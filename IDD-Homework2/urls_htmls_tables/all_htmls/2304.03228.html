<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2304.03228] FedBot: Enhancing Privacy in Chatbots with Federated Learning</title><meta property="og:description" content="Chatbots are mainly data-driven and usually based on utterances that might be sensitive. However, training deep learning models on shared data can violate user privacy. Such issues have commonly existed in chatbots sin…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedBot: Enhancing Privacy in Chatbots with Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedBot: Enhancing Privacy in Chatbots with Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2304.03228">

<!--Generated on Thu Feb 29 14:34:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedBot: Enhancing Privacy in Chatbots with Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Addi Ait-Mlouk 
<br class="ltx_break">School of Informatics, University of Skövde,
<br class="ltx_break">Skövde, Sweden
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">addi.ait-mlouk@his.se </span>
&amp;Sadi Alawadi
<br class="ltx_break">School of Information Technology
<br class="ltx_break">Halmstad University, Halmstad, Sweden
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">sadi.alawadi@hh.se</span>
&amp;Salman Toor
<br class="ltx_break">Department of Information Technology
<br class="ltx_break">Division of Scientific Computing
<br class="ltx_break">Uppsala University, Sweden
<br class="ltx_break">Scaleout Systems, Sweden
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">salman.toor@it.uu.se</span>
&amp;Andreas Hellander 
<br class="ltx_break">Department of Information Technology
<br class="ltx_break">Division of Scientific Computing
<br class="ltx_break">Uppsala University, Sweden
<br class="ltx_break">Scaleout Systems, Sweden
<br class="ltx_break"><span id="id4.4.id4" class="ltx_text ltx_font_typewriter">andreas.hellander@it.uu.se</span>
</span><span class="ltx_author_notes"><span id="id5.5.id1" class="ltx_text ltx_font_typewriter">Corresponding author.</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id6.id1" class="ltx_p">Chatbots are mainly data-driven and usually based on utterances that might be sensitive. However, training deep learning models on shared data can violate user privacy. Such issues have commonly existed in chatbots since their inception. In the literature, there have been many approaches to deal with privacy, such as differential privacy and secure multi-party computation, but most of them need to have access to users’ data. In this context, Federated Learning (FL) aims to protect data privacy through distributed learning methods that keep the data in its location. This paper presents Fedbot, a proof-of-concept (POC) privacy-preserving chatbot that leverages large-scale customer support data. The POC combines Deep Bidirectional Transformer models and federated learning algorithms to protect customer data privacy during collaborative model training. The results of the proof-of-concept showcase the potential for privacy-preserving chatbots to transform the customer support industry by delivering personalized and efficient customer service that meets data privacy regulations and legal requirements. Furthermore, the system is specifically designed to improve its performance and accuracy over time by leveraging its ability to learn from previous interactions.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<p id="p1.4" class="ltx_p"><em id="p1.4.1" class="ltx_emph ltx_font_bold ltx_font_italic">Keywords</em> Chatbot  <math id="p1.1.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation></semantics></math>
Natural Language Processing  <math id="p1.2.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation></semantics></math>
Data Privacy  <math id="p1.3.m3.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.3.m3.1a"><mo id="p1.3.m3.1.1" xref="p1.3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.3.m3.1b"><ci id="p1.3.m3.1.1.cmml" xref="p1.3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.3.m3.1c">\cdot</annotation></semantics></math>
Federated Learning  <math id="p1.4.m4.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.4.m4.1a"><mo id="p1.4.m4.1.1" xref="p1.4.m4.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.4.m4.1b"><ci id="p1.4.m4.1.1.cmml" xref="p1.4.m4.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.4.m4.1c">\cdot</annotation></semantics></math>
Transformer</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Background</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">A chatbot is a virtual agent able to assist users by providing useful information to the user’s request. Chatbots have been very popular since their inception in 1960. After two decades, research and development have seen impressive progress from Eliza in 1960 to AI chatbots such as Siri in 2010, Cortona, and google assistant. Early chatbot systems, such as Eliza <cite class="ltx_cite ltx_citemacro_cite">Weizenbaum (<a href="#bib.bib1" title="" class="ltx_ref">1966</a>)</cite>, Parry <cite class="ltx_cite ltx_citemacro_cite">Colby (<a href="#bib.bib2" title="" class="ltx_ref">1999</a>)</cite>, and Alice <cite class="ltx_cite ltx_citemacro_cite">AbuShawar and Atwell (<a href="#bib.bib3" title="" class="ltx_ref">2015</a>)</cite>, was designed based on a text conversation. These chatbots have been used in Healthcare, e-commerce, and marketing. They are not just conversational systems but also can carry out other tasks such as ordering, booking, frequently asked questions, and symptom assessment. In the past several years, large companies have invested in AI and developed several assistants, among them Apple’s Siri <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.apple.com/ios/siri/</span></span></span>, Microsoft Cortana <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.microsoft.com/en-us/cortana/</span></span></span>, Google Assistant <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://assistant.google.com/</span></span></span>, Facebook Messenger <span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://developers. Facebook.com/blog/post/2016/04/12/</span></span></span>, Alexa <span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://developer.amazon.com/alexa/</span></span></span> and ChatGPT <span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>https://chat.openai.com/</span></span></span>. In terms of security, fundamental challenges for chatbots and Question answering systems are trustworthiness and data privacy. There are concerns regarding the proper handling of data in terms of consent and regulations; these concerns revolve around 1) where and how data is shared with third parties, 2) how data is legally collected or stored, 3) how data is regulated (GDPR, HIPAA, GLBA, CCPA).
<br class="ltx_break"></p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Chatbots are mainly data-driven; training a chatbot model requires massive training data. In most machine learning settings, users or companies must upload their data to a central server in order to train chatbot models. However, centralizing data in this way is not always possible. Reasons for this include the data being large, sensitive, and legally regulated. Federated learning offers several benefits for chatbot applications. First, it allows for the training of chatbots on a large dataset without the need to transfer all the data to a central server which is particularly useful for chatbot applications that handle sensitive or private information. Second, federated learning enables the training of chatbots on data from multiple sources, which can improve the accuracy and robustness of the model, this is especially important for chatbots that interact with diverse user populations. Third, federated learning can reduce the computational burden on the central server, since the training takes place on local devices to ensure that user privacy is preserved, as the data never leaves the device. In recent work, we developed a flexible and scalable framework for federated learning, FEDn, and demonstrated it for a wide range of applications in a geographically distributed setting  <cite class="ltx_cite ltx_citemacro_cite">Ekmefjord et al. (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite>. To extend it to more sophisticated applications, firstly, we propose in this paper our POC that leverages large customer support datasets to train collaboratively Deep Bidirectional Transformer models for customer chatbots.
Secondly, we employed incremental online learning to construct more demanding models that enable accurate local training. This method enhances model performance during collaborative training without sacrificing data privacy. It also enables cross-silo and cross-device participation, allowing models to learn from distributed datasets while sharing knowledge in a trusted environment.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">The remainder of this paper is organized as follows. Section <a href="#S2" title="2 Related work ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> surveys related work. Section <a href="#S3" title="3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> details the proposed approach and architecture of Fedbot, with an emphasis on its privacy and scalability properties. In Section <a href="#S4" title="4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we demonstrate the potential of the framework in an evaluation based on customer support datasets. Finally, Section 4 concludes the work and outlines future work.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">Chatbots have become increasingly popular in recent years, as businesses look for ways to automate customer service and improve customer engagement. Generally, chatbots can be categorized into different categories, among them educational, healthcare, and business. They are based on knowledge from those domains to provide relevant support for the user. Educational chatbots are being used to support students, teachers, and administrators, providing personalized learning experiences and improving student outcomes. For example, educational chatbots can provide information on academic subjects, answer questions about the curriculum, and provide feedback on student performance. One example is MedChatbot <cite class="ltx_cite ltx_citemacro_cite">Kazi et al. (<a href="#bib.bib5" title="" class="ltx_ref">2012</a>)</cite> for medical students, which is based on open-source AIML. Authors in this chatbot deploy the widely available Unified Medical Language System (UMLS) as the domain knowledge source for generating responses to queries and converting natural language queries into relevant SQL queries. These SQL queries are run against the knowledge base, and results are returned to the user in the natural dialogue. Computer Simulation in Educational Communication, CSIEC <cite class="ltx_cite ltx_citemacro_cite">Jia (<a href="#bib.bib6" title="" class="ltx_ref">2009</a>)</cite>, is a system with newly developed multiple functions for English instruction that can chat interactively in English with English learners. It generates responses according to the user input, the dialogue context, user and personality knowledge, common sense knowledge, and inference knowledge. Freudbot <cite class="ltx_cite ltx_citemacro_cite">Heller et al. (<a href="#bib.bib7" title="" class="ltx_ref">2005</a>)</cite> for the psychology domain, is designed to chat in the first person about his theories, concepts, and biographical events using a resource that contained dictionary-type definitions of Freudian terms and concepts. Other chatbots for FAQs have been proposed, among them <cite class="ltx_cite ltx_citemacro_cite">Qiu et al. (<a href="#bib.bib8" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">Healthcare chatbots are being used to improve the patient experience, reduce wait times, and improve triage. For example, virtual health assistants can provide medical information, schedule appointments, and even help diagnose certain conditions. These chatbots are also being used to improve communication between patients and healthcare providers, making it easier for patients to access the information and support they need. Among those chatbots, Mamabot for supporting women and families during pregnancy <cite class="ltx_cite ltx_citemacro_cite">Vaira et al. (<a href="#bib.bib9" title="" class="ltx_ref">2018</a>)</cite> exploiting AI-based chatbot systems to understand and respond to the needs of patients and their families. Also, Pharmabot <cite class="ltx_cite ltx_citemacro_cite">Comendador et al. (<a href="#bib.bib10" title="" class="ltx_ref">2015</a>)</cite> in 2015 is a pediatric generic medicine consultant chatbot designed to prescribe, suggest, and give information on generic medicines for children. A Chatbot for Psychiatric Counseling in Mental Healthcare Service Based on Emotional Dialogue Analysis and Sentence Generation <cite class="ltx_cite ltx_citemacro_cite">Oh et al. (<a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite> that suggests a conversational service for psychiatric counselling that is adapted methodologies to understand counselling contents based on high-level natural language understanding (NLU). Dyva <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib12" title="" class="ltx_ref">Divya et al. </a></cite> proposed a medical chatbot; the idea is to create a text-to-text chatbot that engages patients in conversation about their medical issues and provides basic information and diagnosis based on their symptoms. To improve the quality of life for young adults with food allergies, AllergyBot <cite class="ltx_cite ltx_citemacro_cite">Hsu et al. (<a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite> was proposed as an intelligent and humane chatbot that provides restaurants’ allergy accommodation information based on users’ allergens.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p">In addition, chatbots from the business domain are also proposed to support customers and improve companies’ services in e-commerce systems. Customer service chatbots have been widely adopted by businesses of all sizes to provide 24/7 support to customers. These chatbots use natural language processing (NLP) and machine learning (ML) algorithms to understand customer inquiries and provide relevant responses. They can be integrated with popular messaging platforms, such as Facebook Messenger and WhatsApp, to make it easy for customers to interact with the chatbot. Among those chatbots, SuperAgent <cite class="ltx_cite ltx_citemacro_cite">Cui et al. (<a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite> from Microsoft is a customer service chatbot that leverages large-scale and publicly available e-commerce data. It takes advantage of data from in-page product descriptions and user-generated content from e-commerce websites, which is more practical and cost-effective when answering repetitive questions. Another conversational system is from IBM to automatically generates responses for users’ requests on social media integrated with state-of-the-art deep learning techniques and trained by nearly 1M Twitter conversations between users and agents from over 60 brands <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite>. This system adopts a word embedding method, word2vec neural network language model <cite class="ltx_cite ltx_citemacro_cite">Mikolov et al. (<a href="#bib.bib16" title="" class="ltx_ref">2013</a>)</cite> to learn distributed representations of words from the customer.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">Many open-source frameworks that assist in easily creating centralized conversational engines are proposed, among them, Microsoft Bot, Facebook Messenger, Google Assistant, and Amazon Lex. These frameworks build and connect intelligent conversation engines to interact with customers naturally wherever they are by taking advantage of the wide range of users. Besides, they are highly customizable in real scenarios with third-party data. However, most of them are limited regarding privacy, trust, and data governance. There are many situations where data cannot or should not be shared in this way, such as when data is regulated, sensitive or private (medical text, business, social media). An obvious example is biomedical use cases where a single hospital or clinic may not have access to a sufficient amount of data. Thus the performance of predictive models stands in direct conflict with patient privacy.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p">In this context, we here explore the use of federated learning as a method for distributed and collaborative machine learning to train large models for chatbots and conversational agents. Organizations maintain and govern their data locally and participate in learning a new global, federated model by sending only their model updates (model weights) to a server for aggregation into the global model. Hence, all participants (clients) can benefit from a newly trained model without exposing their data publicly. Our contributions in this paper can be summarized as follows: (1) We propose federated learning models for a customer support chatbot using a Deep Bidirectional Transformer architecture, (2) we design and develop Fedbot, a trustworthy federated learning system for collaborative training (4) we improve the local training with an incremental learning scheme and private online labelling, and (5) our analyses of the models respect data privacy regulations and performs well compared to a baseline centralized model on customer support data after a couple of rounds.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed approach</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">The overall architecture of our proposed Fedbot is shown in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>; it is based on a modular approach and takes advantage of scalable federated learning, data privacy, and distributed ML. Fedbot is trained on customer support data on Twitter, (e.g., over 3 million tweets and replies from the biggest brands) and can respond to user queries related to customer support; it can also retrieve information from multiple sources (information retrieval). Users can interact with the Fedbot using a chit-chat system or voice-based messages. The main modules are the private data pipeline, federated learning settings, a dialogue manager, incremental learning, and information retrieval (see Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The private data pipeline module allows parties (clients) to process and prepare their data locally to be used by federated learning methods. The federated learning module enables multiple private clients to form an alliance to collaboratively train transformer models and send parameters to the server for global model generation (aggregation of local models). The information retrieval module allows users to enrich the conversation with the chatbot by using open-linked data and knowledge graphs. The system allows parties to add new data continuously and train the model through a defined number of rounds to improve the performance using incremental learning techniques. Finally, participating clients can use the global model for customer support. The system is implemented using the open source federated learning framework FEDn  <cite class="ltx_cite ltx_citemacro_cite">Ekmefjord et al. (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite> and a web interface using Flask (<a target="_blank" href="https://flask.palletsprojects.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://flask.palletsprojects.com/</a> accessed on: 04 Avril 2023). FEDn provides a highly scalable federated learning run-time, and Flask is used to develop interactive and user-friendly dialogue interfaces for the different processes in the workflow. The list of available datasets related to customer support used for the demo is placed in the local data sources.
Moreover, the developed system is scalable, flexible, and can be expanded with new clients/data sets on-demand (without re-training the federated model). The conversations and user feedback are stored in a database anonymously for continuous learning and future improvement. More details about the working mechanism of the proposed Fedbot will be explained in the following subsections.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2304.03228/assets/figures/fedbot.png" id="S3.F1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="228" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The Fedbot architecture is organized in three main logical layers, the first one deals with privacy-preserving training using federated learning, the second one is a dialogue manager, and the third is for incremental learning and private data labelling.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Private Data Pipeline Module</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">Deep learning has become the main component of many popular conversational AI and chatbot tasks, such as intent classification, speech recognition, natural language understanding, and question-answering. With massive generated data, these tasks require computational and storage resources. To support this increased demand, cloud providers such as Google cloud <cite class="ltx_cite ltx_citemacro_cite">cloud (<a href="#bib.bib17" title="" class="ltx_ref">2021a</a>)</cite>, Microsoft Azure <cite class="ltx_cite ltx_citemacro_cite">cloud (<a href="#bib.bib18" title="" class="ltx_ref">2021b</a>)</cite>, and Amazon <cite class="ltx_cite ltx_citemacro_cite">cloud (<a href="#bib.bib19" title="" class="ltx_ref">2021c</a>)</cite> provide machine learning and deep learning pipelines as a service to train and serve models. Customers must provide/upload training datasets to the cloud provider to use these services. However, training datasets can contain sensitive and private data (e.g., personal medical data, customer data, and financial data). Hence, data privacy becomes a security problem in machine learning with its unique challenges.
We propose a customer support chatbot based on a federated learning methodology to preserve data privacy and provide secure collaborative training. Fedbot builds on federated learning in which participating clients train local model updates and then share the gradient (model parameters) with the central server. The server implements an aggregation strategy where local models are combined into an updated global model. This whole process is iterated until convergence. This approach ensures input data privacy, enables collaborative training, and reduces the need for very large central computing resources by distributing the workload across clients.
Further, the proposed system is capable of improving local learning by using incremental learning and a local data labelling pipeline.
</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Federated Machine Learning Module</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.2" class="ltx_p">Federated learning is an emerging technology for collaborative and decentralized machine learning <cite class="ltx_cite ltx_citemacro_cite">Kairouz et al. (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite> in which multiple parties (client) jointly train machine learning models using private data. These parties could be mobile and IoT devices (cross-device FL) or larger entities such as different organizations, subsidiaries or geographically separated data silos (cross-silo FL). In FL, private data remains local at each party at all times, and only the parameter updates are communicated with a server. In our system, we use FL to develop a customer support chatbot based on transformer architecture. Fedbot trains a global model using <span id="S3.SS2.p1.2.1" class="ltx_text ltx_font_italic">Federated Averaging</span>  <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite> (Algorithm <a href="#algorithm1" title="In 3.2 Federated Machine Learning Module ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> ) on large amounts of data from multiple geographically distributed parties. Each party trains a local transformer model on its data (Algorithm <a href="#algorithm2" title="In 3.2 Federated Machine Learning Module ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) and share parameters <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="W_{t}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑊</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">W_{t}</annotation></semantics></math> with the central server for aggregation.
In the aggregation part, the aggregator (running in the <em id="S3.SS2.p1.2.2" class="ltx_emph ltx_font_italic">combiner</em> in FEDn <cite class="ltx_cite ltx_citemacro_cite">Ekmefjord et al. (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite>) combines shared parameters and generates a single global model <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="M(W_{t})" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></times><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑀</ci><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">M(W_{t})</annotation></semantics></math> for each round using
incremental averaging.
In this way, Fedbot can learn new knowledge from different clients without exposing or sharing their private data.
</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.12" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.1.1" class="ltx_listingline">
<span id="algorithm1.1.1.1" class="ltx_text"><span id="algorithm1.1.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span><math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="W_{t}" display="inline"><semantics id="algorithm1.1.1.m1.1a"><msub id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">W</mi><mi id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2">𝑊</ci><ci id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">W_{t}</annotation></semantics></math>
</div>
<div id="algorithm1.2.2" class="ltx_listingline">
<span id="algorithm1.2.2.1" class="ltx_text"><span id="algorithm1.2.2.1.1" class="ltx_text ltx_font_bold">Output:</span> </span><math id="algorithm1.2.2.m1.1" class="ltx_Math" alttext="M(W_{t})" display="inline"><semantics id="algorithm1.2.2.m1.1a"><mrow id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml"><mi id="algorithm1.2.2.m1.1.1.3" xref="algorithm1.2.2.m1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="algorithm1.2.2.m1.1.1.2" xref="algorithm1.2.2.m1.1.1.2.cmml">​</mo><mrow id="algorithm1.2.2.m1.1.1.1.1" xref="algorithm1.2.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.2.2.m1.1.1.1.1.2" xref="algorithm1.2.2.m1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.2.2.m1.1.1.1.1.1" xref="algorithm1.2.2.m1.1.1.1.1.1.cmml"><mi id="algorithm1.2.2.m1.1.1.1.1.1.2" xref="algorithm1.2.2.m1.1.1.1.1.1.2.cmml">W</mi><mi id="algorithm1.2.2.m1.1.1.1.1.1.3" xref="algorithm1.2.2.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.2.2.m1.1.1.1.1.3" xref="algorithm1.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.1b"><apply id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1"><times id="algorithm1.2.2.m1.1.1.2.cmml" xref="algorithm1.2.2.m1.1.1.2"></times><ci id="algorithm1.2.2.m1.1.1.3.cmml" xref="algorithm1.2.2.m1.1.1.3">𝑀</ci><apply id="algorithm1.2.2.m1.1.1.1.1.1.cmml" xref="algorithm1.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m1.1.1.1.1.1.1.cmml" xref="algorithm1.2.2.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.2.2.m1.1.1.1.1.1.2.cmml" xref="algorithm1.2.2.m1.1.1.1.1.1.2">𝑊</ci><ci id="algorithm1.2.2.m1.1.1.1.1.1.3.cmml" xref="algorithm1.2.2.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.1c">M(W_{t})</annotation></semantics></math>
</div>
<div id="algorithm1.12.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<span id="algorithm1.12.13.1" class="ltx_text ltx_font_bold">Server executes:</span>
</div>
<div id="algorithm1.3.3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
initialized <math id="algorithm1.3.3.m1.1" class="ltx_Math" alttext="W_{0}" display="inline"><semantics id="algorithm1.3.3.m1.1a"><msub id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml"><mi id="algorithm1.3.3.m1.1.1.2" xref="algorithm1.3.3.m1.1.1.2.cmml">W</mi><mn id="algorithm1.3.3.m1.1.1.3" xref="algorithm1.3.3.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.1b"><apply id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m1.1.1.1.cmml" xref="algorithm1.3.3.m1.1.1">subscript</csymbol><ci id="algorithm1.3.3.m1.1.1.2.cmml" xref="algorithm1.3.3.m1.1.1.2">𝑊</ci><cn type="integer" id="algorithm1.3.3.m1.1.1.3.cmml" xref="algorithm1.3.3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.1c">W_{0}</annotation></semantics></math>

</div>
<div id="algorithm1.4.4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>

<span id="algorithm1.4.4.2" class="ltx_text ltx_font_bold">Function</span> <em id="algorithm1.4.4.1" class="ltx_emph ltx_font_typewriter">IncrementalFedAVG(<em id="algorithm1.4.4.1.1.1" class="ltx_emph ltx_font_serif ltx_font_italic"><math id="algorithm1.4.4.1.1.1.m1.3" class="ltx_Math" alttext="k,W_{t-1},W_{t}" display="inline"><semantics id="algorithm1.4.4.1.1.1.m1.3a"><mrow id="algorithm1.4.4.1.1.1.m1.3.3.2" xref="algorithm1.4.4.1.1.1.m1.3.3.3.cmml"><mi id="algorithm1.4.4.1.1.1.m1.1.1" xref="algorithm1.4.4.1.1.1.m1.1.1.cmml">k</mi><mo id="algorithm1.4.4.1.1.1.m1.3.3.2.3" xref="algorithm1.4.4.1.1.1.m1.3.3.3.cmml">,</mo><msub id="algorithm1.4.4.1.1.1.m1.2.2.1.1" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.cmml"><mi id="algorithm1.4.4.1.1.1.m1.2.2.1.1.2" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.2.cmml">W</mi><mrow id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.cmml"><mi id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.2" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.2.cmml">t</mi><mo id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.1" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.1.cmml">−</mo><mn id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.3" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="algorithm1.4.4.1.1.1.m1.3.3.2.4" xref="algorithm1.4.4.1.1.1.m1.3.3.3.cmml">,</mo><msub id="algorithm1.4.4.1.1.1.m1.3.3.2.2" xref="algorithm1.4.4.1.1.1.m1.3.3.2.2.cmml"><mi id="algorithm1.4.4.1.1.1.m1.3.3.2.2.2" xref="algorithm1.4.4.1.1.1.m1.3.3.2.2.2.cmml">W</mi><mi id="algorithm1.4.4.1.1.1.m1.3.3.2.2.3" xref="algorithm1.4.4.1.1.1.m1.3.3.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.1.1.1.m1.3b"><list id="algorithm1.4.4.1.1.1.m1.3.3.3.cmml" xref="algorithm1.4.4.1.1.1.m1.3.3.2"><ci id="algorithm1.4.4.1.1.1.m1.1.1.cmml" xref="algorithm1.4.4.1.1.1.m1.1.1">𝑘</ci><apply id="algorithm1.4.4.1.1.1.m1.2.2.1.1.cmml" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.4.4.1.1.1.m1.2.2.1.1.1.cmml" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="algorithm1.4.4.1.1.1.m1.2.2.1.1.2.cmml" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.2">𝑊</ci><apply id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.cmml" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3"><minus id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.1.cmml" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.1"></minus><ci id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.2.cmml" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.3.cmml" xref="algorithm1.4.4.1.1.1.m1.2.2.1.1.3.3">1</cn></apply></apply><apply id="algorithm1.4.4.1.1.1.m1.3.3.2.2.cmml" xref="algorithm1.4.4.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.4.4.1.1.1.m1.3.3.2.2.1.cmml" xref="algorithm1.4.4.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="algorithm1.4.4.1.1.1.m1.3.3.2.2.2.cmml" xref="algorithm1.4.4.1.1.1.m1.3.3.2.2.2">𝑊</ci><ci id="algorithm1.4.4.1.1.1.m1.3.3.2.2.3.cmml" xref="algorithm1.4.4.1.1.1.m1.3.3.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.1.1.1.m1.3c">k,W_{t-1},W_{t}</annotation></semantics></math></em>)</em><span id="algorithm1.4.4.3" class="ltx_text ltx_font_bold">:</span> 
</div>
<div id="algorithm1.12.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.6.6.3" class="ltx_text ltx_font_bold">foreach</span> <em id="algorithm1.6.6.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.5.5.1.m1.1" class="ltx_Math" alttext="t\leftarrow 1" display="inline"><semantics id="algorithm1.5.5.1.m1.1a"><mrow id="algorithm1.5.5.1.m1.1.1" xref="algorithm1.5.5.1.m1.1.1.cmml"><mi id="algorithm1.5.5.1.m1.1.1.2" xref="algorithm1.5.5.1.m1.1.1.2.cmml">t</mi><mo stretchy="false" id="algorithm1.5.5.1.m1.1.1.1" xref="algorithm1.5.5.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.5.5.1.m1.1.1.3" xref="algorithm1.5.5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.1.m1.1b"><apply id="algorithm1.5.5.1.m1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1"><ci id="algorithm1.5.5.1.m1.1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1">←</ci><ci id="algorithm1.5.5.1.m1.1.1.2.cmml" xref="algorithm1.5.5.1.m1.1.1.2">𝑡</ci><cn type="integer" id="algorithm1.5.5.1.m1.1.1.3.cmml" xref="algorithm1.5.5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.1.m1.1c">t\leftarrow 1</annotation></semantics></math> <span id="algorithm1.6.6.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm1.6.6.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="algorithm1.6.6.2.m2.1a"><mi id="algorithm1.6.6.2.m2.1.1" xref="algorithm1.6.6.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.2.m2.1b"><ci id="algorithm1.6.6.2.m2.1.1.cmml" xref="algorithm1.6.6.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.2.m2.1c">r</annotation></semantics></math></em> <span id="algorithm1.6.6.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.12.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.7.7.m1.1" class="ltx_Math" alttext="S_{t}\leftarrow" display="inline"><semantics id="algorithm1.7.7.m1.1a"><mrow id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml"><msub id="algorithm1.7.7.m1.1.1.2" xref="algorithm1.7.7.m1.1.1.2.cmml"><mi id="algorithm1.7.7.m1.1.1.2.2" xref="algorithm1.7.7.m1.1.1.2.2.cmml">S</mi><mi id="algorithm1.7.7.m1.1.1.2.3" xref="algorithm1.7.7.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.7.7.m1.1.1.1" xref="algorithm1.7.7.m1.1.1.1.cmml">←</mo><mi id="algorithm1.7.7.m1.1.1.3" xref="algorithm1.7.7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><apply id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1"><ci id="algorithm1.7.7.m1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1">←</ci><apply id="algorithm1.7.7.m1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.2.1.cmml" xref="algorithm1.7.7.m1.1.1.2">subscript</csymbol><ci id="algorithm1.7.7.m1.1.1.2.2.cmml" xref="algorithm1.7.7.m1.1.1.2.2">𝑆</ci><ci id="algorithm1.7.7.m1.1.1.2.3.cmml" xref="algorithm1.7.7.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.7.7.m1.1.1.3.cmml" xref="algorithm1.7.7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">S_{t}\leftarrow</annotation></semantics></math> (sample a random set of clients)
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.8.8.2" class="ltx_text ltx_font_bold">foreach</span> <em id="algorithm1.8.8.1" class="ltx_emph ltx_font_italic">client <math id="algorithm1.8.8.1.m1.1" class="ltx_Math" alttext="k\in S_{t}" display="inline"><semantics id="algorithm1.8.8.1.m1.1a"><mrow id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml"><mi id="algorithm1.8.8.1.m1.1.1.2" xref="algorithm1.8.8.1.m1.1.1.2.cmml">k</mi><mo id="algorithm1.8.8.1.m1.1.1.1" xref="algorithm1.8.8.1.m1.1.1.1.cmml">∈</mo><msub id="algorithm1.8.8.1.m1.1.1.3" xref="algorithm1.8.8.1.m1.1.1.3.cmml"><mi id="algorithm1.8.8.1.m1.1.1.3.2" xref="algorithm1.8.8.1.m1.1.1.3.2.cmml">S</mi><mi id="algorithm1.8.8.1.m1.1.1.3.3" xref="algorithm1.8.8.1.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.1b"><apply id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1"><in id="algorithm1.8.8.1.m1.1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1.1"></in><ci id="algorithm1.8.8.1.m1.1.1.2.cmml" xref="algorithm1.8.8.1.m1.1.1.2">𝑘</ci><apply id="algorithm1.8.8.1.m1.1.1.3.cmml" xref="algorithm1.8.8.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.8.8.1.m1.1.1.3.1.cmml" xref="algorithm1.8.8.1.m1.1.1.3">subscript</csymbol><ci id="algorithm1.8.8.1.m1.1.1.3.2.cmml" xref="algorithm1.8.8.1.m1.1.1.3.2">𝑆</ci><ci id="algorithm1.8.8.1.m1.1.1.3.3.cmml" xref="algorithm1.8.8.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.1c">k\in S_{t}</annotation></semantics></math> <span id="algorithm1.8.8.1.1" class="ltx_text ltx_font_bold">in parallel</span></em> <span id="algorithm1.8.8.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.9.9.m1.3" class="ltx_Math" alttext="W_{t+1}^{k}\leftarrow ClientUpdate(k,W_{t},N_{l})" display="inline"><semantics id="algorithm1.9.9.m1.3a"><mrow id="algorithm1.9.9.m1.3.3" xref="algorithm1.9.9.m1.3.3.cmml"><msubsup id="algorithm1.9.9.m1.3.3.4" xref="algorithm1.9.9.m1.3.3.4.cmml"><mi id="algorithm1.9.9.m1.3.3.4.2.2" xref="algorithm1.9.9.m1.3.3.4.2.2.cmml">W</mi><mrow id="algorithm1.9.9.m1.3.3.4.2.3" xref="algorithm1.9.9.m1.3.3.4.2.3.cmml"><mi id="algorithm1.9.9.m1.3.3.4.2.3.2" xref="algorithm1.9.9.m1.3.3.4.2.3.2.cmml">t</mi><mo id="algorithm1.9.9.m1.3.3.4.2.3.1" xref="algorithm1.9.9.m1.3.3.4.2.3.1.cmml">+</mo><mn id="algorithm1.9.9.m1.3.3.4.2.3.3" xref="algorithm1.9.9.m1.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.9.9.m1.3.3.4.3" xref="algorithm1.9.9.m1.3.3.4.3.cmml">k</mi></msubsup><mo stretchy="false" id="algorithm1.9.9.m1.3.3.3" xref="algorithm1.9.9.m1.3.3.3.cmml">←</mo><mrow id="algorithm1.9.9.m1.3.3.2" xref="algorithm1.9.9.m1.3.3.2.cmml"><mi id="algorithm1.9.9.m1.3.3.2.4" xref="algorithm1.9.9.m1.3.3.2.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.5" xref="algorithm1.9.9.m1.3.3.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3a" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.6" xref="algorithm1.9.9.m1.3.3.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3b" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.7" xref="algorithm1.9.9.m1.3.3.2.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3c" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.8" xref="algorithm1.9.9.m1.3.3.2.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3d" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.9" xref="algorithm1.9.9.m1.3.3.2.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3e" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.10" xref="algorithm1.9.9.m1.3.3.2.10.cmml">U</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3f" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.11" xref="algorithm1.9.9.m1.3.3.2.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3g" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.12" xref="algorithm1.9.9.m1.3.3.2.12.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3h" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.13" xref="algorithm1.9.9.m1.3.3.2.13.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3i" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.14" xref="algorithm1.9.9.m1.3.3.2.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3j" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mi id="algorithm1.9.9.m1.3.3.2.15" xref="algorithm1.9.9.m1.3.3.2.15.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.3.3.2.3k" xref="algorithm1.9.9.m1.3.3.2.3.cmml">​</mo><mrow id="algorithm1.9.9.m1.3.3.2.2.2" xref="algorithm1.9.9.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="algorithm1.9.9.m1.3.3.2.2.2.3" xref="algorithm1.9.9.m1.3.3.2.2.3.cmml">(</mo><mi id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml">k</mi><mo id="algorithm1.9.9.m1.3.3.2.2.2.4" xref="algorithm1.9.9.m1.3.3.2.2.3.cmml">,</mo><msub id="algorithm1.9.9.m1.2.2.1.1.1.1" xref="algorithm1.9.9.m1.2.2.1.1.1.1.cmml"><mi id="algorithm1.9.9.m1.2.2.1.1.1.1.2" xref="algorithm1.9.9.m1.2.2.1.1.1.1.2.cmml">W</mi><mi id="algorithm1.9.9.m1.2.2.1.1.1.1.3" xref="algorithm1.9.9.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="algorithm1.9.9.m1.3.3.2.2.2.5" xref="algorithm1.9.9.m1.3.3.2.2.3.cmml">,</mo><msub id="algorithm1.9.9.m1.3.3.2.2.2.2" xref="algorithm1.9.9.m1.3.3.2.2.2.2.cmml"><mi id="algorithm1.9.9.m1.3.3.2.2.2.2.2" xref="algorithm1.9.9.m1.3.3.2.2.2.2.2.cmml">N</mi><mi id="algorithm1.9.9.m1.3.3.2.2.2.2.3" xref="algorithm1.9.9.m1.3.3.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="algorithm1.9.9.m1.3.3.2.2.2.6" xref="algorithm1.9.9.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.3b"><apply id="algorithm1.9.9.m1.3.3.cmml" xref="algorithm1.9.9.m1.3.3"><ci id="algorithm1.9.9.m1.3.3.3.cmml" xref="algorithm1.9.9.m1.3.3.3">←</ci><apply id="algorithm1.9.9.m1.3.3.4.cmml" xref="algorithm1.9.9.m1.3.3.4"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.3.3.4.1.cmml" xref="algorithm1.9.9.m1.3.3.4">superscript</csymbol><apply id="algorithm1.9.9.m1.3.3.4.2.cmml" xref="algorithm1.9.9.m1.3.3.4"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.3.3.4.2.1.cmml" xref="algorithm1.9.9.m1.3.3.4">subscript</csymbol><ci id="algorithm1.9.9.m1.3.3.4.2.2.cmml" xref="algorithm1.9.9.m1.3.3.4.2.2">𝑊</ci><apply id="algorithm1.9.9.m1.3.3.4.2.3.cmml" xref="algorithm1.9.9.m1.3.3.4.2.3"><plus id="algorithm1.9.9.m1.3.3.4.2.3.1.cmml" xref="algorithm1.9.9.m1.3.3.4.2.3.1"></plus><ci id="algorithm1.9.9.m1.3.3.4.2.3.2.cmml" xref="algorithm1.9.9.m1.3.3.4.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.9.9.m1.3.3.4.2.3.3.cmml" xref="algorithm1.9.9.m1.3.3.4.2.3.3">1</cn></apply></apply><ci id="algorithm1.9.9.m1.3.3.4.3.cmml" xref="algorithm1.9.9.m1.3.3.4.3">𝑘</ci></apply><apply id="algorithm1.9.9.m1.3.3.2.cmml" xref="algorithm1.9.9.m1.3.3.2"><times id="algorithm1.9.9.m1.3.3.2.3.cmml" xref="algorithm1.9.9.m1.3.3.2.3"></times><ci id="algorithm1.9.9.m1.3.3.2.4.cmml" xref="algorithm1.9.9.m1.3.3.2.4">𝐶</ci><ci id="algorithm1.9.9.m1.3.3.2.5.cmml" xref="algorithm1.9.9.m1.3.3.2.5">𝑙</ci><ci id="algorithm1.9.9.m1.3.3.2.6.cmml" xref="algorithm1.9.9.m1.3.3.2.6">𝑖</ci><ci id="algorithm1.9.9.m1.3.3.2.7.cmml" xref="algorithm1.9.9.m1.3.3.2.7">𝑒</ci><ci id="algorithm1.9.9.m1.3.3.2.8.cmml" xref="algorithm1.9.9.m1.3.3.2.8">𝑛</ci><ci id="algorithm1.9.9.m1.3.3.2.9.cmml" xref="algorithm1.9.9.m1.3.3.2.9">𝑡</ci><ci id="algorithm1.9.9.m1.3.3.2.10.cmml" xref="algorithm1.9.9.m1.3.3.2.10">𝑈</ci><ci id="algorithm1.9.9.m1.3.3.2.11.cmml" xref="algorithm1.9.9.m1.3.3.2.11">𝑝</ci><ci id="algorithm1.9.9.m1.3.3.2.12.cmml" xref="algorithm1.9.9.m1.3.3.2.12">𝑑</ci><ci id="algorithm1.9.9.m1.3.3.2.13.cmml" xref="algorithm1.9.9.m1.3.3.2.13">𝑎</ci><ci id="algorithm1.9.9.m1.3.3.2.14.cmml" xref="algorithm1.9.9.m1.3.3.2.14">𝑡</ci><ci id="algorithm1.9.9.m1.3.3.2.15.cmml" xref="algorithm1.9.9.m1.3.3.2.15">𝑒</ci><vector id="algorithm1.9.9.m1.3.3.2.2.3.cmml" xref="algorithm1.9.9.m1.3.3.2.2.2"><ci id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1">𝑘</ci><apply id="algorithm1.9.9.m1.2.2.1.1.1.1.cmml" xref="algorithm1.9.9.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.9.9.m1.2.2.1.1.1.1">subscript</csymbol><ci id="algorithm1.9.9.m1.2.2.1.1.1.1.2.cmml" xref="algorithm1.9.9.m1.2.2.1.1.1.1.2">𝑊</ci><ci id="algorithm1.9.9.m1.2.2.1.1.1.1.3.cmml" xref="algorithm1.9.9.m1.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="algorithm1.9.9.m1.3.3.2.2.2.2.cmml" xref="algorithm1.9.9.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.3.3.2.2.2.2.1.cmml" xref="algorithm1.9.9.m1.3.3.2.2.2.2">subscript</csymbol><ci id="algorithm1.9.9.m1.3.3.2.2.2.2.2.cmml" xref="algorithm1.9.9.m1.3.3.2.2.2.2.2">𝑁</ci><ci id="algorithm1.9.9.m1.3.3.2.2.2.2.3.cmml" xref="algorithm1.9.9.m1.3.3.2.2.2.2.3">𝑙</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.3c">W_{t+1}^{k}\leftarrow ClientUpdate(k,W_{t},N_{l})</annotation></semantics></math>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="W_{t+1}\leftarrow\sum_{k=1}^{k}\frac{n_{k}}{n}W_{t+1}^{k}" display="inline"><semantics id="algorithm1.10.10.m1.1a"><mrow id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><msub id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml"><mi id="algorithm1.10.10.m1.1.1.2.2" xref="algorithm1.10.10.m1.1.1.2.2.cmml">W</mi><mrow id="algorithm1.10.10.m1.1.1.2.3" xref="algorithm1.10.10.m1.1.1.2.3.cmml"><mi id="algorithm1.10.10.m1.1.1.2.3.2" xref="algorithm1.10.10.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm1.10.10.m1.1.1.2.3.1" xref="algorithm1.10.10.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.10.10.m1.1.1.2.3.3" xref="algorithm1.10.10.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="algorithm1.10.10.m1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml"><msubsup id="algorithm1.10.10.m1.1.1.3.1" xref="algorithm1.10.10.m1.1.1.3.1.cmml"><mo id="algorithm1.10.10.m1.1.1.3.1.2.2" xref="algorithm1.10.10.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.10.10.m1.1.1.3.1.2.3" xref="algorithm1.10.10.m1.1.1.3.1.2.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.1.2.3.2" xref="algorithm1.10.10.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="algorithm1.10.10.m1.1.1.3.1.2.3.1" xref="algorithm1.10.10.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.10.10.m1.1.1.3.1.2.3.3" xref="algorithm1.10.10.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.10.10.m1.1.1.3.1.3" xref="algorithm1.10.10.m1.1.1.3.1.3.cmml">k</mi></msubsup><mrow id="algorithm1.10.10.m1.1.1.3.2" xref="algorithm1.10.10.m1.1.1.3.2.cmml"><mfrac id="algorithm1.10.10.m1.1.1.3.2.2" xref="algorithm1.10.10.m1.1.1.3.2.2.cmml"><msub id="algorithm1.10.10.m1.1.1.3.2.2.2" xref="algorithm1.10.10.m1.1.1.3.2.2.2.cmml"><mi id="algorithm1.10.10.m1.1.1.3.2.2.2.2" xref="algorithm1.10.10.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="algorithm1.10.10.m1.1.1.3.2.2.2.3" xref="algorithm1.10.10.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="algorithm1.10.10.m1.1.1.3.2.2.3" xref="algorithm1.10.10.m1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.10.10.m1.1.1.3.2.1" xref="algorithm1.10.10.m1.1.1.3.2.1.cmml">​</mo><msubsup id="algorithm1.10.10.m1.1.1.3.2.3" xref="algorithm1.10.10.m1.1.1.3.2.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.2.3.2.2" xref="algorithm1.10.10.m1.1.1.3.2.3.2.2.cmml">W</mi><mrow id="algorithm1.10.10.m1.1.1.3.2.3.2.3" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.2.3.2.3.2" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="algorithm1.10.10.m1.1.1.3.2.3.2.3.1" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="algorithm1.10.10.m1.1.1.3.2.3.2.3.3" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.10.10.m1.1.1.3.2.3.3" xref="algorithm1.10.10.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><ci id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1">←</ci><apply id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.2.1.cmml" xref="algorithm1.10.10.m1.1.1.2">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.2.2.cmml" xref="algorithm1.10.10.m1.1.1.2.2">𝑊</ci><apply id="algorithm1.10.10.m1.1.1.2.3.cmml" xref="algorithm1.10.10.m1.1.1.2.3"><plus id="algorithm1.10.10.m1.1.1.2.3.1.cmml" xref="algorithm1.10.10.m1.1.1.2.3.1"></plus><ci id="algorithm1.10.10.m1.1.1.2.3.2.cmml" xref="algorithm1.10.10.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.10.10.m1.1.1.2.3.3.cmml" xref="algorithm1.10.10.m1.1.1.2.3.3">1</cn></apply></apply><apply id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3"><apply id="algorithm1.10.10.m1.1.1.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.1.1.cmml" xref="algorithm1.10.10.m1.1.1.3.1">superscript</csymbol><apply id="algorithm1.10.10.m1.1.1.3.1.2.cmml" xref="algorithm1.10.10.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.1.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.1">subscript</csymbol><sum id="algorithm1.10.10.m1.1.1.3.1.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.1.2.2"></sum><apply id="algorithm1.10.10.m1.1.1.3.1.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.1.2.3"><eq id="algorithm1.10.10.m1.1.1.3.1.2.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.1.2.3.1"></eq><ci id="algorithm1.10.10.m1.1.1.3.1.2.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="algorithm1.10.10.m1.1.1.3.1.2.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.10.10.m1.1.1.3.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3.1.3">𝑘</ci></apply><apply id="algorithm1.10.10.m1.1.1.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2"><times id="algorithm1.10.10.m1.1.1.3.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2.1"></times><apply id="algorithm1.10.10.m1.1.1.3.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2"><divide id="algorithm1.10.10.m1.1.1.3.2.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2"></divide><apply id="algorithm1.10.10.m1.1.1.3.2.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.2.2.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2.2">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.3.2.2.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="algorithm1.10.10.m1.1.1.3.2.2.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="algorithm1.10.10.m1.1.1.3.2.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.2.3">𝑛</ci></apply><apply id="algorithm1.10.10.m1.1.1.3.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.2.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3">superscript</csymbol><apply id="algorithm1.10.10.m1.1.1.3.2.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.2.3.2.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.3.2.3.2.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3.2.2">𝑊</ci><apply id="algorithm1.10.10.m1.1.1.3.2.3.2.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3"><plus id="algorithm1.10.10.m1.1.1.3.2.3.2.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3.1"></plus><ci id="algorithm1.10.10.m1.1.1.3.2.3.2.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.10.10.m1.1.1.3.2.3.2.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.10.10.m1.1.1.3.2.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">W_{t+1}\leftarrow\sum_{k=1}^{k}\frac{n_{k}}{n}W_{t+1}^{k}</annotation></semantics></math> 
</div>
<div id="algorithm1.12.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="W_{t}\leftarrow(W_{t-1}+(W_{t}-W_{t-1})/t)" display="inline"><semantics id="algorithm1.11.11.m1.1a"><mrow id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><msub id="algorithm1.11.11.m1.1.1.3" xref="algorithm1.11.11.m1.1.1.3.cmml"><mi id="algorithm1.11.11.m1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.3.2.cmml">W</mi><mi id="algorithm1.11.11.m1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.3.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.11.11.m1.1.1.2" xref="algorithm1.11.11.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.11.11.m1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.11.11.m1.1.1.1.1.2" xref="algorithm1.11.11.m1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.11.11.m1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.cmml"><msub id="algorithm1.11.11.m1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.1.1.1.3.2.cmml">W</mi><mrow id="algorithm1.11.11.m1.1.1.1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.3.3.2" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="algorithm1.11.11.m1.1.1.1.1.1.3.3.1" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="algorithm1.11.11.m1.1.1.1.1.1.3.3.3" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="algorithm1.11.11.m1.1.1.1.1.1.2" xref="algorithm1.11.11.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.11.11.m1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.cmml"><mrow id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mrow id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.2.cmml">/</mo><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.cmml">t</mi></mrow></mrow><mo stretchy="false" id="algorithm1.11.11.m1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><ci id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2">←</ci><apply id="algorithm1.11.11.m1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.1.1.3.2">𝑊</ci><ci id="algorithm1.11.11.m1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.3.3">𝑡</ci></apply><apply id="algorithm1.11.11.m1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1"><plus id="algorithm1.11.11.m1.1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.2"></plus><apply id="algorithm1.11.11.m1.1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.3.2">𝑊</ci><apply id="algorithm1.11.11.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3"><minus id="algorithm1.11.11.m1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3.1"></minus><ci id="algorithm1.11.11.m1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="algorithm1.11.11.m1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1"><divide id="algorithm1.11.11.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.2"></divide><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1"><minus id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3"><minus id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">W_{t}\leftarrow(W_{t-1}+(W_{t}-W_{t-1})/t)</annotation></semantics></math> 
</div>
<div id="algorithm1.12.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.12.12.1" class="ltx_text ltx_font_bold">return</span> <math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="M(W_{t})" display="inline"><semantics id="algorithm1.12.12.m1.1a"><mrow id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><mi id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.1.1.2" xref="algorithm1.12.12.m1.1.1.2.cmml">​</mo><mrow id="algorithm1.12.12.m1.1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.12.12.m1.1.1.1.1.2" xref="algorithm1.12.12.m1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.12.12.m1.1.1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.1.1.cmml"><mi id="algorithm1.12.12.m1.1.1.1.1.1.2" xref="algorithm1.12.12.m1.1.1.1.1.1.2.cmml">W</mi><mi id="algorithm1.12.12.m1.1.1.1.1.1.3" xref="algorithm1.12.12.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.12.12.m1.1.1.1.1.3" xref="algorithm1.12.12.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><times id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.2"></times><ci id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3">𝑀</ci><apply id="algorithm1.12.12.m1.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.12.12.m1.1.1.1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1.2">𝑊</ci><ci id="algorithm1.12.12.m1.1.1.1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">M(W_{t})</annotation></semantics></math>

</div>
<div id="algorithm1.12.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span> 
</div>
<div id="algorithm1.12.19" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.19.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Incremental FedAVG algorithm. <span id="algorithm1.20.2" class="ltx_text ltx_font_bold">k</span>: Number of clients, <span id="algorithm1.21.3" class="ltx_text ltx_font_bold">r</span>: Number of rounds, <math id="algorithm1.14.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="algorithm1.14.m1.1b"><msub id="algorithm1.14.m1.1.1" xref="algorithm1.14.m1.1.1.cmml"><mi id="algorithm1.14.m1.1.1.2" xref="algorithm1.14.m1.1.1.2.cmml">W</mi><mi id="algorithm1.14.m1.1.1.3" xref="algorithm1.14.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.14.m1.1c"><apply id="algorithm1.14.m1.1.1.cmml" xref="algorithm1.14.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.m1.1.1.1.cmml" xref="algorithm1.14.m1.1.1">subscript</csymbol><ci id="algorithm1.14.m1.1.1.2.cmml" xref="algorithm1.14.m1.1.1.2">𝑊</ci><ci id="algorithm1.14.m1.1.1.3.cmml" xref="algorithm1.14.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.m1.1d">W_{i}</annotation></semantics></math>: Local model weights and <span id="algorithm1.22.4" class="ltx_text ltx_font_bold">M</span>: Global model weights.</figcaption>
</figure>
<figure id="algorithm2" class="ltx_float ltx_algorithm">
<div id="algorithm2.10" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm2.1.1" class="ltx_listingline">
<span id="algorithm2.1.1.1" class="ltx_text"><span id="algorithm2.1.1.1.1" class="ltx_text ltx_font_bold">Output:</span> </span><math id="algorithm2.1.1.m1.1" class="ltx_Math" alttext="W_{t}" display="inline"><semantics id="algorithm2.1.1.m1.1a"><msub id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml"><mi id="algorithm2.1.1.m1.1.1.2" xref="algorithm2.1.1.m1.1.1.2.cmml">W</mi><mi id="algorithm2.1.1.m1.1.1.3" xref="algorithm2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.1b"><apply id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.1.1.m1.1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">subscript</csymbol><ci id="algorithm2.1.1.m1.1.1.2.cmml" xref="algorithm2.1.1.m1.1.1.2">𝑊</ci><ci id="algorithm2.1.1.m1.1.1.3.cmml" xref="algorithm2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.1c">W_{t}</annotation></semantics></math>
</div>
<div id="algorithm2.10.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>

</div>
<div id="algorithm2.10.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span> // Run on client k
</div>
<div id="algorithm2.2.2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>

<span id="algorithm2.2.2.2" class="ltx_text ltx_font_bold">Function</span> <em id="algorithm2.2.2.1" class="ltx_emph ltx_font_typewriter">ClientUpdate(<em id="algorithm2.2.2.1.1.1" class="ltx_emph ltx_font_serif ltx_font_italic"><math id="algorithm2.2.2.1.1.1.m1.2" class="ltx_Math" alttext="k,W_{t}" display="inline"><semantics id="algorithm2.2.2.1.1.1.m1.2a"><mrow id="algorithm2.2.2.1.1.1.m1.2.2.1" xref="algorithm2.2.2.1.1.1.m1.2.2.2.cmml"><mi id="algorithm2.2.2.1.1.1.m1.1.1" xref="algorithm2.2.2.1.1.1.m1.1.1.cmml">k</mi><mo id="algorithm2.2.2.1.1.1.m1.2.2.1.2" xref="algorithm2.2.2.1.1.1.m1.2.2.2.cmml">,</mo><msub id="algorithm2.2.2.1.1.1.m1.2.2.1.1" xref="algorithm2.2.2.1.1.1.m1.2.2.1.1.cmml"><mi id="algorithm2.2.2.1.1.1.m1.2.2.1.1.2" xref="algorithm2.2.2.1.1.1.m1.2.2.1.1.2.cmml">W</mi><mi id="algorithm2.2.2.1.1.1.m1.2.2.1.1.3" xref="algorithm2.2.2.1.1.1.m1.2.2.1.1.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.1.1.1.m1.2b"><list id="algorithm2.2.2.1.1.1.m1.2.2.2.cmml" xref="algorithm2.2.2.1.1.1.m1.2.2.1"><ci id="algorithm2.2.2.1.1.1.m1.1.1.cmml" xref="algorithm2.2.2.1.1.1.m1.1.1">𝑘</ci><apply id="algorithm2.2.2.1.1.1.m1.2.2.1.1.cmml" xref="algorithm2.2.2.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.1.1.1.m1.2.2.1.1.1.cmml" xref="algorithm2.2.2.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="algorithm2.2.2.1.1.1.m1.2.2.1.1.2.cmml" xref="algorithm2.2.2.1.1.1.m1.2.2.1.1.2">𝑊</ci><ci id="algorithm2.2.2.1.1.1.m1.2.2.1.1.3.cmml" xref="algorithm2.2.2.1.1.1.m1.2.2.1.1.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.1.1.1.m1.2c">k,W_{t}</annotation></semantics></math></em>)</em><span id="algorithm2.2.2.3" class="ltx_text ltx_font_bold">:</span> 
</div>
<div id="algorithm2.10.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.5.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm2.3.3.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="algorithm2.3.3.m1.1a"><mi id="algorithm2.3.3.m1.1.1" xref="algorithm2.3.3.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m1.1b"><ci id="algorithm2.3.3.m1.1.1.cmml" xref="algorithm2.3.3.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m1.1c">\beta</annotation></semantics></math> <math id="algorithm2.4.4.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="algorithm2.4.4.m2.1a"><mo stretchy="false" id="algorithm2.4.4.m2.1.1" xref="algorithm2.4.4.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m2.1b"><ci id="algorithm2.4.4.m2.1.1.cmml" xref="algorithm2.4.4.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m2.1c">\leftarrow</annotation></semantics></math> (split <math id="algorithm2.5.5.m3.1" class="ltx_Math" alttext="D^{k}" display="inline"><semantics id="algorithm2.5.5.m3.1a"><msup id="algorithm2.5.5.m3.1.1" xref="algorithm2.5.5.m3.1.1.cmml"><mi id="algorithm2.5.5.m3.1.1.2" xref="algorithm2.5.5.m3.1.1.2.cmml">D</mi><mi id="algorithm2.5.5.m3.1.1.3" xref="algorithm2.5.5.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m3.1b"><apply id="algorithm2.5.5.m3.1.1.cmml" xref="algorithm2.5.5.m3.1.1"><csymbol cd="ambiguous" id="algorithm2.5.5.m3.1.1.1.cmml" xref="algorithm2.5.5.m3.1.1">superscript</csymbol><ci id="algorithm2.5.5.m3.1.1.2.cmml" xref="algorithm2.5.5.m3.1.1.2">𝐷</ci><ci id="algorithm2.5.5.m3.1.1.3.cmml" xref="algorithm2.5.5.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m3.1c">D^{k}</annotation></semantics></math> into mini batches)
</div>
<div id="algorithm2.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.6.6.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.6.6.1" class="ltx_emph ltx_font_italic"><math id="algorithm2.6.6.1.m1.2" class="ltx_Math" alttext="local~{}epoch~{}e_{i}\in 1,\dots e" display="inline"><semantics id="algorithm2.6.6.1.m1.2a"><mrow id="algorithm2.6.6.1.m1.2.2" xref="algorithm2.6.6.1.m1.2.2.cmml"><mrow id="algorithm2.6.6.1.m1.2.2.3" xref="algorithm2.6.6.1.m1.2.2.3.cmml"><mi id="algorithm2.6.6.1.m1.2.2.3.2" xref="algorithm2.6.6.1.m1.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.3" xref="algorithm2.6.6.1.m1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1a" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.4" xref="algorithm2.6.6.1.m1.2.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1b" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.5" xref="algorithm2.6.6.1.m1.2.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1c" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.6" xref="algorithm2.6.6.1.m1.2.2.3.6.cmml">l</mi><mo lspace="0.330em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1d" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.7" xref="algorithm2.6.6.1.m1.2.2.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1e" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.8" xref="algorithm2.6.6.1.m1.2.2.3.8.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1f" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.9" xref="algorithm2.6.6.1.m1.2.2.3.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1g" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.10" xref="algorithm2.6.6.1.m1.2.2.3.10.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1h" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.3.11" xref="algorithm2.6.6.1.m1.2.2.3.11.cmml">h</mi><mo lspace="0.330em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.3.1i" xref="algorithm2.6.6.1.m1.2.2.3.1.cmml">​</mo><msub id="algorithm2.6.6.1.m1.2.2.3.12" xref="algorithm2.6.6.1.m1.2.2.3.12.cmml"><mi id="algorithm2.6.6.1.m1.2.2.3.12.2" xref="algorithm2.6.6.1.m1.2.2.3.12.2.cmml">e</mi><mi id="algorithm2.6.6.1.m1.2.2.3.12.3" xref="algorithm2.6.6.1.m1.2.2.3.12.3.cmml">i</mi></msub></mrow><mo id="algorithm2.6.6.1.m1.2.2.2" xref="algorithm2.6.6.1.m1.2.2.2.cmml">∈</mo><mrow id="algorithm2.6.6.1.m1.2.2.1.1" xref="algorithm2.6.6.1.m1.2.2.1.2.cmml"><mn id="algorithm2.6.6.1.m1.1.1" xref="algorithm2.6.6.1.m1.1.1.cmml">1</mn><mo id="algorithm2.6.6.1.m1.2.2.1.1.2" xref="algorithm2.6.6.1.m1.2.2.1.2.cmml">,</mo><mrow id="algorithm2.6.6.1.m1.2.2.1.1.1" xref="algorithm2.6.6.1.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="algorithm2.6.6.1.m1.2.2.1.1.1.2" xref="algorithm2.6.6.1.m1.2.2.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.1.m1.2.2.1.1.1.1" xref="algorithm2.6.6.1.m1.2.2.1.1.1.1.cmml">​</mo><mi id="algorithm2.6.6.1.m1.2.2.1.1.1.3" xref="algorithm2.6.6.1.m1.2.2.1.1.1.3.cmml">e</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.1.m1.2b"><apply id="algorithm2.6.6.1.m1.2.2.cmml" xref="algorithm2.6.6.1.m1.2.2"><in id="algorithm2.6.6.1.m1.2.2.2.cmml" xref="algorithm2.6.6.1.m1.2.2.2"></in><apply id="algorithm2.6.6.1.m1.2.2.3.cmml" xref="algorithm2.6.6.1.m1.2.2.3"><times id="algorithm2.6.6.1.m1.2.2.3.1.cmml" xref="algorithm2.6.6.1.m1.2.2.3.1"></times><ci id="algorithm2.6.6.1.m1.2.2.3.2.cmml" xref="algorithm2.6.6.1.m1.2.2.3.2">𝑙</ci><ci id="algorithm2.6.6.1.m1.2.2.3.3.cmml" xref="algorithm2.6.6.1.m1.2.2.3.3">𝑜</ci><ci id="algorithm2.6.6.1.m1.2.2.3.4.cmml" xref="algorithm2.6.6.1.m1.2.2.3.4">𝑐</ci><ci id="algorithm2.6.6.1.m1.2.2.3.5.cmml" xref="algorithm2.6.6.1.m1.2.2.3.5">𝑎</ci><ci id="algorithm2.6.6.1.m1.2.2.3.6.cmml" xref="algorithm2.6.6.1.m1.2.2.3.6">𝑙</ci><ci id="algorithm2.6.6.1.m1.2.2.3.7.cmml" xref="algorithm2.6.6.1.m1.2.2.3.7">𝑒</ci><ci id="algorithm2.6.6.1.m1.2.2.3.8.cmml" xref="algorithm2.6.6.1.m1.2.2.3.8">𝑝</ci><ci id="algorithm2.6.6.1.m1.2.2.3.9.cmml" xref="algorithm2.6.6.1.m1.2.2.3.9">𝑜</ci><ci id="algorithm2.6.6.1.m1.2.2.3.10.cmml" xref="algorithm2.6.6.1.m1.2.2.3.10">𝑐</ci><ci id="algorithm2.6.6.1.m1.2.2.3.11.cmml" xref="algorithm2.6.6.1.m1.2.2.3.11">ℎ</ci><apply id="algorithm2.6.6.1.m1.2.2.3.12.cmml" xref="algorithm2.6.6.1.m1.2.2.3.12"><csymbol cd="ambiguous" id="algorithm2.6.6.1.m1.2.2.3.12.1.cmml" xref="algorithm2.6.6.1.m1.2.2.3.12">subscript</csymbol><ci id="algorithm2.6.6.1.m1.2.2.3.12.2.cmml" xref="algorithm2.6.6.1.m1.2.2.3.12.2">𝑒</ci><ci id="algorithm2.6.6.1.m1.2.2.3.12.3.cmml" xref="algorithm2.6.6.1.m1.2.2.3.12.3">𝑖</ci></apply></apply><list id="algorithm2.6.6.1.m1.2.2.1.2.cmml" xref="algorithm2.6.6.1.m1.2.2.1.1"><cn type="integer" id="algorithm2.6.6.1.m1.1.1.cmml" xref="algorithm2.6.6.1.m1.1.1">1</cn><apply id="algorithm2.6.6.1.m1.2.2.1.1.1.cmml" xref="algorithm2.6.6.1.m1.2.2.1.1.1"><times id="algorithm2.6.6.1.m1.2.2.1.1.1.1.cmml" xref="algorithm2.6.6.1.m1.2.2.1.1.1.1"></times><ci id="algorithm2.6.6.1.m1.2.2.1.1.1.2.cmml" xref="algorithm2.6.6.1.m1.2.2.1.1.1.2">…</ci><ci id="algorithm2.6.6.1.m1.2.2.1.1.1.3.cmml" xref="algorithm2.6.6.1.m1.2.2.1.1.1.3">𝑒</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.1.m1.2c">local~{}epoch~{}e_{i}\in 1,\dots e</annotation></semantics></math></em> <span id="algorithm2.6.6.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.8.8.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.8.8.2" class="ltx_emph ltx_font_italic">batch b <math id="algorithm2.7.7.1.m1.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="algorithm2.7.7.1.m1.1a"><mo id="algorithm2.7.7.1.m1.1.1" xref="algorithm2.7.7.1.m1.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.1.m1.1b"><in id="algorithm2.7.7.1.m1.1.1.cmml" xref="algorithm2.7.7.1.m1.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.1.m1.1c">\in</annotation></semantics></math> <math id="algorithm2.8.8.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="algorithm2.8.8.2.m2.1a"><mi id="algorithm2.8.8.2.m2.1.1" xref="algorithm2.8.8.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.2.m2.1b"><ci id="algorithm2.8.8.2.m2.1.1.cmml" xref="algorithm2.8.8.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.2.m2.1c">\beta</annotation></semantics></math></em> <span id="algorithm2.8.8.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.9.9.m1.2" class="ltx_Math" alttext="W_{t}\leftarrow W_{t}-\eta\nabla l(W_{t},b)" display="inline"><semantics id="algorithm2.9.9.m1.2a"><mrow id="algorithm2.9.9.m1.2.2" xref="algorithm2.9.9.m1.2.2.cmml"><msub id="algorithm2.9.9.m1.2.2.3" xref="algorithm2.9.9.m1.2.2.3.cmml"><mi id="algorithm2.9.9.m1.2.2.3.2" xref="algorithm2.9.9.m1.2.2.3.2.cmml">W</mi><mi id="algorithm2.9.9.m1.2.2.3.3" xref="algorithm2.9.9.m1.2.2.3.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm2.9.9.m1.2.2.2" xref="algorithm2.9.9.m1.2.2.2.cmml">←</mo><mrow id="algorithm2.9.9.m1.2.2.1" xref="algorithm2.9.9.m1.2.2.1.cmml"><msub id="algorithm2.9.9.m1.2.2.1.3" xref="algorithm2.9.9.m1.2.2.1.3.cmml"><mi id="algorithm2.9.9.m1.2.2.1.3.2" xref="algorithm2.9.9.m1.2.2.1.3.2.cmml">W</mi><mi id="algorithm2.9.9.m1.2.2.1.3.3" xref="algorithm2.9.9.m1.2.2.1.3.3.cmml">t</mi></msub><mo id="algorithm2.9.9.m1.2.2.1.2" xref="algorithm2.9.9.m1.2.2.1.2.cmml">−</mo><mrow id="algorithm2.9.9.m1.2.2.1.1" xref="algorithm2.9.9.m1.2.2.1.1.cmml"><mi id="algorithm2.9.9.m1.2.2.1.1.3" xref="algorithm2.9.9.m1.2.2.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm2.9.9.m1.2.2.1.1.2" xref="algorithm2.9.9.m1.2.2.1.1.2.cmml">​</mo><mrow id="algorithm2.9.9.m1.2.2.1.1.4" xref="algorithm2.9.9.m1.2.2.1.1.4.cmml"><mo rspace="0.167em" id="algorithm2.9.9.m1.2.2.1.1.4.1" xref="algorithm2.9.9.m1.2.2.1.1.4.1.cmml">∇</mo><mi id="algorithm2.9.9.m1.2.2.1.1.4.2" xref="algorithm2.9.9.m1.2.2.1.1.4.2.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="algorithm2.9.9.m1.2.2.1.1.2a" xref="algorithm2.9.9.m1.2.2.1.1.2.cmml">​</mo><mrow id="algorithm2.9.9.m1.2.2.1.1.1.1" xref="algorithm2.9.9.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="algorithm2.9.9.m1.2.2.1.1.1.1.2" xref="algorithm2.9.9.m1.2.2.1.1.1.2.cmml">(</mo><msub id="algorithm2.9.9.m1.2.2.1.1.1.1.1" xref="algorithm2.9.9.m1.2.2.1.1.1.1.1.cmml"><mi id="algorithm2.9.9.m1.2.2.1.1.1.1.1.2" xref="algorithm2.9.9.m1.2.2.1.1.1.1.1.2.cmml">W</mi><mi id="algorithm2.9.9.m1.2.2.1.1.1.1.1.3" xref="algorithm2.9.9.m1.2.2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="algorithm2.9.9.m1.2.2.1.1.1.1.3" xref="algorithm2.9.9.m1.2.2.1.1.1.2.cmml">,</mo><mi id="algorithm2.9.9.m1.1.1" xref="algorithm2.9.9.m1.1.1.cmml">b</mi><mo stretchy="false" id="algorithm2.9.9.m1.2.2.1.1.1.1.4" xref="algorithm2.9.9.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.m1.2b"><apply id="algorithm2.9.9.m1.2.2.cmml" xref="algorithm2.9.9.m1.2.2"><ci id="algorithm2.9.9.m1.2.2.2.cmml" xref="algorithm2.9.9.m1.2.2.2">←</ci><apply id="algorithm2.9.9.m1.2.2.3.cmml" xref="algorithm2.9.9.m1.2.2.3"><csymbol cd="ambiguous" id="algorithm2.9.9.m1.2.2.3.1.cmml" xref="algorithm2.9.9.m1.2.2.3">subscript</csymbol><ci id="algorithm2.9.9.m1.2.2.3.2.cmml" xref="algorithm2.9.9.m1.2.2.3.2">𝑊</ci><ci id="algorithm2.9.9.m1.2.2.3.3.cmml" xref="algorithm2.9.9.m1.2.2.3.3">𝑡</ci></apply><apply id="algorithm2.9.9.m1.2.2.1.cmml" xref="algorithm2.9.9.m1.2.2.1"><minus id="algorithm2.9.9.m1.2.2.1.2.cmml" xref="algorithm2.9.9.m1.2.2.1.2"></minus><apply id="algorithm2.9.9.m1.2.2.1.3.cmml" xref="algorithm2.9.9.m1.2.2.1.3"><csymbol cd="ambiguous" id="algorithm2.9.9.m1.2.2.1.3.1.cmml" xref="algorithm2.9.9.m1.2.2.1.3">subscript</csymbol><ci id="algorithm2.9.9.m1.2.2.1.3.2.cmml" xref="algorithm2.9.9.m1.2.2.1.3.2">𝑊</ci><ci id="algorithm2.9.9.m1.2.2.1.3.3.cmml" xref="algorithm2.9.9.m1.2.2.1.3.3">𝑡</ci></apply><apply id="algorithm2.9.9.m1.2.2.1.1.cmml" xref="algorithm2.9.9.m1.2.2.1.1"><times id="algorithm2.9.9.m1.2.2.1.1.2.cmml" xref="algorithm2.9.9.m1.2.2.1.1.2"></times><ci id="algorithm2.9.9.m1.2.2.1.1.3.cmml" xref="algorithm2.9.9.m1.2.2.1.1.3">𝜂</ci><apply id="algorithm2.9.9.m1.2.2.1.1.4.cmml" xref="algorithm2.9.9.m1.2.2.1.1.4"><ci id="algorithm2.9.9.m1.2.2.1.1.4.1.cmml" xref="algorithm2.9.9.m1.2.2.1.1.4.1">∇</ci><ci id="algorithm2.9.9.m1.2.2.1.1.4.2.cmml" xref="algorithm2.9.9.m1.2.2.1.1.4.2">𝑙</ci></apply><interval closure="open" id="algorithm2.9.9.m1.2.2.1.1.1.2.cmml" xref="algorithm2.9.9.m1.2.2.1.1.1.1"><apply id="algorithm2.9.9.m1.2.2.1.1.1.1.1.cmml" xref="algorithm2.9.9.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.9.9.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm2.9.9.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.9.9.m1.2.2.1.1.1.1.1.2.cmml" xref="algorithm2.9.9.m1.2.2.1.1.1.1.1.2">𝑊</ci><ci id="algorithm2.9.9.m1.2.2.1.1.1.1.1.3.cmml" xref="algorithm2.9.9.m1.2.2.1.1.1.1.1.3">𝑡</ci></apply><ci id="algorithm2.9.9.m1.1.1.cmml" xref="algorithm2.9.9.m1.1.1">𝑏</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.m1.2c">W_{t}\leftarrow W_{t}-\eta\nabla l(W_{t},b)</annotation></semantics></math>
</div>
<div id="algorithm2.10.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.10.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.10.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm2.10.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm2.10.10.2" class="ltx_text ltx_font_bold">return</span> <em id="algorithm2.10.10.1" class="ltx_emph ltx_font_italic"><math id="algorithm2.10.10.1.m1.1" class="ltx_Math" alttext="W_{t}" display="inline"><semantics id="algorithm2.10.10.1.m1.1a"><msub id="algorithm2.10.10.1.m1.1.1" xref="algorithm2.10.10.1.m1.1.1.cmml"><mi id="algorithm2.10.10.1.m1.1.1.2" xref="algorithm2.10.10.1.m1.1.1.2.cmml">W</mi><mi id="algorithm2.10.10.1.m1.1.1.3" xref="algorithm2.10.10.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.1.m1.1b"><apply id="algorithm2.10.10.1.m1.1.1.cmml" xref="algorithm2.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.10.10.1.m1.1.1.1.cmml" xref="algorithm2.10.10.1.m1.1.1">subscript</csymbol><ci id="algorithm2.10.10.1.m1.1.1.2.cmml" xref="algorithm2.10.10.1.m1.1.1.2">𝑊</ci><ci id="algorithm2.10.10.1.m1.1.1.3.cmml" xref="algorithm2.10.10.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.1.m1.1c">W_{t}</annotation></semantics></math></em>
</div>
<div id="algorithm2.10.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.10.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span> 
</div>
<div id="algorithm2.10.20" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm2.18.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>Local client update, <span id="algorithm2.19.2" class="ltx_text ltx_font_bold">k</span>: Number of clients, <math id="algorithm2.13.m1.1" class="ltx_Math" alttext="D^{k}" display="inline"><semantics id="algorithm2.13.m1.1b"><msup id="algorithm2.13.m1.1.1" xref="algorithm2.13.m1.1.1.cmml"><mi id="algorithm2.13.m1.1.1.2" xref="algorithm2.13.m1.1.1.2.cmml">D</mi><mi id="algorithm2.13.m1.1.1.3" xref="algorithm2.13.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm2.13.m1.1c"><apply id="algorithm2.13.m1.1.1.cmml" xref="algorithm2.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.13.m1.1.1.1.cmml" xref="algorithm2.13.m1.1.1">superscript</csymbol><ci id="algorithm2.13.m1.1.1.2.cmml" xref="algorithm2.13.m1.1.1.2">𝐷</ci><ci id="algorithm2.13.m1.1.1.3.cmml" xref="algorithm2.13.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.m1.1d">D^{k}</annotation></semantics></math>: Client k local dataset, <span id="algorithm2.20.3" class="ltx_text ltx_font_bold">e</span>: Number of local epochs, and <math id="algorithm2.14.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="algorithm2.14.m2.1b"><mi id="algorithm2.14.m2.1.1" xref="algorithm2.14.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="algorithm2.14.m2.1c"><ci id="algorithm2.14.m2.1.1.cmml" xref="algorithm2.14.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.m2.1d">\eta</annotation></semantics></math> is the learning rate. </figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Transformer architecture </h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.4" class="ltx_p"><span id="S3.SS3.p1.4.1" class="ltx_text ltx_font_bold">Encoder-Decoder</span>: In Fedbot we used the Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite> to handle client queries in customer support. A transformer is a model architecture eschewing recurrence and instead relying on an attention mechanism to draw global dependencies between input and output; the transformer follows the encoder and decoder architecture using stacked self-attention. The encoder maps an input sequence of symbol representations <math id="S3.SS3.p1.1.m1.3" class="ltx_Math" alttext="(x_{1},...,x_{n})" display="inline"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.3.2" xref="S3.SS3.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.2.3" xref="S3.SS3.p1.1.m1.3.3.3.cmml">(</mo><msub id="S3.SS3.p1.1.m1.2.2.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS3.p1.1.m1.2.2.1.1.2" xref="S3.SS3.p1.1.m1.2.2.1.1.2.cmml">x</mi><mn id="S3.SS3.p1.1.m1.2.2.1.1.3" xref="S3.SS3.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.1.m1.3.3.2.4" xref="S3.SS3.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p1.1.m1.3.3.2.5" xref="S3.SS3.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS3.p1.1.m1.3.3.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.cmml">x</mi><mi id="S3.SS3.p1.1.m1.3.3.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.2.6" xref="S3.SS3.p1.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><vector id="S3.SS3.p1.1.m1.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2"><apply id="S3.SS3.p1.1.m1.2.2.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.2">𝑥</ci><cn type="integer" id="S3.SS3.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">…</ci><apply id="S3.SS3.p1.1.m1.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">𝑥</ci><ci id="S3.SS3.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.3">𝑛</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">(x_{1},...,x_{n})</annotation></semantics></math> to a sequence of continuous representations <math id="S3.SS3.p1.2.m2.3" class="ltx_Math" alttext="z=(z_{1},...,z_{n})" display="inline"><semantics id="S3.SS3.p1.2.m2.3a"><mrow id="S3.SS3.p1.2.m2.3.3" xref="S3.SS3.p1.2.m2.3.3.cmml"><mi id="S3.SS3.p1.2.m2.3.3.4" xref="S3.SS3.p1.2.m2.3.3.4.cmml">z</mi><mo id="S3.SS3.p1.2.m2.3.3.3" xref="S3.SS3.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS3.p1.2.m2.3.3.2.2" xref="S3.SS3.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.3.3.2.2.3" xref="S3.SS3.p1.2.m2.3.3.2.3.cmml">(</mo><msub id="S3.SS3.p1.2.m2.2.2.1.1.1" xref="S3.SS3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.2.m2.2.2.1.1.1.2" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2.cmml">z</mi><mn id="S3.SS3.p1.2.m2.2.2.1.1.1.3" xref="S3.SS3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.2.m2.3.3.2.2.4" xref="S3.SS3.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p1.2.m2.3.3.2.2.5" xref="S3.SS3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS3.p1.2.m2.3.3.2.2.2" xref="S3.SS3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.2.m2.3.3.2.2.2.2" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2.cmml">z</mi><mi id="S3.SS3.p1.2.m2.3.3.2.2.2.3" xref="S3.SS3.p1.2.m2.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS3.p1.2.m2.3.3.2.2.6" xref="S3.SS3.p1.2.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.3b"><apply id="S3.SS3.p1.2.m2.3.3.cmml" xref="S3.SS3.p1.2.m2.3.3"><eq id="S3.SS3.p1.2.m2.3.3.3.cmml" xref="S3.SS3.p1.2.m2.3.3.3"></eq><ci id="S3.SS3.p1.2.m2.3.3.4.cmml" xref="S3.SS3.p1.2.m2.3.3.4">𝑧</ci><vector id="S3.SS3.p1.2.m2.3.3.2.3.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2"><apply id="S3.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2">𝑧</ci><cn type="integer" id="S3.SS3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">…</ci><apply id="S3.SS3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2">𝑧</ci><ci id="S3.SS3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.3c">z=(z_{1},...,z_{n})</annotation></semantics></math>. The Decoder then generates an output sequence <math id="S3.SS3.p1.3.m3.3" class="ltx_Math" alttext="(y_{1},...,y_{m})" display="inline"><semantics id="S3.SS3.p1.3.m3.3a"><mrow id="S3.SS3.p1.3.m3.3.3.2" xref="S3.SS3.p1.3.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.3.3.2.3" xref="S3.SS3.p1.3.m3.3.3.3.cmml">(</mo><msub id="S3.SS3.p1.3.m3.2.2.1.1" xref="S3.SS3.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS3.p1.3.m3.2.2.1.1.2" xref="S3.SS3.p1.3.m3.2.2.1.1.2.cmml">y</mi><mn id="S3.SS3.p1.3.m3.2.2.1.1.3" xref="S3.SS3.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.3.m3.3.3.2.4" xref="S3.SS3.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS3.p1.3.m3.3.3.2.5" xref="S3.SS3.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS3.p1.3.m3.3.3.2.2" xref="S3.SS3.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS3.p1.3.m3.3.3.2.2.2" xref="S3.SS3.p1.3.m3.3.3.2.2.2.cmml">y</mi><mi id="S3.SS3.p1.3.m3.3.3.2.2.3" xref="S3.SS3.p1.3.m3.3.3.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p1.3.m3.3.3.2.6" xref="S3.SS3.p1.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.3b"><vector id="S3.SS3.p1.3.m3.3.3.3.cmml" xref="S3.SS3.p1.3.m3.3.3.2"><apply id="S3.SS3.p1.3.m3.2.2.1.1.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.2">𝑦</ci><cn type="integer" id="S3.SS3.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS3.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">…</ci><apply id="S3.SS3.p1.3.m3.3.3.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.2">𝑦</ci><ci id="S3.SS3.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS3.p1.3.m3.3.3.2.2.3">𝑚</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.3c">(y_{1},...,y_{m})</annotation></semantics></math> of symbols one element at a time. Both the encoder (left-side) and decoder (right-side) are shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.3 Transformer architecture ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Both Encoder and Decoder are composed of layers and sub-layers that can be stacked on top of each other multiple times, which <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="Nx" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><times id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1"></times><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑁</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">Nx</annotation></semantics></math> describes in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.3 Transformer architecture ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The first is a multi-head self-attention mechanism, and the second is a simple, position-wise, fully connected feed-forward network. The inputs and outputs are first embedded into an n-dimensional space.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2304.03228/assets/figures/transformer.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="314" height="459" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> The Transformer model architecture <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite> - Adapting the transformer model to a Fedbot architecture for natural language processing, featuring an encoder-decoder architecture that generates responses to user inputs using self-attention and feed-forward neural networks</figcaption>
</figure>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.5" class="ltx_p"><span id="S3.SS3.p2.5.1" class="ltx_text ltx_font_bold">Attention layer</span>: The attention layer is a key component of the transformer model used in natural language processing tasks <cite class="ltx_cite ltx_citemacro_cite">Shen et al. (<a href="#bib.bib23" title="" class="ltx_ref">2018</a>); Parikh et al. (<a href="#bib.bib24" title="" class="ltx_ref">2016</a>)</cite>. The attention mechanism enables the model to selectively focus on the relevant parts of the input sequence, rather than treating all inputs equally. The attention layer consists of three sets of parameters - query (Q), key (K), and value (V) - that are learned during the training process. In this paper, by applying the self-attention mechanism, we aim at capturing the long dependencies in the input sentence following these steps:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">Obtain each word’s weight by calculating the similitude between the query matrix and every key matrix <math id="S3.I1.i1.p1.1.m1.3" class="ltx_Math" alttext="(Q,K,V)" display="inline"><semantics id="S3.I1.i1.p1.1.m1.3a"><mrow id="S3.I1.i1.p1.1.m1.3.4.2" xref="S3.I1.i1.p1.1.m1.3.4.1.cmml"><mo stretchy="false" id="S3.I1.i1.p1.1.m1.3.4.2.1" xref="S3.I1.i1.p1.1.m1.3.4.1.cmml">(</mo><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">Q</mi><mo id="S3.I1.i1.p1.1.m1.3.4.2.2" xref="S3.I1.i1.p1.1.m1.3.4.1.cmml">,</mo><mi id="S3.I1.i1.p1.1.m1.2.2" xref="S3.I1.i1.p1.1.m1.2.2.cmml">K</mi><mo id="S3.I1.i1.p1.1.m1.3.4.2.3" xref="S3.I1.i1.p1.1.m1.3.4.1.cmml">,</mo><mi id="S3.I1.i1.p1.1.m1.3.3" xref="S3.I1.i1.p1.1.m1.3.3.cmml">V</mi><mo stretchy="false" id="S3.I1.i1.p1.1.m1.3.4.2.4" xref="S3.I1.i1.p1.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.3b"><vector id="S3.I1.i1.p1.1.m1.3.4.1.cmml" xref="S3.I1.i1.p1.1.m1.3.4.2"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝑄</ci><ci id="S3.I1.i1.p1.1.m1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2">𝐾</ci><ci id="S3.I1.i1.p1.1.m1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.3.3">𝑉</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.3c">(Q,K,V)</annotation></semantics></math>. The dot product, concatenation, and perceptron are typically applied as similarity functions.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">Normalize the similitude score of the preceding step and compute the weights with the SoftMax function.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i3.p1.1" class="ltx_p">Finally, the weights and the <math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><mi id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><ci id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">V</annotation></semantics></math>-values matrix are weighted to get the final attention. Then, the dot product function is used to compute the similarity, and the attention is defined as follows:</p>
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle Attention(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d_{k}}})V" display="inline"><semantics id="S3.E1X.2.1.1.m1.4a"><mrow id="S3.E1X.2.1.1.m1.4.5" xref="S3.E1X.2.1.1.m1.4.5.cmml"><mrow id="S3.E1X.2.1.1.m1.4.5.2" xref="S3.E1X.2.1.1.m1.4.5.2.cmml"><mi id="S3.E1X.2.1.1.m1.4.5.2.2" xref="S3.E1X.2.1.1.m1.4.5.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.3" xref="S3.E1X.2.1.1.m1.4.5.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1a" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.4" xref="S3.E1X.2.1.1.m1.4.5.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1b" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.5" xref="S3.E1X.2.1.1.m1.4.5.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1c" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.6" xref="S3.E1X.2.1.1.m1.4.5.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1d" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.7" xref="S3.E1X.2.1.1.m1.4.5.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1e" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.8" xref="S3.E1X.2.1.1.m1.4.5.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1f" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.9" xref="S3.E1X.2.1.1.m1.4.5.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1g" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.2.10" xref="S3.E1X.2.1.1.m1.4.5.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.2.1h" xref="S3.E1X.2.1.1.m1.4.5.2.1.cmml">​</mo><mrow id="S3.E1X.2.1.1.m1.4.5.2.11.2" xref="S3.E1X.2.1.1.m1.4.5.2.11.1.cmml"><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.5.2.11.2.1" xref="S3.E1X.2.1.1.m1.4.5.2.11.1.cmml">(</mo><mi id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml">Q</mi><mo id="S3.E1X.2.1.1.m1.4.5.2.11.2.2" xref="S3.E1X.2.1.1.m1.4.5.2.11.1.cmml">,</mo><mi id="S3.E1X.2.1.1.m1.2.2" xref="S3.E1X.2.1.1.m1.2.2.cmml">K</mi><mo id="S3.E1X.2.1.1.m1.4.5.2.11.2.3" xref="S3.E1X.2.1.1.m1.4.5.2.11.1.cmml">,</mo><mi id="S3.E1X.2.1.1.m1.3.3" xref="S3.E1X.2.1.1.m1.3.3.cmml">V</mi><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.5.2.11.2.4" xref="S3.E1X.2.1.1.m1.4.5.2.11.1.cmml">)</mo></mrow></mrow><mo id="S3.E1X.2.1.1.m1.4.5.1" xref="S3.E1X.2.1.1.m1.4.5.1.cmml">=</mo><mrow id="S3.E1X.2.1.1.m1.4.5.3" xref="S3.E1X.2.1.1.m1.4.5.3.cmml"><mi id="S3.E1X.2.1.1.m1.4.5.3.2" xref="S3.E1X.2.1.1.m1.4.5.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.3.3" xref="S3.E1X.2.1.1.m1.4.5.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1a" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.3.4" xref="S3.E1X.2.1.1.m1.4.5.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1b" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.3.5" xref="S3.E1X.2.1.1.m1.4.5.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1c" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.3.6" xref="S3.E1X.2.1.1.m1.4.5.3.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1d" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.3.7" xref="S3.E1X.2.1.1.m1.4.5.3.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1e" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.3.8" xref="S3.E1X.2.1.1.m1.4.5.3.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1f" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mrow id="S3.E1X.2.1.1.m1.4.5.3.9.2" xref="S3.E1X.2.1.1.m1.4.4.cmml"><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.5.3.9.2.1" xref="S3.E1X.2.1.1.m1.4.4.cmml">(</mo><mstyle displaystyle="true" id="S3.E1X.2.1.1.m1.4.4" xref="S3.E1X.2.1.1.m1.4.4.cmml"><mfrac id="S3.E1X.2.1.1.m1.4.4a" xref="S3.E1X.2.1.1.m1.4.4.cmml"><mrow id="S3.E1X.2.1.1.m1.4.4.2" xref="S3.E1X.2.1.1.m1.4.4.2.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.2.2" xref="S3.E1X.2.1.1.m1.4.4.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.4.2.1" xref="S3.E1X.2.1.1.m1.4.4.2.1.cmml">​</mo><msup id="S3.E1X.2.1.1.m1.4.4.2.3" xref="S3.E1X.2.1.1.m1.4.4.2.3.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.2.3.2" xref="S3.E1X.2.1.1.m1.4.4.2.3.2.cmml">K</mi><mi id="S3.E1X.2.1.1.m1.4.4.2.3.3" xref="S3.E1X.2.1.1.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.E1X.2.1.1.m1.4.4.3" xref="S3.E1X.2.1.1.m1.4.4.3.cmml"><msub id="S3.E1X.2.1.1.m1.4.4.3.2" xref="S3.E1X.2.1.1.m1.4.4.3.2.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.3.2.2" xref="S3.E1X.2.1.1.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E1X.2.1.1.m1.4.4.3.2.3" xref="S3.E1X.2.1.1.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.5.3.9.2.2" xref="S3.E1X.2.1.1.m1.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.4.5.3.1g" xref="S3.E1X.2.1.1.m1.4.5.3.1.cmml">​</mo><mi id="S3.E1X.2.1.1.m1.4.5.3.10" xref="S3.E1X.2.1.1.m1.4.5.3.10.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.4b"><apply id="S3.E1X.2.1.1.m1.4.5.cmml" xref="S3.E1X.2.1.1.m1.4.5"><eq id="S3.E1X.2.1.1.m1.4.5.1.cmml" xref="S3.E1X.2.1.1.m1.4.5.1"></eq><apply id="S3.E1X.2.1.1.m1.4.5.2.cmml" xref="S3.E1X.2.1.1.m1.4.5.2"><times id="S3.E1X.2.1.1.m1.4.5.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.1"></times><ci id="S3.E1X.2.1.1.m1.4.5.2.2.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.2">𝐴</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.3.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.3">𝑡</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.4.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.4">𝑡</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.5.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.5">𝑒</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.6.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.6">𝑛</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.7.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.7">𝑡</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.8.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.8">𝑖</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.9.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.9">𝑜</ci><ci id="S3.E1X.2.1.1.m1.4.5.2.10.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.10">𝑛</ci><vector id="S3.E1X.2.1.1.m1.4.5.2.11.1.cmml" xref="S3.E1X.2.1.1.m1.4.5.2.11.2"><ci id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1">𝑄</ci><ci id="S3.E1X.2.1.1.m1.2.2.cmml" xref="S3.E1X.2.1.1.m1.2.2">𝐾</ci><ci id="S3.E1X.2.1.1.m1.3.3.cmml" xref="S3.E1X.2.1.1.m1.3.3">𝑉</ci></vector></apply><apply id="S3.E1X.2.1.1.m1.4.5.3.cmml" xref="S3.E1X.2.1.1.m1.4.5.3"><times id="S3.E1X.2.1.1.m1.4.5.3.1.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.1"></times><ci id="S3.E1X.2.1.1.m1.4.5.3.2.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.2">𝑠</ci><ci id="S3.E1X.2.1.1.m1.4.5.3.3.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.3">𝑜</ci><ci id="S3.E1X.2.1.1.m1.4.5.3.4.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.4">𝑓</ci><ci id="S3.E1X.2.1.1.m1.4.5.3.5.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.5">𝑡</ci><ci id="S3.E1X.2.1.1.m1.4.5.3.6.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.6">𝑚</ci><ci id="S3.E1X.2.1.1.m1.4.5.3.7.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.7">𝑎</ci><ci id="S3.E1X.2.1.1.m1.4.5.3.8.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.8">𝑥</ci><apply id="S3.E1X.2.1.1.m1.4.4.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.9.2"><divide id="S3.E1X.2.1.1.m1.4.4.1.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.9.2"></divide><apply id="S3.E1X.2.1.1.m1.4.4.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.2"><times id="S3.E1X.2.1.1.m1.4.4.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.2.1"></times><ci id="S3.E1X.2.1.1.m1.4.4.2.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.2.2">𝑄</ci><apply id="S3.E1X.2.1.1.m1.4.4.2.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.4.4.2.3.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.2.3">superscript</csymbol><ci id="S3.E1X.2.1.1.m1.4.4.2.3.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.2.3.2">𝐾</ci><ci id="S3.E1X.2.1.1.m1.4.4.2.3.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S3.E1X.2.1.1.m1.4.4.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.3"><root id="S3.E1X.2.1.1.m1.4.4.3a.cmml" xref="S3.E1X.2.1.1.m1.4.4.3"></root><apply id="S3.E1X.2.1.1.m1.4.4.3.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.4.4.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.3.2">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.4.4.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E1X.2.1.1.m1.4.4.3.2.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E1X.2.1.1.m1.4.5.3.10.cmml" xref="S3.E1X.2.1.1.m1.4.5.3.10">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.4c">\displaystyle Attention(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d_{k}}})V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p id="S3.SS3.p2.4" class="ltx_p">where <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="QK^{T}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">​</mo><msup id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">K</mi><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><times id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></times><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑄</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">𝐾</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">QK^{T}</annotation></semantics></math> represents the dot product between the query vector <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">Q</annotation></semantics></math> and the transpose of the key matrix <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">K</annotation></semantics></math>, and <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="{\sqrt{d_{k}}}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msqrt id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><msub id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.2.2.cmml">d</mi><mi id="S3.SS3.p2.4.m4.1.1.2.3" xref="S3.SS3.p2.4.m4.1.1.2.3.cmml">k</mi></msub></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><root id="S3.SS3.p2.4.m4.1.1a.cmml" xref="S3.SS3.p2.4.m4.1.1"></root><apply id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2.2">𝑑</ci><ci id="S3.SS3.p2.4.m4.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">{\sqrt{d_{k}}}</annotation></semantics></math> represents the square root of the dimensionality of the key vectors.
<br class="ltx_break"></p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.1" class="ltx_p">Multi-head Attention <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite> is a module for attention mechanisms that run through an attention mechanism several times in parallel. The independent attention outputs are then concatenated and linearly transformed into the expected dimension. The computation of Multi-head Attention proceeds as follows:</p>
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle Head_{i}=Attention(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V})" display="inline"><semantics id="S3.E2X.2.1.1.m1.3a"><mrow id="S3.E2X.2.1.1.m1.3.3" xref="S3.E2X.2.1.1.m1.3.3.cmml"><mrow id="S3.E2X.2.1.1.m1.3.3.5" xref="S3.E2X.2.1.1.m1.3.3.5.cmml"><mi id="S3.E2X.2.1.1.m1.3.3.5.2" xref="S3.E2X.2.1.1.m1.3.3.5.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.5.1" xref="S3.E2X.2.1.1.m1.3.3.5.1.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.5.3" xref="S3.E2X.2.1.1.m1.3.3.5.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.5.1a" xref="S3.E2X.2.1.1.m1.3.3.5.1.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.5.4" xref="S3.E2X.2.1.1.m1.3.3.5.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.5.1b" xref="S3.E2X.2.1.1.m1.3.3.5.1.cmml">​</mo><msub id="S3.E2X.2.1.1.m1.3.3.5.5" xref="S3.E2X.2.1.1.m1.3.3.5.5.cmml"><mi id="S3.E2X.2.1.1.m1.3.3.5.5.2" xref="S3.E2X.2.1.1.m1.3.3.5.5.2.cmml">d</mi><mi id="S3.E2X.2.1.1.m1.3.3.5.5.3" xref="S3.E2X.2.1.1.m1.3.3.5.5.3.cmml">i</mi></msub></mrow><mo id="S3.E2X.2.1.1.m1.3.3.4" xref="S3.E2X.2.1.1.m1.3.3.4.cmml">=</mo><mrow id="S3.E2X.2.1.1.m1.3.3.3" xref="S3.E2X.2.1.1.m1.3.3.3.cmml"><mi id="S3.E2X.2.1.1.m1.3.3.3.5" xref="S3.E2X.2.1.1.m1.3.3.3.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.6" xref="S3.E2X.2.1.1.m1.3.3.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4a" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.7" xref="S3.E2X.2.1.1.m1.3.3.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4b" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.8" xref="S3.E2X.2.1.1.m1.3.3.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4c" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.9" xref="S3.E2X.2.1.1.m1.3.3.3.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4d" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.10" xref="S3.E2X.2.1.1.m1.3.3.3.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4e" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.11" xref="S3.E2X.2.1.1.m1.3.3.3.11.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4f" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.12" xref="S3.E2X.2.1.1.m1.3.3.3.12.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4g" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.3.3.3.13" xref="S3.E2X.2.1.1.m1.3.3.3.13.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.4h" xref="S3.E2X.2.1.1.m1.3.3.3.4.cmml">​</mo><mrow id="S3.E2X.2.1.1.m1.3.3.3.3.3" xref="S3.E2X.2.1.1.m1.3.3.3.3.4.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.3.3.3.3.3.4" xref="S3.E2X.2.1.1.m1.3.3.3.3.4.cmml">(</mo><mrow id="S3.E2X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.2" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.3" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">Q</mi></msubsup></mrow><mo id="S3.E2X.2.1.1.m1.3.3.3.3.3.5" xref="S3.E2X.2.1.1.m1.3.3.3.3.4.cmml">,</mo><mrow id="S3.E2X.2.1.1.m1.2.2.2.2.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.1" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.1.cmml">​</mo><msubsup id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.2.cmml">W</mi><mi id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.3.cmml">i</mi><mi id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo id="S3.E2X.2.1.1.m1.3.3.3.3.3.6" xref="S3.E2X.2.1.1.m1.3.3.3.3.4.cmml">,</mo><mrow id="S3.E2X.2.1.1.m1.3.3.3.3.3.3" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.cmml"><mi id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.2" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.1" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.1.cmml">​</mo><msubsup id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.2" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.3" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.3.cmml">i</mi><mi id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.3" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo stretchy="false" id="S3.E2X.2.1.1.m1.3.3.3.3.3.7" xref="S3.E2X.2.1.1.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.3b"><apply id="S3.E2X.2.1.1.m1.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3"><eq id="S3.E2X.2.1.1.m1.3.3.4.cmml" xref="S3.E2X.2.1.1.m1.3.3.4"></eq><apply id="S3.E2X.2.1.1.m1.3.3.5.cmml" xref="S3.E2X.2.1.1.m1.3.3.5"><times id="S3.E2X.2.1.1.m1.3.3.5.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.1"></times><ci id="S3.E2X.2.1.1.m1.3.3.5.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.2">𝐻</ci><ci id="S3.E2X.2.1.1.m1.3.3.5.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.3">𝑒</ci><ci id="S3.E2X.2.1.1.m1.3.3.5.4.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.4">𝑎</ci><apply id="S3.E2X.2.1.1.m1.3.3.5.5.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.5"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.3.3.5.5.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.5">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.3.3.5.5.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.5.2">𝑑</ci><ci id="S3.E2X.2.1.1.m1.3.3.5.5.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.5.5.3">𝑖</ci></apply></apply><apply id="S3.E2X.2.1.1.m1.3.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.3"><times id="S3.E2X.2.1.1.m1.3.3.3.4.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.4"></times><ci id="S3.E2X.2.1.1.m1.3.3.3.5.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.5">𝐴</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.6.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.6">𝑡</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.7.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.7">𝑡</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.8.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.8">𝑒</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.9.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.9">𝑛</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.10.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.10">𝑡</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.11.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.11">𝑖</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.12.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.12">𝑜</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.13.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.13">𝑛</ci><vector id="S3.E2X.2.1.1.m1.3.3.3.3.4.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3"><apply id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1"><times id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1"></times><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.2">𝑄</ci><apply id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2"><times id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.1"></times><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.2">𝑊</ci><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3"><times id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.1"></times><ci id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.3.3.3.3.3.3">𝑉</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.3c">\displaystyle Head_{i}=Attention(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S3.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle MultiHead(H^{\prime})=(Head_{i}\oplus,...,\oplus Head_{h})" display="inline"><semantics id="S3.E2Xa.2.1.1.m1.4a"><mrow id="S3.E2Xa.2.1.1.m1.4.4" xref="S3.E2Xa.2.1.1.m1.4.4.cmml"><mrow id="S3.E2Xa.2.1.1.m1.2.2.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.2.2.1.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.4" xref="S3.E2Xa.2.1.1.m1.2.2.1.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2a" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.5" xref="S3.E2Xa.2.1.1.m1.2.2.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2b" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.6" xref="S3.E2Xa.2.1.1.m1.2.2.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2c" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.7" xref="S3.E2Xa.2.1.1.m1.2.2.1.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2d" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.8" xref="S3.E2Xa.2.1.1.m1.2.2.1.8.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2e" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.9" xref="S3.E2Xa.2.1.1.m1.2.2.1.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2f" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.10" xref="S3.E2Xa.2.1.1.m1.2.2.1.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2g" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.11" xref="S3.E2Xa.2.1.1.m1.2.2.1.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.2h" xref="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E2Xa.2.1.1.m1.2.2.1.1.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.cmml">(</mo><msup id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml">H</mi><mo id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.4.4.4" xref="S3.E2Xa.2.1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.3.2" xref="S3.E2Xa.2.1.1.m1.4.4.3.3.cmml"><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.4.4.3.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.3.3.cmml">(</mo><mrow id="S3.E2Xa.2.1.1.m1.3.3.2.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.cmml"><mrow id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.2" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.3" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1a" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.4" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1b" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1.cmml">​</mo><msub id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.2" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.2.cmml">d</mi><mi id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.3" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.3.cmml">i</mi></msub></mrow><mo rspace="0em" id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.3" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.3.cmml">⊕</mo></mrow><mo id="S3.E2Xa.2.1.1.m1.4.4.3.2.4" xref="S3.E2Xa.2.1.1.m1.4.4.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2Xa.2.1.1.m1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.cmml">…</mi><mo id="S3.E2Xa.2.1.1.m1.4.4.3.2.5" xref="S3.E2Xa.2.1.1.m1.4.4.3.3.cmml">,</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.3.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.cmml"><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.4.4.3.2.2a" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.cmml">⊕</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1a" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.4" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1b" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1.cmml">​</mo><msub id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.cmml"><mi id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.2" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.2.cmml">d</mi><mi id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.3" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.3.cmml">h</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.4.4.3.2.6" xref="S3.E2Xa.2.1.1.m1.4.4.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.4b"><apply id="S3.E2Xa.2.1.1.m1.4.4.cmml" xref="S3.E2Xa.2.1.1.m1.4.4"><eq id="S3.E2Xa.2.1.1.m1.4.4.4.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.4"></eq><apply id="S3.E2Xa.2.1.1.m1.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1"><times id="S3.E2Xa.2.1.1.m1.2.2.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.2"></times><ci id="S3.E2Xa.2.1.1.m1.2.2.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.3">𝑀</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.4.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.4">𝑢</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.5.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.5">𝑙</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.6.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.6">𝑡</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.7.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.7">𝑖</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.8.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.8">𝐻</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.9.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.9">𝑒</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.10.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.10">𝑎</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.11.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.11">𝑑</ci><apply id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2">𝐻</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.3">′</ci></apply></apply><vector id="S3.E2Xa.2.1.1.m1.4.4.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2"><apply id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1"><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1">limit-from</csymbol><apply id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2"><times id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.1"></times><ci id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.2">𝐻</ci><ci id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.3">𝑒</ci><ci id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.4.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.4">𝑎</ci><apply id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.2">𝑑</ci><ci id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.2.5.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.3.3.2.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.2.1.1.3">direct-sum</csymbol></apply><ci id="S3.E2Xa.2.1.1.m1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1">…</ci><apply id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2"><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2">direct-sum</csymbol><apply id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2"><times id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.1"></times><ci id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.2">𝐻</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.3">𝑒</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.4.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.4">𝑎</ci><apply id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.2">𝑑</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3.2.2.2.5.3">ℎ</ci></apply></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.4c">\displaystyle MultiHead(H^{\prime})=(Head_{i}\oplus,...,\oplus Head_{h})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.4" class="ltx_p">Where the projections are parameter matrices <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="W_{i}^{Q}\in R^{d_{model}d_{k}}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><msubsup id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2.2.2" xref="S3.SS3.p4.1.m1.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.p4.1.m1.1.1.2.2.3" xref="S3.SS3.p4.1.m1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS3.p4.1.m1.1.1.2.3" xref="S3.SS3.p4.1.m1.1.1.2.3.cmml">Q</mi></msubsup><mo id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml"><msub id="S3.SS3.p4.1.m1.1.1.3.3.2" xref="S3.SS3.p4.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.3.2.2" xref="S3.SS3.p4.1.m1.1.1.3.3.2.2.cmml">d</mi><mrow id="S3.SS3.p4.1.m1.1.1.3.3.2.3" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.3.2.3.2" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.3.3.2.3.1" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.3.3.2.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.3.3.2.3.1a" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.3.3.2.3.4" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.3.3.2.3.1b" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.3.3.2.3.5" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.3.3.2.3.1c" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.3.3.2.3.6" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.3.3.1" xref="S3.SS3.p4.1.m1.1.1.3.3.1.cmml">​</mo><msub id="S3.SS3.p4.1.m1.1.1.3.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.3.3.2" xref="S3.SS3.p4.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p4.1.m1.1.1.3.3.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><in id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"></in><apply id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.1.m1.1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.2.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2.2.2">𝑊</ci><ci id="S3.SS3.p4.1.m1.1.1.2.2.3.cmml" xref="S3.SS3.p4.1.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS3.p4.1.m1.1.1.2.3.cmml" xref="S3.SS3.p4.1.m1.1.1.2.3">𝑄</ci></apply><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">𝑅</ci><apply id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3"><times id="S3.SS3.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.1"></times><apply id="S3.SS3.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.2">𝑑</ci><apply id="S3.SS3.p4.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3"><times id="S3.SS3.p4.1.m1.1.1.3.3.2.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.1"></times><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.2">𝑚</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.3">𝑜</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.3.4.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.4">𝑑</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.3.5.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.5">𝑒</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.3.6.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S3.SS3.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">W_{i}^{Q}\in R^{d_{model}d_{k}}</annotation></semantics></math> and <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="W_{i}^{k}\in R^{d_{model}d_{k}}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mrow id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><msubsup id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2.2.2" xref="S3.SS3.p4.2.m2.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.p4.2.m2.1.1.2.2.3" xref="S3.SS3.p4.2.m2.1.1.2.2.3.cmml">i</mi><mi id="S3.SS3.p4.2.m2.1.1.2.3" xref="S3.SS3.p4.2.m2.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS3.p4.2.m2.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml"><msub id="S3.SS3.p4.2.m2.1.1.3.3.2" xref="S3.SS3.p4.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.3.2.2" xref="S3.SS3.p4.2.m2.1.1.3.3.2.2.cmml">d</mi><mrow id="S3.SS3.p4.2.m2.1.1.3.3.2.3" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.3.2.3.2" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.3.2.3.1" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3.2.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.3.2.3.1a" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3.2.3.4" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.3.2.3.1b" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3.2.3.5" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.3.2.3.1c" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3.2.3.6" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.3.3.1" xref="S3.SS3.p4.2.m2.1.1.3.3.1.cmml">​</mo><msub id="S3.SS3.p4.2.m2.1.1.3.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.3.3.2" xref="S3.SS3.p4.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p4.2.m2.1.1.3.3.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><in id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1"></in><apply id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.2.m2.1.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.2.2.1.cmml" xref="S3.SS3.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.2.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2.2.2">𝑊</ci><ci id="S3.SS3.p4.2.m2.1.1.2.2.3.cmml" xref="S3.SS3.p4.2.m2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS3.p4.2.m2.1.1.2.3.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">𝑅</ci><apply id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3"><times id="S3.SS3.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.1"></times><apply id="S3.SS3.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.2">𝑑</ci><apply id="S3.SS3.p4.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3"><times id="S3.SS3.p4.2.m2.1.1.3.3.2.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.1"></times><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.2">𝑚</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.3">𝑜</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.3.4.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.4">𝑑</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.3.5.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.5">𝑒</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.3.6.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S3.SS3.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">W_{i}^{k}\in R^{d_{model}d_{k}}</annotation></semantics></math> and <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="W_{i}^{V}\in R^{d_{model}d_{k}}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mrow id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><msubsup id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2.2.2" xref="S3.SS3.p4.3.m3.1.1.2.2.2.cmml">W</mi><mi id="S3.SS3.p4.3.m3.1.1.2.2.3" xref="S3.SS3.p4.3.m3.1.1.2.2.3.cmml">i</mi><mi id="S3.SS3.p4.3.m3.1.1.2.3" xref="S3.SS3.p4.3.m3.1.1.2.3.cmml">V</mi></msubsup><mo id="S3.SS3.p4.3.m3.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.2" xref="S3.SS3.p4.3.m3.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p4.3.m3.1.1.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.cmml"><msub id="S3.SS3.p4.3.m3.1.1.3.3.2" xref="S3.SS3.p4.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.2" xref="S3.SS3.p4.3.m3.1.1.3.3.2.2.cmml">d</mi><mrow id="S3.SS3.p4.3.m3.1.1.3.3.2.3" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.3.2" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.3.3.2.3.1" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.3.3.2.3.1a" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.3.4" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.3.3.2.3.1b" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.3.5" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.3.3.2.3.1c" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.3.m3.1.1.3.3.2.3.6" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.3.m3.1.1.3.3.1" xref="S3.SS3.p4.3.m3.1.1.3.3.1.cmml">​</mo><msub id="S3.SS3.p4.3.m3.1.1.3.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.3.3.2" xref="S3.SS3.p4.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p4.3.m3.1.1.3.3.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><in id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1"></in><apply id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS3.p4.3.m3.1.1.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.2.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.2.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2.2.2">𝑊</ci><ci id="S3.SS3.p4.3.m3.1.1.2.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS3.p4.3.m3.1.1.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.2.3">𝑉</ci></apply><apply id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.2">𝑅</ci><apply id="S3.SS3.p4.3.m3.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3"><times id="S3.SS3.p4.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.1"></times><apply id="S3.SS3.p4.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.2">𝑑</ci><apply id="S3.SS3.p4.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3"><times id="S3.SS3.p4.3.m3.1.1.3.3.2.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.1"></times><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.2">𝑚</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.3">𝑜</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.3.4.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.4">𝑑</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.3.5.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.5">𝑒</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.2.3.6.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S3.SS3.p4.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">W_{i}^{V}\in R^{d_{model}d_{k}}</annotation></semantics></math> and <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="W_{0}=R^{(hd_{v}d_{model})}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.2" xref="S3.SS3.p4.4.m4.1.2.cmml"><msub id="S3.SS3.p4.4.m4.1.2.2" xref="S3.SS3.p4.4.m4.1.2.2.cmml"><mi id="S3.SS3.p4.4.m4.1.2.2.2" xref="S3.SS3.p4.4.m4.1.2.2.2.cmml">W</mi><mn id="S3.SS3.p4.4.m4.1.2.2.3" xref="S3.SS3.p4.4.m4.1.2.2.3.cmml">0</mn></msub><mo id="S3.SS3.p4.4.m4.1.2.1" xref="S3.SS3.p4.4.m4.1.2.1.cmml">=</mo><msup id="S3.SS3.p4.4.m4.1.2.3" xref="S3.SS3.p4.4.m4.1.2.3.cmml"><mi id="S3.SS3.p4.4.m4.1.2.3.2" xref="S3.SS3.p4.4.m4.1.2.3.2.cmml">R</mi><mrow id="S3.SS3.p4.4.m4.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p4.4.m4.1.1.1.1.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p4.4.m4.1.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml">​</mo><msub id="S3.SS3.p4.4.m4.1.1.1.1.1.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.3.2.cmml">d</mi><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.3.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.1a" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml">​</mo><msub id="S3.SS3.p4.4.m4.1.1.1.1.1.4" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.cmml"><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.4.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.2.cmml">d</mi><mrow id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.2" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1a" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.4" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1b" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.5" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1c" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.6" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS3.p4.4.m4.1.1.1.1.3" xref="S3.SS3.p4.4.m4.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.2.cmml" xref="S3.SS3.p4.4.m4.1.2"><eq id="S3.SS3.p4.4.m4.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2.1"></eq><apply id="S3.SS3.p4.4.m4.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.2.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.2.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2.2.2">𝑊</ci><cn type="integer" id="S3.SS3.p4.4.m4.1.2.2.3.cmml" xref="S3.SS3.p4.4.m4.1.2.2.3">0</cn></apply><apply id="S3.SS3.p4.4.m4.1.2.3.cmml" xref="S3.SS3.p4.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.2.3.1.cmml" xref="S3.SS3.p4.4.m4.1.2.3">superscript</csymbol><ci id="S3.SS3.p4.4.m4.1.2.3.2.cmml" xref="S3.SS3.p4.4.m4.1.2.3.2">𝑅</ci><apply id="S3.SS3.p4.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1"><times id="S3.SS3.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.1"></times><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.2">ℎ</ci><apply id="S3.SS3.p4.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.3.3">𝑣</ci></apply><apply id="S3.SS3.p4.4.m4.1.1.1.1.1.4.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.1.1.4.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.4.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.2">𝑑</ci><apply id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3"><times id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.1"></times><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.2">𝑚</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.3">𝑜</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.4.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.4">𝑑</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.5.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.5">𝑒</ci><ci id="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.6.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1.1.4.3.6">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">W_{0}=R^{(hd_{v}d_{model})}</annotation></semantics></math>.</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Datasets</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">To train the transformer model, we processed customer support on the Twitter dataset <span id="footnote7" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>https://www.kaggle.com/thoughtvector/customer-support-on-twitter/data</span></span></span> which is a large, modern corpus of tweets and replies to aid innovation in natural language understanding and conversational AI models. The dataset is a CSV file, where each row is a tweet; every conversation included has at least one request from a consumer and at least one response from a company support team. The dataset consists of conversation support for many companies, among them Apple, Amazon, Uber, Delta, Spotify, Tesco, AmericanAir and Spotify (see Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3.1 Datasets ‣ 3.3 Transformer architecture ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
In this paper, we used these datasets as private data and processed them to be used to train a transformer model collaboratively in federated learning settings.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2304.03228/assets/figures/dataset.png" id="S3.F3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="350" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The Customer Support on the Twitter dataset is a large, modern corpus of tweets and replies to aid innovation in natural language understanding. In our Fedbot, each company dataset is considered to be a client in a cross-silo federation that trains a transformer model locally and sends model parameters to a central server for aggregation.</figcaption>
</figure>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Information Retrieval (IR)</h3>

<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.1" class="ltx_p">With the rapid progress of the semantic web, a huge amount of structured data has become available on the web (web of data). Making these resources available and useful for end-users is one of the main objectives of linked data <cite class="ltx_cite ltx_citemacro_cite">Berners-Lee (<a href="#bib.bib25" title="" class="ltx_ref">2009</a>)</cite> and open-domain chatbots. Hence, using IR techniques to access knowledge and enrich user conversations can be very useful to strengthen the Fedbot performances through SPARQL queries on the top of the known knowledge base (DBpedia, Wikidata, etc.). Fedbot uses Named Entity Recognition (NER) and user intent to generate SPARQL queries regarding factoid and recurrent questions to enrich and improve the chatbot’s performance.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Incremental learning and Feedback</h3>

<div id="S3.SS5.p1" class="ltx_para ltx_noindent">
<p id="S3.SS5.p1.1" class="ltx_p">In incremental learning, new input data is continuously used to train the model further. A goal is to attempt to improve a model’s performance while adding as few samples as possible. In Fedbot, adding data locally by clients is an important task to improve the local model performance, which is then propagated into the global model after new global training rounds. We have developed an intuitive process for each local client to contribute to the addition of new samples on top of their baseline local data (Figure <a href="#S3.F4" title="Figure 4 ‣ 3.5 Incremental learning and Feedback ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The first step is to add a new data point that will remain on the local site, allowing users to add private training data. The incremental learning module will process and transform the private data locally and generate training points usable for local model training. This process enables collaborative data generation between organizations while activating data protection and avoiding necessary sharing within the alliance. Furthermore, FedBot utilizes a database layer to store feedback and queries from end users. These inputs are collectively analyzed to enhance and optimize future usage. Additionally, numerous modules and libraries can be readily incorporated with FedBot to broaden its functionalities and effectively handle various tasks.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2304.03228/assets/figures/incremental-learning.png" id="S3.F4.g1" class="ltx_graphics ltx_img_landscape" width="314" height="185" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Clients can continuously add local private training data to extend the existing model’s knowledge by additional training of the global model. The generated data will be stored locally on the client side. <math id="S3.F4.7.m1.1" class="ltx_Math" alttext="M_{t}" display="inline"><semantics id="S3.F4.7.m1.1b"><msub id="S3.F4.7.m1.1.1" xref="S3.F4.7.m1.1.1.cmml"><mi id="S3.F4.7.m1.1.1.2" xref="S3.F4.7.m1.1.1.2.cmml">M</mi><mi id="S3.F4.7.m1.1.1.3" xref="S3.F4.7.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.7.m1.1c"><apply id="S3.F4.7.m1.1.1.cmml" xref="S3.F4.7.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.7.m1.1.1.1.cmml" xref="S3.F4.7.m1.1.1">subscript</csymbol><ci id="S3.F4.7.m1.1.1.2.cmml" xref="S3.F4.7.m1.1.1.2">𝑀</ci><ci id="S3.F4.7.m1.1.1.3.cmml" xref="S3.F4.7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.7.m1.1d">M_{t}</annotation></semantics></math> represents the global model. <math id="S3.F4.8.m2.1" class="ltx_Math" alttext="X_{t}" display="inline"><semantics id="S3.F4.8.m2.1b"><msub id="S3.F4.8.m2.1.1" xref="S3.F4.8.m2.1.1.cmml"><mi id="S3.F4.8.m2.1.1.2" xref="S3.F4.8.m2.1.1.2.cmml">X</mi><mi id="S3.F4.8.m2.1.1.3" xref="S3.F4.8.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.8.m2.1c"><apply id="S3.F4.8.m2.1.1.cmml" xref="S3.F4.8.m2.1.1"><csymbol cd="ambiguous" id="S3.F4.8.m2.1.1.1.cmml" xref="S3.F4.8.m2.1.1">subscript</csymbol><ci id="S3.F4.8.m2.1.1.2.cmml" xref="S3.F4.8.m2.1.1.2">𝑋</ci><ci id="S3.F4.8.m2.1.1.3.cmml" xref="S3.F4.8.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.8.m2.1d">X_{t}</annotation></semantics></math> represents the subset of data at time <math id="S3.F4.9.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.F4.9.m3.1b"><mi id="S3.F4.9.m3.1.1" xref="S3.F4.9.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.F4.9.m3.1c"><ci id="S3.F4.9.m3.1.1.cmml" xref="S3.F4.9.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.9.m3.1d">t</annotation></semantics></math>. <math id="S3.F4.10.m4.1" class="ltx_Math" alttext="G_{t}" display="inline"><semantics id="S3.F4.10.m4.1b"><msub id="S3.F4.10.m4.1.1" xref="S3.F4.10.m4.1.1.cmml"><mi id="S3.F4.10.m4.1.1.2" xref="S3.F4.10.m4.1.1.2.cmml">G</mi><mi id="S3.F4.10.m4.1.1.3" xref="S3.F4.10.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.10.m4.1c"><apply id="S3.F4.10.m4.1.1.cmml" xref="S3.F4.10.m4.1.1"><csymbol cd="ambiguous" id="S3.F4.10.m4.1.1.1.cmml" xref="S3.F4.10.m4.1.1">subscript</csymbol><ci id="S3.F4.10.m4.1.1.2.cmml" xref="S3.F4.10.m4.1.1.2">𝐺</ci><ci id="S3.F4.10.m4.1.1.3.cmml" xref="S3.F4.10.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.10.m4.1d">G_{t}</annotation></semantics></math> represents the generator at time <math id="S3.F4.11.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.F4.11.m5.1b"><mi id="S3.F4.11.m5.1.1" xref="S3.F4.11.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.F4.11.m5.1c"><ci id="S3.F4.11.m5.1.1.cmml" xref="S3.F4.11.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.11.m5.1d">t</annotation></semantics></math>, and <math id="S3.F4.12.m6.1" class="ltx_Math" alttext="X_{t}^{P}" display="inline"><semantics id="S3.F4.12.m6.1b"><msubsup id="S3.F4.12.m6.1.1" xref="S3.F4.12.m6.1.1.cmml"><mi id="S3.F4.12.m6.1.1.2.2" xref="S3.F4.12.m6.1.1.2.2.cmml">X</mi><mi id="S3.F4.12.m6.1.1.2.3" xref="S3.F4.12.m6.1.1.2.3.cmml">t</mi><mi id="S3.F4.12.m6.1.1.3" xref="S3.F4.12.m6.1.1.3.cmml">P</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F4.12.m6.1c"><apply id="S3.F4.12.m6.1.1.cmml" xref="S3.F4.12.m6.1.1"><csymbol cd="ambiguous" id="S3.F4.12.m6.1.1.1.cmml" xref="S3.F4.12.m6.1.1">superscript</csymbol><apply id="S3.F4.12.m6.1.1.2.cmml" xref="S3.F4.12.m6.1.1"><csymbol cd="ambiguous" id="S3.F4.12.m6.1.1.2.1.cmml" xref="S3.F4.12.m6.1.1">subscript</csymbol><ci id="S3.F4.12.m6.1.1.2.2.cmml" xref="S3.F4.12.m6.1.1.2.2">𝑋</ci><ci id="S3.F4.12.m6.1.1.2.3.cmml" xref="S3.F4.12.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.F4.12.m6.1.1.3.cmml" xref="S3.F4.12.m6.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.12.m6.1d">X_{t}^{P}</annotation></semantics></math> is a subset generated by it.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment and results</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">We conduct the experiment on the customer support dataset, which contains 550.287 question-answer pairs on 11 datasets from different companies (Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3.1 Datasets ‣ 3.3 Transformer architecture ‣ 3 Proposed approach ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). To ensure collaborative training, we randomly select and split data through 10 clients with 20% for the validation dataset for all clients. We used an encoder and decoder to build our transformer model, and the implementation is based on TensorFlow and FEDn. For the training process, we set the initial learning rate to 0.001, the batch size to 32 and the maximum number of epochs to 10. Texts are tokenized using Wordpieces <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib26" title="" class="ltx_ref">2016</a>)</cite> with a maximum length of 30. More configuration is shown in Table <a href="#S4.T1" title="Table 1 ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The hyper-parameters used in this model are shown in Table <a href="#S4.T2" title="Table 2 ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Federated training configuration</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Rounds</th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Nbr clients</th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Update size</th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Nbr of parameters</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">30</th>
<th id="S4.T1.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">10</th>
<td id="S4.T1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">72 MB</td>
<td id="S4.T1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">19.639.619</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span> Order in which different hyper-parameters are explored and the corresponding values considered
for each hyper-parameter. Underlined values indicate the default value.</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Step</th>
<th id="S4.T2.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Hyper-parameter</th>
<th id="S4.T2.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Values</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<td id="S4.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">1</td>
<td id="S4.T2.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">embedding dimension</td>
<td id="S4.T2.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">256, 512, 1024</td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<td id="S4.T2.1.3.2.1" class="ltx_td ltx_align_left">2</td>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_left">attention heads</td>
<td id="S4.T2.1.3.2.3" class="ltx_td ltx_align_left">1, 2, 4, <span id="S4.T2.1.3.2.3.1" class="ltx_text ltx_framed ltx_framed_underline">8</span>, 16</td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<td id="S4.T2.1.4.3.1" class="ltx_td ltx_align_left">3</td>
<td id="S4.T2.1.4.3.2" class="ltx_td ltx_align_left">dropout</td>
<td id="S4.T2.1.4.3.3" class="ltx_td ltx_align_left">0.1, <span id="S4.T2.1.4.3.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.2</span>, 0.3, 0.4, 0.5</td>
</tr>
<tr id="S4.T2.1.5.4" class="ltx_tr">
<td id="S4.T2.1.5.4.1" class="ltx_td ltx_align_left">4</td>
<td id="S4.T2.1.5.4.2" class="ltx_td ltx_align_left">number of layers</td>
<td id="S4.T2.1.5.4.3" class="ltx_td ltx_align_left">1, 2, 3, <span id="S4.T2.1.5.4.3.1" class="ltx_text ltx_framed ltx_framed_underline">4</span>, 5, 6, 7, 8</td>
</tr>
<tr id="S4.T2.1.6.5" class="ltx_tr">
<td id="S4.T2.1.6.5.1" class="ltx_td ltx_align_left">5</td>
<td id="S4.T2.1.6.5.2" class="ltx_td ltx_align_left">number of units</td>
<td id="S4.T2.1.6.5.3" class="ltx_td ltx_align_left">128, 256, <span id="S4.T2.1.6.5.3.1" class="ltx_text ltx_framed ltx_framed_underline">512</span>
</td>
</tr>
<tr id="S4.T2.1.7.6" class="ltx_tr">
<td id="S4.T2.1.7.6.1" class="ltx_td ltx_align_left">6</td>
<td id="S4.T2.1.7.6.2" class="ltx_td ltx_align_left">enc/dec layer dropout</td>
<td id="S4.T2.1.7.6.3" class="ltx_td ltx_align_left">0, 0.1, <span id="S4.T2.1.7.6.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.2</span>, 0.3, 0.4</td>
</tr>
<tr id="S4.T2.1.8.7" class="ltx_tr">
<td id="S4.T2.1.8.7.1" class="ltx_td ltx_align_left">7</td>
<td id="S4.T2.1.8.7.2" class="ltx_td ltx_align_left">attention dropout</td>
<td id="S4.T2.1.8.7.3" class="ltx_td ltx_align_left">0, 0.1, <span id="S4.T2.1.8.7.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.2</span>, 0.3</td>
</tr>
<tr id="S4.T2.1.9.8" class="ltx_tr">
<td id="S4.T2.1.9.8.1" class="ltx_td ltx_align_left">8</td>
<td id="S4.T2.1.9.8.2" class="ltx_td ltx_align_left">activation dropout</td>
<td id="S4.T2.1.9.8.3" class="ltx_td ltx_align_left">0, 0.1, <span id="S4.T2.1.9.8.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.2</span>, 0.3, 0.4, 0.5</td>
</tr>
<tr id="S4.T2.1.10.9" class="ltx_tr">
<td id="S4.T2.1.10.9.1" class="ltx_td ltx_align_left">9</td>
<td id="S4.T2.1.10.9.2" class="ltx_td ltx_align_left">batch size</td>
<td id="S4.T2.1.10.9.3" class="ltx_td ltx_align_left">8, <span id="S4.T2.1.10.9.3.1" class="ltx_text ltx_framed ltx_framed_underline">32</span>, 64</td>
</tr>
<tr id="S4.T2.1.11.10" class="ltx_tr">
<td id="S4.T2.1.11.10.1" class="ltx_td ltx_align_left">10</td>
<td id="S4.T2.1.11.10.2" class="ltx_td ltx_align_left">learning rate scheduler</td>
<td id="S4.T2.1.11.10.3" class="ltx_td ltx_align_left">
<span id="S4.T2.1.11.10.3.1" class="ltx_text ltx_framed ltx_framed_underline">Transformer standard</span>, inverse square root</td>
</tr>
<tr id="S4.T2.1.12.11" class="ltx_tr">
<td id="S4.T2.1.12.11.1" class="ltx_td ltx_align_left">11</td>
<td id="S4.T2.1.12.11.2" class="ltx_td ltx_align_left">warm-up steps</td>
<td id="S4.T2.1.12.11.3" class="ltx_td ltx_align_left">2000, <span id="S4.T2.1.12.11.3.1" class="ltx_text ltx_framed ltx_framed_underline">4000</span>, 5000, 6000, 8000, 10000</td>
</tr>
<tr id="S4.T2.1.13.12" class="ltx_tr">
<td id="S4.T2.1.13.12.1" class="ltx_td ltx_align_left">12</td>
<td id="S4.T2.1.13.12.2" class="ltx_td ltx_align_left">learning rate</td>
<td id="S4.T2.1.13.12.3" class="ltx_td ltx_align_left">0.01, <span id="S4.T2.1.13.12.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.001</span>, 0.0001, 0.00001</td>
</tr>
<tr id="S4.T2.1.14.13" class="ltx_tr">
<td id="S4.T2.1.14.13.1" class="ltx_td ltx_align_left">13</td>
<td id="S4.T2.1.14.13.2" class="ltx_td ltx_align_left">epochs</td>
<td id="S4.T2.1.14.13.3" class="ltx_td ltx_align_left">5, <span id="S4.T2.1.14.13.3.1" class="ltx_text ltx_framed ltx_framed_underline">10</span>, 15, 20, 25</td>
</tr>
<tr id="S4.T2.1.15.14" class="ltx_tr">
<td id="S4.T2.1.15.14.1" class="ltx_td ltx_align_left">14</td>
<td id="S4.T2.1.15.14.2" class="ltx_td ltx_align_left">maxlen</td>
<td id="S4.T2.1.15.14.3" class="ltx_td ltx_align_left">15, 20, 25, <span id="S4.T2.1.15.14.3.1" class="ltx_text ltx_framed ltx_framed_underline">30</span>
</td>
</tr>
<tr id="S4.T2.1.16.15" class="ltx_tr">
<td id="S4.T2.1.16.15.1" class="ltx_td ltx_align_left ltx_border_b">15</td>
<td id="S4.T2.1.16.15.2" class="ltx_td ltx_align_left ltx_border_b">activation function</td>
<td id="S4.T2.1.16.15.3" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T2.1.16.15.3.1" class="ltx_text ltx_framed ltx_framed_underline">relu</span></td>
</tr>
</tbody>
</table>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Evaluation</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">To evaluate the performance of Fedbot, we used accuracy and loss metrics. We then evaluated performance using the accuracy function provided by Tensorflow that falls between (0, 100), shown in Equation <a href="#S4.E3" title="In 4.1 Evaluation ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, and the categorical cross-entropy as a loss function, shown in Equation <a href="#S4.E4" title="In 4.1 Evaluation ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="Accuracy=\frac{TP+TN}{TP+TN+FN+FP}*100\%" display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><mrow id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.2.2" xref="S4.E3.m1.1.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.2.1" xref="S4.E3.m1.1.1.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.2.3" xref="S4.E3.m1.1.1.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.2.1a" xref="S4.E3.m1.1.1.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.2.4" xref="S4.E3.m1.1.1.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.2.1b" xref="S4.E3.m1.1.1.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.2.5" xref="S4.E3.m1.1.1.2.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.2.1c" xref="S4.E3.m1.1.1.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.2.6" xref="S4.E3.m1.1.1.2.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.2.1d" xref="S4.E3.m1.1.1.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.2.7" xref="S4.E3.m1.1.1.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.2.1e" xref="S4.E3.m1.1.1.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.2.8" xref="S4.E3.m1.1.1.2.8.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.2.1f" xref="S4.E3.m1.1.1.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.2.9" xref="S4.E3.m1.1.1.2.9.cmml">y</mi></mrow><mo id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml"><mfrac id="S4.E3.m1.1.1.3.2" xref="S4.E3.m1.1.1.3.2.cmml"><mrow id="S4.E3.m1.1.1.3.2.2" xref="S4.E3.m1.1.1.3.2.2.cmml"><mrow id="S4.E3.m1.1.1.3.2.2.2" xref="S4.E3.m1.1.1.3.2.2.2.cmml"><mi id="S4.E3.m1.1.1.3.2.2.2.2" xref="S4.E3.m1.1.1.3.2.2.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.2.2.2.1" xref="S4.E3.m1.1.1.3.2.2.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.2.2.2.3" xref="S4.E3.m1.1.1.3.2.2.2.3.cmml">P</mi></mrow><mo id="S4.E3.m1.1.1.3.2.2.1" xref="S4.E3.m1.1.1.3.2.2.1.cmml">+</mo><mrow id="S4.E3.m1.1.1.3.2.2.3" xref="S4.E3.m1.1.1.3.2.2.3.cmml"><mi id="S4.E3.m1.1.1.3.2.2.3.2" xref="S4.E3.m1.1.1.3.2.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.2.2.3.1" xref="S4.E3.m1.1.1.3.2.2.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.2.2.3.3" xref="S4.E3.m1.1.1.3.2.2.3.3.cmml">N</mi></mrow></mrow><mrow id="S4.E3.m1.1.1.3.2.3" xref="S4.E3.m1.1.1.3.2.3.cmml"><mrow id="S4.E3.m1.1.1.3.2.3.2" xref="S4.E3.m1.1.1.3.2.3.2.cmml"><mi id="S4.E3.m1.1.1.3.2.3.2.2" xref="S4.E3.m1.1.1.3.2.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.2.3.2.1" xref="S4.E3.m1.1.1.3.2.3.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.2.3.2.3" xref="S4.E3.m1.1.1.3.2.3.2.3.cmml">P</mi></mrow><mo id="S4.E3.m1.1.1.3.2.3.1" xref="S4.E3.m1.1.1.3.2.3.1.cmml">+</mo><mrow id="S4.E3.m1.1.1.3.2.3.3" xref="S4.E3.m1.1.1.3.2.3.3.cmml"><mi id="S4.E3.m1.1.1.3.2.3.3.2" xref="S4.E3.m1.1.1.3.2.3.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.2.3.3.1" xref="S4.E3.m1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.2.3.3.3" xref="S4.E3.m1.1.1.3.2.3.3.3.cmml">N</mi></mrow><mo id="S4.E3.m1.1.1.3.2.3.1a" xref="S4.E3.m1.1.1.3.2.3.1.cmml">+</mo><mrow id="S4.E3.m1.1.1.3.2.3.4" xref="S4.E3.m1.1.1.3.2.3.4.cmml"><mi id="S4.E3.m1.1.1.3.2.3.4.2" xref="S4.E3.m1.1.1.3.2.3.4.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.2.3.4.1" xref="S4.E3.m1.1.1.3.2.3.4.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.2.3.4.3" xref="S4.E3.m1.1.1.3.2.3.4.3.cmml">N</mi></mrow><mo id="S4.E3.m1.1.1.3.2.3.1b" xref="S4.E3.m1.1.1.3.2.3.1.cmml">+</mo><mrow id="S4.E3.m1.1.1.3.2.3.5" xref="S4.E3.m1.1.1.3.2.3.5.cmml"><mi id="S4.E3.m1.1.1.3.2.3.5.2" xref="S4.E3.m1.1.1.3.2.3.5.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.2.3.5.1" xref="S4.E3.m1.1.1.3.2.3.5.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.2.3.5.3" xref="S4.E3.m1.1.1.3.2.3.5.3.cmml">P</mi></mrow></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S4.E3.m1.1.1.3.1" xref="S4.E3.m1.1.1.3.1.cmml">∗</mo><mrow id="S4.E3.m1.1.1.3.3" xref="S4.E3.m1.1.1.3.3.cmml"><mn id="S4.E3.m1.1.1.3.3.2" xref="S4.E3.m1.1.1.3.3.2.cmml">100</mn><mo id="S4.E3.m1.1.1.3.3.1" xref="S4.E3.m1.1.1.3.3.1.cmml">%</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><eq id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"></eq><apply id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2"><times id="S4.E3.m1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.2.1"></times><ci id="S4.E3.m1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.2.2">𝐴</ci><ci id="S4.E3.m1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.2.3">𝑐</ci><ci id="S4.E3.m1.1.1.2.4.cmml" xref="S4.E3.m1.1.1.2.4">𝑐</ci><ci id="S4.E3.m1.1.1.2.5.cmml" xref="S4.E3.m1.1.1.2.5">𝑢</ci><ci id="S4.E3.m1.1.1.2.6.cmml" xref="S4.E3.m1.1.1.2.6">𝑟</ci><ci id="S4.E3.m1.1.1.2.7.cmml" xref="S4.E3.m1.1.1.2.7">𝑎</ci><ci id="S4.E3.m1.1.1.2.8.cmml" xref="S4.E3.m1.1.1.2.8">𝑐</ci><ci id="S4.E3.m1.1.1.2.9.cmml" xref="S4.E3.m1.1.1.2.9">𝑦</ci></apply><apply id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3"><times id="S4.E3.m1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.3.1"></times><apply id="S4.E3.m1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.3.2"><divide id="S4.E3.m1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.3.2"></divide><apply id="S4.E3.m1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.3.2.2"><plus id="S4.E3.m1.1.1.3.2.2.1.cmml" xref="S4.E3.m1.1.1.3.2.2.1"></plus><apply id="S4.E3.m1.1.1.3.2.2.2.cmml" xref="S4.E3.m1.1.1.3.2.2.2"><times id="S4.E3.m1.1.1.3.2.2.2.1.cmml" xref="S4.E3.m1.1.1.3.2.2.2.1"></times><ci id="S4.E3.m1.1.1.3.2.2.2.2.cmml" xref="S4.E3.m1.1.1.3.2.2.2.2">𝑇</ci><ci id="S4.E3.m1.1.1.3.2.2.2.3.cmml" xref="S4.E3.m1.1.1.3.2.2.2.3">𝑃</ci></apply><apply id="S4.E3.m1.1.1.3.2.2.3.cmml" xref="S4.E3.m1.1.1.3.2.2.3"><times id="S4.E3.m1.1.1.3.2.2.3.1.cmml" xref="S4.E3.m1.1.1.3.2.2.3.1"></times><ci id="S4.E3.m1.1.1.3.2.2.3.2.cmml" xref="S4.E3.m1.1.1.3.2.2.3.2">𝑇</ci><ci id="S4.E3.m1.1.1.3.2.2.3.3.cmml" xref="S4.E3.m1.1.1.3.2.2.3.3">𝑁</ci></apply></apply><apply id="S4.E3.m1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.3.2.3"><plus id="S4.E3.m1.1.1.3.2.3.1.cmml" xref="S4.E3.m1.1.1.3.2.3.1"></plus><apply id="S4.E3.m1.1.1.3.2.3.2.cmml" xref="S4.E3.m1.1.1.3.2.3.2"><times id="S4.E3.m1.1.1.3.2.3.2.1.cmml" xref="S4.E3.m1.1.1.3.2.3.2.1"></times><ci id="S4.E3.m1.1.1.3.2.3.2.2.cmml" xref="S4.E3.m1.1.1.3.2.3.2.2">𝑇</ci><ci id="S4.E3.m1.1.1.3.2.3.2.3.cmml" xref="S4.E3.m1.1.1.3.2.3.2.3">𝑃</ci></apply><apply id="S4.E3.m1.1.1.3.2.3.3.cmml" xref="S4.E3.m1.1.1.3.2.3.3"><times id="S4.E3.m1.1.1.3.2.3.3.1.cmml" xref="S4.E3.m1.1.1.3.2.3.3.1"></times><ci id="S4.E3.m1.1.1.3.2.3.3.2.cmml" xref="S4.E3.m1.1.1.3.2.3.3.2">𝑇</ci><ci id="S4.E3.m1.1.1.3.2.3.3.3.cmml" xref="S4.E3.m1.1.1.3.2.3.3.3">𝑁</ci></apply><apply id="S4.E3.m1.1.1.3.2.3.4.cmml" xref="S4.E3.m1.1.1.3.2.3.4"><times id="S4.E3.m1.1.1.3.2.3.4.1.cmml" xref="S4.E3.m1.1.1.3.2.3.4.1"></times><ci id="S4.E3.m1.1.1.3.2.3.4.2.cmml" xref="S4.E3.m1.1.1.3.2.3.4.2">𝐹</ci><ci id="S4.E3.m1.1.1.3.2.3.4.3.cmml" xref="S4.E3.m1.1.1.3.2.3.4.3">𝑁</ci></apply><apply id="S4.E3.m1.1.1.3.2.3.5.cmml" xref="S4.E3.m1.1.1.3.2.3.5"><times id="S4.E3.m1.1.1.3.2.3.5.1.cmml" xref="S4.E3.m1.1.1.3.2.3.5.1"></times><ci id="S4.E3.m1.1.1.3.2.3.5.2.cmml" xref="S4.E3.m1.1.1.3.2.3.5.2">𝐹</ci><ci id="S4.E3.m1.1.1.3.2.3.5.3.cmml" xref="S4.E3.m1.1.1.3.2.3.5.3">𝑃</ci></apply></apply></apply><apply id="S4.E3.m1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.3.3"><csymbol cd="latexml" id="S4.E3.m1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.3.3.1">percent</csymbol><cn type="integer" id="S4.E3.m1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.3.3.2">100</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">Accuracy=\frac{TP+TN}{TP+TN+FN+FP}*100\%</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.4" class="ltx_p">where <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="TP" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><times id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></times><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑇</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">TP</annotation></semantics></math>, <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="TN" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><times id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></times><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑇</ci><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">TN</annotation></semantics></math>,<math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="FP" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><times id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1"></times><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝐹</ci><ci id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">FP</annotation></semantics></math>, and <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="FN" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.4.m4.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><times id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1"></times><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝐹</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">FN</annotation></semantics></math> are the True Positives, True Negatives, False Positives and False Negatives respectively.</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.2" class="ltx_Math" alttext="Loss=-\sum_{i=1}^{N}y_{i}.\log\hat{y}_{i}" display="block"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2.2" xref="S4.E4.m1.2.2.3.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.1" xref="S4.E4.m1.1.1.1.1.2.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.1a" xref="S4.E4.m1.1.1.1.1.2.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.2.4" xref="S4.E4.m1.1.1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.1b" xref="S4.E4.m1.1.1.1.1.2.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.2.5" xref="S4.E4.m1.1.1.1.1.2.5.cmml">s</mi></mrow><mo id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml"><mo id="S4.E4.m1.1.1.1.1.3a" xref="S4.E4.m1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.3.2.cmml"><munderover id="S4.E4.m1.1.1.1.1.3.2.1" xref="S4.E4.m1.1.1.1.1.3.2.1.cmml"><mo movablelimits="false" id="S4.E4.m1.1.1.1.1.3.2.1.2.2" xref="S4.E4.m1.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E4.m1.1.1.1.1.3.2.1.2.3" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2.1.2.3.2" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3.2.cmml">i</mi><mo id="S4.E4.m1.1.1.1.1.3.2.1.2.3.1" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E4.m1.1.1.1.1.3.2.1.2.3.3" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m1.1.1.1.1.3.2.1.3" xref="S4.E4.m1.1.1.1.1.3.2.1.3.cmml">N</mi></munderover><msub id="S4.E4.m1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.2.cmml">y</mi><mi id="S4.E4.m1.1.1.1.1.3.2.2.3" xref="S4.E4.m1.1.1.1.1.3.2.2.3.cmml">i</mi></msub></mrow></mrow></mrow><mo lspace="0em" rspace="0.167em" id="S4.E4.m1.2.2.2.3" xref="S4.E4.m1.2.2.3a.cmml">.</mo><mrow id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.2.cmml"><mi id="S4.E4.m1.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S4.E4.m1.2.2.2.2a" xref="S4.E4.m1.2.2.2.2.cmml">⁡</mo><msub id="S4.E4.m1.2.2.2.2.2" xref="S4.E4.m1.2.2.2.2.2.cmml"><mover accent="true" id="S4.E4.m1.2.2.2.2.2.2" xref="S4.E4.m1.2.2.2.2.2.2.cmml"><mi id="S4.E4.m1.2.2.2.2.2.2.2" xref="S4.E4.m1.2.2.2.2.2.2.2.cmml">y</mi><mo id="S4.E4.m1.2.2.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S4.E4.m1.2.2.2.2.2.3" xref="S4.E4.m1.2.2.2.2.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.3.cmml" xref="S4.E4.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.3a.cmml" xref="S4.E4.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"></eq><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><times id="S4.E4.m1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1"></times><ci id="S4.E4.m1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2">𝐿</ci><ci id="S4.E4.m1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3">𝑜</ci><ci id="S4.E4.m1.1.1.1.1.2.4.cmml" xref="S4.E4.m1.1.1.1.1.2.4">𝑠</ci><ci id="S4.E4.m1.1.1.1.1.2.5.cmml" xref="S4.E4.m1.1.1.1.1.2.5">𝑠</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"><minus id="S4.E4.m1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3"></minus><apply id="S4.E4.m1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2"><apply id="S4.E4.m1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.1.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.3.2.1.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.3.2.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.2.2"></sum><apply id="S4.E4.m1.1.1.1.1.3.2.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3"><eq id="S4.E4.m1.1.1.1.1.3.2.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3.1"></eq><ci id="S4.E4.m1.1.1.1.1.3.2.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E4.m1.1.1.1.1.3.2.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E4.m1.1.1.1.1.3.2.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.3">𝑁</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.2">𝑦</ci><ci id="S4.E4.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E4.m1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2"><log id="S4.E4.m1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.1"></log><apply id="S4.E4.m1.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2">subscript</csymbol><apply id="S4.E4.m1.2.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2"><ci id="S4.E4.m1.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1">^</ci><ci id="S4.E4.m1.2.2.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S4.E4.m1.2.2.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">Loss=-\sum_{i=1}^{N}y_{i}.\log\hat{y}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.2" class="ltx_p">where <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\hat{y}_{i}" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><msub id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2.2" xref="S4.SS1.p4.1.m1.1.1.2.2.cmml">y</mi><mo id="S4.SS1.p4.1.m1.1.1.2.1" xref="S4.SS1.p4.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2"><ci id="S4.SS1.p4.1.m1.1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.2.1">^</ci><ci id="S4.SS1.p4.1.m1.1.1.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2.2">𝑦</ci></apply><ci id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\hat{y}_{i}</annotation></semantics></math> is the model prediction for <span id="S4.SS1.p4.2.1" class="ltx_text ltx_font_italic">i-th</span> pattern, <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><msub id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">y_{i}</annotation></semantics></math> represent the corresponding real value, and <span id="S4.SS1.p4.2.2" class="ltx_text ltx_font_italic">N</span> is the total number of samples.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS1.p5.1" class="ltx_p">To validate our POC, we partitioned the dataset into ten equal chunks so that each client has 20% of the total dataset. We then compare the federated scenario to centralized model training using the entire dataset. The convergence and divergence of training and testing accuracy on the customer support dataset for 10 clients on 20 communication rounds are depicted in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.1 Evaluation ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and Figure <a href="#S4.F6" title="Figure 6 ‣ 4.1 Evaluation ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, respectively. In addition Figure, <a href="#S4.F8" title="Figure 8 ‣ 4.1 Evaluation ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and Figure <a href="#S4.F8" title="Figure 8 ‣ 4.1 Evaluation ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> show the partial models compared to the global model (Fedbot). Partial models represent the model updates contributed by individual clients participating in the collaborative learning process. These updates capture the local insights and unique data characteristics of each client, which are incorporated into the global model to enhance its performance. The use of partial models in federated learning highlights the idea that the model’s performance benefits everyone involved in the collaborative learning process. Each device contributes its knowledge to the shared model, which improves the overall model’s accuracy, and this, in turn, benefits all the participants.</p>
</div>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;"><img src="/html/2304.03228/assets/figures/accuracy.png" id="S4.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="208" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Convergence of training and testing accuracy on customer support dataset for 10 clients on 20 communication rounds</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;"><img src="/html/2304.03228/assets/figures/loss.png" id="S4.F6.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="211" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Divergence of training and testing loss for 10 clients on 20 communication rounds.</figcaption>
</figure>
</div>
</div>
</figure>
<figure id="S4.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F8.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;"><img src="/html/2304.03228/assets/figures/partial_training.png" id="S4.F8.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="447" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Training accuracy for partial models trained on each customer support dataset. The accuracy varies greatly between clients due to the amount of available data. As can be seen, the federated Fedbot model improves on all client models.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F8.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:216.8pt;"><img src="/html/2304.03228/assets/figures/partial_testing.png" id="S4.F8.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="435" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Testing accuracy for partial models on each customer support dataset, resulted in a difference due to the amount of available data. In the end, a partial model (client) with poor performance will benefit from knowledge transfer via the global model</figcaption>
</figure>
</div>
</div>
</figure>
<div id="S4.SS1.p6" class="ltx_para ltx_noindent">
<p id="S4.SS1.p6.1" class="ltx_p">For demonstration, we consider a FEDn network consisting of a single, high-powered aggregation server (known as a combiner) with 16 VCPU and 16GB RAM, along with connected client instances (each with 16 VCPU and 16GB RAM) located in SSC (SNIC Science Cloud <cite class="ltx_cite ltx_citemacro_cite">Toor et al. (<a href="#bib.bib27" title="" class="ltx_ref">2017</a>)</cite>). To have an intuitive observation of the predictions, we give prediction examples using global models in Figure <a href="#S4.F9" title="Figure 9 ‣ 4.2 Implementation and demo environment ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, which shows the Fedbot performance on a given utterance. Hence, the proposed approach has contributed overall to a better understanding of text conversation, preserving data privacy, and contributing to low-cost training as well as collaborative training using large models.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation and demo environment</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">Designing and developing privacy-aware chatbots is not a trivial task; it requires various design techniques for data governance and privacy regulations. Third-party frameworks have been proposed for chatbot development; it refers to open-source building blocks that help build conversation engines, including Microsoft Bot, Facebook Messenger, Google Assistant, and Amazon Lex. However, the increasing use of chatbot technologies has led to a heightened focus on privacy issues. To tackle this concern, we developed Febot, a system that employs natural language processing techniques and federated learning to operate on private data. It includes the following benefits:</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">Privacy Protection: Federated learning ensures that sensitive customer data remains on the local device, reducing the risk of data breaches and providing stronger privacy protection for customers.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">Improved User Experience: By training models locally, federated learning enables chatbots to provide more accurate and relevant responses to users. This can result in a better customer experience and higher customer satisfaction.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p">Scalability: Federated learning enables organizations to scale their chatbots quickly and efficiently, as the models can be trained on multiple devices simultaneously. This reduces the need for large amounts of centralized computing resources and eliminates the need for complex data transfers.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p">Robust Models: Federated learning enables chatbots to leverage data from multiple devices to train robust models, improving their accuracy and performance.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p">Incremental learning: generate new knowledge and a new global model by attaching more clients and annotating new data points;</p>
</div>
</li>
<li id="S4.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i6.p1" class="ltx_para ltx_noindent">
<p id="S4.I1.i6.p1.1" class="ltx_p">Standalone: multiple platforms (i.e., guarantee for low disk and memory footprint). It can be run on a standard laptop having two cores and 2GB of RAM;</p>
</div>
</li>
</ul>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p">The proposed Fedbot is accessible from different platforms to engage a wide range of users, and it is also optimized for both desktop and mobile. Figure <a href="#S4.F9" title="Figure 9 ‣ 4.2 Implementation and demo environment ‣ 4 Experiment and results ‣ FedBot: Enhancing Privacy in Chatbots with Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> present some examples.</p>
</div>
<figure id="S4.F9" class="ltx_figure"><img src="/html/2304.03228/assets/figures/use-case.png" id="S4.F9.g1" class="ltx_graphics ltx_img_landscape" width="598" height="357" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Fedbot use case including UI and federated incremental learning where the model is trained incrementally on new data as it becomes available. This approach allows the model to adapt to changes in the data over time, improving its accuracy and relevance. </figcaption>
</figure>
</section>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.p1.1" class="ltx_p">In this paper, we have proposed Fedbot, a proof of concept customer support chatbot system, to address the data-sharing issue in machine learning and to handle client questions in customer support. Validation experiments were implemented based on twenty training rounds with a transformer neural network. The system consists of several components: the private data pipeline, dialogue management, collaborative training, and private incremental learning. Experiments on the customer support dataset using the transformer architecture demonstrate that our approach performs well compared to the baseline centralized model. The proposed Fedbot allows collaborative training participants to control their sensitive and private data while training a chatbot. The integration of federated learning within chatbot and conversation AI provides a sustainable solution by preserving data privacy. We conclude that the application of FL to NLP tasks such as dialogue understanding can contribute to solving the problem that arises when using machine learning with private and sensitive data.
Furthermore, the system actively supports end-users in joining training and improving their performance through incremental learning on various local clients.
<br class="ltx_break">In future work, we aim to extend Fedbot to cover more customer support datasets in a real geographically distributed manner and test the model with other aggregation algorithms (e.g., FedOPT, FedProx, etc.) for federated learning. Additionally, we intend to Fine-tune the pre-trained model LLaMA <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib28" title="" class="ltx_ref">2023</a>)</cite> and investigate its efficacy in federated learning settings.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>

<div id="Sx2.p1" class="ltx_para ltx_noindent">
<p id="Sx2.p1.1" class="ltx_p">This work is funded by Uppsala University in Sweden on scalable federated learning research and supported by the University of Skövde. The authors also would like to thank SNIC for providing cloud resources.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weizenbaum [1966]</span>
<span class="ltx_bibblock">
Joseph Weizenbaum.

</span>
<span class="ltx_bibblock">Eliza a computer program for the study of natural language
communication between man and machine.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Commun. ACM</em>, 9(1):36–45, January 1966.

</span>
<span class="ltx_bibblock">ISSN 0001-0782.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.1145/365153.365168" title="" class="ltx_ref ltx_href">10.1145/365153.365168</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://doi.acm.org/10.1145/365153.365168" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://doi.acm.org/10.1145/365153.365168</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Colby [1999]</span>
<span class="ltx_bibblock">
K. M. Colby.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Human-Computer Conversation in A Cognitive Therapy Program</em>,
pages 9–19.

</span>
<span class="ltx_bibblock">Springer US, Boston, MA, 1999.

</span>
<span class="ltx_bibblock">ISBN 978-1-4757-5687-6.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.1007/978-1-4757-5687-6_3" title="" class="ltx_ref ltx_href">10.1007/978-1-4757-5687-6_3</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1007/978-1-4757-5687-6_3" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1007/978-1-4757-5687-6_3</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AbuShawar and Atwell [2015]</span>
<span class="ltx_bibblock">
Bayan AbuShawar and Eric Atwell.

</span>
<span class="ltx_bibblock">Alice chatbot: Trials and outputs.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Computación y Sistemas</em>, 19, 12 2015.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.13053/cys-19-4-2326" title="" class="ltx_ref ltx_href">10.13053/cys-19-4-2326</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ekmefjord et al. [2021]</span>
<span class="ltx_bibblock">
Morgan Ekmefjord, Addi Ait-Mlouk, Sadi Alawadi, Mattias Åkesson, Desislava
Stoyanova, Ola Spjuth, Salman Toor, and Andreas Hellander.

</span>
<span class="ltx_bibblock">Scalable federated machine learning with fedn, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kazi et al. [2012]</span>
<span class="ltx_bibblock">
Hameedullah Kazi, Bhawani Shankar Chowdhry, and Zeesha Memon.

</span>
<span class="ltx_bibblock">Medchatbot: An umls based chatbot for medical students.

</span>
<span class="ltx_bibblock">2012.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia [2009]</span>
<span class="ltx_bibblock">
Jiyou Jia.

</span>
<span class="ltx_bibblock">Csiec: A computer assisted english learning chatbot based on textual
knowledge and reasoning.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Knowledge-Based Systems</em>, 22(4):249 – 255,
2009.

</span>
<span class="ltx_bibblock">ISSN 0950-7051.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/https://doi.org/10.1016/j.knosys.2008.09.001" title="" class="ltx_ref ltx_href">https://doi.org/10.1016/j.knosys.2008.09.001</a>.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://www.sciencedirect.com/science/article/pii/S0950705109000045" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.sciencedirect.com/science/article/pii/S0950705109000045</a>.

</span>
<span class="ltx_bibblock">Artificial Intelligence (AI) in Blended Learning.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heller et al. [2005]</span>
<span class="ltx_bibblock">
Bob Heller, Mike D. Proctor, Dean Y.-O.-N. Mah, Lisa Jewell, and Bill Cheung.

</span>
<span class="ltx_bibblock">Freudbot: An investigation of chatbot technology in distance
education.

</span>
<span class="ltx_bibblock">2005.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al. [2017]</span>
<span class="ltx_bibblock">
Minghui Qiu, Feng-Lin Li, Siyu Wang, Xing Gao, Yan Chen, Weipeng Zhao, Haiqing
Chen, Jun Huang, and Wei Chu.

</span>
<span class="ltx_bibblock">AliMe chat: A sequence to sequence and rerank based chatbot
engine.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 55th Annual Meeting of the Association
for Computational Linguistics (Volume 2: Short Papers)</em>, pages 498–503,
Vancouver, Canada, July 2017. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.18653/v1/P17-2079" title="" class="ltx_ref ltx_href">10.18653/v1/P17-2079</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.aclweb.org/anthology/P17-2079" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.aclweb.org/anthology/P17-2079</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaira et al. [2018]</span>
<span class="ltx_bibblock">
Lucia Vaira, Mario A. Bochicchio, Matteo Conte, Francesco Margiotta Casaluci,
and Antonio Melpignano.

</span>
<span class="ltx_bibblock">Mamabot: a system based on ml and nlp for supporting women and
families during pregnancy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IDEAS</em>, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Comendador et al. [2015]</span>
<span class="ltx_bibblock">
Benilda Eleonor Comendador, Bien Francisco, Jefferson Medenilla, Sharleen
Nacion, and Timothy Serac.

</span>
<span class="ltx_bibblock">Pharmabot: A pediatric generic medicine consultant chatbot.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Journal of Automation and Control Engineering</em>, 3:137–140, 01 2015.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.12720/joace.3.2.137-140" title="" class="ltx_ref ltx_href">10.12720/joace.3.2.137-140</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al. [2017]</span>
<span class="ltx_bibblock">
KyoJoong Oh, Dongkun Lee, ByungSoo Ko, and Ho-Jin Choi.

</span>
<span class="ltx_bibblock">A chatbot for psychiatric counseling in mental healthcare service
based on emotional dialogue analysis and sentence generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">2017 18th IEEE International Conference on Mobile Data
Management (MDM)</em>, pages 371–375, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Divya, Indumathi, Ishwarya, Priyasankari, and Kalpana Devi.

</span>
<span class="ltx_bibblock">A self-diagnosis medical chatbot using artificial intelligence.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Journal of Web Development and Web Designing</em>, 3.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. [2017]</span>
<span class="ltx_bibblock">
Paris (Pei-Ting) Hsu, Jingshu Zhao, Kehan Liao, Tianyi Liu, and Chen Wang.

</span>
<span class="ltx_bibblock">Allergybot: A chatbot technology intervention for young adults with
food allergies dining out.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 CHI Conference Extended Abstracts on
Human Factors in Computing Systems</em>, CHI EA ’17, pages 74–79, New York, NY,
USA, 2017. ACM.

</span>
<span class="ltx_bibblock">ISBN 978-1-4503-4656-6.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.1145/3027063.3049270" title="" class="ltx_ref ltx_href">10.1145/3027063.3049270</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://doi.acm.org/10.1145/3027063.3049270" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://doi.acm.org/10.1145/3027063.3049270</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. [2017]</span>
<span class="ltx_bibblock">
Lei Cui, Furu Wei, Shaohan Huang, Chuanqi Tan, Chaoqun Duan, and Ming Zhou.

</span>
<span class="ltx_bibblock">Superagent: A customer service chatbot for e-commerce websites.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of ACL 2017, System Demonstrations</em>, pages
97–102. Association for Computational Linguistics, July 2017.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.microsoft.com/en-us/research/publication/superagent-customer-service-chatbot-e-commerce-websites/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.microsoft.com/en-us/research/publication/superagent-customer-service-chatbot-e-commerce-websites/</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2017]</span>
<span class="ltx_bibblock">
Anbang Xu, Zhe Liu, Yufan Guo, Vibha Sinha, and Rama Akkiraju.

</span>
<span class="ltx_bibblock">A new chatbot for customer service on social media.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 CHI Conference on Human Factors in
Computing Systems</em>, CHI ’17, pages 3506–3510, New York, NY, USA, 2017. ACM.

</span>
<span class="ltx_bibblock">ISBN 978-1-4503-4655-9.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.1145/3025453.3025496" title="" class="ltx_ref ltx_href">10.1145/3025453.3025496</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://doi.acm.org/10.1145/3025453.3025496" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://doi.acm.org/10.1145/3025453.3025496</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov et al. [2013]</span>
<span class="ltx_bibblock">
Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg Corrado, and Jeffrey Dean.

</span>
<span class="ltx_bibblock">Distributed representations of words and phrases and their
compositionality.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 26th International Conference on Neural
Information Processing Systems - Volume 2</em>, NIPS’13, pages 3111–3119, USA,
2013. Curran Associates Inc.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://dl.acm.org/citation.cfm?id=2999792.2999959" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dl.acm.org/citation.cfm?id=2999792.2999959</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">cloud [2021a]</span>
<span class="ltx_bibblock">
Google cloud.

</span>
<span class="ltx_bibblock">Google cloud, 2021a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://cloud.google.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://cloud.google.com/</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">cloud [2021b]</span>
<span class="ltx_bibblock">
Azure cloud.

</span>
<span class="ltx_bibblock">Azure cloud, 2021b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://azure.microsoft.com/en-us/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://azure.microsoft.com/en-us/</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">cloud [2021c]</span>
<span class="ltx_bibblock">
AWS cloud.

</span>
<span class="ltx_bibblock">Aws cloud, 2021c.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aws.amazon.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aws.amazon.com/</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. [2019]</span>
<span class="ltx_bibblock">
Peter Kairouz, H. Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Keith Bonawitz, Zachary Charles, Graham Cormode,
Rachel Cummings, Rafael G. L. D’Oliveira, Salim El Rouayheb, David Evans,
Josh Gardner, Zachary Garrett, Adrià Gascón, Badih Ghazi,
Phillip B. Gibbons, Marco Gruteser, Zaïd Harchaoui, Chaoyang He, Lie
He, Zhouyuan Huo, Ben Hutchinson, Justin Hsu, Martin Jaggi, Tara Javidi,
Gauri Joshi, Mikhail Khodak, Jakub Konečný, Aleksandra Korolova,
Farinaz Koushanfar, Sanmi Koyejo, Tancrède Lepoint, Yang Liu, Prateek
Mittal, Mehryar Mohri, Richard Nock, Ayfer Özgür, Rasmus Pagh,
Mariana Raykova, Hang Qi, Daniel Ramage, Ramesh Raskar, Dawn Song, Weikang
Song, Sebastian U. Stich, Ziteng Sun, Ananda Theertha Suresh, Florian
Tramèr, Praneeth Vepakomma, Jianyu Wang, Li Xiong, Zheng Xu, Qiang
Yang, Felix X. Yu, Han Yu, and Sen Zhao.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1912.04977, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1912.04977" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1912.04977</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. [2017]</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and
Blaise Agüera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need, 2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. [2018]</span>
<span class="ltx_bibblock">
Tao Shen, Jing Jiang, Tianyi Zhou, Shirui Pan, Guodong Long, and Chengqi Zhang.

</span>
<span class="ltx_bibblock">Disan: Directional self-attention network for RnN/CNN-free language
understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">32nd AAAI Conference on Artificial Intelligence, AAAI 2018</em>,
pages 5446–5455, 2018.

</span>
<span class="ltx_bibblock">ISBN 9781577358008.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Parikh et al. [2016]</span>
<span class="ltx_bibblock">
Ankur P Parikh, Oscar Täckström, Dipanjan Das, and Jakob Uszkoreit.

</span>
<span class="ltx_bibblock">A decomposable attention model for natural language inference.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">EMNLP 2016 - Conference on Empirical Methods in Natural
Language Processing, Proceedings</em>, pages 2249–2255, 2016.

</span>
<span class="ltx_bibblock">ISBN 9781945626258.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.18653/v1/d16-1244" title="" class="ltx_ref ltx_href">10.18653/v1/d16-1244</a>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berners-Lee [2009]</span>
<span class="ltx_bibblock">
Tim Berners-Lee.

</span>
<span class="ltx_bibblock">https://www.w3.org/designissues/linkeddata.html, 2009.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2016]</span>
<span class="ltx_bibblock">
Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V. Le, Mohammad Norouzi, Wolfgang
Macherey, Maxim Krikun, Yuan Cao, Qin Gao, Klaus Macherey, Jeff Klingner,
Apurva Shah, Melvin Johnson, Xiaobing Liu, Łukasz Kaiser, Stephan Gouws,
Yoshikiyo Kato, Taku Kudo, Hideto Kazawa, Keith Stevens, George Kurian,
Nishant Patil, Wei Wang, Cliff Young, Jason Smith, Jason Riesa, Alex Rudnick,
Oriol Vinyals, Greg Corrado, Macduff Hughes, and Jeffrey Dean.

</span>
<span class="ltx_bibblock">Google’s neural machine translation system: Bridging the gap between
human and machine translation, 2016.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Toor et al. [2017]</span>
<span class="ltx_bibblock">
Salman Toor, Mathias Lindberg, Ingemar Falman, Andreas Vallin, Olof Mohill,
Pontus Freyhult, Linus Nilsson, Martin Agback, Lars Viklund, Henric Zazzik,
Ola Spjuth, Marco Capuccini, Joakim Möller, Donal Murtagh, and Andreas
Hellander.

</span>
<span class="ltx_bibblock">Snic science cloud (ssc): A national-scale cloud infrastructure for
swedish academia.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">2017 IEEE 13th International Conference on e-Science
(e-Science)</em>, pages 219–227, 2017.

</span>
<span class="ltx_bibblock">doi:<a target="_blank" href="https://doi.org/10.1109/eScience.2017.35" title="" class="ltx_ref ltx_href">10.1109/eScience.2017.35</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. [2023]</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne
Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro,
Faisal Azhar, Aurelien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume
Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models, 2023.

</span>
</li>
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:creator" content="David S. Hippocampus, Elias D. Striatum"></div>
<div class="ltx_rdf" about="" property="dcterms:subject" content="First keyword, Second keyword, More"></div>
<div class="ltx_rdf" about="" property="dcterms:subject" content="q-bio.NC, q-bio.QM"></div>
<div class="ltx_rdf" about="" property="dcterms:title" content="A template for the arxiv style"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2304.03227" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2304.03228" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2304.03228">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2304.03228" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2304.03229" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 14:34:13 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
