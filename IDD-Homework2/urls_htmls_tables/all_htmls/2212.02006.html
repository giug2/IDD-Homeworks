<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2212.02006] HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation</title><meta property="og:description" content="Federated learning (FL) has been recognized as a privacy-preserving distributed machine learning paradigm that enables knowledge sharing among various heterogeneous artificial intelligence (AIoT) devices through centra…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2212.02006">

<!--Generated on Fri Mar  1 12:35:06 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
federated learning,  heterogeneous model,  AIoT,  hierarchical self-distillation
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">HierarchyFL: Heterogeneous
Federated Learning via Hierarchical
Self-Distillation </h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jun Xia, Yi Zhang, Zhihao Yue, Ming Hu, Xian Wei, and Mingsong Chen
<br class="ltx_break">
</span><span class="ltx_author_notes">Jun Xia, Yi Zhang, Zhihao Yue, Ming Hu, Xian Wei, and Mingsong Chen are with the MoE Engineering Research Center of Software/Hardware Co-Design Technology and Application, East China Normal University, Shanghai 200062, China.
Mingsong Chen is the corresponding author (e-mail: mschen@sei.ecnu.edu.cn).
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning (FL) has been recognized as a privacy-preserving distributed machine learning paradigm that enables knowledge sharing among various heterogeneous artificial intelligence (AIoT) devices through centralized global model aggregation. FL suffers from model inaccuracy and slow convergence due to the model heterogeneity of the AIoT devices involved. Although various existing methods try to solve the bottleneck of the model heterogeneity problem, most of them improve the accuracy of heterogeneous models in a coarse-grained manner, which makes it still a great challenge to deploy large-scale AIoT devices. To alleviate the negative impact of this problem and take full advantage of the diversity of each heterogeneous model, we propose an efficient framework named HierarchyFL, which uses a small amount of public data for efficient and scalable knowledge across a variety of differently structured models. By using self-distillation and our proposed ensemble library, each hierarchical model can intelligently learn from each other on cloud servers. Experimental results on various well-known datasets show that HierarchyFL can not only maximize the knowledge sharing among various heterogeneous models in large-scale AIoT systems, but also greatly improve the model performance of each involved heterogeneous AIoT device.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
federated learning, heterogeneous model, AIoT, hierarchical self-distillation

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Along with the prosperity of Artificial Intelligence of Things (AIoT), more and more heterogeneous devices possess deep neural networks for the purpose on precising discrimination and perceptual control <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
However, due to both the limitation of training data and the restricted hardware resources, the daily performance of models in heterogeneous devices cannot be guaranteed. To enhance the model performance of heterogeneous AIoT devices, we are expecting a large-scale AIoT system that fully uses the computing power of cloud computing to predict inference results accurately. Although such a cloud computing system is promising to deal with collaborative learning of heterogeneous AIoT devices in daily life, due to the uncertainty of the real environment, it inherently suffers from the risks of data privacy exposure and model performance inaccuracy.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">As a promising technology in distributed machine learning, Federated Learning (FL) is usually deployed in many security-critical scenarios (e.g., autonomous driving, portable medical equipment, and intelligent transportation) to avoid the risk of sensitive data leakage <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
To achieve this goal, FL ensures data privacy by uploading the gradients of the DNN model in an AIoT system instead of uploading its locally sensitive data.
However, the classic FL uses the same global model for communication, which ignores the heterogeneity of various heterogeneous AIoT devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
This ideal assumption suffers from poor model performance and slow convergence speed, which greatly limits the FL development
in large-scale AIoT systems.
According to the above reason, <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">how to mitigate its negative effects of model heterogeneity and enhance the knowledge
sharing among heterogeneous models is becoming a great challenge in the development of FL framework, especially when facing a large-scale AIoT system. </span></p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To weaken the negative effects of the model heterogeneity issue,
various existing works (e.g., FedProto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, PervasiveFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, HeteroFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, and FedGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>) have been proposed. However, most of them focus on the perspectives of uploading model gradients or middle-ware knowledge, which ignores the diversity of heterogeneous models.
To make this matter worse, some of them focus overly on communication overhead, which has a restricted effect on the enhancement performance of heterogeneous models.
For example, HeteroFL only considers sharing the same part of the global model and neglects the diversity among the heterogeneous models of all AIoT devices, which greatly influences its quality of knowledge sharing between various heterogeneous models.
To conceal the model heterogeneity for each AIoT device, PervasiveFL and Fedproto try to send a same “modellet” or “prototype” as its knowledge middle-ware to all the AIoT devices for effective knowledge sharing.
To further extract the knowledge of heterogeneous models, FedGen enables the knowledge sharing by dint of a generator model, which introduced an extra communication overhead in FL.
Although various existing methods try to tackle the bottleneck of the model heterogeneity problem, most of them improve the accuracy of heterogeneity models in a coarse-grained manner, which makes the deployment of large-scale AIoT devices a great challenge.
</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To enable effective knowledge sharing between heterogeneous models in large-scale AIoT systems, this paper proposed a novel framework named <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">HierarchyFL</span>, which allows different hierarchy models to learn from each other, thus improving their inference performance.
This paper makes the following three major contributions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Inspired by self-distillation method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, we propose the HierarchyFL, which allows the distillation between
various hierarchy models on the cloud server.
Since all the hierarchy local models (i.e., heterogeneous local models) in an AIoT system are the subset of global models, they enable knowledge sharing among
heterogeneous devices by layer-alignment averaging way with different hierarchies of the global model.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">To fully utilize the diversity of each heterogeneous model in self-distillation, we propose the concept of <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">meta-leaner</span> that can explore the proportion of each heterogeneous model in knowledge sharing. Based on the meta-learner, we develop an ensemble distillation library that has both the ensemble logits and ensemble features of all hierarchy models to maximize the efficacy of self-distillation in knowledge sharing of various heterogeneous models.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We design serials of experiments on two well-known datasets with both various Non-Independent and Identically Distributed (Non-IID) and IID settings.
Compared with various state-of-the-art heterogeneous FL approaches, HierarchyFL cannot achieve better model inference performance but also have superior scalability in large-scale AIoT systems.
</p>
</div>
</li>
</ul>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The rest of this paper is organized as follows. Section <a href="#S2" title="II Related Work ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> presents related work on heterogeneous federated learning. After Section <a href="#S3" title="III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>
details our proposed HierachyFL method, Section <a href="#S4" title="IV Experiment ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>
introduces the experimental results on well-known benchmarks. Finally, Section <a href="#S5" title="V Conclusion ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> concludes the paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2212.02006/assets/x1.png" id="S2.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="360" height="247" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Framework and workflow of HierarchyFL</figcaption>
</figure>
<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Although FL is promising in collaborative learning of AIoT systems, it still suffers from the problem of model heterogeneity.
To mitigate the effect of this problem, various existing methods try to tackle the bottleneck from the perspective of heterogeneous model knowledge sharing, which can deploy a suitable heterogeneous model to an AIoT device.
The methods for solving model heterogeneity can be divided into two categories, i.e., “slimmable-based” methods and “knowledge middleware” distillation-based methods.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">The former uses similar subset model aggregation to achieve knowledge sharing from large to small models.
For example, Diao et al. proposed
a framework named HeteroFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, which is applied width-wise models and aggregates local models by channel on the cloud server.
To fully use the heterogeneous models, Hong et al. presented a novel method named split-Mix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> that uses a thinner model in the cloud aggregation to obtain a more large model.
Although the above methods are promising in dealing with the heterogeneous model problem, most of them still suffer from low inference accuracy of the heterogeneous model, which hinders their deployment in real scenarios.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">To enable the effective knowledge sharing of all involved heterogeneous models, the latter uses the knowledge distillation method with the same knowledge middleware among heterogeneous models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. For example,
to achieve effective knowledge sharing, Zhu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed a distillation-based method named FedGen, which designs a generator on the cloud server. Based on this generator, FedGen can not only share global knowledge through knowledge distillation but also enhance the inference performance
of local models.
To enable privacy-preserving FL for large-scale AIoT devices equipped with heterogeneous DNN models, Xia et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> developed a novel framework named PervasiveFL, which uses deep mutual learning by setting up a uniformly small model named “modellet” to achieve global knowledge-sharing.
Similar to PervasiveFL, Tan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> proposed a newly method named FedProto, which allows each device to send a prototype that represents the features of each category in local nature images. In this way, Fedproto can be used to minimize the gap between local and global prototypes to enhance knowledge sharing during training.
Although the above methods are effective in improving
FL performance, most of them are based on coarse-granularity features. None of them explicitly take the diversity of local heterogeneous
models to the model performance enhancement into account.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">To the best of our knowledge, HierarchyFL is the first attempt to utilize the merit of self-distillation and fully consider the diversity of local heterogeneous
models to mitigate the negative effect of model heterogeneity issues on AIoT devices. Compared with state-of-the-art heterogeneous FL methods, HierarchyFL cannot only enable effective knowledge sharing between heterogeneous models in large-scale AIoT systems but also have superior
scalability in large-scale AIoT systems.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Our HierarchyFL Approach</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">To ease the understanding of our HierarchyFL framework,
this section introduces our HierarchyFL architecture in detail. Firstly, it presents the architecture and workflow of HierarchyFL.
Afterward, it represents hierarchical self-distillation procedure
based on our proposed ensemble library used in HierarchyFL.
Lastly, it demonstrates
the training procedure of HierarchyFL on both the cloud server and local devices.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Architecture and Workflow of HierarchyFL</span>
</h3>

<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS1.4.1.1" class="ltx_text">III-A</span>1 </span>Architecture of HierarchyFL</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">Typically, an AIoT application comprises a cloud server and various heterogeneous AIoT devices, where each device has both restricted memory and computation capacities.
In this paper, HierarchyFL focuses on the hierarchy model performance enhancement, which can not only enable knowledge sharing among heterogeneous models in large-scale AIoT systems but also greatly enhance the model performance in each AIoT device.
As shown in Figure <a href="#S2.F1" title="Figure 1 ‣ II Related Work ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>,
the HierarchyFL is composed of two components, i) the cloud server that contains the hierarchical self-distillation among various hierarchy models and the aggregation of each hierarchy model; ii) heterogeneous AIoT devices that conduct the local training based on the local nature images.
Unlike Fedavg, which uses the same global model in its training procedure,
HierarchyFL allows heterogeneous models to adapt to the hardware resource capacities of AIoT devices.
To complete this idea, HierarchyFL uses the layer heterogeneous (i.e., the layer width of all AIoT device models is variable.) models in an AIoT system.
To determine the size of the hierarchy model in each AIoT device, the device needs to upload its size of free hardware resources to the cloud server.
Afterward, the cloud server can ensure and dispatch the local model in the newly participated devices for knowledge sharing.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS2.4.1.1" class="ltx_text">III-A</span>2 </span>Workflow of HierarchyFL</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">In HierarchyFL, distributed
edge devices and a cloud server work closely to realize the global
learning of various kinds of hierarchy models deployed on heterogeneous
devices. Before training, all the devices participating in HierarchyFL will install and initialize a hierarchy model in advance, which is a subset of the global model in the cloud server. Afterward,
the cloud server sends a part of the global model to AIoT devices for local training.
When the local training end, HierarchyFL will conduct the model aggregation and hierarchical self-distillation on the cloud server. Note that HierarchyFL allows hot-plug AIoT devices, where the newly involved device only inherits the parameters of the global model in the cloud server. In practical terms, the whole
working procedure of the HierarchyFL framework can be divided
into six steps.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.1" class="ltx_p"><span id="S3.SS1.SSS2.p2.1.1" class="ltx_text ltx_font_bold">Step 1 (Model Synchronization):</span>
At the initial stage of HierarchyFL, the cloud server dispatches the part of global model parameters to each heterogeneous AIoT device
according to their memory and computation capability for local training.</p>
</div>
<div id="S3.SS1.SSS2.p3" class="ltx_para">
<p id="S3.SS1.SSS2.p3.1" class="ltx_p"><span id="S3.SS1.SSS2.p3.1.1" class="ltx_text ltx_font_bold">Step 2 (Local Training):</span>
Based on the received global model parameters, each heterogeneous AIoT device constructs an initial hierarchy model (i.e., local model), which is trained by local nature images using cross-entropy loss to get the gradients of the local model for gradient upload.</p>
</div>
<div id="S3.SS1.SSS2.p4" class="ltx_para">
<p id="S3.SS1.SSS2.p4.1" class="ltx_p"><span id="S3.SS1.SSS2.p4.1.1" class="ltx_text ltx_font_bold">Step 3 (Gradient Upload):</span>
When the local training is finished, each participating AIoT device uploads its latest local model gradients to a gradient buffer in the cloud server. All the collected local model gradients derive an aggregated global model by using layer-alignment averaging, where all the heterogeneous models only aggregate their corresponding public parts in a global model in an average way.</p>
</div>
<div id="S3.SS1.SSS2.p5" class="ltx_para">
<p id="S3.SS1.SSS2.p5.1" class="ltx_p"><span id="S3.SS1.SSS2.p5.1.1" class="ltx_text ltx_font_bold">Step 4 (Cloud Aggregation):</span>
After receiving the local model gradients of all the participating devices, this step will layer-alignment averaging such gradients and use the previous round global model stored in the model parameter buffer to construct a new global model.</p>
</div>
<div id="S3.SS1.SSS2.p6" class="ltx_para">
<p id="S3.SS1.SSS2.p6.1" class="ltx_p"><span id="S3.SS1.SSS2.p6.1.1" class="ltx_text ltx_font_bold">Step 5 (Ensemble Library Update):</span>
After the global model is averaged, this step will update the meta-learner by calculating the cross-entropy loss between the ensemble predictions of each hierarchy model and the labels of public images, thus utilizing the diversity of each hierarchy model. Based on the new meta-learner, the features and predictions in the ensemble library can be updated for the hierarchical self-distillation period.
(See details in Section <a href="#S3.SS2.SSS1" title="III-B1 Ensemble Library Update ‣ III-B Hierarchical Self-distillation ‣ III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span>1</span></a>).</p>
</div>
<div id="S3.SS1.SSS2.p7" class="ltx_para">
<p id="S3.SS1.SSS2.p7.1" class="ltx_p"><span id="S3.SS1.SSS2.p7.1.1" class="ltx_text ltx_font_bold">Step 6 (Hierarchical Self-distillation):</span>
Based on the new ensemble feature and prediction, all of the hierarchy models can be updated by hierarchical self-distillation, which includes two categories, i.e., feature distillation and prediction distillation. Afterward, the updated global model can be saved to the global model parameters.</p>
</div>
<div id="S3.SS1.SSS2.p8" class="ltx_para">
<p id="S3.SS1.SSS2.p8.1" class="ltx_p">HierarchyFL repeats all the above six steps until the convergence of both global models and all its hierarchy models.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Hierarchical Self-distillation</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In HierarchyFL, the cloud server and all the participating AIoT devices
start knowledge sharing by hierarchical self-distillation that fully considers the diversity of each hierarchy model.
The hierarchical self-distillation procedure can be aided by an ensemble library, which consists of three parts, i.e., meta-learner, ensemble predictions, and ensemble features.
To explore the proportion of each heterogeneous model in knowledge sharing,
the meta-learner can be updated by cross-entropy loss function between the ensemble predictions of each hierarchy model and the labels of public images based on a few public data in the cloud server. Afterward, the ensemble library that includes ensemble features and ensemble predictions can be updated through the newly meta-learner.
When the ensemble library is updated, it can be used for hierarchy self-distillation for each hierarchy model on the cloud server.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS1.4.1.1" class="ltx_text">III-B</span>1 </span>Ensemble Library Update</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.3" class="ltx_p">Inspired by self-distillation methods, the approach in this paper builds the ensemble features and prediction sets from the output of each hierarchical model by maintaining an ensemble library for hierarchical self-distillation.
Assume that there are <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">n</annotation></semantics></math> categories of hierarchy models participating in an AIoT system, and let the meta-learner and the prediction of each hierarchy model be <math id="S3.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mi id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">M</annotation></semantics></math> and <math id="S3.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">P</annotation></semantics></math>. Based on the few public images, the loss function of the meta-learner is demonstrated as follows</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\footnotesize L_{M}=CE\_Loss(\sum_{i=1}^{n}{M_{i}\cdot P_{i}},y)." display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml"><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.2.cmml">L</mi><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.3.3" xref="S3.E1.m1.2.2.1.1.3.3.cmml">M</mi></msub><mo mathsize="80%" id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.4" xref="S3.E1.m1.2.2.1.1.1.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2a" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mi mathsize="80%" mathvariant="normal" id="S3.E1.m1.2.2.1.1.1.5" xref="S3.E1.m1.2.2.1.1.1.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2b" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.6" xref="S3.E1.m1.2.2.1.1.1.6.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2c" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.7" xref="S3.E1.m1.2.2.1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2d" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.8" xref="S3.E1.m1.2.2.1.1.1.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2e" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.9" xref="S3.E1.m1.2.2.1.1.1.9.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2f" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml"><mo maxsize="80%" minsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo lspace="0em" maxsize="80%" minsize="80%" movablelimits="false" stretchy="true" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">M</mi><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" mathsize="80%" rspace="0.222em" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">P</mi><mi mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><mo mathsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">,</mo><mi mathsize="80%" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">y</mi><mo maxsize="80%" minsize="80%" id="S3.E1.m1.2.2.1.1.1.1.1.4" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" mathsize="80%" id="S3.E1.m1.2.2.1.2" xref="S3.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"></eq><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.2">𝐿</ci><ci id="S3.E1.m1.2.2.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.3">𝑀</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><times id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"></times><ci id="S3.E1.m1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3">𝐶</ci><ci id="S3.E1.m1.2.2.1.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.1.4">𝐸</ci><ci id="S3.E1.m1.2.2.1.1.1.5.cmml" xref="S3.E1.m1.2.2.1.1.1.5">_</ci><ci id="S3.E1.m1.2.2.1.1.1.6.cmml" xref="S3.E1.m1.2.2.1.1.1.6">𝐿</ci><ci id="S3.E1.m1.2.2.1.1.1.7.cmml" xref="S3.E1.m1.2.2.1.1.1.7">𝑜</ci><ci id="S3.E1.m1.2.2.1.1.1.8.cmml" xref="S3.E1.m1.2.2.1.1.1.8">𝑠</ci><ci id="S3.E1.m1.2.2.1.1.1.9.cmml" xref="S3.E1.m1.2.2.1.1.1.9">𝑠</ci><interval closure="open" id="S3.E1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1"><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1"><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3"><eq id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2"><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.1">⋅</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2">𝑀</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.2">𝑃</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\footnotesize L_{M}=CE\_Loss(\sum_{i=1}^{n}{M_{i}\cdot P_{i}},y).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p1.9" class="ltx_p">where <math id="S3.SS2.SSS1.p1.4.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.SSS1.p1.4.m1.1a"><mi id="S3.SS2.SSS1.p1.4.m1.1.1" xref="S3.SS2.SSS1.p1.4.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m1.1b"><ci id="S3.SS2.SSS1.p1.4.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m1.1c">y</annotation></semantics></math> is the labels of public data on the cloud server, <math id="S3.SS2.SSS1.p1.5.m2.1" class="ltx_Math" alttext="CE\_Loss" display="inline"><semantics id="S3.SS2.SSS1.p1.5.m2.1a"><mrow id="S3.SS2.SSS1.p1.5.m2.1.1" xref="S3.SS2.SSS1.p1.5.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.5.m2.1.1.2" xref="S3.SS2.SSS1.p1.5.m2.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.5.m2.1.1.1" xref="S3.SS2.SSS1.p1.5.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.5.m2.1.1.3" xref="S3.SS2.SSS1.p1.5.m2.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.5.m2.1.1.1a" xref="S3.SS2.SSS1.p1.5.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p1.5.m2.1.1.4" xref="S3.SS2.SSS1.p1.5.m2.1.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.5.m2.1.1.1b" xref="S3.SS2.SSS1.p1.5.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.5.m2.1.1.5" xref="S3.SS2.SSS1.p1.5.m2.1.1.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.5.m2.1.1.1c" xref="S3.SS2.SSS1.p1.5.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.5.m2.1.1.6" xref="S3.SS2.SSS1.p1.5.m2.1.1.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.5.m2.1.1.1d" xref="S3.SS2.SSS1.p1.5.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.5.m2.1.1.7" xref="S3.SS2.SSS1.p1.5.m2.1.1.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.5.m2.1.1.1e" xref="S3.SS2.SSS1.p1.5.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.5.m2.1.1.8" xref="S3.SS2.SSS1.p1.5.m2.1.1.8.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m2.1b"><apply id="S3.SS2.SSS1.p1.5.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1"><times id="S3.SS2.SSS1.p1.5.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.1"></times><ci id="S3.SS2.SSS1.p1.5.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.2">𝐶</ci><ci id="S3.SS2.SSS1.p1.5.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.3">𝐸</ci><ci id="S3.SS2.SSS1.p1.5.m2.1.1.4.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.4">_</ci><ci id="S3.SS2.SSS1.p1.5.m2.1.1.5.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.5">𝐿</ci><ci id="S3.SS2.SSS1.p1.5.m2.1.1.6.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.6">𝑜</ci><ci id="S3.SS2.SSS1.p1.5.m2.1.1.7.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.7">𝑠</ci><ci id="S3.SS2.SSS1.p1.5.m2.1.1.8.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1.8">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m2.1c">CE\_Loss</annotation></semantics></math> means the cross entropy loss function of the meta-learner, and <math id="S3.SS2.SSS1.p1.6.m3.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="S3.SS2.SSS1.p1.6.m3.1a"><msub id="S3.SS2.SSS1.p1.6.m3.1.1" xref="S3.SS2.SSS1.p1.6.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.6.m3.1.1.2" xref="S3.SS2.SSS1.p1.6.m3.1.1.2.cmml">M</mi><mi id="S3.SS2.SSS1.p1.6.m3.1.1.3" xref="S3.SS2.SSS1.p1.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m3.1b"><apply id="S3.SS2.SSS1.p1.6.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m3.1.1.2">𝑀</ci><ci id="S3.SS2.SSS1.p1.6.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m3.1c">M_{i}</annotation></semantics></math> represents the proportion of <math id="S3.SS2.SSS1.p1.7.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS2.SSS1.p1.7.m4.1a"><msup id="S3.SS2.SSS1.p1.7.m4.1.1" xref="S3.SS2.SSS1.p1.7.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p1.7.m4.1.1.2" xref="S3.SS2.SSS1.p1.7.m4.1.1.2.cmml">i</mi><mrow id="S3.SS2.SSS1.p1.7.m4.1.1.3" xref="S3.SS2.SSS1.p1.7.m4.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.7.m4.1.1.3.2" xref="S3.SS2.SSS1.p1.7.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.7.m4.1.1.3.1" xref="S3.SS2.SSS1.p1.7.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.7.m4.1.1.3.3" xref="S3.SS2.SSS1.p1.7.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m4.1b"><apply id="S3.SS2.SSS1.p1.7.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m4.1.1.2">𝑖</ci><apply id="S3.SS2.SSS1.p1.7.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m4.1.1.3"><times id="S3.SS2.SSS1.p1.7.m4.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.7.m4.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.7.m4.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.7.m4.1.1.3.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.7.m4.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.7.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m4.1c">i^{th}</annotation></semantics></math> hierarchy model.
Based on the newly meta-learner, the ensemble features <math id="S3.SS2.SSS1.p1.8.m5.1" class="ltx_Math" alttext="F_{M}" display="inline"><semantics id="S3.SS2.SSS1.p1.8.m5.1a"><msub id="S3.SS2.SSS1.p1.8.m5.1.1" xref="S3.SS2.SSS1.p1.8.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p1.8.m5.1.1.2" xref="S3.SS2.SSS1.p1.8.m5.1.1.2.cmml">F</mi><mi id="S3.SS2.SSS1.p1.8.m5.1.1.3" xref="S3.SS2.SSS1.p1.8.m5.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m5.1b"><apply id="S3.SS2.SSS1.p1.8.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.8.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.8.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.8.m5.1.1.2">𝐹</ci><ci id="S3.SS2.SSS1.p1.8.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.8.m5.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m5.1c">F_{M}</annotation></semantics></math> and the ensemble predictions <math id="S3.SS2.SSS1.p1.9.m6.1" class="ltx_Math" alttext="P_{M}" display="inline"><semantics id="S3.SS2.SSS1.p1.9.m6.1a"><msub id="S3.SS2.SSS1.p1.9.m6.1.1" xref="S3.SS2.SSS1.p1.9.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p1.9.m6.1.1.2" xref="S3.SS2.SSS1.p1.9.m6.1.1.2.cmml">P</mi><mi id="S3.SS2.SSS1.p1.9.m6.1.1.3" xref="S3.SS2.SSS1.p1.9.m6.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m6.1b"><apply id="S3.SS2.SSS1.p1.9.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.9.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.9.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p1.9.m6.1.1.2">𝑃</ci><ci id="S3.SS2.SSS1.p1.9.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p1.9.m6.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m6.1c">P_{M}</annotation></semantics></math> can be updated as follows</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\footnotesize P_{M}=\sum_{i=1}^{n}{M_{i}\cdot P_{i}},\qquad F_{M}=\sum_{i=1}^{n}{M_{i}\cdot F_{i}}." display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1"><mrow id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.3.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.cmml">P</mi><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.3.cmml">M</mi></msub><mo mathsize="80%" rspace="0.111em" id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml"><munderover id="S3.E2.m1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.3.1.cmml"><mo maxsize="80%" minsize="80%" movablelimits="false" stretchy="true" id="S3.E2.m1.1.1.1.1.1.1.3.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.1.3.cmml">n</mi></munderover><mrow id="S3.E2.m1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2.2.cmml">M</mi><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" mathsize="80%" rspace="0.222em" id="S3.E2.m1.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.1.1.1.1.1.1.3.2.1.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.2.cmml">P</mi><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo mathsize="80%" rspace="1.767em" id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.cmml"><msub id="S3.E2.m1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.cmml">F</mi><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.3.cmml">M</mi></msub><mo mathsize="80%" rspace="0.111em" id="S3.E2.m1.1.1.1.1.2.2.1" xref="S3.E2.m1.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml"><munderover id="S3.E2.m1.1.1.1.1.2.2.3.1" xref="S3.E2.m1.1.1.1.1.2.2.3.1.cmml"><mo maxsize="80%" minsize="80%" movablelimits="false" stretchy="true" id="S3.E2.m1.1.1.1.1.2.2.3.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.2" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.2.cmml">i</mi><mo mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.1" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.1.cmml">=</mo><mn mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.3" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.1.3" xref="S3.E2.m1.1.1.1.1.2.2.3.1.3.cmml">n</mi></munderover><mrow id="S3.E2.m1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.1.2.2.3.2.cmml"><msub id="S3.E2.m1.1.1.1.1.2.2.3.2.2" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2.2.cmml">M</mi><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" mathsize="80%" rspace="0.222em" id="S3.E2.m1.1.1.1.1.2.2.3.2.1" xref="S3.E2.m1.1.1.1.1.2.2.3.2.1.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.1.2.2.3.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.cmml"><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.2.3.2" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.2.cmml">F</mi><mi mathsize="80%" id="S3.E2.m1.1.1.1.1.2.2.3.2.3.3" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo lspace="0em" mathsize="80%" id="S3.E2.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3a.cmml" xref="S3.E2.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"></eq><apply id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2">𝑃</ci><ci id="S3.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3"><apply id="S3.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1.3">𝑛</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2"><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.1">⋅</ci><apply id="S3.E2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2.2">𝑀</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.2">𝑃</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2"><eq id="S3.E2.m1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1"></eq><apply id="S3.E2.m1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2">𝐹</ci><ci id="S3.E2.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.3">𝑀</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3"><apply id="S3.E2.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.2.2.3.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.3.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.2.2.3.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.2"></sum><apply id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3"><eq id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.1.2.2.3.1.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.1.3">𝑛</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2"><ci id="S3.E2.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.1">⋅</ci><apply id="S3.E2.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.3.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.3.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2.2">𝑀</ci><ci id="S3.E2.m1.1.1.1.1.2.2.3.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.2">𝐹</ci><ci id="S3.E2.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\footnotesize P_{M}=\sum_{i=1}^{n}{M_{i}\cdot P_{i}},\qquad F_{M}=\sum_{i=1}^{n}{M_{i}\cdot F_{i}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p1.11" class="ltx_p">Here, <math id="S3.SS2.SSS1.p1.10.m1.1" class="ltx_Math" alttext="F_{i}" display="inline"><semantics id="S3.SS2.SSS1.p1.10.m1.1a"><msub id="S3.SS2.SSS1.p1.10.m1.1.1" xref="S3.SS2.SSS1.p1.10.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.10.m1.1.1.2" xref="S3.SS2.SSS1.p1.10.m1.1.1.2.cmml">F</mi><mi id="S3.SS2.SSS1.p1.10.m1.1.1.3" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m1.1b"><apply id="S3.SS2.SSS1.p1.10.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.2">𝐹</ci><ci id="S3.SS2.SSS1.p1.10.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m1.1c">F_{i}</annotation></semantics></math> is the features of <math id="S3.SS2.SSS1.p1.11.m2.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS2.SSS1.p1.11.m2.1a"><msup id="S3.SS2.SSS1.p1.11.m2.1.1" xref="S3.SS2.SSS1.p1.11.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.11.m2.1.1.2" xref="S3.SS2.SSS1.p1.11.m2.1.1.2.cmml">i</mi><mrow id="S3.SS2.SSS1.p1.11.m2.1.1.3" xref="S3.SS2.SSS1.p1.11.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.11.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.11.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.11.m2.1.1.3.1" xref="S3.SS2.SSS1.p1.11.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.11.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.11.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.11.m2.1b"><apply id="S3.SS2.SSS1.p1.11.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.11.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.11.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1.2">𝑖</ci><apply id="S3.SS2.SSS1.p1.11.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1.3"><times id="S3.SS2.SSS1.p1.11.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.11.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1.3.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.11.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.11.m2.1c">i^{th}</annotation></semantics></math> hierarchy model, where it is a tensor before its fully connected layer.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.31" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.31.32" class="ltx_listingline">

</div>
<div id="algorithm1.1.1" class="ltx_listingline">
<span id="algorithm1.1.1.1" class="ltx_text"><span id="algorithm1.1.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>
i) <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">N</annotation></semantics></math>, number of devices;
</div>
<div id="algorithm1.2.2" class="ltx_listingline">
ii) <math id="algorithm1.2.2.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="algorithm1.2.2.m1.1a"><mi id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.1b"><ci id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.1c">R</annotation></semantics></math>, number of communication rounds;
</div>
<div id="algorithm1.3.3" class="ltx_listingline">
iii) <math id="algorithm1.3.3.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm1.3.3.m1.1a"><mi id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.1b"><ci id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.1c">C</annotation></semantics></math>, number of self-distillation epochs;
</div>
<div id="algorithm1.4.4" class="ltx_listingline">
iv) <math id="algorithm1.4.4.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.4.4.m1.1a"><mi id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><ci id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">K</annotation></semantics></math>, number of hierarchy model types;
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
v) <math id="algorithm1.5.5.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="algorithm1.5.5.m1.1a"><mi id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.1b"><ci id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.1c">M</annotation></semantics></math>, the meta-learner in the cloud server;
</div>
<div id="algorithm1.31.33" class="ltx_listingline">

</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<span id="algorithm1.6.6.2" class="ltx_text ltx_font_bold">while</span> <em id="algorithm1.6.6.1" class="ltx_emph ltx_font_italic"> <math id="algorithm1.6.6.1.m1.1" class="ltx_Math" alttext="true" display="inline"><semantics id="algorithm1.6.6.1.m1.1a"><mrow id="algorithm1.6.6.1.m1.1.1" xref="algorithm1.6.6.1.m1.1.1.cmml"><mi id="algorithm1.6.6.1.m1.1.1.2" xref="algorithm1.6.6.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.6.1.m1.1.1.1" xref="algorithm1.6.6.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.6.6.1.m1.1.1.3" xref="algorithm1.6.6.1.m1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.6.1.m1.1.1.1a" xref="algorithm1.6.6.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.6.6.1.m1.1.1.4" xref="algorithm1.6.6.1.m1.1.1.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.6.1.m1.1.1.1b" xref="algorithm1.6.6.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.6.6.1.m1.1.1.5" xref="algorithm1.6.6.1.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.1.m1.1b"><apply id="algorithm1.6.6.1.m1.1.1.cmml" xref="algorithm1.6.6.1.m1.1.1"><times id="algorithm1.6.6.1.m1.1.1.1.cmml" xref="algorithm1.6.6.1.m1.1.1.1"></times><ci id="algorithm1.6.6.1.m1.1.1.2.cmml" xref="algorithm1.6.6.1.m1.1.1.2">𝑡</ci><ci id="algorithm1.6.6.1.m1.1.1.3.cmml" xref="algorithm1.6.6.1.m1.1.1.3">𝑟</ci><ci id="algorithm1.6.6.1.m1.1.1.4.cmml" xref="algorithm1.6.6.1.m1.1.1.4">𝑢</ci><ci id="algorithm1.6.6.1.m1.1.1.5.cmml" xref="algorithm1.6.6.1.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.1.m1.1c">true</annotation></semantics></math></em> <span id="algorithm1.6.6.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.8.8.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.8.8.2" class="ltx_emph ltx_font_italic"> <math id="algorithm1.7.7.1.m1.1" class="ltx_Math" alttext="r\leftarrow 1" display="inline"><semantics id="algorithm1.7.7.1.m1.1a"><mrow id="algorithm1.7.7.1.m1.1.1" xref="algorithm1.7.7.1.m1.1.1.cmml"><mi id="algorithm1.7.7.1.m1.1.1.2" xref="algorithm1.7.7.1.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="algorithm1.7.7.1.m1.1.1.1" xref="algorithm1.7.7.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.7.7.1.m1.1.1.3" xref="algorithm1.7.7.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.1.m1.1b"><apply id="algorithm1.7.7.1.m1.1.1.cmml" xref="algorithm1.7.7.1.m1.1.1"><ci id="algorithm1.7.7.1.m1.1.1.1.cmml" xref="algorithm1.7.7.1.m1.1.1.1">←</ci><ci id="algorithm1.7.7.1.m1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.1.1.2">𝑟</ci><cn type="integer" id="algorithm1.7.7.1.m1.1.1.3.cmml" xref="algorithm1.7.7.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.1.m1.1c">r\leftarrow 1</annotation></semantics></math> to <math id="algorithm1.8.8.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="algorithm1.8.8.2.m2.1a"><mi id="algorithm1.8.8.2.m2.1.1" xref="algorithm1.8.8.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.2.m2.1b"><ci id="algorithm1.8.8.2.m2.1.1.cmml" xref="algorithm1.8.8.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.2.m2.1c">R</annotation></semantics></math></em> <span id="algorithm1.8.8.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.10.10.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.10.10.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.9.9.1.m1.1" class="ltx_Math" alttext="n\leftarrow 1" display="inline"><semantics id="algorithm1.9.9.1.m1.1a"><mrow id="algorithm1.9.9.1.m1.1.1" xref="algorithm1.9.9.1.m1.1.1.cmml"><mi id="algorithm1.9.9.1.m1.1.1.2" xref="algorithm1.9.9.1.m1.1.1.2.cmml">n</mi><mo stretchy="false" id="algorithm1.9.9.1.m1.1.1.1" xref="algorithm1.9.9.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.9.9.1.m1.1.1.3" xref="algorithm1.9.9.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.m1.1b"><apply id="algorithm1.9.9.1.m1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1"><ci id="algorithm1.9.9.1.m1.1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1.1">←</ci><ci id="algorithm1.9.9.1.m1.1.1.2.cmml" xref="algorithm1.9.9.1.m1.1.1.2">𝑛</ci><cn type="integer" id="algorithm1.9.9.1.m1.1.1.3.cmml" xref="algorithm1.9.9.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.m1.1c">n\leftarrow 1</annotation></semantics></math> to <math id="algorithm1.10.10.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.10.10.2.m2.1a"><mi id="algorithm1.10.10.2.m2.1.1" xref="algorithm1.10.10.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.2.m2.1b"><ci id="algorithm1.10.10.2.m2.1.1.cmml" xref="algorithm1.10.10.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.2.m2.1c">N</annotation></semantics></math></em> <span id="algorithm1.10.10.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.11.11.m1.2" class="ltx_math_unparsed" alttext="\nabla w_{G}^{r,n}\ \ \leftarrow\ Receive(n)" display="inline"><semantics id="algorithm1.11.11.m1.2a"><mrow id="algorithm1.11.11.m1.2b"><mo rspace="0.167em" id="algorithm1.11.11.m1.2.3">∇</mo><msubsup id="algorithm1.11.11.m1.2.4"><mi id="algorithm1.11.11.m1.2.4.2.2">w</mi><mi id="algorithm1.11.11.m1.2.4.2.3">G</mi><mrow id="algorithm1.11.11.m1.2.2.2.4"><mi id="algorithm1.11.11.m1.1.1.1.1">r</mi><mo id="algorithm1.11.11.m1.2.2.2.4.1">,</mo><mi id="algorithm1.11.11.m1.2.2.2.2">n</mi></mrow></msubsup><mspace width="1em" id="algorithm1.11.11.m1.2.5"></mspace><mo rspace="0.778em" stretchy="false" id="algorithm1.11.11.m1.2.6">←</mo><mi id="algorithm1.11.11.m1.2.7">R</mi><mi id="algorithm1.11.11.m1.2.8">e</mi><mi id="algorithm1.11.11.m1.2.9">c</mi><mi id="algorithm1.11.11.m1.2.10">e</mi><mi id="algorithm1.11.11.m1.2.11">i</mi><mi id="algorithm1.11.11.m1.2.12">v</mi><mi id="algorithm1.11.11.m1.2.13">e</mi><mrow id="algorithm1.11.11.m1.2.14"><mo stretchy="false" id="algorithm1.11.11.m1.2.14.1">(</mo><mi id="algorithm1.11.11.m1.2.14.2">n</mi><mo stretchy="false" id="algorithm1.11.11.m1.2.14.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.2c">\nabla w_{G}^{r,n}\ \ \leftarrow\ Receive(n)</annotation></semantics></math>;
</div>
<div id="algorithm1.31.34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.31.35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.12.12.m1.3" class="ltx_Math" alttext="\nabla w_{G\ }^{r}\leftarrow layer\_wise\_averaging(\nabla w_{H}^{r,n})" display="inline"><semantics id="algorithm1.12.12.m1.3a"><mrow id="algorithm1.12.12.m1.3.3" xref="algorithm1.12.12.m1.3.3.cmml"><mrow id="algorithm1.12.12.m1.3.3.3" xref="algorithm1.12.12.m1.3.3.3.cmml"><mo rspace="0.167em" id="algorithm1.12.12.m1.3.3.3.1" xref="algorithm1.12.12.m1.3.3.3.1.cmml">∇</mo><msubsup id="algorithm1.12.12.m1.3.3.3.2" xref="algorithm1.12.12.m1.3.3.3.2.cmml"><mi id="algorithm1.12.12.m1.3.3.3.2.2.2" xref="algorithm1.12.12.m1.3.3.3.2.2.2.cmml">w</mi><mi id="algorithm1.12.12.m1.3.3.3.2.2.3" xref="algorithm1.12.12.m1.3.3.3.2.2.3.cmml">G</mi><mi id="algorithm1.12.12.m1.3.3.3.2.3" xref="algorithm1.12.12.m1.3.3.3.2.3.cmml">r</mi></msubsup></mrow><mo stretchy="false" id="algorithm1.12.12.m1.3.3.2" xref="algorithm1.12.12.m1.3.3.2.cmml">←</mo><mrow id="algorithm1.12.12.m1.3.3.1" xref="algorithm1.12.12.m1.3.3.1.cmml"><mi id="algorithm1.12.12.m1.3.3.1.3" xref="algorithm1.12.12.m1.3.3.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.4" xref="algorithm1.12.12.m1.3.3.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2a" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.5" xref="algorithm1.12.12.m1.3.3.1.5.cmml">y</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2b" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.6" xref="algorithm1.12.12.m1.3.3.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2c" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.7" xref="algorithm1.12.12.m1.3.3.1.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2d" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi mathvariant="normal" id="algorithm1.12.12.m1.3.3.1.8" xref="algorithm1.12.12.m1.3.3.1.8.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2e" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.9" xref="algorithm1.12.12.m1.3.3.1.9.cmml">w</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2f" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.10" xref="algorithm1.12.12.m1.3.3.1.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2g" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.11" xref="algorithm1.12.12.m1.3.3.1.11.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2h" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.12" xref="algorithm1.12.12.m1.3.3.1.12.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2i" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi mathvariant="normal" id="algorithm1.12.12.m1.3.3.1.13" xref="algorithm1.12.12.m1.3.3.1.13.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2j" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.14" xref="algorithm1.12.12.m1.3.3.1.14.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2k" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.15" xref="algorithm1.12.12.m1.3.3.1.15.cmml">v</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2l" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.16" xref="algorithm1.12.12.m1.3.3.1.16.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2m" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.17" xref="algorithm1.12.12.m1.3.3.1.17.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2n" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.18" xref="algorithm1.12.12.m1.3.3.1.18.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2o" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.19" xref="algorithm1.12.12.m1.3.3.1.19.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2p" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.20" xref="algorithm1.12.12.m1.3.3.1.20.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2q" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.21" xref="algorithm1.12.12.m1.3.3.1.21.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2r" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.12.12.m1.3.3.1.22" xref="algorithm1.12.12.m1.3.3.1.22.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.12.m1.3.3.1.2s" xref="algorithm1.12.12.m1.3.3.1.2.cmml">​</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.12.12.m1.3.3.1.1.1.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml"><mo rspace="0.167em" id="algorithm1.12.12.m1.3.3.1.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.cmml">∇</mo><msubsup id="algorithm1.12.12.m1.3.3.1.1.1.1.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.cmml"><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.2.cmml">w</mi><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.3.cmml">H</mi><mrow id="algorithm1.12.12.m1.2.2.2.4" xref="algorithm1.12.12.m1.2.2.2.3.cmml"><mi id="algorithm1.12.12.m1.1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.1.cmml">r</mi><mo id="algorithm1.12.12.m1.2.2.2.4.1" xref="algorithm1.12.12.m1.2.2.2.3.cmml">,</mo><mi id="algorithm1.12.12.m1.2.2.2.2" xref="algorithm1.12.12.m1.2.2.2.2.cmml">n</mi></mrow></msubsup></mrow><mo stretchy="false" id="algorithm1.12.12.m1.3.3.1.1.1.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.3b"><apply id="algorithm1.12.12.m1.3.3.cmml" xref="algorithm1.12.12.m1.3.3"><ci id="algorithm1.12.12.m1.3.3.2.cmml" xref="algorithm1.12.12.m1.3.3.2">←</ci><apply id="algorithm1.12.12.m1.3.3.3.cmml" xref="algorithm1.12.12.m1.3.3.3"><ci id="algorithm1.12.12.m1.3.3.3.1.cmml" xref="algorithm1.12.12.m1.3.3.3.1">∇</ci><apply id="algorithm1.12.12.m1.3.3.3.2.cmml" xref="algorithm1.12.12.m1.3.3.3.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.3.2.1.cmml" xref="algorithm1.12.12.m1.3.3.3.2">superscript</csymbol><apply id="algorithm1.12.12.m1.3.3.3.2.2.cmml" xref="algorithm1.12.12.m1.3.3.3.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.3.2.2.1.cmml" xref="algorithm1.12.12.m1.3.3.3.2">subscript</csymbol><ci id="algorithm1.12.12.m1.3.3.3.2.2.2.cmml" xref="algorithm1.12.12.m1.3.3.3.2.2.2">𝑤</ci><ci id="algorithm1.12.12.m1.3.3.3.2.2.3.cmml" xref="algorithm1.12.12.m1.3.3.3.2.2.3">𝐺</ci></apply><ci id="algorithm1.12.12.m1.3.3.3.2.3.cmml" xref="algorithm1.12.12.m1.3.3.3.2.3">𝑟</ci></apply></apply><apply id="algorithm1.12.12.m1.3.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1"><times id="algorithm1.12.12.m1.3.3.1.2.cmml" xref="algorithm1.12.12.m1.3.3.1.2"></times><ci id="algorithm1.12.12.m1.3.3.1.3.cmml" xref="algorithm1.12.12.m1.3.3.1.3">𝑙</ci><ci id="algorithm1.12.12.m1.3.3.1.4.cmml" xref="algorithm1.12.12.m1.3.3.1.4">𝑎</ci><ci id="algorithm1.12.12.m1.3.3.1.5.cmml" xref="algorithm1.12.12.m1.3.3.1.5">𝑦</ci><ci id="algorithm1.12.12.m1.3.3.1.6.cmml" xref="algorithm1.12.12.m1.3.3.1.6">𝑒</ci><ci id="algorithm1.12.12.m1.3.3.1.7.cmml" xref="algorithm1.12.12.m1.3.3.1.7">𝑟</ci><ci id="algorithm1.12.12.m1.3.3.1.8.cmml" xref="algorithm1.12.12.m1.3.3.1.8">_</ci><ci id="algorithm1.12.12.m1.3.3.1.9.cmml" xref="algorithm1.12.12.m1.3.3.1.9">𝑤</ci><ci id="algorithm1.12.12.m1.3.3.1.10.cmml" xref="algorithm1.12.12.m1.3.3.1.10">𝑖</ci><ci id="algorithm1.12.12.m1.3.3.1.11.cmml" xref="algorithm1.12.12.m1.3.3.1.11">𝑠</ci><ci id="algorithm1.12.12.m1.3.3.1.12.cmml" xref="algorithm1.12.12.m1.3.3.1.12">𝑒</ci><ci id="algorithm1.12.12.m1.3.3.1.13.cmml" xref="algorithm1.12.12.m1.3.3.1.13">_</ci><ci id="algorithm1.12.12.m1.3.3.1.14.cmml" xref="algorithm1.12.12.m1.3.3.1.14">𝑎</ci><ci id="algorithm1.12.12.m1.3.3.1.15.cmml" xref="algorithm1.12.12.m1.3.3.1.15">𝑣</ci><ci id="algorithm1.12.12.m1.3.3.1.16.cmml" xref="algorithm1.12.12.m1.3.3.1.16">𝑒</ci><ci id="algorithm1.12.12.m1.3.3.1.17.cmml" xref="algorithm1.12.12.m1.3.3.1.17">𝑟</ci><ci id="algorithm1.12.12.m1.3.3.1.18.cmml" xref="algorithm1.12.12.m1.3.3.1.18">𝑎</ci><ci id="algorithm1.12.12.m1.3.3.1.19.cmml" xref="algorithm1.12.12.m1.3.3.1.19">𝑔</ci><ci id="algorithm1.12.12.m1.3.3.1.20.cmml" xref="algorithm1.12.12.m1.3.3.1.20">𝑖</ci><ci id="algorithm1.12.12.m1.3.3.1.21.cmml" xref="algorithm1.12.12.m1.3.3.1.21">𝑛</ci><ci id="algorithm1.12.12.m1.3.3.1.22.cmml" xref="algorithm1.12.12.m1.3.3.1.22">𝑔</ci><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1"><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1">∇</ci><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.2">𝑤</ci><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.3">𝐻</ci></apply><list id="algorithm1.12.12.m1.2.2.2.3.cmml" xref="algorithm1.12.12.m1.2.2.2.4"><ci id="algorithm1.12.12.m1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1.1">𝑟</ci><ci id="algorithm1.12.12.m1.2.2.2.2.cmml" xref="algorithm1.12.12.m1.2.2.2.2">𝑛</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.3c">\nabla w_{G\ }^{r}\leftarrow layer\_wise\_averaging(\nabla w_{H}^{r,n})</annotation></semantics></math>; 
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.13.13.m1.2" class="ltx_Math" alttext="w_{G}\leftarrow SGD.get\_weights(w_{G},\ \nabla w_{G\ }^{r})" display="inline"><semantics id="algorithm1.13.13.m1.2a"><mrow id="algorithm1.13.13.m1.2.2.2" xref="algorithm1.13.13.m1.2.2.3.cmml"><mrow id="algorithm1.13.13.m1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml"><msub id="algorithm1.13.13.m1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.2.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.2.2" xref="algorithm1.13.13.m1.1.1.1.1.2.2.cmml">w</mi><mi id="algorithm1.13.13.m1.1.1.1.1.2.3" xref="algorithm1.13.13.m1.1.1.1.1.2.3.cmml">G</mi></msub><mo stretchy="false" id="algorithm1.13.13.m1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.cmml">←</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.1.1.1.1.3.1" xref="algorithm1.13.13.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.13.13.m1.1.1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.1.1.3.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.1.1.1.1.3.1a" xref="algorithm1.13.13.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.13.13.m1.1.1.1.1.3.4" xref="algorithm1.13.13.m1.1.1.1.1.3.4.cmml">D</mi></mrow></mrow><mo lspace="0em" rspace="0.167em" id="algorithm1.13.13.m1.2.2.2.3" xref="algorithm1.13.13.m1.2.2.3a.cmml">.</mo><mrow id="algorithm1.13.13.m1.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.cmml"><mi id="algorithm1.13.13.m1.2.2.2.2.4" xref="algorithm1.13.13.m1.2.2.2.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.5" xref="algorithm1.13.13.m1.2.2.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3a" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.6" xref="algorithm1.13.13.m1.2.2.2.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3b" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi mathvariant="normal" id="algorithm1.13.13.m1.2.2.2.2.7" xref="algorithm1.13.13.m1.2.2.2.2.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3c" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.8" xref="algorithm1.13.13.m1.2.2.2.2.8.cmml">w</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3d" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.9" xref="algorithm1.13.13.m1.2.2.2.2.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3e" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.10" xref="algorithm1.13.13.m1.2.2.2.2.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3f" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.11" xref="algorithm1.13.13.m1.2.2.2.2.11.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3g" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.12" xref="algorithm1.13.13.m1.2.2.2.2.12.cmml">h</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3h" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.13" xref="algorithm1.13.13.m1.2.2.2.2.13.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3i" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.13.13.m1.2.2.2.2.14" xref="algorithm1.13.13.m1.2.2.2.2.14.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.2.3j" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.13.13.m1.2.2.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.13.13.m1.2.2.2.2.2.2.3" xref="algorithm1.13.13.m1.2.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.13.13.m1.2.2.2.2.1.1.1" xref="algorithm1.13.13.m1.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.13.13.m1.2.2.2.2.1.1.1.2" xref="algorithm1.13.13.m1.2.2.2.2.1.1.1.2.cmml">w</mi><mi id="algorithm1.13.13.m1.2.2.2.2.1.1.1.3" xref="algorithm1.13.13.m1.2.2.2.2.1.1.1.3.cmml">G</mi></msub><mo rspace="0.667em" id="algorithm1.13.13.m1.2.2.2.2.2.2.4" xref="algorithm1.13.13.m1.2.2.2.2.2.3.cmml">,</mo><mrow id="algorithm1.13.13.m1.2.2.2.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.cmml"><mo rspace="0.167em" id="algorithm1.13.13.m1.2.2.2.2.2.2.2.1" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.1.cmml">∇</mo><msubsup id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.cmml"><mi id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.2.cmml">w</mi><mi id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.3" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.3.cmml">G</mi><mi id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.3" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.3.cmml">r</mi></msubsup></mrow><mo stretchy="false" id="algorithm1.13.13.m1.2.2.2.2.2.2.5" xref="algorithm1.13.13.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.2b"><apply id="algorithm1.13.13.m1.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.2.2.3a.cmml" xref="algorithm1.13.13.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm1.13.13.m1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1"><ci id="algorithm1.13.13.m1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1">←</ci><apply id="algorithm1.13.13.m1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.2.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.2.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2.2">𝑤</ci><ci id="algorithm1.13.13.m1.1.1.1.1.2.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2.3">𝐺</ci></apply><apply id="algorithm1.13.13.m1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3"><times id="algorithm1.13.13.m1.1.1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.1"></times><ci id="algorithm1.13.13.m1.1.1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.2">𝑆</ci><ci id="algorithm1.13.13.m1.1.1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3">𝐺</ci><ci id="algorithm1.13.13.m1.1.1.1.1.3.4.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.4">𝐷</ci></apply></apply><apply id="algorithm1.13.13.m1.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2"><times id="algorithm1.13.13.m1.2.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.3"></times><ci id="algorithm1.13.13.m1.2.2.2.2.4.cmml" xref="algorithm1.13.13.m1.2.2.2.2.4">𝑔</ci><ci id="algorithm1.13.13.m1.2.2.2.2.5.cmml" xref="algorithm1.13.13.m1.2.2.2.2.5">𝑒</ci><ci id="algorithm1.13.13.m1.2.2.2.2.6.cmml" xref="algorithm1.13.13.m1.2.2.2.2.6">𝑡</ci><ci id="algorithm1.13.13.m1.2.2.2.2.7.cmml" xref="algorithm1.13.13.m1.2.2.2.2.7">_</ci><ci id="algorithm1.13.13.m1.2.2.2.2.8.cmml" xref="algorithm1.13.13.m1.2.2.2.2.8">𝑤</ci><ci id="algorithm1.13.13.m1.2.2.2.2.9.cmml" xref="algorithm1.13.13.m1.2.2.2.2.9">𝑒</ci><ci id="algorithm1.13.13.m1.2.2.2.2.10.cmml" xref="algorithm1.13.13.m1.2.2.2.2.10">𝑖</ci><ci id="algorithm1.13.13.m1.2.2.2.2.11.cmml" xref="algorithm1.13.13.m1.2.2.2.2.11">𝑔</ci><ci id="algorithm1.13.13.m1.2.2.2.2.12.cmml" xref="algorithm1.13.13.m1.2.2.2.2.12">ℎ</ci><ci id="algorithm1.13.13.m1.2.2.2.2.13.cmml" xref="algorithm1.13.13.m1.2.2.2.2.13">𝑡</ci><ci id="algorithm1.13.13.m1.2.2.2.2.14.cmml" xref="algorithm1.13.13.m1.2.2.2.2.14">𝑠</ci><interval closure="open" id="algorithm1.13.13.m1.2.2.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2"><apply id="algorithm1.13.13.m1.2.2.2.2.1.1.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="algorithm1.13.13.m1.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.1.1.1.2">𝑤</ci><ci id="algorithm1.13.13.m1.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.1.1.1.3">𝐺</ci></apply><apply id="algorithm1.13.13.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2"><ci id="algorithm1.13.13.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.1">∇</ci><apply id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.2">𝑤</ci><ci id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.2.3">𝐺</ci></apply><ci id="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2.2.2.3">𝑟</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.2c">w_{G}\leftarrow SGD.get\_weights(w_{G},\ \nabla w_{G\ }^{r})</annotation></semantics></math>;
</div>
<div id="algorithm1.31.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.15.15.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.15.15.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.14.14.1.m1.1" class="ltx_Math" alttext="c\leftarrow 1" display="inline"><semantics id="algorithm1.14.14.1.m1.1a"><mrow id="algorithm1.14.14.1.m1.1.1" xref="algorithm1.14.14.1.m1.1.1.cmml"><mi id="algorithm1.14.14.1.m1.1.1.2" xref="algorithm1.14.14.1.m1.1.1.2.cmml">c</mi><mo stretchy="false" id="algorithm1.14.14.1.m1.1.1.1" xref="algorithm1.14.14.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.14.14.1.m1.1.1.3" xref="algorithm1.14.14.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.1.m1.1b"><apply id="algorithm1.14.14.1.m1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1"><ci id="algorithm1.14.14.1.m1.1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1.1">←</ci><ci id="algorithm1.14.14.1.m1.1.1.2.cmml" xref="algorithm1.14.14.1.m1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.14.14.1.m1.1.1.3.cmml" xref="algorithm1.14.14.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.1.m1.1c">c\leftarrow 1</annotation></semantics></math> to <math id="algorithm1.15.15.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm1.15.15.2.m2.1a"><mi id="algorithm1.15.15.2.m2.1.1" xref="algorithm1.15.15.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.2.m2.1b"><ci id="algorithm1.15.15.2.m2.1.1.cmml" xref="algorithm1.15.15.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.2.m2.1c">C</annotation></semantics></math></em> <span id="algorithm1.15.15.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.16.16.m1.2" class="ltx_Math" alttext="(x_{public},\ y_{public})\leftarrow Public\_Data()" display="inline"><semantics id="algorithm1.16.16.m1.2a"><mrow id="algorithm1.16.16.m1.2.2" xref="algorithm1.16.16.m1.2.2.cmml"><mrow id="algorithm1.16.16.m1.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.2.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.3.cmml">(</mo><msub id="algorithm1.16.16.m1.1.1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.1.1.cmml"><mi id="algorithm1.16.16.m1.1.1.1.1.1.2" xref="algorithm1.16.16.m1.1.1.1.1.1.2.cmml">x</mi><mrow id="algorithm1.16.16.m1.1.1.1.1.1.3" xref="algorithm1.16.16.m1.1.1.1.1.1.3.cmml"><mi id="algorithm1.16.16.m1.1.1.1.1.1.3.2" xref="algorithm1.16.16.m1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.1.1.1.1.1.3.1" xref="algorithm1.16.16.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.1.1.1.1.1.3.3" xref="algorithm1.16.16.m1.1.1.1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.1.1.1.1.1.3.1a" xref="algorithm1.16.16.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.1.1.1.1.1.3.4" xref="algorithm1.16.16.m1.1.1.1.1.1.3.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.1.1.1.1.1.3.1b" xref="algorithm1.16.16.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.1.1.1.1.1.3.5" xref="algorithm1.16.16.m1.1.1.1.1.1.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.1.1.1.1.1.3.1c" xref="algorithm1.16.16.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.1.1.1.1.1.3.6" xref="algorithm1.16.16.m1.1.1.1.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.1.1.1.1.1.3.1d" xref="algorithm1.16.16.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.1.1.1.1.1.3.7" xref="algorithm1.16.16.m1.1.1.1.1.1.3.7.cmml">c</mi></mrow></msub><mo rspace="0.667em" id="algorithm1.16.16.m1.2.2.2.2.4" xref="algorithm1.16.16.m1.2.2.2.3.cmml">,</mo><msub id="algorithm1.16.16.m1.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.cmml"><mi id="algorithm1.16.16.m1.2.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.2.2.2.2.cmml">y</mi><mrow id="algorithm1.16.16.m1.2.2.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.2.3.cmml"><mi id="algorithm1.16.16.m1.2.2.2.2.2.3.2" xref="algorithm1.16.16.m1.2.2.2.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.3.1" xref="algorithm1.16.16.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.2.2.2.3.3" xref="algorithm1.16.16.m1.2.2.2.2.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.3.1a" xref="algorithm1.16.16.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.2.2.2.3.4" xref="algorithm1.16.16.m1.2.2.2.2.2.3.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.3.1b" xref="algorithm1.16.16.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.2.2.2.3.5" xref="algorithm1.16.16.m1.2.2.2.2.2.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.3.1c" xref="algorithm1.16.16.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.2.2.2.3.6" xref="algorithm1.16.16.m1.2.2.2.2.2.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.2.2.2.3.1d" xref="algorithm1.16.16.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.2.2.2.3.7" xref="algorithm1.16.16.m1.2.2.2.2.2.3.7.cmml">c</mi></mrow></msub><mo stretchy="false" id="algorithm1.16.16.m1.2.2.2.2.5" xref="algorithm1.16.16.m1.2.2.2.3.cmml">)</mo></mrow><mo stretchy="false" id="algorithm1.16.16.m1.2.2.3" xref="algorithm1.16.16.m1.2.2.3.cmml">←</mo><mrow id="algorithm1.16.16.m1.2.2.4" xref="algorithm1.16.16.m1.2.2.4.cmml"><mi id="algorithm1.16.16.m1.2.2.4.2" xref="algorithm1.16.16.m1.2.2.4.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.3" xref="algorithm1.16.16.m1.2.2.4.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1a" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.4" xref="algorithm1.16.16.m1.2.2.4.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1b" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.5" xref="algorithm1.16.16.m1.2.2.4.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1c" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.6" xref="algorithm1.16.16.m1.2.2.4.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1d" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.7" xref="algorithm1.16.16.m1.2.2.4.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1e" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.16.16.m1.2.2.4.8" xref="algorithm1.16.16.m1.2.2.4.8.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1f" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.9" xref="algorithm1.16.16.m1.2.2.4.9.cmml">D</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1g" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.10" xref="algorithm1.16.16.m1.2.2.4.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1h" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.11" xref="algorithm1.16.16.m1.2.2.4.11.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1i" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mi id="algorithm1.16.16.m1.2.2.4.12" xref="algorithm1.16.16.m1.2.2.4.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.4.1j" xref="algorithm1.16.16.m1.2.2.4.1.cmml">​</mo><mrow id="algorithm1.16.16.m1.2.2.4.13.2" xref="algorithm1.16.16.m1.2.2.4.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.2.2.4.13.2.1" xref="algorithm1.16.16.m1.2.2.4.13.1.cmml">(</mo><mo stretchy="false" id="algorithm1.16.16.m1.2.2.4.13.2.2" xref="algorithm1.16.16.m1.2.2.4.13.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.2b"><apply id="algorithm1.16.16.m1.2.2.cmml" xref="algorithm1.16.16.m1.2.2"><ci id="algorithm1.16.16.m1.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.3">←</ci><interval closure="open" id="algorithm1.16.16.m1.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2"><apply id="algorithm1.16.16.m1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.16.16.m1.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.2">𝑥</ci><apply id="algorithm1.16.16.m1.1.1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3"><times id="algorithm1.16.16.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3.1"></times><ci id="algorithm1.16.16.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3.2">𝑝</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3.3">𝑢</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.3.4.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3.4">𝑏</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.3.5.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3.5">𝑙</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.3.6.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3.6">𝑖</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.3.7.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3.7">𝑐</ci></apply></apply><apply id="algorithm1.16.16.m1.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.2">𝑦</ci><apply id="algorithm1.16.16.m1.2.2.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3"><times id="algorithm1.16.16.m1.2.2.2.2.2.3.1.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3.1"></times><ci id="algorithm1.16.16.m1.2.2.2.2.2.3.2.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3.2">𝑝</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.3.3.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3.3">𝑢</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.3.4.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3.4">𝑏</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.3.5.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3.5">𝑙</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.3.6.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3.6">𝑖</ci><ci id="algorithm1.16.16.m1.2.2.2.2.2.3.7.cmml" xref="algorithm1.16.16.m1.2.2.2.2.2.3.7">𝑐</ci></apply></apply></interval><apply id="algorithm1.16.16.m1.2.2.4.cmml" xref="algorithm1.16.16.m1.2.2.4"><times id="algorithm1.16.16.m1.2.2.4.1.cmml" xref="algorithm1.16.16.m1.2.2.4.1"></times><ci id="algorithm1.16.16.m1.2.2.4.2.cmml" xref="algorithm1.16.16.m1.2.2.4.2">𝑃</ci><ci id="algorithm1.16.16.m1.2.2.4.3.cmml" xref="algorithm1.16.16.m1.2.2.4.3">𝑢</ci><ci id="algorithm1.16.16.m1.2.2.4.4.cmml" xref="algorithm1.16.16.m1.2.2.4.4">𝑏</ci><ci id="algorithm1.16.16.m1.2.2.4.5.cmml" xref="algorithm1.16.16.m1.2.2.4.5">𝑙</ci><ci id="algorithm1.16.16.m1.2.2.4.6.cmml" xref="algorithm1.16.16.m1.2.2.4.6">𝑖</ci><ci id="algorithm1.16.16.m1.2.2.4.7.cmml" xref="algorithm1.16.16.m1.2.2.4.7">𝑐</ci><ci id="algorithm1.16.16.m1.2.2.4.8.cmml" xref="algorithm1.16.16.m1.2.2.4.8">_</ci><ci id="algorithm1.16.16.m1.2.2.4.9.cmml" xref="algorithm1.16.16.m1.2.2.4.9">𝐷</ci><ci id="algorithm1.16.16.m1.2.2.4.10.cmml" xref="algorithm1.16.16.m1.2.2.4.10">𝑎</ci><ci id="algorithm1.16.16.m1.2.2.4.11.cmml" xref="algorithm1.16.16.m1.2.2.4.11">𝑡</ci><ci id="algorithm1.16.16.m1.2.2.4.12.cmml" xref="algorithm1.16.16.m1.2.2.4.12">𝑎</ci><list id="algorithm1.16.16.m1.2.2.4.13.1.cmml" xref="algorithm1.16.16.m1.2.2.4.13.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.2c">(x_{public},\ y_{public})\leftarrow Public\_Data()</annotation></semantics></math>;
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.17.17.m1.2" class="ltx_Math" alttext="\bigcup_{i=1}^{K}\left\{F_{i},P_{i}\right\}" display="inline"><semantics id="algorithm1.17.17.m1.2a"><mrow id="algorithm1.17.17.m1.2.2" xref="algorithm1.17.17.m1.2.2.cmml"><msubsup id="algorithm1.17.17.m1.2.2.3" xref="algorithm1.17.17.m1.2.2.3.cmml"><mo id="algorithm1.17.17.m1.2.2.3.2.2" xref="algorithm1.17.17.m1.2.2.3.2.2.cmml">⋃</mo><mrow id="algorithm1.17.17.m1.2.2.3.2.3" xref="algorithm1.17.17.m1.2.2.3.2.3.cmml"><mi id="algorithm1.17.17.m1.2.2.3.2.3.2" xref="algorithm1.17.17.m1.2.2.3.2.3.2.cmml">i</mi><mo id="algorithm1.17.17.m1.2.2.3.2.3.1" xref="algorithm1.17.17.m1.2.2.3.2.3.1.cmml">=</mo><mn id="algorithm1.17.17.m1.2.2.3.2.3.3" xref="algorithm1.17.17.m1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.17.17.m1.2.2.3.3" xref="algorithm1.17.17.m1.2.2.3.3.cmml">K</mi></msubsup><mrow id="algorithm1.17.17.m1.2.2.2.2" xref="algorithm1.17.17.m1.2.2.2.3.cmml"><mo lspace="0em" id="algorithm1.17.17.m1.2.2.2.2.3" xref="algorithm1.17.17.m1.2.2.2.3.cmml">{</mo><msub id="algorithm1.17.17.m1.1.1.1.1.1" xref="algorithm1.17.17.m1.1.1.1.1.1.cmml"><mi id="algorithm1.17.17.m1.1.1.1.1.1.2" xref="algorithm1.17.17.m1.1.1.1.1.1.2.cmml">F</mi><mi id="algorithm1.17.17.m1.1.1.1.1.1.3" xref="algorithm1.17.17.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.17.17.m1.2.2.2.2.4" xref="algorithm1.17.17.m1.2.2.2.3.cmml">,</mo><msub id="algorithm1.17.17.m1.2.2.2.2.2" xref="algorithm1.17.17.m1.2.2.2.2.2.cmml"><mi id="algorithm1.17.17.m1.2.2.2.2.2.2" xref="algorithm1.17.17.m1.2.2.2.2.2.2.cmml">P</mi><mi id="algorithm1.17.17.m1.2.2.2.2.2.3" xref="algorithm1.17.17.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="algorithm1.17.17.m1.2.2.2.2.5" xref="algorithm1.17.17.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.2b"><apply id="algorithm1.17.17.m1.2.2.cmml" xref="algorithm1.17.17.m1.2.2"><apply id="algorithm1.17.17.m1.2.2.3.cmml" xref="algorithm1.17.17.m1.2.2.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.2.2.3.1.cmml" xref="algorithm1.17.17.m1.2.2.3">superscript</csymbol><apply id="algorithm1.17.17.m1.2.2.3.2.cmml" xref="algorithm1.17.17.m1.2.2.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.2.2.3.2.1.cmml" xref="algorithm1.17.17.m1.2.2.3">subscript</csymbol><union id="algorithm1.17.17.m1.2.2.3.2.2.cmml" xref="algorithm1.17.17.m1.2.2.3.2.2"></union><apply id="algorithm1.17.17.m1.2.2.3.2.3.cmml" xref="algorithm1.17.17.m1.2.2.3.2.3"><eq id="algorithm1.17.17.m1.2.2.3.2.3.1.cmml" xref="algorithm1.17.17.m1.2.2.3.2.3.1"></eq><ci id="algorithm1.17.17.m1.2.2.3.2.3.2.cmml" xref="algorithm1.17.17.m1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.17.17.m1.2.2.3.2.3.3.cmml" xref="algorithm1.17.17.m1.2.2.3.2.3.3">1</cn></apply></apply><ci id="algorithm1.17.17.m1.2.2.3.3.cmml" xref="algorithm1.17.17.m1.2.2.3.3">𝐾</ci></apply><set id="algorithm1.17.17.m1.2.2.2.3.cmml" xref="algorithm1.17.17.m1.2.2.2.2"><apply id="algorithm1.17.17.m1.1.1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.17.17.m1.1.1.1.1.1.2.cmml" xref="algorithm1.17.17.m1.1.1.1.1.1.2">𝐹</ci><ci id="algorithm1.17.17.m1.1.1.1.1.1.3.cmml" xref="algorithm1.17.17.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.17.17.m1.2.2.2.2.2.cmml" xref="algorithm1.17.17.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.2.2.2.2.2.1.cmml" xref="algorithm1.17.17.m1.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.17.17.m1.2.2.2.2.2.2.cmml" xref="algorithm1.17.17.m1.2.2.2.2.2.2">𝑃</ci><ci id="algorithm1.17.17.m1.2.2.2.2.2.3.cmml" xref="algorithm1.17.17.m1.2.2.2.2.2.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.2c">\bigcup_{i=1}^{K}\left\{F_{i},P_{i}\right\}</annotation></semantics></math> <math id="algorithm1.18.18.m2.1" class="ltx_Math" alttext="\leftarrow\ w_{G}\left(x_{public}\right)" display="inline"><semantics id="algorithm1.18.18.m2.1a"><mrow id="algorithm1.18.18.m2.1.1" xref="algorithm1.18.18.m2.1.1.cmml"><mi id="algorithm1.18.18.m2.1.1.3" xref="algorithm1.18.18.m2.1.1.3.cmml"></mi><mo rspace="0.778em" stretchy="false" id="algorithm1.18.18.m2.1.1.2" xref="algorithm1.18.18.m2.1.1.2.cmml">←</mo><mrow id="algorithm1.18.18.m2.1.1.1" xref="algorithm1.18.18.m2.1.1.1.cmml"><msub id="algorithm1.18.18.m2.1.1.1.3" xref="algorithm1.18.18.m2.1.1.1.3.cmml"><mi id="algorithm1.18.18.m2.1.1.1.3.2" xref="algorithm1.18.18.m2.1.1.1.3.2.cmml">w</mi><mi id="algorithm1.18.18.m2.1.1.1.3.3" xref="algorithm1.18.18.m2.1.1.1.3.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m2.1.1.1.2" xref="algorithm1.18.18.m2.1.1.1.2.cmml">​</mo><mrow id="algorithm1.18.18.m2.1.1.1.1.1" xref="algorithm1.18.18.m2.1.1.1.1.1.1.cmml"><mo id="algorithm1.18.18.m2.1.1.1.1.1.2" xref="algorithm1.18.18.m2.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.18.18.m2.1.1.1.1.1.1" xref="algorithm1.18.18.m2.1.1.1.1.1.1.cmml"><mi id="algorithm1.18.18.m2.1.1.1.1.1.1.2" xref="algorithm1.18.18.m2.1.1.1.1.1.1.2.cmml">x</mi><mrow id="algorithm1.18.18.m2.1.1.1.1.1.1.3" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.18.18.m2.1.1.1.1.1.1.3.2" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m2.1.1.1.1.1.1.3.1" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.18.18.m2.1.1.1.1.1.1.3.3" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m2.1.1.1.1.1.1.3.1a" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.18.18.m2.1.1.1.1.1.1.3.4" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m2.1.1.1.1.1.1.3.1b" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.18.18.m2.1.1.1.1.1.1.3.5" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m2.1.1.1.1.1.1.3.1c" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.18.18.m2.1.1.1.1.1.1.3.6" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m2.1.1.1.1.1.1.3.1d" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.18.18.m2.1.1.1.1.1.1.3.7" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.7.cmml">c</mi></mrow></msub><mo id="algorithm1.18.18.m2.1.1.1.1.1.3" xref="algorithm1.18.18.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m2.1b"><apply id="algorithm1.18.18.m2.1.1.cmml" xref="algorithm1.18.18.m2.1.1"><ci id="algorithm1.18.18.m2.1.1.2.cmml" xref="algorithm1.18.18.m2.1.1.2">←</ci><csymbol cd="latexml" id="algorithm1.18.18.m2.1.1.3.cmml" xref="algorithm1.18.18.m2.1.1.3">absent</csymbol><apply id="algorithm1.18.18.m2.1.1.1.cmml" xref="algorithm1.18.18.m2.1.1.1"><times id="algorithm1.18.18.m2.1.1.1.2.cmml" xref="algorithm1.18.18.m2.1.1.1.2"></times><apply id="algorithm1.18.18.m2.1.1.1.3.cmml" xref="algorithm1.18.18.m2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.18.18.m2.1.1.1.3.1.cmml" xref="algorithm1.18.18.m2.1.1.1.3">subscript</csymbol><ci id="algorithm1.18.18.m2.1.1.1.3.2.cmml" xref="algorithm1.18.18.m2.1.1.1.3.2">𝑤</ci><ci id="algorithm1.18.18.m2.1.1.1.3.3.cmml" xref="algorithm1.18.18.m2.1.1.1.3.3">𝐺</ci></apply><apply id="algorithm1.18.18.m2.1.1.1.1.1.1.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m2.1.1.1.1.1.1.1.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.18.18.m2.1.1.1.1.1.1.2.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.2">𝑥</ci><apply id="algorithm1.18.18.m2.1.1.1.1.1.1.3.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3"><times id="algorithm1.18.18.m2.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.18.18.m2.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.2">𝑝</ci><ci id="algorithm1.18.18.m2.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.3">𝑢</ci><ci id="algorithm1.18.18.m2.1.1.1.1.1.1.3.4.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.4">𝑏</ci><ci id="algorithm1.18.18.m2.1.1.1.1.1.1.3.5.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.5">𝑙</ci><ci id="algorithm1.18.18.m2.1.1.1.1.1.1.3.6.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.6">𝑖</ci><ci id="algorithm1.18.18.m2.1.1.1.1.1.1.3.7.cmml" xref="algorithm1.18.18.m2.1.1.1.1.1.1.3.7">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m2.1c">\leftarrow\ w_{G}\left(x_{public}\right)</annotation></semantics></math>;
</div>
<div id="algorithm1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.19.19.m1.1" class="ltx_Math" alttext="L_{M}\leftarrow CE\_loss" display="inline"><semantics id="algorithm1.19.19.m1.1a"><mrow id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml"><msub id="algorithm1.19.19.m1.1.1.2" xref="algorithm1.19.19.m1.1.1.2.cmml"><mi id="algorithm1.19.19.m1.1.1.2.2" xref="algorithm1.19.19.m1.1.1.2.2.cmml">L</mi><mi id="algorithm1.19.19.m1.1.1.2.3" xref="algorithm1.19.19.m1.1.1.2.3.cmml">M</mi></msub><mo stretchy="false" id="algorithm1.19.19.m1.1.1.1" xref="algorithm1.19.19.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.19.19.m1.1.1.3" xref="algorithm1.19.19.m1.1.1.3.cmml"><mi id="algorithm1.19.19.m1.1.1.3.2" xref="algorithm1.19.19.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.1" xref="algorithm1.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.19.19.m1.1.1.3.3" xref="algorithm1.19.19.m1.1.1.3.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.1a" xref="algorithm1.19.19.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.19.19.m1.1.1.3.4" xref="algorithm1.19.19.m1.1.1.3.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.1b" xref="algorithm1.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.19.19.m1.1.1.3.5" xref="algorithm1.19.19.m1.1.1.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.1c" xref="algorithm1.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.19.19.m1.1.1.3.6" xref="algorithm1.19.19.m1.1.1.3.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.1d" xref="algorithm1.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.19.19.m1.1.1.3.7" xref="algorithm1.19.19.m1.1.1.3.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.1e" xref="algorithm1.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.19.19.m1.1.1.3.8" xref="algorithm1.19.19.m1.1.1.3.8.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><apply id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1"><ci id="algorithm1.19.19.m1.1.1.1.cmml" xref="algorithm1.19.19.m1.1.1.1">←</ci><apply id="algorithm1.19.19.m1.1.1.2.cmml" xref="algorithm1.19.19.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.2.1.cmml" xref="algorithm1.19.19.m1.1.1.2">subscript</csymbol><ci id="algorithm1.19.19.m1.1.1.2.2.cmml" xref="algorithm1.19.19.m1.1.1.2.2">𝐿</ci><ci id="algorithm1.19.19.m1.1.1.2.3.cmml" xref="algorithm1.19.19.m1.1.1.2.3">𝑀</ci></apply><apply id="algorithm1.19.19.m1.1.1.3.cmml" xref="algorithm1.19.19.m1.1.1.3"><times id="algorithm1.19.19.m1.1.1.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.1"></times><ci id="algorithm1.19.19.m1.1.1.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.2">𝐶</ci><ci id="algorithm1.19.19.m1.1.1.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3">𝐸</ci><ci id="algorithm1.19.19.m1.1.1.3.4.cmml" xref="algorithm1.19.19.m1.1.1.3.4">_</ci><ci id="algorithm1.19.19.m1.1.1.3.5.cmml" xref="algorithm1.19.19.m1.1.1.3.5">𝑙</ci><ci id="algorithm1.19.19.m1.1.1.3.6.cmml" xref="algorithm1.19.19.m1.1.1.3.6">𝑜</ci><ci id="algorithm1.19.19.m1.1.1.3.7.cmml" xref="algorithm1.19.19.m1.1.1.3.7">𝑠</ci><ci id="algorithm1.19.19.m1.1.1.3.8.cmml" xref="algorithm1.19.19.m1.1.1.3.8">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">L_{M}\leftarrow CE\_loss</annotation></semantics></math>( <math id="algorithm1.20.20.m2.1" class="ltx_Math" alttext="\sum_{i=1}^{n}{M_{i}\cdot P_{i}}" display="inline"><semantics id="algorithm1.20.20.m2.1a"><mrow id="algorithm1.20.20.m2.1.1" xref="algorithm1.20.20.m2.1.1.cmml"><msubsup id="algorithm1.20.20.m2.1.1.1" xref="algorithm1.20.20.m2.1.1.1.cmml"><mo id="algorithm1.20.20.m2.1.1.1.2.2" xref="algorithm1.20.20.m2.1.1.1.2.2.cmml">∑</mo><mrow id="algorithm1.20.20.m2.1.1.1.2.3" xref="algorithm1.20.20.m2.1.1.1.2.3.cmml"><mi id="algorithm1.20.20.m2.1.1.1.2.3.2" xref="algorithm1.20.20.m2.1.1.1.2.3.2.cmml">i</mi><mo id="algorithm1.20.20.m2.1.1.1.2.3.1" xref="algorithm1.20.20.m2.1.1.1.2.3.1.cmml">=</mo><mn id="algorithm1.20.20.m2.1.1.1.2.3.3" xref="algorithm1.20.20.m2.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.20.20.m2.1.1.1.3" xref="algorithm1.20.20.m2.1.1.1.3.cmml">n</mi></msubsup><mrow id="algorithm1.20.20.m2.1.1.2" xref="algorithm1.20.20.m2.1.1.2.cmml"><msub id="algorithm1.20.20.m2.1.1.2.2" xref="algorithm1.20.20.m2.1.1.2.2.cmml"><mi id="algorithm1.20.20.m2.1.1.2.2.2" xref="algorithm1.20.20.m2.1.1.2.2.2.cmml">M</mi><mi id="algorithm1.20.20.m2.1.1.2.2.3" xref="algorithm1.20.20.m2.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="algorithm1.20.20.m2.1.1.2.1" xref="algorithm1.20.20.m2.1.1.2.1.cmml">⋅</mo><msub id="algorithm1.20.20.m2.1.1.2.3" xref="algorithm1.20.20.m2.1.1.2.3.cmml"><mi id="algorithm1.20.20.m2.1.1.2.3.2" xref="algorithm1.20.20.m2.1.1.2.3.2.cmml">P</mi><mi id="algorithm1.20.20.m2.1.1.2.3.3" xref="algorithm1.20.20.m2.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m2.1b"><apply id="algorithm1.20.20.m2.1.1.cmml" xref="algorithm1.20.20.m2.1.1"><apply id="algorithm1.20.20.m2.1.1.1.cmml" xref="algorithm1.20.20.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m2.1.1.1.1.cmml" xref="algorithm1.20.20.m2.1.1.1">superscript</csymbol><apply id="algorithm1.20.20.m2.1.1.1.2.cmml" xref="algorithm1.20.20.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m2.1.1.1.2.1.cmml" xref="algorithm1.20.20.m2.1.1.1">subscript</csymbol><sum id="algorithm1.20.20.m2.1.1.1.2.2.cmml" xref="algorithm1.20.20.m2.1.1.1.2.2"></sum><apply id="algorithm1.20.20.m2.1.1.1.2.3.cmml" xref="algorithm1.20.20.m2.1.1.1.2.3"><eq id="algorithm1.20.20.m2.1.1.1.2.3.1.cmml" xref="algorithm1.20.20.m2.1.1.1.2.3.1"></eq><ci id="algorithm1.20.20.m2.1.1.1.2.3.2.cmml" xref="algorithm1.20.20.m2.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.20.20.m2.1.1.1.2.3.3.cmml" xref="algorithm1.20.20.m2.1.1.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.20.20.m2.1.1.1.3.cmml" xref="algorithm1.20.20.m2.1.1.1.3">𝑛</ci></apply><apply id="algorithm1.20.20.m2.1.1.2.cmml" xref="algorithm1.20.20.m2.1.1.2"><ci id="algorithm1.20.20.m2.1.1.2.1.cmml" xref="algorithm1.20.20.m2.1.1.2.1">⋅</ci><apply id="algorithm1.20.20.m2.1.1.2.2.cmml" xref="algorithm1.20.20.m2.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m2.1.1.2.2.1.cmml" xref="algorithm1.20.20.m2.1.1.2.2">subscript</csymbol><ci id="algorithm1.20.20.m2.1.1.2.2.2.cmml" xref="algorithm1.20.20.m2.1.1.2.2.2">𝑀</ci><ci id="algorithm1.20.20.m2.1.1.2.2.3.cmml" xref="algorithm1.20.20.m2.1.1.2.2.3">𝑖</ci></apply><apply id="algorithm1.20.20.m2.1.1.2.3.cmml" xref="algorithm1.20.20.m2.1.1.2.3"><csymbol cd="ambiguous" id="algorithm1.20.20.m2.1.1.2.3.1.cmml" xref="algorithm1.20.20.m2.1.1.2.3">subscript</csymbol><ci id="algorithm1.20.20.m2.1.1.2.3.2.cmml" xref="algorithm1.20.20.m2.1.1.2.3.2">𝑃</ci><ci id="algorithm1.20.20.m2.1.1.2.3.3.cmml" xref="algorithm1.20.20.m2.1.1.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m2.1c">\sum_{i=1}^{n}{M_{i}\cdot P_{i}}</annotation></semantics></math>, <math id="algorithm1.21.21.m3.1" class="ltx_Math" alttext="y_{public}" display="inline"><semantics id="algorithm1.21.21.m3.1a"><msub id="algorithm1.21.21.m3.1.1" xref="algorithm1.21.21.m3.1.1.cmml"><mi id="algorithm1.21.21.m3.1.1.2" xref="algorithm1.21.21.m3.1.1.2.cmml">y</mi><mrow id="algorithm1.21.21.m3.1.1.3" xref="algorithm1.21.21.m3.1.1.3.cmml"><mi id="algorithm1.21.21.m3.1.1.3.2" xref="algorithm1.21.21.m3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m3.1.1.3.1" xref="algorithm1.21.21.m3.1.1.3.1.cmml">​</mo><mi id="algorithm1.21.21.m3.1.1.3.3" xref="algorithm1.21.21.m3.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m3.1.1.3.1a" xref="algorithm1.21.21.m3.1.1.3.1.cmml">​</mo><mi id="algorithm1.21.21.m3.1.1.3.4" xref="algorithm1.21.21.m3.1.1.3.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m3.1.1.3.1b" xref="algorithm1.21.21.m3.1.1.3.1.cmml">​</mo><mi id="algorithm1.21.21.m3.1.1.3.5" xref="algorithm1.21.21.m3.1.1.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m3.1.1.3.1c" xref="algorithm1.21.21.m3.1.1.3.1.cmml">​</mo><mi id="algorithm1.21.21.m3.1.1.3.6" xref="algorithm1.21.21.m3.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m3.1.1.3.1d" xref="algorithm1.21.21.m3.1.1.3.1.cmml">​</mo><mi id="algorithm1.21.21.m3.1.1.3.7" xref="algorithm1.21.21.m3.1.1.3.7.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m3.1b"><apply id="algorithm1.21.21.m3.1.1.cmml" xref="algorithm1.21.21.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m3.1.1.1.cmml" xref="algorithm1.21.21.m3.1.1">subscript</csymbol><ci id="algorithm1.21.21.m3.1.1.2.cmml" xref="algorithm1.21.21.m3.1.1.2">𝑦</ci><apply id="algorithm1.21.21.m3.1.1.3.cmml" xref="algorithm1.21.21.m3.1.1.3"><times id="algorithm1.21.21.m3.1.1.3.1.cmml" xref="algorithm1.21.21.m3.1.1.3.1"></times><ci id="algorithm1.21.21.m3.1.1.3.2.cmml" xref="algorithm1.21.21.m3.1.1.3.2">𝑝</ci><ci id="algorithm1.21.21.m3.1.1.3.3.cmml" xref="algorithm1.21.21.m3.1.1.3.3">𝑢</ci><ci id="algorithm1.21.21.m3.1.1.3.4.cmml" xref="algorithm1.21.21.m3.1.1.3.4">𝑏</ci><ci id="algorithm1.21.21.m3.1.1.3.5.cmml" xref="algorithm1.21.21.m3.1.1.3.5">𝑙</ci><ci id="algorithm1.21.21.m3.1.1.3.6.cmml" xref="algorithm1.21.21.m3.1.1.3.6">𝑖</ci><ci id="algorithm1.21.21.m3.1.1.3.7.cmml" xref="algorithm1.21.21.m3.1.1.3.7">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m3.1c">y_{public}</annotation></semantics></math>);
</div>
<div id="algorithm1.22.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.22.22.m1.2" class="ltx_Math" alttext="\nabla M\leftarrow SGD.get\_gradients(L_{M},\ w_{G})" display="inline"><semantics id="algorithm1.22.22.m1.2a"><mrow id="algorithm1.22.22.m1.2.2.2" xref="algorithm1.22.22.m1.2.2.3.cmml"><mrow id="algorithm1.22.22.m1.1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.1.cmml"><mrow id="algorithm1.22.22.m1.1.1.1.1.2" xref="algorithm1.22.22.m1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="algorithm1.22.22.m1.1.1.1.1.2.1" xref="algorithm1.22.22.m1.1.1.1.1.2.1.cmml">∇</mo><mi id="algorithm1.22.22.m1.1.1.1.1.2.2" xref="algorithm1.22.22.m1.1.1.1.1.2.2.cmml">M</mi></mrow><mo stretchy="false" id="algorithm1.22.22.m1.1.1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.1.1.cmml">←</mo><mrow id="algorithm1.22.22.m1.1.1.1.1.3" xref="algorithm1.22.22.m1.1.1.1.1.3.cmml"><mi id="algorithm1.22.22.m1.1.1.1.1.3.2" xref="algorithm1.22.22.m1.1.1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.1.1.3.1" xref="algorithm1.22.22.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.22.22.m1.1.1.1.1.3.3" xref="algorithm1.22.22.m1.1.1.1.1.3.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.1.1.3.1a" xref="algorithm1.22.22.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.22.22.m1.1.1.1.1.3.4" xref="algorithm1.22.22.m1.1.1.1.1.3.4.cmml">D</mi></mrow></mrow><mo lspace="0em" rspace="0.167em" id="algorithm1.22.22.m1.2.2.2.3" xref="algorithm1.22.22.m1.2.2.3a.cmml">.</mo><mrow id="algorithm1.22.22.m1.2.2.2.2" xref="algorithm1.22.22.m1.2.2.2.2.cmml"><mi id="algorithm1.22.22.m1.2.2.2.2.4" xref="algorithm1.22.22.m1.2.2.2.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.5" xref="algorithm1.22.22.m1.2.2.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3a" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.6" xref="algorithm1.22.22.m1.2.2.2.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3b" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi mathvariant="normal" id="algorithm1.22.22.m1.2.2.2.2.7" xref="algorithm1.22.22.m1.2.2.2.2.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3c" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.8" xref="algorithm1.22.22.m1.2.2.2.2.8.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3d" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.9" xref="algorithm1.22.22.m1.2.2.2.2.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3e" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.10" xref="algorithm1.22.22.m1.2.2.2.2.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3f" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.11" xref="algorithm1.22.22.m1.2.2.2.2.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3g" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.12" xref="algorithm1.22.22.m1.2.2.2.2.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3h" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.13" xref="algorithm1.22.22.m1.2.2.2.2.13.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3i" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.14" xref="algorithm1.22.22.m1.2.2.2.2.14.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3j" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.15" xref="algorithm1.22.22.m1.2.2.2.2.15.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3k" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.22.22.m1.2.2.2.2.16" xref="algorithm1.22.22.m1.2.2.2.2.16.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.2.2.2.2.3l" xref="algorithm1.22.22.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.22.22.m1.2.2.2.2.2.2" xref="algorithm1.22.22.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.22.22.m1.2.2.2.2.2.2.3" xref="algorithm1.22.22.m1.2.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.22.22.m1.2.2.2.2.1.1.1" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.22.22.m1.2.2.2.2.1.1.1.2" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.2.cmml">L</mi><mi id="algorithm1.22.22.m1.2.2.2.2.1.1.1.3" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.3.cmml">M</mi></msub><mo rspace="0.667em" id="algorithm1.22.22.m1.2.2.2.2.2.2.4" xref="algorithm1.22.22.m1.2.2.2.2.2.3.cmml">,</mo><msub id="algorithm1.22.22.m1.2.2.2.2.2.2.2" xref="algorithm1.22.22.m1.2.2.2.2.2.2.2.cmml"><mi id="algorithm1.22.22.m1.2.2.2.2.2.2.2.2" xref="algorithm1.22.22.m1.2.2.2.2.2.2.2.2.cmml">w</mi><mi id="algorithm1.22.22.m1.2.2.2.2.2.2.2.3" xref="algorithm1.22.22.m1.2.2.2.2.2.2.2.3.cmml">G</mi></msub><mo stretchy="false" id="algorithm1.22.22.m1.2.2.2.2.2.2.5" xref="algorithm1.22.22.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.2b"><apply id="algorithm1.22.22.m1.2.2.3.cmml" xref="algorithm1.22.22.m1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.2.2.3a.cmml" xref="algorithm1.22.22.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm1.22.22.m1.1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1"><ci id="algorithm1.22.22.m1.1.1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1.1">←</ci><apply id="algorithm1.22.22.m1.1.1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.1.1.2"><ci id="algorithm1.22.22.m1.1.1.1.1.2.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1.2.1">∇</ci><ci id="algorithm1.22.22.m1.1.1.1.1.2.2.cmml" xref="algorithm1.22.22.m1.1.1.1.1.2.2">𝑀</ci></apply><apply id="algorithm1.22.22.m1.1.1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.1.1.3"><times id="algorithm1.22.22.m1.1.1.1.1.3.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1.3.1"></times><ci id="algorithm1.22.22.m1.1.1.1.1.3.2.cmml" xref="algorithm1.22.22.m1.1.1.1.1.3.2">𝑆</ci><ci id="algorithm1.22.22.m1.1.1.1.1.3.3.cmml" xref="algorithm1.22.22.m1.1.1.1.1.3.3">𝐺</ci><ci id="algorithm1.22.22.m1.1.1.1.1.3.4.cmml" xref="algorithm1.22.22.m1.1.1.1.1.3.4">𝐷</ci></apply></apply><apply id="algorithm1.22.22.m1.2.2.2.2.cmml" xref="algorithm1.22.22.m1.2.2.2.2"><times id="algorithm1.22.22.m1.2.2.2.2.3.cmml" xref="algorithm1.22.22.m1.2.2.2.2.3"></times><ci id="algorithm1.22.22.m1.2.2.2.2.4.cmml" xref="algorithm1.22.22.m1.2.2.2.2.4">𝑔</ci><ci id="algorithm1.22.22.m1.2.2.2.2.5.cmml" xref="algorithm1.22.22.m1.2.2.2.2.5">𝑒</ci><ci id="algorithm1.22.22.m1.2.2.2.2.6.cmml" xref="algorithm1.22.22.m1.2.2.2.2.6">𝑡</ci><ci id="algorithm1.22.22.m1.2.2.2.2.7.cmml" xref="algorithm1.22.22.m1.2.2.2.2.7">_</ci><ci id="algorithm1.22.22.m1.2.2.2.2.8.cmml" xref="algorithm1.22.22.m1.2.2.2.2.8">𝑔</ci><ci id="algorithm1.22.22.m1.2.2.2.2.9.cmml" xref="algorithm1.22.22.m1.2.2.2.2.9">𝑟</ci><ci id="algorithm1.22.22.m1.2.2.2.2.10.cmml" xref="algorithm1.22.22.m1.2.2.2.2.10">𝑎</ci><ci id="algorithm1.22.22.m1.2.2.2.2.11.cmml" xref="algorithm1.22.22.m1.2.2.2.2.11">𝑑</ci><ci id="algorithm1.22.22.m1.2.2.2.2.12.cmml" xref="algorithm1.22.22.m1.2.2.2.2.12">𝑖</ci><ci id="algorithm1.22.22.m1.2.2.2.2.13.cmml" xref="algorithm1.22.22.m1.2.2.2.2.13">𝑒</ci><ci id="algorithm1.22.22.m1.2.2.2.2.14.cmml" xref="algorithm1.22.22.m1.2.2.2.2.14">𝑛</ci><ci id="algorithm1.22.22.m1.2.2.2.2.15.cmml" xref="algorithm1.22.22.m1.2.2.2.2.15">𝑡</ci><ci id="algorithm1.22.22.m1.2.2.2.2.16.cmml" xref="algorithm1.22.22.m1.2.2.2.2.16">𝑠</ci><interval closure="open" id="algorithm1.22.22.m1.2.2.2.2.2.3.cmml" xref="algorithm1.22.22.m1.2.2.2.2.2.2"><apply id="algorithm1.22.22.m1.2.2.2.2.1.1.1.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="algorithm1.22.22.m1.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.2">𝐿</ci><ci id="algorithm1.22.22.m1.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.22.22.m1.2.2.2.2.1.1.1.3">𝑀</ci></apply><apply id="algorithm1.22.22.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.22.22.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.22.22.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.22.22.m1.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.22.22.m1.2.2.2.2.2.2.2.2">𝑤</ci><ci id="algorithm1.22.22.m1.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.22.22.m1.2.2.2.2.2.2.2.3">𝐺</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.2c">\nabla M\leftarrow SGD.get\_gradients(L_{M},\ w_{G})</annotation></semantics></math>;
</div>
<div id="algorithm1.23.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.23.23.m1.1" class="ltx_math_unparsed" alttext="M\leftarrow Update(\nabla M,M" display="inline"><semantics id="algorithm1.23.23.m1.1a"><mrow id="algorithm1.23.23.m1.1b"><mi id="algorithm1.23.23.m1.1.2">M</mi><mo stretchy="false" id="algorithm1.23.23.m1.1.3">←</mo><mi id="algorithm1.23.23.m1.1.4">U</mi><mi id="algorithm1.23.23.m1.1.5">p</mi><mi id="algorithm1.23.23.m1.1.6">d</mi><mi id="algorithm1.23.23.m1.1.7">a</mi><mi id="algorithm1.23.23.m1.1.8">t</mi><mi id="algorithm1.23.23.m1.1.9">e</mi><mrow id="algorithm1.23.23.m1.1.10"><mo stretchy="false" id="algorithm1.23.23.m1.1.10.1">(</mo><mo rspace="0.167em" id="algorithm1.23.23.m1.1.10.2">∇</mo><mi id="algorithm1.23.23.m1.1.10.3">M</mi><mo id="algorithm1.23.23.m1.1.10.4">,</mo><mi id="algorithm1.23.23.m1.1.1">M</mi></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.23.23.m1.1c">M\leftarrow Update(\nabla M,M</annotation></semantics></math>);
</div>
<div id="algorithm1.24.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.24.24.m1.1" class="ltx_Math" alttext="P_{M}\leftarrow\sum_{i=1}^{n}{M_{i}\cdot P_{i}}" display="inline"><semantics id="algorithm1.24.24.m1.1a"><mrow id="algorithm1.24.24.m1.1.1" xref="algorithm1.24.24.m1.1.1.cmml"><msub id="algorithm1.24.24.m1.1.1.2" xref="algorithm1.24.24.m1.1.1.2.cmml"><mi id="algorithm1.24.24.m1.1.1.2.2" xref="algorithm1.24.24.m1.1.1.2.2.cmml">P</mi><mi id="algorithm1.24.24.m1.1.1.2.3" xref="algorithm1.24.24.m1.1.1.2.3.cmml">M</mi></msub><mo rspace="0.111em" stretchy="false" id="algorithm1.24.24.m1.1.1.1" xref="algorithm1.24.24.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.24.24.m1.1.1.3" xref="algorithm1.24.24.m1.1.1.3.cmml"><msubsup id="algorithm1.24.24.m1.1.1.3.1" xref="algorithm1.24.24.m1.1.1.3.1.cmml"><mo id="algorithm1.24.24.m1.1.1.3.1.2.2" xref="algorithm1.24.24.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.24.24.m1.1.1.3.1.2.3" xref="algorithm1.24.24.m1.1.1.3.1.2.3.cmml"><mi id="algorithm1.24.24.m1.1.1.3.1.2.3.2" xref="algorithm1.24.24.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="algorithm1.24.24.m1.1.1.3.1.2.3.1" xref="algorithm1.24.24.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.24.24.m1.1.1.3.1.2.3.3" xref="algorithm1.24.24.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.24.24.m1.1.1.3.1.3" xref="algorithm1.24.24.m1.1.1.3.1.3.cmml">n</mi></msubsup><mrow id="algorithm1.24.24.m1.1.1.3.2" xref="algorithm1.24.24.m1.1.1.3.2.cmml"><msub id="algorithm1.24.24.m1.1.1.3.2.2" xref="algorithm1.24.24.m1.1.1.3.2.2.cmml"><mi id="algorithm1.24.24.m1.1.1.3.2.2.2" xref="algorithm1.24.24.m1.1.1.3.2.2.2.cmml">M</mi><mi id="algorithm1.24.24.m1.1.1.3.2.2.3" xref="algorithm1.24.24.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="algorithm1.24.24.m1.1.1.3.2.1" xref="algorithm1.24.24.m1.1.1.3.2.1.cmml">⋅</mo><msub id="algorithm1.24.24.m1.1.1.3.2.3" xref="algorithm1.24.24.m1.1.1.3.2.3.cmml"><mi id="algorithm1.24.24.m1.1.1.3.2.3.2" xref="algorithm1.24.24.m1.1.1.3.2.3.2.cmml">P</mi><mi id="algorithm1.24.24.m1.1.1.3.2.3.3" xref="algorithm1.24.24.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m1.1b"><apply id="algorithm1.24.24.m1.1.1.cmml" xref="algorithm1.24.24.m1.1.1"><ci id="algorithm1.24.24.m1.1.1.1.cmml" xref="algorithm1.24.24.m1.1.1.1">←</ci><apply id="algorithm1.24.24.m1.1.1.2.cmml" xref="algorithm1.24.24.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.2.1.cmml" xref="algorithm1.24.24.m1.1.1.2">subscript</csymbol><ci id="algorithm1.24.24.m1.1.1.2.2.cmml" xref="algorithm1.24.24.m1.1.1.2.2">𝑃</ci><ci id="algorithm1.24.24.m1.1.1.2.3.cmml" xref="algorithm1.24.24.m1.1.1.2.3">𝑀</ci></apply><apply id="algorithm1.24.24.m1.1.1.3.cmml" xref="algorithm1.24.24.m1.1.1.3"><apply id="algorithm1.24.24.m1.1.1.3.1.cmml" xref="algorithm1.24.24.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.3.1.1.cmml" xref="algorithm1.24.24.m1.1.1.3.1">superscript</csymbol><apply id="algorithm1.24.24.m1.1.1.3.1.2.cmml" xref="algorithm1.24.24.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.3.1.2.1.cmml" xref="algorithm1.24.24.m1.1.1.3.1">subscript</csymbol><sum id="algorithm1.24.24.m1.1.1.3.1.2.2.cmml" xref="algorithm1.24.24.m1.1.1.3.1.2.2"></sum><apply id="algorithm1.24.24.m1.1.1.3.1.2.3.cmml" xref="algorithm1.24.24.m1.1.1.3.1.2.3"><eq id="algorithm1.24.24.m1.1.1.3.1.2.3.1.cmml" xref="algorithm1.24.24.m1.1.1.3.1.2.3.1"></eq><ci id="algorithm1.24.24.m1.1.1.3.1.2.3.2.cmml" xref="algorithm1.24.24.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.24.24.m1.1.1.3.1.2.3.3.cmml" xref="algorithm1.24.24.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.24.24.m1.1.1.3.1.3.cmml" xref="algorithm1.24.24.m1.1.1.3.1.3">𝑛</ci></apply><apply id="algorithm1.24.24.m1.1.1.3.2.cmml" xref="algorithm1.24.24.m1.1.1.3.2"><ci id="algorithm1.24.24.m1.1.1.3.2.1.cmml" xref="algorithm1.24.24.m1.1.1.3.2.1">⋅</ci><apply id="algorithm1.24.24.m1.1.1.3.2.2.cmml" xref="algorithm1.24.24.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.3.2.2.1.cmml" xref="algorithm1.24.24.m1.1.1.3.2.2">subscript</csymbol><ci id="algorithm1.24.24.m1.1.1.3.2.2.2.cmml" xref="algorithm1.24.24.m1.1.1.3.2.2.2">𝑀</ci><ci id="algorithm1.24.24.m1.1.1.3.2.2.3.cmml" xref="algorithm1.24.24.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="algorithm1.24.24.m1.1.1.3.2.3.cmml" xref="algorithm1.24.24.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.3.2.3.1.cmml" xref="algorithm1.24.24.m1.1.1.3.2.3">subscript</csymbol><ci id="algorithm1.24.24.m1.1.1.3.2.3.2.cmml" xref="algorithm1.24.24.m1.1.1.3.2.3.2">𝑃</ci><ci id="algorithm1.24.24.m1.1.1.3.2.3.3.cmml" xref="algorithm1.24.24.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m1.1c">P_{M}\leftarrow\sum_{i=1}^{n}{M_{i}\cdot P_{i}}</annotation></semantics></math> ;
</div>
<div id="algorithm1.25.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.25.25.m1.1" class="ltx_Math" alttext="F_{M}\leftarrow\sum_{i=1}^{n}{M_{i}\cdot F_{i}}" display="inline"><semantics id="algorithm1.25.25.m1.1a"><mrow id="algorithm1.25.25.m1.1.1" xref="algorithm1.25.25.m1.1.1.cmml"><msub id="algorithm1.25.25.m1.1.1.2" xref="algorithm1.25.25.m1.1.1.2.cmml"><mi id="algorithm1.25.25.m1.1.1.2.2" xref="algorithm1.25.25.m1.1.1.2.2.cmml">F</mi><mi id="algorithm1.25.25.m1.1.1.2.3" xref="algorithm1.25.25.m1.1.1.2.3.cmml">M</mi></msub><mo rspace="0.111em" stretchy="false" id="algorithm1.25.25.m1.1.1.1" xref="algorithm1.25.25.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.25.25.m1.1.1.3" xref="algorithm1.25.25.m1.1.1.3.cmml"><msubsup id="algorithm1.25.25.m1.1.1.3.1" xref="algorithm1.25.25.m1.1.1.3.1.cmml"><mo id="algorithm1.25.25.m1.1.1.3.1.2.2" xref="algorithm1.25.25.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.25.25.m1.1.1.3.1.2.3" xref="algorithm1.25.25.m1.1.1.3.1.2.3.cmml"><mi id="algorithm1.25.25.m1.1.1.3.1.2.3.2" xref="algorithm1.25.25.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="algorithm1.25.25.m1.1.1.3.1.2.3.1" xref="algorithm1.25.25.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.25.25.m1.1.1.3.1.2.3.3" xref="algorithm1.25.25.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.25.25.m1.1.1.3.1.3" xref="algorithm1.25.25.m1.1.1.3.1.3.cmml">n</mi></msubsup><mrow id="algorithm1.25.25.m1.1.1.3.2" xref="algorithm1.25.25.m1.1.1.3.2.cmml"><msub id="algorithm1.25.25.m1.1.1.3.2.2" xref="algorithm1.25.25.m1.1.1.3.2.2.cmml"><mi id="algorithm1.25.25.m1.1.1.3.2.2.2" xref="algorithm1.25.25.m1.1.1.3.2.2.2.cmml">M</mi><mi id="algorithm1.25.25.m1.1.1.3.2.2.3" xref="algorithm1.25.25.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="algorithm1.25.25.m1.1.1.3.2.1" xref="algorithm1.25.25.m1.1.1.3.2.1.cmml">⋅</mo><msub id="algorithm1.25.25.m1.1.1.3.2.3" xref="algorithm1.25.25.m1.1.1.3.2.3.cmml"><mi id="algorithm1.25.25.m1.1.1.3.2.3.2" xref="algorithm1.25.25.m1.1.1.3.2.3.2.cmml">F</mi><mi id="algorithm1.25.25.m1.1.1.3.2.3.3" xref="algorithm1.25.25.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m1.1b"><apply id="algorithm1.25.25.m1.1.1.cmml" xref="algorithm1.25.25.m1.1.1"><ci id="algorithm1.25.25.m1.1.1.1.cmml" xref="algorithm1.25.25.m1.1.1.1">←</ci><apply id="algorithm1.25.25.m1.1.1.2.cmml" xref="algorithm1.25.25.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.2.1.cmml" xref="algorithm1.25.25.m1.1.1.2">subscript</csymbol><ci id="algorithm1.25.25.m1.1.1.2.2.cmml" xref="algorithm1.25.25.m1.1.1.2.2">𝐹</ci><ci id="algorithm1.25.25.m1.1.1.2.3.cmml" xref="algorithm1.25.25.m1.1.1.2.3">𝑀</ci></apply><apply id="algorithm1.25.25.m1.1.1.3.cmml" xref="algorithm1.25.25.m1.1.1.3"><apply id="algorithm1.25.25.m1.1.1.3.1.cmml" xref="algorithm1.25.25.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.3.1.1.cmml" xref="algorithm1.25.25.m1.1.1.3.1">superscript</csymbol><apply id="algorithm1.25.25.m1.1.1.3.1.2.cmml" xref="algorithm1.25.25.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.3.1.2.1.cmml" xref="algorithm1.25.25.m1.1.1.3.1">subscript</csymbol><sum id="algorithm1.25.25.m1.1.1.3.1.2.2.cmml" xref="algorithm1.25.25.m1.1.1.3.1.2.2"></sum><apply id="algorithm1.25.25.m1.1.1.3.1.2.3.cmml" xref="algorithm1.25.25.m1.1.1.3.1.2.3"><eq id="algorithm1.25.25.m1.1.1.3.1.2.3.1.cmml" xref="algorithm1.25.25.m1.1.1.3.1.2.3.1"></eq><ci id="algorithm1.25.25.m1.1.1.3.1.2.3.2.cmml" xref="algorithm1.25.25.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.25.25.m1.1.1.3.1.2.3.3.cmml" xref="algorithm1.25.25.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.25.25.m1.1.1.3.1.3.cmml" xref="algorithm1.25.25.m1.1.1.3.1.3">𝑛</ci></apply><apply id="algorithm1.25.25.m1.1.1.3.2.cmml" xref="algorithm1.25.25.m1.1.1.3.2"><ci id="algorithm1.25.25.m1.1.1.3.2.1.cmml" xref="algorithm1.25.25.m1.1.1.3.2.1">⋅</ci><apply id="algorithm1.25.25.m1.1.1.3.2.2.cmml" xref="algorithm1.25.25.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.3.2.2.1.cmml" xref="algorithm1.25.25.m1.1.1.3.2.2">subscript</csymbol><ci id="algorithm1.25.25.m1.1.1.3.2.2.2.cmml" xref="algorithm1.25.25.m1.1.1.3.2.2.2">𝑀</ci><ci id="algorithm1.25.25.m1.1.1.3.2.2.3.cmml" xref="algorithm1.25.25.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="algorithm1.25.25.m1.1.1.3.2.3.cmml" xref="algorithm1.25.25.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.3.2.3.1.cmml" xref="algorithm1.25.25.m1.1.1.3.2.3">subscript</csymbol><ci id="algorithm1.25.25.m1.1.1.3.2.3.2.cmml" xref="algorithm1.25.25.m1.1.1.3.2.3.2">𝐹</ci><ci id="algorithm1.25.25.m1.1.1.3.2.3.3.cmml" xref="algorithm1.25.25.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m1.1c">F_{M}\leftarrow\sum_{i=1}^{n}{M_{i}\cdot F_{i}}</annotation></semantics></math> ;
</div>
<div id="algorithm1.26.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.26.26.m1.1" class="ltx_Math" alttext="L_{G}\leftarrow loss\_calculation()" display="inline"><semantics id="algorithm1.26.26.m1.1a"><mrow id="algorithm1.26.26.m1.1.1" xref="algorithm1.26.26.m1.1.1.cmml"><msub id="algorithm1.26.26.m1.1.1.2" xref="algorithm1.26.26.m1.1.1.2.cmml"><mi id="algorithm1.26.26.m1.1.1.2.2" xref="algorithm1.26.26.m1.1.1.2.2.cmml">L</mi><mi id="algorithm1.26.26.m1.1.1.2.3" xref="algorithm1.26.26.m1.1.1.2.3.cmml">G</mi></msub><mo stretchy="false" id="algorithm1.26.26.m1.1.1.1" xref="algorithm1.26.26.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.26.26.m1.1.1.3" xref="algorithm1.26.26.m1.1.1.3.cmml"><mi id="algorithm1.26.26.m1.1.1.3.2" xref="algorithm1.26.26.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.3" xref="algorithm1.26.26.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1a" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.4" xref="algorithm1.26.26.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1b" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.5" xref="algorithm1.26.26.m1.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1c" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.26.26.m1.1.1.3.6" xref="algorithm1.26.26.m1.1.1.3.6.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1d" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.7" xref="algorithm1.26.26.m1.1.1.3.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1e" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.8" xref="algorithm1.26.26.m1.1.1.3.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1f" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.9" xref="algorithm1.26.26.m1.1.1.3.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1g" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.10" xref="algorithm1.26.26.m1.1.1.3.10.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1h" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.11" xref="algorithm1.26.26.m1.1.1.3.11.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1i" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.12" xref="algorithm1.26.26.m1.1.1.3.12.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1j" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.13" xref="algorithm1.26.26.m1.1.1.3.13.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1k" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.14" xref="algorithm1.26.26.m1.1.1.3.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1l" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.15" xref="algorithm1.26.26.m1.1.1.3.15.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1m" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.16" xref="algorithm1.26.26.m1.1.1.3.16.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1n" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.1.3.17" xref="algorithm1.26.26.m1.1.1.3.17.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.1.3.1o" xref="algorithm1.26.26.m1.1.1.3.1.cmml">​</mo><mrow id="algorithm1.26.26.m1.1.1.3.18.2" xref="algorithm1.26.26.m1.1.1.3.cmml"><mo stretchy="false" id="algorithm1.26.26.m1.1.1.3.18.2.1" xref="algorithm1.26.26.m1.1.1.3.18.1.cmml">(</mo><mo stretchy="false" id="algorithm1.26.26.m1.1.1.3.18.2.2" xref="algorithm1.26.26.m1.1.1.3.18.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m1.1b"><apply id="algorithm1.26.26.m1.1.1.cmml" xref="algorithm1.26.26.m1.1.1"><ci id="algorithm1.26.26.m1.1.1.1.cmml" xref="algorithm1.26.26.m1.1.1.1">←</ci><apply id="algorithm1.26.26.m1.1.1.2.cmml" xref="algorithm1.26.26.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.1.1.2.1.cmml" xref="algorithm1.26.26.m1.1.1.2">subscript</csymbol><ci id="algorithm1.26.26.m1.1.1.2.2.cmml" xref="algorithm1.26.26.m1.1.1.2.2">𝐿</ci><ci id="algorithm1.26.26.m1.1.1.2.3.cmml" xref="algorithm1.26.26.m1.1.1.2.3">𝐺</ci></apply><apply id="algorithm1.26.26.m1.1.1.3.cmml" xref="algorithm1.26.26.m1.1.1.3"><times id="algorithm1.26.26.m1.1.1.3.1.cmml" xref="algorithm1.26.26.m1.1.1.3.1"></times><ci id="algorithm1.26.26.m1.1.1.3.2.cmml" xref="algorithm1.26.26.m1.1.1.3.2">𝑙</ci><ci id="algorithm1.26.26.m1.1.1.3.3.cmml" xref="algorithm1.26.26.m1.1.1.3.3">𝑜</ci><ci id="algorithm1.26.26.m1.1.1.3.4.cmml" xref="algorithm1.26.26.m1.1.1.3.4">𝑠</ci><ci id="algorithm1.26.26.m1.1.1.3.5.cmml" xref="algorithm1.26.26.m1.1.1.3.5">𝑠</ci><ci id="algorithm1.26.26.m1.1.1.3.6.cmml" xref="algorithm1.26.26.m1.1.1.3.6">_</ci><ci id="algorithm1.26.26.m1.1.1.3.7.cmml" xref="algorithm1.26.26.m1.1.1.3.7">𝑐</ci><ci id="algorithm1.26.26.m1.1.1.3.8.cmml" xref="algorithm1.26.26.m1.1.1.3.8">𝑎</ci><ci id="algorithm1.26.26.m1.1.1.3.9.cmml" xref="algorithm1.26.26.m1.1.1.3.9">𝑙</ci><ci id="algorithm1.26.26.m1.1.1.3.10.cmml" xref="algorithm1.26.26.m1.1.1.3.10">𝑐</ci><ci id="algorithm1.26.26.m1.1.1.3.11.cmml" xref="algorithm1.26.26.m1.1.1.3.11">𝑢</ci><ci id="algorithm1.26.26.m1.1.1.3.12.cmml" xref="algorithm1.26.26.m1.1.1.3.12">𝑙</ci><ci id="algorithm1.26.26.m1.1.1.3.13.cmml" xref="algorithm1.26.26.m1.1.1.3.13">𝑎</ci><ci id="algorithm1.26.26.m1.1.1.3.14.cmml" xref="algorithm1.26.26.m1.1.1.3.14">𝑡</ci><ci id="algorithm1.26.26.m1.1.1.3.15.cmml" xref="algorithm1.26.26.m1.1.1.3.15">𝑖</ci><ci id="algorithm1.26.26.m1.1.1.3.16.cmml" xref="algorithm1.26.26.m1.1.1.3.16">𝑜</ci><ci id="algorithm1.26.26.m1.1.1.3.17.cmml" xref="algorithm1.26.26.m1.1.1.3.17">𝑛</ci><list id="algorithm1.26.26.m1.1.1.3.18.1.cmml" xref="algorithm1.26.26.m1.1.1.3.18.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m1.1c">L_{G}\leftarrow loss\_calculation()</annotation></semantics></math>; (See Equation <a href="#S3.E3" title="In III-B2 Hierarchical Distillation ‣ III-B Hierarchical Self-distillation ‣ III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)

</div>
<div id="algorithm1.27.27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.27.27.m1.2" class="ltx_Math" alttext="\nabla w_{G}\leftarrow SGD.get\_gradients(L_{G},\ w_{G})" display="inline"><semantics id="algorithm1.27.27.m1.2a"><mrow id="algorithm1.27.27.m1.2.2.2" xref="algorithm1.27.27.m1.2.2.3.cmml"><mrow id="algorithm1.27.27.m1.1.1.1.1" xref="algorithm1.27.27.m1.1.1.1.1.cmml"><mrow id="algorithm1.27.27.m1.1.1.1.1.2" xref="algorithm1.27.27.m1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="algorithm1.27.27.m1.1.1.1.1.2.1" xref="algorithm1.27.27.m1.1.1.1.1.2.1.cmml">∇</mo><msub id="algorithm1.27.27.m1.1.1.1.1.2.2" xref="algorithm1.27.27.m1.1.1.1.1.2.2.cmml"><mi id="algorithm1.27.27.m1.1.1.1.1.2.2.2" xref="algorithm1.27.27.m1.1.1.1.1.2.2.2.cmml">w</mi><mi id="algorithm1.27.27.m1.1.1.1.1.2.2.3" xref="algorithm1.27.27.m1.1.1.1.1.2.2.3.cmml">G</mi></msub></mrow><mo stretchy="false" id="algorithm1.27.27.m1.1.1.1.1.1" xref="algorithm1.27.27.m1.1.1.1.1.1.cmml">←</mo><mrow id="algorithm1.27.27.m1.1.1.1.1.3" xref="algorithm1.27.27.m1.1.1.1.1.3.cmml"><mi id="algorithm1.27.27.m1.1.1.1.1.3.2" xref="algorithm1.27.27.m1.1.1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.1.1.1.1.3.1" xref="algorithm1.27.27.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.27.27.m1.1.1.1.1.3.3" xref="algorithm1.27.27.m1.1.1.1.1.3.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.1.1.1.1.3.1a" xref="algorithm1.27.27.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.27.27.m1.1.1.1.1.3.4" xref="algorithm1.27.27.m1.1.1.1.1.3.4.cmml">D</mi></mrow></mrow><mo lspace="0em" rspace="0.167em" id="algorithm1.27.27.m1.2.2.2.3" xref="algorithm1.27.27.m1.2.2.3a.cmml">.</mo><mrow id="algorithm1.27.27.m1.2.2.2.2" xref="algorithm1.27.27.m1.2.2.2.2.cmml"><mi id="algorithm1.27.27.m1.2.2.2.2.4" xref="algorithm1.27.27.m1.2.2.2.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.5" xref="algorithm1.27.27.m1.2.2.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3a" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.6" xref="algorithm1.27.27.m1.2.2.2.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3b" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi mathvariant="normal" id="algorithm1.27.27.m1.2.2.2.2.7" xref="algorithm1.27.27.m1.2.2.2.2.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3c" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.8" xref="algorithm1.27.27.m1.2.2.2.2.8.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3d" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.9" xref="algorithm1.27.27.m1.2.2.2.2.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3e" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.10" xref="algorithm1.27.27.m1.2.2.2.2.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3f" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.11" xref="algorithm1.27.27.m1.2.2.2.2.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3g" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.12" xref="algorithm1.27.27.m1.2.2.2.2.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3h" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.13" xref="algorithm1.27.27.m1.2.2.2.2.13.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3i" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.14" xref="algorithm1.27.27.m1.2.2.2.2.14.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3j" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.15" xref="algorithm1.27.27.m1.2.2.2.2.15.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3k" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm1.27.27.m1.2.2.2.2.16" xref="algorithm1.27.27.m1.2.2.2.2.16.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.2.2.2.2.3l" xref="algorithm1.27.27.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.27.27.m1.2.2.2.2.2.2" xref="algorithm1.27.27.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.27.27.m1.2.2.2.2.2.2.3" xref="algorithm1.27.27.m1.2.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.27.27.m1.2.2.2.2.1.1.1" xref="algorithm1.27.27.m1.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.27.27.m1.2.2.2.2.1.1.1.2" xref="algorithm1.27.27.m1.2.2.2.2.1.1.1.2.cmml">L</mi><mi id="algorithm1.27.27.m1.2.2.2.2.1.1.1.3" xref="algorithm1.27.27.m1.2.2.2.2.1.1.1.3.cmml">G</mi></msub><mo rspace="0.667em" id="algorithm1.27.27.m1.2.2.2.2.2.2.4" xref="algorithm1.27.27.m1.2.2.2.2.2.3.cmml">,</mo><msub id="algorithm1.27.27.m1.2.2.2.2.2.2.2" xref="algorithm1.27.27.m1.2.2.2.2.2.2.2.cmml"><mi id="algorithm1.27.27.m1.2.2.2.2.2.2.2.2" xref="algorithm1.27.27.m1.2.2.2.2.2.2.2.2.cmml">w</mi><mi id="algorithm1.27.27.m1.2.2.2.2.2.2.2.3" xref="algorithm1.27.27.m1.2.2.2.2.2.2.2.3.cmml">G</mi></msub><mo stretchy="false" id="algorithm1.27.27.m1.2.2.2.2.2.2.5" xref="algorithm1.27.27.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m1.2b"><apply id="algorithm1.27.27.m1.2.2.3.cmml" xref="algorithm1.27.27.m1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.2.2.3a.cmml" xref="algorithm1.27.27.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm1.27.27.m1.1.1.1.1.cmml" xref="algorithm1.27.27.m1.1.1.1.1"><ci id="algorithm1.27.27.m1.1.1.1.1.1.cmml" xref="algorithm1.27.27.m1.1.1.1.1.1">←</ci><apply id="algorithm1.27.27.m1.1.1.1.1.2.cmml" xref="algorithm1.27.27.m1.1.1.1.1.2"><ci id="algorithm1.27.27.m1.1.1.1.1.2.1.cmml" xref="algorithm1.27.27.m1.1.1.1.1.2.1">∇</ci><apply id="algorithm1.27.27.m1.1.1.1.1.2.2.cmml" xref="algorithm1.27.27.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.1.1.1.2.2.1.cmml" xref="algorithm1.27.27.m1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm1.27.27.m1.1.1.1.1.2.2.2.cmml" xref="algorithm1.27.27.m1.1.1.1.1.2.2.2">𝑤</ci><ci id="algorithm1.27.27.m1.1.1.1.1.2.2.3.cmml" xref="algorithm1.27.27.m1.1.1.1.1.2.2.3">𝐺</ci></apply></apply><apply id="algorithm1.27.27.m1.1.1.1.1.3.cmml" xref="algorithm1.27.27.m1.1.1.1.1.3"><times id="algorithm1.27.27.m1.1.1.1.1.3.1.cmml" xref="algorithm1.27.27.m1.1.1.1.1.3.1"></times><ci id="algorithm1.27.27.m1.1.1.1.1.3.2.cmml" xref="algorithm1.27.27.m1.1.1.1.1.3.2">𝑆</ci><ci id="algorithm1.27.27.m1.1.1.1.1.3.3.cmml" xref="algorithm1.27.27.m1.1.1.1.1.3.3">𝐺</ci><ci id="algorithm1.27.27.m1.1.1.1.1.3.4.cmml" xref="algorithm1.27.27.m1.1.1.1.1.3.4">𝐷</ci></apply></apply><apply id="algorithm1.27.27.m1.2.2.2.2.cmml" xref="algorithm1.27.27.m1.2.2.2.2"><times id="algorithm1.27.27.m1.2.2.2.2.3.cmml" xref="algorithm1.27.27.m1.2.2.2.2.3"></times><ci id="algorithm1.27.27.m1.2.2.2.2.4.cmml" xref="algorithm1.27.27.m1.2.2.2.2.4">𝑔</ci><ci id="algorithm1.27.27.m1.2.2.2.2.5.cmml" xref="algorithm1.27.27.m1.2.2.2.2.5">𝑒</ci><ci id="algorithm1.27.27.m1.2.2.2.2.6.cmml" xref="algorithm1.27.27.m1.2.2.2.2.6">𝑡</ci><ci id="algorithm1.27.27.m1.2.2.2.2.7.cmml" xref="algorithm1.27.27.m1.2.2.2.2.7">_</ci><ci id="algorithm1.27.27.m1.2.2.2.2.8.cmml" xref="algorithm1.27.27.m1.2.2.2.2.8">𝑔</ci><ci id="algorithm1.27.27.m1.2.2.2.2.9.cmml" xref="algorithm1.27.27.m1.2.2.2.2.9">𝑟</ci><ci id="algorithm1.27.27.m1.2.2.2.2.10.cmml" xref="algorithm1.27.27.m1.2.2.2.2.10">𝑎</ci><ci id="algorithm1.27.27.m1.2.2.2.2.11.cmml" xref="algorithm1.27.27.m1.2.2.2.2.11">𝑑</ci><ci id="algorithm1.27.27.m1.2.2.2.2.12.cmml" xref="algorithm1.27.27.m1.2.2.2.2.12">𝑖</ci><ci id="algorithm1.27.27.m1.2.2.2.2.13.cmml" xref="algorithm1.27.27.m1.2.2.2.2.13">𝑒</ci><ci id="algorithm1.27.27.m1.2.2.2.2.14.cmml" xref="algorithm1.27.27.m1.2.2.2.2.14">𝑛</ci><ci id="algorithm1.27.27.m1.2.2.2.2.15.cmml" xref="algorithm1.27.27.m1.2.2.2.2.15">𝑡</ci><ci id="algorithm1.27.27.m1.2.2.2.2.16.cmml" xref="algorithm1.27.27.m1.2.2.2.2.16">𝑠</ci><interval closure="open" id="algorithm1.27.27.m1.2.2.2.2.2.3.cmml" xref="algorithm1.27.27.m1.2.2.2.2.2.2"><apply id="algorithm1.27.27.m1.2.2.2.2.1.1.1.cmml" xref="algorithm1.27.27.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.27.27.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="algorithm1.27.27.m1.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.27.27.m1.2.2.2.2.1.1.1.2">𝐿</ci><ci id="algorithm1.27.27.m1.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.27.27.m1.2.2.2.2.1.1.1.3">𝐺</ci></apply><apply id="algorithm1.27.27.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.27.27.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.27.27.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.27.27.m1.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.27.27.m1.2.2.2.2.2.2.2.2">𝑤</ci><ci id="algorithm1.27.27.m1.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.27.27.m1.2.2.2.2.2.2.2.3">𝐺</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m1.2c">\nabla w_{G}\leftarrow SGD.get\_gradients(L_{G},\ w_{G})</annotation></semantics></math>;
</div>
<div id="algorithm1.28.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.28.28.m1.1" class="ltx_math_unparsed" alttext="w_{G}\leftarrow Update(\nabla w_{G},w_{G}" display="inline"><semantics id="algorithm1.28.28.m1.1a"><mrow id="algorithm1.28.28.m1.1b"><msub id="algorithm1.28.28.m1.1.1"><mi id="algorithm1.28.28.m1.1.1.2">w</mi><mi id="algorithm1.28.28.m1.1.1.3">G</mi></msub><mo stretchy="false" id="algorithm1.28.28.m1.1.2">←</mo><mi id="algorithm1.28.28.m1.1.3">U</mi><mi id="algorithm1.28.28.m1.1.4">p</mi><mi id="algorithm1.28.28.m1.1.5">d</mi><mi id="algorithm1.28.28.m1.1.6">a</mi><mi id="algorithm1.28.28.m1.1.7">t</mi><mi id="algorithm1.28.28.m1.1.8">e</mi><mrow id="algorithm1.28.28.m1.1.9"><mo stretchy="false" id="algorithm1.28.28.m1.1.9.1">(</mo><mo rspace="0.167em" id="algorithm1.28.28.m1.1.9.2">∇</mo><msub id="algorithm1.28.28.m1.1.9.3"><mi id="algorithm1.28.28.m1.1.9.3.2">w</mi><mi id="algorithm1.28.28.m1.1.9.3.3">G</mi></msub><mo id="algorithm1.28.28.m1.1.9.4">,</mo><msub id="algorithm1.28.28.m1.1.9.5"><mi id="algorithm1.28.28.m1.1.9.5.2">w</mi><mi id="algorithm1.28.28.m1.1.9.5.3">G</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.28.28.m1.1c">w_{G}\leftarrow Update(\nabla w_{G},w_{G}</annotation></semantics></math>);
</div>
<div id="algorithm1.31.37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.31.38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.31.39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.30.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.30.30.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.30.30.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.29.29.1.m1.1" class="ltx_Math" alttext="n\leftarrow 1" display="inline"><semantics id="algorithm1.29.29.1.m1.1a"><mrow id="algorithm1.29.29.1.m1.1.1" xref="algorithm1.29.29.1.m1.1.1.cmml"><mi id="algorithm1.29.29.1.m1.1.1.2" xref="algorithm1.29.29.1.m1.1.1.2.cmml">n</mi><mo stretchy="false" id="algorithm1.29.29.1.m1.1.1.1" xref="algorithm1.29.29.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.29.29.1.m1.1.1.3" xref="algorithm1.29.29.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.1.m1.1b"><apply id="algorithm1.29.29.1.m1.1.1.cmml" xref="algorithm1.29.29.1.m1.1.1"><ci id="algorithm1.29.29.1.m1.1.1.1.cmml" xref="algorithm1.29.29.1.m1.1.1.1">←</ci><ci id="algorithm1.29.29.1.m1.1.1.2.cmml" xref="algorithm1.29.29.1.m1.1.1.2">𝑛</ci><cn type="integer" id="algorithm1.29.29.1.m1.1.1.3.cmml" xref="algorithm1.29.29.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.1.m1.1c">n\leftarrow 1</annotation></semantics></math> to <math id="algorithm1.30.30.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.30.30.2.m2.1a"><mi id="algorithm1.30.30.2.m2.1.1" xref="algorithm1.30.30.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.2.m2.1b"><ci id="algorithm1.30.30.2.m2.1.1.cmml" xref="algorithm1.30.30.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.2.m2.1c">N</annotation></semantics></math></em> <span id="algorithm1.30.30.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.31.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.31.31.m1.2" class="ltx_Math" alttext="Send(n,w_{G}^{n})" display="inline"><semantics id="algorithm1.31.31.m1.2a"><mrow id="algorithm1.31.31.m1.2.2" xref="algorithm1.31.31.m1.2.2.cmml"><mi id="algorithm1.31.31.m1.2.2.3" xref="algorithm1.31.31.m1.2.2.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.31.31.m1.2.2.2" xref="algorithm1.31.31.m1.2.2.2.cmml">​</mo><mi id="algorithm1.31.31.m1.2.2.4" xref="algorithm1.31.31.m1.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.31.31.m1.2.2.2a" xref="algorithm1.31.31.m1.2.2.2.cmml">​</mo><mi id="algorithm1.31.31.m1.2.2.5" xref="algorithm1.31.31.m1.2.2.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.31.31.m1.2.2.2b" xref="algorithm1.31.31.m1.2.2.2.cmml">​</mo><mi id="algorithm1.31.31.m1.2.2.6" xref="algorithm1.31.31.m1.2.2.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm1.31.31.m1.2.2.2c" xref="algorithm1.31.31.m1.2.2.2.cmml">​</mo><mrow id="algorithm1.31.31.m1.2.2.1.1" xref="algorithm1.31.31.m1.2.2.1.2.cmml"><mo stretchy="false" id="algorithm1.31.31.m1.2.2.1.1.2" xref="algorithm1.31.31.m1.2.2.1.2.cmml">(</mo><mi id="algorithm1.31.31.m1.1.1" xref="algorithm1.31.31.m1.1.1.cmml">n</mi><mo id="algorithm1.31.31.m1.2.2.1.1.3" xref="algorithm1.31.31.m1.2.2.1.2.cmml">,</mo><msubsup id="algorithm1.31.31.m1.2.2.1.1.1" xref="algorithm1.31.31.m1.2.2.1.1.1.cmml"><mi id="algorithm1.31.31.m1.2.2.1.1.1.2.2" xref="algorithm1.31.31.m1.2.2.1.1.1.2.2.cmml">w</mi><mi id="algorithm1.31.31.m1.2.2.1.1.1.2.3" xref="algorithm1.31.31.m1.2.2.1.1.1.2.3.cmml">G</mi><mi id="algorithm1.31.31.m1.2.2.1.1.1.3" xref="algorithm1.31.31.m1.2.2.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="algorithm1.31.31.m1.2.2.1.1.4" xref="algorithm1.31.31.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.m1.2b"><apply id="algorithm1.31.31.m1.2.2.cmml" xref="algorithm1.31.31.m1.2.2"><times id="algorithm1.31.31.m1.2.2.2.cmml" xref="algorithm1.31.31.m1.2.2.2"></times><ci id="algorithm1.31.31.m1.2.2.3.cmml" xref="algorithm1.31.31.m1.2.2.3">𝑆</ci><ci id="algorithm1.31.31.m1.2.2.4.cmml" xref="algorithm1.31.31.m1.2.2.4">𝑒</ci><ci id="algorithm1.31.31.m1.2.2.5.cmml" xref="algorithm1.31.31.m1.2.2.5">𝑛</ci><ci id="algorithm1.31.31.m1.2.2.6.cmml" xref="algorithm1.31.31.m1.2.2.6">𝑑</ci><interval closure="open" id="algorithm1.31.31.m1.2.2.1.2.cmml" xref="algorithm1.31.31.m1.2.2.1.1"><ci id="algorithm1.31.31.m1.1.1.cmml" xref="algorithm1.31.31.m1.1.1">𝑛</ci><apply id="algorithm1.31.31.m1.2.2.1.1.1.cmml" xref="algorithm1.31.31.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.31.31.m1.2.2.1.1.1.1.cmml" xref="algorithm1.31.31.m1.2.2.1.1.1">superscript</csymbol><apply id="algorithm1.31.31.m1.2.2.1.1.1.2.cmml" xref="algorithm1.31.31.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.31.31.m1.2.2.1.1.1.2.1.cmml" xref="algorithm1.31.31.m1.2.2.1.1.1">subscript</csymbol><ci id="algorithm1.31.31.m1.2.2.1.1.1.2.2.cmml" xref="algorithm1.31.31.m1.2.2.1.1.1.2.2">𝑤</ci><ci id="algorithm1.31.31.m1.2.2.1.1.1.2.3.cmml" xref="algorithm1.31.31.m1.2.2.1.1.1.2.3">𝐺</ci></apply><ci id="algorithm1.31.31.m1.2.2.1.1.1.3.cmml" xref="algorithm1.31.31.m1.2.2.1.1.1.3">𝑛</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.m1.2c">Send(n,w_{G}^{n})</annotation></semantics></math>;
</div>
<div id="algorithm1.31.40" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.31.41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.31.42" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.31.43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.31.44" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.31.45" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span> end while
</div>
<div id="algorithm1.31.46" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.33.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Training Procedure of HierarchyFL (Cloud)</figcaption>
</figure>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Test accuracy comparison for four scenarios using three heterogeneous federated learning methods.</figcaption>
<table id="S3.T1.18" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.18.19.1" class="ltx_tr">
<td id="S3.T1.18.19.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">DataSet</td>
<td id="S3.T1.18.19.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="12">CIFAR10</td>
</tr>
<tr id="S3.T1.18.20.2" class="ltx_tr">
<td id="S3.T1.18.20.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Methods</td>
<td id="S3.T1.18.20.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">HeteroFL</td>
<td id="S3.T1.18.20.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">Fedproto</td>
<td id="S3.T1.18.20.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">HierarchyFL (Ours)</td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<td id="S3.T1.9.9.10" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Distribution</td>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mi id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.2.2.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.2.2.2.m1.1a"><mi id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b"><ci id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">\alpha</annotation></semantics></math>=0.5</td>
<td id="S3.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.3.3.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.3.3.3.m1.1a"><mi id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><ci id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S3.T1.9.9.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">IID</td>
<td id="S3.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.4.4.4.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.4.4.4.m1.1a"><mi id="S3.T1.4.4.4.m1.1.1" xref="S3.T1.4.4.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.m1.1b"><ci id="S3.T1.4.4.4.m1.1.1.cmml" xref="S3.T1.4.4.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
<td id="S3.T1.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.5.5.5.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.5.5.5.m1.1a"><mi id="S3.T1.5.5.5.m1.1.1" xref="S3.T1.5.5.5.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.m1.1b"><ci id="S3.T1.5.5.5.m1.1.1.cmml" xref="S3.T1.5.5.5.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.m1.1c">\alpha</annotation></semantics></math>=0.5</td>
<td id="S3.T1.6.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.6.6.6.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.6.6.6.m1.1a"><mi id="S3.T1.6.6.6.m1.1.1" xref="S3.T1.6.6.6.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.m1.1b"><ci id="S3.T1.6.6.6.m1.1.1.cmml" xref="S3.T1.6.6.6.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S3.T1.9.9.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">IID</td>
<td id="S3.T1.7.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.7.7.7.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.7.7.7.m1.1a"><mi id="S3.T1.7.7.7.m1.1.1" xref="S3.T1.7.7.7.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.m1.1b"><ci id="S3.T1.7.7.7.m1.1.1.cmml" xref="S3.T1.7.7.7.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
<td id="S3.T1.8.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.8.8.8.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.8.8.8.m1.1a"><mi id="S3.T1.8.8.8.m1.1.1" xref="S3.T1.8.8.8.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.m1.1b"><ci id="S3.T1.8.8.8.m1.1.1.cmml" xref="S3.T1.8.8.8.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.m1.1c">\alpha</annotation></semantics></math>=0.5</td>
<td id="S3.T1.9.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.9.9.9.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.9.9.9.m1.1a"><mi id="S3.T1.9.9.9.m1.1.1" xref="S3.T1.9.9.9.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.9.m1.1b"><ci id="S3.T1.9.9.9.m1.1.1.cmml" xref="S3.T1.9.9.9.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.9.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S3.T1.9.9.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">IID</td>
</tr>
<tr id="S3.T1.18.21.3" class="ltx_tr">
<td id="S3.T1.18.21.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Model 1</td>
<td id="S3.T1.18.21.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">49.40</td>
<td id="S3.T1.18.21.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75.03</td>
<td id="S3.T1.18.21.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">81.28</td>
<td id="S3.T1.18.21.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85.86</td>
<td id="S3.T1.18.21.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">21.81</td>
<td id="S3.T1.18.21.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">49.89</td>
<td id="S3.T1.18.21.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.83</td>
<td id="S3.T1.18.21.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.03</td>
<td id="S3.T1.18.21.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.21.3.10.1" class="ltx_text ltx_font_bold">69.43</span></td>
<td id="S3.T1.18.21.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.21.3.11.1" class="ltx_text ltx_font_bold">81.33</span></td>
<td id="S3.T1.18.21.3.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.21.3.12.1" class="ltx_text ltx_font_bold">83.52</span></td>
<td id="S3.T1.18.21.3.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.21.3.13.1" class="ltx_text ltx_font_bold">86.41</span></td>
</tr>
<tr id="S3.T1.18.22.4" class="ltx_tr">
<td id="S3.T1.18.22.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Model 2</td>
<td id="S3.T1.18.22.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.41</td>
<td id="S3.T1.18.22.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">79.46</td>
<td id="S3.T1.18.22.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">84.10</td>
<td id="S3.T1.18.22.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">87.12</td>
<td id="S3.T1.18.22.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">25.05</td>
<td id="S3.T1.18.22.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">42.76</td>
<td id="S3.T1.18.22.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.80</td>
<td id="S3.T1.18.22.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.51</td>
<td id="S3.T1.18.22.4.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.22.4.10.1" class="ltx_text ltx_font_bold">76.91</span></td>
<td id="S3.T1.18.22.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.22.4.11.1" class="ltx_text ltx_font_bold">84.25</span></td>
<td id="S3.T1.18.22.4.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.22.4.12.1" class="ltx_text ltx_font_bold">86.00</span></td>
<td id="S3.T1.18.22.4.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.22.4.13.1" class="ltx_text ltx_font_bold">87.80</span></td>
</tr>
<tr id="S3.T1.18.23.5" class="ltx_tr">
<td id="S3.T1.18.23.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Model 3</td>
<td id="S3.T1.18.23.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.93</td>
<td id="S3.T1.18.23.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.23.5.3.1" class="ltx_text ltx_font_bold">87.80</span></td>
<td id="S3.T1.18.23.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">88.17</td>
<td id="S3.T1.18.23.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">88.86</td>
<td id="S3.T1.18.23.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.24</td>
<td id="S3.T1.18.23.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.50</td>
<td id="S3.T1.18.23.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.52</td>
<td id="S3.T1.18.23.5.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.54</td>
<td id="S3.T1.18.23.5.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.23.5.10.1" class="ltx_text ltx_font_bold">83.18</span></td>
<td id="S3.T1.18.23.5.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">86.86</td>
<td id="S3.T1.18.23.5.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.23.5.12.1" class="ltx_text ltx_font_bold">89.07</span></td>
<td id="S3.T1.18.23.5.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.23.5.13.1" class="ltx_text ltx_font_bold">89.70</span></td>
</tr>
<tr id="S3.T1.18.24.6" class="ltx_tr">
<td id="S3.T1.18.24.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Model 4</td>
<td id="S3.T1.18.24.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75.33</td>
<td id="S3.T1.18.24.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.24.6.3.1" class="ltx_text ltx_font_bold">87.75</span></td>
<td id="S3.T1.18.24.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">88.90</td>
<td id="S3.T1.18.24.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.21</td>
<td id="S3.T1.18.24.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.20</td>
<td id="S3.T1.18.24.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">58.59</td>
<td id="S3.T1.18.24.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.38</td>
<td id="S3.T1.18.24.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.22</td>
<td id="S3.T1.18.24.6.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.24.6.10.1" class="ltx_text ltx_font_bold">82.90</span></td>
<td id="S3.T1.18.24.6.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">86.92</td>
<td id="S3.T1.18.24.6.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.24.6.12.1" class="ltx_text ltx_font_bold">89.15</span></td>
<td id="S3.T1.18.24.6.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.24.6.13.1" class="ltx_text ltx_font_bold">89.62</span></td>
</tr>
<tr id="S3.T1.18.25.7" class="ltx_tr">
<td id="S3.T1.18.25.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">DataSet</td>
<td id="S3.T1.18.25.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="12">CIFAR100</td>
</tr>
<tr id="S3.T1.18.26.8" class="ltx_tr">
<td id="S3.T1.18.26.8.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Methods</td>
<td id="S3.T1.18.26.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">HeteroFL</td>
<td id="S3.T1.18.26.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">Fedproto</td>
<td id="S3.T1.18.26.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">HierarchyFL (Ours)</td>
</tr>
<tr id="S3.T1.18.18" class="ltx_tr">
<td id="S3.T1.18.18.10" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Distribution</td>
<td id="S3.T1.10.10.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.10.10.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.10.10.1.m1.1a"><mi id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><ci id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
<td id="S3.T1.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.11.11.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.11.11.2.m1.1a"><mi id="S3.T1.11.11.2.m1.1.1" xref="S3.T1.11.11.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.2.m1.1b"><ci id="S3.T1.11.11.2.m1.1.1.cmml" xref="S3.T1.11.11.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.2.m1.1c">\alpha</annotation></semantics></math>=0.5</td>
<td id="S3.T1.12.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.12.12.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.12.12.3.m1.1a"><mi id="S3.T1.12.12.3.m1.1.1" xref="S3.T1.12.12.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.3.m1.1b"><ci id="S3.T1.12.12.3.m1.1.1.cmml" xref="S3.T1.12.12.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.3.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S3.T1.18.18.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">IID</td>
<td id="S3.T1.13.13.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.13.13.4.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.13.13.4.m1.1a"><mi id="S3.T1.13.13.4.m1.1.1" xref="S3.T1.13.13.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.4.m1.1b"><ci id="S3.T1.13.13.4.m1.1.1.cmml" xref="S3.T1.13.13.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.4.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
<td id="S3.T1.14.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.14.14.5.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.14.14.5.m1.1a"><mi id="S3.T1.14.14.5.m1.1.1" xref="S3.T1.14.14.5.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.5.m1.1b"><ci id="S3.T1.14.14.5.m1.1.1.cmml" xref="S3.T1.14.14.5.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.5.m1.1c">\alpha</annotation></semantics></math>=0.5</td>
<td id="S3.T1.15.15.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.15.15.6.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.15.15.6.m1.1a"><mi id="S3.T1.15.15.6.m1.1.1" xref="S3.T1.15.15.6.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.6.m1.1b"><ci id="S3.T1.15.15.6.m1.1.1.cmml" xref="S3.T1.15.15.6.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.6.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S3.T1.18.18.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">IID</td>
<td id="S3.T1.16.16.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.16.16.7.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.16.16.7.m1.1a"><mi id="S3.T1.16.16.7.m1.1.1" xref="S3.T1.16.16.7.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.7.m1.1b"><ci id="S3.T1.16.16.7.m1.1.1.cmml" xref="S3.T1.16.16.7.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.7.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
<td id="S3.T1.17.17.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.17.17.8.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.17.17.8.m1.1a"><mi id="S3.T1.17.17.8.m1.1.1" xref="S3.T1.17.17.8.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.8.m1.1b"><ci id="S3.T1.17.17.8.m1.1.1.cmml" xref="S3.T1.17.17.8.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.8.m1.1c">\alpha</annotation></semantics></math>=0.5</td>
<td id="S3.T1.18.18.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.18.18.9.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.18.18.9.m1.1a"><mi id="S3.T1.18.18.9.m1.1.1" xref="S3.T1.18.18.9.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.9.m1.1b"><ci id="S3.T1.18.18.9.m1.1.1.cmml" xref="S3.T1.18.18.9.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.9.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S3.T1.18.18.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">IID</td>
</tr>
<tr id="S3.T1.18.27.9" class="ltx_tr">
<td id="S3.T1.18.27.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Model 1</td>
<td id="S3.T1.18.27.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">34.85</td>
<td id="S3.T1.18.27.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">48.65</td>
<td id="S3.T1.18.27.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.19</td>
<td id="S3.T1.18.27.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.88</td>
<td id="S3.T1.18.27.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">13.28</td>
<td id="S3.T1.18.27.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">21.23</td>
<td id="S3.T1.18.27.9.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24.41</td>
<td id="S3.T1.18.27.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">31.08</td>
<td id="S3.T1.18.27.9.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.27.9.10.1" class="ltx_text ltx_font_bold">42.33</span></td>
<td id="S3.T1.18.27.9.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.27.9.11.1" class="ltx_text ltx_font_bold">52.32</span></td>
<td id="S3.T1.18.27.9.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.27.9.12.1" class="ltx_text ltx_font_bold">53.14</span></td>
<td id="S3.T1.18.27.9.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.27.9.13.1" class="ltx_text ltx_font_bold">56.31</span></td>
</tr>
<tr id="S3.T1.18.28.10" class="ltx_tr">
<td id="S3.T1.18.28.10.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Model 2</td>
<td id="S3.T1.18.28.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.15</td>
<td id="S3.T1.18.28.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.96</td>
<td id="S3.T1.18.28.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.84</td>
<td id="S3.T1.18.28.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.58</td>
<td id="S3.T1.18.28.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">14.84</td>
<td id="S3.T1.18.28.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23.52</td>
<td id="S3.T1.18.28.10.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">25.28</td>
<td id="S3.T1.18.28.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.58</td>
<td id="S3.T1.18.28.10.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.28.10.10.1" class="ltx_text ltx_font_bold">46.44</span></td>
<td id="S3.T1.18.28.10.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.28.10.11.1" class="ltx_text ltx_font_bold">53.89</span></td>
<td id="S3.T1.18.28.10.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.28.10.12.1" class="ltx_text ltx_font_bold">56.26</span></td>
<td id="S3.T1.18.28.10.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.28.10.13.1" class="ltx_text ltx_font_bold">58.63</span></td>
</tr>
<tr id="S3.T1.18.29.11" class="ltx_tr">
<td id="S3.T1.18.29.11.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Model 3</td>
<td id="S3.T1.18.29.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">45.13</td>
<td id="S3.T1.18.29.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.11</td>
<td id="S3.T1.18.29.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.50</td>
<td id="S3.T1.18.29.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.55</td>
<td id="S3.T1.18.29.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15.80</td>
<td id="S3.T1.18.29.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24.05</td>
<td id="S3.T1.18.29.11.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">26.59</td>
<td id="S3.T1.18.29.11.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.06</td>
<td id="S3.T1.18.29.11.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.29.11.10.1" class="ltx_text ltx_font_bold">51.77</span></td>
<td id="S3.T1.18.29.11.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.29.11.11.1" class="ltx_text ltx_font_bold">58.95</span></td>
<td id="S3.T1.18.29.11.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.29.11.12.1" class="ltx_text ltx_font_bold">58.96</span></td>
<td id="S3.T1.18.29.11.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.18.29.11.13.1" class="ltx_text ltx_font_bold">60.16</span></td>
</tr>
<tr id="S3.T1.18.30.12" class="ltx_tr">
<td id="S3.T1.18.30.12.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Model 4</td>
<td id="S3.T1.18.30.12.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">47.09</td>
<td id="S3.T1.18.30.12.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">57.64</td>
<td id="S3.T1.18.30.12.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">57.29</td>
<td id="S3.T1.18.30.12.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">58.56</td>
<td id="S3.T1.18.30.12.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">18.18</td>
<td id="S3.T1.18.30.12.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">26.05</td>
<td id="S3.T1.18.30.12.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">27.00</td>
<td id="S3.T1.18.30.12.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">29.60</td>
<td id="S3.T1.18.30.12.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S3.T1.18.30.12.10.1" class="ltx_text ltx_font_bold">52.56</span></td>
<td id="S3.T1.18.30.12.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S3.T1.18.30.12.11.1" class="ltx_text ltx_font_bold">59.92</span></td>
<td id="S3.T1.18.30.12.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S3.T1.18.30.12.12.1" class="ltx_text ltx_font_bold">59.49</span></td>
<td id="S3.T1.18.30.12.13" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S3.T1.18.30.12.13.1" class="ltx_text ltx_font_bold">60.35</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS2.4.1.1" class="ltx_text">III-B</span>2 </span>Hierarchical Distillation</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">After the ensemble library is updated, the ensemble features and predictions can be used as the ensemble knowledge for the hierarchical self-distillation, which can be fully considered the diversity of each hierarchy model.
Note that since the ensemble library can get excellent performance based on the diversity of each hierarchy model, the distillation target of each hierarchy model should be different for effective knowledge sharing.
To maintain the diversity of each hierarchy model, the loss function of hierarchical self-distillation can be formulated as</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\footnotesize L_{G}=\sum_{i=1}^{n}\begin{cases}KL(P_{i},P_{n})+\beta\cdot MSE(F_{i},F_{n}),\quad\ if\quad i&lt;n,\\
KL(P_{i},P_{M})+\beta\cdot MSE(F_{i},F_{M}),\ if\quad i=n.\end{cases}" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.3" xref="S3.E3.m1.2.3.cmml"><msub id="S3.E3.m1.2.3.2" xref="S3.E3.m1.2.3.2.cmml"><mi mathsize="80%" id="S3.E3.m1.2.3.2.2" xref="S3.E3.m1.2.3.2.2.cmml">L</mi><mi mathsize="80%" id="S3.E3.m1.2.3.2.3" xref="S3.E3.m1.2.3.2.3.cmml">G</mi></msub><mo mathsize="80%" rspace="0.111em" id="S3.E3.m1.2.3.1" xref="S3.E3.m1.2.3.1.cmml">=</mo><mrow id="S3.E3.m1.2.3.3" xref="S3.E3.m1.2.3.3.cmml"><munderover id="S3.E3.m1.2.3.3.1" xref="S3.E3.m1.2.3.3.1.cmml"><mo maxsize="80%" minsize="80%" movablelimits="false" rspace="0em" stretchy="true" id="S3.E3.m1.2.3.3.1.2.2" xref="S3.E3.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.3.3.1.2.3" xref="S3.E3.m1.2.3.3.1.2.3.cmml"><mi mathsize="80%" id="S3.E3.m1.2.3.3.1.2.3.2" xref="S3.E3.m1.2.3.3.1.2.3.2.cmml">i</mi><mo mathsize="80%" id="S3.E3.m1.2.3.3.1.2.3.1" xref="S3.E3.m1.2.3.3.1.2.3.1.cmml">=</mo><mn mathsize="80%" id="S3.E3.m1.2.3.3.1.2.3.3" xref="S3.E3.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="80%" id="S3.E3.m1.2.3.3.1.3" xref="S3.E3.m1.2.3.3.1.3.cmml">n</mi></munderover><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.3.3.2.1.cmml"><mo id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.3.3.2.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.3.3.2.1.cmml"><mtr id="S3.E3.m1.2.2.2a" xref="S3.E3.m1.2.3.3.2.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.2.2.2b" xref="S3.E3.m1.2.3.3.2.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.4.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3a" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo maxsize="80%" minsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">P</mi><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">P</mi><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">n</mi></msub><mo maxsize="80%" minsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.5" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.5" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.cmml"><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml">β</mi><mo lspace="0.222em" mathsize="80%" rspace="0.222em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml">⋅</mo><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml">M</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.5" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3a" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.6" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.6.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3b" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml"><mo maxsize="80%" minsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.cmml"><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml">F</mi><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml">i</mi></msub><mo mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.cmml"><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.2.cmml">F</mi><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.3.cmml">n</mi></msub><mo maxsize="80%" minsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.5" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo mathsize="80%" rspace="1.367em" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">f</mi><mo lspace="0.800em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.1a" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.4.cmml">i</mi></mrow></mrow><mo mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">&lt;</mo><mi mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.4.cmml">n</mi></mrow><mo mathsize="80%" id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd><mtd id="S3.E3.m1.2.2.2c" xref="S3.E3.m1.2.3.3.2.1.1.cmml"></mtd></mtr><mtr id="S3.E3.m1.2.2.2d" xref="S3.E3.m1.2.3.3.2.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.2.2.2e" xref="S3.E3.m1.2.3.3.2.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.3.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml"><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.4" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.4.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.5" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.3a" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mo maxsize="80%" minsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">P</mi><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml">P</mi><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">M</mi></msub><mo maxsize="80%" minsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.5" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.5" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.cmml"><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.2.cmml">β</mi><mo lspace="0.222em" mathsize="80%" rspace="0.222em" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.1.cmml">⋅</mo><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.3.cmml">M</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.5" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3a" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.6" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.6.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3b" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3.cmml">​</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.3.cmml"><mo maxsize="80%" minsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msub id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.cmml"><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.2.cmml">F</mi><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.3.cmml">i</mi></msub><mo mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.4" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.cmml"><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.2.cmml">F</mi><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.3.cmml">M</mi></msub><mo maxsize="80%" minsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.5" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo mathsize="80%" rspace="0.567em" id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.cmml"><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.1.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.3.cmml">f</mi><mo lspace="0.800em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.1a" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.1.cmml">​</mo><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.4" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.4.cmml">i</mi></mrow></mrow><mo mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.3.cmml">=</mo><mi mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.1.4" xref="S3.E3.m1.2.2.2.2.1.1.1.1.4.cmml">n</mi></mrow><mo lspace="0em" mathsize="80%" id="S3.E3.m1.2.2.2.2.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.cmml">.</mo></mrow></mtd><mtd id="S3.E3.m1.2.2.2f" xref="S3.E3.m1.2.3.3.2.1.1.cmml"></mtd></mtr></mtable></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.3.cmml" xref="S3.E3.m1.2.3"><eq id="S3.E3.m1.2.3.1.cmml" xref="S3.E3.m1.2.3.1"></eq><apply id="S3.E3.m1.2.3.2.cmml" xref="S3.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.1.cmml" xref="S3.E3.m1.2.3.2">subscript</csymbol><ci id="S3.E3.m1.2.3.2.2.cmml" xref="S3.E3.m1.2.3.2.2">𝐿</ci><ci id="S3.E3.m1.2.3.2.3.cmml" xref="S3.E3.m1.2.3.2.3">𝐺</ci></apply><apply id="S3.E3.m1.2.3.3.cmml" xref="S3.E3.m1.2.3.3"><apply id="S3.E3.m1.2.3.3.1.cmml" xref="S3.E3.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.1.1.cmml" xref="S3.E3.m1.2.3.3.1">superscript</csymbol><apply id="S3.E3.m1.2.3.3.1.2.cmml" xref="S3.E3.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.1.2.1.cmml" xref="S3.E3.m1.2.3.3.1">subscript</csymbol><sum id="S3.E3.m1.2.3.3.1.2.2.cmml" xref="S3.E3.m1.2.3.3.1.2.2"></sum><apply id="S3.E3.m1.2.3.3.1.2.3.cmml" xref="S3.E3.m1.2.3.3.1.2.3"><eq id="S3.E3.m1.2.3.3.1.2.3.1.cmml" xref="S3.E3.m1.2.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.2.3.3.1.2.3.2.cmml" xref="S3.E3.m1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.2.3.3.1.2.3.3.cmml" xref="S3.E3.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.3.3.1.3.cmml" xref="S3.E3.m1.2.3.3.1.3">𝑛</ci></apply><apply id="S3.E3.m1.2.3.3.2.1.cmml" xref="S3.E3.m1.2.2"><csymbol cd="latexml" id="S3.E3.m1.2.3.3.2.1.1.cmml" xref="S3.E3.m1.2.2.3">cases</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><lt id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3"></lt><list id="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.5"></plus><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.4">𝐾</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.5">𝐿</ci><interval closure="open" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑃</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑃</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑛</ci></apply></interval></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.3"></times><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4"><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.1">⋅</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.2">𝛽</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.4.3">𝑀</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.5">𝑆</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.6.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.6">𝐸</ci><interval closure="open" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.2">𝐹</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.2">𝐹</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.2.3">𝑛</ci></apply></interval></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝑖</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3">𝑓</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.4">𝑖</ci></apply></list><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.4">𝑛</ci></apply><ci id="S3.E3.m1.2.3.3.2.1.3a.cmml" xref="S3.E3.m1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.2.3.3.2.1.3.cmml" xref="S3.E3.m1.2.2.3">otherwise</mtext></ci><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1"><eq id="S3.E3.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.3"></eq><list id="S3.E3.m1.2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2"><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1"><plus id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.5"></plus><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.3"></times><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.4">𝐾</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.5">𝐿</ci><interval closure="open" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2"><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑃</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.2">𝑃</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.2.2.3">𝑀</ci></apply></interval></apply><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4"><times id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.3"></times><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4"><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.1">⋅</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.2">𝛽</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.4.3">𝑀</ci></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.5">𝑆</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.6.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.6">𝐸</ci><interval closure="open" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2"><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.2">𝐹</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.2">𝐹</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.4.2.2.2.3">𝑀</ci></apply></interval></apply></apply><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2"><times id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.1"></times><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.2">𝑖</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.3">𝑓</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.2.2.2.4">𝑖</ci></apply></list><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.4">𝑛</ci></apply><ci id="S3.E3.m1.2.3.3.2.1.5a.cmml" xref="S3.E3.m1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.2.3.3.2.1.5.cmml" xref="S3.E3.m1.2.2.3">otherwise</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\footnotesize L_{G}=\sum_{i=1}^{n}\begin{cases}KL(P_{i},P_{n})+\beta\cdot MSE(F_{i},F_{n}),\quad\ if\quad i&lt;n,\\
KL(P_{i},P_{M})+\beta\cdot MSE(F_{i},F_{M}),\ if\quad i=n.\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p2.5" class="ltx_p">where <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mi id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><ci id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">G</annotation></semantics></math> is the global model in the cloud hierarchical self-distillation period, <math id="S3.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="KL" display="inline"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><mrow id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.2.m2.1.1.2" xref="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.2.m2.1.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.2.m2.1.1.3" xref="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><apply id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1"><times id="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.1"></times><ci id="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.2">𝐾</ci><ci id="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">KL</annotation></semantics></math> and <math id="S3.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="MSE" display="inline"><semantics id="S3.SS2.SSS2.p2.3.m3.1a"><mrow id="S3.SS2.SSS2.p2.3.m3.1.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p2.3.m3.1.1.2" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.3.m3.1.1.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.3.m3.1.1.3" xref="S3.SS2.SSS2.p2.3.m3.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.3.m3.1.1.1a" xref="S3.SS2.SSS2.p2.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.3.m3.1.1.4" xref="S3.SS2.SSS2.p2.3.m3.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m3.1b"><apply id="S3.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1"><times id="S3.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.1"></times><ci id="S3.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2">𝑀</ci><ci id="S3.SS2.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.3">𝑆</ci><ci id="S3.SS2.SSS2.p2.3.m3.1.1.4.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m3.1c">MSE</annotation></semantics></math> are the Kullback-Leibler divergence and Mean Squared Error loss functions, <math id="S3.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.SSS2.p2.4.m4.1a"><mi id="S3.SS2.SSS2.p2.4.m4.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m4.1b"><ci id="S3.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m4.1c">\beta</annotation></semantics></math> means the importance of <math id="S3.SS2.SSS2.p2.5.m5.1" class="ltx_Math" alttext="MSE" display="inline"><semantics id="S3.SS2.SSS2.p2.5.m5.1a"><mrow id="S3.SS2.SSS2.p2.5.m5.1.1" xref="S3.SS2.SSS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p2.5.m5.1.1.2" xref="S3.SS2.SSS2.p2.5.m5.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.5.m5.1.1.1" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.5.m5.1.1.3" xref="S3.SS2.SSS2.p2.5.m5.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.5.m5.1.1.1a" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.5.m5.1.1.4" xref="S3.SS2.SSS2.p2.5.m5.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.5.m5.1b"><apply id="S3.SS2.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1"><times id="S3.SS2.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1.1"></times><ci id="S3.SS2.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1.2">𝑀</ci><ci id="S3.SS2.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1.3">𝑆</ci><ci id="S3.SS2.SSS2.p2.5.m5.1.1.4.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.5.m5.1c">MSE</annotation></semantics></math> loss function in hierarchical self-distillation. Based on this loss function, each hierarchy model can be trained from the ensemble library to realize effective knowledge sharing by hierarchical self-distillation.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic"> Training Procedure of HierarchyFL</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">This subsection details the training procedure of HierarchyFL on both devices and the cloud server.
</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS3.SSS1.4.1.1" class="ltx_text">III-C</span>1 </span>Training Procedure of HierarchyFL (Cloud)</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.2" class="ltx_p">Algorithm <a href="#algorithm1" title="In III-B1 Ensemble Library Update ‣ III-B Hierarchical Self-distillation ‣ III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the training procedure of the cloud server in HierarchyFL, including gradient average, layer-wise aggregation, and hierarchical self-distillation. In Algorithm <a href="#algorithm1" title="In III-B1 Ensemble Library Update ‣ III-B Hierarchical Self-distillation ‣ III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the training procedure
will be conducted with consecutive <math id="S3.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">R</annotation></semantics></math> communication rounds in the cloud server (lines 2-23).
Specifically, lines 3-5 receive gradients from <math id="S3.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">N</annotation></semantics></math> heterogeneous AIoT deceives.
Line 6 conducts the layer-alignment averaging way for gradients of each hierarchy model.
Line 7 aggregates the global model by adding the averaged hierarchy model gradients to the global model updated by the previous communication round.
Lines 8-15 update the meta-learner based on a few public images, where the ensemble features and predictions can be updated by newly meta-learner. Lines 16-19 use the updated ensemble library to execute hierarchical self-distillation for each hierarchy model.
Lines 20-22 dispatch the part of the global model (i.e., the hierarchy model of all AIoT devices) to all the participating AIoT devices in an asynchronous way.</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS3.SSS2.4.1.1" class="ltx_text">III-C</span>2 </span>Training Procedure of HierarchyFL (Device)</h4>

<figure id="algorithm2" class="ltx_float ltx_algorithm">
<div id="algorithm2.19" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm2.1.1" class="ltx_listingline">

<span id="algorithm2.1.1.1" class="ltx_text"><span id="algorithm2.1.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>
i) <math id="algorithm2.1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm2.1.1.m1.1a"><mi id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.1b"><ci id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.1c">S</annotation></semantics></math>, cloud server;

</div>
<div id="algorithm2.2.2" class="ltx_listingline">ii) <math id="algorithm2.2.2.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="algorithm2.2.2.m1.1a"><mi id="algorithm2.2.2.m1.1.1" xref="algorithm2.2.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m1.1b"><ci id="algorithm2.2.2.m1.1.1.cmml" xref="algorithm2.2.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m1.1c">n</annotation></semantics></math>, index of device;

</div>
<div id="algorithm2.3.3" class="ltx_listingline">iii) <math id="algorithm2.3.3.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="algorithm2.3.3.m1.1a"><mi id="algorithm2.3.3.m1.1.1" xref="algorithm2.3.3.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m1.1b"><ci id="algorithm2.3.3.m1.1.1.cmml" xref="algorithm2.3.3.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m1.1c">R</annotation></semantics></math>, number of communication rounds;

</div>
<div id="algorithm2.4.4" class="ltx_listingline">iv) <math id="algorithm2.4.4.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm2.4.4.m1.1a"><mi id="algorithm2.4.4.m1.1.1" xref="algorithm2.4.4.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m1.1b"><ci id="algorithm2.4.4.m1.1.1.cmml" xref="algorithm2.4.4.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m1.1c">E</annotation></semantics></math>, number of local training epochs;

</div>
<div id="algorithm2.5.5" class="ltx_listingline">v) <math id="algorithm2.5.5.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="algorithm2.5.5.m1.1a"><mi id="algorithm2.5.5.m1.1.1" xref="algorithm2.5.5.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m1.1b"><ci id="algorithm2.5.5.m1.1.1.cmml" xref="algorithm2.5.5.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m1.1c">D</annotation></semantics></math>, local device model;

</div>
<div id="algorithm2.6.6" class="ltx_listingline">
<span id="algorithm2.6.6.1" class="ltx_text"><span id="algorithm2.6.6.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>
<math id="algorithm2.6.6.m1.1" class="ltx_Math" alttext="w_{D}" display="inline"><semantics id="algorithm2.6.6.m1.1a"><msub id="algorithm2.6.6.m1.1.1" xref="algorithm2.6.6.m1.1.1.cmml"><mi id="algorithm2.6.6.m1.1.1.2" xref="algorithm2.6.6.m1.1.1.2.cmml">w</mi><mi id="algorithm2.6.6.m1.1.1.3" xref="algorithm2.6.6.m1.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m1.1b"><apply id="algorithm2.6.6.m1.1.1.cmml" xref="algorithm2.6.6.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.6.6.m1.1.1.1.cmml" xref="algorithm2.6.6.m1.1.1">subscript</csymbol><ci id="algorithm2.6.6.m1.1.1.2.cmml" xref="algorithm2.6.6.m1.1.1.2">𝑤</ci><ci id="algorithm2.6.6.m1.1.1.3.cmml" xref="algorithm2.6.6.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m1.1c">w_{D}</annotation></semantics></math>

</div>
<div id="algorithm2.7.7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<math id="algorithm2.7.7.m1.2" class="ltx_Math" alttext="(x,\ y)\leftarrow Collect()" display="inline"><semantics id="algorithm2.7.7.m1.2a"><mrow id="algorithm2.7.7.m1.2.3" xref="algorithm2.7.7.m1.2.3.cmml"><mrow id="algorithm2.7.7.m1.2.3.2.2" xref="algorithm2.7.7.m1.2.3.2.1.cmml"><mo stretchy="false" id="algorithm2.7.7.m1.2.3.2.2.1" xref="algorithm2.7.7.m1.2.3.2.1.cmml">(</mo><mi id="algorithm2.7.7.m1.1.1" xref="algorithm2.7.7.m1.1.1.cmml">x</mi><mo rspace="0.667em" id="algorithm2.7.7.m1.2.3.2.2.2" xref="algorithm2.7.7.m1.2.3.2.1.cmml">,</mo><mi id="algorithm2.7.7.m1.2.2" xref="algorithm2.7.7.m1.2.2.cmml">y</mi><mo stretchy="false" id="algorithm2.7.7.m1.2.3.2.2.3" xref="algorithm2.7.7.m1.2.3.2.1.cmml">)</mo></mrow><mo stretchy="false" id="algorithm2.7.7.m1.2.3.1" xref="algorithm2.7.7.m1.2.3.1.cmml">←</mo><mrow id="algorithm2.7.7.m1.2.3.3" xref="algorithm2.7.7.m1.2.3.3.cmml"><mi id="algorithm2.7.7.m1.2.3.3.2" xref="algorithm2.7.7.m1.2.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm2.7.7.m1.2.3.3.1" xref="algorithm2.7.7.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.7.7.m1.2.3.3.3" xref="algorithm2.7.7.m1.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm2.7.7.m1.2.3.3.1a" xref="algorithm2.7.7.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.7.7.m1.2.3.3.4" xref="algorithm2.7.7.m1.2.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm2.7.7.m1.2.3.3.1b" xref="algorithm2.7.7.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.7.7.m1.2.3.3.5" xref="algorithm2.7.7.m1.2.3.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm2.7.7.m1.2.3.3.1c" xref="algorithm2.7.7.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.7.7.m1.2.3.3.6" xref="algorithm2.7.7.m1.2.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.7.7.m1.2.3.3.1d" xref="algorithm2.7.7.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.7.7.m1.2.3.3.7" xref="algorithm2.7.7.m1.2.3.3.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm2.7.7.m1.2.3.3.1e" xref="algorithm2.7.7.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.7.7.m1.2.3.3.8" xref="algorithm2.7.7.m1.2.3.3.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.7.7.m1.2.3.3.1f" xref="algorithm2.7.7.m1.2.3.3.1.cmml">​</mo><mrow id="algorithm2.7.7.m1.2.3.3.9.2" xref="algorithm2.7.7.m1.2.3.3.cmml"><mo stretchy="false" id="algorithm2.7.7.m1.2.3.3.9.2.1" xref="algorithm2.7.7.m1.2.3.3.9.1.cmml">(</mo><mo stretchy="false" id="algorithm2.7.7.m1.2.3.3.9.2.2" xref="algorithm2.7.7.m1.2.3.3.9.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m1.2b"><apply id="algorithm2.7.7.m1.2.3.cmml" xref="algorithm2.7.7.m1.2.3"><ci id="algorithm2.7.7.m1.2.3.1.cmml" xref="algorithm2.7.7.m1.2.3.1">←</ci><interval closure="open" id="algorithm2.7.7.m1.2.3.2.1.cmml" xref="algorithm2.7.7.m1.2.3.2.2"><ci id="algorithm2.7.7.m1.1.1.cmml" xref="algorithm2.7.7.m1.1.1">𝑥</ci><ci id="algorithm2.7.7.m1.2.2.cmml" xref="algorithm2.7.7.m1.2.2">𝑦</ci></interval><apply id="algorithm2.7.7.m1.2.3.3.cmml" xref="algorithm2.7.7.m1.2.3.3"><times id="algorithm2.7.7.m1.2.3.3.1.cmml" xref="algorithm2.7.7.m1.2.3.3.1"></times><ci id="algorithm2.7.7.m1.2.3.3.2.cmml" xref="algorithm2.7.7.m1.2.3.3.2">𝐶</ci><ci id="algorithm2.7.7.m1.2.3.3.3.cmml" xref="algorithm2.7.7.m1.2.3.3.3">𝑜</ci><ci id="algorithm2.7.7.m1.2.3.3.4.cmml" xref="algorithm2.7.7.m1.2.3.3.4">𝑙</ci><ci id="algorithm2.7.7.m1.2.3.3.5.cmml" xref="algorithm2.7.7.m1.2.3.3.5">𝑙</ci><ci id="algorithm2.7.7.m1.2.3.3.6.cmml" xref="algorithm2.7.7.m1.2.3.3.6">𝑒</ci><ci id="algorithm2.7.7.m1.2.3.3.7.cmml" xref="algorithm2.7.7.m1.2.3.3.7">𝑐</ci><ci id="algorithm2.7.7.m1.2.3.3.8.cmml" xref="algorithm2.7.7.m1.2.3.3.8">𝑡</ci><list id="algorithm2.7.7.m1.2.3.3.9.1.cmml" xref="algorithm2.7.7.m1.2.3.3.9.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m1.2c">(x,\ y)\leftarrow Collect()</annotation></semantics></math>;
</div>
<div id="algorithm2.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
<span id="algorithm2.10.10.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.10.10.3" class="ltx_emph ltx_font_italic"><math id="algorithm2.8.8.1.m1.1" class="ltx_Math" alttext="r\leftarrow" display="inline"><semantics id="algorithm2.8.8.1.m1.1a"><mrow id="algorithm2.8.8.1.m1.1.1" xref="algorithm2.8.8.1.m1.1.1.cmml"><mi id="algorithm2.8.8.1.m1.1.1.2" xref="algorithm2.8.8.1.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="algorithm2.8.8.1.m1.1.1.1" xref="algorithm2.8.8.1.m1.1.1.1.cmml">←</mo><mi id="algorithm2.8.8.1.m1.1.1.3" xref="algorithm2.8.8.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.1.m1.1b"><apply id="algorithm2.8.8.1.m1.1.1.cmml" xref="algorithm2.8.8.1.m1.1.1"><ci id="algorithm2.8.8.1.m1.1.1.1.cmml" xref="algorithm2.8.8.1.m1.1.1.1">←</ci><ci id="algorithm2.8.8.1.m1.1.1.2.cmml" xref="algorithm2.8.8.1.m1.1.1.2">𝑟</ci><csymbol cd="latexml" id="algorithm2.8.8.1.m1.1.1.3.cmml" xref="algorithm2.8.8.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.1.m1.1c">r\leftarrow</annotation></semantics></math> <math id="algorithm2.9.9.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="algorithm2.9.9.2.m2.1a"><mn id="algorithm2.9.9.2.m2.1.1" xref="algorithm2.9.9.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.2.m2.1b"><cn type="integer" id="algorithm2.9.9.2.m2.1.1.cmml" xref="algorithm2.9.9.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.2.m2.1c">1</annotation></semantics></math> to <math id="algorithm2.10.10.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="algorithm2.10.10.3.m3.1a"><mi id="algorithm2.10.10.3.m3.1.1" xref="algorithm2.10.10.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.3.m3.1b"><ci id="algorithm2.10.10.3.m3.1.1.cmml" xref="algorithm2.10.10.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.3.m3.1c">R</annotation></semantics></math></em> <span id="algorithm2.10.10.5" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.13.13.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.13.13.3" class="ltx_emph ltx_font_italic"><math id="algorithm2.11.11.1.m1.1" class="ltx_Math" alttext="e\leftarrow" display="inline"><semantics id="algorithm2.11.11.1.m1.1a"><mrow id="algorithm2.11.11.1.m1.1.1" xref="algorithm2.11.11.1.m1.1.1.cmml"><mi id="algorithm2.11.11.1.m1.1.1.2" xref="algorithm2.11.11.1.m1.1.1.2.cmml">e</mi><mo stretchy="false" id="algorithm2.11.11.1.m1.1.1.1" xref="algorithm2.11.11.1.m1.1.1.1.cmml">←</mo><mi id="algorithm2.11.11.1.m1.1.1.3" xref="algorithm2.11.11.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.1.m1.1b"><apply id="algorithm2.11.11.1.m1.1.1.cmml" xref="algorithm2.11.11.1.m1.1.1"><ci id="algorithm2.11.11.1.m1.1.1.1.cmml" xref="algorithm2.11.11.1.m1.1.1.1">←</ci><ci id="algorithm2.11.11.1.m1.1.1.2.cmml" xref="algorithm2.11.11.1.m1.1.1.2">𝑒</ci><csymbol cd="latexml" id="algorithm2.11.11.1.m1.1.1.3.cmml" xref="algorithm2.11.11.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.1.m1.1c">e\leftarrow</annotation></semantics></math> <math id="algorithm2.12.12.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="algorithm2.12.12.2.m2.1a"><mn id="algorithm2.12.12.2.m2.1.1" xref="algorithm2.12.12.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="algorithm2.12.12.2.m2.1b"><cn type="integer" id="algorithm2.12.12.2.m2.1.1.cmml" xref="algorithm2.12.12.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.12.2.m2.1c">1</annotation></semantics></math> to <math id="algorithm2.13.13.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm2.13.13.3.m3.1a"><mi id="algorithm2.13.13.3.m3.1.1" xref="algorithm2.13.13.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.3.m3.1b"><ci id="algorithm2.13.13.3.m3.1.1.cmml" xref="algorithm2.13.13.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.3.m3.1c">E</annotation></semantics></math></em> <span id="algorithm2.13.13.5" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.14.14.m1.3" class="ltx_Math" alttext="\left(V^{D},{P}^{D}\right)\leftarrow\ w_{D}(x)" display="inline"><semantics id="algorithm2.14.14.m1.3a"><mrow id="algorithm2.14.14.m1.3.3" xref="algorithm2.14.14.m1.3.3.cmml"><mrow id="algorithm2.14.14.m1.3.3.2.2" xref="algorithm2.14.14.m1.3.3.2.3.cmml"><mo id="algorithm2.14.14.m1.3.3.2.2.3" xref="algorithm2.14.14.m1.3.3.2.3.cmml">(</mo><msup id="algorithm2.14.14.m1.2.2.1.1.1" xref="algorithm2.14.14.m1.2.2.1.1.1.cmml"><mi id="algorithm2.14.14.m1.2.2.1.1.1.2" xref="algorithm2.14.14.m1.2.2.1.1.1.2.cmml">V</mi><mi id="algorithm2.14.14.m1.2.2.1.1.1.3" xref="algorithm2.14.14.m1.2.2.1.1.1.3.cmml">D</mi></msup><mo id="algorithm2.14.14.m1.3.3.2.2.4" xref="algorithm2.14.14.m1.3.3.2.3.cmml">,</mo><msup id="algorithm2.14.14.m1.3.3.2.2.2" xref="algorithm2.14.14.m1.3.3.2.2.2.cmml"><mi id="algorithm2.14.14.m1.3.3.2.2.2.2" xref="algorithm2.14.14.m1.3.3.2.2.2.2.cmml">P</mi><mi id="algorithm2.14.14.m1.3.3.2.2.2.3" xref="algorithm2.14.14.m1.3.3.2.2.2.3.cmml">D</mi></msup><mo id="algorithm2.14.14.m1.3.3.2.2.5" xref="algorithm2.14.14.m1.3.3.2.3.cmml">)</mo></mrow><mo rspace="0.778em" stretchy="false" id="algorithm2.14.14.m1.3.3.3" xref="algorithm2.14.14.m1.3.3.3.cmml">←</mo><mrow id="algorithm2.14.14.m1.3.3.4" xref="algorithm2.14.14.m1.3.3.4.cmml"><msub id="algorithm2.14.14.m1.3.3.4.2" xref="algorithm2.14.14.m1.3.3.4.2.cmml"><mi id="algorithm2.14.14.m1.3.3.4.2.2" xref="algorithm2.14.14.m1.3.3.4.2.2.cmml">w</mi><mi id="algorithm2.14.14.m1.3.3.4.2.3" xref="algorithm2.14.14.m1.3.3.4.2.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="algorithm2.14.14.m1.3.3.4.1" xref="algorithm2.14.14.m1.3.3.4.1.cmml">​</mo><mrow id="algorithm2.14.14.m1.3.3.4.3.2" xref="algorithm2.14.14.m1.3.3.4.cmml"><mo stretchy="false" id="algorithm2.14.14.m1.3.3.4.3.2.1" xref="algorithm2.14.14.m1.3.3.4.cmml">(</mo><mi id="algorithm2.14.14.m1.1.1" xref="algorithm2.14.14.m1.1.1.cmml">x</mi><mo stretchy="false" id="algorithm2.14.14.m1.3.3.4.3.2.2" xref="algorithm2.14.14.m1.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.14.14.m1.3b"><apply id="algorithm2.14.14.m1.3.3.cmml" xref="algorithm2.14.14.m1.3.3"><ci id="algorithm2.14.14.m1.3.3.3.cmml" xref="algorithm2.14.14.m1.3.3.3">←</ci><interval closure="open" id="algorithm2.14.14.m1.3.3.2.3.cmml" xref="algorithm2.14.14.m1.3.3.2.2"><apply id="algorithm2.14.14.m1.2.2.1.1.1.cmml" xref="algorithm2.14.14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.2.2.1.1.1.1.cmml" xref="algorithm2.14.14.m1.2.2.1.1.1">superscript</csymbol><ci id="algorithm2.14.14.m1.2.2.1.1.1.2.cmml" xref="algorithm2.14.14.m1.2.2.1.1.1.2">𝑉</ci><ci id="algorithm2.14.14.m1.2.2.1.1.1.3.cmml" xref="algorithm2.14.14.m1.2.2.1.1.1.3">𝐷</ci></apply><apply id="algorithm2.14.14.m1.3.3.2.2.2.cmml" xref="algorithm2.14.14.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.3.3.2.2.2.1.cmml" xref="algorithm2.14.14.m1.3.3.2.2.2">superscript</csymbol><ci id="algorithm2.14.14.m1.3.3.2.2.2.2.cmml" xref="algorithm2.14.14.m1.3.3.2.2.2.2">𝑃</ci><ci id="algorithm2.14.14.m1.3.3.2.2.2.3.cmml" xref="algorithm2.14.14.m1.3.3.2.2.2.3">𝐷</ci></apply></interval><apply id="algorithm2.14.14.m1.3.3.4.cmml" xref="algorithm2.14.14.m1.3.3.4"><times id="algorithm2.14.14.m1.3.3.4.1.cmml" xref="algorithm2.14.14.m1.3.3.4.1"></times><apply id="algorithm2.14.14.m1.3.3.4.2.cmml" xref="algorithm2.14.14.m1.3.3.4.2"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.3.3.4.2.1.cmml" xref="algorithm2.14.14.m1.3.3.4.2">subscript</csymbol><ci id="algorithm2.14.14.m1.3.3.4.2.2.cmml" xref="algorithm2.14.14.m1.3.3.4.2.2">𝑤</ci><ci id="algorithm2.14.14.m1.3.3.4.2.3.cmml" xref="algorithm2.14.14.m1.3.3.4.2.3">𝐷</ci></apply><ci id="algorithm2.14.14.m1.1.1.cmml" xref="algorithm2.14.14.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.14.m1.3c">\left(V^{D},{P}^{D}\right)\leftarrow\ w_{D}(x)</annotation></semantics></math>;
</div>
<div id="algorithm2.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.15.15.m1.2" class="ltx_Math" alttext="L^{D}\leftarrow CE\_Loss(y,\ V^{D})" display="inline"><semantics id="algorithm2.15.15.m1.2a"><mrow id="algorithm2.15.15.m1.2.2" xref="algorithm2.15.15.m1.2.2.cmml"><msup id="algorithm2.15.15.m1.2.2.3" xref="algorithm2.15.15.m1.2.2.3.cmml"><mi id="algorithm2.15.15.m1.2.2.3.2" xref="algorithm2.15.15.m1.2.2.3.2.cmml">L</mi><mi id="algorithm2.15.15.m1.2.2.3.3" xref="algorithm2.15.15.m1.2.2.3.3.cmml">D</mi></msup><mo stretchy="false" id="algorithm2.15.15.m1.2.2.2" xref="algorithm2.15.15.m1.2.2.2.cmml">←</mo><mrow id="algorithm2.15.15.m1.2.2.1" xref="algorithm2.15.15.m1.2.2.1.cmml"><mi id="algorithm2.15.15.m1.2.2.1.3" xref="algorithm2.15.15.m1.2.2.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm2.15.15.m1.2.2.1.2" xref="algorithm2.15.15.m1.2.2.1.2.cmml">​</mo><mi id="algorithm2.15.15.m1.2.2.1.4" xref="algorithm2.15.15.m1.2.2.1.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm2.15.15.m1.2.2.1.2a" xref="algorithm2.15.15.m1.2.2.1.2.cmml">​</mo><mi mathvariant="normal" id="algorithm2.15.15.m1.2.2.1.5" xref="algorithm2.15.15.m1.2.2.1.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm2.15.15.m1.2.2.1.2b" xref="algorithm2.15.15.m1.2.2.1.2.cmml">​</mo><mi id="algorithm2.15.15.m1.2.2.1.6" xref="algorithm2.15.15.m1.2.2.1.6.cmml">L</mi><mo lspace="0em" rspace="0em" id="algorithm2.15.15.m1.2.2.1.2c" xref="algorithm2.15.15.m1.2.2.1.2.cmml">​</mo><mi id="algorithm2.15.15.m1.2.2.1.7" xref="algorithm2.15.15.m1.2.2.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm2.15.15.m1.2.2.1.2d" xref="algorithm2.15.15.m1.2.2.1.2.cmml">​</mo><mi id="algorithm2.15.15.m1.2.2.1.8" xref="algorithm2.15.15.m1.2.2.1.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm2.15.15.m1.2.2.1.2e" xref="algorithm2.15.15.m1.2.2.1.2.cmml">​</mo><mi id="algorithm2.15.15.m1.2.2.1.9" xref="algorithm2.15.15.m1.2.2.1.9.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm2.15.15.m1.2.2.1.2f" xref="algorithm2.15.15.m1.2.2.1.2.cmml">​</mo><mrow id="algorithm2.15.15.m1.2.2.1.1.1" xref="algorithm2.15.15.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="algorithm2.15.15.m1.2.2.1.1.1.2" xref="algorithm2.15.15.m1.2.2.1.1.2.cmml">(</mo><mi id="algorithm2.15.15.m1.1.1" xref="algorithm2.15.15.m1.1.1.cmml">y</mi><mo rspace="0.667em" id="algorithm2.15.15.m1.2.2.1.1.1.3" xref="algorithm2.15.15.m1.2.2.1.1.2.cmml">,</mo><msup id="algorithm2.15.15.m1.2.2.1.1.1.1" xref="algorithm2.15.15.m1.2.2.1.1.1.1.cmml"><mi id="algorithm2.15.15.m1.2.2.1.1.1.1.2" xref="algorithm2.15.15.m1.2.2.1.1.1.1.2.cmml">V</mi><mi id="algorithm2.15.15.m1.2.2.1.1.1.1.3" xref="algorithm2.15.15.m1.2.2.1.1.1.1.3.cmml">D</mi></msup><mo stretchy="false" id="algorithm2.15.15.m1.2.2.1.1.1.4" xref="algorithm2.15.15.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.15.15.m1.2b"><apply id="algorithm2.15.15.m1.2.2.cmml" xref="algorithm2.15.15.m1.2.2"><ci id="algorithm2.15.15.m1.2.2.2.cmml" xref="algorithm2.15.15.m1.2.2.2">←</ci><apply id="algorithm2.15.15.m1.2.2.3.cmml" xref="algorithm2.15.15.m1.2.2.3"><csymbol cd="ambiguous" id="algorithm2.15.15.m1.2.2.3.1.cmml" xref="algorithm2.15.15.m1.2.2.3">superscript</csymbol><ci id="algorithm2.15.15.m1.2.2.3.2.cmml" xref="algorithm2.15.15.m1.2.2.3.2">𝐿</ci><ci id="algorithm2.15.15.m1.2.2.3.3.cmml" xref="algorithm2.15.15.m1.2.2.3.3">𝐷</ci></apply><apply id="algorithm2.15.15.m1.2.2.1.cmml" xref="algorithm2.15.15.m1.2.2.1"><times id="algorithm2.15.15.m1.2.2.1.2.cmml" xref="algorithm2.15.15.m1.2.2.1.2"></times><ci id="algorithm2.15.15.m1.2.2.1.3.cmml" xref="algorithm2.15.15.m1.2.2.1.3">𝐶</ci><ci id="algorithm2.15.15.m1.2.2.1.4.cmml" xref="algorithm2.15.15.m1.2.2.1.4">𝐸</ci><ci id="algorithm2.15.15.m1.2.2.1.5.cmml" xref="algorithm2.15.15.m1.2.2.1.5">_</ci><ci id="algorithm2.15.15.m1.2.2.1.6.cmml" xref="algorithm2.15.15.m1.2.2.1.6">𝐿</ci><ci id="algorithm2.15.15.m1.2.2.1.7.cmml" xref="algorithm2.15.15.m1.2.2.1.7">𝑜</ci><ci id="algorithm2.15.15.m1.2.2.1.8.cmml" xref="algorithm2.15.15.m1.2.2.1.8">𝑠</ci><ci id="algorithm2.15.15.m1.2.2.1.9.cmml" xref="algorithm2.15.15.m1.2.2.1.9">𝑠</ci><interval closure="open" id="algorithm2.15.15.m1.2.2.1.1.2.cmml" xref="algorithm2.15.15.m1.2.2.1.1.1"><ci id="algorithm2.15.15.m1.1.1.cmml" xref="algorithm2.15.15.m1.1.1">𝑦</ci><apply id="algorithm2.15.15.m1.2.2.1.1.1.1.cmml" xref="algorithm2.15.15.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.15.15.m1.2.2.1.1.1.1.1.cmml" xref="algorithm2.15.15.m1.2.2.1.1.1.1">superscript</csymbol><ci id="algorithm2.15.15.m1.2.2.1.1.1.1.2.cmml" xref="algorithm2.15.15.m1.2.2.1.1.1.1.2">𝑉</ci><ci id="algorithm2.15.15.m1.2.2.1.1.1.1.3.cmml" xref="algorithm2.15.15.m1.2.2.1.1.1.1.3">𝐷</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.15.15.m1.2c">L^{D}\leftarrow CE\_Loss(y,\ V^{D})</annotation></semantics></math>;
</div>
<div id="algorithm2.19.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm2.16.16.m1.2" class="ltx_Math" alttext="\nabla w_{D}^{e}\leftarrow SGD.get\_gradients(L^{D},\ w_{D})" display="inline"><semantics id="algorithm2.16.16.m1.2a"><mrow id="algorithm2.16.16.m1.2.2.2" xref="algorithm2.16.16.m1.2.2.3.cmml"><mrow id="algorithm2.16.16.m1.1.1.1.1" xref="algorithm2.16.16.m1.1.1.1.1.cmml"><mrow id="algorithm2.16.16.m1.1.1.1.1.2" xref="algorithm2.16.16.m1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="algorithm2.16.16.m1.1.1.1.1.2.1" xref="algorithm2.16.16.m1.1.1.1.1.2.1.cmml">∇</mo><msubsup id="algorithm2.16.16.m1.1.1.1.1.2.2" xref="algorithm2.16.16.m1.1.1.1.1.2.2.cmml"><mi id="algorithm2.16.16.m1.1.1.1.1.2.2.2.2" xref="algorithm2.16.16.m1.1.1.1.1.2.2.2.2.cmml">w</mi><mi id="algorithm2.16.16.m1.1.1.1.1.2.2.2.3" xref="algorithm2.16.16.m1.1.1.1.1.2.2.2.3.cmml">D</mi><mi id="algorithm2.16.16.m1.1.1.1.1.2.2.3" xref="algorithm2.16.16.m1.1.1.1.1.2.2.3.cmml">e</mi></msubsup></mrow><mo stretchy="false" id="algorithm2.16.16.m1.1.1.1.1.1" xref="algorithm2.16.16.m1.1.1.1.1.1.cmml">←</mo><mrow id="algorithm2.16.16.m1.1.1.1.1.3" xref="algorithm2.16.16.m1.1.1.1.1.3.cmml"><mi id="algorithm2.16.16.m1.1.1.1.1.3.2" xref="algorithm2.16.16.m1.1.1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.1.1.1.1.3.1" xref="algorithm2.16.16.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.16.16.m1.1.1.1.1.3.3" xref="algorithm2.16.16.m1.1.1.1.1.3.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.1.1.1.1.3.1a" xref="algorithm2.16.16.m1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.16.16.m1.1.1.1.1.3.4" xref="algorithm2.16.16.m1.1.1.1.1.3.4.cmml">D</mi></mrow></mrow><mo lspace="0em" rspace="0.167em" id="algorithm2.16.16.m1.2.2.2.3" xref="algorithm2.16.16.m1.2.2.3a.cmml">.</mo><mrow id="algorithm2.16.16.m1.2.2.2.2" xref="algorithm2.16.16.m1.2.2.2.2.cmml"><mi id="algorithm2.16.16.m1.2.2.2.2.4" xref="algorithm2.16.16.m1.2.2.2.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.5" xref="algorithm2.16.16.m1.2.2.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3a" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.6" xref="algorithm2.16.16.m1.2.2.2.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3b" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi mathvariant="normal" id="algorithm2.16.16.m1.2.2.2.2.7" xref="algorithm2.16.16.m1.2.2.2.2.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3c" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.8" xref="algorithm2.16.16.m1.2.2.2.2.8.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3d" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.9" xref="algorithm2.16.16.m1.2.2.2.2.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3e" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.10" xref="algorithm2.16.16.m1.2.2.2.2.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3f" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.11" xref="algorithm2.16.16.m1.2.2.2.2.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3g" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.12" xref="algorithm2.16.16.m1.2.2.2.2.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3h" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.13" xref="algorithm2.16.16.m1.2.2.2.2.13.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3i" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.14" xref="algorithm2.16.16.m1.2.2.2.2.14.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3j" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.15" xref="algorithm2.16.16.m1.2.2.2.2.15.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3k" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mi id="algorithm2.16.16.m1.2.2.2.2.16" xref="algorithm2.16.16.m1.2.2.2.2.16.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm2.16.16.m1.2.2.2.2.3l" xref="algorithm2.16.16.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm2.16.16.m1.2.2.2.2.2.2" xref="algorithm2.16.16.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm2.16.16.m1.2.2.2.2.2.2.3" xref="algorithm2.16.16.m1.2.2.2.2.2.3.cmml">(</mo><msup id="algorithm2.16.16.m1.2.2.2.2.1.1.1" xref="algorithm2.16.16.m1.2.2.2.2.1.1.1.cmml"><mi id="algorithm2.16.16.m1.2.2.2.2.1.1.1.2" xref="algorithm2.16.16.m1.2.2.2.2.1.1.1.2.cmml">L</mi><mi id="algorithm2.16.16.m1.2.2.2.2.1.1.1.3" xref="algorithm2.16.16.m1.2.2.2.2.1.1.1.3.cmml">D</mi></msup><mo rspace="0.667em" id="algorithm2.16.16.m1.2.2.2.2.2.2.4" xref="algorithm2.16.16.m1.2.2.2.2.2.3.cmml">,</mo><msub id="algorithm2.16.16.m1.2.2.2.2.2.2.2" xref="algorithm2.16.16.m1.2.2.2.2.2.2.2.cmml"><mi id="algorithm2.16.16.m1.2.2.2.2.2.2.2.2" xref="algorithm2.16.16.m1.2.2.2.2.2.2.2.2.cmml">w</mi><mi id="algorithm2.16.16.m1.2.2.2.2.2.2.2.3" xref="algorithm2.16.16.m1.2.2.2.2.2.2.2.3.cmml">D</mi></msub><mo stretchy="false" id="algorithm2.16.16.m1.2.2.2.2.2.2.5" xref="algorithm2.16.16.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.16.16.m1.2b"><apply id="algorithm2.16.16.m1.2.2.3.cmml" xref="algorithm2.16.16.m1.2.2.2"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.2.2.3a.cmml" xref="algorithm2.16.16.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm2.16.16.m1.1.1.1.1.cmml" xref="algorithm2.16.16.m1.1.1.1.1"><ci id="algorithm2.16.16.m1.1.1.1.1.1.cmml" xref="algorithm2.16.16.m1.1.1.1.1.1">←</ci><apply id="algorithm2.16.16.m1.1.1.1.1.2.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2"><ci id="algorithm2.16.16.m1.1.1.1.1.2.1.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.1">∇</ci><apply id="algorithm2.16.16.m1.1.1.1.1.2.2.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.1.1.1.1.2.2.1.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.2">superscript</csymbol><apply id="algorithm2.16.16.m1.1.1.1.1.2.2.2.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.1.1.1.1.2.2.2.1.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm2.16.16.m1.1.1.1.1.2.2.2.2.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.2.2.2">𝑤</ci><ci id="algorithm2.16.16.m1.1.1.1.1.2.2.2.3.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.2.2.3">𝐷</ci></apply><ci id="algorithm2.16.16.m1.1.1.1.1.2.2.3.cmml" xref="algorithm2.16.16.m1.1.1.1.1.2.2.3">𝑒</ci></apply></apply><apply id="algorithm2.16.16.m1.1.1.1.1.3.cmml" xref="algorithm2.16.16.m1.1.1.1.1.3"><times id="algorithm2.16.16.m1.1.1.1.1.3.1.cmml" xref="algorithm2.16.16.m1.1.1.1.1.3.1"></times><ci id="algorithm2.16.16.m1.1.1.1.1.3.2.cmml" xref="algorithm2.16.16.m1.1.1.1.1.3.2">𝑆</ci><ci id="algorithm2.16.16.m1.1.1.1.1.3.3.cmml" xref="algorithm2.16.16.m1.1.1.1.1.3.3">𝐺</ci><ci id="algorithm2.16.16.m1.1.1.1.1.3.4.cmml" xref="algorithm2.16.16.m1.1.1.1.1.3.4">𝐷</ci></apply></apply><apply id="algorithm2.16.16.m1.2.2.2.2.cmml" xref="algorithm2.16.16.m1.2.2.2.2"><times id="algorithm2.16.16.m1.2.2.2.2.3.cmml" xref="algorithm2.16.16.m1.2.2.2.2.3"></times><ci id="algorithm2.16.16.m1.2.2.2.2.4.cmml" xref="algorithm2.16.16.m1.2.2.2.2.4">𝑔</ci><ci id="algorithm2.16.16.m1.2.2.2.2.5.cmml" xref="algorithm2.16.16.m1.2.2.2.2.5">𝑒</ci><ci id="algorithm2.16.16.m1.2.2.2.2.6.cmml" xref="algorithm2.16.16.m1.2.2.2.2.6">𝑡</ci><ci id="algorithm2.16.16.m1.2.2.2.2.7.cmml" xref="algorithm2.16.16.m1.2.2.2.2.7">_</ci><ci id="algorithm2.16.16.m1.2.2.2.2.8.cmml" xref="algorithm2.16.16.m1.2.2.2.2.8">𝑔</ci><ci id="algorithm2.16.16.m1.2.2.2.2.9.cmml" xref="algorithm2.16.16.m1.2.2.2.2.9">𝑟</ci><ci id="algorithm2.16.16.m1.2.2.2.2.10.cmml" xref="algorithm2.16.16.m1.2.2.2.2.10">𝑎</ci><ci id="algorithm2.16.16.m1.2.2.2.2.11.cmml" xref="algorithm2.16.16.m1.2.2.2.2.11">𝑑</ci><ci id="algorithm2.16.16.m1.2.2.2.2.12.cmml" xref="algorithm2.16.16.m1.2.2.2.2.12">𝑖</ci><ci id="algorithm2.16.16.m1.2.2.2.2.13.cmml" xref="algorithm2.16.16.m1.2.2.2.2.13">𝑒</ci><ci id="algorithm2.16.16.m1.2.2.2.2.14.cmml" xref="algorithm2.16.16.m1.2.2.2.2.14">𝑛</ci><ci id="algorithm2.16.16.m1.2.2.2.2.15.cmml" xref="algorithm2.16.16.m1.2.2.2.2.15">𝑡</ci><ci id="algorithm2.16.16.m1.2.2.2.2.16.cmml" xref="algorithm2.16.16.m1.2.2.2.2.16">𝑠</ci><interval closure="open" id="algorithm2.16.16.m1.2.2.2.2.2.3.cmml" xref="algorithm2.16.16.m1.2.2.2.2.2.2"><apply id="algorithm2.16.16.m1.2.2.2.2.1.1.1.cmml" xref="algorithm2.16.16.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.2.2.2.2.1.1.1.1.cmml" xref="algorithm2.16.16.m1.2.2.2.2.1.1.1">superscript</csymbol><ci id="algorithm2.16.16.m1.2.2.2.2.1.1.1.2.cmml" xref="algorithm2.16.16.m1.2.2.2.2.1.1.1.2">𝐿</ci><ci id="algorithm2.16.16.m1.2.2.2.2.1.1.1.3.cmml" xref="algorithm2.16.16.m1.2.2.2.2.1.1.1.3">𝐷</ci></apply><apply id="algorithm2.16.16.m1.2.2.2.2.2.2.2.cmml" xref="algorithm2.16.16.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm2.16.16.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.16.16.m1.2.2.2.2.2.2.2.2.cmml" xref="algorithm2.16.16.m1.2.2.2.2.2.2.2.2">𝑤</ci><ci id="algorithm2.16.16.m1.2.2.2.2.2.2.2.3.cmml" xref="algorithm2.16.16.m1.2.2.2.2.2.2.2.3">𝐷</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.16.16.m1.2c">\nabla w_{D}^{e}\leftarrow SGD.get\_gradients(L^{D},\ w_{D})</annotation></semantics></math>;
</div>
<div id="algorithm2.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.17.17.m1.1" class="ltx_math_unparsed" alttext="w_{D}\leftarrow Update(\nabla w_{D}^{e},w_{D}" display="inline"><semantics id="algorithm2.17.17.m1.1a"><mrow id="algorithm2.17.17.m1.1b"><msub id="algorithm2.17.17.m1.1.1"><mi id="algorithm2.17.17.m1.1.1.2">w</mi><mi id="algorithm2.17.17.m1.1.1.3">D</mi></msub><mo stretchy="false" id="algorithm2.17.17.m1.1.2">←</mo><mi id="algorithm2.17.17.m1.1.3">U</mi><mi id="algorithm2.17.17.m1.1.4">p</mi><mi id="algorithm2.17.17.m1.1.5">d</mi><mi id="algorithm2.17.17.m1.1.6">a</mi><mi id="algorithm2.17.17.m1.1.7">t</mi><mi id="algorithm2.17.17.m1.1.8">e</mi><mrow id="algorithm2.17.17.m1.1.9"><mo stretchy="false" id="algorithm2.17.17.m1.1.9.1">(</mo><mo rspace="0.167em" id="algorithm2.17.17.m1.1.9.2">∇</mo><msubsup id="algorithm2.17.17.m1.1.9.3"><mi id="algorithm2.17.17.m1.1.9.3.2.2">w</mi><mi id="algorithm2.17.17.m1.1.9.3.2.3">D</mi><mi id="algorithm2.17.17.m1.1.9.3.3">e</mi></msubsup><mo id="algorithm2.17.17.m1.1.9.4">,</mo><msub id="algorithm2.17.17.m1.1.9.5"><mi id="algorithm2.17.17.m1.1.9.5.2">w</mi><mi id="algorithm2.17.17.m1.1.9.5.3">D</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.17.17.m1.1c">w_{D}\leftarrow Update(\nabla w_{D}^{e},w_{D}</annotation></semantics></math>);
</div>
<div id="algorithm2.19.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.19.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm2.18.18.m1.3" class="ltx_Math" alttext="Send(\nabla w_{D},n,S)" display="inline"><semantics id="algorithm2.18.18.m1.3a"><mrow id="algorithm2.18.18.m1.3.3" xref="algorithm2.18.18.m1.3.3.cmml"><mi id="algorithm2.18.18.m1.3.3.3" xref="algorithm2.18.18.m1.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm2.18.18.m1.3.3.2" xref="algorithm2.18.18.m1.3.3.2.cmml">​</mo><mi id="algorithm2.18.18.m1.3.3.4" xref="algorithm2.18.18.m1.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.18.18.m1.3.3.2a" xref="algorithm2.18.18.m1.3.3.2.cmml">​</mo><mi id="algorithm2.18.18.m1.3.3.5" xref="algorithm2.18.18.m1.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm2.18.18.m1.3.3.2b" xref="algorithm2.18.18.m1.3.3.2.cmml">​</mo><mi id="algorithm2.18.18.m1.3.3.6" xref="algorithm2.18.18.m1.3.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm2.18.18.m1.3.3.2c" xref="algorithm2.18.18.m1.3.3.2.cmml">​</mo><mrow id="algorithm2.18.18.m1.3.3.1.1" xref="algorithm2.18.18.m1.3.3.1.2.cmml"><mo stretchy="false" id="algorithm2.18.18.m1.3.3.1.1.2" xref="algorithm2.18.18.m1.3.3.1.2.cmml">(</mo><mrow id="algorithm2.18.18.m1.3.3.1.1.1" xref="algorithm2.18.18.m1.3.3.1.1.1.cmml"><mo rspace="0.167em" id="algorithm2.18.18.m1.3.3.1.1.1.1" xref="algorithm2.18.18.m1.3.3.1.1.1.1.cmml">∇</mo><msub id="algorithm2.18.18.m1.3.3.1.1.1.2" xref="algorithm2.18.18.m1.3.3.1.1.1.2.cmml"><mi id="algorithm2.18.18.m1.3.3.1.1.1.2.2" xref="algorithm2.18.18.m1.3.3.1.1.1.2.2.cmml">w</mi><mi id="algorithm2.18.18.m1.3.3.1.1.1.2.3" xref="algorithm2.18.18.m1.3.3.1.1.1.2.3.cmml">D</mi></msub></mrow><mo id="algorithm2.18.18.m1.3.3.1.1.3" xref="algorithm2.18.18.m1.3.3.1.2.cmml">,</mo><mi id="algorithm2.18.18.m1.1.1" xref="algorithm2.18.18.m1.1.1.cmml">n</mi><mo id="algorithm2.18.18.m1.3.3.1.1.4" xref="algorithm2.18.18.m1.3.3.1.2.cmml">,</mo><mi id="algorithm2.18.18.m1.2.2" xref="algorithm2.18.18.m1.2.2.cmml">S</mi><mo stretchy="false" id="algorithm2.18.18.m1.3.3.1.1.5" xref="algorithm2.18.18.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.18.18.m1.3b"><apply id="algorithm2.18.18.m1.3.3.cmml" xref="algorithm2.18.18.m1.3.3"><times id="algorithm2.18.18.m1.3.3.2.cmml" xref="algorithm2.18.18.m1.3.3.2"></times><ci id="algorithm2.18.18.m1.3.3.3.cmml" xref="algorithm2.18.18.m1.3.3.3">𝑆</ci><ci id="algorithm2.18.18.m1.3.3.4.cmml" xref="algorithm2.18.18.m1.3.3.4">𝑒</ci><ci id="algorithm2.18.18.m1.3.3.5.cmml" xref="algorithm2.18.18.m1.3.3.5">𝑛</ci><ci id="algorithm2.18.18.m1.3.3.6.cmml" xref="algorithm2.18.18.m1.3.3.6">𝑑</ci><vector id="algorithm2.18.18.m1.3.3.1.2.cmml" xref="algorithm2.18.18.m1.3.3.1.1"><apply id="algorithm2.18.18.m1.3.3.1.1.1.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1"><ci id="algorithm2.18.18.m1.3.3.1.1.1.1.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.1">∇</ci><apply id="algorithm2.18.18.m1.3.3.1.1.1.2.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.3.3.1.1.1.2.1.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.2">subscript</csymbol><ci id="algorithm2.18.18.m1.3.3.1.1.1.2.2.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.2.2">𝑤</ci><ci id="algorithm2.18.18.m1.3.3.1.1.1.2.3.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.2.3">𝐷</ci></apply></apply><ci id="algorithm2.18.18.m1.1.1.cmml" xref="algorithm2.18.18.m1.1.1">𝑛</ci><ci id="algorithm2.18.18.m1.2.2.cmml" xref="algorithm2.18.18.m1.2.2">𝑆</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.18.m1.3c">Send(\nabla w_{D},n,S)</annotation></semantics></math>;
</div>
<div id="algorithm2.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.19.19.m1.1" class="ltx_Math" alttext="w_{D}\leftarrow Receive()" display="inline"><semantics id="algorithm2.19.19.m1.1a"><mrow id="algorithm2.19.19.m1.1.1" xref="algorithm2.19.19.m1.1.1.cmml"><msub id="algorithm2.19.19.m1.1.1.2" xref="algorithm2.19.19.m1.1.1.2.cmml"><mi id="algorithm2.19.19.m1.1.1.2.2" xref="algorithm2.19.19.m1.1.1.2.2.cmml">w</mi><mi id="algorithm2.19.19.m1.1.1.2.3" xref="algorithm2.19.19.m1.1.1.2.3.cmml">D</mi></msub><mo stretchy="false" id="algorithm2.19.19.m1.1.1.1" xref="algorithm2.19.19.m1.1.1.1.cmml">←</mo><mrow id="algorithm2.19.19.m1.1.1.3" xref="algorithm2.19.19.m1.1.1.3.cmml"><mi id="algorithm2.19.19.m1.1.1.3.2" xref="algorithm2.19.19.m1.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.19.m1.1.1.3.1" xref="algorithm2.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm2.19.19.m1.1.1.3.3" xref="algorithm2.19.19.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.19.m1.1.1.3.1a" xref="algorithm2.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm2.19.19.m1.1.1.3.4" xref="algorithm2.19.19.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.19.m1.1.1.3.1b" xref="algorithm2.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm2.19.19.m1.1.1.3.5" xref="algorithm2.19.19.m1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.19.m1.1.1.3.1c" xref="algorithm2.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm2.19.19.m1.1.1.3.6" xref="algorithm2.19.19.m1.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.19.m1.1.1.3.1d" xref="algorithm2.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm2.19.19.m1.1.1.3.7" xref="algorithm2.19.19.m1.1.1.3.7.cmml">v</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.19.m1.1.1.3.1e" xref="algorithm2.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm2.19.19.m1.1.1.3.8" xref="algorithm2.19.19.m1.1.1.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.19.m1.1.1.3.1f" xref="algorithm2.19.19.m1.1.1.3.1.cmml">​</mo><mrow id="algorithm2.19.19.m1.1.1.3.9.2" xref="algorithm2.19.19.m1.1.1.3.cmml"><mo stretchy="false" id="algorithm2.19.19.m1.1.1.3.9.2.1" xref="algorithm2.19.19.m1.1.1.3.9.1.cmml">(</mo><mo stretchy="false" id="algorithm2.19.19.m1.1.1.3.9.2.2" xref="algorithm2.19.19.m1.1.1.3.9.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.19.19.m1.1b"><apply id="algorithm2.19.19.m1.1.1.cmml" xref="algorithm2.19.19.m1.1.1"><ci id="algorithm2.19.19.m1.1.1.1.cmml" xref="algorithm2.19.19.m1.1.1.1">←</ci><apply id="algorithm2.19.19.m1.1.1.2.cmml" xref="algorithm2.19.19.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.19.19.m1.1.1.2.1.cmml" xref="algorithm2.19.19.m1.1.1.2">subscript</csymbol><ci id="algorithm2.19.19.m1.1.1.2.2.cmml" xref="algorithm2.19.19.m1.1.1.2.2">𝑤</ci><ci id="algorithm2.19.19.m1.1.1.2.3.cmml" xref="algorithm2.19.19.m1.1.1.2.3">𝐷</ci></apply><apply id="algorithm2.19.19.m1.1.1.3.cmml" xref="algorithm2.19.19.m1.1.1.3"><times id="algorithm2.19.19.m1.1.1.3.1.cmml" xref="algorithm2.19.19.m1.1.1.3.1"></times><ci id="algorithm2.19.19.m1.1.1.3.2.cmml" xref="algorithm2.19.19.m1.1.1.3.2">𝑅</ci><ci id="algorithm2.19.19.m1.1.1.3.3.cmml" xref="algorithm2.19.19.m1.1.1.3.3">𝑒</ci><ci id="algorithm2.19.19.m1.1.1.3.4.cmml" xref="algorithm2.19.19.m1.1.1.3.4">𝑐</ci><ci id="algorithm2.19.19.m1.1.1.3.5.cmml" xref="algorithm2.19.19.m1.1.1.3.5">𝑒</ci><ci id="algorithm2.19.19.m1.1.1.3.6.cmml" xref="algorithm2.19.19.m1.1.1.3.6">𝑖</ci><ci id="algorithm2.19.19.m1.1.1.3.7.cmml" xref="algorithm2.19.19.m1.1.1.3.7">𝑣</ci><ci id="algorithm2.19.19.m1.1.1.3.8.cmml" xref="algorithm2.19.19.m1.1.1.3.8">𝑒</ci><list id="algorithm2.19.19.m1.1.1.3.9.1.cmml" xref="algorithm2.19.19.m1.1.1.3.9.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.19.m1.1c">w_{D}\leftarrow Receive()</annotation></semantics></math>;
</div>
<div id="algorithm2.19.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.19.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span> end for
</div>
<div id="algorithm2.19.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>
</div>
<div id="algorithm2.19.26" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm2.21.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Training Procedure of HierarchyFL (Device)</figcaption>
</figure>
<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.5" class="ltx_p">Algorithm <a href="#algorithm2" title="In III-C2 Training Procedure of HierarchyFL (Device) ‣ III-C Training Procedure of HierarchyFL ‣ III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the training procedure of our HierarchyFL in AIoT devices.
In line 1,
each AIoT device gathers nature images to support local training, where <math id="S3.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mi id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">x</annotation></semantics></math> and <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">y</annotation></semantics></math> represent the gathered training data and their corresponding labels.
Lines 2-11 conduct <math id="S3.SS3.SSS2.p1.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS3.SSS2.p1.3.m3.1a"><mi id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.1b"><ci id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.1c">R</annotation></semantics></math> communication rounds of FL with the cloud server for the
model gradients upload. Lines 3-4 utilize the nature images to local model <math id="S3.SS3.SSS2.p1.4.m4.1" class="ltx_Math" alttext="w_{D}" display="inline"><semantics id="S3.SS3.SSS2.p1.4.m4.1a"><msub id="S3.SS3.SSS2.p1.4.m4.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p1.4.m4.1.1.2" xref="S3.SS3.SSS2.p1.4.m4.1.1.2.cmml">w</mi><mi id="S3.SS3.SSS2.p1.4.m4.1.1.3" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m4.1b"><apply id="S3.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.2">𝑤</ci><ci id="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m4.1c">w_{D}</annotation></semantics></math> and figure out the corresponding labels of nature images from model predictions (i.e., <math id="S3.SS3.SSS2.p1.5.m5.1" class="ltx_Math" alttext="V^{D}" display="inline"><semantics id="S3.SS3.SSS2.p1.5.m5.1a"><msup id="S3.SS3.SSS2.p1.5.m5.1.1" xref="S3.SS3.SSS2.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p1.5.m5.1.1.2" xref="S3.SS3.SSS2.p1.5.m5.1.1.2.cmml">V</mi><mi id="S3.SS3.SSS2.p1.5.m5.1.1.3" xref="S3.SS3.SSS2.p1.5.m5.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.5.m5.1b"><apply id="S3.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1.2">𝑉</ci><ci id="S3.SS3.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.5.m5.1c">V^{D}</annotation></semantics></math>).
Lines 5-7 iteratively update the parameters of heterogeneous local models based on the cross-entropy loss function.
After that, each local model uploads model gradients to the cloud server for aggregation.
Based on the trained model, line 9 uploads the model gradient to the cloud server for aggregation.
Finally, line 10 receives the newly dispatched model for the next local training round.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiment</span>
</h2>

<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x2.png" id="S4.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="111" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf1.4.2.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F2.sf1.2.1" class="ltx_text" style="font-size:70%;"> CIFAR10 (<math id="S4.F2.sf1.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.F2.sf1.2.1.m1.1b"><mrow id="S4.F2.sf1.2.1.m1.1.1" xref="S4.F2.sf1.2.1.m1.1.1.cmml"><mi id="S4.F2.sf1.2.1.m1.1.1.2" xref="S4.F2.sf1.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf1.2.1.m1.1.1.1" xref="S4.F2.sf1.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf1.2.1.m1.1.1.3" xref="S4.F2.sf1.2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf1.2.1.m1.1c"><apply id="S4.F2.sf1.2.1.m1.1.1.cmml" xref="S4.F2.sf1.2.1.m1.1.1"><eq id="S4.F2.sf1.2.1.m1.1.1.1.cmml" xref="S4.F2.sf1.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf1.2.1.m1.1.1.2.cmml" xref="S4.F2.sf1.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf1.2.1.m1.1.1.3.cmml" xref="S4.F2.sf1.2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf1.2.1.m1.1d">\alpha=0.1</annotation></semantics></math>) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x3.png" id="S4.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="111" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf2.4.2.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F2.sf2.2.1" class="ltx_text" style="font-size:70%;"> CIFAR10 (<math id="S4.F2.sf2.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.F2.sf2.2.1.m1.1b"><mrow id="S4.F2.sf2.2.1.m1.1.1" xref="S4.F2.sf2.2.1.m1.1.1.cmml"><mi id="S4.F2.sf2.2.1.m1.1.1.2" xref="S4.F2.sf2.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf2.2.1.m1.1.1.1" xref="S4.F2.sf2.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf2.2.1.m1.1.1.3" xref="S4.F2.sf2.2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf2.2.1.m1.1c"><apply id="S4.F2.sf2.2.1.m1.1.1.cmml" xref="S4.F2.sf2.2.1.m1.1.1"><eq id="S4.F2.sf2.2.1.m1.1.1.1.cmml" xref="S4.F2.sf2.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf2.2.1.m1.1.1.2.cmml" xref="S4.F2.sf2.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf2.2.1.m1.1.1.3.cmml" xref="S4.F2.sf2.2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf2.2.1.m1.1d">\alpha=0.5</annotation></semantics></math>) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x4.png" id="S4.F2.sf3.g1" class="ltx_graphics ltx_img_landscape" width="110" height="75" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf3.4.2.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F2.sf3.2.1" class="ltx_text" style="font-size:70%;"> CIFAR10 (<math id="S4.F2.sf3.2.1.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.F2.sf3.2.1.m1.1b"><mrow id="S4.F2.sf3.2.1.m1.1.1" xref="S4.F2.sf3.2.1.m1.1.1.cmml"><mi id="S4.F2.sf3.2.1.m1.1.1.2" xref="S4.F2.sf3.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf3.2.1.m1.1.1.1" xref="S4.F2.sf3.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf3.2.1.m1.1.1.3" xref="S4.F2.sf3.2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf3.2.1.m1.1c"><apply id="S4.F2.sf3.2.1.m1.1.1.cmml" xref="S4.F2.sf3.2.1.m1.1.1"><eq id="S4.F2.sf3.2.1.m1.1.1.1.cmml" xref="S4.F2.sf3.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf3.2.1.m1.1.1.2.cmml" xref="S4.F2.sf3.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S4.F2.sf3.2.1.m1.1.1.3.cmml" xref="S4.F2.sf3.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf3.2.1.m1.1d">\alpha=1</annotation></semantics></math>) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x5.png" id="S4.F2.sf4.g1" class="ltx_graphics ltx_img_landscape" width="110" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf4.3.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F2.sf4.4.2" class="ltx_text" style="font-size:70%;"> CIFAR10 (IID) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x6.png" id="S4.F2.sf5.g1" class="ltx_graphics ltx_img_landscape" width="111" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf5.4.2.1" class="ltx_text" style="font-size:80%;">(e)</span> </span><span id="S4.F2.sf5.2.1" class="ltx_text" style="font-size:70%;"> CIFAR100 (<math id="S4.F2.sf5.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.F2.sf5.2.1.m1.1b"><mrow id="S4.F2.sf5.2.1.m1.1.1" xref="S4.F2.sf5.2.1.m1.1.1.cmml"><mi id="S4.F2.sf5.2.1.m1.1.1.2" xref="S4.F2.sf5.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf5.2.1.m1.1.1.1" xref="S4.F2.sf5.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf5.2.1.m1.1.1.3" xref="S4.F2.sf5.2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf5.2.1.m1.1c"><apply id="S4.F2.sf5.2.1.m1.1.1.cmml" xref="S4.F2.sf5.2.1.m1.1.1"><eq id="S4.F2.sf5.2.1.m1.1.1.1.cmml" xref="S4.F2.sf5.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf5.2.1.m1.1.1.2.cmml" xref="S4.F2.sf5.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf5.2.1.m1.1.1.3.cmml" xref="S4.F2.sf5.2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf5.2.1.m1.1d">\alpha=0.1</annotation></semantics></math>) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x7.png" id="S4.F2.sf6.g1" class="ltx_graphics ltx_img_landscape" width="110" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf6.4.2.1" class="ltx_text" style="font-size:80%;">(f)</span> </span><span id="S4.F2.sf6.2.1" class="ltx_text" style="font-size:70%;"> CIFAR100 (<math id="S4.F2.sf6.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.F2.sf6.2.1.m1.1b"><mrow id="S4.F2.sf6.2.1.m1.1.1" xref="S4.F2.sf6.2.1.m1.1.1.cmml"><mi id="S4.F2.sf6.2.1.m1.1.1.2" xref="S4.F2.sf6.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf6.2.1.m1.1.1.1" xref="S4.F2.sf6.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf6.2.1.m1.1.1.3" xref="S4.F2.sf6.2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf6.2.1.m1.1c"><apply id="S4.F2.sf6.2.1.m1.1.1.cmml" xref="S4.F2.sf6.2.1.m1.1.1"><eq id="S4.F2.sf6.2.1.m1.1.1.1.cmml" xref="S4.F2.sf6.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf6.2.1.m1.1.1.2.cmml" xref="S4.F2.sf6.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf6.2.1.m1.1.1.3.cmml" xref="S4.F2.sf6.2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf6.2.1.m1.1d">\alpha=0.5</annotation></semantics></math>) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf7" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x8.png" id="S4.F2.sf7.g1" class="ltx_graphics ltx_img_landscape" width="110" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf7.4.2.1" class="ltx_text" style="font-size:80%;">(g)</span> </span><span id="S4.F2.sf7.2.1" class="ltx_text" style="font-size:70%;"> CIFAR100 (<math id="S4.F2.sf7.2.1.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.F2.sf7.2.1.m1.1b"><mrow id="S4.F2.sf7.2.1.m1.1.1" xref="S4.F2.sf7.2.1.m1.1.1.cmml"><mi id="S4.F2.sf7.2.1.m1.1.1.2" xref="S4.F2.sf7.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf7.2.1.m1.1.1.1" xref="S4.F2.sf7.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf7.2.1.m1.1.1.3" xref="S4.F2.sf7.2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf7.2.1.m1.1c"><apply id="S4.F2.sf7.2.1.m1.1.1.cmml" xref="S4.F2.sf7.2.1.m1.1.1"><eq id="S4.F2.sf7.2.1.m1.1.1.1.cmml" xref="S4.F2.sf7.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf7.2.1.m1.1.1.2.cmml" xref="S4.F2.sf7.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S4.F2.sf7.2.1.m1.1.1.3.cmml" xref="S4.F2.sf7.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf7.2.1.m1.1d">\alpha=1</annotation></semantics></math>) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf8" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x9.png" id="S4.F2.sf8.g1" class="ltx_graphics ltx_img_landscape" width="110" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf8.3.1.1" class="ltx_text" style="font-size:80%;">(h)</span> </span><span id="S4.F2.sf8.4.2" class="ltx_text" style="font-size:70%;"> CIFAR100 (IID) w/ 40 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf9" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x10.png" id="S4.F2.sf9.g1" class="ltx_graphics ltx_img_landscape" width="110" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf9.4.2.1" class="ltx_text" style="font-size:80%;">(i)</span> </span><span id="S4.F2.sf9.2.1" class="ltx_text" style="font-size:70%;"> CIFAR10 (<math id="S4.F2.sf9.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.F2.sf9.2.1.m1.1b"><mrow id="S4.F2.sf9.2.1.m1.1.1" xref="S4.F2.sf9.2.1.m1.1.1.cmml"><mi id="S4.F2.sf9.2.1.m1.1.1.2" xref="S4.F2.sf9.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf9.2.1.m1.1.1.1" xref="S4.F2.sf9.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf9.2.1.m1.1.1.3" xref="S4.F2.sf9.2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf9.2.1.m1.1c"><apply id="S4.F2.sf9.2.1.m1.1.1.cmml" xref="S4.F2.sf9.2.1.m1.1.1"><eq id="S4.F2.sf9.2.1.m1.1.1.1.cmml" xref="S4.F2.sf9.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf9.2.1.m1.1.1.2.cmml" xref="S4.F2.sf9.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf9.2.1.m1.1.1.3.cmml" xref="S4.F2.sf9.2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf9.2.1.m1.1d">\alpha=0.1</annotation></semantics></math>) w/ 60 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf10" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x11.png" id="S4.F2.sf10.g1" class="ltx_graphics ltx_img_landscape" width="110" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf10.4.2.1" class="ltx_text" style="font-size:80%;">(j)</span> </span><span id="S4.F2.sf10.2.1" class="ltx_text" style="font-size:70%;"> CIFAR10 (<math id="S4.F2.sf10.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.F2.sf10.2.1.m1.1b"><mrow id="S4.F2.sf10.2.1.m1.1.1" xref="S4.F2.sf10.2.1.m1.1.1.cmml"><mi id="S4.F2.sf10.2.1.m1.1.1.2" xref="S4.F2.sf10.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf10.2.1.m1.1.1.1" xref="S4.F2.sf10.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf10.2.1.m1.1.1.3" xref="S4.F2.sf10.2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf10.2.1.m1.1c"><apply id="S4.F2.sf10.2.1.m1.1.1.cmml" xref="S4.F2.sf10.2.1.m1.1.1"><eq id="S4.F2.sf10.2.1.m1.1.1.1.cmml" xref="S4.F2.sf10.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf10.2.1.m1.1.1.2.cmml" xref="S4.F2.sf10.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf10.2.1.m1.1.1.3.cmml" xref="S4.F2.sf10.2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf10.2.1.m1.1d">\alpha=0.5</annotation></semantics></math>) w/ 60 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf11" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x12.png" id="S4.F2.sf11.g1" class="ltx_graphics ltx_img_landscape" width="111" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf11.4.2.1" class="ltx_text" style="font-size:80%;">(k)</span> </span><span id="S4.F2.sf11.2.1" class="ltx_text" style="font-size:70%;"> CIFAR10 (<math id="S4.F2.sf11.2.1.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.F2.sf11.2.1.m1.1b"><mrow id="S4.F2.sf11.2.1.m1.1.1" xref="S4.F2.sf11.2.1.m1.1.1.cmml"><mi id="S4.F2.sf11.2.1.m1.1.1.2" xref="S4.F2.sf11.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf11.2.1.m1.1.1.1" xref="S4.F2.sf11.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf11.2.1.m1.1.1.3" xref="S4.F2.sf11.2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf11.2.1.m1.1c"><apply id="S4.F2.sf11.2.1.m1.1.1.cmml" xref="S4.F2.sf11.2.1.m1.1.1"><eq id="S4.F2.sf11.2.1.m1.1.1.1.cmml" xref="S4.F2.sf11.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf11.2.1.m1.1.1.2.cmml" xref="S4.F2.sf11.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S4.F2.sf11.2.1.m1.1.1.3.cmml" xref="S4.F2.sf11.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf11.2.1.m1.1d">\alpha=1</annotation></semantics></math>) w/ 60 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf12" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x13.png" id="S4.F2.sf12.g1" class="ltx_graphics ltx_img_landscape" width="110" height="75" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf12.3.1.1" class="ltx_text" style="font-size:80%;">(l)</span> </span><span id="S4.F2.sf12.4.2" class="ltx_text" style="font-size:70%;"> CIFAR10 (IID) w/ 60 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf13" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x14.png" id="S4.F2.sf13.g1" class="ltx_graphics ltx_img_landscape" width="110" height="75" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf13.4.2.1" class="ltx_text" style="font-size:80%;">(m)</span> </span><span id="S4.F2.sf13.2.1" class="ltx_text" style="font-size:70%;"> CIFAR100 (<math id="S4.F2.sf13.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.F2.sf13.2.1.m1.1b"><mrow id="S4.F2.sf13.2.1.m1.1.1" xref="S4.F2.sf13.2.1.m1.1.1.cmml"><mi id="S4.F2.sf13.2.1.m1.1.1.2" xref="S4.F2.sf13.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf13.2.1.m1.1.1.1" xref="S4.F2.sf13.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf13.2.1.m1.1.1.3" xref="S4.F2.sf13.2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf13.2.1.m1.1c"><apply id="S4.F2.sf13.2.1.m1.1.1.cmml" xref="S4.F2.sf13.2.1.m1.1.1"><eq id="S4.F2.sf13.2.1.m1.1.1.1.cmml" xref="S4.F2.sf13.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf13.2.1.m1.1.1.2.cmml" xref="S4.F2.sf13.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf13.2.1.m1.1.1.3.cmml" xref="S4.F2.sf13.2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf13.2.1.m1.1d">\alpha=0.1</annotation></semantics></math>) w/ 60 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf14" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x15.png" id="S4.F2.sf14.g1" class="ltx_graphics ltx_img_landscape" width="111" height="75" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf14.4.2.1" class="ltx_text" style="font-size:80%;">(n)</span> </span><span id="S4.F2.sf14.2.1" class="ltx_text" style="font-size:70%;"> CIFAR100 (<math id="S4.F2.sf14.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.F2.sf14.2.1.m1.1b"><mrow id="S4.F2.sf14.2.1.m1.1.1" xref="S4.F2.sf14.2.1.m1.1.1.cmml"><mi id="S4.F2.sf14.2.1.m1.1.1.2" xref="S4.F2.sf14.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf14.2.1.m1.1.1.1" xref="S4.F2.sf14.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf14.2.1.m1.1.1.3" xref="S4.F2.sf14.2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf14.2.1.m1.1c"><apply id="S4.F2.sf14.2.1.m1.1.1.cmml" xref="S4.F2.sf14.2.1.m1.1.1"><eq id="S4.F2.sf14.2.1.m1.1.1.1.cmml" xref="S4.F2.sf14.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf14.2.1.m1.1.1.2.cmml" xref="S4.F2.sf14.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F2.sf14.2.1.m1.1.1.3.cmml" xref="S4.F2.sf14.2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf14.2.1.m1.1d">\alpha=0.5</annotation></semantics></math>) w/ 60 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf15" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x16.png" id="S4.F2.sf15.g1" class="ltx_graphics ltx_img_landscape" width="111" height="76" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf15.4.2.1" class="ltx_text" style="font-size:80%;">(o)</span> </span><span id="S4.F2.sf15.2.1" class="ltx_text" style="font-size:70%;"> CIFAR100 (<math id="S4.F2.sf15.2.1.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.F2.sf15.2.1.m1.1b"><mrow id="S4.F2.sf15.2.1.m1.1.1" xref="S4.F2.sf15.2.1.m1.1.1.cmml"><mi id="S4.F2.sf15.2.1.m1.1.1.2" xref="S4.F2.sf15.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F2.sf15.2.1.m1.1.1.1" xref="S4.F2.sf15.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf15.2.1.m1.1.1.3" xref="S4.F2.sf15.2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf15.2.1.m1.1c"><apply id="S4.F2.sf15.2.1.m1.1.1.cmml" xref="S4.F2.sf15.2.1.m1.1.1"><eq id="S4.F2.sf15.2.1.m1.1.1.1.cmml" xref="S4.F2.sf15.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf15.2.1.m1.1.1.2.cmml" xref="S4.F2.sf15.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S4.F2.sf15.2.1.m1.1.1.3.cmml" xref="S4.F2.sf15.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf15.2.1.m1.1d">\alpha=1</annotation></semantics></math>) w/ 60 devices</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F2.sf16" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.02006/assets/x17.png" id="S4.F2.sf16.g1" class="ltx_graphics ltx_img_landscape" width="110" height="75" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf16.3.1.1" class="ltx_text" style="font-size:80%;">(p)</span> </span><span id="S4.F2.sf16.4.2" class="ltx_text" style="font-size:70%;"> CIFAR100 (IID) w/ 60 devices</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Test accuracy comparison of AIoT systems for both
IID and non-IID scenarios with different number of devices</figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">To evaluate
the effectiveness of our proposed method,
we developed the HierarchyFL framework
using PyTorch (version 1.4.0). We
set the random seed to 1234, which can
mitigate the influence of randomness within the experimental results. Note that in the training procedure, we assumed that all the AIoT devices are involved in each FL communcation
round.
We set the mini-batch size of both hierarchical self-distillation and other heterogeneous FL methods to 32, where the number of local training epochs and the initial learning rate are set to 5 and 0.05, respectively. To ensure the stability of the training process, the learning rate adaptively dropped 0.1 in every 30 epochs.
The initial learning rate of HierarchyFL is set to 0.05. Based on the adaptive drop of the learning rate, it drops by 0.1 in every 30 epochs.
Our experimental environment is based on a Windows personal computer, which is deployed with an Intel i9 CPU, 32GB memory, and GTX3090.
The subsequent experiments are conducted to answer these three research questions.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">RQ1: (Superiority of HierarchyFL)</span>:
What are the advantages of HierarchyFL compared with
state-of-the-art heterogeneous federated learning methods?</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">RQ2: (Scalability of HierarchyFL)</span>:
What is the impact of the number of AIoT devices for knowledge sharing in HierarchyFL?</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p"><span id="S4.p4.1.1" class="ltx_text ltx_font_bold">RQ3: (Benefits of Ensemble Library)</span>: How
much can HierarchyFL benefit from the ensemble library during hierarchical self-distillation?</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Experimental Settings</span>
</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS1.4.1.1" class="ltx_text">IV-A</span>1 </span>Dataset Setting</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.2" class="ltx_p">To show the effectiveness of our HierarchyFL method, we considered two training datasets (i.e., CIFAR10 and CIFAR100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>), where both of them involve 50000 training images and 10000 testing images, respectively. For each
dataset, we investigated both Independent and Identically Distributed (IID) and non-IID distributions for subsequent experiments.
For non-IID scenarios, we constructed local training sets using heterogeneous data splits with a Dirichlet distribution, which is the same as Fedproto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. In the Dirichlet distribution, the value of <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mi id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><ci id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">\alpha</annotation></semantics></math> means the distribution degree of non-IID, where a smaller <math id="S4.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><mi id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><ci id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">\alpha</annotation></semantics></math> represents a higher distribution degree of non-IID.
To fully use the nature image datasets, we use the data augmentation technologies in our experiment, which are similar to the ones used by HeteroFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. To simulate the real scenario in the cloud server, in our experiment, the public dataset only accounts for only 1% of the overall training data in HierarchyFL.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS2.4.1.1" class="ltx_text">IV-A</span>2 </span>Model Setting</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">We compared
our HierarchyFL with two state-of-the-art model heterogeneous methods, i.e., HeteroFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, and Fedproto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
Following the HeteroFL, we set the ResNet-18 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> as the backbone, and four bottlenecks and classifiers are followed by each block of ResNet18 as the four newly hierarchy models (i.e., Models 1-4 shown in Table <a href="#S3.T1" title="TABLE I ‣ III-B1 Ensemble Library Update ‣ III-B Hierarchical Self-distillation ‣ III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>) to simulate four types of heterogeneous models in our experiments. Note that under these settings, each hierarchy model can be reused with the same backbone to conduct the model inference.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Performance comparison</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To show the superiority of HierarchyFL, we compared our
approach with the two heterogeneous FL methods with four
data settings. Table <a href="#S3.T1" title="TABLE I ‣ III-B1 Ensemble Library Update ‣ III-B Hierarchical Self-distillation ‣ III Our HierarchyFL Approach ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> presents the comparison results for two image datasets.
In this table, columns 2-4 present the name of three heterogeneous FL methods, where each column has four sub-columns to represent the various
training data distribution of all local AIoT devices.
Note that the non-IID setting we used in this table is the Dirichlet distribution with various <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\alpha</annotation></semantics></math> settings (i.e., 0.1, 0.5, 1.0).</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">From this table, we can realize that HierarchyFL obtains the best inference performance in 30 out of 32 scenarios.
For example, compared with
Fedproto, HierarchyFL achieves more than 25%
improvement with <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\alpha=0.1</annotation></semantics></math> for Model 1. Furthermore, we can find that our HierarchyFL method always outperforms its counterparts in non-IID settings. For instance,
HierarchyFL outperforms HeteroFL by 13% in <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\alpha=0.1</annotation></semantics></math> training data set on average.
In other words, the hierarchical self-distillation can effectively improve the inference capabilities of all the hierarchy models with the assistance of the ensemble library.
This is mainly because HierarchyFL fully considers the diversity of each hierarchy model knowledge, which can be used in self-distillation by learning a wise ensemble library to effectively enhance the model inference performance of each hierarchy model in an AIoT system.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Discussion</span>
</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS3.SSS1.4.1.1" class="ltx_text">IV-C</span>1 </span>Scalability Analysis</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">Due to the prevalence of large-scale AIoT systems, scalability is essential in the development of HierarchyFL.
Figure <a href="#S4.F2" title="Figure 2 ‣ IV Experiment ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the inference comparison of
AIoT systems under both IID and non-IID scenarios with both 40 and 60 devices, where the experimental settings are the same as that in Section <a href="#S4.SS1" title="IV-A Experimental Settings ‣ IV Experiment ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-A</span></span></a>.</p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para">
<p id="S4.SS3.SSS1.p2.1" class="ltx_p">As shown in Figure <a href="#S4.F2" title="Figure 2 ‣ IV Experiment ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, when large devices participate in the three heterogeneous federated learning methods, the superiority of HierarchyFL becomes more obvious than the other two methods.
Our HierarchyFL method always outperforms its counterparts for the two image datasets under all the training data settings with 40 and 60 devices, where the star (i.e., HierarchyFL) is always above the circle (i.e., HeteroFL) and triangle (i.e., Fedproto) in the Figure <a href="#S4.F2" title="Figure 2 ‣ IV Experiment ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS3.SSS2.4.1.1" class="ltx_text">IV-C</span>2 </span>Ablation Study</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">To evaluate the contributions of ensemble library parts in HierarchyFL, we conducted an ablation study on CIFAR100 under data setting <math id="S4.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mrow id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS2.p1.1.m1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><apply id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><eq id="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1"></eq><ci id="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">\alpha=0.1</annotation></semantics></math> with 20 devices, whose results are shown in Table <a href="#S4.T2" title="TABLE II ‣ IV-C2 Ablation Study ‣ IV-C Discussion ‣ IV Experiment ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. Column 1 denotes the case without adopting knowledge distillation or only using the layer alignment averaging for each hierarchy model. Based on our
HierarchyFL method, columns 2 and 3 present the two cases indicating
whether the ensemble logits and ensemble features
are included, respectively. Columns 4
indicates the inference performance of the global model (i.e., Model 4).</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Ablation results considering impacts of
Ensemble Library</figcaption>
<table id="S4.T2.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.6.7.1" class="ltx_tr">
<td id="S4.T2.6.7.1.1" class="ltx_td ltx_align_center ltx_border_t">Averaging</td>
<td id="S4.T2.6.7.1.2" class="ltx_td ltx_align_center ltx_border_t">Ensemble Logits</td>
<td id="S4.T2.6.7.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Ensemble Features</td>
<td id="S4.T2.6.7.1.4" class="ltx_td ltx_align_center ltx_border_t">Global Model (%)</td>
</tr>
<tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mi mathvariant="normal" id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S4.T2.1.1.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S4.T2.1.1.4" class="ltx_td ltx_align_center ltx_border_t">47.09</td>
</tr>
<tr id="S4.T2.3.3" class="ltx_tr">
<td id="S4.T2.2.2.1" class="ltx_td ltx_align_center"><math id="S4.T2.2.2.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S4.T2.2.2.1.m1.1a"><mi mathvariant="normal" id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><ci id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S4.T2.3.3.2" class="ltx_td ltx_align_center"><math id="S4.T2.3.3.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S4.T2.3.3.2.m1.1a"><mi mathvariant="normal" id="S4.T2.3.3.2.m1.1.1" xref="S4.T2.3.3.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.2.m1.1b"><ci id="S4.T2.3.3.2.m1.1.1.cmml" xref="S4.T2.3.3.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.2.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S4.T2.3.3.3" class="ltx_td ltx_border_r"></td>
<td id="S4.T2.3.3.4" class="ltx_td ltx_align_center">49.04</td>
</tr>
<tr id="S4.T2.6.6" class="ltx_tr">
<td id="S4.T2.4.4.1" class="ltx_td ltx_align_center ltx_border_b"><math id="S4.T2.4.4.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S4.T2.4.4.1.m1.1a"><mi mathvariant="normal" id="S4.T2.4.4.1.m1.1.1" xref="S4.T2.4.4.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.m1.1b"><ci id="S4.T2.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S4.T2.5.5.2" class="ltx_td ltx_align_center ltx_border_b"><math id="S4.T2.5.5.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S4.T2.5.5.2.m1.1a"><mi mathvariant="normal" id="S4.T2.5.5.2.m1.1.1" xref="S4.T2.5.5.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.2.m1.1b"><ci id="S4.T2.5.5.2.m1.1.1.cmml" xref="S4.T2.5.5.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.2.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S4.T2.6.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><math id="S4.T2.6.6.3.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S4.T2.6.6.3.m1.1a"><mi mathvariant="normal" id="S4.T2.6.6.3.m1.1.1" xref="S4.T2.6.6.3.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.3.m1.1b"><ci id="S4.T2.6.6.3.m1.1.1.cmml" xref="S4.T2.6.6.3.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.3.m1.1c">\checkmark</annotation></semantics></math></td>
<td id="S4.T2.6.6.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.6.6.4.1" class="ltx_text ltx_font_bold">52.56</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.SSS2.p2" class="ltx_para">
<p id="S4.SS3.SSS2.p2.1" class="ltx_p">Note that HeteroFL can be considered as HierarchyFL without its hierarchical self-distillation procedure by the ensemble library.
Unlike HeteroFL, HierarchyFL takes the synergy of hierarchical self-distillation by the ensemble library into account.
From Table <a href="#S4.T2" title="TABLE II ‣ IV-C2 Ablation Study ‣ IV-C Discussion ‣ IV Experiment ‣ HierarchyFL: Heterogeneous Federated Learning via Hierarchical Self-Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, we can find that compared with HeteroFL, the inference of the global model (i.e., Model 4) can be
improved from 47.09% to 52.56%.
In other words, each element in the ensemble library plays a crucial role in the knowledge sharing of HierarchyFL.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Although FL is promising for privacy-preserving collaborative learning, it still suffers from the model heterogeneity problem due to the different hardware resources of all involved AIoT devices. To alleviate the negative impact of this problem, we propose a novel HierarchyFL framework, which enables efficient knowledge sharing on large-scale AIoT systems with various heterogeneous models. By combining self-distillation with our ensemble library, each hierarchical model can intelligently learn from each other, improving its model inference performance. Comprehensive experiments on well-known datasets demonstrate the effectiveness of HierarchyFL in terms of inference performance and scalability.
</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. McMahan, et al.,
“Communication-efficient learning of deep networks from decentralized
data”,
<em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">AISTATS</em>, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
R. Chandrasekaran, et al.,
“FHDnn: Communication Efficient and Robust Federated Learning for AIoT Networks”, <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">DAC</em>, 2022, pp. 37-42.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Z. Gao, et al.,
“FedSwap: A Federated Learning based 5G Decentralized Dynamic Spectrum Access System”, <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">ICCAD</em>, 2021, pp. 1-6.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
X. Zhang, et al.,
“Efficient Federated Learning for Cloud-Based AIoT Applications”, <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE TCAD</em>, 41(11):2211-2223, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
J. Xia, et al.,
“Accelerated synthesis of neural network-based barrier certificates using collaborative learning”, <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">DAC</em>, 2022, pp. 1201–1206.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Y. Ye, et al.,
“FedLight: Federated Reinforcement Learning for Autonomous Multi-Intersection Traffic Signal Control”, <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">DAC</em>, 2021, pp. 847–852.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
P. Kairouz, et al.,
“Advances and open problems in federated learning,”
in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>,
vol. 14, no. 1-2, pp. 1–210, 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y. Wu, et al.,
“Federated Contrastive Learning for Dermatological Disease Diagnosis via On-device Learning”, <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">ICCAD</em>, 2021, pp. 1-7.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Z. Xu, et al.,
“Helios: Heterogeneity-Aware Federated Learning with Dynamically Balanced Collaboration”, <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">DAC</em>, 2021, pp. 997-1002.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Tan, et al.,
“FedProto: Federated Prototype Learning across Heterogeneous Clients,”
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, 2022, pp. 8432-8440.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
J. Xia, et al.,
“PervasiveFL: Pervasive Federated Learning for Heterogeneous IoT Systems”, <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE TCAD</em>, 41(11):4100-4111, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Z. Zhu, et al.,
“Data-Free Knowledge Distillation for Heterogeneous Federated Learning,”
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ICML</em>, pp. 12878–12889, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
E. Diao, et al.,
“HeteroFL: Computation and Communication Efficient Federated Learning for Heterogeneous Clients,”
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
L. Zhang, et al.,
“Self-Distillation: Towards Efficient and Compact Neural Networks,”
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE PAMI</em>, 44(8):4388-4403, 2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
J. Hong, et al.,
“Efficient Split-Mix Federated Learning for On-Demand and In-Situ Customization,”
<em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
T. Lin, et al.,
“Ensemble distillation for robust model fusion in federated learning,”
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2020, pp. 2351–2363.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
K. He, et al.,
“Deep residual learning for image recognition,”
<em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016, pp. 770–778.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
A. Krizhevsky, et al.,
“Learning multiple layers of features from tiny images,”
http://www.cs.toronto.edu/ kriz/cifar.html, 2009.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2212.02005" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2212.02006" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2212.02006">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2212.02006" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2212.02007" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 12:35:06 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
