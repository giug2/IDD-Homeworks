<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services</title>
<!--Generated on Thu Oct  3 11:53:18 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
large language models,  inference services,  performance,  benchmarking,  prediction
" lang="en" name="keywords"/>
<base href="/html/2410.02425v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S1" title="In LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2" title="In LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Background</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.SS1" title="In II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">LLM inference performance requirements</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.SS2" title="In II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">LLM inference servers</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.SS3" title="In II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span> </span><span class="ltx_text ltx_font_italic">Deploying LLM inference services</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3" title="In LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Performance Characterization Tool</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS1" title="In III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Analysis of production traces</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2" title="In III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Workload generator</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2.SSS1" title="In III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span>1 </span>Modelling the requests</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2.SSS2" title="In III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span>2 </span>Sampling requests</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS3" title="In III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Performance data collection</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS3.SSS1" title="In III-C Performance data collection ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>1 </span>Deployment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS3.SSS2" title="In III-C Performance data collection ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>2 </span>Tuning the batch weight</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS3.SSS3" title="In III-C Performance data collection ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>3 </span>Load testing</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS4" title="In III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-D</span> </span><span class="ltx_text ltx_font_italic">Other considerations</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4" title="In LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">GPU Recommendation Tool</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS1" title="In IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Problem statement</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS2" title="In IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">LLM-Pilot’s solution</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS2.SSS1" title="In IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span>1 </span>Feature engineering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS2.SSS2" title="In IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span>2 </span>Regressor</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS2.SSS3" title="In IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span>3 </span>Hyperparameter tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS2.SSS4" title="In IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span>4 </span>Final GPU recommendation</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5" title="In LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Analysis and Evaluation</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS1" title="In V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-A</span> </span><span class="ltx_text ltx_font_italic">Workload generator</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS2" title="In V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-B</span> </span><span class="ltx_text ltx_font_italic">Performance characterization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS3" title="In V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-C</span> </span><span class="ltx_text ltx_font_italic">GPU recommendation</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6" title="In LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">Related Works</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.SS1" title="In VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-A</span> </span><span class="ltx_text ltx_font_italic">LLM traces</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.SS2" title="In VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-B</span> </span><span class="ltx_text ltx_font_italic">Workload generators and benchmarking tools</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.SS3" title="In VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-C</span> </span><span class="ltx_text ltx_font_italic">LLM performance datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.SS4" title="In VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-D</span> </span><span class="ltx_text ltx_font_italic">LLM performance prediction</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S7" title="In LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VII </span><span class="ltx_text ltx_font_smallcaps">Conclusion and Next Steps</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">LLM-Pilot: Characterize and Optimize Performance
<br class="ltx_break"/>of your LLM Inference Services</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Malgorzata Lazuka
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id1.1.id1">IBM Research, ETH Zurich
<br class="ltx_break"/></span>Zurich, Switzerland 
<br class="ltx_break"/>mal@zurich.ibm.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andreea Anghel
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id2.1.id1">IBM Research
<br class="ltx_break"/></span>Zurich, Switzerland 
<br class="ltx_break"/>aan@zurich.ibm.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Thomas Parnell
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id3.1.id1">IBM Research
<br class="ltx_break"/></span>Zurich, Switzerland 
<br class="ltx_break"/>tpa@zurich.ibm.com
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.id1">As Large Language Models (LLMs) are rapidly growing in popularity, LLM inference services must be able to serve requests from thousands of users while satisfying performance requirements.
The performance of an LLM inference service is largely determined by the hardware onto which it is deployed, but understanding of which hardware will deliver on performance requirements remains challenging.
In this work we present LLM-Pilot – a first-of-its-kind system for characterizing and predicting performance of LLM inference services.
LLM-Pilot performs benchmarking of LLM inference services, under a realistic workload, across a variety of GPUs, and optimizes the service configuration for each considered GPU to maximize performance.
Finally, using this characterization data, LLM-Pilot learns a predictive model, which can be used to recommend the most cost-effective hardware for a previously unseen LLM.
Compared to existing methods, LLM-Pilot can deliver on performance requirements 33% more frequently, whilst reducing costs by 60% on average.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
large language models, inference services, performance, benchmarking, prediction

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) have gained massive popularity in recent years, in both industry and the research community <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib58" title="">58</a>]</cite> for their remarkable capability of performing a wide variety of natural language processing tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib27" title="">27</a>]</cite>.
In particular, LLMs excel at generating text and programming code, conducting conversation as chatbots, extracting information from text, and language translation.
The development of LLMs is only accelerating and considered to be a modern-day Moore’s law <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib2" title="">2</a>]</cite>, with numbers of parameters of newly released LLMs growing exponentially <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib53" title="">53</a>]</cite>.
This is largely due to the fact that, until now, training larger LLMs has been a sure path to improving the LLM’s output quality <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib17" title="">17</a>]</cite>.
Unfortunately, growing LLMs in size leads to the necessity to scale the hardware used for their training and inference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib43" title="">43</a>]</cite>.
As most research efforts in this area go into improving the performance of LLM training, optimizing the performance of LLM inference services remains a fairly unexplored area <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib39" title="">39</a>]</cite>.
Therefore, we are starting to observe a new challenge emerging: <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">Once you have trained a state-of-the-art LLM with billions of parameters, how do you deploy it in a cost-effective way while ensuring sufficient performance?</em></p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The choice of hardware to which the inference service is deployed can significantly impact the resulting performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib39" title="">39</a>]</cite>.
As LLM inference services must store billions of model weights, the choice of hardware is limited to a range of powerful GPUs, which are currently scarce and in all-time high demand <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib31" title="">31</a>]</cite>.
As a result, GPUs are both hard to get and hard to afford.
While cloud providers offer on-demand GPU instances, in the long-term they are more expensive than buying GPUs and institutions often prefer to pool on-prem resources instead <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib43" title="">43</a>]</cite>.
In this work we consider the perspective of such an institution, which owns and maintains a large cluster of heterogeneous GPUs.
Each GPU has some cost per unit time associated with it, which may be related to the total cost of ownership, energy consumption or some combination thereof.
We consider two roles with respect to this cluster: a cluster user and a cluster administrator.
The user wishes to deploy an LLM inference service and has a set of performance requirements that should be met, while the administrator has an interest that each inference service incurs as little cost as possible, thus ensuring that the resources are efficiently utilized.
In some private cloud-like scenarios, the burden of cost may also be passed onto the user, who may be billed internally for the resources consumed.
Trying to satisfy both performance and cost requirements is challenging since the performance of a given LLM inference service on a given GPU in the cluster is a-priori unknown.
Additionally, it is impractical for the user to run a large set of experiments to characterize performance across different GPUs, because the cluster is typically close to fully-utilized.
This motivates the two problems considered in this work: (1) how the administrator can collect data offline to characterize the performance of different LLMs on different GPUs and (2) how this data can assist the user to make online decisions about the type and number of GPUs that will satisfy their performance requirements in the most cost-effective way.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this work we present LLM-Pilot, a first-of-its-kind system for characterizing the performance of LLM inference services, and recommending the cheapest deployment for a new LLM such that its performance requirements are met.
LLM-Pilot consists of two main components: the performance characterization tool and the GPU recommendation tool.
The performance characterization tool can be used offline, by the cluster administrator, to benchmark the performance of a collection of LLM inference services across the GPUs of the cluster.
While doing so, it ensures that the inference service is subject to a realistic load of inference requests and that the server-side batching algorithm has been configured individually for each GPU.
The output is a characterization dataset containing performance measurements for a variety of LLMs across the different GPUs of the cluster.
The GPU recommendation tool provides the cluster user with online recommendations regarding how to deploy an unseen LLM in the most cost-effective way whilst satisfying their performance requirements.
This is achieved by learning a predictive performance model, fitted to the offline characterization data, and tailored to the user’s specific performance requirements.
In summary, the contributions of this work are as follows:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">An LLM inference benchmarking tool<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/fmperf-project/fmperf" title="">https://github.com/fmperf-project/fmperf</a>.</span></span></span> which ensures that the services are optimized for the specific hardware, and internally uses our novel workload generator<sup class="ltx_sup" id="S1.I1.i1.p1.1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#footnote1" title="footnote 1 ‣ item 1 ‣ I Introduction ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a></sup>, which subjects the services to a realistic workload of inference requests based on a large collection of production traces.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">A performance dataset comparing the inference performance of many LLMs running on a variety of GPUs, which we have open sourced in order to deepen the understanding of LLM inference performance and its dependence on the GPU choice<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/IBM/LLM-performance-prediction" title="">https://github.com/IBM/LLM-performance-prediction</a>.</span></span></span>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">A GPU recommendation tool<sup class="ltx_sup" id="S1.I1.i3.p1.1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#footnote2" title="footnote 2 ‣ item 2 ‣ I Introduction ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">2</span></a></sup> which can ensure satisfying the performance requirements 33% more frequently than state-of-the-art methods, and reduces cost of recommended type and number of GPUs by 60% on average, thanks to the use of a novel performance prediction model designed specifically for this use-case.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S1.p3.2">The structure of this work is as follows: in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2" title="II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">II</span></a> we discuss the background on the performance and deployment of LLM inference services.
Then, we present the performance characterization tool (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3" title="III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">III</span></a>) and the GPU recommendation tool (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4" title="IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">IV</span></a>) of LLM-Pilot.
In Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5" title="V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">V</span></a> we evaluate various novel components of LLM-Pilot, and in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6" title="VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">VI</span></a> we discuss prior works on related topics.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Background</span>
</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.5.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.6.2">LLM inference performance requirements</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Unlike inference services based on classical machine learning or deep learning models, LLMs process requests in two phases.
First, in the so-called <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.1.1">prompt processing</em> phase, they split the input text into smaller segments called tokens, process them and populate the key-value (KV) cache <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib19" title="">19</a>]</cite>, and finally generate the first output token.
Then, in the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.1.2">decode</em> phase, they update the KV cache and sequentially generate the output tokens, which are later converted into an output text and sent to the user.
The latency of these phases (and consequently the end-to-end latency) can vary significantly depending on the number of input and output tokens.
Therefore, in case of LLMs one typically defines two latency metrics.
Time to first token (TTFT) measures the overhead of generating the first output token resulting from processing the input tokens.
The inter-token latency (ITL) measures the latency of generating each subsequent output token.
Depending on the application, one of these metrics can have larger impact on the end user’s experience than the other.
For example, in case of LLM-powered chatbots, it is important for the user’s experience that the output starts being generated quickly, while the speed of subsequent tokens does not need to exceed the human reading speed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib60" title="">60</a>]</cite>.
On the other hand, when LLMs are used for text summarization, longer initial overhead is acceptable as long as long output texts can be generated quickly <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib60" title="">60</a>]</cite>.
Inference services are typically subject to a service-level agreement (SLA) which outlines the requirements regarding the service’s performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib33" title="">33</a>]</cite>.
In case of LLM inference services, however, one must ensure that both TTFT and ITL meet their respective SLA constraints.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.5.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.6.2">LLM inference servers</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">In practice, in order to perform inference on a trained LLM, one uses a framework called an inference server (e.g., vLLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib19" title="">19</a>]</cite>, TGIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib14" title="">14</a>]</cite>, TGI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib11" title="">11</a>]</cite>, Orca <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib57" title="">57</a>]</cite>, NVIDIA Triton Inference Server <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib30" title="">30</a>]</cite>), which acts as a bridge between the LLM and the users sending their inference requests.
The inference server handles running all incoming requests through the LLM and sending back the generated responses.
As the incoming inference requests can strongly vary in terms of number of input and output tokens, inference servers typically use <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.1">continuous batching</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib57" title="">57</a>]</cite> to improve utilization of the hardware hosting the inference service.
In continuous batching, the server maintains a single batch of requests from various users that are being processed at any given moment.
When processing of certain requests in the batch finishes, new requests are introduced into the batch from the queue, while other requests in the batch continue processing.
This way, requests with diverse numbers of input and output tokens can be processesed in parallel but small requests can be processed quickly, without waiting for larger requests in the batch to finish processing.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">When an LLM is deployed on a GPU, a large amount of its capacity is used for storing the LLM itself.
The remaining capacity is required for storing the KV cache associated with the batch of requests currently being processed, as well as any auxiliary data structures required to perform a forward pass with the LLM.
The larger the storage space assigned to the batch, the more requests can be processed in parallel, which in turn improves the throughput of the inference service.
Inference servers control the maximum size of the batch using equivalent parameters under different names, e.g., max batch weight in TGIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib14" title="">14</a>]</cite>, max num batch tokens in vLLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib19" title="">19</a>]</cite>, and max batch total tokens in TGI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib11" title="">11</a>]</cite>.
In this work, we refer to it as the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.1.1">maximum batch weight</em>.
The maximum batch weight is the maximum allowed ‘volume’ of the batch, defined as the total number input and output tokens of all requests processed in the batch at any given time.
This indirectly determines the maximum storage space that can be occupied by the batch and significantly impacts the inference performance.</p>
</div>
<figure class="ltx_figure" id="S2.F1">
<p class="ltx_p ltx_align_center" id="S2.F1.1"><span class="ltx_text" id="S2.F1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="299" id="S2.F1.1.1.g1" src="extracted/5895755/batch_weight_impact.png" width="598"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.4.2" style="font-size:90%;">Median end-to-end latency achieved by the inference service of a selected LLM (bigcode/starcoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib21" title="">21</a>]</cite>) deployed on one A100 GPU with varying maximum batch weight, for 128 concurrent users.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S2.F2">
<p class="ltx_p ltx_align_center" id="S2.F2.1"><span class="ltx_text" id="S2.F2.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="176" id="S2.F2.1.1.g1" src="extracted/5895755/characterization_overview.png" width="598"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.3.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.4.2" style="font-size:90%;">Architecture of the performance characterization tool.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.2">Tuning the maximum batch weight is critical to achieving optimal inference performance.
For example, when the maximum batch weight is doubled, we can expect the queuing time of requests to decrease because twice as many tokens are being processed in parallel.
However, the end-to-end latency comprises both the queuing time and the processing time (i.e., time needed to generate all output tokens).
If doubling the maximum batch weight increases the processing time of each request by more than 2<math alttext="\times" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mo id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><times id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">×</annotation></semantics></math>, the final end-to-end latency will actually be worse.
Therefore, in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.F1" title="Figure 1 ‣ II-B LLM inference servers ‣ II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a> we analyze the end-to-end latency of a selected LLM inference service running on the same GPU with varying maximum batch weight.
The chart shows that increasing the maximum batch weight improves the end-to-end latency: the largest maximum batch weight results in approx. 2.8<math alttext="\times" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><mo id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><times id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">×</annotation></semantics></math> lower end-to-end latency than the smallest one.
This confirms that (a) the maximum batch weight strongly impacts the inference performance, and (b) in order to optimize performance under the load of inference requests from our workload generator (see Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2" title="III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>), the maximum batch weight should be set as high as possible.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS3.5.1.1">II-C</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS3.6.2">Deploying LLM inference services</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">When an inference service is to be used in production, it is deployed onto a Kubernetes (k8s) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib7" title="">7</a>]</cite> or Openshift <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib36" title="">36</a>]</cite> cluster via an abstraction called a <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.1">Deployment</em>.
Each deployment manages a number of replicas of the inference service, and each replica is deployed to the cluster via an abstraction called a <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.2">Pod</em>.
Load balancing is performed across the pods of the deployment, which operate independently, and the number of pods can be scaled up or down based on demand.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Since inference is embarrassingly parallel at the level of requests, and LLM inference requests can easily take more than 100ms, we expect close-to-perfect scaling of the throughput with respect to the number of pods.
We confirm this experimentally, as depicted in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.T1" title="TABLE I ‣ II-C Deploying LLM inference services ‣ II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">I</span></a>.
In the experiment, we have tested different numbers of pods of the same LLM inference service running on the same GPU, under different numbers of concurrent users whose requests are distributed across pods.
Results confirm near-perfect scaling – across cases with the same ratio between the number of concurrent users and number of pods (e.g., 1 pod and 8 users, 2 pods and 16 users, etc.), indicated by the same cell background color, the relative standard deviation of throughputs per pod never exceeds 5% (2% on average).</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S2.T1.2.1.1" style="font-size:90%;">TABLE I</span>: </span><span class="ltx_text" id="S2.T1.3.2" style="font-size:90%;">Average throughput per pod achieved by a varying number of Llama-2-13b pods, each running on a A100 80GB GPU, for various numbers of concurrent users. Same color of diagonally adjacent cells marks cases with the same ratio between the number of pods and the number of concurrent users.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S2.T1.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.4.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.4.1.1.1" style="padding-left:4.5pt;padding-right:4.5pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="8" id="S2.T1.4.1.1.2" style="padding-left:4.5pt;padding-right:4.5pt;">Number of concurrent users</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S2.T1.4.2.2.1" style="padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.2.2.1.1">
<span class="ltx_tabular ltx_align_middle" id="S2.T1.4.2.2.1.1.1">
<span class="ltx_tr" id="S2.T1.4.2.2.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T1.4.2.2.1.1.1.1.1" style="padding-left:4.5pt;padding-right:4.5pt;">Number</span></span>
<span class="ltx_tr" id="S2.T1.4.2.2.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T1.4.2.2.1.1.1.2.1" style="padding-left:4.5pt;padding-right:4.5pt;">of pods</span></span>
</span></span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.2" style="padding-left:4.5pt;padding-right:4.5pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.3" style="padding-left:4.5pt;padding-right:4.5pt;">2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.4" style="padding-left:4.5pt;padding-right:4.5pt;">4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.5" style="padding-left:4.5pt;padding-right:4.5pt;">8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.6" style="padding-left:4.5pt;padding-right:4.5pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.7" style="padding-left:4.5pt;padding-right:4.5pt;">32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.8" style="padding-left:4.5pt;padding-right:4.5pt;">64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.2.2.9" style="padding-left:4.5pt;padding-right:4.5pt;">128</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.4.3.3.1" style="padding-left:4.5pt;padding-right:4.5pt;">1</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.2" style="background-color:#D2E4FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.2.1" style="background-color:#D2E4FF;">47.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.3" style="background-color:#E1EDFF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.3.1" style="background-color:#E1EDFF;">78.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.4" style="background-color:#E7D6FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.4.1" style="background-color:#E7D6FF;">118.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.5" style="background-color:#F0E5FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.5.1" style="background-color:#F0E5FF;">174.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.6" style="background-color:#FFD8D8;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.6.1" style="background-color:#FFD8D8;">237.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.7" style="background-color:#FFE6E5;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.7.1" style="background-color:#FFE6E5;">288.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.8" style="background-color:#FFE2BF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.8.1" style="background-color:#FFE2BF;">314.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.3.3.9" style="background-color:#FFF1E1;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.3.3.9.1" style="background-color:#FFF1E1;">292.6</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.4.4.4.1" style="padding-left:4.5pt;padding-right:4.5pt;">2</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.2" style="background-color:#E1FFE1;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.2.1" style="background-color:#E1FFE1;">23.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.3" style="background-color:#D2E4FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.3.1" style="background-color:#D2E4FF;">44.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.4" style="background-color:#E1EDFF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.4.1" style="background-color:#E1EDFF;">74.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.5" style="background-color:#E7D6FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.5.1" style="background-color:#E7D6FF;">114.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.6" style="background-color:#F0E5FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.6.1" style="background-color:#F0E5FF;">171.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.7" style="background-color:#FFD8D8;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.7.1" style="background-color:#FFD8D8;">229.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.8" style="background-color:#FFE6E5;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.8.1" style="background-color:#FFE6E5;">282.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.4.4.9" style="background-color:#FFE2BF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.4.4.9.1" style="background-color:#FFE2BF;">286.3</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.4.5.5.1" style="padding-left:4.5pt;padding-right:4.5pt;">4</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.2" style="background-color:#C7FFC7;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.2.1" style="background-color:#C7FFC7;">11.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.3" style="background-color:#E1FFE1;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.3.1" style="background-color:#E1FFE1;">23.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.4" style="background-color:#D2E4FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.4.1" style="background-color:#D2E4FF;">43.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.5" style="background-color:#E1EDFF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.5.1" style="background-color:#E1EDFF;">73.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.6" style="background-color:#E7D6FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.6.1" style="background-color:#E7D6FF;">113.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.7" style="background-color:#F0E5FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.7.1" style="background-color:#F0E5FF;">169.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.8" style="background-color:#FFD8D8;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.8.1" style="background-color:#FFD8D8;">231.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.4.5.5.9" style="background-color:#FFE6E5;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.5.5.9.1" style="background-color:#FFE6E5;">283.4</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.4.6.6.1" style="padding-left:4.5pt;padding-right:4.5pt;">8</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.2" style="background-color:#FFFFDB;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.2.1" style="background-color:#FFFFDB;">5.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.3" style="background-color:#C7FFC7;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.3.1" style="background-color:#C7FFC7;">11.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.4" style="background-color:#E1FFE1;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.4.1" style="background-color:#E1FFE1;">22.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.5" style="background-color:#D2E4FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.5.1" style="background-color:#D2E4FF;">42.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.6" style="background-color:#E1EDFF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.6.1" style="background-color:#E1EDFF;">72.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.7" style="background-color:#E7D6FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.7.1" style="background-color:#E7D6FF;">112.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.8" style="background-color:#F0E5FF;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.8.1" style="background-color:#F0E5FF;">169.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.4.6.6.9" style="background-color:#FFD8D8;padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text" id="S2.T1.4.6.6.9.1" style="background-color:#FFD8D8;">231.1</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.1">When defining the deployment specification, one must declare what hardware resources should be allocated to each pod.
These include the number and type of GPUs to be assigned to each pod (which we jointly refer to as the <em class="ltx_emph ltx_font_italic" id="S2.SS3.p3.1.1">GPU profile</em>), as well as the number of CPU cores and amount of memory.
Note that in the case when the specified GPU profile comprises more than one GPU, the weights of the LLM and all computation will be sharded across the GPUs in a tensor-parallel manner.
Tensor parallel deployments may be preferred when dealing with very large models that are too big to fit in a single GPU, and in some cases may also bring latency benefits <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib38" title="">38</a>]</cite>.
Note that in this setup, each pod has exclusive access to the GPUs assigned to it, and thus there are no effects related to co-location that need to be considered.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Performance Characterization Tool</span>
</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section we present the performance characterization tool, the structure of which is presented in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.F2" title="Figure 2 ‣ II-B LLM inference servers ‣ II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">2</span></a>.
There are two important aspects of performance characterization that we have considered when developing LLM-Pilot.
Firstly, we ensure that the LLM’s performance will be characterized under a <em class="ltx_emph ltx_font_italic" id="S3.p1.1.1">realistic</em> workload.
Therefore, we have acquired and analyzed a large collection of production traces of real inference requests to a variety of LLMs (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS1" title="III-A Analysis of production traces ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-A</span></span></a>).
Then, we have developed our own workload generator (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2" title="III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>) based on the production traces to ensure that the generated workload resembles the real usage of LLM inference services.
Secondly, the performance characterization tool ensures that the maximum batch weight is <em class="ltx_emph ltx_font_italic" id="S3.p1.1.2">optimized</em> for each GPU profile.
As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.F2" title="Figure 2 ‣ II-B LLM inference servers ‣ II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">2</span></a>, on each benchmarked GPU profile LLM-Pilot deploys the inference service, tunes the maximum batch weight, and subjects the service to a series of requests from the workload generator, collecting various performance metrics (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS3" title="III-C Performance data collection ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>).
Other considerations taken into account when developing the performance characterization tool of LLM-Pilot have been discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS4" title="III-D Other considerations ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T2.2.1.1" style="font-size:90%;">TABLE II</span>: </span><span class="ltx_text" id="S3.T2.3.2" style="font-size:90%;">Characteristics of the production traces used to develop the workload generator.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.1.1">Time period</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.4.1.1.2">5.5 months</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.4.2.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.4.2.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.2.1.1.1">Number of requests</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.4.2.1.2">17.3M</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.3.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.4.3.2.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.3.2.1.1">Number of users</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.4.3.2.2">approx. 2500</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.4.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.4.4.3.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.4.3.1.1">Number of LLMs</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.4.4.3.2">24 (with 3B–176B parameters)</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.5.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.4.5.4.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.5.4.1.1">Range of tokens</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.4.5.4.2">input: 1–4093, output: 1–1500</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.6.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.4.6.5.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.6.5.1.1">Batch sizes</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.4.6.5.2">1–5</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.7.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.4.7.6.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.7.6.1.1">Additional parameters</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.4.7.6.2">33 (e.g., decoding method, top k,</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.8.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S3.T2.4.8.7.1"><span class="ltx_text ltx_font_bold" id="S3.T2.4.8.7.1.1">describing the requests</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.4.8.7.2">top p, repetition penalty,</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.9.8">
<td class="ltx_td ltx_border_b ltx_border_l ltx_border_r" id="S3.T2.4.9.8.1"></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S3.T2.4.9.8.2">length penalty, temperature)</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="458" id="S3.F3.g1" src="extracted/5895755/trace_params_correlation.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Correlation between selected parameters of requests from the production traces.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">Analysis of production traces</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The production traces analyzed in this section come from an LLM inference platform used internally in our organization, which hosts a large number of LLMs deployed on an Openshift cluster running on A100 GPUs, which are made available for many users to send inference requests.
Internally, the platform uses Text Generation Inference Server (TGIS) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib14" title="">14</a>]</cite>.
The traces are a record of every inference request (i.e., every request to perform inference on a certain input text using a specific LLM and return the output) sent to the inference platform by every user within a certain period of time.
Each entry in the traces includes the user’s id, timestamp and all details of the request (including various TGIS-specific request parameters set by the user), as well as output from the LLM and end-to-end latency of processing the request.
As shown in the detailed characteristics in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.T2" title="TABLE II ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">II</span></a>, the traces were collected over a long period of time and include millions of diverse requests from thousands of users.
To the best of our knowledge, the traces used in this work are larger than any publicly available LLM trace collection published to date <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib20" title="">20</a>]</cite>.
Furthermore, the traces were in no way generated or collected synthetically and therefore represent a fully realistic and diverse usage of LLM inference services.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Impact on latency</h4>
<div class="ltx_para" id="S3.SS1.SSSx1.p1">
<p class="ltx_p" id="S3.SS1.SSSx1.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.T2" title="TABLE II ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">II</span></a>, each request in the traces is described by a large number of parameters.
We analyze the impact of these parameters on the latency through an importance study using a Random Forest (RF) regression model.
First, we trained a RF regressor on all available trace data to predict the latency of all individual requests using all parameters included in the traces.
The model achieved good accuracy, with the coefficient of determination <math alttext="R^{2}\approx 0.93" class="ltx_Math" display="inline" id="S3.SS1.SSSx1.p1.1.m1.1"><semantics id="S3.SS1.SSSx1.p1.1.m1.1a"><mrow id="S3.SS1.SSSx1.p1.1.m1.1.1" xref="S3.SS1.SSSx1.p1.1.m1.1.1.cmml"><msup id="S3.SS1.SSSx1.p1.1.m1.1.1.2" xref="S3.SS1.SSSx1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS1.SSSx1.p1.1.m1.1.1.2.2" xref="S3.SS1.SSSx1.p1.1.m1.1.1.2.2.cmml">R</mi><mn id="S3.SS1.SSSx1.p1.1.m1.1.1.2.3" xref="S3.SS1.SSSx1.p1.1.m1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS1.SSSx1.p1.1.m1.1.1.1" xref="S3.SS1.SSSx1.p1.1.m1.1.1.1.cmml">≈</mo><mn id="S3.SS1.SSSx1.p1.1.m1.1.1.3" xref="S3.SS1.SSSx1.p1.1.m1.1.1.3.cmml">0.93</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSSx1.p1.1.m1.1b"><apply id="S3.SS1.SSSx1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSSx1.p1.1.m1.1.1"><approx id="S3.SS1.SSSx1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSSx1.p1.1.m1.1.1.1"></approx><apply id="S3.SS1.SSSx1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSSx1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSSx1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSSx1.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSSx1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSSx1.p1.1.m1.1.1.2.2">𝑅</ci><cn id="S3.SS1.SSSx1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSSx1.p1.1.m1.1.1.2.3">2</cn></apply><cn id="S3.SS1.SSSx1.p1.1.m1.1.1.3.cmml" type="float" xref="S3.SS1.SSSx1.p1.1.m1.1.1.3">0.93</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSSx1.p1.1.m1.1c">R^{2}\approx 0.93</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSSx1.p1.1.m1.1d">italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ≈ 0.93</annotation></semantics></math>.
Then, we evaluated their impact on the RF’s predictions using the Mean Decrease in Impurity (MDI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib3" title="">3</a>]</cite>.
According to our study and our expectation, the parameter with the largest influence on the performance is the number of output tokens, followed by the number of input tokens, the batch size and parameters related to token sampling (decoding method, temperature, top p, top k).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Correlation</h4>
<div class="ltx_para" id="S3.SS1.SSSx2.p1">
<p class="ltx_p" id="S3.SS1.SSSx2.p1.1">Further, we have analyzed the correlation between the request parameters listed above using the Spearman’s rank correlation coefficient <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib41" title="">41</a>]</cite>.
The results presented in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.F3" title="Figure 3 ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">3</span></a> indicate that many pairs of parameters are strongly correlated.
Most notably, the parameters with the strongest influence on the performance – the batch size and the numbers of input and output tokens – are all strongly correlated with one another.
Therefore, in order for a workload generator to produce realistic workloads, it should preserve the correlation between the parameters characterizing each request.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">Workload generator</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Based on the conclusions drawn in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS1" title="III-A Analysis of production traces ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-A</span></span></a>, in each request the workload generator should specify the parameters which impact the latency, and it must consider the fact that in practice some parameters are strongly correlated.
These considerations are an important contribution of our work, as to the best of our knowledge, no prior works on workload generation include any request parameters beyond the batch size and the numbers of input and output tokens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib37" title="">37</a>]</cite>, and in some works the request parameters are treated as independent variables <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib12" title="">12</a>]</cite>.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS2.SSS1.5.1.1">III-B</span>1 </span>Modelling the requests</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">Internally, the workload generator uses a non-parametric model of requests, which jointly models the distributions of all request parameters.
For each parameter describing the requests, we divide the range of its values into a series of intervals called <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.1.1">bins</em>.
This allows us to reduce the cardinality of each parameter, as the true parameter values will be replaced with the centers of their respective bin intervals.
For each parameter, we define 64 bins (unless the cardinality of the parameter is lower, in which case we define as many bins as there are unique values).
We aim to define the bins such that they all contain an approximately equal number of requests.
Then, we proceed to create the joint, multi-dimensional model of requests.
Each multi-dimensional bin is defined by a distinct combination of bin assignments for values of all parameters.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS2.SSS2.5.1.1">III-B</span>2 </span>Sampling requests</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">Whenever the workload generator needs to produce an inference request, it can draw a random sample from the model of requests by selecting one of its multi-dimensional bins.
The probability of choosing each bin is defined by the histogram of the multi-dimensional bins, i.e. it is proportional to the number of requests from the traces that were assigned to it.
This way, the distribution of drawn samples will be very similar to the empirical distribution observed in the traces.
The final sample is a request with each parameter equal to the center of that parameter’s interval in the selected bin.
The input text for the request is generated based on some designated corpus of texts, truncated to match the number of input tokens indicated by the request’s parameters.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.5.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.6.2">Performance data collection</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">For each LLM and GPU profile to be benchmarked, LLM-Pilot performs a series of actions: (1) it deploys the inference service, (2) tunes the maximum batch weight parameter of the inference server to ensure maximum GPU utilization, and (3) runs a series of load testing experiments using the workload generator, collecting various performance metrics.
These steps will now be explained in detail.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS1.5.1.1">III-C</span>1 </span>Deployment</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">The tool creates a TGIS deployment on the cluster, using a single pod, and with the number and type of GPUs set according to the given GPU profile.
The amount of memory available to the pod is set to 250GB, and the number of CPU cores is set to be twice larger than the number of GPUs.
LLM-Pilot then waits until the pod is created and the LLM has been loaded into GPU memory, before proceeding to the next step.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS2.5.1.1">III-C</span>2 </span>Tuning the batch weight</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">Based on the conclusions drawn in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2" title="II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">II</span></a>, we must ensure that the maximum batch weight parameter is set as high as possible to achieve the best possible performance of the inference service.
As GPU profiles vary in terms of memory capacity, so does the highest possible maximum batch weight that can be achieved.
Thus, in order to be able to compare GPU profiles in a fair way, we must always ensure that the batch weight has been optimized individually for each one.
This is achieved in LLM-Pilot by running a binary search to optimize the maximum batch weight, as an initialization step before starting the inference server.
Namely, in each step of the search, we test a different maximum batch weight value and check if we encounter Out Of Memory (OOM) errors.
This is achieved by passing a sequence of batches to the model that are designed to test all possible corner cases, with respect to the batch size, number of input and output tokens, that can be constructed according to the given maximum batch weight.
If all corner cases succeed (i.e., none of them result in an OOM error), the batch weight is considered valid, and otherwise it is not.
Once binary search is completed, we take the optimized value for the maximum batch weight and start the inference server.
Once the server is ready to receive requests, we proceed to perform load testing.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS3.5.1.1">III-C</span>3 </span>Load testing</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.1">In each load testing experiment, LLM-Pilot simulates a different number of concurrent users simultaneously sending various requests generated by the workload generator (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2" title="III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>), for a duration of 2 minutes.
By default, subsequent experiments simulate 1, 2, 4, …, 128 concurrent users, increasing exponentially.
In each experiment, LLM-Pilot logs all generated tokens and the timestamps of their arrival to the client.
From the timestamps, the following performance metrics are extracted:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">time to first token (TTFT) – the median latency of receiving the first output token. It includes the time spent on queueing and the prompt processing phase.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">normalized TTFT (nTTFT) – the median of TTFT latencies of requests divided by their number of input tokens. We create this new metric as its value does not change as significantly as TTFT with the number of input tokens.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">inter-token latency (ITL) – the median latency between all subsequent output tokens, excluding the first one.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1">throughput – the total number of output tokens generated throughout the experiment, divided by its duration.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.1">Once these three steps have been performed for all LLMs and GPUs, all of the collected performance data are aggregated into a characterization dataset, which is discussed in detail in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS2" title="V-B Performance characterization ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-B</span></span></a>.
While there exist other tools for benchmarking the performance of LLM inference services (discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.SS2" title="VI-B Workload generators and benchmarking tools ‣ VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-B</span></span></a>), our work is the only one that benchmarks <em class="ltx_emph ltx_font_italic" id="S3.SS3.SSS3.p2.1.1">optimized</em> inference services by finding the appropriate value of maximum batch weight to maximize the inference performance.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="280" id="S3.F4.g1" src="extracted/5895755/importance_scores.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">The MDI importance scores of the number of CPU cores, amount of memory, maximum batch weight and number of concurrent users, determined by a RF predicting the TTFT and ITL latency for a selected LLM (bigcode/starcoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib21" title="">21</a>]</cite>).</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS4.5.1.1">III-D</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS4.6.2">Other considerations</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">While we have shown that tuning the maximum batch weight is critical to evaluate performance across different GPUs, a natural question is whether other aspects of the deployment specification also need to be tuned (e.g., the amount of memory and number of CPU cores).
Similarly to the study in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S2.F1" title="Figure 1 ‣ II-B LLM inference servers ‣ II Background ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a>, we have run an example LLM’s inference service on a single A100 40GB GPU with varying number of CPU cores, amount of memory and maximum batch weight, and measured the inference performance for different numbers of concurrent users as described in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS3" title="III-C Performance data collection ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>.
Then, we have trained a RF regressor to predict the TTFT and ITL latencies based on the varying parameters, and performed an importance analysis similarly to Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2" title="III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>.
The MDI importance scores of all parameters are presented in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.F4" title="Figure 4 ‣ III-C3 Load testing ‣ III-C Performance data collection ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">4</span></a>.
The number of CPU cores and memory achieved near-zero scores, over 300<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mo id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><times id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">×</annotation></semantics></math> lower than the MDI score of maximum batch weight.
This suggests that they do not have considerable impact on performance and motivates why LLM-Pilot sets them according to trivial rules.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">GPU Recommendation Tool</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we describe LLM-Pilot’s GPU recommendation tool, depicted schematically in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.F5" title="Figure 5 ‣ IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">5</span></a>.
In Sec <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS1" title="IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-A</span></span></a> we define the problem that the GPU recommendation tool aims to solve, and in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS2" title="IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a> we describe how LLM-Pilot solves it.
LLM-Pilot’s ability to recommend GPUs for unseen LLMs has been evaluated in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS3" title="V-C GPU recommendation ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-C</span></span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.5.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.6.2">Problem statement</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.20">The input to the GPU recommendation tool consists of: an LLM model <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_M</annotation></semantics></math> with unknown performance, a set of GPU profiles <math alttext="\mathbb{G}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝔾</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝔾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathbb{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">blackboard_G</annotation></semantics></math> that the user considers for deployment (each defined as the number and type of GPUs assigned to each pod), the latency constraints on nTTFT and ITL denoted as <math alttext="L_{1},L_{2}\in\mathbb{R}^{+}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.2"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml"><mrow id="S4.SS1.p1.3.m3.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.3.cmml"><msub id="S4.SS1.p1.3.m3.1.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.1.1.1.2" xref="S4.SS1.p1.3.m3.1.1.1.1.1.2.cmml">L</mi><mn id="S4.SS1.p1.3.m3.1.1.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.3.m3.2.2.2.2.3" xref="S4.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.3.m3.2.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.2.2.cmml">L</mi><mn id="S4.SS1.p1.3.m3.2.2.2.2.2.3" xref="S4.SS1.p1.3.m3.2.2.2.2.2.3.cmml">2</mn></msub></mrow><mo id="S4.SS1.p1.3.m3.2.2.3" xref="S4.SS1.p1.3.m3.2.2.3.cmml">∈</mo><msup id="S4.SS1.p1.3.m3.2.2.4" xref="S4.SS1.p1.3.m3.2.2.4.cmml"><mi id="S4.SS1.p1.3.m3.2.2.4.2" xref="S4.SS1.p1.3.m3.2.2.4.2.cmml">ℝ</mi><mo id="S4.SS1.p1.3.m3.2.2.4.3" xref="S4.SS1.p1.3.m3.2.2.4.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><apply id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2"><in id="S4.SS1.p1.3.m3.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.3"></in><list id="S4.SS1.p1.3.m3.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2"><apply id="S4.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.2">𝐿</ci><cn id="S4.SS1.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2.2">𝐿</ci><cn id="S4.SS1.p1.3.m3.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.2.2.2.2.2.3">2</cn></apply></list><apply id="S4.SS1.p1.3.m3.2.2.4.cmml" xref="S4.SS1.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.4.1.cmml" xref="S4.SS1.p1.3.m3.2.2.4">superscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.4.2.cmml" xref="S4.SS1.p1.3.m3.2.2.4.2">ℝ</ci><plus id="S4.SS1.p1.3.m3.2.2.4.3.cmml" xref="S4.SS1.p1.3.m3.2.2.4.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">L_{1},L_{2}\in\mathbb{R}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.2d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> respectively (and jointly denoted as <math alttext="L=\left(L_{1},L_{2}\right)" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.2"><semantics id="S4.SS1.p1.4.m4.2a"><mrow id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml"><mi id="S4.SS1.p1.4.m4.2.2.4" xref="S4.SS1.p1.4.m4.2.2.4.cmml">L</mi><mo id="S4.SS1.p1.4.m4.2.2.3" xref="S4.SS1.p1.4.m4.2.2.3.cmml">=</mo><mrow id="S4.SS1.p1.4.m4.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml"><mo id="S4.SS1.p1.4.m4.2.2.2.2.3" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p1.4.m4.1.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml">L</mi><mn id="S4.SS1.p1.4.m4.1.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.4.m4.2.2.2.2.4" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.4.m4.2.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.4.m4.2.2.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.2.2.2.cmml">L</mi><mn id="S4.SS1.p1.4.m4.2.2.2.2.2.3" xref="S4.SS1.p1.4.m4.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.4.m4.2.2.2.2.5" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><apply id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2"><eq id="S4.SS1.p1.4.m4.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.3"></eq><ci id="S4.SS1.p1.4.m4.2.2.4.cmml" xref="S4.SS1.p1.4.m4.2.2.4">𝐿</ci><interval closure="open" id="S4.SS1.p1.4.m4.2.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2"><apply id="S4.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.2">𝐿</ci><cn id="S4.SS1.p1.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.2.2">𝐿</ci><cn id="S4.SS1.p1.4.m4.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">L=\left(L_{1},L_{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.2d">italic_L = ( italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>), and the expected load on the service expressed as the total number of concurrent users <math alttext="U\in\mathbb{Z}^{+}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">U</mi><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">ℤ</mi><mo id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><in id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></in><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑈</ci><apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.3.2">ℤ</ci><plus id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">U\in\mathbb{Z}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_U ∈ blackboard_Z start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> that will be simultaneously sending requests to the service, following the same request distribution as modeled by the workload generator.
As we have argued in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S1" title="I Introduction ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">I</span></a>, an important assumption of the recommendation tool is to make no performance evaluations of the unseen LLM <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_M</annotation></semantics></math>.
Instead, LLM-Pilot uses the collection of historical performance data <math alttext="\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">𝔻</mi><mtext id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝔻</ci><ci id="S4.SS1.p1.7.m7.1.1.3a.cmml" xref="S4.SS1.p1.7.m7.1.1.3"><mtext id="S4.SS1.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p1.7.m7.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> collected using a set of training LLMs <math alttext="\mathbb{M}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><msub id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml"><mi id="S4.SS1.p1.8.m8.1.1.2" xref="S4.SS1.p1.8.m8.1.1.2.cmml">𝕄</mi><mtext id="S4.SS1.p1.8.m8.1.1.3" xref="S4.SS1.p1.8.m8.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><apply id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m8.1.1.2.cmml" xref="S4.SS1.p1.8.m8.1.1.2">𝕄</ci><ci id="S4.SS1.p1.8.m8.1.1.3a.cmml" xref="S4.SS1.p1.8.m8.1.1.3"><mtext id="S4.SS1.p1.8.m8.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p1.8.m8.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">\mathbb{M}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">blackboard_M start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> on GPU profiles <math alttext="\mathbb{G}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.1"><semantics id="S4.SS1.p1.9.m9.1a"><mi id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">𝔾</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><ci id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">𝔾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">\mathbb{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m9.1d">blackboard_G</annotation></semantics></math> to make predictions regarding nTTFT <math alttext="l_{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m10.1"><semantics id="S4.SS1.p1.10.m10.1a"><msub id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml"><mi id="S4.SS1.p1.10.m10.1.1.2" xref="S4.SS1.p1.10.m10.1.1.2.cmml">l</mi><mn id="S4.SS1.p1.10.m10.1.1.3" xref="S4.SS1.p1.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2">𝑙</ci><cn id="S4.SS1.p1.10.m10.1.1.3.cmml" type="integer" xref="S4.SS1.p1.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">l_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m10.1d">italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and ITL <math alttext="l_{2}" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m11.1"><semantics id="S4.SS1.p1.11.m11.1a"><msub id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><mi id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml">l</mi><mn id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2">𝑙</ci><cn id="S4.SS1.p1.11.m11.1.1.3.cmml" type="integer" xref="S4.SS1.p1.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">l_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m11.1d">italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> of the unseen LLM <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m12.1"><semantics id="S4.SS1.p1.12.m12.1a"><mi id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><ci id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m12.1d">italic_M</annotation></semantics></math>.
In all equations to follow, we omit the dependence on the total number of users <math alttext="U" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m13.1"><semantics id="S4.SS1.p1.13.m13.1a"><mi id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b"><ci id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">U</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.m13.1d">italic_U</annotation></semantics></math> and the latency constraints <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m14.1"><semantics id="S4.SS1.p1.14.m14.1a"><mi id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b"><ci id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.14.m14.1d">italic_L</annotation></semantics></math> for brevity.
The end goal of the GPU recommendation tool is to identify the most cost-effective GPU profile <math alttext="G^{\star}\in\mathbb{G}" class="ltx_Math" display="inline" id="S4.SS1.p1.15.m15.1"><semantics id="S4.SS1.p1.15.m15.1a"><mrow id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml"><msup id="S4.SS1.p1.15.m15.1.1.2" xref="S4.SS1.p1.15.m15.1.1.2.cmml"><mi id="S4.SS1.p1.15.m15.1.1.2.2" xref="S4.SS1.p1.15.m15.1.1.2.2.cmml">G</mi><mo id="S4.SS1.p1.15.m15.1.1.2.3" xref="S4.SS1.p1.15.m15.1.1.2.3.cmml">⋆</mo></msup><mo id="S4.SS1.p1.15.m15.1.1.1" xref="S4.SS1.p1.15.m15.1.1.1.cmml">∈</mo><mi id="S4.SS1.p1.15.m15.1.1.3" xref="S4.SS1.p1.15.m15.1.1.3.cmml">𝔾</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.1b"><apply id="S4.SS1.p1.15.m15.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1"><in id="S4.SS1.p1.15.m15.1.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1"></in><apply id="S4.SS1.p1.15.m15.1.1.2.cmml" xref="S4.SS1.p1.15.m15.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.1.1.2.1.cmml" xref="S4.SS1.p1.15.m15.1.1.2">superscript</csymbol><ci id="S4.SS1.p1.15.m15.1.1.2.2.cmml" xref="S4.SS1.p1.15.m15.1.1.2.2">𝐺</ci><ci id="S4.SS1.p1.15.m15.1.1.2.3.cmml" xref="S4.SS1.p1.15.m15.1.1.2.3">⋆</ci></apply><ci id="S4.SS1.p1.15.m15.1.1.3.cmml" xref="S4.SS1.p1.15.m15.1.1.3">𝔾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.1c">G^{\star}\in\mathbb{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.15.m15.1d">italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ∈ blackboard_G</annotation></semantics></math> and estimate the number <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p1.16.m16.1"><semantics id="S4.SS1.p1.16.m16.1a"><mi id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m16.1b"><ci id="S4.SS1.p1.16.m16.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m16.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.16.m16.1d">italic_n</annotation></semantics></math> of pods running on GPU profile <math alttext="G^{\star}" class="ltx_Math" display="inline" id="S4.SS1.p1.17.m17.1"><semantics id="S4.SS1.p1.17.m17.1a"><msup id="S4.SS1.p1.17.m17.1.1" xref="S4.SS1.p1.17.m17.1.1.cmml"><mi id="S4.SS1.p1.17.m17.1.1.2" xref="S4.SS1.p1.17.m17.1.1.2.cmml">G</mi><mo id="S4.SS1.p1.17.m17.1.1.3" xref="S4.SS1.p1.17.m17.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.17.m17.1b"><apply id="S4.SS1.p1.17.m17.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.17.m17.1.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1">superscript</csymbol><ci id="S4.SS1.p1.17.m17.1.1.2.cmml" xref="S4.SS1.p1.17.m17.1.1.2">𝐺</ci><ci id="S4.SS1.p1.17.m17.1.1.3.cmml" xref="S4.SS1.p1.17.m17.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.17.m17.1c">G^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.17.m17.1d">italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> that should be created in order for LLM <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p1.18.m18.1"><semantics id="S4.SS1.p1.18.m18.1a"><mi id="S4.SS1.p1.18.m18.1.1" xref="S4.SS1.p1.18.m18.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.18.m18.1b"><ci id="S4.SS1.p1.18.m18.1.1.cmml" xref="S4.SS1.p1.18.m18.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.18.m18.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.18.m18.1d">italic_M</annotation></semantics></math> to serve <math alttext="U" class="ltx_Math" display="inline" id="S4.SS1.p1.19.m19.1"><semantics id="S4.SS1.p1.19.m19.1a"><mi id="S4.SS1.p1.19.m19.1.1" xref="S4.SS1.p1.19.m19.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.19.m19.1b"><ci id="S4.SS1.p1.19.m19.1.1.cmml" xref="S4.SS1.p1.19.m19.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.19.m19.1c">U</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.19.m19.1d">italic_U</annotation></semantics></math> concurrent users under constraints <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p1.20.m20.1"><semantics id="S4.SS1.p1.20.m20.1a"><mi id="S4.SS1.p1.20.m20.1.1" xref="S4.SS1.p1.20.m20.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.20.m20.1b"><ci id="S4.SS1.p1.20.m20.1.1.cmml" xref="S4.SS1.p1.20.m20.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.20.m20.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.20.m20.1d">italic_L</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{find}\ \ G^{\star}\!\left(M\big{|}\mathbb{D}_{\text{train}}\right)=\text%
{arg}\min_{G\in\mathbb{G}}n\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)%
\cdot c\!\left(G\right)," class="ltx_Math" display="block" id="S4.E1.m1.4"><semantics id="S4.E1.m1.4a"><mrow id="S4.E1.m1.4.4.1" xref="S4.E1.m1.4.4.1.1.cmml"><mrow id="S4.E1.m1.4.4.1.1" xref="S4.E1.m1.4.4.1.1.cmml"><mrow id="S4.E1.m1.4.4.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.2.cmml"><mtext id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3a.cmml">find</mtext><mspace id="S4.E1.m1.4.4.1.1.1.1.2" width="1em" xref="S4.E1.m1.4.4.1.1.1.2.cmml"></mspace><mrow id="S4.E1.m1.4.4.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.cmml"><msup id="S4.E1.m1.4.4.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.1.3.2" xref="S4.E1.m1.4.4.1.1.1.1.1.3.2.cmml">G</mi><mo id="S4.E1.m1.4.4.1.1.1.1.1.3.3" xref="S4.E1.m1.4.4.1.1.1.1.1.3.3.cmml">⋆</mo></msup><mo id="S4.E1.m1.4.4.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.4.4.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">M</mi><mo fence="false" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1" mathsize="120%" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.4.4.1.1.3" xref="S4.E1.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E1.m1.4.4.1.1.2" xref="S4.E1.m1.4.4.1.1.2.cmml"><mrow id="S4.E1.m1.4.4.1.1.2.1" xref="S4.E1.m1.4.4.1.1.2.1.cmml"><mrow id="S4.E1.m1.4.4.1.1.2.1.1" xref="S4.E1.m1.4.4.1.1.2.1.1.cmml"><mtext id="S4.E1.m1.4.4.1.1.2.1.1.3" xref="S4.E1.m1.4.4.1.1.2.1.1.3a.cmml">arg</mtext><mo id="S4.E1.m1.4.4.1.1.2.1.1.2" lspace="0.167em" xref="S4.E1.m1.4.4.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.4.4.1.1.2.1.1.4" xref="S4.E1.m1.4.4.1.1.2.1.1.4.cmml"><munder id="S4.E1.m1.4.4.1.1.2.1.1.4.1" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.cmml"><mi id="S4.E1.m1.4.4.1.1.2.1.1.4.1.2" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.2.cmml">min</mi><mrow id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.cmml"><mi id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.2" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.2.cmml">G</mi><mo id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.1" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.1.cmml">∈</mo><mi id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.3" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.3.cmml">𝔾</mi></mrow></munder><mo id="S4.E1.m1.4.4.1.1.2.1.1.4a" lspace="0.167em" xref="S4.E1.m1.4.4.1.1.2.1.1.4.cmml">⁡</mo><mpadded width="0.430em"><mi id="S4.E1.m1.4.4.1.1.2.1.1.4.2" xref="S4.E1.m1.4.4.1.1.2.1.1.4.2.cmml">n</mi></mpadded></mrow><mo id="S4.E1.m1.4.4.1.1.2.1.1.2a" xref="S4.E1.m1.4.4.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.4.4.1.1.2.1.1.1.1" xref="S4.E1.m1.4.4.1.1.2.1.1.1.2.cmml"><mo id="S4.E1.m1.4.4.1.1.2.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.2.1.1.1.2.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">M</mi><mo id="S4.E1.m1.4.4.1.1.2.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.2.1.1.1.2.cmml">,</mo><mrow id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.cmml"><mi id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.2.cmml">G</mi><mo fence="false" id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.1" mathsize="120%" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.2" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.3" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.E1.m1.4.4.1.1.2.1.1.1.1.4" rspace="0.055em" xref="S4.E1.m1.4.4.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.4.4.1.1.2.1.2" rspace="0.222em" xref="S4.E1.m1.4.4.1.1.2.1.2.cmml">⋅</mo><mpadded width="0.263em"><mi id="S4.E1.m1.4.4.1.1.2.1.3" xref="S4.E1.m1.4.4.1.1.2.1.3.cmml">c</mi></mpadded></mrow><mo id="S4.E1.m1.4.4.1.1.2.2" xref="S4.E1.m1.4.4.1.1.2.2.cmml">⁢</mo><mrow id="S4.E1.m1.4.4.1.1.2.3.2" xref="S4.E1.m1.4.4.1.1.2.cmml"><mo id="S4.E1.m1.4.4.1.1.2.3.2.1" xref="S4.E1.m1.4.4.1.1.2.cmml">(</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">G</mi><mo id="S4.E1.m1.4.4.1.1.2.3.2.2" xref="S4.E1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.4.4.1.2" xref="S4.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.4b"><apply id="S4.E1.m1.4.4.1.1.cmml" xref="S4.E1.m1.4.4.1"><eq id="S4.E1.m1.4.4.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.3"></eq><list id="S4.E1.m1.4.4.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1"><ci id="S4.E1.m1.3.3a.cmml" xref="S4.E1.m1.3.3"><mtext id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">find</mtext></ci><apply id="S4.E1.m1.4.4.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1"><times id="S4.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.2"></times><apply id="S4.E1.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E1.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.3.2">𝐺</ci><ci id="S4.E1.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.3.3">⋆</ci></apply><apply id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2">𝑀</ci><apply id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.2">𝔻</ci><ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3"><mtext id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.3.3">train</mtext></ci></apply></apply></apply></list><apply id="S4.E1.m1.4.4.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.2"><times id="S4.E1.m1.4.4.1.1.2.2.cmml" xref="S4.E1.m1.4.4.1.1.2.2"></times><apply id="S4.E1.m1.4.4.1.1.2.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1"><ci id="S4.E1.m1.4.4.1.1.2.1.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.2">⋅</ci><apply id="S4.E1.m1.4.4.1.1.2.1.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1"><times id="S4.E1.m1.4.4.1.1.2.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.2"></times><ci id="S4.E1.m1.4.4.1.1.2.1.1.3a.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.3"><mtext id="S4.E1.m1.4.4.1.1.2.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.3">arg</mtext></ci><apply id="S4.E1.m1.4.4.1.1.2.1.1.4.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4"><apply id="S4.E1.m1.4.4.1.1.2.1.1.4.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.2.1.1.4.1.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1">subscript</csymbol><min id="S4.E1.m1.4.4.1.1.2.1.1.4.1.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.2"></min><apply id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3"><in id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.1"></in><ci id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.2">𝐺</ci><ci id="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.3.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.1.3.3">𝔾</ci></apply></apply><ci id="S4.E1.m1.4.4.1.1.2.1.1.4.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.4.2">𝑛</ci></apply><interval closure="open" id="S4.E1.m1.4.4.1.1.2.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝑀</ci><apply id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.2">𝐺</ci><apply id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.2">𝔻</ci><ci id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.3a.cmml" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.3"><mtext id="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E1.m1.4.4.1.1.2.1.1.1.1.1.3.3">train</mtext></ci></apply></apply></interval></apply><ci id="S4.E1.m1.4.4.1.1.2.1.3.cmml" xref="S4.E1.m1.4.4.1.1.2.1.3">𝑐</ci></apply><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.4c">\text{find}\ \ G^{\star}\!\left(M\big{|}\mathbb{D}_{\text{train}}\right)=\text%
{arg}\min_{G\in\mathbb{G}}n\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)%
\cdot c\!\left(G\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.4d">find italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ( italic_M | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) = arg roman_min start_POSTSUBSCRIPT italic_G ∈ blackboard_G end_POSTSUBSCRIPT italic_n ( italic_M , italic_G | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ⋅ italic_c ( italic_G ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.19">where</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="n\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)=\bigg{\lceil}\frac{U}{u_{%
\text{max}}\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)}\bigg{\rceil},\ %
\text{and}" class="ltx_Math" display="block" id="S4.E2.m1.6"><semantics id="S4.E2.m1.6a"><mrow id="S4.E2.m1.6.6" xref="S4.E2.m1.6.6.cmml"><mrow id="S4.E2.m1.5.5.1" xref="S4.E2.m1.5.5.1.cmml"><mpadded width="0.430em"><mi id="S4.E2.m1.5.5.1.3" xref="S4.E2.m1.5.5.1.3.cmml">n</mi></mpadded><mo id="S4.E2.m1.5.5.1.2" xref="S4.E2.m1.5.5.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.5.5.1.1.1" xref="S4.E2.m1.5.5.1.1.2.cmml"><mo id="S4.E2.m1.5.5.1.1.1.2" xref="S4.E2.m1.5.5.1.1.2.cmml">(</mo><mi id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml">M</mi><mo id="S4.E2.m1.5.5.1.1.1.3" xref="S4.E2.m1.5.5.1.1.2.cmml">,</mo><mrow id="S4.E2.m1.5.5.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.2.cmml">G</mi><mo fence="false" id="S4.E2.m1.5.5.1.1.1.1.1" mathsize="120%" xref="S4.E2.m1.5.5.1.1.1.1.1.cmml">|</mo><msub id="S4.E2.m1.5.5.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.3.2" xref="S4.E2.m1.5.5.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.E2.m1.5.5.1.1.1.1.3.3" xref="S4.E2.m1.5.5.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.E2.m1.5.5.1.1.1.4" xref="S4.E2.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.6.6.3" xref="S4.E2.m1.6.6.3.cmml">=</mo><mrow id="S4.E2.m1.6.6.2.1" xref="S4.E2.m1.6.6.2.2.cmml"><mrow id="S4.E2.m1.6.6.2.1.1.2" xref="S4.E2.m1.6.6.2.1.1.1.cmml"><mo id="S4.E2.m1.6.6.2.1.1.2.1" maxsize="210%" minsize="210%" xref="S4.E2.m1.6.6.2.1.1.1.1.cmml">⌈</mo><mfrac id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><mi id="S4.E2.m1.2.2.4" xref="S4.E2.m1.2.2.4.cmml">U</mi><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><msub id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.4.cmml"><mi id="S4.E2.m1.2.2.2.4.2" xref="S4.E2.m1.2.2.2.4.2.cmml">u</mi><mtext id="S4.E2.m1.2.2.2.4.3" xref="S4.E2.m1.2.2.2.4.3a.cmml">max</mtext></msub><mo id="S4.E2.m1.2.2.2.3" xref="S4.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E2.m1.2.2.2.2.1" xref="S4.E2.m1.2.2.2.2.2.cmml"><mo id="S4.E2.m1.2.2.2.2.1.2" xref="S4.E2.m1.2.2.2.2.2.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">M</mi><mo id="S4.E2.m1.2.2.2.2.1.3" xref="S4.E2.m1.2.2.2.2.2.cmml">,</mo><mrow id="S4.E2.m1.2.2.2.2.1.1" xref="S4.E2.m1.2.2.2.2.1.1.cmml"><mi id="S4.E2.m1.2.2.2.2.1.1.2" xref="S4.E2.m1.2.2.2.2.1.1.2.cmml">G</mi><mo fence="false" id="S4.E2.m1.2.2.2.2.1.1.1" mathsize="120%" xref="S4.E2.m1.2.2.2.2.1.1.1.cmml">|</mo><msub id="S4.E2.m1.2.2.2.2.1.1.3" xref="S4.E2.m1.2.2.2.2.1.1.3.cmml"><mi id="S4.E2.m1.2.2.2.2.1.1.3.2" xref="S4.E2.m1.2.2.2.2.1.1.3.2.cmml">𝔻</mi><mtext id="S4.E2.m1.2.2.2.2.1.1.3.3" xref="S4.E2.m1.2.2.2.2.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.E2.m1.2.2.2.2.1.4" xref="S4.E2.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E2.m1.6.6.2.1.1.2.2" maxsize="210%" minsize="210%" xref="S4.E2.m1.6.6.2.1.1.1.1.cmml">⌉</mo></mrow><mo id="S4.E2.m1.6.6.2.1.2" rspace="0.667em" xref="S4.E2.m1.6.6.2.2.cmml">,</mo><mtext id="S4.E2.m1.4.4" xref="S4.E2.m1.4.4a.cmml">and</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.6b"><apply id="S4.E2.m1.6.6.cmml" xref="S4.E2.m1.6.6"><eq id="S4.E2.m1.6.6.3.cmml" xref="S4.E2.m1.6.6.3"></eq><apply id="S4.E2.m1.5.5.1.cmml" xref="S4.E2.m1.5.5.1"><times id="S4.E2.m1.5.5.1.2.cmml" xref="S4.E2.m1.5.5.1.2"></times><ci id="S4.E2.m1.5.5.1.3.cmml" xref="S4.E2.m1.5.5.1.3">𝑛</ci><interval closure="open" id="S4.E2.m1.5.5.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1"><ci id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3">𝑀</ci><apply id="S4.E2.m1.5.5.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.5.5.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2">𝐺</ci><apply id="S4.E2.m1.5.5.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.3.2">𝔻</ci><ci id="S4.E2.m1.5.5.1.1.1.1.3.3a.cmml" xref="S4.E2.m1.5.5.1.1.1.1.3.3"><mtext id="S4.E2.m1.5.5.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E2.m1.5.5.1.1.1.1.3.3">train</mtext></ci></apply></apply></interval></apply><list id="S4.E2.m1.6.6.2.2.cmml" xref="S4.E2.m1.6.6.2.1"><apply id="S4.E2.m1.6.6.2.1.1.1.cmml" xref="S4.E2.m1.6.6.2.1.1.2"><ceiling id="S4.E2.m1.6.6.2.1.1.1.1.cmml" xref="S4.E2.m1.6.6.2.1.1.2.1"></ceiling><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2"><divide id="S4.E2.m1.2.2.3.cmml" xref="S4.E2.m1.2.2"></divide><ci id="S4.E2.m1.2.2.4.cmml" xref="S4.E2.m1.2.2.4">𝑈</ci><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><times id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3"></times><apply id="S4.E2.m1.2.2.2.4.cmml" xref="S4.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.4.1.cmml" xref="S4.E2.m1.2.2.2.4">subscript</csymbol><ci id="S4.E2.m1.2.2.2.4.2.cmml" xref="S4.E2.m1.2.2.2.4.2">𝑢</ci><ci id="S4.E2.m1.2.2.2.4.3a.cmml" xref="S4.E2.m1.2.2.2.4.3"><mtext id="S4.E2.m1.2.2.2.4.3.cmml" mathsize="70%" xref="S4.E2.m1.2.2.2.4.3">max</mtext></ci></apply><interval closure="open" id="S4.E2.m1.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2.1"><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑀</ci><apply id="S4.E2.m1.2.2.2.2.1.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.E2.m1.2.2.2.2.1.1.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="S4.E2.m1.2.2.2.2.1.1.2.cmml" xref="S4.E2.m1.2.2.2.2.1.1.2">𝐺</ci><apply id="S4.E2.m1.2.2.2.2.1.1.3.cmml" xref="S4.E2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E2.m1.2.2.2.2.1.1.3.2">𝔻</ci><ci id="S4.E2.m1.2.2.2.2.1.1.3.3a.cmml" xref="S4.E2.m1.2.2.2.2.1.1.3.3"><mtext id="S4.E2.m1.2.2.2.2.1.1.3.3.cmml" mathsize="70%" xref="S4.E2.m1.2.2.2.2.1.1.3.3">train</mtext></ci></apply></apply></interval></apply></apply></apply><ci id="S4.E2.m1.4.4a.cmml" xref="S4.E2.m1.4.4"><mtext id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4">and</mtext></ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.6c">n\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)=\bigg{\lceil}\frac{U}{u_{%
\text{max}}\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)}\bigg{\rceil},\ %
\text{and}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.6d">italic_n ( italic_M , italic_G | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) = ⌈ divide start_ARG italic_U end_ARG start_ARG italic_u start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( italic_M , italic_G | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) end_ARG ⌉ , and</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{array}[]{l}u_{\text{max}}\!\left(M,\!G\big{|}\mathbb{D}_{\text{train}}%
\right)=\\
=\max\Big{\{}\!u\in\mathbb{U}\!:\!\!\begin{array}[]{l}l_{1}\!\left(M,\!G,\!u^{%
\prime}\big{|}\mathbb{D}_{\text{train}}\right)\!\leq\!L_{1}\\
l_{2}\!\left(M,\!G,\!u^{\prime}\big{|}\mathbb{D}_{\text{train}}\right)\!\leq\!%
L_{2}\end{array}\!\forall_{u^{\prime}\in\mathbb{U}:\ u^{\prime}\leq u}\!\Big{%
\}}.\end{array}" class="ltx_Math" display="block" id="S4.E3.m1.10"><semantics id="S4.E3.m1.10a"><mtable displaystyle="true" id="S4.E3.m1.10.10" rowspacing="0pt" xref="S4.E3.m1.10.10.cmml"><mtr id="S4.E3.m1.10.10a" xref="S4.E3.m1.10.10.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.10.10b" xref="S4.E3.m1.10.10.cmml"><mrow id="S4.E3.m1.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.cmml"><mrow id="S4.E3.m1.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.cmml"><msub id="S4.E3.m1.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.3.2" xref="S4.E3.m1.2.2.2.2.2.2.3.2.cmml">u</mi><mtext id="S4.E3.m1.2.2.2.2.2.2.3.3" xref="S4.E3.m1.2.2.2.2.2.2.3.3a.cmml">max</mtext></msub><mo id="S4.E3.m1.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.1.1" xref="S4.E3.m1.2.2.2.2.2.2.1.2.cmml"><mo id="S4.E3.m1.2.2.2.2.2.2.1.1.2" xref="S4.E3.m1.2.2.2.2.2.2.1.2.cmml">(</mo><mi id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml">M</mi><mpadded width="0.275em"><mo id="S4.E3.m1.2.2.2.2.2.2.1.1.3" xref="S4.E3.m1.2.2.2.2.2.2.1.2.cmml">,</mo></mpadded><mrow id="S4.E3.m1.2.2.2.2.2.2.1.1.1" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.1.1.1.2" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.2.cmml">G</mi><mo fence="false" id="S4.E3.m1.2.2.2.2.2.2.1.1.1.1" mathsize="120%" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.1.cmml">|</mo><msub id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.3" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.E3.m1.2.2.2.2.2.2.1.1.4" xref="S4.E3.m1.2.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.3.cmml">=</mo><mi id="S4.E3.m1.2.2.2.2.2.4" xref="S4.E3.m1.2.2.2.2.2.4.cmml"></mi></mrow></mtd></mtr><mtr id="S4.E3.m1.10.10c" xref="S4.E3.m1.10.10.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.10.10d" xref="S4.E3.m1.10.10.cmml"><mrow id="S4.E3.m1.10.10.10.8.8.8" xref="S4.E3.m1.10.10.10.8.8.8.1.cmml"><mrow id="S4.E3.m1.10.10.10.8.8.8.1" xref="S4.E3.m1.10.10.10.8.8.8.1.cmml"><mi id="S4.E3.m1.10.10.10.8.8.8.1.3" xref="S4.E3.m1.10.10.10.8.8.8.1.3.cmml"></mi><mo id="S4.E3.m1.10.10.10.8.8.8.1.2" xref="S4.E3.m1.10.10.10.8.8.8.1.2.cmml">=</mo><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1" xref="S4.E3.m1.10.10.10.8.8.8.1.1.2.cmml"><mi id="S4.E3.m1.9.9.9.7.7.7" xref="S4.E3.m1.9.9.9.7.7.7.cmml">max</mi><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1a" xref="S4.E3.m1.10.10.10.8.8.8.1.1.2.cmml">⁡</mo><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1" xref="S4.E3.m1.10.10.10.8.8.8.1.1.2.cmml"><mpadded width="0.330em"><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S4.E3.m1.10.10.10.8.8.8.1.1.2.cmml">{</mo></mpadded><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.2.cmml">u</mi><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.1" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.1.cmml">∈</mo><mi id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.3.cmml">𝕌</mi></mrow><mpadded width="0.226em"><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.1" lspace="0.108em" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.1.cmml">:</mo></mpadded><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.cmml"><mtable displaystyle="true" id="S4.E3.m1.8.8.8.6.6.6" rowspacing="0pt" xref="S4.E3.m1.8.8.8.6.6.6.cmml"><mtr id="S4.E3.m1.8.8.8.6.6.6a" xref="S4.E3.m1.8.8.8.6.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.8.8.8.6.6.6b" xref="S4.E3.m1.8.8.8.6.6.6.cmml"><mrow id="S4.E3.m1.5.5.5.3.3.3.3.3.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.cmml"><mrow id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.cmml"><msub id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.cmml"><mi id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.2" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.2.cmml">l</mi><mn id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.3.cmml">1</mn></msub><mo id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.2" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.2.cmml">⁢</mo><mrow id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.2.cmml"><mo id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.2" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.2.cmml">(</mo><mi id="S4.E3.m1.3.3.3.1.1.1.1.1.1.1" xref="S4.E3.m1.3.3.3.1.1.1.1.1.1.1.cmml">M</mi><mpadded width="0.275em"><mo id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.2.cmml">,</mo></mpadded><mi id="S4.E3.m1.4.4.4.2.2.2.2.2.2.2" xref="S4.E3.m1.4.4.4.2.2.2.2.2.2.2.cmml">G</mi><mpadded width="0.275em"><mo id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.4" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.2.cmml">,</mo></mpadded><mrow id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.cmml"><msup id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.cmml"><mi id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.2" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.2.cmml">u</mi><mo id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.1" mathsize="120%" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.1.cmml">|</mo><msub id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.cmml"><mi id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.2" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.5" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.5.5.5.3.3.3.3.3.3.4" lspace="0.108em" rspace="0.108em" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.4.cmml">≤</mo><msub id="S4.E3.m1.5.5.5.3.3.3.3.3.3.5" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.cmml"><mi id="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.2" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.2.cmml">L</mi><mn id="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.3" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.3.cmml">1</mn></msub></mrow></mtd></mtr><mtr id="S4.E3.m1.8.8.8.6.6.6c" xref="S4.E3.m1.8.8.8.6.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.8.8.8.6.6.6d" xref="S4.E3.m1.8.8.8.6.6.6.cmml"><mrow id="S4.E3.m1.8.8.8.6.6.6.6.3.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.cmml"><mrow id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.cmml"><msub id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.cmml"><mi id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.2" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.2.cmml">l</mi><mn id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.3.cmml">2</mn></msub><mo id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.2" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.2.cmml">⁢</mo><mrow id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.2.cmml"><mo id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.2" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.2.cmml">(</mo><mi id="S4.E3.m1.6.6.6.4.4.4.4.1.1.1" xref="S4.E3.m1.6.6.6.4.4.4.4.1.1.1.cmml">M</mi><mpadded width="0.275em"><mo id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.2.cmml">,</mo></mpadded><mi id="S4.E3.m1.7.7.7.5.5.5.5.2.2.2" xref="S4.E3.m1.7.7.7.5.5.5.5.2.2.2.cmml">G</mi><mpadded width="0.275em"><mo id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.4" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.2.cmml">,</mo></mpadded><mrow id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.cmml"><msup id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.cmml"><mi id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.2" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.2.cmml">u</mi><mo id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.1" mathsize="120%" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.1.cmml">|</mo><msub id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.cmml"><mi id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.2" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.5" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.8.8.8.6.6.6.6.3.3.4" lspace="0.108em" rspace="0.108em" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.4.cmml">≤</mo><msub id="S4.E3.m1.8.8.8.6.6.6.6.3.3.5" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.cmml"><mi id="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.2" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.2.cmml">L</mi><mn id="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.3" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.3.cmml">2</mn></msub></mrow></mtd></mtr></mtable><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.1" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.cmml"><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.2.cmml">∀</mo><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.cmml"><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.cmml"><msup id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.cmml"><mi id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.2.cmml">u</mi><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.3.cmml">′</mo></msup><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.1" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.1.cmml">∈</mo><mi id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.3.cmml">𝕌</mi></mrow><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.1" lspace="0.278em" rspace="0.628em" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.1.cmml">:</mo><mrow id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.cmml"><msup id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.cmml"><mi id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.2" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.2.cmml">u</mi><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.3.cmml">′</mo></msup><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.1" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.1.cmml">≤</mo><mi id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.3" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.3.cmml">u</mi></mrow></mrow></msub></mrow></mrow><mo id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S4.E3.m1.10.10.10.8.8.8.1.1.2.cmml">}</mo></mrow></mrow></mrow><mo id="S4.E3.m1.10.10.10.8.8.8.2" lspace="0em" xref="S4.E3.m1.10.10.10.8.8.8.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E3.m1.10b"><matrix id="S4.E3.m1.10.10.cmml" xref="S4.E3.m1.10.10"><matrixrow id="S4.E3.m1.10.10a.cmml" xref="S4.E3.m1.10.10"><apply id="S4.E3.m1.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2"><eq id="S4.E3.m1.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.3"></eq><apply id="S4.E3.m1.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2"><times id="S4.E3.m1.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2"></times><apply id="S4.E3.m1.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3.2">𝑢</ci><ci id="S4.E3.m1.2.2.2.2.2.2.3.3a.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3.3"><mtext id="S4.E3.m1.2.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S4.E3.m1.2.2.2.2.2.2.3.3">max</mtext></ci></apply><interval closure="open" id="S4.E3.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1"><ci id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1">𝑀</ci><apply id="S4.E3.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.2">𝐺</ci><apply id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.2">𝔻</ci><ci id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.3a.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.3"><mtext id="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E3.m1.2.2.2.2.2.2.1.1.1.3.3">train</mtext></ci></apply></apply></interval></apply><csymbol cd="latexml" id="S4.E3.m1.2.2.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.2.2.4">absent</csymbol></apply></matrixrow><matrixrow id="S4.E3.m1.10.10b.cmml" xref="S4.E3.m1.10.10"><apply id="S4.E3.m1.10.10.10.8.8.8.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8"><eq id="S4.E3.m1.10.10.10.8.8.8.1.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.2"></eq><csymbol cd="latexml" id="S4.E3.m1.10.10.10.8.8.8.1.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.3">absent</csymbol><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1"><max id="S4.E3.m1.9.9.9.7.7.7.cmml" xref="S4.E3.m1.9.9.9.7.7.7"></max><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1"><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.1">:</ci><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2"><in id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.1"></in><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.2">𝑢</ci><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.2.3">𝕌</ci></apply><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3"><times id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.1"></times><matrix id="S4.E3.m1.8.8.8.6.6.6.cmml" xref="S4.E3.m1.8.8.8.6.6.6"><matrixrow id="S4.E3.m1.8.8.8.6.6.6a.cmml" xref="S4.E3.m1.8.8.8.6.6.6"><apply id="S4.E3.m1.5.5.5.3.3.3.3.3.3.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3"><leq id="S4.E3.m1.5.5.5.3.3.3.3.3.3.4.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.4"></leq><apply id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3"><times id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.2.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.2"></times><apply id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.1.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.2.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.2">𝑙</ci><cn id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.3.cmml" type="integer" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.3.3">1</cn></apply><vector id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.2.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1"><ci id="S4.E3.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1.1.1.1">𝑀</ci><ci id="S4.E3.m1.4.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.4.4.4.2.2.2.2.2.2.2">𝐺</ci><apply id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.1.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.1">conditional</csymbol><apply id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.1.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2">superscript</csymbol><ci id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.2.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.2">𝑢</ci><ci id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.3.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.2.3">′</ci></apply><apply id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.1.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.2.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.2">𝔻</ci><ci id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.3a.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.3"><mtext id="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.3.1.1.1.3.3">train</mtext></ci></apply></apply></vector></apply><apply id="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.1.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.2.cmml" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.2">𝐿</ci><cn id="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.3.cmml" type="integer" xref="S4.E3.m1.5.5.5.3.3.3.3.3.3.5.3">1</cn></apply></apply></matrixrow><matrixrow id="S4.E3.m1.8.8.8.6.6.6b.cmml" xref="S4.E3.m1.8.8.8.6.6.6"><apply id="S4.E3.m1.8.8.8.6.6.6.6.3.3.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3"><leq id="S4.E3.m1.8.8.8.6.6.6.6.3.3.4.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.4"></leq><apply id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3"><times id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.2.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.2"></times><apply id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.1.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3">subscript</csymbol><ci id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.2.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.2">𝑙</ci><cn id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.3.cmml" type="integer" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.3.3">2</cn></apply><vector id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.2.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1"><ci id="S4.E3.m1.6.6.6.4.4.4.4.1.1.1.cmml" xref="S4.E3.m1.6.6.6.4.4.4.4.1.1.1">𝑀</ci><ci id="S4.E3.m1.7.7.7.5.5.5.5.2.2.2.cmml" xref="S4.E3.m1.7.7.7.5.5.5.5.2.2.2">𝐺</ci><apply id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.1.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.1">conditional</csymbol><apply id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.1.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2">superscript</csymbol><ci id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.2.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.2">𝑢</ci><ci id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.3.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.2.3">′</ci></apply><apply id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.1.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.2.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.2">𝔻</ci><ci id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.3a.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.3"><mtext id="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.3.1.1.1.3.3">train</mtext></ci></apply></apply></vector></apply><apply id="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.5"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.1.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.5">subscript</csymbol><ci id="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.2.cmml" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.2">𝐿</ci><cn id="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.3.cmml" type="integer" xref="S4.E3.m1.8.8.8.6.6.6.6.3.3.5.3">2</cn></apply></apply></matrixrow></matrix><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2">subscript</csymbol><csymbol cd="latexml" id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.2">for-all</csymbol><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3"><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.1">:</ci><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2"><in id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.1"></in><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2">superscript</csymbol><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.2">𝑢</ci><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.2.3">′</ci></apply><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.2.3">𝕌</ci></apply><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3"><leq id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.1"></leq><apply id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.1.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2">superscript</csymbol><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.2.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.2">𝑢</ci><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.2.3">′</ci></apply><ci id="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.3.cmml" xref="S4.E3.m1.10.10.10.8.8.8.1.1.1.1.1.3.2.3.3.3">𝑢</ci></apply></apply></apply></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.10c">\begin{array}[]{l}u_{\text{max}}\!\left(M,\!G\big{|}\mathbb{D}_{\text{train}}%
\right)=\\
=\max\Big{\{}\!u\in\mathbb{U}\!:\!\!\begin{array}[]{l}l_{1}\!\left(M,\!G,\!u^{%
\prime}\big{|}\mathbb{D}_{\text{train}}\right)\!\leq\!L_{1}\\
l_{2}\!\left(M,\!G,\!u^{\prime}\big{|}\mathbb{D}_{\text{train}}\right)\!\leq\!%
L_{2}\end{array}\!\forall_{u^{\prime}\in\mathbb{U}:\ u^{\prime}\leq u}\!\Big{%
\}}.\end{array}</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.10d">start_ARRAY start_ROW start_CELL italic_u start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( italic_M , italic_G | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) = end_CELL end_ROW start_ROW start_CELL = roman_max { italic_u ∈ blackboard_U : start_ARRAY start_ROW start_CELL italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ≤ italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ≤ italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL end_ROW end_ARRAY ∀ start_POSTSUBSCRIPT italic_u start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_U : italic_u start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ≤ italic_u end_POSTSUBSCRIPT } . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.18">Value <math alttext="c\!\left(G\right)\in\mathbb{R}^{+}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.2" xref="S4.SS1.p2.1.m1.1.2.cmml"><mrow id="S4.SS1.p2.1.m1.1.2.2" xref="S4.SS1.p2.1.m1.1.2.2.cmml"><mpadded width="0.263em"><mi id="S4.SS1.p2.1.m1.1.2.2.2" xref="S4.SS1.p2.1.m1.1.2.2.2.cmml">c</mi></mpadded><mo id="S4.SS1.p2.1.m1.1.2.2.1" xref="S4.SS1.p2.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS1.p2.1.m1.1.2.2.3.2" xref="S4.SS1.p2.1.m1.1.2.2.cmml"><mo id="S4.SS1.p2.1.m1.1.2.2.3.2.1" xref="S4.SS1.p2.1.m1.1.2.2.cmml">(</mo><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">G</mi><mo id="S4.SS1.p2.1.m1.1.2.2.3.2.2" xref="S4.SS1.p2.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.1.m1.1.2.1" xref="S4.SS1.p2.1.m1.1.2.1.cmml">∈</mo><msup id="S4.SS1.p2.1.m1.1.2.3" xref="S4.SS1.p2.1.m1.1.2.3.cmml"><mi id="S4.SS1.p2.1.m1.1.2.3.2" xref="S4.SS1.p2.1.m1.1.2.3.2.cmml">ℝ</mi><mo id="S4.SS1.p2.1.m1.1.2.3.3" xref="S4.SS1.p2.1.m1.1.2.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.2"><in id="S4.SS1.p2.1.m1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.2.1"></in><apply id="S4.SS1.p2.1.m1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.2.2"><times id="S4.SS1.p2.1.m1.1.2.2.1.cmml" xref="S4.SS1.p2.1.m1.1.2.2.1"></times><ci id="S4.SS1.p2.1.m1.1.2.2.2.cmml" xref="S4.SS1.p2.1.m1.1.2.2.2">𝑐</ci><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝐺</ci></apply><apply id="S4.SS1.p2.1.m1.1.2.3.cmml" xref="S4.SS1.p2.1.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.1.2.3">superscript</csymbol><ci id="S4.SS1.p2.1.m1.1.2.3.2.cmml" xref="S4.SS1.p2.1.m1.1.2.3.2">ℝ</ci><plus id="S4.SS1.p2.1.m1.1.2.3.3.cmml" xref="S4.SS1.p2.1.m1.1.2.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">c\!\left(G\right)\in\mathbb{R}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_c ( italic_G ) ∈ blackboard_R start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the cost of a single pod running on the GPU profile <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_G</annotation></semantics></math>, read from the GPU pricing tables.
Value <math alttext="n\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)\!\!\in\!\!\mathbb{Z}^{+}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.2"><semantics id="S4.SS1.p2.3.m3.2a"><mrow id="S4.SS1.p2.3.m3.2.2" xref="S4.SS1.p2.3.m3.2.2.cmml"><mrow id="S4.SS1.p2.3.m3.2.2.1" xref="S4.SS1.p2.3.m3.2.2.1.cmml"><mpadded width="0.430em"><mi id="S4.SS1.p2.3.m3.2.2.1.3" xref="S4.SS1.p2.3.m3.2.2.1.3.cmml">n</mi></mpadded><mo id="S4.SS1.p2.3.m3.2.2.1.2" xref="S4.SS1.p2.3.m3.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS1.p2.3.m3.2.2.1.1.1" xref="S4.SS1.p2.3.m3.2.2.1.1.2.cmml"><mo id="S4.SS1.p2.3.m3.2.2.1.1.1.2" xref="S4.SS1.p2.3.m3.2.2.1.1.2.cmml">(</mo><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">M</mi><mo id="S4.SS1.p2.3.m3.2.2.1.1.1.3" xref="S4.SS1.p2.3.m3.2.2.1.1.2.cmml">,</mo><mrow id="S4.SS1.p2.3.m3.2.2.1.1.1.1" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p2.3.m3.2.2.1.1.1.1.2" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.2.cmml">G</mi><mo fence="false" id="S4.SS1.p2.3.m3.2.2.1.1.1.1.1" mathsize="120%" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.1.cmml">|</mo><msub id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.cmml"><mi id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.2" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.3" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mpadded width="0.406em"><mo id="S4.SS1.p2.3.m3.2.2.1.1.1.4" xref="S4.SS1.p2.3.m3.2.2.1.1.2.cmml">)</mo></mpadded></mrow></mrow><mpadded width="0.615em"><mo id="S4.SS1.p2.3.m3.2.2.2" xref="S4.SS1.p2.3.m3.2.2.2.cmml">∈</mo></mpadded><msup id="S4.SS1.p2.3.m3.2.2.3" xref="S4.SS1.p2.3.m3.2.2.3.cmml"><mi id="S4.SS1.p2.3.m3.2.2.3.2" xref="S4.SS1.p2.3.m3.2.2.3.2.cmml">ℤ</mi><mo id="S4.SS1.p2.3.m3.2.2.3.3" xref="S4.SS1.p2.3.m3.2.2.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.2b"><apply id="S4.SS1.p2.3.m3.2.2.cmml" xref="S4.SS1.p2.3.m3.2.2"><in id="S4.SS1.p2.3.m3.2.2.2.cmml" xref="S4.SS1.p2.3.m3.2.2.2"></in><apply id="S4.SS1.p2.3.m3.2.2.1.cmml" xref="S4.SS1.p2.3.m3.2.2.1"><times id="S4.SS1.p2.3.m3.2.2.1.2.cmml" xref="S4.SS1.p2.3.m3.2.2.1.2"></times><ci id="S4.SS1.p2.3.m3.2.2.1.3.cmml" xref="S4.SS1.p2.3.m3.2.2.1.3">𝑛</ci><interval closure="open" id="S4.SS1.p2.3.m3.2.2.1.1.2.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑀</ci><apply id="S4.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.2">𝐺</ci><apply id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.2">𝔻</ci><ci id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.3a.cmml" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.3"><mtext id="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS1.p2.3.m3.2.2.1.1.1.1.3.3">train</mtext></ci></apply></apply></interval></apply><apply id="S4.SS1.p2.3.m3.2.2.3.cmml" xref="S4.SS1.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.2.2.3.1.cmml" xref="S4.SS1.p2.3.m3.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.3.m3.2.2.3.2.cmml" xref="S4.SS1.p2.3.m3.2.2.3.2">ℤ</ci><plus id="S4.SS1.p2.3.m3.2.2.3.3.cmml" xref="S4.SS1.p2.3.m3.2.2.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.2c">n\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)\!\!\in\!\!\mathbb{Z}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.2d">italic_n ( italic_M , italic_G | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ∈ blackboard_Z start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the number of pods with GPU profile <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">italic_G</annotation></semantics></math> needed to serve <math alttext="U" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">U</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">italic_U</annotation></semantics></math> users under constraint <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mi id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><ci id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">italic_L</annotation></semantics></math>, predicted based on <math alttext="\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.1"><semantics id="S4.SS1.p2.7.m7.1a"><msub id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.p2.7.m7.1.1.2" xref="S4.SS1.p2.7.m7.1.1.2.cmml">𝔻</mi><mtext id="S4.SS1.p2.7.m7.1.1.3" xref="S4.SS1.p2.7.m7.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><apply id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.p2.7.m7.1.1.2">𝔻</ci><ci id="S4.SS1.p2.7.m7.1.1.3a.cmml" xref="S4.SS1.p2.7.m7.1.1.3"><mtext id="S4.SS1.p2.7.m7.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p2.7.m7.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.1d">blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>.
<math alttext="\mathbb{U}\!\subset\!\mathbb{Z}^{+}" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m8.1"><semantics id="S4.SS1.p2.8.m8.1a"><mrow id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml"><mi id="S4.SS1.p2.8.m8.1.1.2" xref="S4.SS1.p2.8.m8.1.1.2.cmml">𝕌</mi><mo id="S4.SS1.p2.8.m8.1.1.1" lspace="0.108em" rspace="0.108em" xref="S4.SS1.p2.8.m8.1.1.1.cmml">⊂</mo><msup id="S4.SS1.p2.8.m8.1.1.3" xref="S4.SS1.p2.8.m8.1.1.3.cmml"><mi id="S4.SS1.p2.8.m8.1.1.3.2" xref="S4.SS1.p2.8.m8.1.1.3.2.cmml">ℤ</mi><mo id="S4.SS1.p2.8.m8.1.1.3.3" xref="S4.SS1.p2.8.m8.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b"><apply id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1"><subset id="S4.SS1.p2.8.m8.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1"></subset><ci id="S4.SS1.p2.8.m8.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.2">𝕌</ci><apply id="S4.SS1.p2.8.m8.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m8.1.1.3.1.cmml" xref="S4.SS1.p2.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.8.m8.1.1.3.2.cmml" xref="S4.SS1.p2.8.m8.1.1.3.2">ℤ</ci><plus id="S4.SS1.p2.8.m8.1.1.3.3.cmml" xref="S4.SS1.p2.8.m8.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">\mathbb{U}\!\subset\!\mathbb{Z}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m8.1d">blackboard_U ⊂ blackboard_Z start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> is the set of all considered numbers of concurrent users, while <math alttext="u_{\text{max}}\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)\in\mathbb{U}" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m9.2"><semantics id="S4.SS1.p2.9.m9.2a"><mrow id="S4.SS1.p2.9.m9.2.2" xref="S4.SS1.p2.9.m9.2.2.cmml"><mrow id="S4.SS1.p2.9.m9.2.2.1" xref="S4.SS1.p2.9.m9.2.2.1.cmml"><msub id="S4.SS1.p2.9.m9.2.2.1.3" xref="S4.SS1.p2.9.m9.2.2.1.3.cmml"><mi id="S4.SS1.p2.9.m9.2.2.1.3.2" xref="S4.SS1.p2.9.m9.2.2.1.3.2.cmml">u</mi><mtext id="S4.SS1.p2.9.m9.2.2.1.3.3" xref="S4.SS1.p2.9.m9.2.2.1.3.3a.cmml">max</mtext></msub><mo id="S4.SS1.p2.9.m9.2.2.1.2" xref="S4.SS1.p2.9.m9.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS1.p2.9.m9.2.2.1.1.1" xref="S4.SS1.p2.9.m9.2.2.1.1.2.cmml"><mo id="S4.SS1.p2.9.m9.2.2.1.1.1.2" xref="S4.SS1.p2.9.m9.2.2.1.1.2.cmml">(</mo><mi id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml">M</mi><mo id="S4.SS1.p2.9.m9.2.2.1.1.1.3" xref="S4.SS1.p2.9.m9.2.2.1.1.2.cmml">,</mo><mrow id="S4.SS1.p2.9.m9.2.2.1.1.1.1" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p2.9.m9.2.2.1.1.1.1.2" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.2.cmml">G</mi><mo fence="false" id="S4.SS1.p2.9.m9.2.2.1.1.1.1.1" mathsize="120%" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.1.cmml">|</mo><msub id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.cmml"><mi id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.2" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.3" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.SS1.p2.9.m9.2.2.1.1.1.4" xref="S4.SS1.p2.9.m9.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.9.m9.2.2.2" xref="S4.SS1.p2.9.m9.2.2.2.cmml">∈</mo><mi id="S4.SS1.p2.9.m9.2.2.3" xref="S4.SS1.p2.9.m9.2.2.3.cmml">𝕌</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.2b"><apply id="S4.SS1.p2.9.m9.2.2.cmml" xref="S4.SS1.p2.9.m9.2.2"><in id="S4.SS1.p2.9.m9.2.2.2.cmml" xref="S4.SS1.p2.9.m9.2.2.2"></in><apply id="S4.SS1.p2.9.m9.2.2.1.cmml" xref="S4.SS1.p2.9.m9.2.2.1"><times id="S4.SS1.p2.9.m9.2.2.1.2.cmml" xref="S4.SS1.p2.9.m9.2.2.1.2"></times><apply id="S4.SS1.p2.9.m9.2.2.1.3.cmml" xref="S4.SS1.p2.9.m9.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m9.2.2.1.3.1.cmml" xref="S4.SS1.p2.9.m9.2.2.1.3">subscript</csymbol><ci id="S4.SS1.p2.9.m9.2.2.1.3.2.cmml" xref="S4.SS1.p2.9.m9.2.2.1.3.2">𝑢</ci><ci id="S4.SS1.p2.9.m9.2.2.1.3.3a.cmml" xref="S4.SS1.p2.9.m9.2.2.1.3.3"><mtext id="S4.SS1.p2.9.m9.2.2.1.3.3.cmml" mathsize="70%" xref="S4.SS1.p2.9.m9.2.2.1.3.3">max</mtext></ci></apply><interval closure="open" id="S4.SS1.p2.9.m9.2.2.1.1.2.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1"><ci id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">𝑀</ci><apply id="S4.SS1.p2.9.m9.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.9.m9.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p2.9.m9.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.2">𝐺</ci><apply id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.2">𝔻</ci><ci id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.3a.cmml" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.3"><mtext id="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS1.p2.9.m9.2.2.1.1.1.1.3.3">train</mtext></ci></apply></apply></interval></apply><ci id="S4.SS1.p2.9.m9.2.2.3.cmml" xref="S4.SS1.p2.9.m9.2.2.3">𝕌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.2c">u_{\text{max}}\!\left(M,G\big{|}\mathbb{D}_{\text{train}}\right)\in\mathbb{U}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m9.2d">italic_u start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( italic_M , italic_G | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ∈ blackboard_U</annotation></semantics></math> denotes the maximum number of users that can be served by a single pod of <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p2.10.m10.1"><semantics id="S4.SS1.p2.10.m10.1a"><mi id="S4.SS1.p2.10.m10.1.1" xref="S4.SS1.p2.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m10.1b"><ci id="S4.SS1.p2.10.m10.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m10.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.10.m10.1d">italic_M</annotation></semantics></math> deployed on <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.p2.11.m11.1"><semantics id="S4.SS1.p2.11.m11.1a"><mi id="S4.SS1.p2.11.m11.1.1" xref="S4.SS1.p2.11.m11.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m11.1b"><ci id="S4.SS1.p2.11.m11.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m11.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.11.m11.1d">italic_G</annotation></semantics></math> without violating constraints <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p2.12.m12.1"><semantics id="S4.SS1.p2.12.m12.1a"><mi id="S4.SS1.p2.12.m12.1.1" xref="S4.SS1.p2.12.m12.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m12.1b"><ci id="S4.SS1.p2.12.m12.1.1.cmml" xref="S4.SS1.p2.12.m12.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m12.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.12.m12.1d">italic_L</annotation></semantics></math>, predicted based on <math alttext="\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS1.p2.13.m13.1"><semantics id="S4.SS1.p2.13.m13.1a"><msub id="S4.SS1.p2.13.m13.1.1" xref="S4.SS1.p2.13.m13.1.1.cmml"><mi id="S4.SS1.p2.13.m13.1.1.2" xref="S4.SS1.p2.13.m13.1.1.2.cmml">𝔻</mi><mtext id="S4.SS1.p2.13.m13.1.1.3" xref="S4.SS1.p2.13.m13.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m13.1b"><apply id="S4.SS1.p2.13.m13.1.1.cmml" xref="S4.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m13.1.1.1.cmml" xref="S4.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.p2.13.m13.1.1.2.cmml" xref="S4.SS1.p2.13.m13.1.1.2">𝔻</ci><ci id="S4.SS1.p2.13.m13.1.1.3a.cmml" xref="S4.SS1.p2.13.m13.1.1.3"><mtext id="S4.SS1.p2.13.m13.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p2.13.m13.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m13.1c">\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.13.m13.1d">blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>.
Finally, <math alttext="l_{1}\!\left(M,\!G,\!u\big{|}\mathbb{D}_{\text{train}}\right)\!,\ l_{2}\!\left%
(M,\!G,\!u\big{|}\mathbb{D}_{\text{train}}\right)\in\mathbb{R}^{+}" class="ltx_Math" display="inline" id="S4.SS1.p2.14.m14.6"><semantics id="S4.SS1.p2.14.m14.6a"><mrow id="S4.SS1.p2.14.m14.6.6" xref="S4.SS1.p2.14.m14.6.6.cmml"><mrow id="S4.SS1.p2.14.m14.6.6.2.2" xref="S4.SS1.p2.14.m14.6.6.2.3.cmml"><mrow id="S4.SS1.p2.14.m14.5.5.1.1.1" xref="S4.SS1.p2.14.m14.5.5.1.1.1.cmml"><msub id="S4.SS1.p2.14.m14.5.5.1.1.1.3" xref="S4.SS1.p2.14.m14.5.5.1.1.1.3.cmml"><mi id="S4.SS1.p2.14.m14.5.5.1.1.1.3.2" xref="S4.SS1.p2.14.m14.5.5.1.1.1.3.2.cmml">l</mi><mn id="S4.SS1.p2.14.m14.5.5.1.1.1.3.3" xref="S4.SS1.p2.14.m14.5.5.1.1.1.3.3.cmml">1</mn></msub><mo id="S4.SS1.p2.14.m14.5.5.1.1.1.2" xref="S4.SS1.p2.14.m14.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.2.cmml"><mo id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.2" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.2.cmml">(</mo><mi id="S4.SS1.p2.14.m14.1.1" xref="S4.SS1.p2.14.m14.1.1.cmml">M</mi><mpadded width="0.275em"><mo id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.3" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.2.cmml">,</mo></mpadded><mi id="S4.SS1.p2.14.m14.2.2" xref="S4.SS1.p2.14.m14.2.2.cmml">G</mi><mpadded width="0.275em"><mo id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.4" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.2.cmml">,</mo></mpadded><mrow id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.2" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.2.cmml">u</mi><mo fence="false" id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.1" mathsize="120%" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.2" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.3" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mpadded width="0.288em"><mo id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.5" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.2.cmml">)</mo></mpadded></mrow></mrow><mo id="S4.SS1.p2.14.m14.6.6.2.2.3" rspace="0.667em" xref="S4.SS1.p2.14.m14.6.6.2.3.cmml">,</mo><mrow id="S4.SS1.p2.14.m14.6.6.2.2.2" xref="S4.SS1.p2.14.m14.6.6.2.2.2.cmml"><msub id="S4.SS1.p2.14.m14.6.6.2.2.2.3" xref="S4.SS1.p2.14.m14.6.6.2.2.2.3.cmml"><mi id="S4.SS1.p2.14.m14.6.6.2.2.2.3.2" xref="S4.SS1.p2.14.m14.6.6.2.2.2.3.2.cmml">l</mi><mn id="S4.SS1.p2.14.m14.6.6.2.2.2.3.3" xref="S4.SS1.p2.14.m14.6.6.2.2.2.3.3.cmml">2</mn></msub><mo id="S4.SS1.p2.14.m14.6.6.2.2.2.2" xref="S4.SS1.p2.14.m14.6.6.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.2.cmml"><mo id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.2" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.2.cmml">(</mo><mi id="S4.SS1.p2.14.m14.3.3" xref="S4.SS1.p2.14.m14.3.3.cmml">M</mi><mpadded width="0.275em"><mo id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.3" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.2.cmml">,</mo></mpadded><mi id="S4.SS1.p2.14.m14.4.4" xref="S4.SS1.p2.14.m14.4.4.cmml">G</mi><mpadded width="0.275em"><mo id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.4" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.2.cmml">,</mo></mpadded><mrow id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.2" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.2.cmml">u</mi><mo fence="false" id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.1" mathsize="120%" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.1.cmml">|</mo><msub id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.2" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.3" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.5" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS1.p2.14.m14.6.6.3" xref="S4.SS1.p2.14.m14.6.6.3.cmml">∈</mo><msup id="S4.SS1.p2.14.m14.6.6.4" xref="S4.SS1.p2.14.m14.6.6.4.cmml"><mi id="S4.SS1.p2.14.m14.6.6.4.2" xref="S4.SS1.p2.14.m14.6.6.4.2.cmml">ℝ</mi><mo id="S4.SS1.p2.14.m14.6.6.4.3" xref="S4.SS1.p2.14.m14.6.6.4.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m14.6b"><apply id="S4.SS1.p2.14.m14.6.6.cmml" xref="S4.SS1.p2.14.m14.6.6"><in id="S4.SS1.p2.14.m14.6.6.3.cmml" xref="S4.SS1.p2.14.m14.6.6.3"></in><list id="S4.SS1.p2.14.m14.6.6.2.3.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2"><apply id="S4.SS1.p2.14.m14.5.5.1.1.1.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1"><times id="S4.SS1.p2.14.m14.5.5.1.1.1.2.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.2"></times><apply id="S4.SS1.p2.14.m14.5.5.1.1.1.3.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m14.5.5.1.1.1.3.1.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.14.m14.5.5.1.1.1.3.2.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.3.2">𝑙</ci><cn id="S4.SS1.p2.14.m14.5.5.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p2.14.m14.5.5.1.1.1.3.3">1</cn></apply><vector id="S4.SS1.p2.14.m14.5.5.1.1.1.1.2.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1"><ci id="S4.SS1.p2.14.m14.1.1.cmml" xref="S4.SS1.p2.14.m14.1.1">𝑀</ci><ci id="S4.SS1.p2.14.m14.2.2.cmml" xref="S4.SS1.p2.14.m14.2.2">𝐺</ci><apply id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.2">𝑢</ci><apply id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.2">𝔻</ci><ci id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.3a.cmml" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.3"><mtext id="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS1.p2.14.m14.5.5.1.1.1.1.1.1.3.3">train</mtext></ci></apply></apply></vector></apply><apply id="S4.SS1.p2.14.m14.6.6.2.2.2.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2"><times id="S4.SS1.p2.14.m14.6.6.2.2.2.2.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.2"></times><apply id="S4.SS1.p2.14.m14.6.6.2.2.2.3.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m14.6.6.2.2.2.3.1.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.3">subscript</csymbol><ci id="S4.SS1.p2.14.m14.6.6.2.2.2.3.2.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.3.2">𝑙</ci><cn id="S4.SS1.p2.14.m14.6.6.2.2.2.3.3.cmml" type="integer" xref="S4.SS1.p2.14.m14.6.6.2.2.2.3.3">2</cn></apply><vector id="S4.SS1.p2.14.m14.6.6.2.2.2.1.2.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1"><ci id="S4.SS1.p2.14.m14.3.3.cmml" xref="S4.SS1.p2.14.m14.3.3">𝑀</ci><ci id="S4.SS1.p2.14.m14.4.4.cmml" xref="S4.SS1.p2.14.m14.4.4">𝐺</ci><apply id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.2">𝑢</ci><apply id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.2">𝔻</ci><ci id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.3a.cmml" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.3"><mtext id="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS1.p2.14.m14.6.6.2.2.2.1.1.1.3.3">train</mtext></ci></apply></apply></vector></apply></list><apply id="S4.SS1.p2.14.m14.6.6.4.cmml" xref="S4.SS1.p2.14.m14.6.6.4"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m14.6.6.4.1.cmml" xref="S4.SS1.p2.14.m14.6.6.4">superscript</csymbol><ci id="S4.SS1.p2.14.m14.6.6.4.2.cmml" xref="S4.SS1.p2.14.m14.6.6.4.2">ℝ</ci><plus id="S4.SS1.p2.14.m14.6.6.4.3.cmml" xref="S4.SS1.p2.14.m14.6.6.4.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m14.6c">l_{1}\!\left(M,\!G,\!u\big{|}\mathbb{D}_{\text{train}}\right)\!,\ l_{2}\!\left%
(M,\!G,\!u\big{|}\mathbb{D}_{\text{train}}\right)\in\mathbb{R}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.14.m14.6d">italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) , italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> respectively denote estimated nTTFT and ITL of <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p2.15.m15.1"><semantics id="S4.SS1.p2.15.m15.1a"><mi id="S4.SS1.p2.15.m15.1.1" xref="S4.SS1.p2.15.m15.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.15.m15.1b"><ci id="S4.SS1.p2.15.m15.1.1.cmml" xref="S4.SS1.p2.15.m15.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.15.m15.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.15.m15.1d">italic_M</annotation></semantics></math> deployed on <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.p2.16.m16.1"><semantics id="S4.SS1.p2.16.m16.1a"><mi id="S4.SS1.p2.16.m16.1.1" xref="S4.SS1.p2.16.m16.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.16.m16.1b"><ci id="S4.SS1.p2.16.m16.1.1.cmml" xref="S4.SS1.p2.16.m16.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.16.m16.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.16.m16.1d">italic_G</annotation></semantics></math> and serving <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p2.17.m17.1"><semantics id="S4.SS1.p2.17.m17.1a"><mi id="S4.SS1.p2.17.m17.1.1" xref="S4.SS1.p2.17.m17.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.17.m17.1b"><ci id="S4.SS1.p2.17.m17.1.1.cmml" xref="S4.SS1.p2.17.m17.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.17.m17.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.17.m17.1d">italic_u</annotation></semantics></math> concurrent users, predicted using a regressor trained on <math alttext="\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS1.p2.18.m18.1"><semantics id="S4.SS1.p2.18.m18.1a"><msub id="S4.SS1.p2.18.m18.1.1" xref="S4.SS1.p2.18.m18.1.1.cmml"><mi id="S4.SS1.p2.18.m18.1.1.2" xref="S4.SS1.p2.18.m18.1.1.2.cmml">𝔻</mi><mtext id="S4.SS1.p2.18.m18.1.1.3" xref="S4.SS1.p2.18.m18.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.18.m18.1b"><apply id="S4.SS1.p2.18.m18.1.1.cmml" xref="S4.SS1.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.18.m18.1.1.1.cmml" xref="S4.SS1.p2.18.m18.1.1">subscript</csymbol><ci id="S4.SS1.p2.18.m18.1.1.2.cmml" xref="S4.SS1.p2.18.m18.1.1.2">𝔻</ci><ci id="S4.SS1.p2.18.m18.1.1.3a.cmml" xref="S4.SS1.p2.18.m18.1.1.3"><mtext id="S4.SS1.p2.18.m18.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p2.18.m18.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.18.m18.1c">\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.18.m18.1d">blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<p class="ltx_p ltx_align_center" id="S4.F5.1"><span class="ltx_text" id="S4.F5.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="168" id="S4.F5.1.1.g1" src="extracted/5895755/recommendation_overview.png" width="598"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.3.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.4.2" style="font-size:90%;">Architecture of the GPU recommendation tool.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.5.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.6.2">LLM-Pilot’s solution</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.6">Before LLM-Pilot can decide on the most cost-effective GPU profile for an unseen LLM, it uses the performance model to make predictions regarding the unseen LLM’s performance.
The performance model’s training data <math alttext="\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">𝔻</mi><mtext id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝔻</ci><ci id="S4.SS2.p1.1.m1.1.1.3a.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><mtext id="S4.SS2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.1.m1.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> was created using the performance characterization dataset described in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS2" title="V-B Performance characterization ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-B</span></span></a>.
The performance model takes an input the features describing the LLM <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_M</annotation></semantics></math>, features describing the GPU profile <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_G</annotation></semantics></math> and the number of concurrent users <math alttext="u\in\mathbb{U}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">u</mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">∈</mo><mi id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">𝕌</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><in id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></in><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑢</ci><ci id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">𝕌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">u\in\mathbb{U}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_u ∈ blackboard_U</annotation></semantics></math>.
As output, it predicts the latencies <math alttext="l_{1}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><msub id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">l</mi><mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝑙</ci><cn id="S4.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">l_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="l_{2}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><msub id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">l</mi><mn id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝑙</ci><cn id="S4.SS2.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.SS2.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">l_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> of that inference service.
The recommendation tool uses these predictions to identify the most cost-effective GPU profile, following Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E1" title="In IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a>)–(<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E3" title="In IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS2.SSS1.5.1.1">IV-B</span>1 </span>Feature engineering</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.1">The LLMs are characterized by the following set of features: LLM type (e.g., t5, codegen2), whether the LLM has an encoder-decoder or decoder-only architecture, the number of parameters, layers, positions and heads, whether flash attention was used, the vocabulary size, parameters for relative attention (maximum distance and number of buckets) and the data type used for training.
The set of features characterizing the GPU profiles includes the number of GPUs, memory capacity and bandwidth, GPU architecture, number of Tensor/RT/CUDA cores, number of texture mapping units, raster operations pipelines, and streaming multiprocessors, TFLOPS for various data types, compute capability, interface generation, form factor (SXM vs. PCIe) and finally whether the GPU is connected using NVLink.
The LLM features listed above were explained in detail in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib48" title="">48</a>]</cite>, and the GPU features in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib16" title="">16</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS2.SSS2.5.1.1">IV-B</span>2 </span>Regressor</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.11">Internally, the GPU recommendation tool of LLM-Pilot uses an XGBoost regressor <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib5" title="">5</a>]</cite>.
As the end goal of LLM-Pilot’s recommendation tool is to identify cost-effective GPU profiles rather than to make accurate latency predictions, we introduce two modifications to the regression task which will ultimately improve the GPU recommendations.
Our first modification is to apply sample weights to our training data, in which the closer each data point’s latency metrics are to the latency constraints, the higher weight is assigned to it.
Initially, we define weights based on nTTFT as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w_{1}(M,G,u|\mathbb{D}_{M})=1-\frac{\big{|}\hat{l}_{1}\left(M,G,u|\mathbb{D}_{%
M}\right)-L_{1}\big{|}}{\max\limits_{v\in\mathbb{U}}\big{|}\hat{l}_{1}\left(M,%
G,v|\mathbb{D}_{M}\right)-L_{1}\big{|}}" class="ltx_math_unparsed" display="block" id="S4.E4.m1.9"><semantics id="S4.E4.m1.9a"><mrow id="S4.E4.m1.9.9"><mrow id="S4.E4.m1.9.9.1"><msub id="S4.E4.m1.9.9.1.3"><mi id="S4.E4.m1.9.9.1.3.2">w</mi><mn id="S4.E4.m1.9.9.1.3.3">1</mn></msub><mo id="S4.E4.m1.9.9.1.2">⁢</mo><mrow id="S4.E4.m1.9.9.1.1.1"><mo id="S4.E4.m1.9.9.1.1.1.2" stretchy="false">(</mo><mi id="S4.E4.m1.7.7">M</mi><mo id="S4.E4.m1.9.9.1.1.1.3">,</mo><mi id="S4.E4.m1.8.8">G</mi><mo id="S4.E4.m1.9.9.1.1.1.4">,</mo><mrow id="S4.E4.m1.9.9.1.1.1.1"><mi id="S4.E4.m1.9.9.1.1.1.1.2">u</mi><mo fence="false" id="S4.E4.m1.9.9.1.1.1.1.1">|</mo><msub id="S4.E4.m1.9.9.1.1.1.1.3"><mi id="S4.E4.m1.9.9.1.1.1.1.3.2">𝔻</mi><mi id="S4.E4.m1.9.9.1.1.1.1.3.3">M</mi></msub></mrow><mo id="S4.E4.m1.9.9.1.1.1.5" stretchy="false">)</mo></mrow></mrow><mo id="S4.E4.m1.9.9.2">=</mo><mrow id="S4.E4.m1.9.9.3"><mn id="S4.E4.m1.9.9.3.2">1</mn><mo id="S4.E4.m1.9.9.3.1">−</mo><mfrac id="S4.E4.m1.6.6"><mrow id="S4.E4.m1.3.3.3"><mo fence="false" id="S4.E4.m1.3.3.3.4" maxsize="120%" minsize="120%" rspace="0.167em">|</mo><msub id="S4.E4.m1.3.3.3.5"><mover accent="true" id="S4.E4.m1.3.3.3.5.2"><mi id="S4.E4.m1.3.3.3.5.2.2">l</mi><mo id="S4.E4.m1.3.3.3.5.2.1">^</mo></mover><mn id="S4.E4.m1.3.3.3.5.3">1</mn></msub><mrow id="S4.E4.m1.3.3.3.6"><mo id="S4.E4.m1.3.3.3.6.1">(</mo><mi id="S4.E4.m1.1.1.1.1">M</mi><mo id="S4.E4.m1.3.3.3.6.2">,</mo><mi id="S4.E4.m1.2.2.2.2">G</mi><mo id="S4.E4.m1.3.3.3.6.3">,</mo><mi id="S4.E4.m1.3.3.3.3">u</mi><mo fence="false" id="S4.E4.m1.3.3.3.6.4" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E4.m1.3.3.3.6.5"><mi id="S4.E4.m1.3.3.3.6.5.2">𝔻</mi><mi id="S4.E4.m1.3.3.3.6.5.3">M</mi></msub><mo id="S4.E4.m1.3.3.3.6.6">)</mo></mrow><mo id="S4.E4.m1.3.3.3.7">−</mo><msub id="S4.E4.m1.3.3.3.8"><mi id="S4.E4.m1.3.3.3.8.2">L</mi><mn id="S4.E4.m1.3.3.3.8.3">1</mn></msub><mo fence="false" id="S4.E4.m1.3.3.3.9" maxsize="120%" minsize="120%">|</mo></mrow><mrow id="S4.E4.m1.6.6.6"><munder id="S4.E4.m1.6.6.6.4"><mi id="S4.E4.m1.6.6.6.4.2">max</mi><mrow id="S4.E4.m1.6.6.6.4.3"><mi id="S4.E4.m1.6.6.6.4.3.2">v</mi><mo id="S4.E4.m1.6.6.6.4.3.1">∈</mo><mi id="S4.E4.m1.6.6.6.4.3.3">𝕌</mi></mrow></munder><mo fence="false" id="S4.E4.m1.6.6.6.5" maxsize="120%" minsize="120%" rspace="0.167em">|</mo><msub id="S4.E4.m1.6.6.6.6"><mover accent="true" id="S4.E4.m1.6.6.6.6.2"><mi id="S4.E4.m1.6.6.6.6.2.2">l</mi><mo id="S4.E4.m1.6.6.6.6.2.1">^</mo></mover><mn id="S4.E4.m1.6.6.6.6.3">1</mn></msub><mrow id="S4.E4.m1.6.6.6.7"><mo id="S4.E4.m1.6.6.6.7.1">(</mo><mi id="S4.E4.m1.4.4.4.1">M</mi><mo id="S4.E4.m1.6.6.6.7.2">,</mo><mi id="S4.E4.m1.5.5.5.2">G</mi><mo id="S4.E4.m1.6.6.6.7.3">,</mo><mi id="S4.E4.m1.6.6.6.3">v</mi><mo fence="false" id="S4.E4.m1.6.6.6.7.4" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E4.m1.6.6.6.7.5"><mi id="S4.E4.m1.6.6.6.7.5.2">𝔻</mi><mi id="S4.E4.m1.6.6.6.7.5.3">M</mi></msub><mo id="S4.E4.m1.6.6.6.7.6">)</mo></mrow><mo id="S4.E4.m1.6.6.6.8">−</mo><msub id="S4.E4.m1.6.6.6.9"><mi id="S4.E4.m1.6.6.6.9.2">L</mi><mn id="S4.E4.m1.6.6.6.9.3">1</mn></msub><mo fence="false" id="S4.E4.m1.6.6.6.10" maxsize="120%" minsize="120%">|</mo></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex" id="S4.E4.m1.9b">w_{1}(M,G,u|\mathbb{D}_{M})=1-\frac{\big{|}\hat{l}_{1}\left(M,G,u|\mathbb{D}_{%
M}\right)-L_{1}\big{|}}{\max\limits_{v\in\mathbb{U}}\big{|}\hat{l}_{1}\left(M,%
G,v|\mathbb{D}_{M}\right)-L_{1}\big{|}}</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.9c">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) = 1 - divide start_ARG | over^ start_ARG italic_l end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) - italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | end_ARG start_ARG roman_max start_POSTSUBSCRIPT italic_v ∈ blackboard_U end_POSTSUBSCRIPT | over^ start_ARG italic_l end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_v | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) - italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p1.10">where <math alttext="\hat{l}_{1}\left(M,G,u|\mathbb{D}_{M}\right)" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.1.m1.3"><semantics id="S4.SS2.SSS2.p1.1.m1.3a"><mrow id="S4.SS2.SSS2.p1.1.m1.3.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.cmml"><msub id="S4.SS2.SSS2.p1.1.m1.3.3.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.cmml"><mover accent="true" id="S4.SS2.SSS2.p1.1.m1.3.3.3.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.2.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.3.3.3.2.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.2.2.cmml">l</mi><mo id="S4.SS2.SSS2.p1.1.m1.3.3.3.2.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.2.1.cmml">^</mo></mover><mn id="S4.SS2.SSS2.p1.1.m1.3.3.3.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.3.cmml">1</mn></msub><mo id="S4.SS2.SSS2.p1.1.m1.3.3.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p1.1.m1.3.3.1.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml"><mo id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml">M</mi><mo id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml">,</mo><mi id="S4.SS2.SSS2.p1.1.m1.2.2" xref="S4.SS2.SSS2.p1.1.m1.2.2.cmml">G</mi><mo id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.4" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml">,</mo><mrow id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.2.cmml">u</mi><mo fence="false" id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.cmml">|</mo><msub id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.2.cmml">𝔻</mi><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.5" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.3b"><apply id="S4.SS2.SSS2.p1.1.m1.3.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3"><times id="S4.SS2.SSS2.p1.1.m1.3.3.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.2"></times><apply id="S4.SS2.SSS2.p1.1.m1.3.3.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.3.3.3.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.3">subscript</csymbol><apply id="S4.SS2.SSS2.p1.1.m1.3.3.3.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.2"><ci id="S4.SS2.SSS2.p1.1.m1.3.3.3.2.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.2.1">^</ci><ci id="S4.SS2.SSS2.p1.1.m1.3.3.3.2.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.2.2">𝑙</ci></apply><cn id="S4.SS2.SSS2.p1.1.m1.3.3.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.1.m1.3.3.3.3">1</cn></apply><vector id="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1"><ci id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">𝑀</ci><ci id="S4.SS2.SSS2.p1.1.m1.2.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.2.2">𝐺</ci><apply id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.2">𝑢</ci><apply id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.2">𝔻</ci><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3.3">𝑀</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.3c">\hat{l}_{1}\left(M,G,u|\mathbb{D}_{M}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.3d">over^ start_ARG italic_l end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the true nTTFT latency of <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.2.m2.1"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><mi id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><ci id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.2.m2.1d">italic_M</annotation></semantics></math> deployed on <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.3.m3.1"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><mi id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><ci id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m3.1d">italic_G</annotation></semantics></math> with <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.4.m4.1"><semantics id="S4.SS2.SSS2.p1.4.m4.1a"><mi id="S4.SS2.SSS2.p1.4.m4.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m4.1b"><ci id="S4.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.4.m4.1d">italic_u</annotation></semantics></math> concurrent users, extracted from the known performance <math alttext="\mathbb{D}_{M}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.5.m5.1"><semantics id="S4.SS2.SSS2.p1.5.m5.1a"><msub id="S4.SS2.SSS2.p1.5.m5.1.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS2.p1.5.m5.1.1.2" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.cmml">𝔻</mi><mi id="S4.SS2.SSS2.p1.5.m5.1.1.3" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.5.m5.1b"><apply id="S4.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2">𝔻</ci><ci id="S4.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.5.m5.1c">\mathbb{D}_{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.5.m5.1d">blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> of LLM <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.6.m6.1"><semantics id="S4.SS2.SSS2.p1.6.m6.1a"><mi id="S4.SS2.SSS2.p1.6.m6.1.1" xref="S4.SS2.SSS2.p1.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.6.m6.1b"><ci id="S4.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.6.m6.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.6.m6.1d">italic_M</annotation></semantics></math>, as <math alttext="M\in\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.7.m7.1"><semantics id="S4.SS2.SSS2.p1.7.m7.1a"><mrow id="S4.SS2.SSS2.p1.7.m7.1.1" xref="S4.SS2.SSS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.SSS2.p1.7.m7.1.1.2" xref="S4.SS2.SSS2.p1.7.m7.1.1.2.cmml">M</mi><mo id="S4.SS2.SSS2.p1.7.m7.1.1.1" xref="S4.SS2.SSS2.p1.7.m7.1.1.1.cmml">∈</mo><msub id="S4.SS2.SSS2.p1.7.m7.1.1.3" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.7.m7.1.1.3.2" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.2.cmml">𝔻</mi><mtext id="S4.SS2.SSS2.p1.7.m7.1.1.3.3" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.3a.cmml">train</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.7.m7.1b"><apply id="S4.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1"><in id="S4.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.1"></in><ci id="S4.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.2">𝑀</ci><apply id="S4.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.7.m7.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.2">𝔻</ci><ci id="S4.SS2.SSS2.p1.7.m7.1.1.3.3a.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.3"><mtext id="S4.SS2.SSS2.p1.7.m7.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.SSS2.p1.7.m7.1.1.3.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.7.m7.1c">M\in\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.7.m7.1d">italic_M ∈ blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>.
The weights for the ITL latency <math alttext="w_{2}(M,G,u|\mathbb{D}_{M})" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.8.m8.3"><semantics id="S4.SS2.SSS2.p1.8.m8.3a"><mrow id="S4.SS2.SSS2.p1.8.m8.3.3" xref="S4.SS2.SSS2.p1.8.m8.3.3.cmml"><msub id="S4.SS2.SSS2.p1.8.m8.3.3.3" xref="S4.SS2.SSS2.p1.8.m8.3.3.3.cmml"><mi id="S4.SS2.SSS2.p1.8.m8.3.3.3.2" xref="S4.SS2.SSS2.p1.8.m8.3.3.3.2.cmml">w</mi><mn id="S4.SS2.SSS2.p1.8.m8.3.3.3.3" xref="S4.SS2.SSS2.p1.8.m8.3.3.3.3.cmml">2</mn></msub><mo id="S4.SS2.SSS2.p1.8.m8.3.3.2" xref="S4.SS2.SSS2.p1.8.m8.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p1.8.m8.3.3.1.1" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.2.cmml"><mo id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p1.8.m8.1.1" xref="S4.SS2.SSS2.p1.8.m8.1.1.cmml">M</mi><mo id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.3" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.2.cmml">,</mo><mi id="S4.SS2.SSS2.p1.8.m8.2.2" xref="S4.SS2.SSS2.p1.8.m8.2.2.cmml">G</mi><mo id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.4" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.2.cmml">,</mo><mrow id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.2" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.2.cmml">u</mi><mo fence="false" id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.1" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.1.cmml">|</mo><msub id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.2" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.2.cmml">𝔻</mi><mi id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.3" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.5" stretchy="false" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.8.m8.3b"><apply id="S4.SS2.SSS2.p1.8.m8.3.3.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3"><times id="S4.SS2.SSS2.p1.8.m8.3.3.2.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.2"></times><apply id="S4.SS2.SSS2.p1.8.m8.3.3.3.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.8.m8.3.3.3.1.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.8.m8.3.3.3.2.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.3.2">𝑤</ci><cn id="S4.SS2.SSS2.p1.8.m8.3.3.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.8.m8.3.3.3.3">2</cn></apply><vector id="S4.SS2.SSS2.p1.8.m8.3.3.1.2.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1"><ci id="S4.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S4.SS2.SSS2.p1.8.m8.1.1">𝑀</ci><ci id="S4.SS2.SSS2.p1.8.m8.2.2.cmml" xref="S4.SS2.SSS2.p1.8.m8.2.2">𝐺</ci><apply id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.2">𝑢</ci><apply id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.2">𝔻</ci><ci id="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.8.m8.3.3.1.1.1.3.3">𝑀</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.8.m8.3c">w_{2}(M,G,u|\mathbb{D}_{M})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.8.m8.3d">italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT )</annotation></semantics></math> are calculated in an analogous way, using the true ITL latency <math alttext="\hat{l}_{2}\left(M,G,u|\mathbb{D}_{M}\right)" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.9.m9.3"><semantics id="S4.SS2.SSS2.p1.9.m9.3a"><mrow id="S4.SS2.SSS2.p1.9.m9.3.3" xref="S4.SS2.SSS2.p1.9.m9.3.3.cmml"><msub id="S4.SS2.SSS2.p1.9.m9.3.3.3" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.cmml"><mover accent="true" id="S4.SS2.SSS2.p1.9.m9.3.3.3.2" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.2.cmml"><mi id="S4.SS2.SSS2.p1.9.m9.3.3.3.2.2" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.2.2.cmml">l</mi><mo id="S4.SS2.SSS2.p1.9.m9.3.3.3.2.1" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.2.1.cmml">^</mo></mover><mn id="S4.SS2.SSS2.p1.9.m9.3.3.3.3" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.3.cmml">2</mn></msub><mo id="S4.SS2.SSS2.p1.9.m9.3.3.2" xref="S4.SS2.SSS2.p1.9.m9.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p1.9.m9.3.3.1.1" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.2.cmml"><mo id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.2" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p1.9.m9.1.1" xref="S4.SS2.SSS2.p1.9.m9.1.1.cmml">M</mi><mo id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.3" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.2.cmml">,</mo><mi id="S4.SS2.SSS2.p1.9.m9.2.2" xref="S4.SS2.SSS2.p1.9.m9.2.2.cmml">G</mi><mo id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.4" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.2.cmml">,</mo><mrow id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.2" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.2.cmml">u</mi><mo fence="false" id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.1" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.1.cmml">|</mo><msub id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.2" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.2.cmml">𝔻</mi><mi id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.3" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.5" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.9.m9.3b"><apply id="S4.SS2.SSS2.p1.9.m9.3.3.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3"><times id="S4.SS2.SSS2.p1.9.m9.3.3.2.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.2"></times><apply id="S4.SS2.SSS2.p1.9.m9.3.3.3.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.9.m9.3.3.3.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.3">subscript</csymbol><apply id="S4.SS2.SSS2.p1.9.m9.3.3.3.2.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.2"><ci id="S4.SS2.SSS2.p1.9.m9.3.3.3.2.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.2.1">^</ci><ci id="S4.SS2.SSS2.p1.9.m9.3.3.3.2.2.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.2.2">𝑙</ci></apply><cn id="S4.SS2.SSS2.p1.9.m9.3.3.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.9.m9.3.3.3.3">2</cn></apply><vector id="S4.SS2.SSS2.p1.9.m9.3.3.1.2.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1"><ci id="S4.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.1.1">𝑀</ci><ci id="S4.SS2.SSS2.p1.9.m9.2.2.cmml" xref="S4.SS2.SSS2.p1.9.m9.2.2">𝐺</ci><apply id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.2">𝑢</ci><apply id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.2">𝔻</ci><ci id="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.9.m9.3.3.1.1.1.3.3">𝑀</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.9.m9.3c">\hat{l}_{2}\left(M,G,u|\mathbb{D}_{M}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.9.m9.3d">over^ start_ARG italic_l end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_M , italic_G , italic_u | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT )</annotation></semantics></math> and the constraint <math alttext="L_{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.10.m10.1"><semantics id="S4.SS2.SSS2.p1.10.m10.1a"><msub id="S4.SS2.SSS2.p1.10.m10.1.1" xref="S4.SS2.SSS2.p1.10.m10.1.1.cmml"><mi id="S4.SS2.SSS2.p1.10.m10.1.1.2" xref="S4.SS2.SSS2.p1.10.m10.1.1.2.cmml">L</mi><mn id="S4.SS2.SSS2.p1.10.m10.1.1.3" xref="S4.SS2.SSS2.p1.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.10.m10.1b"><apply id="S4.SS2.SSS2.p1.10.m10.1.1.cmml" xref="S4.SS2.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.10.m10.1.1.1.cmml" xref="S4.SS2.SSS2.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.10.m10.1.1.2.cmml" xref="S4.SS2.SSS2.p1.10.m10.1.1.2">𝐿</ci><cn id="S4.SS2.SSS2.p1.10.m10.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.10.m10.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.10.m10.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
With this formula for the sample weights, training data points have weights inversely proportional to how far their latency is from the respective latency constraint.
We combine both weights using arithmetic mean.
The intuition behind our use of the sample weights is as follows: as we are solving the GPU recommendation problem (<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E1" title="In IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a>), the regressor’s purpose is to estimate the maximum number of concurrent users that can be served on a given GPU under the latency constraints.
Therefore, it has to make accurate latency predictions mainly for those numbers of users for which the latency metrics are near the constraints.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.p2.1">However, the sample weights can also lead to drastically incorrect recommendations.
For example, let us assume that for some GPU profile the true latency for 4 concurrent users is far from the latency constraint and therefore, that data point has a low sample weight.
The regressor predicts an incorrect, very high latency value for that data point and LLM-Pilot determines that the latency constraint is already violated.
At the same time, the regressor made accurate latency predictions for 16 and 32 concurrent users, as these data points are close to the latency constraint and have high sample weights.
However, constraint violation for 4 concurrent users causes LLM-Pilot to determine that this GPU profile can only support 2 concurrent users and massively overestimate the number of pods needed.
Therefore, we additionally enforce on the regressor a monotonicity constraint on the number of concurrent users, as based on our experiments, as the number of concurrent users increases, the nTTFT and ITL of the service increase or stay constant:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{array}[]{c}u^{\prime}\!&lt;\!u^{\prime\prime}\implies l\!\left(M,G,u^{%
\prime}\big{|}\mathbb{D}_{\text{train}}\right)\leq l\!\left(M,G,u^{\prime%
\prime}\big{|}\mathbb{D}_{\text{train}}\right)\\
\hfill\forall_{u^{\prime},u^{\prime\prime}\in\mathbb{U},\ l\in\{l_{1},l_{2}\}}%
\end{array}" class="ltx_Math" display="block" id="S4.Ex1.m1.8"><semantics id="S4.Ex1.m1.8a"><mtable displaystyle="true" id="S4.Ex1.m1.8.8" rowspacing="0pt" xref="S4.Ex1.m1.8.8.cmml"><mtr id="S4.Ex1.m1.8.8a" xref="S4.Ex1.m1.8.8.cmml"><mtd id="S4.Ex1.m1.8.8b" xref="S4.Ex1.m1.8.8.cmml"><mrow id="S4.Ex1.m1.6.6.6.6.6" xref="S4.Ex1.m1.6.6.6.6.6.cmml"><msup id="S4.Ex1.m1.6.6.6.6.6.8" xref="S4.Ex1.m1.6.6.6.6.6.8.cmml"><mi id="S4.Ex1.m1.6.6.6.6.6.8.2" xref="S4.Ex1.m1.6.6.6.6.6.8.2.cmml">u</mi><mo id="S4.Ex1.m1.6.6.6.6.6.8.3" xref="S4.Ex1.m1.6.6.6.6.6.8.3.cmml">′</mo></msup><mo id="S4.Ex1.m1.6.6.6.6.6.9" lspace="0.108em" rspace="0.108em" xref="S4.Ex1.m1.6.6.6.6.6.9.cmml">&lt;</mo><msup id="S4.Ex1.m1.6.6.6.6.6.10" xref="S4.Ex1.m1.6.6.6.6.6.10.cmml"><mi id="S4.Ex1.m1.6.6.6.6.6.10.2" xref="S4.Ex1.m1.6.6.6.6.6.10.2.cmml">u</mi><mo id="S4.Ex1.m1.6.6.6.6.6.10.3" xref="S4.Ex1.m1.6.6.6.6.6.10.3.cmml">′′</mo></msup><mo id="S4.Ex1.m1.6.6.6.6.6.11" stretchy="false" xref="S4.Ex1.m1.6.6.6.6.6.11.cmml">⟹</mo><mrow id="S4.Ex1.m1.5.5.5.5.5.5" xref="S4.Ex1.m1.5.5.5.5.5.5.cmml"><mpadded width="0.148em"><mi id="S4.Ex1.m1.5.5.5.5.5.5.3" xref="S4.Ex1.m1.5.5.5.5.5.5.3.cmml">l</mi></mpadded><mo id="S4.Ex1.m1.5.5.5.5.5.5.2" xref="S4.Ex1.m1.5.5.5.5.5.5.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.5.5.5.5.5.5.1.1" xref="S4.Ex1.m1.5.5.5.5.5.5.1.2.cmml"><mo id="S4.Ex1.m1.5.5.5.5.5.5.1.1.2" xref="S4.Ex1.m1.5.5.5.5.5.5.1.2.cmml">(</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.cmml">M</mi><mo id="S4.Ex1.m1.5.5.5.5.5.5.1.1.3" xref="S4.Ex1.m1.5.5.5.5.5.5.1.2.cmml">,</mo><mi id="S4.Ex1.m1.2.2.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.2.2.cmml">G</mi><mo id="S4.Ex1.m1.5.5.5.5.5.5.1.1.4" xref="S4.Ex1.m1.5.5.5.5.5.5.1.2.cmml">,</mo><mrow id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.cmml"><msup id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.cmml"><mi id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.2" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.2.cmml">u</mi><mo id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.3" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.1" mathsize="120%" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.1.cmml">|</mo><msub id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.cmml"><mi id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.2" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.3" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.Ex1.m1.5.5.5.5.5.5.1.1.5" xref="S4.Ex1.m1.5.5.5.5.5.5.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.6.6.6.6.6.12" xref="S4.Ex1.m1.6.6.6.6.6.12.cmml">≤</mo><mrow id="S4.Ex1.m1.6.6.6.6.6.6" xref="S4.Ex1.m1.6.6.6.6.6.6.cmml"><mpadded width="0.148em"><mi id="S4.Ex1.m1.6.6.6.6.6.6.3" xref="S4.Ex1.m1.6.6.6.6.6.6.3.cmml">l</mi></mpadded><mo id="S4.Ex1.m1.6.6.6.6.6.6.2" xref="S4.Ex1.m1.6.6.6.6.6.6.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.6.6.6.6.6.6.1.1" xref="S4.Ex1.m1.6.6.6.6.6.6.1.2.cmml"><mo id="S4.Ex1.m1.6.6.6.6.6.6.1.1.2" xref="S4.Ex1.m1.6.6.6.6.6.6.1.2.cmml">(</mo><mi id="S4.Ex1.m1.3.3.3.3.3.3" xref="S4.Ex1.m1.3.3.3.3.3.3.cmml">M</mi><mo id="S4.Ex1.m1.6.6.6.6.6.6.1.1.3" xref="S4.Ex1.m1.6.6.6.6.6.6.1.2.cmml">,</mo><mi id="S4.Ex1.m1.4.4.4.4.4.4" xref="S4.Ex1.m1.4.4.4.4.4.4.cmml">G</mi><mo id="S4.Ex1.m1.6.6.6.6.6.6.1.1.4" xref="S4.Ex1.m1.6.6.6.6.6.6.1.2.cmml">,</mo><mrow id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.cmml"><msup id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.cmml"><mi id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.2" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.2.cmml">u</mi><mo id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.3" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.3.cmml">′′</mo></msup><mo fence="false" id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.1" mathsize="120%" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.1.cmml">|</mo><msub id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.cmml"><mi id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.2" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.2.cmml">𝔻</mi><mtext id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.3" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S4.Ex1.m1.6.6.6.6.6.6.1.1.5" xref="S4.Ex1.m1.6.6.6.6.6.6.1.2.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.Ex1.m1.8.8c" xref="S4.Ex1.m1.8.8.cmml"><mtd id="S4.Ex1.m1.8.8d" xref="S4.Ex1.m1.8.8.cmml"><msub id="S4.Ex1.m1.8.8.8.2.2" xref="S4.Ex1.m1.8.8.8.2.2.cmml"><mo id="S4.Ex1.m1.8.8.8.2.2.4" xref="S4.Ex1.m1.8.8.8.2.2.4.cmml">∀</mo><mrow id="S4.Ex1.m1.8.8.8.2.2.2.2.2" xref="S4.Ex1.m1.8.8.8.2.2.2.2.3.cmml"><mrow id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.3.cmml"><msup id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.2.cmml">u</mi><mo id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.3" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.2" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.2.cmml">u</mi><mo id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.3" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.3.cmml">′′</mo></msup></mrow><mo id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.3" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.3.cmml">∈</mo><mi id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.4" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.4.cmml">𝕌</mi></mrow><mo id="S4.Ex1.m1.8.8.8.2.2.2.2.2.3" rspace="0.517em" xref="S4.Ex1.m1.8.8.8.2.2.2.2.3a.cmml">,</mo><mrow id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.cmml"><mi id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.4" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.4.cmml">l</mi><mo id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.3" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.3.cmml">∈</mo><mrow id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.3.cmml"><mo id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.3" stretchy="false" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.3.cmml">{</mo><msub id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.2" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.2.cmml">l</mi><mn id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.3" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.4" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.cmml"><mi id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.2" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.2.cmml">l</mi><mn id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.3" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.5" stretchy="false" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.3.cmml">}</mo></mrow></mrow></mrow></msub></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.8b"><matrix id="S4.Ex1.m1.8.8.cmml" xref="S4.Ex1.m1.8.8"><matrixrow id="S4.Ex1.m1.8.8a.cmml" xref="S4.Ex1.m1.8.8"><apply id="S4.Ex1.m1.6.6.6.6.6.cmml" xref="S4.Ex1.m1.6.6.6.6.6"><and id="S4.Ex1.m1.6.6.6.6.6a.cmml" xref="S4.Ex1.m1.6.6.6.6.6"></and><apply id="S4.Ex1.m1.6.6.6.6.6b.cmml" xref="S4.Ex1.m1.6.6.6.6.6"><lt id="S4.Ex1.m1.6.6.6.6.6.9.cmml" xref="S4.Ex1.m1.6.6.6.6.6.9"></lt><apply id="S4.Ex1.m1.6.6.6.6.6.8.cmml" xref="S4.Ex1.m1.6.6.6.6.6.8"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.6.6.6.8.1.cmml" xref="S4.Ex1.m1.6.6.6.6.6.8">superscript</csymbol><ci id="S4.Ex1.m1.6.6.6.6.6.8.2.cmml" xref="S4.Ex1.m1.6.6.6.6.6.8.2">𝑢</ci><ci id="S4.Ex1.m1.6.6.6.6.6.8.3.cmml" xref="S4.Ex1.m1.6.6.6.6.6.8.3">′</ci></apply><apply id="S4.Ex1.m1.6.6.6.6.6.10.cmml" xref="S4.Ex1.m1.6.6.6.6.6.10"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.6.6.6.10.1.cmml" xref="S4.Ex1.m1.6.6.6.6.6.10">superscript</csymbol><ci id="S4.Ex1.m1.6.6.6.6.6.10.2.cmml" xref="S4.Ex1.m1.6.6.6.6.6.10.2">𝑢</ci><ci id="S4.Ex1.m1.6.6.6.6.6.10.3.cmml" xref="S4.Ex1.m1.6.6.6.6.6.10.3">′′</ci></apply></apply><apply id="S4.Ex1.m1.6.6.6.6.6c.cmml" xref="S4.Ex1.m1.6.6.6.6.6"><implies id="S4.Ex1.m1.6.6.6.6.6.11.cmml" xref="S4.Ex1.m1.6.6.6.6.6.11"></implies><share href="https://arxiv.org/html/2410.02425v1#S4.Ex1.m1.6.6.6.6.6.10.cmml" id="S4.Ex1.m1.6.6.6.6.6d.cmml" xref="S4.Ex1.m1.6.6.6.6.6"></share><apply id="S4.Ex1.m1.5.5.5.5.5.5.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5"><times id="S4.Ex1.m1.5.5.5.5.5.5.2.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.2"></times><ci id="S4.Ex1.m1.5.5.5.5.5.5.3.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.3">𝑙</ci><vector id="S4.Ex1.m1.5.5.5.5.5.5.1.2.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1"><ci id="S4.Ex1.m1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1">𝑀</ci><ci id="S4.Ex1.m1.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2.2.2">𝐺</ci><apply id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.1">conditional</csymbol><apply id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.1.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2">superscript</csymbol><ci id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.2.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.2">𝑢</ci><ci id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.3.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.2.3">′</ci></apply><apply id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.1.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.2.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.2">𝔻</ci><ci id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.3a.cmml" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.3"><mtext id="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.3.cmml" mathsize="70%" xref="S4.Ex1.m1.5.5.5.5.5.5.1.1.1.3.3">train</mtext></ci></apply></apply></vector></apply></apply><apply id="S4.Ex1.m1.6.6.6.6.6e.cmml" xref="S4.Ex1.m1.6.6.6.6.6"><leq id="S4.Ex1.m1.6.6.6.6.6.12.cmml" xref="S4.Ex1.m1.6.6.6.6.6.12"></leq><share href="https://arxiv.org/html/2410.02425v1#S4.Ex1.m1.5.5.5.5.5.5.cmml" id="S4.Ex1.m1.6.6.6.6.6f.cmml" xref="S4.Ex1.m1.6.6.6.6.6"></share><apply id="S4.Ex1.m1.6.6.6.6.6.6.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6"><times id="S4.Ex1.m1.6.6.6.6.6.6.2.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.2"></times><ci id="S4.Ex1.m1.6.6.6.6.6.6.3.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.3">𝑙</ci><vector id="S4.Ex1.m1.6.6.6.6.6.6.1.2.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1"><ci id="S4.Ex1.m1.3.3.3.3.3.3.cmml" xref="S4.Ex1.m1.3.3.3.3.3.3">𝑀</ci><ci id="S4.Ex1.m1.4.4.4.4.4.4.cmml" xref="S4.Ex1.m1.4.4.4.4.4.4">𝐺</ci><apply id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.1">conditional</csymbol><apply id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.1.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2">superscript</csymbol><ci id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.2.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.2">𝑢</ci><ci id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.3.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.2.3">′′</ci></apply><apply id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.1.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.2.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.2">𝔻</ci><ci id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.3a.cmml" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.3"><mtext id="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.3.cmml" mathsize="70%" xref="S4.Ex1.m1.6.6.6.6.6.6.1.1.1.3.3">train</mtext></ci></apply></apply></vector></apply></apply></apply></matrixrow><matrixrow id="S4.Ex1.m1.8.8b.cmml" xref="S4.Ex1.m1.8.8"><apply id="S4.Ex1.m1.8.8.8.2.2.cmml" xref="S4.Ex1.m1.8.8.8.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.8.2.2.3.cmml" xref="S4.Ex1.m1.8.8.8.2.2">subscript</csymbol><csymbol cd="latexml" id="S4.Ex1.m1.8.8.8.2.2.4.cmml" xref="S4.Ex1.m1.8.8.8.2.2.4">for-all</csymbol><apply id="S4.Ex1.m1.8.8.8.2.2.2.2.3.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.8.2.2.2.2.3a.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1"><in id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.3"></in><list id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2"><apply id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.2">𝑢</ci><ci id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.2">𝑢</ci><ci id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.2.2.2.3">′′</ci></apply></list><ci id="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.4.cmml" xref="S4.Ex1.m1.7.7.7.1.1.1.1.1.1.4">𝕌</ci></apply><apply id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2"><in id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.3.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.3"></in><ci id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.4.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.4">𝑙</ci><set id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.3.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2"><apply id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.2">𝑙</ci><cn id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.1.1.1.3">1</cn></apply><apply id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.1.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.2">𝑙</ci><cn id="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="S4.Ex1.m1.8.8.8.2.2.2.2.2.2.2.2.2.3">2</cn></apply></set></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.8c">\begin{array}[]{c}u^{\prime}\!&lt;\!u^{\prime\prime}\implies l\!\left(M,G,u^{%
\prime}\big{|}\mathbb{D}_{\text{train}}\right)\leq l\!\left(M,G,u^{\prime%
\prime}\big{|}\mathbb{D}_{\text{train}}\right)\\
\hfill\forall_{u^{\prime},u^{\prime\prime}\in\mathbb{U},\ l\in\{l_{1},l_{2}\}}%
\end{array}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.8d">start_ARRAY start_ROW start_CELL italic_u start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT &lt; italic_u start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ⟹ italic_l ( italic_M , italic_G , italic_u start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ≤ italic_l ( italic_M , italic_G , italic_u start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL ∀ start_POSTSUBSCRIPT italic_u start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_u start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ∈ blackboard_U , italic_l ∈ { italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT } end_POSTSUBSCRIPT end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p3">
<p class="ltx_p" id="S4.SS2.SSS2.p3.1">With the addition of the monotonicity constraint, if the regressor makes accurate predictions for data points close to the latency constraint, it will never incorrectly indicate violation or satisfaction of the constraint for the other data points.
This way, the monotonicity constraint ensures that using the sample weights does not negatively impact the estimation of the maximum number of concurrent users.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="398" id="S4.F6.sf1.g1" src="extracted/5895755/generator_input_tokens.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F6.sf1.3.2" style="font-size:90%;">Number of input tokens</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="405" id="S4.F6.sf2.g1" src="extracted/5895755/generator_batch_size.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F6.sf2.3.2" style="font-size:90%;">Client-side batch size</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="405" id="S4.F6.sf3.g1" src="extracted/5895755/generator_temperature.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S4.F6.sf3.3.2" style="font-size:90%;">Temperature</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S4.F6.3.2" style="font-size:90%;">Marginal CDFs of selected request parameters in the empirical distribution and in the workload generator.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.41.2.1" style="font-size:90%;">TABLE III</span>: </span><span class="ltx_text" id="S4.T3.2.1" style="font-size:90%;">LLMs and GPUs included in our performance characterization dataset: combinations for which data was collected (<span class="ltx_text" id="S4.T3.2.1.1" style="color:#00FF00;">✓</span>), combinations in which the GPU profile’s memory capacity was too small to host the LLM while leaving sufficient space to process workload generator’s requests (<math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.2.1.m1.1"><semantics id="S4.T3.2.1.m1.1b"><mo id="S4.T3.2.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.1.m1.1c"><times id="S4.T3.2.1.m1.1.1.cmml" xref="S4.T3.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.1.m1.1e">×</annotation></semantics></math>), and combinations omitted due to software or hardware limitations (<span class="ltx_text" id="S4.T3.2.1.2" style="color:#0000FF;">–</span>).</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.37">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.37.36.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S4.T3.37.36.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.37.36.1.1.1">LLM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T3.37.36.1.2">H100 (80GB)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T3.37.36.1.3">A100 (40GB)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T3.37.36.1.4">​A10 (24GB)​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T3.37.36.1.5">T4 (16GB)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T3.37.36.1.6">V100 (16GB)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.37.37.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.1">  ​1​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.2">  ​2​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.3">  ​4​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.4">  ​1​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.5">  ​2​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.6">  ​4​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.7">  ​1​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.8">  ​2​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.9">  ​1​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.10">  ​2​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.11">  ​4​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.12">  ​1​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.13">  ​2​</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.37.2.14">  ​4​</td>
</tr>
<tr class="ltx_tr" id="S4.T3.37.38.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.37.38.3.1">google/flan-t5-xl <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib6" title="">6</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.2">3B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.3"><span class="ltx_text" id="S4.T3.37.38.3.3.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.4"><span class="ltx_text" id="S4.T3.37.38.3.4.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.5"><span class="ltx_text" id="S4.T3.37.38.3.5.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.6"><span class="ltx_text" id="S4.T3.37.38.3.6.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.7"><span class="ltx_text" id="S4.T3.37.38.3.7.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.8"><span class="ltx_text" id="S4.T3.37.38.3.8.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.9"><span class="ltx_text" id="S4.T3.37.38.3.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.10"><span class="ltx_text" id="S4.T3.37.38.3.10.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.11"><span class="ltx_text" id="S4.T3.37.38.3.11.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.12"><span class="ltx_text" id="S4.T3.37.38.3.12.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.13"><span class="ltx_text" id="S4.T3.37.38.3.13.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.14"><span class="ltx_text" id="S4.T3.37.38.3.14.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.15"><span class="ltx_text" id="S4.T3.37.38.3.15.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.37.38.3.16"><span class="ltx_text" id="S4.T3.37.38.3.16.1" style="color:#00FF00;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.7.5.6">google/flan-t5-xxl <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib6" title="">6</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.7">11B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.8"><span class="ltx_text" id="S4.T3.7.5.8.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.9"><span class="ltx_text" id="S4.T3.7.5.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.10"><span class="ltx_text" id="S4.T3.7.5.10.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.11"><span class="ltx_text" id="S4.T3.7.5.11.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.12"><span class="ltx_text" id="S4.T3.7.5.12.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.13"><span class="ltx_text" id="S4.T3.7.5.13.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.1.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.3.1.1.m1.1"><semantics id="S4.T3.3.1.1.m1.1a"><mo id="S4.T3.3.1.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.3.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.m1.1b"><times id="S4.T3.3.1.1.m1.1.1.cmml" xref="S4.T3.3.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.1.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.14"><span class="ltx_text" id="S4.T3.7.5.14.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.4.2.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.4.2.2.m1.1"><semantics id="S4.T3.4.2.2.m1.1a"><mo id="S4.T3.4.2.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.4.2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.2.m1.1b"><times id="S4.T3.4.2.2.m1.1.1.cmml" xref="S4.T3.4.2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.2.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.5.3.3.m1.1"><semantics id="S4.T3.5.3.3.m1.1a"><mo id="S4.T3.5.3.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.5.3.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.3.m1.1b"><times id="S4.T3.5.3.3.m1.1.1.cmml" xref="S4.T3.5.3.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.3.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.15"><span class="ltx_text" id="S4.T3.7.5.15.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.4.4"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.6.4.4.m1.1"><semantics id="S4.T3.6.4.4.m1.1a"><mo id="S4.T3.6.4.4.m1.1.1" mathcolor="#FF0000" xref="S4.T3.6.4.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.4.4.m1.1b"><times id="S4.T3.6.4.4.m1.1.1.cmml" xref="S4.T3.6.4.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.4.4.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.4.4.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.5"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.7.5.5.m1.1"><semantics id="S4.T3.7.5.5.m1.1a"><mo id="S4.T3.7.5.5.m1.1.1" mathcolor="#FF0000" xref="S4.T3.7.5.5.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.5.5.m1.1b"><times id="S4.T3.7.5.5.m1.1.1.cmml" xref="S4.T3.7.5.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.5.5.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.5.5.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.5.16"><span class="ltx_text" id="S4.T3.7.5.16.1" style="color:#00FF00;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.16.14">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.16.14.10">google/flan-ul2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib45" title="">45</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.14.11">20B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.14.12"><span class="ltx_text" id="S4.T3.16.14.12.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.14.13"><span class="ltx_text" id="S4.T3.16.14.13.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.14.14"><span class="ltx_text" id="S4.T3.16.14.14.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.8.6.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.8.6.1.m1.1"><semantics id="S4.T3.8.6.1.m1.1a"><mo id="S4.T3.8.6.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.8.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.6.1.m1.1b"><times id="S4.T3.8.6.1.m1.1.1.cmml" xref="S4.T3.8.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.6.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.6.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.14.15"><span class="ltx_text" id="S4.T3.16.14.15.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.14.16"><span class="ltx_text" id="S4.T3.16.14.16.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.9.7.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.9.7.2.m1.1"><semantics id="S4.T3.9.7.2.m1.1a"><mo id="S4.T3.9.7.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.9.7.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.9.7.2.m1.1b"><times id="S4.T3.9.7.2.m1.1.1.cmml" xref="S4.T3.9.7.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.7.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.7.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.10.8.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.10.8.3.m1.1"><semantics id="S4.T3.10.8.3.m1.1a"><mo id="S4.T3.10.8.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.10.8.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.10.8.3.m1.1b"><times id="S4.T3.10.8.3.m1.1.1.cmml" xref="S4.T3.10.8.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.8.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.8.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.11.9.4"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.11.9.4.m1.1"><semantics id="S4.T3.11.9.4.m1.1a"><mo id="S4.T3.11.9.4.m1.1.1" mathcolor="#FF0000" xref="S4.T3.11.9.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.11.9.4.m1.1b"><times id="S4.T3.11.9.4.m1.1.1.cmml" xref="S4.T3.11.9.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.9.4.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.9.4.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.12.10.5"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.12.10.5.m1.1"><semantics id="S4.T3.12.10.5.m1.1a"><mo id="S4.T3.12.10.5.m1.1.1" mathcolor="#FF0000" xref="S4.T3.12.10.5.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.12.10.5.m1.1b"><times id="S4.T3.12.10.5.m1.1.1.cmml" xref="S4.T3.12.10.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.10.5.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.12.10.5.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.13.11.6"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.13.11.6.m1.1"><semantics id="S4.T3.13.11.6.m1.1a"><mo id="S4.T3.13.11.6.m1.1.1" mathcolor="#FF0000" xref="S4.T3.13.11.6.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.13.11.6.m1.1b"><times id="S4.T3.13.11.6.m1.1.1.cmml" xref="S4.T3.13.11.6.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.11.6.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.13.11.6.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.14.12.7"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.14.12.7.m1.1"><semantics id="S4.T3.14.12.7.m1.1a"><mo id="S4.T3.14.12.7.m1.1.1" mathcolor="#FF0000" xref="S4.T3.14.12.7.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.14.12.7.m1.1b"><times id="S4.T3.14.12.7.m1.1.1.cmml" xref="S4.T3.14.12.7.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.12.7.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.14.12.7.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.15.13.8"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.15.13.8.m1.1"><semantics id="S4.T3.15.13.8.m1.1a"><mo id="S4.T3.15.13.8.m1.1.1" mathcolor="#FF0000" xref="S4.T3.15.13.8.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.15.13.8.m1.1b"><times id="S4.T3.15.13.8.m1.1.1.cmml" xref="S4.T3.15.13.8.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.13.8.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.15.13.8.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.14.9"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.16.14.9.m1.1"><semantics id="S4.T3.16.14.9.m1.1a"><mo id="S4.T3.16.14.9.m1.1.1" mathcolor="#FF0000" xref="S4.T3.16.14.9.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.16.14.9.m1.1b"><times id="S4.T3.16.14.9.m1.1.1.cmml" xref="S4.T3.16.14.9.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.14.9.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.16.14.9.m1.1d">×</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.19.17">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.19.17.4">ibm/mpt-7b-instruct2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib13" title="">13</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.5">7B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.6"><span class="ltx_text" id="S4.T3.19.17.6.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.7"><span class="ltx_text" id="S4.T3.19.17.7.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.8"><span class="ltx_text" id="S4.T3.19.17.8.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.9"><span class="ltx_text" id="S4.T3.19.17.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.10"><span class="ltx_text" id="S4.T3.19.17.10.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.11"><span class="ltx_text" id="S4.T3.19.17.11.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.17.15.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.17.15.1.m1.1"><semantics id="S4.T3.17.15.1.m1.1a"><mo id="S4.T3.17.15.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.17.15.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.17.15.1.m1.1b"><times id="S4.T3.17.15.1.m1.1.1.cmml" xref="S4.T3.17.15.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.17.15.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.17.15.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.12"><span class="ltx_text" id="S4.T3.19.17.12.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.18.16.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.18.16.2.m1.1"><semantics id="S4.T3.18.16.2.m1.1a"><mo id="S4.T3.18.16.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.18.16.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.18.16.2.m1.1b"><times id="S4.T3.18.16.2.m1.1.1.cmml" xref="S4.T3.18.16.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.18.16.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.18.16.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.13"><span class="ltx_text" id="S4.T3.19.17.13.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.14"><span class="ltx_text" id="S4.T3.19.17.14.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.19.17.3.m1.1"><semantics id="S4.T3.19.17.3.m1.1a"><mo id="S4.T3.19.17.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.19.17.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.19.17.3.m1.1b"><times id="S4.T3.19.17.3.m1.1.1.cmml" xref="S4.T3.19.17.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.19.17.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.19.17.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.15"><span class="ltx_text" id="S4.T3.19.17.15.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.17.16"><span class="ltx_text" id="S4.T3.19.17.16.1" style="color:#0000FF;">–</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.22.20">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.22.20.4">bigscience/mt0-xxl <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib24" title="">24</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.5">13B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.6"><span class="ltx_text" id="S4.T3.22.20.6.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.7"><span class="ltx_text" id="S4.T3.22.20.7.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.8"><span class="ltx_text" id="S4.T3.22.20.8.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.9"><span class="ltx_text" id="S4.T3.22.20.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.10"><span class="ltx_text" id="S4.T3.22.20.10.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.11"><span class="ltx_text" id="S4.T3.22.20.11.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.20.18.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.20.18.1.m1.1"><semantics id="S4.T3.20.18.1.m1.1a"><mo id="S4.T3.20.18.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.20.18.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.20.18.1.m1.1b"><times id="S4.T3.20.18.1.m1.1.1.cmml" xref="S4.T3.20.18.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.20.18.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.20.18.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.12"><span class="ltx_text" id="S4.T3.22.20.12.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.21.19.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.21.19.2.m1.1"><semantics id="S4.T3.21.19.2.m1.1a"><mo id="S4.T3.21.19.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.21.19.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.21.19.2.m1.1b"><times id="S4.T3.21.19.2.m1.1.1.cmml" xref="S4.T3.21.19.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.21.19.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.21.19.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.13"><span class="ltx_text" id="S4.T3.22.20.13.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.14"><span class="ltx_text" id="S4.T3.22.20.14.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.22.20.3.m1.1"><semantics id="S4.T3.22.20.3.m1.1a"><mo id="S4.T3.22.20.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.22.20.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.22.20.3.m1.1b"><times id="S4.T3.22.20.3.m1.1.1.cmml" xref="S4.T3.22.20.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.22.20.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.22.20.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.15"><span class="ltx_text" id="S4.T3.22.20.15.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.22.20.16"><span class="ltx_text" id="S4.T3.22.20.16.1" style="color:#0000FF;">–</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.26.24">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.26.24.5">Salesforce/codegen2-16B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib29" title="">29</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.6">16B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.7"><span class="ltx_text" id="S4.T3.26.24.7.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.8"><span class="ltx_text" id="S4.T3.26.24.8.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.9"><span class="ltx_text" id="S4.T3.26.24.9.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.23.21.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.23.21.1.m1.1"><semantics id="S4.T3.23.21.1.m1.1a"><mo id="S4.T3.23.21.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.23.21.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.23.21.1.m1.1b"><times id="S4.T3.23.21.1.m1.1.1.cmml" xref="S4.T3.23.21.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.23.21.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.23.21.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.10"><span class="ltx_text" id="S4.T3.26.24.10.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.11"><span class="ltx_text" id="S4.T3.26.24.11.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.24.22.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.24.22.2.m1.1"><semantics id="S4.T3.24.22.2.m1.1a"><mo id="S4.T3.24.22.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.24.22.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.24.22.2.m1.1b"><times id="S4.T3.24.22.2.m1.1.1.cmml" xref="S4.T3.24.22.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.24.22.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.24.22.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.12"><span class="ltx_text" id="S4.T3.26.24.12.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.25.23.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.25.23.3.m1.1"><semantics id="S4.T3.25.23.3.m1.1a"><mo id="S4.T3.25.23.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.25.23.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.25.23.3.m1.1b"><times id="S4.T3.25.23.3.m1.1.1.cmml" xref="S4.T3.25.23.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.25.23.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.25.23.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.13"><span class="ltx_text" id="S4.T3.26.24.13.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.14"><span class="ltx_text" id="S4.T3.26.24.14.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.4"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.26.24.4.m1.1"><semantics id="S4.T3.26.24.4.m1.1a"><mo id="S4.T3.26.24.4.m1.1.1" mathcolor="#FF0000" xref="S4.T3.26.24.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.26.24.4.m1.1b"><times id="S4.T3.26.24.4.m1.1.1.cmml" xref="S4.T3.26.24.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.26.24.4.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.26.24.4.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.15"><span class="ltx_text" id="S4.T3.26.24.15.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.26.24.16"><span class="ltx_text" id="S4.T3.26.24.16.1" style="color:#0000FF;">–</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.27.25">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.27.25.2">Llama-2-7b <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib47" title="">47</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.3">7B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.4"><span class="ltx_text" id="S4.T3.27.25.4.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.5"><span class="ltx_text" id="S4.T3.27.25.5.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.6"><span class="ltx_text" id="S4.T3.27.25.6.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.7"><span class="ltx_text" id="S4.T3.27.25.7.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.8"><span class="ltx_text" id="S4.T3.27.25.8.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.9"><span class="ltx_text" id="S4.T3.27.25.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.10"><span class="ltx_text" id="S4.T3.27.25.10.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.11"><span class="ltx_text" id="S4.T3.27.25.11.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.27.25.1.m1.1"><semantics id="S4.T3.27.25.1.m1.1a"><mo id="S4.T3.27.25.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.27.25.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.27.25.1.m1.1b"><times id="S4.T3.27.25.1.m1.1.1.cmml" xref="S4.T3.27.25.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.27.25.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.27.25.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.12"><span class="ltx_text" id="S4.T3.27.25.12.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.13"><span class="ltx_text" id="S4.T3.27.25.13.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.14"><span class="ltx_text" id="S4.T3.27.25.14.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.15"><span class="ltx_text" id="S4.T3.27.25.15.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.27.25.16"><span class="ltx_text" id="S4.T3.27.25.16.1" style="color:#0000FF;">–</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.30.28">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.30.28.4">Llama-2-13b <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib47" title="">47</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.5">13B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.6"><span class="ltx_text" id="S4.T3.30.28.6.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.7"><span class="ltx_text" id="S4.T3.30.28.7.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.8"><span class="ltx_text" id="S4.T3.30.28.8.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.9"><span class="ltx_text" id="S4.T3.30.28.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.10"><span class="ltx_text" id="S4.T3.30.28.10.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.11"><span class="ltx_text" id="S4.T3.30.28.11.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.28.26.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.28.26.1.m1.1"><semantics id="S4.T3.28.26.1.m1.1a"><mo id="S4.T3.28.26.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.28.26.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.28.26.1.m1.1b"><times id="S4.T3.28.26.1.m1.1.1.cmml" xref="S4.T3.28.26.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.28.26.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.28.26.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.12"><span class="ltx_text" id="S4.T3.30.28.12.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.29.27.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.29.27.2.m1.1"><semantics id="S4.T3.29.27.2.m1.1a"><mo id="S4.T3.29.27.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.29.27.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.29.27.2.m1.1b"><times id="S4.T3.29.27.2.m1.1.1.cmml" xref="S4.T3.29.27.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.29.27.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.29.27.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.30.28.3.m1.1"><semantics id="S4.T3.30.28.3.m1.1a"><mo id="S4.T3.30.28.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.30.28.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.30.28.3.m1.1b"><times id="S4.T3.30.28.3.m1.1.1.cmml" xref="S4.T3.30.28.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.30.28.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.30.28.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.13"><span class="ltx_text" id="S4.T3.30.28.13.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.14"><span class="ltx_text" id="S4.T3.30.28.14.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.15"><span class="ltx_text" id="S4.T3.30.28.15.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.30.28.16"><span class="ltx_text" id="S4.T3.30.28.16.1" style="color:#0000FF;">–</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.34.32">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.34.32.5">EleutherAI/gpt-neox-20b <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib1" title="">1</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.6">20B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.7"><span class="ltx_text" id="S4.T3.34.32.7.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.8"><span class="ltx_text" id="S4.T3.34.32.8.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.9"><span class="ltx_text" id="S4.T3.34.32.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.31.29.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.31.29.1.m1.1"><semantics id="S4.T3.31.29.1.m1.1a"><mo id="S4.T3.31.29.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.31.29.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.31.29.1.m1.1b"><times id="S4.T3.31.29.1.m1.1.1.cmml" xref="S4.T3.31.29.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.31.29.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.31.29.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.10"><span class="ltx_text" id="S4.T3.34.32.10.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.11"><span class="ltx_text" id="S4.T3.34.32.11.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.32.30.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.32.30.2.m1.1"><semantics id="S4.T3.32.30.2.m1.1a"><mo id="S4.T3.32.30.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.32.30.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.32.30.2.m1.1b"><times id="S4.T3.32.30.2.m1.1.1.cmml" xref="S4.T3.32.30.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.32.30.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.32.30.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.12"><span class="ltx_text" id="S4.T3.34.32.12.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.33.31.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.33.31.3.m1.1"><semantics id="S4.T3.33.31.3.m1.1a"><mo id="S4.T3.33.31.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.33.31.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.33.31.3.m1.1b"><times id="S4.T3.33.31.3.m1.1.1.cmml" xref="S4.T3.33.31.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.33.31.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.33.31.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.4"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.34.32.4.m1.1"><semantics id="S4.T3.34.32.4.m1.1a"><mo id="S4.T3.34.32.4.m1.1.1" mathcolor="#FF0000" xref="S4.T3.34.32.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.34.32.4.m1.1b"><times id="S4.T3.34.32.4.m1.1.1.cmml" xref="S4.T3.34.32.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.34.32.4.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.34.32.4.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.13"><span class="ltx_text" id="S4.T3.34.32.13.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.14"><span class="ltx_text" id="S4.T3.34.32.14.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.15"><span class="ltx_text" id="S4.T3.34.32.15.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.34.32.16"><span class="ltx_text" id="S4.T3.34.32.16.1" style="color:#0000FF;">–</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.37.35">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.37.35.4">bigcode/starcoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib21" title="">21</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.5">15B</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.6"><span class="ltx_text" id="S4.T3.37.35.6.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.7"><span class="ltx_text" id="S4.T3.37.35.7.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.8"><span class="ltx_text" id="S4.T3.37.35.8.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.9"><span class="ltx_text" id="S4.T3.37.35.9.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.10"><span class="ltx_text" id="S4.T3.37.35.10.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.11"><span class="ltx_text" id="S4.T3.37.35.11.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.35.33.1"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.35.33.1.m1.1"><semantics id="S4.T3.35.33.1.m1.1a"><mo id="S4.T3.35.33.1.m1.1.1" mathcolor="#FF0000" xref="S4.T3.35.33.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.35.33.1.m1.1b"><times id="S4.T3.35.33.1.m1.1.1.cmml" xref="S4.T3.35.33.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.35.33.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.35.33.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.12"><span class="ltx_text" id="S4.T3.37.35.12.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.36.34.2"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.36.34.2.m1.1"><semantics id="S4.T3.36.34.2.m1.1a"><mo id="S4.T3.36.34.2.m1.1.1" mathcolor="#FF0000" xref="S4.T3.36.34.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.36.34.2.m1.1b"><times id="S4.T3.36.34.2.m1.1.1.cmml" xref="S4.T3.36.34.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.36.34.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.36.34.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.3"><math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.37.35.3.m1.1"><semantics id="S4.T3.37.35.3.m1.1a"><mo id="S4.T3.37.35.3.m1.1.1" mathcolor="#FF0000" xref="S4.T3.37.35.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.37.35.3.m1.1b"><times id="S4.T3.37.35.3.m1.1.1.cmml" xref="S4.T3.37.35.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.37.35.3.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.37.35.3.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.13"><span class="ltx_text" id="S4.T3.37.35.13.1" style="color:#00FF00;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.14"><span class="ltx_text" id="S4.T3.37.35.14.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.15"><span class="ltx_text" id="S4.T3.37.35.15.1" style="color:#0000FF;">–</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.37.35.16"><span class="ltx_text" id="S4.T3.37.35.16.1" style="color:#0000FF;">–</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS2.SSS3.5.1.1">IV-B</span>3 </span>Hyperparameter tuning</h4>
<div class="ltx_para" id="S4.SS2.SSS3.p1">
<p class="ltx_p" id="S4.SS2.SSS3.p1.4">Before training an XGBoost regressor, one must first set a number of <em class="ltx_emph ltx_font_italic" id="S4.SS2.SSS3.p1.4.1">hyperparameters</em> (HPs), which cannot be tuned as part of the training process but strongly impact the quality of the regressor’s predictions.
For XGBoost, these include the number of boosted trees, their maximum depth, learning rate, subsampling rates, the tree building method, and the number of bins for the histogram tree method.
We tune XGBoost’s HPs via a leave-one-LLM-out cross-validation procedure.
We split the available performance data into the training dataset <math alttext="\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.1.m1.1"><semantics id="S4.SS2.SSS3.p1.1.m1.1a"><msub id="S4.SS2.SSS3.p1.1.m1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS3.p1.1.m1.1.1.2" xref="S4.SS2.SSS3.p1.1.m1.1.1.2.cmml">𝔻</mi><mtext id="S4.SS2.SSS3.p1.1.m1.1.1.3" xref="S4.SS2.SSS3.p1.1.m1.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.1.m1.1b"><apply id="S4.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.2">𝔻</ci><ci id="S4.SS2.SSS3.p1.1.m1.1.1.3a.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.3"><mtext id="S4.SS2.SSS3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSS3.p1.1.m1.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.1.m1.1c">\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.1.m1.1d">blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> used to train the regressor, and the validation dataset <math alttext="\mathbb{D}_{\text{val}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.2.m2.1"><semantics id="S4.SS2.SSS3.p1.2.m2.1a"><msub id="S4.SS2.SSS3.p1.2.m2.1.1" xref="S4.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS3.p1.2.m2.1.1.2" xref="S4.SS2.SSS3.p1.2.m2.1.1.2.cmml">𝔻</mi><mtext id="S4.SS2.SSS3.p1.2.m2.1.1.3" xref="S4.SS2.SSS3.p1.2.m2.1.1.3a.cmml">val</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.2.m2.1b"><apply id="S4.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.2">𝔻</ci><ci id="S4.SS2.SSS3.p1.2.m2.1.1.3a.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.3"><mtext id="S4.SS2.SSS3.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSS3.p1.2.m2.1.1.3">val</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.2.m2.1c">\mathbb{D}_{\text{val}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.2.m2.1d">blackboard_D start_POSTSUBSCRIPT val end_POSTSUBSCRIPT</annotation></semantics></math> used to evaluate the predictions.
Specifically, all performance data from one LLM is used as <math alttext="\mathbb{D}_{\text{val}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.3.m3.1"><semantics id="S4.SS2.SSS3.p1.3.m3.1a"><msub id="S4.SS2.SSS3.p1.3.m3.1.1" xref="S4.SS2.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS3.p1.3.m3.1.1.2" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml">𝔻</mi><mtext id="S4.SS2.SSS3.p1.3.m3.1.1.3" xref="S4.SS2.SSS3.p1.3.m3.1.1.3a.cmml">val</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.3.m3.1b"><apply id="S4.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.2">𝔻</ci><ci id="S4.SS2.SSS3.p1.3.m3.1.1.3a.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.3"><mtext id="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSS3.p1.3.m3.1.1.3">val</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.3.m3.1c">\mathbb{D}_{\text{val}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.3.m3.1d">blackboard_D start_POSTSUBSCRIPT val end_POSTSUBSCRIPT</annotation></semantics></math> and all remaining LLMs act as <math alttext="\mathbb{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.4.m4.1"><semantics id="S4.SS2.SSS3.p1.4.m4.1a"><msub id="S4.SS2.SSS3.p1.4.m4.1.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS3.p1.4.m4.1.1.2" xref="S4.SS2.SSS3.p1.4.m4.1.1.2.cmml">𝔻</mi><mtext id="S4.SS2.SSS3.p1.4.m4.1.1.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.4.m4.1b"><apply id="S4.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.2">𝔻</ci><ci id="S4.SS2.SSS3.p1.4.m4.1.1.3a.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3"><mtext id="S4.SS2.SSS3.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSS3.p1.4.m4.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.4.m4.1c">\mathbb{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.4.m4.1d">blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>.
Finally, we select the configuration of HPs that achieved the lowest average validation error across all possible training/validation splits.
As the error metric, we use the mean absolute percentage error (MAPE) weighted using the sample weights defined in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E4" title="In IV-B2 Regressor ‣ IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">4</span></a>) because it measures the error relative to the latency values, which vary significantly within our data.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS2.SSS4.5.1.1">IV-B</span>4 </span>Final GPU recommendation</h4>
<div class="ltx_para" id="S4.SS2.SSS4.p1">
<p class="ltx_p" id="S4.SS2.SSS4.p1.1">Once the performance model has predicted the latencies for an unseen LLM <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS4.p1.1.m1.1"><semantics id="S4.SS2.SSS4.p1.1.m1.1a"><mi id="S4.SS2.SSS4.p1.1.m1.1.1" xref="S4.SS2.SSS4.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS4.p1.1.m1.1b"><ci id="S4.SS2.SSS4.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS4.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS4.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS4.p1.1.m1.1d">italic_M</annotation></semantics></math> across all GPU profiles and numbers of concurrent users, LLM-Pilot recommends the most cost-effective GPU profile and the number of pods that will safisfy the performance requirements, following Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E1" title="In IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a>)–(<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E3" title="In IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">3</span></a>).
Then, LLM-Pilot can be used to tune the maximum batch weight for that LLM on that GPU profile and to deploy the inference service, as described in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS3" title="III-C Performance data collection ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Analysis and Evaluation</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this Section we analyze and evaluate LLM-Pilot’s workload generator (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS1" title="V-A Workload generator ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-A</span></span></a>), the performance dataset collected using the performance characterization tool (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS2" title="V-B Performance characterization ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-B</span></span></a>), and the GPU recommendation tool (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS3" title="V-C GPU recommendation ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-C</span></span></a>).</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS1.5.1.1">V-A</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS1.6.2">Workload generator</span>
</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">To evaluate the workload generator developed in this work (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2" title="III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>), we analyze: (1) whether the generator’s internal model of requests accurately models the distributions of all parameters describing the traces, (2) whether the preserved correlation between request parameters has any effect on the inference performance, and (3) whether using the workload generator has any benefits over generating requests by drawing random samples from the traces.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS1.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Accurate modelling</h4>
<div class="ltx_para" id="S5.SS1.SSSx1.p1">
<p class="ltx_p" id="S5.SS1.SSSx1.p1.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.F6.sf1" title="In Figure 6 ‣ IV-B2 Regressor ‣ IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">6(a)</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.F6.sf3" title="In Figure 6 ‣ IV-B2 Regressor ‣ IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">6(c)</span></a> we compare the empirical marginal cumulative distribution function (CDF) of selected request parameters to the marginal CDF obtained with the workload generator.
Based on the plots we can conclude that the workload generator preserves the marginal distributions of parameters with both very high and low cardinality.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Parameter correlation</h4>
<div class="ltx_para" id="S5.SS1.SSSx2.p1">
<p class="ltx_p" id="S5.SS1.SSSx2.p1.1">We have conducted an experiment for an example test case (Llama-2-13b running on one A100 80GB GPU) to prove that the correlation between request parameter affects the LLM inference performance.
On average, across 1–128 concurrent users, generating parameter values from independent marginal distributions results in 13% lower throughput (up to 19%), 30% higher median TTFT (up to 98%) and 25% lower median ITL (up to 58%), as compared to generating them based on a joint distribution.
We consider these differences significant enough to justify that modelling request parameters jointly is crucial for the measured performance to reflect what would be observed in production.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Size and sampling speed</h4>
<div class="ltx_para" id="S5.SS1.SSSx3.p1">
<p class="ltx_p" id="S5.SS1.SSSx3.p1.2">Because the parameters are strongly correlated, many combinations of parameters never occur, and their respective multi-dimensional bins are empty.
Consequently, the collection of multi-dimensional bins in the workload generator is sparse, with 46.5 thousand non-empty bins, compared to 10.7 billion theoretically possible combinations of parameter bin assignments.
Thanks to binning the parameter values and sparsity, the workload generator is much smaller in terms of storage space than the traces that it models (<math alttext="&lt;" class="ltx_Math" display="inline" id="S5.SS1.SSSx3.p1.1.m1.1"><semantics id="S5.SS1.SSSx3.p1.1.m1.1a"><mo id="S5.SS1.SSSx3.p1.1.m1.1.1" xref="S5.SS1.SSSx3.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx3.p1.1.m1.1b"><lt id="S5.SS1.SSSx3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSSx3.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx3.p1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSSx3.p1.1.m1.1d">&lt;</annotation></semantics></math>1MB generator, compared to 1.6GB of traces), and will remain approximately the same size even if a much larger amount of traces is collected in the future.
Furthermore, the workload generator produces requests much faster than directly sampling past requests from the traces.
For an example of drawing 1000 samples, sampling requests from traces takes 770ms, while the workload generator produces the requests in 22ms, which is 35<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS1.SSSx3.p1.2.m2.1"><semantics id="S5.SS1.SSSx3.p1.2.m2.1a"><mo id="S5.SS1.SSSx3.p1.2.m2.1.1" xref="S5.SS1.SSSx3.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx3.p1.2.m2.1b"><times id="S5.SS1.SSSx3.p1.2.m2.1.1.cmml" xref="S5.SS1.SSSx3.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx3.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSSx3.p1.2.m2.1d">×</annotation></semantics></math> faster.
It is worth noting that the time needed to generate 1000 requests is lower than the typical ITL of generating a single output token.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS2.5.1.1">V-B</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS2.6.2">Performance characterization</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Using LLM-Pilot’s performance characterization tool, we performed a series of performance measurements using 10 LLMs deployed on 14 GPU profiles (single-GPU or tensor-parallel deployment across 2 or 4 GPUs, with one of 5 GPU types).
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.T3" title="TABLE III ‣ IV-B2 Regressor ‣ IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">III</span></a> presents which combinations of LLMs and GPU profiles were feasible.
For certain combinations it was impossible to collect performance data because the LLM would not fit into the GPU profile’s aggregate memory or because the free space after loading the LLM into memory was insufficient to process the largest requests produced by the workload generator.
Additionally, certain combinations were impossible due to software or hardware constraints.
Specifically, at the time of writing this work TGIS didn’t support tensor parallelism for certain LLMs.
Furthermore, TGIS uses flash attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib8" title="">8</a>]</cite> for some LLMs and therefore these LLMs couldn’t be deployed on the V100 GPUs because of insufficient CUDA capability.</p>
</div>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="334" id="S5.F7.sf1.g1" src="extracted/5895755/data_ttft_throughput.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F7.sf1.3.2" style="font-size:90%;">TTFT vs. throughput</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="333" id="S5.F7.sf2.g1" src="extracted/5895755/data_itl_throughput.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F7.sf2.3.2" style="font-size:90%;">ITL vs. throughput</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="319" id="S5.F7.sf3.g1" src="extracted/5895755/data_itl_throughput_per_dollar.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S5.F7.sf3.3.2" style="font-size:90%;">ITL vs. throughput per cost</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.4.2.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S5.F7.2.1" style="font-size:90%;">Relationship between TTFT, ITL, throughput, and throughput per dollar for google/flan-t5-xxl LLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib6" title="">6</a>]</cite> running on a variety of GPUs. Markers on each curve mark exponentially increasing numbers of users <math alttext="\in\{1,2,4,...,128\}" class="ltx_Math" display="inline" id="S5.F7.2.1.m1.5"><semantics id="S5.F7.2.1.m1.5b"><mrow id="S5.F7.2.1.m1.5.6" xref="S5.F7.2.1.m1.5.6.cmml"><mi id="S5.F7.2.1.m1.5.6.2" xref="S5.F7.2.1.m1.5.6.2.cmml"></mi><mo id="S5.F7.2.1.m1.5.6.1" xref="S5.F7.2.1.m1.5.6.1.cmml">∈</mo><mrow id="S5.F7.2.1.m1.5.6.3.2" xref="S5.F7.2.1.m1.5.6.3.1.cmml"><mo id="S5.F7.2.1.m1.5.6.3.2.1" stretchy="false" xref="S5.F7.2.1.m1.5.6.3.1.cmml">{</mo><mn id="S5.F7.2.1.m1.1.1" xref="S5.F7.2.1.m1.1.1.cmml">1</mn><mo id="S5.F7.2.1.m1.5.6.3.2.2" xref="S5.F7.2.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.F7.2.1.m1.2.2" xref="S5.F7.2.1.m1.2.2.cmml">2</mn><mo id="S5.F7.2.1.m1.5.6.3.2.3" xref="S5.F7.2.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.F7.2.1.m1.3.3" xref="S5.F7.2.1.m1.3.3.cmml">4</mn><mo id="S5.F7.2.1.m1.5.6.3.2.4" xref="S5.F7.2.1.m1.5.6.3.1.cmml">,</mo><mi id="S5.F7.2.1.m1.4.4" mathvariant="normal" xref="S5.F7.2.1.m1.4.4.cmml">…</mi><mo id="S5.F7.2.1.m1.5.6.3.2.5" xref="S5.F7.2.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.F7.2.1.m1.5.5" xref="S5.F7.2.1.m1.5.5.cmml">128</mn><mo id="S5.F7.2.1.m1.5.6.3.2.6" stretchy="false" xref="S5.F7.2.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.2.1.m1.5c"><apply id="S5.F7.2.1.m1.5.6.cmml" xref="S5.F7.2.1.m1.5.6"><in id="S5.F7.2.1.m1.5.6.1.cmml" xref="S5.F7.2.1.m1.5.6.1"></in><csymbol cd="latexml" id="S5.F7.2.1.m1.5.6.2.cmml" xref="S5.F7.2.1.m1.5.6.2">absent</csymbol><set id="S5.F7.2.1.m1.5.6.3.1.cmml" xref="S5.F7.2.1.m1.5.6.3.2"><cn id="S5.F7.2.1.m1.1.1.cmml" type="integer" xref="S5.F7.2.1.m1.1.1">1</cn><cn id="S5.F7.2.1.m1.2.2.cmml" type="integer" xref="S5.F7.2.1.m1.2.2">2</cn><cn id="S5.F7.2.1.m1.3.3.cmml" type="integer" xref="S5.F7.2.1.m1.3.3">4</cn><ci id="S5.F7.2.1.m1.4.4.cmml" xref="S5.F7.2.1.m1.4.4">…</ci><cn id="S5.F7.2.1.m1.5.5.cmml" type="integer" xref="S5.F7.2.1.m1.5.5">128</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.1.m1.5d">\in\{1,2,4,...,128\}</annotation><annotation encoding="application/x-llamapun" id="S5.F7.2.1.m1.5e">∈ { 1 , 2 , 4 , … , 128 }</annotation></semantics></math>.</span></figcaption>
</figure>
<section class="ltx_subsubsection" id="S5.SS2.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Performance data analysis</h4>
<div class="ltx_para" id="S5.SS2.SSSx1.p1">
<p class="ltx_p" id="S5.SS2.SSSx1.p1.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.F7.sf1" title="In Figure 7 ‣ V-B Performance characterization ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">7(a)</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.F7.sf2" title="In Figure 7 ‣ V-B Performance characterization ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">7(b)</span></a> we present the relationship between median latencies (TTFT and ITL) and throughput achieved by an example LLM deployed on various GPU profiles.
As the prompt processing phase is compute bound <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib42" title="">42</a>]</cite>, the typical behavior that we observe across all LLMs is that TTFT increases linearly with the increasing number of concurrent users because the LLM processes a larger batch of requests at the same time.
For weak GPUs with many concurrent users, we can observe a sudden jump of TTFT due to increased queueing time.
On the other hand, the decode phase is memory bandwidth bound <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib42" title="">42</a>]</cite>.
As a result, ITL typically remains stable as the number of concurrent users and throughput increase, until the memory capacity is saturated.
As the number of concurrent users increases further, the ITL increases rapidly, while throughput does not improve anymore.
We can also observe that the larger the total memory capacity of the GPU profile, the larger number of concurrent users marks the point of saturation.
Consequently, GPU profiles with larger memory capacity (and larger maximum batch weights) achieve higher throughput and lower ITL before saturation.</p>
</div>
<div class="ltx_para" id="S5.SS2.SSSx1.p2">
<p class="ltx_p" id="S5.SS2.SSSx1.p2.1">Additionally, in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.F7.sf3" title="In Figure 7 ‣ V-B Performance characterization ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">7(c)</span></a> we present the relationship between median ITL and throughput per dollar for the same LLM.
Throughput per dollar is defined as throughput divided by the cost of the respective GPU profile, and can help quantify the trade-off between the inference performance achieved using various GPU profiles and the cost that they incurred.
As the cost metric, we use hourly on-demand GPU instance prices collected from Amazon Web Services (AWS) pricing tables.
However, the user of LLM-Pilot could also plug in their own pricing table or use any other metric to express their preference for certain GPUs.
The plot demonstrates that the GPU profiles with the highest memory capacity are not necessarily the most cost-effective.
For example, although profiles with H100 GPUs outperform others in terms of maximum throughput, profiles using A100 and T4 GPUs achieve higher throughput per dollar.
However, if the service is subject to a very low latency constraint, many GPU profiles will not deliver on the SLA, even with just one concurrent user.
In such cases, it is necessary to use GPU profiles with higher memory capacity despite their high cost.</p>
</div>
<div class="ltx_para" id="S5.SS2.SSSx1.p3">
<p class="ltx_p" id="S5.SS2.SSSx1.p3.1">To the best of our knowledge, the dataset that we have collected is the first work comparing the performance of many LLMs on a variety of GPUs (discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.SS2" title="VI-B Workload generators and benchmarking tools ‣ VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-B</span></span></a>).
It is also the first dataset in which the maximum batch weight was optimized individually for each GPU profile.
We have made our performance characterization dataset public in the hope that it will benefit the community and extend the efforts towards maximizing the performance of LLM inference.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Characterization overhead</h4>
<div class="ltx_para" id="S5.SS2.SSSx2.p1">
<p class="ltx_p" id="S5.SS2.SSSx2.p1.1">We expect the characterization tool to be used whenever users wish to add support for new LLMs or GPUs, which could happen frequently if support for many novel LLMs is desired.
We estimate that collecting a performance dataset of similar size to ours would take approx. 8h: 5h to tune the maximum batch weights for all LLMs (30min/LLM, parallelized over GPUs), and 3h to run load testing experiments (20min/LLM, parallelized over GPUs).
We note that the characterization tool was designed to be used offline by the cluster administrator, so although its overhead is nonnegligible, it does not disrupt the use of the GPU recommendation tool.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS3.5.1.1">V-C</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS3.6.2">GPU recommendation</span>
</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.7">We evaluate LLM-Pilot’s GPU recommendation tool, and multiple state-of-the-art performance prediction methods, using the performance characterization dataset described in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS2" title="V-B Performance characterization ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-B</span></span></a>.
We simulate a set of “unseen” LLMs, <math alttext="\mathbb{M}_{\text{test}}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">𝕄</mi><mtext id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝕄</ci><ci id="S5.SS3.p1.1.m1.1.1.3a.cmml" xref="S5.SS3.p1.1.m1.1.1.3"><mtext id="S5.SS3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS3.p1.1.m1.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\mathbb{M}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">blackboard_M start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math>, via a nested cross-validation procedure, i.e., by iteratively excluding one LLM <math alttext="M" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_M</annotation></semantics></math> from the performance characterization dataset and assuming its performance is unknown. We then tune the HPs of each method using the cross-validation procedure described in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.SS2.SSS3" title="IV-B3 Hyperparameter tuning ‣ IV-B LLM-Pilot’s solution ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span>3</span></a> using only the performance data collected from the remaining models.
We then use the regressors with tuned HPs to make performance predictions for <math alttext="M" class="ltx_Math" display="inline" id="S5.SS3.p1.3.m3.1"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.3.m3.1d">italic_M</annotation></semantics></math>, and make recommendations.
In the following experiments, we assume that the required total number of concurrent users <math alttext="U=200" class="ltx_Math" display="inline" id="S5.SS3.p1.4.m4.1"><semantics id="S5.SS3.p1.4.m4.1a"><mrow id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml"><mi id="S5.SS3.p1.4.m4.1.1.2" xref="S5.SS3.p1.4.m4.1.1.2.cmml">U</mi><mo id="S5.SS3.p1.4.m4.1.1.1" xref="S5.SS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.4.m4.1.1.3" xref="S5.SS3.p1.4.m4.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><apply id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1"><eq id="S5.SS3.p1.4.m4.1.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1.1"></eq><ci id="S5.SS3.p1.4.m4.1.1.2.cmml" xref="S5.SS3.p1.4.m4.1.1.2">𝑈</ci><cn id="S5.SS3.p1.4.m4.1.1.3.cmml" type="integer" xref="S5.SS3.p1.4.m4.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">U=200</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.4.m4.1d">italic_U = 200</annotation></semantics></math>, the latency constraints on nTTFT and ITL are equal <math alttext="L_{1}=100ms" class="ltx_Math" display="inline" id="S5.SS3.p1.5.m5.1"><semantics id="S5.SS3.p1.5.m5.1a"><mrow id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml"><msub id="S5.SS3.p1.5.m5.1.1.2" xref="S5.SS3.p1.5.m5.1.1.2.cmml"><mi id="S5.SS3.p1.5.m5.1.1.2.2" xref="S5.SS3.p1.5.m5.1.1.2.2.cmml">L</mi><mn id="S5.SS3.p1.5.m5.1.1.2.3" xref="S5.SS3.p1.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS3.p1.5.m5.1.1.1" xref="S5.SS3.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S5.SS3.p1.5.m5.1.1.3" xref="S5.SS3.p1.5.m5.1.1.3.cmml"><mn id="S5.SS3.p1.5.m5.1.1.3.2" xref="S5.SS3.p1.5.m5.1.1.3.2.cmml">100</mn><mo id="S5.SS3.p1.5.m5.1.1.3.1" xref="S5.SS3.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.5.m5.1.1.3.3" xref="S5.SS3.p1.5.m5.1.1.3.3.cmml">m</mi><mo id="S5.SS3.p1.5.m5.1.1.3.1a" xref="S5.SS3.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.5.m5.1.1.3.4" xref="S5.SS3.p1.5.m5.1.1.3.4.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><apply id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1"><eq id="S5.SS3.p1.5.m5.1.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1.1"></eq><apply id="S5.SS3.p1.5.m5.1.1.2.cmml" xref="S5.SS3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.5.m5.1.1.2.1.cmml" xref="S5.SS3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS3.p1.5.m5.1.1.2.2.cmml" xref="S5.SS3.p1.5.m5.1.1.2.2">𝐿</ci><cn id="S5.SS3.p1.5.m5.1.1.2.3.cmml" type="integer" xref="S5.SS3.p1.5.m5.1.1.2.3">1</cn></apply><apply id="S5.SS3.p1.5.m5.1.1.3.cmml" xref="S5.SS3.p1.5.m5.1.1.3"><times id="S5.SS3.p1.5.m5.1.1.3.1.cmml" xref="S5.SS3.p1.5.m5.1.1.3.1"></times><cn id="S5.SS3.p1.5.m5.1.1.3.2.cmml" type="integer" xref="S5.SS3.p1.5.m5.1.1.3.2">100</cn><ci id="S5.SS3.p1.5.m5.1.1.3.3.cmml" xref="S5.SS3.p1.5.m5.1.1.3.3">𝑚</ci><ci id="S5.SS3.p1.5.m5.1.1.3.4.cmml" xref="S5.SS3.p1.5.m5.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">L_{1}=100ms</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.5.m5.1d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 100 italic_m italic_s</annotation></semantics></math> and <math alttext="L_{2}=50ms" class="ltx_Math" display="inline" id="S5.SS3.p1.6.m6.1"><semantics id="S5.SS3.p1.6.m6.1a"><mrow id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml"><msub id="S5.SS3.p1.6.m6.1.1.2" xref="S5.SS3.p1.6.m6.1.1.2.cmml"><mi id="S5.SS3.p1.6.m6.1.1.2.2" xref="S5.SS3.p1.6.m6.1.1.2.2.cmml">L</mi><mn id="S5.SS3.p1.6.m6.1.1.2.3" xref="S5.SS3.p1.6.m6.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS3.p1.6.m6.1.1.1" xref="S5.SS3.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S5.SS3.p1.6.m6.1.1.3" xref="S5.SS3.p1.6.m6.1.1.3.cmml"><mn id="S5.SS3.p1.6.m6.1.1.3.2" xref="S5.SS3.p1.6.m6.1.1.3.2.cmml">50</mn><mo id="S5.SS3.p1.6.m6.1.1.3.1" xref="S5.SS3.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.6.m6.1.1.3.3" xref="S5.SS3.p1.6.m6.1.1.3.3.cmml">m</mi><mo id="S5.SS3.p1.6.m6.1.1.3.1a" xref="S5.SS3.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.6.m6.1.1.3.4" xref="S5.SS3.p1.6.m6.1.1.3.4.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.1b"><apply id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1"><eq id="S5.SS3.p1.6.m6.1.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1.1"></eq><apply id="S5.SS3.p1.6.m6.1.1.2.cmml" xref="S5.SS3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.6.m6.1.1.2.1.cmml" xref="S5.SS3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS3.p1.6.m6.1.1.2.2.cmml" xref="S5.SS3.p1.6.m6.1.1.2.2">𝐿</ci><cn id="S5.SS3.p1.6.m6.1.1.2.3.cmml" type="integer" xref="S5.SS3.p1.6.m6.1.1.2.3">2</cn></apply><apply id="S5.SS3.p1.6.m6.1.1.3.cmml" xref="S5.SS3.p1.6.m6.1.1.3"><times id="S5.SS3.p1.6.m6.1.1.3.1.cmml" xref="S5.SS3.p1.6.m6.1.1.3.1"></times><cn id="S5.SS3.p1.6.m6.1.1.3.2.cmml" type="integer" xref="S5.SS3.p1.6.m6.1.1.3.2">50</cn><ci id="S5.SS3.p1.6.m6.1.1.3.3.cmml" xref="S5.SS3.p1.6.m6.1.1.3.3">𝑚</ci><ci id="S5.SS3.p1.6.m6.1.1.3.4.cmml" xref="S5.SS3.p1.6.m6.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.1c">L_{2}=50ms</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.6.m6.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 50 italic_m italic_s</annotation></semantics></math>, respectively, and the possible numbers of concurrent users per pod <math alttext="u\in\mathbb{U}=\{1,2,4,8,...128\}" class="ltx_Math" display="inline" id="S5.SS3.p1.7.m7.5"><semantics id="S5.SS3.p1.7.m7.5a"><mrow id="S5.SS3.p1.7.m7.5.5" xref="S5.SS3.p1.7.m7.5.5.cmml"><mi id="S5.SS3.p1.7.m7.5.5.3" xref="S5.SS3.p1.7.m7.5.5.3.cmml">u</mi><mo id="S5.SS3.p1.7.m7.5.5.4" xref="S5.SS3.p1.7.m7.5.5.4.cmml">∈</mo><mi id="S5.SS3.p1.7.m7.5.5.5" xref="S5.SS3.p1.7.m7.5.5.5.cmml">𝕌</mi><mo id="S5.SS3.p1.7.m7.5.5.6" xref="S5.SS3.p1.7.m7.5.5.6.cmml">=</mo><mrow id="S5.SS3.p1.7.m7.5.5.1.1" xref="S5.SS3.p1.7.m7.5.5.1.2.cmml"><mo id="S5.SS3.p1.7.m7.5.5.1.1.2" stretchy="false" xref="S5.SS3.p1.7.m7.5.5.1.2.cmml">{</mo><mn id="S5.SS3.p1.7.m7.1.1" xref="S5.SS3.p1.7.m7.1.1.cmml">1</mn><mo id="S5.SS3.p1.7.m7.5.5.1.1.3" xref="S5.SS3.p1.7.m7.5.5.1.2.cmml">,</mo><mn id="S5.SS3.p1.7.m7.2.2" xref="S5.SS3.p1.7.m7.2.2.cmml">2</mn><mo id="S5.SS3.p1.7.m7.5.5.1.1.4" xref="S5.SS3.p1.7.m7.5.5.1.2.cmml">,</mo><mn id="S5.SS3.p1.7.m7.3.3" xref="S5.SS3.p1.7.m7.3.3.cmml">4</mn><mo id="S5.SS3.p1.7.m7.5.5.1.1.5" xref="S5.SS3.p1.7.m7.5.5.1.2.cmml">,</mo><mn id="S5.SS3.p1.7.m7.4.4" xref="S5.SS3.p1.7.m7.4.4.cmml">8</mn><mo id="S5.SS3.p1.7.m7.5.5.1.1.6" xref="S5.SS3.p1.7.m7.5.5.1.2.cmml">,</mo><mrow id="S5.SS3.p1.7.m7.5.5.1.1.1" xref="S5.SS3.p1.7.m7.5.5.1.1.1.cmml"><mi id="S5.SS3.p1.7.m7.5.5.1.1.1.2" mathvariant="normal" xref="S5.SS3.p1.7.m7.5.5.1.1.1.2.cmml">…</mi><mo id="S5.SS3.p1.7.m7.5.5.1.1.1.1" xref="S5.SS3.p1.7.m7.5.5.1.1.1.1.cmml">⁢</mo><mn id="S5.SS3.p1.7.m7.5.5.1.1.1.3" xref="S5.SS3.p1.7.m7.5.5.1.1.1.3.cmml">128</mn></mrow><mo id="S5.SS3.p1.7.m7.5.5.1.1.7" stretchy="false" xref="S5.SS3.p1.7.m7.5.5.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.7.m7.5b"><apply id="S5.SS3.p1.7.m7.5.5.cmml" xref="S5.SS3.p1.7.m7.5.5"><and id="S5.SS3.p1.7.m7.5.5a.cmml" xref="S5.SS3.p1.7.m7.5.5"></and><apply id="S5.SS3.p1.7.m7.5.5b.cmml" xref="S5.SS3.p1.7.m7.5.5"><in id="S5.SS3.p1.7.m7.5.5.4.cmml" xref="S5.SS3.p1.7.m7.5.5.4"></in><ci id="S5.SS3.p1.7.m7.5.5.3.cmml" xref="S5.SS3.p1.7.m7.5.5.3">𝑢</ci><ci id="S5.SS3.p1.7.m7.5.5.5.cmml" xref="S5.SS3.p1.7.m7.5.5.5">𝕌</ci></apply><apply id="S5.SS3.p1.7.m7.5.5c.cmml" xref="S5.SS3.p1.7.m7.5.5"><eq id="S5.SS3.p1.7.m7.5.5.6.cmml" xref="S5.SS3.p1.7.m7.5.5.6"></eq><share href="https://arxiv.org/html/2410.02425v1#S5.SS3.p1.7.m7.5.5.5.cmml" id="S5.SS3.p1.7.m7.5.5d.cmml" xref="S5.SS3.p1.7.m7.5.5"></share><set id="S5.SS3.p1.7.m7.5.5.1.2.cmml" xref="S5.SS3.p1.7.m7.5.5.1.1"><cn id="S5.SS3.p1.7.m7.1.1.cmml" type="integer" xref="S5.SS3.p1.7.m7.1.1">1</cn><cn id="S5.SS3.p1.7.m7.2.2.cmml" type="integer" xref="S5.SS3.p1.7.m7.2.2">2</cn><cn id="S5.SS3.p1.7.m7.3.3.cmml" type="integer" xref="S5.SS3.p1.7.m7.3.3">4</cn><cn id="S5.SS3.p1.7.m7.4.4.cmml" type="integer" xref="S5.SS3.p1.7.m7.4.4">8</cn><apply id="S5.SS3.p1.7.m7.5.5.1.1.1.cmml" xref="S5.SS3.p1.7.m7.5.5.1.1.1"><times id="S5.SS3.p1.7.m7.5.5.1.1.1.1.cmml" xref="S5.SS3.p1.7.m7.5.5.1.1.1.1"></times><ci id="S5.SS3.p1.7.m7.5.5.1.1.1.2.cmml" xref="S5.SS3.p1.7.m7.5.5.1.1.1.2">…</ci><cn id="S5.SS3.p1.7.m7.5.5.1.1.1.3.cmml" type="integer" xref="S5.SS3.p1.7.m7.5.5.1.1.1.3">128</cn></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.5c">u\in\mathbb{U}=\{1,2,4,8,...128\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.7.m7.5d">italic_u ∈ blackboard_U = { 1 , 2 , 4 , 8 , … 128 }</annotation></semantics></math>.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS3.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Evaluation metrics</h4>
<div class="ltx_para" id="S5.SS3.SSSx1.p1">
<p class="ltx_p" id="S5.SS3.SSSx1.p1.8">In order to evaluate LLM-Pilot’s ability to solve problem (<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E1" title="In IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a>), we have defined three evaluation metrics.
The first evaluation metric is <span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx1.p1.8.1">success rate</span> <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.1.m1.1"><semantics id="S5.SS3.SSSx1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.1.m1.1.1" xref="S5.SS3.SSSx1.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.1.m1.1b"><ci id="S5.SS3.SSSx1.p1.1.m1.1.1.cmml" xref="S5.SS3.SSSx1.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.1.m1.1d">caligraphic_S</annotation></semantics></math>.
The recommendation for LLM <math alttext="M\in\mathbb{M}_{\text{test}}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.2.m2.1"><semantics id="S5.SS3.SSSx1.p1.2.m2.1a"><mrow id="S5.SS3.SSSx1.p1.2.m2.1.1" xref="S5.SS3.SSSx1.p1.2.m2.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.2.m2.1.1.2" xref="S5.SS3.SSSx1.p1.2.m2.1.1.2.cmml">M</mi><mo id="S5.SS3.SSSx1.p1.2.m2.1.1.1" xref="S5.SS3.SSSx1.p1.2.m2.1.1.1.cmml">∈</mo><msub id="S5.SS3.SSSx1.p1.2.m2.1.1.3" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3.cmml"><mi id="S5.SS3.SSSx1.p1.2.m2.1.1.3.2" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3.2.cmml">𝕄</mi><mtext id="S5.SS3.SSSx1.p1.2.m2.1.1.3.3" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3.3a.cmml">test</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.2.m2.1b"><apply id="S5.SS3.SSSx1.p1.2.m2.1.1.cmml" xref="S5.SS3.SSSx1.p1.2.m2.1.1"><in id="S5.SS3.SSSx1.p1.2.m2.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.2.m2.1.1.1"></in><ci id="S5.SS3.SSSx1.p1.2.m2.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.2.m2.1.1.2">𝑀</ci><apply id="S5.SS3.SSSx1.p1.2.m2.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.2.m2.1.1.3.1.cmml" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.2.m2.1.1.3.2.cmml" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3.2">𝕄</ci><ci id="S5.SS3.SSSx1.p1.2.m2.1.1.3.3a.cmml" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3.3"><mtext id="S5.SS3.SSSx1.p1.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S5.SS3.SSSx1.p1.2.m2.1.1.3.3">test</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.2.m2.1c">M\in\mathbb{M}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.2.m2.1d">italic_M ∈ blackboard_M start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math> is considered a success <math alttext="\mathcal{S}_{M}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.3.m3.1"><semantics id="S5.SS3.SSSx1.p1.3.m3.1a"><msub id="S5.SS3.SSSx1.p1.3.m3.1.1" xref="S5.SS3.SSSx1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.3.m3.1.1.2" xref="S5.SS3.SSSx1.p1.3.m3.1.1.2.cmml">𝒮</mi><mi id="S5.SS3.SSSx1.p1.3.m3.1.1.3" xref="S5.SS3.SSSx1.p1.3.m3.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.3.m3.1b"><apply id="S5.SS3.SSSx1.p1.3.m3.1.1.cmml" xref="S5.SS3.SSSx1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.3.m3.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.3.m3.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.3.m3.1.1.2">𝒮</ci><ci id="S5.SS3.SSSx1.p1.3.m3.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.3.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.3.m3.1c">\mathcal{S}_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.3.m3.1d">caligraphic_S start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> if, after the user has followed the tool’s suggestion and deployed <math alttext="n" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.4.m4.1"><semantics id="S5.SS3.SSSx1.p1.4.m4.1a"><mi id="S5.SS3.SSSx1.p1.4.m4.1.1" xref="S5.SS3.SSSx1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.4.m4.1b"><ci id="S5.SS3.SSSx1.p1.4.m4.1.1.cmml" xref="S5.SS3.SSSx1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.4.m4.1d">italic_n</annotation></semantics></math> pods with the GPU profile <math alttext="G^{\star}\!\left(M\big{|}\mathbb{D}_{\text{train}}\right)" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.5.m5.1"><semantics id="S5.SS3.SSSx1.p1.5.m5.1a"><mrow id="S5.SS3.SSSx1.p1.5.m5.1.1" xref="S5.SS3.SSSx1.p1.5.m5.1.1.cmml"><msup id="S5.SS3.SSSx1.p1.5.m5.1.1.3" xref="S5.SS3.SSSx1.p1.5.m5.1.1.3.cmml"><mi id="S5.SS3.SSSx1.p1.5.m5.1.1.3.2" xref="S5.SS3.SSSx1.p1.5.m5.1.1.3.2.cmml">G</mi><mo id="S5.SS3.SSSx1.p1.5.m5.1.1.3.3" xref="S5.SS3.SSSx1.p1.5.m5.1.1.3.3.cmml">⋆</mo></msup><mo id="S5.SS3.SSSx1.p1.5.m5.1.1.2" xref="S5.SS3.SSSx1.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.2" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.2" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.2.cmml">M</mi><mo fence="false" id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.1" mathsize="120%" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.1.cmml">|</mo><msub id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.cmml"><mi id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.2" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.3" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.3" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.5.m5.1b"><apply id="S5.SS3.SSSx1.p1.5.m5.1.1.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1"><times id="S5.SS3.SSSx1.p1.5.m5.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.2"></times><apply id="S5.SS3.SSSx1.p1.5.m5.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.5.m5.1.1.3.1.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S5.SS3.SSSx1.p1.5.m5.1.1.3.2.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.3.2">𝐺</ci><ci id="S5.SS3.SSSx1.p1.5.m5.1.1.3.3.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.3.3">⋆</ci></apply><apply id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.2">𝑀</ci><apply id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.1.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.2.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.2">𝔻</ci><ci id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.3a.cmml" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.3"><mtext id="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S5.SS3.SSSx1.p1.5.m5.1.1.1.1.1.3.3">train</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.5.m5.1c">G^{\star}\!\left(M\big{|}\mathbb{D}_{\text{train}}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.5.m5.1d">italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ( italic_M | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT )</annotation></semantics></math> (denoted as <math alttext="G^{\star}_{M}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.6.m6.1"><semantics id="S5.SS3.SSSx1.p1.6.m6.1a"><msubsup id="S5.SS3.SSSx1.p1.6.m6.1.1" xref="S5.SS3.SSSx1.p1.6.m6.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.6.m6.1.1.2.2" xref="S5.SS3.SSSx1.p1.6.m6.1.1.2.2.cmml">G</mi><mi id="S5.SS3.SSSx1.p1.6.m6.1.1.3" xref="S5.SS3.SSSx1.p1.6.m6.1.1.3.cmml">M</mi><mo id="S5.SS3.SSSx1.p1.6.m6.1.1.2.3" xref="S5.SS3.SSSx1.p1.6.m6.1.1.2.3.cmml">⋆</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.6.m6.1b"><apply id="S5.SS3.SSSx1.p1.6.m6.1.1.cmml" xref="S5.SS3.SSSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.6.m6.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.6.m6.1.1">subscript</csymbol><apply id="S5.SS3.SSSx1.p1.6.m6.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.6.m6.1.1.2.1.cmml" xref="S5.SS3.SSSx1.p1.6.m6.1.1">superscript</csymbol><ci id="S5.SS3.SSSx1.p1.6.m6.1.1.2.2.cmml" xref="S5.SS3.SSSx1.p1.6.m6.1.1.2.2">𝐺</ci><ci id="S5.SS3.SSSx1.p1.6.m6.1.1.2.3.cmml" xref="S5.SS3.SSSx1.p1.6.m6.1.1.2.3">⋆</ci></apply><ci id="S5.SS3.SSSx1.p1.6.m6.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.6.m6.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.6.m6.1c">G^{\star}_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.6.m6.1d">italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> for brevity), the true performance of the inference service did in fact meet their initial requirements regarding the total number of concurrent users <math alttext="U" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.7.m7.1"><semantics id="S5.SS3.SSSx1.p1.7.m7.1a"><mi id="S5.SS3.SSSx1.p1.7.m7.1.1" xref="S5.SS3.SSSx1.p1.7.m7.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.7.m7.1b"><ci id="S5.SS3.SSSx1.p1.7.m7.1.1.cmml" xref="S5.SS3.SSSx1.p1.7.m7.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.7.m7.1c">U</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.7.m7.1d">italic_U</annotation></semantics></math> and latency constraints <math alttext="L" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.8.m8.1"><semantics id="S5.SS3.SSSx1.p1.8.m8.1a"><mi id="S5.SS3.SSSx1.p1.8.m8.1.1" xref="S5.SS3.SSSx1.p1.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.8.m8.1b"><ci id="S5.SS3.SSSx1.p1.8.m8.1.1.cmml" xref="S5.SS3.SSSx1.p1.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.8.m8.1d">italic_L</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{S}_{M}\!=\!\Bigg{\{}\!\!\!\begin{array}[]{l}1\ \text{if}\ n\!\left(M,%
G^{\star}_{M}\big{|}\mathbb{D}_{\text{train}}\right)\!\cdot\!\hat{u}_{\text{%
max}}\!\left(M,G^{\star}_{M}\big{|}\mathbb{D}_{M}\right)\geq U,\\
0\ \text{otherwise.}\end{array}" class="ltx_Math" display="block" id="S5.E5.m1.3"><semantics id="S5.E5.m1.3a"><mrow id="S5.E5.m1.3.4" xref="S5.E5.m1.3.4.cmml"><msub id="S5.E5.m1.3.4.2" xref="S5.E5.m1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E5.m1.3.4.2.2" xref="S5.E5.m1.3.4.2.2.cmml">𝒮</mi><mi id="S5.E5.m1.3.4.2.3" xref="S5.E5.m1.3.4.2.3.cmml">M</mi></msub><mo id="S5.E5.m1.3.4.1" lspace="0.108em" rspace="0.108em" xref="S5.E5.m1.3.4.1.cmml">=</mo><mrow id="S5.E5.m1.3.4.3.2" xref="S5.E5.m1.3.4.3.1.cmml"><mpadded width="0em"><mo id="S5.E5.m1.3.4.3.2.1" maxsize="260%" minsize="260%" xref="S5.E5.m1.3.4.3.1.1.cmml">{</mo></mpadded><mtable displaystyle="true" id="S5.E5.m1.3.3" rowspacing="0pt" xref="S5.E5.m1.3.3.cmml"><mtr id="S5.E5.m1.3.3a" xref="S5.E5.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S5.E5.m1.3.3b" xref="S5.E5.m1.3.3.cmml"><mrow id="S5.E5.m1.3.3.3.3.3.3" xref="S5.E5.m1.3.3.3.3.3.3.1.cmml"><mrow id="S5.E5.m1.3.3.3.3.3.3.1" xref="S5.E5.m1.3.3.3.3.3.3.1.cmml"><mrow id="S5.E5.m1.3.3.3.3.3.3.1.2" xref="S5.E5.m1.3.3.3.3.3.3.1.2.cmml"><mrow id="S5.E5.m1.3.3.3.3.3.3.1.1.1" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.cmml"><mrow id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.cmml"><mn id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.3.cmml">1</mn><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2" lspace="0.500em" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mtext id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.4" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.4a.cmml">if</mtext><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2a" lspace="0.500em" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mpadded width="0.430em"><mi id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.5" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.5.cmml">n</mi></mpadded><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2b" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2.cmml"><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.2" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S5.E5.m1.1.1.1.1.1.1" xref="S5.E5.m1.1.1.1.1.1.1.cmml">M</mi><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2.cmml">,</mo><mrow id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml"><msubsup id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.2" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.2.cmml">G</mi><mi id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.3.cmml">M</mi><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.3.cmml">⋆</mo></msubsup><mo fence="false" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.1" mathsize="120%" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.2" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml">𝔻</mi><mtext id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.4" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.2" lspace="0.052em" rspace="0.052em" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.2.cmml">⋅</mo><msub id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.cmml"><mover accent="true" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.cmml"><mi id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.2" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.2.cmml">u</mi><mo id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.1" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.1.cmml">^</mo></mover><mtext id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.3" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.3a.cmml">max</mtext></msub></mrow><mo id="S5.E5.m1.3.3.3.3.3.3.1.2.3" xref="S5.E5.m1.3.3.3.3.3.3.1.2.3.cmml">⁢</mo><mrow id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.2.cmml"><mo id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.2" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.2.cmml">(</mo><mi id="S5.E5.m1.2.2.2.2.2.2" xref="S5.E5.m1.2.2.2.2.2.2.cmml">M</mi><mo id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.3" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.2.cmml">,</mo><mrow id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.cmml"><msubsup id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.cmml"><mi id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.2" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.2.cmml">G</mi><mi id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.3" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.3.cmml">M</mi><mo id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.3" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.3.cmml">⋆</mo></msubsup><mo fence="false" id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.1" mathsize="120%" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.1.cmml">|</mo><msub id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.cmml"><mi id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.2" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.2.cmml">𝔻</mi><mi id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.3" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.4" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S5.E5.m1.3.3.3.3.3.3.1.3" xref="S5.E5.m1.3.3.3.3.3.3.1.3.cmml">≥</mo><mi id="S5.E5.m1.3.3.3.3.3.3.1.4" xref="S5.E5.m1.3.3.3.3.3.3.1.4.cmml">U</mi></mrow><mo id="S5.E5.m1.3.3.3.3.3.3.2" xref="S5.E5.m1.3.3.3.3.3.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S5.E5.m1.3.3c" xref="S5.E5.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S5.E5.m1.3.3d" xref="S5.E5.m1.3.3.cmml"><mrow id="S5.E5.m1.3.3.4.1.1" xref="S5.E5.m1.3.3.4.1.1.cmml"><mn id="S5.E5.m1.3.3.4.1.1.2" xref="S5.E5.m1.3.3.4.1.1.2.cmml">0</mn><mo id="S5.E5.m1.3.3.4.1.1.1" lspace="0.500em" xref="S5.E5.m1.3.3.4.1.1.1.cmml">⁢</mo><mtext id="S5.E5.m1.3.3.4.1.1.3" xref="S5.E5.m1.3.3.4.1.1.3a.cmml">otherwise.</mtext></mrow></mtd></mtr></mtable><mi id="S5.E5.m1.3.4.3.2.2" xref="S5.E5.m1.3.4.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E5.m1.3b"><apply id="S5.E5.m1.3.4.cmml" xref="S5.E5.m1.3.4"><eq id="S5.E5.m1.3.4.1.cmml" xref="S5.E5.m1.3.4.1"></eq><apply id="S5.E5.m1.3.4.2.cmml" xref="S5.E5.m1.3.4.2"><csymbol cd="ambiguous" id="S5.E5.m1.3.4.2.1.cmml" xref="S5.E5.m1.3.4.2">subscript</csymbol><ci id="S5.E5.m1.3.4.2.2.cmml" xref="S5.E5.m1.3.4.2.2">𝒮</ci><ci id="S5.E5.m1.3.4.2.3.cmml" xref="S5.E5.m1.3.4.2.3">𝑀</ci></apply><apply id="S5.E5.m1.3.4.3.1.cmml" xref="S5.E5.m1.3.4.3.2"><csymbol cd="latexml" id="S5.E5.m1.3.4.3.1.1.cmml" xref="S5.E5.m1.3.4.3.2.1">cases</csymbol><matrix id="S5.E5.m1.3.3.cmml" xref="S5.E5.m1.3.3"><matrixrow id="S5.E5.m1.3.3a.cmml" xref="S5.E5.m1.3.3"><apply id="S5.E5.m1.3.3.3.3.3.3.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3"><geq id="S5.E5.m1.3.3.3.3.3.3.1.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.3"></geq><apply id="S5.E5.m1.3.3.3.3.3.3.1.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2"><times id="S5.E5.m1.3.3.3.3.3.3.1.2.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.3"></times><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1"><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.2">⋅</ci><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1"><times id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.2"></times><cn id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.3.cmml" type="integer" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.3">1</cn><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.4a.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.4"><mtext id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.4.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.4">if</mtext></ci><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.5.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.5">𝑛</ci><interval closure="open" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1"><ci id="S5.E5.m1.1.1.1.1.1.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1">𝑀</ci><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.2">𝐺</ci><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.2.3">⋆</ci></apply><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.2">𝔻</ci><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.3a.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.3"><mtext id="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.3.3">train</mtext></ci></apply></apply></interval></apply><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3">subscript</csymbol><apply id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2"><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.1">^</ci><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.2.2">𝑢</ci></apply><ci id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.3a.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.3"><mtext id="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.3.cmml" mathsize="70%" xref="S5.E5.m1.3.3.3.3.3.3.1.1.1.3.3">max</mtext></ci></apply></apply><interval closure="open" id="S5.E5.m1.3.3.3.3.3.3.1.2.2.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1"><ci id="S5.E5.m1.2.2.2.2.2.2.cmml" xref="S5.E5.m1.2.2.2.2.2.2">𝑀</ci><apply id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1"><csymbol cd="latexml" id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.1">conditional</csymbol><apply id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2">subscript</csymbol><apply id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2">superscript</csymbol><ci id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.2">𝐺</ci><ci id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.2.3">⋆</ci></apply><ci id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.2.3">𝑀</ci></apply><apply id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.1.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3">subscript</csymbol><ci id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.2.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.2">𝔻</ci><ci id="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.3.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.2.2.1.1.3.3">𝑀</ci></apply></apply></interval></apply><ci id="S5.E5.m1.3.3.3.3.3.3.1.4.cmml" xref="S5.E5.m1.3.3.3.3.3.3.1.4">𝑈</ci></apply></matrixrow><matrixrow id="S5.E5.m1.3.3b.cmml" xref="S5.E5.m1.3.3"><apply id="S5.E5.m1.3.3.4.1.1.cmml" xref="S5.E5.m1.3.3.4.1.1"><times id="S5.E5.m1.3.3.4.1.1.1.cmml" xref="S5.E5.m1.3.3.4.1.1.1"></times><cn id="S5.E5.m1.3.3.4.1.1.2.cmml" type="integer" xref="S5.E5.m1.3.3.4.1.1.2">0</cn><ci id="S5.E5.m1.3.3.4.1.1.3a.cmml" xref="S5.E5.m1.3.3.4.1.1.3"><mtext id="S5.E5.m1.3.3.4.1.1.3.cmml" xref="S5.E5.m1.3.3.4.1.1.3">otherwise.</mtext></ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E5.m1.3c">\mathcal{S}_{M}\!=\!\Bigg{\{}\!\!\!\begin{array}[]{l}1\ \text{if}\ n\!\left(M,%
G^{\star}_{M}\big{|}\mathbb{D}_{\text{train}}\right)\!\cdot\!\hat{u}_{\text{%
max}}\!\left(M,G^{\star}_{M}\big{|}\mathbb{D}_{M}\right)\geq U,\\
0\ \text{otherwise.}\end{array}</annotation><annotation encoding="application/x-llamapun" id="S5.E5.m1.3d">caligraphic_S start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL 1 if italic_n ( italic_M , italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT | blackboard_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) ⋅ over^ start_ARG italic_u end_ARG start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( italic_M , italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) ≥ italic_U , end_CELL end_ROW start_ROW start_CELL 0 otherwise. end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.SSSx1.p1.21">where <math alttext="\hat{u}_{\text{max}}\!\left(M,\!G^{\star}_{M}\big{|}\mathbb{D}_{M}\right)" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.9.m1.2"><semantics id="S5.SS3.SSSx1.p1.9.m1.2a"><mrow id="S5.SS3.SSSx1.p1.9.m1.2.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.cmml"><msub id="S5.SS3.SSSx1.p1.9.m1.2.2.3" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.cmml"><mover accent="true" id="S5.SS3.SSSx1.p1.9.m1.2.2.3.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.cmml"><mi id="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.2.cmml">u</mi><mo id="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.1" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.1.cmml">^</mo></mover><mtext id="S5.SS3.SSSx1.p1.9.m1.2.2.3.3" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.3a.cmml">max</mtext></msub><mo id="S5.SS3.SSSx1.p1.9.m1.2.2.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.2.cmml">⁢</mo><mrow id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.2.cmml"><mo id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.2.cmml">(</mo><mi id="S5.SS3.SSSx1.p1.9.m1.1.1" xref="S5.SS3.SSSx1.p1.9.m1.1.1.cmml">M</mi><mpadded width="0.275em"><mo id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.3" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.2.cmml">,</mo></mpadded><mrow id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.cmml"><msubsup id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.cmml"><mi id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.2.cmml">G</mi><mi id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.3" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.3.cmml">M</mi><mo id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.3" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.3.cmml">⋆</mo></msubsup><mo fence="false" id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.1" mathsize="120%" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.1.cmml">|</mo><msub id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.cmml"><mi id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.2" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.2.cmml">𝔻</mi><mi id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.3" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.4" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.9.m1.2b"><apply id="S5.SS3.SSSx1.p1.9.m1.2.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2"><times id="S5.SS3.SSSx1.p1.9.m1.2.2.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.2"></times><apply id="S5.SS3.SSSx1.p1.9.m1.2.2.3.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.9.m1.2.2.3.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3">subscript</csymbol><apply id="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.2"><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.1">^</ci><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.2.2">𝑢</ci></apply><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.3.3a.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.3"><mtext id="S5.SS3.SSSx1.p1.9.m1.2.2.3.3.cmml" mathsize="70%" xref="S5.SS3.SSSx1.p1.9.m1.2.2.3.3">max</mtext></ci></apply><interval closure="open" id="S5.SS3.SSSx1.p1.9.m1.2.2.1.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1"><ci id="S5.SS3.SSSx1.p1.9.m1.1.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.1.1">𝑀</ci><apply id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1"><csymbol cd="latexml" id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.1">conditional</csymbol><apply id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2">subscript</csymbol><apply id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2">superscript</csymbol><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.2">𝐺</ci><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.3.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.2.3">⋆</ci></apply><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.3.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.2.3">𝑀</ci></apply><apply id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.1.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.2.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.2">𝔻</ci><ci id="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.3.cmml" xref="S5.SS3.SSSx1.p1.9.m1.2.2.1.1.1.3.3">𝑀</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.9.m1.2c">\hat{u}_{\text{max}}\!\left(M,\!G^{\star}_{M}\big{|}\mathbb{D}_{M}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.9.m1.2d">over^ start_ARG italic_u end_ARG start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( italic_M , italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the true maximum number of concurrent users that can be served within a single pod with the GPU profile <math alttext="G^{\star}_{M}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.10.m2.1"><semantics id="S5.SS3.SSSx1.p1.10.m2.1a"><msubsup id="S5.SS3.SSSx1.p1.10.m2.1.1" xref="S5.SS3.SSSx1.p1.10.m2.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.10.m2.1.1.2.2" xref="S5.SS3.SSSx1.p1.10.m2.1.1.2.2.cmml">G</mi><mi id="S5.SS3.SSSx1.p1.10.m2.1.1.3" xref="S5.SS3.SSSx1.p1.10.m2.1.1.3.cmml">M</mi><mo id="S5.SS3.SSSx1.p1.10.m2.1.1.2.3" xref="S5.SS3.SSSx1.p1.10.m2.1.1.2.3.cmml">⋆</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.10.m2.1b"><apply id="S5.SS3.SSSx1.p1.10.m2.1.1.cmml" xref="S5.SS3.SSSx1.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.10.m2.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.10.m2.1.1">subscript</csymbol><apply id="S5.SS3.SSSx1.p1.10.m2.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.10.m2.1.1.2.1.cmml" xref="S5.SS3.SSSx1.p1.10.m2.1.1">superscript</csymbol><ci id="S5.SS3.SSSx1.p1.10.m2.1.1.2.2.cmml" xref="S5.SS3.SSSx1.p1.10.m2.1.1.2.2">𝐺</ci><ci id="S5.SS3.SSSx1.p1.10.m2.1.1.2.3.cmml" xref="S5.SS3.SSSx1.p1.10.m2.1.1.2.3">⋆</ci></apply><ci id="S5.SS3.SSSx1.p1.10.m2.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.10.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.10.m2.1c">G^{\star}_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.10.m2.1d">italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> without violating the latency constraints <math alttext="L" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.11.m3.1"><semantics id="S5.SS3.SSSx1.p1.11.m3.1a"><mi id="S5.SS3.SSSx1.p1.11.m3.1.1" xref="S5.SS3.SSSx1.p1.11.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.11.m3.1b"><ci id="S5.SS3.SSSx1.p1.11.m3.1.1.cmml" xref="S5.SS3.SSSx1.p1.11.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.11.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.11.m3.1d">italic_L</annotation></semantics></math> which could be determined if the real performance data <math alttext="\mathbb{D}_{M}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.12.m4.1"><semantics id="S5.SS3.SSSx1.p1.12.m4.1a"><msub id="S5.SS3.SSSx1.p1.12.m4.1.1" xref="S5.SS3.SSSx1.p1.12.m4.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.12.m4.1.1.2" xref="S5.SS3.SSSx1.p1.12.m4.1.1.2.cmml">𝔻</mi><mi id="S5.SS3.SSSx1.p1.12.m4.1.1.3" xref="S5.SS3.SSSx1.p1.12.m4.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.12.m4.1b"><apply id="S5.SS3.SSSx1.p1.12.m4.1.1.cmml" xref="S5.SS3.SSSx1.p1.12.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.12.m4.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.12.m4.1.1">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.12.m4.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.12.m4.1.1.2">𝔻</ci><ci id="S5.SS3.SSSx1.p1.12.m4.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.12.m4.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.12.m4.1c">\mathbb{D}_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.12.m4.1d">blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> of LLM <math alttext="M" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.13.m5.1"><semantics id="S5.SS3.SSSx1.p1.13.m5.1a"><mi id="S5.SS3.SSSx1.p1.13.m5.1.1" xref="S5.SS3.SSSx1.p1.13.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.13.m5.1b"><ci id="S5.SS3.SSSx1.p1.13.m5.1.1.cmml" xref="S5.SS3.SSSx1.p1.13.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.13.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.13.m5.1d">italic_M</annotation></semantics></math> was known.
To balance the success rate, in successful cases <math alttext="\mathbb{M}_{\text{test}}^{\mathcal{S}}=\{M\in\mathbb{M}_{\text{test}}:\mathcal%
{S}_{M}=1\}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.14.m6.2"><semantics id="S5.SS3.SSSx1.p1.14.m6.2a"><mrow id="S5.SS3.SSSx1.p1.14.m6.2.2" xref="S5.SS3.SSSx1.p1.14.m6.2.2.cmml"><msubsup id="S5.SS3.SSSx1.p1.14.m6.2.2.4" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.cmml"><mi id="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.2" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.2.cmml">𝕄</mi><mtext id="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.3" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.3a.cmml">test</mtext><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.14.m6.2.2.4.3" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.3.cmml">𝒮</mi></msubsup><mo id="S5.SS3.SSSx1.p1.14.m6.2.2.3" xref="S5.SS3.SSSx1.p1.14.m6.2.2.3.cmml">=</mo><mrow id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.3.cmml"><mo id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.3" stretchy="false" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.3.1.cmml">{</mo><mrow id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.2" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.2.cmml">M</mi><mo id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.1" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.1.cmml">∈</mo><msub id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.cmml"><mi id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.2" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.2.cmml">𝕄</mi><mtext id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.3" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.3a.cmml">test</mtext></msub></mrow><mo id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.3.1.cmml">:</mo><mrow id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.cmml"><msub id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.2" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.2.cmml">𝒮</mi><mi id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.3" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.3.cmml">M</mi></msub><mo id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.1" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.1.cmml">=</mo><mn id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.3" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.5" stretchy="false" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.14.m6.2b"><apply id="S5.SS3.SSSx1.p1.14.m6.2.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2"><eq id="S5.SS3.SSSx1.p1.14.m6.2.2.3.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.3"></eq><apply id="S5.SS3.SSSx1.p1.14.m6.2.2.4.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.14.m6.2.2.4.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4">superscript</csymbol><apply id="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.2">𝕄</ci><ci id="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.3a.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.3"><mtext id="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.3.cmml" mathsize="70%" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.2.3">test</mtext></ci></apply><ci id="S5.SS3.SSSx1.p1.14.m6.2.2.4.3.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.4.3">𝒮</ci></apply><apply id="S5.SS3.SSSx1.p1.14.m6.2.2.2.3.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2"><csymbol cd="latexml" id="S5.SS3.SSSx1.p1.14.m6.2.2.2.3.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.3">conditional-set</csymbol><apply id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1"><in id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.1"></in><ci id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.2">𝑀</ci><apply id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.2">𝕄</ci><ci id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.3a.cmml" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.3"><mtext id="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S5.SS3.SSSx1.p1.14.m6.1.1.1.1.1.3.3">test</mtext></ci></apply></apply><apply id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2"><eq id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.1"></eq><apply id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.1.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.2.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.2">𝒮</ci><ci id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.3.cmml" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.2.3">𝑀</ci></apply><cn id="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.3.cmml" type="integer" xref="S5.SS3.SSSx1.p1.14.m6.2.2.2.2.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.14.m6.2c">\mathbb{M}_{\text{test}}^{\mathcal{S}}=\{M\in\mathbb{M}_{\text{test}}:\mathcal%
{S}_{M}=1\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.14.m6.2d">blackboard_M start_POSTSUBSCRIPT test end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT = { italic_M ∈ blackboard_M start_POSTSUBSCRIPT test end_POSTSUBSCRIPT : caligraphic_S start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT = 1 }</annotation></semantics></math> we additionally calculate the <span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx1.p1.21.1">relative overspend</span> <math alttext="\mathcal{O}_{M}\in\mathbb{R}^{+}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.15.m7.1"><semantics id="S5.SS3.SSSx1.p1.15.m7.1a"><mrow id="S5.SS3.SSSx1.p1.15.m7.1.1" xref="S5.SS3.SSSx1.p1.15.m7.1.1.cmml"><msub id="S5.SS3.SSSx1.p1.15.m7.1.1.2" xref="S5.SS3.SSSx1.p1.15.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.15.m7.1.1.2.2" xref="S5.SS3.SSSx1.p1.15.m7.1.1.2.2.cmml">𝒪</mi><mi id="S5.SS3.SSSx1.p1.15.m7.1.1.2.3" xref="S5.SS3.SSSx1.p1.15.m7.1.1.2.3.cmml">M</mi></msub><mo id="S5.SS3.SSSx1.p1.15.m7.1.1.1" xref="S5.SS3.SSSx1.p1.15.m7.1.1.1.cmml">∈</mo><msup id="S5.SS3.SSSx1.p1.15.m7.1.1.3" xref="S5.SS3.SSSx1.p1.15.m7.1.1.3.cmml"><mi id="S5.SS3.SSSx1.p1.15.m7.1.1.3.2" xref="S5.SS3.SSSx1.p1.15.m7.1.1.3.2.cmml">ℝ</mi><mo id="S5.SS3.SSSx1.p1.15.m7.1.1.3.3" xref="S5.SS3.SSSx1.p1.15.m7.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.15.m7.1b"><apply id="S5.SS3.SSSx1.p1.15.m7.1.1.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1"><in id="S5.SS3.SSSx1.p1.15.m7.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.1"></in><apply id="S5.SS3.SSSx1.p1.15.m7.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.15.m7.1.1.2.1.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.2">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.15.m7.1.1.2.2.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.2.2">𝒪</ci><ci id="S5.SS3.SSSx1.p1.15.m7.1.1.2.3.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.2.3">𝑀</ci></apply><apply id="S5.SS3.SSSx1.p1.15.m7.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.15.m7.1.1.3.1.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.3">superscript</csymbol><ci id="S5.SS3.SSSx1.p1.15.m7.1.1.3.2.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.3.2">ℝ</ci><plus id="S5.SS3.SSSx1.p1.15.m7.1.1.3.3.cmml" xref="S5.SS3.SSSx1.p1.15.m7.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.15.m7.1c">\mathcal{O}_{M}\in\mathbb{R}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.15.m7.1d">caligraphic_O start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>, which quantifies the relative difference between the expense that the user carried by following the tool’s recommendation (<math alttext="n" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.16.m8.1"><semantics id="S5.SS3.SSSx1.p1.16.m8.1a"><mi id="S5.SS3.SSSx1.p1.16.m8.1.1" xref="S5.SS3.SSSx1.p1.16.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.16.m8.1b"><ci id="S5.SS3.SSSx1.p1.16.m8.1.1.cmml" xref="S5.SS3.SSSx1.p1.16.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.16.m8.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.16.m8.1d">italic_n</annotation></semantics></math> pods with GPU profile <math alttext="G^{\star}_{M}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.17.m9.1"><semantics id="S5.SS3.SSSx1.p1.17.m9.1a"><msubsup id="S5.SS3.SSSx1.p1.17.m9.1.1" xref="S5.SS3.SSSx1.p1.17.m9.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.17.m9.1.1.2.2" xref="S5.SS3.SSSx1.p1.17.m9.1.1.2.2.cmml">G</mi><mi id="S5.SS3.SSSx1.p1.17.m9.1.1.3" xref="S5.SS3.SSSx1.p1.17.m9.1.1.3.cmml">M</mi><mo id="S5.SS3.SSSx1.p1.17.m9.1.1.2.3" xref="S5.SS3.SSSx1.p1.17.m9.1.1.2.3.cmml">⋆</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.17.m9.1b"><apply id="S5.SS3.SSSx1.p1.17.m9.1.1.cmml" xref="S5.SS3.SSSx1.p1.17.m9.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.17.m9.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.17.m9.1.1">subscript</csymbol><apply id="S5.SS3.SSSx1.p1.17.m9.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.17.m9.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.17.m9.1.1.2.1.cmml" xref="S5.SS3.SSSx1.p1.17.m9.1.1">superscript</csymbol><ci id="S5.SS3.SSSx1.p1.17.m9.1.1.2.2.cmml" xref="S5.SS3.SSSx1.p1.17.m9.1.1.2.2">𝐺</ci><ci id="S5.SS3.SSSx1.p1.17.m9.1.1.2.3.cmml" xref="S5.SS3.SSSx1.p1.17.m9.1.1.2.3">⋆</ci></apply><ci id="S5.SS3.SSSx1.p1.17.m9.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.17.m9.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.17.m9.1c">G^{\star}_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.17.m9.1d">italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> determined by LLM-Pilot) and the expense of the truly most cost-effective deployment (denoted as <math alttext="\hat{n}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.18.m10.1"><semantics id="S5.SS3.SSSx1.p1.18.m10.1a"><mover accent="true" id="S5.SS3.SSSx1.p1.18.m10.1.1" xref="S5.SS3.SSSx1.p1.18.m10.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.18.m10.1.1.2" xref="S5.SS3.SSSx1.p1.18.m10.1.1.2.cmml">n</mi><mo id="S5.SS3.SSSx1.p1.18.m10.1.1.1" xref="S5.SS3.SSSx1.p1.18.m10.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.18.m10.1b"><apply id="S5.SS3.SSSx1.p1.18.m10.1.1.cmml" xref="S5.SS3.SSSx1.p1.18.m10.1.1"><ci id="S5.SS3.SSSx1.p1.18.m10.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.18.m10.1.1.1">^</ci><ci id="S5.SS3.SSSx1.p1.18.m10.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.18.m10.1.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.18.m10.1c">\hat{n}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.18.m10.1d">over^ start_ARG italic_n end_ARG</annotation></semantics></math> pods with the GPU profile <math alttext="\hat{G}^{\star}_{M}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.19.m11.1"><semantics id="S5.SS3.SSSx1.p1.19.m11.1a"><msubsup id="S5.SS3.SSSx1.p1.19.m11.1.1" xref="S5.SS3.SSSx1.p1.19.m11.1.1.cmml"><mover accent="true" id="S5.SS3.SSSx1.p1.19.m11.1.1.2.2" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.cmml"><mi id="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.2" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.2.cmml">G</mi><mo id="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.1" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.SS3.SSSx1.p1.19.m11.1.1.3" xref="S5.SS3.SSSx1.p1.19.m11.1.1.3.cmml">M</mi><mo id="S5.SS3.SSSx1.p1.19.m11.1.1.2.3" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.3.cmml">⋆</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.19.m11.1b"><apply id="S5.SS3.SSSx1.p1.19.m11.1.1.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.19.m11.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1">subscript</csymbol><apply id="S5.SS3.SSSx1.p1.19.m11.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.19.m11.1.1.2.1.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1">superscript</csymbol><apply id="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.2"><ci id="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.1.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.1">^</ci><ci id="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.2.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.2.2">𝐺</ci></apply><ci id="S5.SS3.SSSx1.p1.19.m11.1.1.2.3.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1.2.3">⋆</ci></apply><ci id="S5.SS3.SSSx1.p1.19.m11.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.19.m11.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.19.m11.1c">\hat{G}^{\star}_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.19.m11.1d">over^ start_ARG italic_G end_ARG start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math>) that they could have chosen if they knew the real performance <math alttext="\mathbb{D}_{M}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.20.m12.1"><semantics id="S5.SS3.SSSx1.p1.20.m12.1a"><msub id="S5.SS3.SSSx1.p1.20.m12.1.1" xref="S5.SS3.SSSx1.p1.20.m12.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.20.m12.1.1.2" xref="S5.SS3.SSSx1.p1.20.m12.1.1.2.cmml">𝔻</mi><mi id="S5.SS3.SSSx1.p1.20.m12.1.1.3" xref="S5.SS3.SSSx1.p1.20.m12.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.20.m12.1b"><apply id="S5.SS3.SSSx1.p1.20.m12.1.1.cmml" xref="S5.SS3.SSSx1.p1.20.m12.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.20.m12.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.20.m12.1.1">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.20.m12.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.20.m12.1.1.2">𝔻</ci><ci id="S5.SS3.SSSx1.p1.20.m12.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.20.m12.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.20.m12.1c">\mathbb{D}_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.20.m12.1d">blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> of LLM <math alttext="M" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.21.m13.1"><semantics id="S5.SS3.SSSx1.p1.21.m13.1a"><mi id="S5.SS3.SSSx1.p1.21.m13.1.1" xref="S5.SS3.SSSx1.p1.21.m13.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.21.m13.1b"><ci id="S5.SS3.SSSx1.p1.21.m13.1.1.cmml" xref="S5.SS3.SSSx1.p1.21.m13.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.21.m13.1c">M</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.21.m13.1d">italic_M</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{O}_{M}=\frac{n\big{(}M,\!G^{\star}_{M}\big{)}\!\cdot\!c\!\left(G^{%
\star}_{M}\right)-\hat{n}\big{(}M,\!\hat{G}^{\star}_{M}\big{|}\mathbb{D}_{M}%
\big{)}\!\cdot\!c\big{(}\hat{G}^{\star}_{M}\big{)}}{\hat{n}\big{(}M,\!\hat{G}^%
{\star}_{M}\big{|}\mathbb{D}_{M}\big{)}\!\cdot\!c\big{(}\hat{G}^{\star}_{M}%
\big{)}}." class="ltx_Math" display="block" id="S5.E6.m1.10"><semantics id="S5.E6.m1.10a"><mrow id="S5.E6.m1.10.10.1" xref="S5.E6.m1.10.10.1.1.cmml"><mrow id="S5.E6.m1.10.10.1.1" xref="S5.E6.m1.10.10.1.1.cmml"><msub id="S5.E6.m1.10.10.1.1.2" xref="S5.E6.m1.10.10.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E6.m1.10.10.1.1.2.2" xref="S5.E6.m1.10.10.1.1.2.2.cmml">𝒪</mi><mi id="S5.E6.m1.10.10.1.1.2.3" xref="S5.E6.m1.10.10.1.1.2.3.cmml">M</mi></msub><mo id="S5.E6.m1.10.10.1.1.1" xref="S5.E6.m1.10.10.1.1.1.cmml">=</mo><mfrac id="S5.E6.m1.9.9" xref="S5.E6.m1.9.9.cmml"><mrow id="S5.E6.m1.6.6.6" xref="S5.E6.m1.6.6.6.cmml"><mrow id="S5.E6.m1.4.4.4.4" xref="S5.E6.m1.4.4.4.4.cmml"><mrow id="S5.E6.m1.3.3.3.3.1" xref="S5.E6.m1.3.3.3.3.1.cmml"><mrow id="S5.E6.m1.3.3.3.3.1.1" xref="S5.E6.m1.3.3.3.3.1.1.cmml"><mi id="S5.E6.m1.3.3.3.3.1.1.3" xref="S5.E6.m1.3.3.3.3.1.1.3.cmml">n</mi><mo id="S5.E6.m1.3.3.3.3.1.1.2" xref="S5.E6.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S5.E6.m1.3.3.3.3.1.1.1.1" xref="S5.E6.m1.3.3.3.3.1.1.1.2.cmml"><mo id="S5.E6.m1.3.3.3.3.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S5.E6.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="S5.E6.m1.1.1.1.1" xref="S5.E6.m1.1.1.1.1.cmml">M</mi><mpadded width="0.275em"><mo id="S5.E6.m1.3.3.3.3.1.1.1.1.3" xref="S5.E6.m1.3.3.3.3.1.1.1.2.cmml">,</mo></mpadded><msubsup id="S5.E6.m1.3.3.3.3.1.1.1.1.1" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.2" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.2.cmml">G</mi><mi id="S5.E6.m1.3.3.3.3.1.1.1.1.1.3" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1.3.cmml">M</mi><mo id="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.3" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.3.cmml">⋆</mo></msubsup><mo id="S5.E6.m1.3.3.3.3.1.1.1.1.4" maxsize="120%" minsize="120%" xref="S5.E6.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E6.m1.3.3.3.3.1.2" lspace="0.052em" rspace="0.052em" xref="S5.E6.m1.3.3.3.3.1.2.cmml">⋅</mo><mpadded width="0.263em"><mi id="S5.E6.m1.3.3.3.3.1.3" xref="S5.E6.m1.3.3.3.3.1.3.cmml">c</mi></mpadded></mrow><mo id="S5.E6.m1.4.4.4.4.3" xref="S5.E6.m1.4.4.4.4.3.cmml">⁢</mo><mrow id="S5.E6.m1.4.4.4.4.2.1" xref="S5.E6.m1.4.4.4.4.2.1.1.cmml"><mo id="S5.E6.m1.4.4.4.4.2.1.2" xref="S5.E6.m1.4.4.4.4.2.1.1.cmml">(</mo><msubsup id="S5.E6.m1.4.4.4.4.2.1.1" xref="S5.E6.m1.4.4.4.4.2.1.1.cmml"><mi id="S5.E6.m1.4.4.4.4.2.1.1.2.2" xref="S5.E6.m1.4.4.4.4.2.1.1.2.2.cmml">G</mi><mi id="S5.E6.m1.4.4.4.4.2.1.1.3" xref="S5.E6.m1.4.4.4.4.2.1.1.3.cmml">M</mi><mo id="S5.E6.m1.4.4.4.4.2.1.1.2.3" xref="S5.E6.m1.4.4.4.4.2.1.1.2.3.cmml">⋆</mo></msubsup><mo id="S5.E6.m1.4.4.4.4.2.1.3" xref="S5.E6.m1.4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E6.m1.6.6.6.7" xref="S5.E6.m1.6.6.6.7.cmml">−</mo><mrow id="S5.E6.m1.6.6.6.6" xref="S5.E6.m1.6.6.6.6.cmml"><mrow id="S5.E6.m1.5.5.5.5.1" xref="S5.E6.m1.5.5.5.5.1.cmml"><mrow id="S5.E6.m1.5.5.5.5.1.1" xref="S5.E6.m1.5.5.5.5.1.1.cmml"><mover accent="true" id="S5.E6.m1.5.5.5.5.1.1.3" xref="S5.E6.m1.5.5.5.5.1.1.3.cmml"><mi id="S5.E6.m1.5.5.5.5.1.1.3.2" xref="S5.E6.m1.5.5.5.5.1.1.3.2.cmml">n</mi><mo id="S5.E6.m1.5.5.5.5.1.1.3.1" xref="S5.E6.m1.5.5.5.5.1.1.3.1.cmml">^</mo></mover><mo id="S5.E6.m1.5.5.5.5.1.1.2" xref="S5.E6.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mrow id="S5.E6.m1.5.5.5.5.1.1.1.1" xref="S5.E6.m1.5.5.5.5.1.1.1.2.cmml"><mo id="S5.E6.m1.5.5.5.5.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S5.E6.m1.5.5.5.5.1.1.1.2.cmml">(</mo><mi id="S5.E6.m1.2.2.2.2" xref="S5.E6.m1.2.2.2.2.cmml">M</mi><mpadded width="0.275em"><mo id="S5.E6.m1.5.5.5.5.1.1.1.1.3" xref="S5.E6.m1.5.5.5.5.1.1.1.2.cmml">,</mo></mpadded><mrow id="S5.E6.m1.5.5.5.5.1.1.1.1.1" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.cmml"><msubsup id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.cmml"><mover accent="true" id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.cmml"><mi id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.2" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.2.cmml">G</mi><mo id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.1" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.3" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.3.cmml">M</mi><mo id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.3" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.3.cmml">⋆</mo></msubsup><mo fence="false" id="S5.E6.m1.5.5.5.5.1.1.1.1.1.1" mathsize="120%" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.1.cmml">|</mo><msub id="S5.E6.m1.5.5.5.5.1.1.1.1.1.3" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.cmml"><mi id="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.2" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.2.cmml">𝔻</mi><mi id="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.3" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S5.E6.m1.5.5.5.5.1.1.1.1.4" maxsize="120%" minsize="120%" xref="S5.E6.m1.5.5.5.5.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E6.m1.5.5.5.5.1.2" lspace="0.052em" rspace="0.052em" xref="S5.E6.m1.5.5.5.5.1.2.cmml">⋅</mo><mi id="S5.E6.m1.5.5.5.5.1.3" xref="S5.E6.m1.5.5.5.5.1.3.cmml">c</mi></mrow><mo id="S5.E6.m1.6.6.6.6.3" xref="S5.E6.m1.6.6.6.6.3.cmml">⁢</mo><mrow id="S5.E6.m1.6.6.6.6.2.1" xref="S5.E6.m1.6.6.6.6.2.1.1.cmml"><mo id="S5.E6.m1.6.6.6.6.2.1.2" maxsize="120%" minsize="120%" xref="S5.E6.m1.6.6.6.6.2.1.1.cmml">(</mo><msubsup id="S5.E6.m1.6.6.6.6.2.1.1" xref="S5.E6.m1.6.6.6.6.2.1.1.cmml"><mover accent="true" id="S5.E6.m1.6.6.6.6.2.1.1.2.2" xref="S5.E6.m1.6.6.6.6.2.1.1.2.2.cmml"><mi id="S5.E6.m1.6.6.6.6.2.1.1.2.2.2" xref="S5.E6.m1.6.6.6.6.2.1.1.2.2.2.cmml">G</mi><mo id="S5.E6.m1.6.6.6.6.2.1.1.2.2.1" xref="S5.E6.m1.6.6.6.6.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.E6.m1.6.6.6.6.2.1.1.3" xref="S5.E6.m1.6.6.6.6.2.1.1.3.cmml">M</mi><mo id="S5.E6.m1.6.6.6.6.2.1.1.2.3" xref="S5.E6.m1.6.6.6.6.2.1.1.2.3.cmml">⋆</mo></msubsup><mo id="S5.E6.m1.6.6.6.6.2.1.3" maxsize="120%" minsize="120%" xref="S5.E6.m1.6.6.6.6.2.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S5.E6.m1.9.9.9" xref="S5.E6.m1.9.9.9.cmml"><mrow id="S5.E6.m1.8.8.8.2" xref="S5.E6.m1.8.8.8.2.cmml"><mrow id="S5.E6.m1.8.8.8.2.1" xref="S5.E6.m1.8.8.8.2.1.cmml"><mover accent="true" id="S5.E6.m1.8.8.8.2.1.3" xref="S5.E6.m1.8.8.8.2.1.3.cmml"><mi id="S5.E6.m1.8.8.8.2.1.3.2" xref="S5.E6.m1.8.8.8.2.1.3.2.cmml">n</mi><mo id="S5.E6.m1.8.8.8.2.1.3.1" xref="S5.E6.m1.8.8.8.2.1.3.1.cmml">^</mo></mover><mo id="S5.E6.m1.8.8.8.2.1.2" xref="S5.E6.m1.8.8.8.2.1.2.cmml">⁢</mo><mrow id="S5.E6.m1.8.8.8.2.1.1.1" xref="S5.E6.m1.8.8.8.2.1.1.2.cmml"><mo id="S5.E6.m1.8.8.8.2.1.1.1.2" maxsize="120%" minsize="120%" xref="S5.E6.m1.8.8.8.2.1.1.2.cmml">(</mo><mi id="S5.E6.m1.7.7.7.1" xref="S5.E6.m1.7.7.7.1.cmml">M</mi><mpadded width="0.275em"><mo id="S5.E6.m1.8.8.8.2.1.1.1.3" xref="S5.E6.m1.8.8.8.2.1.1.2.cmml">,</mo></mpadded><mrow id="S5.E6.m1.8.8.8.2.1.1.1.1" xref="S5.E6.m1.8.8.8.2.1.1.1.1.cmml"><msubsup id="S5.E6.m1.8.8.8.2.1.1.1.1.2" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.cmml"><mover accent="true" id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.cmml"><mi id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.2" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.2.cmml">G</mi><mo id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.1" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S5.E6.m1.8.8.8.2.1.1.1.1.2.3" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.3.cmml">M</mi><mo id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.3" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.3.cmml">⋆</mo></msubsup><mo fence="false" id="S5.E6.m1.8.8.8.2.1.1.1.1.1" mathsize="120%" xref="S5.E6.m1.8.8.8.2.1.1.1.1.1.cmml">|</mo><msub id="S5.E6.m1.8.8.8.2.1.1.1.1.3" xref="S5.E6.m1.8.8.8.2.1.1.1.1.3.cmml"><mi id="S5.E6.m1.8.8.8.2.1.1.1.1.3.2" xref="S5.E6.m1.8.8.8.2.1.1.1.1.3.2.cmml">𝔻</mi><mi id="S5.E6.m1.8.8.8.2.1.1.1.1.3.3" xref="S5.E6.m1.8.8.8.2.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S5.E6.m1.8.8.8.2.1.1.1.4" maxsize="120%" minsize="120%" xref="S5.E6.m1.8.8.8.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E6.m1.8.8.8.2.2" lspace="0.052em" rspace="0.052em" xref="S5.E6.m1.8.8.8.2.2.cmml">⋅</mo><mi id="S5.E6.m1.8.8.8.2.3" xref="S5.E6.m1.8.8.8.2.3.cmml">c</mi></mrow><mo id="S5.E6.m1.9.9.9.4" xref="S5.E6.m1.9.9.9.4.cmml">⁢</mo><mrow id="S5.E6.m1.9.9.9.3.1" xref="S5.E6.m1.9.9.9.3.1.1.cmml"><mo id="S5.E6.m1.9.9.9.3.1.2" maxsize="120%" minsize="120%" xref="S5.E6.m1.9.9.9.3.1.1.cmml">(</mo><msubsup id="S5.E6.m1.9.9.9.3.1.1" xref="S5.E6.m1.9.9.9.3.1.1.cmml"><mover accent="true" id="S5.E6.m1.9.9.9.3.1.1.2.2" xref="S5.E6.m1.9.9.9.3.1.1.2.2.cmml"><mi id="S5.E6.m1.9.9.9.3.1.1.2.2.2" xref="S5.E6.m1.9.9.9.3.1.1.2.2.2.cmml">G</mi><mo id="S5.E6.m1.9.9.9.3.1.1.2.2.1" xref="S5.E6.m1.9.9.9.3.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.E6.m1.9.9.9.3.1.1.3" xref="S5.E6.m1.9.9.9.3.1.1.3.cmml">M</mi><mo id="S5.E6.m1.9.9.9.3.1.1.2.3" xref="S5.E6.m1.9.9.9.3.1.1.2.3.cmml">⋆</mo></msubsup><mo id="S5.E6.m1.9.9.9.3.1.3" maxsize="120%" minsize="120%" xref="S5.E6.m1.9.9.9.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S5.E6.m1.10.10.1.2" lspace="0em" xref="S5.E6.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E6.m1.10b"><apply id="S5.E6.m1.10.10.1.1.cmml" xref="S5.E6.m1.10.10.1"><eq id="S5.E6.m1.10.10.1.1.1.cmml" xref="S5.E6.m1.10.10.1.1.1"></eq><apply id="S5.E6.m1.10.10.1.1.2.cmml" xref="S5.E6.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m1.10.10.1.1.2.1.cmml" xref="S5.E6.m1.10.10.1.1.2">subscript</csymbol><ci id="S5.E6.m1.10.10.1.1.2.2.cmml" xref="S5.E6.m1.10.10.1.1.2.2">𝒪</ci><ci id="S5.E6.m1.10.10.1.1.2.3.cmml" xref="S5.E6.m1.10.10.1.1.2.3">𝑀</ci></apply><apply id="S5.E6.m1.9.9.cmml" xref="S5.E6.m1.9.9"><divide id="S5.E6.m1.9.9.10.cmml" xref="S5.E6.m1.9.9"></divide><apply id="S5.E6.m1.6.6.6.cmml" xref="S5.E6.m1.6.6.6"><minus id="S5.E6.m1.6.6.6.7.cmml" xref="S5.E6.m1.6.6.6.7"></minus><apply id="S5.E6.m1.4.4.4.4.cmml" xref="S5.E6.m1.4.4.4.4"><times id="S5.E6.m1.4.4.4.4.3.cmml" xref="S5.E6.m1.4.4.4.4.3"></times><apply id="S5.E6.m1.3.3.3.3.1.cmml" xref="S5.E6.m1.3.3.3.3.1"><ci id="S5.E6.m1.3.3.3.3.1.2.cmml" xref="S5.E6.m1.3.3.3.3.1.2">⋅</ci><apply id="S5.E6.m1.3.3.3.3.1.1.cmml" xref="S5.E6.m1.3.3.3.3.1.1"><times id="S5.E6.m1.3.3.3.3.1.1.2.cmml" xref="S5.E6.m1.3.3.3.3.1.1.2"></times><ci id="S5.E6.m1.3.3.3.3.1.1.3.cmml" xref="S5.E6.m1.3.3.3.3.1.1.3">𝑛</ci><interval closure="open" id="S5.E6.m1.3.3.3.3.1.1.1.2.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1"><ci id="S5.E6.m1.1.1.1.1.cmml" xref="S5.E6.m1.1.1.1.1">𝑀</ci><apply id="S5.E6.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E6.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><apply id="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.2.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.2">𝐺</ci><ci id="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.3.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1.2.3">⋆</ci></apply><ci id="S5.E6.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S5.E6.m1.3.3.3.3.1.1.1.1.1.3">𝑀</ci></apply></interval></apply><ci id="S5.E6.m1.3.3.3.3.1.3.cmml" xref="S5.E6.m1.3.3.3.3.1.3">𝑐</ci></apply><apply id="S5.E6.m1.4.4.4.4.2.1.1.cmml" xref="S5.E6.m1.4.4.4.4.2.1"><csymbol cd="ambiguous" id="S5.E6.m1.4.4.4.4.2.1.1.1.cmml" xref="S5.E6.m1.4.4.4.4.2.1">subscript</csymbol><apply id="S5.E6.m1.4.4.4.4.2.1.1.2.cmml" xref="S5.E6.m1.4.4.4.4.2.1"><csymbol cd="ambiguous" id="S5.E6.m1.4.4.4.4.2.1.1.2.1.cmml" xref="S5.E6.m1.4.4.4.4.2.1">superscript</csymbol><ci id="S5.E6.m1.4.4.4.4.2.1.1.2.2.cmml" xref="S5.E6.m1.4.4.4.4.2.1.1.2.2">𝐺</ci><ci id="S5.E6.m1.4.4.4.4.2.1.1.2.3.cmml" xref="S5.E6.m1.4.4.4.4.2.1.1.2.3">⋆</ci></apply><ci id="S5.E6.m1.4.4.4.4.2.1.1.3.cmml" xref="S5.E6.m1.4.4.4.4.2.1.1.3">𝑀</ci></apply></apply><apply id="S5.E6.m1.6.6.6.6.cmml" xref="S5.E6.m1.6.6.6.6"><times id="S5.E6.m1.6.6.6.6.3.cmml" xref="S5.E6.m1.6.6.6.6.3"></times><apply id="S5.E6.m1.5.5.5.5.1.cmml" xref="S5.E6.m1.5.5.5.5.1"><ci id="S5.E6.m1.5.5.5.5.1.2.cmml" xref="S5.E6.m1.5.5.5.5.1.2">⋅</ci><apply id="S5.E6.m1.5.5.5.5.1.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1"><times id="S5.E6.m1.5.5.5.5.1.1.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.2"></times><apply id="S5.E6.m1.5.5.5.5.1.1.3.cmml" xref="S5.E6.m1.5.5.5.5.1.1.3"><ci id="S5.E6.m1.5.5.5.5.1.1.3.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1.3.1">^</ci><ci id="S5.E6.m1.5.5.5.5.1.1.3.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.3.2">𝑛</ci></apply><interval closure="open" id="S5.E6.m1.5.5.5.5.1.1.1.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1"><ci id="S5.E6.m1.2.2.2.2.cmml" xref="S5.E6.m1.2.2.2.2">𝑀</ci><apply id="S5.E6.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S5.E6.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.1">conditional</csymbol><apply id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2">subscript</csymbol><apply id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2">superscript</csymbol><apply id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2"><ci id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.1">^</ci><ci id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.2.2">𝐺</ci></apply><ci id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.3.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.2.3">⋆</ci></apply><ci id="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.3.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.1.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.2.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.2">𝔻</ci><ci id="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.3.cmml" xref="S5.E6.m1.5.5.5.5.1.1.1.1.1.3.3">𝑀</ci></apply></apply></interval></apply><ci id="S5.E6.m1.5.5.5.5.1.3.cmml" xref="S5.E6.m1.5.5.5.5.1.3">𝑐</ci></apply><apply id="S5.E6.m1.6.6.6.6.2.1.1.cmml" xref="S5.E6.m1.6.6.6.6.2.1"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.6.6.2.1.1.1.cmml" xref="S5.E6.m1.6.6.6.6.2.1">subscript</csymbol><apply id="S5.E6.m1.6.6.6.6.2.1.1.2.cmml" xref="S5.E6.m1.6.6.6.6.2.1"><csymbol cd="ambiguous" id="S5.E6.m1.6.6.6.6.2.1.1.2.1.cmml" xref="S5.E6.m1.6.6.6.6.2.1">superscript</csymbol><apply id="S5.E6.m1.6.6.6.6.2.1.1.2.2.cmml" xref="S5.E6.m1.6.6.6.6.2.1.1.2.2"><ci id="S5.E6.m1.6.6.6.6.2.1.1.2.2.1.cmml" xref="S5.E6.m1.6.6.6.6.2.1.1.2.2.1">^</ci><ci id="S5.E6.m1.6.6.6.6.2.1.1.2.2.2.cmml" xref="S5.E6.m1.6.6.6.6.2.1.1.2.2.2">𝐺</ci></apply><ci id="S5.E6.m1.6.6.6.6.2.1.1.2.3.cmml" xref="S5.E6.m1.6.6.6.6.2.1.1.2.3">⋆</ci></apply><ci id="S5.E6.m1.6.6.6.6.2.1.1.3.cmml" xref="S5.E6.m1.6.6.6.6.2.1.1.3">𝑀</ci></apply></apply></apply><apply id="S5.E6.m1.9.9.9.cmml" xref="S5.E6.m1.9.9.9"><times id="S5.E6.m1.9.9.9.4.cmml" xref="S5.E6.m1.9.9.9.4"></times><apply id="S5.E6.m1.8.8.8.2.cmml" xref="S5.E6.m1.8.8.8.2"><ci id="S5.E6.m1.8.8.8.2.2.cmml" xref="S5.E6.m1.8.8.8.2.2">⋅</ci><apply id="S5.E6.m1.8.8.8.2.1.cmml" xref="S5.E6.m1.8.8.8.2.1"><times id="S5.E6.m1.8.8.8.2.1.2.cmml" xref="S5.E6.m1.8.8.8.2.1.2"></times><apply id="S5.E6.m1.8.8.8.2.1.3.cmml" xref="S5.E6.m1.8.8.8.2.1.3"><ci id="S5.E6.m1.8.8.8.2.1.3.1.cmml" xref="S5.E6.m1.8.8.8.2.1.3.1">^</ci><ci id="S5.E6.m1.8.8.8.2.1.3.2.cmml" xref="S5.E6.m1.8.8.8.2.1.3.2">𝑛</ci></apply><interval closure="open" id="S5.E6.m1.8.8.8.2.1.1.2.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1"><ci id="S5.E6.m1.7.7.7.1.cmml" xref="S5.E6.m1.7.7.7.1">𝑀</ci><apply id="S5.E6.m1.8.8.8.2.1.1.1.1.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1"><csymbol cd="latexml" id="S5.E6.m1.8.8.8.2.1.1.1.1.1.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.1">conditional</csymbol><apply id="S5.E6.m1.8.8.8.2.1.1.1.1.2.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m1.8.8.8.2.1.1.1.1.2.1.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2">subscript</csymbol><apply id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.1.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2">superscript</csymbol><apply id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2"><ci id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.1.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.1">^</ci><ci id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.2.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.2.2">𝐺</ci></apply><ci id="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.3.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.2.3">⋆</ci></apply><ci id="S5.E6.m1.8.8.8.2.1.1.1.1.2.3.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.2.3">𝑀</ci></apply><apply id="S5.E6.m1.8.8.8.2.1.1.1.1.3.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E6.m1.8.8.8.2.1.1.1.1.3.1.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.3">subscript</csymbol><ci id="S5.E6.m1.8.8.8.2.1.1.1.1.3.2.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.3.2">𝔻</ci><ci id="S5.E6.m1.8.8.8.2.1.1.1.1.3.3.cmml" xref="S5.E6.m1.8.8.8.2.1.1.1.1.3.3">𝑀</ci></apply></apply></interval></apply><ci id="S5.E6.m1.8.8.8.2.3.cmml" xref="S5.E6.m1.8.8.8.2.3">𝑐</ci></apply><apply id="S5.E6.m1.9.9.9.3.1.1.cmml" xref="S5.E6.m1.9.9.9.3.1"><csymbol cd="ambiguous" id="S5.E6.m1.9.9.9.3.1.1.1.cmml" xref="S5.E6.m1.9.9.9.3.1">subscript</csymbol><apply id="S5.E6.m1.9.9.9.3.1.1.2.cmml" xref="S5.E6.m1.9.9.9.3.1"><csymbol cd="ambiguous" id="S5.E6.m1.9.9.9.3.1.1.2.1.cmml" xref="S5.E6.m1.9.9.9.3.1">superscript</csymbol><apply id="S5.E6.m1.9.9.9.3.1.1.2.2.cmml" xref="S5.E6.m1.9.9.9.3.1.1.2.2"><ci id="S5.E6.m1.9.9.9.3.1.1.2.2.1.cmml" xref="S5.E6.m1.9.9.9.3.1.1.2.2.1">^</ci><ci id="S5.E6.m1.9.9.9.3.1.1.2.2.2.cmml" xref="S5.E6.m1.9.9.9.3.1.1.2.2.2">𝐺</ci></apply><ci id="S5.E6.m1.9.9.9.3.1.1.2.3.cmml" xref="S5.E6.m1.9.9.9.3.1.1.2.3">⋆</ci></apply><ci id="S5.E6.m1.9.9.9.3.1.1.3.cmml" xref="S5.E6.m1.9.9.9.3.1.1.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E6.m1.10c">\mathcal{O}_{M}=\frac{n\big{(}M,\!G^{\star}_{M}\big{)}\!\cdot\!c\!\left(G^{%
\star}_{M}\right)-\hat{n}\big{(}M,\!\hat{G}^{\star}_{M}\big{|}\mathbb{D}_{M}%
\big{)}\!\cdot\!c\big{(}\hat{G}^{\star}_{M}\big{)}}{\hat{n}\big{(}M,\!\hat{G}^%
{\star}_{M}\big{|}\mathbb{D}_{M}\big{)}\!\cdot\!c\big{(}\hat{G}^{\star}_{M}%
\big{)}}.</annotation><annotation encoding="application/x-llamapun" id="S5.E6.m1.10d">caligraphic_O start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT = divide start_ARG italic_n ( italic_M , italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) ⋅ italic_c ( italic_G start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) - over^ start_ARG italic_n end_ARG ( italic_M , over^ start_ARG italic_G end_ARG start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) ⋅ italic_c ( over^ start_ARG italic_G end_ARG start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) end_ARG start_ARG over^ start_ARG italic_n end_ARG ( italic_M , over^ start_ARG italic_G end_ARG start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT | blackboard_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) ⋅ italic_c ( over^ start_ARG italic_G end_ARG start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.SSSx1.p1.28">We obtain the final success rate <math alttext="\mathcal{S}\in\left[0,1\right]" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.22.m1.2"><semantics id="S5.SS3.SSSx1.p1.22.m1.2a"><mrow id="S5.SS3.SSSx1.p1.22.m1.2.3" xref="S5.SS3.SSSx1.p1.22.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.22.m1.2.3.2" xref="S5.SS3.SSSx1.p1.22.m1.2.3.2.cmml">𝒮</mi><mo id="S5.SS3.SSSx1.p1.22.m1.2.3.1" xref="S5.SS3.SSSx1.p1.22.m1.2.3.1.cmml">∈</mo><mrow id="S5.SS3.SSSx1.p1.22.m1.2.3.3.2" xref="S5.SS3.SSSx1.p1.22.m1.2.3.3.1.cmml"><mo id="S5.SS3.SSSx1.p1.22.m1.2.3.3.2.1" xref="S5.SS3.SSSx1.p1.22.m1.2.3.3.1.cmml">[</mo><mn id="S5.SS3.SSSx1.p1.22.m1.1.1" xref="S5.SS3.SSSx1.p1.22.m1.1.1.cmml">0</mn><mo id="S5.SS3.SSSx1.p1.22.m1.2.3.3.2.2" xref="S5.SS3.SSSx1.p1.22.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS3.SSSx1.p1.22.m1.2.2" xref="S5.SS3.SSSx1.p1.22.m1.2.2.cmml">1</mn><mo id="S5.SS3.SSSx1.p1.22.m1.2.3.3.2.3" xref="S5.SS3.SSSx1.p1.22.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.22.m1.2b"><apply id="S5.SS3.SSSx1.p1.22.m1.2.3.cmml" xref="S5.SS3.SSSx1.p1.22.m1.2.3"><in id="S5.SS3.SSSx1.p1.22.m1.2.3.1.cmml" xref="S5.SS3.SSSx1.p1.22.m1.2.3.1"></in><ci id="S5.SS3.SSSx1.p1.22.m1.2.3.2.cmml" xref="S5.SS3.SSSx1.p1.22.m1.2.3.2">𝒮</ci><interval closure="closed" id="S5.SS3.SSSx1.p1.22.m1.2.3.3.1.cmml" xref="S5.SS3.SSSx1.p1.22.m1.2.3.3.2"><cn id="S5.SS3.SSSx1.p1.22.m1.1.1.cmml" type="integer" xref="S5.SS3.SSSx1.p1.22.m1.1.1">0</cn><cn id="S5.SS3.SSSx1.p1.22.m1.2.2.cmml" type="integer" xref="S5.SS3.SSSx1.p1.22.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.22.m1.2c">\mathcal{S}\in\left[0,1\right]</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.22.m1.2d">caligraphic_S ∈ [ 0 , 1 ]</annotation></semantics></math> by averaging the successes of all unseen LLMs <math alttext="\mathbb{M}_{\text{test}}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.23.m2.1"><semantics id="S5.SS3.SSSx1.p1.23.m2.1a"><msub id="S5.SS3.SSSx1.p1.23.m2.1.1" xref="S5.SS3.SSSx1.p1.23.m2.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.23.m2.1.1.2" xref="S5.SS3.SSSx1.p1.23.m2.1.1.2.cmml">𝕄</mi><mtext id="S5.SS3.SSSx1.p1.23.m2.1.1.3" xref="S5.SS3.SSSx1.p1.23.m2.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.23.m2.1b"><apply id="S5.SS3.SSSx1.p1.23.m2.1.1.cmml" xref="S5.SS3.SSSx1.p1.23.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.23.m2.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.23.m2.1.1">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.23.m2.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.23.m2.1.1.2">𝕄</ci><ci id="S5.SS3.SSSx1.p1.23.m2.1.1.3a.cmml" xref="S5.SS3.SSSx1.p1.23.m2.1.1.3"><mtext id="S5.SS3.SSSx1.p1.23.m2.1.1.3.cmml" mathsize="70%" xref="S5.SS3.SSSx1.p1.23.m2.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.23.m2.1c">\mathbb{M}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.23.m2.1d">blackboard_M start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math>, and the mean relative overspend <math alttext="\mathcal{O}\in\mathbb{R}^{+}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.24.m3.1"><semantics id="S5.SS3.SSSx1.p1.24.m3.1a"><mrow id="S5.SS3.SSSx1.p1.24.m3.1.1" xref="S5.SS3.SSSx1.p1.24.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.24.m3.1.1.2" xref="S5.SS3.SSSx1.p1.24.m3.1.1.2.cmml">𝒪</mi><mo id="S5.SS3.SSSx1.p1.24.m3.1.1.1" xref="S5.SS3.SSSx1.p1.24.m3.1.1.1.cmml">∈</mo><msup id="S5.SS3.SSSx1.p1.24.m3.1.1.3" xref="S5.SS3.SSSx1.p1.24.m3.1.1.3.cmml"><mi id="S5.SS3.SSSx1.p1.24.m3.1.1.3.2" xref="S5.SS3.SSSx1.p1.24.m3.1.1.3.2.cmml">ℝ</mi><mo id="S5.SS3.SSSx1.p1.24.m3.1.1.3.3" xref="S5.SS3.SSSx1.p1.24.m3.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.24.m3.1b"><apply id="S5.SS3.SSSx1.p1.24.m3.1.1.cmml" xref="S5.SS3.SSSx1.p1.24.m3.1.1"><in id="S5.SS3.SSSx1.p1.24.m3.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.24.m3.1.1.1"></in><ci id="S5.SS3.SSSx1.p1.24.m3.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.24.m3.1.1.2">𝒪</ci><apply id="S5.SS3.SSSx1.p1.24.m3.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.24.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.24.m3.1.1.3.1.cmml" xref="S5.SS3.SSSx1.p1.24.m3.1.1.3">superscript</csymbol><ci id="S5.SS3.SSSx1.p1.24.m3.1.1.3.2.cmml" xref="S5.SS3.SSSx1.p1.24.m3.1.1.3.2">ℝ</ci><plus id="S5.SS3.SSSx1.p1.24.m3.1.1.3.3.cmml" xref="S5.SS3.SSSx1.p1.24.m3.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.24.m3.1c">\mathcal{O}\in\mathbb{R}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.24.m3.1d">caligraphic_O ∈ blackboard_R start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> by averaging the relative overspends over all unseen LLMs for which the recommendation was successful <math alttext="\mathbb{M}_{\text{test}}^{\mathcal{S}}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.25.m4.1"><semantics id="S5.SS3.SSSx1.p1.25.m4.1a"><msubsup id="S5.SS3.SSSx1.p1.25.m4.1.1" xref="S5.SS3.SSSx1.p1.25.m4.1.1.cmml"><mi id="S5.SS3.SSSx1.p1.25.m4.1.1.2.2" xref="S5.SS3.SSSx1.p1.25.m4.1.1.2.2.cmml">𝕄</mi><mtext id="S5.SS3.SSSx1.p1.25.m4.1.1.2.3" xref="S5.SS3.SSSx1.p1.25.m4.1.1.2.3a.cmml">test</mtext><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.25.m4.1.1.3" xref="S5.SS3.SSSx1.p1.25.m4.1.1.3.cmml">𝒮</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.25.m4.1b"><apply id="S5.SS3.SSSx1.p1.25.m4.1.1.cmml" xref="S5.SS3.SSSx1.p1.25.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.25.m4.1.1.1.cmml" xref="S5.SS3.SSSx1.p1.25.m4.1.1">superscript</csymbol><apply id="S5.SS3.SSSx1.p1.25.m4.1.1.2.cmml" xref="S5.SS3.SSSx1.p1.25.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSSx1.p1.25.m4.1.1.2.1.cmml" xref="S5.SS3.SSSx1.p1.25.m4.1.1">subscript</csymbol><ci id="S5.SS3.SSSx1.p1.25.m4.1.1.2.2.cmml" xref="S5.SS3.SSSx1.p1.25.m4.1.1.2.2">𝕄</ci><ci id="S5.SS3.SSSx1.p1.25.m4.1.1.2.3a.cmml" xref="S5.SS3.SSSx1.p1.25.m4.1.1.2.3"><mtext id="S5.SS3.SSSx1.p1.25.m4.1.1.2.3.cmml" mathsize="70%" xref="S5.SS3.SSSx1.p1.25.m4.1.1.2.3">test</mtext></ci></apply><ci id="S5.SS3.SSSx1.p1.25.m4.1.1.3.cmml" xref="S5.SS3.SSSx1.p1.25.m4.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.25.m4.1c">\mathbb{M}_{\text{test}}^{\mathcal{S}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.25.m4.1d">blackboard_M start_POSTSUBSCRIPT test end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT</annotation></semantics></math>.
The purpose of using both metrics above is for them to compliment each other: the success rate penalizes underpredicting the number of GPUs needed, while the overspend penalizes overpredicting them.
Finally, we define the <span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx1.p1.28.1">S/O score</span> <math alttext="\mathcal{SO}\in\left[0,1\right]" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.26.m5.2"><semantics id="S5.SS3.SSSx1.p1.26.m5.2a"><mrow id="S5.SS3.SSSx1.p1.26.m5.2.3" xref="S5.SS3.SSSx1.p1.26.m5.2.3.cmml"><mrow id="S5.SS3.SSSx1.p1.26.m5.2.3.2" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.26.m5.2.3.2.2" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2.2.cmml">𝒮</mi><mo id="S5.SS3.SSSx1.p1.26.m5.2.3.2.1" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.26.m5.2.3.2.3" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2.3.cmml">𝒪</mi></mrow><mo id="S5.SS3.SSSx1.p1.26.m5.2.3.1" xref="S5.SS3.SSSx1.p1.26.m5.2.3.1.cmml">∈</mo><mrow id="S5.SS3.SSSx1.p1.26.m5.2.3.3.2" xref="S5.SS3.SSSx1.p1.26.m5.2.3.3.1.cmml"><mo id="S5.SS3.SSSx1.p1.26.m5.2.3.3.2.1" xref="S5.SS3.SSSx1.p1.26.m5.2.3.3.1.cmml">[</mo><mn id="S5.SS3.SSSx1.p1.26.m5.1.1" xref="S5.SS3.SSSx1.p1.26.m5.1.1.cmml">0</mn><mo id="S5.SS3.SSSx1.p1.26.m5.2.3.3.2.2" xref="S5.SS3.SSSx1.p1.26.m5.2.3.3.1.cmml">,</mo><mn id="S5.SS3.SSSx1.p1.26.m5.2.2" xref="S5.SS3.SSSx1.p1.26.m5.2.2.cmml">1</mn><mo id="S5.SS3.SSSx1.p1.26.m5.2.3.3.2.3" xref="S5.SS3.SSSx1.p1.26.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.26.m5.2b"><apply id="S5.SS3.SSSx1.p1.26.m5.2.3.cmml" xref="S5.SS3.SSSx1.p1.26.m5.2.3"><in id="S5.SS3.SSSx1.p1.26.m5.2.3.1.cmml" xref="S5.SS3.SSSx1.p1.26.m5.2.3.1"></in><apply id="S5.SS3.SSSx1.p1.26.m5.2.3.2.cmml" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2"><times id="S5.SS3.SSSx1.p1.26.m5.2.3.2.1.cmml" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2.1"></times><ci id="S5.SS3.SSSx1.p1.26.m5.2.3.2.2.cmml" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2.2">𝒮</ci><ci id="S5.SS3.SSSx1.p1.26.m5.2.3.2.3.cmml" xref="S5.SS3.SSSx1.p1.26.m5.2.3.2.3">𝒪</ci></apply><interval closure="closed" id="S5.SS3.SSSx1.p1.26.m5.2.3.3.1.cmml" xref="S5.SS3.SSSx1.p1.26.m5.2.3.3.2"><cn id="S5.SS3.SSSx1.p1.26.m5.1.1.cmml" type="integer" xref="S5.SS3.SSSx1.p1.26.m5.1.1">0</cn><cn id="S5.SS3.SSSx1.p1.26.m5.2.2.cmml" type="integer" xref="S5.SS3.SSSx1.p1.26.m5.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.26.m5.2c">\mathcal{SO}\in\left[0,1\right]</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.26.m5.2d">caligraphic_S caligraphic_O ∈ [ 0 , 1 ]</annotation></semantics></math>, which combines the success rate <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.27.m6.1"><semantics id="S5.SS3.SSSx1.p1.27.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.27.m6.1.1" xref="S5.SS3.SSSx1.p1.27.m6.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.27.m6.1b"><ci id="S5.SS3.SSSx1.p1.27.m6.1.1.cmml" xref="S5.SS3.SSSx1.p1.27.m6.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.27.m6.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.27.m6.1d">caligraphic_S</annotation></semantics></math> and the inverse of overspend <math alttext="\mathcal{O}" class="ltx_Math" display="inline" id="S5.SS3.SSSx1.p1.28.m7.1"><semantics id="S5.SS3.SSSx1.p1.28.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSSx1.p1.28.m7.1.1" xref="S5.SS3.SSSx1.p1.28.m7.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx1.p1.28.m7.1b"><ci id="S5.SS3.SSSx1.p1.28.m7.1.1.cmml" xref="S5.SS3.SSSx1.p1.28.m7.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx1.p1.28.m7.1c">\mathcal{O}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx1.p1.28.m7.1d">caligraphic_O</annotation></semantics></math> using the harmonic mean:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{SO}=\frac{2\cdot\mathcal{S}\cdot\text{max}\!\left(0,1-\mathcal{O}%
\right)}{\mathcal{S}+\text{max}\!\left(0,1-\mathcal{O}\right)}." class="ltx_Math" display="block" id="S5.E7.m1.5"><semantics id="S5.E7.m1.5a"><mrow id="S5.E7.m1.5.5.1" xref="S5.E7.m1.5.5.1.1.cmml"><mrow id="S5.E7.m1.5.5.1.1" xref="S5.E7.m1.5.5.1.1.cmml"><mrow id="S5.E7.m1.5.5.1.1.2" xref="S5.E7.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E7.m1.5.5.1.1.2.2" xref="S5.E7.m1.5.5.1.1.2.2.cmml">𝒮</mi><mo id="S5.E7.m1.5.5.1.1.2.1" xref="S5.E7.m1.5.5.1.1.2.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S5.E7.m1.5.5.1.1.2.3" xref="S5.E7.m1.5.5.1.1.2.3.cmml">𝒪</mi></mrow><mo id="S5.E7.m1.5.5.1.1.1" xref="S5.E7.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S5.E7.m1.4.4" xref="S5.E7.m1.4.4.cmml"><mrow id="S5.E7.m1.2.2.2" xref="S5.E7.m1.2.2.2.cmml"><mrow id="S5.E7.m1.2.2.2.4" xref="S5.E7.m1.2.2.2.4.cmml"><mn id="S5.E7.m1.2.2.2.4.2" xref="S5.E7.m1.2.2.2.4.2.cmml">2</mn><mo id="S5.E7.m1.2.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S5.E7.m1.2.2.2.4.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S5.E7.m1.2.2.2.4.3" xref="S5.E7.m1.2.2.2.4.3.cmml">𝒮</mi><mo id="S5.E7.m1.2.2.2.4.1a" lspace="0.222em" rspace="0.222em" xref="S5.E7.m1.2.2.2.4.1.cmml">⋅</mo><mpadded width="1.808em"><mtext id="S5.E7.m1.2.2.2.4.4" xref="S5.E7.m1.2.2.2.4.4a.cmml">max</mtext></mpadded></mrow><mo id="S5.E7.m1.2.2.2.3" xref="S5.E7.m1.2.2.2.3.cmml">⁢</mo><mrow id="S5.E7.m1.2.2.2.2.1" xref="S5.E7.m1.2.2.2.2.2.cmml"><mo id="S5.E7.m1.2.2.2.2.1.2" xref="S5.E7.m1.2.2.2.2.2.cmml">(</mo><mn id="S5.E7.m1.1.1.1.1" xref="S5.E7.m1.1.1.1.1.cmml">0</mn><mo id="S5.E7.m1.2.2.2.2.1.3" xref="S5.E7.m1.2.2.2.2.2.cmml">,</mo><mrow id="S5.E7.m1.2.2.2.2.1.1" xref="S5.E7.m1.2.2.2.2.1.1.cmml"><mn id="S5.E7.m1.2.2.2.2.1.1.2" xref="S5.E7.m1.2.2.2.2.1.1.2.cmml">1</mn><mo id="S5.E7.m1.2.2.2.2.1.1.1" xref="S5.E7.m1.2.2.2.2.1.1.1.cmml">−</mo><mi class="ltx_font_mathcaligraphic" id="S5.E7.m1.2.2.2.2.1.1.3" xref="S5.E7.m1.2.2.2.2.1.1.3.cmml">𝒪</mi></mrow><mo id="S5.E7.m1.2.2.2.2.1.4" xref="S5.E7.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S5.E7.m1.4.4.4" xref="S5.E7.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E7.m1.4.4.4.4" xref="S5.E7.m1.4.4.4.4.cmml">𝒮</mi><mo id="S5.E7.m1.4.4.4.3" xref="S5.E7.m1.4.4.4.3.cmml">+</mo><mrow id="S5.E7.m1.4.4.4.2" xref="S5.E7.m1.4.4.4.2.cmml"><mpadded width="1.808em"><mtext id="S5.E7.m1.4.4.4.2.3" xref="S5.E7.m1.4.4.4.2.3a.cmml">max</mtext></mpadded><mo id="S5.E7.m1.4.4.4.2.2" xref="S5.E7.m1.4.4.4.2.2.cmml">⁢</mo><mrow id="S5.E7.m1.4.4.4.2.1.1" xref="S5.E7.m1.4.4.4.2.1.2.cmml"><mo id="S5.E7.m1.4.4.4.2.1.1.2" xref="S5.E7.m1.4.4.4.2.1.2.cmml">(</mo><mn id="S5.E7.m1.3.3.3.1" xref="S5.E7.m1.3.3.3.1.cmml">0</mn><mo id="S5.E7.m1.4.4.4.2.1.1.3" xref="S5.E7.m1.4.4.4.2.1.2.cmml">,</mo><mrow id="S5.E7.m1.4.4.4.2.1.1.1" xref="S5.E7.m1.4.4.4.2.1.1.1.cmml"><mn id="S5.E7.m1.4.4.4.2.1.1.1.2" xref="S5.E7.m1.4.4.4.2.1.1.1.2.cmml">1</mn><mo id="S5.E7.m1.4.4.4.2.1.1.1.1" xref="S5.E7.m1.4.4.4.2.1.1.1.1.cmml">−</mo><mi class="ltx_font_mathcaligraphic" id="S5.E7.m1.4.4.4.2.1.1.1.3" xref="S5.E7.m1.4.4.4.2.1.1.1.3.cmml">𝒪</mi></mrow><mo id="S5.E7.m1.4.4.4.2.1.1.4" xref="S5.E7.m1.4.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S5.E7.m1.5.5.1.2" lspace="0em" xref="S5.E7.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E7.m1.5b"><apply id="S5.E7.m1.5.5.1.1.cmml" xref="S5.E7.m1.5.5.1"><eq id="S5.E7.m1.5.5.1.1.1.cmml" xref="S5.E7.m1.5.5.1.1.1"></eq><apply id="S5.E7.m1.5.5.1.1.2.cmml" xref="S5.E7.m1.5.5.1.1.2"><times id="S5.E7.m1.5.5.1.1.2.1.cmml" xref="S5.E7.m1.5.5.1.1.2.1"></times><ci id="S5.E7.m1.5.5.1.1.2.2.cmml" xref="S5.E7.m1.5.5.1.1.2.2">𝒮</ci><ci id="S5.E7.m1.5.5.1.1.2.3.cmml" xref="S5.E7.m1.5.5.1.1.2.3">𝒪</ci></apply><apply id="S5.E7.m1.4.4.cmml" xref="S5.E7.m1.4.4"><divide id="S5.E7.m1.4.4.5.cmml" xref="S5.E7.m1.4.4"></divide><apply id="S5.E7.m1.2.2.2.cmml" xref="S5.E7.m1.2.2.2"><times id="S5.E7.m1.2.2.2.3.cmml" xref="S5.E7.m1.2.2.2.3"></times><apply id="S5.E7.m1.2.2.2.4.cmml" xref="S5.E7.m1.2.2.2.4"><ci id="S5.E7.m1.2.2.2.4.1.cmml" xref="S5.E7.m1.2.2.2.4.1">⋅</ci><cn id="S5.E7.m1.2.2.2.4.2.cmml" type="integer" xref="S5.E7.m1.2.2.2.4.2">2</cn><ci id="S5.E7.m1.2.2.2.4.3.cmml" xref="S5.E7.m1.2.2.2.4.3">𝒮</ci><ci id="S5.E7.m1.2.2.2.4.4a.cmml" xref="S5.E7.m1.2.2.2.4.4"><mtext id="S5.E7.m1.2.2.2.4.4.cmml" xref="S5.E7.m1.2.2.2.4.4">max</mtext></ci></apply><interval closure="open" id="S5.E7.m1.2.2.2.2.2.cmml" xref="S5.E7.m1.2.2.2.2.1"><cn id="S5.E7.m1.1.1.1.1.cmml" type="integer" xref="S5.E7.m1.1.1.1.1">0</cn><apply id="S5.E7.m1.2.2.2.2.1.1.cmml" xref="S5.E7.m1.2.2.2.2.1.1"><minus id="S5.E7.m1.2.2.2.2.1.1.1.cmml" xref="S5.E7.m1.2.2.2.2.1.1.1"></minus><cn id="S5.E7.m1.2.2.2.2.1.1.2.cmml" type="integer" xref="S5.E7.m1.2.2.2.2.1.1.2">1</cn><ci id="S5.E7.m1.2.2.2.2.1.1.3.cmml" xref="S5.E7.m1.2.2.2.2.1.1.3">𝒪</ci></apply></interval></apply><apply id="S5.E7.m1.4.4.4.cmml" xref="S5.E7.m1.4.4.4"><plus id="S5.E7.m1.4.4.4.3.cmml" xref="S5.E7.m1.4.4.4.3"></plus><ci id="S5.E7.m1.4.4.4.4.cmml" xref="S5.E7.m1.4.4.4.4">𝒮</ci><apply id="S5.E7.m1.4.4.4.2.cmml" xref="S5.E7.m1.4.4.4.2"><times id="S5.E7.m1.4.4.4.2.2.cmml" xref="S5.E7.m1.4.4.4.2.2"></times><ci id="S5.E7.m1.4.4.4.2.3a.cmml" xref="S5.E7.m1.4.4.4.2.3"><mtext id="S5.E7.m1.4.4.4.2.3.cmml" xref="S5.E7.m1.4.4.4.2.3">max</mtext></ci><interval closure="open" id="S5.E7.m1.4.4.4.2.1.2.cmml" xref="S5.E7.m1.4.4.4.2.1.1"><cn id="S5.E7.m1.3.3.3.1.cmml" type="integer" xref="S5.E7.m1.3.3.3.1">0</cn><apply id="S5.E7.m1.4.4.4.2.1.1.1.cmml" xref="S5.E7.m1.4.4.4.2.1.1.1"><minus id="S5.E7.m1.4.4.4.2.1.1.1.1.cmml" xref="S5.E7.m1.4.4.4.2.1.1.1.1"></minus><cn id="S5.E7.m1.4.4.4.2.1.1.1.2.cmml" type="integer" xref="S5.E7.m1.4.4.4.2.1.1.1.2">1</cn><ci id="S5.E7.m1.4.4.4.2.1.1.1.3.cmml" xref="S5.E7.m1.4.4.4.2.1.1.1.3">𝒪</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E7.m1.5c">\mathcal{SO}=\frac{2\cdot\mathcal{S}\cdot\text{max}\!\left(0,1-\mathcal{O}%
\right)}{\mathcal{S}+\text{max}\!\left(0,1-\mathcal{O}\right)}.</annotation><annotation encoding="application/x-llamapun" id="S5.E7.m1.5d">caligraphic_S caligraphic_O = divide start_ARG 2 ⋅ caligraphic_S ⋅ max ( 0 , 1 - caligraphic_O ) end_ARG start_ARG caligraphic_S + max ( 0 , 1 - caligraphic_O ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.SSSx1.p1.29">The S/O score serves as the most important metric in our study, as it directly evaluates how well we solve problem (<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S4.E1" title="In IV-A Problem statement ‣ IV GPU Recommendation Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Baselines</h4>
<div class="ltx_para" id="S5.SS3.SSSx2.p1">
<p class="ltx_p" id="S5.SS3.SSSx2.p1.3">While to the best of our knowledge there are no prior works that predict the inference performance of LLMs across various GPUs, we have implemented several methods developed in related fields.
<span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx2.p1.3.1">PARIS</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib55" title="">55</a>]</cite> predicts the performance of a previously unseen application across many virtual machine (VM) types in the cloud.
First, PARIS measures the performance of the unseen application on two reference VM types: the weakest and the most powerful one.
Then, it uses a RF regressor to predict the inference performance of that application running on other VM types, based on the features describing the application and the performance measurements collected on the reference VM types.
In our implementation of PARIS, the performance measurements consist of nTTFT, ITL and throughput values for all numbers of concurrent users for two reference GPU profiles: 1<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS3.SSSx2.p1.1.m1.1"><semantics id="S5.SS3.SSSx2.p1.1.m1.1a"><mo id="S5.SS3.SSSx2.p1.1.m1.1.1" xref="S5.SS3.SSSx2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx2.p1.1.m1.1b"><times id="S5.SS3.SSSx2.p1.1.m1.1.1.cmml" xref="S5.SS3.SSSx2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx2.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx2.p1.1.m1.1d">×</annotation></semantics></math>T4 and 4<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS3.SSSx2.p1.2.m2.1"><semantics id="S5.SS3.SSSx2.p1.2.m2.1a"><mo id="S5.SS3.SSSx2.p1.2.m2.1.1" xref="S5.SS3.SSSx2.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx2.p1.2.m2.1b"><times id="S5.SS3.SSSx2.p1.2.m2.1.1.cmml" xref="S5.SS3.SSSx2.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx2.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx2.p1.2.m2.1d">×</annotation></semantics></math>H100, which, respectively, have the weakest and the strongest memory and computing parameters.
To evaluate how the performance measurements of the reference VM types improve the quality of RF predictions in PARIS, we have also implemented a <span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx2.p1.3.2">RF</span> predictor that uses as input only features describing the LLM, and makes no performance measurements.
<span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx2.p1.3.3">Selecta</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib18" title="">18</a>]</cite> was developed for the same use-case as PARIS.
Internally, it builds a sparse matrix containing the known runtimes of historical and reference (application, VM type)-combinations, and predicts the missing entries via collaborative filtering.
We have implemented Selecta using the same library as the original work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib10" title="">10</a>]</cite>, and have chosen the same reference GPU profiles as we used for PARIS.
<span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx2.p1.3.4">Morphling</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib51" title="">51</a>]</cite>, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx2.p1.3.5">PerfNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib49" title="">49</a>]</cite>, and <span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx2.p1.3.6">PerfNetV2</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib50" title="">50</a>]</cite> predict the performance of inference services using neural network (NN) models.
We have implemented all three NNs ourselves.
As Morphling additionally fine-tunes the NN using two reference evaluations, we again use the same reference GPU profiles as for other baselines.
Finally, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSSx2.p1.3.7">Static policy</span> is a simple, naive baseline, in which no performance predictions are made.
The GPU recommendation is always the same: to create a fixed number of pods with a certain GPU profile.
We have considered a broad range of static policies and present the one which achieved the highest S/O score: 4 pods running on 1<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS3.SSSx2.p1.3.m3.1"><semantics id="S5.SS3.SSSx2.p1.3.m3.1a"><mo id="S5.SS3.SSSx2.p1.3.m3.1.1" xref="S5.SS3.SSSx2.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx2.p1.3.m3.1b"><times id="S5.SS3.SSSx2.p1.3.m3.1.1.cmml" xref="S5.SS3.SSSx2.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx2.p1.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx2.p1.3.m3.1d">×</annotation></semantics></math>A100 GPU.
Unknown HPs of baseline methods were determined through the same leave-one-LLM-out cross-validation procedure as for LLM-Pilot.</p>
</div>
<figure class="ltx_figure" id="S5.F8">
<p class="ltx_p ltx_align_center" id="S5.F8.1"><span class="ltx_text" id="S5.F8.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="387" id="S5.F8.1.1.g1" src="extracted/5895755/so_scores.png" width="598"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F8.9.4.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S5.F8.7.3" style="font-size:90%;">Evaluation of the quality of recommendations made by LLM-Pilot and baselines. Numbers in parentheses present the S/O scores achieved by each method. We mark methods which make reference performance measurements using <math alttext="\blacktriangle" class="ltx_Math" display="inline" id="S5.F8.5.1.m1.1"><semantics id="S5.F8.5.1.m1.1b"><mi id="S5.F8.5.1.m1.1.1" mathvariant="normal" xref="S5.F8.5.1.m1.1.1.cmml">▲</mi><annotation-xml encoding="MathML-Content" id="S5.F8.5.1.m1.1c"><ci id="S5.F8.5.1.m1.1.1.cmml" xref="S5.F8.5.1.m1.1.1">▲</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.5.1.m1.1d">\blacktriangle</annotation><annotation encoding="application/x-llamapun" id="S5.F8.5.1.m1.1e">▲</annotation></semantics></math>, and methods which make no reference evaluations with <math alttext="\CIRCLE" class="ltx_Math" display="inline" id="S5.F8.6.2.m2.1"><semantics id="S5.F8.6.2.m2.1b"><mi id="S5.F8.6.2.m2.1.1" mathvariant="normal" xref="S5.F8.6.2.m2.1.1.cmml">●</mi><annotation-xml encoding="MathML-Content" id="S5.F8.6.2.m2.1c"><ci id="S5.F8.6.2.m2.1.1.cmml" xref="S5.F8.6.2.m2.1.1">●</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.6.2.m2.1d">\CIRCLE</annotation><annotation encoding="application/x-llamapun" id="S5.F8.6.2.m2.1e">●</annotation></semantics></math>. Additionally, <math alttext="\bigstar" class="ltx_Math" display="inline" id="S5.F8.7.3.m3.1"><semantics id="S5.F8.7.3.m3.1b"><mi id="S5.F8.7.3.m3.1.1" mathvariant="normal" xref="S5.F8.7.3.m3.1.1.cmml">★</mi><annotation-xml encoding="MathML-Content" id="S5.F8.7.3.m3.1c"><ci id="S5.F8.7.3.m3.1.1.cmml" xref="S5.F8.7.3.m3.1.1">★</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.7.3.m3.1d">\bigstar</annotation><annotation encoding="application/x-llamapun" id="S5.F8.7.3.m3.1e">★</annotation></semantics></math> marks the theoretical ideal performance.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Recommendation results</h4>
<div class="ltx_para" id="S5.SS3.SSSx3.p1">
<p class="ltx_p" id="S5.SS3.SSSx3.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.F8" title="Figure 8 ‣ Baselines ‣ V-C GPU recommendation ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">8</span></a> summarizes the recommendation scores achieved with LLM-Pilot and the baseline methods.
Based on these results, we can draw a number of conclusions.
Firstly, LLM-Pilot achieves good results – its recommendations are successful in 80% of cases and have average overspend of less than 20%, outperforming all other methods in terms of the S/O score.
The static policy can be considered a high-risk, high-reward solution.
It only succeeds in 50% of cases but it achieves an excellent overspend when it makes a successful recommendation, outperforming all other baselines in terms of the S/O score.
PARIS and Selecta achieve the same or similar success rate as LLM-Pilot but have higher average overspend, and require making additional performance measurements using the reference GPU profiles.
RF, which depicts the performance of PARIS without the reference performance measurements, is significantly worse in terms of all three evaluation metrics.
Finally, PerfNet models achieve good overspend scores but their success rate is the worst of all state-of-the-art solutions.
On the other hand, Morphling achieves higher success rate than other NN-based methods thanks to performing reference performance measurements but is worse in terms of overspend.</p>
</div>
<div class="ltx_para" id="S5.SS3.SSSx3.p2">
<p class="ltx_p" id="S5.SS3.SSSx3.p2.1">Overall, the experimental results indicate that LLM-Pilot can successfully recommend the most cost-effective GPU profile for previously unseen LLMs, and outperforms all state-of-the-art methods.
Its GPU recommendations satisfy the performance requirements 33% more frequently on average, thanks to ensuring that the performance is most accurately predicted in the neighborhood of the latency constraints.
At the same time, it recommends GPU profiles which are on average 60% cheaper than state-of-the-art.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">Related Works</span>
</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS1.5.1.1">VI-A</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS1.6.2">LLM traces</span>
</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">There are multiple publicly available collections of LLM traces, in some cases consisting of thousands or millions of LLM inference requests.
While some datasets consist of real user inputs of inference requests and resulting outputs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib59" title="">59</a>]</cite>, they do not take into account any additional request parameters.
There is also a range of inference request collections generated synthetically: <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib20" title="">20</a>]</cite> generated by a group of volunteers, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib25" title="">25</a>]</cite> with handcrafted system prompts, and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib44" title="">44</a>]</cite> generated by GPT 3.5 using Self-Instruct <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib52" title="">52</a>]</cite>.
None of the synthetic collections represents a real-life distribution of user requests, and therefore could not be used in this work for realistic workload generation.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS2.5.1.1">VI-B</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS2.6.2">Workload generators and benchmarking tools</span>
</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">There is a number of related works on benchmarking LLM inference services, which we have compared in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.T4" title="TABLE IV ‣ VI-C LLM performance datasets ‣ VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">IV</span></a>.
Many of them measure the LLM inference performance under a very simple workload of requests not based on real LLM usage <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib46" title="">46</a>]</cite>.
As we have argued in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S3.SS2" title="III-B Workload generator ‣ III Performance Characterization Tool ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>, a realistic and varied set of inference requests is necessary to perform meaningful performance measurements.
Other benchmarking tools ensure that the inference requests are realistic by drawing random samples from existing trace collections <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib9" title="">9</a>]</cite>.
However, none of the related benchmarking tools optimizes the maximum batch weight, which we have found to have big influence on the performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS3.5.1.1">VI-C</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS3.6.2">LLM performance datasets</span>
</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">While various benchmarking tools publish some of their benchmarking results, none of the existing datasets aggregates performance measurements of many LLM services deployed on a variety of GPUs (see Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S6.T4" title="TABLE IV ‣ VI-C LLM performance datasets ‣ VI Related Works ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag">IV</span></a>).
Optimum’s <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib12" title="">12</a>]</cite> LLM-Perf leaderboard <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib32" title="">32</a>]</cite> includes benchmarking results of LLMs but only includes 2 GPUs, while MLPerf <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib37" title="">37</a>]</cite> collected data across many GPUs but only two LLMs are currently included.
Other related benchmarking tools <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib34" title="">34</a>]</cite> also published small collections of LLM performance data.</p>
</div>
<figure class="ltx_table" id="S6.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T4.11.1.1" style="font-size:90%;">TABLE IV</span>: </span><span class="ltx_text" id="S6.T4.12.2" style="font-size:90%;">Comparison of LLM-Pilot’s performance characterization tool and related LLM benchmarking tools, including LLM performance datasets that they released publicly.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T4.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T4.9.10.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.9.10.1.1" rowspan="2"><span class="ltx_text" id="S6.T4.9.10.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T4.9.10.1.1.1.1">
<span class="ltx_tr" id="S6.T4.9.10.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T4.9.10.1.1.1.1.1.1">Comparison</span></span>
<span class="ltx_tr" id="S6.T4.9.10.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T4.9.10.1.1.1.1.2.1">criterion</span></span>
</span></span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.10.1.2" rowspan="2"><span class="ltx_text" id="S6.T4.9.10.1.2.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T4.9.10.1.2.1.1">
<span class="ltx_tr" id="S6.T4.9.10.1.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.2.1.1.1.1">Workload</span></span>
<span class="ltx_tr" id="S6.T4.9.10.1.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.2.1.1.2.1">based on</span></span>
<span class="ltx_tr" id="S6.T4.9.10.1.2.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.2.1.1.3.1">real data</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.10.1.3" rowspan="2"><span class="ltx_text" id="S6.T4.9.10.1.3.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T4.9.10.1.3.1.1">
<span class="ltx_tr" id="S6.T4.9.10.1.3.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.3.1.1.1.1">Maximum</span></span>
<span class="ltx_tr" id="S6.T4.9.10.1.3.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.3.1.1.2.1">batch weight</span></span>
<span class="ltx_tr" id="S6.T4.9.10.1.3.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.3.1.1.3.1">tuning</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S6.T4.9.10.1.4">
<table class="ltx_tabular ltx_align_middle" id="S6.T4.9.10.1.4.1">
<tr class="ltx_tr" id="S6.T4.9.10.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.4.1.1.1">LLM performance</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.10.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.10.1.4.1.2.1">data released publicly</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.11.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.11.2.1">
<table class="ltx_tabular ltx_align_middle" id="S6.T4.9.11.2.1.1">
<tr class="ltx_tr" id="S6.T4.9.11.2.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.11.2.1.1.1.1">Number</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.11.2.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.11.2.1.1.2.1">of LLMs</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.11.2.2">
<table class="ltx_tabular ltx_align_middle" id="S6.T4.9.11.2.2.1">
<tr class="ltx_tr" id="S6.T4.9.11.2.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.11.2.2.1.1.1">Number</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.11.2.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T4.9.11.2.2.1.2.1">of GPUs</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S6.T4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.2.2.3">Optimum <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib12" title="">12</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.1.1"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.1.1.1.m1.1"><semantics id="S6.T4.1.1.1.m1.1a"><mo id="S6.T4.1.1.1.m1.1.1" xref="S6.T4.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.1.1.1.m1.1b"><times id="S6.T4.1.1.1.m1.1.1.cmml" xref="S6.T4.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.1.1.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.2.2.2"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.2.2.2.m1.1"><semantics id="S6.T4.2.2.2.m1.1a"><mo id="S6.T4.2.2.2.m1.1.1" xref="S6.T4.2.2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.2.2.2.m1.1b"><times id="S6.T4.2.2.2.m1.1.1.cmml" xref="S6.T4.2.2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.2.2.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.2.2.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.2.2.4">34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.2.2.5">2</td>
</tr>
<tr class="ltx_tr" id="S6.T4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.4.4.3">LLMPerf <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib34" title="">34</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.3.3.1"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.3.3.1.m1.1"><semantics id="S6.T4.3.3.1.m1.1a"><mo id="S6.T4.3.3.1.m1.1.1" xref="S6.T4.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.3.3.1.m1.1b"><times id="S6.T4.3.3.1.m1.1.1.cmml" xref="S6.T4.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.3.3.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.3.3.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.4.4.2"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.4.4.2.m1.1"><semantics id="S6.T4.4.4.2.m1.1a"><mo id="S6.T4.4.4.2.m1.1.1" xref="S6.T4.4.4.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.4.4.2.m1.1b"><times id="S6.T4.4.4.2.m1.1.1.cmml" xref="S6.T4.4.4.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.4.4.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.4.4.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.4.4.4">3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.4.4.5">1</td>
</tr>
<tr class="ltx_tr" id="S6.T4.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.6.6.3">
<table class="ltx_tabular ltx_align_middle" id="S6.T4.6.6.3.1">
<tr class="ltx_tr" id="S6.T4.6.6.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T4.6.6.3.1.1.1">Inference</td>
</tr>
<tr class="ltx_tr" id="S6.T4.6.6.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T4.6.6.3.1.2.1">benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib46" title="">46</a>]</cite>
</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.5.5.1"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.5.5.1.m1.1"><semantics id="S6.T4.5.5.1.m1.1a"><mo id="S6.T4.5.5.1.m1.1.1" xref="S6.T4.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.5.5.1.m1.1b"><times id="S6.T4.5.5.1.m1.1.1.cmml" xref="S6.T4.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.5.5.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.5.5.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.6.6.2"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.6.6.2.m1.1"><semantics id="S6.T4.6.6.2.m1.1a"><mo id="S6.T4.6.6.2.m1.1.1" xref="S6.T4.6.6.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.6.6.2.m1.1b"><times id="S6.T4.6.6.2.m1.1.1.cmml" xref="S6.T4.6.6.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.6.6.2.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.6.6.2.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.6.6.4">1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.6.6.5">1</td>
</tr>
<tr class="ltx_tr" id="S6.T4.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.7.7.2">Fleece <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib9" title="">9</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.7.7.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.7.7.1"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.7.7.1.m1.1"><semantics id="S6.T4.7.7.1.m1.1a"><mo id="S6.T4.7.7.1.m1.1.1" xref="S6.T4.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.7.7.1.m1.1b"><times id="S6.T4.7.7.1.m1.1.1.cmml" xref="S6.T4.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.7.7.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.7.7.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.7.7.4">5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.7.7.5">5</td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.8.8.2">vLLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib19" title="">19</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.8.8.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.8.8.1"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.8.8.1.m1.1"><semantics id="S6.T4.8.8.1.m1.1a"><mo id="S6.T4.8.8.1.m1.1.1" xref="S6.T4.8.8.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.8.8.1.m1.1b"><times id="S6.T4.8.8.1.m1.1.1.cmml" xref="S6.T4.8.8.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.8.8.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.8.8.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.8.8.4">3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.8.8.5">2</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.9.9.2">MLPerf <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.9.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.9.1"><math alttext="\times" class="ltx_Math" display="inline" id="S6.T4.9.9.1.m1.1"><semantics id="S6.T4.9.9.1.m1.1a"><mo id="S6.T4.9.9.1.m1.1.1" xref="S6.T4.9.9.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T4.9.9.1.m1.1b"><times id="S6.T4.9.9.1.m1.1.1.cmml" xref="S6.T4.9.9.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.9.9.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T4.9.9.1.m1.1d">×</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.9.4">2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.9.9.5">10</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.12.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.9.12.3.1">LLM-Pilot (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T4.9.12.3.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T4.9.12.3.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T4.9.12.3.4">10</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T4.9.12.3.5">14</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS4.5.1.1">VI-D</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS4.6.2">LLM performance prediction</span>
</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">To the best of our knowledge, there are no prior works that predict the inference performance of LLMs across a variety of hardware platforms.
The works that are most closely related to our work predict the runtimes of other types of machine learning applications.
Many of these methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib50" title="">50</a>]</cite> have been used as baselines in this work and have been discussed in detail in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#S5.SS3" title="V-C GPU recommendation ‣ V Analysis and Evaluation ‣ LLM-Pilot: Characterize and Optimize Performance of your LLM Inference Services"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">V-C</span></span></a>.
Other works related to LLM-Pilot include <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib16" title="">16</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib54" title="">54</a>]</cite> which predict the training runtime or inference latency of NNs across GPUs or runtime and resource configurations, while <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib56" title="">56</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02425v1#bib.bib15" title="">15</a>]</cite> predict the quality of outputs of machine learning models on downstream tasks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span class="ltx_text ltx_font_smallcaps" id="S7.1.1">Conclusion and Next Steps</span>
</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this work we have presented LLM-Pilot, a system that can perform realistic and optimized benchmarking of LLM inference services across different GPUs.
In addition, LLM-Pilot can recommend which GPU will meet performance requirements in the most cost-effective way for a previously unseen LLM, achieving on average 33% higher success rate and 60% lower cost compared to state-of-the-art methods.
As a next step, we intend to extend LLM-Pilot to cover the multi-tenancy scenario, in which multiple users compete to deploy LLM inference services on the same hardware resources.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We would like to express our gratitude to our colleagues in IBM Research: Nick Hill, for sharing his technical insights into LLM serving using TGIS, and Burkhard Ringlein, for his valuable input during the experimental work and the process of writing this publication.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Sid Black, Stella Biderman, Eric Hallahan, Quentin Anthony, Leo Gao, Laurence
Golding, Horace He, Connor Leahy, Kyle McDonell, Jason Phang, Michael Pieler,
USVSN Sai Prashanth, Shivanshu Purohit, Laria Reynolds, Jonathan Tow, Ben
Wang, and Samuel Weinbach.

</span>
<span class="ltx_bibblock">Gpt-neox-20b: An open-source autoregressive language model, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Rishi Bommasani, Drew A. Hudson, Ehsan Adeli, Russ Altman, Simran Arora, Sydney
von Arx, Michael S. Bernstein, Jeannette Bohg, Antoine Bosselut, Emma
Brunskill, Erik Brynjolfsson, Shyamal Buch, Dallas Card, Rodrigo Castellon,
Niladri Chatterji, Annie Chen, Kathleen Creel, Jared Quincy Davis, Dora
Demszky, Chris Donahue, Moussa Doumbouya, Esin Durmus, Stefano Ermon, John
Etchemendy, Kawin Ethayarajh, Li Fei-Fei, Chelsea Finn, Trevor Gale, Lauren
Gillespie, Karan Goel, Noah Goodman, Shelby Grossman, Neel Guha, Tatsunori
Hashimoto, Peter Henderson, John Hewitt, Daniel E. Ho, Jenny Hong, Kyle Hsu,
Jing Huang, Thomas Icard, Saahil Jain, Dan Jurafsky, Pratyusha Kalluri,
Siddharth Karamcheti, Geoff Keeling, Fereshte Khani, Omar Khattab, Pang Wei
Koh, Mark Krass, Ranjay Krishna, Rohith Kuditipudi, Ananya Kumar, Faisal
Ladhak, Mina Lee, Tony Lee, Jure Leskovec, Isabelle Levent, Xiang Lisa Li,
Xuechen Li, Tengyu Ma, Ali Malik, Christopher D. Manning, Suvir Mirchandani,
Eric Mitchell, Zanele Munyikwa, Suraj Nair, Avanika Narayan, Deepak
Narayanan, Ben Newman, Allen Nie, Juan Carlos Niebles, Hamed Nilforoshan,
Julian Nyarko, Giray Ogut, Laurel Orr, Isabel Papadimitriou, Joon Sung Park,
Chris Piech, Eva Portelance, Christopher Potts, Aditi Raghunathan, Rob Reich,
Hongyu Ren, Frieda Rong, Yusuf Roohani, Camilo Ruiz, Jack Ryan, Christopher
Ré, Dorsa Sadigh, Shiori Sagawa, Keshav Santhanam, Andy Shih, Krishnan
Srinivasan, Alex Tamkin, Rohan Taori, Armin W. Thomas, Florian Tramèr,
Rose E. Wang, William Wang, Bohan Wu, Jiajun Wu, Yuhuai Wu, Sang Michael Xie,
Michihiro Yasunaga, Jiaxuan You, Matei Zaharia, Michael Zhang, Tianyi Zhang,
Xikun Zhang, Yuhui Zhang, Lucia Zheng, Kaitlyn Zhou, and Percy Liang.

</span>
<span class="ltx_bibblock">On the opportunities and risks of foundation models, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
L. Breiman, J. Friedman, C.J. Stone, and R.A. Olshen.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Classification and Regression Trees</span>.

</span>
<span class="ltx_bibblock">Taylor &amp; Francis, 1984.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon
Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris
Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess,
Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever,
and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin,
editors, <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Advances in Neural Information Processing Systems</span>, volume 33,
pages 1877–1901. Curran Associates, Inc., 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Tianqi Chen and Carlos Guestrin.

</span>
<span class="ltx_bibblock">Xgboost: A scalable tree boosting system.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 22nd ACM SIGKDD International Conference
on Knowledge Discovery and Data Mining</span>, KDD ’16, page 785–794, New York,
NY, USA, 2016. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Hyung Won Chung, Le Hou, Shayne Longpre, Barret Zoph, Yi Tay, William Fedus,
Eric Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, Albert Webson,
Shixiang Shane Gu, Zhuyun Dai, Mirac Suzgun, Xinyun Chen, Aakanksha
Chowdhery, Sharan Narang, Gaurav Mishra, Adams Yu, Vincent Zhao, Yanping
Huang, Andrew Dai, Hongkun Yu, Slav Petrov, Ed H. Chi, Jeff Dean, Jacob
Devlin, Adam Roberts, Denny Zhou, Quoc V. Le, and Jason Wei.

</span>
<span class="ltx_bibblock">Scaling instruction-finetuned language models, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
The Kubernetes Community.

</span>
<span class="ltx_bibblock">Kubernetes.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://kubernetes.io/" title="">https://kubernetes.io/</a>, accessed: 28.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Tri Dao, Daniel Y. Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with
io-awareness, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Zhongjing Wei et al.

</span>
<span class="ltx_bibblock">Fleece-benchmark.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/CoLearn-Dev/fleece-benchmark" title="">https://github.com/CoLearn-Dev/fleece-benchmark</a>, accessed:
04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Nicolas Hug.

</span>
<span class="ltx_bibblock">Surprise: A python library for recommender systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Journal of Open Source Software</span>, 5(52):2174, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
huggingface.

</span>
<span class="ltx_bibblock">Large Language Model Text Generation Inference.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/huggingface/text-generation-inference" title="">https://github.com/huggingface/text-generation-inference</a>,
accessed: 28.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
huggingface.

</span>
<span class="ltx_bibblock">Optimum benchmark.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/huggingface/optimum-benchmark" title="">https://github.com/huggingface/optimum-benchmark</a>, accessed:
04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
IBM.

</span>
<span class="ltx_bibblock">Mpt-7b-instruct2.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/ibm/mpt-7b-instruct2" title="">https://huggingface.co/ibm/mpt-7b-instruct2</a>, accessed:
21.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
IBM.

</span>
<span class="ltx_bibblock">Text Generation Inference Server.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/IBM/text-generation-inference" title="">https://github.com/IBM/text-generation-inference</a>, accessed:
28.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Ganesh Jawahar, Muhammad Abdul-Mageed, Laks V. S. Lakshmanan, and Dujian Ding.

</span>
<span class="ltx_bibblock">Llm performance predictors are good initializers for architecture
search, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Daniel Justus, John Brennan, Stephen Bonner, and Andrew Stephen McGough.

</span>
<span class="ltx_bibblock">Predicting the computational cost of deep learning models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">2018 IEEE International Conference on Big Data (Big Data)</span>,
pages 3873–3882, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom B. Brown, Benjamin Chess, Rewon
Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Ana Klimovic, Heiner Litz, and Christos Kozyrakis.

</span>
<span class="ltx_bibblock">Selecta: Heterogeneous cloud storage configuration for data
analytics.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">2018 USENIX Annual Technical Conference (USENIX ATC 18)</span>,
pages 759–773, Boston, MA, July 2018. USENIX Association.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng, Lianmin Zheng, Cody Hao Yu,
Joseph E. Gonzalez, Hao Zhang, and Ion Stoica.

</span>
<span class="ltx_bibblock">Efficient memory management for large language model serving with
pagedattention.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Proceedings of the ACM SIGOPS 29th Symposium on Operating
Systems Principles</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Andreas Köpf, Yannic Kilcher, Dimitri von Rütte, Sotiris Anagnostidis,
Zhi-Rui Tam, Keith Stevens, Abdullah Barhoum, Nguyen Minh Duc, Oliver
Stanley, Richárd Nagyfi, Shahul ES, Sameer Suri, David Glushkov, Arnav
Dantuluri, Andrew Maguire, Christoph Schuhmann, Huu Nguyen, and Alexander
Mattick.

</span>
<span class="ltx_bibblock">Openassistant conversations – democratizing large language model
alignment, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Raymond Li, Loubna Ben Allal, Yangtian Zi, Niklas Muennighoff, Denis Kocetkov,
Chenghao Mou, Marc Marone, Christopher Akiki, Jia Li, Jenny Chim, Qian Liu,
Evgenii Zheltonozhskii, Terry Yue Zhuo, Thomas Wang, Olivier Dehaene, Mishig
Davaadorj, Joel Lamy-Poirier, João Monteiro, Oleh Shliazhko, Nicolas
Gontier, Nicholas Meade, Armel Zebaze, Ming-Ho Yee, Logesh Kumar Umapathi,
Jian Zhu, Benjamin Lipkin, Muhtasham Oblokulov, Zhiruo Wang, Rudra Murthy,
Jason Stillerman, Siva Sankalp Patel, Dmitry Abulkhanov, Marco Zocca, Manan
Dey, Zhihan Zhang, Nour Fahmy, Urvashi Bhattacharyya, Wenhao Yu, Swayam
Singh, Sasha Luccioni, Paulo Villegas, Maxim Kunakov, Fedor Zhdanov, Manuel
Romero, Tony Lee, Nadav Timor, Jennifer Ding, Claire Schlesinger, Hailey
Schoelkopf, Jan Ebert, Tri Dao, Mayank Mishra, Alex Gu, Jennifer Robinson,
Carolyn Jane Anderson, Brendan Dolan-Gavitt, Danish Contractor, Siva Reddy,
Daniel Fried, Dzmitry Bahdanau, Yacine Jernite, Carlos Muñoz Ferrandis, Sean
Hughes, Thomas Wolf, Arjun Guha, Leandro von Werra, and Harm de Vries.

</span>
<span class="ltx_bibblock">Starcoder: may the source be with you!

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Wing Lian, Bleys Goodson, Eugene Pentland, Austin Cook, Chanvichet Vong, and
”Teknium”.

</span>
<span class="ltx_bibblock">Openorca: An open dataset of gpt augmented flan reasoning traces.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://https://huggingface.co/Open-Orca/OpenOrca" title="">https://https://huggingface.co/Open-Orca/OpenOrca</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Shayne Longpre, Le Hou, Tu Vu, Albert Webson, Hyung Won Chung, Yi Tay, Denny
Zhou, Quoc V. Le, Barret Zoph, Jason Wei, and Adam Roberts.

</span>
<span class="ltx_bibblock">The flan collection: Designing data and methods for effective
instruction tuning, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Niklas Muennighoff, Thomas Wang, Lintang Sutawika, Adam Roberts, Stella
Biderman, Teven Le Scao, M Saiful Bari, Sheng Shen, Zheng-Xin Yong, Hailey
Schoelkopf, et al.

</span>
<span class="ltx_bibblock">Crosslingual generalization through multitask finetuning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2211.01786</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Subhabrata Mukherjee, Arindam Mitra, Ganesh Jawahar, Sahaj Agarwal, Hamid
Palangi, and Ahmed Awadallah.

</span>
<span class="ltx_bibblock">Orca: Progressive learning from complex explanation traces of gpt-4,
2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Deepak Narayanan, Mohammad Shoeybi, Jared Casper, Patrick LeGresley, Mostofa
Patwary, Vijay Anand Korthikanti, Dmitri Vainbrand, Prethvi Kashinkunti,
Julie Bernauer, Bryan Catanzaro, Amar Phanishayee, and Matei Zaharia.

</span>
<span class="ltx_bibblock">Efficient large-scale language model training on gpu clusters using
megatron-lm, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Humza Naveed, Asad Ullah Khan, Shi Qiu, Muhammad Saqib, Saeed Anwar, Muhammad
Usman, Naveed Akhtar, Nick Barnes, and Ajmal Mian.

</span>
<span class="ltx_bibblock">A comprehensive overview of large language models, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Vercel NextJS and Upstash.

</span>
<span class="ltx_bibblock">Sharegpt.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://sharegpt.com/" title="">https://sharegpt.com/</a>, accessed: 04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Erik Nijkamp, Hiroaki Hayashi, Caiming Xiong, Silvio Savarese, and Yingbo Zhou.

</span>
<span class="ltx_bibblock">Codegen2: Lessons for training llms on programming and natural
languages.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">arXiv preprint</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
NVIDIA Corporation.

</span>
<span class="ltx_bibblock">Triton Inference Server: An Optimized Cloud and Edge Inferencing
Solution.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/triton-inference-server/server" title="">https://github.com/triton-inference-server/server</a>, accessed:
28.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Emmanuel Ohiri.

</span>
<span class="ltx_bibblock">How ai is contributing to the gpu shortage.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.cudocompute.com/blog/gpu-supply-shortage-due-to-ai-needs/" title="">https://www.cudocompute.com/blog/gpu-supply-shortage-due-to-ai-needs/</a>,
accessed: 04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Optimum.

</span>
<span class="ltx_bibblock">Llm-perf leaderboard.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/spaces/optimum/llm-perf-leaderboard" title="">https://huggingface.co/spaces/optimum/llm-perf-leaderboard</a>,
accessed: 11.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Pankesh Patel, Ajith Ranabahu, and Amit Sheth.

</span>
<span class="ltx_bibblock">Service level agreement in cloud computing.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Proceedings of International Conference on Object-Oriented
Programming, Systems, Languages and Applications (OOPSLA) Cloud Computing
workshop</span>, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Ray Project.

</span>
<span class="ltx_bibblock">Llmperf.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ray-project/llmperf" title="">https://github.com/ray-project/llmperf</a>, accessed: 04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Marco Ramponi.

</span>
<span class="ltx_bibblock">Why language models became large language models and the hurdles in
developing llm-based applications.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.assemblyai.com/blog/why-language-models-became-large-language-models" title="">https://www.assemblyai.com/blog/why-language-models-became-large-language-models</a>,
accessed: 04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Red Hat.

</span>
<span class="ltx_bibblock">Red Hat Openshift.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.redhat.com/en/technologies/cloud-computing/openshift" title="">https://www.redhat.com/en/technologies/cloud-computing/openshift</a>,
accessed: 28.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Vijay Janapa Reddi, Christine Cheng, David Kanter, Peter Mattson, Guenther
Schmuelling, Carole-Jean Wu, Brian Anderson, Maximilien Breughe, Mark
Charlebois, William Chou, Ramesh Chukka, Cody Coleman, Sam Davis, Pan Deng,
Greg Diamos, Jared Duke, Dave Fick, J. Scott Gardner, Itay Hubara, Sachin
Idgunji, Thomas B. Jablin, Jeff Jiao, Tom St. John, Pankaj Kanwar, David Lee,
Jeffery Liao, Anton Lokhmotov, Francisco Massa, Peng Meng, Paulius
Micikevicius, Colin Osborne, Gennady Pekhimenko, Arun Tejusve Raghunath
Rajan, Dilip Sequeira, Ashish Sirasao, Fei Sun, Hanlin Tang, Michael Thomson,
Frank Wei, Ephrem Wu, Lingjie Xu, Koichi Yamada, Bing Yu, George Yuan, Aaron
Zhong, Peizhao Zhang, and Yuchen Zhou.

</span>
<span class="ltx_bibblock">Mlperf inference benchmark, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Run:ai.

</span>
<span class="ltx_bibblock">How to achieve almost 2x inference throughput and reduce latency
leveraging multi-gpu setup.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.run.ai/blog/achieve-2x-inference-throughput-reduce-latency-leveraging-multi-gpu" title="">https://www.run.ai/blog/achieve-2x-inference-throughput-reduce-latency-leveraging-multi-gpu</a>,
accessed: 28.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Siddharth Samsi, Dan Zhao, Joseph McDonald, Baolin Li, Adam Michaleas, Michael
Jones, William Bergeron, Jeremy Kepner, Devesh Tiwari, and Vijay Gadepally.

</span>
<span class="ltx_bibblock">From words to watts: Benchmarking the energy costs of large language
model inference, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Julien Simon.

</span>
<span class="ltx_bibblock">Large language models: A new moore’s law?

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/blog/large-language-models" title="">https://huggingface.co/blog/large-language-models</a>, accessed:
04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
C. Spearman.

</span>
<span class="ltx_bibblock">The proof and measurement of association between two things.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">The American Journal of Psychology</span>, 15(1):72–101, 1904.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Foteini Strati, Sara Mcallister, Amar Phanishayee, Jakub Tarnawski, and Ana
Klimovic.

</span>
<span class="ltx_bibblock">Déjàvu: Kv-cache streaming for fast, fault-tolerant generative
llm serving, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Emma Strubell, Ananya Ganesh, and Andrew McCallum.

</span>
<span class="ltx_bibblock">Energy and policy considerations for deep learning in nlp, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos
Guestrin, Percy Liang, and Tatsunori B. Hashimoto.

</span>
<span class="ltx_bibblock">Stanford alpaca: An instruction-following llama model.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/tatsu-lab/stanford_alpaca" title="">https://github.com/tatsu-lab/stanford_alpaca</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Yi Tay.

</span>
<span class="ltx_bibblock">A new open source flan 20b with ul2.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.yitay.net/blog/flan-ul2-20b" title="">https://www.yitay.net/blog/flan-ul2-20b</a>, accessed: 21.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
TensorChord.

</span>
<span class="ltx_bibblock">inference-benchmark.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/tensorchord/inference-benchmark/" title="">https://github.com/tensorchord/inference-benchmark/</a>, accessed:
04.03.2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
Dan Bikel, Lukas Blecher, Cristian Canton Ferrer, Moya Chen, Guillem
Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller,
Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar
Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa,
Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux,
Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier
Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew
Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan
Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang,
Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan
Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien
Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">Advances in Neural Information Processing Systems</span>,
volume 30. Curran Associates, Inc., 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Chuan-Chi Wang, Ying-Chiao Liao, Ming-Chang Kao, Wen-Yew Liang, and Shih-Hao
Hung.

</span>
<span class="ltx_bibblock">Perfnet: Platform-aware performance modeling for deep neural
networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">Proceedings of the International Conference on Research in
Adaptive and Convergent Systems</span>, RACS ’20, page 90–95, New York, NY, USA,
2020. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Chuan-Chi Wang, Ying-Chiao Liao, Ming-Chang Kao, Wen-Yew Liang, and Shih-Hao
Hung.

</span>
<span class="ltx_bibblock">Toward accurate platform-aware performance modeling for deep neural
networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib50.1.1">SIGAPP Appl. Comput. Rev.</span>, 21(1):50–61, jul 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Luping Wang, Lingyun Yang, Yinghao Yu, Wei Wang, Bo Li, Xianchao Sun, Jian He,
and Liping Zhang.

</span>
<span class="ltx_bibblock">Morphling: Fast, near-optimal auto-configuration for cloud-native
model serving.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib51.1.1">Proceedings of the ACM Symposium on Cloud Computing</span>, SoCC
’21, page 639–653, New York, NY, USA, 2021. Association for Computing
Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Yizhong Wang, Yeganeh Kordi, Swaroop Mishra, Alisa Liu, Noah A. Smith, Daniel
Khashabi, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Self-instruct: Aligning language model with self generated
instructions, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Jason Wei, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian
Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, Ed H.
Chi, Tatsunori Hashimoto, Oriol Vinyals, Percy Liang, Jeff Dean, and William
Fedus.

</span>
<span class="ltx_bibblock">Emergent abilities of large language models, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Yuewen Wu, Heng Wu, Diaohan Luo, Yuanjia Xu, Yi Hu, Wenbo Zhang, and Hua Zhong.

</span>
<span class="ltx_bibblock">Serving unseen deep learning models with near-optimal configurations:
a fast adaptive search approach.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib54.1.1">Proceedings of the 13th Symposium on Cloud Computing</span>, SoCC
’22, page 461–476, New York, NY, USA, 2022. Association for Computing
Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Neeraja J. Yadwadkar, Bharath Hariharan, Joseph E. Gonzalez, Burton Smith, and
Randy H. Katz.

</span>
<span class="ltx_bibblock">Selecting the best vm across multiple public clouds: A data-driven
performance modeling approach.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">Proceedings of the 2017 Symposium on Cloud Computing</span>, SoCC
’17, page 452–465, New York, NY, USA, 2017. Association for Computing
Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Qinyuan Ye, Harvey Yiyun Fu, Xiang Ren, and Robin Jia.

</span>
<span class="ltx_bibblock">How predictable are large language model capabilities? a case study
on big-bench, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Gyeong-In Yu, Joo Seong Jeong, Geon-Woo Kim, Soojeong Kim, and Byung-Gon Chun.

</span>
<span class="ltx_bibblock">Orca: A distributed serving system for Transformer-Based generative
models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib57.1.1">16th USENIX Symposium on Operating Systems Design and
Implementation (OSDI 22)</span>, pages 521–538, Carlsbad, CA, July 2022. USENIX
Association.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Wayne Xin Zhao, Kun Zhou, Junyi Li, Tianyi Tang, Xiaolei Wang, Yupeng Hou,
Yingqian Min, Beichen Zhang, Junjie Zhang, Zican Dong, Yifan Du, Chen Yang,
Yushuo Chen, Zhipeng Chen, Jinhao Jiang, Ruiyang Ren, Yifan Li, Xinyu Tang,
Zikang Liu, Peiyu Liu, Jian-Yun Nie, and Ji-Rong Wen.

</span>
<span class="ltx_bibblock">A survey of large language models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao
Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric. P Xing, Hao Zhang, Joseph E.
Gonzalez, and Ion Stoica.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Yinmin Zhong, Junda Chen, Shengyu Liu, Yibo Zhu, Xin Jin, and Hao Zhang.

</span>
<span class="ltx_bibblock">Throughput is not all you need: Maximizing goodput in llm serving
using prefill-decode disaggregation.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://hao-ai-lab.github.io/blogs/distserve/" title="">https://hao-ai-lab.github.io/blogs/distserve/</a>, accessed:
25.03.2024.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 11:53:18 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
