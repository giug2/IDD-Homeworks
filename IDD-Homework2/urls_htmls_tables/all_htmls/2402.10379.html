<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2402.10379] DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows</title><meta property="og:description" content="Large language models (LLMs) have become a dominant and important tool for NLP researchers in a wide range of tasks. Today, many researchers use LLMs in synthetic data generation, task evaluation, fine-tuning, distilla…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2402.10379">

<!--Generated on Tue Mar  5 16:39:07 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">DataDreamer: A Tool for Synthetic Data Generation and
<br class="ltx_break">Reproducible LLM Workflows</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ajay Patel 
<br class="ltx_break">University of Pennsylvania 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">ajayp@upenn.edu</span> 
<br class="ltx_break">&amp;Colin Raffel 
<br class="ltx_break">University of Toronto 
<br class="ltx_break">Vector Institute 
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">craffel@gmail.com</span> 
<br class="ltx_break">&amp;Chris Callison-Burch 
<br class="ltx_break">University of Pennsylvania 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">ccb@upenn.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Large language models (LLMs) have become a dominant and important tool for NLP researchers in a wide range of tasks. Today, many researchers use LLMs in synthetic data generation, task evaluation, fine-tuning, distillation, and other model-in-the-loop research workflows. However, challenges arise when using these models that stem from their scale, their closed source nature, and the lack of standardized tooling for these new and emerging workflows. The rapid rise to prominence of these models and these unique challenges has had immediate adverse impacts on open science and on the reproducibility of work that uses them. In this paper, we introduce DataDreamer, an open source Python library that allows researchers to write simple code to implement powerful LLM workflows. DataDreamer also helps researchers adhere to best practices that we propose to encourage open science and reproducibility. The library and documentation are available at: <a target="_blank" href="https://github.com/datadreamer-dev/DataDreamer" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/datadreamer-dev/DataDreamer</a>.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<div id="p1.1" class="ltx_block ltx_align_bottom">
<p id="p1.1.1" class="ltx_p"><span id="p1.1.1.1" class="ltx_text ltx_font_bold">DataDreamer: A Tool for Synthetic Data Generation and
<br class="ltx_break">Reproducible LLM Workflows</span></p>
<br class="ltx_break ltx_centering">
<p id="p1.1.2" class="ltx_p ltx_align_center" style="width:433.6pt;"><span id="p1.1.2.1" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p1.1.2.1.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p1.1.2.1.1.1.1" class="ltx_tr">
<span id="p1.1.2.1.1.1.1.1" class="ltx_td ltx_align_center"><span id="p1.1.2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Ajay Patel</span></span></span>
<span id="p1.1.2.1.1.2.2" class="ltx_tr">
<span id="p1.1.2.1.1.2.2.1" class="ltx_td ltx_align_center">University of Pennsylvania</span></span>
<span id="p1.1.2.1.1.3.3" class="ltx_tr">
<span id="p1.1.2.1.1.3.3.1" class="ltx_td ltx_align_center"><span id="p1.1.2.1.1.3.3.1.1" class="ltx_text ltx_font_typewriter">ajayp@upenn.edu</span></span></span>
</span>
</span></span>                      <span id="p1.1.2.2" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p1.1.2.2.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p1.1.2.2.1.1.1" class="ltx_tr">
<span id="p1.1.2.2.1.1.1.1" class="ltx_td ltx_align_center"><span id="p1.1.2.2.1.1.1.1.1" class="ltx_text ltx_font_bold">Colin Raffel</span></span></span>
<span id="p1.1.2.2.1.2.2" class="ltx_tr">
<span id="p1.1.2.2.1.2.2.1" class="ltx_td ltx_align_center">University of Toronto</span></span>
<span id="p1.1.2.2.1.3.3" class="ltx_tr">
<span id="p1.1.2.2.1.3.3.1" class="ltx_td ltx_align_center">Vector Institute</span></span>
<span id="p1.1.2.2.1.4.4" class="ltx_tr">
<span id="p1.1.2.2.1.4.4.1" class="ltx_td ltx_align_center"><span id="p1.1.2.2.1.4.4.1.1" class="ltx_text ltx_font_typewriter">craffel@gmail.com</span></span></span>
</span>
</span></span>                      <span id="p1.1.2.3" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p1.1.2.3.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p1.1.2.3.1.1.1" class="ltx_tr">
<span id="p1.1.2.3.1.1.1.1" class="ltx_td ltx_align_center"><span id="p1.1.2.3.1.1.1.1.1" class="ltx_text ltx_font_bold">Chris Callison-Burch</span></span></span>
<span id="p1.1.2.3.1.2.2" class="ltx_tr">
<span id="p1.1.2.3.1.2.2.1" class="ltx_td ltx_align_center">University of Pennsylvania</span></span>
<span id="p1.1.2.3.1.3.3" class="ltx_tr">
<span id="p1.1.2.3.1.3.3.1" class="ltx_td ltx_align_center"><span id="p1.1.2.3.1.3.3.1.1" class="ltx_text ltx_font_typewriter">ccb@upenn.edu</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering">
</div>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2402.10379/assets/resources/figures/DataDreamerRecursive.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="298" height="429" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>DataDreamer helps researchers implement many types of LLM workflows easier and makes reproducibility automatic and simple. These workflows often involve synthetic data generation with a LLM-in-the-loop and/or fine-tuning, aligning, and distilling models.</figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">While large language models (LLMs) have established a new era in NLP research
through the prompt-and-predict paradigm that has proven effective on a wide variety of tasks, the use of these models has come with significant drawbacks <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite>. Many popular models like GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite> are closed source and behind a remote API, while running models locally can be technically complex and expensive due to their scale. Moreover, the now well-established prompting paradigm can be brittle with results widely varying between different models, configurations, and environments <cite class="ltx_cite ltx_citemacro_citep">(Sclar et al., <a href="#bib.bib36" title="" class="ltx_ref">2023</a>; Jaiswal et al., <a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite>. These challenges have made it difficult for researchers to share, reproduce, extend, and compare work, hindering the rate of research progress.</p>
</div>
<figure id="S1.T1" class="ltx_table">
<table id="S1.T1.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S1.T1.4.5.1" class="ltx_tr">
<td id="S1.T1.4.5.1.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S1.T1.4.5.1.1.1" class="ltx_text ltx_font_bold">Feature</span></td>
<td id="S1.T1.4.5.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S1.T1.4.5.1.2.1" class="ltx_text ltx_font_bold">LangChain<span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span></span></td>
<td id="S1.T1.4.5.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S1.T1.4.5.1.3.1" class="ltx_text ltx_font_bold">Axlotl<span id="footnotex2" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span></span></td>
<td id="S1.T1.4.5.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S1.T1.4.5.1.4.1" class="ltx_text ltx_font_bold">HF Transformers + TRL<span id="footnotex3" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span></span></td>
<td id="S1.T1.4.5.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S1.T1.4.5.1.5.1" class="ltx_text ltx_font_bold">DataDreamer</span></td>
</tr>
<tr id="S1.T1.4.6.2" class="ltx_tr">
<td id="S1.T1.4.6.2.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" colspan="5"><span id="S1.T1.4.6.2.1.1" class="ltx_text ltx_font_italic">Implementation</span></td>
</tr>
<tr id="S1.T1.4.7.3" class="ltx_tr">
<td id="S1.T1.4.7.3.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Accessible via Python API</td>
<td id="S1.T1.4.7.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.7.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.7.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.7.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.8.4" class="ltx_tr">
<td id="S1.T1.4.8.4.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Built for Researchers</td>
<td id="S1.T1.4.8.4.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.8.4.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.8.4.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.8.4.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.9.5" class="ltx_tr">
<td id="S1.T1.4.9.5.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" colspan="5"><span id="S1.T1.4.9.5.1.1" class="ltx_text ltx_font_italic">Integrations</span></td>
</tr>
<tr id="S1.T1.4.10.6" class="ltx_tr">
<td id="S1.T1.4.10.6.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Open Source Models</td>
<td id="S1.T1.4.10.6.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.10.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.10.6.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.10.6.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.11.7" class="ltx_tr">
<td id="S1.T1.4.11.7.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Commercial &amp; API-based Models</td>
<td id="S1.T1.4.11.7.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.11.7.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.11.7.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.11.7.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.12.8" class="ltx_tr">
<td id="S1.T1.4.12.8.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" colspan="5"><span id="S1.T1.4.12.8.1.1" class="ltx_text ltx_font_italic">Tasks</span></td>
</tr>
<tr id="S1.T1.4.13.9" class="ltx_tr">
<td id="S1.T1.4.13.9.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Prompting &amp; Prompt “Chaining”</td>
<td id="S1.T1.4.13.9.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.13.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.13.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.13.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.14.10" class="ltx_tr">
<td id="S1.T1.4.14.10.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Synthetic Data Generation &amp; Augmentation</td>
<td id="S1.T1.4.14.10.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.14.10.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.14.10.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.14.10.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.15.11" class="ltx_tr">
<td id="S1.T1.4.15.11.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Fine-tuning LLMs</td>
<td id="S1.T1.4.15.11.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.15.11.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.15.11.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.15.11.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.16.12" class="ltx_tr">
<td id="S1.T1.4.16.12.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Instruction-tuning LLMs</td>
<td id="S1.T1.4.16.12.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.16.12.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.16.12.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.16.12.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.17.13" class="ltx_tr">
<td id="S1.T1.4.17.13.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Aligning LLMs</td>
<td id="S1.T1.4.17.13.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.17.13.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.17.13.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.17.13.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.18.14" class="ltx_tr">
<td id="S1.T1.4.18.14.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Training Classifier Models</td>
<td id="S1.T1.4.18.14.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.18.14.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.18.14.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.18.14.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.19.15" class="ltx_tr">
<td id="S1.T1.4.19.15.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Training Embedding Models</td>
<td id="S1.T1.4.19.15.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.19.15.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.19.15.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.19.15.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.20.16" class="ltx_tr">
<td id="S1.T1.4.20.16.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" colspan="5"><span id="S1.T1.4.20.16.1.1" class="ltx_text ltx_font_italic">Conveniences</span></td>
</tr>
<tr id="S1.T1.1.1" class="ltx_tr">
<td id="S1.T1.1.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Caching</td>
<td id="S1.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><math id="S1.T1.1.1.1.m1.1" class="ltx_Math" alttext="\ocircle" display="inline"><semantics id="S1.T1.1.1.1.m1.1a"><mi mathvariant="normal" id="S1.T1.1.1.1.m1.1.1" xref="S1.T1.1.1.1.m1.1.1.cmml">○</mi><annotation-xml encoding="MathML-Content" id="S1.T1.1.1.1.m1.1b"><ci id="S1.T1.1.1.1.m1.1.1.cmml" xref="S1.T1.1.1.1.m1.1.1">○</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.1.1.1.m1.1c">\ocircle</annotation></semantics></math></td>
<td id="S1.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.2.2" class="ltx_tr">
<td id="S1.T1.2.2.2" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Resumability</td>
<td id="S1.T1.2.2.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.2.2.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.2.2.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><math id="S1.T1.2.2.1.m1.1" class="ltx_Math" alttext="\ocircle" display="inline"><semantics id="S1.T1.2.2.1.m1.1a"><mi mathvariant="normal" id="S1.T1.2.2.1.m1.1.1" xref="S1.T1.2.2.1.m1.1.1.cmml">○</mi><annotation-xml encoding="MathML-Content" id="S1.T1.2.2.1.m1.1b"><ci id="S1.T1.2.2.1.m1.1.1.cmml" xref="S1.T1.2.2.1.m1.1.1">○</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.2.2.1.m1.1c">\ocircle</annotation></semantics></math></td>
<td id="S1.T1.2.2.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.21.17" class="ltx_tr">
<td id="S1.T1.4.21.17.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Simplifies Boilerplate Code (tokenization, etc.)</td>
<td id="S1.T1.4.21.17.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.21.17.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.21.17.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.21.17.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.3.3" class="ltx_tr">
<td id="S1.T1.3.3.2" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Simplifies Multi-GPU Inference and Training</td>
<td id="S1.T1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.3.3.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><math id="S1.T1.3.3.1.m1.1" class="ltx_Math" alttext="\ocircle" display="inline"><semantics id="S1.T1.3.3.1.m1.1a"><mi mathvariant="normal" id="S1.T1.3.3.1.m1.1.1" xref="S1.T1.3.3.1.m1.1.1.cmml">○</mi><annotation-xml encoding="MathML-Content" id="S1.T1.3.3.1.m1.1b"><ci id="S1.T1.3.3.1.m1.1.1.cmml" xref="S1.T1.3.3.1.m1.1.1">○</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.3.3.1.m1.1c">\ocircle</annotation></semantics></math></td>
<td id="S1.T1.3.3.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.3.3.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.4" class="ltx_tr">
<td id="S1.T1.4.4.2" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Publishing Datasets &amp; Models</td>
<td id="S1.T1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.4.1" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><math id="S1.T1.4.4.1.m1.1" class="ltx_Math" alttext="\ocircle" display="inline"><semantics id="S1.T1.4.4.1.m1.1a"><mi mathvariant="normal" id="S1.T1.4.4.1.m1.1.1" xref="S1.T1.4.4.1.m1.1.1.cmml">○</mi><annotation-xml encoding="MathML-Content" id="S1.T1.4.4.1.m1.1b"><ci id="S1.T1.4.4.1.m1.1.1.cmml" xref="S1.T1.4.4.1.m1.1.1">○</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.4.4.1.m1.1c">\ocircle</annotation></semantics></math></td>
<td id="S1.T1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
<td id="S1.T1.4.4.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.22.18" class="ltx_tr">
<td id="S1.T1.4.22.18.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;" colspan="5"><span id="S1.T1.4.22.18.1.1" class="ltx_text ltx_font_italic">Open Science and Reproducibility</span></td>
</tr>
<tr id="S1.T1.4.23.19" class="ltx_tr">
<td id="S1.T1.4.23.19.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Reproducibility Fingerprints</td>
<td id="S1.T1.4.23.19.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.23.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.23.19.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.23.19.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.24.20" class="ltx_tr">
<td id="S1.T1.4.24.20.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Saves Intermediate Outputs</td>
<td id="S1.T1.4.24.20.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.24.20.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.24.20.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.24.20.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
<tr id="S1.T1.4.25.21" class="ltx_tr">
<td id="S1.T1.4.25.21.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">Synthetic Data and Model Cards</td>
<td id="S1.T1.4.25.21.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.25.21.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.25.21.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">✗</td>
<td id="S1.T1.4.25.21.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">✓</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>We compare feature coverage between other popular libraries and solutions available to researchers today that target similar workflows. DataDreamer integrates these features into a single library with a standardized interface making experimentation and chaining data between tasks simple. (✗= No; ✓= Yes; <math id="S1.T1.6.m1.1" class="ltx_Math" alttext="\ocircle" display="inline"><semantics id="S1.T1.6.m1.1b"><mi mathvariant="normal" id="S1.T1.6.m1.1.1" xref="S1.T1.6.m1.1.1.cmml">○</mi><annotation-xml encoding="MathML-Content" id="S1.T1.6.m1.1c"><ci id="S1.T1.6.m1.1.1.cmml" xref="S1.T1.6.m1.1.1">○</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.6.m1.1d">\ocircle</annotation></semantics></math> = Partial Support)
</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In context of the rapid shift to using these large models in research, we introduce DataDreamer, our open source Python package that provides both practical utility to researchers and scientific utility to the community:</p>
</div>
<div id="S1.p3" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">DataDreamer helps researchers implement state-of-the-art emerging workflows involving LLMs such as synthetic data generation, fine-tuning, instruction-tuning, and alignment. It simplifies implementations by providing a single library with a standardized interface for many of these tasks while reducing technical complexity around switching between models, caching, resumability, logging, multi-GPU inference and training, using adapter and quantization optimizations, and publishing open datasets and models.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">DataDreamer makes chaining data between tasks, an increasingly common practice, simple. For example, a user can generate data with a synthetic data workflow and then fine-tune on that synthetic data.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">DataDreamer helps researchers implement workflows while crucially producing output that is compatible with open science and reproducible ideals with minimal effort, through automatic caching, reproducibility fingerprints, and more best-practice artifacts.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>LLM Workflows</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">To motivate DataDreamer, we first discuss the LLM workflows that it supports. We discuss challenges to open science that arise from these usage patterns. In this paper, we do not seek to validate or critique these approaches. Instead, we offer a solution to implement them and make them reproducible. These LLM workflows are often used in combination with each other <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a href="#bib.bib48" title="" class="ltx_ref">2024</a>)</cite>, and orchestration of multi-stage workflows is frequently implemented through multiple shell or Python scripts. Reproducing these multi-stage workflows is challenging as shell scripts may rely upon a particular author’s job scheduler or environment and require execution in a specific order. In Section <a href="#S4" title="4 DataDreamer ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S5" title="5 Reproducibility ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we discuss how DataDreamer’s task orchestration, caching system, and simple multi-GPU training make it easier to implement these multi-stage workflows in a single Python program, minimizing these issues.</p>
</div>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Synthetic Data Generation</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Recent work has explored using LLMs to create synthetic data for tasks or to augment existing datasets to boost task performance <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib47" title="" class="ltx_ref">2023</a>; Kumar et al., <a href="#bib.bib16" title="" class="ltx_ref">2020a</a>, <a href="#bib.bib17" title="" class="ltx_ref">b</a>; Yoo et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>; Han et al., <a href="#bib.bib9" title="" class="ltx_ref">2021a</a>; Ye et al., <a href="#bib.bib45" title="" class="ltx_ref">2022</a>; Honovich et al., <a href="#bib.bib11" title="" class="ltx_ref">2022</a>, <span id="S2.SS0.SSS0.Px1.p1.1.1.1" class="ltx_text ltx_font_italic">inter alia</span>)</cite>. Synthetic data generation involves using a LLM once or multiple times in a multi-stage workflow to process data, sometimes referred to as “chaining” <cite class="ltx_cite ltx_citemacro_citep">(Rush, <a href="#bib.bib34" title="" class="ltx_ref">2023</a>)</cite>. When prompting LLMs to generate or augment datasets, a reproducibility challenge that arises is “prompt sensitivity” where even small variations in a prompt can lead to significantly different results <cite class="ltx_cite ltx_citemacro_citep">(Sclar et al., <a href="#bib.bib36" title="" class="ltx_ref">2023</a>)</cite>. Moreover, it is imperative to tag synthetically generated datasets because of model degradation concerns <cite class="ltx_cite ltx_citemacro_citep">(Shumailov et al., <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">LLMs for Task Evaluation</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Another increasingly common workflow is using LLMs as judges or as automatic metrics for evaluating a model’s performance on a task <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a href="#bib.bib51" title="" class="ltx_ref">2023</a>; Fu et al., <a href="#bib.bib7" title="" class="ltx_ref">2023</a>; Dubois et al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>; Chiang and Lee, <a href="#bib.bib4" title="" class="ltx_ref">2023</a>, <span id="S2.SS0.SSS0.Px2.p1.1.1.1" class="ltx_text ltx_font_italic">inter alia</span>)</cite>. Many of the reproducibility challenges applicable to synthetic data also arise here.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Fine-tuning and Alignment</h4>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">Another common workflow is the creation of task-specific expert models using knowledge from larger models to create smaller, more efficient models via fine-tuning and distillation <cite class="ltx_cite ltx_citemacro_citep">(Han et al., <a href="#bib.bib10" title="" class="ltx_ref">2021b</a>; Liu et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>; Hsieh et al., <a href="#bib.bib12" title="" class="ltx_ref">2023</a>)</cite>. Instruction-tuning is fine-tuning that allows base pre-trained models to better follow natural language human instruction and improve their generalized task performance <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>; Wei et al., <a href="#bib.bib42" title="" class="ltx_ref">2021</a>; Sanh et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>; Mishra et al., <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. Closely related, alignment techniques steer model responses towards those more preferable to humans <cite class="ltx_cite ltx_citemacro_citep">(Stiennon et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>; Bai et al., <a href="#bib.bib1" title="" class="ltx_ref">2022</a>; Rafailov et al., <a href="#bib.bib31" title="" class="ltx_ref">2023</a>)</cite>. Implementing resumability and efficient training techniques are practical challenges often faced. Reproducibility challenges include sharing exact data and hyperparameters.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Self-improving LLMs</h4>

<div id="S2.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px4.p1.1" class="ltx_p">Self-improving LLMs through self-feedback training loops is an increasingly active area of research interest <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib14" title="" class="ltx_ref">2022</a>; Wang et al., <a href="#bib.bib41" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>; Chen et al., <a href="#bib.bib3" title="" class="ltx_ref">2024</a>; Yuan et al., <a href="#bib.bib48" title="" class="ltx_ref">2024</a>; Gunasekar et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>. These workflows can be uniquely complex to both implement and reproduce due to requiring multiple rounds that chain together synthetic data generation, automatic evaluation, and model re-training. DataDreamer supports all of these workflows and makes it simple to chain data between them.</p>
</div>
<span id="footnotex4" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">0</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">0</sup><span class="ltx_note_type">footnotetext: </span><a target="_blank" href="https://github.com/langchain-ai/langchain" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/langchain-ai/langchain</a></span></span></span><span id="footnotex5" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">0</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">0</sup><span class="ltx_note_type">footnotetext: </span><a target="_blank" href="https://github.com/OpenAccess-AI-Collective/axolotl" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/OpenAccess-AI-Collective/axolotl</a></span></span></span>
<div class="ltx_pagination ltx_role_newpage"></div>
<span id="footnotex6" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">0</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">0</sup><span class="ltx_note_type">footnotetext: </span><cite class="ltx_cite ltx_citemacro_citet">Wolf et al. (<a href="#bib.bib43" title="" class="ltx_ref">2019</a>); von Werra et al. (<a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite></span></span></span>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Demonstration and Examples</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Before delving into the structure and implementation of DataDreamer, we first provide a simple demonstration of DataDreamer’s capabilities and API through an example synthetic data generation and distillation workflow in Example <a href="#LST1" title="Example 1 ‣ 3 Demonstration and Examples ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The LLM used in this example is GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI et al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>. As an initial step, the example uses the LLM to generate 1,000 NLP research paper abstracts. The LLM is then used to summarize those abstracts in a tweet-like style. These two steps result in a fully synthetic dataset of abstracts and tweets summarizing them. Using a trainer, this synthetic dataset is then distilled to a small, local model that is capable of summarizing paper abstracts in a tweet-like style. As a final step, the example demonstrates how both the synthetic dataset and the trained model can be published and shared. For illustrative purposes, we demonstrate a sample generation of the trained model’s output on this paper’s abstract:

<br class="ltx_break"></p>
<p id="S3.p1.2" class="ltx_p ltx_align_center"><span id="S3.p1.2.1" class="ltx_text">
<span id="S3.p1.2.1.1" class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" style="width:175.0pt;">
<span id="S3.p1.2.1.1.1" class="ltx_p ltx_align_left">“Introducing DataDreamer, an open source Python library for advanced #NLP workflows. It offers easy code to create powerful LLM workflows, addressing challenges in scale, closed source nature, and tooling. A step towards open science and reproducibility! #AI #MachineLearning”</span>
</span></span></p>
<br class="ltx_break">
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">Further example workflows can be found in the Appendix (Example <a href="#LST2" title="Example 2 ‣ Appendix A Instruction-Tuning a LLM ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Example <a href="#LST3" title="Example 3 ‣ Appendix B Aligning a LLM ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, Example <a href="#LST4" title="Example 4 ‣ Appendix C Self-Rewarding LLMs ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, Example <a href="#LST5" title="Example 5 ‣ Appendix D Augmenting an Existing Dataset ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<figure id="LST1" class="ltx_float ltx_lstlisting">
<div id="LST1.1" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSBkYXRhZHJlYW1lciBpbXBvcnQgRGF0YURyZWFtZXIKZnJvbSBkYXRhZHJlYW1lci5sbG1zIGltcG9ydCBPcGVuQUkKZnJvbSBkYXRhZHJlYW1lci5zdGVwcyBpbXBvcnQgRGF0YUZyb21Qcm9tcHQsIFByb2Nlc3NXaXRoUHJvbXB0CmZyb20gZGF0YWRyZWFtZXIudHJhaW5lcnMgaW1wb3J0IFRyYWluSEZGaW5lVHVuZQpmcm9tIHBlZnQgaW1wb3J0IExvcmFDb25maWcKCndpdGggRGF0YURyZWFtZXIoIi4vb3V0cHV0Iik6CiAgICAjIExvYWQgR1BULTQKICAgIGdwdF80ID0gT3BlbkFJKG1vZGVsX25hbWU9ImdwdC00IikKCiAgICAjIEdlbmVyYXRlIHN5bnRoZXRpYyBhclhpdi1zdHlsZSByZXNlYXJjaCBwYXBlciBhYnN0cmFjdHMgd2l0aCBHUFQtNAogICAgYXJ4aXZfZGF0YXNldCA9IERhdGFGcm9tUHJvbXB0KAogICAgICAgICJHZW5lcmF0ZSBSZXNlYXJjaCBQYXBlciBBYnN0cmFjdHMiLAogICAgICAgIGFyZ3M9ewogICAgICAgICAgICAibGxtIjogZ3B0XzQsCiAgICAgICAgICAgICJuIjogMTAwMCwKICAgICAgICAgICAgInRlbXBlcmF0dXJlIjogMS4yLAogICAgICAgICAgICAiaW5zdHJ1Y3Rpb24iOiAoCiAgICAgICAgICAgICAgIkdlbmVyYXRlIGFuIGFyWGl2IGFic3RyYWN0IG9mIGFuIE5MUCByZXNlYXJjaCBwYXBlci4iCiAgICAgICAgICAgICAgIiBSZXR1cm4ganVzdCB0aGUgYWJzdHJhY3QsIG5vIHRpdGxlcy4iCiAgICAgICAgICAgICksCiAgICAgICAgfSwKICAgICAgICBvdXRwdXRzPXsiZ2VuZXJhdGlvbnMiOiAiYWJzdHJhY3RzIn0sCiAgICApCgogICAgIyBVc2UgR1BULTQgdG8gY29udmVydCB0aGUgYWJzdHJhY3RzIHRvIHR3ZWV0cwogICAgYWJzdHJhY3RzX2FuZF90d2VldHMgPSBQcm9jZXNzV2l0aFByb21wdCgKICAgICAgICAiR2VuZXJhdGUgVHdlZXRzIGZyb20gQWJzdHJhY3RzIiwKICAgICAgICBpbnB1dHM9eyJpbnB1dHMiOiBhcnhpdl9kYXRhc2V0Lm91dHB1dFsiYWJzdHJhY3RzIl19LAogICAgICAgIGFyZ3M9ewogICAgICAgICAgImxsbSI6IGdwdF80LAogICAgICAgICAgImluc3RydWN0aW9uIjogIkdpdmVuIHRoZSBhYnN0cmFjdCwgd3JpdGUgYSB0d2VldCB0byBzdW1tYXJpemUgdGhlIHdvcmsuIiwKICAgICAgICAgICJ0b3BfcCI6IDEuMCwKICAgICAgICB9LAogICAgICAgIG91dHB1dHM9eyJpbnB1dHMiOiAiYWJzdHJhY3RzIiwgImdlbmVyYXRpb25zIjogInR3ZWV0cyJ9LAogICAgKQoKICAgICMgQ3JlYXRlIHRyYWluaW5nIGRhdGEgc3BsaXRzCiAgICBzcGxpdHMgPSBhYnN0cmFjdHNfYW5kX3R3ZWV0cy5zcGxpdHModHJhaW5fc2l6ZT0wLjkwLCB2YWxpZGF0aW9uX3NpemU9MC4xMCkKCiAgICAjIFRyYWluIGEgbW9kZWwgdG8gY29udmVydCByZXNlYXJjaCBwYXBlciBhYnN0cmFjdHMgdG8gdHdlZXRzIHdpdGggdGhlCiAgICAjIHN5bnRoZXRpYyBkYXRhc2V0CiAgICB0cmFpbmVyID0gVHJhaW5IRkZpbmVUdW5lKAogICAgICAgICJUcmFpbiBhbiBBYnN0cmFjdCA9PiBUd2VldCBNb2RlbCIsCiAgICAgICAgbW9kZWxfbmFtZT0iZ29vZ2xlL3Q1LXYxXzEtYmFzZSIsCiAgICAgICAgcGVmdF9jb25maWc9TG9yYUNvbmZpZygpLAogICAgKQogICAgdHJhaW5lci50cmFpbigKICAgICAgICB0cmFpbl9pbnB1dD1zcGxpdHNbInRyYWluIl0ub3V0cHV0WyJhYnN0cmFjdHMiXSwKICAgICAgICB0cmFpbl9vdXRwdXQ9c3BsaXRzWyJ0cmFpbiJdLm91dHB1dFsidHdlZXRzIl0sCiAgICAgICAgdmFsaWRhdGlvbl9pbnB1dD1zcGxpdHNbInZhbGlkYXRpb24iXS5vdXRwdXRbImFic3RyYWN0cyJdLAogICAgICAgIHZhbGlkYXRpb25fb3V0cHV0PXNwbGl0c1sidmFsaWRhdGlvbiJdLm91dHB1dFsidHdlZXRzIl0sCiAgICAgICAgZXBvY2hzPTMwLAogICAgICAgIGJhdGNoX3NpemU9OCwKICAgICkKCiAgICAjIFB1Ymxpc2ggYW5kIHNoYXJlIHRoZSBzeW50aGV0aWMgZGF0YXNldAogICAgYWJzdHJhY3RzX2FuZF90d2VldHMucHVibGlzaF90b19oZl9odWIoInJlcG9faWQiKQoKICAgICMgUHVibGlzaCBhbmQgc2hhcmUgdGhlIHRyYWluZWQgbW9kZWwKICAgIHRyYWluZXIucHVibGlzaF90b19oZl9odWIoInJlcG9faWQiKQ==" download="resources/examples/abstract_to_tweet.py">⬇</a></div>
<div id="lstnumberx1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx1.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx1.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx1.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx1.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx1.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx1.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx1.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span>
</div>
<div id="lstnumberx2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx2.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx2.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx2.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx2.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx2.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">llms</span><span id="lstnumberx2.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx2.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx2.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx2.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">OpenAI</span>
</div>
<div id="lstnumberx3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx3.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx3.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx3.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx3.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">steps</span><span id="lstnumberx3.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx3.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataFromPrompt</span><span id="lstnumberx3.10" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx3.11" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.12" class="ltx_text ltx_lst_identifier ltx_font_typewriter">ProcessWithPrompt</span>
</div>
<div id="lstnumberx4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span id="lstnumberx4.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx4.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx4.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx4.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx4.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainers</span><span id="lstnumberx4.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx4.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx4.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx4.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFFineTune</span>
</div>
<div id="lstnumberx5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span><span id="lstnumberx5.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx5.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx5.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft</span><span id="lstnumberx5.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx5.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx5.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx5.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span>
</div>
<div id="lstnumberx6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>
</div>
<div id="lstnumberx7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span id="lstnumberx7.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">with</span><span id="lstnumberx7.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx7.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span><span id="lstnumberx7.4" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx7.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"./output"</span><span id="lstnumberx7.6" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span><span id="lstnumberx8.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx8.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx8.2.1" class="ltx_text ltx_lst_space"> </span>Load<span id="lstnumberx8.2.2" class="ltx_text ltx_lst_space"> </span>GPT-4</span>
</div>
<div id="lstnumberx9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span><span id="lstnumberx9.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx9.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gpt_4</span><span id="lstnumberx9.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx9.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx9.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx9.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">OpenAI</span><span id="lstnumberx9.7" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx9.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">model_name</span><span id="lstnumberx9.9" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx9.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"gpt-4"</span><span id="lstnumberx9.11" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>
</div>
<div id="lstnumberx11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span><span id="lstnumberx11.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx11.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx11.2.1" class="ltx_text ltx_lst_space"> </span>Generate<span id="lstnumberx11.2.2" class="ltx_text ltx_lst_space"> </span>synthetic<span id="lstnumberx11.2.3" class="ltx_text ltx_lst_space"> </span>arXiv-style<span id="lstnumberx11.2.4" class="ltx_text ltx_lst_space"> </span>research<span id="lstnumberx11.2.5" class="ltx_text ltx_lst_space"> </span>paper<span id="lstnumberx11.2.6" class="ltx_text ltx_lst_space"> </span>abstracts<span id="lstnumberx11.2.7" class="ltx_text ltx_lst_space"> </span>with<span id="lstnumberx11.2.8" class="ltx_text ltx_lst_space"> </span>GPT-4</span>
</div>
<div id="lstnumberx12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span><span id="lstnumberx12.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx12.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">arxiv_dataset</span><span id="lstnumberx12.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx12.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx12.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx12.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataFromPrompt</span><span id="lstnumberx12.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span><span id="lstnumberx13.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx13.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Generate<span id="lstnumberx13.2.1" class="ltx_text ltx_lst_space"> </span>Research<span id="lstnumberx13.2.2" class="ltx_text ltx_lst_space"> </span>Paper<span id="lstnumberx13.2.3" class="ltx_text ltx_lst_space"> </span>Abstracts"</span><span id="lstnumberx13.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span><span id="lstnumberx14.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx14.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">args</span><span id="lstnumberx14.3" class="ltx_text ltx_font_typewriter">={</span>
</div>
<div id="lstnumberx15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span><span id="lstnumberx15.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx15.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"llm"</span><span id="lstnumberx15.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx15.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx15.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gpt_4</span><span id="lstnumberx15.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span><span id="lstnumberx16.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx16.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"n"</span><span id="lstnumberx16.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx16.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx16.5" class="ltx_text ltx_font_typewriter">1000,</span>
</div>
<div id="lstnumberx17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span><span id="lstnumberx17.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx17.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"temperature"</span><span id="lstnumberx17.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx17.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx17.5" class="ltx_text ltx_font_typewriter">1.2,</span>
</div>
<div id="lstnumberx18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span><span id="lstnumberx18.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx18.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"instruction"</span><span id="lstnumberx18.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx18.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx18.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span><span id="lstnumberx19.1" class="ltx_text ltx_lst_space ltx_font_typewriter">              </span><span id="lstnumberx19.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Generate<span id="lstnumberx19.2.1" class="ltx_text ltx_lst_space"> </span>an<span id="lstnumberx19.2.2" class="ltx_text ltx_lst_space"> </span>arXiv<span id="lstnumberx19.2.3" class="ltx_text ltx_lst_space"> </span>abstract<span id="lstnumberx19.2.4" class="ltx_text ltx_lst_space"> </span>of<span id="lstnumberx19.2.5" class="ltx_text ltx_lst_space"> </span>an<span id="lstnumberx19.2.6" class="ltx_text ltx_lst_space"> </span>NLP<span id="lstnumberx19.2.7" class="ltx_text ltx_lst_space"> </span>research<span id="lstnumberx19.2.8" class="ltx_text ltx_lst_space"> </span>paper."</span>
</div>
<div id="lstnumberx20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span><span id="lstnumberx20.1" class="ltx_text ltx_lst_space ltx_font_typewriter">              </span><span id="lstnumberx20.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"<span id="lstnumberx20.2.1" class="ltx_text ltx_lst_space"> </span>Return<span id="lstnumberx20.2.2" class="ltx_text ltx_lst_space"> </span>just<span id="lstnumberx20.2.3" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx20.2.4" class="ltx_text ltx_lst_space"> </span>abstract,<span id="lstnumberx20.2.5" class="ltx_text ltx_lst_space"> </span>no<span id="lstnumberx20.2.6" class="ltx_text ltx_lst_space"> </span>titles."</span>
</div>
<div id="lstnumberx21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span><span id="lstnumberx21.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx21.2" class="ltx_text ltx_font_typewriter">),</span>
</div>
<div id="lstnumberx22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span><span id="lstnumberx22.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx22.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span><span id="lstnumberx23.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx23.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">outputs</span><span id="lstnumberx23.3" class="ltx_text ltx_font_typewriter">={</span><span id="lstnumberx23.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"generations"</span><span id="lstnumberx23.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx23.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx23.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"abstracts"</span><span id="lstnumberx23.8" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span><span id="lstnumberx24.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx24.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span>
</div>
<div id="lstnumberx26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span><span id="lstnumberx26.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx26.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx26.2.1" class="ltx_text ltx_lst_space"> </span>Use<span id="lstnumberx26.2.2" class="ltx_text ltx_lst_space"> </span>GPT-4<span id="lstnumberx26.2.3" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx26.2.4" class="ltx_text ltx_lst_space"> </span>convert<span id="lstnumberx26.2.5" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx26.2.6" class="ltx_text ltx_lst_space"> </span>abstracts<span id="lstnumberx26.2.7" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx26.2.8" class="ltx_text ltx_lst_space"> </span>tweets</span>
</div>
<div id="lstnumberx27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span><span id="lstnumberx27.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx27.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">abstracts_and_tweets</span><span id="lstnumberx27.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx27.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx27.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx27.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">ProcessWithPrompt</span><span id="lstnumberx27.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span><span id="lstnumberx28.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx28.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Generate<span id="lstnumberx28.2.1" class="ltx_text ltx_lst_space"> </span>Tweets<span id="lstnumberx28.2.2" class="ltx_text ltx_lst_space"> </span>from<span id="lstnumberx28.2.3" class="ltx_text ltx_lst_space"> </span>Abstracts"</span><span id="lstnumberx28.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span><span id="lstnumberx29.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx29.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">inputs</span><span id="lstnumberx29.3" class="ltx_text ltx_font_typewriter">={</span><span id="lstnumberx29.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"inputs"</span><span id="lstnumberx29.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx29.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx29.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">arxiv_dataset</span><span id="lstnumberx29.8" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx29.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx29.10" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx29.11" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"abstracts"</span><span id="lstnumberx29.12" class="ltx_text ltx_font_typewriter">]},</span>
</div>
<div id="lstnumberx30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span><span id="lstnumberx30.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx30.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">args</span><span id="lstnumberx30.3" class="ltx_text ltx_font_typewriter">={</span>
</div>
<div id="lstnumberx31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span><span id="lstnumberx31.1" class="ltx_text ltx_lst_space ltx_font_typewriter">          </span><span id="lstnumberx31.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"llm"</span><span id="lstnumberx31.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx31.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx31.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gpt_4</span><span id="lstnumberx31.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span><span id="lstnumberx32.1" class="ltx_text ltx_lst_space ltx_font_typewriter">          </span><span id="lstnumberx32.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"instruction"</span><span id="lstnumberx32.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx32.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx32.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Given<span id="lstnumberx32.5.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx32.5.2" class="ltx_text ltx_lst_space"> </span>abstract,<span id="lstnumberx32.5.3" class="ltx_text ltx_lst_space"> </span>write<span id="lstnumberx32.5.4" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx32.5.5" class="ltx_text ltx_lst_space"> </span>tweet<span id="lstnumberx32.5.6" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx32.5.7" class="ltx_text ltx_lst_space"> </span>summarize<span id="lstnumberx32.5.8" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx32.5.9" class="ltx_text ltx_lst_space"> </span>work."</span><span id="lstnumberx32.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span><span id="lstnumberx33.1" class="ltx_text ltx_lst_space ltx_font_typewriter">          </span><span id="lstnumberx33.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"top_p"</span><span id="lstnumberx33.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx33.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx33.5" class="ltx_text ltx_font_typewriter">1.0,</span>
</div>
<div id="lstnumberx34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span><span id="lstnumberx34.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx34.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span><span id="lstnumberx35.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx35.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">outputs</span><span id="lstnumberx35.3" class="ltx_text ltx_font_typewriter">={</span><span id="lstnumberx35.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"inputs"</span><span id="lstnumberx35.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx35.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx35.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"abstracts"</span><span id="lstnumberx35.8" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx35.9" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx35.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"generations"</span><span id="lstnumberx35.11" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx35.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx35.13" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"tweets"</span><span id="lstnumberx35.14" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span><span id="lstnumberx36.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx36.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">37</span>
</div>
<div id="lstnumberx38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">38</span><span id="lstnumberx38.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx38.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx38.2.1" class="ltx_text ltx_lst_space"> </span>Create<span id="lstnumberx38.2.2" class="ltx_text ltx_lst_space"> </span>training<span id="lstnumberx38.2.3" class="ltx_text ltx_lst_space"> </span>data<span id="lstnumberx38.2.4" class="ltx_text ltx_lst_space"> </span>splits</span>
</div>
<div id="lstnumberx39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">39</span><span id="lstnumberx39.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx39.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx39.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx39.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx39.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx39.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">abstracts_and_tweets</span><span id="lstnumberx39.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx39.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx39.9" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx39.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_size</span><span id="lstnumberx39.11" class="ltx_text ltx_font_typewriter">=0.90,</span><span id="lstnumberx39.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx39.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_size</span><span id="lstnumberx39.14" class="ltx_text ltx_font_typewriter">=0.10)</span>
</div>
<div id="lstnumberx40" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">40</span>
</div>
<div id="lstnumberx41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">41</span><span id="lstnumberx41.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx41.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx41.2.1" class="ltx_text ltx_lst_space"> </span>Train<span id="lstnumberx41.2.2" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx41.2.3" class="ltx_text ltx_lst_space"> </span>model<span id="lstnumberx41.2.4" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx41.2.5" class="ltx_text ltx_lst_space"> </span>convert<span id="lstnumberx41.2.6" class="ltx_text ltx_lst_space"> </span>research<span id="lstnumberx41.2.7" class="ltx_text ltx_lst_space"> </span>paper<span id="lstnumberx41.2.8" class="ltx_text ltx_lst_space"> </span>abstracts<span id="lstnumberx41.2.9" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx41.2.10" class="ltx_text ltx_lst_space"> </span>tweets<span id="lstnumberx41.2.11" class="ltx_text ltx_lst_space"> </span>with<span id="lstnumberx41.2.12" class="ltx_text ltx_lst_space"> </span>the</span>
</div>
<div id="lstnumberx42" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">42</span><span id="lstnumberx42.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx42.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx42.2.1" class="ltx_text ltx_lst_space"> </span>synthetic<span id="lstnumberx42.2.2" class="ltx_text ltx_lst_space"> </span>dataset</span>
</div>
<div id="lstnumberx43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">43</span><span id="lstnumberx43.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx43.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx43.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx43.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx43.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx43.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFFineTune</span><span id="lstnumberx43.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx44" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">44</span><span id="lstnumberx44.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx44.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Train<span id="lstnumberx44.2.1" class="ltx_text ltx_lst_space"> </span>an<span id="lstnumberx44.2.2" class="ltx_text ltx_lst_space"> </span>Abstract<span id="lstnumberx44.2.3" class="ltx_text ltx_lst_space"> </span>=&gt;<span id="lstnumberx44.2.4" class="ltx_text ltx_lst_space"> </span>Tweet<span id="lstnumberx44.2.5" class="ltx_text ltx_lst_space"> </span>Model"</span><span id="lstnumberx44.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx45" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">45</span><span id="lstnumberx45.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx45.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">model_name</span><span id="lstnumberx45.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx45.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"google/t5-v1_1-base"</span><span id="lstnumberx45.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx46" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">46</span><span id="lstnumberx46.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx46.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft_config</span><span id="lstnumberx46.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx46.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span><span id="lstnumberx46.5" class="ltx_text ltx_font_typewriter">(),</span>
</div>
<div id="lstnumberx47" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">47</span><span id="lstnumberx47.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx47.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx48" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">48</span><span id="lstnumberx48.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx48.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx48.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx48.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train</span><span id="lstnumberx48.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx49" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">49</span><span id="lstnumberx49.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx49.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_input</span><span id="lstnumberx49.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx49.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx49.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx49.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx49.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx49.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx49.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx49.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"abstracts"</span><span id="lstnumberx49.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx50" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">50</span><span id="lstnumberx50.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx50.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_output</span><span id="lstnumberx50.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx50.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx50.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx50.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx50.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx50.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx50.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx50.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"tweets"</span><span id="lstnumberx50.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx51" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">51</span><span id="lstnumberx51.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx51.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_input</span><span id="lstnumberx51.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx51.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx51.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx51.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx51.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx51.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx51.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx51.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"abstracts"</span><span id="lstnumberx51.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx52" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">52</span><span id="lstnumberx52.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx52.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_output</span><span id="lstnumberx52.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx52.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx52.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx52.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx52.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx52.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx52.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx52.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"tweets"</span><span id="lstnumberx52.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx53" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">53</span><span id="lstnumberx53.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx53.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">epochs</span><span id="lstnumberx53.3" class="ltx_text ltx_font_typewriter">=30,</span>
</div>
<div id="lstnumberx54" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">54</span><span id="lstnumberx54.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx54.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">batch_size</span><span id="lstnumberx54.3" class="ltx_text ltx_font_typewriter">=8,</span>
</div>
<div id="lstnumberx55" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">55</span><span id="lstnumberx55.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx55.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx56" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">56</span>
</div>
<div id="lstnumberx57" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">57</span><span id="lstnumberx57.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx57.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx57.2.1" class="ltx_text ltx_lst_space"> </span>Publish<span id="lstnumberx57.2.2" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx57.2.3" class="ltx_text ltx_lst_space"> </span>share<span id="lstnumberx57.2.4" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx57.2.5" class="ltx_text ltx_lst_space"> </span>synthetic<span id="lstnumberx57.2.6" class="ltx_text ltx_lst_space"> </span>dataset</span>
</div>
<div id="lstnumberx58" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">58</span><span id="lstnumberx58.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx58.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">abstracts_and_tweets</span><span id="lstnumberx58.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx58.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">publish_to_hf_hub</span><span id="lstnumberx58.5" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx58.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"repo_id"</span><span id="lstnumberx58.7" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx59" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">59</span>
</div>
<div id="lstnumberx60" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">60</span><span id="lstnumberx60.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx60.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx60.2.1" class="ltx_text ltx_lst_space"> </span>Publish<span id="lstnumberx60.2.2" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx60.2.3" class="ltx_text ltx_lst_space"> </span>share<span id="lstnumberx60.2.4" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx60.2.5" class="ltx_text ltx_lst_space"> </span>trained<span id="lstnumberx60.2.6" class="ltx_text ltx_lst_space"> </span>model</span>
</div>
<div id="lstnumberx61" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">61</span><span id="lstnumberx61.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx61.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx61.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx61.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">publish_to_hf_hub</span><span id="lstnumberx61.5" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx61.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"repo_id"</span><span id="lstnumberx61.7" class="ltx_text ltx_font_typewriter">)</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#FAFAFA;"><span class="ltx_tag ltx_tag_float">Example 1: </span>In this demonstration snippet, DataDreamer generates a fully synthetic dataset of tweets summarizing research paper abstracts and then trains a smaller T5 distilled model <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite> to perform the task and publishes both the synthetic dataset and the trained model. DataDreamer makes it simple to chain data from each step in the workflow to the next and automatically caches each step of this workflow to the <span id="LST1.9.1" class="ltx_text ltx_font_typewriter">./output/</span> folder to allow interruption and resumability at any point in the script. The standardized API also makes it easy to switch to and experiment with different models, both open source and commercial, for generation and training.</figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>DataDreamer</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">DataDreamer is an open source Python package that allows researchers to implement all of the LLM workflows discussed in Section <a href="#S2" title="2 LLM Workflows ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> using a single library. DataDreamer provides a standardized interface for prompting and training models, abstracting away vendor-specific libraries and tooling. This makes research code simpler to implement, modify, experiment with, and share with others. DataDreamer integrates with other open source LLM libraries like <span id="S4.p1.1.1" class="ltx_text ltx_font_typewriter">transformers</span> <cite class="ltx_cite ltx_citemacro_citep">(Wolf et al., <a href="#bib.bib43" title="" class="ltx_ref">2019</a>)</cite> and <span id="S4.p1.1.2" class="ltx_text ltx_font_typewriter">trl</span> <cite class="ltx_cite ltx_citemacro_citep">(von Werra et al., <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite>, as well as commercial model APIs like OpenAI and Anthropic<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a target="_blank" href="https://www.anthropic.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.anthropic.com/</a></span></span></span> for commercial LLMs <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>. Moreover, DataDreamer automatically implements the best practices for reproducibility discussed in Section <a href="#S5" title="5 Reproducibility ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding:2.5pt 5.0pt;"><span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Type</span></th>
<th id="S4.T2.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding:2.5pt 5.0pt;"></th>
<th id="S4.T2.1.1.1.3" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" style="padding:2.5pt 5.0pt;">
<span id="S4.T2.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.1.1.3.1.1" class="ltx_p"><span id="S4.T2.1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">Examples</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<td id="S4.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding:2.5pt 5.0pt;" rowspan="3"><span id="S4.T2.1.2.1.1.1" class="ltx_text ltx_font_bold">Steps</span></td>
<td id="S4.T2.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding:2.5pt 5.0pt;">Load a Dataset</td>
<td id="S4.T2.1.2.1.3" class="ltx_td ltx_align_justify ltx_border_t" style="padding:2.5pt 5.0pt;">
<span id="S4.T2.1.2.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.2.1.3.1.1" class="ltx_p"><span id="S4.T2.1.2.1.3.1.1.1" class="ltx_text ltx_font_typewriter">DataSource</span>, <span id="S4.T2.1.2.1.3.1.1.2" class="ltx_text ltx_font_typewriter">HFHubDataSource</span>, <span id="S4.T2.1.2.1.3.1.1.3" class="ltx_text ltx_font_typewriter">JSONDataSource</span>, <span id="S4.T2.1.2.1.3.1.1.4" class="ltx_text ltx_font_typewriter">CSVDataSource</span>, …</span>
</span>
</td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<td id="S4.T2.1.3.2.1" class="ltx_td ltx_align_left" style="padding:2.5pt 5.0pt;">Prompting</td>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_justify" style="padding:2.5pt 5.0pt;">
<span id="S4.T2.1.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.3.2.2.1.1" class="ltx_p"><span id="S4.T2.1.3.2.2.1.1.1" class="ltx_text ltx_font_typewriter">Prompt</span>, <span id="S4.T2.1.3.2.2.1.1.2" class="ltx_text ltx_font_typewriter">RAGPrompt</span>, <span id="S4.T2.1.3.2.2.1.1.3" class="ltx_text ltx_font_typewriter">ProcessWithPrompt</span>, <span id="S4.T2.1.3.2.2.1.1.4" class="ltx_text ltx_font_typewriter">FewShotPrompt</span>, <span id="S4.T2.1.3.2.2.1.1.5" class="ltx_text ltx_font_typewriter">DataFromPrompt</span>, <span id="S4.T2.1.3.2.2.1.1.6" class="ltx_text ltx_font_typewriter">DataFromAttributedPrompt</span>, <span id="S4.T2.1.3.2.2.1.1.7" class="ltx_text ltx_font_typewriter">FilterWithPrompt</span>, <span id="S4.T2.1.3.2.2.1.1.8" class="ltx_text ltx_font_typewriter">RankWithPrompt</span>, <span id="S4.T2.1.3.2.2.1.1.9" class="ltx_text ltx_font_typewriter">JudgeGenerationPairsWithPrompt</span>, …</span>
</span>
</td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<td id="S4.T2.1.4.3.1" class="ltx_td ltx_align_left" style="padding:2.5pt 5.0pt;">Other</td>
<td id="S4.T2.1.4.3.2" class="ltx_td ltx_align_justify" style="padding:2.5pt 5.0pt;">
<span id="S4.T2.1.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.4.3.2.1.1" class="ltx_p"><span id="S4.T2.1.4.3.2.1.1.1" class="ltx_text ltx_font_typewriter">Embed</span>, <span id="S4.T2.1.4.3.2.1.1.2" class="ltx_text ltx_font_typewriter">Retrieve</span>, <span id="S4.T2.1.4.3.2.1.1.3" class="ltx_text ltx_font_typewriter">CosineSimilarity</span>, …</span>
</span>
</td>
</tr>
<tr id="S4.T2.1.5.4" class="ltx_tr">
<td id="S4.T2.1.5.4.1" class="ltx_td ltx_align_left" style="padding:2.5pt 5.0pt;"><span id="S4.T2.1.5.4.1.1" class="ltx_text ltx_font_bold">Models</span></td>
<td id="S4.T2.1.5.4.2" class="ltx_td" style="padding:2.5pt 5.0pt;"></td>
<td id="S4.T2.1.5.4.3" class="ltx_td ltx_align_justify" style="padding:2.5pt 5.0pt;">
<span id="S4.T2.1.5.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.5.4.3.1.1" class="ltx_p"><span id="S4.T2.1.5.4.3.1.1.1" class="ltx_text ltx_font_typewriter">OpenAI</span>, <span id="S4.T2.1.5.4.3.1.1.2" class="ltx_text ltx_font_typewriter">OpenAIAssistant</span>, <span id="S4.T2.1.5.4.3.1.1.3" class="ltx_text ltx_font_typewriter">HFTransformers</span>, <span id="S4.T2.1.5.4.3.1.1.4" class="ltx_text ltx_font_typewriter">CTransformers</span>, <span id="S4.T2.1.5.4.3.1.1.5" class="ltx_text ltx_font_typewriter">VLLM</span>, <span id="S4.T2.1.5.4.3.1.1.6" class="ltx_text ltx_font_typewriter">Petals</span>, <span id="S4.T2.1.5.4.3.1.1.7" class="ltx_text ltx_font_typewriter">HFAPIEndpoint</span>, <span id="S4.T2.1.5.4.3.1.1.8" class="ltx_text ltx_font_typewriter">Together</span>, <span id="S4.T2.1.5.4.3.1.1.9" class="ltx_text ltx_font_typewriter">MistralAI</span>, <span id="S4.T2.1.5.4.3.1.1.10" class="ltx_text ltx_font_typewriter">Anthropic</span>, <span id="S4.T2.1.5.4.3.1.1.11" class="ltx_text ltx_font_typewriter">Cohere</span>, <span id="S4.T2.1.5.4.3.1.1.12" class="ltx_text ltx_font_typewriter">AI21</span>, <span id="S4.T2.1.5.4.3.1.1.13" class="ltx_text ltx_font_typewriter">Bedrock</span>, <span id="S4.T2.1.5.4.3.1.1.14" class="ltx_text ltx_font_typewriter">Vertex</span>, …</span>
</span>
</td>
</tr>
<tr id="S4.T2.1.6.5" class="ltx_tr">
<td id="S4.T2.1.6.5.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding:2.5pt 5.0pt;"><span id="S4.T2.1.6.5.1.1" class="ltx_text ltx_font_bold">Trainers</span></td>
<td id="S4.T2.1.6.5.2" class="ltx_td ltx_border_bb" style="padding:2.5pt 5.0pt;"></td>
<td id="S4.T2.1.6.5.3" class="ltx_td ltx_align_justify ltx_border_bb" style="padding:2.5pt 5.0pt;">
<span id="S4.T2.1.6.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.6.5.3.1.1" class="ltx_p"><span id="S4.T2.1.6.5.3.1.1.1" class="ltx_text ltx_font_typewriter">TrainOpenAIFineTune</span>, <span id="S4.T2.1.6.5.3.1.1.2" class="ltx_text ltx_font_typewriter">TrainHFClassifier</span>, <span id="S4.T2.1.6.5.3.1.1.3" class="ltx_text ltx_font_typewriter">TrainHFFineTune</span>, <span id="S4.T2.1.6.5.3.1.1.4" class="ltx_text ltx_font_typewriter">TrainSentenceTransformer</span>, <span id="S4.T2.1.6.5.3.1.1.5" class="ltx_text ltx_font_typewriter">TrainHFDPO</span>, <span id="S4.T2.1.6.5.3.1.1.6" class="ltx_text ltx_font_typewriter">TrainHFPPO</span>, …</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>A few examples of built-in steps, models, and trainers available in DataDreamer.</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Installation</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">DataDreamer can be installed with:</p>
<div id="S4.SS1.p1.2" class="ltx_listing ltx_lst_language_bash ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,cGlwIGluc3RhbGwgZGF0YWRyZWFtZXIuZGV2" download="">⬇</a></div>
<div id="lstnumberx62" class="ltx_listingline">
<span id="lstnumberx62.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">pip</span><span id="lstnumberx62.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx62.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">install</span><span id="lstnumberx62.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx62.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx62.6" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx62.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dev</span>
</div>
</div>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Sessions</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">All code using the DataDreamer library is placed within a “session” using a Python context manager instantiated using the <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_typewriter">with</span> keyword:</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<div id="S4.SS2.p2.1" class="ltx_listing ltx_lst_language_bash ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSBkYXRhZHJlYW1lciBpbXBvcnQgRGF0YURyZWFtZXIKCndpdGggRGF0YURyZWFtZXIoIi4vb3V0cHV0Iik6CiAgICAuLi4=" download="">⬇</a></div>
<div id="lstnumberx63" class="ltx_listingline">
<span id="lstnumberx63.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">from</span><span id="lstnumberx63.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx63.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx63.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx63.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">import</span><span id="lstnumberx63.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx63.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span>
</div>
<div id="lstnumberx64" class="ltx_listingline">
</div>
<div id="lstnumberx65" class="ltx_listingline">
<span id="lstnumberx65.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">with</span><span id="lstnumberx65.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx65.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span><span id="lstnumberx65.4" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx65.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"./output"</span><span id="lstnumberx65.6" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx66" class="ltx_listingline">
<span id="lstnumberx66.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx66.2" class="ltx_text ltx_font_typewriter">...</span>
</div>
</div>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Workflow tasks can be run within the session context manager. These tasks are called “steps” (loading a dataset, prompting a model, etc.) or “trainers”. The session allows DataDreamer to automatically organize the resulting datasets, outputs, caches, training checkpoints, and trained models that result from tasks run within the session into the <span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_typewriter">./output/</span> folder. Each step in a workflow assigns a custom descriptive name for its subfolder under <span id="S4.SS2.p3.1.2" class="ltx_text ltx_font_typewriter">./output/</span>. DataDreamer sessions automatically provide user-friendly logging around workflow tasks run within the session (see Figure <a href="#S4.F2" title="Figure 2 ‣ 4.10 Configuration and Extensibility ‣ 4 DataDreamer ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Steps</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Steps are the core operators in a DataDreamer session. A step in DataDreamer transforms from an input dataset to an output dataset <cite class="ltx_cite ltx_citemacro_citep">(Lhoest et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>. This is useful for tasks like generating synthetic data from LLMs, or data augmentation for existing datasets. The output of one step can be directly used as the input to another step or as the input to a trainer, allowing users to chain together multiple steps/trainers to create complex workflows. DataDreamer comes with a number of built-in steps for common operations in LLM workflows, some examples of which can be seen in Table <a href="#S4.T2" title="Table 2 ‣ 4 DataDreamer ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Useful standard data processing operations such as <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_typewriter">.map()</span>, <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_typewriter">.filter()</span>, and <span id="S4.SS3.p1.1.3" class="ltx_text ltx_font_typewriter">.shuffle()</span> can also quickly be applied to the output of a step for custom processing. DataDreamer uses memory-mapping to handle large datasets stored on disk and can be run lazily over iterable, streaming datasets.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Models</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Models can be loaded in a DataDreamer session and then be passed as an argument to steps like <span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_typewriter">FewShotPrompt</span> and <span id="S4.SS4.p1.1.2" class="ltx_text ltx_font_typewriter">ProcessWithPrompt</span>. DataDreamer creates a standardized interface for accessing open source and commercial LLMs. It includes interfaces for embedding models as well as LLMs. Examples of supported models and model providers can be found in Table <a href="#S4.T2" title="Table 2 ‣ 4 DataDreamer ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Trainers</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Trainers can train on a dataset produced by a step in a DataDreamer workflow. The dataset may be loaded from an external source or produced as the output of a step in a multi-step workflow. DataDreamer’s trainers support a wide variety of techniques and tasks including fine-tuning, instruction-tuning, alignment via RLHF <cite class="ltx_cite ltx_citemacro_cite">Ouyang et al. (<a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite> and DPO <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a href="#bib.bib31" title="" class="ltx_ref">2023</a>)</cite>, distillation, training classifiers, and training embedding models. Examples of supported techniques are shown in Table <a href="#S4.T2" title="Table 2 ‣ 4 DataDreamer ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Caching and Sharing Workflows</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">Caching has practical utility in LLM workflows as these large models can be both computationally and financially expensive to run. Therefore, eliminating re-computation can save both time and resources. Caching in DataDreamer happens at multiple levels. When a step or trainer is completed, its resulting dataset or trained model is saved to disk and loaded from disk if the step or trainer is executed again with the same inputs and arguments, instead of being run again. Additionally, DataDreamer caches at the model-level, caching the results of prompts or texts being run against a model to a SQLite database file. During training, DataDreamer similarly automatically saves checkpoints and resumes from them if interrupted and restarted. Caching uses minimal disk space (storing mainly text) and adds minimal overhead in these workloads dominated by heavy model inference computation, but can be granularly disabled if desired.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.1" class="ltx_p">DataDreamer’s cache system allows a researcher to share both their workflow script and their session output folder with others, giving them access to useful caches and saved outputs. These allow others to easily reproduce and extend the entire workflow while also benefiting from avoiding expensive computations when unnecessary. For example, a researcher could extend another researcher’s workflow by adding another step at the end. Only the additional added step would need to be computed, while all of the original steps could have their results loaded from disk.</p>
</div>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Resumability</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.1" class="ltx_p">Caching allows resumability during development, so scripts can be interrupted and resumed. This allows graceful handling of crashes, server preemption, and other situations where only a portion of a workflow was previously computed. Furthermore, caching can be useful during experimentation of a workflow. For example, when modifying a single prompt in the middle of a multi-step synthetic data generation workflow, the change may only affect a certain number of inputs to the next step. If so, only that portion of the work will be re-computed.</p>
</div>
</section>
<section id="S4.SS8" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8 </span>Sharing Open Data and Open Models</h3>

<div id="S4.SS8.p1" class="ltx_para">
<p id="S4.SS8.p1.1" class="ltx_p">DataDreamer provides convenient utilities for exporting and publishing datasets and trained models produced by steps or trainers. Resources can be exported to disk or published to the Hugging Face Hub <span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://huggingface.co/</span></span></span>. When resources are published, DataDreamer can automatically upload a demonstration snippet and set up the live demonstration widget on the Hugging Face Hub, which makes shared resources easily usable. Additionally, these resources are automatically given appropriate metadata such as tags clearly indicating when data is synthetically generated and its source LLM. DataDreamer also produces what we call “synthetic data cards” and “synthetic model cards”. Synthetic data and model cards are automatically produced by recursively tracing through all steps, models, and trainers that DataDreamer used to produce the dataset or model. Each step, model, and trainer has associated metadata including license information and citation information. DataDreamer collects this information and produces a synthetic data card (or model card) that reports the information along with reproducibility information for each step, model, and trainer in the workflow. The information collected in our cards is defined in Table <a href="#S4.T3" title="Table 3 ‣ 4.8 Sharing Open Data and Open Models ‣ 4 DataDreamer ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Date &amp; Time</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<td id="S4.T3.1.2.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T3.1.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.2.1.1.1.1" class="ltx_p" style="width:407.6pt;">The date and time the step or trainer was run. This is important to document when using API-based LLMs that can be updated over time.</span>
</span>
</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<td id="S4.T3.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="S4.T3.1.3.2.1.1" class="ltx_text ltx_font_bold">Dataset Name &amp; Card</span></td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<td id="S4.T3.1.4.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T3.1.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.4.3.1.1.1" class="ltx_p" style="width:407.6pt;">The name of any datasets used as part of a step or trainer’s operation along with their data cards.</span>
</span>
</td>
</tr>
<tr id="S4.T3.1.5.4" class="ltx_tr">
<td id="S4.T3.1.5.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="S4.T3.1.5.4.1.1" class="ltx_text ltx_font_bold">Model Name &amp; Card</span></td>
</tr>
<tr id="S4.T3.1.6.5" class="ltx_tr">
<td id="S4.T3.1.6.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T3.1.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.6.5.1.1.1" class="ltx_p" style="width:407.6pt;">The name of any models used in a step or trainer’s operation along with their model cards.</span>
</span>
</td>
</tr>
<tr id="S4.T3.1.7.6" class="ltx_tr">
<td id="S4.T3.1.7.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="S4.T3.1.7.6.1.1" class="ltx_text ltx_font_bold">URL</span></td>
</tr>
<tr id="S4.T3.1.8.7" class="ltx_tr">
<td id="S4.T3.1.8.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T3.1.8.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.8.7.1.1.1" class="ltx_p" style="width:407.6pt;">A URL that can be referenced for more information about the step or trainer.</span>
</span>
</td>
</tr>
<tr id="S4.T3.1.9.8" class="ltx_tr">
<td id="S4.T3.1.9.8.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="S4.T3.1.9.8.1.1" class="ltx_text ltx_font_bold">License</span></td>
</tr>
<tr id="S4.T3.1.10.9" class="ltx_tr">
<td id="S4.T3.1.10.9.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T3.1.10.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.10.9.1.1.1" class="ltx_p" style="width:407.6pt;">Any known license that may apply as a result of a model or dataset being used in a step or trainer.</span>
</span>
</td>
</tr>
<tr id="S4.T3.1.11.10" class="ltx_tr">
<td id="S4.T3.1.11.10.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="S4.T3.1.11.10.1.1" class="ltx_text ltx_font_bold">Citations</span></td>
</tr>
<tr id="S4.T3.1.12.11" class="ltx_tr">
<td id="S4.T3.1.12.11.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T3.1.12.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.12.11.1.1.1" class="ltx_p" style="width:407.6pt;">Citations for datasets and models used in a trainer.</span>
</span>
</td>
</tr>
<tr id="S4.T3.1.13.12" class="ltx_tr">
<td id="S4.T3.1.13.12.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="S4.T3.1.13.12.1.1" class="ltx_text ltx_font_bold">Reproducibility Fingerprint</span></td>
</tr>
<tr id="S4.T3.1.14.13" class="ltx_tr">
<td id="S4.T3.1.14.13.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T3.1.14.13.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.14.13.1.1.1" class="ltx_p" style="width:407.6pt;">A hash of all inputs, arguments, and configurations that may affect reproducibility for a step or trainer. When steps and trainers are chained in a multi-stage workflow, the reproducibility hash is computed recursively through the chain. These fingerprints can be used to compare if two workflows within DataDreamer are exactly identical.</span>
</span>
</td>
</tr>
<tr id="S4.T3.1.15.14" class="ltx_tr">
<td id="S4.T3.1.15.14.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="S4.T3.1.15.14.1.1" class="ltx_text ltx_font_bold">Other Reproducibility Information</span></td>
</tr>
<tr id="S4.T3.1.16.15" class="ltx_tr">
<td id="S4.T3.1.16.15.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t">
<span id="S4.T3.1.16.15.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.16.15.1.1.1" class="ltx_p" style="width:407.6pt;">Other miscellaneous reproducibility information such as environment information, system information, and versions of packages and dependencies.</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Information automatically recorded in a synthetic data card or synthetic model card. An example synthetic data card can found in Appendix <a href="#A5" title="Appendix E Example Synthetic Data Card ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.</figcaption>
</figure>
<div id="S4.SS8.p2" class="ltx_para">
<p id="S4.SS8.p2.1" class="ltx_p">These automatically generated synthetic data cards and model cards can aid in preventing contamination of pre-training sources with model-generated synthetic data. As synthetic data generation becomes more prevalent, contamination can be a concern due to the performance degradation that has been observed when synthetic datasets are shared and trained on, possibly without the knowledge of the model developer <cite class="ltx_cite ltx_citemacro_citep">(Shumailov et al., <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite>. DataDreamer’s cards can also help other researchers understand what license restrictions may apply to the synthetically generated data, among other usability concerns. These automatically generated cards are not a replacement for traditional data cards and model cards <cite class="ltx_cite ltx_citemacro_citep">(Pushkarna et al., <a href="#bib.bib30" title="" class="ltx_ref">2022</a>; Mitchell et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite> that recommend a wider set of important attributes such as potential dataset biases. Instead, they provide supplemental information that is crucial to the usability and reproducibility of LLM workflows. We encourage researchers to review and add information that cannot be automatically detected to our generated cards.</p>
</div>
</section>
<section id="S4.SS9" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.9 </span>Efficiency and Optimizations</h3>

<div id="S4.SS9.p1" class="ltx_para">
<p id="S4.SS9.p1.1" class="ltx_p">LLMs workflows often benefit from or require certain optimizations to be applied in order to load or process the scale of data and models typically used. DataDreamer supports many of the common optimizations that researchers may want to apply.</p>
</div>
<section id="S4.SS9.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Parallelization</h4>

<div id="S4.SS9.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS9.SSS0.Px1.p1.1" class="ltx_p">DataDreamer supports running steps in background processes and running steps concurrently to easily implement parallel task orchestration in a workflow.</p>
</div>
</section>
<section id="S4.SS9.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Quantization and Adapters</h4>

<div id="S4.SS9.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS9.SSS0.Px2.p1.1" class="ltx_p">DataDreamer supports quantization of model weights that can reduce memory usage <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib5" title="" class="ltx_ref">Dettmers and Zettlemoyer, </a>)</cite> as well as parameter-efficient fine-tuning techniques like LoRA adapters <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>; Mangrulkar et al., <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite>. It standardizes using these optimizations across different model architectures and minimizes boilerplate, making it as simple as a single argument to configure training with LoRA in Example <a href="#LST1" title="Example 1 ‣ 3 Demonstration and Examples ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. DataDreamer attempts to create uniform support for features across all of its supported integrations when possible. So while the underlying <span id="S4.SS9.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter">sentence_transformers</span> and <span id="S4.SS9.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_typewriter">transformers</span> libraries do not support training embedding models with LoRA <cite class="ltx_cite ltx_citemacro_citep">(Reimers and Gurevych, <a href="#bib.bib33" title="" class="ltx_ref">2019</a>; Wolf et al., <a href="#bib.bib43" title="" class="ltx_ref">2019</a>)</cite>, DataDreamer supports this, which extends the benefits of LoRA to these models.</p>
</div>
</section>
<section id="S4.SS9.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Multi-GPU Usage</h4>

<div id="S4.SS9.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS9.SSS0.Px3.p1.1" class="ltx_p">DataDreamer makes it simple to load models on multiple GPUs and train models on multiple GPUs with PyTorch FSDP <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>; Zhao et al., <a href="#bib.bib50" title="" class="ltx_ref">2023</a>)</cite>. For example, training a model on multiple GPUs is as simple as passing a list of <span id="S4.SS9.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_typewriter">torch.device</span>s to the <span id="S4.SS9.SSS0.Px3.p1.1.2" class="ltx_text ltx_font_typewriter">device</span> parameter of a trainer (<span id="S4.SS9.SSS0.Px3.p1.1.3" class="ltx_text ltx_font_typewriter">device=["cuda:0", "cuda:1"]</span>). DataDreamer automatically configures FSDP and launches distributed processes within the session so that a command line launcher like <span id="S4.SS9.SSS0.Px3.p1.1.4" class="ltx_text ltx_font_typewriter">torchrun</span> never has to be used, simplifying multi-GPU training. The use of <span id="S4.SS9.SSS0.Px3.p1.1.5" class="ltx_text ltx_font_typewriter">torchrun</span> can often force complex, multi-stage workflows being split into multiple scripts launched via shell scripts since training portions need to be isolated from data generation or data processing portions. This added complexity in running the workflow end-to-end can make reproducibility challenging. With DataDreamer, workflows do not need to be re-orchestrated around portions needing to be launched via <span id="S4.SS9.SSS0.Px3.p1.1.6" class="ltx_text ltx_font_typewriter">torchrun</span>. Since DataDreamer handles this distributed orchestration automatically, users can build multi-stage workflows involving data generation, data processing, and training on multiple GPUs all in a single Python program, obviating the use of orchestration through multiple shell scripts. Example <a href="#LST4" title="Example 4 ‣ Appendix C Self-Rewarding LLMs ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> in the Appendix provides an example of such a workflow.</p>
</div>
</section>
</section>
<section id="S4.SS10" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.10 </span>Configuration and Extensibility</h3>

<div id="S4.SS10.p1" class="ltx_para">
<p id="S4.SS10.p1.1" class="ltx_p">DataDreamer seeks to minimize configuration and boilerplate code that for most research workflows do not need to be customized, for example automatically handling tokenization and applying the correct padding, among other tasks. DataDreamer applies sensible defaults and standard research practices to minimize configuration. Some researchers, however, may need to customize these choices and the option to override and extend is provided and well-documented.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2402.10379/assets/resources/figures/example_logs.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="623" height="251" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>DataDreamer logs produced by the workflow in Example <a href="#LST1" title="Example 1 ‣ 3 Demonstration and Examples ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> when resuming from a prior interrupted run.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Reproducibility</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We outline a few best practices, specific to the emerging use of LLMs in research workflows that DataDreamer adopts. We believe instituting these practices can alleviate a number of reproducibility concerns. Of course, when closed-source models are involved, these concerns can never be fully eliminated (see Section <a href="#Sx1" title="Limitations ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_title">Limitations</span></a> for further discussion on limitations). We discuss how DataDreamer makes it easier to implement these practices or automatically implements these practices in this section.</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Adaptable to Model Substitution</h4>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">While experimental workflows can often be sensitive to model choice and the transferability of prompts can be unreliable <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite>, for reproducibility purposes and for ease of experimentation, workflow implementation code should attempt to minimize dependence on a specific model and should allow other researchers to easily substitute one LLM for another. This can also be useful if a model is not accessible to another researcher or if a model has become obsolete. DataDreamer’s API and model abstractions make model substitution simple.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Sharing Prompts</h4>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px2.p1.1" class="ltx_p">Exact prompts used should be shared since even minor variations can significantly impact performance <cite class="ltx_cite ltx_citemacro_citep">(Sclar et al., <a href="#bib.bib36" title="" class="ltx_ref">2023</a>)</cite>. DataDreamer makes it easy to share an entire workflow and session output folder. DataDreamer can also help ensure a re-implementation is exactly identical between two experimental setups by comparing the reproducibility fingerprints of individual steps or the entire workflow in aggregate.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Sharing Intermediate Outputs</h4>

<div id="S5.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px3.p1.1" class="ltx_p">In multi-stage workflows, intermediate outputs should be shared for inspection and analysis by other researchers as well as for extendability purposes. DataDreamer makes this simple by automatically saving the results of each step in a multi-stage workflow in an easily inspectable Hugging Face <span id="S5.SS0.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_typewriter">datasets</span> format <cite class="ltx_cite ltx_citemacro_citep">(Lhoest et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>. When API-based LLMs are used, there is greater risk to reproducibility. DataDreamer allows workflows to be exactly reproduced from caches in the session output folder, even if the remote API is no longer available.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Synthetic Data Cards and Model Cards</h4>

<div id="S5.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px4.p1.1" class="ltx_p">Synthetic data and model cards can help other researchers understand the source of synthetic data, license restrictions that may apply, citations that may apply, among other attributes. Importantly, these cards and other metadata-like tags can help prevent contamination of pre-training data <cite class="ltx_cite ltx_citemacro_citep">(Shumailov et al., <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite>. Finally, these cards carry reproducibility information, useful for validating two experimental setups as identical.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Sharing Optimization Configurations</h4>

<div id="S5.SS0.SSS0.Px5.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px5.p1.1" class="ltx_p">Optimizations like quantization can have an effect on generations <cite class="ltx_cite ltx_citemacro_citep">(Jaiswal et al., <a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite>. DataDreamer’s reproducibility fingerprints account for these configurations and with its easily shareable workflows, DataDreamer makes it easy to reproduce an exact workflow, along with configured optimizations.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px6" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Environment-Agnostic Code</h4>

<div id="S5.SS0.SSS0.Px6.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px6.p1.1" class="ltx_p">For reproducibility, code should attempt to minimize dependence on local environments, job schedulers, shell scripts, etc. DataDreamer helps make this easier by providing tools for workflow orchestration (steps, parallelization, managed distributed processes for multi-GPU training) that can be all be done within Python. DataDreamer also minimizes dependencies on local file paths, by organizing results and outputs into the session output folder automatically.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">The current moment in NLP research and recent progress is exciting yet raises important questions for the community. We introduce DataDreamer, an open source Python package for implementing common patterns and workflows involving LLMs. We believe DataDreamer provides both practical and scientific utility to the research community and that its adoption can help advance the rate of research progress in workflows involving LLMs by making implementation easier and making research output reproducible and extendable.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Limitations</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">In this work, we outline best practices and implement these practices in an open source system called DataDreamer. We believe these contributions can help aid open science in our field, however, we acknowledge that as long as the research community chooses to use closed-source models for experiments, especially those served behind an API on remote servers, challenges to reproducibility are inevitable. With DataDreamer, we provide a way to reproduce and further analyze some of these experiments long after these remote APIs may be changed or unavailable through the session-based caching system as well as provide a way to easily substitute models where needed through abstractions. To the best of our knowledge, there are no significant ethical considerations that arise from this work. We believe the broader impacts of this work to be largely positive, making state-of-the-art LLM workflows both easier and more accessible to implement and reproduce as well as reducing carbon emissions through DataDreamer’s caching system that helps researchers avoid expensive re-computation when possible.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2022)</span>
<span class="ltx_bibblock">
Yuntao Bai, Saurav Kadavath, Sandipan Kundu, Amanda Askell, Jackson Kernion, Andy Jones, Anna Chen, Anna Goldie, Azalia Mirhoseini, Cameron McKinnon, et al. 2022.

</span>
<span class="ltx_bibblock">Constitutional ai: Harmlessness from ai feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2212.08073</em>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. 2020.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:1877–1901.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2024)</span>
<span class="ltx_bibblock">
Zixiang Chen, Yihe Deng, Huizhuo Yuan, Kaixuan Ji, and Quanquan Gu. 2024.

</span>
<span class="ltx_bibblock">Self-play fine-tuning converts weak language models to strong language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.01335</em>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chiang and Lee (2023)</span>
<span class="ltx_bibblock">
Cheng-Han Chiang and Hung-yi Lee. 2023.

</span>
<span class="ltx_bibblock">Can large language models be an alternative to human evaluations?

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.01937</em>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(5)</span>
<span class="ltx_bibblock">
Tim Dettmers and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">The case for 4-bit precision: k-bit inference scaling laws, 2022.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">URL https://arxiv. org/abs/2212.09720</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubois et al. (2023)</span>
<span class="ltx_bibblock">
Yann Dubois, Xuechen Li, Rohan Taori, Tianyi Zhang, Ishaan Gulrajani, Jimmy Ba, Carlos Guestrin, Percy Liang, and Tatsunori B Hashimoto. 2023.

</span>
<span class="ltx_bibblock">Alpacafarm: A simulation framework for methods that learn from human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.14387</em>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2023)</span>
<span class="ltx_bibblock">
Jinlan Fu, See-Kiong Ng, Zhengbao Jiang, and Pengfei Liu. 2023.

</span>
<span class="ltx_bibblock">Gptscore: Evaluate as you desire.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.04166</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gunasekar et al. (2023)</span>
<span class="ltx_bibblock">
Suriya Gunasekar, Yi Zhang, Jyoti Aneja, Caio Cesar Teodoro Mendes, Allison Del Giorno, Sivakanth Gopi, Mojan Javaheripi, Piero C. Kauffmann, Gustavo de Rosa, Olli Saarikivi, Adil Salim, S. Shah, Harkirat Singh Behl, Xin Wang, Sébastien Bubeck, Ronen Eldan, Adam Tauman Kalai, Yin Tat Lee, and Yuan-Fang Li. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://api.semanticscholar.org/CorpusID:259203998" title="" class="ltx_ref ltx_href">Textbooks are all you need</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2306.11644.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2021a)</span>
<span class="ltx_bibblock">
Jesse Michael Han, Igor Babuschkin, Harrison Edwards, Arvind Neelakantan, Tao Xu, Stanislas Polu, Alex Ray, Pranav Shyam, Aditya Ramesh, Alec Radford, et al. 2021a.

</span>
<span class="ltx_bibblock">Unsupervised neural machine translation with generative language models only.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.05448</em>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2021b)</span>
<span class="ltx_bibblock">
Jesse Michael Han, Igor Babuschkin, Harrison Edwards, Arvind Neelakantan, Tao Xu, Stanislas Polu, Alex Ray, Pranav Shyam, Aditya Ramesh, Alec Radford, et al. 2021b.

</span>
<span class="ltx_bibblock">Unsupervised neural machine translation with generative language models only.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.05448</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Honovich et al. (2022)</span>
<span class="ltx_bibblock">
Or Honovich, Thomas Scialom, Omer Levy, and Timo Schick. 2022.

</span>
<span class="ltx_bibblock">Unnatural instructions: Tuning language models with (almost) no human labor.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2212.09689</em>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh et al. (2023)</span>
<span class="ltx_bibblock">
Cheng-Yu Hsieh, Chun-Liang Li, Chih-Kuan Yeh, Hootan Nakhost, Yasuhisa Fujii, Alexander Ratner, Ranjay Krishna, Chen-Yu Lee, and Tomas Pfister. 2023.

</span>
<span class="ltx_bibblock">Distilling step-by-step! outperforming larger language models with less training data and smaller model sizes.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.02301</em>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2021.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.09685</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2022)</span>
<span class="ltx_bibblock">
Jiaxin Huang, Shixiang Shane Gu, Le Hou, Yuexin Wu, Xuezhi Wang, Hongkun Yu, and Jiawei Han. 2022.

</span>
<span class="ltx_bibblock">Large language models can self-improve.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.11610</em>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jaiswal et al. (2023)</span>
<span class="ltx_bibblock">
Ajay Jaiswal, Zhe Gan, Xianzhi Du, Bowen Zhang, Zhangyang Wang, and Yinfei Yang. 2023.

</span>
<span class="ltx_bibblock">Compressing llms: The truth is rarely pure and never simple.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.01382</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2020a)</span>
<span class="ltx_bibblock">
Varun Kumar, Ashutosh Choudhary, and Eunah Cho. 2020a.

</span>
<span class="ltx_bibblock">Data augmentation using pre-trained transformer models.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.02245</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2020b)</span>
<span class="ltx_bibblock">
Varun Kumar, Ashutosh Choudhary, and Eunah Cho. 2020b.

</span>
<span class="ltx_bibblock">Data augmentation using pre-trained transformer models.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.02245</em>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lhoest et al. (2021)</span>
<span class="ltx_bibblock">
Quentin Lhoest, Albert Villanova del Moral, Yacine Jernite, Abhishek Thakur, Patrick von Platen, Suraj Patil, Julien Chaumond, Mariama Drame, Julien Plu, Lewis Tunstall, et al. 2021.

</span>
<span class="ltx_bibblock">Datasets: A community library for natural language processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.02846</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Xiang Lisa Li, Vaishnavi Shrivastava, Siyan Li, Tatsunori Hashimoto, and Percy Liang. 2023.

</span>
<span class="ltx_bibblock">Benchmarking and improving generator-validator consistency of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.01846</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al. (2023)</span>
<span class="ltx_bibblock">
Wing Lian, Bleys Goodson, Eugene Pentland, Austin Cook, Chanvichet Vong, and "Teknium". 2023.

</span>
<span class="ltx_bibblock">Openorca: An open dataset of gpt augmented flan reasoning traces.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://https://huggingface.co/Open-Orca/OpenOrca" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://https://huggingface.co/Open-Orca/OpenOrca</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Haokun Liu, Derek Tam, Mohammed Muqeeth, Jay Mohta, Tenghao Huang, Mohit Bansal, and Colin A Raffel. 2022.

</span>
<span class="ltx_bibblock">Few-shot parameter-efficient fine-tuning is better and cheaper than in-context learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:1950–1965.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Pengfei Liu, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and Graham Neubig. 2023.

</span>
<span class="ltx_bibblock">Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys</em>, 55(9):1–35.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mangrulkar et al. (2022)</span>
<span class="ltx_bibblock">
Sourab Mangrulkar, Sylvain Gugger, Lysandre Debut, Younes Belkada, Sayak Paul, and Benjamin Bossan. 2022.

</span>
<span class="ltx_bibblock">Peft: State-of-the-art parameter-efficient fine-tuning methods.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/huggingface/peft" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/huggingface/peft</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mishra et al. (2021)</span>
<span class="ltx_bibblock">
Swaroop Mishra, Daniel Khashabi, Chitta Baral, and Hannaneh Hajishirzi. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://api.semanticscholar.org/CorpusID:237421373" title="" class="ltx_ref ltx_href">Cross-task generalization via natural language crowdsourcing instructions</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Annual Meeting of the Association for Computational Linguistics</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitchell et al. (2019)</span>
<span class="ltx_bibblock">
Margaret Mitchell, Simone Wu, Andrew Zaldivar, Parker Barnes, Lucy Vasserman, Ben Hutchinson, Elena Spitzer, Inioluwa Deborah Raji, and Timnit Gebru. 2019.

</span>
<span class="ltx_bibblock">Model cards for model reporting.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the conference on fairness, accountability, and transparency</em>, pages 220–229.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mukherjee et al. (2023)</span>
<span class="ltx_bibblock">
Subhabrata Mukherjee, Arindam Mitra, Ganesh Jawahar, Sahaj Agarwal, Hamid Palangi, and Ahmed Awadallah. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/2306.02707" title="" class="ltx_ref ltx_href">Orca: Progressive learning from complex explanation traces of gpt-4</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI et al. (2023)</span>
<span class="ltx_bibblock">
OpenAI, :, Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, Red Avila, Igor Babuschkin, Suchir Balaji, Valerie Balcom, Paul Baltescu, Haiming Bao, Mo Bavarian, Jeff Belgum, Irwan Bello, Jake Berdine, Gabriel Bernadett-Shapiro, Christopher Berner, Lenny Bogdonoff, Oleg Boiko, Madelaine Boyd, Anna-Luisa Brakman, Greg Brockman, Tim Brooks, Miles Brundage, Kevin Button, Trevor Cai, Rosie Campbell, Andrew Cann, Brittany Carey, Chelsea Carlson, Rory Carmichael, Brooke Chan, Che Chang, Fotis Chantzis, Derek Chen, Sully Chen, Ruby Chen, Jason Chen, Mark Chen, Ben Chess, Chester Cho, Casey Chu, Hyung Won Chung, Dave Cummings, Jeremiah Currier, Yunxing Dai, Cory Decareaux, Thomas Degry, Noah Deutsch, Damien Deville, Arka Dhar, David Dohan, Steve Dowling, Sheila Dunning, Adrien Ecoffet, Atty Eleti, Tyna Eloundou, David Farhi, Liam Fedus, Niko Felix, Simón Posada Fishman, Juston Forte, Isabella Fulford, Leo Gao,
Elie Georges, Christian Gibson, Vik Goel, Tarun Gogineni, Gabriel Goh, Rapha Gontijo-Lopes, Jonathan Gordon, Morgan Grafstein, Scott Gray, Ryan Greene, Joshua Gross, Shixiang Shane Gu, Yufei Guo, Chris Hallacy, Jesse Han, Jeff Harris, Yuchen He, Mike Heaton, Johannes Heidecke, Chris Hesse, Alan Hickey, Wade Hickey, Peter Hoeschele, Brandon Houghton, Kenny Hsu, Shengli Hu, Xin Hu, Joost Huizinga, Shantanu Jain, Shawn Jain, Joanne Jang, Angela Jiang, Roger Jiang, Haozhun Jin, Denny Jin, Shino Jomoto, Billie Jonn, Heewoo Jun, Tomer Kaftan, Łukasz Kaiser, Ali Kamali, Ingmar Kanitscheider, Nitish Shirish Keskar, Tabarak Khan, Logan Kilpatrick, Jong Wook Kim, Christina Kim, Yongjik Kim, Hendrik Kirchner, Jamie Kiros, Matt Knight, Daniel Kokotajlo, Łukasz Kondraciuk, Andrew Kondrich, Aris Konstantinidis, Kyle Kosic, Gretchen Krueger, Vishal Kuo, Michael Lampe, Ikai Lan, Teddy Lee, Jan Leike, Jade Leung, Daniel Levy, Chak Ming Li, Rachel Lim, Molly Lin, Stephanie Lin, Mateusz Litwin, Theresa Lopez, Ryan Lowe,
Patricia Lue, Anna Makanju, Kim Malfacini, Sam Manning, Todor Markov, Yaniv Markovski, Bianca Martin, Katie Mayer, Andrew Mayne, Bob McGrew, Scott Mayer McKinney, Christine McLeavey, Paul McMillan, Jake McNeil, David Medina, Aalok Mehta, Jacob Menick, Luke Metz, Andrey Mishchenko, Pamela Mishkin, Vinnie Monaco, Evan Morikawa, Daniel Mossing, Tong Mu, Mira Murati, Oleg Murk, David Mély, Ashvin Nair, Reiichiro Nakano, Rajeev Nayak, Arvind Neelakantan, Richard Ngo, Hyeonwoo Noh, Long Ouyang, Cullen O’Keefe, Jakub Pachocki, Alex Paino, Joe Palermo, Ashley Pantuliano, Giambattista Parascandolo, Joel Parish, Emy Parparita, Alex Passos, Mikhail Pavlov, Andrew Peng, Adam Perelman, Filipe de Avila Belbute Peres, Michael Petrov, Henrique Ponde de Oliveira Pinto, Michael, Pokorny, Michelle Pokrass, Vitchyr Pong, Tolly Powell, Alethea Power, Boris Power, Elizabeth Proehl, Raul Puri, Alec Radford, Jack Rae, Aditya Ramesh, Cameron Raymond, Francis Real, Kendra Rimbach, Carl Ross, Bob Rotsted, Henri Roussez, Nick Ryder,
Mario Saltarelli, Ted Sanders, Shibani Santurkar, Girish Sastry, Heather Schmidt, David Schnurr, John Schulman, Daniel Selsam, Kyla Sheppard, Toki Sherbakov, Jessica Shieh, Sarah Shoker, Pranav Shyam, Szymon Sidor, Eric Sigler, Maddie Simens, Jordan Sitkin, Katarina Slama, Ian Sohl, Benjamin Sokolowsky, Yang Song, Natalie Staudacher, Felipe Petroski Such, Natalie Summers, Ilya Sutskever, Jie Tang, Nikolas Tezak, Madeleine Thompson, Phil Tillet, Amin Tootoonchian, Elizabeth Tseng, Preston Tuggle, Nick Turley, Jerry Tworek, Juan Felipe Cerón Uribe, Andrea Vallone, Arun Vijayvergiya, Chelsea Voss, Carroll Wainwright, Justin Jay Wang, Alvin Wang, Ben Wang, Jonathan Ward, Jason Wei, CJ Weinmann, Akila Welihinda, Peter Welinder, Jiayi Weng, Lilian Weng, Matt Wiethoff, Dave Willner, Clemens Winter, Samuel Wolrich, Hannah Wong, Lauren Workman, Sherwin Wu, Jeff Wu, Michael Wu, Kai Xiao, Tao Xu, Sarah Yoo, Kevin Yu, Qiming Yuan, Wojciech Zaremba, Rowan Zellers, Chong Zhang, Marvin Zhang, Shengjia Zhao, Tianhao
Zheng, Juntang Zhuang, William Zhuk, and Barret Zoph. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/2303.08774" title="" class="ltx_ref ltx_href">Gpt-4 technical report</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al. 2022.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:27730–27744.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al. 2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pushkarna et al. (2022)</span>
<span class="ltx_bibblock">
Mahima Pushkarna, Andrew Zaldivar, and Oddur Kjartansson. 2022.

</span>
<span class="ltx_bibblock">Data cards: Purposeful and transparent dataset documentation for responsible ai.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 ACM Conference on Fairness, Accountability, and Transparency</em>, pages 1776–1826.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. (2023)</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Stefano Ermon, Christopher D Manning, and Chelsea Finn. 2023.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.18290</em>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J Liu. 2020.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 21(1):5485–5551.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reimers and Gurevych (2019)</span>
<span class="ltx_bibblock">
Nils Reimers and Iryna Gurevych. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1908.10084" title="" class="ltx_ref ltx_href">Sentence-bert: Sentence embeddings using siamese bert-networks</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing</em>. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rush (2023)</span>
<span class="ltx_bibblock">
Alexander M Rush. 2023.

</span>
<span class="ltx_bibblock">Minichain: A small library for coding with large language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 311–317.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al. (2021)</span>
<span class="ltx_bibblock">
Victor Sanh, Albert Webson, Colin Raffel, Stephen H. Bach, Lintang Sutawika, Zaid Alyafeai, Antoine Chaffin, Arnaud Stiegler, Teven Le Scao, Arun Raja, Manan Dey, M Saiful Bari, Canwen Xu, Urmish Thakker, Shanya Sharma Sharma, Eliza Szczechla, Taewoon Kim, Gunjan Chhablani, Nihal V. Nayak, Debajyoti Datta, Jonathan D. Chang, Mike Tian-Jian Jiang, Han Wang, Matteo Manica, Sheng Shen, Zheng-Xin Yong, Harshit Pandey, Rachel Bawden, Thomas Wang, Trishala Neeraj, Jos Rozen, Abheesht Sharma, Andrea Santilli, Thibault Févry, Jason Alan Fries, Ryan Teehan, Stella Biderman, Leo Gao, Tali Bers, Thomas Wolf, and Alexander M. Rush. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://api.semanticscholar.org/CorpusID:239009562" title="" class="ltx_ref ltx_href">Multitask prompted training enables zero-shot task generalization</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2110.08207.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sclar et al. (2023)</span>
<span class="ltx_bibblock">
Melanie Sclar, Yejin Choi, Yulia Tsvetkov, and Alane Suhr. 2023.

</span>
<span class="ltx_bibblock">Quantifying language models’ sensitivity to spurious features in prompt design or: How i learned to start worrying about prompt formatting.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.11324</em>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shumailov et al. (2023)</span>
<span class="ltx_bibblock">
Ilia Shumailov, Zakhar Shumaylov, Yiren Zhao, Yarin Gal, Nicolas Papernot, and Ross Anderson. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/2305.17493" title="" class="ltx_ref ltx_href">The curse of recursion: Training on generated data makes models forget</a>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stiennon et al. (2020)</span>
<span class="ltx_bibblock">
Nisan Stiennon, Long Ouyang, Jeffrey Wu, Daniel Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul F Christiano. 2020.

</span>
<span class="ltx_bibblock">Learning to summarize with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:3008–3021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori et al. (2023)</span>
<span class="ltx_bibblock">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. 2023.

</span>
<span class="ltx_bibblock">Stanford alpaca: An instruction-following llama model.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/tatsu-lab/stanford_alpaca" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/tatsu-lab/stanford_alpaca</a>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">von Werra et al. (2020)</span>
<span class="ltx_bibblock">
Leandro von Werra, Younes Belkada, Lewis Tunstall, Edward Beeching, Tristan Thrush, Nathan Lambert, and Shengyi Huang. 2020.

</span>
<span class="ltx_bibblock">Trl: Transformer reinforcement learning.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/huggingface/trl" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/huggingface/trl</a>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Yizhong Wang, Yeganeh Kordi, Swaroop Mishra, Alisa Liu, Noah A Smith, Daniel Khashabi, and Hannaneh Hajishirzi. 2022.

</span>
<span class="ltx_bibblock">Self-instruct: Aligning language model with self generated instructions.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2212.10560</em>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2021)</span>
<span class="ltx_bibblock">
Jason Wei, Maarten Bosma, Vincent Y Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M Dai, and Quoc V Le. 2021.

</span>
<span class="ltx_bibblock">Finetuned language models are zero-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.01652</em>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. (2019)</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, et al. 2019.

</span>
<span class="ltx_bibblock">Huggingface’s transformers: State-of-the-art natural language processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03771</em>.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018)</span>
<span class="ltx_bibblock">
Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William W Cohen, Ruslan Salakhutdinov, and Christopher D Manning. 2018.

</span>
<span class="ltx_bibblock">Hotpotqa: A dataset for diverse, explainable multi-hop question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1809.09600</em>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2022)</span>
<span class="ltx_bibblock">
Jiacheng Ye, Jiahui Gao, Qintong Li, Hang Xu, Jiangtao Feng, Zhiyong Wu, Tao Yu, and Lingpeng Kong. 2022.

</span>
<span class="ltx_bibblock">Zerogen: Efficient zero-shot learning via dataset generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2202.07922</em>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoo et al. (2021)</span>
<span class="ltx_bibblock">
Kang Min Yoo, Dongju Park, Jaewook Kang, Sang-Woo Lee, and Woomyeong Park. 2021.

</span>
<span class="ltx_bibblock">Gpt3mix: Leveraging large-scale language models for text augmentation.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.08826</em>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Yue Yu, Yuchen Zhuang, Jieyu Zhang, Yu Meng, Alexander Ratner, Ranjay Krishna, Jiaming Shen, and Chao Zhang. 2023.

</span>
<span class="ltx_bibblock">Large language model as attributed training data generator: A tale of diversity and bias.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Thirty-Seventh Conference on Neural Information Processing Systems Datasets and Benchmarks Track</em>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2024)</span>
<span class="ltx_bibblock">
Weizhe Yuan, Richard Yuanzhe Pang, Kyunghyun Cho, Sainbayar Sukhbaatar, Jing Xu, and Jason Weston. 2024.

</span>
<span class="ltx_bibblock">Self-rewarding language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.10020</em>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Peiyuan Zhang, Guangtao Zeng, Tianduo Wang, and Wei Lu. 2024.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/2401.02385" title="" class="ltx_ref ltx_href">Tinyllama: An open-source small language model</a>.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Yanli Zhao, Andrew Gu, Rohan Varma, Liang Luo, Chien-Chin Huang, Min Xu, Less Wright, Hamid Shojanazeri, Myle Ott, Sam Shleifer, et al. 2023.

</span>
<span class="ltx_bibblock">Pytorch fsdp: experiences on scaling fully sharded data parallel.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.11277</em>.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2023)</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric Xing, et al. 2023.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.05685</em>.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Instruction-Tuning a LLM</h2>

<figure id="LST2" class="ltx_float ltx_lstlisting">
<div id="LST2.1" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSBkYXRhZHJlYW1lciBpbXBvcnQgRGF0YURyZWFtZXIKZnJvbSBkYXRhZHJlYW1lci5zdGVwcyBpbXBvcnQgSEZIdWJEYXRhU291cmNlCmZyb20gZGF0YWRyZWFtZXIudHJhaW5lcnMgaW1wb3J0IFRyYWluSEZGaW5lVHVuZQpmcm9tIHBlZnQgaW1wb3J0IExvcmFDb25maWcKCndpdGggRGF0YURyZWFtZXIoIi4vb3V0cHV0Iik6CiAgICAjIEdldCB0aGUgQWxwYWNhIGluc3RydWN0aW9uLXR1bmluZyBkYXRhc2V0IChjbGVhbmVkIHZlcnNpb24pCiAgICBpbnN0cnVjdGlvbl9kYXRhc2V0ID0gSEZIdWJEYXRhU291cmNlKAogICAgICAgICJHZXQgSW5zdHJ1Y3Rpb24tVHVuaW5nIERhdGFzZXQiLCAieWFobWEvYWxwYWNhLWNsZWFuZWQiLCBzcGxpdD0idHJhaW4iCiAgICApCgogICAgIyBLZWVwIG9ubHkgMTAwMCBleGFtcGxlcyBhcyBhIHF1aWNrIGRlbW8KICAgIGluc3RydWN0aW9uX2RhdGFzZXQgPSBpbnN0cnVjdGlvbl9kYXRhc2V0LnRha2UoMTAwMCkKCiAgICAjIFNvbWUgZXhhbXBsZXMgdGFrZW4gaW4gYW4gImlucHV0Iiwgd2UnbGwgZm9ybWF0IHRob3NlIGludG8gdGhlIGluc3RydWN0aW9uCiAgICBpbnN0cnVjdGlvbl9kYXRhc2V0Lm1hcCgKICAgICAgICBsYW1iZGEgcm93OiB7CiAgICAgICAgICAgICJpbnN0cnVjdGlvbiI6ICgKICAgICAgICAgICAgICAgIHJvd1siaW5zdHJ1Y3Rpb24iXQogICAgICAgICAgICAgICAgaWYgbGVuKHJvd1siaW5wdXQiXSkgPT0gMAogICAgICAgICAgICAgICAgZWxzZSBmIklucHV0OiB7cm93WydpbnB1dCddfVxuXG57cm93WydpbnN0cnVjdGlvbiddfSIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgIm91dHB1dCI6IHJvd1sib3V0cHV0Il0sCiAgICAgICAgfSwKICAgICAgICBsYXp5PUZhbHNlLAogICAgKQoKICAgICMgQ3JlYXRlIHRyYWluaW5nIGRhdGEgc3BsaXRzCiAgICBzcGxpdHMgPSBpbnN0cnVjdGlvbl9kYXRhc2V0LnNwbGl0cyh0cmFpbl9zaXplPTAuOTAsIHZhbGlkYXRpb25fc2l6ZT0wLjEwKQoKICAgICMgRGVmaW5lIHdoYXQgdGhlIHByb21wdCB0ZW1wbGF0ZSBzaG91bGQgYmUgd2hlbiBpbnN0cnVjdGlvbi10dW5pbmcKICAgIGNoYXRfcHJvbXB0X3RlbXBsYXRlID0gIiMjIyBJbnN0cnVjdGlvbjpcbnt7cHJvbXB0fX1cblxuIyMjIFJlc3BvbnNlOlxuIgoKICAgICMgSW5zdHJ1Y3Rpb24tdHVuZSB0aGUgYmFzZSBUaW55TGxhbWEgbW9kZWwgdG8gbWFrZSBpdCBmb2xsb3cgaW5zdHJ1Y3Rpb25zCiAgICB0cmFpbmVyID0gVHJhaW5IRkZpbmVUdW5lKAogICAgICAgICJJbnN0cnVjdGlvbi1UdW5lIFRpbnlMbGFtYSIsCiAgICAgICAgbW9kZWxfbmFtZT0iVGlueUxsYW1hL1RpbnlMbGFtYS0xLjFCLWludGVybWVkaWF0ZS1zdGVwLTE0MzFrLTNUIiwKICAgICAgICBjaGF0X3Byb21wdF90ZW1wbGF0ZT1jaGF0X3Byb21wdF90ZW1wbGF0ZSwKICAgICAgICBwZWZ0X2NvbmZpZz1Mb3JhQ29uZmlnKCksCiAgICAgICAgZGV2aWNlPVsiY3VkYTowIiwgImN1ZGE6MSJdLAogICAgICAgIGR0eXBlPSJiZmxvYXQxNiIsCiAgICApCiAgICB0cmFpbmVyLnRyYWluKAogICAgICAgIHRyYWluX2lucHV0PXNwbGl0c1sidHJhaW4iXS5vdXRwdXRbImluc3RydWN0aW9uIl0sCiAgICAgICAgdHJhaW5fb3V0cHV0PXNwbGl0c1sidHJhaW4iXS5vdXRwdXRbIm91dHB1dCJdLAogICAgICAgIHZhbGlkYXRpb25faW5wdXQ9c3BsaXRzWyJ2YWxpZGF0aW9uIl0ub3V0cHV0WyJpbnN0cnVjdGlvbiJdLAogICAgICAgIHZhbGlkYXRpb25fb3V0cHV0PXNwbGl0c1sidmFsaWRhdGlvbiJdLm91dHB1dFsib3V0cHV0Il0sCiAgICAgICAgZXBvY2hzPTMsCiAgICAgICAgYmF0Y2hfc2l6ZT0xLAogICAgICAgIGdyYWRpZW50X2FjY3VtdWxhdGlvbl9zdGVwcz0zMiwKICAgICk=" download="resources/examples/instruct.py">⬇</a></div>
<div id="lstnumberx67" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx67.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx67.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx67.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx67.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx67.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx67.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx67.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span>
</div>
<div id="lstnumberx68" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx68.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx68.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx68.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx68.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx68.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">steps</span><span id="lstnumberx68.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx68.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx68.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx68.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span>
</div>
<div id="lstnumberx69" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx69.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx69.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx69.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx69.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx69.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainers</span><span id="lstnumberx69.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx69.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx69.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx69.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFFineTune</span>
</div>
<div id="lstnumberx70" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span id="lstnumberx70.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx70.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx70.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft</span><span id="lstnumberx70.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx70.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx70.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx70.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span>
</div>
<div id="lstnumberx71" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>
</div>
<div id="lstnumberx72" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span><span id="lstnumberx72.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">with</span><span id="lstnumberx72.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx72.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span><span id="lstnumberx72.4" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx72.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"./output"</span><span id="lstnumberx72.6" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx73" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span id="lstnumberx73.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx73.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx73.2.1" class="ltx_text ltx_lst_space"> </span>Get<span id="lstnumberx73.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx73.2.3" class="ltx_text ltx_lst_space"> </span>Alpaca<span id="lstnumberx73.2.4" class="ltx_text ltx_lst_space"> </span>instruction-tuning<span id="lstnumberx73.2.5" class="ltx_text ltx_lst_space"> </span>dataset<span id="lstnumberx73.2.6" class="ltx_text ltx_lst_space"> </span>(cleaned<span id="lstnumberx73.2.7" class="ltx_text ltx_lst_space"> </span>version)</span>
</div>
<div id="lstnumberx74" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span><span id="lstnumberx74.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx74.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">instruction_dataset</span><span id="lstnumberx74.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx74.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx74.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx74.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span><span id="lstnumberx74.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx75" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span><span id="lstnumberx75.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx75.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Get<span id="lstnumberx75.2.1" class="ltx_text ltx_lst_space"> </span>Instruction-Tuning<span id="lstnumberx75.2.2" class="ltx_text ltx_lst_space"> </span>Dataset"</span><span id="lstnumberx75.3" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx75.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx75.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"yahma/alpaca-cleaned"</span><span id="lstnumberx75.6" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx75.7" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx75.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">split</span><span id="lstnumberx75.9" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx75.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span>
</div>
<div id="lstnumberx76" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span><span id="lstnumberx76.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx76.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx77" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>
</div>
<div id="lstnumberx78" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span><span id="lstnumberx78.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx78.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx78.2.1" class="ltx_text ltx_lst_space"> </span>Keep<span id="lstnumberx78.2.2" class="ltx_text ltx_lst_space"> </span>only<span id="lstnumberx78.2.3" class="ltx_text ltx_lst_space"> </span>1000<span id="lstnumberx78.2.4" class="ltx_text ltx_lst_space"> </span>examples<span id="lstnumberx78.2.5" class="ltx_text ltx_lst_space"> </span>as<span id="lstnumberx78.2.6" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx78.2.7" class="ltx_text ltx_lst_space"> </span>quick<span id="lstnumberx78.2.8" class="ltx_text ltx_lst_space"> </span>demo</span>
</div>
<div id="lstnumberx79" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span><span id="lstnumberx79.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx79.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">instruction_dataset</span><span id="lstnumberx79.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx79.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx79.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx79.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">instruction_dataset</span><span id="lstnumberx79.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx79.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">take</span><span id="lstnumberx79.9" class="ltx_text ltx_font_typewriter">(1000)</span>
</div>
<div id="lstnumberx80" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>
</div>
<div id="lstnumberx81" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span><span id="lstnumberx81.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx81.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx81.2.1" class="ltx_text ltx_lst_space"> </span>Some<span id="lstnumberx81.2.2" class="ltx_text ltx_lst_space"> </span>examples<span id="lstnumberx81.2.3" class="ltx_text ltx_lst_space"> </span>taken<span id="lstnumberx81.2.4" class="ltx_text ltx_lst_space"> </span>in<span id="lstnumberx81.2.5" class="ltx_text ltx_lst_space"> </span>an<span id="lstnumberx81.2.6" class="ltx_text ltx_lst_space"> </span>"input",<span id="lstnumberx81.2.7" class="ltx_text ltx_lst_space"> </span>we’ll<span id="lstnumberx81.2.8" class="ltx_text ltx_lst_space"> </span>format<span id="lstnumberx81.2.9" class="ltx_text ltx_lst_space"> </span>those<span id="lstnumberx81.2.10" class="ltx_text ltx_lst_space"> </span>into<span id="lstnumberx81.2.11" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx81.2.12" class="ltx_text ltx_lst_space"> </span>instruction</span>
</div>
<div id="lstnumberx82" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span><span id="lstnumberx82.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx82.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">instruction_dataset</span><span id="lstnumberx82.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx82.4" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" style="color:#0000FF;">map</span><span id="lstnumberx82.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx83" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span><span id="lstnumberx83.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx83.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">lambda</span><span id="lstnumberx83.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx83.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx83.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx83.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx83.7" class="ltx_text ltx_font_typewriter">{</span>
</div>
<div id="lstnumberx84" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span><span id="lstnumberx84.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx84.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"instruction"</span><span id="lstnumberx84.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx84.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx84.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx85" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span><span id="lstnumberx85.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx85.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx85.3" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx85.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"instruction"</span><span id="lstnumberx85.5" class="ltx_text ltx_font_typewriter">]</span>
</div>
<div id="lstnumberx86" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span><span id="lstnumberx86.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx86.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">if</span><span id="lstnumberx86.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx86.4" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" style="color:#0000FF;">len</span><span id="lstnumberx86.5" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx86.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx86.7" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx86.8" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"input"</span><span id="lstnumberx86.9" class="ltx_text ltx_font_typewriter">])</span><span id="lstnumberx86.10" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx86.11" class="ltx_text ltx_font_typewriter">==</span><span id="lstnumberx86.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx86.13" class="ltx_text ltx_font_typewriter">0</span>
</div>
<div id="lstnumberx87" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span><span id="lstnumberx87.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx87.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">else</span><span id="lstnumberx87.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx87.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">f</span><span id="lstnumberx87.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Input:<span id="lstnumberx87.5.1" class="ltx_text ltx_lst_space"> </span>{row[’input’]}\n\n{row[’instruction’]}"</span>
</div>
<div id="lstnumberx88" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span><span id="lstnumberx88.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx88.2" class="ltx_text ltx_font_typewriter">),</span>
</div>
<div id="lstnumberx89" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span><span id="lstnumberx89.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx89.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"output"</span><span id="lstnumberx89.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx89.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx89.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx89.6" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx89.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"output"</span><span id="lstnumberx89.8" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx90" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span><span id="lstnumberx90.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx90.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx91" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span><span id="lstnumberx91.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx91.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">lazy</span><span id="lstnumberx91.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx91.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">False</span><span id="lstnumberx91.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx92" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span><span id="lstnumberx92.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx92.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx93" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span>
</div>
<div id="lstnumberx94" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span><span id="lstnumberx94.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx94.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx94.2.1" class="ltx_text ltx_lst_space"> </span>Create<span id="lstnumberx94.2.2" class="ltx_text ltx_lst_space"> </span>training<span id="lstnumberx94.2.3" class="ltx_text ltx_lst_space"> </span>data<span id="lstnumberx94.2.4" class="ltx_text ltx_lst_space"> </span>splits</span>
</div>
<div id="lstnumberx95" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span><span id="lstnumberx95.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx95.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx95.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx95.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx95.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx95.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">instruction_dataset</span><span id="lstnumberx95.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx95.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx95.9" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx95.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_size</span><span id="lstnumberx95.11" class="ltx_text ltx_font_typewriter">=0.90,</span><span id="lstnumberx95.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx95.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_size</span><span id="lstnumberx95.14" class="ltx_text ltx_font_typewriter">=0.10)</span>
</div>
<div id="lstnumberx96" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span>
</div>
<div id="lstnumberx97" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span><span id="lstnumberx97.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx97.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx97.2.1" class="ltx_text ltx_lst_space"> </span>Define<span id="lstnumberx97.2.2" class="ltx_text ltx_lst_space"> </span>what<span id="lstnumberx97.2.3" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx97.2.4" class="ltx_text ltx_lst_space"> </span>prompt<span id="lstnumberx97.2.5" class="ltx_text ltx_lst_space"> </span>template<span id="lstnumberx97.2.6" class="ltx_text ltx_lst_space"> </span>should<span id="lstnumberx97.2.7" class="ltx_text ltx_lst_space"> </span>be<span id="lstnumberx97.2.8" class="ltx_text ltx_lst_space"> </span>when<span id="lstnumberx97.2.9" class="ltx_text ltx_lst_space"> </span>instruction-tuning</span>
</div>
<div id="lstnumberx98" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span><span id="lstnumberx98.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx98.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">chat_prompt_template</span><span id="lstnumberx98.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx98.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx98.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx98.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"###<span id="lstnumberx98.6.1" class="ltx_text ltx_lst_space"> </span>Instruction:\n{{prompt}}\n\n###<span id="lstnumberx98.6.2" class="ltx_text ltx_lst_space"> </span>Response:\n"</span>
</div>
<div id="lstnumberx99" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span>
</div>
<div id="lstnumberx100" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span><span id="lstnumberx100.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx100.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx100.2.1" class="ltx_text ltx_lst_space"> </span>Instruction-tune<span id="lstnumberx100.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx100.2.3" class="ltx_text ltx_lst_space"> </span>base<span id="lstnumberx100.2.4" class="ltx_text ltx_lst_space"> </span>TinyLlama<span id="lstnumberx100.2.5" class="ltx_text ltx_lst_space"> </span>model<span id="lstnumberx100.2.6" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx100.2.7" class="ltx_text ltx_lst_space"> </span>make<span id="lstnumberx100.2.8" class="ltx_text ltx_lst_space"> </span>it<span id="lstnumberx100.2.9" class="ltx_text ltx_lst_space"> </span>follow<span id="lstnumberx100.2.10" class="ltx_text ltx_lst_space"> </span>instructions</span>
</div>
<div id="lstnumberx101" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span><span id="lstnumberx101.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx101.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx101.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx101.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx101.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx101.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFFineTune</span><span id="lstnumberx101.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx102" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span><span id="lstnumberx102.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx102.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Instruction-Tune<span id="lstnumberx102.2.1" class="ltx_text ltx_lst_space"> </span>TinyLlama"</span><span id="lstnumberx102.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx103" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">37</span><span id="lstnumberx103.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx103.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">model_name</span><span id="lstnumberx103.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx103.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T"</span><span id="lstnumberx103.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx104" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">38</span><span id="lstnumberx104.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx104.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">chat_prompt_template</span><span id="lstnumberx104.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx104.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">chat_prompt_template</span><span id="lstnumberx104.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx105" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">39</span><span id="lstnumberx105.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx105.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft_config</span><span id="lstnumberx105.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx105.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span><span id="lstnumberx105.5" class="ltx_text ltx_font_typewriter">(),</span>
</div>
<div id="lstnumberx106" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">40</span><span id="lstnumberx106.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx106.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">device</span><span id="lstnumberx106.3" class="ltx_text ltx_font_typewriter">=[</span><span id="lstnumberx106.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"cuda:0"</span><span id="lstnumberx106.5" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx106.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx106.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"cuda:1"</span><span id="lstnumberx106.8" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx107" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">41</span><span id="lstnumberx107.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx107.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dtype</span><span id="lstnumberx107.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx107.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"bfloat16"</span><span id="lstnumberx107.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx108" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">42</span><span id="lstnumberx108.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx108.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx109" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">43</span><span id="lstnumberx109.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx109.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx109.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx109.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train</span><span id="lstnumberx109.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx110" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">44</span><span id="lstnumberx110.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx110.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_input</span><span id="lstnumberx110.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx110.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx110.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx110.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx110.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx110.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx110.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx110.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"instruction"</span><span id="lstnumberx110.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx111" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">45</span><span id="lstnumberx111.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx111.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_output</span><span id="lstnumberx111.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx111.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx111.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx111.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx111.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx111.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx111.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx111.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"output"</span><span id="lstnumberx111.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx112" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">46</span><span id="lstnumberx112.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx112.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_input</span><span id="lstnumberx112.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx112.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx112.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx112.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx112.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx112.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx112.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx112.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"instruction"</span><span id="lstnumberx112.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx113" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">47</span><span id="lstnumberx113.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx113.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_output</span><span id="lstnumberx113.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx113.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx113.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx113.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx113.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx113.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx113.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx113.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"output"</span><span id="lstnumberx113.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx114" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">48</span><span id="lstnumberx114.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx114.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">epochs</span><span id="lstnumberx114.3" class="ltx_text ltx_font_typewriter">=3,</span>
</div>
<div id="lstnumberx115" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">49</span><span id="lstnumberx115.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx115.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">batch_size</span><span id="lstnumberx115.3" class="ltx_text ltx_font_typewriter">=1,</span>
</div>
<div id="lstnumberx116" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">50</span><span id="lstnumberx116.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx116.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gradient_accumulation_steps</span><span id="lstnumberx116.3" class="ltx_text ltx_font_typewriter">=32,</span>
</div>
<div id="lstnumberx117" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">51</span><span id="lstnumberx117.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx117.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#FAFAFA;"><span class="ltx_tag ltx_tag_float">Example 2: </span>In this demonstration snippet, we instruction-tune a model <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>; Zhang et al., <a href="#bib.bib49" title="" class="ltx_ref">2024</a>; Taori et al., <a href="#bib.bib39" title="" class="ltx_ref">2023</a>)</cite>. DataDreamer reduces boilerplate around tokenization, caching, training resumability, multi-GPU training, parameter-efficient fine-tuning, and more.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Aligning a LLM</h2>

<figure id="LST3" class="ltx_float ltx_lstlisting">
<div id="LST3.1" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSBkYXRhZHJlYW1lciBpbXBvcnQgRGF0YURyZWFtZXIKZnJvbSBkYXRhZHJlYW1lci5zdGVwcyBpbXBvcnQgSEZIdWJEYXRhU291cmNlCmZyb20gZGF0YWRyZWFtZXIudHJhaW5lcnMgaW1wb3J0IFRyYWluSEZEUE8KZnJvbSBwZWZ0IGltcG9ydCBMb3JhQ29uZmlnCgp3aXRoIERhdGFEcmVhbWVyKCIuL291dHB1dCIpOgogICAgIyBHZXQgdGhlIERQTyBkYXRhc2V0CiAgICBkcG9fZGF0YXNldCA9IEhGSHViRGF0YVNvdXJjZSgKICAgICAgICAiR2V0IERQTyBEYXRhc2V0IiwgIkludGVsL29yY2FfZHBvX3BhaXJzIiwgc3BsaXQ9InRyYWluIgogICAgKQoKICAgICMgS2VlcCBvbmx5IDEwMDAgZXhhbXBsZXMgYXMgYSBxdWljayBkZW1vCiAgICBkcG9fZGF0YXNldCA9IGRwb19kYXRhc2V0LnRha2UoMTAwMCkKCiAgICAjIENyZWF0ZSB0cmFpbmluZyBkYXRhIHNwbGl0cwogICAgc3BsaXRzID0gZHBvX2RhdGFzZXQuc3BsaXRzKHRyYWluX3NpemU9MC45MCwgdmFsaWRhdGlvbl9zaXplPTAuMTApCgogICAgIyBBbGlnbiB0aGUgVGlueUxsYW1hIGNoYXQgbW9kZWwgd2l0aCBodW1hbiBwcmVmZXJlbmNlcwogICAgdHJhaW5lciA9IFRyYWluSEZEUE8oCiAgICAgICAgIkFsaWduIFRpbnlMbGFtYS1DaGF0IiwKICAgICAgICBtb2RlbF9uYW1lPSJUaW55TGxhbWEvVGlueUxsYW1hLTEuMUItQ2hhdC12MS4wIiwKICAgICAgICBwZWZ0X2NvbmZpZz1Mb3JhQ29uZmlnKCksCiAgICAgICAgZGV2aWNlPVsiY3VkYTowIiwgImN1ZGE6MSJdLAogICAgICAgIGR0eXBlPSJiZmxvYXQxNiIsCiAgICApCiAgICB0cmFpbmVyLnRyYWluKAogICAgICAgIHRyYWluX3Byb21wdHM9c3BsaXRzWyJ0cmFpbiJdLm91dHB1dFsicXVlc3Rpb24iXSwKICAgICAgICB0cmFpbl9jaG9zZW49c3BsaXRzWyJ0cmFpbiJdLm91dHB1dFsiY2hvc2VuIl0sCiAgICAgICAgdHJhaW5fcmVqZWN0ZWQ9c3BsaXRzWyJ0cmFpbiJdLm91dHB1dFsicmVqZWN0ZWQiXSwKICAgICAgICB2YWxpZGF0aW9uX3Byb21wdHM9c3BsaXRzWyJ2YWxpZGF0aW9uIl0ub3V0cHV0WyJxdWVzdGlvbiJdLAogICAgICAgIHZhbGlkYXRpb25fY2hvc2VuPXNwbGl0c1sidmFsaWRhdGlvbiJdLm91dHB1dFsiY2hvc2VuIl0sCiAgICAgICAgdmFsaWRhdGlvbl9yZWplY3RlZD1zcGxpdHNbInZhbGlkYXRpb24iXS5vdXRwdXRbInJlamVjdGVkIl0sCiAgICAgICAgZXBvY2hzPTMsCiAgICAgICAgYmF0Y2hfc2l6ZT0xLAogICAgICAgIGdyYWRpZW50X2FjY3VtdWxhdGlvbl9zdGVwcz0zMiwKICAgICk=" download="resources/examples/align.py">⬇</a></div>
<div id="lstnumberx118" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx118.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx118.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx118.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx118.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx118.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx118.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx118.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span>
</div>
<div id="lstnumberx119" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx119.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx119.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx119.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx119.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx119.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">steps</span><span id="lstnumberx119.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx119.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx119.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx119.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span>
</div>
<div id="lstnumberx120" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx120.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx120.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx120.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx120.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx120.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainers</span><span id="lstnumberx120.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx120.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx120.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx120.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFDPO</span>
</div>
<div id="lstnumberx121" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span id="lstnumberx121.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx121.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx121.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft</span><span id="lstnumberx121.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx121.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx121.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx121.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span>
</div>
<div id="lstnumberx122" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>
</div>
<div id="lstnumberx123" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span><span id="lstnumberx123.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">with</span><span id="lstnumberx123.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx123.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span><span id="lstnumberx123.4" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx123.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"./output"</span><span id="lstnumberx123.6" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx124" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span id="lstnumberx124.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx124.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx124.2.1" class="ltx_text ltx_lst_space"> </span>Get<span id="lstnumberx124.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx124.2.3" class="ltx_text ltx_lst_space"> </span>DPO<span id="lstnumberx124.2.4" class="ltx_text ltx_lst_space"> </span>dataset</span>
</div>
<div id="lstnumberx125" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span><span id="lstnumberx125.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx125.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dpo_dataset</span><span id="lstnumberx125.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx125.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx125.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx125.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span><span id="lstnumberx125.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx126" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span><span id="lstnumberx126.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx126.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Get<span id="lstnumberx126.2.1" class="ltx_text ltx_lst_space"> </span>DPO<span id="lstnumberx126.2.2" class="ltx_text ltx_lst_space"> </span>Dataset"</span><span id="lstnumberx126.3" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx126.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx126.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Intel/orca_dpo_pairs"</span><span id="lstnumberx126.6" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx126.7" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx126.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">split</span><span id="lstnumberx126.9" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx126.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span>
</div>
<div id="lstnumberx127" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span><span id="lstnumberx127.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx127.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx128" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>
</div>
<div id="lstnumberx129" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span><span id="lstnumberx129.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx129.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx129.2.1" class="ltx_text ltx_lst_space"> </span>Keep<span id="lstnumberx129.2.2" class="ltx_text ltx_lst_space"> </span>only<span id="lstnumberx129.2.3" class="ltx_text ltx_lst_space"> </span>1000<span id="lstnumberx129.2.4" class="ltx_text ltx_lst_space"> </span>examples<span id="lstnumberx129.2.5" class="ltx_text ltx_lst_space"> </span>as<span id="lstnumberx129.2.6" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx129.2.7" class="ltx_text ltx_lst_space"> </span>quick<span id="lstnumberx129.2.8" class="ltx_text ltx_lst_space"> </span>demo</span>
</div>
<div id="lstnumberx130" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span><span id="lstnumberx130.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx130.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dpo_dataset</span><span id="lstnumberx130.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx130.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx130.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx130.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dpo_dataset</span><span id="lstnumberx130.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx130.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">take</span><span id="lstnumberx130.9" class="ltx_text ltx_font_typewriter">(1000)</span>
</div>
<div id="lstnumberx131" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>
</div>
<div id="lstnumberx132" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span><span id="lstnumberx132.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx132.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx132.2.1" class="ltx_text ltx_lst_space"> </span>Create<span id="lstnumberx132.2.2" class="ltx_text ltx_lst_space"> </span>training<span id="lstnumberx132.2.3" class="ltx_text ltx_lst_space"> </span>data<span id="lstnumberx132.2.4" class="ltx_text ltx_lst_space"> </span>splits</span>
</div>
<div id="lstnumberx133" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span><span id="lstnumberx133.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx133.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx133.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx133.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx133.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx133.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dpo_dataset</span><span id="lstnumberx133.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx133.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx133.9" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx133.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_size</span><span id="lstnumberx133.11" class="ltx_text ltx_font_typewriter">=0.90,</span><span id="lstnumberx133.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx133.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_size</span><span id="lstnumberx133.14" class="ltx_text ltx_font_typewriter">=0.10)</span>
</div>
<div id="lstnumberx134" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>
</div>
<div id="lstnumberx135" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span><span id="lstnumberx135.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx135.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx135.2.1" class="ltx_text ltx_lst_space"> </span>Align<span id="lstnumberx135.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx135.2.3" class="ltx_text ltx_lst_space"> </span>TinyLlama<span id="lstnumberx135.2.4" class="ltx_text ltx_lst_space"> </span>chat<span id="lstnumberx135.2.5" class="ltx_text ltx_lst_space"> </span>model<span id="lstnumberx135.2.6" class="ltx_text ltx_lst_space"> </span>with<span id="lstnumberx135.2.7" class="ltx_text ltx_lst_space"> </span>human<span id="lstnumberx135.2.8" class="ltx_text ltx_lst_space"> </span>preferences</span>
</div>
<div id="lstnumberx136" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span><span id="lstnumberx136.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx136.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx136.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx136.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx136.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx136.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFDPO</span><span id="lstnumberx136.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx137" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span><span id="lstnumberx137.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx137.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Align<span id="lstnumberx137.2.1" class="ltx_text ltx_lst_space"> </span>TinyLlama-Chat"</span><span id="lstnumberx137.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx138" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span><span id="lstnumberx138.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx138.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">model_name</span><span id="lstnumberx138.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx138.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"TinyLlama/TinyLlama-1.1B-Chat-v1.0"</span><span id="lstnumberx138.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx139" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span><span id="lstnumberx139.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx139.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft_config</span><span id="lstnumberx139.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx139.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span><span id="lstnumberx139.5" class="ltx_text ltx_font_typewriter">(),</span>
</div>
<div id="lstnumberx140" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span><span id="lstnumberx140.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx140.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">device</span><span id="lstnumberx140.3" class="ltx_text ltx_font_typewriter">=[</span><span id="lstnumberx140.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"cuda:0"</span><span id="lstnumberx140.5" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx140.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx140.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"cuda:1"</span><span id="lstnumberx140.8" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx141" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span><span id="lstnumberx141.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx141.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dtype</span><span id="lstnumberx141.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx141.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"bfloat16"</span><span id="lstnumberx141.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx142" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span><span id="lstnumberx142.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx142.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx143" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span><span id="lstnumberx143.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx143.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx143.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx143.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train</span><span id="lstnumberx143.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx144" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span><span id="lstnumberx144.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx144.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_prompts</span><span id="lstnumberx144.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx144.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx144.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx144.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx144.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx144.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx144.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx144.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx144.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx145" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span><span id="lstnumberx145.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx145.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_chosen</span><span id="lstnumberx145.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx145.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx145.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx145.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx145.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx145.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx145.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx145.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"chosen"</span><span id="lstnumberx145.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx146" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span><span id="lstnumberx146.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx146.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_rejected</span><span id="lstnumberx146.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx146.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx146.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx146.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx146.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx146.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx146.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx146.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"rejected"</span><span id="lstnumberx146.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx147" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span><span id="lstnumberx147.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx147.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_prompts</span><span id="lstnumberx147.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx147.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx147.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx147.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx147.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx147.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx147.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx147.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx147.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx148" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span><span id="lstnumberx148.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx148.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_chosen</span><span id="lstnumberx148.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx148.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx148.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx148.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx148.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx148.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx148.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx148.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"chosen"</span><span id="lstnumberx148.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx149" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span><span id="lstnumberx149.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx149.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_rejected</span><span id="lstnumberx149.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx149.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx149.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx149.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx149.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx149.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx149.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx149.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"rejected"</span><span id="lstnumberx149.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx150" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span><span id="lstnumberx150.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx150.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">epochs</span><span id="lstnumberx150.3" class="ltx_text ltx_font_typewriter">=3,</span>
</div>
<div id="lstnumberx151" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span><span id="lstnumberx151.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx151.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">batch_size</span><span id="lstnumberx151.3" class="ltx_text ltx_font_typewriter">=1,</span>
</div>
<div id="lstnumberx152" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span><span id="lstnumberx152.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx152.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gradient_accumulation_steps</span><span id="lstnumberx152.3" class="ltx_text ltx_font_typewriter">=32,</span>
</div>
<div id="lstnumberx153" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span><span id="lstnumberx153.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx153.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#FAFAFA;"><span class="ltx_tag ltx_tag_float">Example 3: </span>In this demonstration snippet, we align a model using DPO <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et al., <a href="#bib.bib31" title="" class="ltx_ref">2023</a>; Zhang et al., <a href="#bib.bib49" title="" class="ltx_ref">2024</a>; Lian et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>; Mukherjee et al., <a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite>. DataDreamer reduces boilerplate around tokenization, caching, training resumability, multi-GPU training, parameter-efficient fine-tuning, and more.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Self-Rewarding LLMs</h2>

<figure id="LST4" class="ltx_float ltx_lstlisting">
<div id="LST4.1" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSBkYXRhZHJlYW1lciBpbXBvcnQgRGF0YURyZWFtZXIKZnJvbSBkYXRhZHJlYW1lci5zdGVwcyBpbXBvcnQgKAogICAgSEZIdWJEYXRhU291cmNlLAogICAgUHJvbXB0LAogICAgSnVkZ2VHZW5lcmF0aW9uUGFpcnNXaXRoUHJvbXB0LAopCmZyb20gZGF0YWRyZWFtZXIudHJhaW5lcnMgaW1wb3J0IFRyYWluSEZEUE8KZnJvbSBkYXRhZHJlYW1lci5sbG1zIGltcG9ydCBIRlRyYW5zZm9ybWVycwpmcm9tIHBlZnQgaW1wb3J0IExvcmFDb25maWcKCndpdGggRGF0YURyZWFtZXIoIi4vb3V0cHV0Iik6CiAgICAjIEdldCBhIGRhdGFzZXQgb2YgcHJvbXB0cwogICAgcHJvbXB0c19kYXRhc2V0ID0gSEZIdWJEYXRhU291cmNlKAogICAgICAgICJHZXQgUHJvbXB0cyBEYXRhc2V0IiwgIkludGVsL29yY2FfZHBvX3BhaXJzIiwgc3BsaXQ9InRyYWluIgogICAgKS5zZWxlY3RfY29sdW1ucyhbInF1ZXN0aW9uIl0pCgogICAgIyBLZWVwIG9ubHkgMzAwMCBleGFtcGxlcyBhcyBhIHF1aWNrIGRlbW8KICAgIHByb21wdHNfZGF0YXNldCA9IHByb21wdHNfZGF0YXNldC50YWtlKDMwMDApCgogICAgIyBEZWZpbmUgaG93IG1hbnkgcm91bmRzIG9mIHNlbGYtcmV3YXJkIHRyYWluaW5nCiAgICByb3VuZHMgPSAzCgogICAgIyBGb3IgZWFjaCByb3VuZCBvZiBzZWxmLXJld2FyZCB0cmFpbmluZwogICAgYWRhcHRlcl90b19hcHBseSA9IE5vbmUKICAgIGZvciByIGluIHJhbmdlKHJvdW5kcyk6CiAgICAgICAgIyBVc2UgYSBwYXJ0aWFsIHNldCBvZiB0aGUgcHJvbXB0cyBmb3IgZWFjaCByb3VuZAogICAgICAgIHByb21wdHNfZm9yX3JvdW5kID0gcHJvbXB0c19kYXRhc2V0LnNoYXJkKAogICAgICAgICAgICBudW1fc2hhcmRzPXJvdW5kcywgaW5kZXg9ciwgbmFtZT1mIlJvdW5kICN7cisxfTogR2V0IFByb21wdHMiCiAgICAgICAgKQoKICAgICAgICAjIExvYWQgdGhlIExMTQogICAgICAgIGxsbSA9IEhGVHJhbnNmb3JtZXJzKAogICAgICAgICAgICAiVGlueUxsYW1hL1RpbnlMbGFtYS0xLjFCLUNoYXQtdjEuMCIsCiAgICAgICAgICAgIGFkYXB0ZXJfbmFtZT1hZGFwdGVyX3RvX2FwcGx5LAogICAgICAgICAgICBkZXZpY2VfbWFwPSJhdXRvIiwKICAgICAgICAgICAgZHR5cGU9ImJmbG9hdDE2IiwKICAgICAgICApCgogICAgICAgICMgU2FtcGxlIDIgY2FuZGlkYXRlIHJlc3BvbnNlcyBmcm9tIHRoZSBMTE0KICAgICAgICBjYW5kaWRhdGVfcmVzcG9uc2VzID0gW10KICAgICAgICBmb3IgY2FuZGlkYXRlX2lkeCBpbiByYW5nZSgyKToKICAgICAgICAgICAgY2FuZGlkYXRlX3Jlc3BvbnNlcy5hcHBlbmQoCiAgICAgICAgICAgICAgICBQcm9tcHQoCiAgICAgICAgICAgICAgICAgICAgZiJSb3VuZCAje3IrMX06IFNhbXBsZSBDYW5kaWRhdGUgUmVzcG9uc2UgI3tjYW5kaWRhdGVfaWR4fSIsCiAgICAgICAgICAgICAgICAgICAgaW5wdXRzPXsicHJvbXB0cyI6IHByb21wdHNfZm9yX3JvdW5kLm91dHB1dFsicXVlc3Rpb24iXX0sCiAgICAgICAgICAgICAgICAgICAgYXJncz17CiAgICAgICAgICAgICAgICAgICAgICAgICJsbG0iOiBsbG0sCiAgICAgICAgICAgICAgICAgICAgICAgICJiYXRjaF9zaXplIjogMiwKICAgICAgICAgICAgICAgICAgICAgICAgInRvcF9wIjogMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAic2VlZCI6IGNhbmRpZGF0ZV9pZHgsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQoKICAgICAgICAjIEhhdmUgdGhlIExMTSBqdWRnZSBpdHMgb3duIHJlc3BvbnNlcwogICAgICAgIGp1ZGdlbWVudHMgPSBKdWRnZUdlbmVyYXRpb25QYWlyc1dpdGhQcm9tcHQoCiAgICAgICAgICAgIGYiUm91bmQgI3tyKzF9OiBKdWRnZSBDYW5kaWRhdGUgUmVzcG9uc2VzIiwKICAgICAgICAgICAgYXJncz17CiAgICAgICAgICAgICAgICAibGxtIjogbGxtLAogICAgICAgICAgICAgICAgImJhdGNoX3NpemUiOiAxLAogICAgICAgICAgICAgICAgIm1heF9uZXdfdG9rZW5zIjogNSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaW5wdXRzPXsKICAgICAgICAgICAgICAgICJwcm9tcHRzIjogcHJvbXB0c19mb3Jfcm91bmQub3V0cHV0WyJxdWVzdGlvbiJdLAogICAgICAgICAgICAgICAgImEiOiBjYW5kaWRhdGVfcmVzcG9uc2VzWzBdLm91dHB1dFsiZ2VuZXJhdGlvbnMiXSwKICAgICAgICAgICAgICAgICJiIjogY2FuZGlkYXRlX3Jlc3BvbnNlc1sxXS5vdXRwdXRbImdlbmVyYXRpb25zIl0sCiAgICAgICAgICAgIH0sCiAgICAgICAgKQoKICAgICAgICAjIFVubG9hZCB0aGUgTExNCiAgICAgICAgbGxtLnVubG9hZF9tb2RlbCgpCgogICAgICAgICMgUHJvY2VzcyB0aGUganVkZ2VtZW50cyBpbnRvIGEgcHJlZmVyZW5jZSBkYXRhc2V0CiAgICAgICAgZHBvX2RhdGFzZXQgPSBqdWRnZW1lbnRzLm1hcCgKICAgICAgICAgICAgbGFtYmRhIHJvdzogewogICAgICAgICAgICAgICAgInF1ZXN0aW9uIjogcm93WyJwcm9tcHRzIl0sCiAgICAgICAgICAgICAgICAiY2hvc2VuIjogKAogICAgICAgICAgICAgICAgICAgIHJvd1siYSJdCiAgICAgICAgICAgICAgICAgICAgaWYgcm93WyJqdWRnZW1lbnRzIl0gPT0gIlJlc3BvbnNlIEEiCiAgICAgICAgICAgICAgICAgICAgZWxzZSByb3dbImIiXQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICJyZWplY3RlZCI6ICgKICAgICAgICAgICAgICAgICAgICByb3dbImIiXQogICAgICAgICAgICAgICAgICAgIGlmIHJvd1sianVkZ2VtZW50cyJdID09ICJSZXNwb25zZSBBIgogICAgICAgICAgICAgICAgICAgIGVsc2Ugcm93WyJhIl0KICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxhenk9RmFsc2UsCiAgICAgICAgICAgIG5hbWU9ZiJSb3VuZCAje3IrMX06IENyZWF0ZSBTZWxmLVJld2FyZCBQcmVmZXJlbmNlIERhdGFzZXQiLAogICAgICAgICkKCiAgICAgICAgIyBDcmVhdGUgdHJhaW5pbmcgZGF0YSBzcGxpdHMKICAgICAgICBzcGxpdHMgPSBkcG9fZGF0YXNldC5zcGxpdHModHJhaW5fc2l6ZT0wLjkwLCB2YWxpZGF0aW9uX3NpemU9MC4xMCkKCiAgICAgICAgIyBBbGlnbiB0aGUgVGlueUxsYW1hIGNoYXQgbW9kZWwgd2l0aCBpdHMgb3duIHByZWZlcmVuY2VzCiAgICAgICAgdHJhaW5lciA9IFRyYWluSEZEUE8oCiAgICAgICAgICAgIGYiUm91bmQgI3tyKzF9OiBTZWxmLVJld2FyZCBBbGlnbiBUaW55TGxhbWEtQ2hhdCIsCiAgICAgICAgICAgIG1vZGVsX25hbWU9IlRpbnlMbGFtYS9UaW55TGxhbWEtMS4xQi1DaGF0LXYxLjAiLAogICAgICAgICAgICBwZWZ0X2NvbmZpZz1Mb3JhQ29uZmlnKCksCiAgICAgICAgICAgIGRldmljZT1bImN1ZGE6MCIsICJjdWRhOjEiXSwKICAgICAgICAgICAgZHR5cGU9ImJmbG9hdDE2IiwKICAgICAgICApCiAgICAgICAgdHJhaW5lci50cmFpbigKICAgICAgICAgICAgdHJhaW5fcHJvbXB0cz1zcGxpdHNbInRyYWluIl0ub3V0cHV0WyJxdWVzdGlvbiJdLAogICAgICAgICAgICB0cmFpbl9jaG9zZW49c3BsaXRzWyJ0cmFpbiJdLm91dHB1dFsiY2hvc2VuIl0sCiAgICAgICAgICAgIHRyYWluX3JlamVjdGVkPXNwbGl0c1sidHJhaW4iXS5vdXRwdXRbInJlamVjdGVkIl0sCiAgICAgICAgICAgIHZhbGlkYXRpb25fcHJvbXB0cz1zcGxpdHNbInZhbGlkYXRpb24iXS5vdXRwdXRbInF1ZXN0aW9uIl0sCiAgICAgICAgICAgIHZhbGlkYXRpb25fY2hvc2VuPXNwbGl0c1sidmFsaWRhdGlvbiJdLm91dHB1dFsiY2hvc2VuIl0sCiAgICAgICAgICAgIHZhbGlkYXRpb25fcmVqZWN0ZWQ9c3BsaXRzWyJ2YWxpZGF0aW9uIl0ub3V0cHV0WyJyZWplY3RlZCJdLAogICAgICAgICAgICBlcG9jaHM9MywKICAgICAgICAgICAgYmF0Y2hfc2l6ZT0xLAogICAgICAgICAgICBncmFkaWVudF9hY2N1bXVsYXRpb25fc3RlcHM9MzIsCiAgICAgICAgKQoKICAgICAgICAjIFVubG9hZCB0aGUgdHJhaW5lZCBtb2RlbCBmcm9tIG1lbW9yeQogICAgICAgIHRyYWluZXIudW5sb2FkX21vZGVsKCkKCiAgICAgICAgIyBVc2UgdGhlIG5ld2x5IHRyYWluZWQgYWRhcHRlciBmb3IgdGhlIG5leHQgcm91bmQgb2Ygc2VsZi1yZXdhcmQKICAgICAgICBhZGFwdGVyX3RvX2FwcGx5ID0gdHJhaW5lci5tb2RlbF9wYXRo" download="resources/examples/selfrewarding.py">⬇</a></div>
<div id="lstnumberx154" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx154.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx154.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx154.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx154.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx154.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx154.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx154.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span>
</div>
<div id="lstnumberx155" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx155.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx155.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx155.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx155.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx155.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">steps</span><span id="lstnumberx155.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx155.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx155.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx155.9" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx156" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx156.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx156.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span><span id="lstnumberx156.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx157" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span id="lstnumberx157.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx157.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">Prompt</span><span id="lstnumberx157.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx158" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span><span id="lstnumberx158.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx158.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">JudgeGenerationPairsWithPrompt</span><span id="lstnumberx158.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx159" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span><span id="lstnumberx159.1" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx160" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span id="lstnumberx160.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx160.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx160.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx160.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx160.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainers</span><span id="lstnumberx160.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx160.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx160.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx160.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFDPO</span>
</div>
<div id="lstnumberx161" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span><span id="lstnumberx161.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx161.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx161.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx161.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx161.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">llms</span><span id="lstnumberx161.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx161.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx161.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx161.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFTransformers</span>
</div>
<div id="lstnumberx162" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span><span id="lstnumberx162.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx162.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx162.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft</span><span id="lstnumberx162.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx162.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx162.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx162.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span>
</div>
<div id="lstnumberx163" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>
</div>
<div id="lstnumberx164" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span><span id="lstnumberx164.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">with</span><span id="lstnumberx164.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx164.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span><span id="lstnumberx164.4" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx164.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"./output"</span><span id="lstnumberx164.6" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx165" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span><span id="lstnumberx165.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx165.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx165.2.1" class="ltx_text ltx_lst_space"> </span>Get<span id="lstnumberx165.2.2" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx165.2.3" class="ltx_text ltx_lst_space"> </span>dataset<span id="lstnumberx165.2.4" class="ltx_text ltx_lst_space"> </span>of<span id="lstnumberx165.2.5" class="ltx_text ltx_lst_space"> </span>prompts</span>
</div>
<div id="lstnumberx166" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span><span id="lstnumberx166.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx166.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">prompts_dataset</span><span id="lstnumberx166.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx166.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx166.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx166.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span><span id="lstnumberx166.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx167" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span><span id="lstnumberx167.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx167.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Get<span id="lstnumberx167.2.1" class="ltx_text ltx_lst_space"> </span>Prompts<span id="lstnumberx167.2.2" class="ltx_text ltx_lst_space"> </span>Dataset"</span><span id="lstnumberx167.3" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx167.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx167.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Intel/orca_dpo_pairs"</span><span id="lstnumberx167.6" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx167.7" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx167.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">split</span><span id="lstnumberx167.9" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx167.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span>
</div>
<div id="lstnumberx168" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span><span id="lstnumberx168.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx168.2" class="ltx_text ltx_font_typewriter">).</span><span id="lstnumberx168.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">select_columns</span><span id="lstnumberx168.4" class="ltx_text ltx_font_typewriter">([</span><span id="lstnumberx168.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx168.6" class="ltx_text ltx_font_typewriter">])</span>
</div>
<div id="lstnumberx169" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>
</div>
<div id="lstnumberx170" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span><span id="lstnumberx170.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx170.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx170.2.1" class="ltx_text ltx_lst_space"> </span>Keep<span id="lstnumberx170.2.2" class="ltx_text ltx_lst_space"> </span>only<span id="lstnumberx170.2.3" class="ltx_text ltx_lst_space"> </span>3000<span id="lstnumberx170.2.4" class="ltx_text ltx_lst_space"> </span>examples<span id="lstnumberx170.2.5" class="ltx_text ltx_lst_space"> </span>as<span id="lstnumberx170.2.6" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx170.2.7" class="ltx_text ltx_lst_space"> </span>quick<span id="lstnumberx170.2.8" class="ltx_text ltx_lst_space"> </span>demo</span>
</div>
<div id="lstnumberx171" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span><span id="lstnumberx171.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx171.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">prompts_dataset</span><span id="lstnumberx171.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx171.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx171.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx171.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">prompts_dataset</span><span id="lstnumberx171.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx171.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">take</span><span id="lstnumberx171.9" class="ltx_text ltx_font_typewriter">(3000)</span>
</div>
<div id="lstnumberx172" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>
</div>
<div id="lstnumberx173" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span><span id="lstnumberx173.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx173.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx173.2.1" class="ltx_text ltx_lst_space"> </span>Define<span id="lstnumberx173.2.2" class="ltx_text ltx_lst_space"> </span>how<span id="lstnumberx173.2.3" class="ltx_text ltx_lst_space"> </span>many<span id="lstnumberx173.2.4" class="ltx_text ltx_lst_space"> </span>rounds<span id="lstnumberx173.2.5" class="ltx_text ltx_lst_space"> </span>of<span id="lstnumberx173.2.6" class="ltx_text ltx_lst_space"> </span>self-reward<span id="lstnumberx173.2.7" class="ltx_text ltx_lst_space"> </span>training</span>
</div>
<div id="lstnumberx174" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span><span id="lstnumberx174.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx174.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">rounds</span><span id="lstnumberx174.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx174.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx174.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx174.6" class="ltx_text ltx_font_typewriter">3</span>
</div>
<div id="lstnumberx175" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>
</div>
<div id="lstnumberx176" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span><span id="lstnumberx176.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx176.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx176.2.1" class="ltx_text ltx_lst_space"> </span>For<span id="lstnumberx176.2.2" class="ltx_text ltx_lst_space"> </span>each<span id="lstnumberx176.2.3" class="ltx_text ltx_lst_space"> </span>round<span id="lstnumberx176.2.4" class="ltx_text ltx_lst_space"> </span>of<span id="lstnumberx176.2.5" class="ltx_text ltx_lst_space"> </span>self-reward<span id="lstnumberx176.2.6" class="ltx_text ltx_lst_space"> </span>training</span>
</div>
<div id="lstnumberx177" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span><span id="lstnumberx177.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx177.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">adapter_to_apply</span><span id="lstnumberx177.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx177.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx177.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx177.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">None</span>
</div>
<div id="lstnumberx178" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span><span id="lstnumberx178.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx178.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">for</span><span id="lstnumberx178.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx178.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">r</span><span id="lstnumberx178.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx178.6" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">in</span><span id="lstnumberx178.7" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx178.8" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" style="color:#0000FF;">range</span><span id="lstnumberx178.9" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx178.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter">rounds</span><span id="lstnumberx178.11" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx179" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span><span id="lstnumberx179.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx179.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx179.2.1" class="ltx_text ltx_lst_space"> </span>Use<span id="lstnumberx179.2.2" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx179.2.3" class="ltx_text ltx_lst_space"> </span>partial<span id="lstnumberx179.2.4" class="ltx_text ltx_lst_space"> </span>set<span id="lstnumberx179.2.5" class="ltx_text ltx_lst_space"> </span>of<span id="lstnumberx179.2.6" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx179.2.7" class="ltx_text ltx_lst_space"> </span>prompts<span id="lstnumberx179.2.8" class="ltx_text ltx_lst_space"> </span>for<span id="lstnumberx179.2.9" class="ltx_text ltx_lst_space"> </span>each<span id="lstnumberx179.2.10" class="ltx_text ltx_lst_space"> </span>round</span>
</div>
<div id="lstnumberx180" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span><span id="lstnumberx180.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx180.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">prompts_for_round</span><span id="lstnumberx180.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx180.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx180.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx180.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">prompts_dataset</span><span id="lstnumberx180.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx180.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">shard</span><span id="lstnumberx180.9" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx181" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span><span id="lstnumberx181.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx181.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">num_shards</span><span id="lstnumberx181.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx181.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">rounds</span><span id="lstnumberx181.5" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx181.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx181.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">index</span><span id="lstnumberx181.8" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx181.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">r</span><span id="lstnumberx181.10" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx181.11" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx181.12" class="ltx_text ltx_lst_identifier ltx_font_typewriter">name</span><span id="lstnumberx181.13" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx181.14" class="ltx_text ltx_lst_identifier ltx_font_typewriter">f</span><span id="lstnumberx181.15" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Round<span id="lstnumberx181.15.1" class="ltx_text ltx_lst_space"> </span>#{r+1}:<span id="lstnumberx181.15.2" class="ltx_text ltx_lst_space"> </span>Get<span id="lstnumberx181.15.3" class="ltx_text ltx_lst_space"> </span>Prompts"</span>
</div>
<div id="lstnumberx182" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span><span id="lstnumberx182.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx182.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx183" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span>
</div>
<div id="lstnumberx184" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span><span id="lstnumberx184.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx184.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx184.2.1" class="ltx_text ltx_lst_space"> </span>Load<span id="lstnumberx184.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx184.2.3" class="ltx_text ltx_lst_space"> </span>LLM</span>
</div>
<div id="lstnumberx185" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span><span id="lstnumberx185.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx185.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">llm</span><span id="lstnumberx185.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx185.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx185.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx185.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFTransformers</span><span id="lstnumberx185.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx186" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span><span id="lstnumberx186.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx186.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"TinyLlama/TinyLlama-1.1B-Chat-v1.0"</span><span id="lstnumberx186.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx187" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span><span id="lstnumberx187.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx187.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">adapter_name</span><span id="lstnumberx187.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx187.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">adapter_to_apply</span><span id="lstnumberx187.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx188" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span><span id="lstnumberx188.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx188.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">device_map</span><span id="lstnumberx188.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx188.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"auto"</span><span id="lstnumberx188.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx189" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span><span id="lstnumberx189.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx189.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dtype</span><span id="lstnumberx189.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx189.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"bfloat16"</span><span id="lstnumberx189.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx190" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">37</span><span id="lstnumberx190.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx190.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx191" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">38</span>
</div>
<div id="lstnumberx192" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">39</span><span id="lstnumberx192.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx192.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx192.2.1" class="ltx_text ltx_lst_space"> </span>Sample<span id="lstnumberx192.2.2" class="ltx_text ltx_lst_space"> </span>2<span id="lstnumberx192.2.3" class="ltx_text ltx_lst_space"> </span>candidate<span id="lstnumberx192.2.4" class="ltx_text ltx_lst_space"> </span>responses<span id="lstnumberx192.2.5" class="ltx_text ltx_lst_space"> </span>from<span id="lstnumberx192.2.6" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx192.2.7" class="ltx_text ltx_lst_space"> </span>LLM</span>
</div>
<div id="lstnumberx193" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">40</span><span id="lstnumberx193.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx193.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">candidate_responses</span><span id="lstnumberx193.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx193.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx193.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx193.6" class="ltx_text ltx_font_typewriter">[]</span>
</div>
<div id="lstnumberx194" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">41</span><span id="lstnumberx194.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx194.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">for</span><span id="lstnumberx194.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx194.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">candidate_idx</span><span id="lstnumberx194.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx194.6" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">in</span><span id="lstnumberx194.7" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx194.8" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" style="color:#0000FF;">range</span><span id="lstnumberx194.9" class="ltx_text ltx_font_typewriter">(2):</span>
</div>
<div id="lstnumberx195" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">42</span><span id="lstnumberx195.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx195.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">candidate_responses</span><span id="lstnumberx195.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx195.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">append</span><span id="lstnumberx195.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx196" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">43</span><span id="lstnumberx196.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx196.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">Prompt</span><span id="lstnumberx196.3" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx197" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">44</span><span id="lstnumberx197.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx197.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">f</span><span id="lstnumberx197.3" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Round<span id="lstnumberx197.3.1" class="ltx_text ltx_lst_space"> </span>#{r+1}:<span id="lstnumberx197.3.2" class="ltx_text ltx_lst_space"> </span>Sample<span id="lstnumberx197.3.3" class="ltx_text ltx_lst_space"> </span>Candidate<span id="lstnumberx197.3.4" class="ltx_text ltx_lst_space"> </span>Response<span id="lstnumberx197.3.5" class="ltx_text ltx_lst_space"> </span>#{candidate_idx}"</span><span id="lstnumberx197.4" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx198" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">45</span><span id="lstnumberx198.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx198.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">inputs</span><span id="lstnumberx198.3" class="ltx_text ltx_font_typewriter">={</span><span id="lstnumberx198.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"prompts"</span><span id="lstnumberx198.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx198.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx198.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">prompts_for_round</span><span id="lstnumberx198.8" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx198.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx198.10" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx198.11" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx198.12" class="ltx_text ltx_font_typewriter">]},</span>
</div>
<div id="lstnumberx199" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">46</span><span id="lstnumberx199.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx199.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">args</span><span id="lstnumberx199.3" class="ltx_text ltx_font_typewriter">={</span>
</div>
<div id="lstnumberx200" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">47</span><span id="lstnumberx200.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                        </span><span id="lstnumberx200.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"llm"</span><span id="lstnumberx200.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx200.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx200.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">llm</span><span id="lstnumberx200.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx201" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">48</span><span id="lstnumberx201.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                        </span><span id="lstnumberx201.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"batch_size"</span><span id="lstnumberx201.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx201.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx201.5" class="ltx_text ltx_font_typewriter">2,</span>
</div>
<div id="lstnumberx202" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">49</span><span id="lstnumberx202.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                        </span><span id="lstnumberx202.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"top_p"</span><span id="lstnumberx202.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx202.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx202.5" class="ltx_text ltx_font_typewriter">1.0,</span>
</div>
<div id="lstnumberx203" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">50</span><span id="lstnumberx203.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                        </span><span id="lstnumberx203.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"seed"</span><span id="lstnumberx203.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx203.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx203.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">candidate_idx</span><span id="lstnumberx203.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx204" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">51</span><span id="lstnumberx204.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx204.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx205" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">52</span><span id="lstnumberx205.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx205.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx206" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">53</span><span id="lstnumberx206.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx206.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx207" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">54</span>
</div>
<div id="lstnumberx208" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">55</span><span id="lstnumberx208.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx208.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx208.2.1" class="ltx_text ltx_lst_space"> </span>Have<span id="lstnumberx208.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx208.2.3" class="ltx_text ltx_lst_space"> </span>LLM<span id="lstnumberx208.2.4" class="ltx_text ltx_lst_space"> </span>judge<span id="lstnumberx208.2.5" class="ltx_text ltx_lst_space"> </span>its<span id="lstnumberx208.2.6" class="ltx_text ltx_lst_space"> </span>own<span id="lstnumberx208.2.7" class="ltx_text ltx_lst_space"> </span>responses</span>
</div>
<div id="lstnumberx209" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">56</span><span id="lstnumberx209.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx209.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">judgements</span><span id="lstnumberx209.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx209.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx209.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx209.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">JudgeGenerationPairsWithPrompt</span><span id="lstnumberx209.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx210" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">57</span><span id="lstnumberx210.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx210.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">f</span><span id="lstnumberx210.3" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Round<span id="lstnumberx210.3.1" class="ltx_text ltx_lst_space"> </span>#{r+1}:<span id="lstnumberx210.3.2" class="ltx_text ltx_lst_space"> </span>Judge<span id="lstnumberx210.3.3" class="ltx_text ltx_lst_space"> </span>Candidate<span id="lstnumberx210.3.4" class="ltx_text ltx_lst_space"> </span>Responses"</span><span id="lstnumberx210.4" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx211" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">58</span><span id="lstnumberx211.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx211.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">args</span><span id="lstnumberx211.3" class="ltx_text ltx_font_typewriter">={</span>
</div>
<div id="lstnumberx212" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">59</span><span id="lstnumberx212.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx212.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"llm"</span><span id="lstnumberx212.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx212.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx212.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">llm</span><span id="lstnumberx212.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx213" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">60</span><span id="lstnumberx213.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx213.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"batch_size"</span><span id="lstnumberx213.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx213.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx213.5" class="ltx_text ltx_font_typewriter">1,</span>
</div>
<div id="lstnumberx214" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">61</span><span id="lstnumberx214.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx214.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"max_new_tokens"</span><span id="lstnumberx214.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx214.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx214.5" class="ltx_text ltx_font_typewriter">5,</span>
</div>
<div id="lstnumberx215" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">62</span><span id="lstnumberx215.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx215.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx216" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">63</span><span id="lstnumberx216.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx216.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">inputs</span><span id="lstnumberx216.3" class="ltx_text ltx_font_typewriter">={</span>
</div>
<div id="lstnumberx217" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">64</span><span id="lstnumberx217.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx217.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"prompts"</span><span id="lstnumberx217.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx217.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx217.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">prompts_for_round</span><span id="lstnumberx217.6" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx217.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx217.8" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx217.9" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx217.10" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx218" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">65</span><span id="lstnumberx218.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx218.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"a"</span><span id="lstnumberx218.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx218.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx218.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">candidate_responses</span><span id="lstnumberx218.6" class="ltx_text ltx_font_typewriter">[0].</span><span id="lstnumberx218.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx218.8" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx218.9" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"generations"</span><span id="lstnumberx218.10" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx219" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">66</span><span id="lstnumberx219.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx219.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"b"</span><span id="lstnumberx219.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx219.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx219.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">candidate_responses</span><span id="lstnumberx219.6" class="ltx_text ltx_font_typewriter">[1].</span><span id="lstnumberx219.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx219.8" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx219.9" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"generations"</span><span id="lstnumberx219.10" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx220" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">67</span><span id="lstnumberx220.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx220.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx221" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">68</span><span id="lstnumberx221.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx221.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx222" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">69</span>
</div>
<div id="lstnumberx223" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">70</span><span id="lstnumberx223.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx223.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx223.2.1" class="ltx_text ltx_lst_space"> </span>Unload<span id="lstnumberx223.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx223.2.3" class="ltx_text ltx_lst_space"> </span>LLM</span>
</div>
<div id="lstnumberx224" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">71</span><span id="lstnumberx224.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx224.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">llm</span><span id="lstnumberx224.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx224.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">unload_model</span><span id="lstnumberx224.5" class="ltx_text ltx_font_typewriter">()</span>
</div>
<div id="lstnumberx225" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">72</span>
</div>
<div id="lstnumberx226" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">73</span><span id="lstnumberx226.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx226.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx226.2.1" class="ltx_text ltx_lst_space"> </span>Process<span id="lstnumberx226.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx226.2.3" class="ltx_text ltx_lst_space"> </span>judgements<span id="lstnumberx226.2.4" class="ltx_text ltx_lst_space"> </span>into<span id="lstnumberx226.2.5" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx226.2.6" class="ltx_text ltx_lst_space"> </span>preference<span id="lstnumberx226.2.7" class="ltx_text ltx_lst_space"> </span>dataset</span>
</div>
<div id="lstnumberx227" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">74</span><span id="lstnumberx227.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx227.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dpo_dataset</span><span id="lstnumberx227.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx227.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx227.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx227.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">judgements</span><span id="lstnumberx227.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx227.8" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" style="color:#0000FF;">map</span><span id="lstnumberx227.9" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx228" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">75</span><span id="lstnumberx228.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx228.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">lambda</span><span id="lstnumberx228.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx228.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx228.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx228.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx228.7" class="ltx_text ltx_font_typewriter">{</span>
</div>
<div id="lstnumberx229" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">76</span><span id="lstnumberx229.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx229.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx229.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx229.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx229.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx229.6" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx229.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"prompts"</span><span id="lstnumberx229.8" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx230" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">77</span><span id="lstnumberx230.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx230.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"chosen"</span><span id="lstnumberx230.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx230.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx230.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx231" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">78</span><span id="lstnumberx231.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx231.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx231.3" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx231.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"a"</span><span id="lstnumberx231.5" class="ltx_text ltx_font_typewriter">]</span>
</div>
<div id="lstnumberx232" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">79</span><span id="lstnumberx232.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx232.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">if</span><span id="lstnumberx232.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx232.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx232.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx232.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"judgements"</span><span id="lstnumberx232.7" class="ltx_text ltx_font_typewriter">]</span><span id="lstnumberx232.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx232.9" class="ltx_text ltx_font_typewriter">==</span><span id="lstnumberx232.10" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx232.11" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Response<span id="lstnumberx232.11.1" class="ltx_text ltx_lst_space"> </span>A"</span>
</div>
<div id="lstnumberx233" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">80</span><span id="lstnumberx233.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx233.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">else</span><span id="lstnumberx233.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx233.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx233.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx233.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"b"</span><span id="lstnumberx233.7" class="ltx_text ltx_font_typewriter">]</span>
</div>
<div id="lstnumberx234" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">81</span><span id="lstnumberx234.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx234.2" class="ltx_text ltx_font_typewriter">),</span>
</div>
<div id="lstnumberx235" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">82</span><span id="lstnumberx235.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx235.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"rejected"</span><span id="lstnumberx235.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx235.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx235.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx236" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">83</span><span id="lstnumberx236.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx236.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx236.3" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx236.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"b"</span><span id="lstnumberx236.5" class="ltx_text ltx_font_typewriter">]</span>
</div>
<div id="lstnumberx237" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">84</span><span id="lstnumberx237.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx237.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">if</span><span id="lstnumberx237.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx237.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx237.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx237.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"judgements"</span><span id="lstnumberx237.7" class="ltx_text ltx_font_typewriter">]</span><span id="lstnumberx237.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx237.9" class="ltx_text ltx_font_typewriter">==</span><span id="lstnumberx237.10" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx237.11" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Response<span id="lstnumberx237.11.1" class="ltx_text ltx_lst_space"> </span>A"</span>
</div>
<div id="lstnumberx238" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">85</span><span id="lstnumberx238.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                    </span><span id="lstnumberx238.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">else</span><span id="lstnumberx238.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx238.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">row</span><span id="lstnumberx238.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx238.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"a"</span><span id="lstnumberx238.7" class="ltx_text ltx_font_typewriter">]</span>
</div>
<div id="lstnumberx239" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">86</span><span id="lstnumberx239.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx239.2" class="ltx_text ltx_font_typewriter">),</span>
</div>
<div id="lstnumberx240" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">87</span><span id="lstnumberx240.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx240.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx241" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">88</span><span id="lstnumberx241.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx241.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">lazy</span><span id="lstnumberx241.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx241.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">False</span><span id="lstnumberx241.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx242" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">89</span><span id="lstnumberx242.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx242.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">name</span><span id="lstnumberx242.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx242.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">f</span><span id="lstnumberx242.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Round<span id="lstnumberx242.5.1" class="ltx_text ltx_lst_space"> </span>#{r+1}:<span id="lstnumberx242.5.2" class="ltx_text ltx_lst_space"> </span>Create<span id="lstnumberx242.5.3" class="ltx_text ltx_lst_space"> </span>Self-Reward<span id="lstnumberx242.5.4" class="ltx_text ltx_lst_space"> </span>Preference<span id="lstnumberx242.5.5" class="ltx_text ltx_lst_space"> </span>Dataset"</span><span id="lstnumberx242.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx243" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">90</span><span id="lstnumberx243.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx243.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx244" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">91</span>
</div>
<div id="lstnumberx245" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">92</span><span id="lstnumberx245.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx245.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx245.2.1" class="ltx_text ltx_lst_space"> </span>Create<span id="lstnumberx245.2.2" class="ltx_text ltx_lst_space"> </span>training<span id="lstnumberx245.2.3" class="ltx_text ltx_lst_space"> </span>data<span id="lstnumberx245.2.4" class="ltx_text ltx_lst_space"> </span>splits</span>
</div>
<div id="lstnumberx246" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">93</span><span id="lstnumberx246.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx246.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx246.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx246.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx246.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx246.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dpo_dataset</span><span id="lstnumberx246.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx246.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx246.9" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx246.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_size</span><span id="lstnumberx246.11" class="ltx_text ltx_font_typewriter">=0.90,</span><span id="lstnumberx246.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx246.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_size</span><span id="lstnumberx246.14" class="ltx_text ltx_font_typewriter">=0.10)</span>
</div>
<div id="lstnumberx247" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">94</span>
</div>
<div id="lstnumberx248" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">95</span><span id="lstnumberx248.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx248.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx248.2.1" class="ltx_text ltx_lst_space"> </span>Align<span id="lstnumberx248.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx248.2.3" class="ltx_text ltx_lst_space"> </span>TinyLlama<span id="lstnumberx248.2.4" class="ltx_text ltx_lst_space"> </span>chat<span id="lstnumberx248.2.5" class="ltx_text ltx_lst_space"> </span>model<span id="lstnumberx248.2.6" class="ltx_text ltx_lst_space"> </span>with<span id="lstnumberx248.2.7" class="ltx_text ltx_lst_space"> </span>its<span id="lstnumberx248.2.8" class="ltx_text ltx_lst_space"> </span>own<span id="lstnumberx248.2.9" class="ltx_text ltx_lst_space"> </span>preferences</span>
</div>
<div id="lstnumberx249" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">96</span><span id="lstnumberx249.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx249.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx249.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx249.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx249.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx249.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">TrainHFDPO</span><span id="lstnumberx249.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx250" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">97</span><span id="lstnumberx250.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx250.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">f</span><span id="lstnumberx250.3" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Round<span id="lstnumberx250.3.1" class="ltx_text ltx_lst_space"> </span>#{r+1}:<span id="lstnumberx250.3.2" class="ltx_text ltx_lst_space"> </span>Self-Reward<span id="lstnumberx250.3.3" class="ltx_text ltx_lst_space"> </span>Align<span id="lstnumberx250.3.4" class="ltx_text ltx_lst_space"> </span>TinyLlama-Chat"</span><span id="lstnumberx250.4" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx251" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">98</span><span id="lstnumberx251.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx251.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">model_name</span><span id="lstnumberx251.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx251.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"TinyLlama/TinyLlama-1.1B-Chat-v1.0"</span><span id="lstnumberx251.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx252" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">99</span><span id="lstnumberx252.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx252.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">peft_config</span><span id="lstnumberx252.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx252.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">LoraConfig</span><span id="lstnumberx252.5" class="ltx_text ltx_font_typewriter">(),</span>
</div>
<div id="lstnumberx253" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">100</span><span id="lstnumberx253.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx253.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">device</span><span id="lstnumberx253.3" class="ltx_text ltx_font_typewriter">=[</span><span id="lstnumberx253.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"cuda:0"</span><span id="lstnumberx253.5" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx253.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx253.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"cuda:1"</span><span id="lstnumberx253.8" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx254" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">101</span><span id="lstnumberx254.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx254.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">dtype</span><span id="lstnumberx254.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx254.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"bfloat16"</span><span id="lstnumberx254.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx255" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">102</span><span id="lstnumberx255.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx255.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx256" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">103</span><span id="lstnumberx256.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx256.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx256.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx256.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train</span><span id="lstnumberx256.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx257" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">104</span><span id="lstnumberx257.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx257.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_prompts</span><span id="lstnumberx257.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx257.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx257.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx257.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx257.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx257.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx257.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx257.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx257.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx258" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">105</span><span id="lstnumberx258.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx258.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_chosen</span><span id="lstnumberx258.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx258.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx258.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx258.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx258.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx258.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx258.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx258.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"chosen"</span><span id="lstnumberx258.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx259" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">106</span><span id="lstnumberx259.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx259.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">train_rejected</span><span id="lstnumberx259.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx259.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx259.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx259.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx259.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx259.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx259.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx259.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"rejected"</span><span id="lstnumberx259.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx260" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">107</span><span id="lstnumberx260.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx260.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_prompts</span><span id="lstnumberx260.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx260.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx260.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx260.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx260.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx260.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx260.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx260.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx260.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx261" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">108</span><span id="lstnumberx261.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx261.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_chosen</span><span id="lstnumberx261.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx261.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx261.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx261.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx261.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx261.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx261.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx261.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"chosen"</span><span id="lstnumberx261.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx262" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">109</span><span id="lstnumberx262.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx262.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">validation_rejected</span><span id="lstnumberx262.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx262.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">splits</span><span id="lstnumberx262.5" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx262.6" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"validation"</span><span id="lstnumberx262.7" class="ltx_text ltx_font_typewriter">].</span><span id="lstnumberx262.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx262.9" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx262.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"rejected"</span><span id="lstnumberx262.11" class="ltx_text ltx_font_typewriter">],</span>
</div>
<div id="lstnumberx263" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">110</span><span id="lstnumberx263.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx263.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">epochs</span><span id="lstnumberx263.3" class="ltx_text ltx_font_typewriter">=3,</span>
</div>
<div id="lstnumberx264" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">111</span><span id="lstnumberx264.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx264.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">batch_size</span><span id="lstnumberx264.3" class="ltx_text ltx_font_typewriter">=1,</span>
</div>
<div id="lstnumberx265" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">112</span><span id="lstnumberx265.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx265.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gradient_accumulation_steps</span><span id="lstnumberx265.3" class="ltx_text ltx_font_typewriter">=32,</span>
</div>
<div id="lstnumberx266" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">113</span><span id="lstnumberx266.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx266.2" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx267" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">114</span>
</div>
<div id="lstnumberx268" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">115</span><span id="lstnumberx268.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx268.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx268.2.1" class="ltx_text ltx_lst_space"> </span>Unload<span id="lstnumberx268.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx268.2.3" class="ltx_text ltx_lst_space"> </span>trained<span id="lstnumberx268.2.4" class="ltx_text ltx_lst_space"> </span>model<span id="lstnumberx268.2.5" class="ltx_text ltx_lst_space"> </span>from<span id="lstnumberx268.2.6" class="ltx_text ltx_lst_space"> </span>memory</span>
</div>
<div id="lstnumberx269" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">116</span><span id="lstnumberx269.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx269.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx269.3" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx269.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">unload_model</span><span id="lstnumberx269.5" class="ltx_text ltx_font_typewriter">()</span>
</div>
<div id="lstnumberx270" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">117</span>
</div>
<div id="lstnumberx271" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">118</span><span id="lstnumberx271.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx271.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx271.2.1" class="ltx_text ltx_lst_space"> </span>Use<span id="lstnumberx271.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx271.2.3" class="ltx_text ltx_lst_space"> </span>newly<span id="lstnumberx271.2.4" class="ltx_text ltx_lst_space"> </span>trained<span id="lstnumberx271.2.5" class="ltx_text ltx_lst_space"> </span>adapter<span id="lstnumberx271.2.6" class="ltx_text ltx_lst_space"> </span>for<span id="lstnumberx271.2.7" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx271.2.8" class="ltx_text ltx_lst_space"> </span>next<span id="lstnumberx271.2.9" class="ltx_text ltx_lst_space"> </span>round<span id="lstnumberx271.2.10" class="ltx_text ltx_lst_space"> </span>of<span id="lstnumberx271.2.11" class="ltx_text ltx_lst_space"> </span>self-reward</span>
</div>
<div id="lstnumberx272" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">119</span><span id="lstnumberx272.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx272.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">adapter_to_apply</span><span id="lstnumberx272.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx272.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx272.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx272.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">trainer</span><span id="lstnumberx272.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx272.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">model_path</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#FAFAFA;"><span class="ltx_tag ltx_tag_float">Example 4: </span>This demonstration snippet implements a simplified version of the self-rewarding LLMs <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a href="#bib.bib48" title="" class="ltx_ref">2024</a>)</cite> procedure. This workflow involves using an LLM to judge its own generations in order to self-align and self-improve itself over a number of rounds. DataDreamer allows this complex multi-stage workflow to be implemented intuitively, without needing to split generation and training logic into separate files and without needing to involve a launcher like <span id="LST4.9.1" class="ltx_text ltx_font_typewriter">torchrun</span> to perform multi-GPU training. DataDreamer also makes this complex multi-round, multi-stage workflow automatically cachable and resumable.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Augmenting an Existing Dataset</h2>

<figure id="LST5" class="ltx_float ltx_lstlisting">
<div id="LST5.1" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSBkYXRhZHJlYW1lciBpbXBvcnQgRGF0YURyZWFtZXIKZnJvbSBkYXRhZHJlYW1lci5sbG1zIGltcG9ydCBPcGVuQUkKZnJvbSBkYXRhZHJlYW1lci5zdGVwcyBpbXBvcnQgUHJvY2Vzc1dpdGhQcm9tcHQsIEhGSHViRGF0YVNvdXJjZQoKd2l0aCBEYXRhRHJlYW1lcigiLi9vdXRwdXQiKToKICAgICMgTG9hZCBHUFQtNAogICAgZ3B0XzQgPSBPcGVuQUkobW9kZWxfbmFtZT0iZ3B0LTQiKQoKICAgICMgR2V0IEhvdFBvdCBRQSBxdWVzdGlvbnMKICAgIGhvdHBvdF9xYV9kYXRhc2V0ID0gSEZIdWJEYXRhU291cmNlKAogICAgICAgICJHZXQgSG90cG90IFFBIFF1ZXN0aW9ucyIsCiAgICAgICAgImhvdHBvdF9xYSIsCiAgICAgICAgY29uZmlnX25hbWU9ImRpc3RyYWN0b3IiLAogICAgICAgIHNwbGl0PSJ0cmFpbiIsCiAgICApLnNlbGVjdF9jb2x1bW5zKFsicXVlc3Rpb24iXSkKCiAgICAjIEtlZXAgb25seSAxMDAwIHF1ZXN0aW9ucyBhcyBhIHF1aWNrIGRlbW8KICAgIGhvdHBvdF9xYV9kYXRhc2V0ID0gaG90cG90X3FhX2RhdGFzZXQudGFrZSgxMDAwKQoKICAgICMgQXNrIEdQVC00IHRvIGRlY29tcG9zZSB0aGUgcXVlc3Rpb24KICAgIHF1ZXN0aW9uc19hbmRfZGVjb21wb3NpdGlvbnMgPSBQcm9jZXNzV2l0aFByb21wdCgKICAgICAgICAiR2VuZXJhdGUgRGVjb21wb3NpdGlvbnMiLAogICAgICAgIGlucHV0cz17ImlucHV0cyI6IGhvdHBvdF9xYV9kYXRhc2V0Lm91dHB1dFsicXVlc3Rpb24iXX0sCiAgICAgICAgYXJncz17CiAgICAgICAgICAgICJsbG0iOiBncHRfNCwKICAgICAgICAgICAgImluc3RydWN0aW9uIjogKAogICAgICAgICAgICAgICAgIkdpdmVuIHRoZSBxdWVzdGlvbiB3aGljaCByZXF1aXJlcyBtdWx0aXBsZSBzdGVwcyB0byBzb2x2ZSwiCiAgICAgICAgICAgICAgICAiIGdpdmUgYSBudW1iZXJlZCBsaXN0IG9mIGludGVybWVkaWF0ZSBxdWVzdGlvbnMgcmVxdWlyZWQgdG8iCiAgICAgICAgICAgICAgICAiIHNvbHZlIHRoZSBxdWVzdGlvbi4gUmV0dXJuIG9ubHkgdGhlIGxpc3QsIG5vdGhpbmcgZWxzZS4iCiAgICAgICAgICAgICksCiAgICAgICAgfSwKICAgICAgICBvdXRwdXRzPXsiaW5wdXRzIjogInF1ZXN0aW9ucyIsICJnZW5lcmF0aW9ucyI6ICJkZWNvbXBvc2l0aW9ucyJ9LAogICAgKS5zZWxlY3RfY29sdW1ucyhbInF1ZXN0aW9ucyIsICJkZWNvbXBvc2l0aW9ucyJdKQ==" download="resources/examples/augment.py">⬇</a></div>
<div id="lstnumberx273" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx273.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx273.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx273.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx273.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx273.5" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx273.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx273.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span>
</div>
<div id="lstnumberx274" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx274.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx274.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx274.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx274.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx274.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">llms</span><span id="lstnumberx274.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx274.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx274.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx274.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">OpenAI</span>
</div>
<div id="lstnumberx275" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx275.1" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">from</span><span id="lstnumberx275.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx275.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">datadreamer</span><span id="lstnumberx275.4" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx275.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">steps</span><span id="lstnumberx275.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx275.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter" style="color:#0000FF;">import</span><span id="lstnumberx275.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx275.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">ProcessWithPrompt</span><span id="lstnumberx275.10" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx275.11" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx275.12" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span>
</div>
<div id="lstnumberx276" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>
</div>
<div id="lstnumberx277" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span><span id="lstnumberx277.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter">with</span><span id="lstnumberx277.2" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx277.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">DataDreamer</span><span id="lstnumberx277.4" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx277.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"./output"</span><span id="lstnumberx277.6" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx278" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span><span id="lstnumberx278.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx278.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx278.2.1" class="ltx_text ltx_lst_space"> </span>Load<span id="lstnumberx278.2.2" class="ltx_text ltx_lst_space"> </span>GPT-4</span>
</div>
<div id="lstnumberx279" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span id="lstnumberx279.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx279.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gpt_4</span><span id="lstnumberx279.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx279.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx279.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx279.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">OpenAI</span><span id="lstnumberx279.7" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx279.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">model_name</span><span id="lstnumberx279.9" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx279.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"gpt-4"</span><span id="lstnumberx279.11" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx280" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>
</div>
<div id="lstnumberx281" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span><span id="lstnumberx281.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx281.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx281.2.1" class="ltx_text ltx_lst_space"> </span>Get<span id="lstnumberx281.2.2" class="ltx_text ltx_lst_space"> </span>HotPot<span id="lstnumberx281.2.3" class="ltx_text ltx_lst_space"> </span>QA<span id="lstnumberx281.2.4" class="ltx_text ltx_lst_space"> </span>questions</span>
</div>
<div id="lstnumberx282" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span><span id="lstnumberx282.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx282.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">hotpot_qa_dataset</span><span id="lstnumberx282.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx282.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx282.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx282.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">HFHubDataSource</span><span id="lstnumberx282.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx283" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span><span id="lstnumberx283.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx283.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Get<span id="lstnumberx283.2.1" class="ltx_text ltx_lst_space"> </span>Hotpot<span id="lstnumberx283.2.2" class="ltx_text ltx_lst_space"> </span>QA<span id="lstnumberx283.2.3" class="ltx_text ltx_lst_space"> </span>Questions"</span><span id="lstnumberx283.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx284" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span><span id="lstnumberx284.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx284.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"hotpot_qa"</span><span id="lstnumberx284.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx285" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span><span id="lstnumberx285.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx285.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">config_name</span><span id="lstnumberx285.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx285.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"distractor"</span><span id="lstnumberx285.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx286" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span><span id="lstnumberx286.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx286.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">split</span><span id="lstnumberx286.3" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx286.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"train"</span><span id="lstnumberx286.5" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx287" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span><span id="lstnumberx287.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx287.2" class="ltx_text ltx_font_typewriter">).</span><span id="lstnumberx287.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">select_columns</span><span id="lstnumberx287.4" class="ltx_text ltx_font_typewriter">([</span><span id="lstnumberx287.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx287.6" class="ltx_text ltx_font_typewriter">])</span>
</div>
<div id="lstnumberx288" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>
</div>
<div id="lstnumberx289" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span><span id="lstnumberx289.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx289.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx289.2.1" class="ltx_text ltx_lst_space"> </span>Keep<span id="lstnumberx289.2.2" class="ltx_text ltx_lst_space"> </span>only<span id="lstnumberx289.2.3" class="ltx_text ltx_lst_space"> </span>1000<span id="lstnumberx289.2.4" class="ltx_text ltx_lst_space"> </span>questions<span id="lstnumberx289.2.5" class="ltx_text ltx_lst_space"> </span>as<span id="lstnumberx289.2.6" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx289.2.7" class="ltx_text ltx_lst_space"> </span>quick<span id="lstnumberx289.2.8" class="ltx_text ltx_lst_space"> </span>demo</span>
</div>
<div id="lstnumberx290" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span><span id="lstnumberx290.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx290.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">hotpot_qa_dataset</span><span id="lstnumberx290.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx290.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx290.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx290.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">hotpot_qa_dataset</span><span id="lstnumberx290.7" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx290.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter">take</span><span id="lstnumberx290.9" class="ltx_text ltx_font_typewriter">(1000)</span>
</div>
<div id="lstnumberx291" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>
</div>
<div id="lstnumberx292" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span><span id="lstnumberx292.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx292.2" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="color:#008000;">#<span id="lstnumberx292.2.1" class="ltx_text ltx_lst_space"> </span>Ask<span id="lstnumberx292.2.2" class="ltx_text ltx_lst_space"> </span>GPT-4<span id="lstnumberx292.2.3" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx292.2.4" class="ltx_text ltx_lst_space"> </span>decompose<span id="lstnumberx292.2.5" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx292.2.6" class="ltx_text ltx_lst_space"> </span>question</span>
</div>
<div id="lstnumberx293" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span><span id="lstnumberx293.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx293.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">questions_and_decompositions</span><span id="lstnumberx293.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx293.4" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx293.5" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx293.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">ProcessWithPrompt</span><span id="lstnumberx293.7" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx294" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span><span id="lstnumberx294.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx294.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Generate<span id="lstnumberx294.2.1" class="ltx_text ltx_lst_space"> </span>Decompositions"</span><span id="lstnumberx294.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx295" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span><span id="lstnumberx295.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx295.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">inputs</span><span id="lstnumberx295.3" class="ltx_text ltx_font_typewriter">={</span><span id="lstnumberx295.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"inputs"</span><span id="lstnumberx295.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx295.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx295.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">hotpot_qa_dataset</span><span id="lstnumberx295.8" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx295.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">output</span><span id="lstnumberx295.10" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx295.11" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"question"</span><span id="lstnumberx295.12" class="ltx_text ltx_font_typewriter">]},</span>
</div>
<div id="lstnumberx296" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span><span id="lstnumberx296.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx296.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">args</span><span id="lstnumberx296.3" class="ltx_text ltx_font_typewriter">={</span>
</div>
<div id="lstnumberx297" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span><span id="lstnumberx297.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx297.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"llm"</span><span id="lstnumberx297.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx297.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx297.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">gpt_4</span><span id="lstnumberx297.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx298" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span><span id="lstnumberx298.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx298.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"instruction"</span><span id="lstnumberx298.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx298.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx298.5" class="ltx_text ltx_font_typewriter">(</span>
</div>
<div id="lstnumberx299" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span><span id="lstnumberx299.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx299.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"Given<span id="lstnumberx299.2.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx299.2.2" class="ltx_text ltx_lst_space"> </span>question<span id="lstnumberx299.2.3" class="ltx_text ltx_lst_space"> </span>which<span id="lstnumberx299.2.4" class="ltx_text ltx_lst_space"> </span>requires<span id="lstnumberx299.2.5" class="ltx_text ltx_lst_space"> </span>multiple<span id="lstnumberx299.2.6" class="ltx_text ltx_lst_space"> </span>steps<span id="lstnumberx299.2.7" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx299.2.8" class="ltx_text ltx_lst_space"> </span>solve,"</span>
</div>
<div id="lstnumberx300" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span><span id="lstnumberx300.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx300.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"<span id="lstnumberx300.2.1" class="ltx_text ltx_lst_space"> </span>give<span id="lstnumberx300.2.2" class="ltx_text ltx_lst_space"> </span>a<span id="lstnumberx300.2.3" class="ltx_text ltx_lst_space"> </span>numbered<span id="lstnumberx300.2.4" class="ltx_text ltx_lst_space"> </span>list<span id="lstnumberx300.2.5" class="ltx_text ltx_lst_space"> </span>of<span id="lstnumberx300.2.6" class="ltx_text ltx_lst_space"> </span>intermediate<span id="lstnumberx300.2.7" class="ltx_text ltx_lst_space"> </span>questions<span id="lstnumberx300.2.8" class="ltx_text ltx_lst_space"> </span>required<span id="lstnumberx300.2.9" class="ltx_text ltx_lst_space"> </span>to"</span>
</div>
<div id="lstnumberx301" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span><span id="lstnumberx301.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx301.2" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"<span id="lstnumberx301.2.1" class="ltx_text ltx_lst_space"> </span>solve<span id="lstnumberx301.2.2" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx301.2.3" class="ltx_text ltx_lst_space"> </span>question.<span id="lstnumberx301.2.4" class="ltx_text ltx_lst_space"> </span>Return<span id="lstnumberx301.2.5" class="ltx_text ltx_lst_space"> </span>only<span id="lstnumberx301.2.6" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx301.2.7" class="ltx_text ltx_lst_space"> </span>list,<span id="lstnumberx301.2.8" class="ltx_text ltx_lst_space"> </span>nothing<span id="lstnumberx301.2.9" class="ltx_text ltx_lst_space"> </span>else."</span>
</div>
<div id="lstnumberx302" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span><span id="lstnumberx302.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx302.2" class="ltx_text ltx_font_typewriter">),</span>
</div>
<div id="lstnumberx303" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span><span id="lstnumberx303.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx303.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx304" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span><span id="lstnumberx304.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx304.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter">outputs</span><span id="lstnumberx304.3" class="ltx_text ltx_font_typewriter">={</span><span id="lstnumberx304.4" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"inputs"</span><span id="lstnumberx304.5" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx304.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx304.7" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"questions"</span><span id="lstnumberx304.8" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx304.9" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx304.10" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"generations"</span><span id="lstnumberx304.11" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx304.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx304.13" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"decompositions"</span><span id="lstnumberx304.14" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx305" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span><span id="lstnumberx305.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx305.2" class="ltx_text ltx_font_typewriter">).</span><span id="lstnumberx305.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">select_columns</span><span id="lstnumberx305.4" class="ltx_text ltx_font_typewriter">([</span><span id="lstnumberx305.5" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"questions"</span><span id="lstnumberx305.6" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx305.7" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx305.8" class="ltx_text ltx_lst_string ltx_font_typewriter" style="color:#800080;">"decompositions"</span><span id="lstnumberx305.9" class="ltx_text ltx_font_typewriter">])</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#FAFAFA;"><span class="ltx_tag ltx_tag_float">Example 5: </span>In this demonstration snippet, we augment an existing dataset, HotpotQA <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a href="#bib.bib44" title="" class="ltx_ref">2018</a>)</cite>, a multi-hop QA dataset. DataDreamer makes it easy to perform synthetic dataset augmentation with a LLM. In this example, we add intermediate questions required to solve the multi-hop question.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Example Synthetic Data Card</h2>

<figure id="LST6" class="ltx_float ltx_lstlisting">
<div id="LST6.1" class="ltx_listing ltx_lst_language_json ltx_lst_numbers_left ltx_lstlisting ltx_listing" style="background-color:#FAFAFA;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ewogICAgImRhdGFfY2FyZCI6IHsKICAgICAgICAiR2VuZXJhdGUgUmVzZWFyY2ggUGFwZXIgQWJzdHJhY3RzIjogewogICAgICAgICAgICAiRGF0ZSAmIFRpbWUiOiAiPERBVEVfVElNRV9IRVJFPiIsCiAgICAgICAgICAgICJNb2RlbCBOYW1lIjogWwogICAgICAgICAgICAgICAgImdwdC00IgogICAgICAgICAgICBdLAogICAgICAgICAgICAiTW9kZWwgQ2FyZCI6IFsKICAgICAgICAgICAgICAgICJodHRwczovL2Nkbi5vcGVuYWkuY29tL3BhcGVycy9ncHQtNC1zeXN0ZW0tY2FyZC5wZGYiCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJMaWNlbnNlIEluZm9ybWF0aW9uIjogWwogICAgICAgICAgICAgICAgImh0dHBzOi8vb3BlbmFpLmNvbS9wb2xpY2llcyIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgIkNpdGF0aW9uIEluZm9ybWF0aW9uIjogWwogICAgICAgICAgICAgICAgIkBhcnRpY2xle09wZW5BSTIwMjNHUFQ0VFIsXG4gIHRpdGxlPXtHUFQtNCBUZWNobmljYWwgUmVwb3J0fSxcbiAgYXV0aG9yPXtPcGVuQUl9LFxuICBqb3VybmFsPXtBclhpdn0sXG4gIHllYXI9ezIwMjN9LFxuICB2b2x1bWU9e2Ficy8yMzAzLjA4Nzc0fSxcbiAgdXJsPXtodHRwczovL2FwaS5zZW1hbnRpY3NjaG9sYXIub3JnL0NvcnB1c0lEOjI1NzUzMjgxNX1cbn0iLAogICAgICAgICAgICAgICAgIkBhcnRpY2xle291eWFuZzIwMjJ0cmFpbmluZyxcbiAgdGl0bGU9e1RyYWluaW5nIGxhbmd1YWdlIG1vZGVscyB0byBmb2xsb3cgaW5zdHJ1Y3Rpb25zIHdpdGggaHVtYW4gZmVlZGJhY2t9LFxuICBhdXRob3I9e091eWFuZywgTG9uZyBhbmQgV3UsIEplZmZyZXkgYW5kIEppYW5nLCBYdSBhbmQgQWxtZWlkYSwgRGlvZ28gYW5kIFdhaW53cmlnaHQsIENhcnJvbGwgYW5kIE1pc2hraW4sIFBhbWVsYSBhbmQgWmhhbmcsIENob25nIGFuZCBBZ2Fyd2FsLCBTYW5kaGluaSBhbmQgU2xhbWEsIEthdGFyaW5hIGFuZCBSYXksIEFsZXggYW5kIG90aGVyc30sXG4gIGpvdXJuYWw9e0FkdmFuY2VzIGluIE5ldXJhbCBJbmZvcm1hdGlvbiBQcm9jZXNzaW5nIFN5c3RlbXN9LFxuICB2b2x1bWU9ezM1fSxcbiAgcGFnZXM9ezI3NzMwLS0yNzc0NH0sXG4gIHllYXI9ezIwMjJ9XG59IgogICAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICAiR2VuZXJhdGUgVHdlZXRzIGZyb20gQWJzdHJhY3RzIjogewogICAgICAgICAgICAiRGF0ZSAmIFRpbWUiOiAiPERBVEVfVElNRV9IRVJFPiIsCiAgICAgICAgICAgICJNb2RlbCBOYW1lIjogWwogICAgICAgICAgICAgICAgImdwdC00IgogICAgICAgICAgICBdLAogICAgICAgICAgICAiTW9kZWwgQ2FyZCI6IFsKICAgICAgICAgICAgICAgICJodHRwczovL2Nkbi5vcGVuYWkuY29tL3BhcGVycy9ncHQtNC1zeXN0ZW0tY2FyZC5wZGYiCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJMaWNlbnNlIEluZm9ybWF0aW9uIjogWwogICAgICAgICAgICAgICAgImh0dHBzOi8vb3BlbmFpLmNvbS9wb2xpY2llcyIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgIkNpdGF0aW9uIEluZm9ybWF0aW9uIjogWwogICAgICAgICAgICAgICAgIkBhcnRpY2xle09wZW5BSTIwMjNHUFQ0VFIsXG4gIHRpdGxlPXtHUFQtNCBUZWNobmljYWwgUmVwb3J0fSxcbiAgYXV0aG9yPXtPcGVuQUl9LFxuICBqb3VybmFsPXtBclhpdn0sXG4gIHllYXI9ezIwMjN9LFxuICB2b2x1bWU9e2Ficy8yMzAzLjA4Nzc0fSxcbiAgdXJsPXtodHRwczovL2FwaS5zZW1hbnRpY3NjaG9sYXIub3JnL0NvcnB1c0lEOjI1NzUzMjgxNX1cbn0iLAogICAgICAgICAgICAgICAgIkBhcnRpY2xle291eWFuZzIwMjJ0cmFpbmluZyxcbiAgdGl0bGU9e1RyYWluaW5nIGxhbmd1YWdlIG1vZGVscyB0byBmb2xsb3cgaW5zdHJ1Y3Rpb25zIHdpdGggaHVtYW4gZmVlZGJhY2t9LFxuICBhdXRob3I9e091eWFuZywgTG9uZyBhbmQgV3UsIEplZmZyZXkgYW5kIEppYW5nLCBYdSBhbmQgQWxtZWlkYSwgRGlvZ28gYW5kIFdhaW53cmlnaHQsIENhcnJvbGwgYW5kIE1pc2hraW4sIFBhbWVsYSBhbmQgWmhhbmcsIENob25nIGFuZCBBZ2Fyd2FsLCBTYW5kaGluaSBhbmQgU2xhbWEsIEthdGFyaW5hIGFuZCBSYXksIEFsZXggYW5kIG90aGVyc30sXG4gIGpvdXJuYWw9e0FkdmFuY2VzIGluIE5ldXJhbCBJbmZvcm1hdGlvbiBQcm9jZXNzaW5nIFN5c3RlbXN9LFxuICB2b2x1bWU9ezM1fSxcbiAgcGFnZXM9ezI3NzMwLS0yNzc0NH0sXG4gIHllYXI9ezIwMjJ9XG59IgogICAgICAgICAgICBdCiAgICAgICAgfQogICAgfSwKICAgICJfX3ZlcnNpb25fXyI6ICIwLjEuMCIsCiAgICAiZGF0ZXRpbWUiOiAiPERBVEVfVElNRV9IRVJFPiIsCiAgICAidHlwZSI6ICJQcm9jZXNzV2l0aFByb21wdCIsCiAgICAibmFtZSI6ICJHZW5lcmF0ZSBUd2VldHMgZnJvbSBBYnN0cmFjdHMiLAogICAgInZlcnNpb24iOiAxLjAsCiAgICAiZmluZ2VycHJpbnQiOiAiMjhiNWUyMDliZGFkN2QxNSIsCiAgICAicGlja2xlZCI6IGZhbHNlLAogICAgInJlcV92ZXJzaW9ucyI6IHsKICAgICAgICAiZGlsbCI6ICIwLjMuNyIsCiAgICAgICAgInNxbGl0ZWRpY3QiOiAiMi4xLjAiLAogICAgICAgICJ0b3JjaCI6ICIyLjEuMiIsCiAgICAgICAgIm51bXB5IjogIjEuMjYuMyIsCiAgICAgICAgInRyYW5zZm9ybWVycyI6ICI0LjM2LjIiLAogICAgICAgICJkYXRhc2V0cyI6ICIyLjE2LjEiLAogICAgICAgICJodWdnaW5nZmFjZV9odWIiOiAiMC4yMC4yIiwKICAgICAgICAiYWNjZWxlcmF0ZSI6ICIwLjI2LjEiLAogICAgICAgICJwZWZ0IjogIjAuNy4xIiwKICAgICAgICAidGlrdG9rZW4iOiAiMC41LjIiLAogICAgICAgICJ0b2tlbml6ZXJzIjogIjAuMTUuMCIsCiAgICAgICAgInBldGFscyI6ICIyLjIuMCIsCiAgICAgICAgIm9wZW5haSI6ICIxLjkuMCIsCiAgICAgICAgImN0cmFuc2Zvcm1lcnMiOiAiMC4yLjI3IiwKICAgICAgICAib3B0aW11bSI6ICIxLjE2LjIiLAogICAgICAgICJiaXRzYW5kYnl0ZXMiOiAiMC40Mi4wIiwKICAgICAgICAibGl0ZWxsbSI6ICIxLjE1LjMiLAogICAgICAgICJ0cmwiOiAiMC43LjYiLAogICAgICAgICJzZXRmaXQiOiAiMS4wLjMiLAogICAgICAgICJ0b2dldGhlciI6ICIwLjIuMTAiLAogICAgICAgICJnb29nbGUuZ2VuZXJhdGl2ZWFpIjogIjAuMi4xIiwKICAgICAgICAiZ29vZ2xlLWNsb3VkLWFpcGxhdGZvcm0iOiAiMS4zNS4wIgogICAgfSwKICAgICJpbnRlcnByZXRlciI6ICIzLjExLjcgKG1haW4sIERlYyAgNCAyMDIzLCAxODoxMDoxMSkgW0NsYW5nIDE1LjAuMCAoY2xhbmctMTUwMC4xLjAuMi41KV0iCn0=" download="resources/examples/synthetic_data_card.json">⬇</a></div>
<div id="lstnumberx306" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx306.1" class="ltx_text ltx_font_typewriter">{</span>
</div>
<div id="lstnumberx307" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx307.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx307.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx307.2.1" class="ltx_text" style="color:#A31414;">"data_card"</span></span><span id="lstnumberx307.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx307.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx307.5" class="ltx_text ltx_font_typewriter">{</span>
</div>
<div id="lstnumberx308" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx308.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx308.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx308.2.1" class="ltx_text" style="color:#A31414;">"Generate<span id="lstnumberx308.2.1.1" class="ltx_text ltx_lst_space"> </span>Research<span id="lstnumberx308.2.1.2" class="ltx_text ltx_lst_space"> </span>Paper<span id="lstnumberx308.2.1.3" class="ltx_text ltx_lst_space"> </span>Abstracts"</span></span><span id="lstnumberx308.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx308.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx308.5" class="ltx_text ltx_font_typewriter">{</span>
</div>
<div id="lstnumberx309" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span id="lstnumberx309.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx309.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx309.2.1" class="ltx_text" style="color:#A31414;">"Date<span id="lstnumberx309.2.1.1" class="ltx_text ltx_lst_space"> </span>&amp;<span id="lstnumberx309.2.1.2" class="ltx_text ltx_lst_space"> </span>Time"</span></span><span id="lstnumberx309.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx309.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx309.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx309.5.1" class="ltx_text" style="color:#A31414;">"&lt;DATE_TIME_HERE&gt;"</span></span><span id="lstnumberx309.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx310" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span><span id="lstnumberx310.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx310.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx310.2.1" class="ltx_text" style="color:#A31414;">"Model<span id="lstnumberx310.2.1.1" class="ltx_text ltx_lst_space"> </span>Name"</span></span><span id="lstnumberx310.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx310.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx310.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx311" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span><span id="lstnumberx311.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx311.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx311.2.1" class="ltx_text" style="color:#A31414;">"gpt-4"</span></span>
</div>
<div id="lstnumberx312" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span id="lstnumberx312.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx312.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span><span id="lstnumberx312.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx313" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span><span id="lstnumberx313.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx313.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx313.2.1" class="ltx_text" style="color:#A31414;">"Model<span id="lstnumberx313.2.1.1" class="ltx_text ltx_lst_space"> </span>Card"</span></span><span id="lstnumberx313.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx313.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx313.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx314" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span><span id="lstnumberx314.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx314.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx314.2.1" class="ltx_text" style="color:#A31414;">"https://cdn.openai.com/papers/gpt-4-system-card.pdf"</span></span>
</div>
<div id="lstnumberx315" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span><span id="lstnumberx315.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx315.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span><span id="lstnumberx315.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx316" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span><span id="lstnumberx316.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx316.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx316.2.1" class="ltx_text" style="color:#A31414;">"License<span id="lstnumberx316.2.1.1" class="ltx_text ltx_lst_space"> </span>Information"</span></span><span id="lstnumberx316.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx316.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx316.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx317" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span><span id="lstnumberx317.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx317.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx317.2.1" class="ltx_text" style="color:#A31414;">"https://openai.com/policies"</span></span>
</div>
<div id="lstnumberx318" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span><span id="lstnumberx318.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx318.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span><span id="lstnumberx318.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx319" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span><span id="lstnumberx319.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx319.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx319.2.1" class="ltx_text" style="color:#A31414;">"Citation<span id="lstnumberx319.2.1.1" class="ltx_text ltx_lst_space"> </span>Information"</span></span><span id="lstnumberx319.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx319.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx319.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx320" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span><span id="lstnumberx320.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx320.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx320.2.1" class="ltx_text" style="color:#A31414;">"@article{OpenAI2023GPT4TR,\n<span id="lstnumberx320.2.1.1" class="ltx_text ltx_lst_space">  </span>title={GPT-4<span id="lstnumberx320.2.1.2" class="ltx_text ltx_lst_space"> </span>Technical<span id="lstnumberx320.2.1.3" class="ltx_text ltx_lst_space"> </span>Report},\n<span id="lstnumberx320.2.1.4" class="ltx_text ltx_lst_space">  </span>author={OpenAI},\n<span id="lstnumberx320.2.1.5" class="ltx_text ltx_lst_space">  </span>journal={ArXiv},\n<span id="lstnumberx320.2.1.6" class="ltx_text ltx_lst_space">  </span>year={2023},\n<span id="lstnumberx320.2.1.7" class="ltx_text ltx_lst_space">  </span>volume={abs/2303.08774},\n<span id="lstnumberx320.2.1.8" class="ltx_text ltx_lst_space">  </span>url={https://api.semanticscholar.org/CorpusID:257532815}\n}"</span></span><span id="lstnumberx320.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx321" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span><span id="lstnumberx321.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx321.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx321.2.1" class="ltx_text" style="color:#A31414;">"@article{ouyang2022training,\n<span id="lstnumberx321.2.1.1" class="ltx_text ltx_lst_space">  </span>title={Training<span id="lstnumberx321.2.1.2" class="ltx_text ltx_lst_space"> </span>language<span id="lstnumberx321.2.1.3" class="ltx_text ltx_lst_space"> </span>models<span id="lstnumberx321.2.1.4" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx321.2.1.5" class="ltx_text ltx_lst_space"> </span>follow<span id="lstnumberx321.2.1.6" class="ltx_text ltx_lst_space"> </span>instructions<span id="lstnumberx321.2.1.7" class="ltx_text ltx_lst_space"> </span>with<span id="lstnumberx321.2.1.8" class="ltx_text ltx_lst_space"> </span>human<span id="lstnumberx321.2.1.9" class="ltx_text ltx_lst_space"> </span>feedback},\n<span id="lstnumberx321.2.1.10" class="ltx_text ltx_lst_space">  </span>author={Ouyang,<span id="lstnumberx321.2.1.11" class="ltx_text ltx_lst_space"> </span>Long<span id="lstnumberx321.2.1.12" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.13" class="ltx_text ltx_lst_space"> </span>Wu,<span id="lstnumberx321.2.1.14" class="ltx_text ltx_lst_space"> </span>Jeffrey<span id="lstnumberx321.2.1.15" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.16" class="ltx_text ltx_lst_space"> </span>Jiang,<span id="lstnumberx321.2.1.17" class="ltx_text ltx_lst_space"> </span>Xu<span id="lstnumberx321.2.1.18" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.19" class="ltx_text ltx_lst_space"> </span>Almeida,<span id="lstnumberx321.2.1.20" class="ltx_text ltx_lst_space"> </span>Diogo<span id="lstnumberx321.2.1.21" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.22" class="ltx_text ltx_lst_space"> </span>Wainwright,<span id="lstnumberx321.2.1.23" class="ltx_text ltx_lst_space"> </span>Carroll<span id="lstnumberx321.2.1.24" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.25" class="ltx_text ltx_lst_space"> </span>Mishkin,<span id="lstnumberx321.2.1.26" class="ltx_text ltx_lst_space"> </span>Pamela<span id="lstnumberx321.2.1.27" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.28" class="ltx_text ltx_lst_space"> </span>Zhang,<span id="lstnumberx321.2.1.29" class="ltx_text ltx_lst_space"> </span>Chong<span id="lstnumberx321.2.1.30" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.31" class="ltx_text ltx_lst_space"> </span>Agarwal,<span id="lstnumberx321.2.1.32" class="ltx_text ltx_lst_space"> </span>Sandhini<span id="lstnumberx321.2.1.33" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.34" class="ltx_text ltx_lst_space"> </span>Slama,<span id="lstnumberx321.2.1.35" class="ltx_text ltx_lst_space"> </span>Katarina<span id="lstnumberx321.2.1.36" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.37" class="ltx_text ltx_lst_space"> </span>Ray,<span id="lstnumberx321.2.1.38" class="ltx_text ltx_lst_space"> </span>Alex<span id="lstnumberx321.2.1.39" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx321.2.1.40" class="ltx_text ltx_lst_space"> </span>others},\n<span id="lstnumberx321.2.1.41" class="ltx_text ltx_lst_space">  </span>journal={Advances<span id="lstnumberx321.2.1.42" class="ltx_text ltx_lst_space"> </span>in<span id="lstnumberx321.2.1.43" class="ltx_text ltx_lst_space"> </span>Neural<span id="lstnumberx321.2.1.44" class="ltx_text ltx_lst_space"> </span>Information<span id="lstnumberx321.2.1.45" class="ltx_text ltx_lst_space"> </span>Processing<span id="lstnumberx321.2.1.46" class="ltx_text ltx_lst_space"> </span>Systems},\n<span id="lstnumberx321.2.1.47" class="ltx_text ltx_lst_space">  </span>volume={35},\n<span id="lstnumberx321.2.1.48" class="ltx_text ltx_lst_space">  </span>pages={27730--27744},\n<span id="lstnumberx321.2.1.49" class="ltx_text ltx_lst_space">  </span>year={2022}\n}"</span></span>
</div>
<div id="lstnumberx322" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span><span id="lstnumberx322.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx322.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span>
</div>
<div id="lstnumberx323" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span><span id="lstnumberx323.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx323.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx324" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span><span id="lstnumberx324.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx324.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx324.2.1" class="ltx_text" style="color:#A31414;">"Generate<span id="lstnumberx324.2.1.1" class="ltx_text ltx_lst_space"> </span>Tweets<span id="lstnumberx324.2.1.2" class="ltx_text ltx_lst_space"> </span>from<span id="lstnumberx324.2.1.3" class="ltx_text ltx_lst_space"> </span>Abstracts"</span></span><span id="lstnumberx324.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx324.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx324.5" class="ltx_text ltx_font_typewriter">{</span>
</div>
<div id="lstnumberx325" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span><span id="lstnumberx325.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx325.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx325.2.1" class="ltx_text" style="color:#A31414;">"Date<span id="lstnumberx325.2.1.1" class="ltx_text ltx_lst_space"> </span>&amp;<span id="lstnumberx325.2.1.2" class="ltx_text ltx_lst_space"> </span>Time"</span></span><span id="lstnumberx325.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx325.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx325.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx325.5.1" class="ltx_text" style="color:#A31414;">"&lt;DATE_TIME_HERE&gt;"</span></span><span id="lstnumberx325.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx326" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span><span id="lstnumberx326.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx326.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx326.2.1" class="ltx_text" style="color:#A31414;">"Model<span id="lstnumberx326.2.1.1" class="ltx_text ltx_lst_space"> </span>Name"</span></span><span id="lstnumberx326.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx326.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx326.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx327" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span><span id="lstnumberx327.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx327.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx327.2.1" class="ltx_text" style="color:#A31414;">"gpt-4"</span></span>
</div>
<div id="lstnumberx328" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span><span id="lstnumberx328.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx328.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span><span id="lstnumberx328.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx329" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span><span id="lstnumberx329.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx329.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx329.2.1" class="ltx_text" style="color:#A31414;">"Model<span id="lstnumberx329.2.1.1" class="ltx_text ltx_lst_space"> </span>Card"</span></span><span id="lstnumberx329.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx329.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx329.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx330" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span><span id="lstnumberx330.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx330.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx330.2.1" class="ltx_text" style="color:#A31414;">"https://cdn.openai.com/papers/gpt-4-system-card.pdf"</span></span>
</div>
<div id="lstnumberx331" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span><span id="lstnumberx331.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx331.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span><span id="lstnumberx331.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx332" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span><span id="lstnumberx332.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx332.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx332.2.1" class="ltx_text" style="color:#A31414;">"License<span id="lstnumberx332.2.1.1" class="ltx_text ltx_lst_space"> </span>Information"</span></span><span id="lstnumberx332.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx332.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx332.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx333" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span><span id="lstnumberx333.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx333.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx333.2.1" class="ltx_text" style="color:#A31414;">"https://openai.com/policies"</span></span>
</div>
<div id="lstnumberx334" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span><span id="lstnumberx334.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx334.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span><span id="lstnumberx334.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx335" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span><span id="lstnumberx335.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx335.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx335.2.1" class="ltx_text" style="color:#A31414;">"Citation<span id="lstnumberx335.2.1.1" class="ltx_text ltx_lst_space"> </span>Information"</span></span><span id="lstnumberx335.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx335.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx335.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">[</span>
</div>
<div id="lstnumberx336" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span><span id="lstnumberx336.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx336.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx336.2.1" class="ltx_text" style="color:#A31414;">"@article{OpenAI2023GPT4TR,\n<span id="lstnumberx336.2.1.1" class="ltx_text ltx_lst_space">  </span>title={GPT-4<span id="lstnumberx336.2.1.2" class="ltx_text ltx_lst_space"> </span>Technical<span id="lstnumberx336.2.1.3" class="ltx_text ltx_lst_space"> </span>Report},\n<span id="lstnumberx336.2.1.4" class="ltx_text ltx_lst_space">  </span>author={OpenAI},\n<span id="lstnumberx336.2.1.5" class="ltx_text ltx_lst_space">  </span>journal={ArXiv},\n<span id="lstnumberx336.2.1.6" class="ltx_text ltx_lst_space">  </span>year={2023},\n<span id="lstnumberx336.2.1.7" class="ltx_text ltx_lst_space">  </span>volume={abs/2303.08774},\n<span id="lstnumberx336.2.1.8" class="ltx_text ltx_lst_space">  </span>url={https://api.semanticscholar.org/CorpusID:257532815}\n}"</span></span><span id="lstnumberx336.3" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx337" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span><span id="lstnumberx337.1" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx337.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx337.2.1" class="ltx_text" style="color:#A31414;">"@article{ouyang2022training,\n<span id="lstnumberx337.2.1.1" class="ltx_text ltx_lst_space">  </span>title={Training<span id="lstnumberx337.2.1.2" class="ltx_text ltx_lst_space"> </span>language<span id="lstnumberx337.2.1.3" class="ltx_text ltx_lst_space"> </span>models<span id="lstnumberx337.2.1.4" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx337.2.1.5" class="ltx_text ltx_lst_space"> </span>follow<span id="lstnumberx337.2.1.6" class="ltx_text ltx_lst_space"> </span>instructions<span id="lstnumberx337.2.1.7" class="ltx_text ltx_lst_space"> </span>with<span id="lstnumberx337.2.1.8" class="ltx_text ltx_lst_space"> </span>human<span id="lstnumberx337.2.1.9" class="ltx_text ltx_lst_space"> </span>feedback},\n<span id="lstnumberx337.2.1.10" class="ltx_text ltx_lst_space">  </span>author={Ouyang,<span id="lstnumberx337.2.1.11" class="ltx_text ltx_lst_space"> </span>Long<span id="lstnumberx337.2.1.12" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.13" class="ltx_text ltx_lst_space"> </span>Wu,<span id="lstnumberx337.2.1.14" class="ltx_text ltx_lst_space"> </span>Jeffrey<span id="lstnumberx337.2.1.15" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.16" class="ltx_text ltx_lst_space"> </span>Jiang,<span id="lstnumberx337.2.1.17" class="ltx_text ltx_lst_space"> </span>Xu<span id="lstnumberx337.2.1.18" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.19" class="ltx_text ltx_lst_space"> </span>Almeida,<span id="lstnumberx337.2.1.20" class="ltx_text ltx_lst_space"> </span>Diogo<span id="lstnumberx337.2.1.21" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.22" class="ltx_text ltx_lst_space"> </span>Wainwright,<span id="lstnumberx337.2.1.23" class="ltx_text ltx_lst_space"> </span>Carroll<span id="lstnumberx337.2.1.24" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.25" class="ltx_text ltx_lst_space"> </span>Mishkin,<span id="lstnumberx337.2.1.26" class="ltx_text ltx_lst_space"> </span>Pamela<span id="lstnumberx337.2.1.27" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.28" class="ltx_text ltx_lst_space"> </span>Zhang,<span id="lstnumberx337.2.1.29" class="ltx_text ltx_lst_space"> </span>Chong<span id="lstnumberx337.2.1.30" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.31" class="ltx_text ltx_lst_space"> </span>Agarwal,<span id="lstnumberx337.2.1.32" class="ltx_text ltx_lst_space"> </span>Sandhini<span id="lstnumberx337.2.1.33" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.34" class="ltx_text ltx_lst_space"> </span>Slama,<span id="lstnumberx337.2.1.35" class="ltx_text ltx_lst_space"> </span>Katarina<span id="lstnumberx337.2.1.36" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.37" class="ltx_text ltx_lst_space"> </span>Ray,<span id="lstnumberx337.2.1.38" class="ltx_text ltx_lst_space"> </span>Alex<span id="lstnumberx337.2.1.39" class="ltx_text ltx_lst_space"> </span>and<span id="lstnumberx337.2.1.40" class="ltx_text ltx_lst_space"> </span>others},\n<span id="lstnumberx337.2.1.41" class="ltx_text ltx_lst_space">  </span>journal={Advances<span id="lstnumberx337.2.1.42" class="ltx_text ltx_lst_space"> </span>in<span id="lstnumberx337.2.1.43" class="ltx_text ltx_lst_space"> </span>Neural<span id="lstnumberx337.2.1.44" class="ltx_text ltx_lst_space"> </span>Information<span id="lstnumberx337.2.1.45" class="ltx_text ltx_lst_space"> </span>Processing<span id="lstnumberx337.2.1.46" class="ltx_text ltx_lst_space"> </span>Systems},\n<span id="lstnumberx337.2.1.47" class="ltx_text ltx_lst_space">  </span>volume={35},\n<span id="lstnumberx337.2.1.48" class="ltx_text ltx_lst_space">  </span>pages={27730--27744},\n<span id="lstnumberx337.2.1.49" class="ltx_text ltx_lst_space">  </span>year={2022}\n}"</span></span>
</div>
<div id="lstnumberx338" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span><span id="lstnumberx338.1" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx338.2" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#1469B0;">]</span>
</div>
<div id="lstnumberx339" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span><span id="lstnumberx339.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx339.2" class="ltx_text ltx_font_typewriter">}</span>
</div>
<div id="lstnumberx340" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span><span id="lstnumberx340.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx340.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx341" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span><span id="lstnumberx341.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx341.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx341.2.1" class="ltx_text" style="color:#A31414;">"__version__"</span></span><span id="lstnumberx341.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx341.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx341.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx341.5.1" class="ltx_text" style="color:#A31414;">"0.1.0"</span></span><span id="lstnumberx341.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx342" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">37</span><span id="lstnumberx342.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx342.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx342.2.1" class="ltx_text" style="color:#A31414;">"datetime"</span></span><span id="lstnumberx342.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx342.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx342.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx342.5.1" class="ltx_text" style="color:#A31414;">"&lt;DATE_TIME_HERE&gt;"</span></span><span id="lstnumberx342.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx343" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">38</span><span id="lstnumberx343.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx343.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx343.2.1" class="ltx_text" style="color:#A31414;">"type"</span></span><span id="lstnumberx343.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx343.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx343.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx343.5.1" class="ltx_text" style="color:#A31414;">"ProcessWithPrompt"</span></span><span id="lstnumberx343.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx344" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">39</span><span id="lstnumberx344.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx344.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx344.2.1" class="ltx_text" style="color:#A31414;">"name"</span></span><span id="lstnumberx344.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx344.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx344.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx344.5.1" class="ltx_text" style="color:#A31414;">"Generate<span id="lstnumberx344.5.1.1" class="ltx_text ltx_lst_space"> </span>Tweets<span id="lstnumberx344.5.1.2" class="ltx_text ltx_lst_space"> </span>from<span id="lstnumberx344.5.1.3" class="ltx_text ltx_lst_space"> </span>Abstracts"</span></span><span id="lstnumberx344.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx345" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">40</span><span id="lstnumberx345.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx345.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx345.2.1" class="ltx_text" style="color:#A31414;">"version"</span></span><span id="lstnumberx345.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx345.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx345.5" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#6A6D20;">1</span><span id="lstnumberx345.6" class="ltx_text ltx_font_typewriter">.</span><span id="lstnumberx345.7" class="ltx_text ltx_lst_literate ltx_font_typewriter" style="color:#6A6D20;">0</span><span id="lstnumberx345.8" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx346" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">41</span><span id="lstnumberx346.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx346.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx346.2.1" class="ltx_text" style="color:#A31414;">"fingerprint"</span></span><span id="lstnumberx346.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx346.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx346.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx346.5.1" class="ltx_text" style="color:#A31414;">"28b5e209bdad7d15"</span></span><span id="lstnumberx346.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx347" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">42</span><span id="lstnumberx347.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx347.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx347.2.1" class="ltx_text" style="color:#A31414;">"pickled"</span></span><span id="lstnumberx347.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx347.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx347.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">false</span><span id="lstnumberx347.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx348" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">43</span><span id="lstnumberx348.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx348.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx348.2.1" class="ltx_text" style="color:#A31414;">"req_versions"</span></span><span id="lstnumberx348.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx348.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx348.5" class="ltx_text ltx_font_typewriter">{</span>
</div>
<div id="lstnumberx349" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">44</span><span id="lstnumberx349.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx349.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx349.2.1" class="ltx_text" style="color:#A31414;">"dill"</span></span><span id="lstnumberx349.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx349.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx349.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx349.5.1" class="ltx_text" style="color:#A31414;">"0.3.7"</span></span><span id="lstnumberx349.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx350" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">45</span><span id="lstnumberx350.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx350.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx350.2.1" class="ltx_text" style="color:#A31414;">"sqlitedict"</span></span><span id="lstnumberx350.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx350.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx350.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx350.5.1" class="ltx_text" style="color:#A31414;">"2.1.0"</span></span><span id="lstnumberx350.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx351" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">46</span><span id="lstnumberx351.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx351.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx351.2.1" class="ltx_text" style="color:#A31414;">"torch"</span></span><span id="lstnumberx351.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx351.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx351.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx351.5.1" class="ltx_text" style="color:#A31414;">"2.1.2"</span></span><span id="lstnumberx351.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx352" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">47</span><span id="lstnumberx352.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx352.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx352.2.1" class="ltx_text" style="color:#A31414;">"numpy"</span></span><span id="lstnumberx352.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx352.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx352.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx352.5.1" class="ltx_text" style="color:#A31414;">"1.26.3"</span></span><span id="lstnumberx352.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx353" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">48</span><span id="lstnumberx353.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx353.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx353.2.1" class="ltx_text" style="color:#A31414;">"transformers"</span></span><span id="lstnumberx353.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx353.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx353.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx353.5.1" class="ltx_text" style="color:#A31414;">"4.36.2"</span></span><span id="lstnumberx353.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx354" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">49</span><span id="lstnumberx354.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx354.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx354.2.1" class="ltx_text" style="color:#A31414;">"datasets"</span></span><span id="lstnumberx354.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx354.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx354.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx354.5.1" class="ltx_text" style="color:#A31414;">"2.16.1"</span></span><span id="lstnumberx354.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx355" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">50</span><span id="lstnumberx355.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx355.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx355.2.1" class="ltx_text" style="color:#A31414;">"huggingface_hub"</span></span><span id="lstnumberx355.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx355.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx355.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx355.5.1" class="ltx_text" style="color:#A31414;">"0.20.2"</span></span><span id="lstnumberx355.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx356" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">51</span><span id="lstnumberx356.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx356.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx356.2.1" class="ltx_text" style="color:#A31414;">"accelerate"</span></span><span id="lstnumberx356.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx356.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx356.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx356.5.1" class="ltx_text" style="color:#A31414;">"0.26.1"</span></span><span id="lstnumberx356.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx357" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">52</span><span id="lstnumberx357.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx357.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx357.2.1" class="ltx_text" style="color:#A31414;">"peft"</span></span><span id="lstnumberx357.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx357.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx357.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx357.5.1" class="ltx_text" style="color:#A31414;">"0.7.1"</span></span><span id="lstnumberx357.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx358" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">53</span><span id="lstnumberx358.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx358.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx358.2.1" class="ltx_text" style="color:#A31414;">"tiktoken"</span></span><span id="lstnumberx358.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx358.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx358.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx358.5.1" class="ltx_text" style="color:#A31414;">"0.5.2"</span></span><span id="lstnumberx358.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx359" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">54</span><span id="lstnumberx359.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx359.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx359.2.1" class="ltx_text" style="color:#A31414;">"tokenizers"</span></span><span id="lstnumberx359.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx359.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx359.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx359.5.1" class="ltx_text" style="color:#A31414;">"0.15.0"</span></span><span id="lstnumberx359.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx360" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">55</span><span id="lstnumberx360.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx360.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx360.2.1" class="ltx_text" style="color:#A31414;">"petals"</span></span><span id="lstnumberx360.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx360.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx360.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx360.5.1" class="ltx_text" style="color:#A31414;">"2.2.0"</span></span><span id="lstnumberx360.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx361" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">56</span><span id="lstnumberx361.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx361.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx361.2.1" class="ltx_text" style="color:#A31414;">"openai"</span></span><span id="lstnumberx361.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx361.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx361.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx361.5.1" class="ltx_text" style="color:#A31414;">"1.9.0"</span></span><span id="lstnumberx361.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx362" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">57</span><span id="lstnumberx362.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx362.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx362.2.1" class="ltx_text" style="color:#A31414;">"ctransformers"</span></span><span id="lstnumberx362.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx362.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx362.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx362.5.1" class="ltx_text" style="color:#A31414;">"0.2.27"</span></span><span id="lstnumberx362.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx363" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">58</span><span id="lstnumberx363.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx363.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx363.2.1" class="ltx_text" style="color:#A31414;">"optimum"</span></span><span id="lstnumberx363.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx363.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx363.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx363.5.1" class="ltx_text" style="color:#A31414;">"1.16.2"</span></span><span id="lstnumberx363.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx364" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">59</span><span id="lstnumberx364.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx364.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx364.2.1" class="ltx_text" style="color:#A31414;">"bitsandbytes"</span></span><span id="lstnumberx364.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx364.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx364.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx364.5.1" class="ltx_text" style="color:#A31414;">"0.42.0"</span></span><span id="lstnumberx364.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx365" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">60</span><span id="lstnumberx365.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx365.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx365.2.1" class="ltx_text" style="color:#A31414;">"litellm"</span></span><span id="lstnumberx365.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx365.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx365.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx365.5.1" class="ltx_text" style="color:#A31414;">"1.15.3"</span></span><span id="lstnumberx365.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx366" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">61</span><span id="lstnumberx366.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx366.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx366.2.1" class="ltx_text" style="color:#A31414;">"trl"</span></span><span id="lstnumberx366.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx366.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx366.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx366.5.1" class="ltx_text" style="color:#A31414;">"0.7.6"</span></span><span id="lstnumberx366.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx367" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">62</span><span id="lstnumberx367.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx367.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx367.2.1" class="ltx_text" style="color:#A31414;">"setfit"</span></span><span id="lstnumberx367.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx367.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx367.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx367.5.1" class="ltx_text" style="color:#A31414;">"1.0.3"</span></span><span id="lstnumberx367.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx368" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">63</span><span id="lstnumberx368.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx368.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx368.2.1" class="ltx_text" style="color:#A31414;">"together"</span></span><span id="lstnumberx368.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx368.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx368.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx368.5.1" class="ltx_text" style="color:#A31414;">"0.2.10"</span></span><span id="lstnumberx368.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx369" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">64</span><span id="lstnumberx369.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx369.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx369.2.1" class="ltx_text" style="color:#A31414;">"google.generativeai"</span></span><span id="lstnumberx369.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx369.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx369.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx369.5.1" class="ltx_text" style="color:#A31414;">"0.2.1"</span></span><span id="lstnumberx369.6" class="ltx_text ltx_font_typewriter">,</span>
</div>
<div id="lstnumberx370" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">65</span><span id="lstnumberx370.1" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx370.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx370.2.1" class="ltx_text" style="color:#A31414;">"google-cloud-aiplatform"</span></span><span id="lstnumberx370.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx370.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx370.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx370.5.1" class="ltx_text" style="color:#A31414;">"1.35.0"</span></span>
</div>
<div id="lstnumberx371" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">66</span><span id="lstnumberx371.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx371.2" class="ltx_text ltx_font_typewriter">},</span>
</div>
<div id="lstnumberx372" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">67</span><span id="lstnumberx372.1" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx372.2" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx372.2.1" class="ltx_text" style="color:#A31414;">"interpreter"</span></span><span id="lstnumberx372.3" class="ltx_text ltx_font_typewriter">:</span><span id="lstnumberx372.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx372.5" class="ltx_text ltx_lst_string ltx_font_typewriter"><span id="lstnumberx372.5.1" class="ltx_text" style="color:#A31414;">"3.11.7<span id="lstnumberx372.5.1.1" class="ltx_text ltx_lst_space"> </span>(main,<span id="lstnumberx372.5.1.2" class="ltx_text ltx_lst_space"> </span>Dec<span id="lstnumberx372.5.1.3" class="ltx_text ltx_lst_space">  </span>4<span id="lstnumberx372.5.1.4" class="ltx_text ltx_lst_space"> </span>2023,<span id="lstnumberx372.5.1.5" class="ltx_text ltx_lst_space"> </span>18:10:11)<span id="lstnumberx372.5.1.6" class="ltx_text ltx_lst_space"> </span>[Clang<span id="lstnumberx372.5.1.7" class="ltx_text ltx_lst_space"> </span>15.0.0<span id="lstnumberx372.5.1.8" class="ltx_text ltx_lst_space"> </span>(clang-1500.1.0.2.5)]"</span></span>
</div>
<div id="lstnumberx373" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">68</span><span id="lstnumberx373.1" class="ltx_text ltx_font_typewriter">}</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#FAFAFA;"><span class="ltx_tag ltx_tag_float">Example 6: </span>A JSON representation of an example automatically generated synthetic data card produced by DataDreamer for Example <a href="#LST1" title="Example 1 ‣ 3 Demonstration and Examples ‣ DataDreamer: A Tool for Synthetic Data Generation and Reproducible LLM Workflows" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Synthetic data cards and model cards are automatically produced by recursively tracing through any steps, models, and trainers used to produce a given dataset or model. Each step, model, and trainer has associated metadata such as license information and citation information. DataDreamer collects this information and produces a synthetic data card (or model card) that reports the information along with reproducibility information like the reproducibility fingerprint.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2402.10378" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2402.10379" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2402.10379">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2402.10379" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2402.10380" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar  5 16:39:07 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
