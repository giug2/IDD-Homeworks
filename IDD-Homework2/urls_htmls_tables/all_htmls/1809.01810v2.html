<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1809.01810] Interpretable Visual Question Answering by Reasoning on Dependency Trees</title><meta property="og:description" content="Collaborative reasoning for understanding image-question pairs is a very critical but underexplored topic in interpretable visual question answering systems. Although very recent studies have attempted to use explicit …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Interpretable Visual Question Answering by Reasoning on Dependency Trees">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Interpretable Visual Question Answering by Reasoning on Dependency Trees">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1809.01810">

<!--Generated on Fri Mar 15 22:36:36 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Visual Question Answering,  Image and Language Parsing,  Deep Reasoning,  Attention Model
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Interpretable Visual Question Answering by Reasoning on Dependency Trees</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qingxing Cao, Bailin Li, Xiaodan Liang and Liang Lin
</span><span class="ltx_author_notes">
This work was supported in part by the National Key Research and Development Program of China under Grant No. 2016YFB1001004, in part by National Natural Science Foundation of China (NSFC) under Grant No. 61976233, 61836012, 61622214, and in part by the Natural Science Foundation of Guangdong Province under Grant No. 2017A030312006.
Q.Cao and X. Liang are with the School of Intelligent Systems Engineering, Sun Yat-sen University, China. B. Li is with DMAI Great China. L. Lin is with the School of Data and Computer
Science, Sun Yat-sen University, China
Corresponding author:
Xiaodan Liang (E-mail: xdliang328@gmail.com)</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">Collaborative reasoning for understanding image-question pairs is a very critical but underexplored topic in interpretable visual question answering systems. Although very recent studies have attempted to use explicit compositional processes to assemble multiple subtasks embedded in questions, their models heavily rely on annotations or handcrafted rules to obtain valid reasoning processes, which leads to either heavy workloads or poor performance on compositional reasoning. In this paper, to better align image and language domains in diverse and unrestricted cases, we propose a novel neural network model that performs global reasoning on a dependency tree parsed from the question; thus, our model is called a parse-tree-guided reasoning network (PTGRN). This network consists of three collaborative modules: i) an attention module that exploits the local visual evidence of each word parsed from the question, ii) a gated residual composition module that composes the previously mined evidence, and iii) a parse-tree-guided propagation module that passes the mined evidence along the parse tree. Thus, PTGRN is capable of building an interpretable visual question answering (VQA) system that gradually derives image cues following question-driven parse-tree reasoning. Experiments on relational datasets demonstrate the superiority of PTGRN over current state-of-the-art VQA methods, and the visualization results highlight the explainable capability of our reasoning system.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Visual Question Answering, Image and Language Parsing, Deep Reasoning, Attention Model

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The task of visual question answering (VQA) is to predict the correct answer given an image and a textual question.
The key to this task is the ability to apply coreasoning over the image and language domains.
However, most previous methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> work in a manner similar to a black box, i.e., simply mapping the visual content to the textual words by crafting neural networks. The main drawback of these methods is the lack of interpretability of the results, i.e., why are these answers produced?
Moreover, it has been shown that the accuracy of these results may be improved by overfitting the data bias in the VQA benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and that not explicitly exploiting the structures of the text and images leads to unsatisfactory performance on relational reasoning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
Very recently, a few pioneering works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> have taken advantage of the inherent structure of text and images; these works parse the question-image input into a tree or graph layout and assemble local features of nodes to predict the answer. For example, the layout “<em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">more</em>(<em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">find</em>(<em id="S1.p1.1.3" class="ltx_emph ltx_font_italic">ball</em>),<em id="S1.p1.1.4" class="ltx_emph ltx_font_italic">find</em>(<em id="S1.p1.1.5" class="ltx_emph ltx_font_italic">yellow</em>))” means that the module should locate the ball and the yellow object in the image first and then combine the two results to determine whether there are more balls than yellow objects.
However, these methods rely on either handcrafted rules for understanding questions or a layout parser that is trained from scratch; the first approach requires human experts to design appropriate rules in a specific domain or requires heavy labor to annotate a specific dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, while the second results in a large decrease in performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. We argue that these limitations severely limit the application potential of these approaches for understanding general image-question pairs that may contain diverse and open-ended question styles.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1809.01810/assets/figure/intro.png" id="S1.F1.g1" class="ltx_graphics ltx_img_square" width="299" height="275" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of our parse-tree-guided reasoning network (PTGRN) that sequentially performs reasoning over a dependency tree parsed from the question. Conditioned on preceding word nodes, PTGRN alternately mines visual evidence for nodes via an attention module and integrates the features of child nodes via a gated residual composition module.
</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To achieve a general and powerful reasoning system that can enable reasoning over any dependency parse trees of questions without domain-specific knowledge, we propose a novel parse-tree-guided reasoning network (PTGRN) that contains three collaborative modules to perform tailored reasoning operations for addressing the two most common word relations in the questions. As shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, given a specific dependency tree of a question parsed by an off-the-shelf parser, we construct a reasoning route that follows the parse tree layout, which is a tree structure composed of several types of nodes or edges. Our proposed network then alternately applies three collaborative modules on each word node for global reasoning to 1) exploit the local visual evidence of each word guided by the exploited regions of its child nodes, 2) integrate the messages of child nodes via gated residual composition, and 3) propagate the hidden and exploited map toward its parent with respect to the type of edges. Notably, in contrast to previous methods, PTGRN is a general and interpretable reasoning VQA framework that does not require any complicated handcrafted rules or ground-truth annotations to obtain a specific layout.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.3" class="ltx_p">Specifically, we observe that the frequently used types of dependency relations can be categorized into two sets depending on whether the head is a predicate that describes the relation of its children (<span id="S1.p3.3.1" class="ltx_text ltx_font_italic">e</span>.<span id="S1.p3.3.2" class="ltx_text ltx_font_italic">g</span>.<em id="S1.p3.3.3" class="ltx_emph ltx_font_italic">color</em> <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="S1.p3.1.m1.1a"><mo stretchy="false" id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\leftarrow</annotation></semantics></math> <em id="S1.p3.3.4" class="ltx_emph ltx_font_italic">is</em>, <em id="S1.p3.3.5" class="ltx_emph ltx_font_italic">is</em><math id="S1.p3.2.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S1.p3.2.m2.1a"><mo stretchy="false" id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><ci id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">\rightarrow</annotation></semantics></math><em id="S1.p3.3.6" class="ltx_emph ltx_font_italic">nose</em>) or a word described by its child (<span id="S1.p3.3.7" class="ltx_text ltx_font_italic">e</span>.<span id="S1.p3.3.8" class="ltx_text ltx_font_italic">g</span>.<em id="S1.p3.3.9" class="ltx_emph ltx_font_italic">furthest</em><math id="S1.p3.3.m3.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S1.p3.3.m3.1a"><mo stretchy="false" id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><ci id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">\rightarrow</annotation></semantics></math><em id="S1.p3.3.10" class="ltx_emph ltx_font_italic">object</em>). We refer to the first set as a clausal predicate relation, which describes how a parent node composes its children, and we refer to the second as a modifier relation, which will help specify an object more concretely given the parent-child pairs.
Thus, we design an attention module to unitize the information propagated from the modifier relations, a gated residual composition module to compose the messages from child nodes, and finally, a parse-tree-guided propagation module to transfer the node’s inner representations to its parent conditioned on the fine-grained relation types.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">First, the attention module mines visual evidence from the image feature map given the word and encoded attention maps from child nodes. We sum the encoded attention maps from child nodes and fuse the result with the image feature and word encoding. Then, we perform an attention operation on the fused hidden map to extract new local visual evidence for the current node.
Second, two gated residual composition modules separately integrate both the mined local visual evidence and the attention map with the child nodes. To retain the information from an arbitrary number of child nodes, the module sums over the child nodes and learns a gate and a residual that will forget and update the hidden representations. Finally, the parse-tree-guided propagation module transforms the composed visual hidden representation and the attention hidden representation based on a head-dependent relation type and propagates the output message to the parent nodes. This edge-dependent module is capable of learning to encode how much of a hidden vector should be persevered given a specific head-dependent type. Thus, the gated residual composition module of parent nodes can forget a previous message if necessary. The hidden and attention output message of the root node will pass through a multilayer perceptron to predict the final answer.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">A preliminary version of this work is published in CVPR2018. In this work, we inherit the idea of reasoning along the dependency parse tree, but we redevelop both modules such that they depend on specific types of relations rather than on a coarse-grained modifier relation and a clausal predicate relation. Furthermore, to improve the performance on question types of “count” and “compare number”, we compose and propagate an attention map that is the same as the hidden representations. These changes involve fewer manually designed structures and thus lead to better performance and generalizability. We perform additional experiments to show the influence of redeveloped components, and we evaluate the generalizability against different tasks.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Extensive experiments show that our model can achieve state-of-the-art VQA performance on the CLEVR and FigureQA relational datasets. Moreover, the qualitative results further demonstrate the interpretability of PTGRN on collaborative reasoning over the image and language domains.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Our contributions are summarized as follows. 1) We present a general and interpretable reasoning VQA system that follows a general dependency layout composed of modifier relations and clausal predicate relations. 2) An attention module is proposed to enforce efficient visual evidence mining, a gated residual composition module is proposed for integrating knowledge of child nodes, and a parse-tree-guided propagation module is proposed to propagate knowledge along the dependency parse tree.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/1809.01810/assets/figure/overview.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="258" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>PTGRN pipeline. Each PTGRN module is composed of an attention module and two gated residual composition modules. Each node receives the encoded attention map, the hidden features from its children, and the image feature and word encoding. The attention module is employed to generate a new attention map conditioned on image features, word encodings and previous attended regions given by the child nodes. The gated residual composition module is trained to evolve a higher-level representation by dropping and integrating features of its children with local visual evidence. The edge modules transform the output attention and hidden feature according to the question encoding and the relation types (<em id="S1.F2.4.1" class="ltx_emph ltx_font_italic">nmod: nominal modifier</em>, <em id="S1.F2.5.2" class="ltx_emph ltx_font_italic">dobj: direct object</em> and <em id="S1.F2.6.3" class="ltx_emph ltx_font_italic">nsubj: nominal subject</em>). The blue arrows indicate the propagation process of the attention map, and the yellow arrows represent the process of the visual hidden representation.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Works</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">Visual question answering.</em>  The VQA task requires coreasoning over both image and text to infer the correct answer.
The baseline method proposed in the VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> to solve this task uses a convolutional neural network (CNN)-long short-term memory (LSTM)-based architecture, which consists of a CNN to extract image features and an LSTM to encode the question features. The method combines these two features to predict the final answer. In recent years, a large number of works have followed this pipeline and have achieved substantial improvements over the baseline model. Among these works, the attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and the joint embedding of image and question representation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> have been widely studied. The attention mechanism learns to focus on the most discriminative subregion rather than the whole image, providing a certain extent of reasoning to the answer. Different attention methods, such as stacked attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and coattention between question and image on different levels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> consistently improve the performance of the VQA task. For multimodal joint embedding, Fukui <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, Kim <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and Hedi <em id="S2.p1.1.4" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> exploited the compact bilinear method to fuse the embedding of image and question and incorporate the attention mechanism to further improve performance.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">However, some recently proposed works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> have shown that the promising performance of these deep models might be achieved by exploiting the dataset bias. It is possible to perform equally well by memorizing the question-answer (QA) pairs or encoding the question with the bag-of-words method. To address this concern, newer datasets have been released recently. The VQAv2 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> was proposed to eliminate data biases by balancing QA pairs. The CLEVR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> dataset consists of synthetic images and provides more complex questions that involve multiple objects. This dataset has also balanced the answer distribution to suppress the data bias.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><em id="S2.p3.1.1" class="ltx_emph ltx_font_italic">Reasoning model.</em>  Some prior works attempted to explicitly incorporate the knowledge into the network structure. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> encoded both images and questions into discrete vectors, such as image attributes or database queries. These vectors enable the model to query external data sources for common knowledge and basic factual knowledge to answer questions. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> actively acquired predefined types of evidence to obtain external information and predict answers. Other recent works proposed networks to handle compositional reasoning. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> augmented a differentiable memory and encoded long-term knowledge to infer answers. The neural reasoning network was recently proposed to address compositional visual reasoning. Rather than using a fixed structure to predict the answer to every question, this line of work assembles a structure layout for different questions into predefined subtasks.
Then, a set of neural modules is designed to solve a particular subtask.
Some representative works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> used the sequence-to-sequence recurrent neural network (RNN) to predict the postorder of the layout and jointly trained the RNN and the neural module on the CLEVR dataset by using reinforcement learning or expectation maximization. However, RNN training requires ground-truth layouts for supervision. The performance drops rapidly on CLEVR if ground-truth layouts are not used.
On the VQA dataset, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> generated layouts based on dependency parsing. These three works first filter the set of dependencies to those connected to the wh-word at a certain distance. Then, they applied predefined modules to the remaining words to generate their inference layout. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> further used the generated layouts as supervision to train an RNN layout parser. The parse tree filter and module assignment include too many manually designed rules and thus it is difficult to generalize across tasks. Our work intends to address this problem by applying a modular network to the raw parse tree.
More recently, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> proposed an explicitly interpretable modular network by restricting the modules to pass only attention masks. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> converted both question and images into symbolic representations and executed symbolic program for reasoning. These works rely on ground-truth layouts in CLEVR but achieve high accuracy and interpretable results.
In addition to the tree-structured layout, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> performed sequential reasoning with augmented memory. At each step, a time-dependent module reads the memory based on both the question and the image and writes a newly generated encoding to the memory for answer prediction.
Different from these works, our model intends to achieve similar interpretable compositional reasoning on tree structures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> without ground-truth layouts or manually designed rules <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p"><em id="S2.p4.1.1" class="ltx_emph ltx_font_italic">Reasoning with counting-like questions.</em>  Counting the objects in an image has been studied for years. Lempitsky and Zisserman <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> learned to produce a density map for counting.  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> exploited a convolution network to estimate density and count target objects.
Zhang <em id="S2.p4.1.2" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> studied the problem of salient object subitizing, which recognizes the number of salient objects when only a few objects are present.
Chattopadhyay <em id="S2.p4.1.3" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> further extended this approach by employing a divide and conquer strategy; they divided the image into subregions, counted within the regions individually, and combined the results.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">However, the counting problem has been infrequently addressed in VQA. Anderson <em id="S2.p5.1.1" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> improved the “counting” question accuracy on VQAv2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> by first training an object detector on the Visual Genome dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. The pretrained detector was used to extract the objects from the VQAv2 dataset, and the attention operation was performed on candidate objects rather than the grid feature map only.
Trott <em id="S2.p5.1.2" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> followed this pipeline, representing each image as a set of detected objects. Then, they treated the counting problem as a sequential decision process by deciding which candidate object should be counted at each step. Finally, they employed reinforcement learning to train the model. However, this pipeline is limited to counting questions and cannot be easily applied to other types of questions.
Zhang <em id="S2.p5.1.3" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> reported that it is the soft attention mechanism that limits the counting capability of VQA models. If one should answer how many cats are in an image, then cats counted by the normalized attention map will have weights that sum to <math id="S2.p5.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S2.p5.1.m1.1a"><mn id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><cn type="integer" id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">1</annotation></semantics></math>. Weighted sum pooling on these cats results in a feature vector that is similar to a single cat. To resolve this problem, Zhang <em id="S2.p5.1.4" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> first generated an attention weight for each detected object; then, they performed “soft” nonmaximum suppression on the weights to count the attended objects.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p">Inspired by these observations, we separately encode and propagate the mined visual evidence and attention map. The attention map at each node will be composed with its children’s output through a convolution GRU and will be propagated to its parent. We preserve the feature of the attended region and utilize it to predict the counting questions.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Tree-Structured Composition Reasoning Network</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span id="S3.SS1.1.1" class="ltx_text ltx_font_italic">Overview</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.4" class="ltx_p">Given free-form questions <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">Q</annotation></semantics></math> and images <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">I</annotation></semantics></math>, our proposed PTGRN model learns to predict the answers <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">y</annotation></semantics></math> and their corresponding explainable attention maps. We first generate the tree-structured layout by parsing the input question <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">Q</annotation></semantics></math> into a parse tree with an off-the-shelf universal Stanford Parser <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. We prune leaf nodes that are not nouns to reduce computational complexity.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.12" class="ltx_p">We denote the tree-structured layout as a 3-tuple <math id="S3.SS1.p2.1.m1.3" class="ltx_Math" alttext="G=(u,X,E)" display="inline"><semantics id="S3.SS1.p2.1.m1.3a"><mrow id="S3.SS1.p2.1.m1.3.4" xref="S3.SS1.p2.1.m1.3.4.cmml"><mi id="S3.SS1.p2.1.m1.3.4.2" xref="S3.SS1.p2.1.m1.3.4.2.cmml">G</mi><mo id="S3.SS1.p2.1.m1.3.4.1" xref="S3.SS1.p2.1.m1.3.4.1.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.3.4.3.2" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.3.4.3.2.1" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">u</mi><mo id="S3.SS1.p2.1.m1.3.4.3.2.2" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml">X</mi><mo id="S3.SS1.p2.1.m1.3.4.3.2.3" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.1.m1.3.3" xref="S3.SS1.p2.1.m1.3.3.cmml">E</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.3.4.3.2.4" xref="S3.SS1.p2.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.3b"><apply id="S3.SS1.p2.1.m1.3.4.cmml" xref="S3.SS1.p2.1.m1.3.4"><eq id="S3.SS1.p2.1.m1.3.4.1.cmml" xref="S3.SS1.p2.1.m1.3.4.1"></eq><ci id="S3.SS1.p2.1.m1.3.4.2.cmml" xref="S3.SS1.p2.1.m1.3.4.2">𝐺</ci><vector id="S3.SS1.p2.1.m1.3.4.3.1.cmml" xref="S3.SS1.p2.1.m1.3.4.3.2"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑢</ci><ci id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2">𝑋</ci><ci id="S3.SS1.p2.1.m1.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3">𝐸</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.3c">G=(u,X,E)</annotation></semantics></math>, and <math id="S3.SS1.p2.2.m2.2" class="ltx_Math" alttext="u=(v,q)" display="inline"><semantics id="S3.SS1.p2.2.m2.2a"><mrow id="S3.SS1.p2.2.m2.2.3" xref="S3.SS1.p2.2.m2.2.3.cmml"><mi id="S3.SS1.p2.2.m2.2.3.2" xref="S3.SS1.p2.2.m2.2.3.2.cmml">u</mi><mo id="S3.SS1.p2.2.m2.2.3.1" xref="S3.SS1.p2.2.m2.2.3.1.cmml">=</mo><mrow id="S3.SS1.p2.2.m2.2.3.3.2" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.2.3.3.2.1" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">v</mi><mo id="S3.SS1.p2.2.m2.2.3.3.2.2" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.2.m2.2.2" xref="S3.SS1.p2.2.m2.2.2.cmml">q</mi><mo stretchy="false" id="S3.SS1.p2.2.m2.2.3.3.2.3" xref="S3.SS1.p2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b"><apply id="S3.SS1.p2.2.m2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.3"><eq id="S3.SS1.p2.2.m2.2.3.1.cmml" xref="S3.SS1.p2.2.m2.2.3.1"></eq><ci id="S3.SS1.p2.2.m2.2.3.2.cmml" xref="S3.SS1.p2.2.m2.2.3.2">𝑢</ci><interval closure="open" id="S3.SS1.p2.2.m2.2.3.3.1.cmml" xref="S3.SS1.p2.2.m2.2.3.3.2"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑣</ci><ci id="S3.SS1.p2.2.m2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2">𝑞</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">u=(v,q)</annotation></semantics></math> represents the global attributes that contain the image feature <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">v</annotation></semantics></math> and the question encoding <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">q</annotation></semantics></math>. <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="X=\{w_{i}\}_{i=1:N}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">X</mi><mo id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">=</mo><msub id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml"><mrow id="S3.SS1.p2.5.m5.1.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.1.1.2" xref="S3.SS1.p2.5.m5.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.5.m5.1.1.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.1.1.1.1.2" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS1.p2.5.m5.1.1.1.1.1.1.3" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.1.1.3" xref="S3.SS1.p2.5.m5.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.5.m5.1.1.1.3" xref="S3.SS1.p2.5.m5.1.1.1.3.cmml"><mrow id="S3.SS1.p2.5.m5.1.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.1.3.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.1.3.2.2" xref="S3.SS1.p2.5.m5.1.1.1.3.2.2.cmml">i</mi><mo id="S3.SS1.p2.5.m5.1.1.1.3.2.1" xref="S3.SS1.p2.5.m5.1.1.1.3.2.1.cmml">=</mo><mn id="S3.SS1.p2.5.m5.1.1.1.3.2.3" xref="S3.SS1.p2.5.m5.1.1.1.3.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.5.m5.1.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.1.3.1.cmml">:</mo><mi id="S3.SS1.p2.5.m5.1.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.1.3.3.cmml">N</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><eq id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2"></eq><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑋</ci><apply id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1">subscript</csymbol><set id="S3.SS1.p2.5.m5.1.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1"><apply id="S3.SS1.p2.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS1.p2.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p2.5.m5.1.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.1.3"><ci id="S3.SS1.p2.5.m5.1.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.3.1">:</ci><apply id="S3.SS1.p2.5.m5.1.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.3.2"><eq id="S3.SS1.p2.5.m5.1.1.1.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.3.2.1"></eq><ci id="S3.SS1.p2.5.m5.1.1.1.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.1.3.2.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.1.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.1.3.2.3">1</cn></apply><ci id="S3.SS1.p2.5.m5.1.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.1.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">X=\{w_{i}\}_{i=1:N}</annotation></semantics></math> represents the nodes in the parsed tree, and <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">N</annotation></semantics></math> is the number of nodes. Each node is associated with word encoding <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">w</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝑤</ci><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">w_{i}</annotation></semantics></math> in the origin question <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">Q</annotation></semantics></math>. <math id="S3.SS1.p2.9.m9.5" class="ltx_Math" alttext="E=\{e_{i,j}\}_{i,j=1:N}" display="inline"><semantics id="S3.SS1.p2.9.m9.5a"><mrow id="S3.SS1.p2.9.m9.5.5" xref="S3.SS1.p2.9.m9.5.5.cmml"><mi id="S3.SS1.p2.9.m9.5.5.3" xref="S3.SS1.p2.9.m9.5.5.3.cmml">E</mi><mo id="S3.SS1.p2.9.m9.5.5.2" xref="S3.SS1.p2.9.m9.5.5.2.cmml">=</mo><msub id="S3.SS1.p2.9.m9.5.5.1" xref="S3.SS1.p2.9.m9.5.5.1.cmml"><mrow id="S3.SS1.p2.9.m9.5.5.1.1.1" xref="S3.SS1.p2.9.m9.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.9.m9.5.5.1.1.1.2" xref="S3.SS1.p2.9.m9.5.5.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.9.m9.5.5.1.1.1.1" xref="S3.SS1.p2.9.m9.5.5.1.1.1.1.cmml"><mi id="S3.SS1.p2.9.m9.5.5.1.1.1.1.2" xref="S3.SS1.p2.9.m9.5.5.1.1.1.1.2.cmml">e</mi><mrow id="S3.SS1.p2.9.m9.2.2.2.4" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml"><mi id="S3.SS1.p2.9.m9.1.1.1.1" xref="S3.SS1.p2.9.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.9.m9.2.2.2.4.1" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.9.m9.2.2.2.2" xref="S3.SS1.p2.9.m9.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p2.9.m9.5.5.1.1.1.3" xref="S3.SS1.p2.9.m9.5.5.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.9.m9.4.4.2" xref="S3.SS1.p2.9.m9.4.4.2.cmml"><mrow id="S3.SS1.p2.9.m9.4.4.2.4" xref="S3.SS1.p2.9.m9.4.4.2.4.cmml"><mrow id="S3.SS1.p2.9.m9.4.4.2.4.2.2" xref="S3.SS1.p2.9.m9.4.4.2.4.2.1.cmml"><mi id="S3.SS1.p2.9.m9.3.3.1.1" xref="S3.SS1.p2.9.m9.3.3.1.1.cmml">i</mi><mo id="S3.SS1.p2.9.m9.4.4.2.4.2.2.1" xref="S3.SS1.p2.9.m9.4.4.2.4.2.1.cmml">,</mo><mi id="S3.SS1.p2.9.m9.4.4.2.2" xref="S3.SS1.p2.9.m9.4.4.2.2.cmml">j</mi></mrow><mo id="S3.SS1.p2.9.m9.4.4.2.4.1" xref="S3.SS1.p2.9.m9.4.4.2.4.1.cmml">=</mo><mn id="S3.SS1.p2.9.m9.4.4.2.4.3" xref="S3.SS1.p2.9.m9.4.4.2.4.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.9.m9.4.4.2.3" xref="S3.SS1.p2.9.m9.4.4.2.3.cmml">:</mo><mi id="S3.SS1.p2.9.m9.4.4.2.5" xref="S3.SS1.p2.9.m9.4.4.2.5.cmml">N</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.5b"><apply id="S3.SS1.p2.9.m9.5.5.cmml" xref="S3.SS1.p2.9.m9.5.5"><eq id="S3.SS1.p2.9.m9.5.5.2.cmml" xref="S3.SS1.p2.9.m9.5.5.2"></eq><ci id="S3.SS1.p2.9.m9.5.5.3.cmml" xref="S3.SS1.p2.9.m9.5.5.3">𝐸</ci><apply id="S3.SS1.p2.9.m9.5.5.1.cmml" xref="S3.SS1.p2.9.m9.5.5.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.5.5.1.2.cmml" xref="S3.SS1.p2.9.m9.5.5.1">subscript</csymbol><set id="S3.SS1.p2.9.m9.5.5.1.1.2.cmml" xref="S3.SS1.p2.9.m9.5.5.1.1.1"><apply id="S3.SS1.p2.9.m9.5.5.1.1.1.1.cmml" xref="S3.SS1.p2.9.m9.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.5.5.1.1.1.1.1.cmml" xref="S3.SS1.p2.9.m9.5.5.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.5.5.1.1.1.1.2.cmml" xref="S3.SS1.p2.9.m9.5.5.1.1.1.1.2">𝑒</ci><list id="S3.SS1.p2.9.m9.2.2.2.3.cmml" xref="S3.SS1.p2.9.m9.2.2.2.4"><ci id="S3.SS1.p2.9.m9.1.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1.1">𝑖</ci><ci id="S3.SS1.p2.9.m9.2.2.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2">𝑗</ci></list></apply></set><apply id="S3.SS1.p2.9.m9.4.4.2.cmml" xref="S3.SS1.p2.9.m9.4.4.2"><ci id="S3.SS1.p2.9.m9.4.4.2.3.cmml" xref="S3.SS1.p2.9.m9.4.4.2.3">:</ci><apply id="S3.SS1.p2.9.m9.4.4.2.4.cmml" xref="S3.SS1.p2.9.m9.4.4.2.4"><eq id="S3.SS1.p2.9.m9.4.4.2.4.1.cmml" xref="S3.SS1.p2.9.m9.4.4.2.4.1"></eq><list id="S3.SS1.p2.9.m9.4.4.2.4.2.1.cmml" xref="S3.SS1.p2.9.m9.4.4.2.4.2.2"><ci id="S3.SS1.p2.9.m9.3.3.1.1.cmml" xref="S3.SS1.p2.9.m9.3.3.1.1">𝑖</ci><ci id="S3.SS1.p2.9.m9.4.4.2.2.cmml" xref="S3.SS1.p2.9.m9.4.4.2.2">𝑗</ci></list><cn type="integer" id="S3.SS1.p2.9.m9.4.4.2.4.3.cmml" xref="S3.SS1.p2.9.m9.4.4.2.4.3">1</cn></apply><ci id="S3.SS1.p2.9.m9.4.4.2.5.cmml" xref="S3.SS1.p2.9.m9.4.4.2.5">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.5c">E=\{e_{i,j}\}_{i,j=1:N}</annotation></semantics></math> represents the set of edges in the parsed tree, and <math id="S3.SS1.p2.10.m10.2" class="ltx_Math" alttext="e_{i,j}" display="inline"><semantics id="S3.SS1.p2.10.m10.2a"><msub id="S3.SS1.p2.10.m10.2.3" xref="S3.SS1.p2.10.m10.2.3.cmml"><mi id="S3.SS1.p2.10.m10.2.3.2" xref="S3.SS1.p2.10.m10.2.3.2.cmml">e</mi><mrow id="S3.SS1.p2.10.m10.2.2.2.4" xref="S3.SS1.p2.10.m10.2.2.2.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.10.m10.2.2.2.4.1" xref="S3.SS1.p2.10.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.10.m10.2.2.2.2" xref="S3.SS1.p2.10.m10.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.2b"><apply id="S3.SS1.p2.10.m10.2.3.cmml" xref="S3.SS1.p2.10.m10.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.2.3.1.cmml" xref="S3.SS1.p2.10.m10.2.3">subscript</csymbol><ci id="S3.SS1.p2.10.m10.2.3.2.cmml" xref="S3.SS1.p2.10.m10.2.3.2">𝑒</ci><list id="S3.SS1.p2.10.m10.2.2.2.3.cmml" xref="S3.SS1.p2.10.m10.2.2.2.4"><ci id="S3.SS1.p2.10.m10.1.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1">𝑖</ci><ci id="S3.SS1.p2.10.m10.2.2.2.2.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.2c">e_{i,j}</annotation></semantics></math> denotes the edge type between head node <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><mi id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">j</annotation></semantics></math> and its dependent node <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><mi id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><ci id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">i</annotation></semantics></math> in the dependency parse tree.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.5" class="ltx_p">We then perform bottom-up visual question reasoning on the parse tree. Specifically, the image feature <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">v</annotation></semantics></math> is extracted from each image via any CNN pretrained on ImageNet (<span id="S3.SS1.p3.5.1" class="ltx_text ltx_font_italic">e</span>.<span id="S3.SS1.p3.5.2" class="ltx_text ltx_font_italic">g</span>., conv5 features from ResNet-152 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> or conv4 features from ResNet-101 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>). The word encoding <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">w</annotation></semantics></math> is obtained with Bi-GRU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. Each word in the question is first embedded as a <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><cn type="integer" id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">200</annotation></semantics></math>-dimensional vector, and then the words are fed into a bidirectional GRU. The final word encoding <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">w</annotation></semantics></math> is the hidden vector of Bi-GRU at its corresponding position, and the hidden vector at the end of the question is extracted as question encoding <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">q</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.14" class="ltx_p">A node <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">j</annotation></semantics></math> has several inputs: the image feature <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">v</annotation></semantics></math>, the question encoding <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">q</annotation></semantics></math>, the word encoding <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="w_{j}" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><msub id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><mi id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">w</mi><mi id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2">𝑤</ci><ci id="S3.SS1.p4.4.m4.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">w_{j}</annotation></semantics></math>, and the messages <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="\{m_{ij}\}" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mrow id="S3.SS1.p4.5.m5.1.1.1" xref="S3.SS1.p4.5.m5.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.5.m5.1.1.1.2" xref="S3.SS1.p4.5.m5.1.1.2.cmml">{</mo><msub id="S3.SS1.p4.5.m5.1.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.1.cmml"><mi id="S3.SS1.p4.5.m5.1.1.1.1.2" xref="S3.SS1.p4.5.m5.1.1.1.1.2.cmml">m</mi><mrow id="S3.SS1.p4.5.m5.1.1.1.1.3" xref="S3.SS1.p4.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS1.p4.5.m5.1.1.1.1.3.2" xref="S3.SS1.p4.5.m5.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.5.m5.1.1.1.1.3.1" xref="S3.SS1.p4.5.m5.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.5.m5.1.1.1.1.3.3" xref="S3.SS1.p4.5.m5.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p4.5.m5.1.1.1.3" xref="S3.SS1.p4.5.m5.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><set id="S3.SS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.1"><apply id="S3.SS1.p4.5.m5.1.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.5.m5.1.1.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.2">𝑚</ci><apply id="S3.SS1.p4.5.m5.1.1.1.1.3.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.3"><times id="S3.SS1.p4.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.3.1"></times><ci id="S3.SS1.p4.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p4.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.3.3">𝑗</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">\{m_{ij}\}</annotation></semantics></math> from its input edge <math id="S3.SS1.p4.6.m6.1" class="ltx_Math" alttext="\{e_{ij}\}" display="inline"><semantics id="S3.SS1.p4.6.m6.1a"><mrow id="S3.SS1.p4.6.m6.1.1.1" xref="S3.SS1.p4.6.m6.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.6.m6.1.1.1.2" xref="S3.SS1.p4.6.m6.1.1.2.cmml">{</mo><msub id="S3.SS1.p4.6.m6.1.1.1.1" xref="S3.SS1.p4.6.m6.1.1.1.1.cmml"><mi id="S3.SS1.p4.6.m6.1.1.1.1.2" xref="S3.SS1.p4.6.m6.1.1.1.1.2.cmml">e</mi><mrow id="S3.SS1.p4.6.m6.1.1.1.1.3" xref="S3.SS1.p4.6.m6.1.1.1.1.3.cmml"><mi id="S3.SS1.p4.6.m6.1.1.1.1.3.2" xref="S3.SS1.p4.6.m6.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.6.m6.1.1.1.1.3.1" xref="S3.SS1.p4.6.m6.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.6.m6.1.1.1.1.3.3" xref="S3.SS1.p4.6.m6.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p4.6.m6.1.1.1.3" xref="S3.SS1.p4.6.m6.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><set id="S3.SS1.p4.6.m6.1.1.2.cmml" xref="S3.SS1.p4.6.m6.1.1.1"><apply id="S3.SS1.p4.6.m6.1.1.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.6.m6.1.1.1.1.2.cmml" xref="S3.SS1.p4.6.m6.1.1.1.1.2">𝑒</ci><apply id="S3.SS1.p4.6.m6.1.1.1.1.3.cmml" xref="S3.SS1.p4.6.m6.1.1.1.1.3"><times id="S3.SS1.p4.6.m6.1.1.1.1.3.1.cmml" xref="S3.SS1.p4.6.m6.1.1.1.1.3.1"></times><ci id="S3.SS1.p4.6.m6.1.1.1.1.3.2.cmml" xref="S3.SS1.p4.6.m6.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p4.6.m6.1.1.1.1.3.3.cmml" xref="S3.SS1.p4.6.m6.1.1.1.1.3.3">𝑗</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">\{e_{ij}\}</annotation></semantics></math>. The message <math id="S3.SS1.p4.7.m7.2" class="ltx_Math" alttext="m_{ij}=[m^{a}_{ij},m^{h}_{ij}]" display="inline"><semantics id="S3.SS1.p4.7.m7.2a"><mrow id="S3.SS1.p4.7.m7.2.2" xref="S3.SS1.p4.7.m7.2.2.cmml"><msub id="S3.SS1.p4.7.m7.2.2.4" xref="S3.SS1.p4.7.m7.2.2.4.cmml"><mi id="S3.SS1.p4.7.m7.2.2.4.2" xref="S3.SS1.p4.7.m7.2.2.4.2.cmml">m</mi><mrow id="S3.SS1.p4.7.m7.2.2.4.3" xref="S3.SS1.p4.7.m7.2.2.4.3.cmml"><mi id="S3.SS1.p4.7.m7.2.2.4.3.2" xref="S3.SS1.p4.7.m7.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.7.m7.2.2.4.3.1" xref="S3.SS1.p4.7.m7.2.2.4.3.1.cmml">​</mo><mi id="S3.SS1.p4.7.m7.2.2.4.3.3" xref="S3.SS1.p4.7.m7.2.2.4.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p4.7.m7.2.2.3" xref="S3.SS1.p4.7.m7.2.2.3.cmml">=</mo><mrow id="S3.SS1.p4.7.m7.2.2.2.2" xref="S3.SS1.p4.7.m7.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p4.7.m7.2.2.2.2.3" xref="S3.SS1.p4.7.m7.2.2.2.3.cmml">[</mo><msubsup id="S3.SS1.p4.7.m7.1.1.1.1.1" xref="S3.SS1.p4.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.7.m7.1.1.1.1.1.2.2" xref="S3.SS1.p4.7.m7.1.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS1.p4.7.m7.1.1.1.1.1.3" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p4.7.m7.1.1.1.1.1.3.2" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.7.m7.1.1.1.1.1.3.1" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.7.m7.1.1.1.1.1.3.3" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS1.p4.7.m7.1.1.1.1.1.2.3" xref="S3.SS1.p4.7.m7.1.1.1.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.SS1.p4.7.m7.2.2.2.2.4" xref="S3.SS1.p4.7.m7.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p4.7.m7.2.2.2.2.2" xref="S3.SS1.p4.7.m7.2.2.2.2.2.cmml"><mi id="S3.SS1.p4.7.m7.2.2.2.2.2.2.2" xref="S3.SS1.p4.7.m7.2.2.2.2.2.2.2.cmml">m</mi><mrow id="S3.SS1.p4.7.m7.2.2.2.2.2.3" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p4.7.m7.2.2.2.2.2.3.2" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.7.m7.2.2.2.2.2.3.1" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p4.7.m7.2.2.2.2.2.3.3" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3.3.cmml">j</mi></mrow><mi id="S3.SS1.p4.7.m7.2.2.2.2.2.2.3" xref="S3.SS1.p4.7.m7.2.2.2.2.2.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="S3.SS1.p4.7.m7.2.2.2.2.5" xref="S3.SS1.p4.7.m7.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m7.2b"><apply id="S3.SS1.p4.7.m7.2.2.cmml" xref="S3.SS1.p4.7.m7.2.2"><eq id="S3.SS1.p4.7.m7.2.2.3.cmml" xref="S3.SS1.p4.7.m7.2.2.3"></eq><apply id="S3.SS1.p4.7.m7.2.2.4.cmml" xref="S3.SS1.p4.7.m7.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m7.2.2.4.1.cmml" xref="S3.SS1.p4.7.m7.2.2.4">subscript</csymbol><ci id="S3.SS1.p4.7.m7.2.2.4.2.cmml" xref="S3.SS1.p4.7.m7.2.2.4.2">𝑚</ci><apply id="S3.SS1.p4.7.m7.2.2.4.3.cmml" xref="S3.SS1.p4.7.m7.2.2.4.3"><times id="S3.SS1.p4.7.m7.2.2.4.3.1.cmml" xref="S3.SS1.p4.7.m7.2.2.4.3.1"></times><ci id="S3.SS1.p4.7.m7.2.2.4.3.2.cmml" xref="S3.SS1.p4.7.m7.2.2.4.3.2">𝑖</ci><ci id="S3.SS1.p4.7.m7.2.2.4.3.3.cmml" xref="S3.SS1.p4.7.m7.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="closed" id="S3.SS1.p4.7.m7.2.2.2.3.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2"><apply id="S3.SS1.p4.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p4.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m7.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p4.7.m7.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS1.p4.7.m7.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS1.p4.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3"><times id="S3.SS1.p4.7.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p4.7.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p4.7.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p4.7.m7.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p4.7.m7.2.2.2.2.2.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m7.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p4.7.m7.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m7.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p4.7.m7.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2.2.2">𝑚</ci><ci id="S3.SS1.p4.7.m7.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2.2.3">ℎ</ci></apply><apply id="S3.SS1.p4.7.m7.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3"><times id="S3.SS1.p4.7.m7.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3.1"></times><ci id="S3.SS1.p4.7.m7.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3.2">𝑖</ci><ci id="S3.SS1.p4.7.m7.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p4.7.m7.2.2.2.2.2.3.3">𝑗</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m7.2c">m_{ij}=[m^{a}_{ij},m^{h}_{ij}]</annotation></semantics></math> includes the message <math id="S3.SS1.p4.8.m8.1" class="ltx_Math" alttext="m^{a}_{ij}" display="inline"><semantics id="S3.SS1.p4.8.m8.1a"><msubsup id="S3.SS1.p4.8.m8.1.1" xref="S3.SS1.p4.8.m8.1.1.cmml"><mi id="S3.SS1.p4.8.m8.1.1.2.2" xref="S3.SS1.p4.8.m8.1.1.2.2.cmml">m</mi><mrow id="S3.SS1.p4.8.m8.1.1.3" xref="S3.SS1.p4.8.m8.1.1.3.cmml"><mi id="S3.SS1.p4.8.m8.1.1.3.2" xref="S3.SS1.p4.8.m8.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m8.1.1.3.1" xref="S3.SS1.p4.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.8.m8.1.1.3.3" xref="S3.SS1.p4.8.m8.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS1.p4.8.m8.1.1.2.3" xref="S3.SS1.p4.8.m8.1.1.2.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m8.1b"><apply id="S3.SS1.p4.8.m8.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1">subscript</csymbol><apply id="S3.SS1.p4.8.m8.1.1.2.cmml" xref="S3.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.2.1.cmml" xref="S3.SS1.p4.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.p4.8.m8.1.1.2.2.cmml" xref="S3.SS1.p4.8.m8.1.1.2.2">𝑚</ci><ci id="S3.SS1.p4.8.m8.1.1.2.3.cmml" xref="S3.SS1.p4.8.m8.1.1.2.3">𝑎</ci></apply><apply id="S3.SS1.p4.8.m8.1.1.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3"><times id="S3.SS1.p4.8.m8.1.1.3.1.cmml" xref="S3.SS1.p4.8.m8.1.1.3.1"></times><ci id="S3.SS1.p4.8.m8.1.1.3.2.cmml" xref="S3.SS1.p4.8.m8.1.1.3.2">𝑖</ci><ci id="S3.SS1.p4.8.m8.1.1.3.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m8.1c">m^{a}_{ij}</annotation></semantics></math> for the attention map and <math id="S3.SS1.p4.9.m9.1" class="ltx_Math" alttext="m^{h}_{ij}" display="inline"><semantics id="S3.SS1.p4.9.m9.1a"><msubsup id="S3.SS1.p4.9.m9.1.1" xref="S3.SS1.p4.9.m9.1.1.cmml"><mi id="S3.SS1.p4.9.m9.1.1.2.2" xref="S3.SS1.p4.9.m9.1.1.2.2.cmml">m</mi><mrow id="S3.SS1.p4.9.m9.1.1.3" xref="S3.SS1.p4.9.m9.1.1.3.cmml"><mi id="S3.SS1.p4.9.m9.1.1.3.2" xref="S3.SS1.p4.9.m9.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.9.m9.1.1.3.1" xref="S3.SS1.p4.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.9.m9.1.1.3.3" xref="S3.SS1.p4.9.m9.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS1.p4.9.m9.1.1.2.3" xref="S3.SS1.p4.9.m9.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m9.1b"><apply id="S3.SS1.p4.9.m9.1.1.cmml" xref="S3.SS1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m9.1.1.1.cmml" xref="S3.SS1.p4.9.m9.1.1">subscript</csymbol><apply id="S3.SS1.p4.9.m9.1.1.2.cmml" xref="S3.SS1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m9.1.1.2.1.cmml" xref="S3.SS1.p4.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.p4.9.m9.1.1.2.2.cmml" xref="S3.SS1.p4.9.m9.1.1.2.2">𝑚</ci><ci id="S3.SS1.p4.9.m9.1.1.2.3.cmml" xref="S3.SS1.p4.9.m9.1.1.2.3">ℎ</ci></apply><apply id="S3.SS1.p4.9.m9.1.1.3.cmml" xref="S3.SS1.p4.9.m9.1.1.3"><times id="S3.SS1.p4.9.m9.1.1.3.1.cmml" xref="S3.SS1.p4.9.m9.1.1.3.1"></times><ci id="S3.SS1.p4.9.m9.1.1.3.2.cmml" xref="S3.SS1.p4.9.m9.1.1.3.2">𝑖</ci><ci id="S3.SS1.p4.9.m9.1.1.3.3.cmml" xref="S3.SS1.p4.9.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m9.1c">m^{h}_{ij}</annotation></semantics></math> for hidden representation. It generates the attention map <math id="S3.SS1.p4.10.m10.1" class="ltx_Math" alttext="att_{j}" display="inline"><semantics id="S3.SS1.p4.10.m10.1a"><mrow id="S3.SS1.p4.10.m10.1.1" xref="S3.SS1.p4.10.m10.1.1.cmml"><mi id="S3.SS1.p4.10.m10.1.1.2" xref="S3.SS1.p4.10.m10.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.10.m10.1.1.1" xref="S3.SS1.p4.10.m10.1.1.1.cmml">​</mo><mi id="S3.SS1.p4.10.m10.1.1.3" xref="S3.SS1.p4.10.m10.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.10.m10.1.1.1a" xref="S3.SS1.p4.10.m10.1.1.1.cmml">​</mo><msub id="S3.SS1.p4.10.m10.1.1.4" xref="S3.SS1.p4.10.m10.1.1.4.cmml"><mi id="S3.SS1.p4.10.m10.1.1.4.2" xref="S3.SS1.p4.10.m10.1.1.4.2.cmml">t</mi><mi id="S3.SS1.p4.10.m10.1.1.4.3" xref="S3.SS1.p4.10.m10.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.m10.1b"><apply id="S3.SS1.p4.10.m10.1.1.cmml" xref="S3.SS1.p4.10.m10.1.1"><times id="S3.SS1.p4.10.m10.1.1.1.cmml" xref="S3.SS1.p4.10.m10.1.1.1"></times><ci id="S3.SS1.p4.10.m10.1.1.2.cmml" xref="S3.SS1.p4.10.m10.1.1.2">𝑎</ci><ci id="S3.SS1.p4.10.m10.1.1.3.cmml" xref="S3.SS1.p4.10.m10.1.1.3">𝑡</ci><apply id="S3.SS1.p4.10.m10.1.1.4.cmml" xref="S3.SS1.p4.10.m10.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p4.10.m10.1.1.4.1.cmml" xref="S3.SS1.p4.10.m10.1.1.4">subscript</csymbol><ci id="S3.SS1.p4.10.m10.1.1.4.2.cmml" xref="S3.SS1.p4.10.m10.1.1.4.2">𝑡</ci><ci id="S3.SS1.p4.10.m10.1.1.4.3.cmml" xref="S3.SS1.p4.10.m10.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.m10.1c">att_{j}</annotation></semantics></math> with the attention module <math id="S3.SS1.p4.11.m11.1" class="ltx_Math" alttext="f_{a}" display="inline"><semantics id="S3.SS1.p4.11.m11.1a"><msub id="S3.SS1.p4.11.m11.1.1" xref="S3.SS1.p4.11.m11.1.1.cmml"><mi id="S3.SS1.p4.11.m11.1.1.2" xref="S3.SS1.p4.11.m11.1.1.2.cmml">f</mi><mi id="S3.SS1.p4.11.m11.1.1.3" xref="S3.SS1.p4.11.m11.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.11.m11.1b"><apply id="S3.SS1.p4.11.m11.1.1.cmml" xref="S3.SS1.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.11.m11.1.1.1.cmml" xref="S3.SS1.p4.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p4.11.m11.1.1.2.cmml" xref="S3.SS1.p4.11.m11.1.1.2">𝑓</ci><ci id="S3.SS1.p4.11.m11.1.1.3.cmml" xref="S3.SS1.p4.11.m11.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.11.m11.1c">f_{a}</annotation></semantics></math> as well as the hidden representation <math id="S3.SS1.p4.12.m12.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS1.p4.12.m12.1a"><msub id="S3.SS1.p4.12.m12.1.1" xref="S3.SS1.p4.12.m12.1.1.cmml"><mi id="S3.SS1.p4.12.m12.1.1.2" xref="S3.SS1.p4.12.m12.1.1.2.cmml">h</mi><mi id="S3.SS1.p4.12.m12.1.1.3" xref="S3.SS1.p4.12.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.12.m12.1b"><apply id="S3.SS1.p4.12.m12.1.1.cmml" xref="S3.SS1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.12.m12.1.1.1.cmml" xref="S3.SS1.p4.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p4.12.m12.1.1.2.cmml" xref="S3.SS1.p4.12.m12.1.1.2">ℎ</ci><ci id="S3.SS1.p4.12.m12.1.1.3.cmml" xref="S3.SS1.p4.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.12.m12.1c">h_{j}</annotation></semantics></math> and the attention map encoding <math id="S3.SS1.p4.13.m13.1" class="ltx_Math" alttext="h^{att}_{j}" display="inline"><semantics id="S3.SS1.p4.13.m13.1a"><msubsup id="S3.SS1.p4.13.m13.1.1" xref="S3.SS1.p4.13.m13.1.1.cmml"><mi id="S3.SS1.p4.13.m13.1.1.2.2" xref="S3.SS1.p4.13.m13.1.1.2.2.cmml">h</mi><mi id="S3.SS1.p4.13.m13.1.1.3" xref="S3.SS1.p4.13.m13.1.1.3.cmml">j</mi><mrow id="S3.SS1.p4.13.m13.1.1.2.3" xref="S3.SS1.p4.13.m13.1.1.2.3.cmml"><mi id="S3.SS1.p4.13.m13.1.1.2.3.2" xref="S3.SS1.p4.13.m13.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.13.m13.1.1.2.3.1" xref="S3.SS1.p4.13.m13.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p4.13.m13.1.1.2.3.3" xref="S3.SS1.p4.13.m13.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.13.m13.1.1.2.3.1a" xref="S3.SS1.p4.13.m13.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p4.13.m13.1.1.2.3.4" xref="S3.SS1.p4.13.m13.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.13.m13.1b"><apply id="S3.SS1.p4.13.m13.1.1.cmml" xref="S3.SS1.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.13.m13.1.1.1.cmml" xref="S3.SS1.p4.13.m13.1.1">subscript</csymbol><apply id="S3.SS1.p4.13.m13.1.1.2.cmml" xref="S3.SS1.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.13.m13.1.1.2.1.cmml" xref="S3.SS1.p4.13.m13.1.1">superscript</csymbol><ci id="S3.SS1.p4.13.m13.1.1.2.2.cmml" xref="S3.SS1.p4.13.m13.1.1.2.2">ℎ</ci><apply id="S3.SS1.p4.13.m13.1.1.2.3.cmml" xref="S3.SS1.p4.13.m13.1.1.2.3"><times id="S3.SS1.p4.13.m13.1.1.2.3.1.cmml" xref="S3.SS1.p4.13.m13.1.1.2.3.1"></times><ci id="S3.SS1.p4.13.m13.1.1.2.3.2.cmml" xref="S3.SS1.p4.13.m13.1.1.2.3.2">𝑎</ci><ci id="S3.SS1.p4.13.m13.1.1.2.3.3.cmml" xref="S3.SS1.p4.13.m13.1.1.2.3.3">𝑡</ci><ci id="S3.SS1.p4.13.m13.1.1.2.3.4.cmml" xref="S3.SS1.p4.13.m13.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS1.p4.13.m13.1.1.3.cmml" xref="S3.SS1.p4.13.m13.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.13.m13.1c">h^{att}_{j}</annotation></semantics></math> with the gated residual composition module <math id="S3.SS1.p4.14.m14.1" class="ltx_Math" alttext="f_{h}" display="inline"><semantics id="S3.SS1.p4.14.m14.1a"><msub id="S3.SS1.p4.14.m14.1.1" xref="S3.SS1.p4.14.m14.1.1.cmml"><mi id="S3.SS1.p4.14.m14.1.1.2" xref="S3.SS1.p4.14.m14.1.1.2.cmml">f</mi><mi id="S3.SS1.p4.14.m14.1.1.3" xref="S3.SS1.p4.14.m14.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.14.m14.1b"><apply id="S3.SS1.p4.14.m14.1.1.cmml" xref="S3.SS1.p4.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.14.m14.1.1.1.cmml" xref="S3.SS1.p4.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p4.14.m14.1.1.2.cmml" xref="S3.SS1.p4.14.m14.1.1.2">𝑓</ci><ci id="S3.SS1.p4.14.m14.1.1.3.cmml" xref="S3.SS1.p4.14.m14.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.14.m14.1c">f_{h}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.9" class="ltx_p">The inputs of an edge <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="jk" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><times id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1"></times><ci id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2">𝑗</ci><ci id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">jk</annotation></semantics></math> are the hidden representation <math id="S3.SS1.p5.2.m2.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS1.p5.2.m2.1a"><msub id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml">h</mi><mi id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2">ℎ</ci><ci id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">h_{j}</annotation></semantics></math> and the attention map encoding <math id="S3.SS1.p5.3.m3.1" class="ltx_Math" alttext="h^{att}_{j}" display="inline"><semantics id="S3.SS1.p5.3.m3.1a"><msubsup id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml"><mi id="S3.SS1.p5.3.m3.1.1.2.2" xref="S3.SS1.p5.3.m3.1.1.2.2.cmml">h</mi><mi id="S3.SS1.p5.3.m3.1.1.3" xref="S3.SS1.p5.3.m3.1.1.3.cmml">j</mi><mrow id="S3.SS1.p5.3.m3.1.1.2.3" xref="S3.SS1.p5.3.m3.1.1.2.3.cmml"><mi id="S3.SS1.p5.3.m3.1.1.2.3.2" xref="S3.SS1.p5.3.m3.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.3.m3.1.1.2.3.1" xref="S3.SS1.p5.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p5.3.m3.1.1.2.3.3" xref="S3.SS1.p5.3.m3.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.3.m3.1.1.2.3.1a" xref="S3.SS1.p5.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p5.3.m3.1.1.2.3.4" xref="S3.SS1.p5.3.m3.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><apply id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">subscript</csymbol><apply id="S3.SS1.p5.3.m3.1.1.2.cmml" xref="S3.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.2.1.cmml" xref="S3.SS1.p5.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.2.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2.2">ℎ</ci><apply id="S3.SS1.p5.3.m3.1.1.2.3.cmml" xref="S3.SS1.p5.3.m3.1.1.2.3"><times id="S3.SS1.p5.3.m3.1.1.2.3.1.cmml" xref="S3.SS1.p5.3.m3.1.1.2.3.1"></times><ci id="S3.SS1.p5.3.m3.1.1.2.3.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2.3.2">𝑎</ci><ci id="S3.SS1.p5.3.m3.1.1.2.3.3.cmml" xref="S3.SS1.p5.3.m3.1.1.2.3.3">𝑡</ci><ci id="S3.SS1.p5.3.m3.1.1.2.3.4.cmml" xref="S3.SS1.p5.3.m3.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS1.p5.3.m3.1.1.3.cmml" xref="S3.SS1.p5.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">h^{att}_{j}</annotation></semantics></math> generated by node <math id="S3.SS1.p5.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p5.4.m4.1a"><mi id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><ci id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">j</annotation></semantics></math>. Given the inputs and the edge type <math id="S3.SS1.p5.5.m5.1" class="ltx_Math" alttext="e_{jk}" display="inline"><semantics id="S3.SS1.p5.5.m5.1a"><msub id="S3.SS1.p5.5.m5.1.1" xref="S3.SS1.p5.5.m5.1.1.cmml"><mi id="S3.SS1.p5.5.m5.1.1.2" xref="S3.SS1.p5.5.m5.1.1.2.cmml">e</mi><mrow id="S3.SS1.p5.5.m5.1.1.3" xref="S3.SS1.p5.5.m5.1.1.3.cmml"><mi id="S3.SS1.p5.5.m5.1.1.3.2" xref="S3.SS1.p5.5.m5.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.5.m5.1.1.3.1" xref="S3.SS1.p5.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p5.5.m5.1.1.3.3" xref="S3.SS1.p5.5.m5.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m5.1b"><apply id="S3.SS1.p5.5.m5.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m5.1.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p5.5.m5.1.1.2.cmml" xref="S3.SS1.p5.5.m5.1.1.2">𝑒</ci><apply id="S3.SS1.p5.5.m5.1.1.3.cmml" xref="S3.SS1.p5.5.m5.1.1.3"><times id="S3.SS1.p5.5.m5.1.1.3.1.cmml" xref="S3.SS1.p5.5.m5.1.1.3.1"></times><ci id="S3.SS1.p5.5.m5.1.1.3.2.cmml" xref="S3.SS1.p5.5.m5.1.1.3.2">𝑗</ci><ci id="S3.SS1.p5.5.m5.1.1.3.3.cmml" xref="S3.SS1.p5.5.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m5.1c">e_{jk}</annotation></semantics></math>, edge <math id="S3.SS1.p5.6.m6.1" class="ltx_Math" alttext="jk" display="inline"><semantics id="S3.SS1.p5.6.m6.1a"><mrow id="S3.SS1.p5.6.m6.1.1" xref="S3.SS1.p5.6.m6.1.1.cmml"><mi id="S3.SS1.p5.6.m6.1.1.2" xref="S3.SS1.p5.6.m6.1.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.6.m6.1.1.1" xref="S3.SS1.p5.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS1.p5.6.m6.1.1.3" xref="S3.SS1.p5.6.m6.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m6.1b"><apply id="S3.SS1.p5.6.m6.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1"><times id="S3.SS1.p5.6.m6.1.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1.1"></times><ci id="S3.SS1.p5.6.m6.1.1.2.cmml" xref="S3.SS1.p5.6.m6.1.1.2">𝑗</ci><ci id="S3.SS1.p5.6.m6.1.1.3.cmml" xref="S3.SS1.p5.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m6.1c">jk</annotation></semantics></math> generates the message <math id="S3.SS1.p5.7.m7.2" class="ltx_Math" alttext="[m^{a}_{jk},m^{h}_{jk}]" display="inline"><semantics id="S3.SS1.p5.7.m7.2a"><mrow id="S3.SS1.p5.7.m7.2.2.2" xref="S3.SS1.p5.7.m7.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p5.7.m7.2.2.2.3" xref="S3.SS1.p5.7.m7.2.2.3.cmml">[</mo><msubsup id="S3.SS1.p5.7.m7.1.1.1.1" xref="S3.SS1.p5.7.m7.1.1.1.1.cmml"><mi id="S3.SS1.p5.7.m7.1.1.1.1.2.2" xref="S3.SS1.p5.7.m7.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS1.p5.7.m7.1.1.1.1.3" xref="S3.SS1.p5.7.m7.1.1.1.1.3.cmml"><mi id="S3.SS1.p5.7.m7.1.1.1.1.3.2" xref="S3.SS1.p5.7.m7.1.1.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.7.m7.1.1.1.1.3.1" xref="S3.SS1.p5.7.m7.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p5.7.m7.1.1.1.1.3.3" xref="S3.SS1.p5.7.m7.1.1.1.1.3.3.cmml">k</mi></mrow><mi id="S3.SS1.p5.7.m7.1.1.1.1.2.3" xref="S3.SS1.p5.7.m7.1.1.1.1.2.3.cmml">a</mi></msubsup><mo id="S3.SS1.p5.7.m7.2.2.2.4" xref="S3.SS1.p5.7.m7.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p5.7.m7.2.2.2.2" xref="S3.SS1.p5.7.m7.2.2.2.2.cmml"><mi id="S3.SS1.p5.7.m7.2.2.2.2.2.2" xref="S3.SS1.p5.7.m7.2.2.2.2.2.2.cmml">m</mi><mrow id="S3.SS1.p5.7.m7.2.2.2.2.3" xref="S3.SS1.p5.7.m7.2.2.2.2.3.cmml"><mi id="S3.SS1.p5.7.m7.2.2.2.2.3.2" xref="S3.SS1.p5.7.m7.2.2.2.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.7.m7.2.2.2.2.3.1" xref="S3.SS1.p5.7.m7.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p5.7.m7.2.2.2.2.3.3" xref="S3.SS1.p5.7.m7.2.2.2.2.3.3.cmml">k</mi></mrow><mi id="S3.SS1.p5.7.m7.2.2.2.2.2.3" xref="S3.SS1.p5.7.m7.2.2.2.2.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="S3.SS1.p5.7.m7.2.2.2.5" xref="S3.SS1.p5.7.m7.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.7.m7.2b"><interval closure="closed" id="S3.SS1.p5.7.m7.2.2.3.cmml" xref="S3.SS1.p5.7.m7.2.2.2"><apply id="S3.SS1.p5.7.m7.1.1.1.1.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p5.7.m7.1.1.1.1.2.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m7.1.1.1.1.2.1.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p5.7.m7.1.1.1.1.2.2.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS1.p5.7.m7.1.1.1.1.2.3.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS1.p5.7.m7.1.1.1.1.3.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1.3"><times id="S3.SS1.p5.7.m7.1.1.1.1.3.1.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1.3.1"></times><ci id="S3.SS1.p5.7.m7.1.1.1.1.3.2.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1.3.2">𝑗</ci><ci id="S3.SS1.p5.7.m7.1.1.1.1.3.3.cmml" xref="S3.SS1.p5.7.m7.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS1.p5.7.m7.2.2.2.2.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m7.2.2.2.2.1.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p5.7.m7.2.2.2.2.2.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m7.2.2.2.2.2.1.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p5.7.m7.2.2.2.2.2.2.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2.2.2">𝑚</ci><ci id="S3.SS1.p5.7.m7.2.2.2.2.2.3.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2.2.3">ℎ</ci></apply><apply id="S3.SS1.p5.7.m7.2.2.2.2.3.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2.3"><times id="S3.SS1.p5.7.m7.2.2.2.2.3.1.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2.3.1"></times><ci id="S3.SS1.p5.7.m7.2.2.2.2.3.2.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2.3.2">𝑗</ci><ci id="S3.SS1.p5.7.m7.2.2.2.2.3.3.cmml" xref="S3.SS1.p5.7.m7.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.7.m7.2c">[m^{a}_{jk},m^{h}_{jk}]</annotation></semantics></math> with the parse-tree-guided propagation module <math id="S3.SS1.p5.8.m8.1" class="ltx_Math" alttext="f_{e}" display="inline"><semantics id="S3.SS1.p5.8.m8.1a"><msub id="S3.SS1.p5.8.m8.1.1" xref="S3.SS1.p5.8.m8.1.1.cmml"><mi id="S3.SS1.p5.8.m8.1.1.2" xref="S3.SS1.p5.8.m8.1.1.2.cmml">f</mi><mi id="S3.SS1.p5.8.m8.1.1.3" xref="S3.SS1.p5.8.m8.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.8.m8.1b"><apply id="S3.SS1.p5.8.m8.1.1.cmml" xref="S3.SS1.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.8.m8.1.1.1.cmml" xref="S3.SS1.p5.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p5.8.m8.1.1.2.cmml" xref="S3.SS1.p5.8.m8.1.1.2">𝑓</ci><ci id="S3.SS1.p5.8.m8.1.1.3.cmml" xref="S3.SS1.p5.8.m8.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.8.m8.1c">f_{e}</annotation></semantics></math> and transfers these messages to node <math id="S3.SS1.p5.9.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p5.9.m9.1a"><mi id="S3.SS1.p5.9.m9.1.1" xref="S3.SS1.p5.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.9.m9.1b"><ci id="S3.SS1.p5.9.m9.1.1.cmml" xref="S3.SS1.p5.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.9.m9.1c">k</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.2" class="ltx_p">We update each node from bottom to top by postorder traversing the tree. Finally, at root node <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">N</annotation></semantics></math>, <math id="S3.SS1.p6.2.m2.2" class="ltx_Math" alttext="[m^{h}_{N},m^{a}_{N}]" display="inline"><semantics id="S3.SS1.p6.2.m2.2a"><mrow id="S3.SS1.p6.2.m2.2.2.2" xref="S3.SS1.p6.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p6.2.m2.2.2.2.3" xref="S3.SS1.p6.2.m2.2.2.3.cmml">[</mo><msubsup id="S3.SS1.p6.2.m2.1.1.1.1" xref="S3.SS1.p6.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p6.2.m2.1.1.1.1.2.2" xref="S3.SS1.p6.2.m2.1.1.1.1.2.2.cmml">m</mi><mi id="S3.SS1.p6.2.m2.1.1.1.1.3" xref="S3.SS1.p6.2.m2.1.1.1.1.3.cmml">N</mi><mi id="S3.SS1.p6.2.m2.1.1.1.1.2.3" xref="S3.SS1.p6.2.m2.1.1.1.1.2.3.cmml">h</mi></msubsup><mo id="S3.SS1.p6.2.m2.2.2.2.4" xref="S3.SS1.p6.2.m2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p6.2.m2.2.2.2.2" xref="S3.SS1.p6.2.m2.2.2.2.2.cmml"><mi id="S3.SS1.p6.2.m2.2.2.2.2.2.2" xref="S3.SS1.p6.2.m2.2.2.2.2.2.2.cmml">m</mi><mi id="S3.SS1.p6.2.m2.2.2.2.2.3" xref="S3.SS1.p6.2.m2.2.2.2.2.3.cmml">N</mi><mi id="S3.SS1.p6.2.m2.2.2.2.2.2.3" xref="S3.SS1.p6.2.m2.2.2.2.2.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.SS1.p6.2.m2.2.2.2.5" xref="S3.SS1.p6.2.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.2b"><interval closure="closed" id="S3.SS1.p6.2.m2.2.2.3.cmml" xref="S3.SS1.p6.2.m2.2.2.2"><apply id="S3.SS1.p6.2.m2.1.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p6.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p6.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS1.p6.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.2.3">ℎ</ci></apply><ci id="S3.SS1.p6.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.3">𝑁</ci></apply><apply id="S3.SS1.p6.2.m2.2.2.2.2.cmml" xref="S3.SS1.p6.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p6.2.m2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p6.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p6.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p6.2.m2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p6.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p6.2.m2.2.2.2.2.2.2">𝑚</ci><ci id="S3.SS1.p6.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p6.2.m2.2.2.2.2.2.3">𝑎</ci></apply><ci id="S3.SS1.p6.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p6.2.m2.2.2.2.2.3">𝑁</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.2c">[m^{h}_{N},m^{a}_{N}]</annotation></semantics></math> are passed to a multilayer perceptron classifier to predict the answer, as shown in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/1809.01810/assets/figure/attention.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="269" height="80" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Detailed architecture of the attention module. The image feature, previously attended regions and word encoding are projected to <math id="S3.F3.3.m1.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S3.F3.3.m1.1b"><mn id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><cn type="integer" id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">2048</annotation></semantics></math>-d features. Then, they are fused by elementwise multiplication. Finally, the fused feature is projected to a <math id="S3.F3.4.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.F3.4.m2.1b"><mn id="S3.F3.4.m2.1.1" xref="S3.F3.4.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.F3.4.m2.1c"><cn type="integer" id="S3.F3.4.m2.1.1.cmml" xref="S3.F3.4.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m2.1d">1</annotation></semantics></math>-d attention map and normalized with softmax. </figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/1809.01810/assets/figure/composition.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="269" height="122" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The gated residual composition module utilizes the architecture of a gated recurrent unit to integrate the features of its children with local visual evidence or attention map. The sum of children input is considered memory, and the local visual evidence or attention map is the input at the current step.</figcaption>
</figure>
<figure id="S3.F5" class="ltx_figure"><img src="/html/1809.01810/assets/figure/edgeShift.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="269" height="56" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The parse-tree-guided propagation module performs bilinear fusion between the hidden/attention map and question encoding. Different edge types have the same architecture but different sets of weights.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span id="S3.SS2.1.1" class="ltx_text ltx_font_italic">Attention module</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.20" class="ltx_p">In node <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">j</annotation></semantics></math>, the attention module <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="f_{a}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑓</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">f_{a}</annotation></semantics></math> is used to locate the image region that corresponds to the words encoding <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="w_{j}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑤</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">w_{j}</annotation></semantics></math> and the input attention message <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\{m^{a}_{ij}\}_{e_{ij}\in E}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mrow id="S3.SS2.p1.4.m4.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.2.cmml">{</mo><msubsup id="S3.SS2.p1.4.m4.1.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS2.p1.4.m4.1.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.1.1.1.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.4.m4.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><msub id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2.2" xref="S3.SS2.p1.4.m4.1.1.3.2.2.cmml">e</mi><mrow id="S3.SS2.p1.4.m4.1.1.3.2.3" xref="S3.SS2.p1.4.m4.1.1.3.2.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.1.1.3.2.3.1" xref="S3.SS2.p1.4.m4.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.1.1.3.2.3.3" xref="S3.SS2.p1.4.m4.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS2.p1.4.m4.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.3.1.cmml">∈</mo><mi id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><set id="S3.SS2.p1.4.m4.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1"><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3"><times id="S3.SS2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1.3.3">𝑗</ci></apply></apply></set><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><in id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.1"></in><apply id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.2">𝑒</ci><apply id="S3.SS2.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.3"><times id="S3.SS2.p1.4.m4.1.1.3.2.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.3.2.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.3.2">𝑖</ci><ci id="S3.SS2.p1.4.m4.1.1.3.2.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\{m^{a}_{ij}\}_{e_{ij}\in E}</annotation></semantics></math>.
Specifically, as shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Overview ‣ 3 Tree-Structured Composition Reasoning Network ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the input attention feature <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\tilde{att}_{j}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mover accent="true" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml"><mrow id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.2.2.1" xref="S3.SS2.p1.5.m5.1.1.2.2.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.2.2.3" xref="S3.SS2.p1.5.m5.1.1.2.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.2.2.1a" xref="S3.SS2.p1.5.m5.1.1.2.2.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.2.2.4" xref="S3.SS2.p1.5.m5.1.1.2.2.4.cmml">t</mi></mrow><mo id="S3.SS2.p1.5.m5.1.1.2.1" xref="S3.SS2.p1.5.m5.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2"><ci id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2.1">~</ci><apply id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2"><times id="S3.SS2.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2.1"></times><ci id="S3.SS2.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2.2">𝑎</ci><ci id="S3.SS2.p1.5.m5.1.1.2.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2.3">𝑡</ci><ci id="S3.SS2.p1.5.m5.1.1.2.2.4.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2.4">𝑡</ci></apply></apply><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\tilde{att}_{j}</annotation></semantics></math> of each node <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">j</annotation></semantics></math> is first obtained by summing <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\{m^{a}_{ij}\}_{e_{ij}\in E}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mrow id="S3.SS2.p1.7.m7.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.2.cmml">{</mo><msubsup id="S3.SS2.p1.7.m7.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS2.p1.7.m7.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.1.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><msub id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.2.2" xref="S3.SS2.p1.7.m7.1.1.3.2.2.cmml">e</mi><mrow id="S3.SS2.p1.7.m7.1.1.3.2.3" xref="S3.SS2.p1.7.m7.1.1.3.2.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.2.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m7.1.1.3.2.3.1" xref="S3.SS2.p1.7.m7.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.7.m7.1.1.3.2.3.3" xref="S3.SS2.p1.7.m7.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS2.p1.7.m7.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.3.1.cmml">∈</mo><mi id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><set id="S3.SS2.p1.7.m7.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1"><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3"><times id="S3.SS2.p1.7.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.3.3">𝑗</ci></apply></apply></set><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><in id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.1"></in><apply id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.3.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.3.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2.2">𝑒</ci><apply id="S3.SS2.p1.7.m7.1.1.3.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2.3"><times id="S3.SS2.p1.7.m7.1.1.3.2.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2.3.1"></times><ci id="S3.SS2.p1.7.m7.1.1.3.2.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2.3.2">𝑖</ci><ci id="S3.SS2.p1.7.m7.1.1.3.2.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\{m^{a}_{ij}\}_{e_{ij}\in E}</annotation></semantics></math> as <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="\tilde{att}_{j}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mover accent="true" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml"><mrow id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m8.1.1.2.2.1" xref="S3.SS2.p1.8.m8.1.1.2.2.1.cmml">​</mo><mi id="S3.SS2.p1.8.m8.1.1.2.2.3" xref="S3.SS2.p1.8.m8.1.1.2.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m8.1.1.2.2.1a" xref="S3.SS2.p1.8.m8.1.1.2.2.1.cmml">​</mo><mi id="S3.SS2.p1.8.m8.1.1.2.2.4" xref="S3.SS2.p1.8.m8.1.1.2.2.4.cmml">t</mi></mrow><mo id="S3.SS2.p1.8.m8.1.1.2.1" xref="S3.SS2.p1.8.m8.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2"><ci id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.2.1">~</ci><apply id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2"><times id="S3.SS2.p1.8.m8.1.1.2.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2.1"></times><ci id="S3.SS2.p1.8.m8.1.1.2.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2.2">𝑎</ci><ci id="S3.SS2.p1.8.m8.1.1.2.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2.3">𝑡</ci><ci id="S3.SS2.p1.8.m8.1.1.2.2.4.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2.4">𝑡</ci></apply></apply><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\tilde{att}_{j}</annotation></semantics></math>.
Then, we project the image feature <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mi id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">v</annotation></semantics></math>, the input attention feature <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="\tilde{att}_{j}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msub id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mover accent="true" id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml"><mrow id="S3.SS2.p1.10.m10.1.1.2.2" xref="S3.SS2.p1.10.m10.1.1.2.2.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2.2.2" xref="S3.SS2.p1.10.m10.1.1.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.10.m10.1.1.2.2.1" xref="S3.SS2.p1.10.m10.1.1.2.2.1.cmml">​</mo><mi id="S3.SS2.p1.10.m10.1.1.2.2.3" xref="S3.SS2.p1.10.m10.1.1.2.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.10.m10.1.1.2.2.1a" xref="S3.SS2.p1.10.m10.1.1.2.2.1.cmml">​</mo><mi id="S3.SS2.p1.10.m10.1.1.2.2.4" xref="S3.SS2.p1.10.m10.1.1.2.2.4.cmml">t</mi></mrow><mo id="S3.SS2.p1.10.m10.1.1.2.1" xref="S3.SS2.p1.10.m10.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><apply id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2"><ci id="S3.SS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.p1.10.m10.1.1.2.1">~</ci><apply id="S3.SS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2"><times id="S3.SS2.p1.10.m10.1.1.2.2.1.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2.1"></times><ci id="S3.SS2.p1.10.m10.1.1.2.2.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2.2">𝑎</ci><ci id="S3.SS2.p1.10.m10.1.1.2.2.3.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2.3">𝑡</ci><ci id="S3.SS2.p1.10.m10.1.1.2.2.4.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2.4">𝑡</ci></apply></apply><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">\tilde{att}_{j}</annotation></semantics></math> and the word encoding <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="w_{j}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><msub id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2" xref="S3.SS2.p1.11.m11.1.1.2.cmml">w</mi><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2">𝑤</ci><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">w_{j}</annotation></semantics></math> to <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mn id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><cn type="integer" id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">2048</annotation></semantics></math>-d features and perform elementwise multiplication on these three <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><mn id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><cn type="integer" id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">2048</annotation></semantics></math>-d features.
Finally, the fused <math id="S3.SS2.p1.14.m14.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S3.SS2.p1.14.m14.1a"><mn id="S3.SS2.p1.14.m14.1.1" xref="S3.SS2.p1.14.m14.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m14.1b"><cn type="integer" id="S3.SS2.p1.14.m14.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m14.1c">2048</annotation></semantics></math>-d feature is fed into another convolution layer, resulting in a new attention map <math id="S3.SS2.p1.15.m15.1" class="ltx_Math" alttext="{att}_{j}" display="inline"><semantics id="S3.SS2.p1.15.m15.1a"><mrow id="S3.SS2.p1.15.m15.1.1" xref="S3.SS2.p1.15.m15.1.1.cmml"><mi id="S3.SS2.p1.15.m15.1.1.2" xref="S3.SS2.p1.15.m15.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.15.m15.1.1.1" xref="S3.SS2.p1.15.m15.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.15.m15.1.1.3" xref="S3.SS2.p1.15.m15.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.15.m15.1.1.1a" xref="S3.SS2.p1.15.m15.1.1.1.cmml">​</mo><msub id="S3.SS2.p1.15.m15.1.1.4" xref="S3.SS2.p1.15.m15.1.1.4.cmml"><mi id="S3.SS2.p1.15.m15.1.1.4.2" xref="S3.SS2.p1.15.m15.1.1.4.2.cmml">t</mi><mi id="S3.SS2.p1.15.m15.1.1.4.3" xref="S3.SS2.p1.15.m15.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m15.1b"><apply id="S3.SS2.p1.15.m15.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1"><times id="S3.SS2.p1.15.m15.1.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1.1"></times><ci id="S3.SS2.p1.15.m15.1.1.2.cmml" xref="S3.SS2.p1.15.m15.1.1.2">𝑎</ci><ci id="S3.SS2.p1.15.m15.1.1.3.cmml" xref="S3.SS2.p1.15.m15.1.1.3">𝑡</ci><apply id="S3.SS2.p1.15.m15.1.1.4.cmml" xref="S3.SS2.p1.15.m15.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m15.1.1.4.1.cmml" xref="S3.SS2.p1.15.m15.1.1.4">subscript</csymbol><ci id="S3.SS2.p1.15.m15.1.1.4.2.cmml" xref="S3.SS2.p1.15.m15.1.1.4.2">𝑡</ci><ci id="S3.SS2.p1.15.m15.1.1.4.3.cmml" xref="S3.SS2.p1.15.m15.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m15.1c">{att}_{j}</annotation></semantics></math>. We further apply softmax to regularize the resulting attention map into the range <math id="S3.SS2.p1.16.m16.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S3.SS2.p1.16.m16.2a"><mrow id="S3.SS2.p1.16.m16.2.3.2" xref="S3.SS2.p1.16.m16.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.16.m16.2.3.2.1" xref="S3.SS2.p1.16.m16.2.3.1.cmml">[</mo><mn id="S3.SS2.p1.16.m16.1.1" xref="S3.SS2.p1.16.m16.1.1.cmml">0</mn><mo id="S3.SS2.p1.16.m16.2.3.2.2" xref="S3.SS2.p1.16.m16.2.3.1.cmml">,</mo><mn id="S3.SS2.p1.16.m16.2.2" xref="S3.SS2.p1.16.m16.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p1.16.m16.2.3.2.3" xref="S3.SS2.p1.16.m16.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m16.2b"><interval closure="closed" id="S3.SS2.p1.16.m16.2.3.1.cmml" xref="S3.SS2.p1.16.m16.2.3.2"><cn type="integer" id="S3.SS2.p1.16.m16.1.1.cmml" xref="S3.SS2.p1.16.m16.1.1">0</cn><cn type="integer" id="S3.SS2.p1.16.m16.2.2.cmml" xref="S3.SS2.p1.16.m16.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m16.2c">[0,1]</annotation></semantics></math>. The local image feature <math id="S3.SS2.p1.17.m17.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS2.p1.17.m17.1a"><msub id="S3.SS2.p1.17.m17.1.1" xref="S3.SS2.p1.17.m17.1.1.cmml"><mi id="S3.SS2.p1.17.m17.1.1.2" xref="S3.SS2.p1.17.m17.1.1.2.cmml">v</mi><mi id="S3.SS2.p1.17.m17.1.1.3" xref="S3.SS2.p1.17.m17.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m17.1b"><apply id="S3.SS2.p1.17.m17.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.1.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1">subscript</csymbol><ci id="S3.SS2.p1.17.m17.1.1.2.cmml" xref="S3.SS2.p1.17.m17.1.1.2">𝑣</ci><ci id="S3.SS2.p1.17.m17.1.1.3.cmml" xref="S3.SS2.p1.17.m17.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m17.1c">v_{j}</annotation></semantics></math> of node <math id="S3.SS2.p1.18.m18.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.18.m18.1a"><mi id="S3.SS2.p1.18.m18.1.1" xref="S3.SS2.p1.18.m18.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m18.1b"><ci id="S3.SS2.p1.18.m18.1.1.cmml" xref="S3.SS2.p1.18.m18.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m18.1c">j</annotation></semantics></math> is then generated by the weighted sum of each grid in image feature <math id="S3.SS2.p1.19.m19.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS2.p1.19.m19.1a"><mi id="S3.SS2.p1.19.m19.1.1" xref="S3.SS2.p1.19.m19.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m19.1b"><ci id="S3.SS2.p1.19.m19.1.1.cmml" xref="S3.SS2.p1.19.m19.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m19.1c">v</annotation></semantics></math> given the weights in attention map <math id="S3.SS2.p1.20.m20.1" class="ltx_Math" alttext="{att}_{j}" display="inline"><semantics id="S3.SS2.p1.20.m20.1a"><mrow id="S3.SS2.p1.20.m20.1.1" xref="S3.SS2.p1.20.m20.1.1.cmml"><mi id="S3.SS2.p1.20.m20.1.1.2" xref="S3.SS2.p1.20.m20.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.20.m20.1.1.1" xref="S3.SS2.p1.20.m20.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.20.m20.1.1.3" xref="S3.SS2.p1.20.m20.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.20.m20.1.1.1a" xref="S3.SS2.p1.20.m20.1.1.1.cmml">​</mo><msub id="S3.SS2.p1.20.m20.1.1.4" xref="S3.SS2.p1.20.m20.1.1.4.cmml"><mi id="S3.SS2.p1.20.m20.1.1.4.2" xref="S3.SS2.p1.20.m20.1.1.4.2.cmml">t</mi><mi id="S3.SS2.p1.20.m20.1.1.4.3" xref="S3.SS2.p1.20.m20.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m20.1b"><apply id="S3.SS2.p1.20.m20.1.1.cmml" xref="S3.SS2.p1.20.m20.1.1"><times id="S3.SS2.p1.20.m20.1.1.1.cmml" xref="S3.SS2.p1.20.m20.1.1.1"></times><ci id="S3.SS2.p1.20.m20.1.1.2.cmml" xref="S3.SS2.p1.20.m20.1.1.2">𝑎</ci><ci id="S3.SS2.p1.20.m20.1.1.3.cmml" xref="S3.SS2.p1.20.m20.1.1.3">𝑡</ci><apply id="S3.SS2.p1.20.m20.1.1.4.cmml" xref="S3.SS2.p1.20.m20.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m20.1.1.4.1.cmml" xref="S3.SS2.p1.20.m20.1.1.4">subscript</csymbol><ci id="S3.SS2.p1.20.m20.1.1.4.2.cmml" xref="S3.SS2.p1.20.m20.1.1.4.2">𝑡</ci><ci id="S3.SS2.p1.20.m20.1.1.4.3.cmml" xref="S3.SS2.p1.20.m20.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m20.1c">{att}_{j}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span id="S3.SS3.1.1" class="ltx_text ltx_font_italic">Gated residual composition module</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.5" class="ltx_p">A node <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">j</annotation></semantics></math> contains two gated residual composition modules with similar architectures but different weights, as shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.1 Overview ‣ 3 Tree-Structured Composition Reasoning Network ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. This module is used to compose the newly generated attention map <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="{att}_{j}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.1.1a" xref="S3.SS3.p1.2.m2.1.1.1.cmml">​</mo><msub id="S3.SS3.p1.2.m2.1.1.4" xref="S3.SS3.p1.2.m2.1.1.4.cmml"><mi id="S3.SS3.p1.2.m2.1.1.4.2" xref="S3.SS3.p1.2.m2.1.1.4.2.cmml">t</mi><mi id="S3.SS3.p1.2.m2.1.1.4.3" xref="S3.SS3.p1.2.m2.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><times id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"></times><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑎</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑡</ci><apply id="S3.SS3.p1.2.m2.1.1.4.cmml" xref="S3.SS3.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.4.1.cmml" xref="S3.SS3.p1.2.m2.1.1.4">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.4.2.cmml" xref="S3.SS3.p1.2.m2.1.1.4.2">𝑡</ci><ci id="S3.SS3.p1.2.m2.1.1.4.3.cmml" xref="S3.SS3.p1.2.m2.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">{att}_{j}</annotation></semantics></math> and local image feature <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">v_{j}</annotation></semantics></math> with input messages <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\{m^{a}_{ij}\}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p1.4.m4.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.1.2.2" xref="S3.SS3.p1.4.m4.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS3.p1.4.m4.1.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.4.m4.1.1.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS3.p1.4.m4.1.1.1.1.2.3" xref="S3.SS3.p1.4.m4.1.1.1.1.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.SS3.p1.4.m4.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><set id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1"><apply id="S3.SS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.p1.4.m4.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3"><times id="S3.SS3.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3.1"></times><ci id="S3.SS3.p1.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p1.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3.3">𝑗</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\{m^{a}_{ij}\}</annotation></semantics></math> and <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\{m^{h}_{ij}\}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1.1" xref="S3.SS3.p1.5.m5.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.1.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.1.1.2.2" xref="S3.SS3.p1.5.m5.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS3.p1.5.m5.1.1.1.1.3" xref="S3.SS3.p1.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.5.m5.1.1.1.1.3.2" xref="S3.SS3.p1.5.m5.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.1.1.1.1.3.1" xref="S3.SS3.p1.5.m5.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.5.m5.1.1.1.1.3.3" xref="S3.SS3.p1.5.m5.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS3.p1.5.m5.1.1.1.1.2.3" xref="S3.SS3.p1.5.m5.1.1.1.1.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="S3.SS3.p1.5.m5.1.1.1.3" xref="S3.SS3.p1.5.m5.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><set id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.1"><apply id="S3.SS3.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.p1.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.3"><times id="S3.SS3.p1.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.3.1"></times><ci id="S3.SS3.p1.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p1.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.3.3">𝑗</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\{m^{h}_{ij}\}</annotation></semantics></math> respectively.
In the preliminary work, the nodes share only weight at the same level, which contains many parameters and is not suitable for global reasoning with different parse trees.
However, applying a single node module multiple times essentially acts as a recurrent network and will suffer from gradient exploding/vanishing problems.
Meanwhile, in the CLEVR dataset, there are a large number of objects referred to by their relationships with other objects, such as “left of the big sphere” or “left of the brown metal”. To answer the question, the visual representation of “big sphere” is not necessary and might impact the final prediction. Previously, we dropped the hidden feature of these nodes when its head-dependent relation is a modifier relation. We want to enable the module to learn this drop process rather than using handcrafted rules. Here, we utilize the widely used gated recurrent unit to enable the module to learn the drop process.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.10" class="ltx_p">As shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.1 Overview ‣ 3 Tree-Structured Composition Reasoning Network ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the gated residual composition module <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="f_{h}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑓</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">f_{h}</annotation></semantics></math> first sums the messages of hidden representation <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\{m^{h}_{ij}\}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p2.2.m2.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS3.p2.2.m2.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.1.1.1.3.1" xref="S3.SS3.p2.2.m2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.1.1.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS3.p2.2.m2.1.1.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.1.1.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.2.m2.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><set id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1"><apply id="S3.SS3.p2.2.m2.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.p2.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.SS3.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3"><times id="S3.SS3.p2.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3.1"></times><ci id="S3.SS3.p2.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.3.3">𝑗</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\{m^{h}_{ij}\}</annotation></semantics></math> of its children into <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\tilde{h}_{j}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">h</mi><mo id="S3.SS3.p2.3.m3.1.1.2.1" xref="S3.SS3.p2.3.m3.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><ci id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1">~</ci><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">ℎ</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\tilde{h}_{j}</annotation></semantics></math>, and then it concatenates <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\tilde{h}_{j}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mover accent="true" id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.2.2.cmml">h</mi><mo id="S3.SS3.p2.4.m4.1.1.2.1" xref="S3.SS3.p2.4.m4.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2"><ci id="S3.SS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.2.1">~</ci><ci id="S3.SS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2.2">ℎ</ci></apply><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\tilde{h}_{j}</annotation></semantics></math> with extracted local image feature <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑣</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">v_{j}</annotation></semantics></math>. Similar to a gated recurrent unit, the module generates the reset gate <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">r</mi><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝑟</ci><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">r_{j}</annotation></semantics></math> and the update gate <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="z_{j}" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><msub id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">z</mi><mi id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝑧</ci><ci id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">z_{j}</annotation></semantics></math> based on the concatenated <math id="S3.SS3.p2.8.m8.2" class="ltx_Math" alttext="[\tilde{h}_{j},v_{j}]" display="inline"><semantics id="S3.SS3.p2.8.m8.2a"><mrow id="S3.SS3.p2.8.m8.2.2.2" xref="S3.SS3.p2.8.m8.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.8.m8.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.3.cmml">[</mo><msub id="S3.SS3.p2.8.m8.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.8.m8.1.1.1.1.2" xref="S3.SS3.p2.8.m8.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.8.m8.1.1.1.1.2.2" xref="S3.SS3.p2.8.m8.1.1.1.1.2.2.cmml">h</mi><mo id="S3.SS3.p2.8.m8.1.1.1.1.2.1" xref="S3.SS3.p2.8.m8.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.p2.8.m8.1.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.p2.8.m8.2.2.2.4" xref="S3.SS3.p2.8.m8.2.2.3.cmml">,</mo><msub id="S3.SS3.p2.8.m8.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.cmml"><mi id="S3.SS3.p2.8.m8.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.cmml">v</mi><mi id="S3.SS3.p2.8.m8.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.p2.8.m8.2.2.2.5" xref="S3.SS3.p2.8.m8.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.2b"><interval closure="closed" id="S3.SS3.p2.8.m8.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2"><apply id="S3.SS3.p2.8.m8.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.8.m8.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.2"><ci id="S3.SS3.p2.8.m8.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.2.1">~</ci><ci id="S3.SS3.p2.8.m8.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.2.2">ℎ</ci></apply><ci id="S3.SS3.p2.8.m8.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS3.p2.8.m8.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2">𝑣</ci><ci id="S3.SS3.p2.8.m8.2.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.2c">[\tilde{h}_{j},v_{j}]</annotation></semantics></math>. Then, the module produces an update vector <math id="S3.SS3.p2.9.m9.1" class="ltx_Math" alttext="c_{j}" display="inline"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">c</mi><mi id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑐</ci><ci id="S3.SS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">c_{j}</annotation></semantics></math>, updates and outputs the hidden representation <math id="S3.SS3.p2.10.m10.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS3.p2.10.m10.1a"><msub id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">h</mi><mi id="S3.SS3.p2.10.m10.1.1.3" xref="S3.SS3.p2.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">ℎ</ci><ci id="S3.SS3.p2.10.m10.1.1.3.cmml" xref="S3.SS3.p2.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">h_{j}</annotation></semantics></math>:</p>
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{h}_{j}" display="inline"><semantics id="S3.E1X.2.1.1.m1.1a"><msub id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml"><mover accent="true" id="S3.E1X.2.1.1.m1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.2.2" xref="S3.E1X.2.1.1.m1.1.1.2.2.cmml">h</mi><mo id="S3.E1X.2.1.1.m1.1.1.2.1" xref="S3.E1X.2.1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E1X.2.1.1.m1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.1b"><apply id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1">subscript</csymbol><apply id="S3.E1X.2.1.1.m1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.2"><ci id="S3.E1X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.2.1">~</ci><ci id="S3.E1X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.2.2">ℎ</ci></apply><ci id="S3.E1X.2.1.1.m1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.1c">\displaystyle\tilde{h}_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\sum_{(i,j)\in E}m^{h}_{ij}" display="inline"><semantics id="S3.E1X.3.2.2.m1.2a"><mrow id="S3.E1X.3.2.2.m1.2.3" xref="S3.E1X.3.2.2.m1.2.3.cmml"><mi id="S3.E1X.3.2.2.m1.2.3.2" xref="S3.E1X.3.2.2.m1.2.3.2.cmml"></mi><mo id="S3.E1X.3.2.2.m1.2.3.1" xref="S3.E1X.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="S3.E1X.3.2.2.m1.2.3.3" xref="S3.E1X.3.2.2.m1.2.3.3.cmml"><mstyle displaystyle="true" id="S3.E1X.3.2.2.m1.2.3.3.1" xref="S3.E1X.3.2.2.m1.2.3.3.1.cmml"><munder id="S3.E1X.3.2.2.m1.2.3.3.1a" xref="S3.E1X.3.2.2.m1.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E1X.3.2.2.m1.2.3.3.1.2" xref="S3.E1X.3.2.2.m1.2.3.3.1.2.cmml">∑</mo><mrow id="S3.E1X.3.2.2.m1.2.2.2" xref="S3.E1X.3.2.2.m1.2.2.2.cmml"><mrow id="S3.E1X.3.2.2.m1.2.2.2.4.2" xref="S3.E1X.3.2.2.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E1X.3.2.2.m1.2.2.2.4.2.1" xref="S3.E1X.3.2.2.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E1X.3.2.2.m1.1.1.1.1" xref="S3.E1X.3.2.2.m1.1.1.1.1.cmml">i</mi><mo id="S3.E1X.3.2.2.m1.2.2.2.4.2.2" xref="S3.E1X.3.2.2.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E1X.3.2.2.m1.2.2.2.2" xref="S3.E1X.3.2.2.m1.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E1X.3.2.2.m1.2.2.2.4.2.3" xref="S3.E1X.3.2.2.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E1X.3.2.2.m1.2.2.2.3" xref="S3.E1X.3.2.2.m1.2.2.2.3.cmml">∈</mo><mi id="S3.E1X.3.2.2.m1.2.2.2.5" xref="S3.E1X.3.2.2.m1.2.2.2.5.cmml">E</mi></mrow></munder></mstyle><msubsup id="S3.E1X.3.2.2.m1.2.3.3.2" xref="S3.E1X.3.2.2.m1.2.3.3.2.cmml"><mi id="S3.E1X.3.2.2.m1.2.3.3.2.2.2" xref="S3.E1X.3.2.2.m1.2.3.3.2.2.2.cmml">m</mi><mrow id="S3.E1X.3.2.2.m1.2.3.3.2.3" xref="S3.E1X.3.2.2.m1.2.3.3.2.3.cmml"><mi id="S3.E1X.3.2.2.m1.2.3.3.2.3.2" xref="S3.E1X.3.2.2.m1.2.3.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E1X.3.2.2.m1.2.3.3.2.3.1" xref="S3.E1X.3.2.2.m1.2.3.3.2.3.1.cmml">​</mo><mi id="S3.E1X.3.2.2.m1.2.3.3.2.3.3" xref="S3.E1X.3.2.2.m1.2.3.3.2.3.3.cmml">j</mi></mrow><mi id="S3.E1X.3.2.2.m1.2.3.3.2.2.3" xref="S3.E1X.3.2.2.m1.2.3.3.2.2.3.cmml">h</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.3.2.2.m1.2b"><apply id="S3.E1X.3.2.2.m1.2.3.cmml" xref="S3.E1X.3.2.2.m1.2.3"><eq id="S3.E1X.3.2.2.m1.2.3.1.cmml" xref="S3.E1X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.2.3.2.cmml" xref="S3.E1X.3.2.2.m1.2.3.2">absent</csymbol><apply id="S3.E1X.3.2.2.m1.2.3.3.cmml" xref="S3.E1X.3.2.2.m1.2.3.3"><apply id="S3.E1X.3.2.2.m1.2.3.3.1.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.3.3.1.1.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.1">subscript</csymbol><sum id="S3.E1X.3.2.2.m1.2.3.3.1.2.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.1.2"></sum><apply id="S3.E1X.3.2.2.m1.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.2"><in id="S3.E1X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.2.2.2.3"></in><interval closure="open" id="S3.E1X.3.2.2.m1.2.2.2.4.1.cmml" xref="S3.E1X.3.2.2.m1.2.2.2.4.2"><ci id="S3.E1X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1.1.1">𝑖</ci><ci id="S3.E1X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.2.2.2">𝑗</ci></interval><ci id="S3.E1X.3.2.2.m1.2.2.2.5.cmml" xref="S3.E1X.3.2.2.m1.2.2.2.5">𝐸</ci></apply></apply><apply id="S3.E1X.3.2.2.m1.2.3.3.2.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.3.3.2.1.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2">subscript</csymbol><apply id="S3.E1X.3.2.2.m1.2.3.3.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.2.3.3.2.2.1.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2">superscript</csymbol><ci id="S3.E1X.3.2.2.m1.2.3.3.2.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2.2.2">𝑚</ci><ci id="S3.E1X.3.2.2.m1.2.3.3.2.2.3.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2.2.3">ℎ</ci></apply><apply id="S3.E1X.3.2.2.m1.2.3.3.2.3.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2.3"><times id="S3.E1X.3.2.2.m1.2.3.3.2.3.1.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2.3.1"></times><ci id="S3.E1X.3.2.2.m1.2.3.3.2.3.2.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2.3.2">𝑖</ci><ci id="S3.E1X.3.2.2.m1.2.3.3.2.3.3.cmml" xref="S3.E1X.3.2.2.m1.2.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.3.2.2.m1.2c">\displaystyle=\sum_{(i,j)\in E}m^{h}_{ij}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="5" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr id="S3.E1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle z_{j}" display="inline"><semantics id="S3.E1Xa.2.1.1.m1.1a"><msub id="S3.E1Xa.2.1.1.m1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E1Xa.2.1.1.m1.1.1.2" xref="S3.E1Xa.2.1.1.m1.1.1.2.cmml">z</mi><mi id="S3.E1Xa.2.1.1.m1.1.1.3" xref="S3.E1Xa.2.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E1Xa.2.1.1.m1.1b"><apply id="S3.E1Xa.2.1.1.m1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E1Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.2">𝑧</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.2.1.1.m1.1c">\displaystyle z_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\sigma(W_{z}\cdot[\tilde{h}_{j},v_{j}])" display="inline"><semantics id="S3.E1Xa.3.2.2.m1.1a"><mrow id="S3.E1Xa.3.2.2.m1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E1Xa.3.2.2.m1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1Xa.3.2.2.m1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.2.cmml">W</mi><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.3.cmml">z</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml">⋅</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.4" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.5" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xa.3.2.2.m1.1b"><apply id="S3.E1Xa.3.2.2.m1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1"><eq id="S3.E1Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E1Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1"><times id="S3.E1Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.2"></times><ci id="S3.E1Xa.3.2.2.m1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.3">𝜎</ci><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1"><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3">⋅</ci><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.2">𝑊</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.4.3">𝑧</ci></apply><interval closure="closed" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2"><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.3.2.2.m1.1c">\displaystyle=\sigma(W_{z}\cdot[\tilde{h}_{j},v_{j}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E1Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle r_{j}" display="inline"><semantics id="S3.E1Xb.2.1.1.m1.1a"><msub id="S3.E1Xb.2.1.1.m1.1.1" xref="S3.E1Xb.2.1.1.m1.1.1.cmml"><mi id="S3.E1Xb.2.1.1.m1.1.1.2" xref="S3.E1Xb.2.1.1.m1.1.1.2.cmml">r</mi><mi id="S3.E1Xb.2.1.1.m1.1.1.3" xref="S3.E1Xb.2.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E1Xb.2.1.1.m1.1b"><apply id="S3.E1Xb.2.1.1.m1.1.1.cmml" xref="S3.E1Xb.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E1Xb.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E1Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E1Xb.2.1.1.m1.1.1.2">𝑟</ci><ci id="S3.E1Xb.2.1.1.m1.1.1.3.cmml" xref="S3.E1Xb.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xb.2.1.1.m1.1c">\displaystyle r_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1Xb.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\sigma(W_{r}\cdot[\tilde{h}_{j},v_{j}])" display="inline"><semantics id="S3.E1Xb.3.2.2.m1.1a"><mrow id="S3.E1Xb.3.2.2.m1.1.1" xref="S3.E1Xb.3.2.2.m1.1.1.cmml"><mi id="S3.E1Xb.3.2.2.m1.1.1.3" xref="S3.E1Xb.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E1Xb.3.2.2.m1.1.1.2" xref="S3.E1Xb.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E1Xb.3.2.2.m1.1.1.1" xref="S3.E1Xb.3.2.2.m1.1.1.1.cmml"><mi id="S3.E1Xb.3.2.2.m1.1.1.1.3" xref="S3.E1Xb.3.2.2.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1Xb.3.2.2.m1.1.1.1.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1Xb.3.2.2.m1.1.1.1.1.1" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.2.cmml">W</mi><mi id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.3" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.3.cmml">r</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml">⋅</mo><mrow id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mo id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.4" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.5" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.3" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xb.3.2.2.m1.1b"><apply id="S3.E1Xb.3.2.2.m1.1.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1"><eq id="S3.E1Xb.3.2.2.m1.1.1.2.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E1Xb.3.2.2.m1.1.1.3.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E1Xb.3.2.2.m1.1.1.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1"><times id="S3.E1Xb.3.2.2.m1.1.1.1.2.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.2"></times><ci id="S3.E1Xb.3.2.2.m1.1.1.1.3.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.3">𝜎</ci><apply id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1"><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.3">⋅</ci><apply id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.2">𝑊</ci><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.4.3">𝑟</ci></apply><interval closure="closed" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2"><apply id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci></apply><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xb.3.2.2.m1.1c">\displaystyle=\sigma(W_{r}\cdot[\tilde{h}_{j},v_{j}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E1Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle c_{j}" display="inline"><semantics id="S3.E1Xc.2.1.1.m1.1a"><msub id="S3.E1Xc.2.1.1.m1.1.1" xref="S3.E1Xc.2.1.1.m1.1.1.cmml"><mi id="S3.E1Xc.2.1.1.m1.1.1.2" xref="S3.E1Xc.2.1.1.m1.1.1.2.cmml">c</mi><mi id="S3.E1Xc.2.1.1.m1.1.1.3" xref="S3.E1Xc.2.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E1Xc.2.1.1.m1.1b"><apply id="S3.E1Xc.2.1.1.m1.1.1.cmml" xref="S3.E1Xc.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1Xc.2.1.1.m1.1.1.1.cmml" xref="S3.E1Xc.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E1Xc.2.1.1.m1.1.1.2.cmml" xref="S3.E1Xc.2.1.1.m1.1.1.2">𝑐</ci><ci id="S3.E1Xc.2.1.1.m1.1.1.3.cmml" xref="S3.E1Xc.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xc.2.1.1.m1.1c">\displaystyle c_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1Xc.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=tanh(W\cdot[r*\tilde{h}_{j},v_{j}])" display="inline"><semantics id="S3.E1Xc.3.2.2.m1.1a"><mrow id="S3.E1Xc.3.2.2.m1.1.1" xref="S3.E1Xc.3.2.2.m1.1.1.cmml"><mi id="S3.E1Xc.3.2.2.m1.1.1.3" xref="S3.E1Xc.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E1Xc.3.2.2.m1.1.1.2" xref="S3.E1Xc.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E1Xc.3.2.2.m1.1.1.1" xref="S3.E1Xc.3.2.2.m1.1.1.1.cmml"><mi id="S3.E1Xc.3.2.2.m1.1.1.1.3" xref="S3.E1Xc.3.2.2.m1.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1Xc.3.2.2.m1.1.1.1.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E1Xc.3.2.2.m1.1.1.1.4" xref="S3.E1Xc.3.2.2.m1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1Xc.3.2.2.m1.1.1.1.2a" xref="S3.E1Xc.3.2.2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E1Xc.3.2.2.m1.1.1.1.5" xref="S3.E1Xc.3.2.2.m1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E1Xc.3.2.2.m1.1.1.1.2b" xref="S3.E1Xc.3.2.2.m1.1.1.1.2.cmml">​</mo><mi id="S3.E1Xc.3.2.2.m1.1.1.1.6" xref="S3.E1Xc.3.2.2.m1.1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E1Xc.3.2.2.m1.1.1.1.2c" xref="S3.E1Xc.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1Xc.3.2.2.m1.1.1.1.1.1" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.4" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.4.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.3.cmml">⋅</mo><mrow id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">∗</mo><msub id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">h</mi><mo id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.4" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.5" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.3" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xc.3.2.2.m1.1b"><apply id="S3.E1Xc.3.2.2.m1.1.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1"><eq id="S3.E1Xc.3.2.2.m1.1.1.2.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E1Xc.3.2.2.m1.1.1.3.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E1Xc.3.2.2.m1.1.1.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1"><times id="S3.E1Xc.3.2.2.m1.1.1.1.2.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.2"></times><ci id="S3.E1Xc.3.2.2.m1.1.1.1.3.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.3">𝑡</ci><ci id="S3.E1Xc.3.2.2.m1.1.1.1.4.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.4">𝑎</ci><ci id="S3.E1Xc.3.2.2.m1.1.1.1.5.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.5">𝑛</ci><ci id="S3.E1Xc.3.2.2.m1.1.1.1.6.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.6">ℎ</ci><apply id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1"><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.3">⋅</ci><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.4">𝑊</ci><interval closure="closed" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2"><apply id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑟</ci><apply id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2">ℎ</ci></apply><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1Xc.3.2.2.m1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xc.3.2.2.m1.1c">\displaystyle=tanh(W\cdot[r*\tilde{h}_{j},v_{j}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E1Xd" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1Xd.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle h_{j}" display="inline"><semantics id="S3.E1Xd.2.1.1.m1.1a"><msub id="S3.E1Xd.2.1.1.m1.1.1" xref="S3.E1Xd.2.1.1.m1.1.1.cmml"><mi id="S3.E1Xd.2.1.1.m1.1.1.2" xref="S3.E1Xd.2.1.1.m1.1.1.2.cmml">h</mi><mi id="S3.E1Xd.2.1.1.m1.1.1.3" xref="S3.E1Xd.2.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E1Xd.2.1.1.m1.1b"><apply id="S3.E1Xd.2.1.1.m1.1.1.cmml" xref="S3.E1Xd.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1Xd.2.1.1.m1.1.1.1.cmml" xref="S3.E1Xd.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E1Xd.2.1.1.m1.1.1.2.cmml" xref="S3.E1Xd.2.1.1.m1.1.1.2">ℎ</ci><ci id="S3.E1Xd.2.1.1.m1.1.1.3.cmml" xref="S3.E1Xd.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xd.2.1.1.m1.1c">\displaystyle h_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1Xd.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=(1-z_{j})*\tilde{h}_{j}+z_{j}*c_{j}" display="inline"><semantics id="S3.E1Xd.3.2.2.m1.1a"><mrow id="S3.E1Xd.3.2.2.m1.1.1" xref="S3.E1Xd.3.2.2.m1.1.1.cmml"><mi id="S3.E1Xd.3.2.2.m1.1.1.3" xref="S3.E1Xd.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E1Xd.3.2.2.m1.1.1.2" xref="S3.E1Xd.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E1Xd.3.2.2.m1.1.1.1" xref="S3.E1Xd.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E1Xd.3.2.2.m1.1.1.1.1" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E1Xd.3.2.2.m1.1.1.1.1.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.2.cmml">∗</mo><msub id="S3.E1Xd.3.2.2.m1.1.1.1.1.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.2.cmml">h</mi><mo id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.1" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.E1Xd.3.2.2.m1.1.1.1.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E1Xd.3.2.2.m1.1.1.1.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.cmml"><msub id="S3.E1Xd.3.2.2.m1.1.1.1.3.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.2.cmml"><mi id="S3.E1Xd.3.2.2.m1.1.1.1.3.2.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.2.2.cmml">z</mi><mi id="S3.E1Xd.3.2.2.m1.1.1.1.3.2.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E1Xd.3.2.2.m1.1.1.1.3.1" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.1.cmml">∗</mo><msub id="S3.E1Xd.3.2.2.m1.1.1.1.3.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.3.cmml"><mi id="S3.E1Xd.3.2.2.m1.1.1.1.3.3.2" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.3.2.cmml">c</mi><mi id="S3.E1Xd.3.2.2.m1.1.1.1.3.3.3" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xd.3.2.2.m1.1b"><apply id="S3.E1Xd.3.2.2.m1.1.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1"><eq id="S3.E1Xd.3.2.2.m1.1.1.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E1Xd.3.2.2.m1.1.1.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E1Xd.3.2.2.m1.1.1.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1"><plus id="S3.E1Xd.3.2.2.m1.1.1.1.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.2"></plus><apply id="S3.E1Xd.3.2.2.m1.1.1.1.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1"><times id="S3.E1Xd.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.2"></times><apply id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1"><minus id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2"><ci id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.1">~</ci><ci id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.2.2">ℎ</ci></apply><ci id="S3.E1Xd.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E1Xd.3.2.2.m1.1.1.1.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3"><times id="S3.E1Xd.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.1"></times><apply id="S3.E1Xd.3.2.2.m1.1.1.1.3.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1Xd.3.2.2.m1.1.1.1.3.2.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1Xd.3.2.2.m1.1.1.1.3.2.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.2.2">𝑧</ci><ci id="S3.E1Xd.3.2.2.m1.1.1.1.3.2.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.2.3">𝑗</ci></apply><apply id="S3.E1Xd.3.2.2.m1.1.1.1.3.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1Xd.3.2.2.m1.1.1.1.3.3.1.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1Xd.3.2.2.m1.1.1.1.3.3.2.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E1Xd.3.2.2.m1.1.1.1.3.3.3.cmml" xref="S3.E1Xd.3.2.2.m1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xd.3.2.2.m1.1c">\displaystyle=(1-z_{j})*\tilde{h}_{j}+z_{j}*c_{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p2.18" class="ltx_p">To encode the attention map <math id="S3.SS3.p2.11.m1.1" class="ltx_Math" alttext="att_{j}" display="inline"><semantics id="S3.SS3.p2.11.m1.1a"><mrow id="S3.SS3.p2.11.m1.1.1" xref="S3.SS3.p2.11.m1.1.1.cmml"><mi id="S3.SS3.p2.11.m1.1.1.2" xref="S3.SS3.p2.11.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.11.m1.1.1.1" xref="S3.SS3.p2.11.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.11.m1.1.1.3" xref="S3.SS3.p2.11.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.11.m1.1.1.1a" xref="S3.SS3.p2.11.m1.1.1.1.cmml">​</mo><msub id="S3.SS3.p2.11.m1.1.1.4" xref="S3.SS3.p2.11.m1.1.1.4.cmml"><mi id="S3.SS3.p2.11.m1.1.1.4.2" xref="S3.SS3.p2.11.m1.1.1.4.2.cmml">t</mi><mi id="S3.SS3.p2.11.m1.1.1.4.3" xref="S3.SS3.p2.11.m1.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m1.1b"><apply id="S3.SS3.p2.11.m1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1"><times id="S3.SS3.p2.11.m1.1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1.1"></times><ci id="S3.SS3.p2.11.m1.1.1.2.cmml" xref="S3.SS3.p2.11.m1.1.1.2">𝑎</ci><ci id="S3.SS3.p2.11.m1.1.1.3.cmml" xref="S3.SS3.p2.11.m1.1.1.3">𝑡</ci><apply id="S3.SS3.p2.11.m1.1.1.4.cmml" xref="S3.SS3.p2.11.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m1.1.1.4.1.cmml" xref="S3.SS3.p2.11.m1.1.1.4">subscript</csymbol><ci id="S3.SS3.p2.11.m1.1.1.4.2.cmml" xref="S3.SS3.p2.11.m1.1.1.4.2">𝑡</ci><ci id="S3.SS3.p2.11.m1.1.1.4.3.cmml" xref="S3.SS3.p2.11.m1.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m1.1c">att_{j}</annotation></semantics></math>, we perform similar operations. We first sum <math id="S3.SS3.p2.12.m2.1" class="ltx_Math" alttext="\{m^{a}_{ij}\}" display="inline"><semantics id="S3.SS3.p2.12.m2.1a"><mrow id="S3.SS3.p2.12.m2.1.1.1" xref="S3.SS3.p2.12.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.12.m2.1.1.1.2" xref="S3.SS3.p2.12.m2.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p2.12.m2.1.1.1.1" xref="S3.SS3.p2.12.m2.1.1.1.1.cmml"><mi id="S3.SS3.p2.12.m2.1.1.1.1.2.2" xref="S3.SS3.p2.12.m2.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS3.p2.12.m2.1.1.1.1.3" xref="S3.SS3.p2.12.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.12.m2.1.1.1.1.3.2" xref="S3.SS3.p2.12.m2.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.12.m2.1.1.1.1.3.1" xref="S3.SS3.p2.12.m2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.12.m2.1.1.1.1.3.3" xref="S3.SS3.p2.12.m2.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS3.p2.12.m2.1.1.1.1.2.3" xref="S3.SS3.p2.12.m2.1.1.1.1.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.12.m2.1.1.1.3" xref="S3.SS3.p2.12.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m2.1b"><set id="S3.SS3.p2.12.m2.1.1.2.cmml" xref="S3.SS3.p2.12.m2.1.1.1"><apply id="S3.SS3.p2.12.m2.1.1.1.1.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m2.1.1.1.1.1.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.12.m2.1.1.1.1.2.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m2.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.12.m2.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.p2.12.m2.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS3.p2.12.m2.1.1.1.1.3.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1.3"><times id="S3.SS3.p2.12.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1.3.1"></times><ci id="S3.SS3.p2.12.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.12.m2.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.12.m2.1.1.1.1.3.3">𝑗</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m2.1c">\{m^{a}_{ij}\}</annotation></semantics></math> to obtain <math id="S3.SS3.p2.13.m3.1" class="ltx_Math" alttext="\tilde{att}_{j}" display="inline"><semantics id="S3.SS3.p2.13.m3.1a"><msub id="S3.SS3.p2.13.m3.1.1" xref="S3.SS3.p2.13.m3.1.1.cmml"><mover accent="true" id="S3.SS3.p2.13.m3.1.1.2" xref="S3.SS3.p2.13.m3.1.1.2.cmml"><mrow id="S3.SS3.p2.13.m3.1.1.2.2" xref="S3.SS3.p2.13.m3.1.1.2.2.cmml"><mi id="S3.SS3.p2.13.m3.1.1.2.2.2" xref="S3.SS3.p2.13.m3.1.1.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.13.m3.1.1.2.2.1" xref="S3.SS3.p2.13.m3.1.1.2.2.1.cmml">​</mo><mi id="S3.SS3.p2.13.m3.1.1.2.2.3" xref="S3.SS3.p2.13.m3.1.1.2.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.13.m3.1.1.2.2.1a" xref="S3.SS3.p2.13.m3.1.1.2.2.1.cmml">​</mo><mi id="S3.SS3.p2.13.m3.1.1.2.2.4" xref="S3.SS3.p2.13.m3.1.1.2.2.4.cmml">t</mi></mrow><mo id="S3.SS3.p2.13.m3.1.1.2.1" xref="S3.SS3.p2.13.m3.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.p2.13.m3.1.1.3" xref="S3.SS3.p2.13.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m3.1b"><apply id="S3.SS3.p2.13.m3.1.1.cmml" xref="S3.SS3.p2.13.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m3.1.1.1.cmml" xref="S3.SS3.p2.13.m3.1.1">subscript</csymbol><apply id="S3.SS3.p2.13.m3.1.1.2.cmml" xref="S3.SS3.p2.13.m3.1.1.2"><ci id="S3.SS3.p2.13.m3.1.1.2.1.cmml" xref="S3.SS3.p2.13.m3.1.1.2.1">~</ci><apply id="S3.SS3.p2.13.m3.1.1.2.2.cmml" xref="S3.SS3.p2.13.m3.1.1.2.2"><times id="S3.SS3.p2.13.m3.1.1.2.2.1.cmml" xref="S3.SS3.p2.13.m3.1.1.2.2.1"></times><ci id="S3.SS3.p2.13.m3.1.1.2.2.2.cmml" xref="S3.SS3.p2.13.m3.1.1.2.2.2">𝑎</ci><ci id="S3.SS3.p2.13.m3.1.1.2.2.3.cmml" xref="S3.SS3.p2.13.m3.1.1.2.2.3">𝑡</ci><ci id="S3.SS3.p2.13.m3.1.1.2.2.4.cmml" xref="S3.SS3.p2.13.m3.1.1.2.2.4">𝑡</ci></apply></apply><ci id="S3.SS3.p2.13.m3.1.1.3.cmml" xref="S3.SS3.p2.13.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m3.1c">\tilde{att}_{j}</annotation></semantics></math>. Since the attention map is a <math id="S3.SS3.p2.14.m4.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S3.SS3.p2.14.m4.1a"><mn id="S3.SS3.p2.14.m4.1.1" xref="S3.SS3.p2.14.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m4.1b"><cn type="integer" id="S3.SS3.p2.14.m4.1.1.cmml" xref="S3.SS3.p2.14.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m4.1c">2</annotation></semantics></math>-dimensional grid, we use the convolution gated recurrent unit to update the attention map encoding <math id="S3.SS3.p2.15.m5.1" class="ltx_Math" alttext="h^{att}_{j}" display="inline"><semantics id="S3.SS3.p2.15.m5.1a"><msubsup id="S3.SS3.p2.15.m5.1.1" xref="S3.SS3.p2.15.m5.1.1.cmml"><mi id="S3.SS3.p2.15.m5.1.1.2.2" xref="S3.SS3.p2.15.m5.1.1.2.2.cmml">h</mi><mi id="S3.SS3.p2.15.m5.1.1.3" xref="S3.SS3.p2.15.m5.1.1.3.cmml">j</mi><mrow id="S3.SS3.p2.15.m5.1.1.2.3" xref="S3.SS3.p2.15.m5.1.1.2.3.cmml"><mi id="S3.SS3.p2.15.m5.1.1.2.3.2" xref="S3.SS3.p2.15.m5.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.15.m5.1.1.2.3.1" xref="S3.SS3.p2.15.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.15.m5.1.1.2.3.3" xref="S3.SS3.p2.15.m5.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.15.m5.1.1.2.3.1a" xref="S3.SS3.p2.15.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.15.m5.1.1.2.3.4" xref="S3.SS3.p2.15.m5.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m5.1b"><apply id="S3.SS3.p2.15.m5.1.1.cmml" xref="S3.SS3.p2.15.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m5.1.1.1.cmml" xref="S3.SS3.p2.15.m5.1.1">subscript</csymbol><apply id="S3.SS3.p2.15.m5.1.1.2.cmml" xref="S3.SS3.p2.15.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m5.1.1.2.1.cmml" xref="S3.SS3.p2.15.m5.1.1">superscript</csymbol><ci id="S3.SS3.p2.15.m5.1.1.2.2.cmml" xref="S3.SS3.p2.15.m5.1.1.2.2">ℎ</ci><apply id="S3.SS3.p2.15.m5.1.1.2.3.cmml" xref="S3.SS3.p2.15.m5.1.1.2.3"><times id="S3.SS3.p2.15.m5.1.1.2.3.1.cmml" xref="S3.SS3.p2.15.m5.1.1.2.3.1"></times><ci id="S3.SS3.p2.15.m5.1.1.2.3.2.cmml" xref="S3.SS3.p2.15.m5.1.1.2.3.2">𝑎</ci><ci id="S3.SS3.p2.15.m5.1.1.2.3.3.cmml" xref="S3.SS3.p2.15.m5.1.1.2.3.3">𝑡</ci><ci id="S3.SS3.p2.15.m5.1.1.2.3.4.cmml" xref="S3.SS3.p2.15.m5.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS3.p2.15.m5.1.1.3.cmml" xref="S3.SS3.p2.15.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m5.1c">h^{att}_{j}</annotation></semantics></math>.
Compared with our preliminary work, which has <math id="S3.SS3.p2.16.m6.1" class="ltx_Math" alttext="c_{j}=tanh(W\cdot[\tilde{h}_{j},v_{j}])" display="inline"><semantics id="S3.SS3.p2.16.m6.1a"><mrow id="S3.SS3.p2.16.m6.1.1" xref="S3.SS3.p2.16.m6.1.1.cmml"><msub id="S3.SS3.p2.16.m6.1.1.3" xref="S3.SS3.p2.16.m6.1.1.3.cmml"><mi id="S3.SS3.p2.16.m6.1.1.3.2" xref="S3.SS3.p2.16.m6.1.1.3.2.cmml">c</mi><mi id="S3.SS3.p2.16.m6.1.1.3.3" xref="S3.SS3.p2.16.m6.1.1.3.3.cmml">j</mi></msub><mo id="S3.SS3.p2.16.m6.1.1.2" xref="S3.SS3.p2.16.m6.1.1.2.cmml">=</mo><mrow id="S3.SS3.p2.16.m6.1.1.1" xref="S3.SS3.p2.16.m6.1.1.1.cmml"><mi id="S3.SS3.p2.16.m6.1.1.1.3" xref="S3.SS3.p2.16.m6.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.16.m6.1.1.1.2" xref="S3.SS3.p2.16.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS3.p2.16.m6.1.1.1.4" xref="S3.SS3.p2.16.m6.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.16.m6.1.1.1.2a" xref="S3.SS3.p2.16.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS3.p2.16.m6.1.1.1.5" xref="S3.SS3.p2.16.m6.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.16.m6.1.1.1.2b" xref="S3.SS3.p2.16.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS3.p2.16.m6.1.1.1.6" xref="S3.SS3.p2.16.m6.1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.16.m6.1.1.1.2c" xref="S3.SS3.p2.16.m6.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.16.m6.1.1.1.1.1" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.16.m6.1.1.1.1.1.2" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.16.m6.1.1.1.1.1.1" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.16.m6.1.1.1.1.1.1.4" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.4.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.16.m6.1.1.1.1.1.1.3" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.3.cmml">⋅</mo><mrow id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.3" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mo id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.1" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.4" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.2" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.3" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.5" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.16.m6.1.1.1.1.1.3" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m6.1b"><apply id="S3.SS3.p2.16.m6.1.1.cmml" xref="S3.SS3.p2.16.m6.1.1"><eq id="S3.SS3.p2.16.m6.1.1.2.cmml" xref="S3.SS3.p2.16.m6.1.1.2"></eq><apply id="S3.SS3.p2.16.m6.1.1.3.cmml" xref="S3.SS3.p2.16.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.16.m6.1.1.3.1.cmml" xref="S3.SS3.p2.16.m6.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.16.m6.1.1.3.2.cmml" xref="S3.SS3.p2.16.m6.1.1.3.2">𝑐</ci><ci id="S3.SS3.p2.16.m6.1.1.3.3.cmml" xref="S3.SS3.p2.16.m6.1.1.3.3">𝑗</ci></apply><apply id="S3.SS3.p2.16.m6.1.1.1.cmml" xref="S3.SS3.p2.16.m6.1.1.1"><times id="S3.SS3.p2.16.m6.1.1.1.2.cmml" xref="S3.SS3.p2.16.m6.1.1.1.2"></times><ci id="S3.SS3.p2.16.m6.1.1.1.3.cmml" xref="S3.SS3.p2.16.m6.1.1.1.3">𝑡</ci><ci id="S3.SS3.p2.16.m6.1.1.1.4.cmml" xref="S3.SS3.p2.16.m6.1.1.1.4">𝑎</ci><ci id="S3.SS3.p2.16.m6.1.1.1.5.cmml" xref="S3.SS3.p2.16.m6.1.1.1.5">𝑛</ci><ci id="S3.SS3.p2.16.m6.1.1.1.6.cmml" xref="S3.SS3.p2.16.m6.1.1.1.6">ℎ</ci><apply id="S3.SS3.p2.16.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1"><ci id="S3.SS3.p2.16.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.3">⋅</ci><ci id="S3.SS3.p2.16.m6.1.1.1.1.1.1.4.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.4">𝑊</ci><interval closure="closed" id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2"><apply id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2"><ci id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci></apply><ci id="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS3.p2.16.m6.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m6.1c">c_{j}=tanh(W\cdot[\tilde{h}_{j},v_{j}])</annotation></semantics></math> and <math id="S3.SS3.p2.17.m7.1" class="ltx_Math" alttext="h_{j}=\tilde{h}_{j}+c_{j}" display="inline"><semantics id="S3.SS3.p2.17.m7.1a"><mrow id="S3.SS3.p2.17.m7.1.1" xref="S3.SS3.p2.17.m7.1.1.cmml"><msub id="S3.SS3.p2.17.m7.1.1.2" xref="S3.SS3.p2.17.m7.1.1.2.cmml"><mi id="S3.SS3.p2.17.m7.1.1.2.2" xref="S3.SS3.p2.17.m7.1.1.2.2.cmml">h</mi><mi id="S3.SS3.p2.17.m7.1.1.2.3" xref="S3.SS3.p2.17.m7.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS3.p2.17.m7.1.1.1" xref="S3.SS3.p2.17.m7.1.1.1.cmml">=</mo><mrow id="S3.SS3.p2.17.m7.1.1.3" xref="S3.SS3.p2.17.m7.1.1.3.cmml"><msub id="S3.SS3.p2.17.m7.1.1.3.2" xref="S3.SS3.p2.17.m7.1.1.3.2.cmml"><mover accent="true" id="S3.SS3.p2.17.m7.1.1.3.2.2" xref="S3.SS3.p2.17.m7.1.1.3.2.2.cmml"><mi id="S3.SS3.p2.17.m7.1.1.3.2.2.2" xref="S3.SS3.p2.17.m7.1.1.3.2.2.2.cmml">h</mi><mo id="S3.SS3.p2.17.m7.1.1.3.2.2.1" xref="S3.SS3.p2.17.m7.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.p2.17.m7.1.1.3.2.3" xref="S3.SS3.p2.17.m7.1.1.3.2.3.cmml">j</mi></msub><mo id="S3.SS3.p2.17.m7.1.1.3.1" xref="S3.SS3.p2.17.m7.1.1.3.1.cmml">+</mo><msub id="S3.SS3.p2.17.m7.1.1.3.3" xref="S3.SS3.p2.17.m7.1.1.3.3.cmml"><mi id="S3.SS3.p2.17.m7.1.1.3.3.2" xref="S3.SS3.p2.17.m7.1.1.3.3.2.cmml">c</mi><mi id="S3.SS3.p2.17.m7.1.1.3.3.3" xref="S3.SS3.p2.17.m7.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m7.1b"><apply id="S3.SS3.p2.17.m7.1.1.cmml" xref="S3.SS3.p2.17.m7.1.1"><eq id="S3.SS3.p2.17.m7.1.1.1.cmml" xref="S3.SS3.p2.17.m7.1.1.1"></eq><apply id="S3.SS3.p2.17.m7.1.1.2.cmml" xref="S3.SS3.p2.17.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.1.1.2.1.cmml" xref="S3.SS3.p2.17.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.17.m7.1.1.2.2.cmml" xref="S3.SS3.p2.17.m7.1.1.2.2">ℎ</ci><ci id="S3.SS3.p2.17.m7.1.1.2.3.cmml" xref="S3.SS3.p2.17.m7.1.1.2.3">𝑗</ci></apply><apply id="S3.SS3.p2.17.m7.1.1.3.cmml" xref="S3.SS3.p2.17.m7.1.1.3"><plus id="S3.SS3.p2.17.m7.1.1.3.1.cmml" xref="S3.SS3.p2.17.m7.1.1.3.1"></plus><apply id="S3.SS3.p2.17.m7.1.1.3.2.cmml" xref="S3.SS3.p2.17.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.1.1.3.2.1.cmml" xref="S3.SS3.p2.17.m7.1.1.3.2">subscript</csymbol><apply id="S3.SS3.p2.17.m7.1.1.3.2.2.cmml" xref="S3.SS3.p2.17.m7.1.1.3.2.2"><ci id="S3.SS3.p2.17.m7.1.1.3.2.2.1.cmml" xref="S3.SS3.p2.17.m7.1.1.3.2.2.1">~</ci><ci id="S3.SS3.p2.17.m7.1.1.3.2.2.2.cmml" xref="S3.SS3.p2.17.m7.1.1.3.2.2.2">ℎ</ci></apply><ci id="S3.SS3.p2.17.m7.1.1.3.2.3.cmml" xref="S3.SS3.p2.17.m7.1.1.3.2.3">𝑗</ci></apply><apply id="S3.SS3.p2.17.m7.1.1.3.3.cmml" xref="S3.SS3.p2.17.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m7.1.1.3.3.1.cmml" xref="S3.SS3.p2.17.m7.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p2.17.m7.1.1.3.3.2.cmml" xref="S3.SS3.p2.17.m7.1.1.3.3.2">𝑐</ci><ci id="S3.SS3.p2.17.m7.1.1.3.3.3.cmml" xref="S3.SS3.p2.17.m7.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m7.1c">h_{j}=\tilde{h}_{j}+c_{j}</annotation></semantics></math>, in our current work, we add an update gate and a reset gate to the residual composition. These two gates can reduce the effect of the gradient exploding/vanishing problems when applying a single node multiple times, which enables us to reuse the node module across multiple parse tree heights.
The update process is also similar to that in Child-Sum Tree-LSTMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, the LSTM cell calculates forget gates for each of the memories from its child; we simplify this process by first summing over the children’s hidden representation and outputting a single reset and forget gate for updating the hidden representation <math id="S3.SS3.p2.18.m8.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS3.p2.18.m8.1a"><msub id="S3.SS3.p2.18.m8.1.1" xref="S3.SS3.p2.18.m8.1.1.cmml"><mi id="S3.SS3.p2.18.m8.1.1.2" xref="S3.SS3.p2.18.m8.1.1.2.cmml">h</mi><mi id="S3.SS3.p2.18.m8.1.1.3" xref="S3.SS3.p2.18.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.18.m8.1b"><apply id="S3.SS3.p2.18.m8.1.1.cmml" xref="S3.SS3.p2.18.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m8.1.1.1.cmml" xref="S3.SS3.p2.18.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.18.m8.1.1.2.cmml" xref="S3.SS3.p2.18.m8.1.1.2">ℎ</ci><ci id="S3.SS3.p2.18.m8.1.1.3.cmml" xref="S3.SS3.p2.18.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.18.m8.1c">h_{j}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span><span id="S3.SS4.1.1" class="ltx_text ltx_font_italic">Parse-tree-guided propagation module</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.16" class="ltx_p">Given the edge <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="jk" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><times id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></times><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑗</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">jk</annotation></semantics></math>, the parse-tree-guided propagation module is used to transfer the hidden representation <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">h</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">ℎ</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">h_{j}</annotation></semantics></math> and the attention map encoding <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="h^{att}_{j}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msubsup id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2.2" xref="S3.SS4.p1.3.m3.1.1.2.2.cmml">h</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">j</mi><mrow id="S3.SS4.p1.3.m3.1.1.2.3" xref="S3.SS4.p1.3.m3.1.1.2.3.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2.3.2" xref="S3.SS4.p1.3.m3.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.1.2.3.1" xref="S3.SS4.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.3.m3.1.1.2.3.3" xref="S3.SS4.p1.3.m3.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.1.2.3.1a" xref="S3.SS4.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.3.m3.1.1.2.3.4" xref="S3.SS4.p1.3.m3.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2.2">ℎ</ci><apply id="S3.SS4.p1.3.m3.1.1.2.3.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3"><times id="S3.SS4.p1.3.m3.1.1.2.3.1.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3.1"></times><ci id="S3.SS4.p1.3.m3.1.1.2.3.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3.2">𝑎</ci><ci id="S3.SS4.p1.3.m3.1.1.2.3.3.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3.3">𝑡</ci><ci id="S3.SS4.p1.3.m3.1.1.2.3.4.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">h^{att}_{j}</annotation></semantics></math> of node <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">j</annotation></semantics></math> to messages <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="m^{h}_{jk}" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><msubsup id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2.2" xref="S3.SS4.p1.5.m5.1.1.2.2.cmml">m</mi><mrow id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.3.2" xref="S3.SS4.p1.5.m5.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m5.1.1.3.1" xref="S3.SS4.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.5.m5.1.1.3.3" xref="S3.SS4.p1.5.m5.1.1.3.3.cmml">k</mi></mrow><mi id="S3.SS4.p1.5.m5.1.1.2.3" xref="S3.SS4.p1.5.m5.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.2.1.cmml" xref="S3.SS4.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2.2">𝑚</ci><ci id="S3.SS4.p1.5.m5.1.1.2.3.cmml" xref="S3.SS4.p1.5.m5.1.1.2.3">ℎ</ci></apply><apply id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3"><times id="S3.SS4.p1.5.m5.1.1.3.1.cmml" xref="S3.SS4.p1.5.m5.1.1.3.1"></times><ci id="S3.SS4.p1.5.m5.1.1.3.2.cmml" xref="S3.SS4.p1.5.m5.1.1.3.2">𝑗</ci><ci id="S3.SS4.p1.5.m5.1.1.3.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">m^{h}_{jk}</annotation></semantics></math> and <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="m^{a}_{jk}" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><msubsup id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml"><mi id="S3.SS4.p1.6.m6.1.1.2.2" xref="S3.SS4.p1.6.m6.1.1.2.2.cmml">m</mi><mrow id="S3.SS4.p1.6.m6.1.1.3" xref="S3.SS4.p1.6.m6.1.1.3.cmml"><mi id="S3.SS4.p1.6.m6.1.1.3.2" xref="S3.SS4.p1.6.m6.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.1.1.3.1" xref="S3.SS4.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.6.m6.1.1.3.3" xref="S3.SS4.p1.6.m6.1.1.3.3.cmml">k</mi></mrow><mi id="S3.SS4.p1.6.m6.1.1.2.3" xref="S3.SS4.p1.6.m6.1.1.2.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS4.p1.6.m6.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.2.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2.2">𝑚</ci><ci id="S3.SS4.p1.6.m6.1.1.2.3.cmml" xref="S3.SS4.p1.6.m6.1.1.2.3">𝑎</ci></apply><apply id="S3.SS4.p1.6.m6.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3"><times id="S3.SS4.p1.6.m6.1.1.3.1.cmml" xref="S3.SS4.p1.6.m6.1.1.3.1"></times><ci id="S3.SS4.p1.6.m6.1.1.3.2.cmml" xref="S3.SS4.p1.6.m6.1.1.3.2">𝑗</ci><ci id="S3.SS4.p1.6.m6.1.1.3.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">m^{a}_{jk}</annotation></semantics></math> based on the edge type <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="e_{jk}" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><msub id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml">e</mi><mrow id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml"><mi id="S3.SS4.p1.7.m7.1.1.3.2" xref="S3.SS4.p1.7.m7.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m7.1.1.3.1" xref="S3.SS4.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.7.m7.1.1.3.3" xref="S3.SS4.p1.7.m7.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2">𝑒</ci><apply id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3"><times id="S3.SS4.p1.7.m7.1.1.3.1.cmml" xref="S3.SS4.p1.7.m7.1.1.3.1"></times><ci id="S3.SS4.p1.7.m7.1.1.3.2.cmml" xref="S3.SS4.p1.7.m7.1.1.3.2">𝑗</ci><ci id="S3.SS4.p1.7.m7.1.1.3.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">e_{jk}</annotation></semantics></math>, as shown in Figure <a href="#S3.F5" title="Figure 5 ‣ 3.1 Overview ‣ 3 Tree-Structured Composition Reasoning Network ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
This module to transfer the hidden representation to its parent node is based on the fine-grained dependency relation rather than directly blocking the hidden representation or the attention map based on two coarse-grained categories, namely, modifier relations and clausal predicate relations. For different types of edges, we apply the same module on hidden representation <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><msub id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><mi id="S3.SS4.p1.8.m8.1.1.2" xref="S3.SS4.p1.8.m8.1.1.2.cmml">h</mi><mi id="S3.SS4.p1.8.m8.1.1.3" xref="S3.SS4.p1.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2">ℎ</ci><ci id="S3.SS4.p1.8.m8.1.1.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">h_{j}</annotation></semantics></math> but with different sets of weights. The module performs multimodal bilinear pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> on the hidden representation <math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><msub id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml">h</mi><mi id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2">ℎ</ci><ci id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">h_{j}</annotation></semantics></math> and the question encoding <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mi id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><ci id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">q</annotation></semantics></math>. Then, it generates the message for its parent <math id="S3.SS4.p1.11.m11.1" class="ltx_Math" alttext="m^{h}_{jk}" display="inline"><semantics id="S3.SS4.p1.11.m11.1a"><msubsup id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml"><mi id="S3.SS4.p1.11.m11.1.1.2.2" xref="S3.SS4.p1.11.m11.1.1.2.2.cmml">m</mi><mrow id="S3.SS4.p1.11.m11.1.1.3" xref="S3.SS4.p1.11.m11.1.1.3.cmml"><mi id="S3.SS4.p1.11.m11.1.1.3.2" xref="S3.SS4.p1.11.m11.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.11.m11.1.1.3.1" xref="S3.SS4.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.11.m11.1.1.3.3" xref="S3.SS4.p1.11.m11.1.1.3.3.cmml">k</mi></mrow><mi id="S3.SS4.p1.11.m11.1.1.2.3" xref="S3.SS4.p1.11.m11.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><apply id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1">subscript</csymbol><apply id="S3.SS4.p1.11.m11.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.2.1.cmml" xref="S3.SS4.p1.11.m11.1.1">superscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.2.2.cmml" xref="S3.SS4.p1.11.m11.1.1.2.2">𝑚</ci><ci id="S3.SS4.p1.11.m11.1.1.2.3.cmml" xref="S3.SS4.p1.11.m11.1.1.2.3">ℎ</ci></apply><apply id="S3.SS4.p1.11.m11.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3"><times id="S3.SS4.p1.11.m11.1.1.3.1.cmml" xref="S3.SS4.p1.11.m11.1.1.3.1"></times><ci id="S3.SS4.p1.11.m11.1.1.3.2.cmml" xref="S3.SS4.p1.11.m11.1.1.3.2">𝑗</ci><ci id="S3.SS4.p1.11.m11.1.1.3.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">m^{h}_{jk}</annotation></semantics></math>.
Specifically, fully connected layers are applied to project both the hidden representation <math id="S3.SS4.p1.12.m12.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS4.p1.12.m12.1a"><msub id="S3.SS4.p1.12.m12.1.1" xref="S3.SS4.p1.12.m12.1.1.cmml"><mi id="S3.SS4.p1.12.m12.1.1.2" xref="S3.SS4.p1.12.m12.1.1.2.cmml">h</mi><mi id="S3.SS4.p1.12.m12.1.1.3" xref="S3.SS4.p1.12.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.1b"><apply id="S3.SS4.p1.12.m12.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.1.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS4.p1.12.m12.1.1.2.cmml" xref="S3.SS4.p1.12.m12.1.1.2">ℎ</ci><ci id="S3.SS4.p1.12.m12.1.1.3.cmml" xref="S3.SS4.p1.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.1c">h_{j}</annotation></semantics></math> and the question encoding <math id="S3.SS4.p1.13.m13.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS4.p1.13.m13.1a"><mi id="S3.SS4.p1.13.m13.1.1" xref="S3.SS4.p1.13.m13.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m13.1b"><ci id="S3.SS4.p1.13.m13.1.1.cmml" xref="S3.SS4.p1.13.m13.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m13.1c">q</annotation></semantics></math> into two feature vectors that have the same size as <math id="S3.SS4.p1.14.m14.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS4.p1.14.m14.1a"><msub id="S3.SS4.p1.14.m14.1.1" xref="S3.SS4.p1.14.m14.1.1.cmml"><mi id="S3.SS4.p1.14.m14.1.1.2" xref="S3.SS4.p1.14.m14.1.1.2.cmml">h</mi><mi id="S3.SS4.p1.14.m14.1.1.3" xref="S3.SS4.p1.14.m14.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.14.m14.1b"><apply id="S3.SS4.p1.14.m14.1.1.cmml" xref="S3.SS4.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.14.m14.1.1.1.cmml" xref="S3.SS4.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS4.p1.14.m14.1.1.2.cmml" xref="S3.SS4.p1.14.m14.1.1.2">ℎ</ci><ci id="S3.SS4.p1.14.m14.1.1.3.cmml" xref="S3.SS4.p1.14.m14.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.14.m14.1c">h_{j}</annotation></semantics></math>. Then, we perform elementwise multiplication on these two features and apply ReLU nonlinearity on the result. Finally, we add the result to <math id="S3.SS4.p1.15.m15.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S3.SS4.p1.15.m15.1a"><msub id="S3.SS4.p1.15.m15.1.1" xref="S3.SS4.p1.15.m15.1.1.cmml"><mi id="S3.SS4.p1.15.m15.1.1.2" xref="S3.SS4.p1.15.m15.1.1.2.cmml">h</mi><mi id="S3.SS4.p1.15.m15.1.1.3" xref="S3.SS4.p1.15.m15.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.15.m15.1b"><apply id="S3.SS4.p1.15.m15.1.1.cmml" xref="S3.SS4.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m15.1.1.1.cmml" xref="S3.SS4.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS4.p1.15.m15.1.1.2.cmml" xref="S3.SS4.p1.15.m15.1.1.2">ℎ</ci><ci id="S3.SS4.p1.15.m15.1.1.3.cmml" xref="S3.SS4.p1.15.m15.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.15.m15.1c">h_{j}</annotation></semantics></math>, resulting in a hidden vector <math id="S3.SS4.p1.16.m16.1" class="ltx_Math" alttext="m^{h}_{jk}" display="inline"><semantics id="S3.SS4.p1.16.m16.1a"><msubsup id="S3.SS4.p1.16.m16.1.1" xref="S3.SS4.p1.16.m16.1.1.cmml"><mi id="S3.SS4.p1.16.m16.1.1.2.2" xref="S3.SS4.p1.16.m16.1.1.2.2.cmml">m</mi><mrow id="S3.SS4.p1.16.m16.1.1.3" xref="S3.SS4.p1.16.m16.1.1.3.cmml"><mi id="S3.SS4.p1.16.m16.1.1.3.2" xref="S3.SS4.p1.16.m16.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.16.m16.1.1.3.1" xref="S3.SS4.p1.16.m16.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.16.m16.1.1.3.3" xref="S3.SS4.p1.16.m16.1.1.3.3.cmml">k</mi></mrow><mi id="S3.SS4.p1.16.m16.1.1.2.3" xref="S3.SS4.p1.16.m16.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.16.m16.1b"><apply id="S3.SS4.p1.16.m16.1.1.cmml" xref="S3.SS4.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.1.cmml" xref="S3.SS4.p1.16.m16.1.1">subscript</csymbol><apply id="S3.SS4.p1.16.m16.1.1.2.cmml" xref="S3.SS4.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.2.1.cmml" xref="S3.SS4.p1.16.m16.1.1">superscript</csymbol><ci id="S3.SS4.p1.16.m16.1.1.2.2.cmml" xref="S3.SS4.p1.16.m16.1.1.2.2">𝑚</ci><ci id="S3.SS4.p1.16.m16.1.1.2.3.cmml" xref="S3.SS4.p1.16.m16.1.1.2.3">ℎ</ci></apply><apply id="S3.SS4.p1.16.m16.1.1.3.cmml" xref="S3.SS4.p1.16.m16.1.1.3"><times id="S3.SS4.p1.16.m16.1.1.3.1.cmml" xref="S3.SS4.p1.16.m16.1.1.3.1"></times><ci id="S3.SS4.p1.16.m16.1.1.3.2.cmml" xref="S3.SS4.p1.16.m16.1.1.3.2">𝑗</ci><ci id="S3.SS4.p1.16.m16.1.1.3.3.cmml" xref="S3.SS4.p1.16.m16.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.16.m16.1c">m^{h}_{jk}</annotation></semantics></math> that will be passed through the edge.</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="m^{h}_{jk}=h_{j}+ReLU((W^{h}_{e_{jk}}\cdot h_{j}+b^{h}_{e_{jk}})*(W^{q}_{e_{jk}}\cdot q+b^{q}_{e_{jk}}))" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.3.2.2" xref="S3.E2.m1.1.1.3.2.2.cmml">m</mi><mrow id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.3.3.2" xref="S3.E2.m1.1.1.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.3.3.1" xref="S3.E2.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.3.3.3" xref="S3.E2.m1.1.1.3.3.3.cmml">k</mi></mrow><mi id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml">h</mi></msubsup><mo id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">h</mi><mi id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2a" xref="S3.E2.m1.1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.5" xref="S3.E2.m1.1.1.1.1.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2b" xref="S3.E2.m1.1.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.6" xref="S3.E2.m1.1.1.1.1.6.cmml">U</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2c" xref="S3.E2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">e</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml">k</mi></mrow></msub><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">h</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">b</mi><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">e</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">k</mi></mrow></msub><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">h</mi></msubsup></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml">∗</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.cmml"><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.2.cmml">W</mi><msub id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.2.cmml">e</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.3.cmml">k</mi></mrow></msub><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.3.cmml">q</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.1.cmml">⋅</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.3.cmml">q</mi></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.1.cmml">+</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.2.cmml">b</mi><msub id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.2.cmml">e</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.3.cmml">k</mi></mrow></msub><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.3.cmml">q</mi></msubsup></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"></eq><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3">subscript</csymbol><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2">𝑚</ci><ci id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3">ℎ</ci></apply><apply id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3"><times id="S3.E2.m1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.3.3.2">𝑗</ci><ci id="S3.E2.m1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><plus id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></plus><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">ℎ</ci><ci id="S3.E2.m1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3">𝑅</ci><ci id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4">𝑒</ci><ci id="S3.E2.m1.1.1.1.1.5.cmml" xref="S3.E2.m1.1.1.1.1.5">𝐿</ci><ci id="S3.E2.m1.1.1.1.1.6.cmml" xref="S3.E2.m1.1.1.1.1.6">𝑈</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><plus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1">⋅</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">ℎ</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑒</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.2">𝑗</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑏</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">ℎ</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑒</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑗</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1"><plus id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.1"></plus><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.1">⋅</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.2">𝑊</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.2.3">𝑞</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.2">𝑒</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.2">𝑗</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.2.3.3.3">𝑘</ci></apply></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.2.3">𝑞</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.2">𝑏</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.2.3">𝑞</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.2">𝑒</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.2">𝑗</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">m^{h}_{jk}=h_{j}+ReLU((W^{h}_{e_{jk}}\cdot h_{j}+b^{h}_{e_{jk}})*(W^{q}_{e_{jk}}\cdot q+b^{q}_{e_{jk}}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.19" class="ltx_p">Here, <math id="S3.SS4.p1.17.m1.1" class="ltx_Math" alttext="e_{jk}" display="inline"><semantics id="S3.SS4.p1.17.m1.1a"><msub id="S3.SS4.p1.17.m1.1.1" xref="S3.SS4.p1.17.m1.1.1.cmml"><mi id="S3.SS4.p1.17.m1.1.1.2" xref="S3.SS4.p1.17.m1.1.1.2.cmml">e</mi><mrow id="S3.SS4.p1.17.m1.1.1.3" xref="S3.SS4.p1.17.m1.1.1.3.cmml"><mi id="S3.SS4.p1.17.m1.1.1.3.2" xref="S3.SS4.p1.17.m1.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.17.m1.1.1.3.1" xref="S3.SS4.p1.17.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.17.m1.1.1.3.3" xref="S3.SS4.p1.17.m1.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.17.m1.1b"><apply id="S3.SS4.p1.17.m1.1.1.cmml" xref="S3.SS4.p1.17.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m1.1.1.1.cmml" xref="S3.SS4.p1.17.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.17.m1.1.1.2.cmml" xref="S3.SS4.p1.17.m1.1.1.2">𝑒</ci><apply id="S3.SS4.p1.17.m1.1.1.3.cmml" xref="S3.SS4.p1.17.m1.1.1.3"><times id="S3.SS4.p1.17.m1.1.1.3.1.cmml" xref="S3.SS4.p1.17.m1.1.1.3.1"></times><ci id="S3.SS4.p1.17.m1.1.1.3.2.cmml" xref="S3.SS4.p1.17.m1.1.1.3.2">𝑗</ci><ci id="S3.SS4.p1.17.m1.1.1.3.3.cmml" xref="S3.SS4.p1.17.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.17.m1.1c">e_{jk}</annotation></semantics></math> indicates the type of dependency relation between node <math id="S3.SS4.p1.18.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.18.m2.1a"><mi id="S3.SS4.p1.18.m2.1.1" xref="S3.SS4.p1.18.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.18.m2.1b"><ci id="S3.SS4.p1.18.m2.1.1.cmml" xref="S3.SS4.p1.18.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.18.m2.1c">j</annotation></semantics></math> and its parent node <math id="S3.SS4.p1.19.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p1.19.m3.1a"><mi id="S3.SS4.p1.19.m3.1.1" xref="S3.SS4.p1.19.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.19.m3.1b"><ci id="S3.SS4.p1.19.m3.1.1.cmml" xref="S3.SS4.p1.19.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.19.m3.1c">k</annotation></semantics></math>.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.4" class="ltx_p">When propagating the attention map encoding <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="att_{j}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.1a" xref="S3.SS4.p2.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS4.p2.1.m1.1.1.4" xref="S3.SS4.p2.1.m1.1.1.4.cmml"><mi id="S3.SS4.p2.1.m1.1.1.4.2" xref="S3.SS4.p2.1.m1.1.1.4.2.cmml">t</mi><mi id="S3.SS4.p2.1.m1.1.1.4.3" xref="S3.SS4.p2.1.m1.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><times id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"></times><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝑎</ci><ci id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3">𝑡</ci><apply id="S3.SS4.p2.1.m1.1.1.4.cmml" xref="S3.SS4.p2.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.4.1.cmml" xref="S3.SS4.p2.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.4.2.cmml" xref="S3.SS4.p2.1.m1.1.1.4.2">𝑡</ci><ci id="S3.SS4.p2.1.m1.1.1.4.3.cmml" xref="S3.SS4.p2.1.m1.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">att_{j}</annotation></semantics></math>, we use convolution to project <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="att_{j}" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mrow id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.1.1.1a" xref="S3.SS4.p2.2.m2.1.1.1.cmml">​</mo><msub id="S3.SS4.p2.2.m2.1.1.4" xref="S3.SS4.p2.2.m2.1.1.4.cmml"><mi id="S3.SS4.p2.2.m2.1.1.4.2" xref="S3.SS4.p2.2.m2.1.1.4.2.cmml">t</mi><mi id="S3.SS4.p2.2.m2.1.1.4.3" xref="S3.SS4.p2.2.m2.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><times id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1"></times><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">𝑎</ci><ci id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">𝑡</ci><apply id="S3.SS4.p2.2.m2.1.1.4.cmml" xref="S3.SS4.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.4.1.cmml" xref="S3.SS4.p2.2.m2.1.1.4">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.4.2.cmml" xref="S3.SS4.p2.2.m2.1.1.4.2">𝑡</ci><ci id="S3.SS4.p2.2.m2.1.1.4.3.cmml" xref="S3.SS4.p2.2.m2.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">att_{j}</annotation></semantics></math>, as shown in Figure <a href="#S3.F5" title="Figure 5 ‣ 3.1 Overview ‣ 3 Tree-Structured Composition Reasoning Network ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. There are a total of <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="22" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><mn id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml">22</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><cn type="integer" id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">22</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">22</annotation></semantics></math> relation types that reside in the dependency parse tree for questions in the CLEVR dataset; thus, we have <math id="S3.SS4.p2.4.m4.2" class="ltx_Math" alttext="e_{jk}\in[1,22]" display="inline"><semantics id="S3.SS4.p2.4.m4.2a"><mrow id="S3.SS4.p2.4.m4.2.3" xref="S3.SS4.p2.4.m4.2.3.cmml"><msub id="S3.SS4.p2.4.m4.2.3.2" xref="S3.SS4.p2.4.m4.2.3.2.cmml"><mi id="S3.SS4.p2.4.m4.2.3.2.2" xref="S3.SS4.p2.4.m4.2.3.2.2.cmml">e</mi><mrow id="S3.SS4.p2.4.m4.2.3.2.3" xref="S3.SS4.p2.4.m4.2.3.2.3.cmml"><mi id="S3.SS4.p2.4.m4.2.3.2.3.2" xref="S3.SS4.p2.4.m4.2.3.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.2.3.2.3.1" xref="S3.SS4.p2.4.m4.2.3.2.3.1.cmml">​</mo><mi id="S3.SS4.p2.4.m4.2.3.2.3.3" xref="S3.SS4.p2.4.m4.2.3.2.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS4.p2.4.m4.2.3.1" xref="S3.SS4.p2.4.m4.2.3.1.cmml">∈</mo><mrow id="S3.SS4.p2.4.m4.2.3.3.2" xref="S3.SS4.p2.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p2.4.m4.2.3.3.2.1" xref="S3.SS4.p2.4.m4.2.3.3.1.cmml">[</mo><mn id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">1</mn><mo id="S3.SS4.p2.4.m4.2.3.3.2.2" xref="S3.SS4.p2.4.m4.2.3.3.1.cmml">,</mo><mn id="S3.SS4.p2.4.m4.2.2" xref="S3.SS4.p2.4.m4.2.2.cmml">22</mn><mo stretchy="false" id="S3.SS4.p2.4.m4.2.3.3.2.3" xref="S3.SS4.p2.4.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.2b"><apply id="S3.SS4.p2.4.m4.2.3.cmml" xref="S3.SS4.p2.4.m4.2.3"><in id="S3.SS4.p2.4.m4.2.3.1.cmml" xref="S3.SS4.p2.4.m4.2.3.1"></in><apply id="S3.SS4.p2.4.m4.2.3.2.cmml" xref="S3.SS4.p2.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.2.3.2.1.cmml" xref="S3.SS4.p2.4.m4.2.3.2">subscript</csymbol><ci id="S3.SS4.p2.4.m4.2.3.2.2.cmml" xref="S3.SS4.p2.4.m4.2.3.2.2">𝑒</ci><apply id="S3.SS4.p2.4.m4.2.3.2.3.cmml" xref="S3.SS4.p2.4.m4.2.3.2.3"><times id="S3.SS4.p2.4.m4.2.3.2.3.1.cmml" xref="S3.SS4.p2.4.m4.2.3.2.3.1"></times><ci id="S3.SS4.p2.4.m4.2.3.2.3.2.cmml" xref="S3.SS4.p2.4.m4.2.3.2.3.2">𝑗</ci><ci id="S3.SS4.p2.4.m4.2.3.2.3.3.cmml" xref="S3.SS4.p2.4.m4.2.3.2.3.3">𝑘</ci></apply></apply><interval closure="closed" id="S3.SS4.p2.4.m4.2.3.3.1.cmml" xref="S3.SS4.p2.4.m4.2.3.3.2"><cn type="integer" id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">1</cn><cn type="integer" id="S3.SS4.p2.4.m4.2.2.cmml" xref="S3.SS4.p2.4.m4.2.2">22</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.2c">e_{jk}\in[1,22]</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span><span id="S3.SS5.1.1" class="ltx_text ltx_font_italic">The proposed PTGRN model</span>
</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.6" class="ltx_p">Given the tree-structured layout of the dependency tree, our PTGRN module is sequentially used on each word node to mine visual evidence and integrate features of its child nodes from bottom to top, and then it predicts the final answer at the root of the tree.
Formally, each PTGRN module can be written as</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{att}_{j}" display="inline"><semantics id="S3.E3X.2.1.1.m1.1a"><mrow id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.1.1.1a" xref="S3.E3X.2.1.1.m1.1.1.1.cmml">​</mo><msub id="S3.E3X.2.1.1.m1.1.1.4" xref="S3.E3X.2.1.1.m1.1.1.4.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.4.2" xref="S3.E3X.2.1.1.m1.1.1.4.2.cmml">t</mi><mi id="S3.E3X.2.1.1.m1.1.1.4.3" xref="S3.E3X.2.1.1.m1.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1"><times id="S3.E3X.2.1.1.m1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1"></times><ci id="S3.E3X.2.1.1.m1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2">𝑎</ci><ci id="S3.E3X.2.1.1.m1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.3">𝑡</ci><apply id="S3.E3X.2.1.1.m1.1.1.4.cmml" xref="S3.E3X.2.1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.4.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.4">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.4.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.4.2">𝑡</ci><ci id="S3.E3X.2.1.1.m1.1.1.4.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle{att}_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=f_{a}(\{m^{a}_{ij}\}_{e_{ij}\in E},v,w)," display="inline"><semantics id="S3.E3X.3.2.2.m1.3a"><mrow id="S3.E3X.3.2.2.m1.3.3.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E3X.3.2.2.m1.3.3.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.1.1.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.3.cmml"></mi><mo id="S3.E3X.3.2.2.m1.3.3.1.1.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.3.3.1.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.cmml"><msub id="S3.E3X.3.2.2.m1.3.3.1.1.1.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.3.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.3.2.cmml">f</mi><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.3.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.3.3.1.1.1.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml"><msub id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">e</mi><mrow id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.1.cmml">∈</mo><mi id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.cmml">E</mi></mrow></msub><mo id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.1.1" xref="S3.E3X.3.2.2.m1.1.1.cmml">v</mi><mo id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.4" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.2.2" xref="S3.E3X.3.2.2.m1.2.2.cmml">w</mi><mo stretchy="false" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.5" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3X.3.2.2.m1.3.3.1.2" xref="S3.E3X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.3b"><apply id="S3.E3X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1"><eq id="S3.E3X.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.3">absent</csymbol><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1"><times id="S3.E3X.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.2"></times><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.3.3.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.3.2">𝑓</ci><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.3.3">𝑎</ci></apply><vector id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1"><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><set id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑚</ci><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3"><times id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></set><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3"><in id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.1"></in><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.2">𝑒</ci><apply id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3"><times id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1.1.1.1.1.3.3">𝐸</ci></apply></apply><ci id="S3.E3X.3.2.2.m1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1">𝑣</ci><ci id="S3.E3X.3.2.2.m1.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2">𝑤</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.3c">\displaystyle=f_{a}(\{m^{a}_{ij}\}_{e_{ij}\in E},v,w),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="6" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle v_{j}" display="inline"><semantics id="S3.E3Xa.2.1.1.m1.1a"><msub id="S3.E3Xa.2.1.1.m1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.2.cmml">v</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.1b"><apply id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2">𝑣</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.1c">\displaystyle v_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle={att}_{j}*v," display="inline"><semantics id="S3.E3Xa.3.2.2.m1.1a"><mrow id="S3.E3Xa.3.2.2.m1.1.1.1" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E3Xa.3.2.2.m1.1.1.1.1" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E3Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S3.E3Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.cmml"><mrow id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.1" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml">​</mo><mi id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.1a" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.cmml"><mi id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.2" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.2.cmml">t</mi><mi id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.3" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.3.cmml">j</mi></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.1" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.1.cmml">∗</mo><mi id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.3" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.3.cmml">v</mi></mrow></mrow><mo id="S3.E3Xa.3.2.2.m1.1.1.1.2" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.3.2.2.m1.1b"><apply id="S3.E3Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1"><eq id="S3.E3Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E3Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3"><times id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.1"></times><apply id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2"><times id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.1"></times><ci id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.2">𝑎</ci><ci id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.3">𝑡</ci><apply id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4">subscript</csymbol><ci id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.2.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.2">𝑡</ci><ci id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.3.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.2.4.3">𝑗</ci></apply></apply><ci id="S3.E3Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.3.2.2.m1.1c">\displaystyle={att}_{j}*v,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{h}_{j}" display="inline"><semantics id="S3.E3Xb.2.1.1.m1.1a"><msub id="S3.E3Xb.2.1.1.m1.1.1" xref="S3.E3Xb.2.1.1.m1.1.1.cmml"><mi id="S3.E3Xb.2.1.1.m1.1.1.2" xref="S3.E3Xb.2.1.1.m1.1.1.2.cmml">h</mi><mi id="S3.E3Xb.2.1.1.m1.1.1.3" xref="S3.E3Xb.2.1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E3Xb.2.1.1.m1.1b"><apply id="S3.E3Xb.2.1.1.m1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E3Xb.2.1.1.m1.1.1.2">ℎ</ci><ci id="S3.E3Xb.2.1.1.m1.1.1.3.cmml" xref="S3.E3Xb.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.2.1.1.m1.1c">\displaystyle{h}_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xb.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=f_{h}(\{m^{h}_{ij}\}_{e_{ij}\in E},v_{j})," display="inline"><semantics id="S3.E3Xb.3.2.2.m1.1a"><mrow id="S3.E3Xb.3.2.2.m1.1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E3Xb.3.2.2.m1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.4" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.4.cmml"></mi><mo id="S3.E3Xb.3.2.2.m1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E3Xb.3.2.2.m1.1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.cmml"><msub id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.2.cmml">f</mi><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">e</mi><mrow id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml">∈</mo><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml">E</mi></mrow></msub><mo id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.4" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mi id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.3" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.5" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3Xb.3.2.2.m1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xb.3.2.2.m1.1b"><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1"><eq id="S3.E3Xb.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E3Xb.3.2.2.m1.1.1.1.1.4.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.4">absent</csymbol><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2"><times id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.3"></times><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.2">𝑓</ci><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.4.3">ℎ</ci></apply><interval closure="open" id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2"><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><set id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑚</ci><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></set><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3"><in id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.1"></in><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2">𝑒</ci><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3"><times id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.3">𝐸</ci></apply></apply><apply id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.2">𝑣</ci><ci id="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.3.2.2.m1.1c">\displaystyle=f_{h}(\{m^{h}_{ij}\}_{e_{ij}\in E},v_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{h}^{att}_{j}" display="inline"><semantics id="S3.E3Xc.2.1.1.m1.1a"><msubsup id="S3.E3Xc.2.1.1.m1.1.1" xref="S3.E3Xc.2.1.1.m1.1.1.cmml"><mi id="S3.E3Xc.2.1.1.m1.1.1.2.2" xref="S3.E3Xc.2.1.1.m1.1.1.2.2.cmml">h</mi><mi id="S3.E3Xc.2.1.1.m1.1.1.3" xref="S3.E3Xc.2.1.1.m1.1.1.3.cmml">j</mi><mrow id="S3.E3Xc.2.1.1.m1.1.1.2.3" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E3Xc.2.1.1.m1.1.1.2.3.2" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.2.1.1.m1.1.1.2.3.1" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E3Xc.2.1.1.m1.1.1.2.3.3" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.2.1.1.m1.1.1.2.3.1a" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E3Xc.2.1.1.m1.1.1.2.3.4" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E3Xc.2.1.1.m1.1b"><apply id="S3.E3Xc.2.1.1.m1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xc.2.1.1.m1.1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.1.1">subscript</csymbol><apply id="S3.E3Xc.2.1.1.m1.1.1.2.cmml" xref="S3.E3Xc.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xc.2.1.1.m1.1.1.2.1.cmml" xref="S3.E3Xc.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E3Xc.2.1.1.m1.1.1.2.2.cmml" xref="S3.E3Xc.2.1.1.m1.1.1.2.2">ℎ</ci><apply id="S3.E3Xc.2.1.1.m1.1.1.2.3.cmml" xref="S3.E3Xc.2.1.1.m1.1.1.2.3"><times id="S3.E3Xc.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.1"></times><ci id="S3.E3Xc.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.2">𝑎</ci><ci id="S3.E3Xc.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.3">𝑡</ci><ci id="S3.E3Xc.2.1.1.m1.1.1.2.3.4.cmml" xref="S3.E3Xc.2.1.1.m1.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S3.E3Xc.2.1.1.m1.1.1.3.cmml" xref="S3.E3Xc.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xc.2.1.1.m1.1c">\displaystyle{h}^{att}_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xc.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=f^{att}_{h}(\{m^{a}_{ij}\}_{e_{ij}\in E},att_{j})," display="inline"><semantics id="S3.E3Xc.3.2.2.m1.1a"><mrow id="S3.E3Xc.3.2.2.m1.1.1.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.4" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.4.cmml"></mi><mo id="S3.E3Xc.3.2.2.m1.1.1.1.1.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.cmml"><msubsup id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.2.cmml">f</mi><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.3.cmml">h</mi><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.1.cmml">​</mo><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.1a" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.1.cmml">​</mo><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.4" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.4.cmml">t</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">e</mi><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml">∈</mo><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml">E</mi></mrow></msub><mo id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.4" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.1" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.1.cmml">​</mo><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.1a" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.1.cmml">​</mo><msub id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.cmml"><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.2.cmml">t</mi><mi id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.3" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.5" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3Xc.3.2.2.m1.1.1.1.2" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xc.3.2.2.m1.1b"><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1"><eq id="S3.E3Xc.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E3Xc.3.2.2.m1.1.1.1.1.4.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.4">absent</csymbol><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2"><times id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.3"></times><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4">subscript</csymbol><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4">superscript</csymbol><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.2">𝑓</ci><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3"><times id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.1"></times><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.2">𝑎</ci><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.3">𝑡</ci><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.4.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.2.3.4">𝑡</ci></apply></apply><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.4.3">ℎ</ci></apply><interval closure="open" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2"><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><set id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑚</ci><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></set><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3"><in id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.1"></in><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2">𝑒</ci><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3"><times id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3">𝐸</ci></apply></apply><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2"><times id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.1"></times><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3">𝑡</ci><apply id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.1.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4">subscript</csymbol><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.2.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.2">𝑡</ci><ci id="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.3.cmml" xref="S3.E3Xc.3.2.2.m1.1.1.1.1.2.2.2.2.4.3">𝑗</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xc.3.2.2.m1.1c">\displaystyle=f^{att}_{h}(\{m^{a}_{ij}\}_{e_{ij}\in E},att_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xd" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3Xd.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle m^{h}_{jk}" display="inline"><semantics id="S3.E3Xd.2.1.1.m1.1a"><msubsup id="S3.E3Xd.2.1.1.m1.1.1" xref="S3.E3Xd.2.1.1.m1.1.1.cmml"><mi id="S3.E3Xd.2.1.1.m1.1.1.2.2" xref="S3.E3Xd.2.1.1.m1.1.1.2.2.cmml">m</mi><mrow id="S3.E3Xd.2.1.1.m1.1.1.3" xref="S3.E3Xd.2.1.1.m1.1.1.3.cmml"><mi id="S3.E3Xd.2.1.1.m1.1.1.3.2" xref="S3.E3Xd.2.1.1.m1.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E3Xd.2.1.1.m1.1.1.3.1" xref="S3.E3Xd.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.E3Xd.2.1.1.m1.1.1.3.3" xref="S3.E3Xd.2.1.1.m1.1.1.3.3.cmml">k</mi></mrow><mi id="S3.E3Xd.2.1.1.m1.1.1.2.3" xref="S3.E3Xd.2.1.1.m1.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E3Xd.2.1.1.m1.1b"><apply id="S3.E3Xd.2.1.1.m1.1.1.cmml" xref="S3.E3Xd.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xd.2.1.1.m1.1.1.1.cmml" xref="S3.E3Xd.2.1.1.m1.1.1">subscript</csymbol><apply id="S3.E3Xd.2.1.1.m1.1.1.2.cmml" xref="S3.E3Xd.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xd.2.1.1.m1.1.1.2.1.cmml" xref="S3.E3Xd.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E3Xd.2.1.1.m1.1.1.2.2.cmml" xref="S3.E3Xd.2.1.1.m1.1.1.2.2">𝑚</ci><ci id="S3.E3Xd.2.1.1.m1.1.1.2.3.cmml" xref="S3.E3Xd.2.1.1.m1.1.1.2.3">ℎ</ci></apply><apply id="S3.E3Xd.2.1.1.m1.1.1.3.cmml" xref="S3.E3Xd.2.1.1.m1.1.1.3"><times id="S3.E3Xd.2.1.1.m1.1.1.3.1.cmml" xref="S3.E3Xd.2.1.1.m1.1.1.3.1"></times><ci id="S3.E3Xd.2.1.1.m1.1.1.3.2.cmml" xref="S3.E3Xd.2.1.1.m1.1.1.3.2">𝑗</ci><ci id="S3.E3Xd.2.1.1.m1.1.1.3.3.cmml" xref="S3.E3Xd.2.1.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xd.2.1.1.m1.1c">\displaystyle m^{h}_{jk}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xd.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=f^{h}_{e_{jk}}({h}_{j},q)," display="inline"><semantics id="S3.E3Xd.3.2.2.m1.2a"><mrow id="S3.E3Xd.3.2.2.m1.2.2.1" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.cmml"><mrow id="S3.E3Xd.3.2.2.m1.2.2.1.1" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.3.cmml"></mi><mo id="S3.E3Xd.3.2.2.m1.2.2.1.1.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E3Xd.3.2.2.m1.2.2.1.1.1" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.cmml"><msubsup id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.2.cmml">f</mi><msub id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.cmml"><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.2.cmml">e</mi><mrow id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.cmml"><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.1" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.3.cmml">k</mi></mrow></msub><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.3.cmml">h</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E3Xd.3.2.2.m1.1.1" xref="S3.E3Xd.3.2.2.m1.1.1.cmml">q</mi><mo stretchy="false" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.4" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3Xd.3.2.2.m1.2.2.1.2" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xd.3.2.2.m1.2b"><apply id="S3.E3Xd.3.2.2.m1.2.2.1.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1"><eq id="S3.E3Xd.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E3Xd.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.3">absent</csymbol><apply id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1"><times id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3">subscript</csymbol><apply id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.2">𝑓</ci><ci id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.3.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.2.3">ℎ</ci></apply><apply id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.2">𝑒</ci><apply id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3"><times id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.1"></times><ci id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.2">𝑗</ci><ci id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.3.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply><interval closure="open" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1"><apply id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3Xd.3.2.2.m1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E3Xd.3.2.2.m1.1.1.cmml" xref="S3.E3Xd.3.2.2.m1.1.1">𝑞</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xd.3.2.2.m1.2c">\displaystyle=f^{h}_{e_{jk}}({h}_{j},q),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xe" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3Xe.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle m^{a}_{jk}" display="inline"><semantics id="S3.E3Xe.2.1.1.m1.1a"><msubsup id="S3.E3Xe.2.1.1.m1.1.1" xref="S3.E3Xe.2.1.1.m1.1.1.cmml"><mi id="S3.E3Xe.2.1.1.m1.1.1.2.2" xref="S3.E3Xe.2.1.1.m1.1.1.2.2.cmml">m</mi><mrow id="S3.E3Xe.2.1.1.m1.1.1.3" xref="S3.E3Xe.2.1.1.m1.1.1.3.cmml"><mi id="S3.E3Xe.2.1.1.m1.1.1.3.2" xref="S3.E3Xe.2.1.1.m1.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E3Xe.2.1.1.m1.1.1.3.1" xref="S3.E3Xe.2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.E3Xe.2.1.1.m1.1.1.3.3" xref="S3.E3Xe.2.1.1.m1.1.1.3.3.cmml">k</mi></mrow><mi id="S3.E3Xe.2.1.1.m1.1.1.2.3" xref="S3.E3Xe.2.1.1.m1.1.1.2.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E3Xe.2.1.1.m1.1b"><apply id="S3.E3Xe.2.1.1.m1.1.1.cmml" xref="S3.E3Xe.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xe.2.1.1.m1.1.1.1.cmml" xref="S3.E3Xe.2.1.1.m1.1.1">subscript</csymbol><apply id="S3.E3Xe.2.1.1.m1.1.1.2.cmml" xref="S3.E3Xe.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xe.2.1.1.m1.1.1.2.1.cmml" xref="S3.E3Xe.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E3Xe.2.1.1.m1.1.1.2.2.cmml" xref="S3.E3Xe.2.1.1.m1.1.1.2.2">𝑚</ci><ci id="S3.E3Xe.2.1.1.m1.1.1.2.3.cmml" xref="S3.E3Xe.2.1.1.m1.1.1.2.3">𝑎</ci></apply><apply id="S3.E3Xe.2.1.1.m1.1.1.3.cmml" xref="S3.E3Xe.2.1.1.m1.1.1.3"><times id="S3.E3Xe.2.1.1.m1.1.1.3.1.cmml" xref="S3.E3Xe.2.1.1.m1.1.1.3.1"></times><ci id="S3.E3Xe.2.1.1.m1.1.1.3.2.cmml" xref="S3.E3Xe.2.1.1.m1.1.1.3.2">𝑗</ci><ci id="S3.E3Xe.2.1.1.m1.1.1.3.3.cmml" xref="S3.E3Xe.2.1.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xe.2.1.1.m1.1c">\displaystyle m^{a}_{jk}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xe.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=f^{a}_{e_{jk}}({h}^{att}_{j},q)" display="inline"><semantics id="S3.E3Xe.3.2.2.m1.2a"><mrow id="S3.E3Xe.3.2.2.m1.2.2" xref="S3.E3Xe.3.2.2.m1.2.2.cmml"><mi id="S3.E3Xe.3.2.2.m1.2.2.3" xref="S3.E3Xe.3.2.2.m1.2.2.3.cmml"></mi><mo id="S3.E3Xe.3.2.2.m1.2.2.2" xref="S3.E3Xe.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S3.E3Xe.3.2.2.m1.2.2.1" xref="S3.E3Xe.3.2.2.m1.2.2.1.cmml"><msubsup id="S3.E3Xe.3.2.2.m1.2.2.1.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.cmml"><mi id="S3.E3Xe.3.2.2.m1.2.2.1.3.2.2" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.2.2.cmml">f</mi><msub id="S3.E3Xe.3.2.2.m1.2.2.1.3.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.cmml"><mi id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.2" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.2.cmml">e</mi><mrow id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.cmml"><mi id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.2" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.1" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.1.cmml">​</mo><mi id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.3.cmml">k</mi></mrow></msub><mi id="S3.E3Xe.3.2.2.m1.2.2.1.3.2.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.2.3.cmml">a</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3Xe.3.2.2.m1.2.2.1.2" xref="S3.E3Xe.3.2.2.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E3Xe.3.2.2.m1.2.2.1.1.1" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.2" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.2.cmml">(</mo><msubsup id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.cmml"><mi id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.2" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.3.cmml">j</mi><mrow id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.2" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.1" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.1a" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.4" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.4.cmml">t</mi></mrow></msubsup><mo id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.3" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.2.cmml">,</mo><mi id="S3.E3Xe.3.2.2.m1.1.1" xref="S3.E3Xe.3.2.2.m1.1.1.cmml">q</mi><mo stretchy="false" id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.4" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xe.3.2.2.m1.2b"><apply id="S3.E3Xe.3.2.2.m1.2.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2"><eq id="S3.E3Xe.3.2.2.m1.2.2.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S3.E3Xe.3.2.2.m1.2.2.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.3">absent</csymbol><apply id="S3.E3Xe.3.2.2.m1.2.2.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1"><times id="S3.E3Xe.3.2.2.m1.2.2.1.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.2"></times><apply id="S3.E3Xe.3.2.2.m1.2.2.1.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3Xe.3.2.2.m1.2.2.1.3.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3">subscript</csymbol><apply id="S3.E3Xe.3.2.2.m1.2.2.1.3.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3Xe.3.2.2.m1.2.2.1.3.2.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3">superscript</csymbol><ci id="S3.E3Xe.3.2.2.m1.2.2.1.3.2.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.2.2">𝑓</ci><ci id="S3.E3Xe.3.2.2.m1.2.2.1.3.2.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.2.3">𝑎</ci></apply><apply id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3">subscript</csymbol><ci id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.2">𝑒</ci><apply id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3"><times id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.1"></times><ci id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.2">𝑗</ci><ci id="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.3.3.3.3">𝑘</ci></apply></apply></apply><interval closure="open" id="S3.E3Xe.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1"><apply id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1">subscript</csymbol><apply id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.2">ℎ</ci><apply id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3"><times id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.1"></times><ci id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.2">𝑎</ci><ci id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.3">𝑡</ci><ci id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.4.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3Xe.3.2.2.m1.2.2.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E3Xe.3.2.2.m1.1.1.cmml" xref="S3.E3Xe.3.2.2.m1.1.1">𝑞</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xe.3.2.2.m1.2c">\displaystyle=f^{a}_{e_{jk}}({h}^{att}_{j},q)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS5.p1.5" class="ltx_p">We process each node by postorder traversing on the dependency tree. The type of edge indicates whether a node serves as a modifier, which can modify their parent node by referring to a more specific object, or as a subject/object of its predicate parent node. We thus pass both the attention map and the hidden representation of a node to its parent based on the edge such that the parent node can generate a more precise attention map as <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="{att}_{j}" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><mrow id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><mi id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.1.m1.1.1.1" xref="S3.SS5.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS5.p1.1.m1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.1.m1.1.1.1a" xref="S3.SS5.p1.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS5.p1.1.m1.1.1.4" xref="S3.SS5.p1.1.m1.1.1.4.cmml"><mi id="S3.SS5.p1.1.m1.1.1.4.2" xref="S3.SS5.p1.1.m1.1.1.4.2.cmml">t</mi><mi id="S3.SS5.p1.1.m1.1.1.4.3" xref="S3.SS5.p1.1.m1.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><times id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1.1"></times><ci id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2">𝑎</ci><ci id="S3.SS5.p1.1.m1.1.1.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3">𝑡</ci><apply id="S3.SS5.p1.1.m1.1.1.4.cmml" xref="S3.SS5.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.4.1.cmml" xref="S3.SS5.p1.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.4.2.cmml" xref="S3.SS5.p1.1.m1.1.1.4.2">𝑡</ci><ci id="S3.SS5.p1.1.m1.1.1.4.3.cmml" xref="S3.SS5.p1.1.m1.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">{att}_{j}</annotation></semantics></math> or integrate the features of child nodes to enhance the representation given the predicate word.
After propagating through all word nodes, the output message of the root node <math id="S3.SS5.p1.2.m2.2" class="ltx_Math" alttext="[m^{h}_{root},m^{a}_{root}]" display="inline"><semantics id="S3.SS5.p1.2.m2.2a"><mrow id="S3.SS5.p1.2.m2.2.2.2" xref="S3.SS5.p1.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS5.p1.2.m2.2.2.2.3" xref="S3.SS5.p1.2.m2.2.2.3.cmml">[</mo><msubsup id="S3.SS5.p1.2.m2.1.1.1.1" xref="S3.SS5.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS5.p1.2.m2.1.1.1.1.2.2" xref="S3.SS5.p1.2.m2.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS5.p1.2.m2.1.1.1.1.3" xref="S3.SS5.p1.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS5.p1.2.m2.1.1.1.1.3.2" xref="S3.SS5.p1.2.m2.1.1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.1.1.3.1" xref="S3.SS5.p1.2.m2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.1.1.3.3" xref="S3.SS5.p1.2.m2.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.1.1.3.1a" xref="S3.SS5.p1.2.m2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.1.1.3.4" xref="S3.SS5.p1.2.m2.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.1.1.3.1b" xref="S3.SS5.p1.2.m2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.1.1.3.5" xref="S3.SS5.p1.2.m2.1.1.1.1.3.5.cmml">t</mi></mrow><mi id="S3.SS5.p1.2.m2.1.1.1.1.2.3" xref="S3.SS5.p1.2.m2.1.1.1.1.2.3.cmml">h</mi></msubsup><mo id="S3.SS5.p1.2.m2.2.2.2.4" xref="S3.SS5.p1.2.m2.2.2.3.cmml">,</mo><msubsup id="S3.SS5.p1.2.m2.2.2.2.2" xref="S3.SS5.p1.2.m2.2.2.2.2.cmml"><mi id="S3.SS5.p1.2.m2.2.2.2.2.2.2" xref="S3.SS5.p1.2.m2.2.2.2.2.2.2.cmml">m</mi><mrow id="S3.SS5.p1.2.m2.2.2.2.2.3" xref="S3.SS5.p1.2.m2.2.2.2.2.3.cmml"><mi id="S3.SS5.p1.2.m2.2.2.2.2.3.2" xref="S3.SS5.p1.2.m2.2.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.2.2.2.2.3.1" xref="S3.SS5.p1.2.m2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.2.2.2.2.3.3" xref="S3.SS5.p1.2.m2.2.2.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.2.2.2.2.3.1a" xref="S3.SS5.p1.2.m2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.2.2.2.2.3.4" xref="S3.SS5.p1.2.m2.2.2.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.2.2.2.2.3.1b" xref="S3.SS5.p1.2.m2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.2.2.2.2.3.5" xref="S3.SS5.p1.2.m2.2.2.2.2.3.5.cmml">t</mi></mrow><mi id="S3.SS5.p1.2.m2.2.2.2.2.2.3" xref="S3.SS5.p1.2.m2.2.2.2.2.2.3.cmml">a</mi></msubsup><mo stretchy="false" id="S3.SS5.p1.2.m2.2.2.2.5" xref="S3.SS5.p1.2.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.2b"><interval closure="closed" id="S3.SS5.p1.2.m2.2.2.3.cmml" xref="S3.SS5.p1.2.m2.2.2.2"><apply id="S3.SS5.p1.2.m2.1.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS5.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS5.p1.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS5.p1.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.SS5.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.3"><times id="S3.SS5.p1.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.3.1"></times><ci id="S3.SS5.p1.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.3.2">𝑟</ci><ci id="S3.SS5.p1.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.3.3">𝑜</ci><ci id="S3.SS5.p1.2.m2.1.1.1.1.3.4.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.3.4">𝑜</ci><ci id="S3.SS5.p1.2.m2.1.1.1.1.3.5.cmml" xref="S3.SS5.p1.2.m2.1.1.1.1.3.5">𝑡</ci></apply></apply><apply id="S3.SS5.p1.2.m2.2.2.2.2.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2">subscript</csymbol><apply id="S3.SS5.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2">superscript</csymbol><ci id="S3.SS5.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.2.2">𝑚</ci><ci id="S3.SS5.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.2.3">𝑎</ci></apply><apply id="S3.SS5.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.3"><times id="S3.SS5.p1.2.m2.2.2.2.2.3.1.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.3.1"></times><ci id="S3.SS5.p1.2.m2.2.2.2.2.3.2.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.3.2">𝑟</ci><ci id="S3.SS5.p1.2.m2.2.2.2.2.3.3.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.3.3">𝑜</ci><ci id="S3.SS5.p1.2.m2.2.2.2.2.3.4.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.3.4">𝑜</ci><ci id="S3.SS5.p1.2.m2.2.2.2.2.3.5.cmml" xref="S3.SS5.p1.2.m2.2.2.2.2.3.5">𝑡</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.2c">[m^{h}_{root},m^{a}_{root}]</annotation></semantics></math> is used to predict the answer. We perform global max pooling on the encoded attention map <math id="S3.SS5.p1.3.m3.1" class="ltx_Math" alttext="m^{a}_{root}" display="inline"><semantics id="S3.SS5.p1.3.m3.1a"><msubsup id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml"><mi id="S3.SS5.p1.3.m3.1.1.2.2" xref="S3.SS5.p1.3.m3.1.1.2.2.cmml">m</mi><mrow id="S3.SS5.p1.3.m3.1.1.3" xref="S3.SS5.p1.3.m3.1.1.3.cmml"><mi id="S3.SS5.p1.3.m3.1.1.3.2" xref="S3.SS5.p1.3.m3.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.3.m3.1.1.3.1" xref="S3.SS5.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.3.m3.1.1.3.3" xref="S3.SS5.p1.3.m3.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.3.m3.1.1.3.1a" xref="S3.SS5.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.3.m3.1.1.3.4" xref="S3.SS5.p1.3.m3.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.3.m3.1.1.3.1b" xref="S3.SS5.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.3.m3.1.1.3.5" xref="S3.SS5.p1.3.m3.1.1.3.5.cmml">t</mi></mrow><mi id="S3.SS5.p1.3.m3.1.1.2.3" xref="S3.SS5.p1.3.m3.1.1.2.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><apply id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS5.p1.3.m3.1.1.2.cmml" xref="S3.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.1.1.2.1.cmml" xref="S3.SS5.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS5.p1.3.m3.1.1.2.2.cmml" xref="S3.SS5.p1.3.m3.1.1.2.2">𝑚</ci><ci id="S3.SS5.p1.3.m3.1.1.2.3.cmml" xref="S3.SS5.p1.3.m3.1.1.2.3">𝑎</ci></apply><apply id="S3.SS5.p1.3.m3.1.1.3.cmml" xref="S3.SS5.p1.3.m3.1.1.3"><times id="S3.SS5.p1.3.m3.1.1.3.1.cmml" xref="S3.SS5.p1.3.m3.1.1.3.1"></times><ci id="S3.SS5.p1.3.m3.1.1.3.2.cmml" xref="S3.SS5.p1.3.m3.1.1.3.2">𝑟</ci><ci id="S3.SS5.p1.3.m3.1.1.3.3.cmml" xref="S3.SS5.p1.3.m3.1.1.3.3">𝑜</ci><ci id="S3.SS5.p1.3.m3.1.1.3.4.cmml" xref="S3.SS5.p1.3.m3.1.1.3.4">𝑜</ci><ci id="S3.SS5.p1.3.m3.1.1.3.5.cmml" xref="S3.SS5.p1.3.m3.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">m^{a}_{root}</annotation></semantics></math> and concatenate it with <math id="S3.SS5.p1.4.m4.1" class="ltx_Math" alttext="m^{h}_{root}" display="inline"><semantics id="S3.SS5.p1.4.m4.1a"><msubsup id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml"><mi id="S3.SS5.p1.4.m4.1.1.2.2" xref="S3.SS5.p1.4.m4.1.1.2.2.cmml">m</mi><mrow id="S3.SS5.p1.4.m4.1.1.3" xref="S3.SS5.p1.4.m4.1.1.3.cmml"><mi id="S3.SS5.p1.4.m4.1.1.3.2" xref="S3.SS5.p1.4.m4.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.4.m4.1.1.3.1" xref="S3.SS5.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.4.m4.1.1.3.3" xref="S3.SS5.p1.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.4.m4.1.1.3.1a" xref="S3.SS5.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.4.m4.1.1.3.4" xref="S3.SS5.p1.4.m4.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.4.m4.1.1.3.1b" xref="S3.SS5.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.4.m4.1.1.3.5" xref="S3.SS5.p1.4.m4.1.1.3.5.cmml">t</mi></mrow><mi id="S3.SS5.p1.4.m4.1.1.2.3" xref="S3.SS5.p1.4.m4.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><apply id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS5.p1.4.m4.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.2.1.cmml" xref="S3.SS5.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.2.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2.2">𝑚</ci><ci id="S3.SS5.p1.4.m4.1.1.2.3.cmml" xref="S3.SS5.p1.4.m4.1.1.2.3">ℎ</ci></apply><apply id="S3.SS5.p1.4.m4.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3"><times id="S3.SS5.p1.4.m4.1.1.3.1.cmml" xref="S3.SS5.p1.4.m4.1.1.3.1"></times><ci id="S3.SS5.p1.4.m4.1.1.3.2.cmml" xref="S3.SS5.p1.4.m4.1.1.3.2">𝑟</ci><ci id="S3.SS5.p1.4.m4.1.1.3.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3.3">𝑜</ci><ci id="S3.SS5.p1.4.m4.1.1.3.4.cmml" xref="S3.SS5.p1.4.m4.1.1.3.4">𝑜</ci><ci id="S3.SS5.p1.4.m4.1.1.3.5.cmml" xref="S3.SS5.p1.4.m4.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">m^{h}_{root}</annotation></semantics></math>. This concatenated feature is passed through a multilayer perceptron with three layers to predict the final answer <math id="S3.SS5.p1.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS5.p1.5.m5.1a"><mi id="S3.SS5.p1.5.m5.1.1" xref="S3.SS5.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.1b"><ci id="S3.SS5.p1.5.m5.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.1c">y</annotation></semantics></math>.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.1" class="ltx_p">Our model is stacked by a list of node modules with a tree-structured layout. Weights are shared across all node modules. The entire model can be trained in an end-to-end manner with only the supervision signal <math id="S3.SS5.p2.1.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS5.p2.1.m1.1a"><mi id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><ci id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">y</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiment</span>
</h2>

<figure id="S4.F6" class="ltx_figure"><img src="/html/1809.01810/assets/figure/clevr_hd.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="471" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Two examples of the dependency trees of questions and corresponding regions attended by our model at each step on the CLEVR dataset. The questions are shown on the bottom. The input images and dependency parse trees are shown on the left and lower parts. The arrows in the dependency tree are drawn from the head words to the dependent words. The curved arrows point to pruned leaf words that are not nouns. Thus, the word “are” is the root node for both examples.
</figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We validate the effectiveness and interpretation capability of our models on both synthetic datasets (i.e., CLEVR and FigureQA) that focus mainly on relation reasoning and natural image datasets (i.e., VQAv2).</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span id="S4.SS1.1.1" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p"><span id="S4.SS1.p1.2.1" class="ltx_text ltx_font_bold">CLEVR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> is a synthesized dataset with <math id="S4.SS1.p1.1.m1.2" class="ltx_Math" alttext="100,000" display="inline"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.3.2" xref="S4.SS1.p1.1.m1.2.3.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">100</mn><mo id="S4.SS1.p1.1.m1.2.3.2.1" xref="S4.SS1.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><list id="S4.SS1.p1.1.m1.2.3.1.cmml" xref="S4.SS1.p1.1.m1.2.3.2"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">100</cn><cn type="integer" id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">100,000</annotation></semantics></math> images and <math id="S4.SS1.p1.2.m2.2" class="ltx_Math" alttext="853,554" display="inline"><semantics id="S4.SS1.p1.2.m2.2a"><mrow id="S4.SS1.p1.2.m2.2.3.2" xref="S4.SS1.p1.2.m2.2.3.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">853</mn><mo id="S4.SS1.p1.2.m2.2.3.2.1" xref="S4.SS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml">554</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.2b"><list id="S4.SS1.p1.2.m2.2.3.1.cmml" xref="S4.SS1.p1.2.m2.2.3.2"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">853</cn><cn type="integer" id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2">554</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.2c">853,554</annotation></semantics></math> questions. The images are photorealistic rendered images with objects of random shapes, colors, materials and sizes. The questions are generated using sets of functional programs, which consist of functions that can filter certain colors and shapes or compare two objects. Thus, the reasoning routes required to answer each question can be precisely determined by the underlying function program. Unlike natural image datasets, this dataset requires a model capable of reasoning on relations to answer the questions.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.2" class="ltx_p"><span id="S4.SS1.p2.2.1" class="ltx_text ltx_font_bold">FigureQA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> is also a synthesized dataset. This dataset contains <math id="S4.SS1.p2.1.m1.2" class="ltx_Math" alttext="100,000" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.3.2" xref="S4.SS1.p2.1.m1.2.3.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">100</mn><mo id="S4.SS1.p2.1.m1.2.3.2.1" xref="S4.SS1.p2.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><list id="S4.SS1.p2.1.m1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.2"><cn type="integer" id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">100</cn><cn type="integer" id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">100,000</annotation></semantics></math> images and <math id="S4.SS1.p2.2.m2.3" class="ltx_Math" alttext="1,327,368" display="inline"><semantics id="S4.SS1.p2.2.m2.3a"><mrow id="S4.SS1.p2.2.m2.3.4.2" xref="S4.SS1.p2.2.m2.3.4.1.cmml"><mn id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">1</mn><mo id="S4.SS1.p2.2.m2.3.4.2.1" xref="S4.SS1.p2.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml">327</mn><mo id="S4.SS1.p2.2.m2.3.4.2.2" xref="S4.SS1.p2.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p2.2.m2.3.3" xref="S4.SS1.p2.2.m2.3.3.cmml">368</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.3b"><list id="S4.SS1.p2.2.m2.3.4.1.cmml" xref="S4.SS1.p2.2.m2.3.4.2"><cn type="integer" id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">1</cn><cn type="integer" id="S4.SS1.p2.2.m2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2">327</cn><cn type="integer" id="S4.SS1.p2.2.m2.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3">368</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.3c">1,327,368</annotation></semantics></math> questions for training. In contrast to CLEVR, the images are scientific-style figures. The dataset includes five classes: line plots, dot-line plots, vertical and horizontal bar graphs, and pie charts. The questions also concern various relationships between elements in the figures, such as the maximum, the area under the curve, intersections, etc. Thus, this dataset also requires the VQA model to perform relational reasoning on the plot elements.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.2" class="ltx_p">The <span id="S4.SS1.p3.2.1" class="ltx_text ltx_font_bold">VQAv2</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> is a widely used VQA benchmark on natural images. It contains <math id="S4.SS1.p3.1.m1.2" class="ltx_Math" alttext="204,721" display="inline"><semantics id="S4.SS1.p3.1.m1.2a"><mrow id="S4.SS1.p3.1.m1.2.3.2" xref="S4.SS1.p3.1.m1.2.3.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">204</mn><mo id="S4.SS1.p3.1.m1.2.3.2.1" xref="S4.SS1.p3.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.p3.1.m1.2.2" xref="S4.SS1.p3.1.m1.2.2.cmml">721</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><list id="S4.SS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.2"><cn type="integer" id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">204</cn><cn type="integer" id="S4.SS1.p3.1.m1.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2">721</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">204,721</annotation></semantics></math> natural images from COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> and <math id="S4.SS1.p3.2.m2.3" class="ltx_Math" alttext="1,105,904" display="inline"><semantics id="S4.SS1.p3.2.m2.3a"><mrow id="S4.SS1.p3.2.m2.3.4.2" xref="S4.SS1.p3.2.m2.3.4.1.cmml"><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">1</mn><mo id="S4.SS1.p3.2.m2.3.4.2.1" xref="S4.SS1.p3.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p3.2.m2.2.2" xref="S4.SS1.p3.2.m2.2.2.cmml">105</mn><mo id="S4.SS1.p3.2.m2.3.4.2.2" xref="S4.SS1.p3.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p3.2.m2.3.3" xref="S4.SS1.p3.2.m2.3.3.cmml">904</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.3b"><list id="S4.SS1.p3.2.m2.3.4.1.cmml" xref="S4.SS1.p3.2.m2.3.4.2"><cn type="integer" id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">1</cn><cn type="integer" id="S4.SS1.p3.2.m2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2">105</cn><cn type="integer" id="S4.SS1.p3.2.m2.3.3.cmml" xref="S4.SS1.p3.2.m2.3.3">904</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.3c">1,105,904</annotation></semantics></math> free-form questions. Compared with its first version <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, this dataset focuses on reducing dataset biases through balanced pairs: for each question, there are a pair of images that have different answers.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Comparison of question answering accuracy on the CLEVR dataset. The performances of question types <em id="S4.T1.8.1" class="ltx_emph ltx_font_italic">Exist</em>, <em id="S4.T1.9.2" class="ltx_emph ltx_font_italic">Count</em>, <em id="S4.T1.10.3" class="ltx_emph ltx_font_italic">Compare Integer</em>, <em id="S4.T1.11.4" class="ltx_emph ltx_font_italic">Query</em>, and <em id="S4.T1.12.5" class="ltx_emph ltx_font_italic">Compare</em> are reported in each column. Methods with <math id="S4.T1.2.m1.1" class="ltx_Math" alttext="*" display="inline"><semantics id="S4.T1.2.m1.1b"><mo id="S4.T1.2.m1.1.1" xref="S4.T1.2.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.m1.1c"><times id="S4.T1.2.m1.1.1.cmml" xref="S4.T1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.m1.1d">*</annotation></semantics></math> are trained with extra program layout annotations. </figcaption>
<table id="S4.T1.13" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.13.1.1" class="ltx_tr">
<th id="S4.T1.13.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Method</th>
<th id="S4.T1.13.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Exist</th>
<th id="S4.T1.13.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Count</th>
<th id="S4.T1.13.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<table id="S4.T1.13.1.1.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.13.1.1.4.1.1" class="ltx_tr">
<td id="S4.T1.13.1.1.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Compare</td>
</tr>
<tr id="S4.T1.13.1.1.4.1.2" class="ltx_tr">
<td id="S4.T1.13.1.1.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Integer</td>
</tr>
</table>
</th>
<th id="S4.T1.13.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">
<table id="S4.T1.13.1.1.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.13.1.1.5.1.1" class="ltx_tr">
<td id="S4.T1.13.1.1.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Query</td>
</tr>
<tr id="S4.T1.13.1.1.5.1.2" class="ltx_tr">
<td id="S4.T1.13.1.1.5.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Attribute</td>
</tr>
</table>
</th>
<th id="S4.T1.13.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S4.T1.13.1.1.6.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.13.1.1.6.1.1" class="ltx_tr">
<td id="S4.T1.13.1.1.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Compare</td>
</tr>
<tr id="S4.T1.13.1.1.6.1.2" class="ltx_tr">
<td id="S4.T1.13.1.1.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Attribute</td>
</tr>
</table>
</th>
<th id="S4.T1.13.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Overall</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.13.2.1" class="ltx_tr">
<td id="S4.T1.13.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">LBP-SIG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>
</td>
<td id="S4.T1.13.2.1.2" class="ltx_td ltx_align_center ltx_border_t">79.6</td>
<td id="S4.T1.13.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.3</td>
<td id="S4.T1.13.2.1.4" class="ltx_td ltx_align_center ltx_border_t">80.7</td>
<td id="S4.T1.13.2.1.5" class="ltx_td ltx_align_center ltx_border_t">88.6</td>
<td id="S4.T1.13.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76.3</td>
<td id="S4.T1.13.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.0</td>
</tr>
<tr id="S4.T1.13.3.2" class="ltx_tr">
<td id="S4.T1.13.3.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">N2NMN scratch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</td>
<td id="S4.T1.13.3.2.2" class="ltx_td ltx_align_center">72.7</td>
<td id="S4.T1.13.3.2.3" class="ltx_td ltx_align_center ltx_border_r">55.1</td>
<td id="S4.T1.13.3.2.4" class="ltx_td ltx_align_center">78.5</td>
<td id="S4.T1.13.3.2.5" class="ltx_td ltx_align_center">83.2</td>
<td id="S4.T1.13.3.2.6" class="ltx_td ltx_align_center ltx_border_r">50.9</td>
<td id="S4.T1.13.3.2.7" class="ltx_td ltx_align_center ltx_border_r">69.0</td>
</tr>
<tr id="S4.T1.13.4.3" class="ltx_tr">
<td id="S4.T1.13.4.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">N2NMN cloning expert* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</td>
<td id="S4.T1.13.4.3.2" class="ltx_td ltx_align_center">83.3</td>
<td id="S4.T1.13.4.3.3" class="ltx_td ltx_align_center ltx_border_r">63.3</td>
<td id="S4.T1.13.4.3.4" class="ltx_td ltx_align_center">80.3</td>
<td id="S4.T1.13.4.3.5" class="ltx_td ltx_align_center">87.0</td>
<td id="S4.T1.13.4.3.6" class="ltx_td ltx_align_center ltx_border_r">78.5</td>
<td id="S4.T1.13.4.3.7" class="ltx_td ltx_align_center ltx_border_r">78.9</td>
</tr>
<tr id="S4.T1.13.5.4" class="ltx_tr">
<td id="S4.T1.13.5.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">N2NMN policy search* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</td>
<td id="S4.T1.13.5.4.2" class="ltx_td ltx_align_center">85.7</td>
<td id="S4.T1.13.5.4.3" class="ltx_td ltx_align_center ltx_border_r">68.5</td>
<td id="S4.T1.13.5.4.4" class="ltx_td ltx_align_center">84.9</td>
<td id="S4.T1.13.5.4.5" class="ltx_td ltx_align_center">90.0</td>
<td id="S4.T1.13.5.4.6" class="ltx_td ltx_align_center ltx_border_r">88.7</td>
<td id="S4.T1.13.5.4.7" class="ltx_td ltx_align_center ltx_border_r">83.7</td>
</tr>
<tr id="S4.T1.13.6.5" class="ltx_tr">
<td id="S4.T1.13.6.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">PE-semi-9K* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</td>
<td id="S4.T1.13.6.5.2" class="ltx_td ltx_align_center">89.7</td>
<td id="S4.T1.13.6.5.3" class="ltx_td ltx_align_center ltx_border_r">79.7</td>
<td id="S4.T1.13.6.5.4" class="ltx_td ltx_align_center">79.7</td>
<td id="S4.T1.13.6.5.5" class="ltx_td ltx_align_center">92.6</td>
<td id="S4.T1.13.6.5.6" class="ltx_td ltx_align_center ltx_border_r">96.0</td>
<td id="S4.T1.13.6.5.7" class="ltx_td ltx_align_center ltx_border_r">88.6</td>
</tr>
<tr id="S4.T1.13.7.6" class="ltx_tr">
<td id="S4.T1.13.7.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">PE-Strong* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</td>
<td id="S4.T1.13.7.6.2" class="ltx_td ltx_align_center">97.7</td>
<td id="S4.T1.13.7.6.3" class="ltx_td ltx_align_center ltx_border_r">92.7</td>
<td id="S4.T1.13.7.6.4" class="ltx_td ltx_align_center">98.7</td>
<td id="S4.T1.13.7.6.5" class="ltx_td ltx_align_center">98.1</td>
<td id="S4.T1.13.7.6.6" class="ltx_td ltx_align_center ltx_border_r">98.9</td>
<td id="S4.T1.13.7.6.7" class="ltx_td ltx_align_center ltx_border_r">96.9</td>
</tr>
<tr id="S4.T1.13.8.7" class="ltx_tr">
<td id="S4.T1.13.8.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>
</td>
<td id="S4.T1.13.8.7.2" class="ltx_td ltx_align_center">97.8</td>
<td id="S4.T1.13.8.7.3" class="ltx_td ltx_align_center ltx_border_r">90.1</td>
<td id="S4.T1.13.8.7.4" class="ltx_td ltx_align_center">93.6</td>
<td id="S4.T1.13.8.7.5" class="ltx_td ltx_align_center">97.9</td>
<td id="S4.T1.13.8.7.6" class="ltx_td ltx_align_center ltx_border_r">97.1</td>
<td id="S4.T1.13.8.7.7" class="ltx_td ltx_align_center ltx_border_r">95.5</td>
</tr>
<tr id="S4.T1.13.9.8" class="ltx_tr">
<td id="S4.T1.13.9.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">FiLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>
</td>
<td id="S4.T1.13.9.8.2" class="ltx_td ltx_align_center">99.2</td>
<td id="S4.T1.13.9.8.3" class="ltx_td ltx_align_center ltx_border_r">94.5</td>
<td id="S4.T1.13.9.8.4" class="ltx_td ltx_align_center">93.8</td>
<td id="S4.T1.13.9.8.5" class="ltx_td ltx_align_center">99.2</td>
<td id="S4.T1.13.9.8.6" class="ltx_td ltx_align_center ltx_border_r">99.0</td>
<td id="S4.T1.13.9.8.7" class="ltx_td ltx_align_center ltx_border_r">97.6</td>
</tr>
<tr id="S4.T1.13.10.9" class="ltx_tr">
<td id="S4.T1.13.10.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</td>
<td id="S4.T1.13.10.9.2" class="ltx_td ltx_align_center">99.5</td>
<td id="S4.T1.13.10.9.3" class="ltx_td ltx_align_center ltx_border_r">97.1</td>
<td id="S4.T1.13.10.9.4" class="ltx_td ltx_align_center">99.1</td>
<td id="S4.T1.13.10.9.5" class="ltx_td ltx_align_center">99.5</td>
<td id="S4.T1.13.10.9.6" class="ltx_td ltx_align_center ltx_border_r">99.5</td>
<td id="S4.T1.13.10.9.7" class="ltx_td ltx_align_center ltx_border_r">98.9</td>
</tr>
<tr id="S4.T1.13.11.10" class="ltx_tr">
<td id="S4.T1.13.11.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">TbD+reg+hres* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</td>
<td id="S4.T1.13.11.10.2" class="ltx_td ltx_align_center">99.2</td>
<td id="S4.T1.13.11.10.3" class="ltx_td ltx_align_center ltx_border_r">97.6</td>
<td id="S4.T1.13.11.10.4" class="ltx_td ltx_align_center">99.4</td>
<td id="S4.T1.13.11.10.5" class="ltx_td ltx_align_center">99.5</td>
<td id="S4.T1.13.11.10.6" class="ltx_td ltx_align_center ltx_border_r">99.6</td>
<td id="S4.T1.13.11.10.7" class="ltx_td ltx_align_center ltx_border_r">99.1</td>
</tr>
<tr id="S4.T1.13.12.11" class="ltx_tr">
<td id="S4.T1.13.12.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">NS-VQA* <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</td>
<td id="S4.T1.13.12.11.2" class="ltx_td ltx_align_center">99.9</td>
<td id="S4.T1.13.12.11.3" class="ltx_td ltx_align_center ltx_border_r">99.7</td>
<td id="S4.T1.13.12.11.4" class="ltx_td ltx_align_center">99.9</td>
<td id="S4.T1.13.12.11.5" class="ltx_td ltx_align_center">99.8</td>
<td id="S4.T1.13.12.11.6" class="ltx_td ltx_align_center ltx_border_r">99.8</td>
<td id="S4.T1.13.12.11.7" class="ltx_td ltx_align_center ltx_border_r">99.8</td>
</tr>
<tr id="S4.T1.13.13.12" class="ltx_tr">
<td id="S4.T1.13.13.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">ACMN</td>
<td id="S4.T1.13.13.12.2" class="ltx_td ltx_align_center">94.2</td>
<td id="S4.T1.13.13.12.3" class="ltx_td ltx_align_center ltx_border_r">81.4</td>
<td id="S4.T1.13.13.12.4" class="ltx_td ltx_align_center">81.6</td>
<td id="S4.T1.13.13.12.5" class="ltx_td ltx_align_center">90.5</td>
<td id="S4.T1.13.13.12.6" class="ltx_td ltx_align_center ltx_border_r">97.1</td>
<td id="S4.T1.13.13.12.7" class="ltx_td ltx_align_center ltx_border_r">89.3</td>
</tr>
<tr id="S4.T1.13.14.13" class="ltx_tr">
<td id="S4.T1.13.14.13.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r">PTGRN</td>
<td id="S4.T1.13.14.13.2" class="ltx_td ltx_align_center ltx_border_b">97.9</td>
<td id="S4.T1.13.14.13.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">91.8</td>
<td id="S4.T1.13.14.13.4" class="ltx_td ltx_align_center ltx_border_b">95.2</td>
<td id="S4.T1.13.14.13.5" class="ltx_td ltx_align_center ltx_border_b">95.5</td>
<td id="S4.T1.13.14.13.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">98.5</td>
<td id="S4.T1.13.14.13.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">95.5</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span id="S4.SS2.1.1" class="ltx_text ltx_font_italic">Implementation details</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.16" class="ltx_p">For the CLEVR dataset, we employ the same settings used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> to extract image features and word encodings. We first resize all images to <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><times id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></times><cn type="integer" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">224</cn><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">224\times 224</annotation></semantics></math>, and then we extract the conv4 feature from ResNet-101 pretrained on ImageNet. The resulting <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="1024\times 14\times 14" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">1024</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.2.m2.1.1.1a" xref="S4.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.2.m2.1.1.4" xref="S4.SS2.p1.2.m2.1.1.4.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><times id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">1024</cn><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">14</cn><cn type="integer" id="S4.SS2.p1.2.m2.1.1.4.cmml" xref="S4.SS2.p1.2.m2.1.1.4">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">1024\times 14\times 14</annotation></semantics></math> feature maps are concatenated with a <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><cn type="integer" id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">2</annotation></semantics></math>-channel coordinate map, which is further fed into a single <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mn id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><times id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></times><cn type="integer" id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">3</cn><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">3\times 3</annotation></semantics></math> convolution layer. The resulting <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="128\times 14\times 14" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mn id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">128</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.5.m5.1.1.1a" xref="S4.SS2.p1.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.5.m5.1.1.4" xref="S4.SS2.p1.5.m5.1.1.4.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><times id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></times><cn type="integer" id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">128</cn><cn type="integer" id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">14</cn><cn type="integer" id="S4.SS2.p1.5.m5.1.1.4.cmml" xref="S4.SS2.p1.5.m5.1.1.4">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">128\times 14\times 14</annotation></semantics></math> feature maps are also concatenated with the <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">2</annotation></semantics></math>-channel coordinate map and then passed through our PTGRN module. We encode the questions using a bidirectional GRU with <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mn id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><cn type="integer" id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">512</annotation></semantics></math>-d hidden states for both directions. The hidden vector of Bi-GRU at the corresponding word position is extracted to be this word’s encoding <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">w</annotation></semantics></math>. The hidden representations of gated residual composition modules are <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mn id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><cn type="integer" id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">128</annotation></semantics></math>-d for both <math id="S4.SS2.p1.10.m10.1" class="ltx_Math" alttext="h_{j}" display="inline"><semantics id="S4.SS2.p1.10.m10.1a"><msub id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml"><mi id="S4.SS2.p1.10.m10.1.1.2" xref="S4.SS2.p1.10.m10.1.1.2.cmml">h</mi><mi id="S4.SS2.p1.10.m10.1.1.3" xref="S4.SS2.p1.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><apply id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m10.1.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m10.1.1.2.cmml" xref="S4.SS2.p1.10.m10.1.1.2">ℎ</ci><ci id="S4.SS2.p1.10.m10.1.1.3.cmml" xref="S4.SS2.p1.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">h_{j}</annotation></semantics></math> and <math id="S4.SS2.p1.11.m11.1" class="ltx_Math" alttext="h^{att}_{j}" display="inline"><semantics id="S4.SS2.p1.11.m11.1a"><msubsup id="S4.SS2.p1.11.m11.1.1" xref="S4.SS2.p1.11.m11.1.1.cmml"><mi id="S4.SS2.p1.11.m11.1.1.2.2" xref="S4.SS2.p1.11.m11.1.1.2.2.cmml">h</mi><mi id="S4.SS2.p1.11.m11.1.1.3" xref="S4.SS2.p1.11.m11.1.1.3.cmml">j</mi><mrow id="S4.SS2.p1.11.m11.1.1.2.3" xref="S4.SS2.p1.11.m11.1.1.2.3.cmml"><mi id="S4.SS2.p1.11.m11.1.1.2.3.2" xref="S4.SS2.p1.11.m11.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m11.1.1.2.3.1" xref="S4.SS2.p1.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.11.m11.1.1.2.3.3" xref="S4.SS2.p1.11.m11.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m11.1.1.2.3.1a" xref="S4.SS2.p1.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.11.m11.1.1.2.3.4" xref="S4.SS2.p1.11.m11.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b"><apply id="S4.SS2.p1.11.m11.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m11.1.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">subscript</csymbol><apply id="S4.SS2.p1.11.m11.1.1.2.cmml" xref="S4.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m11.1.1.2.1.cmml" xref="S4.SS2.p1.11.m11.1.1">superscript</csymbol><ci id="S4.SS2.p1.11.m11.1.1.2.2.cmml" xref="S4.SS2.p1.11.m11.1.1.2.2">ℎ</ci><apply id="S4.SS2.p1.11.m11.1.1.2.3.cmml" xref="S4.SS2.p1.11.m11.1.1.2.3"><times id="S4.SS2.p1.11.m11.1.1.2.3.1.cmml" xref="S4.SS2.p1.11.m11.1.1.2.3.1"></times><ci id="S4.SS2.p1.11.m11.1.1.2.3.2.cmml" xref="S4.SS2.p1.11.m11.1.1.2.3.2">𝑎</ci><ci id="S4.SS2.p1.11.m11.1.1.2.3.3.cmml" xref="S4.SS2.p1.11.m11.1.1.2.3.3">𝑡</ci><ci id="S4.SS2.p1.11.m11.1.1.2.3.4.cmml" xref="S4.SS2.p1.11.m11.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S4.SS2.p1.11.m11.1.1.3.cmml" xref="S4.SS2.p1.11.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">h^{att}_{j}</annotation></semantics></math>.
The messages generated by parse-tree-guided propagation module modules are also <math id="S4.SS2.p1.12.m12.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS2.p1.12.m12.1a"><mn id="S4.SS2.p1.12.m12.1.1" xref="S4.SS2.p1.12.m12.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m12.1b"><cn type="integer" id="S4.SS2.p1.12.m12.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m12.1c">128</annotation></semantics></math>-d for both the attention map and the hidden representation. The three-layer MLP has output sizes of <math id="S4.SS2.p1.13.m13.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS2.p1.13.m13.1a"><mn id="S4.SS2.p1.13.m13.1.1" xref="S4.SS2.p1.13.m13.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m13.1b"><cn type="integer" id="S4.SS2.p1.13.m13.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m13.1c">512</annotation></semantics></math>, <math id="S4.SS2.p1.14.m14.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S4.SS2.p1.14.m14.1a"><mn id="S4.SS2.p1.14.m14.1.1" xref="S4.SS2.p1.14.m14.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m14.1b"><cn type="integer" id="S4.SS2.p1.14.m14.1.1.cmml" xref="S4.SS2.p1.14.m14.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m14.1c">1024</annotation></semantics></math> and <math id="S4.SS2.p1.15.m15.1" class="ltx_Math" alttext="29" display="inline"><semantics id="S4.SS2.p1.15.m15.1a"><mn id="S4.SS2.p1.15.m15.1.1" xref="S4.SS2.p1.15.m15.1.1.cmml">29</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m15.1b"><cn type="integer" id="S4.SS2.p1.15.m15.1.1.cmml" xref="S4.SS2.p1.15.m15.1.1">29</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m15.1c">29</annotation></semantics></math>, where <math id="S4.SS2.p1.16.m16.1" class="ltx_Math" alttext="29" display="inline"><semantics id="S4.SS2.p1.16.m16.1a"><mn id="S4.SS2.p1.16.m16.1.1" xref="S4.SS2.p1.16.m16.1.1.cmml">29</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.16.m16.1b"><cn type="integer" id="S4.SS2.p1.16.m16.1.1.cmml" xref="S4.SS2.p1.16.m16.1.1">29</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.16.m16.1c">29</annotation></semantics></math> is the number of candidate answers.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/1809.01810/assets/figure/figureqa.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="331" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Two examples of the dependency trees of questions and the corresponding regions attended by our model at each step on the FigureQA dataset.</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.10" class="ltx_p">We resize the images in FigureQA to <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="256\times 256" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">256</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">256</cn><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">256\times 256</annotation></semantics></math>. Then, we use a five-layer CNN to extract the image features. Each layer has a <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">3</cn><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">3\times 3</annotation></semantics></math> kernel and a stride of <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mn id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><cn type="integer" id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">2</annotation></semantics></math>. The dimensions of the feature map in the first four layers are <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mn id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><cn type="integer" id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">64</annotation></semantics></math>, and the last layer has <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mn id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><cn type="integer" id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">128</annotation></semantics></math>-channel outputs. The resulting feature map is concatenated with the <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mn id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><cn type="integer" id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">2</annotation></semantics></math>-d coordination map. Thus, the image feature map has a size of <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="130\times 8\times 8" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mrow id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mn id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">130</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.7.m7.1.1.1" xref="S4.SS2.p2.7.m7.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">8</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.7.m7.1.1.1a" xref="S4.SS2.p2.7.m7.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.7.m7.1.1.4" xref="S4.SS2.p2.7.m7.1.1.4.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><times id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1.1"></times><cn type="integer" id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">130</cn><cn type="integer" id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">8</cn><cn type="integer" id="S4.SS2.p2.7.m7.1.1.4.cmml" xref="S4.SS2.p2.7.m7.1.1.4">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">130\times 8\times 8</annotation></semantics></math>. The hidden output representations of gated residual composition modules and propagation modules are <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mn id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><cn type="integer" id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">128</annotation></semantics></math>-d. The words in a question are first embedded as a <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mn id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><cn type="integer" id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">200</annotation></semantics></math>-d vector, and then the whole question is encoded by a bidirectional GRU, which has <math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><mn id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><cn type="integer" id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">1024</annotation></semantics></math>-d hidden units in both directions. The word encoding vector is represented by the GRU hidden vector at its corresponding position.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.11" class="ltx_p">For the VQAv2 dataset, we use the image features provided by a bottom-up attention network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. The bottom-up attention network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> detects <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="36" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">36</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><cn type="integer" id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">36</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">36</annotation></semantics></math> objects for each image and extracts <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mn id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><cn type="integer" id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">2048</annotation></semantics></math>-d regional features for each object. The word vectors are extracted from a <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mn id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><cn type="integer" id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">512</annotation></semantics></math>-d bidirectional LSTM at corresponding positions. The hidden representation and attention map encoding are <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mn id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><cn type="integer" id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">1024</annotation></semantics></math>-d and <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><mn id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><cn type="integer" id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">128</annotation></semantics></math>-d, respectively.
Since attention is performed on <math id="S4.SS2.p3.6.m6.1" class="ltx_Math" alttext="36" display="inline"><semantics id="S4.SS2.p3.6.m6.1a"><mn id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">36</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><cn type="integer" id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">36</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">36</annotation></semantics></math> objects instead of the feature map, we use a fully connected layer rather than a convolutional layer to encode the attention results. Specifically, we concatenate the <math id="S4.SS2.p3.7.m7.1" class="ltx_Math" alttext="36" display="inline"><semantics id="S4.SS2.p3.7.m7.1a"><mn id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">36</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><cn type="integer" id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">36</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">36</annotation></semantics></math>-d attention weights with corresponding <math id="S4.SS2.p3.8.m8.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.SS2.p3.8.m8.1a"><mn id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b"><cn type="integer" id="S4.SS2.p3.8.m8.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.1c">4</annotation></semantics></math>-d bounding box coordinates, then flatten it to a <math id="S4.SS2.p3.9.m9.1" class="ltx_Math" alttext="36*5" display="inline"><semantics id="S4.SS2.p3.9.m9.1a"><mrow id="S4.SS2.p3.9.m9.1.1" xref="S4.SS2.p3.9.m9.1.1.cmml"><mn id="S4.SS2.p3.9.m9.1.1.2" xref="S4.SS2.p3.9.m9.1.1.2.cmml">36</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p3.9.m9.1.1.1" xref="S4.SS2.p3.9.m9.1.1.1.cmml">∗</mo><mn id="S4.SS2.p3.9.m9.1.1.3" xref="S4.SS2.p3.9.m9.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m9.1b"><apply id="S4.SS2.p3.9.m9.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1"><times id="S4.SS2.p3.9.m9.1.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1.1"></times><cn type="integer" id="S4.SS2.p3.9.m9.1.1.2.cmml" xref="S4.SS2.p3.9.m9.1.1.2">36</cn><cn type="integer" id="S4.SS2.p3.9.m9.1.1.3.cmml" xref="S4.SS2.p3.9.m9.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m9.1c">36*5</annotation></semantics></math>-d vector, and finally fed the <math id="S4.SS2.p3.10.m10.1" class="ltx_Math" alttext="180" display="inline"><semantics id="S4.SS2.p3.10.m10.1a"><mn id="S4.SS2.p3.10.m10.1.1" xref="S4.SS2.p3.10.m10.1.1.cmml">180</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m10.1b"><cn type="integer" id="S4.SS2.p3.10.m10.1.1.cmml" xref="S4.SS2.p3.10.m10.1.1">180</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m10.1c">180</annotation></semantics></math>-d vector into a fully-connected layer to produce the <math id="S4.SS2.p3.11.m11.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS2.p3.11.m11.1a"><mn id="S4.SS2.p3.11.m11.1.1" xref="S4.SS2.p3.11.m11.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.11.m11.1b"><cn type="integer" id="S4.SS2.p3.11.m11.1.1.cmml" xref="S4.SS2.p3.11.m11.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.11.m11.1c">128</annotation></semantics></math>-d attention map encoding.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.10" class="ltx_p">For CLEVR and FigureQA dataset, the model is trained with the Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. The base learning rate is <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="0.0003" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mn id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">0.0003</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><cn type="float" id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">0.0003</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">0.0003</annotation></semantics></math> for CLEVR, and it is <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mn id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><cn type="float" id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">0.0001</annotation></semantics></math> for FigureQA. The batch size is <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mn id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><cn type="integer" id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">64</annotation></semantics></math>. The weight decay, <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="{\beta}_{1}" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><msub id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">β</mi><mn id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">𝛽</ci><cn type="integer" id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">{\beta}_{1}</annotation></semantics></math> and <math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="{\beta}_{2}" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><msub id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mi id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">β</mi><mn id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">𝛽</ci><cn type="integer" id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">{\beta}_{2}</annotation></semantics></math> are <math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="0.00001" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mn id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">0.00001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><cn type="float" id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">0.00001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">0.00001</annotation></semantics></math>, <math id="S4.SS2.p4.7.m7.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S4.SS2.p4.7.m7.1a"><mn id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><cn type="float" id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">0.9</annotation></semantics></math>, and <math id="S4.SS2.p4.8.m8.1" class="ltx_Math" alttext="0.999" display="inline"><semantics id="S4.SS2.p4.8.m8.1a"><mn id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml">0.999</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><cn type="float" id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">0.999</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">0.999</annotation></semantics></math>, respectively. We train our model on the training split, and then we evaluate on the validation or test split.
For VQAv2 dataset, we train the model on VQAv2 on training and validation split with Adamax <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> with a learning rate of <math id="S4.SS2.p4.9.m9.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S4.SS2.p4.9.m9.1a"><mn id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.1b"><cn type="float" id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.1c">0.001</annotation></semantics></math> and a batch size of <math id="S4.SS2.p4.10.m10.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS2.p4.10.m10.1a"><mn id="S4.SS2.p4.10.m10.1.1" xref="S4.SS2.p4.10.m10.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m10.1b"><cn type="integer" id="S4.SS2.p4.10.m10.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m10.1c">128</annotation></semantics></math>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Comparison of question answering accuracy on FigureQA validation and test sets that have alternative color schemes.</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Model</th>
<th id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Val</th>
<th id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Test</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<th id="S4.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Text only</th>
<td id="S4.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.01</td>
<td id="S4.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.01</td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<th id="S4.T2.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">CNN+LSTM</th>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">56.16</td>
<td id="S4.T2.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">56.00</td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<th id="S4.T2.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">CNN+LSTM on VGG-16 features</th>
<td id="S4.T2.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">52.31</td>
<td id="S4.T2.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r">52.47</td>
</tr>
<tr id="S4.T2.1.5.4" class="ltx_tr">
<th id="S4.T2.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">RN</th>
<td id="S4.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">72.54</td>
<td id="S4.T2.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r">72.40</td>
</tr>
<tr id="S4.T2.1.6.5" class="ltx_tr">
<th id="S4.T2.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">Ours</th>
<td id="S4.T2.1.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">86.25</td>
<td id="S4.T2.1.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">86.23</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span id="S4.SS3.1.1" class="ltx_text ltx_font_italic">Comparison with state-of-the-art models</span>
</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>CLEVR dataset</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">Table <a href="#S4.T1" title="TABLE I ‣ 4.1 Datasets ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> shows the performances of different works on the CLEVR test set. The previous end-to-end modular network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and program execution engine <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> are referred to as N2NMN and PE, respectively. Both approaches use functional programs as the ground-truth layout, and they train their question parser in a sequence-to-sequence manner with strong supervision. They also have variants that are trained using signals with semisupervision or no supervision. “N2NMN scratch” indicates the end-to-end modular network without layout supervision and “N2NMN cloning expert” shows the results of models trained with full supervision. “N2NMN policy search” provides this model’s best results if it further trains the parser from “N2NMN cloning expert” with RL.
As shown, our model outperforms the previous models by a large margin without using a dataset-specific layout, thus showing the good generalizability of PTGRN. PTGRN also surpasses the program execution engine <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> variant trained with semisupervision (as “PE-semi-9K”).
Furthermore, PE-Strong <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, NS-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> and TbD+reg+hres <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> used extra program layouts as additional supervision signals. RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> and FiLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> are black-box models that lack interpretability. PTGRN not only obtains comparable accuracy, but also provides more explicit reasoning results without dataset-specific layout supervision.</p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para">
<p id="S4.SS3.SSS1.p2.1" class="ltx_p">“ACMN” shows the results of our preliminary work. It performs structured reasoning along the dependency tree but has three differences. 1) Rather than learning a forget gate, it drops the attention map or hidden representation according to whether the edge is a clausal predicate relation or a modifier relation. 2) It performs fusion between hidden and question encodings independent of edge type, but each node shares only weights with other nodes at the same height. 3) It propagates the attention map without extra encoding, and the attention module masks the image feature adversary based on the children’s attention maps. As shown, our proposed modules significantly improve the performance by <math id="S4.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="6.2\%" display="inline"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><mrow id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml"><mn id="S4.SS3.SSS1.p2.1.m1.1.1.2" xref="S4.SS3.SSS1.p2.1.m1.1.1.2.cmml">6.2</mn><mo id="S4.SS3.SSS1.p2.1.m1.1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><apply id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.2">6.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">6.2\%</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.SSS1.p3" class="ltx_para">
<p id="S4.SS3.SSS1.p3.1" class="ltx_p">Figure <a href="#S4.F6" title="Figure 6 ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the promising intermediate reasoning results achieved by PTGRN. The images and the dependency parse trees are shown on the left and bottom. The attention map that our model obtained at each tree node is displayed on the right and top. The first example shows that our model can first locate the “big metallic object”, while the phrase “same shape” attends the same region. Later, our model attends all objects except the metallic object given the phrase “any other things”, and the phrase “are there” extracts the attended objects’ features and predicts the answer “no”. The second example first locates the “yellow rubber” thing, and it attends nothing given the phrase “small red spheres” because there is no such object in the image. Then, it sequentially attends the “left” and “shiny things” based on the yellow rubber object and predicts the answer “yes”.</p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>FigureQA dataset</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">Table <a href="#S4.T2" title="TABLE II ‣ 4.2 Implementation details ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> presents the comparisons of our model with prior works on the FigureQA dataset. The baseline methods “Text only”, “CNN+LSTM”, “CNN+LSTM on VGG-16 features” and “RN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>” were originally reported in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. As shown, PTGRN outperforms all baseline methods by a large margin, including the relational network, which has achieved great performance on the CLEVR dataset. This result demonstrates the generalizability of our model across different datasets.
Figure <a href="#S4.F7" title="Figure 7 ‣ 4.2 Implementation details ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the reasoning route on the FigureQA dataset. The first question queries whether the plot of purple is greater than that of midnight blue. Our model successfully locates midnight blue in the first two steps, and then it locates the dotted purple line and predicts the answer. The second example first locates several bars that are “median”, and then it attends the “dark magenta” bar to predict that it is the low median.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Question answering accuracy on VQAv2 test-dev and test-std.</figcaption>
<div id="S4.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:117.4pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-17.7pt,4.8pt) scale(0.924376428474588,0.924376428474588) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4">test-dev</th>
<th id="S4.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4">test-std</th>
</tr>
<tr id="S4.T3.1.1.2.2" class="ltx_tr">
<th id="S4.T3.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r">Method</th>
<th id="S4.T3.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">All</th>
<th id="S4.T3.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">Yes/no</th>
<th id="S4.T3.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">Numb.</th>
<th id="S4.T3.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Other</th>
<th id="S4.T3.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">All</th>
<th id="S4.T3.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">Yes/no</th>
<th id="S4.T3.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">Numb.</th>
<th id="S4.T3.1.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Other</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.3.1" class="ltx_tr">
<th id="S4.T3.1.1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Bottom-Up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>
</th>
<td id="S4.T3.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">65.32</td>
<td id="S4.T3.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">81.82</td>
<td id="S4.T3.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">44.21</td>
<td id="S4.T3.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.05</td>
<td id="S4.T3.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">65.67</td>
<td id="S4.T3.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">82.20</td>
<td id="S4.T3.1.1.3.1.8" class="ltx_td ltx_align_center ltx_border_t">43.90</td>
<td id="S4.T3.1.1.3.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.26</td>
</tr>
<tr id="S4.T3.1.1.4.2" class="ltx_tr">
<th id="S4.T3.1.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">Counter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</th>
<td id="S4.T3.1.1.4.2.2" class="ltx_td ltx_align_center">68.09</td>
<td id="S4.T3.1.1.4.2.3" class="ltx_td ltx_align_center">83.14</td>
<td id="S4.T3.1.1.4.2.4" class="ltx_td ltx_align_center">51.62</td>
<td id="S4.T3.1.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">58.97</td>
<td id="S4.T3.1.1.4.2.6" class="ltx_td ltx_align_center">68.41</td>
<td id="S4.T3.1.1.4.2.7" class="ltx_td ltx_align_center">83.56</td>
<td id="S4.T3.1.1.4.2.8" class="ltx_td ltx_align_center">51.39</td>
<td id="S4.T3.1.1.4.2.9" class="ltx_td ltx_align_center ltx_border_r">59.11</td>
</tr>
<tr id="S4.T3.1.1.5.3" class="ltx_tr">
<th id="S4.T3.1.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">BAN+Glove+Counter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>
</th>
<td id="S4.T3.1.1.5.3.2" class="ltx_td ltx_align_center">70.04</td>
<td id="S4.T3.1.1.5.3.3" class="ltx_td ltx_align_center">85.42</td>
<td id="S4.T3.1.1.5.3.4" class="ltx_td ltx_align_center">54.04</td>
<td id="S4.T3.1.1.5.3.5" class="ltx_td ltx_align_center ltx_border_r">60.52</td>
<td id="S4.T3.1.1.5.3.6" class="ltx_td ltx_align_center">70.35</td>
<td id="S4.T3.1.1.5.3.7" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.1.5.3.8" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.1.5.3.9" class="ltx_td ltx_align_center ltx_border_r">-</td>
</tr>
<tr id="S4.T3.1.1.6.4" class="ltx_tr">
<th id="S4.T3.1.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">ACMN</th>
<td id="S4.T3.1.1.6.4.2" class="ltx_td ltx_align_center">63.81</td>
<td id="S4.T3.1.1.6.4.3" class="ltx_td ltx_align_center">81.59</td>
<td id="S4.T3.1.1.6.4.4" class="ltx_td ltx_align_center">44.18</td>
<td id="S4.T3.1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_r">53.07</td>
<td id="S4.T3.1.1.6.4.6" class="ltx_td ltx_align_center">64.05</td>
<td id="S4.T3.1.1.6.4.7" class="ltx_td ltx_align_center">81.83</td>
<td id="S4.T3.1.1.6.4.8" class="ltx_td ltx_align_center">43.80</td>
<td id="S4.T3.1.1.6.4.9" class="ltx_td ltx_align_center ltx_border_r">53.22</td>
</tr>
<tr id="S4.T3.1.1.7.5" class="ltx_tr">
<th id="S4.T3.1.1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">PTGRN</th>
<td id="S4.T3.1.1.7.5.2" class="ltx_td ltx_align_center ltx_border_b">67.07</td>
<td id="S4.T3.1.1.7.5.3" class="ltx_td ltx_align_center ltx_border_b">83.69</td>
<td id="S4.T3.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_b">48.47</td>
<td id="S4.T3.1.1.7.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">57.09</td>
<td id="S4.T3.1.1.7.5.6" class="ltx_td ltx_align_center ltx_border_b">67.26</td>
<td id="S4.T3.1.1.7.5.7" class="ltx_td ltx_align_center ltx_border_b">83.67</td>
<td id="S4.T3.1.1.7.5.8" class="ltx_td ltx_align_center ltx_border_b">48.22</td>
<td id="S4.T3.1.1.7.5.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">57.33</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1809.01810/assets/figure/vqav2_1.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="269" height="222" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1809.01810/assets/figure/vqav2_2.png" id="S4.F8.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="269" height="222" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Examples of the dependency trees of questions and the corresponding regions attended by our model at each step on the VQAv2 dataset.</figcaption>
</figure>
</section>
<section id="S4.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>VQAv2 dataset</h4>

<div id="S4.SS3.SSS3.p1" class="ltx_para">
<p id="S4.SS3.SSS3.p1.1" class="ltx_p">We compare our model with state-of-art methods on the VQAv2 dataset, The results are shown in Table <a href="#S4.T3" title="TABLE III ‣ 4.3.2 FigureQA dataset ‣ 4.3 Comparison with state-of-the-art models ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, and the intermediate reasoning results are shown in Figure <a href="#S4.F8" title="Figure 8 ‣ 4.3.2 FigureQA dataset ‣ 4.3 Comparison with state-of-the-art models ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<div id="S4.SS3.SSS3.p2" class="ltx_para">
<p id="S4.SS3.SSS3.p2.1" class="ltx_p">Compared with bottom-up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> baseline, our model gains improvement on overall accuracy and gains large improvement on “Number” questions.
Our model don’t outperform other state-of-the-art model for the following two reasons.
First, current state-of-the-art models use many techniques such as multiple glimpse, stacked attention and data augmentation to achieve high accuracy. These techniques can be applied generally and thus cannot determine the contribution of a certain model.
Second, our model performs reasoning on dependency parse trees and handles the compositional reasoning of words in the questions, but it gains no advantage on reasoning with a single word.
However, as shown in Figure <a href="#S4.F8" title="Figure 8 ‣ 4.3.2 FigureQA dataset ‣ 4.3 Comparison with state-of-the-art models ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, most questions in VQAv2 are structurally simple. They do not require compositional reasoning of elements in the image but require complex commonsense reasoning that is outside the image. One of the most common examples is the word “why”. To give an interpretable reasoning process, it may need to perform multistep inference on a commonsense knowledge graph, which is not included in the VQAv2 dataset.</p>
</div>
<figure id="S4.F9" class="ltx_figure"><img src="/html/1809.01810/assets/figure/clevr_cogen.png" id="S4.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="358" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Two examples of the dependency trees of questions and corresponding regions attended by our model at each step on the CLEVR-CoGen test set. </figcaption>
</figure>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span><span id="S4.SS4.1.1" class="ltx_text ltx_font_italic">CLEVR composition generalization test</span>
</h3>

<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Comparisons of question answering accuracy on the CLEVR-CoGenT validation set. Each method is trained on condition A only and evaluated on both condition A and condition B.</figcaption>
<table id="S4.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">Train A</th>
</tr>
<tr id="S4.T4.1.2.2" class="ltx_tr">
<th id="S4.T4.1.2.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r">Model</th>
<th id="S4.T4.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">A</th>
<th id="S4.T4.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">B</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.3.1" class="ltx_tr">
<th id="S4.T4.1.3.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">CNN+LSTM+SA</th>
<td id="S4.T4.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80.3</td>
<td id="S4.T4.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.7</td>
</tr>
<tr id="S4.T4.1.4.2" class="ltx_tr">
<th id="S4.T4.1.4.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r">PG+EE (18K prog.)</th>
<td id="S4.T4.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">96.6</td>
<td id="S4.T4.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">73.7</td>
</tr>
<tr id="S4.T4.1.5.3" class="ltx_tr">
<th id="S4.T4.1.5.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r">CNN+GRU+FiLM</th>
<td id="S4.T4.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r">98.3</td>
<td id="S4.T4.1.5.3.3" class="ltx_td ltx_align_center ltx_border_r">75.6</td>
</tr>
<tr id="S4.T4.1.6.4" class="ltx_tr">
<th id="S4.T4.1.6.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r">CNN+GRU+FiLM 0-Shot</th>
<td id="S4.T4.1.6.4.2" class="ltx_td ltx_align_center ltx_border_r">98.3</td>
<td id="S4.T4.1.6.4.3" class="ltx_td ltx_align_center ltx_border_r">78.8</td>
</tr>
<tr id="S4.T4.1.7.5" class="ltx_tr">
<th id="S4.T4.1.7.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Ours</th>
<td id="S4.T4.1.7.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">97.35</td>
<td id="S4.T4.1.7.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">83.50</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">The CLEVR composition generalization test (CLEVR-CoGenT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> was proposed to investigate the composition generalizability of a VQA model. This dataset contains synthesized images and questions similar to CLEVR, but it has two conditions: in condition A, all cubes are gray, blue, brown, or yellow, and all cylinders are red, green, purple, or cyan; in condition B, cubes and cylinders swap color palettes. Thus, one model cannot achieve good performance on condition B by simply memorizing and overfitting the samples in condition A.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.2" class="ltx_p">We report the accuracy of our model in Table <a href="#S4.T4" title="TABLE IV ‣ 4.4 CLEVR composition generalization test ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. “Ours” represents the model that we trained on the CLEVR dataset with the same settings and hyperparameters. We train it on a training set that meets condition A and evaluate it on a validation set that meets condition A and condition B. Our model achieves <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="97.35\%" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mn id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">97.35</mn><mo id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">97.35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">97.35\%</annotation></semantics></math> accuracy on condition A, and it achieves <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="83.50\%" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mn id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">83.50</mn><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">83.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">83.50\%</annotation></semantics></math> accuracy on condition B without being fine-tuned on the alternative color scheme set B. Our method achieves higher accuracy on condition B, while the accuracy on condition A is similar to PE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and FiLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. This result demonstrates that our model has better composition generalizability.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">In Figure <a href="#S4.F9" title="Figure 9 ‣ 4.3.3 VQAv2 dataset ‣ 4.3 Comparison with state-of-the-art models ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, we show our model’s reasoning routes on the CLEVR-CoGenT condition B validation set. We display the image and parse tree on the left, and the attention map at each step is shown on the right. The first questions query the number of purple blocks and cyan metallic cubes. When there are no “cyan metallic cubes”, the first step attends nothing, while the second step successfully attends the three purple blocks. Note that there is no purple block in the training set, and our model correctly distinguishes the purple blocks from the red block. The second example follows the parsed tree and successively attends the “green object”, its “left” and the “gray thing”. Gray cylinders are not present in the training set, but our model can locate the color “gray” and then predict the answer. These examples show that our model can locate the color and the object separately and that it possesses composition generalizability to a certain extent.</p>
</div>
<figure id="S4.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/1809.01810/assets/figure/clevr_cmp1.png" id="S4.F10.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="568" height="318" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/1809.01810/assets/figure/clevr_cmp2.png" id="S4.F10.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="568" height="414" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Quality comparison of the model with and without GRU and the propagation module</figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span><span id="S4.SS5.1.1" class="ltx_text ltx_font_italic">Ablation studies</span>
</h3>

<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>CLEVR validation accuracy for ablations. We incrementally replace the components of the baseline model with redeveloped modules and report their results on each row.</figcaption>
<div id="S4.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:114.8pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-125.0pt,32.9pt) scale(0.634306890241551,0.634306890241551) ;">
<table id="S4.T5.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.1.1" class="ltx_tr">
<td id="S4.T5.1.1.1.1.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S4.T5.1.1.1.1.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T5.1.1.1.1.3" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S4.T5.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">Compare Integer</td>
<td id="S4.T5.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">Query</td>
<td id="S4.T5.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4">Compare</td>
<td id="S4.T5.1.1.1.1.7" class="ltx_td ltx_border_r ltx_border_t"></td>
</tr>
<tr id="S4.T5.1.1.2.2" class="ltx_tr">
<td id="S4.T5.1.1.2.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">Method</td>
<td id="S4.T5.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Exist</td>
<td id="S4.T5.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Count</td>
<td id="S4.T5.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">Equal</td>
<td id="S4.T5.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">Less</td>
<td id="S4.T5.1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">More</td>
<td id="S4.T5.1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">Size</td>
<td id="S4.T5.1.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t">Color</td>
<td id="S4.T5.1.1.2.2.9" class="ltx_td ltx_align_center ltx_border_t">Material</td>
<td id="S4.T5.1.1.2.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Shape</td>
<td id="S4.T5.1.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t">Size</td>
<td id="S4.T5.1.1.2.2.12" class="ltx_td ltx_align_center ltx_border_t">Color</td>
<td id="S4.T5.1.1.2.2.13" class="ltx_td ltx_align_center ltx_border_t">Material</td>
<td id="S4.T5.1.1.2.2.14" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Shape</td>
<td id="S4.T5.1.1.2.2.15" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Overall</td>
</tr>
<tr id="S4.T5.1.1.3.3" class="ltx_tr">
<td id="S4.T5.1.1.3.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">ACMN</td>
<td id="S4.T5.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">94.20</td>
<td id="S4.T5.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80.46</td>
<td id="S4.T5.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">74.21</td>
<td id="S4.T5.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">88.98</td>
<td id="S4.T5.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">83.62</td>
<td id="S4.T5.1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">93.10</td>
<td id="S4.T5.1.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">86.42</td>
<td id="S4.T5.1.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t">92.16</td>
<td id="S4.T5.1.1.3.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.72</td>
<td id="S4.T5.1.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t">97.17</td>
<td id="S4.T5.1.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t">96.54</td>
<td id="S4.T5.1.1.3.3.13" class="ltx_td ltx_align_center ltx_border_t">95.94</td>
<td id="S4.T5.1.1.3.3.14" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">96.64</td>
<td id="S4.T5.1.1.3.3.15" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.01</td>
</tr>
<tr id="S4.T5.1.1.4.4" class="ltx_tr">
<td id="S4.T5.1.1.4.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">baseline</td>
<td id="S4.T5.1.1.4.4.2" class="ltx_td ltx_align_center">91.38</td>
<td id="S4.T5.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">75.62</td>
<td id="S4.T5.1.1.4.4.4" class="ltx_td ltx_align_center">76.24</td>
<td id="S4.T5.1.1.4.4.5" class="ltx_td ltx_align_center">89.00</td>
<td id="S4.T5.1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_r">85.26</td>
<td id="S4.T5.1.1.4.4.7" class="ltx_td ltx_align_center">92.71</td>
<td id="S4.T5.1.1.4.4.8" class="ltx_td ltx_align_center">86.20</td>
<td id="S4.T5.1.1.4.4.9" class="ltx_td ltx_align_center">92.33</td>
<td id="S4.T5.1.1.4.4.10" class="ltx_td ltx_align_center ltx_border_r">89.18</td>
<td id="S4.T5.1.1.4.4.11" class="ltx_td ltx_align_center">98.29</td>
<td id="S4.T5.1.1.4.4.12" class="ltx_td ltx_align_center">96.06</td>
<td id="S4.T5.1.1.4.4.13" class="ltx_td ltx_align_center">97.43</td>
<td id="S4.T5.1.1.4.4.14" class="ltx_td ltx_align_center ltx_border_r">97.05</td>
<td id="S4.T5.1.1.4.4.15" class="ltx_td ltx_align_center ltx_border_r">87.62</td>
</tr>
<tr id="S4.T5.1.1.5.5" class="ltx_tr">
<td id="S4.T5.1.1.5.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">+Edge</td>
<td id="S4.T5.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">93.98</td>
<td id="S4.T5.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80.18</td>
<td id="S4.T5.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">72.18</td>
<td id="S4.T5.1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t">87.55</td>
<td id="S4.T5.1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">84.86</td>
<td id="S4.T5.1.1.5.5.7" class="ltx_td ltx_align_center ltx_border_t">93.37</td>
<td id="S4.T5.1.1.5.5.8" class="ltx_td ltx_align_center ltx_border_t">86.61</td>
<td id="S4.T5.1.1.5.5.9" class="ltx_td ltx_align_center ltx_border_t">92.35</td>
<td id="S4.T5.1.1.5.5.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.36</td>
<td id="S4.T5.1.1.5.5.11" class="ltx_td ltx_align_center ltx_border_t">98.92</td>
<td id="S4.T5.1.1.5.5.12" class="ltx_td ltx_align_center ltx_border_t">98.01</td>
<td id="S4.T5.1.1.5.5.13" class="ltx_td ltx_align_center ltx_border_t">98.20</td>
<td id="S4.T5.1.1.5.5.14" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">97.72</td>
<td id="S4.T5.1.1.5.5.15" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.28</td>
</tr>
<tr id="S4.T5.1.1.6.6" class="ltx_tr">
<td id="S4.T5.1.1.6.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">+Edge+GRU</td>
<td id="S4.T5.1.1.6.6.2" class="ltx_td ltx_align_center">95.23</td>
<td id="S4.T5.1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">82.62</td>
<td id="S4.T5.1.1.6.6.4" class="ltx_td ltx_align_center">83.93</td>
<td id="S4.T5.1.1.6.6.5" class="ltx_td ltx_align_center">92.04</td>
<td id="S4.T5.1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_r">91.89</td>
<td id="S4.T5.1.1.6.6.7" class="ltx_td ltx_align_center">92.61</td>
<td id="S4.T5.1.1.6.6.8" class="ltx_td ltx_align_center">85.92</td>
<td id="S4.T5.1.1.6.6.9" class="ltx_td ltx_align_center">92.23</td>
<td id="S4.T5.1.1.6.6.10" class="ltx_td ltx_align_center ltx_border_r">89.44</td>
<td id="S4.T5.1.1.6.6.11" class="ltx_td ltx_align_center">98.56</td>
<td id="S4.T5.1.1.6.6.12" class="ltx_td ltx_align_center">98.37</td>
<td id="S4.T5.1.1.6.6.13" class="ltx_td ltx_align_center">97.88</td>
<td id="S4.T5.1.1.6.6.14" class="ltx_td ltx_align_center ltx_border_r">97.69</td>
<td id="S4.T5.1.1.6.6.15" class="ltx_td ltx_align_center ltx_border_r">90.44</td>
</tr>
<tr id="S4.T5.1.1.7.7" class="ltx_tr">
<td id="S4.T5.1.1.7.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">+Edge+ConcatAtt</td>
<td id="S4.T5.1.1.7.7.2" class="ltx_td ltx_align_center">96.38</td>
<td id="S4.T5.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">85.51</td>
<td id="S4.T5.1.1.7.7.4" class="ltx_td ltx_align_center">86.28</td>
<td id="S4.T5.1.1.7.7.5" class="ltx_td ltx_align_center">95.37</td>
<td id="S4.T5.1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_r">93.81</td>
<td id="S4.T5.1.1.7.7.7" class="ltx_td ltx_align_center">95.99</td>
<td id="S4.T5.1.1.7.7.8" class="ltx_td ltx_align_center">95.22</td>
<td id="S4.T5.1.1.7.7.9" class="ltx_td ltx_align_center">95.37</td>
<td id="S4.T5.1.1.7.7.10" class="ltx_td ltx_align_center ltx_border_r">94.48</td>
<td id="S4.T5.1.1.7.7.11" class="ltx_td ltx_align_center">98.74</td>
<td id="S4.T5.1.1.7.7.12" class="ltx_td ltx_align_center">97.59</td>
<td id="S4.T5.1.1.7.7.13" class="ltx_td ltx_align_center">98.12</td>
<td id="S4.T5.1.1.7.7.14" class="ltx_td ltx_align_center ltx_border_r">97.66</td>
<td id="S4.T5.1.1.7.7.15" class="ltx_td ltx_align_center ltx_border_r">93.36</td>
</tr>
<tr id="S4.T5.1.1.8.8" class="ltx_tr">
<td id="S4.T5.1.1.8.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">+Edge+GRU+ConcatAtt</td>
<td id="S4.T5.1.1.8.8.2" class="ltx_td ltx_align_center">95.81</td>
<td id="S4.T5.1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r">86.31</td>
<td id="S4.T5.1.1.8.8.4" class="ltx_td ltx_align_center">85.44</td>
<td id="S4.T5.1.1.8.8.5" class="ltx_td ltx_align_center">94.90</td>
<td id="S4.T5.1.1.8.8.6" class="ltx_td ltx_align_center ltx_border_r">93.13</td>
<td id="S4.T5.1.1.8.8.7" class="ltx_td ltx_align_center">96.03</td>
<td id="S4.T5.1.1.8.8.8" class="ltx_td ltx_align_center">96.12</td>
<td id="S4.T5.1.1.8.8.9" class="ltx_td ltx_align_center">95.58</td>
<td id="S4.T5.1.1.8.8.10" class="ltx_td ltx_align_center ltx_border_r">94.06</td>
<td id="S4.T5.1.1.8.8.11" class="ltx_td ltx_align_center">98.72</td>
<td id="S4.T5.1.1.8.8.12" class="ltx_td ltx_align_center">98.32</td>
<td id="S4.T5.1.1.8.8.13" class="ltx_td ltx_align_center">98.23</td>
<td id="S4.T5.1.1.8.8.14" class="ltx_td ltx_align_center ltx_border_r">97.88</td>
<td id="S4.T5.1.1.8.8.15" class="ltx_td ltx_align_center ltx_border_r">93.53</td>
</tr>
<tr id="S4.T5.1.1.9.9" class="ltx_tr">
<td id="S4.T5.1.1.9.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">+Edge+GRU+GRUAtt</td>
<td id="S4.T5.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t">96.80</td>
<td id="S4.T5.1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">87.50</td>
<td id="S4.T5.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t">89.00</td>
<td id="S4.T5.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t">96.04</td>
<td id="S4.T5.1.1.9.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">95.33</td>
<td id="S4.T5.1.1.9.9.7" class="ltx_td ltx_align_center ltx_border_t">96.76</td>
<td id="S4.T5.1.1.9.9.8" class="ltx_td ltx_align_center ltx_border_t">96.18</td>
<td id="S4.T5.1.1.9.9.9" class="ltx_td ltx_align_center ltx_border_t">96.31</td>
<td id="S4.T5.1.1.9.9.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">95.11</td>
<td id="S4.T5.1.1.9.9.11" class="ltx_td ltx_align_center ltx_border_t">99.39</td>
<td id="S4.T5.1.1.9.9.12" class="ltx_td ltx_align_center ltx_border_t">98.76</td>
<td id="S4.T5.1.1.9.9.13" class="ltx_td ltx_align_center ltx_border_t">98.27</td>
<td id="S4.T5.1.1.9.9.14" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">98.03</td>
<td id="S4.T5.1.1.9.9.15" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">94.42</td>
</tr>
<tr id="S4.T5.1.1.10.10" class="ltx_tr">
<td id="S4.T5.1.1.10.10.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r">+Edge+GRU+ConvGRUAtt</td>
<td id="S4.T5.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_b">97.83</td>
<td id="S4.T5.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">91.78</td>
<td id="S4.T5.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_b">92.08</td>
<td id="S4.T5.1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_b">96.00</td>
<td id="S4.T5.1.1.10.10.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">96.46</td>
<td id="S4.T5.1.1.10.10.7" class="ltx_td ltx_align_center ltx_border_b">95.90</td>
<td id="S4.T5.1.1.10.10.8" class="ltx_td ltx_align_center ltx_border_b">94.00</td>
<td id="S4.T5.1.1.10.10.9" class="ltx_td ltx_align_center ltx_border_b">95.46</td>
<td id="S4.T5.1.1.10.10.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">96.15</td>
<td id="S4.T5.1.1.10.10.11" class="ltx_td ltx_align_center ltx_border_b">99.30</td>
<td id="S4.T5.1.1.10.10.12" class="ltx_td ltx_align_center ltx_border_b">98.32</td>
<td id="S4.T5.1.1.10.10.13" class="ltx_td ltx_align_center ltx_border_b">98.52</td>
<td id="S4.T5.1.1.10.10.14" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">98.19</td>
<td id="S4.T5.1.1.10.10.15" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">95.42</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>CLEVR validation accuracy of PTGRN with different word encoding and provided layout.</figcaption>
<div id="S4.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:72.9pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-107.7pt,17.9pt) scale(0.668105850469535,0.668105850469535) ;">
<table id="S4.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.1.1.1.1" class="ltx_tr">
<th id="S4.T6.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T6.1.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_t"></th>
<th id="S4.T6.1.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_t"></th>
<th id="S4.T6.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">Compare Integer</th>
<th id="S4.T6.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4">Query</th>
<th id="S4.T6.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4">Compare</th>
<th id="S4.T6.1.1.1.1.7" class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_t"></th>
</tr>
<tr id="S4.T6.1.1.2.2" class="ltx_tr">
<th id="S4.T6.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Method</th>
<th id="S4.T6.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Exist</th>
<th id="S4.T6.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Count</th>
<th id="S4.T6.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Equal</th>
<th id="S4.T6.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Less</th>
<th id="S4.T6.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">More</th>
<th id="S4.T6.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Size</th>
<th id="S4.T6.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Color</th>
<th id="S4.T6.1.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Material</th>
<th id="S4.T6.1.1.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Shape</th>
<th id="S4.T6.1.1.2.2.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Size</th>
<th id="S4.T6.1.1.2.2.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Color</th>
<th id="S4.T6.1.1.2.2.13" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Material</th>
<th id="S4.T6.1.1.2.2.14" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Shape</th>
<th id="S4.T6.1.1.2.2.15" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Overall</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.1.1.3.1" class="ltx_tr">
<td id="S4.T6.1.1.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">PTGRN (lookup)</td>
<td id="S4.T6.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">92.66</td>
<td id="S4.T6.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.03</td>
<td id="S4.T6.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">71.19</td>
<td id="S4.T6.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">86.14</td>
<td id="S4.T6.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">83.68</td>
<td id="S4.T6.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">93.22</td>
<td id="S4.T6.1.1.3.1.8" class="ltx_td ltx_align_center ltx_border_t">86.62</td>
<td id="S4.T6.1.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t">92.92</td>
<td id="S4.T6.1.1.3.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.24</td>
<td id="S4.T6.1.1.3.1.11" class="ltx_td ltx_align_center ltx_border_t">94.78</td>
<td id="S4.T6.1.1.3.1.12" class="ltx_td ltx_align_center ltx_border_t">95.52</td>
<td id="S4.T6.1.1.3.1.13" class="ltx_td ltx_align_center ltx_border_t">92.64</td>
<td id="S4.T6.1.1.3.1.14" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">93.11</td>
<td id="S4.T6.1.1.3.1.15" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">87.75</td>
</tr>
<tr id="S4.T6.1.1.4.2" class="ltx_tr">
<td id="S4.T6.1.1.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">PTGRN (LSTM)</td>
<td id="S4.T6.1.1.4.2.2" class="ltx_td ltx_align_center">95.60</td>
<td id="S4.T6.1.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">86.93</td>
<td id="S4.T6.1.1.4.2.4" class="ltx_td ltx_align_center">87.55</td>
<td id="S4.T6.1.1.4.2.5" class="ltx_td ltx_align_center">93.35</td>
<td id="S4.T6.1.1.4.2.6" class="ltx_td ltx_align_center ltx_border_r">93.49</td>
<td id="S4.T6.1.1.4.2.7" class="ltx_td ltx_align_center">94.61</td>
<td id="S4.T6.1.1.4.2.8" class="ltx_td ltx_align_center">88.06</td>
<td id="S4.T6.1.1.4.2.9" class="ltx_td ltx_align_center">93.91</td>
<td id="S4.T6.1.1.4.2.10" class="ltx_td ltx_align_center ltx_border_r">91.92</td>
<td id="S4.T6.1.1.4.2.11" class="ltx_td ltx_align_center">97.00</td>
<td id="S4.T6.1.1.4.2.12" class="ltx_td ltx_align_center">95.64</td>
<td id="S4.T6.1.1.4.2.13" class="ltx_td ltx_align_center">91.19</td>
<td id="S4.T6.1.1.4.2.14" class="ltx_td ltx_align_center ltx_border_r">95.27</td>
<td id="S4.T6.1.1.4.2.15" class="ltx_td ltx_align_center ltx_border_r">91.82</td>
</tr>
<tr id="S4.T6.1.1.5.3" class="ltx_tr">
<td id="S4.T6.1.1.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r">PTGRN (GT layout)</td>
<td id="S4.T6.1.1.5.3.2" class="ltx_td ltx_align_center">98.67</td>
<td id="S4.T6.1.1.5.3.3" class="ltx_td ltx_align_center ltx_border_r">97.70</td>
<td id="S4.T6.1.1.5.3.4" class="ltx_td ltx_align_center">97.53</td>
<td id="S4.T6.1.1.5.3.5" class="ltx_td ltx_align_center">89.79</td>
<td id="S4.T6.1.1.5.3.6" class="ltx_td ltx_align_center ltx_border_r">89.43</td>
<td id="S4.T6.1.1.5.3.7" class="ltx_td ltx_align_center">98.63</td>
<td id="S4.T6.1.1.5.3.8" class="ltx_td ltx_align_center">98.04</td>
<td id="S4.T6.1.1.5.3.9" class="ltx_td ltx_align_center">97.81</td>
<td id="S4.T6.1.1.5.3.10" class="ltx_td ltx_align_center ltx_border_r">97.62</td>
<td id="S4.T6.1.1.5.3.11" class="ltx_td ltx_align_center">99.91</td>
<td id="S4.T6.1.1.5.3.12" class="ltx_td ltx_align_center">98.92</td>
<td id="S4.T6.1.1.5.3.13" class="ltx_td ltx_align_center">98.78</td>
<td id="S4.T6.1.1.5.3.14" class="ltx_td ltx_align_center ltx_border_r">98.47</td>
<td id="S4.T6.1.1.5.3.15" class="ltx_td ltx_align_center ltx_border_r">96.69</td>
</tr>
<tr id="S4.T6.1.1.6.4" class="ltx_tr">
<td id="S4.T6.1.1.6.4.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r">PTGRN</td>
<td id="S4.T6.1.1.6.4.2" class="ltx_td ltx_align_center ltx_border_b">97.83</td>
<td id="S4.T6.1.1.6.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">91.78</td>
<td id="S4.T6.1.1.6.4.4" class="ltx_td ltx_align_center ltx_border_b">92.08</td>
<td id="S4.T6.1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_b">96.00</td>
<td id="S4.T6.1.1.6.4.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">96.46</td>
<td id="S4.T6.1.1.6.4.7" class="ltx_td ltx_align_center ltx_border_b">95.90</td>
<td id="S4.T6.1.1.6.4.8" class="ltx_td ltx_align_center ltx_border_b">94.00</td>
<td id="S4.T6.1.1.6.4.9" class="ltx_td ltx_align_center ltx_border_b">95.46</td>
<td id="S4.T6.1.1.6.4.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">96.15</td>
<td id="S4.T6.1.1.6.4.11" class="ltx_td ltx_align_center ltx_border_b">99.30</td>
<td id="S4.T6.1.1.6.4.12" class="ltx_td ltx_align_center ltx_border_b">98.32</td>
<td id="S4.T6.1.1.6.4.13" class="ltx_td ltx_align_center ltx_border_b">98.52</td>
<td id="S4.T6.1.1.6.4.14" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">98.19</td>
<td id="S4.T6.1.1.6.4.15" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">95.42</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We first compare the performance with and without the redeveloped components in our model. We incrementally add the modules to the baseline model, and we show the accuracy on the CLEVR validation set in Table <a href="#S4.T5" title="TABLE V ‣ 4.5 Ablation studies ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.11" class="ltx_p"><span id="S4.SS5.p2.11.1" class="ltx_text ltx_font_bold">ACMN</span>  The adversarial composition modular network (ACMN) presented in the preliminary work performs structured reasoning along a general dependency parse tree. In each node, it first mines local visual evidence with the adversarial attention module: the image feature is masked by <math id="S4.SS5.p2.1.m1.1" class="ltx_Math" alttext="ReLU(1-\tilde{att})" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mrow id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml"><mi id="S4.SS5.p2.1.m1.1.1.3" xref="S4.SS5.p2.1.m1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.1.1.2" xref="S4.SS5.p2.1.m1.1.1.2.cmml">​</mo><mi id="S4.SS5.p2.1.m1.1.1.4" xref="S4.SS5.p2.1.m1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.1.1.2a" xref="S4.SS5.p2.1.m1.1.1.2.cmml">​</mo><mi id="S4.SS5.p2.1.m1.1.1.5" xref="S4.SS5.p2.1.m1.1.1.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.1.1.2b" xref="S4.SS5.p2.1.m1.1.1.2.cmml">​</mo><mi id="S4.SS5.p2.1.m1.1.1.6" xref="S4.SS5.p2.1.m1.1.1.6.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.1.1.2c" xref="S4.SS5.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S4.SS5.p2.1.m1.1.1.1.1" xref="S4.SS5.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS5.p2.1.m1.1.1.1.1.2" xref="S4.SS5.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.p2.1.m1.1.1.1.1.1" xref="S4.SS5.p2.1.m1.1.1.1.1.1.cmml"><mn id="S4.SS5.p2.1.m1.1.1.1.1.1.2" xref="S4.SS5.p2.1.m1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS5.p2.1.m1.1.1.1.1.1.1" xref="S4.SS5.p2.1.m1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.SS5.p2.1.m1.1.1.1.1.1.3" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.cmml"><mrow id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.2" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.1" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.3" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.1a" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.4" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.4.cmml">t</mi></mrow><mo id="S4.SS5.p2.1.m1.1.1.1.1.1.3.1" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.1.cmml">~</mo></mover></mrow><mo stretchy="false" id="S4.SS5.p2.1.m1.1.1.1.1.3" xref="S4.SS5.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><apply id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1"><times id="S4.SS5.p2.1.m1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.1.1.2"></times><ci id="S4.SS5.p2.1.m1.1.1.3.cmml" xref="S4.SS5.p2.1.m1.1.1.3">𝑅</ci><ci id="S4.SS5.p2.1.m1.1.1.4.cmml" xref="S4.SS5.p2.1.m1.1.1.4">𝑒</ci><ci id="S4.SS5.p2.1.m1.1.1.5.cmml" xref="S4.SS5.p2.1.m1.1.1.5">𝐿</ci><ci id="S4.SS5.p2.1.m1.1.1.6.cmml" xref="S4.SS5.p2.1.m1.1.1.6">𝑈</ci><apply id="S4.SS5.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1"><minus id="S4.SS5.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS5.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.2">1</cn><apply id="S4.SS5.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3"><ci id="S4.SS5.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.1">~</ci><apply id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2"><times id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.1"></times><ci id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.2">𝑎</ci><ci id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.3">𝑡</ci><ci id="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.4.cmml" xref="S4.SS5.p2.1.m1.1.1.1.1.1.3.2.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">ReLU(1-\tilde{att})</annotation></semantics></math>, where <math id="S4.SS5.p2.2.m2.1" class="ltx_Math" alttext="\tilde{att}" display="inline"><semantics id="S4.SS5.p2.2.m2.1a"><mover accent="true" id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml"><mrow id="S4.SS5.p2.2.m2.1.1.2" xref="S4.SS5.p2.2.m2.1.1.2.cmml"><mi id="S4.SS5.p2.2.m2.1.1.2.2" xref="S4.SS5.p2.2.m2.1.1.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.2.m2.1.1.2.1" xref="S4.SS5.p2.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS5.p2.2.m2.1.1.2.3" xref="S4.SS5.p2.2.m2.1.1.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.2.m2.1.1.2.1a" xref="S4.SS5.p2.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS5.p2.2.m2.1.1.2.4" xref="S4.SS5.p2.2.m2.1.1.2.4.cmml">t</mi></mrow><mo id="S4.SS5.p2.2.m2.1.1.1" xref="S4.SS5.p2.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><apply id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1"><ci id="S4.SS5.p2.2.m2.1.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1.1">~</ci><apply id="S4.SS5.p2.2.m2.1.1.2.cmml" xref="S4.SS5.p2.2.m2.1.1.2"><times id="S4.SS5.p2.2.m2.1.1.2.1.cmml" xref="S4.SS5.p2.2.m2.1.1.2.1"></times><ci id="S4.SS5.p2.2.m2.1.1.2.2.cmml" xref="S4.SS5.p2.2.m2.1.1.2.2">𝑎</ci><ci id="S4.SS5.p2.2.m2.1.1.2.3.cmml" xref="S4.SS5.p2.2.m2.1.1.2.3">𝑡</ci><ci id="S4.SS5.p2.2.m2.1.1.2.4.cmml" xref="S4.SS5.p2.2.m2.1.1.2.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">\tilde{att}</annotation></semantics></math> is the sum of the children’s attention map; then, the masked image feature is fused with word embeddings and convolved to a <math id="S4.SS5.p2.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS5.p2.3.m3.1a"><mn id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.1b"><cn type="integer" id="S4.SS5.p2.3.m3.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.1c">1</annotation></semantics></math>-d attention map <math id="S4.SS5.p2.4.m4.1" class="ltx_Math" alttext="att" display="inline"><semantics id="S4.SS5.p2.4.m4.1a"><mrow id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml"><mi id="S4.SS5.p2.4.m4.1.1.2" xref="S4.SS5.p2.4.m4.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.4.m4.1.1.1" xref="S4.SS5.p2.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS5.p2.4.m4.1.1.3" xref="S4.SS5.p2.4.m4.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.4.m4.1.1.1a" xref="S4.SS5.p2.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS5.p2.4.m4.1.1.4" xref="S4.SS5.p2.4.m4.1.1.4.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><apply id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1"><times id="S4.SS5.p2.4.m4.1.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1.1"></times><ci id="S4.SS5.p2.4.m4.1.1.2.cmml" xref="S4.SS5.p2.4.m4.1.1.2">𝑎</ci><ci id="S4.SS5.p2.4.m4.1.1.3.cmml" xref="S4.SS5.p2.4.m4.1.1.3">𝑡</ci><ci id="S4.SS5.p2.4.m4.1.1.4.cmml" xref="S4.SS5.p2.4.m4.1.1.4">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">att</annotation></semantics></math>. Then, the attended local image feature <math id="S4.SS5.p2.5.m5.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S4.SS5.p2.5.m5.1a"><mi id="S4.SS5.p2.5.m5.1.1" xref="S4.SS5.p2.5.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.5.m5.1b"><ci id="S4.SS5.p2.5.m5.1.1.cmml" xref="S4.SS5.p2.5.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.5.m5.1c">v</annotation></semantics></math> is composed with the sum of the children’s hidden representation <math id="S4.SS5.p2.6.m6.1" class="ltx_Math" alttext="\tilde{h}" display="inline"><semantics id="S4.SS5.p2.6.m6.1a"><mover accent="true" id="S4.SS5.p2.6.m6.1.1" xref="S4.SS5.p2.6.m6.1.1.cmml"><mi id="S4.SS5.p2.6.m6.1.1.2" xref="S4.SS5.p2.6.m6.1.1.2.cmml">h</mi><mo id="S4.SS5.p2.6.m6.1.1.1" xref="S4.SS5.p2.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.6.m6.1b"><apply id="S4.SS5.p2.6.m6.1.1.cmml" xref="S4.SS5.p2.6.m6.1.1"><ci id="S4.SS5.p2.6.m6.1.1.1.cmml" xref="S4.SS5.p2.6.m6.1.1.1">~</ci><ci id="S4.SS5.p2.6.m6.1.1.2.cmml" xref="S4.SS5.p2.6.m6.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.6.m6.1c">\tilde{h}</annotation></semantics></math>: it generates the residual by applying a fully connected layer on concatenated <math id="S4.SS5.p2.7.m7.2" class="ltx_Math" alttext="[v,\tilde{h}]" display="inline"><semantics id="S4.SS5.p2.7.m7.2a"><mrow id="S4.SS5.p2.7.m7.2.3.2" xref="S4.SS5.p2.7.m7.2.3.1.cmml"><mo stretchy="false" id="S4.SS5.p2.7.m7.2.3.2.1" xref="S4.SS5.p2.7.m7.2.3.1.cmml">[</mo><mi id="S4.SS5.p2.7.m7.1.1" xref="S4.SS5.p2.7.m7.1.1.cmml">v</mi><mo id="S4.SS5.p2.7.m7.2.3.2.2" xref="S4.SS5.p2.7.m7.2.3.1.cmml">,</mo><mover accent="true" id="S4.SS5.p2.7.m7.2.2" xref="S4.SS5.p2.7.m7.2.2.cmml"><mi id="S4.SS5.p2.7.m7.2.2.2" xref="S4.SS5.p2.7.m7.2.2.2.cmml">h</mi><mo id="S4.SS5.p2.7.m7.2.2.1" xref="S4.SS5.p2.7.m7.2.2.1.cmml">~</mo></mover><mo stretchy="false" id="S4.SS5.p2.7.m7.2.3.2.3" xref="S4.SS5.p2.7.m7.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.7.m7.2b"><interval closure="closed" id="S4.SS5.p2.7.m7.2.3.1.cmml" xref="S4.SS5.p2.7.m7.2.3.2"><ci id="S4.SS5.p2.7.m7.1.1.cmml" xref="S4.SS5.p2.7.m7.1.1">𝑣</ci><apply id="S4.SS5.p2.7.m7.2.2.cmml" xref="S4.SS5.p2.7.m7.2.2"><ci id="S4.SS5.p2.7.m7.2.2.1.cmml" xref="S4.SS5.p2.7.m7.2.2.1">~</ci><ci id="S4.SS5.p2.7.m7.2.2.2.cmml" xref="S4.SS5.p2.7.m7.2.2.2">ℎ</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.7.m7.2c">[v,\tilde{h}]</annotation></semantics></math>; then, the residual is added to <math id="S4.SS5.p2.8.m8.1" class="ltx_Math" alttext="\tilde{h}" display="inline"><semantics id="S4.SS5.p2.8.m8.1a"><mover accent="true" id="S4.SS5.p2.8.m8.1.1" xref="S4.SS5.p2.8.m8.1.1.cmml"><mi id="S4.SS5.p2.8.m8.1.1.2" xref="S4.SS5.p2.8.m8.1.1.2.cmml">h</mi><mo id="S4.SS5.p2.8.m8.1.1.1" xref="S4.SS5.p2.8.m8.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.8.m8.1b"><apply id="S4.SS5.p2.8.m8.1.1.cmml" xref="S4.SS5.p2.8.m8.1.1"><ci id="S4.SS5.p2.8.m8.1.1.1.cmml" xref="S4.SS5.p2.8.m8.1.1.1">~</ci><ci id="S4.SS5.p2.8.m8.1.1.2.cmml" xref="S4.SS5.p2.8.m8.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.8.m8.1c">\tilde{h}</annotation></semantics></math> and fused with the question encoding, and the current hidden <math id="S4.SS5.p2.9.m9.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S4.SS5.p2.9.m9.1a"><mi id="S4.SS5.p2.9.m9.1.1" xref="S4.SS5.p2.9.m9.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.9.m9.1b"><ci id="S4.SS5.p2.9.m9.1.1.cmml" xref="S4.SS5.p2.9.m9.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.9.m9.1c">h</annotation></semantics></math> is obtained as the result. Finally, the attention map <math id="S4.SS5.p2.10.m10.1" class="ltx_Math" alttext="att" display="inline"><semantics id="S4.SS5.p2.10.m10.1a"><mrow id="S4.SS5.p2.10.m10.1.1" xref="S4.SS5.p2.10.m10.1.1.cmml"><mi id="S4.SS5.p2.10.m10.1.1.2" xref="S4.SS5.p2.10.m10.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.10.m10.1.1.1" xref="S4.SS5.p2.10.m10.1.1.1.cmml">​</mo><mi id="S4.SS5.p2.10.m10.1.1.3" xref="S4.SS5.p2.10.m10.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p2.10.m10.1.1.1a" xref="S4.SS5.p2.10.m10.1.1.1.cmml">​</mo><mi id="S4.SS5.p2.10.m10.1.1.4" xref="S4.SS5.p2.10.m10.1.1.4.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.10.m10.1b"><apply id="S4.SS5.p2.10.m10.1.1.cmml" xref="S4.SS5.p2.10.m10.1.1"><times id="S4.SS5.p2.10.m10.1.1.1.cmml" xref="S4.SS5.p2.10.m10.1.1.1"></times><ci id="S4.SS5.p2.10.m10.1.1.2.cmml" xref="S4.SS5.p2.10.m10.1.1.2">𝑎</ci><ci id="S4.SS5.p2.10.m10.1.1.3.cmml" xref="S4.SS5.p2.10.m10.1.1.3">𝑡</ci><ci id="S4.SS5.p2.10.m10.1.1.4.cmml" xref="S4.SS5.p2.10.m10.1.1.4">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.10.m10.1c">att</annotation></semantics></math> is propagated to its parent if the edge type belongs to a modifier relation, or hidden <math id="S4.SS5.p2.11.m11.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S4.SS5.p2.11.m11.1a"><mi id="S4.SS5.p2.11.m11.1.1" xref="S4.SS5.p2.11.m11.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.11.m11.1b"><ci id="S4.SS5.p2.11.m11.1.1.cmml" xref="S4.SS5.p2.11.m11.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.11.m11.1c">h</annotation></semantics></math> is propagated if the edge is a clausal predicate relation. Each node will share weights with other nodes at the same height.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p"><span id="S4.SS5.p3.1.1" class="ltx_text ltx_font_bold">Baseline model</span>  Compared with ACMN, the baseline model has the following changes: 1) each node now shares its weights with other nodes across different heights in the parsed tree and 2) the adversarial attention module is replaced by the proposed one described in section <a href="#S3.SS2" title="3.2 Attention module ‣ 3 Tree-Structured Composition Reasoning Network ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. To perform ablation studies on PTGRN, we replace each module in the baseline model with our proposed components and evaluate them incrementally.</p>
</div>
<div id="S4.SS5.p4" class="ltx_para">
<p id="S4.SS5.p4.2" class="ltx_p"><span id="S4.SS5.p4.2.1" class="ltx_text ltx_font_bold">Edge-dependent propagation</span>  “+Edge” performs extra edge-dependent feature transformations between children and parents. These changes increase the performance by <math id="S4.SS5.p4.1.m1.1" class="ltx_Math" alttext="0.27\%" display="inline"><semantics id="S4.SS5.p4.1.m1.1a"><mrow id="S4.SS5.p4.1.m1.1.1" xref="S4.SS5.p4.1.m1.1.1.cmml"><mn id="S4.SS5.p4.1.m1.1.1.2" xref="S4.SS5.p4.1.m1.1.1.2.cmml">0.27</mn><mo id="S4.SS5.p4.1.m1.1.1.1" xref="S4.SS5.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.1.m1.1b"><apply id="S4.SS5.p4.1.m1.1.1.cmml" xref="S4.SS5.p4.1.m1.1.1"><csymbol cd="latexml" id="S4.SS5.p4.1.m1.1.1.1.cmml" xref="S4.SS5.p4.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p4.1.m1.1.1.2.cmml" xref="S4.SS5.p4.1.m1.1.1.2">0.27</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.1.m1.1c">0.27\%</annotation></semantics></math> compared to that of ACMN and make the model easier to apply to different datasets without adjusting the maximum tree height. Moreover, it is more reasonable to reuse the same module to perform the same tasks, and the accuracy is increased by <math id="S4.SS5.p4.2.m2.1" class="ltx_Math" alttext="1.66\%" display="inline"><semantics id="S4.SS5.p4.2.m2.1a"><mrow id="S4.SS5.p4.2.m2.1.1" xref="S4.SS5.p4.2.m2.1.1.cmml"><mn id="S4.SS5.p4.2.m2.1.1.2" xref="S4.SS5.p4.2.m2.1.1.2.cmml">1.66</mn><mo id="S4.SS5.p4.2.m2.1.1.1" xref="S4.SS5.p4.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.2.m2.1b"><apply id="S4.SS5.p4.2.m2.1.1.cmml" xref="S4.SS5.p4.2.m2.1.1"><csymbol cd="latexml" id="S4.SS5.p4.2.m2.1.1.1.cmml" xref="S4.SS5.p4.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p4.2.m2.1.1.2.cmml" xref="S4.SS5.p4.2.m2.1.1.2">1.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.2.m2.1c">1.66\%</annotation></semantics></math> over the baseline model.</p>
</div>
<div id="S4.SS5.p5" class="ltx_para">
<p id="S4.SS5.p5.6" class="ltx_p"><span id="S4.SS5.p5.6.1" class="ltx_text ltx_font_bold">Gated residual</span>  We investigate the effect of the gated residual module by comparing the accuracy with that of the “+Edge” model.
The “+Edge” model constructs the mined visual evidence <math id="S4.SS5.p5.1.m1.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S4.SS5.p5.1.m1.1a"><msub id="S4.SS5.p5.1.m1.1.1" xref="S4.SS5.p5.1.m1.1.1.cmml"><mi id="S4.SS5.p5.1.m1.1.1.2" xref="S4.SS5.p5.1.m1.1.1.2.cmml">v</mi><mi id="S4.SS5.p5.1.m1.1.1.3" xref="S4.SS5.p5.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.1.m1.1b"><apply id="S4.SS5.p5.1.m1.1.1.cmml" xref="S4.SS5.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p5.1.m1.1.1.1.cmml" xref="S4.SS5.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.p5.1.m1.1.1.2.cmml" xref="S4.SS5.p5.1.m1.1.1.2">𝑣</ci><ci id="S4.SS5.p5.1.m1.1.1.3.cmml" xref="S4.SS5.p5.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.1.m1.1c">v_{j}</annotation></semantics></math> and its children nodes’ message <math id="S4.SS5.p5.2.m2.1" class="ltx_Math" alttext="\tilde{h}" display="inline"><semantics id="S4.SS5.p5.2.m2.1a"><mover accent="true" id="S4.SS5.p5.2.m2.1.1" xref="S4.SS5.p5.2.m2.1.1.cmml"><mi id="S4.SS5.p5.2.m2.1.1.2" xref="S4.SS5.p5.2.m2.1.1.2.cmml">h</mi><mo id="S4.SS5.p5.2.m2.1.1.1" xref="S4.SS5.p5.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.2.m2.1b"><apply id="S4.SS5.p5.2.m2.1.1.cmml" xref="S4.SS5.p5.2.m2.1.1"><ci id="S4.SS5.p5.2.m2.1.1.1.cmml" xref="S4.SS5.p5.2.m2.1.1.1">~</ci><ci id="S4.SS5.p5.2.m2.1.1.2.cmml" xref="S4.SS5.p5.2.m2.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.2.m2.1c">\tilde{h}</annotation></semantics></math> by concatenating them and performing a linear transform with a fully connected layer, while the “+Edge+GRU” model replaces it with a GRU, where <math id="S4.SS5.p5.3.m3.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S4.SS5.p5.3.m3.1a"><msub id="S4.SS5.p5.3.m3.1.1" xref="S4.SS5.p5.3.m3.1.1.cmml"><mi id="S4.SS5.p5.3.m3.1.1.2" xref="S4.SS5.p5.3.m3.1.1.2.cmml">v</mi><mi id="S4.SS5.p5.3.m3.1.1.3" xref="S4.SS5.p5.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.3.m3.1b"><apply id="S4.SS5.p5.3.m3.1.1.cmml" xref="S4.SS5.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p5.3.m3.1.1.1.cmml" xref="S4.SS5.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.p5.3.m3.1.1.2.cmml" xref="S4.SS5.p5.3.m3.1.1.2">𝑣</ci><ci id="S4.SS5.p5.3.m3.1.1.3.cmml" xref="S4.SS5.p5.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.3.m3.1c">v_{j}</annotation></semantics></math> corresponds to the current input, and the message is the memory. Adding a GRU improves the accuracy by <math id="S4.SS5.p5.4.m4.1" class="ltx_Math" alttext="1.16\%" display="inline"><semantics id="S4.SS5.p5.4.m4.1a"><mrow id="S4.SS5.p5.4.m4.1.1" xref="S4.SS5.p5.4.m4.1.1.cmml"><mn id="S4.SS5.p5.4.m4.1.1.2" xref="S4.SS5.p5.4.m4.1.1.2.cmml">1.16</mn><mo id="S4.SS5.p5.4.m4.1.1.1" xref="S4.SS5.p5.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.4.m4.1b"><apply id="S4.SS5.p5.4.m4.1.1.cmml" xref="S4.SS5.p5.4.m4.1.1"><csymbol cd="latexml" id="S4.SS5.p5.4.m4.1.1.1.cmml" xref="S4.SS5.p5.4.m4.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p5.4.m4.1.1.2.cmml" xref="S4.SS5.p5.4.m4.1.1.2">1.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.4.m4.1c">1.16\%</annotation></semantics></math>. This result suggests that the GRU module stabilized the recurrent process and improved the performance.
If the attention map is encoded into a hidden representation, then whether the incoming message is gated has little effect on performance. With the forgotten gate, the accuracy increases from <math id="S4.SS5.p5.5.m5.1" class="ltx_Math" alttext="93.36\%" display="inline"><semantics id="S4.SS5.p5.5.m5.1a"><mrow id="S4.SS5.p5.5.m5.1.1" xref="S4.SS5.p5.5.m5.1.1.cmml"><mn id="S4.SS5.p5.5.m5.1.1.2" xref="S4.SS5.p5.5.m5.1.1.2.cmml">93.36</mn><mo id="S4.SS5.p5.5.m5.1.1.1" xref="S4.SS5.p5.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.5.m5.1b"><apply id="S4.SS5.p5.5.m5.1.1.cmml" xref="S4.SS5.p5.5.m5.1.1"><csymbol cd="latexml" id="S4.SS5.p5.5.m5.1.1.1.cmml" xref="S4.SS5.p5.5.m5.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p5.5.m5.1.1.2.cmml" xref="S4.SS5.p5.5.m5.1.1.2">93.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.5.m5.1c">93.36\%</annotation></semantics></math> to <math id="S4.SS5.p5.6.m6.1" class="ltx_Math" alttext="93.53\%" display="inline"><semantics id="S4.SS5.p5.6.m6.1a"><mrow id="S4.SS5.p5.6.m6.1.1" xref="S4.SS5.p5.6.m6.1.1.cmml"><mn id="S4.SS5.p5.6.m6.1.1.2" xref="S4.SS5.p5.6.m6.1.1.2.cmml">93.53</mn><mo id="S4.SS5.p5.6.m6.1.1.1" xref="S4.SS5.p5.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.6.m6.1b"><apply id="S4.SS5.p5.6.m6.1.1.cmml" xref="S4.SS5.p5.6.m6.1.1"><csymbol cd="latexml" id="S4.SS5.p5.6.m6.1.1.1.cmml" xref="S4.SS5.p5.6.m6.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p5.6.m6.1.1.2.cmml" xref="S4.SS5.p5.6.m6.1.1.2">93.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.6.m6.1c">93.53\%</annotation></semantics></math>, as shown in “+Edge+ConcatAtt” and “+Edge+GRU+ConcatAtt”.</p>
</div>
<div id="S4.SS5.p6" class="ltx_para">
<p id="S4.SS5.p6.1" class="ltx_p"><span id="S4.SS5.p6.1.1" class="ltx_text ltx_font_bold">Attention map encoding</span>  There are multiple methods for encoding the attention map as a hidden representation. We evaluate several methods and report their answering accuracy in Table <a href="#S4.T5" title="TABLE V ‣ 4.5 Ablation studies ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
<div id="S4.SS5.p7" class="ltx_para">
<p id="S4.SS5.p7.14" class="ltx_p">The first method is to flatten the attention map, apply a linear layer, and concatenate the resulting vector to hidden and propagate it to the parent. In the case of the CLEVR dataset, the <math id="S4.SS5.p7.1.m1.1" class="ltx_Math" alttext="14*14" display="inline"><semantics id="S4.SS5.p7.1.m1.1a"><mrow id="S4.SS5.p7.1.m1.1.1" xref="S4.SS5.p7.1.m1.1.1.cmml"><mn id="S4.SS5.p7.1.m1.1.1.2" xref="S4.SS5.p7.1.m1.1.1.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS5.p7.1.m1.1.1.1" xref="S4.SS5.p7.1.m1.1.1.1.cmml">∗</mo><mn id="S4.SS5.p7.1.m1.1.1.3" xref="S4.SS5.p7.1.m1.1.1.3.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.1.m1.1b"><apply id="S4.SS5.p7.1.m1.1.1.cmml" xref="S4.SS5.p7.1.m1.1.1"><times id="S4.SS5.p7.1.m1.1.1.1.cmml" xref="S4.SS5.p7.1.m1.1.1.1"></times><cn type="integer" id="S4.SS5.p7.1.m1.1.1.2.cmml" xref="S4.SS5.p7.1.m1.1.1.2">14</cn><cn type="integer" id="S4.SS5.p7.1.m1.1.1.3.cmml" xref="S4.SS5.p7.1.m1.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.1.m1.1c">14*14</annotation></semantics></math> attention map <math id="S4.SS5.p7.2.m2.1" class="ltx_Math" alttext="att_{j}" display="inline"><semantics id="S4.SS5.p7.2.m2.1a"><mrow id="S4.SS5.p7.2.m2.1.1" xref="S4.SS5.p7.2.m2.1.1.cmml"><mi id="S4.SS5.p7.2.m2.1.1.2" xref="S4.SS5.p7.2.m2.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.2.m2.1.1.1" xref="S4.SS5.p7.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS5.p7.2.m2.1.1.3" xref="S4.SS5.p7.2.m2.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.2.m2.1.1.1a" xref="S4.SS5.p7.2.m2.1.1.1.cmml">​</mo><msub id="S4.SS5.p7.2.m2.1.1.4" xref="S4.SS5.p7.2.m2.1.1.4.cmml"><mi id="S4.SS5.p7.2.m2.1.1.4.2" xref="S4.SS5.p7.2.m2.1.1.4.2.cmml">t</mi><mi id="S4.SS5.p7.2.m2.1.1.4.3" xref="S4.SS5.p7.2.m2.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.2.m2.1b"><apply id="S4.SS5.p7.2.m2.1.1.cmml" xref="S4.SS5.p7.2.m2.1.1"><times id="S4.SS5.p7.2.m2.1.1.1.cmml" xref="S4.SS5.p7.2.m2.1.1.1"></times><ci id="S4.SS5.p7.2.m2.1.1.2.cmml" xref="S4.SS5.p7.2.m2.1.1.2">𝑎</ci><ci id="S4.SS5.p7.2.m2.1.1.3.cmml" xref="S4.SS5.p7.2.m2.1.1.3">𝑡</ci><apply id="S4.SS5.p7.2.m2.1.1.4.cmml" xref="S4.SS5.p7.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.SS5.p7.2.m2.1.1.4.1.cmml" xref="S4.SS5.p7.2.m2.1.1.4">subscript</csymbol><ci id="S4.SS5.p7.2.m2.1.1.4.2.cmml" xref="S4.SS5.p7.2.m2.1.1.4.2">𝑡</ci><ci id="S4.SS5.p7.2.m2.1.1.4.3.cmml" xref="S4.SS5.p7.2.m2.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.2.m2.1c">att_{j}</annotation></semantics></math> is flattened to a <math id="S4.SS5.p7.3.m3.1" class="ltx_Math" alttext="196" display="inline"><semantics id="S4.SS5.p7.3.m3.1a"><mn id="S4.SS5.p7.3.m3.1.1" xref="S4.SS5.p7.3.m3.1.1.cmml">196</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.3.m3.1b"><cn type="integer" id="S4.SS5.p7.3.m3.1.1.cmml" xref="S4.SS5.p7.3.m3.1.1">196</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.3.m3.1c">196</annotation></semantics></math>-d vector and projected to <math id="S4.SS5.p7.4.m4.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS5.p7.4.m4.1a"><mn id="S4.SS5.p7.4.m4.1.1" xref="S4.SS5.p7.4.m4.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.4.m4.1b"><cn type="integer" id="S4.SS5.p7.4.m4.1.1.cmml" xref="S4.SS5.p7.4.m4.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.4.m4.1c">128</annotation></semantics></math>-d feature <math id="S4.SS5.p7.5.m5.1" class="ltx_Math" alttext="h^{att}_{j}" display="inline"><semantics id="S4.SS5.p7.5.m5.1a"><msubsup id="S4.SS5.p7.5.m5.1.1" xref="S4.SS5.p7.5.m5.1.1.cmml"><mi id="S4.SS5.p7.5.m5.1.1.2.2" xref="S4.SS5.p7.5.m5.1.1.2.2.cmml">h</mi><mi id="S4.SS5.p7.5.m5.1.1.3" xref="S4.SS5.p7.5.m5.1.1.3.cmml">j</mi><mrow id="S4.SS5.p7.5.m5.1.1.2.3" xref="S4.SS5.p7.5.m5.1.1.2.3.cmml"><mi id="S4.SS5.p7.5.m5.1.1.2.3.2" xref="S4.SS5.p7.5.m5.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.5.m5.1.1.2.3.1" xref="S4.SS5.p7.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS5.p7.5.m5.1.1.2.3.3" xref="S4.SS5.p7.5.m5.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.5.m5.1.1.2.3.1a" xref="S4.SS5.p7.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS5.p7.5.m5.1.1.2.3.4" xref="S4.SS5.p7.5.m5.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.5.m5.1b"><apply id="S4.SS5.p7.5.m5.1.1.cmml" xref="S4.SS5.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS5.p7.5.m5.1.1.1.cmml" xref="S4.SS5.p7.5.m5.1.1">subscript</csymbol><apply id="S4.SS5.p7.5.m5.1.1.2.cmml" xref="S4.SS5.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS5.p7.5.m5.1.1.2.1.cmml" xref="S4.SS5.p7.5.m5.1.1">superscript</csymbol><ci id="S4.SS5.p7.5.m5.1.1.2.2.cmml" xref="S4.SS5.p7.5.m5.1.1.2.2">ℎ</ci><apply id="S4.SS5.p7.5.m5.1.1.2.3.cmml" xref="S4.SS5.p7.5.m5.1.1.2.3"><times id="S4.SS5.p7.5.m5.1.1.2.3.1.cmml" xref="S4.SS5.p7.5.m5.1.1.2.3.1"></times><ci id="S4.SS5.p7.5.m5.1.1.2.3.2.cmml" xref="S4.SS5.p7.5.m5.1.1.2.3.2">𝑎</ci><ci id="S4.SS5.p7.5.m5.1.1.2.3.3.cmml" xref="S4.SS5.p7.5.m5.1.1.2.3.3">𝑡</ci><ci id="S4.SS5.p7.5.m5.1.1.2.3.4.cmml" xref="S4.SS5.p7.5.m5.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S4.SS5.p7.5.m5.1.1.3.cmml" xref="S4.SS5.p7.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.5.m5.1c">h^{att}_{j}</annotation></semantics></math> with two fully connected layers. Then, it is concatenated with the mined visual evidence <math id="S4.SS5.p7.6.m6.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S4.SS5.p7.6.m6.1a"><msub id="S4.SS5.p7.6.m6.1.1" xref="S4.SS5.p7.6.m6.1.1.cmml"><mi id="S4.SS5.p7.6.m6.1.1.2" xref="S4.SS5.p7.6.m6.1.1.2.cmml">v</mi><mi id="S4.SS5.p7.6.m6.1.1.3" xref="S4.SS5.p7.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.6.m6.1b"><apply id="S4.SS5.p7.6.m6.1.1.cmml" xref="S4.SS5.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS5.p7.6.m6.1.1.1.cmml" xref="S4.SS5.p7.6.m6.1.1">subscript</csymbol><ci id="S4.SS5.p7.6.m6.1.1.2.cmml" xref="S4.SS5.p7.6.m6.1.1.2">𝑣</ci><ci id="S4.SS5.p7.6.m6.1.1.3.cmml" xref="S4.SS5.p7.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.6.m6.1c">v_{j}</annotation></semantics></math>. The accuracies are reported as “+Edge+ConcatAtt” and “+Edge+GRU+ConcatAtt”, where the first one composes the current hidden <math id="S4.SS5.p7.7.m7.2" class="ltx_Math" alttext="[v_{j},h^{att}_{j}]" display="inline"><semantics id="S4.SS5.p7.7.m7.2a"><mrow id="S4.SS5.p7.7.m7.2.2.2" xref="S4.SS5.p7.7.m7.2.2.3.cmml"><mo stretchy="false" id="S4.SS5.p7.7.m7.2.2.2.3" xref="S4.SS5.p7.7.m7.2.2.3.cmml">[</mo><msub id="S4.SS5.p7.7.m7.1.1.1.1" xref="S4.SS5.p7.7.m7.1.1.1.1.cmml"><mi id="S4.SS5.p7.7.m7.1.1.1.1.2" xref="S4.SS5.p7.7.m7.1.1.1.1.2.cmml">v</mi><mi id="S4.SS5.p7.7.m7.1.1.1.1.3" xref="S4.SS5.p7.7.m7.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS5.p7.7.m7.2.2.2.4" xref="S4.SS5.p7.7.m7.2.2.3.cmml">,</mo><msubsup id="S4.SS5.p7.7.m7.2.2.2.2" xref="S4.SS5.p7.7.m7.2.2.2.2.cmml"><mi id="S4.SS5.p7.7.m7.2.2.2.2.2.2" xref="S4.SS5.p7.7.m7.2.2.2.2.2.2.cmml">h</mi><mi id="S4.SS5.p7.7.m7.2.2.2.2.3" xref="S4.SS5.p7.7.m7.2.2.2.2.3.cmml">j</mi><mrow id="S4.SS5.p7.7.m7.2.2.2.2.2.3" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.cmml"><mi id="S4.SS5.p7.7.m7.2.2.2.2.2.3.2" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.7.m7.2.2.2.2.2.3.1" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS5.p7.7.m7.2.2.2.2.2.3.3" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.7.m7.2.2.2.2.2.3.1a" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS5.p7.7.m7.2.2.2.2.2.3.4" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.4.cmml">t</mi></mrow></msubsup><mo stretchy="false" id="S4.SS5.p7.7.m7.2.2.2.5" xref="S4.SS5.p7.7.m7.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.7.m7.2b"><interval closure="closed" id="S4.SS5.p7.7.m7.2.2.3.cmml" xref="S4.SS5.p7.7.m7.2.2.2"><apply id="S4.SS5.p7.7.m7.1.1.1.1.cmml" xref="S4.SS5.p7.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p7.7.m7.1.1.1.1.1.cmml" xref="S4.SS5.p7.7.m7.1.1.1.1">subscript</csymbol><ci id="S4.SS5.p7.7.m7.1.1.1.1.2.cmml" xref="S4.SS5.p7.7.m7.1.1.1.1.2">𝑣</ci><ci id="S4.SS5.p7.7.m7.1.1.1.1.3.cmml" xref="S4.SS5.p7.7.m7.1.1.1.1.3">𝑗</ci></apply><apply id="S4.SS5.p7.7.m7.2.2.2.2.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.p7.7.m7.2.2.2.2.1.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2">subscript</csymbol><apply id="S4.SS5.p7.7.m7.2.2.2.2.2.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.p7.7.m7.2.2.2.2.2.1.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2">superscript</csymbol><ci id="S4.SS5.p7.7.m7.2.2.2.2.2.2.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2.2.2">ℎ</ci><apply id="S4.SS5.p7.7.m7.2.2.2.2.2.3.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3"><times id="S4.SS5.p7.7.m7.2.2.2.2.2.3.1.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.1"></times><ci id="S4.SS5.p7.7.m7.2.2.2.2.2.3.2.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.2">𝑎</ci><ci id="S4.SS5.p7.7.m7.2.2.2.2.2.3.3.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.3">𝑡</ci><ci id="S4.SS5.p7.7.m7.2.2.2.2.2.3.4.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2.2.3.4">𝑡</ci></apply></apply><ci id="S4.SS5.p7.7.m7.2.2.2.2.3.cmml" xref="S4.SS5.p7.7.m7.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.7.m7.2c">[v_{j},h^{att}_{j}]</annotation></semantics></math> and input hidden <math id="S4.SS5.p7.8.m8.1" class="ltx_Math" alttext="\tilde{h}" display="inline"><semantics id="S4.SS5.p7.8.m8.1a"><mover accent="true" id="S4.SS5.p7.8.m8.1.1" xref="S4.SS5.p7.8.m8.1.1.cmml"><mi id="S4.SS5.p7.8.m8.1.1.2" xref="S4.SS5.p7.8.m8.1.1.2.cmml">h</mi><mo id="S4.SS5.p7.8.m8.1.1.1" xref="S4.SS5.p7.8.m8.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.8.m8.1b"><apply id="S4.SS5.p7.8.m8.1.1.cmml" xref="S4.SS5.p7.8.m8.1.1"><ci id="S4.SS5.p7.8.m8.1.1.1.cmml" xref="S4.SS5.p7.8.m8.1.1.1">~</ci><ci id="S4.SS5.p7.8.m8.1.1.2.cmml" xref="S4.SS5.p7.8.m8.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.8.m8.1c">\tilde{h}</annotation></semantics></math> by concatenating them, as in the preliminary work. In “+Edge+GRU+ConcatAtt”, we compose the <math id="S4.SS5.p7.9.m9.2" class="ltx_Math" alttext="[v_{j},h^{att}_{j}]" display="inline"><semantics id="S4.SS5.p7.9.m9.2a"><mrow id="S4.SS5.p7.9.m9.2.2.2" xref="S4.SS5.p7.9.m9.2.2.3.cmml"><mo stretchy="false" id="S4.SS5.p7.9.m9.2.2.2.3" xref="S4.SS5.p7.9.m9.2.2.3.cmml">[</mo><msub id="S4.SS5.p7.9.m9.1.1.1.1" xref="S4.SS5.p7.9.m9.1.1.1.1.cmml"><mi id="S4.SS5.p7.9.m9.1.1.1.1.2" xref="S4.SS5.p7.9.m9.1.1.1.1.2.cmml">v</mi><mi id="S4.SS5.p7.9.m9.1.1.1.1.3" xref="S4.SS5.p7.9.m9.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS5.p7.9.m9.2.2.2.4" xref="S4.SS5.p7.9.m9.2.2.3.cmml">,</mo><msubsup id="S4.SS5.p7.9.m9.2.2.2.2" xref="S4.SS5.p7.9.m9.2.2.2.2.cmml"><mi id="S4.SS5.p7.9.m9.2.2.2.2.2.2" xref="S4.SS5.p7.9.m9.2.2.2.2.2.2.cmml">h</mi><mi id="S4.SS5.p7.9.m9.2.2.2.2.3" xref="S4.SS5.p7.9.m9.2.2.2.2.3.cmml">j</mi><mrow id="S4.SS5.p7.9.m9.2.2.2.2.2.3" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.cmml"><mi id="S4.SS5.p7.9.m9.2.2.2.2.2.3.2" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.9.m9.2.2.2.2.2.3.1" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS5.p7.9.m9.2.2.2.2.2.3.3" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.9.m9.2.2.2.2.2.3.1a" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS5.p7.9.m9.2.2.2.2.2.3.4" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.4.cmml">t</mi></mrow></msubsup><mo stretchy="false" id="S4.SS5.p7.9.m9.2.2.2.5" xref="S4.SS5.p7.9.m9.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.9.m9.2b"><interval closure="closed" id="S4.SS5.p7.9.m9.2.2.3.cmml" xref="S4.SS5.p7.9.m9.2.2.2"><apply id="S4.SS5.p7.9.m9.1.1.1.1.cmml" xref="S4.SS5.p7.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p7.9.m9.1.1.1.1.1.cmml" xref="S4.SS5.p7.9.m9.1.1.1.1">subscript</csymbol><ci id="S4.SS5.p7.9.m9.1.1.1.1.2.cmml" xref="S4.SS5.p7.9.m9.1.1.1.1.2">𝑣</ci><ci id="S4.SS5.p7.9.m9.1.1.1.1.3.cmml" xref="S4.SS5.p7.9.m9.1.1.1.1.3">𝑗</ci></apply><apply id="S4.SS5.p7.9.m9.2.2.2.2.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.p7.9.m9.2.2.2.2.1.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2">subscript</csymbol><apply id="S4.SS5.p7.9.m9.2.2.2.2.2.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.p7.9.m9.2.2.2.2.2.1.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2">superscript</csymbol><ci id="S4.SS5.p7.9.m9.2.2.2.2.2.2.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2.2.2">ℎ</ci><apply id="S4.SS5.p7.9.m9.2.2.2.2.2.3.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3"><times id="S4.SS5.p7.9.m9.2.2.2.2.2.3.1.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.1"></times><ci id="S4.SS5.p7.9.m9.2.2.2.2.2.3.2.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.2">𝑎</ci><ci id="S4.SS5.p7.9.m9.2.2.2.2.2.3.3.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.3">𝑡</ci><ci id="S4.SS5.p7.9.m9.2.2.2.2.2.3.4.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2.2.3.4">𝑡</ci></apply></apply><ci id="S4.SS5.p7.9.m9.2.2.2.2.3.cmml" xref="S4.SS5.p7.9.m9.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.9.m9.2c">[v_{j},h^{att}_{j}]</annotation></semantics></math> and <math id="S4.SS5.p7.10.m10.1" class="ltx_Math" alttext="\tilde{h}" display="inline"><semantics id="S4.SS5.p7.10.m10.1a"><mover accent="true" id="S4.SS5.p7.10.m10.1.1" xref="S4.SS5.p7.10.m10.1.1.cmml"><mi id="S4.SS5.p7.10.m10.1.1.2" xref="S4.SS5.p7.10.m10.1.1.2.cmml">h</mi><mo id="S4.SS5.p7.10.m10.1.1.1" xref="S4.SS5.p7.10.m10.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.10.m10.1b"><apply id="S4.SS5.p7.10.m10.1.1.cmml" xref="S4.SS5.p7.10.m10.1.1"><ci id="S4.SS5.p7.10.m10.1.1.1.cmml" xref="S4.SS5.p7.10.m10.1.1.1">~</ci><ci id="S4.SS5.p7.10.m10.1.1.2.cmml" xref="S4.SS5.p7.10.m10.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.10.m10.1c">\tilde{h}</annotation></semantics></math> with a GRU-unit, as described in section <a href="#S3.SS3" title="3.3 Gated residual composition module ‣ 3 Tree-Structured Composition Reasoning Network ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. Both methods pass the original attention map <math id="S4.SS5.p7.11.m11.1" class="ltx_Math" alttext="att_{j}" display="inline"><semantics id="S4.SS5.p7.11.m11.1a"><mrow id="S4.SS5.p7.11.m11.1.1" xref="S4.SS5.p7.11.m11.1.1.cmml"><mi id="S4.SS5.p7.11.m11.1.1.2" xref="S4.SS5.p7.11.m11.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.11.m11.1.1.1" xref="S4.SS5.p7.11.m11.1.1.1.cmml">​</mo><mi id="S4.SS5.p7.11.m11.1.1.3" xref="S4.SS5.p7.11.m11.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p7.11.m11.1.1.1a" xref="S4.SS5.p7.11.m11.1.1.1.cmml">​</mo><msub id="S4.SS5.p7.11.m11.1.1.4" xref="S4.SS5.p7.11.m11.1.1.4.cmml"><mi id="S4.SS5.p7.11.m11.1.1.4.2" xref="S4.SS5.p7.11.m11.1.1.4.2.cmml">t</mi><mi id="S4.SS5.p7.11.m11.1.1.4.3" xref="S4.SS5.p7.11.m11.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.11.m11.1b"><apply id="S4.SS5.p7.11.m11.1.1.cmml" xref="S4.SS5.p7.11.m11.1.1"><times id="S4.SS5.p7.11.m11.1.1.1.cmml" xref="S4.SS5.p7.11.m11.1.1.1"></times><ci id="S4.SS5.p7.11.m11.1.1.2.cmml" xref="S4.SS5.p7.11.m11.1.1.2">𝑎</ci><ci id="S4.SS5.p7.11.m11.1.1.3.cmml" xref="S4.SS5.p7.11.m11.1.1.3">𝑡</ci><apply id="S4.SS5.p7.11.m11.1.1.4.cmml" xref="S4.SS5.p7.11.m11.1.1.4"><csymbol cd="ambiguous" id="S4.SS5.p7.11.m11.1.1.4.1.cmml" xref="S4.SS5.p7.11.m11.1.1.4">subscript</csymbol><ci id="S4.SS5.p7.11.m11.1.1.4.2.cmml" xref="S4.SS5.p7.11.m11.1.1.4.2">𝑡</ci><ci id="S4.SS5.p7.11.m11.1.1.4.3.cmml" xref="S4.SS5.p7.11.m11.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.11.m11.1c">att_{j}</annotation></semantics></math> to its parent. “+Edge+ConcatAtt” achieves <math id="S4.SS5.p7.12.m12.1" class="ltx_Math" alttext="93.36\%" display="inline"><semantics id="S4.SS5.p7.12.m12.1a"><mrow id="S4.SS5.p7.12.m12.1.1" xref="S4.SS5.p7.12.m12.1.1.cmml"><mn id="S4.SS5.p7.12.m12.1.1.2" xref="S4.SS5.p7.12.m12.1.1.2.cmml">93.36</mn><mo id="S4.SS5.p7.12.m12.1.1.1" xref="S4.SS5.p7.12.m12.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.12.m12.1b"><apply id="S4.SS5.p7.12.m12.1.1.cmml" xref="S4.SS5.p7.12.m12.1.1"><csymbol cd="latexml" id="S4.SS5.p7.12.m12.1.1.1.cmml" xref="S4.SS5.p7.12.m12.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p7.12.m12.1.1.2.cmml" xref="S4.SS5.p7.12.m12.1.1.2">93.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.12.m12.1c">93.36\%</annotation></semantics></math> overall accuracy. “+Edge+GRU+ConcatAtt” achieves <math id="S4.SS5.p7.13.m13.1" class="ltx_Math" alttext="93.53\%" display="inline"><semantics id="S4.SS5.p7.13.m13.1a"><mrow id="S4.SS5.p7.13.m13.1.1" xref="S4.SS5.p7.13.m13.1.1.cmml"><mn id="S4.SS5.p7.13.m13.1.1.2" xref="S4.SS5.p7.13.m13.1.1.2.cmml">93.53</mn><mo id="S4.SS5.p7.13.m13.1.1.1" xref="S4.SS5.p7.13.m13.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.13.m13.1b"><apply id="S4.SS5.p7.13.m13.1.1.cmml" xref="S4.SS5.p7.13.m13.1.1"><csymbol cd="latexml" id="S4.SS5.p7.13.m13.1.1.1.cmml" xref="S4.SS5.p7.13.m13.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p7.13.m13.1.1.2.cmml" xref="S4.SS5.p7.13.m13.1.1.2">93.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.13.m13.1c">93.53\%</annotation></semantics></math>, which is slightly higher than the <math id="S4.SS5.p7.14.m14.1" class="ltx_Math" alttext="93.36\%" display="inline"><semantics id="S4.SS5.p7.14.m14.1a"><mrow id="S4.SS5.p7.14.m14.1.1" xref="S4.SS5.p7.14.m14.1.1.cmml"><mn id="S4.SS5.p7.14.m14.1.1.2" xref="S4.SS5.p7.14.m14.1.1.2.cmml">93.36</mn><mo id="S4.SS5.p7.14.m14.1.1.1" xref="S4.SS5.p7.14.m14.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.14.m14.1b"><apply id="S4.SS5.p7.14.m14.1.1.cmml" xref="S4.SS5.p7.14.m14.1.1"><csymbol cd="latexml" id="S4.SS5.p7.14.m14.1.1.1.cmml" xref="S4.SS5.p7.14.m14.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p7.14.m14.1.1.2.cmml" xref="S4.SS5.p7.14.m14.1.1.2">93.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.14.m14.1c">93.36\%</annotation></semantics></math> obtained by the model without GRU. From the accuracy per question type, we observe that “+Edge+ConcatAtt” performs slightly better on “compare integer” questions. These results indicate that updating the encoded attention map and the hidden representation together will harm the counting ability of our model.</p>
</div>
<div id="S4.SS5.p8" class="ltx_para">
<p id="S4.SS5.p8.10" class="ltx_p">The second method investigates the influence of the separated modules for the attention map. We perform the experiment denoted as “+Edge+GRU+GRUAtt”. This method also first flattens the attention map to a <math id="S4.SS5.p8.1.m1.1" class="ltx_Math" alttext="196" display="inline"><semantics id="S4.SS5.p8.1.m1.1a"><mn id="S4.SS5.p8.1.m1.1.1" xref="S4.SS5.p8.1.m1.1.1.cmml">196</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.1.m1.1b"><cn type="integer" id="S4.SS5.p8.1.m1.1.1.cmml" xref="S4.SS5.p8.1.m1.1.1">196</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.1.m1.1c">196</annotation></semantics></math>-d vector. Then, this vector is used to update the input attention feature <math id="S4.SS5.p8.2.m2.1" class="ltx_Math" alttext="\tilde{att}_{j}" display="inline"><semantics id="S4.SS5.p8.2.m2.1a"><msub id="S4.SS5.p8.2.m2.1.1" xref="S4.SS5.p8.2.m2.1.1.cmml"><mover accent="true" id="S4.SS5.p8.2.m2.1.1.2" xref="S4.SS5.p8.2.m2.1.1.2.cmml"><mrow id="S4.SS5.p8.2.m2.1.1.2.2" xref="S4.SS5.p8.2.m2.1.1.2.2.cmml"><mi id="S4.SS5.p8.2.m2.1.1.2.2.2" xref="S4.SS5.p8.2.m2.1.1.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.2.m2.1.1.2.2.1" xref="S4.SS5.p8.2.m2.1.1.2.2.1.cmml">​</mo><mi id="S4.SS5.p8.2.m2.1.1.2.2.3" xref="S4.SS5.p8.2.m2.1.1.2.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.2.m2.1.1.2.2.1a" xref="S4.SS5.p8.2.m2.1.1.2.2.1.cmml">​</mo><mi id="S4.SS5.p8.2.m2.1.1.2.2.4" xref="S4.SS5.p8.2.m2.1.1.2.2.4.cmml">t</mi></mrow><mo id="S4.SS5.p8.2.m2.1.1.2.1" xref="S4.SS5.p8.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS5.p8.2.m2.1.1.3" xref="S4.SS5.p8.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.2.m2.1b"><apply id="S4.SS5.p8.2.m2.1.1.cmml" xref="S4.SS5.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.2.m2.1.1.1.cmml" xref="S4.SS5.p8.2.m2.1.1">subscript</csymbol><apply id="S4.SS5.p8.2.m2.1.1.2.cmml" xref="S4.SS5.p8.2.m2.1.1.2"><ci id="S4.SS5.p8.2.m2.1.1.2.1.cmml" xref="S4.SS5.p8.2.m2.1.1.2.1">~</ci><apply id="S4.SS5.p8.2.m2.1.1.2.2.cmml" xref="S4.SS5.p8.2.m2.1.1.2.2"><times id="S4.SS5.p8.2.m2.1.1.2.2.1.cmml" xref="S4.SS5.p8.2.m2.1.1.2.2.1"></times><ci id="S4.SS5.p8.2.m2.1.1.2.2.2.cmml" xref="S4.SS5.p8.2.m2.1.1.2.2.2">𝑎</ci><ci id="S4.SS5.p8.2.m2.1.1.2.2.3.cmml" xref="S4.SS5.p8.2.m2.1.1.2.2.3">𝑡</ci><ci id="S4.SS5.p8.2.m2.1.1.2.2.4.cmml" xref="S4.SS5.p8.2.m2.1.1.2.2.4">𝑡</ci></apply></apply><ci id="S4.SS5.p8.2.m2.1.1.3.cmml" xref="S4.SS5.p8.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.2.m2.1c">\tilde{att}_{j}</annotation></semantics></math> with another GRU rather than concatenating it with mined visual evidence <math id="S4.SS5.p8.3.m3.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S4.SS5.p8.3.m3.1a"><msub id="S4.SS5.p8.3.m3.1.1" xref="S4.SS5.p8.3.m3.1.1.cmml"><mi id="S4.SS5.p8.3.m3.1.1.2" xref="S4.SS5.p8.3.m3.1.1.2.cmml">v</mi><mi id="S4.SS5.p8.3.m3.1.1.3" xref="S4.SS5.p8.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.3.m3.1b"><apply id="S4.SS5.p8.3.m3.1.1.cmml" xref="S4.SS5.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.3.m3.1.1.1.cmml" xref="S4.SS5.p8.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.p8.3.m3.1.1.2.cmml" xref="S4.SS5.p8.3.m3.1.1.2">𝑣</ci><ci id="S4.SS5.p8.3.m3.1.1.3.cmml" xref="S4.SS5.p8.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.3.m3.1c">v_{j}</annotation></semantics></math>. The output hidden representation of the GRU <math id="S4.SS5.p8.4.m4.1" class="ltx_Math" alttext="h^{att}_{j}" display="inline"><semantics id="S4.SS5.p8.4.m4.1a"><msubsup id="S4.SS5.p8.4.m4.1.1" xref="S4.SS5.p8.4.m4.1.1.cmml"><mi id="S4.SS5.p8.4.m4.1.1.2.2" xref="S4.SS5.p8.4.m4.1.1.2.2.cmml">h</mi><mi id="S4.SS5.p8.4.m4.1.1.3" xref="S4.SS5.p8.4.m4.1.1.3.cmml">j</mi><mrow id="S4.SS5.p8.4.m4.1.1.2.3" xref="S4.SS5.p8.4.m4.1.1.2.3.cmml"><mi id="S4.SS5.p8.4.m4.1.1.2.3.2" xref="S4.SS5.p8.4.m4.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.4.m4.1.1.2.3.1" xref="S4.SS5.p8.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S4.SS5.p8.4.m4.1.1.2.3.3" xref="S4.SS5.p8.4.m4.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.4.m4.1.1.2.3.1a" xref="S4.SS5.p8.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S4.SS5.p8.4.m4.1.1.2.3.4" xref="S4.SS5.p8.4.m4.1.1.2.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.4.m4.1b"><apply id="S4.SS5.p8.4.m4.1.1.cmml" xref="S4.SS5.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.4.m4.1.1.1.cmml" xref="S4.SS5.p8.4.m4.1.1">subscript</csymbol><apply id="S4.SS5.p8.4.m4.1.1.2.cmml" xref="S4.SS5.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.4.m4.1.1.2.1.cmml" xref="S4.SS5.p8.4.m4.1.1">superscript</csymbol><ci id="S4.SS5.p8.4.m4.1.1.2.2.cmml" xref="S4.SS5.p8.4.m4.1.1.2.2">ℎ</ci><apply id="S4.SS5.p8.4.m4.1.1.2.3.cmml" xref="S4.SS5.p8.4.m4.1.1.2.3"><times id="S4.SS5.p8.4.m4.1.1.2.3.1.cmml" xref="S4.SS5.p8.4.m4.1.1.2.3.1"></times><ci id="S4.SS5.p8.4.m4.1.1.2.3.2.cmml" xref="S4.SS5.p8.4.m4.1.1.2.3.2">𝑎</ci><ci id="S4.SS5.p8.4.m4.1.1.2.3.3.cmml" xref="S4.SS5.p8.4.m4.1.1.2.3.3">𝑡</ci><ci id="S4.SS5.p8.4.m4.1.1.2.3.4.cmml" xref="S4.SS5.p8.4.m4.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S4.SS5.p8.4.m4.1.1.3.cmml" xref="S4.SS5.p8.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.4.m4.1c">h^{att}_{j}</annotation></semantics></math> will be propagated to its parent node <math id="S4.SS5.p8.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS5.p8.5.m5.1a"><mi id="S4.SS5.p8.5.m5.1.1" xref="S4.SS5.p8.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.5.m5.1b"><ci id="S4.SS5.p8.5.m5.1.1.cmml" xref="S4.SS5.p8.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.5.m5.1c">k</annotation></semantics></math> based on the edge <math id="S4.SS5.p8.6.m6.1" class="ltx_Math" alttext="e_{jk}" display="inline"><semantics id="S4.SS5.p8.6.m6.1a"><msub id="S4.SS5.p8.6.m6.1.1" xref="S4.SS5.p8.6.m6.1.1.cmml"><mi id="S4.SS5.p8.6.m6.1.1.2" xref="S4.SS5.p8.6.m6.1.1.2.cmml">e</mi><mrow id="S4.SS5.p8.6.m6.1.1.3" xref="S4.SS5.p8.6.m6.1.1.3.cmml"><mi id="S4.SS5.p8.6.m6.1.1.3.2" xref="S4.SS5.p8.6.m6.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.6.m6.1.1.3.1" xref="S4.SS5.p8.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p8.6.m6.1.1.3.3" xref="S4.SS5.p8.6.m6.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.6.m6.1b"><apply id="S4.SS5.p8.6.m6.1.1.cmml" xref="S4.SS5.p8.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.6.m6.1.1.1.cmml" xref="S4.SS5.p8.6.m6.1.1">subscript</csymbol><ci id="S4.SS5.p8.6.m6.1.1.2.cmml" xref="S4.SS5.p8.6.m6.1.1.2">𝑒</ci><apply id="S4.SS5.p8.6.m6.1.1.3.cmml" xref="S4.SS5.p8.6.m6.1.1.3"><times id="S4.SS5.p8.6.m6.1.1.3.1.cmml" xref="S4.SS5.p8.6.m6.1.1.3.1"></times><ci id="S4.SS5.p8.6.m6.1.1.3.2.cmml" xref="S4.SS5.p8.6.m6.1.1.3.2">𝑗</ci><ci id="S4.SS5.p8.6.m6.1.1.3.3.cmml" xref="S4.SS5.p8.6.m6.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.6.m6.1c">e_{jk}</annotation></semantics></math>. Finally, the encoded attention map to the root node <math id="S4.SS5.p8.7.m7.1" class="ltx_Math" alttext="m^{a}_{root}" display="inline"><semantics id="S4.SS5.p8.7.m7.1a"><msubsup id="S4.SS5.p8.7.m7.1.1" xref="S4.SS5.p8.7.m7.1.1.cmml"><mi id="S4.SS5.p8.7.m7.1.1.2.2" xref="S4.SS5.p8.7.m7.1.1.2.2.cmml">m</mi><mrow id="S4.SS5.p8.7.m7.1.1.3" xref="S4.SS5.p8.7.m7.1.1.3.cmml"><mi id="S4.SS5.p8.7.m7.1.1.3.2" xref="S4.SS5.p8.7.m7.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.7.m7.1.1.3.1" xref="S4.SS5.p8.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p8.7.m7.1.1.3.3" xref="S4.SS5.p8.7.m7.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.7.m7.1.1.3.1a" xref="S4.SS5.p8.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p8.7.m7.1.1.3.4" xref="S4.SS5.p8.7.m7.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.7.m7.1.1.3.1b" xref="S4.SS5.p8.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p8.7.m7.1.1.3.5" xref="S4.SS5.p8.7.m7.1.1.3.5.cmml">t</mi></mrow><mi id="S4.SS5.p8.7.m7.1.1.2.3" xref="S4.SS5.p8.7.m7.1.1.2.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.7.m7.1b"><apply id="S4.SS5.p8.7.m7.1.1.cmml" xref="S4.SS5.p8.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.7.m7.1.1.1.cmml" xref="S4.SS5.p8.7.m7.1.1">subscript</csymbol><apply id="S4.SS5.p8.7.m7.1.1.2.cmml" xref="S4.SS5.p8.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.7.m7.1.1.2.1.cmml" xref="S4.SS5.p8.7.m7.1.1">superscript</csymbol><ci id="S4.SS5.p8.7.m7.1.1.2.2.cmml" xref="S4.SS5.p8.7.m7.1.1.2.2">𝑚</ci><ci id="S4.SS5.p8.7.m7.1.1.2.3.cmml" xref="S4.SS5.p8.7.m7.1.1.2.3">𝑎</ci></apply><apply id="S4.SS5.p8.7.m7.1.1.3.cmml" xref="S4.SS5.p8.7.m7.1.1.3"><times id="S4.SS5.p8.7.m7.1.1.3.1.cmml" xref="S4.SS5.p8.7.m7.1.1.3.1"></times><ci id="S4.SS5.p8.7.m7.1.1.3.2.cmml" xref="S4.SS5.p8.7.m7.1.1.3.2">𝑟</ci><ci id="S4.SS5.p8.7.m7.1.1.3.3.cmml" xref="S4.SS5.p8.7.m7.1.1.3.3">𝑜</ci><ci id="S4.SS5.p8.7.m7.1.1.3.4.cmml" xref="S4.SS5.p8.7.m7.1.1.3.4">𝑜</ci><ci id="S4.SS5.p8.7.m7.1.1.3.5.cmml" xref="S4.SS5.p8.7.m7.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.7.m7.1c">m^{a}_{root}</annotation></semantics></math> will be concatenated with the hidden <math id="S4.SS5.p8.8.m8.1" class="ltx_Math" alttext="m^{h}_{root}" display="inline"><semantics id="S4.SS5.p8.8.m8.1a"><msubsup id="S4.SS5.p8.8.m8.1.1" xref="S4.SS5.p8.8.m8.1.1.cmml"><mi id="S4.SS5.p8.8.m8.1.1.2.2" xref="S4.SS5.p8.8.m8.1.1.2.2.cmml">m</mi><mrow id="S4.SS5.p8.8.m8.1.1.3" xref="S4.SS5.p8.8.m8.1.1.3.cmml"><mi id="S4.SS5.p8.8.m8.1.1.3.2" xref="S4.SS5.p8.8.m8.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.8.m8.1.1.3.1" xref="S4.SS5.p8.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p8.8.m8.1.1.3.3" xref="S4.SS5.p8.8.m8.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.8.m8.1.1.3.1a" xref="S4.SS5.p8.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p8.8.m8.1.1.3.4" xref="S4.SS5.p8.8.m8.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p8.8.m8.1.1.3.1b" xref="S4.SS5.p8.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p8.8.m8.1.1.3.5" xref="S4.SS5.p8.8.m8.1.1.3.5.cmml">t</mi></mrow><mi id="S4.SS5.p8.8.m8.1.1.2.3" xref="S4.SS5.p8.8.m8.1.1.2.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.8.m8.1b"><apply id="S4.SS5.p8.8.m8.1.1.cmml" xref="S4.SS5.p8.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.8.m8.1.1.1.cmml" xref="S4.SS5.p8.8.m8.1.1">subscript</csymbol><apply id="S4.SS5.p8.8.m8.1.1.2.cmml" xref="S4.SS5.p8.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS5.p8.8.m8.1.1.2.1.cmml" xref="S4.SS5.p8.8.m8.1.1">superscript</csymbol><ci id="S4.SS5.p8.8.m8.1.1.2.2.cmml" xref="S4.SS5.p8.8.m8.1.1.2.2">𝑚</ci><ci id="S4.SS5.p8.8.m8.1.1.2.3.cmml" xref="S4.SS5.p8.8.m8.1.1.2.3">ℎ</ci></apply><apply id="S4.SS5.p8.8.m8.1.1.3.cmml" xref="S4.SS5.p8.8.m8.1.1.3"><times id="S4.SS5.p8.8.m8.1.1.3.1.cmml" xref="S4.SS5.p8.8.m8.1.1.3.1"></times><ci id="S4.SS5.p8.8.m8.1.1.3.2.cmml" xref="S4.SS5.p8.8.m8.1.1.3.2">𝑟</ci><ci id="S4.SS5.p8.8.m8.1.1.3.3.cmml" xref="S4.SS5.p8.8.m8.1.1.3.3">𝑜</ci><ci id="S4.SS5.p8.8.m8.1.1.3.4.cmml" xref="S4.SS5.p8.8.m8.1.1.3.4">𝑜</ci><ci id="S4.SS5.p8.8.m8.1.1.3.5.cmml" xref="S4.SS5.p8.8.m8.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.8.m8.1c">m^{h}_{root}</annotation></semantics></math> and fed into the classifier to predict the answer. It achieves <math id="S4.SS5.p8.9.m9.1" class="ltx_Math" alttext="94.42\%" display="inline"><semantics id="S4.SS5.p8.9.m9.1a"><mrow id="S4.SS5.p8.9.m9.1.1" xref="S4.SS5.p8.9.m9.1.1.cmml"><mn id="S4.SS5.p8.9.m9.1.1.2" xref="S4.SS5.p8.9.m9.1.1.2.cmml">94.42</mn><mo id="S4.SS5.p8.9.m9.1.1.1" xref="S4.SS5.p8.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.9.m9.1b"><apply id="S4.SS5.p8.9.m9.1.1.cmml" xref="S4.SS5.p8.9.m9.1.1"><csymbol cd="latexml" id="S4.SS5.p8.9.m9.1.1.1.cmml" xref="S4.SS5.p8.9.m9.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p8.9.m9.1.1.2.cmml" xref="S4.SS5.p8.9.m9.1.1.2">94.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.9.m9.1c">94.42\%</annotation></semantics></math> overall accuracy on the validation set, which improves the accuracy of the ‘+Edge+GRU+ConcatAtt” baseline by <math id="S4.SS5.p8.10.m10.1" class="ltx_Math" alttext="0.89\%" display="inline"><semantics id="S4.SS5.p8.10.m10.1a"><mrow id="S4.SS5.p8.10.m10.1.1" xref="S4.SS5.p8.10.m10.1.1.cmml"><mn id="S4.SS5.p8.10.m10.1.1.2" xref="S4.SS5.p8.10.m10.1.1.2.cmml">0.89</mn><mo id="S4.SS5.p8.10.m10.1.1.1" xref="S4.SS5.p8.10.m10.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.10.m10.1b"><apply id="S4.SS5.p8.10.m10.1.1.cmml" xref="S4.SS5.p8.10.m10.1.1"><csymbol cd="latexml" id="S4.SS5.p8.10.m10.1.1.1.cmml" xref="S4.SS5.p8.10.m10.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p8.10.m10.1.1.2.cmml" xref="S4.SS5.p8.10.m10.1.1.2">0.89</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.10.m10.1c">0.89\%</annotation></semantics></math>, illustrating that it is necessary to process the attention map and the hidden representation with different weights. This result is also consistent with our preliminary model, which processes the attention map and the hidden representation differently based on whether the edge is a modifier relation or a clausal predicate relation.</p>
</div>
<div id="S4.SS5.p9" class="ltx_para">
<p id="S4.SS5.p9.2" class="ltx_p">The last approach is our full model, which is reported as “+Edge+GRU+ConvGRUAtt”. Compared with the second one, this approach utilizes the convolution GRU to preserve spatial information and propagate feature maps across the tree. We perform global max pooling on the feature map <math id="S4.SS5.p9.1.m1.1" class="ltx_Math" alttext="m^{a}_{root}" display="inline"><semantics id="S4.SS5.p9.1.m1.1a"><msubsup id="S4.SS5.p9.1.m1.1.1" xref="S4.SS5.p9.1.m1.1.1.cmml"><mi id="S4.SS5.p9.1.m1.1.1.2.2" xref="S4.SS5.p9.1.m1.1.1.2.2.cmml">m</mi><mrow id="S4.SS5.p9.1.m1.1.1.3" xref="S4.SS5.p9.1.m1.1.1.3.cmml"><mi id="S4.SS5.p9.1.m1.1.1.3.2" xref="S4.SS5.p9.1.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p9.1.m1.1.1.3.1" xref="S4.SS5.p9.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p9.1.m1.1.1.3.3" xref="S4.SS5.p9.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p9.1.m1.1.1.3.1a" xref="S4.SS5.p9.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p9.1.m1.1.1.3.4" xref="S4.SS5.p9.1.m1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p9.1.m1.1.1.3.1b" xref="S4.SS5.p9.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p9.1.m1.1.1.3.5" xref="S4.SS5.p9.1.m1.1.1.3.5.cmml">t</mi></mrow><mi id="S4.SS5.p9.1.m1.1.1.2.3" xref="S4.SS5.p9.1.m1.1.1.2.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS5.p9.1.m1.1b"><apply id="S4.SS5.p9.1.m1.1.1.cmml" xref="S4.SS5.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p9.1.m1.1.1.1.cmml" xref="S4.SS5.p9.1.m1.1.1">subscript</csymbol><apply id="S4.SS5.p9.1.m1.1.1.2.cmml" xref="S4.SS5.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p9.1.m1.1.1.2.1.cmml" xref="S4.SS5.p9.1.m1.1.1">superscript</csymbol><ci id="S4.SS5.p9.1.m1.1.1.2.2.cmml" xref="S4.SS5.p9.1.m1.1.1.2.2">𝑚</ci><ci id="S4.SS5.p9.1.m1.1.1.2.3.cmml" xref="S4.SS5.p9.1.m1.1.1.2.3">𝑎</ci></apply><apply id="S4.SS5.p9.1.m1.1.1.3.cmml" xref="S4.SS5.p9.1.m1.1.1.3"><times id="S4.SS5.p9.1.m1.1.1.3.1.cmml" xref="S4.SS5.p9.1.m1.1.1.3.1"></times><ci id="S4.SS5.p9.1.m1.1.1.3.2.cmml" xref="S4.SS5.p9.1.m1.1.1.3.2">𝑟</ci><ci id="S4.SS5.p9.1.m1.1.1.3.3.cmml" xref="S4.SS5.p9.1.m1.1.1.3.3">𝑜</ci><ci id="S4.SS5.p9.1.m1.1.1.3.4.cmml" xref="S4.SS5.p9.1.m1.1.1.3.4">𝑜</ci><ci id="S4.SS5.p9.1.m1.1.1.3.5.cmml" xref="S4.SS5.p9.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p9.1.m1.1c">m^{a}_{root}</annotation></semantics></math> and concatenate it with the hidden representation to predict the final answer. It gains <math id="S4.SS5.p9.2.m2.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S4.SS5.p9.2.m2.1a"><mrow id="S4.SS5.p9.2.m2.1.1" xref="S4.SS5.p9.2.m2.1.1.cmml"><mn id="S4.SS5.p9.2.m2.1.1.2" xref="S4.SS5.p9.2.m2.1.1.2.cmml">1</mn><mo id="S4.SS5.p9.2.m2.1.1.1" xref="S4.SS5.p9.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p9.2.m2.1b"><apply id="S4.SS5.p9.2.m2.1.1.cmml" xref="S4.SS5.p9.2.m2.1.1"><csymbol cd="latexml" id="S4.SS5.p9.2.m2.1.1.1.cmml" xref="S4.SS5.p9.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS5.p9.2.m2.1.1.2.cmml" xref="S4.SS5.p9.2.m2.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p9.2.m2.1c">1\%</annotation></semantics></math> over the second approach on the validation set. It is shown that preserving spatial information will lead to better performance.</p>
</div>
<div id="S4.SS5.p10" class="ltx_para">
<p id="S4.SS5.p10.3" class="ltx_p"><span id="S4.SS5.p10.3.1" class="ltx_text ltx_font_bold">Bidirectional encoding for pruned words</span>  In our implementation, we pruned leaf nodes that are not nouns to reduce the computational burden. In this way, we can ignore determiner and preposition words such as “the” and “of”. However, this method also prunes some modifier words such as “big” and “metallic” in Figure <a href="#S4.F6" title="Figure 6 ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Since the modifiers are near the object words, we use bidirectional LSTM to extract the hidden representations that encode both the modifiers and the object words. We train two variants that use a lookup table and LSTM to extract word encodings. The results are reported in Table <a href="#S4.T6" title="TABLE VI ‣ 4.5 Ablation studies ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a> and denoted as “PTGRN (lookup)” and “PTGRN (LSTM)”, respectively. The lookup table encoding, which did not consider contexts, led to a significant accuracy drop from <math id="S4.SS5.p10.1.m1.1" class="ltx_Math" alttext="95.42\%" display="inline"><semantics id="S4.SS5.p10.1.m1.1a"><mrow id="S4.SS5.p10.1.m1.1.1" xref="S4.SS5.p10.1.m1.1.1.cmml"><mn id="S4.SS5.p10.1.m1.1.1.2" xref="S4.SS5.p10.1.m1.1.1.2.cmml">95.42</mn><mo id="S4.SS5.p10.1.m1.1.1.1" xref="S4.SS5.p10.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p10.1.m1.1b"><apply id="S4.SS5.p10.1.m1.1.1.cmml" xref="S4.SS5.p10.1.m1.1.1"><csymbol cd="latexml" id="S4.SS5.p10.1.m1.1.1.1.cmml" xref="S4.SS5.p10.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p10.1.m1.1.1.2.cmml" xref="S4.SS5.p10.1.m1.1.1.2">95.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p10.1.m1.1c">95.42\%</annotation></semantics></math> to <math id="S4.SS5.p10.2.m2.1" class="ltx_Math" alttext="87.75\%" display="inline"><semantics id="S4.SS5.p10.2.m2.1a"><mrow id="S4.SS5.p10.2.m2.1.1" xref="S4.SS5.p10.2.m2.1.1.cmml"><mn id="S4.SS5.p10.2.m2.1.1.2" xref="S4.SS5.p10.2.m2.1.1.2.cmml">87.75</mn><mo id="S4.SS5.p10.2.m2.1.1.1" xref="S4.SS5.p10.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p10.2.m2.1b"><apply id="S4.SS5.p10.2.m2.1.1.cmml" xref="S4.SS5.p10.2.m2.1.1"><csymbol cd="latexml" id="S4.SS5.p10.2.m2.1.1.1.cmml" xref="S4.SS5.p10.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p10.2.m2.1.1.2.cmml" xref="S4.SS5.p10.2.m2.1.1.2">87.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p10.2.m2.1c">87.75\%</annotation></semantics></math>. LSTM can encode the modifier words that precede the object, and thus, its performance slightly drops by <math id="S4.SS5.p10.3.m3.1" class="ltx_Math" alttext="3.6\%" display="inline"><semantics id="S4.SS5.p10.3.m3.1a"><mrow id="S4.SS5.p10.3.m3.1.1" xref="S4.SS5.p10.3.m3.1.1.cmml"><mn id="S4.SS5.p10.3.m3.1.1.2" xref="S4.SS5.p10.3.m3.1.1.2.cmml">3.6</mn><mo id="S4.SS5.p10.3.m3.1.1.1" xref="S4.SS5.p10.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p10.3.m3.1b"><apply id="S4.SS5.p10.3.m3.1.1.cmml" xref="S4.SS5.p10.3.m3.1.1"><csymbol cd="latexml" id="S4.SS5.p10.3.m3.1.1.1.cmml" xref="S4.SS5.p10.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p10.3.m3.1.1.2.cmml" xref="S4.SS5.p10.3.m3.1.1.2">3.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p10.3.m3.1c">3.6\%</annotation></semantics></math>.</p>
</div>
<div id="S4.SS5.p11" class="ltx_para">
<p id="S4.SS5.p11.4" class="ltx_p"><span id="S4.SS5.p11.4.1" class="ltx_text ltx_font_bold">Ground-truth program layout</span>  We also investigate the effectiveness of our neural modules by providing ground-truth program layouts. The program layouts are used to generate the questions in CLEVR and are built by composing a set of basic functions into a tree/chain structure. Each function performs one type of operation based on object inputs and value inputs. For example, functions with type “filter_color” and value “blue” output the subset of blue input objects.
Given the program layouts, we perform structured reasoning by considering each function as a node and applying our neural module. Given a function <math id="S4.SS5.p11.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS5.p11.1.m1.1a"><mi id="S4.SS5.p11.1.m1.1.1" xref="S4.SS5.p11.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.1.m1.1b"><ci id="S4.SS5.p11.1.m1.1.1.cmml" xref="S4.SS5.p11.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.1.m1.1c">i</annotation></semantics></math>, we encode the value input with a lookup table and use the result as a word encoding <math id="S4.SS5.p11.2.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.SS5.p11.2.m2.1a"><msub id="S4.SS5.p11.2.m2.1.1" xref="S4.SS5.p11.2.m2.1.1.cmml"><mi id="S4.SS5.p11.2.m2.1.1.2" xref="S4.SS5.p11.2.m2.1.1.2.cmml">w</mi><mi id="S4.SS5.p11.2.m2.1.1.3" xref="S4.SS5.p11.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.2.m2.1b"><apply id="S4.SS5.p11.2.m2.1.1.cmml" xref="S4.SS5.p11.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.p11.2.m2.1.1.1.cmml" xref="S4.SS5.p11.2.m2.1.1">subscript</csymbol><ci id="S4.SS5.p11.2.m2.1.1.2.cmml" xref="S4.SS5.p11.2.m2.1.1.2">𝑤</ci><ci id="S4.SS5.p11.2.m2.1.1.3.cmml" xref="S4.SS5.p11.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.2.m2.1c">w_{i}</annotation></semantics></math>; we use the function type as <math id="S4.SS5.p11.3.m3.1" class="ltx_Math" alttext="e_{ij}" display="inline"><semantics id="S4.SS5.p11.3.m3.1a"><msub id="S4.SS5.p11.3.m3.1.1" xref="S4.SS5.p11.3.m3.1.1.cmml"><mi id="S4.SS5.p11.3.m3.1.1.2" xref="S4.SS5.p11.3.m3.1.1.2.cmml">e</mi><mrow id="S4.SS5.p11.3.m3.1.1.3" xref="S4.SS5.p11.3.m3.1.1.3.cmml"><mi id="S4.SS5.p11.3.m3.1.1.3.2" xref="S4.SS5.p11.3.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p11.3.m3.1.1.3.1" xref="S4.SS5.p11.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS5.p11.3.m3.1.1.3.3" xref="S4.SS5.p11.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.3.m3.1b"><apply id="S4.SS5.p11.3.m3.1.1.cmml" xref="S4.SS5.p11.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p11.3.m3.1.1.1.cmml" xref="S4.SS5.p11.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.p11.3.m3.1.1.2.cmml" xref="S4.SS5.p11.3.m3.1.1.2">𝑒</ci><apply id="S4.SS5.p11.3.m3.1.1.3.cmml" xref="S4.SS5.p11.3.m3.1.1.3"><times id="S4.SS5.p11.3.m3.1.1.3.1.cmml" xref="S4.SS5.p11.3.m3.1.1.3.1"></times><ci id="S4.SS5.p11.3.m3.1.1.3.2.cmml" xref="S4.SS5.p11.3.m3.1.1.3.2">𝑖</ci><ci id="S4.SS5.p11.3.m3.1.1.3.3.cmml" xref="S4.SS5.p11.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.3.m3.1c">e_{ij}</annotation></semantics></math>, where <math id="S4.SS5.p11.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS5.p11.4.m4.1a"><mi id="S4.SS5.p11.4.m4.1.1" xref="S4.SS5.p11.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.4.m4.1b"><ci id="S4.SS5.p11.4.m4.1.1.cmml" xref="S4.SS5.p11.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.4.m4.1c">j</annotation></semantics></math> is the subsequent function. The results are denoted as “PTGRN (GT layout)” in Table <a href="#S4.T6" title="TABLE VI ‣ 4.5 Ablation studies ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>. It is shown that our model can achieve results that are good when compared with other methods that used this layout annotation.</p>
</div>
<div id="S4.SS5.p12" class="ltx_para">
<p id="S4.SS5.p12.1" class="ltx_p"><span id="S4.SS5.p12.1.1" class="ltx_text ltx_font_bold">Quality comparison</span>  We further compare the reasoning results generated by ACMN and PTGRN in Figure <a href="#S4.F10" title="Figure 10 ‣ 4.4 CLEVR composition generalization test ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. The upper part shows the heat map given by ACMN, and the lower part displays the results of PTGRN.
The first question queries the number of specific objects. ACMN correctly attends the “red rubber” things, but it locates only one of the blue objects; PTGRN has also found the “red rubber” and locates all of the objects given the phrases “of things” and “what number”. Finally, PTGRN attends the two blue objects that are far from the “red rubber” at the last step.
The second example illustrates the process of locating the “big thing” and the “metal sphere”. Although both models mined the corresponding objects at each step, PTGRN can pinpoint the location of these objects.</p>
</div>
<figure id="S4.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>The accuracy of attention maps on CLVER validation set.</figcaption>
<div id="S4.T7.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:37.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(9.3pt,-0.8pt) scale(1.04470839397166,1.04470839397166) ;">
<table id="S4.T7.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T7.1.1.1.1" class="ltx_tr">
<td id="S4.T7.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Method</td>
<td id="S4.T7.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</td>
<td id="S4.T7.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PTGRN</td>
<td id="S4.T7.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">TbD+reg+hres <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>
</td>
<td id="S4.T7.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PTGRN (GT layout)</td>
</tr>
<tr id="S4.T7.1.1.2.2" class="ltx_tr">
<td id="S4.T7.1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Accuracy</td>
<td id="S4.T7.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">32.72</td>
<td id="S4.T7.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">64.71</td>
<td id="S4.T7.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">77.11</td>
<td id="S4.T7.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">91.85</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span><span id="S4.SS6.1.1" class="ltx_text ltx_font_italic">Evaluation of interpretability</span>
</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">We evaluate and compare the interpretability of our model with that of the previous method by calculating how well the generated attention map matches the ground-truth bounding boxes.
Specifically, the CLEVR dataset provides functional program layouts for each question. The program layouts are composed of functions and some functions output object sets. Given a function output object set and an attention map, we sum the normalized attention weight inside the objects’ bounding boxes as the attention accuracy on this function. We evaluate the interpretability of a model by averaging the attention accuracy on all functions in the program layouts.
For MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and our methods, the reasoning processes are different from the program layouts. Thus, for each function, we use the attention map that achieves highest attention accuracy as the accuracy for this function.
The results are shown in Table <a href="#S4.T7" title="TABLE VII ‣ 4.5 Ablation studies ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>. Given the ground-truth layouts, our model achieves better results than TbD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>; Our model also outperforms MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> by <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="31.99\%" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mrow id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><mn id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml">31.99</mn><mo id="S4.SS6.p1.1.m1.1.1.1" xref="S4.SS6.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS6.p1.1.m1.1.1.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2">31.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">31.99\%</annotation></semantics></math> if the ground-truth layouts are not given, demonstrating the interpretability of our model.</p>
</div>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span><span id="S4.SS7.1.1" class="ltx_text ltx_font_italic">Perturbed tree structure</span>
</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.1" class="ltx_p">Since our model relies on the parsed results of the parser, we perform experiments to investigate the impact of incorrectly parsed trees. We randomly distort the generated dependency trees to observe the effect on the final prediction. Specifically, we randomly perturb each dependency relation with a certain probability by replacing its parent node and relation edge with a word that is randomly chosen from the sentence and the possible relations, respectively. The results are listed in Table <a href="#S4.T8" title="TABLE VIII ‣ 4.7 Perturbed tree structure ‣ 4 Experiment ‣ Interpretable Visual Question Answering by Reasoning on Dependency Trees" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VIII</span></a>. As shown, the performance dramatically decreases as the number of perturbed relations increases. This result indicates that the parsing results are crucial to the performance.</p>
</div>
<figure id="S4.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">TABLE VIII: </span>Accuracy on CLEVR with randomly perturbed dependency trees.</figcaption>
<table id="S4.T8.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T8.3.1.1" class="ltx_tr">
<th id="S4.T8.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T8.3.1.1.1.1" class="ltx_text" style="font-size:80%;">Percentage of perturb</span></th>
<th id="S4.T8.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t"><span id="S4.T8.3.1.1.2.1" class="ltx_text" style="font-size:80%;">0</span></th>
<th id="S4.T8.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T8.3.1.1.3.1" class="ltx_text" style="font-size:80%;">10%</span></th>
<th id="S4.T8.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T8.3.1.1.4.1" class="ltx_text" style="font-size:80%;">30%</span></th>
<th id="S4.T8.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T8.3.1.1.5.1" class="ltx_text" style="font-size:80%;">50%</span></th>
<th id="S4.T8.3.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T8.3.1.1.6.1" class="ltx_text" style="font-size:80%;">70%</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T8.3.2.1" class="ltx_tr">
<th id="S4.T8.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T8.3.2.1.1.1" class="ltx_text" style="font-size:80%;">Accuracy</span></th>
<th id="S4.T8.3.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T8.3.2.1.2.1" class="ltx_text" style="font-size:80%;">95.42</span></th>
<td id="S4.T8.3.2.1.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T8.3.2.1.3.1" class="ltx_text" style="font-size:80%;">86.77</span></td>
<td id="S4.T8.3.2.1.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T8.3.2.1.4.1" class="ltx_text" style="font-size:80%;">69.88</span></td>
<td id="S4.T8.3.2.1.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T8.3.2.1.5.1" class="ltx_text" style="font-size:80%;">54.21</span></td>
<td id="S4.T8.3.2.1.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T8.3.2.1.6.1" class="ltx_text" style="font-size:80%;">40.11</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose a novel parse-tree-guided reasoning network (PTGRN) equipped with an attention module, a gated residual composition module, and a parse-tree-guided propagation module. In contrast to previous works that rely on annotations or handcrafted rules to perform explicit compositional reasoning, our PTGRN model can automatically perform an interpretable reasoning process over a general dependency parse tree based on the question, which can largely broaden its application fields. The attention module encourages the model to attend the local visual evidence, the gated residual composition module can learn to compose and update the knowledge from its child nodes, and the parse-tree-guided propagation module generates and propagates the edge-dependent information from children to their parents.
Experiments show that PTGRN can achieve state-of-the-art VQA performance and good interpretability without using any specified ground-truth layouts or complicated handcrafted rules.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
M. Malinowski, M. Rohrbach, and M. Fritz, “Ask your neurons: A neural-based
approach to answering questions about images,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2015, pp.
1–9.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
J. Lu, J. Yang, D. Batra, and D. Parikh, “Hierarchical question-image
co-attention for visual question answering,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2016, pp.
289–297.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
J.-H. Kim, K. W. On, J. Kim, J. Ha, and B.-T. Zhang, “Hadamard product for
low-rank bilinear pooling,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1610.04325, 2016.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y. Goyal, T. Khot, D. Summers-Stay, D. Batra, and D. Parikh, “Making the V
in VQA matter: Elevating the role of image understanding in Visual
Question Answering,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
J. Johnson, B. Hariharan, L. van der Maaten, L. Fei-Fei, C. L. Zitnick, and
R. Girshick, “CLEVR: A diagnostic dataset for compositional language and
elementary visual reasoning,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
R. Hu, J. Andreas, M. Rohrbach, T. Darrell, and K. Saenko, “Learning to
reason: End-to-end module networks for visual question answering,” in
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
J. Johnson, B. Hariharan, L. van der Maaten, J. Hoffman, F. Li, C. L. Zitnick,
and R. B. Girshick, “Inferring and executing programs for visual
reasoning,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
D. Teney, L. Liu, and A. van den Hengel, “Graph-structured representations for
visual question answering,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, July 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
K. Yi, J. Wu, C. Gan, A. Torralba, P. Kohli, and J. Tenenbaum,
“Neural-symbolic vqa: Disentangling reasoning from vision and language
understanding,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, S. Bengio, H. Wallach, H. Larochelle,
K. Grauman, N. Cesa-Bianchi, and R. Garnett, Eds.   Curran Associates, Inc., 2018, pp. 1031–1042.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zitnick, and
D. Parikh, “VQA: Visual Question Answering,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2015.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
I. Ilievski, S. Yan, and J. Feng, “A focused dynamic attention model for
visual question answering,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1604.01485, 2016.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
H. Xu and K. Saenko, <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Ask, Attend and Answer: Exploring Question-Guided
Spatial Attention for Visual Question Answering</em>.   Cham: Springer International Publishing, 2016, pp. 451–466.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
K. J. Shih, S. Singh, and D. Hoiem, “Where to look: Focus regions for visual
question answering,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y. Zhu, O. Groth, M. S. Bernstein, and L. Fei-Fei, “Visual7w: Grounded
question answering in images,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016, pp. 4995–5004.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Z. Yang, X. He, J. Gao, L. Deng, and A. Smola, “Stacked attention networks for
image question answering,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, June 2016, pp. 21–29.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A. Fukui, D. H. Park, D. Yang, A. Rohrbach, T. Darrell, and M. Rohrbach,
“Multimodal compact bilinear pooling for visual question answering and
visual grounding,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2016, pp. 457–468.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Z. Yu, J. Yu, J. Fan, and D. Tao, “Multi-modal factorized bilinear pooling
with co-attention learning for visual question answering,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pp.
1839–1848, 2017.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
H. Ben-younes, R. Cadene, M. Cord, and N. Thome, “Mutan: Multimodal tucker
fusion for visual question answering,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, Oct 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
A. Jabri, A. Joulin, and L. van der Maaten, “Revisiting visual question
answering baselines,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, ser. Lecture Notes in Computer
Science, vol. 9912.   Springer, 2016,
pp. 727–739.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
A. Kumar, O. Irsoy, P. Ondruska, M. Iyyer, J. Bradbury, I. Gulrajani, V. Zhong,
R. Paulus, and R. Socher, “Ask me anything: Dynamic memory networks for
natural language processing,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2016, pp. 1378–1387.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
P. Wang, Q. Wu, C. Shen, A. van den Hengel, and A. R. Dick, “FVQA:
fact-based visual question answering,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1606.05433,
2016.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Y. Zhu, J. J. Lim, and L. Fei-Fei, “Knowledge Acquisition for Visual Question
Answering via Iterative Querying,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
C. Xiong, S. Merity, and R. Socher, “Dynamic memory networks for visual and
textual question answering,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2016, pp. 2397–2406.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
J. Andreas, M. Rohrbach, T. Darrell, and D. Klein, “Neural module networks,”
in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.   IEEE Computer
Society, 2016, pp. 39–48.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
——, “Learning to compose neural networks for question answering,” in
<em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">HLT-NAACL</em>.   The Association
for Computational Linguistics, 2016, pp. 1545–1554.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
D. Mascharka, P. Tran, R. Soklaski, and A. Majumdar, “Transparency by design:
Closing the gap between performance and interpretability in visual
reasoning,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, June 2018.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
D. A. Hudson and C. D. Manning, “Compositional attention networks for machine
reasoning,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2018.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
R. Hu, J. Andreas, T. Darrell, and K. Saenko, “Explainable neural computation
via stack neural module networks,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, September 2018.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
V. S. Lempitsky and A. Zisserman, “Learning to count objects in images,” in
<em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">NIPS</em>.   Curran Associates,
Inc., 2010, pp. 1324–1332.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
C. Zhang, H. Li, X. Wang, and X. Yang, “Cross-scene crowd counting via deep
convolutional neural networks,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.   IEEE Computer Society, 2015, pp. 833–841.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
D. Oñoro-Rubio and R. J. López-Sastre, “Towards
perspective-free object counting with deep learning,” in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">ECCV
(7)</em>, ser. Lecture Notes in Computer Science, vol. 9911.   Springer, 2016, pp. 615–629.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
J. Zhang, S. Ma, M. Sameki, S. Sclaroff, M. Betke, Z. Lin, X. Shen, B. L.
Price, and R. Mech, “Salient object subitizing,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">International
Journal of Computer Vision</em>, vol. 124, no. 2, pp. 169–186, 2017.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
P. Chattopadhyay, R. Vedantam, R. R. Selvaraju, D. Batra, and D. Parikh,
“Counting everyday objects in everyday scenes,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.   IEEE Computer Society, 2017, pp. 4428–4437.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
P. Anderson, X. He, C. Buehler, D. Teney, M. Johnson, S. Gould, and L. Zhang,
“Bottom-up and top-down attention for image captioning and visual question
answering,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1707.07998</em>, 2017.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz, S. Chen,
Y. Kalantidis, L.-J. Li, D. A. Shamma, M. S. Bernstein, and L. Fei-Fei,
“Visual genome: Connecting language and vision using crowdsourced dense
image annotations,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, vol.
123, no. 1, pp. 32–73, May 2017. [Online]. Available:
https://doi.org/10.1007/s11263-016-0981-7

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
A. Trott, C. Xiong, and R. Socher, “Interpretable counting for visual question
answering,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1712.08697, 2017.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Y. Zhang, J. Hare, and A. Prügel-Bennett, “Learning to count objects in
natural images for visual question answering,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2018.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
D. Chen and C. D. Manning, “A fast and accurate dependency parser using neural
networks,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2014.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.   IEEE Computer Society, 2016, pp. 770–778.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
J. Chung, Ç. Gülçehre, K. Cho, and Y. Bengio, “Empirical
evaluation of gated recurrent neural networks on sequence modeling,”
<em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1412.3555, 2014.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
K. S. Tai, R. Socher, and C. D. Manning, “Improved semantic representations
from tree-structured long short-term memory networks,” in <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">ACL
(1)</em>.   The Association for Computer
Linguistics, 2015, pp. 1556–1566.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
S. E. Kahou, A. Atkinson, V. Michalski, Á. Kádár,
A. Trischler, and Y. Bengio, “Figureqa: An annotated figure dataset for
visual reasoning,” <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1710.07300, 2017.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ramanan,
P. Dollár, and C. L. Zitnick, <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Microsoft COCO: Common Objects in
Context</em>.   Cham: Springer International
Publishing, 2014, pp. 740–755.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
C. Zhu, Y. Zhao, S. Huang, K. Tu, and Y. Ma, “Structured attentions for visual
question answering,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, Oct 2017.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
A. Santoro, D. Raposo, D. G. T. Barrett, M. Malinowski, R. Pascanu,
P. Battaglia, and T. P. Lillicrap, “A simple neural network module for
relational reasoning,” <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1706.01427, 2017.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
E. Perez, F. Strub, H. de Vries, V. Dumoulin, and A. C. Courville, “Film:
Visual reasoning with a general conditioning layer,” in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">AAAI</em>.   AAAI Press, 2018.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,” in
<em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2015.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
D. Teney, P. Anderson, X. He, and A. van den Hengel, “Tips and tricks for
visual question answering: Learnings from the 2017 challenge,” <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CoRR</em>,
vol. abs/1708.02711, 2017.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
J.-H. Kim, J. Jun, and B.-T. Zhang, “Bilinear Attention Networks,” in
<em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2018, pp. 1571–1581.

</span>
</li>
</ul>
</section>
<figure id="id1" class="ltx_float biography">
<table id="id1.1" class="ltx_tabular">
<tr id="id1.1.1" class="ltx_tr">
<td id="id1.1.1.1" class="ltx_td"><img src="/html/1809.01810/assets/bio/qingxing.png" id="id1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="100" height="100" alt="[Uncaptioned image]"></td>
<td id="id1.1.1.2" class="ltx_td">
<span id="id1.1.1.2.1" class="ltx_inline-block">
<span id="id1.1.1.2.1.1" class="ltx_p"><span id="id1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Qingxing Cao</span> 
Qingxing Cao is currently a postdoctoral researcher in the School of Intelligent Systems Engineering at Sun Yat-sen University, working with Prof. Xiaodan Liang. He received his Ph.D. degree from Sun Yat-Sen University in 2019, advised by Prof. Liang Lin. His current research interests include computer vision and visual question answering.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id2" class="ltx_float biography">
<table id="id2.1" class="ltx_tabular">
<tr id="id2.1.1" class="ltx_tr">
<td id="id2.1.1.1" class="ltx_td"><img src="/html/1809.01810/assets/bio/bailin.png" id="id2.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="89" height="125" alt="[Uncaptioned image]"></td>
<td id="id2.1.1.2" class="ltx_td">
<span id="id2.1.1.2.1" class="ltx_inline-block">
<span id="id2.1.1.2.1.1" class="ltx_p"><span id="id2.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Bailin Li</span> 
Bailin Li received his B.E. degree from Jilin University, Changchun, China, in 2016, and the M.S. degree at Sun Yat-Sen University, Guangzhou, China, advised by Professor Liang Lin. He currently leads the model optimization team at DMAI. His current research interests include visual reasoning and deep learning (e.g., network pruning, neural architecture search).</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id3" class="ltx_float biography">
<table id="id3.1" class="ltx_tabular">
<tr id="id3.1.1" class="ltx_tr">
<td id="id3.1.1.1" class="ltx_td"><img src="/html/1809.01810/assets/bio/xiaodan.png" id="id3.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="84" height="125" alt="[Uncaptioned image]"></td>
<td id="id3.1.1.2" class="ltx_td">
<span id="id3.1.1.2.1" class="ltx_inline-block">
<span id="id3.1.1.2.1.1" class="ltx_p"><span id="id3.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Xiaodan Liang</span> 
Xiaodan Liang is currently an Associate Professor at Sun Yat-sen University. She was a postdoc researcher in the machine learning department at Carnegie Mellon University, working with Prof. Eric Xing, from 2016 to 2018. She received her PhD degree from Sun Yat-sen University in 2016, advised by Liang Lin. She has published several cutting-edge projects on human-related analysis, including human parsing, pedestrian detection and instance segmentation, 2D/3D human pose estimation and activity recognition.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id4" class="ltx_float biography">
<table id="id4.1" class="ltx_tabular">
<tr id="id4.1.1" class="ltx_tr">
<td id="id4.1.1.1" class="ltx_td"><img src="/html/1809.01810/assets/x1.png" id="id4.1.1.1.g1" class="ltx_graphics ltx_img_square" width="77" height="90" alt="[Uncaptioned image]"></td>
<td id="id4.1.1.2" class="ltx_td">
<span id="id4.1.1.2.1" class="ltx_inline-block">
<span id="id4.1.1.2.1.1" class="ltx_p"><span id="id4.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Liang Lin</span> 
Liang Lin is CEO of DMAI Great China and a full professor of Computer Science in Sun Yat-sen University. He served as the Executive Director of the SenseTime Group from 2016 to 2018, leading the R&amp;D teams in developing cutting-edge, deliverable solutions in computer vision, data analysis and mining, and intelligent robotic systems. He has authored or co-authored more than 200 papers in leading academic journals and conferences (e.g., TPAMI/IJCV, CVPR/ICCV/NIPS/ICML/AAAI). He is an associate editor of IEEE Trans, Human-Machine Systems and IET Computer Vision, and he served as the area/session chair for numerous conferences, such as CVPR, ICME, ICCV, ICMR. He was the recipient of Annual Best Paper Award by Pattern Recognition (Elsevier) in 2018, Dimond Award for best paper in IEEE ICME in 2017, ACM NPAR Best Paper Runners-Up Award in 2010, Google Faculty Award in 2012, award for the best student paper in IEEE ICME in 2014, and Hong Kong Scholars Award in 2014. He is a Fellow of IET.</span>
</span>
</td>
</tr>
</table>
</figure>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1809.01809" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1809.01810" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1809.01810">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1809.01810" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1809.01811" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar 15 22:36:36 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
