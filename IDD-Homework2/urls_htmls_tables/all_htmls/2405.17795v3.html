<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Dataset Regeneration for Sequential Recommendation</title>
<!--Generated on Wed Sep 11 02:06:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommendation System,  Sequential Recommendation,  Data-Centric AI,  Data Generation" lang="en" name="keywords"/>
<base href="/html/2405.17795v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S1" title="In Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>INTRODUCTION</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S2" title="In Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>RELATED WORKS</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S2.SS1" title="In 2. RELATED WORKS ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S2.SS2" title="In 2. RELATED WORKS ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Data-Centric AI in Recommender System</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S3" title="In Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>PROBLEM DEFINITION</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4" title="In Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>METHODOLOGY</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS1" title="In 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Overall Framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2" title="In 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Model-agnostic Dataset Regeneration</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS1" title="In 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Construction of Pre-training Task</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS2" title="In 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Diversity-promoted Regenerator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS3" title="In 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.3 </span>Dataset Regeneration with Hybrid Inference Strategy</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS3" title="In 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Model-aware Dataset Regeneration</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS3.SSS1" title="In 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Dataset personalizer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS3.SSS2" title="In 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Efficient optimization of dataset personalizer</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5" title="In Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>EXPERIMENTAL EVALUATION</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS1" title="In 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS1.SSS1" title="In 5.1. Experimental Settings ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS1.SSS2" title="In 5.1. Experimental Settings ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Compared Baselines and Target Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS1.SSS3" title="In 5.1. Experimental Settings ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Evaluation Protocols</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS1.SSS4" title="In 5.1. Experimental Settings ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS2" title="In 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS3" title="In 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS4" title="In 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Advanced Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS4.SSS1" title="In 5.4. Advanced Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4.1 </span><span class="ltx_text ltx_font_bold">Analysis of efficiency of dataset personalization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS4.SSS2" title="In 5.4. Advanced Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4.2 </span><span class="ltx_text ltx_font_bold">Analysis of data sample scores of different target models</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS4.SSS3" title="In 5.4. Advanced Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4.3 </span><span class="ltx_text ltx_font_bold">Analysis of data forms that should be regenerated.</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS5" title="In 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Hyper-parameter Sensitivity</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS5.SSS1" title="In 5.5. Hyper-parameter Sensitivity ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5.1 </span>The diversity factor K</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.SS5.SSS2" title="In 5.5. Hyper-parameter Sensitivity ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5.2 </span>The generative decoding probability <math alttext="\gamma" class="ltx_Math" display="inline"><semantics><mi>γ</mi><annotation-xml encoding="MathML-Content"><ci>𝛾</ci></annotation-xml><annotation encoding="application/x-tex">\gamma</annotation><annotation encoding="application/x-llamapun">italic_γ</annotation></semantics></math></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S6" title="In Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>CONCLUSIONS</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1" title="In Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>APPENDIX</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.SS1" title="In Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Pseudo Code of DR4SR and DR4SR+</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.SS2" title="In Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Detailed Derivations of Equation <span class="ltx_text ltx_ref_tag">10</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.SS3" title="In Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Computational Complexity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.SS4" title="In Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Detailed Hyper-parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.SS5" title="In Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Generalization to More Datasets</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Dataset Regeneration for Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mingjia Yin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:mingjia-yin@mail.ustc.edu.cn">mingjia-yin@mail.ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0005-0853-1089" title="ORCID identifier">0009-0005-0853-1089</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">University of Science and Technology of China &amp; State Key Laboratory of Cognitive Intelligence</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:wanghao3@ustc.edu.cn">wanghao3@ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0001-9921-2078" title="ORCID identifier">0000-0001-9921-2078</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">University of Science and Technology of China &amp; State Key Laboratory of Cognitive Intelligence</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wei Guo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:guowei67@huawei.com">guowei67@huawei.com</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0001-8616-0221" title="ORCID identifier">0000-0001-8616-0221</a></span>
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yong Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:liu.yong6@huawei.com">liu.yong6@huawei.com</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0001-9031-9696" title="ORCID identifier">0000-0001-9031-9696</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Huawei Singapore Research Center</span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2">Singapore</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Suojuan Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:sjzsj@ustc.edu.cn">sjzsj@ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0003-2193-2288" title="ORCID identifier">0009-0003-2193-2288</a></span>
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sirui Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:sirui@mail.ustc.edu.cn">sirui@mail.ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0001-8103-0321" title="ORCID identifier">0000-0001-8103-0321</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">University of Science and Technology of China &amp; State Key Laboratory of Cognitive Intelligence</span><span class="ltx_text ltx_affiliation_city" id="id10.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_country" id="id11.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Defu Lian
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:liandefu@ustc.edu.cn">liandefu@ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-3507-9607" title="ORCID identifier">0000-0002-3507-9607</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id12.1.id1">University of Science and Technology of China &amp; State Key Laboratory of Cognitive Intelligence</span><span class="ltx_text ltx_affiliation_city" id="id13.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_country" id="id14.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Enhong Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:cheneh@ustc.edu.cn">cheneh@ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-4835-4102" title="ORCID identifier">0000-0002-4835-4102</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">University of Science and Technology of China &amp; State Key Laboratory of Cognitive Intelligence</span><span class="ltx_text ltx_affiliation_city" id="id16.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_country" id="id17.3.id3">China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id18.id1">The sequential recommender (SR) system is a crucial component of modern recommender systems, as it aims to capture the evolving preferences of users. Significant efforts have been made to enhance the capabilities of SR systems. These methods typically follow the <span class="ltx_text ltx_font_bold" id="id18.id1.1">model-centric</span> paradigm, which involves developing effective models based on fixed datasets. However, this approach often overlooks potential quality issues and flaws inherent in the data. Driven by the potential of <span class="ltx_text ltx_font_bold" id="id18.id1.2">data-centric</span> AI, we propose a novel data-centric paradigm for developing an ideal training dataset using a model-agnostic dataset regeneration framework called DR4SR. This framework enables the regeneration of a dataset with exceptional cross-architecture generalizability. Additionally, we introduce the DR4SR+ framework, which incorporates a model-aware dataset personalizer to tailor the regenerated dataset specifically for a target model. To demonstrate the effectiveness of the data-centric paradigm, we integrate our framework with various model-centric methods and observe significant performance improvements across four widely adopted datasets. Furthermore, we conduct in-depth analyses to explore the potential of the data-centric paradigm and provide valuable insights. The anonymous code can be found at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/USTC-StarTeam/DR4SR" style="color:#0000FF;" title="">https://github.com/USTC-StarTeam/DR4SR</a>.</p>
</div>
<div class="ltx_keywords">Recommendation System, Sequential Recommendation, Data-Centric AI, Data Generation
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining; August 25–29, 2024; Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’24), August 25–29, 2024, Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3637528.3671841</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0490-1/24/08</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>INTRODUCTION</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="151" id="S1.F1.g1" src="x1.png" width="320"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Model-centric paradigm v.s. Data-centric pradigm.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The sequential recommender (SR) system is a critical component of modern recommender systems, aiming to capture the evolving preferences of users through their sequential interaction records <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib51" title="">2022c</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib57" title="">2023c</a>)</cite>. In recent years, significant efforts have been made to enhance SR. This includes the development of sophisticated deep models <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib44" title="">2018</a>; Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib12" title="">2016</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib21" title="">2018</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib58" title="">2018</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib16" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib28" title="">2023</a>; Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib67" title="">2024</a>)</cite>, effective training strategies <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib38" title="">2022</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib31" title="">2023b</a>)</cite>, and the refinement of representation space through self-supervised learning <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib69" title="">2024b</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib82" title="">2020</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib60" title="">2022</a>; Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib40" title="">2022</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib4" title="">2022</a>; Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib68" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib75" title="">2024</a>)</cite>, among others. These methods follow the <span class="ltx_text ltx_font_bold" id="S1.p1.1.1">model-centric</span> paradigm, which specifically aims to develop more effective models given fixed datasets.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the remarkable achievements, these methods often overlook potential quality issues inherent within the data <cite class="ltx_cite ltx_citemacro_citep">(Zha et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib72" title="">2023</a>)</cite>, which may lead to overfitting or amplification of data errors <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib73" title="">2023b</a>; Lai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib26" title="">2024</a>)</cite>. To address these challenges, the <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">data-centric</span> paradigm <cite class="ltx_cite ltx_citemacro_citep">(Zha et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib72" title="">2023</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib80" title="">2023</a>; Lai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib26" title="">2024</a>)</cite> has been proposed, focusing on developing high-quality data with fixed models. For example, graph structure learning <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib84" title="">2021</a>; Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib20" title="">2020</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib34" title="">2022b</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib64" title="">2023b</a>)</cite> has been introduced to uncover valuable graph structures from data <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib80" title="">2023</a>)</cite>. Additionally, generative models such as GAN <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib6" title="">2014</a>)</cite>, VAE <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Welling, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib24" title="">2014</a>)</cite>, and Diffusion model <cite class="ltx_cite ltx_citemacro_citep">(Ho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib13" title="">2020</a>)</cite> have been employed to synthesize new training samples <cite class="ltx_cite ltx_citemacro_citep">(Ho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib14" title="">2022</a>; Hsu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib17" title="">2017</a>)</cite>. Inspired by the potential of data-centric AI, we aim to acquire an informative and generalizable training dataset for sequential recommender systems. We define this as the <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">training data development</span> problem. To the best of our knowledge, we are the first to investigate this problem in the context of sequential recommendation systems.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address the issue, dataset generation is the most relevant topic. However, to the best of our knowledge, it has been rarely studied in the field of recommender systems. UPC-SDG<cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib32" title="">2022a</a>)</cite> proposed to generate a synthetic dataset, but its primary goal is to preserve privacy rather than recommendation performance. Another potential solution is dataset distillation (DD), aiming to derive a smaller synthetic dataset and enable trained models to attain comparable performance<cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib70" title="">2024a</a>; Sachdeva et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib41" title="">2022</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib55" title="">2023a</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib47" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib56" title="">2023b</a>)</cite>. However, they prioritize training efficiency over effectiveness, which differs from our motivation. Notably, recent advancements in DD <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib81" title="">2023</a>; Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib7" title="">2023</a>)</cite> have reported that even increasing synthetic dataset size, the performance will ultimately plateau around the optimal performance achieved with the original dataset. Yet another viable approach is denoising sequential recommendation, which involves the removal of noisy information from the original data <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib39" title="">2021</a>; Tong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib45" title="">2021</a>; Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib71" title="">2021</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib83" title="">2022</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib74" title="">2023a</a>)</cite>. However, denoising is just one aspect of the larger issue concerning training data development. Our objective is to excavate innovative data content and formats within the developed data, further enhancing model training.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.10">To acquire the optimal training data, our key idea is to learn a new dataset that explicitly contains item transition patterns. In detail, we decompose the modeling process of a recommender into two stages: extracting transition patterns <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><msup id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">𝒳</mi><mo id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">superscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">𝒳</ci><ci id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> from the original dataset <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">caligraphic_X</annotation></semantics></math> and learning user preferences <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><ci id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">caligraphic_Y</annotation></semantics></math> based on <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S1.p4.4.m4.1"><semantics id="S1.p4.4.m4.1a"><msup id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.4.m4.1.1.2" xref="S1.p4.4.m4.1.1.2.cmml">𝒳</mi><mo id="S1.p4.4.m4.1.1.3" xref="S1.p4.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><apply id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p4.4.m4.1.1.1.cmml" xref="S1.p4.4.m4.1.1">superscript</csymbol><ci id="S1.p4.4.m4.1.1.2.cmml" xref="S1.p4.4.m4.1.1.2">𝒳</ci><ci id="S1.p4.4.m4.1.1.3.cmml" xref="S1.p4.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. The learning of the mapping <math alttext="\mathcal{X}\rightarrow\mathcal{Y}" class="ltx_Math" display="inline" id="S1.p4.5.m5.1"><semantics id="S1.p4.5.m5.1a"><mrow id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.5.m5.1.1.2" xref="S1.p4.5.m5.1.1.2.cmml">𝒳</mi><mo id="S1.p4.5.m5.1.1.1" stretchy="false" xref="S1.p4.5.m5.1.1.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S1.p4.5.m5.1.1.3" xref="S1.p4.5.m5.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.1b"><apply id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1"><ci id="S1.p4.5.m5.1.1.1.cmml" xref="S1.p4.5.m5.1.1.1">→</ci><ci id="S1.p4.5.m5.1.1.2.cmml" xref="S1.p4.5.m5.1.1.2">𝒳</ci><ci id="S1.p4.5.m5.1.1.3.cmml" xref="S1.p4.5.m5.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.1c">\mathcal{X}\rightarrow\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.5.m5.1d">caligraphic_X → caligraphic_Y</annotation></semantics></math> is challenging since it involves two implicit mappings: <math alttext="\mathcal{X}\rightarrow\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S1.p4.6.m6.1"><semantics id="S1.p4.6.m6.1a"><mrow id="S1.p4.6.m6.1.1" xref="S1.p4.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.6.m6.1.1.2" xref="S1.p4.6.m6.1.1.2.cmml">𝒳</mi><mo id="S1.p4.6.m6.1.1.1" stretchy="false" xref="S1.p4.6.m6.1.1.1.cmml">→</mo><msup id="S1.p4.6.m6.1.1.3" xref="S1.p4.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.6.m6.1.1.3.2" xref="S1.p4.6.m6.1.1.3.2.cmml">𝒳</mi><mo id="S1.p4.6.m6.1.1.3.3" xref="S1.p4.6.m6.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.6.m6.1b"><apply id="S1.p4.6.m6.1.1.cmml" xref="S1.p4.6.m6.1.1"><ci id="S1.p4.6.m6.1.1.1.cmml" xref="S1.p4.6.m6.1.1.1">→</ci><ci id="S1.p4.6.m6.1.1.2.cmml" xref="S1.p4.6.m6.1.1.2">𝒳</ci><apply id="S1.p4.6.m6.1.1.3.cmml" xref="S1.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S1.p4.6.m6.1.1.3.1.cmml" xref="S1.p4.6.m6.1.1.3">superscript</csymbol><ci id="S1.p4.6.m6.1.1.3.2.cmml" xref="S1.p4.6.m6.1.1.3.2">𝒳</ci><ci id="S1.p4.6.m6.1.1.3.3.cmml" xref="S1.p4.6.m6.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.6.m6.1c">\mathcal{X}\rightarrow\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.6.m6.1d">caligraphic_X → caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{X}^{\prime}\rightarrow\mathcal{Y}" class="ltx_Math" display="inline" id="S1.p4.7.m7.1"><semantics id="S1.p4.7.m7.1a"><mrow id="S1.p4.7.m7.1.1" xref="S1.p4.7.m7.1.1.cmml"><msup id="S1.p4.7.m7.1.1.2" xref="S1.p4.7.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.7.m7.1.1.2.2" xref="S1.p4.7.m7.1.1.2.2.cmml">𝒳</mi><mo id="S1.p4.7.m7.1.1.2.3" xref="S1.p4.7.m7.1.1.2.3.cmml">′</mo></msup><mo id="S1.p4.7.m7.1.1.1" stretchy="false" xref="S1.p4.7.m7.1.1.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S1.p4.7.m7.1.1.3" xref="S1.p4.7.m7.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.7.m7.1b"><apply id="S1.p4.7.m7.1.1.cmml" xref="S1.p4.7.m7.1.1"><ci id="S1.p4.7.m7.1.1.1.cmml" xref="S1.p4.7.m7.1.1.1">→</ci><apply id="S1.p4.7.m7.1.1.2.cmml" xref="S1.p4.7.m7.1.1.2"><csymbol cd="ambiguous" id="S1.p4.7.m7.1.1.2.1.cmml" xref="S1.p4.7.m7.1.1.2">superscript</csymbol><ci id="S1.p4.7.m7.1.1.2.2.cmml" xref="S1.p4.7.m7.1.1.2.2">𝒳</ci><ci id="S1.p4.7.m7.1.1.2.3.cmml" xref="S1.p4.7.m7.1.1.2.3">′</ci></apply><ci id="S1.p4.7.m7.1.1.3.cmml" xref="S1.p4.7.m7.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.7.m7.1c">\mathcal{X}^{\prime}\rightarrow\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.7.m7.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT → caligraphic_Y</annotation></semantics></math>. Therefore, we explore the possibility of developing a dataset that explicitly represents item transition patterns of <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S1.p4.8.m8.1"><semantics id="S1.p4.8.m8.1a"><msup id="S1.p4.8.m8.1.1" xref="S1.p4.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.8.m8.1.1.2" xref="S1.p4.8.m8.1.1.2.cmml">𝒳</mi><mo id="S1.p4.8.m8.1.1.3" xref="S1.p4.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S1.p4.8.m8.1b"><apply id="S1.p4.8.m8.1.1.cmml" xref="S1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S1.p4.8.m8.1.1.1.cmml" xref="S1.p4.8.m8.1.1">superscript</csymbol><ci id="S1.p4.8.m8.1.1.2.cmml" xref="S1.p4.8.m8.1.1.2">𝒳</ci><ci id="S1.p4.8.m8.1.1.3.cmml" xref="S1.p4.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.8.m8.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.8.m8.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. This allows us to explicitly decompose the learning process into two phases, with <math alttext="\mathcal{X}^{\prime}\rightarrow\mathcal{Y}" class="ltx_Math" display="inline" id="S1.p4.9.m9.1"><semantics id="S1.p4.9.m9.1a"><mrow id="S1.p4.9.m9.1.1" xref="S1.p4.9.m9.1.1.cmml"><msup id="S1.p4.9.m9.1.1.2" xref="S1.p4.9.m9.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.9.m9.1.1.2.2" xref="S1.p4.9.m9.1.1.2.2.cmml">𝒳</mi><mo id="S1.p4.9.m9.1.1.2.3" xref="S1.p4.9.m9.1.1.2.3.cmml">′</mo></msup><mo id="S1.p4.9.m9.1.1.1" stretchy="false" xref="S1.p4.9.m9.1.1.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S1.p4.9.m9.1.1.3" xref="S1.p4.9.m9.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.9.m9.1b"><apply id="S1.p4.9.m9.1.1.cmml" xref="S1.p4.9.m9.1.1"><ci id="S1.p4.9.m9.1.1.1.cmml" xref="S1.p4.9.m9.1.1.1">→</ci><apply id="S1.p4.9.m9.1.1.2.cmml" xref="S1.p4.9.m9.1.1.2"><csymbol cd="ambiguous" id="S1.p4.9.m9.1.1.2.1.cmml" xref="S1.p4.9.m9.1.1.2">superscript</csymbol><ci id="S1.p4.9.m9.1.1.2.2.cmml" xref="S1.p4.9.m9.1.1.2.2">𝒳</ci><ci id="S1.p4.9.m9.1.1.2.3.cmml" xref="S1.p4.9.m9.1.1.2.3">′</ci></apply><ci id="S1.p4.9.m9.1.1.3.cmml" xref="S1.p4.9.m9.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.9.m9.1c">\mathcal{X}^{\prime}\rightarrow\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.9.m9.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT → caligraphic_Y</annotation></semantics></math> being intuitively easier to learn. Hence, our main focus is on learning an effective mapping function for <math alttext="\mathcal{X}\rightarrow\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S1.p4.10.m10.1"><semantics id="S1.p4.10.m10.1a"><mrow id="S1.p4.10.m10.1.1" xref="S1.p4.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.10.m10.1.1.2" xref="S1.p4.10.m10.1.1.2.cmml">𝒳</mi><mo id="S1.p4.10.m10.1.1.1" stretchy="false" xref="S1.p4.10.m10.1.1.1.cmml">→</mo><msup id="S1.p4.10.m10.1.1.3" xref="S1.p4.10.m10.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.10.m10.1.1.3.2" xref="S1.p4.10.m10.1.1.3.2.cmml">𝒳</mi><mo id="S1.p4.10.m10.1.1.3.3" xref="S1.p4.10.m10.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.10.m10.1b"><apply id="S1.p4.10.m10.1.1.cmml" xref="S1.p4.10.m10.1.1"><ci id="S1.p4.10.m10.1.1.1.cmml" xref="S1.p4.10.m10.1.1.1">→</ci><ci id="S1.p4.10.m10.1.1.2.cmml" xref="S1.p4.10.m10.1.1.2">𝒳</ci><apply id="S1.p4.10.m10.1.1.3.cmml" xref="S1.p4.10.m10.1.1.3"><csymbol cd="ambiguous" id="S1.p4.10.m10.1.1.3.1.cmml" xref="S1.p4.10.m10.1.1.3">superscript</csymbol><ci id="S1.p4.10.m10.1.1.3.2.cmml" xref="S1.p4.10.m10.1.1.3.2">𝒳</ci><ci id="S1.p4.10.m10.1.1.3.3.cmml" xref="S1.p4.10.m10.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.10.m10.1c">\mathcal{X}\rightarrow\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.10.m10.1d">caligraphic_X → caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, which is a one-to-many mapping. We define the learning process as a <span class="ltx_text ltx_font_bold" id="S1.p4.10.1">dataset regeneration</span> paradigm as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S1.F1" title="Figure 1 ‣ 1. INTRODUCTION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, where ”re-” indicates that we do not incorporate any additional information but solely rely on the original dataset.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To realize dataset regeneration, we propose a novel data-centric paradigm <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">D</span>ataset <span class="ltx_text ltx_font_bold" id="S1.p5.1.2">R</span>egeneration for <span class="ltx_text ltx_font_bold" id="S1.p5.1.3">S</span>equential <span class="ltx_text ltx_font_bold" id="S1.p5.1.4">R</span>ecommendation (<span class="ltx_text ltx_font_bold" id="S1.p5.1.5">DR4SR</span>), to regenerate the original dataset into a highly informative and generalizable dataset. In detail, we first construct a pre-training task, which makes it possible to perform dataset regeneration. Subsequently, a diversity-promoted regenerator is proposed to model the one-to-many relationship between sequences and patterns in the regeneration process. Lastly, we propose a hybrid inference strategy to regenerate a new dataset with balanced exploration and exploitation. To confirm the superiority of DR4SR, we integrated our framework with various model-centric methods and conducted experiments on four widely adopted datasets. The experimental results can demonstrate the ideal cross-architecture generalizability of DR4SR and the high complementarity of data-centric and model-centric paradigms.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Upon regenerating the dataset, we encounter a novel challenge: the dataset regeneration process operates independently of the target model. While it demonstrates promising cross-architecture generalizability, the regenerated dataset may be sub-optimal for a particular target model. Consequently, our objective is to further customize the regenerated dataset to a particular target model. Nevertheless, the non-differentiable nature of the hybrid inference process poses a difficulty, as optimizing the dataset regenerator based on the downstream recommendation performance via gradient backpropagation becomes unfeasible. To mitigate the aforementioned challenges, we augment DR4SR to a model-aware dataset regeneration process, denoted as DR4SR+. DR4SR+ takes into account the unique attributes of each target model and modifies the regenerated dataset accordingly, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S1.F1" title="Figure 1 ‣ 1. INTRODUCTION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. In particular, we have implemented a dataset personalizer that assigns a score to every pattern within the regenerated dataset. To prevent model collapse, we formulate the optimization of the dataset personalizer as a bi-level optimization problem, which can be efficiently addressed using implicit differentiation. Empirical results substantiated that DR4SR+ can enhance the regenerated dataset further. Additionally, our investigations suggest that the data forms amenable to regeneration are not confined to sequences. Our contributions are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p7">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">To the best of our knowledge, this study is the first to address the issue of training data development for sequential recommendations from a data-centric perspective, intending to create an informative and generalizable training dataset.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a model-agnostic dataset regeneration framework DR4SR to tackle the problem. The framework comprises a pre-training task, a diversity-promoted regenerator, and a hybrid inference strategy, all of which contribute to the regeneration of an informative and generalizable dataset.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We further develop DR4SR into a model-aware version, denoted as DR4SR+, to tailor the regenerated dataset to various target models. This is accomplished through the use of a dataset personalizer, which assigns scores to each regenerated pattern and can be optimized efficiently using implicit differentiation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We integrated DR4SR and DR4SR+ with various model-centric methods, resulting in substantial improvements on four widely adopted datasets. Additionally, we conducted comprehensive analyses to explore the potential of the data-centric paradigm.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>RELATED WORKS</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Sequential Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">To reveal the dynamic preferences embedded within users’ interaction sequences, sequential recommendation (SR) has become a prominent branch within the realm of recommendation systems<cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib51" title="">2022c</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib33" title="">2023a</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib76" title="">2022</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib48" title="">2022b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib49" title="">2019b</a>)</cite>. Significant efforts have been directed towards enhancing the capabilities of sequential recommender systems. Initial endeavors concentrated on developing intricate sequential deep models to capture complex sequential preferences, encompassing CNN<cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib44" title="">2018</a>; Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib62" title="">2019</a>)</cite>, RNN<cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib12" title="">2016</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib27" title="">2017</a>; Han et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib9" title="">2023</a>)</cite>, GNN<cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib58" title="">2018</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib61" title="">2019</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib54" title="">2020</a>)</cite>, and Transformer<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib46" title="">2017</a>)</cite>-based approaches<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib21" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib43" title="">2019</a>)</cite>. Beyond model design, ongoing efforts aim to augment the efficacy of SR by devising superior training strategies, such as RSS<cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib38" title="">2022</a>)</cite> and CT4Rec<cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib31" title="">2023b</a>)</cite>. Additionally, self-supervised learning (SSL) has been incorporated into SR to refine the representation space with diverse SSL tasks, including sequence-level tasks<cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib60" title="">2022</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib4" title="">2022</a>)</cite>, model-level tasks<cite class="ltx_cite ltx_citemacro_citep">(Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib40" title="">2022</a>)</cite>, and hybrid tasks<cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib82" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Recognizing the presence of noise in sequential data, denoising sequential recommendation has emerged as an effective method to filter out noisy information from the original data (e.g., <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib39" title="">2021</a>; Tong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib45" title="">2021</a>; Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib71" title="">2021</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib83" title="">2022</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib74" title="">2023a</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib30" title="">2023</a>; Han et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib8" title="">2024</a>)</cite>). One approach achieves this implicitly in the representation space through elaborate model architectures, such as the sparse attention network in DSAN<cite class="ltx_cite ltx_citemacro_citep">(Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib71" title="">2021</a>)</cite>, and the filter-enhanced MLP in FMLP<cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib83" title="">2022</a>)</cite>. Another approach explicitly filters out irrelevant items for a target item, including CLEA<cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib39" title="">2021</a>)</cite> and RAP<cite class="ltx_cite ltx_citemacro_citep">(Tong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib45" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Denoising-based methods partially align with our objective, but denoising alone falls short of producing an optimal dataset as it only focuses on removing information from the data. Dataset generation should produce diverse and novel samples to alleviate the constraints imposed by the original dataset <cite class="ltx_cite ltx_citemacro_citep">(Bauer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib2" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Data-Centric AI in Recommender System</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Recently, the importance of data in the field of AI has been significantly magnified, culminating in the emergence of the Data-Centric AI (DCAI) paradigm. DCAI represents an all-encompassing concept that comprises three principal components: training data development, inference data development, and data maintenance <cite class="ltx_cite ltx_citemacro_citep">(Zha et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib72" title="">2023</a>; Lai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib26" title="">2024</a>)</cite>. Within these significant themes, our primary emphasis is on the development of training data, specifically, the creation of an optimal training dataset for sequential recommendations.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">In pursuit of the objective of training data development, dataset generation is the most relevant topic. In the field of recommender systems, UPC-SDG<cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib32" title="">2022a</a>)</cite> proposed to develop a privacy-preserving synthetic dataset. GTN <cite class="ltx_cite ltx_citemacro_citep">(Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib5" title="">2022</a>)</cite> generated adaptive graph data for graph collaborative filtering. For sequential recommendation, ASReP <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib35" title="">2021</a>)</cite> and METL <cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib22" title="">2023</a>)</cite> focused on generating fabricated data for long-tailed sequences. Another promising technique in DCAI is Dataset Distillation (DD). DD aims to distill a condensed dataset from the original dataset, enabling trained models to attain comparable performance<cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib70" title="">2024a</a>)</cite>. DD is predominantly popular in the field of computer vision (CV) and can be categorized into three main classes: performance matching<cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib52" title="">2018</a>)</cite>, parameter matching<cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib78" title="">2021a</a>)</cite>, and distribution matching<cite class="ltx_cite ltx_citemacro_citep">(Zhao and Bilen, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib77" title="">2023</a>)</cite>. Specifically, DD has been introduced to the field of recommender systems by some pioneer works<cite class="ltx_cite ltx_citemacro_citep">(Sachdeva et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib41" title="">2022</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib55" title="">2023a</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib47" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib56" title="">2023b</a>; Sachdeva et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib42" title="">2023</a>)</cite>. <math alttext="\infty" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS2.p2.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><infinity id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">∞</annotation></semantics></math>-AE<cite class="ltx_cite ltx_citemacro_citep">(Sachdeva et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib41" title="">2022</a>)</cite> adopted neural tangent kernel (NTK) to approximate an infinitely wide autoencoder and synthesized fake users with sampling-based reconstruction. DConRec<cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib55" title="">2023a</a>)</cite> proposed to distill a synthesized dataset by sampling user-item pairs from a learnable probabilistic matrix. Farzi <cite class="ltx_cite ltx_citemacro_citep">(Sachdeva et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib42" title="">2023</a>)</cite> achieved efficient sequential data distillation within the latent space. Different from the previous two performance matching methods, CGM<cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib47" title="">2023</a>)</cite> followed a parameter matching<cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib79" title="">2021b</a>)</cite> paradigm to condense categorical recommendation data in the CTR scenario.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">While these methods have achieved remarkable success, they diverge from our specific objectives. Our goal is to utilize the generated dataset to enhance performance, whereas these methods primarily prioritize privacy or efficiency concerns.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>PROBLEM DEFINITION</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In the domain of sequential recommendation, the primary objective is to model user preferences based on their interaction records and provide the next recommended item for them. We can formally define the problem as follows:</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.13"><span class="ltx_text ltx_font_bold" id="S3.p2.13.14">Definition1</span>. <span class="ltx_text ltx_font_italic" id="S3.p2.13.13">(<span class="ltx_text ltx_font_bold" id="S3.p2.13.13.1">Sequential Recommendation</span>). In a sequential recommendation system, we denote <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.p2.1.1.m1.1"><semantics id="S3.p2.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.1.m1.1.1" xref="S3.p2.1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.1.m1.1b"><ci id="S3.p2.1.1.m1.1.1.cmml" xref="S3.p2.1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.1.m1.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.1.m1.1d">caligraphic_U</annotation></semantics></math> as the user set and <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.p2.2.2.m2.1"><semantics id="S3.p2.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.2.m2.1.1" xref="S3.p2.2.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.2.m2.1b"><ci id="S3.p2.2.2.m2.1.1.cmml" xref="S3.p2.2.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.2.m2.1d">caligraphic_V</annotation></semantics></math> as the item set, and <math alttext="|\mathcal{U}|" class="ltx_Math" display="inline" id="S3.p2.3.3.m3.1"><semantics id="S3.p2.3.3.m3.1a"><mrow id="S3.p2.3.3.m3.1.2.2" xref="S3.p2.3.3.m3.1.2.1.cmml"><mo id="S3.p2.3.3.m3.1.2.2.1" stretchy="false" xref="S3.p2.3.3.m3.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.3.m3.1.1" xref="S3.p2.3.3.m3.1.1.cmml">𝒰</mi><mo id="S3.p2.3.3.m3.1.2.2.2" stretchy="false" xref="S3.p2.3.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.3.m3.1b"><apply id="S3.p2.3.3.m3.1.2.1.cmml" xref="S3.p2.3.3.m3.1.2.2"><abs id="S3.p2.3.3.m3.1.2.1.1.cmml" xref="S3.p2.3.3.m3.1.2.2.1"></abs><ci id="S3.p2.3.3.m3.1.1.cmml" xref="S3.p2.3.3.m3.1.1">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.3.m3.1c">|\mathcal{U}|</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.3.m3.1d">| caligraphic_U |</annotation></semantics></math> and <math alttext="|\mathcal{V}|" class="ltx_Math" display="inline" id="S3.p2.4.4.m4.1"><semantics id="S3.p2.4.4.m4.1a"><mrow id="S3.p2.4.4.m4.1.2.2" xref="S3.p2.4.4.m4.1.2.1.cmml"><mo id="S3.p2.4.4.m4.1.2.2.1" stretchy="false" xref="S3.p2.4.4.m4.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.4.m4.1.1" xref="S3.p2.4.4.m4.1.1.cmml">𝒱</mi><mo id="S3.p2.4.4.m4.1.2.2.2" stretchy="false" xref="S3.p2.4.4.m4.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.4.m4.1b"><apply id="S3.p2.4.4.m4.1.2.1.cmml" xref="S3.p2.4.4.m4.1.2.2"><abs id="S3.p2.4.4.m4.1.2.1.1.cmml" xref="S3.p2.4.4.m4.1.2.2.1"></abs><ci id="S3.p2.4.4.m4.1.1.cmml" xref="S3.p2.4.4.m4.1.1">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.4.m4.1c">|\mathcal{V}|</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.4.m4.1d">| caligraphic_V |</annotation></semantics></math> is the respective number of users and items. The interaction sequences of users are ordered chronologically. We define them as <math alttext="s_{u}=[v_{1},v_{2},\dots,v_{t},\dots,v_{|s_{u}|}]" class="ltx_Math" display="inline" id="S3.p2.5.5.m5.7"><semantics id="S3.p2.5.5.m5.7a"><mrow id="S3.p2.5.5.m5.7.7" xref="S3.p2.5.5.m5.7.7.cmml"><msub id="S3.p2.5.5.m5.7.7.6" xref="S3.p2.5.5.m5.7.7.6.cmml"><mi id="S3.p2.5.5.m5.7.7.6.2" xref="S3.p2.5.5.m5.7.7.6.2.cmml">s</mi><mi id="S3.p2.5.5.m5.7.7.6.3" xref="S3.p2.5.5.m5.7.7.6.3.cmml">u</mi></msub><mo id="S3.p2.5.5.m5.7.7.5" xref="S3.p2.5.5.m5.7.7.5.cmml">=</mo><mrow id="S3.p2.5.5.m5.7.7.4.4" xref="S3.p2.5.5.m5.7.7.4.5.cmml"><mo id="S3.p2.5.5.m5.7.7.4.4.5" stretchy="false" xref="S3.p2.5.5.m5.7.7.4.5.cmml">[</mo><msub id="S3.p2.5.5.m5.4.4.1.1.1" xref="S3.p2.5.5.m5.4.4.1.1.1.cmml"><mi id="S3.p2.5.5.m5.4.4.1.1.1.2" xref="S3.p2.5.5.m5.4.4.1.1.1.2.cmml">v</mi><mn id="S3.p2.5.5.m5.4.4.1.1.1.3" xref="S3.p2.5.5.m5.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.5.5.m5.7.7.4.4.6" xref="S3.p2.5.5.m5.7.7.4.5.cmml">,</mo><msub id="S3.p2.5.5.m5.5.5.2.2.2" xref="S3.p2.5.5.m5.5.5.2.2.2.cmml"><mi id="S3.p2.5.5.m5.5.5.2.2.2.2" xref="S3.p2.5.5.m5.5.5.2.2.2.2.cmml">v</mi><mn id="S3.p2.5.5.m5.5.5.2.2.2.3" xref="S3.p2.5.5.m5.5.5.2.2.2.3.cmml">2</mn></msub><mo id="S3.p2.5.5.m5.7.7.4.4.7" xref="S3.p2.5.5.m5.7.7.4.5.cmml">,</mo><mi id="S3.p2.5.5.m5.2.2" mathvariant="normal" xref="S3.p2.5.5.m5.2.2.cmml">…</mi><mo id="S3.p2.5.5.m5.7.7.4.4.8" xref="S3.p2.5.5.m5.7.7.4.5.cmml">,</mo><msub id="S3.p2.5.5.m5.6.6.3.3.3" xref="S3.p2.5.5.m5.6.6.3.3.3.cmml"><mi id="S3.p2.5.5.m5.6.6.3.3.3.2" xref="S3.p2.5.5.m5.6.6.3.3.3.2.cmml">v</mi><mi id="S3.p2.5.5.m5.6.6.3.3.3.3" xref="S3.p2.5.5.m5.6.6.3.3.3.3.cmml">t</mi></msub><mo id="S3.p2.5.5.m5.7.7.4.4.9" xref="S3.p2.5.5.m5.7.7.4.5.cmml">,</mo><mi id="S3.p2.5.5.m5.3.3" mathvariant="normal" xref="S3.p2.5.5.m5.3.3.cmml">…</mi><mo id="S3.p2.5.5.m5.7.7.4.4.10" xref="S3.p2.5.5.m5.7.7.4.5.cmml">,</mo><msub id="S3.p2.5.5.m5.7.7.4.4.4" xref="S3.p2.5.5.m5.7.7.4.4.4.cmml"><mi id="S3.p2.5.5.m5.7.7.4.4.4.2" xref="S3.p2.5.5.m5.7.7.4.4.4.2.cmml">v</mi><mrow id="S3.p2.5.5.m5.1.1.1.1" xref="S3.p2.5.5.m5.1.1.1.2.cmml"><mo id="S3.p2.5.5.m5.1.1.1.1.2" stretchy="false" xref="S3.p2.5.5.m5.1.1.1.2.1.cmml">|</mo><msub id="S3.p2.5.5.m5.1.1.1.1.1" xref="S3.p2.5.5.m5.1.1.1.1.1.cmml"><mi id="S3.p2.5.5.m5.1.1.1.1.1.2" xref="S3.p2.5.5.m5.1.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.5.5.m5.1.1.1.1.1.3" xref="S3.p2.5.5.m5.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.p2.5.5.m5.1.1.1.1.3" stretchy="false" xref="S3.p2.5.5.m5.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.p2.5.5.m5.7.7.4.4.11" stretchy="false" xref="S3.p2.5.5.m5.7.7.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.5.m5.7b"><apply id="S3.p2.5.5.m5.7.7.cmml" xref="S3.p2.5.5.m5.7.7"><eq id="S3.p2.5.5.m5.7.7.5.cmml" xref="S3.p2.5.5.m5.7.7.5"></eq><apply id="S3.p2.5.5.m5.7.7.6.cmml" xref="S3.p2.5.5.m5.7.7.6"><csymbol cd="ambiguous" id="S3.p2.5.5.m5.7.7.6.1.cmml" xref="S3.p2.5.5.m5.7.7.6">subscript</csymbol><ci id="S3.p2.5.5.m5.7.7.6.2.cmml" xref="S3.p2.5.5.m5.7.7.6.2">𝑠</ci><ci id="S3.p2.5.5.m5.7.7.6.3.cmml" xref="S3.p2.5.5.m5.7.7.6.3">𝑢</ci></apply><list id="S3.p2.5.5.m5.7.7.4.5.cmml" xref="S3.p2.5.5.m5.7.7.4.4"><apply id="S3.p2.5.5.m5.4.4.1.1.1.cmml" xref="S3.p2.5.5.m5.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.p2.5.5.m5.4.4.1.1.1.1.cmml" xref="S3.p2.5.5.m5.4.4.1.1.1">subscript</csymbol><ci id="S3.p2.5.5.m5.4.4.1.1.1.2.cmml" xref="S3.p2.5.5.m5.4.4.1.1.1.2">𝑣</ci><cn id="S3.p2.5.5.m5.4.4.1.1.1.3.cmml" type="integer" xref="S3.p2.5.5.m5.4.4.1.1.1.3">1</cn></apply><apply id="S3.p2.5.5.m5.5.5.2.2.2.cmml" xref="S3.p2.5.5.m5.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.p2.5.5.m5.5.5.2.2.2.1.cmml" xref="S3.p2.5.5.m5.5.5.2.2.2">subscript</csymbol><ci id="S3.p2.5.5.m5.5.5.2.2.2.2.cmml" xref="S3.p2.5.5.m5.5.5.2.2.2.2">𝑣</ci><cn id="S3.p2.5.5.m5.5.5.2.2.2.3.cmml" type="integer" xref="S3.p2.5.5.m5.5.5.2.2.2.3">2</cn></apply><ci id="S3.p2.5.5.m5.2.2.cmml" xref="S3.p2.5.5.m5.2.2">…</ci><apply id="S3.p2.5.5.m5.6.6.3.3.3.cmml" xref="S3.p2.5.5.m5.6.6.3.3.3"><csymbol cd="ambiguous" id="S3.p2.5.5.m5.6.6.3.3.3.1.cmml" xref="S3.p2.5.5.m5.6.6.3.3.3">subscript</csymbol><ci id="S3.p2.5.5.m5.6.6.3.3.3.2.cmml" xref="S3.p2.5.5.m5.6.6.3.3.3.2">𝑣</ci><ci id="S3.p2.5.5.m5.6.6.3.3.3.3.cmml" xref="S3.p2.5.5.m5.6.6.3.3.3.3">𝑡</ci></apply><ci id="S3.p2.5.5.m5.3.3.cmml" xref="S3.p2.5.5.m5.3.3">…</ci><apply id="S3.p2.5.5.m5.7.7.4.4.4.cmml" xref="S3.p2.5.5.m5.7.7.4.4.4"><csymbol cd="ambiguous" id="S3.p2.5.5.m5.7.7.4.4.4.1.cmml" xref="S3.p2.5.5.m5.7.7.4.4.4">subscript</csymbol><ci id="S3.p2.5.5.m5.7.7.4.4.4.2.cmml" xref="S3.p2.5.5.m5.7.7.4.4.4.2">𝑣</ci><apply id="S3.p2.5.5.m5.1.1.1.2.cmml" xref="S3.p2.5.5.m5.1.1.1.1"><abs id="S3.p2.5.5.m5.1.1.1.2.1.cmml" xref="S3.p2.5.5.m5.1.1.1.1.2"></abs><apply id="S3.p2.5.5.m5.1.1.1.1.1.cmml" xref="S3.p2.5.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.5.5.m5.1.1.1.1.1.1.cmml" xref="S3.p2.5.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.5.5.m5.1.1.1.1.1.2.cmml" xref="S3.p2.5.5.m5.1.1.1.1.1.2">𝑠</ci><ci id="S3.p2.5.5.m5.1.1.1.1.1.3.cmml" xref="S3.p2.5.5.m5.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.5.m5.7c">s_{u}=[v_{1},v_{2},\dots,v_{t},\dots,v_{|s_{u}|}]</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.5.m5.7d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S3.p2.6.6.m6.1"><semantics id="S3.p2.6.6.m6.1a"><mrow id="S3.p2.6.6.m6.1.1" xref="S3.p2.6.6.m6.1.1.cmml"><mi id="S3.p2.6.6.m6.1.1.2" xref="S3.p2.6.6.m6.1.1.2.cmml">u</mi><mo id="S3.p2.6.6.m6.1.1.1" xref="S3.p2.6.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.6.m6.1.1.3" xref="S3.p2.6.6.m6.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.6.m6.1b"><apply id="S3.p2.6.6.m6.1.1.cmml" xref="S3.p2.6.6.m6.1.1"><in id="S3.p2.6.6.m6.1.1.1.cmml" xref="S3.p2.6.6.m6.1.1.1"></in><ci id="S3.p2.6.6.m6.1.1.2.cmml" xref="S3.p2.6.6.m6.1.1.2">𝑢</ci><ci id="S3.p2.6.6.m6.1.1.3.cmml" xref="S3.p2.6.6.m6.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.6.m6.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.6.m6.1d">italic_u ∈ caligraphic_U</annotation></semantics></math> is some user, <math alttext="v_{t}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.p2.7.7.m7.1"><semantics id="S3.p2.7.7.m7.1a"><mrow id="S3.p2.7.7.m7.1.1" xref="S3.p2.7.7.m7.1.1.cmml"><msub id="S3.p2.7.7.m7.1.1.2" xref="S3.p2.7.7.m7.1.1.2.cmml"><mi id="S3.p2.7.7.m7.1.1.2.2" xref="S3.p2.7.7.m7.1.1.2.2.cmml">v</mi><mi id="S3.p2.7.7.m7.1.1.2.3" xref="S3.p2.7.7.m7.1.1.2.3.cmml">t</mi></msub><mo id="S3.p2.7.7.m7.1.1.1" xref="S3.p2.7.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.7.7.m7.1.1.3" xref="S3.p2.7.7.m7.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.7.7.m7.1b"><apply id="S3.p2.7.7.m7.1.1.cmml" xref="S3.p2.7.7.m7.1.1"><in id="S3.p2.7.7.m7.1.1.1.cmml" xref="S3.p2.7.7.m7.1.1.1"></in><apply id="S3.p2.7.7.m7.1.1.2.cmml" xref="S3.p2.7.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p2.7.7.m7.1.1.2.1.cmml" xref="S3.p2.7.7.m7.1.1.2">subscript</csymbol><ci id="S3.p2.7.7.m7.1.1.2.2.cmml" xref="S3.p2.7.7.m7.1.1.2.2">𝑣</ci><ci id="S3.p2.7.7.m7.1.1.2.3.cmml" xref="S3.p2.7.7.m7.1.1.2.3">𝑡</ci></apply><ci id="S3.p2.7.7.m7.1.1.3.cmml" xref="S3.p2.7.7.m7.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.7.m7.1c">v_{t}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math> is one item interacted by the user at the time step <math alttext="t" class="ltx_Math" display="inline" id="S3.p2.8.8.m8.1"><semantics id="S3.p2.8.8.m8.1a"><mi id="S3.p2.8.8.m8.1.1" xref="S3.p2.8.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p2.8.8.m8.1b"><ci id="S3.p2.8.8.m8.1.1.cmml" xref="S3.p2.8.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.8.m8.1d">italic_t</annotation></semantics></math>, <math alttext="s_{u}" class="ltx_Math" display="inline" id="S3.p2.9.9.m9.1"><semantics id="S3.p2.9.9.m9.1a"><msub id="S3.p2.9.9.m9.1.1" xref="S3.p2.9.9.m9.1.1.cmml"><mi id="S3.p2.9.9.m9.1.1.2" xref="S3.p2.9.9.m9.1.1.2.cmml">s</mi><mi id="S3.p2.9.9.m9.1.1.3" xref="S3.p2.9.9.m9.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.9.m9.1b"><apply id="S3.p2.9.9.m9.1.1.cmml" xref="S3.p2.9.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.9.9.m9.1.1.1.cmml" xref="S3.p2.9.9.m9.1.1">subscript</csymbol><ci id="S3.p2.9.9.m9.1.1.2.cmml" xref="S3.p2.9.9.m9.1.1.2">𝑠</ci><ci id="S3.p2.9.9.m9.1.1.3.cmml" xref="S3.p2.9.9.m9.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.9.m9.1c">s_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.9.m9.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> represents the sequence, and <math alttext="|s_{u}|" class="ltx_Math" display="inline" id="S3.p2.10.10.m10.1"><semantics id="S3.p2.10.10.m10.1a"><mrow id="S3.p2.10.10.m10.1.1.1" xref="S3.p2.10.10.m10.1.1.2.cmml"><mo id="S3.p2.10.10.m10.1.1.1.2" stretchy="false" xref="S3.p2.10.10.m10.1.1.2.1.cmml">|</mo><msub id="S3.p2.10.10.m10.1.1.1.1" xref="S3.p2.10.10.m10.1.1.1.1.cmml"><mi id="S3.p2.10.10.m10.1.1.1.1.2" xref="S3.p2.10.10.m10.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.10.10.m10.1.1.1.1.3" xref="S3.p2.10.10.m10.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.p2.10.10.m10.1.1.1.3" stretchy="false" xref="S3.p2.10.10.m10.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.10.10.m10.1b"><apply id="S3.p2.10.10.m10.1.1.2.cmml" xref="S3.p2.10.10.m10.1.1.1"><abs id="S3.p2.10.10.m10.1.1.2.1.cmml" xref="S3.p2.10.10.m10.1.1.1.2"></abs><apply id="S3.p2.10.10.m10.1.1.1.1.cmml" xref="S3.p2.10.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.10.m10.1.1.1.1.1.cmml" xref="S3.p2.10.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.p2.10.10.m10.1.1.1.1.2.cmml" xref="S3.p2.10.10.m10.1.1.1.1.2">𝑠</ci><ci id="S3.p2.10.10.m10.1.1.1.1.3.cmml" xref="S3.p2.10.10.m10.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.10.m10.1c">|s_{u}|</annotation><annotation encoding="application/x-llamapun" id="S3.p2.10.10.m10.1d">| italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT |</annotation></semantics></math> denotes its length, which has a maximum value of <math alttext="N" class="ltx_Math" display="inline" id="S3.p2.11.11.m11.1"><semantics id="S3.p2.11.11.m11.1a"><mi id="S3.p2.11.11.m11.1.1" xref="S3.p2.11.11.m11.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.11.11.m11.1b"><ci id="S3.p2.11.11.m11.1.1.cmml" xref="S3.p2.11.11.m11.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.11.m11.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p2.11.11.m11.1d">italic_N</annotation></semantics></math>. Then the next item prediction task aims to predict the item at the next time step <math alttext="v_{|s_{u}|+1}" class="ltx_Math" display="inline" id="S3.p2.12.12.m12.1"><semantics id="S3.p2.12.12.m12.1a"><msub id="S3.p2.12.12.m12.1.2" xref="S3.p2.12.12.m12.1.2.cmml"><mi id="S3.p2.12.12.m12.1.2.2" xref="S3.p2.12.12.m12.1.2.2.cmml">v</mi><mrow id="S3.p2.12.12.m12.1.1.1" xref="S3.p2.12.12.m12.1.1.1.cmml"><mrow id="S3.p2.12.12.m12.1.1.1.1.1" xref="S3.p2.12.12.m12.1.1.1.1.2.cmml"><mo id="S3.p2.12.12.m12.1.1.1.1.1.2" stretchy="false" xref="S3.p2.12.12.m12.1.1.1.1.2.1.cmml">|</mo><msub id="S3.p2.12.12.m12.1.1.1.1.1.1" xref="S3.p2.12.12.m12.1.1.1.1.1.1.cmml"><mi id="S3.p2.12.12.m12.1.1.1.1.1.1.2" xref="S3.p2.12.12.m12.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.12.12.m12.1.1.1.1.1.1.3" xref="S3.p2.12.12.m12.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.p2.12.12.m12.1.1.1.1.1.3" stretchy="false" xref="S3.p2.12.12.m12.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.p2.12.12.m12.1.1.1.2" xref="S3.p2.12.12.m12.1.1.1.2.cmml">+</mo><mn id="S3.p2.12.12.m12.1.1.1.3" xref="S3.p2.12.12.m12.1.1.1.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.12.12.m12.1b"><apply id="S3.p2.12.12.m12.1.2.cmml" xref="S3.p2.12.12.m12.1.2"><csymbol cd="ambiguous" id="S3.p2.12.12.m12.1.2.1.cmml" xref="S3.p2.12.12.m12.1.2">subscript</csymbol><ci id="S3.p2.12.12.m12.1.2.2.cmml" xref="S3.p2.12.12.m12.1.2.2">𝑣</ci><apply id="S3.p2.12.12.m12.1.1.1.cmml" xref="S3.p2.12.12.m12.1.1.1"><plus id="S3.p2.12.12.m12.1.1.1.2.cmml" xref="S3.p2.12.12.m12.1.1.1.2"></plus><apply id="S3.p2.12.12.m12.1.1.1.1.2.cmml" xref="S3.p2.12.12.m12.1.1.1.1.1"><abs id="S3.p2.12.12.m12.1.1.1.1.2.1.cmml" xref="S3.p2.12.12.m12.1.1.1.1.1.2"></abs><apply id="S3.p2.12.12.m12.1.1.1.1.1.1.cmml" xref="S3.p2.12.12.m12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.12.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.p2.12.12.m12.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.12.12.m12.1.1.1.1.1.1.2.cmml" xref="S3.p2.12.12.m12.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.p2.12.12.m12.1.1.1.1.1.1.3.cmml" xref="S3.p2.12.12.m12.1.1.1.1.1.1.3">𝑢</ci></apply></apply><cn id="S3.p2.12.12.m12.1.1.1.3.cmml" type="integer" xref="S3.p2.12.12.m12.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.12.m12.1c">v_{|s_{u}|+1}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.12.12.m12.1d">italic_v start_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | + 1 end_POSTSUBSCRIPT</annotation></semantics></math> for each user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S3.p2.13.13.m13.1"><semantics id="S3.p2.13.13.m13.1a"><mrow id="S3.p2.13.13.m13.1.1" xref="S3.p2.13.13.m13.1.1.cmml"><mi id="S3.p2.13.13.m13.1.1.2" xref="S3.p2.13.13.m13.1.1.2.cmml">u</mi><mo id="S3.p2.13.13.m13.1.1.1" xref="S3.p2.13.13.m13.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.13.13.m13.1.1.3" xref="S3.p2.13.13.m13.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.13.13.m13.1b"><apply id="S3.p2.13.13.m13.1.1.cmml" xref="S3.p2.13.13.m13.1.1"><in id="S3.p2.13.13.m13.1.1.1.cmml" xref="S3.p2.13.13.m13.1.1.1"></in><ci id="S3.p2.13.13.m13.1.1.2.cmml" xref="S3.p2.13.13.m13.1.1.2">𝑢</ci><ci id="S3.p2.13.13.m13.1.1.3.cmml" xref="S3.p2.13.13.m13.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.13.m13.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.13.13.m13.1d">italic_u ∈ caligraphic_U</annotation></semantics></math>.</span></p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">In deviating from conventional model-centric approaches, which concentrate on enhancing recommendation performance with fixed datasets, we endeavor to construct an optimal training dataset from a data-centric perspective, which is formalized as a training data development problem as follows:</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.9"><span class="ltx_text ltx_font_bold" id="S3.p4.9.10">Definition2</span>. <span class="ltx_text ltx_font_italic" id="S3.p4.9.9">(<span class="ltx_text ltx_font_bold" id="S3.p4.9.9.1">Training Data Development</span>). Given an original dataset <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.p4.1.1.m1.1"><semantics id="S3.p4.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.1.m1.1.1" xref="S3.p4.1.1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.1.m1.1b"><ci id="S3.p4.1.1.m1.1.1.cmml" xref="S3.p4.1.1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.1.m1.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.1.m1.1d">caligraphic_X</annotation></semantics></math>, traditional methods aim to learn a target model <math alttext="f^{\prime}" class="ltx_Math" display="inline" id="S3.p4.2.2.m2.1"><semantics id="S3.p4.2.2.m2.1a"><msup id="S3.p4.2.2.m2.1.1" xref="S3.p4.2.2.m2.1.1.cmml"><mi id="S3.p4.2.2.m2.1.1.2" xref="S3.p4.2.2.m2.1.1.2.cmml">f</mi><mo id="S3.p4.2.2.m2.1.1.3" xref="S3.p4.2.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p4.2.2.m2.1b"><apply id="S3.p4.2.2.m2.1.1.cmml" xref="S3.p4.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.2.m2.1.1.1.cmml" xref="S3.p4.2.2.m2.1.1">superscript</csymbol><ci id="S3.p4.2.2.m2.1.1.2.cmml" xref="S3.p4.2.2.m2.1.1.2">𝑓</ci><ci id="S3.p4.2.2.m2.1.1.3.cmml" xref="S3.p4.2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.2.m2.1c">f^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.2.m2.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> satisfying <math alttext="\mathcal{Y}=f^{\prime}(\mathcal{X})" class="ltx_Math" display="inline" id="S3.p4.3.3.m3.1"><semantics id="S3.p4.3.3.m3.1a"><mrow id="S3.p4.3.3.m3.1.2" xref="S3.p4.3.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.3.3.m3.1.2.2" xref="S3.p4.3.3.m3.1.2.2.cmml">𝒴</mi><mo id="S3.p4.3.3.m3.1.2.1" xref="S3.p4.3.3.m3.1.2.1.cmml">=</mo><mrow id="S3.p4.3.3.m3.1.2.3" xref="S3.p4.3.3.m3.1.2.3.cmml"><msup id="S3.p4.3.3.m3.1.2.3.2" xref="S3.p4.3.3.m3.1.2.3.2.cmml"><mi id="S3.p4.3.3.m3.1.2.3.2.2" xref="S3.p4.3.3.m3.1.2.3.2.2.cmml">f</mi><mo id="S3.p4.3.3.m3.1.2.3.2.3" xref="S3.p4.3.3.m3.1.2.3.2.3.cmml">′</mo></msup><mo id="S3.p4.3.3.m3.1.2.3.1" xref="S3.p4.3.3.m3.1.2.3.1.cmml">⁢</mo><mrow id="S3.p4.3.3.m3.1.2.3.3.2" xref="S3.p4.3.3.m3.1.2.3.cmml"><mo id="S3.p4.3.3.m3.1.2.3.3.2.1" stretchy="false" xref="S3.p4.3.3.m3.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p4.3.3.m3.1.1" xref="S3.p4.3.3.m3.1.1.cmml">𝒳</mi><mo id="S3.p4.3.3.m3.1.2.3.3.2.2" stretchy="false" xref="S3.p4.3.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.3.3.m3.1b"><apply id="S3.p4.3.3.m3.1.2.cmml" xref="S3.p4.3.3.m3.1.2"><eq id="S3.p4.3.3.m3.1.2.1.cmml" xref="S3.p4.3.3.m3.1.2.1"></eq><ci id="S3.p4.3.3.m3.1.2.2.cmml" xref="S3.p4.3.3.m3.1.2.2">𝒴</ci><apply id="S3.p4.3.3.m3.1.2.3.cmml" xref="S3.p4.3.3.m3.1.2.3"><times id="S3.p4.3.3.m3.1.2.3.1.cmml" xref="S3.p4.3.3.m3.1.2.3.1"></times><apply id="S3.p4.3.3.m3.1.2.3.2.cmml" xref="S3.p4.3.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="S3.p4.3.3.m3.1.2.3.2.1.cmml" xref="S3.p4.3.3.m3.1.2.3.2">superscript</csymbol><ci id="S3.p4.3.3.m3.1.2.3.2.2.cmml" xref="S3.p4.3.3.m3.1.2.3.2.2">𝑓</ci><ci id="S3.p4.3.3.m3.1.2.3.2.3.cmml" xref="S3.p4.3.3.m3.1.2.3.2.3">′</ci></apply><ci id="S3.p4.3.3.m3.1.1.cmml" xref="S3.p4.3.3.m3.1.1">𝒳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.3.m3.1c">\mathcal{Y}=f^{\prime}(\mathcal{X})</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.3.m3.1d">caligraphic_Y = italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( caligraphic_X )</annotation></semantics></math>, where <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S3.p4.4.4.m4.1"><semantics id="S3.p4.4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p4.4.4.m4.1.1" xref="S3.p4.4.4.m4.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.p4.4.4.m4.1b"><ci id="S3.p4.4.4.m4.1.1.cmml" xref="S3.p4.4.4.m4.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.4.m4.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.4.m4.1d">caligraphic_Y</annotation></semantics></math> is the user preferences. Training data development aims to learn a new informative and generalizable dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S3.p4.5.5.m5.1"><semantics id="S3.p4.5.5.m5.1a"><msup id="S3.p4.5.5.m5.1.1" xref="S3.p4.5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.5.5.m5.1.1.2" xref="S3.p4.5.5.m5.1.1.2.cmml">𝒳</mi><mo id="S3.p4.5.5.m5.1.1.3" xref="S3.p4.5.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p4.5.5.m5.1b"><apply id="S3.p4.5.5.m5.1.1.cmml" xref="S3.p4.5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.5.m5.1.1.1.cmml" xref="S3.p4.5.5.m5.1.1">superscript</csymbol><ci id="S3.p4.5.5.m5.1.1.2.cmml" xref="S3.p4.5.5.m5.1.1.2">𝒳</ci><ci id="S3.p4.5.5.m5.1.1.3.cmml" xref="S3.p4.5.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.5.m5.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.5.5.m5.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> satisfying <math alttext="\mathcal{Y}=f(\mathcal{X}^{\prime})" class="ltx_Math" display="inline" id="S3.p4.6.6.m6.1"><semantics id="S3.p4.6.6.m6.1a"><mrow id="S3.p4.6.6.m6.1.1" xref="S3.p4.6.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.6.6.m6.1.1.3" xref="S3.p4.6.6.m6.1.1.3.cmml">𝒴</mi><mo id="S3.p4.6.6.m6.1.1.2" xref="S3.p4.6.6.m6.1.1.2.cmml">=</mo><mrow id="S3.p4.6.6.m6.1.1.1" xref="S3.p4.6.6.m6.1.1.1.cmml"><mi id="S3.p4.6.6.m6.1.1.1.3" xref="S3.p4.6.6.m6.1.1.1.3.cmml">f</mi><mo id="S3.p4.6.6.m6.1.1.1.2" xref="S3.p4.6.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S3.p4.6.6.m6.1.1.1.1.1" xref="S3.p4.6.6.m6.1.1.1.1.1.1.cmml"><mo id="S3.p4.6.6.m6.1.1.1.1.1.2" stretchy="false" xref="S3.p4.6.6.m6.1.1.1.1.1.1.cmml">(</mo><msup id="S3.p4.6.6.m6.1.1.1.1.1.1" xref="S3.p4.6.6.m6.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.6.6.m6.1.1.1.1.1.1.2" xref="S3.p4.6.6.m6.1.1.1.1.1.1.2.cmml">𝒳</mi><mo id="S3.p4.6.6.m6.1.1.1.1.1.1.3" xref="S3.p4.6.6.m6.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.p4.6.6.m6.1.1.1.1.1.3" stretchy="false" xref="S3.p4.6.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.6.6.m6.1b"><apply id="S3.p4.6.6.m6.1.1.cmml" xref="S3.p4.6.6.m6.1.1"><eq id="S3.p4.6.6.m6.1.1.2.cmml" xref="S3.p4.6.6.m6.1.1.2"></eq><ci id="S3.p4.6.6.m6.1.1.3.cmml" xref="S3.p4.6.6.m6.1.1.3">𝒴</ci><apply id="S3.p4.6.6.m6.1.1.1.cmml" xref="S3.p4.6.6.m6.1.1.1"><times id="S3.p4.6.6.m6.1.1.1.2.cmml" xref="S3.p4.6.6.m6.1.1.1.2"></times><ci id="S3.p4.6.6.m6.1.1.1.3.cmml" xref="S3.p4.6.6.m6.1.1.1.3">𝑓</ci><apply id="S3.p4.6.6.m6.1.1.1.1.1.1.cmml" xref="S3.p4.6.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.6.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.p4.6.6.m6.1.1.1.1.1">superscript</csymbol><ci id="S3.p4.6.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.p4.6.6.m6.1.1.1.1.1.1.2">𝒳</ci><ci id="S3.p4.6.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.p4.6.6.m6.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.6.m6.1c">\mathcal{Y}=f(\mathcal{X}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.p4.6.6.m6.1d">caligraphic_Y = italic_f ( caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, where the target model <math alttext="f" class="ltx_Math" display="inline" id="S3.p4.7.7.m7.1"><semantics id="S3.p4.7.7.m7.1a"><mi id="S3.p4.7.7.m7.1.1" xref="S3.p4.7.7.m7.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p4.7.7.m7.1b"><ci id="S3.p4.7.7.m7.1.1.cmml" xref="S3.p4.7.7.m7.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.7.m7.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.p4.7.7.m7.1d">italic_f</annotation></semantics></math> can be easier to learn than <math alttext="f^{\prime}" class="ltx_Math" display="inline" id="S3.p4.8.8.m8.1"><semantics id="S3.p4.8.8.m8.1a"><msup id="S3.p4.8.8.m8.1.1" xref="S3.p4.8.8.m8.1.1.cmml"><mi id="S3.p4.8.8.m8.1.1.2" xref="S3.p4.8.8.m8.1.1.2.cmml">f</mi><mo id="S3.p4.8.8.m8.1.1.3" xref="S3.p4.8.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p4.8.8.m8.1b"><apply id="S3.p4.8.8.m8.1.1.cmml" xref="S3.p4.8.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.8.8.m8.1.1.1.cmml" xref="S3.p4.8.8.m8.1.1">superscript</csymbol><ci id="S3.p4.8.8.m8.1.1.2.cmml" xref="S3.p4.8.8.m8.1.1.2">𝑓</ci><ci id="S3.p4.8.8.m8.1.1.3.cmml" xref="S3.p4.8.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.8.m8.1c">f^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.8.8.m8.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> based on <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S3.p4.9.9.m9.1"><semantics id="S3.p4.9.9.m9.1a"><msup id="S3.p4.9.9.m9.1.1" xref="S3.p4.9.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.9.9.m9.1.1.2" xref="S3.p4.9.9.m9.1.1.2.cmml">𝒳</mi><mo id="S3.p4.9.9.m9.1.1.3" xref="S3.p4.9.9.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p4.9.9.m9.1b"><apply id="S3.p4.9.9.m9.1.1.cmml" xref="S3.p4.9.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p4.9.9.m9.1.1.1.cmml" xref="S3.p4.9.9.m9.1.1">superscript</csymbol><ci id="S3.p4.9.9.m9.1.1.2.cmml" xref="S3.p4.9.9.m9.1.1.2">𝒳</ci><ci id="S3.p4.9.9.m9.1.1.3.cmml" xref="S3.p4.9.9.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.9.m9.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.9.9.m9.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.1">Then the next crucial issue is how to guarantee an optimal <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><msup id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m1.1.1.2" xref="S3.p5.1.m1.1.1.2.cmml">𝒳</mi><mo id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">superscript</csymbol><ci id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1.2">𝒳</ci><ci id="S3.p5.1.m1.1.1.3.cmml" xref="S3.p5.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. We aim to accomplish this through a model-agnostic dataset regeneration paradigm, which is explained in detail below:</p>
</div>
<div class="ltx_para" id="S3.p6">
<p class="ltx_p" id="S3.p6.8"><span class="ltx_text ltx_font_bold" id="S3.p6.8.9">Definition3</span>. <span class="ltx_text ltx_font_italic" id="S3.p6.8.8">(<span class="ltx_text ltx_font_bold" id="S3.p6.8.8.1">Dataset Regeneration</span>). Given a sequence <math alttext="s_{u}" class="ltx_Math" display="inline" id="S3.p6.1.1.m1.1"><semantics id="S3.p6.1.1.m1.1a"><msub id="S3.p6.1.1.m1.1.1" xref="S3.p6.1.1.m1.1.1.cmml"><mi id="S3.p6.1.1.m1.1.1.2" xref="S3.p6.1.1.m1.1.1.2.cmml">s</mi><mi id="S3.p6.1.1.m1.1.1.3" xref="S3.p6.1.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.1.1.m1.1b"><apply id="S3.p6.1.1.m1.1.1.cmml" xref="S3.p6.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p6.1.1.m1.1.1.1.cmml" xref="S3.p6.1.1.m1.1.1">subscript</csymbol><ci id="S3.p6.1.1.m1.1.1.2.cmml" xref="S3.p6.1.1.m1.1.1.2">𝑠</ci><ci id="S3.p6.1.1.m1.1.1.3.cmml" xref="S3.p6.1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.1.m1.1c">s_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.p6.2.2.m2.1"><semantics id="S3.p6.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p6.2.2.m2.1.1" xref="S3.p6.2.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.p6.2.2.m2.1b"><ci id="S3.p6.2.2.m2.1.1.cmml" xref="S3.p6.2.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.2.2.m2.1d">caligraphic_X</annotation></semantics></math>, dataset regeneration aims to learn a one-to-many dataset regenerator <math alttext="f^{\prime}" class="ltx_Math" display="inline" id="S3.p6.3.3.m3.1"><semantics id="S3.p6.3.3.m3.1a"><msup id="S3.p6.3.3.m3.1.1" xref="S3.p6.3.3.m3.1.1.cmml"><mi id="S3.p6.3.3.m3.1.1.2" xref="S3.p6.3.3.m3.1.1.2.cmml">f</mi><mo id="S3.p6.3.3.m3.1.1.3" xref="S3.p6.3.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p6.3.3.m3.1b"><apply id="S3.p6.3.3.m3.1.1.cmml" xref="S3.p6.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p6.3.3.m3.1.1.1.cmml" xref="S3.p6.3.3.m3.1.1">superscript</csymbol><ci id="S3.p6.3.3.m3.1.1.2.cmml" xref="S3.p6.3.3.m3.1.1.2">𝑓</ci><ci id="S3.p6.3.3.m3.1.1.3.cmml" xref="S3.p6.3.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.3.3.m3.1c">f^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.3.3.m3.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> satisfying <math alttext="\{p_{u1},p_{u2},\dots,p_{uK}\}=f^{\prime}(s_{u})" class="ltx_Math" display="inline" id="S3.p6.4.4.m4.5"><semantics id="S3.p6.4.4.m4.5a"><mrow id="S3.p6.4.4.m4.5.5" xref="S3.p6.4.4.m4.5.5.cmml"><mrow id="S3.p6.4.4.m4.4.4.3.3" xref="S3.p6.4.4.m4.4.4.3.4.cmml"><mo id="S3.p6.4.4.m4.4.4.3.3.4" stretchy="false" xref="S3.p6.4.4.m4.4.4.3.4.cmml">{</mo><msub id="S3.p6.4.4.m4.2.2.1.1.1" xref="S3.p6.4.4.m4.2.2.1.1.1.cmml"><mi id="S3.p6.4.4.m4.2.2.1.1.1.2" xref="S3.p6.4.4.m4.2.2.1.1.1.2.cmml">p</mi><mrow id="S3.p6.4.4.m4.2.2.1.1.1.3" xref="S3.p6.4.4.m4.2.2.1.1.1.3.cmml"><mi id="S3.p6.4.4.m4.2.2.1.1.1.3.2" xref="S3.p6.4.4.m4.2.2.1.1.1.3.2.cmml">u</mi><mo id="S3.p6.4.4.m4.2.2.1.1.1.3.1" xref="S3.p6.4.4.m4.2.2.1.1.1.3.1.cmml">⁢</mo><mn id="S3.p6.4.4.m4.2.2.1.1.1.3.3" xref="S3.p6.4.4.m4.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.p6.4.4.m4.4.4.3.3.5" xref="S3.p6.4.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.p6.4.4.m4.3.3.2.2.2" xref="S3.p6.4.4.m4.3.3.2.2.2.cmml"><mi id="S3.p6.4.4.m4.3.3.2.2.2.2" xref="S3.p6.4.4.m4.3.3.2.2.2.2.cmml">p</mi><mrow id="S3.p6.4.4.m4.3.3.2.2.2.3" xref="S3.p6.4.4.m4.3.3.2.2.2.3.cmml"><mi id="S3.p6.4.4.m4.3.3.2.2.2.3.2" xref="S3.p6.4.4.m4.3.3.2.2.2.3.2.cmml">u</mi><mo id="S3.p6.4.4.m4.3.3.2.2.2.3.1" xref="S3.p6.4.4.m4.3.3.2.2.2.3.1.cmml">⁢</mo><mn id="S3.p6.4.4.m4.3.3.2.2.2.3.3" xref="S3.p6.4.4.m4.3.3.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S3.p6.4.4.m4.4.4.3.3.6" xref="S3.p6.4.4.m4.4.4.3.4.cmml">,</mo><mi id="S3.p6.4.4.m4.1.1" mathvariant="normal" xref="S3.p6.4.4.m4.1.1.cmml">…</mi><mo id="S3.p6.4.4.m4.4.4.3.3.7" xref="S3.p6.4.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.p6.4.4.m4.4.4.3.3.3" xref="S3.p6.4.4.m4.4.4.3.3.3.cmml"><mi id="S3.p6.4.4.m4.4.4.3.3.3.2" xref="S3.p6.4.4.m4.4.4.3.3.3.2.cmml">p</mi><mrow id="S3.p6.4.4.m4.4.4.3.3.3.3" xref="S3.p6.4.4.m4.4.4.3.3.3.3.cmml"><mi id="S3.p6.4.4.m4.4.4.3.3.3.3.2" xref="S3.p6.4.4.m4.4.4.3.3.3.3.2.cmml">u</mi><mo id="S3.p6.4.4.m4.4.4.3.3.3.3.1" xref="S3.p6.4.4.m4.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="S3.p6.4.4.m4.4.4.3.3.3.3.3" xref="S3.p6.4.4.m4.4.4.3.3.3.3.3.cmml">K</mi></mrow></msub><mo id="S3.p6.4.4.m4.4.4.3.3.8" stretchy="false" xref="S3.p6.4.4.m4.4.4.3.4.cmml">}</mo></mrow><mo id="S3.p6.4.4.m4.5.5.5" xref="S3.p6.4.4.m4.5.5.5.cmml">=</mo><mrow id="S3.p6.4.4.m4.5.5.4" xref="S3.p6.4.4.m4.5.5.4.cmml"><msup id="S3.p6.4.4.m4.5.5.4.3" xref="S3.p6.4.4.m4.5.5.4.3.cmml"><mi id="S3.p6.4.4.m4.5.5.4.3.2" xref="S3.p6.4.4.m4.5.5.4.3.2.cmml">f</mi><mo id="S3.p6.4.4.m4.5.5.4.3.3" xref="S3.p6.4.4.m4.5.5.4.3.3.cmml">′</mo></msup><mo id="S3.p6.4.4.m4.5.5.4.2" xref="S3.p6.4.4.m4.5.5.4.2.cmml">⁢</mo><mrow id="S3.p6.4.4.m4.5.5.4.1.1" xref="S3.p6.4.4.m4.5.5.4.1.1.1.cmml"><mo id="S3.p6.4.4.m4.5.5.4.1.1.2" stretchy="false" xref="S3.p6.4.4.m4.5.5.4.1.1.1.cmml">(</mo><msub id="S3.p6.4.4.m4.5.5.4.1.1.1" xref="S3.p6.4.4.m4.5.5.4.1.1.1.cmml"><mi id="S3.p6.4.4.m4.5.5.4.1.1.1.2" xref="S3.p6.4.4.m4.5.5.4.1.1.1.2.cmml">s</mi><mi id="S3.p6.4.4.m4.5.5.4.1.1.1.3" xref="S3.p6.4.4.m4.5.5.4.1.1.1.3.cmml">u</mi></msub><mo id="S3.p6.4.4.m4.5.5.4.1.1.3" stretchy="false" xref="S3.p6.4.4.m4.5.5.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.4.4.m4.5b"><apply id="S3.p6.4.4.m4.5.5.cmml" xref="S3.p6.4.4.m4.5.5"><eq id="S3.p6.4.4.m4.5.5.5.cmml" xref="S3.p6.4.4.m4.5.5.5"></eq><set id="S3.p6.4.4.m4.4.4.3.4.cmml" xref="S3.p6.4.4.m4.4.4.3.3"><apply id="S3.p6.4.4.m4.2.2.1.1.1.cmml" xref="S3.p6.4.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p6.4.4.m4.2.2.1.1.1.1.cmml" xref="S3.p6.4.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.p6.4.4.m4.2.2.1.1.1.2.cmml" xref="S3.p6.4.4.m4.2.2.1.1.1.2">𝑝</ci><apply id="S3.p6.4.4.m4.2.2.1.1.1.3.cmml" xref="S3.p6.4.4.m4.2.2.1.1.1.3"><times id="S3.p6.4.4.m4.2.2.1.1.1.3.1.cmml" xref="S3.p6.4.4.m4.2.2.1.1.1.3.1"></times><ci id="S3.p6.4.4.m4.2.2.1.1.1.3.2.cmml" xref="S3.p6.4.4.m4.2.2.1.1.1.3.2">𝑢</ci><cn id="S3.p6.4.4.m4.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.p6.4.4.m4.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.p6.4.4.m4.3.3.2.2.2.cmml" xref="S3.p6.4.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p6.4.4.m4.3.3.2.2.2.1.cmml" xref="S3.p6.4.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.p6.4.4.m4.3.3.2.2.2.2.cmml" xref="S3.p6.4.4.m4.3.3.2.2.2.2">𝑝</ci><apply id="S3.p6.4.4.m4.3.3.2.2.2.3.cmml" xref="S3.p6.4.4.m4.3.3.2.2.2.3"><times id="S3.p6.4.4.m4.3.3.2.2.2.3.1.cmml" xref="S3.p6.4.4.m4.3.3.2.2.2.3.1"></times><ci id="S3.p6.4.4.m4.3.3.2.2.2.3.2.cmml" xref="S3.p6.4.4.m4.3.3.2.2.2.3.2">𝑢</ci><cn id="S3.p6.4.4.m4.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.p6.4.4.m4.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S3.p6.4.4.m4.1.1.cmml" xref="S3.p6.4.4.m4.1.1">…</ci><apply id="S3.p6.4.4.m4.4.4.3.3.3.cmml" xref="S3.p6.4.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p6.4.4.m4.4.4.3.3.3.1.cmml" xref="S3.p6.4.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.p6.4.4.m4.4.4.3.3.3.2.cmml" xref="S3.p6.4.4.m4.4.4.3.3.3.2">𝑝</ci><apply id="S3.p6.4.4.m4.4.4.3.3.3.3.cmml" xref="S3.p6.4.4.m4.4.4.3.3.3.3"><times id="S3.p6.4.4.m4.4.4.3.3.3.3.1.cmml" xref="S3.p6.4.4.m4.4.4.3.3.3.3.1"></times><ci id="S3.p6.4.4.m4.4.4.3.3.3.3.2.cmml" xref="S3.p6.4.4.m4.4.4.3.3.3.3.2">𝑢</ci><ci id="S3.p6.4.4.m4.4.4.3.3.3.3.3.cmml" xref="S3.p6.4.4.m4.4.4.3.3.3.3.3">𝐾</ci></apply></apply></set><apply id="S3.p6.4.4.m4.5.5.4.cmml" xref="S3.p6.4.4.m4.5.5.4"><times id="S3.p6.4.4.m4.5.5.4.2.cmml" xref="S3.p6.4.4.m4.5.5.4.2"></times><apply id="S3.p6.4.4.m4.5.5.4.3.cmml" xref="S3.p6.4.4.m4.5.5.4.3"><csymbol cd="ambiguous" id="S3.p6.4.4.m4.5.5.4.3.1.cmml" xref="S3.p6.4.4.m4.5.5.4.3">superscript</csymbol><ci id="S3.p6.4.4.m4.5.5.4.3.2.cmml" xref="S3.p6.4.4.m4.5.5.4.3.2">𝑓</ci><ci id="S3.p6.4.4.m4.5.5.4.3.3.cmml" xref="S3.p6.4.4.m4.5.5.4.3.3">′</ci></apply><apply id="S3.p6.4.4.m4.5.5.4.1.1.1.cmml" xref="S3.p6.4.4.m4.5.5.4.1.1"><csymbol cd="ambiguous" id="S3.p6.4.4.m4.5.5.4.1.1.1.1.cmml" xref="S3.p6.4.4.m4.5.5.4.1.1">subscript</csymbol><ci id="S3.p6.4.4.m4.5.5.4.1.1.1.2.cmml" xref="S3.p6.4.4.m4.5.5.4.1.1.1.2">𝑠</ci><ci id="S3.p6.4.4.m4.5.5.4.1.1.1.3.cmml" xref="S3.p6.4.4.m4.5.5.4.1.1.1.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.4.4.m4.5c">\{p_{u1},p_{u2},\dots,p_{uK}\}=f^{\prime}(s_{u})</annotation><annotation encoding="application/x-llamapun" id="S3.p6.4.4.m4.5d">{ italic_p start_POSTSUBSCRIPT italic_u 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_u 2 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_u italic_K end_POSTSUBSCRIPT } = italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\{p_{u1},p_{u2},\dots,p_{uK}\}" class="ltx_Math" display="inline" id="S3.p6.5.5.m5.4"><semantics id="S3.p6.5.5.m5.4a"><mrow id="S3.p6.5.5.m5.4.4.3" xref="S3.p6.5.5.m5.4.4.4.cmml"><mo id="S3.p6.5.5.m5.4.4.3.4" stretchy="false" xref="S3.p6.5.5.m5.4.4.4.cmml">{</mo><msub id="S3.p6.5.5.m5.2.2.1.1" xref="S3.p6.5.5.m5.2.2.1.1.cmml"><mi id="S3.p6.5.5.m5.2.2.1.1.2" xref="S3.p6.5.5.m5.2.2.1.1.2.cmml">p</mi><mrow id="S3.p6.5.5.m5.2.2.1.1.3" xref="S3.p6.5.5.m5.2.2.1.1.3.cmml"><mi id="S3.p6.5.5.m5.2.2.1.1.3.2" xref="S3.p6.5.5.m5.2.2.1.1.3.2.cmml">u</mi><mo id="S3.p6.5.5.m5.2.2.1.1.3.1" xref="S3.p6.5.5.m5.2.2.1.1.3.1.cmml">⁢</mo><mn id="S3.p6.5.5.m5.2.2.1.1.3.3" xref="S3.p6.5.5.m5.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.p6.5.5.m5.4.4.3.5" xref="S3.p6.5.5.m5.4.4.4.cmml">,</mo><msub id="S3.p6.5.5.m5.3.3.2.2" xref="S3.p6.5.5.m5.3.3.2.2.cmml"><mi id="S3.p6.5.5.m5.3.3.2.2.2" xref="S3.p6.5.5.m5.3.3.2.2.2.cmml">p</mi><mrow id="S3.p6.5.5.m5.3.3.2.2.3" xref="S3.p6.5.5.m5.3.3.2.2.3.cmml"><mi id="S3.p6.5.5.m5.3.3.2.2.3.2" xref="S3.p6.5.5.m5.3.3.2.2.3.2.cmml">u</mi><mo id="S3.p6.5.5.m5.3.3.2.2.3.1" xref="S3.p6.5.5.m5.3.3.2.2.3.1.cmml">⁢</mo><mn id="S3.p6.5.5.m5.3.3.2.2.3.3" xref="S3.p6.5.5.m5.3.3.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S3.p6.5.5.m5.4.4.3.6" xref="S3.p6.5.5.m5.4.4.4.cmml">,</mo><mi id="S3.p6.5.5.m5.1.1" mathvariant="normal" xref="S3.p6.5.5.m5.1.1.cmml">…</mi><mo id="S3.p6.5.5.m5.4.4.3.7" xref="S3.p6.5.5.m5.4.4.4.cmml">,</mo><msub id="S3.p6.5.5.m5.4.4.3.3" xref="S3.p6.5.5.m5.4.4.3.3.cmml"><mi id="S3.p6.5.5.m5.4.4.3.3.2" xref="S3.p6.5.5.m5.4.4.3.3.2.cmml">p</mi><mrow id="S3.p6.5.5.m5.4.4.3.3.3" xref="S3.p6.5.5.m5.4.4.3.3.3.cmml"><mi id="S3.p6.5.5.m5.4.4.3.3.3.2" xref="S3.p6.5.5.m5.4.4.3.3.3.2.cmml">u</mi><mo id="S3.p6.5.5.m5.4.4.3.3.3.1" xref="S3.p6.5.5.m5.4.4.3.3.3.1.cmml">⁢</mo><mi id="S3.p6.5.5.m5.4.4.3.3.3.3" xref="S3.p6.5.5.m5.4.4.3.3.3.3.cmml">K</mi></mrow></msub><mo id="S3.p6.5.5.m5.4.4.3.8" stretchy="false" xref="S3.p6.5.5.m5.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.5.5.m5.4b"><set id="S3.p6.5.5.m5.4.4.4.cmml" xref="S3.p6.5.5.m5.4.4.3"><apply id="S3.p6.5.5.m5.2.2.1.1.cmml" xref="S3.p6.5.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.p6.5.5.m5.2.2.1.1.1.cmml" xref="S3.p6.5.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.p6.5.5.m5.2.2.1.1.2.cmml" xref="S3.p6.5.5.m5.2.2.1.1.2">𝑝</ci><apply id="S3.p6.5.5.m5.2.2.1.1.3.cmml" xref="S3.p6.5.5.m5.2.2.1.1.3"><times id="S3.p6.5.5.m5.2.2.1.1.3.1.cmml" xref="S3.p6.5.5.m5.2.2.1.1.3.1"></times><ci id="S3.p6.5.5.m5.2.2.1.1.3.2.cmml" xref="S3.p6.5.5.m5.2.2.1.1.3.2">𝑢</ci><cn id="S3.p6.5.5.m5.2.2.1.1.3.3.cmml" type="integer" xref="S3.p6.5.5.m5.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.p6.5.5.m5.3.3.2.2.cmml" xref="S3.p6.5.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.p6.5.5.m5.3.3.2.2.1.cmml" xref="S3.p6.5.5.m5.3.3.2.2">subscript</csymbol><ci id="S3.p6.5.5.m5.3.3.2.2.2.cmml" xref="S3.p6.5.5.m5.3.3.2.2.2">𝑝</ci><apply id="S3.p6.5.5.m5.3.3.2.2.3.cmml" xref="S3.p6.5.5.m5.3.3.2.2.3"><times id="S3.p6.5.5.m5.3.3.2.2.3.1.cmml" xref="S3.p6.5.5.m5.3.3.2.2.3.1"></times><ci id="S3.p6.5.5.m5.3.3.2.2.3.2.cmml" xref="S3.p6.5.5.m5.3.3.2.2.3.2">𝑢</ci><cn id="S3.p6.5.5.m5.3.3.2.2.3.3.cmml" type="integer" xref="S3.p6.5.5.m5.3.3.2.2.3.3">2</cn></apply></apply><ci id="S3.p6.5.5.m5.1.1.cmml" xref="S3.p6.5.5.m5.1.1">…</ci><apply id="S3.p6.5.5.m5.4.4.3.3.cmml" xref="S3.p6.5.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S3.p6.5.5.m5.4.4.3.3.1.cmml" xref="S3.p6.5.5.m5.4.4.3.3">subscript</csymbol><ci id="S3.p6.5.5.m5.4.4.3.3.2.cmml" xref="S3.p6.5.5.m5.4.4.3.3.2">𝑝</ci><apply id="S3.p6.5.5.m5.4.4.3.3.3.cmml" xref="S3.p6.5.5.m5.4.4.3.3.3"><times id="S3.p6.5.5.m5.4.4.3.3.3.1.cmml" xref="S3.p6.5.5.m5.4.4.3.3.3.1"></times><ci id="S3.p6.5.5.m5.4.4.3.3.3.2.cmml" xref="S3.p6.5.5.m5.4.4.3.3.3.2">𝑢</ci><ci id="S3.p6.5.5.m5.4.4.3.3.3.3.cmml" xref="S3.p6.5.5.m5.4.4.3.3.3.3">𝐾</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.5.5.m5.4c">\{p_{u1},p_{u2},\dots,p_{uK}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.5.5.m5.4d">{ italic_p start_POSTSUBSCRIPT italic_u 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_u 2 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_u italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> are K informative patterns and <math alttext="f^{\prime}" class="ltx_Math" display="inline" id="S3.p6.6.6.m6.1"><semantics id="S3.p6.6.6.m6.1a"><msup id="S3.p6.6.6.m6.1.1" xref="S3.p6.6.6.m6.1.1.cmml"><mi id="S3.p6.6.6.m6.1.1.2" xref="S3.p6.6.6.m6.1.1.2.cmml">f</mi><mo id="S3.p6.6.6.m6.1.1.3" xref="S3.p6.6.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p6.6.6.m6.1b"><apply id="S3.p6.6.6.m6.1.1.cmml" xref="S3.p6.6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p6.6.6.m6.1.1.1.cmml" xref="S3.p6.6.6.m6.1.1">superscript</csymbol><ci id="S3.p6.6.6.m6.1.1.2.cmml" xref="S3.p6.6.6.m6.1.1.2">𝑓</ci><ci id="S3.p6.6.6.m6.1.1.3.cmml" xref="S3.p6.6.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.6.6.m6.1c">f^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.6.6.m6.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is learned independently from the target model <math alttext="f" class="ltx_Math" display="inline" id="S3.p6.7.7.m7.1"><semantics id="S3.p6.7.7.m7.1a"><mi id="S3.p6.7.7.m7.1.1" xref="S3.p6.7.7.m7.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p6.7.7.m7.1b"><ci id="S3.p6.7.7.m7.1.1.cmml" xref="S3.p6.7.7.m7.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.7.7.m7.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.p6.7.7.m7.1d">italic_f</annotation></semantics></math>. By collecting all regenerated patterns, we can obtain the new dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S3.p6.8.8.m8.1"><semantics id="S3.p6.8.8.m8.1a"><msup id="S3.p6.8.8.m8.1.1" xref="S3.p6.8.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p6.8.8.m8.1.1.2" xref="S3.p6.8.8.m8.1.1.2.cmml">𝒳</mi><mo id="S3.p6.8.8.m8.1.1.3" xref="S3.p6.8.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p6.8.8.m8.1b"><apply id="S3.p6.8.8.m8.1.1.cmml" xref="S3.p6.8.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p6.8.8.m8.1.1.1.cmml" xref="S3.p6.8.8.m8.1.1">superscript</csymbol><ci id="S3.p6.8.8.m8.1.1.2.cmml" xref="S3.p6.8.8.m8.1.1.2">𝒳</ci><ci id="S3.p6.8.8.m8.1.1.3.cmml" xref="S3.p6.8.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.8.8.m8.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.8.8.m8.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></p>
</div>
<div class="ltx_para" id="S3.p7">
<p class="ltx_p" id="S3.p7.1">Upon regenerating a new dataset, there is an imperative need to tailor the regenerated dataset specifically for a target recommendation model, as the regeneration process remains independent of the target model. We hence propose a model-aware dataset regeneration process that can evaluate the score of each data sample for the target model. The formal definition is as follows:</p>
</div>
<div class="ltx_para" id="S3.p8">
<p class="ltx_p" id="S3.p8.7"><span class="ltx_text ltx_font_bold" id="S3.p8.7.8">Definition4</span>. <span class="ltx_text ltx_font_italic" id="S3.p8.7.7">(<span class="ltx_text ltx_font_bold" id="S3.p8.7.7.1">Model-aware Dataset Regeneration</span>). Given the regenerated dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S3.p8.1.1.m1.1"><semantics id="S3.p8.1.1.m1.1a"><msup id="S3.p8.1.1.m1.1.1" xref="S3.p8.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p8.1.1.m1.1.1.2" xref="S3.p8.1.1.m1.1.1.2.cmml">𝒳</mi><mo id="S3.p8.1.1.m1.1.1.3" xref="S3.p8.1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p8.1.1.m1.1b"><apply id="S3.p8.1.1.m1.1.1.cmml" xref="S3.p8.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p8.1.1.m1.1.1.1.cmml" xref="S3.p8.1.1.m1.1.1">superscript</csymbol><ci id="S3.p8.1.1.m1.1.1.2.cmml" xref="S3.p8.1.1.m1.1.1.2">𝒳</ci><ci id="S3.p8.1.1.m1.1.1.3.cmml" xref="S3.p8.1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.1.1.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.1.1.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, a dataset personalizer <math alttext="g" class="ltx_Math" display="inline" id="S3.p8.2.2.m2.1"><semantics id="S3.p8.2.2.m2.1a"><mi id="S3.p8.2.2.m2.1.1" xref="S3.p8.2.2.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.p8.2.2.m2.1b"><ci id="S3.p8.2.2.m2.1.1.cmml" xref="S3.p8.2.2.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.2.2.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="S3.p8.2.2.m2.1d">italic_g</annotation></semantics></math> with parameter <math alttext="\phi" class="ltx_Math" display="inline" id="S3.p8.3.3.m3.1"><semantics id="S3.p8.3.3.m3.1a"><mi id="S3.p8.3.3.m3.1.1" xref="S3.p8.3.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.p8.3.3.m3.1b"><ci id="S3.p8.3.3.m3.1.1.cmml" xref="S3.p8.3.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.3.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.p8.3.3.m3.1d">italic_ϕ</annotation></semantics></math> is used to generate a scoring matrix <math alttext="\mathbf{W}\in\mathbb{R}^{|\mathcal{X}^{\prime}|}" class="ltx_Math" display="inline" id="S3.p8.4.4.m4.1"><semantics id="S3.p8.4.4.m4.1a"><mrow id="S3.p8.4.4.m4.1.2" xref="S3.p8.4.4.m4.1.2.cmml"><mi id="S3.p8.4.4.m4.1.2.2" xref="S3.p8.4.4.m4.1.2.2.cmml">𝐖</mi><mo id="S3.p8.4.4.m4.1.2.1" xref="S3.p8.4.4.m4.1.2.1.cmml">∈</mo><msup id="S3.p8.4.4.m4.1.2.3" xref="S3.p8.4.4.m4.1.2.3.cmml"><mi id="S3.p8.4.4.m4.1.2.3.2" xref="S3.p8.4.4.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S3.p8.4.4.m4.1.1.1.1" xref="S3.p8.4.4.m4.1.1.1.2.cmml"><mo id="S3.p8.4.4.m4.1.1.1.1.2" stretchy="false" xref="S3.p8.4.4.m4.1.1.1.2.1.cmml">|</mo><msup id="S3.p8.4.4.m4.1.1.1.1.1" xref="S3.p8.4.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p8.4.4.m4.1.1.1.1.1.2" xref="S3.p8.4.4.m4.1.1.1.1.1.2.cmml">𝒳</mi><mo id="S3.p8.4.4.m4.1.1.1.1.1.3" xref="S3.p8.4.4.m4.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.p8.4.4.m4.1.1.1.1.3" stretchy="false" xref="S3.p8.4.4.m4.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.4.4.m4.1b"><apply id="S3.p8.4.4.m4.1.2.cmml" xref="S3.p8.4.4.m4.1.2"><in id="S3.p8.4.4.m4.1.2.1.cmml" xref="S3.p8.4.4.m4.1.2.1"></in><ci id="S3.p8.4.4.m4.1.2.2.cmml" xref="S3.p8.4.4.m4.1.2.2">𝐖</ci><apply id="S3.p8.4.4.m4.1.2.3.cmml" xref="S3.p8.4.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.p8.4.4.m4.1.2.3.1.cmml" xref="S3.p8.4.4.m4.1.2.3">superscript</csymbol><ci id="S3.p8.4.4.m4.1.2.3.2.cmml" xref="S3.p8.4.4.m4.1.2.3.2">ℝ</ci><apply id="S3.p8.4.4.m4.1.1.1.2.cmml" xref="S3.p8.4.4.m4.1.1.1.1"><abs id="S3.p8.4.4.m4.1.1.1.2.1.cmml" xref="S3.p8.4.4.m4.1.1.1.1.2"></abs><apply id="S3.p8.4.4.m4.1.1.1.1.1.cmml" xref="S3.p8.4.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p8.4.4.m4.1.1.1.1.1.1.cmml" xref="S3.p8.4.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.p8.4.4.m4.1.1.1.1.1.2.cmml" xref="S3.p8.4.4.m4.1.1.1.1.1.2">𝒳</ci><ci id="S3.p8.4.4.m4.1.1.1.1.1.3.cmml" xref="S3.p8.4.4.m4.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.4.4.m4.1c">\mathbf{W}\in\mathbb{R}^{|\mathcal{X}^{\prime}|}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.4.4.m4.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | end_POSTSUPERSCRIPT</annotation></semantics></math> to evaluate the score of each data sample. The learning of <math alttext="g" class="ltx_Math" display="inline" id="S3.p8.5.5.m5.1"><semantics id="S3.p8.5.5.m5.1a"><mi id="S3.p8.5.5.m5.1.1" xref="S3.p8.5.5.m5.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.p8.5.5.m5.1b"><ci id="S3.p8.5.5.m5.1.1.cmml" xref="S3.p8.5.5.m5.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.5.5.m5.1c">g</annotation><annotation encoding="application/x-llamapun" id="S3.p8.5.5.m5.1d">italic_g</annotation></semantics></math> will be guided by a target model <math alttext="f" class="ltx_Math" display="inline" id="S3.p8.6.6.m6.1"><semantics id="S3.p8.6.6.m6.1a"><mi id="S3.p8.6.6.m6.1.1" xref="S3.p8.6.6.m6.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p8.6.6.m6.1b"><ci id="S3.p8.6.6.m6.1.1.cmml" xref="S3.p8.6.6.m6.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.6.6.m6.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.p8.6.6.m6.1d">italic_f</annotation></semantics></math>, thereby achieving dataset personalization. The dataset-score pair <math alttext="(\mathcal{X}^{\prime},\mathbf{W})" class="ltx_Math" display="inline" id="S3.p8.7.7.m7.2"><semantics id="S3.p8.7.7.m7.2a"><mrow id="S3.p8.7.7.m7.2.2.1" xref="S3.p8.7.7.m7.2.2.2.cmml"><mo id="S3.p8.7.7.m7.2.2.1.2" stretchy="false" xref="S3.p8.7.7.m7.2.2.2.cmml">(</mo><msup id="S3.p8.7.7.m7.2.2.1.1" xref="S3.p8.7.7.m7.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p8.7.7.m7.2.2.1.1.2" xref="S3.p8.7.7.m7.2.2.1.1.2.cmml">𝒳</mi><mo id="S3.p8.7.7.m7.2.2.1.1.3" xref="S3.p8.7.7.m7.2.2.1.1.3.cmml">′</mo></msup><mo id="S3.p8.7.7.m7.2.2.1.3" xref="S3.p8.7.7.m7.2.2.2.cmml">,</mo><mi id="S3.p8.7.7.m7.1.1" xref="S3.p8.7.7.m7.1.1.cmml">𝐖</mi><mo id="S3.p8.7.7.m7.2.2.1.4" stretchy="false" xref="S3.p8.7.7.m7.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.7.7.m7.2b"><interval closure="open" id="S3.p8.7.7.m7.2.2.2.cmml" xref="S3.p8.7.7.m7.2.2.1"><apply id="S3.p8.7.7.m7.2.2.1.1.cmml" xref="S3.p8.7.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.p8.7.7.m7.2.2.1.1.1.cmml" xref="S3.p8.7.7.m7.2.2.1.1">superscript</csymbol><ci id="S3.p8.7.7.m7.2.2.1.1.2.cmml" xref="S3.p8.7.7.m7.2.2.1.1.2">𝒳</ci><ci id="S3.p8.7.7.m7.2.2.1.1.3.cmml" xref="S3.p8.7.7.m7.2.2.1.1.3">′</ci></apply><ci id="S3.p8.7.7.m7.1.1.cmml" xref="S3.p8.7.7.m7.1.1">𝐖</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.7.7.m7.2c">(\mathcal{X}^{\prime},\mathbf{W})</annotation><annotation encoding="application/x-llamapun" id="S3.p8.7.7.m7.2d">( caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , bold_W )</annotation></semantics></math> will serve as the personalized dataset.</span></p>
</div>
<div class="ltx_para" id="S3.p9">
<p class="ltx_p" id="S3.p9.1">In the next section, we will illustrate the details of dataset regeneration and model-aware dataset regeneration.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>METHODOLOGY</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Overall Framework</h3>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="257" id="S4.F2.g1" src="x2.png" width="712"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">The framework of the proposed data-centric paradigm: (A) The Pre-training stage of DR4SR involves training a diversity-promoted data regenerator utilizing the curated pre-training dataset. (B) The inference stage of DR4SR regenerates each source sequence into multiple target patterns with a hybrid inference strategy. (C) Model-aware dataset regeneration with a personalizer further tailors the regenerated dataset to each target model.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In this paper, we propose a data-centric framework named <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">D</span>ata <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">R</span>egeneration for <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.3">S</span>equential <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.4">R</span>ecommendation (<span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.5">DR4SR</span>), aiming to regenerate the original dataset into a highly informative and generalizable dataset, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.F2" title="Figure 2 ‣ 4.1. Overall Framework ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. Since the data regeneration process is independent of target models, the regenerated dataset may not necessarily align with their requirements. Therefore, we extend DR4SR to a model-aware version DR4SR+ in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS3" title="4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.3</span></a>, which tailors the regenerated dataset to a particular target model.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Model-agnostic Dataset Regeneration</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To develop an informative and generalizable dataset, we aim to construct a dataset regenerator to facilitate the automated dataset regeneration. However, the original dataset lacks supervised information for learning a dataset regenerator. Therefore, we must implement it in a self-supervised learning manner. To achieve this, we introduce a pre-training task in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS1" title="4.2.1. Construction of Pre-training Task ‣ 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.2.1</span></a> that can guide the learning of the proposed diversity-promoted regenerator detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS2" title="4.2.2. Diversity-promoted Regenerator ‣ 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.2.2</span></a>. After completing the pre-training, we proceed to regenerate a new dataset using a hybrid inference strategy in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS3" title="4.2.3. Dataset Regeneration with Hybrid Inference Strategy ‣ 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.2.3</span></a>. The pipeline is detailed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#alg1" title="Algorithm 1 ‣ A.1. Pseudo Code of DR4SR and DR4SR+ ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>Construction of Pre-training Task</h4>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="79" id="S4.F3.g1" src="x3.png" width="293"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.4.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.5.2" style="font-size:90%;">Pre-training task construction. Assuming two given <span class="ltx_text" id="S4.F3.5.2.1" style="color:#7030A0;">sequences</span> (1,2,3,4,5), (1,2,3) with a window size 3 and a threshold 2, the following <span class="ltx_text" id="S4.F3.5.2.2" style="color:#00717D;">patterns</span> can be extracted: (1,2), (1,3), (2,3), (1,2,3). This is because these patterns appear twice within the sliding window. Then the regenerator is supposed to regenerate each sequence into multiple corresponding patterns.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.1">To construct a pre-training task, we first obtain item transition patterns through rule-based methods. Then, the pre-training task is formalized as training the regenerator to learn how to regenerate these patterns from the sequences in the original dataset.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.2">Specifically, we utilize a sliding window strategy to extract patterns. Within a specified sliding window of size <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.1.m1.1"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mi id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><ci id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.1.m1.1d">italic_α</annotation></semantics></math>, we count the occurrence of item transition patterns. Patterns with an occurrence count exceeding a predetermined threshold <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.2.m2.1"><semantics id="S4.SS2.SSS1.p2.2.m2.1a"><mi id="S4.SS2.SSS1.p2.2.m2.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.2.m2.1b"><ci id="S4.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.2.m2.1d">italic_β</annotation></semantics></math> will be selected to form the pre-training task. A toy example is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.F3" title="Figure 3 ‣ 4.2.1. Construction of Pre-training Task ‣ 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, where the window size is set to 3 and the threshold is set to 2.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.11">After obtaining the pattern set, one pre-training instance pair can be constructed as <math alttext="(s_{u},p_{i})" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.1.m1.2"><semantics id="S4.SS2.SSS1.p3.1.m1.2a"><mrow id="S4.SS2.SSS1.p3.1.m1.2.2.2" xref="S4.SS2.SSS1.p3.1.m1.2.2.3.cmml"><mo id="S4.SS2.SSS1.p3.1.m1.2.2.2.3" stretchy="false" xref="S4.SS2.SSS1.p3.1.m1.2.2.3.cmml">(</mo><msub id="S4.SS2.SSS1.p3.1.m1.1.1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p3.1.m1.1.1.1.1.2" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS1.p3.1.m1.1.1.1.1.3" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS2.SSS1.p3.1.m1.2.2.2.4" xref="S4.SS2.SSS1.p3.1.m1.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS1.p3.1.m1.2.2.2.2" xref="S4.SS2.SSS1.p3.1.m1.2.2.2.2.cmml"><mi id="S4.SS2.SSS1.p3.1.m1.2.2.2.2.2" xref="S4.SS2.SSS1.p3.1.m1.2.2.2.2.2.cmml">p</mi><mi id="S4.SS2.SSS1.p3.1.m1.2.2.2.2.3" xref="S4.SS2.SSS1.p3.1.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.SSS1.p3.1.m1.2.2.2.5" stretchy="false" xref="S4.SS2.SSS1.p3.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.1.m1.2b"><interval closure="open" id="S4.SS2.SSS1.p3.1.m1.2.2.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.2.2.2"><apply id="S4.SS2.SSS1.p3.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.SSS1.p3.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.SS2.SSS1.p3.1.m1.2.2.2.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.1.m1.2.2.2.2.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p3.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.2.2.2.2.2">𝑝</ci><ci id="S4.SS2.SSS1.p3.1.m1.2.2.2.2.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.1.m1.2c">(s_{u},p_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.1.m1.2d">( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="s_{u}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.2.m2.1"><semantics id="S4.SS2.SSS1.p3.2.m2.1a"><msub id="S4.SS2.SSS1.p3.2.m2.1.1" xref="S4.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p3.2.m2.1.1.2" xref="S4.SS2.SSS1.p3.2.m2.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS1.p3.2.m2.1.1.3" xref="S4.SS2.SSS1.p3.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.2.m2.1b"><apply id="S4.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1.2">𝑠</ci><ci id="S4.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.2.m2.1c">s_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the interaction sequence of user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.3.m3.1"><semantics id="S4.SS2.SSS1.p3.3.m3.1a"><mi id="S4.SS2.SSS1.p3.3.m3.1.1" xref="S4.SS2.SSS1.p3.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.3.m3.1b"><ci id="S4.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.3.m3.1d">italic_u</annotation></semantics></math>, <math alttext="p_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.4.m4.1"><semantics id="S4.SS2.SSS1.p3.4.m4.1a"><msub id="S4.SS2.SSS1.p3.4.m4.1.1" xref="S4.SS2.SSS1.p3.4.m4.1.1.cmml"><mi id="S4.SS2.SSS1.p3.4.m4.1.1.2" xref="S4.SS2.SSS1.p3.4.m4.1.1.2.cmml">p</mi><mi id="S4.SS2.SSS1.p3.4.m4.1.1.3" xref="S4.SS2.SSS1.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.4.m4.1b"><apply id="S4.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.2">𝑝</ci><ci id="S4.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.4.m4.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="i" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.5.m5.1"><semantics id="S4.SS2.SSS1.p3.5.m5.1a"><mi id="S4.SS2.SSS1.p3.5.m5.1.1" xref="S4.SS2.SSS1.p3.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.5.m5.1b"><ci id="S4.SS2.SSS1.p3.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p3.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.5.m5.1d">italic_i</annotation></semantics></math>-th pattern extracted from <math alttext="s_{u}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.6.m6.1"><semantics id="S4.SS2.SSS1.p3.6.m6.1a"><msub id="S4.SS2.SSS1.p3.6.m6.1.1" xref="S4.SS2.SSS1.p3.6.m6.1.1.cmml"><mi id="S4.SS2.SSS1.p3.6.m6.1.1.2" xref="S4.SS2.SSS1.p3.6.m6.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS1.p3.6.m6.1.1.3" xref="S4.SS2.SSS1.p3.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.6.m6.1b"><apply id="S4.SS2.SSS1.p3.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.6.m6.1.1.1.cmml" xref="S4.SS2.SSS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.6.m6.1.1.2.cmml" xref="S4.SS2.SSS1.p3.6.m6.1.1.2">𝑠</ci><ci id="S4.SS2.SSS1.p3.6.m6.1.1.3.cmml" xref="S4.SS2.SSS1.p3.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.6.m6.1c">s_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.6.m6.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>. Then the regenerator <math alttext="f^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.7.m7.1"><semantics id="S4.SS2.SSS1.p3.7.m7.1a"><msup id="S4.SS2.SSS1.p3.7.m7.1.1" xref="S4.SS2.SSS1.p3.7.m7.1.1.cmml"><mi id="S4.SS2.SSS1.p3.7.m7.1.1.2" xref="S4.SS2.SSS1.p3.7.m7.1.1.2.cmml">f</mi><mo id="S4.SS2.SSS1.p3.7.m7.1.1.3" xref="S4.SS2.SSS1.p3.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.7.m7.1b"><apply id="S4.SS2.SSS1.p3.7.m7.1.1.cmml" xref="S4.SS2.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.7.m7.1.1.1.cmml" xref="S4.SS2.SSS1.p3.7.m7.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.7.m7.1.1.2.cmml" xref="S4.SS2.SSS1.p3.7.m7.1.1.2">𝑓</ci><ci id="S4.SS2.SSS1.p3.7.m7.1.1.3.cmml" xref="S4.SS2.SSS1.p3.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.7.m7.1c">f^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.7.m7.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is supposed to regenerate <math alttext="s_{u}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.8.m8.1"><semantics id="S4.SS2.SSS1.p3.8.m8.1a"><msub id="S4.SS2.SSS1.p3.8.m8.1.1" xref="S4.SS2.SSS1.p3.8.m8.1.1.cmml"><mi id="S4.SS2.SSS1.p3.8.m8.1.1.2" xref="S4.SS2.SSS1.p3.8.m8.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS1.p3.8.m8.1.1.3" xref="S4.SS2.SSS1.p3.8.m8.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.8.m8.1b"><apply id="S4.SS2.SSS1.p3.8.m8.1.1.cmml" xref="S4.SS2.SSS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.8.m8.1.1.1.cmml" xref="S4.SS2.SSS1.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.8.m8.1.1.2.cmml" xref="S4.SS2.SSS1.p3.8.m8.1.1.2">𝑠</ci><ci id="S4.SS2.SSS1.p3.8.m8.1.1.3.cmml" xref="S4.SS2.SSS1.p3.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.8.m8.1c">s_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> into the corresponding pattern <math alttext="p_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.9.m9.1"><semantics id="S4.SS2.SSS1.p3.9.m9.1a"><msub id="S4.SS2.SSS1.p3.9.m9.1.1" xref="S4.SS2.SSS1.p3.9.m9.1.1.cmml"><mi id="S4.SS2.SSS1.p3.9.m9.1.1.2" xref="S4.SS2.SSS1.p3.9.m9.1.1.2.cmml">p</mi><mi id="S4.SS2.SSS1.p3.9.m9.1.1.3" xref="S4.SS2.SSS1.p3.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.9.m9.1b"><apply id="S4.SS2.SSS1.p3.9.m9.1.1.cmml" xref="S4.SS2.SSS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.9.m9.1.1.1.cmml" xref="S4.SS2.SSS1.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.9.m9.1.1.2.cmml" xref="S4.SS2.SSS1.p3.9.m9.1.1.2">𝑝</ci><ci id="S4.SS2.SSS1.p3.9.m9.1.1.3.cmml" xref="S4.SS2.SSS1.p3.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.9.m9.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.9.m9.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for each pre-training instance pair <math alttext="(s_{u},p_{i})" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.10.m10.2"><semantics id="S4.SS2.SSS1.p3.10.m10.2a"><mrow id="S4.SS2.SSS1.p3.10.m10.2.2.2" xref="S4.SS2.SSS1.p3.10.m10.2.2.3.cmml"><mo id="S4.SS2.SSS1.p3.10.m10.2.2.2.3" stretchy="false" xref="S4.SS2.SSS1.p3.10.m10.2.2.3.cmml">(</mo><msub id="S4.SS2.SSS1.p3.10.m10.1.1.1.1" xref="S4.SS2.SSS1.p3.10.m10.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p3.10.m10.1.1.1.1.2" xref="S4.SS2.SSS1.p3.10.m10.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS1.p3.10.m10.1.1.1.1.3" xref="S4.SS2.SSS1.p3.10.m10.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS2.SSS1.p3.10.m10.2.2.2.4" xref="S4.SS2.SSS1.p3.10.m10.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS1.p3.10.m10.2.2.2.2" xref="S4.SS2.SSS1.p3.10.m10.2.2.2.2.cmml"><mi id="S4.SS2.SSS1.p3.10.m10.2.2.2.2.2" xref="S4.SS2.SSS1.p3.10.m10.2.2.2.2.2.cmml">p</mi><mi id="S4.SS2.SSS1.p3.10.m10.2.2.2.2.3" xref="S4.SS2.SSS1.p3.10.m10.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.SSS1.p3.10.m10.2.2.2.5" stretchy="false" xref="S4.SS2.SSS1.p3.10.m10.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.10.m10.2b"><interval closure="open" id="S4.SS2.SSS1.p3.10.m10.2.2.3.cmml" xref="S4.SS2.SSS1.p3.10.m10.2.2.2"><apply id="S4.SS2.SSS1.p3.10.m10.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.10.m10.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.10.m10.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.10.m10.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.10.m10.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.SSS1.p3.10.m10.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.10.m10.1.1.1.1.3">𝑢</ci></apply><apply id="S4.SS2.SSS1.p3.10.m10.2.2.2.2.cmml" xref="S4.SS2.SSS1.p3.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.10.m10.2.2.2.2.1.cmml" xref="S4.SS2.SSS1.p3.10.m10.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p3.10.m10.2.2.2.2.2.cmml" xref="S4.SS2.SSS1.p3.10.m10.2.2.2.2.2">𝑝</ci><ci id="S4.SS2.SSS1.p3.10.m10.2.2.2.2.3.cmml" xref="S4.SS2.SSS1.p3.10.m10.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.10.m10.2c">(s_{u},p_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.10.m10.2d">( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>. We denote the entire pre-training dataset as <math alttext="\mathcal{X}_{\text{pre}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.11.m11.1"><semantics id="S4.SS2.SSS1.p3.11.m11.1a"><msub id="S4.SS2.SSS1.p3.11.m11.1.1" xref="S4.SS2.SSS1.p3.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.11.m11.1.1.2" xref="S4.SS2.SSS1.p3.11.m11.1.1.2.cmml">𝒳</mi><mtext id="S4.SS2.SSS1.p3.11.m11.1.1.3" xref="S4.SS2.SSS1.p3.11.m11.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.11.m11.1b"><apply id="S4.SS2.SSS1.p3.11.m11.1.1.cmml" xref="S4.SS2.SSS1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.11.m11.1.1.1.cmml" xref="S4.SS2.SSS1.p3.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.11.m11.1.1.2.cmml" xref="S4.SS2.SSS1.p3.11.m11.1.1.2">𝒳</ci><ci id="S4.SS2.SSS1.p3.11.m11.1.1.3a.cmml" xref="S4.SS2.SSS1.p3.11.m11.1.1.3"><mtext id="S4.SS2.SSS1.p3.11.m11.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSS1.p3.11.m11.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.11.m11.1c">\mathcal{X}_{\text{pre}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.11.m11.1d">caligraphic_X start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p4">
<p class="ltx_p" id="S4.SS2.SSS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS1.p4.1.1">Note</span>: This strategy is related to sequential pattern mining, which aims to uncover patterns for guiding sequential recommendations <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib50" title="">2019a</a>; Yap et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib66" title="">2012</a>)</cite>. However, these methods are known to generate redundant information and neglect infrequent patterns, thus failing to meet the requirements of a dataset regenerator.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Diversity-promoted Regenerator</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.1">With the aid of the pre-training task, we can now pre-train a dataset regenerator. In this paper, we employ the Transformer<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib46" title="">2017</a>)</cite> model as the main architecture of our regenerator, whose generation capabilities have been extensively validated. The dataset regenerator consists of three modules: an encoder to obtain representations of sequences in the original dataset, a decoder to regenerate the patterns, and a diversity promoter to capture the one-to-many mapping relationship. Next, we will proceed to introduce each of these modules individually.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.p2.1">The encoder consists of several stacked layers of multi-head self-attention (MHSA) and feed-forward (FFN) layers. Considering a sequence in <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.1.m1.1"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><ci id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.1.m1.1d">caligraphic_X</annotation></semantics></math>, we can get the sequence representation by:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}^{(l)}=FFN(MHSA(\mathbf{H}^{(l-1)}))," class="ltx_Math" display="block" id="S4.E1.m1.3"><semantics id="S4.E1.m1.3a"><mrow id="S4.E1.m1.3.3.1" xref="S4.E1.m1.3.3.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml"><msup id="S4.E1.m1.3.3.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml"><mi id="S4.E1.m1.3.3.1.1.3.2" xref="S4.E1.m1.3.3.1.1.3.2.cmml">𝐇</mi><mrow id="S4.E1.m1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml"><mo id="S4.E1.m1.1.1.1.3.1" stretchy="false" xref="S4.E1.m1.3.3.1.1.3.cmml">(</mo><mi id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml">l</mi><mo id="S4.E1.m1.1.1.1.3.2" stretchy="false" xref="S4.E1.m1.3.3.1.1.3.cmml">)</mo></mrow></msup><mo id="S4.E1.m1.3.3.1.1.2" xref="S4.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.3.3.1.1.1" xref="S4.E1.m1.3.3.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.3.cmml">F</mi><mo id="S4.E1.m1.3.3.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.4" xref="S4.E1.m1.3.3.1.1.1.4.cmml">F</mi><mo id="S4.E1.m1.3.3.1.1.1.2a" xref="S4.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.5" xref="S4.E1.m1.3.3.1.1.1.5.cmml">N</mi><mo id="S4.E1.m1.3.3.1.1.1.2b" xref="S4.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml">M</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.4" xref="S4.E1.m1.3.3.1.1.1.1.1.1.4.cmml">H</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.2a" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.5" xref="S4.E1.m1.3.3.1.1.1.1.1.1.5.cmml">S</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.2b" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.6" xref="S4.E1.m1.3.3.1.1.1.1.1.1.6.cmml">A</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.2c" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝐇</mi><mrow id="S4.E1.m1.2.2.1.1" xref="S4.E1.m1.2.2.1.1.1.cmml"><mo id="S4.E1.m1.2.2.1.1.2" stretchy="false" xref="S4.E1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.2.2.1.1.1" xref="S4.E1.m1.2.2.1.1.1.cmml"><mi id="S4.E1.m1.2.2.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S4.E1.m1.2.2.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E1.m1.2.2.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E1.m1.2.2.1.1.3" stretchy="false" xref="S4.E1.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.3.3.1.2" xref="S4.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.3b"><apply id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1"><eq id="S4.E1.m1.3.3.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.2"></eq><apply id="S4.E1.m1.3.3.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.3.1.cmml" xref="S4.E1.m1.3.3.1.1.3">superscript</csymbol><ci id="S4.E1.m1.3.3.1.1.3.2.cmml" xref="S4.E1.m1.3.3.1.1.3.2">𝐇</ci><ci id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E1.m1.3.3.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2"></times><ci id="S4.E1.m1.3.3.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.3">𝐹</ci><ci id="S4.E1.m1.3.3.1.1.1.4.cmml" xref="S4.E1.m1.3.3.1.1.1.4">𝐹</ci><ci id="S4.E1.m1.3.3.1.1.1.5.cmml" xref="S4.E1.m1.3.3.1.1.1.5">𝑁</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2"></times><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3">𝑀</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.4">𝐻</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.5.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.5">𝑆</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.6.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.6">𝐴</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝐇</ci><apply id="S4.E1.m1.2.2.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1"><minus id="S4.E1.m1.2.2.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1"></minus><ci id="S4.E1.m1.2.2.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.2">𝑙</ci><cn id="S4.E1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.E1.m1.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.3c">\mathbf{H}^{(l)}=FFN(MHSA(\mathbf{H}^{(l-1)})),</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.3d">bold_H start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = italic_F italic_F italic_N ( italic_M italic_H italic_S italic_A ( bold_H start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p2.5">where <math alttext="\mathbf{H}^{(l-1)}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.2.m1.1"><semantics id="S4.SS2.SSS2.p2.2.m1.1a"><mrow id="S4.SS2.SSS2.p2.2.m1.1.2" xref="S4.SS2.SSS2.p2.2.m1.1.2.cmml"><msup id="S4.SS2.SSS2.p2.2.m1.1.2.2" xref="S4.SS2.SSS2.p2.2.m1.1.2.2.cmml"><mi id="S4.SS2.SSS2.p2.2.m1.1.2.2.2" xref="S4.SS2.SSS2.p2.2.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S4.SS2.SSS2.p2.2.m1.1.1.1.1" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.SS2.SSS2.p2.2.m1.1.2.1" xref="S4.SS2.SSS2.p2.2.m1.1.2.1.cmml">∈</mo><msup id="S4.SS2.SSS2.p2.2.m1.1.2.3" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.cmml"><mi id="S4.SS2.SSS2.p2.2.m1.1.2.3.2" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS2.p2.2.m1.1.2.3.3" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3.cmml"><mi id="S4.SS2.SSS2.p2.2.m1.1.2.3.3.2" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3.2.cmml">N</mi><mo id="S4.SS2.SSS2.p2.2.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS2.p2.2.m1.1.2.3.3.3" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m1.1b"><apply id="S4.SS2.SSS2.p2.2.m1.1.2.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2"><in id="S4.SS2.SSS2.p2.2.m1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.1"></in><apply id="S4.SS2.SSS2.p2.2.m1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.2">superscript</csymbol><ci id="S4.SS2.SSS2.p2.2.m1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.2.2">𝐇</ci><apply id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1"><minus id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p2.2.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS2.SSS2.p2.2.m1.1.2.3.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m1.1.2.3.1.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.3">superscript</csymbol><ci id="S4.SS2.SSS2.p2.2.m1.1.2.3.2.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.2">ℝ</ci><apply id="S4.SS2.SSS2.p2.2.m1.1.2.3.3.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3"><times id="S4.SS2.SSS2.p2.2.m1.1.2.3.3.1.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3.1"></times><ci id="S4.SS2.SSS2.p2.2.m1.1.2.3.3.2.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3.2">𝑁</ci><ci id="S4.SS2.SSS2.p2.2.m1.1.2.3.3.3.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m1.1c">\mathbf{H}^{(l-1)}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.2.m1.1d">bold_H start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the output at the <math alttext="(l-1)" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.3.m2.1"><semantics id="S4.SS2.SSS2.p2.3.m2.1a"><mrow id="S4.SS2.SSS2.p2.3.m2.1.1.1" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.cmml"><mo id="S4.SS2.SSS2.p2.3.m2.1.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p2.3.m2.1.1.1.1" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.3.m2.1.1.1.1.2" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS2.p2.3.m2.1.1.1.1.1" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS2.p2.3.m2.1.1.1.1.3" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS2.p2.3.m2.1.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.3.m2.1b"><apply id="S4.SS2.SSS2.p2.3.m2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m2.1.1.1"><minus id="S4.SS2.SSS2.p2.3.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.1"></minus><ci id="S4.SS2.SSS2.p2.3.m2.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS2.p2.3.m2.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p2.3.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.3.m2.1c">(l-1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.3.m2.1d">( italic_l - 1 )</annotation></semantics></math>-th layer, and <math alttext="\mathbf{H}^{(0)}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.4.m3.1"><semantics id="S4.SS2.SSS2.p2.4.m3.1a"><msup id="S4.SS2.SSS2.p2.4.m3.1.2" xref="S4.SS2.SSS2.p2.4.m3.1.2.cmml"><mi id="S4.SS2.SSS2.p2.4.m3.1.2.2" xref="S4.SS2.SSS2.p2.4.m3.1.2.2.cmml">𝐇</mi><mrow id="S4.SS2.SSS2.p2.4.m3.1.1.1.3" xref="S4.SS2.SSS2.p2.4.m3.1.2.cmml"><mo id="S4.SS2.SSS2.p2.4.m3.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS2.p2.4.m3.1.2.cmml">(</mo><mn id="S4.SS2.SSS2.p2.4.m3.1.1.1.1" xref="S4.SS2.SSS2.p2.4.m3.1.1.1.1.cmml">0</mn><mo id="S4.SS2.SSS2.p2.4.m3.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS2.p2.4.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.4.m3.1b"><apply id="S4.SS2.SSS2.p2.4.m3.1.2.cmml" xref="S4.SS2.SSS2.p2.4.m3.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.4.m3.1.2.1.cmml" xref="S4.SS2.SSS2.p2.4.m3.1.2">superscript</csymbol><ci id="S4.SS2.SSS2.p2.4.m3.1.2.2.cmml" xref="S4.SS2.SSS2.p2.4.m3.1.2.2">𝐇</ci><cn id="S4.SS2.SSS2.p2.4.m3.1.1.1.1.cmml" type="integer" xref="S4.SS2.SSS2.p2.4.m3.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.4.m3.1c">\mathbf{H}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.4.m3.1d">bold_H start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> is item embeddings with added learnable positional encoding. As for the decoder, it takes patterns in the regenerated dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.5.m4.1"><semantics id="S4.SS2.SSS2.p2.5.m4.1a"><msup id="S4.SS2.SSS2.p2.5.m4.1.1" xref="S4.SS2.SSS2.p2.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.5.m4.1.1.2" xref="S4.SS2.SSS2.p2.5.m4.1.1.2.cmml">𝒳</mi><mo id="S4.SS2.SSS2.p2.5.m4.1.1.3" xref="S4.SS2.SSS2.p2.5.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.5.m4.1b"><apply id="S4.SS2.SSS2.p2.5.m4.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.5.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p2.5.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1.2">𝒳</ci><ci id="S4.SS2.SSS2.p2.5.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.5.m4.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.5.m4.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as input. The objective of the decoder is to reconstruct the pattern given the sequence representations from the encoder:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{recon}}=-\sum_{(s_{u},p_{i})}^{|\mathcal{X}_{\text{pre}}|}\sum_{t=1}^%
{T}\log P(p_{it}|\mathbf{h}^{(l)}_{u},\hat{p}_{&lt;t})," class="ltx_Math" display="block" id="S4.E2.m1.5"><semantics id="S4.E2.m1.5a"><mrow id="S4.E2.m1.5.5.1" xref="S4.E2.m1.5.5.1.1.cmml"><mrow id="S4.E2.m1.5.5.1.1" xref="S4.E2.m1.5.5.1.1.cmml"><msub id="S4.E2.m1.5.5.1.1.3" xref="S4.E2.m1.5.5.1.1.3.cmml"><mi id="S4.E2.m1.5.5.1.1.3.2" xref="S4.E2.m1.5.5.1.1.3.2.cmml">L</mi><mtext id="S4.E2.m1.5.5.1.1.3.3" xref="S4.E2.m1.5.5.1.1.3.3a.cmml">recon</mtext></msub><mo id="S4.E2.m1.5.5.1.1.2" xref="S4.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.5.5.1.1.1" xref="S4.E2.m1.5.5.1.1.1.cmml"><mo id="S4.E2.m1.5.5.1.1.1a" xref="S4.E2.m1.5.5.1.1.1.cmml">−</mo><mrow id="S4.E2.m1.5.5.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.cmml"><munderover id="S4.E2.m1.5.5.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.E2.m1.5.5.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E2.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.3.cmml"><mo id="S4.E2.m1.2.2.2.2.3" stretchy="false" xref="S4.E2.m1.2.2.2.3.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E2.m1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.E2.m1.2.2.2.2.4" xref="S4.E2.m1.2.2.2.3.cmml">,</mo><msub id="S4.E2.m1.2.2.2.2.2" xref="S4.E2.m1.2.2.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.2.2.2" xref="S4.E2.m1.2.2.2.2.2.2.cmml">p</mi><mi id="S4.E2.m1.2.2.2.2.2.3" xref="S4.E2.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E2.m1.2.2.2.2.5" stretchy="false" xref="S4.E2.m1.2.2.2.3.cmml">)</mo></mrow><mrow id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.2.cmml"><mo id="S4.E2.m1.3.3.1.1.2" stretchy="false" xref="S4.E2.m1.3.3.1.2.1.cmml">|</mo><msub id="S4.E2.m1.3.3.1.1.1" xref="S4.E2.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.3.3.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.2.cmml">𝒳</mi><mtext id="S4.E2.m1.3.3.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.3a.cmml">pre</mtext></msub><mo id="S4.E2.m1.3.3.1.1.3" stretchy="false" xref="S4.E2.m1.3.3.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E2.m1.5.5.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.cmml"><munderover id="S4.E2.m1.5.5.1.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.5.5.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.2" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.1" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E2.m1.5.5.1.1.1.1.1.2.3" xref="S4.E2.m1.5.5.1.1.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.3.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.3.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.2.cmml">p</mi><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.3.cmml">t</mi></mrow></msub><mo fence="false" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><msubsup id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi><mrow id="S4.E2.m1.4.4.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.4.4.1.3.1" stretchy="false" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E2.m1.4.4.1.1" xref="S4.E2.m1.4.4.1.1.cmml">l</mi><mo id="S4.E2.m1.4.4.1.3.2" stretchy="false" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">p</mi><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml"></mi><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">&lt;</mo><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.5.5.1.2" xref="S4.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.5b"><apply id="S4.E2.m1.5.5.1.1.cmml" xref="S4.E2.m1.5.5.1"><eq id="S4.E2.m1.5.5.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.2"></eq><apply id="S4.E2.m1.5.5.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.3">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.3.2">𝐿</ci><ci id="S4.E2.m1.5.5.1.1.3.3a.cmml" xref="S4.E2.m1.5.5.1.1.3.3"><mtext id="S4.E2.m1.5.5.1.1.3.3.cmml" mathsize="70%" xref="S4.E2.m1.5.5.1.1.3.3">recon</mtext></ci></apply><apply id="S4.E2.m1.5.5.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1"><minus id="S4.E2.m1.5.5.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1"></minus><apply id="S4.E2.m1.5.5.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1"><apply id="S4.E2.m1.5.5.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2.2.2"></sum><interval closure="open" id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.2"><apply id="S4.E2.m1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E2.m1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E2.m1.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.2.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2">𝑝</ci><ci id="S4.E2.m1.2.2.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S4.E2.m1.3.3.1.2.cmml" xref="S4.E2.m1.3.3.1.1"><abs id="S4.E2.m1.3.3.1.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2"></abs><apply id="S4.E2.m1.3.3.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.2">𝒳</ci><ci id="S4.E2.m1.3.3.1.1.1.3a.cmml" xref="S4.E2.m1.3.3.1.1.1.3"><mtext id="S4.E2.m1.3.3.1.1.1.3.cmml" mathsize="50%" xref="S4.E2.m1.3.3.1.1.1.3">pre</mtext></ci></apply></apply></apply><apply id="S4.E2.m1.5.5.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1"><apply id="S4.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.2"></sum><apply id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3"><eq id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.5.5.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E2.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1"><times id="S4.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3"><log id="S4.E2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.1"></log><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.2">𝑝</ci><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3"><times id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply><list id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2"><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S4.E2.m1.4.4.1.1.cmml" xref="S4.E2.m1.4.4.1.1">𝑙</ci></apply><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2"><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑝</ci></apply><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3"><lt id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.1"></lt><csymbol cd="latexml" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.2">absent</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝑡</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.5c">L_{\text{recon}}=-\sum_{(s_{u},p_{i})}^{|\mathcal{X}_{\text{pre}}|}\sum_{t=1}^%
{T}\log P(p_{it}|\mathbf{h}^{(l)}_{u},\hat{p}_{&lt;t}),</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.5d">italic_L start_POSTSUBSCRIPT recon end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_X start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_log italic_P ( italic_p start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT | bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p2.14">where <math alttext="(s_{u},p_{i})" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.6.m1.2"><semantics id="S4.SS2.SSS2.p2.6.m1.2a"><mrow id="S4.SS2.SSS2.p2.6.m1.2.2.2" xref="S4.SS2.SSS2.p2.6.m1.2.2.3.cmml"><mo id="S4.SS2.SSS2.p2.6.m1.2.2.2.3" stretchy="false" xref="S4.SS2.SSS2.p2.6.m1.2.2.3.cmml">(</mo><msub id="S4.SS2.SSS2.p2.6.m1.1.1.1.1" xref="S4.SS2.SSS2.p2.6.m1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.6.m1.1.1.1.1.2" xref="S4.SS2.SSS2.p2.6.m1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS2.p2.6.m1.1.1.1.1.3" xref="S4.SS2.SSS2.p2.6.m1.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS2.SSS2.p2.6.m1.2.2.2.4" xref="S4.SS2.SSS2.p2.6.m1.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS2.p2.6.m1.2.2.2.2" xref="S4.SS2.SSS2.p2.6.m1.2.2.2.2.cmml"><mi id="S4.SS2.SSS2.p2.6.m1.2.2.2.2.2" xref="S4.SS2.SSS2.p2.6.m1.2.2.2.2.2.cmml">p</mi><mi id="S4.SS2.SSS2.p2.6.m1.2.2.2.2.3" xref="S4.SS2.SSS2.p2.6.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p2.6.m1.2.2.2.5" stretchy="false" xref="S4.SS2.SSS2.p2.6.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.6.m1.2b"><interval closure="open" id="S4.SS2.SSS2.p2.6.m1.2.2.3.cmml" xref="S4.SS2.SSS2.p2.6.m1.2.2.2"><apply id="S4.SS2.SSS2.p2.6.m1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.6.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.6.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.6.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.6.m1.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.SSS2.p2.6.m1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p2.6.m1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.SS2.SSS2.p2.6.m1.2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.6.m1.2.2.2.2.1.cmml" xref="S4.SS2.SSS2.p2.6.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p2.6.m1.2.2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.6.m1.2.2.2.2.2">𝑝</ci><ci id="S4.SS2.SSS2.p2.6.m1.2.2.2.2.3.cmml" xref="S4.SS2.SSS2.p2.6.m1.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.6.m1.2c">(s_{u},p_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.6.m1.2d">( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is a sequence-pattern pair in <math alttext="\mathcal{X}_{\text{pre}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.7.m2.1"><semantics id="S4.SS2.SSS2.p2.7.m2.1a"><msub id="S4.SS2.SSS2.p2.7.m2.1.1" xref="S4.SS2.SSS2.p2.7.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.7.m2.1.1.2" xref="S4.SS2.SSS2.p2.7.m2.1.1.2.cmml">𝒳</mi><mtext id="S4.SS2.SSS2.p2.7.m2.1.1.3" xref="S4.SS2.SSS2.p2.7.m2.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.7.m2.1b"><apply id="S4.SS2.SSS2.p2.7.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.7.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.7.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p2.7.m2.1.1.2">𝒳</ci><ci id="S4.SS2.SSS2.p2.7.m2.1.1.3a.cmml" xref="S4.SS2.SSS2.p2.7.m2.1.1.3"><mtext id="S4.SS2.SSS2.p2.7.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSS2.p2.7.m2.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.7.m2.1c">\mathcal{X}_{\text{pre}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.7.m2.1d">caligraphic_X start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.8.m3.1"><semantics id="S4.SS2.SSS2.p2.8.m3.1a"><mi id="S4.SS2.SSS2.p2.8.m3.1.1" xref="S4.SS2.SSS2.p2.8.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.8.m3.1b"><ci id="S4.SS2.SSS2.p2.8.m3.1.1.cmml" xref="S4.SS2.SSS2.p2.8.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.8.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.8.m3.1d">italic_t</annotation></semantics></math> is the position in the target pattern, <math alttext="\mathbf{h}^{(l)}_{u}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.9.m4.1"><semantics id="S4.SS2.SSS2.p2.9.m4.1a"><msubsup id="S4.SS2.SSS2.p2.9.m4.1.2" xref="S4.SS2.SSS2.p2.9.m4.1.2.cmml"><mi id="S4.SS2.SSS2.p2.9.m4.1.2.2.2" xref="S4.SS2.SSS2.p2.9.m4.1.2.2.2.cmml">𝐡</mi><mi id="S4.SS2.SSS2.p2.9.m4.1.2.3" xref="S4.SS2.SSS2.p2.9.m4.1.2.3.cmml">u</mi><mrow id="S4.SS2.SSS2.p2.9.m4.1.1.1.3" xref="S4.SS2.SSS2.p2.9.m4.1.2.cmml"><mo id="S4.SS2.SSS2.p2.9.m4.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS2.p2.9.m4.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p2.9.m4.1.1.1.1" xref="S4.SS2.SSS2.p2.9.m4.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS2.p2.9.m4.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS2.p2.9.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.9.m4.1b"><apply id="S4.SS2.SSS2.p2.9.m4.1.2.cmml" xref="S4.SS2.SSS2.p2.9.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.9.m4.1.2.1.cmml" xref="S4.SS2.SSS2.p2.9.m4.1.2">subscript</csymbol><apply id="S4.SS2.SSS2.p2.9.m4.1.2.2.cmml" xref="S4.SS2.SSS2.p2.9.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.9.m4.1.2.2.1.cmml" xref="S4.SS2.SSS2.p2.9.m4.1.2">superscript</csymbol><ci id="S4.SS2.SSS2.p2.9.m4.1.2.2.2.cmml" xref="S4.SS2.SSS2.p2.9.m4.1.2.2.2">𝐡</ci><ci id="S4.SS2.SSS2.p2.9.m4.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.9.m4.1.1.1.1">𝑙</ci></apply><ci id="S4.SS2.SSS2.p2.9.m4.1.2.3.cmml" xref="S4.SS2.SSS2.p2.9.m4.1.2.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.9.m4.1c">\mathbf{h}^{(l)}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.9.m4.1d">bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the representation of the original sequence <math alttext="s_{u}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.10.m5.1"><semantics id="S4.SS2.SSS2.p2.10.m5.1a"><msub id="S4.SS2.SSS2.p2.10.m5.1.1" xref="S4.SS2.SSS2.p2.10.m5.1.1.cmml"><mi id="S4.SS2.SSS2.p2.10.m5.1.1.2" xref="S4.SS2.SSS2.p2.10.m5.1.1.2.cmml">s</mi><mi id="S4.SS2.SSS2.p2.10.m5.1.1.3" xref="S4.SS2.SSS2.p2.10.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.10.m5.1b"><apply id="S4.SS2.SSS2.p2.10.m5.1.1.cmml" xref="S4.SS2.SSS2.p2.10.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.10.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p2.10.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.10.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p2.10.m5.1.1.2">𝑠</ci><ci id="S4.SS2.SSS2.p2.10.m5.1.1.3.cmml" xref="S4.SS2.SSS2.p2.10.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.10.m5.1c">s_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.10.m5.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\hat{p}_{&lt;t}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.11.m6.1"><semantics id="S4.SS2.SSS2.p2.11.m6.1a"><msub id="S4.SS2.SSS2.p2.11.m6.1.1" xref="S4.SS2.SSS2.p2.11.m6.1.1.cmml"><mover accent="true" id="S4.SS2.SSS2.p2.11.m6.1.1.2" xref="S4.SS2.SSS2.p2.11.m6.1.1.2.cmml"><mi id="S4.SS2.SSS2.p2.11.m6.1.1.2.2" xref="S4.SS2.SSS2.p2.11.m6.1.1.2.2.cmml">p</mi><mo id="S4.SS2.SSS2.p2.11.m6.1.1.2.1" xref="S4.SS2.SSS2.p2.11.m6.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS2.SSS2.p2.11.m6.1.1.3" xref="S4.SS2.SSS2.p2.11.m6.1.1.3.cmml"><mi id="S4.SS2.SSS2.p2.11.m6.1.1.3.2" xref="S4.SS2.SSS2.p2.11.m6.1.1.3.2.cmml"></mi><mo id="S4.SS2.SSS2.p2.11.m6.1.1.3.1" xref="S4.SS2.SSS2.p2.11.m6.1.1.3.1.cmml">&lt;</mo><mi id="S4.SS2.SSS2.p2.11.m6.1.1.3.3" xref="S4.SS2.SSS2.p2.11.m6.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.11.m6.1b"><apply id="S4.SS2.SSS2.p2.11.m6.1.1.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.11.m6.1.1.1.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p2.11.m6.1.1.2.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1.2"><ci id="S4.SS2.SSS2.p2.11.m6.1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1.2.1">^</ci><ci id="S4.SS2.SSS2.p2.11.m6.1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1.2.2">𝑝</ci></apply><apply id="S4.SS2.SSS2.p2.11.m6.1.1.3.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1.3"><lt id="S4.SS2.SSS2.p2.11.m6.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1.3.1"></lt><csymbol cd="latexml" id="S4.SS2.SSS2.p2.11.m6.1.1.3.2.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1.3.2">absent</csymbol><ci id="S4.SS2.SSS2.p2.11.m6.1.1.3.3.cmml" xref="S4.SS2.SSS2.p2.11.m6.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.11.m6.1c">\hat{p}_{&lt;t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.11.m6.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the pattern generated before <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.12.m7.1"><semantics id="S4.SS2.SSS2.p2.12.m7.1a"><mi id="S4.SS2.SSS2.p2.12.m7.1.1" xref="S4.SS2.SSS2.p2.12.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.12.m7.1b"><ci id="S4.SS2.SSS2.p2.12.m7.1.1.cmml" xref="S4.SS2.SSS2.p2.12.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.12.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.12.m7.1d">italic_t</annotation></semantics></math>, and <math alttext="P" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.13.m8.1"><semantics id="S4.SS2.SSS2.p2.13.m8.1a"><mi id="S4.SS2.SSS2.p2.13.m8.1.1" xref="S4.SS2.SSS2.p2.13.m8.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.13.m8.1b"><ci id="S4.SS2.SSS2.p2.13.m8.1.1.cmml" xref="S4.SS2.SSS2.p2.13.m8.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.13.m8.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.13.m8.1d">italic_P</annotation></semantics></math> is the prediction probability for the target item <math alttext="p_{it}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.14.m9.1"><semantics id="S4.SS2.SSS2.p2.14.m9.1a"><msub id="S4.SS2.SSS2.p2.14.m9.1.1" xref="S4.SS2.SSS2.p2.14.m9.1.1.cmml"><mi id="S4.SS2.SSS2.p2.14.m9.1.1.2" xref="S4.SS2.SSS2.p2.14.m9.1.1.2.cmml">p</mi><mrow id="S4.SS2.SSS2.p2.14.m9.1.1.3" xref="S4.SS2.SSS2.p2.14.m9.1.1.3.cmml"><mi id="S4.SS2.SSS2.p2.14.m9.1.1.3.2" xref="S4.SS2.SSS2.p2.14.m9.1.1.3.2.cmml">i</mi><mo id="S4.SS2.SSS2.p2.14.m9.1.1.3.1" xref="S4.SS2.SSS2.p2.14.m9.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p2.14.m9.1.1.3.3" xref="S4.SS2.SSS2.p2.14.m9.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.14.m9.1b"><apply id="S4.SS2.SSS2.p2.14.m9.1.1.cmml" xref="S4.SS2.SSS2.p2.14.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.14.m9.1.1.1.cmml" xref="S4.SS2.SSS2.p2.14.m9.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.14.m9.1.1.2.cmml" xref="S4.SS2.SSS2.p2.14.m9.1.1.2">𝑝</ci><apply id="S4.SS2.SSS2.p2.14.m9.1.1.3.cmml" xref="S4.SS2.SSS2.p2.14.m9.1.1.3"><times id="S4.SS2.SSS2.p2.14.m9.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.14.m9.1.1.3.1"></times><ci id="S4.SS2.SSS2.p2.14.m9.1.1.3.2.cmml" xref="S4.SS2.SSS2.p2.14.m9.1.1.3.2">𝑖</ci><ci id="S4.SS2.SSS2.p2.14.m9.1.1.3.3.cmml" xref="S4.SS2.SSS2.p2.14.m9.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.14.m9.1c">p_{it}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.14.m9.1d">italic_p start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p3">
<p class="ltx_p" id="S4.SS2.SSS2.p3.1">However, as mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS1" title="4.2.1. Construction of Pre-training Task ‣ 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.2.1</span></a>, multiple patterns can be extracted from a sequence, which presents challenges during the training process. For instance, a sequence like (1, 2, 3, 4, 5) may yield two distinct patterns, namely (1, 2) and (4, 5). Consequently, this can introduce conflicts during training, thereby impeding the convergence of the dataset regenerator. To address this one-to-many mapping issue, we further propose a diversity promoter.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p4">
<p class="ltx_p" id="S4.SS2.SSS2.p4.6">Specifically, we employ a more aggressive approach to adaptively regulate the impact of the original sequence during the decoding stage by incorporating information about the target pattern. First, we project the memory <math alttext="\mathbf{m}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.1.m1.1"><semantics id="S4.SS2.SSS2.p4.1.m1.1a"><mrow id="S4.SS2.SSS2.p4.1.m1.1.1" xref="S4.SS2.SSS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p4.1.m1.1.1.2" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.cmml">𝐦</mi><mo id="S4.SS2.SSS2.p4.1.m1.1.1.1" xref="S4.SS2.SSS2.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS2.p4.1.m1.1.1.3" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p4.1.m1.1.1.3.2" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.SSS2.p4.1.m1.1.1.3.3" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.1.m1.1b"><apply id="S4.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1"><in id="S4.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.1"></in><ci id="S4.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2">𝐦</ci><apply id="S4.SS2.SSS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.2">ℝ</ci><ci id="S4.SS2.SSS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.1.m1.1c">\mathbf{m}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.1.m1.1d">bold_m ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> (representations of the original sequence) generated by the encoder into K distinct vector spaces, i.e., <math alttext="\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K}\}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.2.m2.4"><semantics id="S4.SS2.SSS2.p4.2.m2.4a"><mrow id="S4.SS2.SSS2.p4.2.m2.4.4.3" xref="S4.SS2.SSS2.p4.2.m2.4.4.4.cmml"><mo id="S4.SS2.SSS2.p4.2.m2.4.4.3.4" stretchy="false" xref="S4.SS2.SSS2.p4.2.m2.4.4.4.cmml">{</mo><msubsup id="S4.SS2.SSS2.p4.2.m2.2.2.1.1" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1.cmml"><mi id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.2" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.2.cmml">𝐦</mi><mn id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.3" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1.3.cmml">1</mn><mo id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.3" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.SSS2.p4.2.m2.4.4.3.5" xref="S4.SS2.SSS2.p4.2.m2.4.4.4.cmml">,</mo><msubsup id="S4.SS2.SSS2.p4.2.m2.3.3.2.2" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2.cmml"><mi id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.2" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.2.cmml">𝐦</mi><mn id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.3" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2.3.cmml">2</mn><mo id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.3" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.SSS2.p4.2.m2.4.4.3.6" xref="S4.SS2.SSS2.p4.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS2.SSS2.p4.2.m2.1.1" mathvariant="normal" xref="S4.SS2.SSS2.p4.2.m2.1.1.cmml">…</mi><mo id="S4.SS2.SSS2.p4.2.m2.4.4.3.7" xref="S4.SS2.SSS2.p4.2.m2.4.4.4.cmml">,</mo><msubsup id="S4.SS2.SSS2.p4.2.m2.4.4.3.3" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3.cmml"><mi id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.2" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.2.cmml">𝐦</mi><mi id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.3" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3.3.cmml">K</mi><mo id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.3" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.SSS2.p4.2.m2.4.4.3.8" stretchy="false" xref="S4.SS2.SSS2.p4.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.2.m2.4b"><set id="S4.SS2.SSS2.p4.2.m2.4.4.4.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3"><apply id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.2">𝐦</ci><ci id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.3.cmml" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1.2.3">′</ci></apply><cn id="S4.SS2.SSS2.p4.2.m2.2.2.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p4.2.m2.2.2.1.1.3">1</cn></apply><apply id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2">subscript</csymbol><apply id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2">superscript</csymbol><ci id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.2">𝐦</ci><ci id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2.2.3">′</ci></apply><cn id="S4.SS2.SSS2.p4.2.m2.3.3.2.2.3.cmml" type="integer" xref="S4.SS2.SSS2.p4.2.m2.3.3.2.2.3">2</cn></apply><ci id="S4.SS2.SSS2.p4.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.1.1">…</ci><apply id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3">subscript</csymbol><apply id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3">superscript</csymbol><ci id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.2">𝐦</ci><ci id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.3.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3.2.3">′</ci></apply><ci id="S4.SS2.SSS2.p4.2.m2.4.4.3.3.3.cmml" xref="S4.SS2.SSS2.p4.2.m2.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.2.m2.4c">\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.2.m2.4d">{ bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathbf{m}^{\prime}_{k}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.3.m3.1"><semantics id="S4.SS2.SSS2.p4.3.m3.1a"><mrow id="S4.SS2.SSS2.p4.3.m3.1.1" xref="S4.SS2.SSS2.p4.3.m3.1.1.cmml"><msubsup id="S4.SS2.SSS2.p4.3.m3.1.1.2" xref="S4.SS2.SSS2.p4.3.m3.1.1.2.cmml"><mi id="S4.SS2.SSS2.p4.3.m3.1.1.2.2.2" xref="S4.SS2.SSS2.p4.3.m3.1.1.2.2.2.cmml">𝐦</mi><mi id="S4.SS2.SSS2.p4.3.m3.1.1.2.3" xref="S4.SS2.SSS2.p4.3.m3.1.1.2.3.cmml">k</mi><mo id="S4.SS2.SSS2.p4.3.m3.1.1.2.2.3" xref="S4.SS2.SSS2.p4.3.m3.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.SSS2.p4.3.m3.1.1.1" xref="S4.SS2.SSS2.p4.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS2.p4.3.m3.1.1.3" xref="S4.SS2.SSS2.p4.3.m3.1.1.3.cmml"><mi id="S4.SS2.SSS2.p4.3.m3.1.1.3.2" xref="S4.SS2.SSS2.p4.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.SSS2.p4.3.m3.1.1.3.3" xref="S4.SS2.SSS2.p4.3.m3.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.3.m3.1b"><apply id="S4.SS2.SSS2.p4.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1"><in id="S4.SS2.SSS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.1"></in><apply id="S4.SS2.SSS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.3.m3.1.1.2.1.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.2">subscript</csymbol><apply id="S4.SS2.SSS2.p4.3.m3.1.1.2.2.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.3.m3.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.2">superscript</csymbol><ci id="S4.SS2.SSS2.p4.3.m3.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.2.2.2">𝐦</ci><ci id="S4.SS2.SSS2.p4.3.m3.1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.2.2.3">′</ci></apply><ci id="S4.SS2.SSS2.p4.3.m3.1.1.2.3.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S4.SS2.SSS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.3.m3.1.1.3.1.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS2.p4.3.m3.1.1.3.2.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.3.2">ℝ</ci><ci id="S4.SS2.SSS2.p4.3.m3.1.1.3.3.cmml" xref="S4.SS2.SSS2.p4.3.m3.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.3.m3.1c">\mathbf{m}^{\prime}_{k}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.3.m3.1d">bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. This projection enables the acquisition of memories with diverse semantic information. Ideally, different target patterns should match distinct memories. To achieve this, we additionally introduce a Transformer encoder to encode the target patterns and obtain <math alttext="\mathbf{h}^{(l)}_{\text{pattern}}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.4.m4.1"><semantics id="S4.SS2.SSS2.p4.4.m4.1a"><mrow id="S4.SS2.SSS2.p4.4.m4.1.2" xref="S4.SS2.SSS2.p4.4.m4.1.2.cmml"><msubsup id="S4.SS2.SSS2.p4.4.m4.1.2.2" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.cmml"><mi id="S4.SS2.SSS2.p4.4.m4.1.2.2.2.2" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.2.2.cmml">𝐡</mi><mtext id="S4.SS2.SSS2.p4.4.m4.1.2.2.3" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.3a.cmml">pattern</mtext><mrow id="S4.SS2.SSS2.p4.4.m4.1.1.1.3" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.cmml"><mo id="S4.SS2.SSS2.p4.4.m4.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.cmml">(</mo><mi id="S4.SS2.SSS2.p4.4.m4.1.1.1.1" xref="S4.SS2.SSS2.p4.4.m4.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS2.p4.4.m4.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS2.p4.4.m4.1.2.1" xref="S4.SS2.SSS2.p4.4.m4.1.2.1.cmml">∈</mo><msup id="S4.SS2.SSS2.p4.4.m4.1.2.3" xref="S4.SS2.SSS2.p4.4.m4.1.2.3.cmml"><mi id="S4.SS2.SSS2.p4.4.m4.1.2.3.2" xref="S4.SS2.SSS2.p4.4.m4.1.2.3.2.cmml">ℝ</mi><mi id="S4.SS2.SSS2.p4.4.m4.1.2.3.3" xref="S4.SS2.SSS2.p4.4.m4.1.2.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.4.m4.1b"><apply id="S4.SS2.SSS2.p4.4.m4.1.2.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2"><in id="S4.SS2.SSS2.p4.4.m4.1.2.1.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.1"></in><apply id="S4.SS2.SSS2.p4.4.m4.1.2.2.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.4.m4.1.2.2.1.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.2">subscript</csymbol><apply id="S4.SS2.SSS2.p4.4.m4.1.2.2.2.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.4.m4.1.2.2.2.1.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.2">superscript</csymbol><ci id="S4.SS2.SSS2.p4.4.m4.1.2.2.2.2.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.2.2">𝐡</ci><ci id="S4.SS2.SSS2.p4.4.m4.1.1.1.1.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.1.1.1">𝑙</ci></apply><ci id="S4.SS2.SSS2.p4.4.m4.1.2.2.3a.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.3"><mtext id="S4.SS2.SSS2.p4.4.m4.1.2.2.3.cmml" mathsize="70%" xref="S4.SS2.SSS2.p4.4.m4.1.2.2.3">pattern</mtext></ci></apply><apply id="S4.SS2.SSS2.p4.4.m4.1.2.3.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.4.m4.1.2.3.1.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.3">superscript</csymbol><ci id="S4.SS2.SSS2.p4.4.m4.1.2.3.2.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.3.2">ℝ</ci><ci id="S4.SS2.SSS2.p4.4.m4.1.2.3.3.cmml" xref="S4.SS2.SSS2.p4.4.m4.1.2.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.4.m4.1c">\mathbf{h}^{(l)}_{\text{pattern}}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.4.m4.1d">bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT pattern end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. Notably, it is imperative to exercise caution when incorporating <math alttext="\mathbf{h}^{(l)}_{\text{pattern}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.5.m5.1"><semantics id="S4.SS2.SSS2.p4.5.m5.1a"><msubsup id="S4.SS2.SSS2.p4.5.m5.1.2" xref="S4.SS2.SSS2.p4.5.m5.1.2.cmml"><mi id="S4.SS2.SSS2.p4.5.m5.1.2.2.2" xref="S4.SS2.SSS2.p4.5.m5.1.2.2.2.cmml">𝐡</mi><mtext id="S4.SS2.SSS2.p4.5.m5.1.2.3" xref="S4.SS2.SSS2.p4.5.m5.1.2.3a.cmml">pattern</mtext><mrow id="S4.SS2.SSS2.p4.5.m5.1.1.1.3" xref="S4.SS2.SSS2.p4.5.m5.1.2.cmml"><mo id="S4.SS2.SSS2.p4.5.m5.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS2.p4.5.m5.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p4.5.m5.1.1.1.1" xref="S4.SS2.SSS2.p4.5.m5.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS2.p4.5.m5.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS2.p4.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.5.m5.1b"><apply id="S4.SS2.SSS2.p4.5.m5.1.2.cmml" xref="S4.SS2.SSS2.p4.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.5.m5.1.2.1.cmml" xref="S4.SS2.SSS2.p4.5.m5.1.2">subscript</csymbol><apply id="S4.SS2.SSS2.p4.5.m5.1.2.2.cmml" xref="S4.SS2.SSS2.p4.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.5.m5.1.2.2.1.cmml" xref="S4.SS2.SSS2.p4.5.m5.1.2">superscript</csymbol><ci id="S4.SS2.SSS2.p4.5.m5.1.2.2.2.cmml" xref="S4.SS2.SSS2.p4.5.m5.1.2.2.2">𝐡</ci><ci id="S4.SS2.SSS2.p4.5.m5.1.1.1.1.cmml" xref="S4.SS2.SSS2.p4.5.m5.1.1.1.1">𝑙</ci></apply><ci id="S4.SS2.SSS2.p4.5.m5.1.2.3a.cmml" xref="S4.SS2.SSS2.p4.5.m5.1.2.3"><mtext id="S4.SS2.SSS2.p4.5.m5.1.2.3.cmml" mathsize="70%" xref="S4.SS2.SSS2.p4.5.m5.1.2.3">pattern</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.5.m5.1c">\mathbf{h}^{(l)}_{\text{pattern}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.5.m5.1d">bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT pattern end_POSTSUBSCRIPT</annotation></semantics></math> into the decoder, otherwise the model may inadvertently collapse into an identity mapping function by simply duplicating the input. Therefore, we compress <math alttext="\mathbf{h}^{(l)}_{\text{pattern}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.6.m6.1"><semantics id="S4.SS2.SSS2.p4.6.m6.1a"><msubsup id="S4.SS2.SSS2.p4.6.m6.1.2" xref="S4.SS2.SSS2.p4.6.m6.1.2.cmml"><mi id="S4.SS2.SSS2.p4.6.m6.1.2.2.2" xref="S4.SS2.SSS2.p4.6.m6.1.2.2.2.cmml">𝐡</mi><mtext id="S4.SS2.SSS2.p4.6.m6.1.2.3" xref="S4.SS2.SSS2.p4.6.m6.1.2.3a.cmml">pattern</mtext><mrow id="S4.SS2.SSS2.p4.6.m6.1.1.1.3" xref="S4.SS2.SSS2.p4.6.m6.1.2.cmml"><mo id="S4.SS2.SSS2.p4.6.m6.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS2.p4.6.m6.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p4.6.m6.1.1.1.1" xref="S4.SS2.SSS2.p4.6.m6.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS2.p4.6.m6.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS2.p4.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.6.m6.1b"><apply id="S4.SS2.SSS2.p4.6.m6.1.2.cmml" xref="S4.SS2.SSS2.p4.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.6.m6.1.2.1.cmml" xref="S4.SS2.SSS2.p4.6.m6.1.2">subscript</csymbol><apply id="S4.SS2.SSS2.p4.6.m6.1.2.2.cmml" xref="S4.SS2.SSS2.p4.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.6.m6.1.2.2.1.cmml" xref="S4.SS2.SSS2.p4.6.m6.1.2">superscript</csymbol><ci id="S4.SS2.SSS2.p4.6.m6.1.2.2.2.cmml" xref="S4.SS2.SSS2.p4.6.m6.1.2.2.2">𝐡</ci><ci id="S4.SS2.SSS2.p4.6.m6.1.1.1.1.cmml" xref="S4.SS2.SSS2.p4.6.m6.1.1.1.1">𝑙</ci></apply><ci id="S4.SS2.SSS2.p4.6.m6.1.2.3a.cmml" xref="S4.SS2.SSS2.p4.6.m6.1.2.3"><mtext id="S4.SS2.SSS2.p4.6.m6.1.2.3.cmml" mathsize="70%" xref="S4.SS2.SSS2.p4.6.m6.1.2.3">pattern</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.6.m6.1c">\mathbf{h}^{(l)}_{\text{pattern}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.6.m6.1d">bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT pattern end_POSTSUBSCRIPT</annotation></semantics></math> into a probability vector by:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\pi}=\text{Softmax}(\text{MLP}(\mathbf{h}^{(l)}_{\text{pattern}}))," class="ltx_Math" display="block" id="S4.E3.m1.2"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2.1" xref="S4.E3.m1.2.2.1.1.cmml"><mrow id="S4.E3.m1.2.2.1.1" xref="S4.E3.m1.2.2.1.1.cmml"><mi id="S4.E3.m1.2.2.1.1.3" xref="S4.E3.m1.2.2.1.1.3.cmml">π</mi><mo id="S4.E3.m1.2.2.1.1.2" xref="S4.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.2.2.1.1.1" xref="S4.E3.m1.2.2.1.1.1.cmml"><mtext id="S4.E3.m1.2.2.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.3a.cmml">Softmax</mtext><mo id="S4.E3.m1.2.2.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml"><mtext id="S4.E3.m1.2.2.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.3a.cmml">MLP</mtext><mo id="S4.E3.m1.2.2.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mtext id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3a.cmml">pattern</mtext><mrow id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.3.1" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">l</mi><mo id="S4.E3.m1.1.1.1.3.2" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.1.2" xref="S4.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.1.1.cmml" xref="S4.E3.m1.2.2.1"><eq id="S4.E3.m1.2.2.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2"></eq><ci id="S4.E3.m1.2.2.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.3">𝜋</ci><apply id="S4.E3.m1.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1"><times id="S4.E3.m1.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.2"></times><ci id="S4.E3.m1.2.2.1.1.1.3a.cmml" xref="S4.E3.m1.2.2.1.1.1.3"><mtext id="S4.E3.m1.2.2.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.3">Softmax</mtext></ci><apply id="S4.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1"><times id="S4.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.3"><mtext id="S4.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.3">MLP</mtext></ci><apply id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝑙</ci></apply><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3"><mtext id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3">pattern</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\mathbf{\pi}=\text{Softmax}(\text{MLP}(\mathbf{h}^{(l)}_{\text{pattern}})),</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.2d">italic_π = Softmax ( MLP ( bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT pattern end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p4.9">where <math alttext="\pi=\{\mathbf{\pi}_{1},\mathbf{\pi}_{2},\dots,\mathbf{\pi}_{k},\dots,\mathbf{%
\pi}_{K}\}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.7.m1.6"><semantics id="S4.SS2.SSS2.p4.7.m1.6a"><mrow id="S4.SS2.SSS2.p4.7.m1.6.6" xref="S4.SS2.SSS2.p4.7.m1.6.6.cmml"><mi id="S4.SS2.SSS2.p4.7.m1.6.6.6" xref="S4.SS2.SSS2.p4.7.m1.6.6.6.cmml">π</mi><mo id="S4.SS2.SSS2.p4.7.m1.6.6.5" xref="S4.SS2.SSS2.p4.7.m1.6.6.5.cmml">=</mo><mrow id="S4.SS2.SSS2.p4.7.m1.6.6.4.4" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml"><mo id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.5" stretchy="false" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml">{</mo><msub id="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1" xref="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.cmml"><mi id="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.2" xref="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.2.cmml">π</mi><mn id="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.3" xref="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.6" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml">,</mo><msub id="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2" xref="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.cmml"><mi id="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.2" xref="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.2.cmml">π</mi><mn id="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.3" xref="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.7" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml">,</mo><mi id="S4.SS2.SSS2.p4.7.m1.1.1" mathvariant="normal" xref="S4.SS2.SSS2.p4.7.m1.1.1.cmml">…</mi><mo id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.8" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml">,</mo><msub id="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3" xref="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.cmml"><mi id="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.2" xref="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.2.cmml">π</mi><mi id="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.3" xref="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.3.cmml">k</mi></msub><mo id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.9" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml">,</mo><mi id="S4.SS2.SSS2.p4.7.m1.2.2" mathvariant="normal" xref="S4.SS2.SSS2.p4.7.m1.2.2.cmml">…</mi><mo id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.10" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml">,</mo><msub id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.cmml"><mi id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.2" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.2.cmml">π</mi><mi id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.3" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.3.cmml">K</mi></msub><mo id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.11" stretchy="false" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.7.m1.6b"><apply id="S4.SS2.SSS2.p4.7.m1.6.6.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6"><eq id="S4.SS2.SSS2.p4.7.m1.6.6.5.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6.5"></eq><ci id="S4.SS2.SSS2.p4.7.m1.6.6.6.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6.6">𝜋</ci><set id="S4.SS2.SSS2.p4.7.m1.6.6.4.5.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4"><apply id="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.cmml" xref="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.2.cmml" xref="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.2">𝜋</ci><cn id="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p4.7.m1.3.3.1.1.1.3">1</cn></apply><apply id="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.cmml" xref="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.1.cmml" xref="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.2.cmml" xref="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.2">𝜋</ci><cn id="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.3.cmml" type="integer" xref="S4.SS2.SSS2.p4.7.m1.4.4.2.2.2.3">2</cn></apply><ci id="S4.SS2.SSS2.p4.7.m1.1.1.cmml" xref="S4.SS2.SSS2.p4.7.m1.1.1">…</ci><apply id="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.cmml" xref="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.1.cmml" xref="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.2.cmml" xref="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.2">𝜋</ci><ci id="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.3.cmml" xref="S4.SS2.SSS2.p4.7.m1.5.5.3.3.3.3">𝑘</ci></apply><ci id="S4.SS2.SSS2.p4.7.m1.2.2.cmml" xref="S4.SS2.SSS2.p4.7.m1.2.2">…</ci><apply id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.1.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4">subscript</csymbol><ci id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.2.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.2">𝜋</ci><ci id="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.3.cmml" xref="S4.SS2.SSS2.p4.7.m1.6.6.4.4.4.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.7.m1.6c">\pi=\{\mathbf{\pi}_{1},\mathbf{\pi}_{2},\dots,\mathbf{\pi}_{k},\dots,\mathbf{%
\pi}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.7.m1.6d">italic_π = { italic_π start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , … , italic_π start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathbf{\pi}_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.8.m2.1"><semantics id="S4.SS2.SSS2.p4.8.m2.1a"><msub id="S4.SS2.SSS2.p4.8.m2.1.1" xref="S4.SS2.SSS2.p4.8.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p4.8.m2.1.1.2" xref="S4.SS2.SSS2.p4.8.m2.1.1.2.cmml">π</mi><mi id="S4.SS2.SSS2.p4.8.m2.1.1.3" xref="S4.SS2.SSS2.p4.8.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.8.m2.1b"><apply id="S4.SS2.SSS2.p4.8.m2.1.1.cmml" xref="S4.SS2.SSS2.p4.8.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.8.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p4.8.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p4.8.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p4.8.m2.1.1.2">𝜋</ci><ci id="S4.SS2.SSS2.p4.8.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p4.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.8.m2.1c">\mathbf{\pi}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.8.m2.1d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the probability of choosing the <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p4.9.m3.1"><semantics id="S4.SS2.SSS2.p4.9.m3.1a"><mi id="S4.SS2.SSS2.p4.9.m3.1.1" xref="S4.SS2.SSS2.p4.9.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.9.m3.1b"><ci id="S4.SS2.SSS2.p4.9.m3.1.1.cmml" xref="S4.SS2.SSS2.p4.9.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.9.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.9.m3.1d">italic_k</annotation></semantics></math>-th memory. To ensure that each memory space receives sufficient training, we do not perform hard selection. Instead, we obtain the final memory through a weighted sum:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{m}_{\text{final}}=\sum_{k=1}^{K}\mathbf{\pi}_{k}\mathbf{m}^{\prime}_{k}." class="ltx_Math" display="block" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><msub id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.2.2.cmml">𝐦</mi><mtext id="S4.E4.m1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.3a.cmml">final</mtext></msub><mo id="S4.E4.m1.1.1.1.1.1" rspace="0.111em" xref="S4.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml"><munderover id="S4.E4.m1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.3.1.cmml"><mo id="S4.E4.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S4.E4.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E4.m1.1.1.1.1.3.1.2.3" xref="S4.E4.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.1.2.3.2" xref="S4.E4.m1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S4.E4.m1.1.1.1.1.3.1.2.3.1" xref="S4.E4.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E4.m1.1.1.1.1.3.1.2.3.3" xref="S4.E4.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m1.1.1.1.1.3.1.3" xref="S4.E4.m1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S4.E4.m1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.3.2.cmml"><msub id="S4.E4.m1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.2.cmml">π</mi><mi id="S4.E4.m1.1.1.1.1.3.2.2.3" xref="S4.E4.m1.1.1.1.1.3.2.2.3.cmml">k</mi></msub><mo id="S4.E4.m1.1.1.1.1.3.2.1" xref="S4.E4.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msubsup id="S4.E4.m1.1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2.3.2.2" xref="S4.E4.m1.1.1.1.1.3.2.3.2.2.cmml">𝐦</mi><mi id="S4.E4.m1.1.1.1.1.3.2.3.3" xref="S4.E4.m1.1.1.1.1.3.2.3.3.cmml">k</mi><mo id="S4.E4.m1.1.1.1.1.3.2.3.2.3" xref="S4.E4.m1.1.1.1.1.3.2.3.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" lspace="0em" xref="S4.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"></eq><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2">𝐦</ci><ci id="S4.E4.m1.1.1.1.1.2.3a.cmml" xref="S4.E4.m1.1.1.1.1.2.3"><mtext id="S4.E4.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.E4.m1.1.1.1.1.2.3">final</mtext></ci></apply><apply id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"><apply id="S4.E4.m1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.1.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.3.1.2.cmml" xref="S4.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.3.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.2"></sum><apply id="S4.E4.m1.1.1.1.1.3.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.3"><eq id="S4.E4.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S4.E4.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="S4.E4.m1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E4.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E4.m1.1.1.1.1.3.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3.1.3">𝐾</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2"><times id="S4.E4.m1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1"></times><apply id="S4.E4.m1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.2">𝜋</ci><ci id="S4.E4.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3">subscript</csymbol><apply id="S4.E4.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3.2.2">𝐦</ci><ci id="S4.E4.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3.2.3">′</ci></apply><ci id="S4.E4.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\mathbf{m}_{\text{final}}=\sum_{k=1}^{K}\mathbf{\pi}_{k}\mathbf{m}^{\prime}_{k}.</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">bold_m start_POSTSUBSCRIPT final end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p4.10">Ultimately, we can leverage the acquired memory to facilitate the decoding process and effectively capture the intricate one-to-many relationship between sequences and patterns.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3. </span>Dataset Regeneration with Hybrid Inference Strategy</h4>
<div class="ltx_para" id="S4.SS2.SSS3.p1">
<p class="ltx_p" id="S4.SS2.SSS3.p1.5">After pre-training, we utilize the regenerator for inference to obtain a regenerated dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.1.m1.1"><semantics id="S4.SS2.SSS3.p1.1.m1.1a"><msup id="S4.SS2.SSS3.p1.1.m1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.1.m1.1.1.2" xref="S4.SS2.SSS3.p1.1.m1.1.1.2.cmml">𝒳</mi><mo id="S4.SS2.SSS3.p1.1.m1.1.1.3" xref="S4.SS2.SSS3.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.1.m1.1b"><apply id="S4.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.2">𝒳</ci><ci id="S4.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.1.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.1.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. Specifically, we re-feed the sequences in <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.2.m2.1"><semantics id="S4.SS2.SSS3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.2.m2.1.1" xref="S4.SS2.SSS3.p1.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.2.m2.1b"><ci id="S4.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.2.m2.1d">caligraphic_X</annotation></semantics></math> into the regenerator to obtain new patterns. Due to the unavailability of target patterns, we cannot generate a category vector <math alttext="\pi" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.3.m3.1"><semantics id="S4.SS2.SSS3.p1.3.m3.1a"><mi id="S4.SS2.SSS3.p1.3.m3.1.1" xref="S4.SS2.SSS3.p1.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.3.m3.1b"><ci id="S4.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.3.m3.1d">italic_π</annotation></semantics></math> for selecting memories. As a result, we respectively input each memory directly into the decoder, leading to the generation of K patterns. Besides, we consider the following two decoding modes: <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS3.p1.5.1">Restrictive mode</span>. Decoding is limited to selecting items from the input sequence, which focuses on the exploitation of existing information from the current sequence. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS3.p1.5.2">Generative mode</span>. There are no restrictions, which allows for the exploration of patterns that may not exist in <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.4.m4.1"><semantics id="S4.SS2.SSS3.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.4.m4.1.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.4.m4.1b"><ci id="S4.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.4.m4.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.4.m4.1d">caligraphic_X</annotation></semantics></math>. For instance, suppose the original dataset contains item transition patterns like (1, 2) and (2, 6). When decoding a sequence like (1, 2, 3, 4, 5), the model may identify a high-order pattern like (1, 2, 6), which was not explicitly present in <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.5.m5.1"><semantics id="S4.SS2.SSS3.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS3.p1.5.m5.1.1" xref="S4.SS2.SSS3.p1.5.m5.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.5.m5.1b"><ci id="S4.SS2.SSS3.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.5.m5.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.5.m5.1d">caligraphic_X</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS3.p2">
<p class="ltx_p" id="S4.SS2.SSS3.p2.2">To achieve a harmonious balance between exploitation and exploration, we propose a hybrid strategy: When decoding an item, there is a probability of <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p2.1.m1.1"><semantics id="S4.SS2.SSS3.p2.1.m1.1a"><mi id="S4.SS2.SSS3.p2.1.m1.1.1" xref="S4.SS2.SSS3.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p2.1.m1.1b"><ci id="S4.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS3.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p2.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p2.1.m1.1d">italic_γ</annotation></semantics></math> to adopt the generative mode and a probability of <math alttext="1-\gamma" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p2.2.m2.1"><semantics id="S4.SS2.SSS3.p2.2.m2.1a"><mrow id="S4.SS2.SSS3.p2.2.m2.1.1" xref="S4.SS2.SSS3.p2.2.m2.1.1.cmml"><mn id="S4.SS2.SSS3.p2.2.m2.1.1.2" xref="S4.SS2.SSS3.p2.2.m2.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS3.p2.2.m2.1.1.1" xref="S4.SS2.SSS3.p2.2.m2.1.1.1.cmml">−</mo><mi id="S4.SS2.SSS3.p2.2.m2.1.1.3" xref="S4.SS2.SSS3.p2.2.m2.1.1.3.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p2.2.m2.1b"><apply id="S4.SS2.SSS3.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS3.p2.2.m2.1.1"><minus id="S4.SS2.SSS3.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS3.p2.2.m2.1.1.1"></minus><cn id="S4.SS2.SSS3.p2.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.SSS3.p2.2.m2.1.1.2">1</cn><ci id="S4.SS2.SSS3.p2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS3.p2.2.m2.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p2.2.m2.1c">1-\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p2.2.m2.1d">1 - italic_γ</annotation></semantics></math> to adopt the restrictive mode.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Model-aware Dataset Regeneration</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Since the previous regeneration process is independent of target models, the regenerated dataset may be sub-optimal for a particular target model. Hence, we extend the model-agnostic dataset regeneration process to a model-aware one. To achieve this, built upon the dataset regenerator, we further introduce a dataset personalizer to evaluate the scores of each data sample in the regenerated dataset in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS3.SSS1" title="4.3.1. Dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.3.1</span></a>. Then the dataset personalizer can be efficiently optimized by implicit differentiation introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS3.SSS2" title="4.3.2. Efficient optimization of dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.3.2</span></a>. The pipeline is detailed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#alg2" title="Algorithm 2 ‣ A.1. Pseudo Code of DR4SR and DR4SR+ ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span>Dataset personalizer</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.6">As outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S3" title="3. PROBLEM DEFINITION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, our objective is to train a dataset personalizer <math alttext="g" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.1.m1.1"><semantics id="S4.SS3.SSS1.p1.1.m1.1a"><mi id="S4.SS3.SSS1.p1.1.m1.1.1" xref="S4.SS3.SSS1.p1.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.1.m1.1b"><ci id="S4.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p1.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.1.m1.1d">italic_g</annotation></semantics></math> with parameter <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.2.m2.1"><semantics id="S4.SS3.SSS1.p1.2.m2.1a"><mi id="S4.SS3.SSS1.p1.2.m2.1.1" xref="S4.SS3.SSS1.p1.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.2.m2.1b"><ci id="S4.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.2.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.2.m2.1d">italic_ϕ</annotation></semantics></math> that can evaluate the score of each data sample <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.3.m3.1"><semantics id="S4.SS3.SSS1.p1.3.m3.1a"><mi id="S4.SS3.SSS1.p1.3.m3.1.1" xref="S4.SS3.SSS1.p1.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.3.m3.1b"><ci id="S4.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p1.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.3.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.3.m3.1d">bold_W</annotation></semantics></math> for the target model. Specifically, given a data sample of pattern <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.4.m4.1"><semantics id="S4.SS3.SSS1.p1.4.m4.1a"><mi id="S4.SS3.SSS1.p1.4.m4.1.1" xref="S4.SS3.SSS1.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.4.m4.1b"><ci id="S4.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.4.m4.1d">italic_i</annotation></semantics></math> in the position <math alttext="t" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.5.m5.1"><semantics id="S4.SS3.SSS1.p1.5.m5.1a"><mi id="S4.SS3.SSS1.p1.5.m5.1.1" xref="S4.SS3.SSS1.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.5.m5.1b"><ci id="S4.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.5.m5.1d">italic_t</annotation></semantics></math>, the score <math alttext="w_{i,t}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.6.m6.2"><semantics id="S4.SS3.SSS1.p1.6.m6.2a"><msub id="S4.SS3.SSS1.p1.6.m6.2.3" xref="S4.SS3.SSS1.p1.6.m6.2.3.cmml"><mi id="S4.SS3.SSS1.p1.6.m6.2.3.2" xref="S4.SS3.SSS1.p1.6.m6.2.3.2.cmml">w</mi><mrow id="S4.SS3.SSS1.p1.6.m6.2.2.2.4" xref="S4.SS3.SSS1.p1.6.m6.2.2.2.3.cmml"><mi id="S4.SS3.SSS1.p1.6.m6.1.1.1.1" xref="S4.SS3.SSS1.p1.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS3.SSS1.p1.6.m6.2.2.2.4.1" xref="S4.SS3.SSS1.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS3.SSS1.p1.6.m6.2.2.2.2" xref="S4.SS3.SSS1.p1.6.m6.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.6.m6.2b"><apply id="S4.SS3.SSS1.p1.6.m6.2.3.cmml" xref="S4.SS3.SSS1.p1.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.6.m6.2.3.1.cmml" xref="S4.SS3.SSS1.p1.6.m6.2.3">subscript</csymbol><ci id="S4.SS3.SSS1.p1.6.m6.2.3.2.cmml" xref="S4.SS3.SSS1.p1.6.m6.2.3.2">𝑤</ci><list id="S4.SS3.SSS1.p1.6.m6.2.2.2.3.cmml" xref="S4.SS3.SSS1.p1.6.m6.2.2.2.4"><ci id="S4.SS3.SSS1.p1.6.m6.1.1.1.1.cmml" xref="S4.SS3.SSS1.p1.6.m6.1.1.1.1">𝑖</ci><ci id="S4.SS3.SSS1.p1.6.m6.2.2.2.2.cmml" xref="S4.SS3.SSS1.p1.6.m6.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.6.m6.2c">w_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.6.m6.2d">italic_w start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> for this data sample can be computed as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{gathered}\mathbf{z}=g_{\phi}(\mathbf{h}_{t}^{i}),\\
\hat{\mathbf{z}}=\text{Softmax}((\mathbf{z}+\mathbf{G})/\tau),\\
w_{i,t}=\hat{\mathbf{z}}_{1},\end{gathered}" class="ltx_Math" display="block" id="S4.E5.m1.33"><semantics id="S4.E5.m1.33a"><mtable displaystyle="true" id="S4.E5.m1.33.33.4" rowspacing="0pt"><mtr id="S4.E5.m1.33.33.4a"><mtd id="S4.E5.m1.33.33.4b"><mrow id="S4.E5.m1.31.31.2.30.11.11.11"><mrow id="S4.E5.m1.31.31.2.30.11.11.11.1"><mi id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">𝐳</mi><mo id="S4.E5.m1.2.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.2.cmml">=</mo><mrow id="S4.E5.m1.31.31.2.30.11.11.11.1.1"><msub id="S4.E5.m1.31.31.2.30.11.11.11.1.1.3"><mi id="S4.E5.m1.3.3.3.3.3.3" xref="S4.E5.m1.3.3.3.3.3.3.cmml">g</mi><mi id="S4.E5.m1.4.4.4.4.4.4.1" xref="S4.E5.m1.4.4.4.4.4.4.1.cmml">ϕ</mi></msub><mo id="S4.E5.m1.31.31.2.30.11.11.11.1.1.2">⁢</mo><mrow id="S4.E5.m1.31.31.2.30.11.11.11.1.1.1.1"><mo id="S4.E5.m1.5.5.5.5.5.5" stretchy="false">(</mo><msubsup id="S4.E5.m1.31.31.2.30.11.11.11.1.1.1.1.1"><mi id="S4.E5.m1.6.6.6.6.6.6" xref="S4.E5.m1.6.6.6.6.6.6.cmml">𝐡</mi><mi id="S4.E5.m1.7.7.7.7.7.7.1" xref="S4.E5.m1.7.7.7.7.7.7.1.cmml">t</mi><mi id="S4.E5.m1.8.8.8.8.8.8.1" xref="S4.E5.m1.8.8.8.8.8.8.1.cmml">i</mi></msubsup><mo id="S4.E5.m1.9.9.9.9.9.9" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.10.10.10.10.10.10">,</mo></mrow></mtd></mtr><mtr id="S4.E5.m1.33.33.4c"><mtd id="S4.E5.m1.33.33.4d"><mrow id="S4.E5.m1.32.32.3.31.14.14.14"><mrow id="S4.E5.m1.32.32.3.31.14.14.14.1"><mover accent="true" id="S4.E5.m1.11.11.11.1.1.1" xref="S4.E5.m1.11.11.11.1.1.1.cmml"><mi id="S4.E5.m1.11.11.11.1.1.1.2" xref="S4.E5.m1.11.11.11.1.1.1.2.cmml">𝐳</mi><mo id="S4.E5.m1.11.11.11.1.1.1.1" xref="S4.E5.m1.11.11.11.1.1.1.1.cmml">^</mo></mover><mo id="S4.E5.m1.12.12.12.2.2.2" xref="S4.E5.m1.12.12.12.2.2.2.cmml">=</mo><mrow id="S4.E5.m1.32.32.3.31.14.14.14.1.1"><mtext id="S4.E5.m1.13.13.13.3.3.3" xref="S4.E5.m1.13.13.13.3.3.3a.cmml">Softmax</mtext><mo id="S4.E5.m1.32.32.3.31.14.14.14.1.1.2">⁢</mo><mrow id="S4.E5.m1.32.32.3.31.14.14.14.1.1.1.1"><mo id="S4.E5.m1.14.14.14.4.4.4" stretchy="false">(</mo><mrow id="S4.E5.m1.32.32.3.31.14.14.14.1.1.1.1.1"><mrow id="S4.E5.m1.32.32.3.31.14.14.14.1.1.1.1.1.1.1"><mo id="S4.E5.m1.15.15.15.5.5.5" stretchy="false">(</mo><mrow id="S4.E5.m1.32.32.3.31.14.14.14.1.1.1.1.1.1.1.1"><mi id="S4.E5.m1.16.16.16.6.6.6" xref="S4.E5.m1.16.16.16.6.6.6.cmml">𝐳</mi><mo id="S4.E5.m1.17.17.17.7.7.7" xref="S4.E5.m1.17.17.17.7.7.7.cmml">+</mo><mi id="S4.E5.m1.18.18.18.8.8.8" xref="S4.E5.m1.18.18.18.8.8.8.cmml">𝐆</mi></mrow><mo id="S4.E5.m1.19.19.19.9.9.9" stretchy="false">)</mo></mrow><mo id="S4.E5.m1.20.20.20.10.10.10" xref="S4.E5.m1.20.20.20.10.10.10.cmml">/</mo><mi id="S4.E5.m1.21.21.21.11.11.11" xref="S4.E5.m1.21.21.21.11.11.11.cmml">τ</mi></mrow><mo id="S4.E5.m1.22.22.22.12.12.12" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.23.23.23.13.13.13">,</mo></mrow></mtd></mtr><mtr id="S4.E5.m1.33.33.4e"><mtd id="S4.E5.m1.33.33.4f"><mrow id="S4.E5.m1.33.33.4.32.7.7.7"><mrow id="S4.E5.m1.33.33.4.32.7.7.7.1"><msub id="S4.E5.m1.33.33.4.32.7.7.7.1.1"><mi id="S4.E5.m1.24.24.24.1.1.1" xref="S4.E5.m1.24.24.24.1.1.1.cmml">w</mi><mrow id="S4.E5.m1.25.25.25.2.2.2.1.4" xref="S4.E5.m1.25.25.25.2.2.2.1.3.cmml"><mi id="S4.E5.m1.25.25.25.2.2.2.1.1" xref="S4.E5.m1.25.25.25.2.2.2.1.1.cmml">i</mi><mo id="S4.E5.m1.25.25.25.2.2.2.1.4.1" xref="S4.E5.m1.25.25.25.2.2.2.1.3.cmml">,</mo><mi id="S4.E5.m1.25.25.25.2.2.2.1.2" xref="S4.E5.m1.25.25.25.2.2.2.1.2.cmml">t</mi></mrow></msub><mo id="S4.E5.m1.26.26.26.3.3.3" xref="S4.E5.m1.26.26.26.3.3.3.cmml">=</mo><msub id="S4.E5.m1.33.33.4.32.7.7.7.1.2"><mover accent="true" id="S4.E5.m1.27.27.27.4.4.4" xref="S4.E5.m1.27.27.27.4.4.4.cmml"><mi id="S4.E5.m1.27.27.27.4.4.4.2" xref="S4.E5.m1.27.27.27.4.4.4.2.cmml">𝐳</mi><mo id="S4.E5.m1.27.27.27.4.4.4.1" xref="S4.E5.m1.27.27.27.4.4.4.1.cmml">^</mo></mover><mn id="S4.E5.m1.28.28.28.5.5.5.1" xref="S4.E5.m1.28.28.28.5.5.5.1.cmml">1</mn></msub></mrow><mo id="S4.E5.m1.29.29.29.6.6.6">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E5.m1.33b"><apply id="S4.E5.m1.30.30.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.30.30.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E5.m1.30.30.1.1.1.1.1.cmml"><eq id="S4.E5.m1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.2.2"></eq><ci id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1">𝐳</ci><apply id="S4.E5.m1.30.30.1.1.1.1.1.1.cmml"><times id="S4.E5.m1.30.30.1.1.1.1.1.1.2.cmml"></times><apply id="S4.E5.m1.30.30.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.30.30.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E5.m1.3.3.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3.3.3">𝑔</ci><ci id="S4.E5.m1.4.4.4.4.4.4.1.cmml" xref="S4.E5.m1.4.4.4.4.4.4.1">italic-ϕ</ci></apply><apply id="S4.E5.m1.30.30.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.30.30.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E5.m1.30.30.1.1.1.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.30.30.1.1.1.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.6.6.6.6.6.6.cmml" xref="S4.E5.m1.6.6.6.6.6.6">𝐡</ci><ci id="S4.E5.m1.7.7.7.7.7.7.1.cmml" xref="S4.E5.m1.7.7.7.7.7.7.1">𝑡</ci></apply><ci id="S4.E5.m1.8.8.8.8.8.8.1.cmml" xref="S4.E5.m1.8.8.8.8.8.8.1">𝑖</ci></apply></apply></apply><apply id="S4.E5.m1.30.30.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.30.30.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E5.m1.30.30.1.1.1.2.2.1.1.cmml"><eq id="S4.E5.m1.12.12.12.2.2.2.cmml" xref="S4.E5.m1.12.12.12.2.2.2"></eq><apply id="S4.E5.m1.11.11.11.1.1.1.cmml" xref="S4.E5.m1.11.11.11.1.1.1"><ci id="S4.E5.m1.11.11.11.1.1.1.1.cmml" xref="S4.E5.m1.11.11.11.1.1.1.1">^</ci><ci id="S4.E5.m1.11.11.11.1.1.1.2.cmml" xref="S4.E5.m1.11.11.11.1.1.1.2">𝐳</ci></apply><apply id="S4.E5.m1.30.30.1.1.1.2.2.1.1.1.cmml"><times id="S4.E5.m1.30.30.1.1.1.2.2.1.1.1.2.cmml"></times><ci id="S4.E5.m1.13.13.13.3.3.3a.cmml" xref="S4.E5.m1.13.13.13.3.3.3"><mtext id="S4.E5.m1.13.13.13.3.3.3.cmml" xref="S4.E5.m1.13.13.13.3.3.3">Softmax</mtext></ci><apply id="S4.E5.m1.30.30.1.1.1.2.2.1.1.1.1.1.1.cmml"><divide id="S4.E5.m1.20.20.20.10.10.10.cmml" xref="S4.E5.m1.20.20.20.10.10.10"></divide><apply id="S4.E5.m1.30.30.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><plus id="S4.E5.m1.17.17.17.7.7.7.cmml" xref="S4.E5.m1.17.17.17.7.7.7"></plus><ci id="S4.E5.m1.16.16.16.6.6.6.cmml" xref="S4.E5.m1.16.16.16.6.6.6">𝐳</ci><ci id="S4.E5.m1.18.18.18.8.8.8.cmml" xref="S4.E5.m1.18.18.18.8.8.8">𝐆</ci></apply><ci id="S4.E5.m1.21.21.21.11.11.11.cmml" xref="S4.E5.m1.21.21.21.11.11.11">𝜏</ci></apply></apply></apply><apply id="S4.E5.m1.30.30.1.1.1.2.2.2.2.cmml"><eq id="S4.E5.m1.26.26.26.3.3.3.cmml" xref="S4.E5.m1.26.26.26.3.3.3"></eq><apply id="S4.E5.m1.30.30.1.1.1.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.30.30.1.1.1.2.2.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.24.24.24.1.1.1.cmml" xref="S4.E5.m1.24.24.24.1.1.1">𝑤</ci><list id="S4.E5.m1.25.25.25.2.2.2.1.3.cmml" xref="S4.E5.m1.25.25.25.2.2.2.1.4"><ci id="S4.E5.m1.25.25.25.2.2.2.1.1.cmml" xref="S4.E5.m1.25.25.25.2.2.2.1.1">𝑖</ci><ci id="S4.E5.m1.25.25.25.2.2.2.1.2.cmml" xref="S4.E5.m1.25.25.25.2.2.2.1.2">𝑡</ci></list></apply><apply id="S4.E5.m1.30.30.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.30.30.1.1.1.2.2.2.2.3.1.cmml">subscript</csymbol><apply id="S4.E5.m1.27.27.27.4.4.4.cmml" xref="S4.E5.m1.27.27.27.4.4.4"><ci id="S4.E5.m1.27.27.27.4.4.4.1.cmml" xref="S4.E5.m1.27.27.27.4.4.4.1">^</ci><ci id="S4.E5.m1.27.27.27.4.4.4.2.cmml" xref="S4.E5.m1.27.27.27.4.4.4.2">𝐳</ci></apply><cn id="S4.E5.m1.28.28.28.5.5.5.1.cmml" type="integer" xref="S4.E5.m1.28.28.28.5.5.5.1">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.33c">\begin{gathered}\mathbf{z}=g_{\phi}(\mathbf{h}_{t}^{i}),\\
\hat{\mathbf{z}}=\text{Softmax}((\mathbf{z}+\mathbf{G})/\tau),\\
w_{i,t}=\hat{\mathbf{z}}_{1},\end{gathered}</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.33d">start_ROW start_CELL bold_z = italic_g start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) , end_CELL end_ROW start_ROW start_CELL over^ start_ARG bold_z end_ARG = Softmax ( ( bold_z + bold_G ) / italic_τ ) , end_CELL end_ROW start_ROW start_CELL italic_w start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT = over^ start_ARG bold_z end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS1.p1.16">where <math alttext="g_{\phi}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.7.m1.1"><semantics id="S4.SS3.SSS1.p1.7.m1.1a"><msub id="S4.SS3.SSS1.p1.7.m1.1.1" xref="S4.SS3.SSS1.p1.7.m1.1.1.cmml"><mi id="S4.SS3.SSS1.p1.7.m1.1.1.2" xref="S4.SS3.SSS1.p1.7.m1.1.1.2.cmml">g</mi><mi id="S4.SS3.SSS1.p1.7.m1.1.1.3" xref="S4.SS3.SSS1.p1.7.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.7.m1.1b"><apply id="S4.SS3.SSS1.p1.7.m1.1.1.cmml" xref="S4.SS3.SSS1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.7.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p1.7.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p1.7.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p1.7.m1.1.1.2">𝑔</ci><ci id="S4.SS3.SSS1.p1.7.m1.1.1.3.cmml" xref="S4.SS3.SSS1.p1.7.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.7.m1.1c">g_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.7.m1.1d">italic_g start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is the dataset personalizer implemented as an MLP, <math alttext="\mathbf{h}_{t}^{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.8.m2.1"><semantics id="S4.SS3.SSS1.p1.8.m2.1a"><msubsup id="S4.SS3.SSS1.p1.8.m2.1.1" xref="S4.SS3.SSS1.p1.8.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p1.8.m2.1.1.2.2" xref="S4.SS3.SSS1.p1.8.m2.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS3.SSS1.p1.8.m2.1.1.2.3" xref="S4.SS3.SSS1.p1.8.m2.1.1.2.3.cmml">t</mi><mi id="S4.SS3.SSS1.p1.8.m2.1.1.3" xref="S4.SS3.SSS1.p1.8.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.8.m2.1b"><apply id="S4.SS3.SSS1.p1.8.m2.1.1.cmml" xref="S4.SS3.SSS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.8.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p1.8.m2.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p1.8.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.8.m2.1.1.2.1.cmml" xref="S4.SS3.SSS1.p1.8.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p1.8.m2.1.1.2.2.cmml" xref="S4.SS3.SSS1.p1.8.m2.1.1.2.2">𝐡</ci><ci id="S4.SS3.SSS1.p1.8.m2.1.1.2.3.cmml" xref="S4.SS3.SSS1.p1.8.m2.1.1.2.3">𝑡</ci></apply><ci id="S4.SS3.SSS1.p1.8.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p1.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.8.m2.1c">\mathbf{h}_{t}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.8.m2.1d">bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the representation of pattern <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.9.m3.1"><semantics id="S4.SS3.SSS1.p1.9.m3.1a"><mi id="S4.SS3.SSS1.p1.9.m3.1.1" xref="S4.SS3.SSS1.p1.9.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.9.m3.1b"><ci id="S4.SS3.SSS1.p1.9.m3.1.1.cmml" xref="S4.SS3.SSS1.p1.9.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.9.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.9.m3.1d">italic_i</annotation></semantics></math> at position <math alttext="t" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.10.m4.1"><semantics id="S4.SS3.SSS1.p1.10.m4.1a"><mi id="S4.SS3.SSS1.p1.10.m4.1.1" xref="S4.SS3.SSS1.p1.10.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.10.m4.1b"><ci id="S4.SS3.SSS1.p1.10.m4.1.1.cmml" xref="S4.SS3.SSS1.p1.10.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.10.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.10.m4.1d">italic_t</annotation></semantics></math> generated by the target model <math alttext="f^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.11.m5.1"><semantics id="S4.SS3.SSS1.p1.11.m5.1a"><msup id="S4.SS3.SSS1.p1.11.m5.1.1" xref="S4.SS3.SSS1.p1.11.m5.1.1.cmml"><mi id="S4.SS3.SSS1.p1.11.m5.1.1.2" xref="S4.SS3.SSS1.p1.11.m5.1.1.2.cmml">f</mi><mo id="S4.SS3.SSS1.p1.11.m5.1.1.3" xref="S4.SS3.SSS1.p1.11.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.11.m5.1b"><apply id="S4.SS3.SSS1.p1.11.m5.1.1.cmml" xref="S4.SS3.SSS1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.11.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p1.11.m5.1.1">superscript</csymbol><ci id="S4.SS3.SSS1.p1.11.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p1.11.m5.1.1.2">𝑓</ci><ci id="S4.SS3.SSS1.p1.11.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p1.11.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.11.m5.1c">f^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.11.m5.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}\in\mathbb{R}^{2}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.12.m6.1"><semantics id="S4.SS3.SSS1.p1.12.m6.1a"><mrow id="S4.SS3.SSS1.p1.12.m6.1.1" xref="S4.SS3.SSS1.p1.12.m6.1.1.cmml"><mi id="S4.SS3.SSS1.p1.12.m6.1.1.2" xref="S4.SS3.SSS1.p1.12.m6.1.1.2.cmml">𝐳</mi><mo id="S4.SS3.SSS1.p1.12.m6.1.1.1" xref="S4.SS3.SSS1.p1.12.m6.1.1.1.cmml">∈</mo><msup id="S4.SS3.SSS1.p1.12.m6.1.1.3" xref="S4.SS3.SSS1.p1.12.m6.1.1.3.cmml"><mi id="S4.SS3.SSS1.p1.12.m6.1.1.3.2" xref="S4.SS3.SSS1.p1.12.m6.1.1.3.2.cmml">ℝ</mi><mn id="S4.SS3.SSS1.p1.12.m6.1.1.3.3" xref="S4.SS3.SSS1.p1.12.m6.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.12.m6.1b"><apply id="S4.SS3.SSS1.p1.12.m6.1.1.cmml" xref="S4.SS3.SSS1.p1.12.m6.1.1"><in id="S4.SS3.SSS1.p1.12.m6.1.1.1.cmml" xref="S4.SS3.SSS1.p1.12.m6.1.1.1"></in><ci id="S4.SS3.SSS1.p1.12.m6.1.1.2.cmml" xref="S4.SS3.SSS1.p1.12.m6.1.1.2">𝐳</ci><apply id="S4.SS3.SSS1.p1.12.m6.1.1.3.cmml" xref="S4.SS3.SSS1.p1.12.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.12.m6.1.1.3.1.cmml" xref="S4.SS3.SSS1.p1.12.m6.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS1.p1.12.m6.1.1.3.2.cmml" xref="S4.SS3.SSS1.p1.12.m6.1.1.3.2">ℝ</ci><cn id="S4.SS3.SSS1.p1.12.m6.1.1.3.3.cmml" type="integer" xref="S4.SS3.SSS1.p1.12.m6.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.12.m6.1c">\mathbf{z}\in\mathbb{R}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.12.m6.1d">bold_z ∈ blackboard_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is the computed logits vector, Gumbel noise <math alttext="\mathbf{G}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.13.m7.1"><semantics id="S4.SS3.SSS1.p1.13.m7.1a"><mi id="S4.SS3.SSS1.p1.13.m7.1.1" xref="S4.SS3.SSS1.p1.13.m7.1.1.cmml">𝐆</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.13.m7.1b"><ci id="S4.SS3.SSS1.p1.13.m7.1.1.cmml" xref="S4.SS3.SSS1.p1.13.m7.1.1">𝐆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.13.m7.1c">\mathbf{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.13.m7.1d">bold_G</annotation></semantics></math> is sampled from a Gumbel distribution<cite class="ltx_cite ltx_citemacro_citep">(Jang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib19" title="">2017</a>)</cite>, <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.14.m8.1"><semantics id="S4.SS3.SSS1.p1.14.m8.1a"><mi id="S4.SS3.SSS1.p1.14.m8.1.1" xref="S4.SS3.SSS1.p1.14.m8.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.14.m8.1b"><ci id="S4.SS3.SSS1.p1.14.m8.1.1.cmml" xref="S4.SS3.SSS1.p1.14.m8.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.14.m8.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.14.m8.1d">italic_τ</annotation></semantics></math> is a temperature parameter to control the smoothness of Gumbel distribution, and the subscript <math alttext="1" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.15.m9.1"><semantics id="S4.SS3.SSS1.p1.15.m9.1a"><mn id="S4.SS3.SSS1.p1.15.m9.1.1" xref="S4.SS3.SSS1.p1.15.m9.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.15.m9.1b"><cn id="S4.SS3.SSS1.p1.15.m9.1.1.cmml" type="integer" xref="S4.SS3.SSS1.p1.15.m9.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.15.m9.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.15.m9.1d">1</annotation></semantics></math> means selecting the first element of <math alttext="\hat{\mathbf{z}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.16.m10.1"><semantics id="S4.SS3.SSS1.p1.16.m10.1a"><mover accent="true" id="S4.SS3.SSS1.p1.16.m10.1.1" xref="S4.SS3.SSS1.p1.16.m10.1.1.cmml"><mi id="S4.SS3.SSS1.p1.16.m10.1.1.2" xref="S4.SS3.SSS1.p1.16.m10.1.1.2.cmml">𝐳</mi><mo id="S4.SS3.SSS1.p1.16.m10.1.1.1" xref="S4.SS3.SSS1.p1.16.m10.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.16.m10.1b"><apply id="S4.SS3.SSS1.p1.16.m10.1.1.cmml" xref="S4.SS3.SSS1.p1.16.m10.1.1"><ci id="S4.SS3.SSS1.p1.16.m10.1.1.1.cmml" xref="S4.SS3.SSS1.p1.16.m10.1.1.1">^</ci><ci id="S4.SS3.SSS1.p1.16.m10.1.1.2.cmml" xref="S4.SS3.SSS1.p1.16.m10.1.1.2">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.16.m10.1c">\hat{\mathbf{z}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.16.m10.1d">over^ start_ARG bold_z end_ARG</annotation></semantics></math> as the score. Since the personalizer takes pattern representations as input, the personalizer possesses a receptive field over the entire pattern, enabling a comprehensive evaluation of the pattern. Additionally, the Gumbel noise is introduced to encourage the scores to approximate a discrete selection operation, which is a desirable property<cite class="ltx_cite ltx_citemacro_citep">(Jang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib19" title="">2017</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.12">To ensure the generality of the framework, we utilize the calculated score to adjust the weighting of training losses, which does not necessitate any additional modifications to target models. We start by defining the original next-item prediction loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{rec-ori}=\sum_{i=1}^{|\mathcal{X}^{\prime}|}\sum_{t=2}^{|p_{i}|}%
\mathcal{L}_{next-item}(i,t)," class="ltx_Math" display="block" id="S4.E6.m1.5"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml"><msub id="S4.E6.m1.5.5.1.1.2" xref="S4.E6.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.5.5.1.1.2.2" xref="S4.E6.m1.5.5.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E6.m1.5.5.1.1.2.3" xref="S4.E6.m1.5.5.1.1.2.3.cmml"><mrow id="S4.E6.m1.5.5.1.1.2.3.2" xref="S4.E6.m1.5.5.1.1.2.3.2.cmml"><mi id="S4.E6.m1.5.5.1.1.2.3.2.2" xref="S4.E6.m1.5.5.1.1.2.3.2.2.cmml">r</mi><mo id="S4.E6.m1.5.5.1.1.2.3.2.1" xref="S4.E6.m1.5.5.1.1.2.3.2.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.2.3.2.3" xref="S4.E6.m1.5.5.1.1.2.3.2.3.cmml">e</mi><mo id="S4.E6.m1.5.5.1.1.2.3.2.1a" xref="S4.E6.m1.5.5.1.1.2.3.2.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.2.3.2.4" xref="S4.E6.m1.5.5.1.1.2.3.2.4.cmml">c</mi></mrow><mo id="S4.E6.m1.5.5.1.1.2.3.1" xref="S4.E6.m1.5.5.1.1.2.3.1.cmml">−</mo><mrow id="S4.E6.m1.5.5.1.1.2.3.3" xref="S4.E6.m1.5.5.1.1.2.3.3.cmml"><mi id="S4.E6.m1.5.5.1.1.2.3.3.2" xref="S4.E6.m1.5.5.1.1.2.3.3.2.cmml">o</mi><mo id="S4.E6.m1.5.5.1.1.2.3.3.1" xref="S4.E6.m1.5.5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.2.3.3.3" xref="S4.E6.m1.5.5.1.1.2.3.3.3.cmml">r</mi><mo id="S4.E6.m1.5.5.1.1.2.3.3.1a" xref="S4.E6.m1.5.5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.2.3.3.4" xref="S4.E6.m1.5.5.1.1.2.3.3.4.cmml">i</mi></mrow></mrow></msub><mo id="S4.E6.m1.5.5.1.1.1" rspace="0.111em" xref="S4.E6.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.5.5.1.1.3" xref="S4.E6.m1.5.5.1.1.3.cmml"><munderover id="S4.E6.m1.5.5.1.1.3.1" xref="S4.E6.m1.5.5.1.1.3.1.cmml"><mo id="S4.E6.m1.5.5.1.1.3.1.2.2" movablelimits="false" rspace="0em" xref="S4.E6.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.5.5.1.1.3.1.2.3" xref="S4.E6.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S4.E6.m1.5.5.1.1.3.1.2.3.2" xref="S4.E6.m1.5.5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E6.m1.5.5.1.1.3.1.2.3.1" xref="S4.E6.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E6.m1.5.5.1.1.3.1.2.3.3" xref="S4.E6.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.2.cmml"><mo id="S4.E6.m1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.2.1.cmml">|</mo><msup id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.2.cmml">𝒳</mi><mo id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.E6.m1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E6.m1.5.5.1.1.3.2" xref="S4.E6.m1.5.5.1.1.3.2.cmml"><munderover id="S4.E6.m1.5.5.1.1.3.2.1" xref="S4.E6.m1.5.5.1.1.3.2.1.cmml"><mo id="S4.E6.m1.5.5.1.1.3.2.1.2.2" movablelimits="false" xref="S4.E6.m1.5.5.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.5.5.1.1.3.2.1.2.3" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3.cmml"><mi id="S4.E6.m1.5.5.1.1.3.2.1.2.3.2" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3.2.cmml">t</mi><mo id="S4.E6.m1.5.5.1.1.3.2.1.2.3.1" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E6.m1.5.5.1.1.3.2.1.2.3.3" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3.3.cmml">2</mn></mrow><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.2.cmml"><mo id="S4.E6.m1.2.2.1.1.2" stretchy="false" xref="S4.E6.m1.2.2.1.2.1.cmml">|</mo><msub id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.2.cmml">p</mi><mi id="S4.E6.m1.2.2.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.2.2.1.1.3" stretchy="false" xref="S4.E6.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E6.m1.5.5.1.1.3.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.cmml"><msub id="S4.E6.m1.5.5.1.1.3.2.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.5.5.1.1.3.2.2.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.2.2.cmml">ℒ</mi><mrow id="S4.E6.m1.5.5.1.1.3.2.2.2.3" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.cmml"><mrow id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.cmml"><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.2.cmml">n</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.3" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.3.cmml">e</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1a" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.4" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.4.cmml">x</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1b" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.5" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.5.cmml">t</mi></mrow><mo id="S4.E6.m1.5.5.1.1.3.2.2.2.3.1" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.1.cmml">−</mo><mrow id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.cmml"><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.2" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.2.cmml">i</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.3" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.3.cmml">t</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1a" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.4" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.4.cmml">e</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1b" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.5" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.5.cmml">m</mi></mrow></mrow></msub><mo id="S4.E6.m1.5.5.1.1.3.2.2.1" xref="S4.E6.m1.5.5.1.1.3.2.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.5.5.1.1.3.2.2.3.2" xref="S4.E6.m1.5.5.1.1.3.2.2.3.1.cmml"><mo id="S4.E6.m1.5.5.1.1.3.2.2.3.2.1" stretchy="false" xref="S4.E6.m1.5.5.1.1.3.2.2.3.1.cmml">(</mo><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">i</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.3.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.3.1.cmml">,</mo><mi id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml">t</mi><mo id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3" stretchy="false" xref="S4.E6.m1.5.5.1.1.3.2.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.5.5.1.2" xref="S4.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1"><eq id="S4.E6.m1.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1"></eq><apply id="S4.E6.m1.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.2">ℒ</ci><apply id="S4.E6.m1.5.5.1.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.3"><minus id="S4.E6.m1.5.5.1.1.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.2.3.1"></minus><apply id="S4.E6.m1.5.5.1.1.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.2.3.2"><times id="S4.E6.m1.5.5.1.1.2.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2.3.2.1"></times><ci id="S4.E6.m1.5.5.1.1.2.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.3.2.2">𝑟</ci><ci id="S4.E6.m1.5.5.1.1.2.3.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.3.2.3">𝑒</ci><ci id="S4.E6.m1.5.5.1.1.2.3.2.4.cmml" xref="S4.E6.m1.5.5.1.1.2.3.2.4">𝑐</ci></apply><apply id="S4.E6.m1.5.5.1.1.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.2.3.3"><times id="S4.E6.m1.5.5.1.1.2.3.3.1.cmml" xref="S4.E6.m1.5.5.1.1.2.3.3.1"></times><ci id="S4.E6.m1.5.5.1.1.2.3.3.2.cmml" xref="S4.E6.m1.5.5.1.1.2.3.3.2">𝑜</ci><ci id="S4.E6.m1.5.5.1.1.2.3.3.3.cmml" xref="S4.E6.m1.5.5.1.1.2.3.3.3">𝑟</ci><ci id="S4.E6.m1.5.5.1.1.2.3.3.4.cmml" xref="S4.E6.m1.5.5.1.1.2.3.3.4">𝑖</ci></apply></apply></apply><apply id="S4.E6.m1.5.5.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.3"><apply id="S4.E6.m1.5.5.1.1.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.1.1.cmml" xref="S4.E6.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.3.1.2.cmml" xref="S4.E6.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S4.E6.m1.5.5.1.1.3.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.1.2.2"></sum><apply id="S4.E6.m1.5.5.1.1.3.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.1.2.3"><eq id="S4.E6.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S4.E6.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.E6.m1.5.5.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E6.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1"><abs id="S4.E6.m1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.2"></abs><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2">𝒳</ci><ci id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="S4.E6.m1.5.5.1.1.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2"><apply id="S4.E6.m1.5.5.1.1.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.1.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.3.2.1.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1">subscript</csymbol><sum id="S4.E6.m1.5.5.1.1.3.2.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.2.2"></sum><apply id="S4.E6.m1.5.5.1.1.3.2.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3"><eq id="S4.E6.m1.5.5.1.1.3.2.1.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3.1"></eq><ci id="S4.E6.m1.5.5.1.1.3.2.1.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3.2">𝑡</ci><cn id="S4.E6.m1.5.5.1.1.3.2.1.2.3.3.cmml" type="integer" xref="S4.E6.m1.5.5.1.1.3.2.1.2.3.3">2</cn></apply></apply><apply id="S4.E6.m1.2.2.1.2.cmml" xref="S4.E6.m1.2.2.1.1"><abs id="S4.E6.m1.2.2.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.2"></abs><apply id="S4.E6.m1.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.2">𝑝</ci><ci id="S4.E6.m1.2.2.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E6.m1.5.5.1.1.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2"><times id="S4.E6.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.1"></times><apply id="S4.E6.m1.5.5.1.1.3.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.2">ℒ</ci><apply id="S4.E6.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3"><minus id="S4.E6.m1.5.5.1.1.3.2.2.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.1"></minus><apply id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2"><times id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.1"></times><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.2">𝑛</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.3">𝑒</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.4.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.4">𝑥</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.5.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.2.5">𝑡</ci></apply><apply id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3"><times id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.1"></times><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.2">𝑖</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.3">𝑡</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.4.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.4">𝑒</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.5.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.3.3.5">𝑚</ci></apply></apply></apply><interval closure="open" id="S4.E6.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2"><ci id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3">𝑖</ci><ci id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4">𝑡</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">\mathcal{L}_{rec-ori}=\sum_{i=1}^{|\mathcal{X}^{\prime}|}\sum_{t=2}^{|p_{i}|}%
\mathcal{L}_{next-item}(i,t),</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.5d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_c - italic_o italic_r italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_n italic_e italic_x italic_t - italic_i italic_t italic_e italic_m end_POSTSUBSCRIPT ( italic_i , italic_t ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{next-item}(i,t)=-\log(\sigma(\mathbf{h}_{t-1}^{i}\cdot\mathbf{v}_%
{t}^{i}))-\sum_{v_{j}\notin p_{i}}\log(1-\sigma(\mathbf{h}_{t-1}^{i}\cdot%
\mathbf{v}_{j}))," class="ltx_Math" display="block" id="S4.E7.m1.5"><semantics id="S4.E7.m1.5a"><mrow id="S4.E7.m1.5.5.1" xref="S4.E7.m1.5.5.1.1.cmml"><mrow id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1.cmml"><mrow id="S4.E7.m1.5.5.1.1.4" xref="S4.E7.m1.5.5.1.1.4.cmml"><msub id="S4.E7.m1.5.5.1.1.4.2" xref="S4.E7.m1.5.5.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.5.5.1.1.4.2.2" xref="S4.E7.m1.5.5.1.1.4.2.2.cmml">ℒ</mi><mrow id="S4.E7.m1.5.5.1.1.4.2.3" xref="S4.E7.m1.5.5.1.1.4.2.3.cmml"><mrow id="S4.E7.m1.5.5.1.1.4.2.3.2" xref="S4.E7.m1.5.5.1.1.4.2.3.2.cmml"><mi id="S4.E7.m1.5.5.1.1.4.2.3.2.2" xref="S4.E7.m1.5.5.1.1.4.2.3.2.2.cmml">n</mi><mo id="S4.E7.m1.5.5.1.1.4.2.3.2.1" xref="S4.E7.m1.5.5.1.1.4.2.3.2.1.cmml">⁢</mo><mi id="S4.E7.m1.5.5.1.1.4.2.3.2.3" xref="S4.E7.m1.5.5.1.1.4.2.3.2.3.cmml">e</mi><mo id="S4.E7.m1.5.5.1.1.4.2.3.2.1a" xref="S4.E7.m1.5.5.1.1.4.2.3.2.1.cmml">⁢</mo><mi id="S4.E7.m1.5.5.1.1.4.2.3.2.4" xref="S4.E7.m1.5.5.1.1.4.2.3.2.4.cmml">x</mi><mo id="S4.E7.m1.5.5.1.1.4.2.3.2.1b" xref="S4.E7.m1.5.5.1.1.4.2.3.2.1.cmml">⁢</mo><mi id="S4.E7.m1.5.5.1.1.4.2.3.2.5" xref="S4.E7.m1.5.5.1.1.4.2.3.2.5.cmml">t</mi></mrow><mo id="S4.E7.m1.5.5.1.1.4.2.3.1" xref="S4.E7.m1.5.5.1.1.4.2.3.1.cmml">−</mo><mrow id="S4.E7.m1.5.5.1.1.4.2.3.3" xref="S4.E7.m1.5.5.1.1.4.2.3.3.cmml"><mi id="S4.E7.m1.5.5.1.1.4.2.3.3.2" xref="S4.E7.m1.5.5.1.1.4.2.3.3.2.cmml">i</mi><mo id="S4.E7.m1.5.5.1.1.4.2.3.3.1" xref="S4.E7.m1.5.5.1.1.4.2.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.5.5.1.1.4.2.3.3.3" xref="S4.E7.m1.5.5.1.1.4.2.3.3.3.cmml">t</mi><mo id="S4.E7.m1.5.5.1.1.4.2.3.3.1a" xref="S4.E7.m1.5.5.1.1.4.2.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.5.5.1.1.4.2.3.3.4" xref="S4.E7.m1.5.5.1.1.4.2.3.3.4.cmml">e</mi><mo id="S4.E7.m1.5.5.1.1.4.2.3.3.1b" xref="S4.E7.m1.5.5.1.1.4.2.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.5.5.1.1.4.2.3.3.5" xref="S4.E7.m1.5.5.1.1.4.2.3.3.5.cmml">m</mi></mrow></mrow></msub><mo id="S4.E7.m1.5.5.1.1.4.1" xref="S4.E7.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S4.E7.m1.5.5.1.1.4.3.2" xref="S4.E7.m1.5.5.1.1.4.3.1.cmml"><mo id="S4.E7.m1.5.5.1.1.4.3.2.1" stretchy="false" xref="S4.E7.m1.5.5.1.1.4.3.1.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">i</mi><mo id="S4.E7.m1.5.5.1.1.4.3.2.2" xref="S4.E7.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">t</mi><mo id="S4.E7.m1.5.5.1.1.4.3.2.3" stretchy="false" xref="S4.E7.m1.5.5.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.5.5.1.1.3" xref="S4.E7.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E7.m1.5.5.1.1.2" xref="S4.E7.m1.5.5.1.1.2.cmml"><mrow id="S4.E7.m1.5.5.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.cmml"><mo id="S4.E7.m1.5.5.1.1.1.1a" rspace="0.167em" xref="S4.E7.m1.5.5.1.1.1.1.cmml">−</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml">log</mi><mo id="S4.E7.m1.5.5.1.1.1.1.1.1a" xref="S4.E7.m1.5.5.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.5.5.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐡</mi><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">−</mo><mn id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐯</mi><mi id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msubsup></mrow><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.5.5.1.1.2.3" rspace="0.055em" xref="S4.E7.m1.5.5.1.1.2.3.cmml">−</mo><mrow id="S4.E7.m1.5.5.1.1.2.2" xref="S4.E7.m1.5.5.1.1.2.2.cmml"><munder id="S4.E7.m1.5.5.1.1.2.2.2" xref="S4.E7.m1.5.5.1.1.2.2.2.cmml"><mo id="S4.E7.m1.5.5.1.1.2.2.2.2" movablelimits="false" xref="S4.E7.m1.5.5.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.E7.m1.5.5.1.1.2.2.2.3" xref="S4.E7.m1.5.5.1.1.2.2.2.3.cmml"><msub id="S4.E7.m1.5.5.1.1.2.2.2.3.2" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.2.3.2.2" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2.2.cmml">v</mi><mi id="S4.E7.m1.5.5.1.1.2.2.2.3.2.3" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2.3.cmml">j</mi></msub><mo id="S4.E7.m1.5.5.1.1.2.2.2.3.1" xref="S4.E7.m1.5.5.1.1.2.2.2.3.1.cmml">∉</mo><msub id="S4.E7.m1.5.5.1.1.2.2.2.3.3" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.2.3.3.2" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3.2.cmml">p</mi><mi id="S4.E7.m1.5.5.1.1.2.2.2.3.3.3" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S4.E7.m1.5.5.1.1.2.2.1.1" xref="S4.E7.m1.5.5.1.1.2.2.1.2.cmml"><mi id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml">log</mi><mo id="S4.E7.m1.5.5.1.1.2.2.1.1a" xref="S4.E7.m1.5.5.1.1.2.2.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.5.5.1.1.2.2.1.1.1" xref="S4.E7.m1.5.5.1.1.2.2.1.2.cmml"><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.2" stretchy="false" xref="S4.E7.m1.5.5.1.1.2.2.1.2.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.cmml"><mn id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.3.cmml">1</mn><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.2.cmml">−</mo><mrow id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml">σ</mi><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐡</mi><mrow id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.1.cmml">−</mo><mn id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">𝐯</mi><mi id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.5.5.1.1.2.2.1.1.1.3" stretchy="false" xref="S4.E7.m1.5.5.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.5.5.1.2" xref="S4.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.5b"><apply id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1"><eq id="S4.E7.m1.5.5.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.3"></eq><apply id="S4.E7.m1.5.5.1.1.4.cmml" xref="S4.E7.m1.5.5.1.1.4"><times id="S4.E7.m1.5.5.1.1.4.1.cmml" xref="S4.E7.m1.5.5.1.1.4.1"></times><apply id="S4.E7.m1.5.5.1.1.4.2.cmml" xref="S4.E7.m1.5.5.1.1.4.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.4.2.1.cmml" xref="S4.E7.m1.5.5.1.1.4.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.4.2.2.cmml" xref="S4.E7.m1.5.5.1.1.4.2.2">ℒ</ci><apply id="S4.E7.m1.5.5.1.1.4.2.3.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3"><minus id="S4.E7.m1.5.5.1.1.4.2.3.1.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.1"></minus><apply id="S4.E7.m1.5.5.1.1.4.2.3.2.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.2"><times id="S4.E7.m1.5.5.1.1.4.2.3.2.1.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.2.1"></times><ci id="S4.E7.m1.5.5.1.1.4.2.3.2.2.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.2.2">𝑛</ci><ci id="S4.E7.m1.5.5.1.1.4.2.3.2.3.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.2.3">𝑒</ci><ci id="S4.E7.m1.5.5.1.1.4.2.3.2.4.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.2.4">𝑥</ci><ci id="S4.E7.m1.5.5.1.1.4.2.3.2.5.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.2.5">𝑡</ci></apply><apply id="S4.E7.m1.5.5.1.1.4.2.3.3.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.3"><times id="S4.E7.m1.5.5.1.1.4.2.3.3.1.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.3.1"></times><ci id="S4.E7.m1.5.5.1.1.4.2.3.3.2.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.3.2">𝑖</ci><ci id="S4.E7.m1.5.5.1.1.4.2.3.3.3.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.3.3">𝑡</ci><ci id="S4.E7.m1.5.5.1.1.4.2.3.3.4.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.3.4">𝑒</ci><ci id="S4.E7.m1.5.5.1.1.4.2.3.3.5.cmml" xref="S4.E7.m1.5.5.1.1.4.2.3.3.5">𝑚</ci></apply></apply></apply><interval closure="open" id="S4.E7.m1.5.5.1.1.4.3.1.cmml" xref="S4.E7.m1.5.5.1.1.4.3.2"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝑖</ci><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">𝑡</ci></interval></apply><apply id="S4.E7.m1.5.5.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.2"><minus id="S4.E7.m1.5.5.1.1.2.3.cmml" xref="S4.E7.m1.5.5.1.1.2.3"></minus><apply id="S4.E7.m1.5.5.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1"><minus id="S4.E7.m1.5.5.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1"></minus><apply id="S4.E7.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1"><log id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3"></log><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1"><times id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1"><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">⋅</ci><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐡</ci><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3"><minus id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1"></minus><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐯</ci><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E7.m1.5.5.1.1.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2"><apply id="S4.E7.m1.5.5.1.1.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2">subscript</csymbol><sum id="S4.E7.m1.5.5.1.1.2.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.2"></sum><apply id="S4.E7.m1.5.5.1.1.2.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3"><notin id="S4.E7.m1.5.5.1.1.2.2.2.3.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.1"></notin><apply id="S4.E7.m1.5.5.1.1.2.2.2.3.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.2.2.3.2.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.2.2.2.3.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2.2">𝑣</ci><ci id="S4.E7.m1.5.5.1.1.2.2.2.3.2.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2.3">𝑗</ci></apply><apply id="S4.E7.m1.5.5.1.1.2.2.2.3.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.2.2.3.3.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.2.2.2.3.3.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3.2">𝑝</ci><ci id="S4.E7.m1.5.5.1.1.2.2.2.3.3.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E7.m1.5.5.1.1.2.2.1.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1"><log id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4"></log><apply id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1"><minus id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.2"></minus><cn id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.3">1</cn><apply id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1"><times id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.2"></times><ci id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.3">𝜎</ci><apply id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1"><ci id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1">⋅</ci><apply id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.2">𝐡</ci><apply id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3"><minus id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.1"></minus><ci id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.2">𝐯</ci><ci id="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.5c">\mathcal{L}_{next-item}(i,t)=-\log(\sigma(\mathbf{h}_{t-1}^{i}\cdot\mathbf{v}_%
{t}^{i}))-\sum_{v_{j}\notin p_{i}}\log(1-\sigma(\mathbf{h}_{t-1}^{i}\cdot%
\mathbf{v}_{j})),</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.5d">caligraphic_L start_POSTSUBSCRIPT italic_n italic_e italic_x italic_t - italic_i italic_t italic_e italic_m end_POSTSUBSCRIPT ( italic_i , italic_t ) = - roman_log ( italic_σ ( bold_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⋅ bold_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) ) - ∑ start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∉ italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log ( 1 - italic_σ ( bold_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⋅ bold_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS1.p2.11">where <math alttext="p_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.1.m1.1"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><msub id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS1.p2.1.m1.1.1.2" xref="S4.SS3.SSS1.p2.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS3.SSS1.p2.1.m1.1.1.3" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><apply id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.2">𝑝</ci><ci id="S4.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents one regenerated pattern, <math alttext="\mathbf{h}_{t-1}^{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.2.m2.1"><semantics id="S4.SS3.SSS1.p2.2.m2.1a"><msubsup id="S4.SS3.SSS1.p2.2.m2.1.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.1.1.2.2" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.2.cmml">𝐡</mi><mrow id="S4.SS3.SSS1.p2.2.m2.1.1.2.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.2" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.2.cmml">t</mi><mo id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.SSS1.p2.2.m2.1.1.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.2.m2.1b"><apply id="S4.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.2">𝐡</ci><apply id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3"><minus id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.1"></minus><ci id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.2">𝑡</ci><cn id="S4.SS3.SSS1.p2.2.m2.1.1.2.3.3.cmml" type="integer" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.2.m2.1c">\mathbf{h}_{t-1}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.2.m2.1d">bold_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the representation of pattern <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.3.m3.1"><semantics id="S4.SS3.SSS1.p2.3.m3.1a"><mi id="S4.SS3.SSS1.p2.3.m3.1.1" xref="S4.SS3.SSS1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.3.m3.1b"><ci id="S4.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.3.m3.1d">italic_i</annotation></semantics></math> at position <math alttext="t-1" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.4.m4.1"><semantics id="S4.SS3.SSS1.p2.4.m4.1a"><mrow id="S4.SS3.SSS1.p2.4.m4.1.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p2.4.m4.1.1.2" xref="S4.SS3.SSS1.p2.4.m4.1.1.2.cmml">t</mi><mo id="S4.SS3.SSS1.p2.4.m4.1.1.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.1.cmml">−</mo><mn id="S4.SS3.SSS1.p2.4.m4.1.1.3" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.4.m4.1b"><apply id="S4.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1"><minus id="S4.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.1"></minus><ci id="S4.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.2">𝑡</ci><cn id="S4.SS3.SSS1.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS3.SSS1.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.4.m4.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.4.m4.1d">italic_t - 1</annotation></semantics></math>, <math alttext="\mathbf{v}_{t}^{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.5.m5.1"><semantics id="S4.SS3.SSS1.p2.5.m5.1a"><msubsup id="S4.SS3.SSS1.p2.5.m5.1.1" xref="S4.SS3.SSS1.p2.5.m5.1.1.cmml"><mi id="S4.SS3.SSS1.p2.5.m5.1.1.2.2" xref="S4.SS3.SSS1.p2.5.m5.1.1.2.2.cmml">𝐯</mi><mi id="S4.SS3.SSS1.p2.5.m5.1.1.2.3" xref="S4.SS3.SSS1.p2.5.m5.1.1.2.3.cmml">t</mi><mi id="S4.SS3.SSS1.p2.5.m5.1.1.3" xref="S4.SS3.SSS1.p2.5.m5.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.5.m5.1b"><apply id="S4.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.5.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p2.5.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.5.m5.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.5.m5.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.2.2">𝐯</ci><ci id="S4.SS3.SSS1.p2.5.m5.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S4.SS3.SSS1.p2.5.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.5.m5.1c">\mathbf{v}_{t}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.5.m5.1d">bold_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the embedding of the target item in <math alttext="p_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.6.m6.1"><semantics id="S4.SS3.SSS1.p2.6.m6.1a"><msub id="S4.SS3.SSS1.p2.6.m6.1.1" xref="S4.SS3.SSS1.p2.6.m6.1.1.cmml"><mi id="S4.SS3.SSS1.p2.6.m6.1.1.2" xref="S4.SS3.SSS1.p2.6.m6.1.1.2.cmml">p</mi><mi id="S4.SS3.SSS1.p2.6.m6.1.1.3" xref="S4.SS3.SSS1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.6.m6.1b"><apply id="S4.SS3.SSS1.p2.6.m6.1.1.cmml" xref="S4.SS3.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m6.1.1.1.cmml" xref="S4.SS3.SSS1.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.6.m6.1.1.2.cmml" xref="S4.SS3.SSS1.p2.6.m6.1.1.2">𝑝</ci><ci id="S4.SS3.SSS1.p2.6.m6.1.1.3.cmml" xref="S4.SS3.SSS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.6.m6.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.6.m6.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.7.m7.1"><semantics id="S4.SS3.SSS1.p2.7.m7.1a"><mi id="S4.SS3.SSS1.p2.7.m7.1.1" xref="S4.SS3.SSS1.p2.7.m7.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.7.m7.1b"><ci id="S4.SS3.SSS1.p2.7.m7.1.1.cmml" xref="S4.SS3.SSS1.p2.7.m7.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.7.m7.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.7.m7.1d">italic_σ</annotation></semantics></math> is the sigmoid function, and we randomly sample one negative item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.8.m8.1"><semantics id="S4.SS3.SSS1.p2.8.m8.1a"><msub id="S4.SS3.SSS1.p2.8.m8.1.1" xref="S4.SS3.SSS1.p2.8.m8.1.1.cmml"><mi id="S4.SS3.SSS1.p2.8.m8.1.1.2" xref="S4.SS3.SSS1.p2.8.m8.1.1.2.cmml">v</mi><mi id="S4.SS3.SSS1.p2.8.m8.1.1.3" xref="S4.SS3.SSS1.p2.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.8.m8.1b"><apply id="S4.SS3.SSS1.p2.8.m8.1.1.cmml" xref="S4.SS3.SSS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.8.m8.1.1.1.cmml" xref="S4.SS3.SSS1.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.8.m8.1.1.2.cmml" xref="S4.SS3.SSS1.p2.8.m8.1.1.2">𝑣</ci><ci id="S4.SS3.SSS1.p2.8.m8.1.1.3.cmml" xref="S4.SS3.SSS1.p2.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.8.m8.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.8.m8.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> at each time step <math alttext="t" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.9.m9.1"><semantics id="S4.SS3.SSS1.p2.9.m9.1a"><mi id="S4.SS3.SSS1.p2.9.m9.1.1" xref="S4.SS3.SSS1.p2.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.9.m9.1b"><ci id="S4.SS3.SSS1.p2.9.m9.1.1.cmml" xref="S4.SS3.SSS1.p2.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.9.m9.1d">italic_t</annotation></semantics></math> for each pattern. The purpose of Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E7" title="In 4.3.1. Dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a> is to maximize the probability of recommending the expected next item <math alttext="v_{t}^{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.10.m10.1"><semantics id="S4.SS3.SSS1.p2.10.m10.1a"><msubsup id="S4.SS3.SSS1.p2.10.m10.1.1" xref="S4.SS3.SSS1.p2.10.m10.1.1.cmml"><mi id="S4.SS3.SSS1.p2.10.m10.1.1.2.2" xref="S4.SS3.SSS1.p2.10.m10.1.1.2.2.cmml">v</mi><mi id="S4.SS3.SSS1.p2.10.m10.1.1.2.3" xref="S4.SS3.SSS1.p2.10.m10.1.1.2.3.cmml">t</mi><mi id="S4.SS3.SSS1.p2.10.m10.1.1.3" xref="S4.SS3.SSS1.p2.10.m10.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.10.m10.1b"><apply id="S4.SS3.SSS1.p2.10.m10.1.1.cmml" xref="S4.SS3.SSS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.10.m10.1.1.1.cmml" xref="S4.SS3.SSS1.p2.10.m10.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p2.10.m10.1.1.2.cmml" xref="S4.SS3.SSS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.10.m10.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.10.m10.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.10.m10.1.1.2.2">𝑣</ci><ci id="S4.SS3.SSS1.p2.10.m10.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.10.m10.1.1.2.3">𝑡</ci></apply><ci id="S4.SS3.SSS1.p2.10.m10.1.1.3.cmml" xref="S4.SS3.SSS1.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.10.m10.1c">v_{t}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.10.m10.1d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> given the pattern representation <math alttext="\mathbf{h}_{t-1}^{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.11.m11.1"><semantics id="S4.SS3.SSS1.p2.11.m11.1a"><msubsup id="S4.SS3.SSS1.p2.11.m11.1.1" xref="S4.SS3.SSS1.p2.11.m11.1.1.cmml"><mi id="S4.SS3.SSS1.p2.11.m11.1.1.2.2" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.2.cmml">𝐡</mi><mrow id="S4.SS3.SSS1.p2.11.m11.1.1.2.3" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3.cmml"><mi id="S4.SS3.SSS1.p2.11.m11.1.1.2.3.2" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3.2.cmml">t</mi><mo id="S4.SS3.SSS1.p2.11.m11.1.1.2.3.1" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3.1.cmml">−</mo><mn id="S4.SS3.SSS1.p2.11.m11.1.1.2.3.3" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.SSS1.p2.11.m11.1.1.3" xref="S4.SS3.SSS1.p2.11.m11.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.11.m11.1b"><apply id="S4.SS3.SSS1.p2.11.m11.1.1.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.11.m11.1.1.1.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1">superscript</csymbol><apply id="S4.SS3.SSS1.p2.11.m11.1.1.2.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.11.m11.1.1.2.1.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.11.m11.1.1.2.2.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.2">𝐡</ci><apply id="S4.SS3.SSS1.p2.11.m11.1.1.2.3.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3"><minus id="S4.SS3.SSS1.p2.11.m11.1.1.2.3.1.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3.1"></minus><ci id="S4.SS3.SSS1.p2.11.m11.1.1.2.3.2.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3.2">𝑡</ci><cn id="S4.SS3.SSS1.p2.11.m11.1.1.2.3.3.cmml" type="integer" xref="S4.SS3.SSS1.p2.11.m11.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS3.SSS1.p2.11.m11.1.1.3.cmml" xref="S4.SS3.SSS1.p2.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.11.m11.1c">\mathbf{h}_{t-1}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.11.m11.1d">bold_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p3">
<p class="ltx_p" id="S4.SS3.SSS1.p3.1">Subsequently, the training loss function on the personalized dataset can be defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{rec}=\sum_{i=1}^{|\mathcal{X}^{\prime}|}\sum_{t=2}^{|p_{i}|}%
\mathbf{w}_{i,t}\mathcal{L}_{next-item}(i,t)." class="ltx_Math" display="block" id="S4.E8.m1.7"><semantics id="S4.E8.m1.7a"><mrow id="S4.E8.m1.7.7.1" xref="S4.E8.m1.7.7.1.1.cmml"><mrow id="S4.E8.m1.7.7.1.1" xref="S4.E8.m1.7.7.1.1.cmml"><msub id="S4.E8.m1.7.7.1.1.2" xref="S4.E8.m1.7.7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.7.7.1.1.2.2" xref="S4.E8.m1.7.7.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E8.m1.7.7.1.1.2.3" xref="S4.E8.m1.7.7.1.1.2.3.cmml"><mi id="S4.E8.m1.7.7.1.1.2.3.2" xref="S4.E8.m1.7.7.1.1.2.3.2.cmml">r</mi><mo id="S4.E8.m1.7.7.1.1.2.3.1" xref="S4.E8.m1.7.7.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.2.3.3" xref="S4.E8.m1.7.7.1.1.2.3.3.cmml">e</mi><mo id="S4.E8.m1.7.7.1.1.2.3.1a" xref="S4.E8.m1.7.7.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.2.3.4" xref="S4.E8.m1.7.7.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S4.E8.m1.7.7.1.1.1" rspace="0.111em" xref="S4.E8.m1.7.7.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.7.7.1.1.3" xref="S4.E8.m1.7.7.1.1.3.cmml"><munderover id="S4.E8.m1.7.7.1.1.3.1" xref="S4.E8.m1.7.7.1.1.3.1.cmml"><mo id="S4.E8.m1.7.7.1.1.3.1.2.2" movablelimits="false" rspace="0em" xref="S4.E8.m1.7.7.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E8.m1.7.7.1.1.3.1.2.3" xref="S4.E8.m1.7.7.1.1.3.1.2.3.cmml"><mi id="S4.E8.m1.7.7.1.1.3.1.2.3.2" xref="S4.E8.m1.7.7.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E8.m1.7.7.1.1.3.1.2.3.1" xref="S4.E8.m1.7.7.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E8.m1.7.7.1.1.3.1.2.3.3" xref="S4.E8.m1.7.7.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.2.cmml"><mo id="S4.E8.m1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.1.1.1.2.1.cmml">|</mo><msup id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.2.cmml">𝒳</mi><mo id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.E8.m1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E8.m1.7.7.1.1.3.2" xref="S4.E8.m1.7.7.1.1.3.2.cmml"><munderover id="S4.E8.m1.7.7.1.1.3.2.1" xref="S4.E8.m1.7.7.1.1.3.2.1.cmml"><mo id="S4.E8.m1.7.7.1.1.3.2.1.2.2" movablelimits="false" xref="S4.E8.m1.7.7.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E8.m1.7.7.1.1.3.2.1.2.3" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3.cmml"><mi id="S4.E8.m1.7.7.1.1.3.2.1.2.3.2" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3.2.cmml">t</mi><mo id="S4.E8.m1.7.7.1.1.3.2.1.2.3.1" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E8.m1.7.7.1.1.3.2.1.2.3.3" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3.3.cmml">2</mn></mrow><mrow id="S4.E8.m1.2.2.1.1" xref="S4.E8.m1.2.2.1.2.cmml"><mo id="S4.E8.m1.2.2.1.1.2" stretchy="false" xref="S4.E8.m1.2.2.1.2.1.cmml">|</mo><msub id="S4.E8.m1.2.2.1.1.1" xref="S4.E8.m1.2.2.1.1.1.cmml"><mi id="S4.E8.m1.2.2.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.2.cmml">p</mi><mi id="S4.E8.m1.2.2.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E8.m1.2.2.1.1.3" stretchy="false" xref="S4.E8.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E8.m1.7.7.1.1.3.2.2" xref="S4.E8.m1.7.7.1.1.3.2.2.cmml"><msub id="S4.E8.m1.7.7.1.1.3.2.2.2" xref="S4.E8.m1.7.7.1.1.3.2.2.2.cmml"><mi id="S4.E8.m1.7.7.1.1.3.2.2.2.2" xref="S4.E8.m1.7.7.1.1.3.2.2.2.2.cmml">𝐰</mi><mrow id="S4.E8.m1.4.4.2.4" xref="S4.E8.m1.4.4.2.3.cmml"><mi id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml">i</mi><mo id="S4.E8.m1.4.4.2.4.1" xref="S4.E8.m1.4.4.2.3.cmml">,</mo><mi id="S4.E8.m1.4.4.2.2" xref="S4.E8.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo id="S4.E8.m1.7.7.1.1.3.2.2.1" xref="S4.E8.m1.7.7.1.1.3.2.2.1.cmml">⁢</mo><msub id="S4.E8.m1.7.7.1.1.3.2.2.3" xref="S4.E8.m1.7.7.1.1.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.7.7.1.1.3.2.2.3.2" xref="S4.E8.m1.7.7.1.1.3.2.2.3.2.cmml">ℒ</mi><mrow id="S4.E8.m1.7.7.1.1.3.2.2.3.3" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.cmml"><mrow id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.cmml"><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.2" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.2.cmml">n</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.3" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.3.cmml">e</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1a" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.4" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.4.cmml">x</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1b" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.5" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.5.cmml">t</mi></mrow><mo id="S4.E8.m1.7.7.1.1.3.2.2.3.3.1" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.1.cmml">−</mo><mrow id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.cmml"><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.2" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.2.cmml">i</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.3" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.3.cmml">t</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1a" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.4" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.4.cmml">e</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1b" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.5" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.5.cmml">m</mi></mrow></mrow></msub><mo id="S4.E8.m1.7.7.1.1.3.2.2.1a" xref="S4.E8.m1.7.7.1.1.3.2.2.1.cmml">⁢</mo><mrow id="S4.E8.m1.7.7.1.1.3.2.2.4.2" xref="S4.E8.m1.7.7.1.1.3.2.2.4.1.cmml"><mo id="S4.E8.m1.7.7.1.1.3.2.2.4.2.1" stretchy="false" xref="S4.E8.m1.7.7.1.1.3.2.2.4.1.cmml">(</mo><mi id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml">i</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.4.2.2" xref="S4.E8.m1.7.7.1.1.3.2.2.4.1.cmml">,</mo><mi id="S4.E8.m1.6.6" xref="S4.E8.m1.6.6.cmml">t</mi><mo id="S4.E8.m1.7.7.1.1.3.2.2.4.2.3" stretchy="false" xref="S4.E8.m1.7.7.1.1.3.2.2.4.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.7.7.1.2" lspace="0em" xref="S4.E8.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.7b"><apply id="S4.E8.m1.7.7.1.1.cmml" xref="S4.E8.m1.7.7.1"><eq id="S4.E8.m1.7.7.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1"></eq><apply id="S4.E8.m1.7.7.1.1.2.cmml" xref="S4.E8.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.2.1.cmml" xref="S4.E8.m1.7.7.1.1.2">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.2.2.cmml" xref="S4.E8.m1.7.7.1.1.2.2">ℒ</ci><apply id="S4.E8.m1.7.7.1.1.2.3.cmml" xref="S4.E8.m1.7.7.1.1.2.3"><times id="S4.E8.m1.7.7.1.1.2.3.1.cmml" xref="S4.E8.m1.7.7.1.1.2.3.1"></times><ci id="S4.E8.m1.7.7.1.1.2.3.2.cmml" xref="S4.E8.m1.7.7.1.1.2.3.2">𝑟</ci><ci id="S4.E8.m1.7.7.1.1.2.3.3.cmml" xref="S4.E8.m1.7.7.1.1.2.3.3">𝑒</ci><ci id="S4.E8.m1.7.7.1.1.2.3.4.cmml" xref="S4.E8.m1.7.7.1.1.2.3.4">𝑐</ci></apply></apply><apply id="S4.E8.m1.7.7.1.1.3.cmml" xref="S4.E8.m1.7.7.1.1.3"><apply id="S4.E8.m1.7.7.1.1.3.1.cmml" xref="S4.E8.m1.7.7.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.3.1.1.cmml" xref="S4.E8.m1.7.7.1.1.3.1">superscript</csymbol><apply id="S4.E8.m1.7.7.1.1.3.1.2.cmml" xref="S4.E8.m1.7.7.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.3.1.2.1.cmml" xref="S4.E8.m1.7.7.1.1.3.1">subscript</csymbol><sum id="S4.E8.m1.7.7.1.1.3.1.2.2.cmml" xref="S4.E8.m1.7.7.1.1.3.1.2.2"></sum><apply id="S4.E8.m1.7.7.1.1.3.1.2.3.cmml" xref="S4.E8.m1.7.7.1.1.3.1.2.3"><eq id="S4.E8.m1.7.7.1.1.3.1.2.3.1.cmml" xref="S4.E8.m1.7.7.1.1.3.1.2.3.1"></eq><ci id="S4.E8.m1.7.7.1.1.3.1.2.3.2.cmml" xref="S4.E8.m1.7.7.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.E8.m1.7.7.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E8.m1.7.7.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1"><abs id="S4.E8.m1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2"></abs><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.2">𝒳</ci><ci id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="S4.E8.m1.7.7.1.1.3.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2"><apply id="S4.E8.m1.7.7.1.1.3.2.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.3.2.1.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1">superscript</csymbol><apply id="S4.E8.m1.7.7.1.1.3.2.1.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.3.2.1.2.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1">subscript</csymbol><sum id="S4.E8.m1.7.7.1.1.3.2.1.2.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1.2.2"></sum><apply id="S4.E8.m1.7.7.1.1.3.2.1.2.3.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3"><eq id="S4.E8.m1.7.7.1.1.3.2.1.2.3.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3.1"></eq><ci id="S4.E8.m1.7.7.1.1.3.2.1.2.3.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3.2">𝑡</ci><cn id="S4.E8.m1.7.7.1.1.3.2.1.2.3.3.cmml" type="integer" xref="S4.E8.m1.7.7.1.1.3.2.1.2.3.3">2</cn></apply></apply><apply id="S4.E8.m1.2.2.1.2.cmml" xref="S4.E8.m1.2.2.1.1"><abs id="S4.E8.m1.2.2.1.2.1.cmml" xref="S4.E8.m1.2.2.1.1.2"></abs><apply id="S4.E8.m1.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E8.m1.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.2">𝑝</ci><ci id="S4.E8.m1.2.2.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E8.m1.7.7.1.1.3.2.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2"><times id="S4.E8.m1.7.7.1.1.3.2.2.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.1"></times><apply id="S4.E8.m1.7.7.1.1.3.2.2.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.3.2.2.2.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.3.2.2.2.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.2.2">𝐰</ci><list id="S4.E8.m1.4.4.2.3.cmml" xref="S4.E8.m1.4.4.2.4"><ci id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1">𝑖</ci><ci id="S4.E8.m1.4.4.2.2.cmml" xref="S4.E8.m1.4.4.2.2">𝑡</ci></list></apply><apply id="S4.E8.m1.7.7.1.1.3.2.2.3.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.3.2.2.3.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.2">ℒ</ci><apply id="S4.E8.m1.7.7.1.1.3.2.2.3.3.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3"><minus id="S4.E8.m1.7.7.1.1.3.2.2.3.3.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.1"></minus><apply id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2"><times id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.1"></times><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.2">𝑛</ci><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.3.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.3">𝑒</ci><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.4.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.4">𝑥</ci><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.5.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.2.5">𝑡</ci></apply><apply id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3"><times id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.1"></times><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.2">𝑖</ci><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.3.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.3">𝑡</ci><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.4.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.4">𝑒</ci><ci id="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.5.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.3.3.3.5">𝑚</ci></apply></apply></apply><interval closure="open" id="S4.E8.m1.7.7.1.1.3.2.2.4.1.cmml" xref="S4.E8.m1.7.7.1.1.3.2.2.4.2"><ci id="S4.E8.m1.5.5.cmml" xref="S4.E8.m1.5.5">𝑖</ci><ci id="S4.E8.m1.6.6.cmml" xref="S4.E8.m1.6.6">𝑡</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.7c">\mathcal{L}_{rec}=\sum_{i=1}^{|\mathcal{X}^{\prime}|}\sum_{t=2}^{|p_{i}|}%
\mathbf{w}_{i,t}\mathcal{L}_{next-item}(i,t).</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.7d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT bold_w start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_n italic_e italic_x italic_t - italic_i italic_t italic_e italic_m end_POSTSUBSCRIPT ( italic_i , italic_t ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span>Efficient optimization of dataset personalizer</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">The optimization of the dataset personalizer presents a nontrivial challenge. Should we attempt to optimize it concurrently with the target model using Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E8" title="In 4.3.1. Dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>, we are likely to confront a model collapse issue, wherein the personalizer assigns zero to each data sample. To confront this challenge, we formalize the optimization process as a bi-level optimization problem.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.7">Specifically, our goal is to train an optimal dataset personalizer to obtain an optimal personalized dataset, on which the target model can achieve the best recommendation performance:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{gathered}\phi^{*}=\arg\min_{\phi}L_{\text{dev}}(\theta^{*}(\phi)),\\
s.t.\quad\theta^{*}(\phi)=\arg\min_{\theta}L_{\text{train}}(\theta,\phi),\end{gathered}" class="ltx_math_unparsed" display="block" id="S4.E9.m1.38"><semantics id="S4.E9.m1.38a"><mtable displaystyle="true" id="S4.E9.m1.38.38.1" rowspacing="0pt"><mtr id="S4.E9.m1.38.38.1a"><mtd id="S4.E9.m1.38.38.1b"><mrow id="S4.E9.m1.38.38.1.38.17.17.17"><mrow id="S4.E9.m1.38.38.1.38.17.17.17.1"><msup id="S4.E9.m1.38.38.1.38.17.17.17.1.2"><mi id="S4.E9.m1.1.1.1.1.1.1">ϕ</mi><mo id="S4.E9.m1.2.2.2.2.2.2.1">∗</mo></msup><mo id="S4.E9.m1.3.3.3.3.3.3">=</mo><mrow id="S4.E9.m1.38.38.1.38.17.17.17.1.1"><mrow id="S4.E9.m1.38.38.1.38.17.17.17.1.1.3"><mi id="S4.E9.m1.4.4.4.4.4.4">arg</mi><mo id="S4.E9.m1.38.38.1.38.17.17.17.1.1.3a" lspace="0.167em">⁡</mo><mrow id="S4.E9.m1.38.38.1.38.17.17.17.1.1.3.1"><munder id="S4.E9.m1.38.38.1.38.17.17.17.1.1.3.1.1"><mi id="S4.E9.m1.5.5.5.5.5.5">min</mi><mi id="S4.E9.m1.6.6.6.6.6.6.1">ϕ</mi></munder><mo id="S4.E9.m1.38.38.1.38.17.17.17.1.1.3.1a" lspace="0.167em">⁡</mo><msub id="S4.E9.m1.38.38.1.38.17.17.17.1.1.3.1.2"><mi id="S4.E9.m1.7.7.7.7.7.7">L</mi><mtext id="S4.E9.m1.8.8.8.8.8.8.1">dev</mtext></msub></mrow></mrow><mo id="S4.E9.m1.38.38.1.38.17.17.17.1.1.2">⁢</mo><mrow id="S4.E9.m1.38.38.1.38.17.17.17.1.1.1.1"><mo id="S4.E9.m1.9.9.9.9.9.9" stretchy="false">(</mo><mrow id="S4.E9.m1.38.38.1.38.17.17.17.1.1.1.1.1"><msup id="S4.E9.m1.38.38.1.38.17.17.17.1.1.1.1.1.2"><mi id="S4.E9.m1.10.10.10.10.10.10">θ</mi><mo id="S4.E9.m1.11.11.11.11.11.11.1">∗</mo></msup><mo id="S4.E9.m1.38.38.1.38.17.17.17.1.1.1.1.1.1">⁢</mo><mrow id="S4.E9.m1.38.38.1.38.17.17.17.1.1.1.1.1.3"><mo id="S4.E9.m1.12.12.12.12.12.12" stretchy="false">(</mo><mi id="S4.E9.m1.13.13.13.13.13.13">ϕ</mi><mo id="S4.E9.m1.14.14.14.14.14.14" stretchy="false">)</mo></mrow></mrow><mo id="S4.E9.m1.15.15.15.15.15.15" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.16.16.16.16.16.16">,</mo></mrow></mtd></mtr><mtr id="S4.E9.m1.38.38.1c"><mtd id="S4.E9.m1.38.38.1d"><mrow id="S4.E9.m1.37.37.37.21.21"><mi id="S4.E9.m1.17.17.17.1.1.1">s</mi><mo id="S4.E9.m1.18.18.18.2.2.2" lspace="0em" rspace="0.167em">.</mo><mi id="S4.E9.m1.19.19.19.3.3.3">t</mi><mo id="S4.E9.m1.20.20.20.4.4.4" lspace="0em">.</mo><mspace id="S4.E9.m1.37.37.37.21.21.22" width="1.167em"></mspace><msup id="S4.E9.m1.37.37.37.21.21.23"><mi id="S4.E9.m1.21.21.21.5.5.5">θ</mi><mo id="S4.E9.m1.22.22.22.6.6.6.1">∗</mo></msup><mrow id="S4.E9.m1.37.37.37.21.21.24"><mo id="S4.E9.m1.23.23.23.7.7.7" stretchy="false">(</mo><mi id="S4.E9.m1.24.24.24.8.8.8">ϕ</mi><mo id="S4.E9.m1.25.25.25.9.9.9" stretchy="false">)</mo></mrow><mo id="S4.E9.m1.26.26.26.10.10.10">=</mo><mi id="S4.E9.m1.27.27.27.11.11.11">arg</mi><munder id="S4.E9.m1.37.37.37.21.21.25"><mi id="S4.E9.m1.28.28.28.12.12.12">min</mi><mi id="S4.E9.m1.29.29.29.13.13.13.1">θ</mi></munder><msub id="S4.E9.m1.37.37.37.21.21.26"><mi id="S4.E9.m1.30.30.30.14.14.14">L</mi><mtext id="S4.E9.m1.31.31.31.15.15.15.1">train</mtext></msub><mrow id="S4.E9.m1.37.37.37.21.21.27"><mo id="S4.E9.m1.32.32.32.16.16.16" stretchy="false">(</mo><mi id="S4.E9.m1.33.33.33.17.17.17">θ</mi><mo id="S4.E9.m1.34.34.34.18.18.18">,</mo><mi id="S4.E9.m1.35.35.35.19.19.19">ϕ</mi><mo id="S4.E9.m1.36.36.36.20.20.20" stretchy="false">)</mo></mrow><mo id="S4.E9.m1.37.37.37.21.21.21">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E9.m1.38b">\begin{gathered}\phi^{*}=\arg\min_{\phi}L_{\text{dev}}(\theta^{*}(\phi)),\\
s.t.\quad\theta^{*}(\phi)=\arg\min_{\theta}L_{\text{train}}(\theta,\phi),\end{gathered}</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.38c">start_ROW start_CELL italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) ) , end_CELL end_ROW start_ROW start_CELL italic_s . italic_t . italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) = roman_arg roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ , italic_ϕ ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS2.p2.6">where <math alttext="L_{\text{train}}(\theta,\phi)" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.1.m1.2"><semantics id="S4.SS3.SSS2.p2.1.m1.2a"><mrow id="S4.SS3.SSS2.p2.1.m1.2.3" xref="S4.SS3.SSS2.p2.1.m1.2.3.cmml"><msub id="S4.SS3.SSS2.p2.1.m1.2.3.2" xref="S4.SS3.SSS2.p2.1.m1.2.3.2.cmml"><mi id="S4.SS3.SSS2.p2.1.m1.2.3.2.2" xref="S4.SS3.SSS2.p2.1.m1.2.3.2.2.cmml">L</mi><mtext id="S4.SS3.SSS2.p2.1.m1.2.3.2.3" xref="S4.SS3.SSS2.p2.1.m1.2.3.2.3a.cmml">train</mtext></msub><mo id="S4.SS3.SSS2.p2.1.m1.2.3.1" xref="S4.SS3.SSS2.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p2.1.m1.2.3.3.2" xref="S4.SS3.SSS2.p2.1.m1.2.3.3.1.cmml"><mo id="S4.SS3.SSS2.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS3.SSS2.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS3.SSS2.p2.1.m1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.cmml">θ</mi><mo id="S4.SS3.SSS2.p2.1.m1.2.3.3.2.2" xref="S4.SS3.SSS2.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS3.SSS2.p2.1.m1.2.2" xref="S4.SS3.SSS2.p2.1.m1.2.2.cmml">ϕ</mi><mo id="S4.SS3.SSS2.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS3.SSS2.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.1.m1.2b"><apply id="S4.SS3.SSS2.p2.1.m1.2.3.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.3"><times id="S4.SS3.SSS2.p2.1.m1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.3.1"></times><apply id="S4.SS3.SSS2.p2.1.m1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.1.m1.2.3.2.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.3.2">subscript</csymbol><ci id="S4.SS3.SSS2.p2.1.m1.2.3.2.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.3.2.2">𝐿</ci><ci id="S4.SS3.SSS2.p2.1.m1.2.3.2.3a.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.3.2.3"><mtext id="S4.SS3.SSS2.p2.1.m1.2.3.2.3.cmml" mathsize="70%" xref="S4.SS3.SSS2.p2.1.m1.2.3.2.3">train</mtext></ci></apply><interval closure="open" id="S4.SS3.SSS2.p2.1.m1.2.3.3.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.3.3.2"><ci id="S4.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1">𝜃</ci><ci id="S4.SS3.SSS2.p2.1.m1.2.2.cmml" xref="S4.SS3.SSS2.p2.1.m1.2.2">italic-ϕ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.1.m1.2c">L_{\text{train}}(\theta,\phi)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.1.m1.2d">italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ , italic_ϕ )</annotation></semantics></math> is defined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E8" title="In 4.3.1. Dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>. The lower optimization aims to get an optimal target model with parameter <math alttext="\theta^{*}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.2.m2.1"><semantics id="S4.SS3.SSS2.p2.2.m2.1a"><msup id="S4.SS3.SSS2.p2.2.m2.1.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS3.SSS2.p2.2.m2.1.1.2" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml">θ</mi><mo id="S4.SS3.SSS2.p2.2.m2.1.1.3" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.2.m2.1b"><apply id="S4.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2">𝜃</ci><times id="S4.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.2.m2.1c">\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.2.m2.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> while fixing the dataset personalizer. Besides, <math alttext="\theta^{*}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.3.m3.1"><semantics id="S4.SS3.SSS2.p2.3.m3.1a"><msup id="S4.SS3.SSS2.p2.3.m3.1.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.cmml"><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.cmml">θ</mi><mo id="S4.SS3.SSS2.p2.3.m3.1.1.3" xref="S4.SS3.SSS2.p2.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.3.m3.1b"><apply id="S4.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2">𝜃</ci><times id="S4.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.3.m3.1c">\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.3.m3.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is an implicit function of <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.4.m4.1"><semantics id="S4.SS3.SSS2.p2.4.m4.1a"><mi id="S4.SS3.SSS2.p2.4.m4.1.1" xref="S4.SS3.SSS2.p2.4.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.4.m4.1b"><ci id="S4.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.4.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.4.m4.1d">italic_ϕ</annotation></semantics></math>, so it can be denoted as <math alttext="\theta^{*}(\phi)" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.5.m5.1"><semantics id="S4.SS3.SSS2.p2.5.m5.1a"><mrow id="S4.SS3.SSS2.p2.5.m5.1.2" xref="S4.SS3.SSS2.p2.5.m5.1.2.cmml"><msup id="S4.SS3.SSS2.p2.5.m5.1.2.2" xref="S4.SS3.SSS2.p2.5.m5.1.2.2.cmml"><mi id="S4.SS3.SSS2.p2.5.m5.1.2.2.2" xref="S4.SS3.SSS2.p2.5.m5.1.2.2.2.cmml">θ</mi><mo id="S4.SS3.SSS2.p2.5.m5.1.2.2.3" xref="S4.SS3.SSS2.p2.5.m5.1.2.2.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS2.p2.5.m5.1.2.1" xref="S4.SS3.SSS2.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p2.5.m5.1.2.3.2" xref="S4.SS3.SSS2.p2.5.m5.1.2.cmml"><mo id="S4.SS3.SSS2.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S4.SS3.SSS2.p2.5.m5.1.2.cmml">(</mo><mi id="S4.SS3.SSS2.p2.5.m5.1.1" xref="S4.SS3.SSS2.p2.5.m5.1.1.cmml">ϕ</mi><mo id="S4.SS3.SSS2.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S4.SS3.SSS2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.5.m5.1b"><apply id="S4.SS3.SSS2.p2.5.m5.1.2.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.2"><times id="S4.SS3.SSS2.p2.5.m5.1.2.1.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.2.1"></times><apply id="S4.SS3.SSS2.p2.5.m5.1.2.2.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.5.m5.1.2.2.1.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.2.2">superscript</csymbol><ci id="S4.SS3.SSS2.p2.5.m5.1.2.2.2.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.2.2.2">𝜃</ci><times id="S4.SS3.SSS2.p2.5.m5.1.2.2.3.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.2.2.3"></times></apply><ci id="S4.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.5.m5.1c">\theta^{*}(\phi)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.5.m5.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ )</annotation></semantics></math>. <math alttext="L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.6.m6.2"><semantics id="S4.SS3.SSS2.p2.6.m6.2a"><mrow id="S4.SS3.SSS2.p2.6.m6.2.2" xref="S4.SS3.SSS2.p2.6.m6.2.2.cmml"><msub id="S4.SS3.SSS2.p2.6.m6.2.2.3" xref="S4.SS3.SSS2.p2.6.m6.2.2.3.cmml"><mi id="S4.SS3.SSS2.p2.6.m6.2.2.3.2" xref="S4.SS3.SSS2.p2.6.m6.2.2.3.2.cmml">L</mi><mtext id="S4.SS3.SSS2.p2.6.m6.2.2.3.3" xref="S4.SS3.SSS2.p2.6.m6.2.2.3.3a.cmml">dev</mtext></msub><mo id="S4.SS3.SSS2.p2.6.m6.2.2.2" xref="S4.SS3.SSS2.p2.6.m6.2.2.2.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p2.6.m6.2.2.1.1" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml"><mo id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.2" stretchy="false" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml"><msup id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.cmml"><mi id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.2" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.2.cmml">θ</mi><mo id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.3" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.1" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.3.2" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml"><mo id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml">(</mo><mi id="S4.SS3.SSS2.p2.6.m6.1.1" xref="S4.SS3.SSS2.p2.6.m6.1.1.cmml">ϕ</mi><mo id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.3" stretchy="false" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.6.m6.2b"><apply id="S4.SS3.SSS2.p2.6.m6.2.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2"><times id="S4.SS3.SSS2.p2.6.m6.2.2.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.2"></times><apply id="S4.SS3.SSS2.p2.6.m6.2.2.3.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.6.m6.2.2.3.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.3">subscript</csymbol><ci id="S4.SS3.SSS2.p2.6.m6.2.2.3.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.3.2">𝐿</ci><ci id="S4.SS3.SSS2.p2.6.m6.2.2.3.3a.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.3.3"><mtext id="S4.SS3.SSS2.p2.6.m6.2.2.3.3.cmml" mathsize="70%" xref="S4.SS3.SSS2.p2.6.m6.2.2.3.3">dev</mtext></ci></apply><apply id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1"><times id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.1"></times><apply id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.2">𝜃</ci><times id="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.6.m6.2.2.1.1.1.2.3"></times></apply><ci id="S4.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.6.m6.2c">L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.6.m6.2d">italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math> is defined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E6" title="In 4.3.1. Dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, which is the unweighted recommendation loss of the target model on a validation dataset. In the context of batch training, we can shuffle the original dataset to create a validation set<cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib3" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p3">
<p class="ltx_p" id="S4.SS3.SSS2.p3.4">Then we can elaborate on how to optimize the bi-level optimization problem. Theoretically, achieving the optimal point of the target model through training is a prerequisite before conducting a one-step upper-level optimization. For the sake of efficiency, we conduct a one-step upper optimization after only <math alttext="T_{\text{lower}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.1.m1.1"><semantics id="S4.SS3.SSS2.p3.1.m1.1a"><msub id="S4.SS3.SSS2.p3.1.m1.1.1" xref="S4.SS3.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p3.1.m1.1.1.2" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.cmml">T</mi><mtext id="S4.SS3.SSS2.p3.1.m1.1.1.3" xref="S4.SS3.SSS2.p3.1.m1.1.1.3a.cmml">lower</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.1.m1.1b"><apply id="S4.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2">𝑇</ci><ci id="S4.SS3.SSS2.p3.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.3"><mtext id="S4.SS3.SSS2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.SSS2.p3.1.m1.1.1.3">lower</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.1.m1.1c">T_{\text{lower}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.1.m1.1d">italic_T start_POSTSUBSCRIPT lower end_POSTSUBSCRIPT</annotation></semantics></math> rounds of lower-level optimization in our implementation. The lower optimization can be directly optimized with gradient descent. As for the upper optimization, we need to compute <math alttext="\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.2.m2.2"><semantics id="S4.SS3.SSS2.p3.2.m2.2a"><mrow id="S4.SS3.SSS2.p3.2.m2.2.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.cmml"><mrow id="S4.SS3.SSS2.p3.2.m2.2.2.3" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.cmml"><msub id="S4.SS3.SSS2.p3.2.m2.2.2.3.1" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.1.cmml"><mo id="S4.SS3.SSS2.p3.2.m2.2.2.3.1.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.1.2.cmml">∇</mo><mi id="S4.SS3.SSS2.p3.2.m2.2.2.3.1.3" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.1.3.cmml">ϕ</mi></msub><msub id="S4.SS3.SSS2.p3.2.m2.2.2.3.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2.cmml"><mi id="S4.SS3.SSS2.p3.2.m2.2.2.3.2.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2.2.cmml">L</mi><mtext id="S4.SS3.SSS2.p3.2.m2.2.2.3.2.3" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="S4.SS3.SSS2.p3.2.m2.2.2.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.2.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p3.2.m2.2.2.1.1" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml"><mo id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.2" stretchy="false" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml"><msup id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.cmml"><mi id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.2.cmml">θ</mi><mo id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.3" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.1" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.3.2" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml"><mo id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml">(</mo><mi id="S4.SS3.SSS2.p3.2.m2.1.1" xref="S4.SS3.SSS2.p3.2.m2.1.1.cmml">ϕ</mi><mo id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.3" stretchy="false" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.2.m2.2b"><apply id="S4.SS3.SSS2.p3.2.m2.2.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2"><times id="S4.SS3.SSS2.p3.2.m2.2.2.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.2"></times><apply id="S4.SS3.SSS2.p3.2.m2.2.2.3.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3"><apply id="S4.SS3.SSS2.p3.2.m2.2.2.3.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.2.m2.2.2.3.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.2.m2.2.2.3.1.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.1.2">∇</ci><ci id="S4.SS3.SSS2.p3.2.m2.2.2.3.1.3.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.1.3">italic-ϕ</ci></apply><apply id="S4.SS3.SSS2.p3.2.m2.2.2.3.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.2.m2.2.2.3.2.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2">subscript</csymbol><ci id="S4.SS3.SSS2.p3.2.m2.2.2.3.2.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2.2">𝐿</ci><ci id="S4.SS3.SSS2.p3.2.m2.2.2.3.2.3a.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2.3"><mtext id="S4.SS3.SSS2.p3.2.m2.2.2.3.2.3.cmml" mathsize="70%" xref="S4.SS3.SSS2.p3.2.m2.2.2.3.2.3">dev</mtext></ci></apply></apply><apply id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1"><times id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.1"></times><apply id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.2">𝜃</ci><times id="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p3.2.m2.2.2.1.1.1.2.3"></times></apply><ci id="S4.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.2.m2.2c">\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.2.m2.2d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math>. Given that <math alttext="\theta^{*}(\phi)" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.3.m3.1"><semantics id="S4.SS3.SSS2.p3.3.m3.1a"><mrow id="S4.SS3.SSS2.p3.3.m3.1.2" xref="S4.SS3.SSS2.p3.3.m3.1.2.cmml"><msup id="S4.SS3.SSS2.p3.3.m3.1.2.2" xref="S4.SS3.SSS2.p3.3.m3.1.2.2.cmml"><mi id="S4.SS3.SSS2.p3.3.m3.1.2.2.2" xref="S4.SS3.SSS2.p3.3.m3.1.2.2.2.cmml">θ</mi><mo id="S4.SS3.SSS2.p3.3.m3.1.2.2.3" xref="S4.SS3.SSS2.p3.3.m3.1.2.2.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS2.p3.3.m3.1.2.1" xref="S4.SS3.SSS2.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS2.p3.3.m3.1.2.3.2" xref="S4.SS3.SSS2.p3.3.m3.1.2.cmml"><mo id="S4.SS3.SSS2.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S4.SS3.SSS2.p3.3.m3.1.2.cmml">(</mo><mi id="S4.SS3.SSS2.p3.3.m3.1.1" xref="S4.SS3.SSS2.p3.3.m3.1.1.cmml">ϕ</mi><mo id="S4.SS3.SSS2.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S4.SS3.SSS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.3.m3.1b"><apply id="S4.SS3.SSS2.p3.3.m3.1.2.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.2"><times id="S4.SS3.SSS2.p3.3.m3.1.2.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.2.1"></times><apply id="S4.SS3.SSS2.p3.3.m3.1.2.2.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.3.m3.1.2.2.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.2.2">superscript</csymbol><ci id="S4.SS3.SSS2.p3.3.m3.1.2.2.2.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.2.2.2">𝜃</ci><times id="S4.SS3.SSS2.p3.3.m3.1.2.2.3.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.2.2.3"></times></apply><ci id="S4.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.3.m3.1c">\theta^{*}(\phi)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.3.m3.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ )</annotation></semantics></math> is an implicit function of <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.4.m4.1"><semantics id="S4.SS3.SSS2.p3.4.m4.1a"><mi id="S4.SS3.SSS2.p3.4.m4.1.1" xref="S4.SS3.SSS2.p3.4.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.4.m4.1b"><ci id="S4.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.4.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.4.m4.1d">italic_ϕ</annotation></semantics></math>, we can derive:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\phi}L_{\text{dev}}=-\nabla_{\theta}L_{\text{dev}}\cdot\sum_{n=0}^{K}(%
I-\nabla_{\theta}^{2}L_{\text{train}})^{n}\cdot\nabla_{\phi}\nabla_{\theta}L_{%
\text{train}}." class="ltx_Math" display="block" id="S4.E10.m1.1"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.3.cmml"><msub id="S4.E10.m1.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.3.1.cmml"><mo id="S4.E10.m1.1.1.1.1.3.1.2" xref="S4.E10.m1.1.1.1.1.3.1.2.cmml">∇</mo><mi id="S4.E10.m1.1.1.1.1.3.1.3" xref="S4.E10.m1.1.1.1.1.3.1.3.cmml">ϕ</mi></msub><msub id="S4.E10.m1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="S4.E10.m1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="S4.E10.m1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1a" rspace="0.167em" xref="S4.E10.m1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml"><msub id="S4.E10.m1.1.1.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1.3.1.2" rspace="0.167em" xref="S4.E10.m1.1.1.1.1.1.1.3.1.2.cmml">∇</mo><mi id="S4.E10.m1.1.1.1.1.1.1.3.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.1.3.cmml">θ</mi></msub><msub id="S4.E10.m1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="S4.E10.m1.1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.1.1.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="S4.E10.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.055em" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.cmml"><munderover id="S4.E10.m1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mi id="S4.E10.m1.1.1.1.1.1.1.1.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E10.m1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">I</mi><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2" rspace="0.167em" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∇</mo><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml">θ</mi><mn id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml">2</mn></msubsup><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow></mrow><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S4.E10.m1.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml"><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.2" rspace="0.167em" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.2.cmml">∇</mo><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.3.cmml">ϕ</mi></msub><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∇</mo><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml">θ</mi></msub></mrow><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.1.1.1.2" lspace="0em" xref="S4.E10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><eq id="S4.E10.m1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.2"></eq><apply id="S4.E10.m1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.3"><apply id="S4.E10.m1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.1.1.cmml" xref="S4.E10.m1.1.1.1.1.3.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.1.2.cmml" xref="S4.E10.m1.1.1.1.1.3.1.2">∇</ci><ci id="S4.E10.m1.1.1.1.1.3.1.3.cmml" xref="S4.E10.m1.1.1.1.1.3.1.3">italic-ϕ</ci></apply><apply id="S4.E10.m1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.E10.m1.1.1.1.1.3.2.3a.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3"><mtext id="S4.E10.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E10.m1.1.1.1.1.3.2.3">dev</mtext></ci></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"><minus id="S4.E10.m1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1"></minus><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1"><ci id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2">⋅</ci><apply id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3"><apply id="S4.E10.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.1.2">∇</ci><ci id="S4.E10.m1.1.1.1.1.1.1.3.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.1.3">𝜃</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.3a.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.3"><mtext id="S4.E10.m1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E10.m1.1.1.1.1.1.1.3.2.3">dev</mtext></ci></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1"><apply id="S4.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E10.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3"><eq id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.2">𝑛</ci><cn id="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E10.m1.1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><ci id="S4.E10.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1"><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐼</ci><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2">∇</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3">𝜃</ci></apply><cn id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml" type="integer" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3">2</cn></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">train</mtext></ci></apply></apply></apply><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3"><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1"><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.2">∇</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.1.3">italic-ϕ</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.2">∇</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.2.3">𝜃</ci></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.3">train</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\nabla_{\phi}L_{\text{dev}}=-\nabla_{\theta}L_{\text{dev}}\cdot\sum_{n=0}^{K}(%
I-\nabla_{\theta}^{2}L_{\text{train}})^{n}\cdot\nabla_{\phi}\nabla_{\theta}L_{%
\text{train}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.1d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT = - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ⋅ ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( italic_I - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⋅ ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS2.p3.5">The detailed derivations can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.SS2" title="A.2. Detailed Derivations of Equation 10 ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">A.2</span></a>. Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E10" title="In 4.3.2. Efficient optimization of dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a> can be efficiently calculated with vector-Jacobi product<cite class="ltx_cite ltx_citemacro_citep">(Navon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib37" title="">2021</a>)</cite>. Through this, we can personalize the regenerated dataset without incurring a substantial time overhead.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>EXPERIMENTAL EVALUATION</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experimental Settings</h3>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1. </span>Datasets</h4>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.4.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S5.T1.5.2" style="font-size:90%;">Statistics of the datasets.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.2.3.1.1">Dataset</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T1.2.3.1.2">Beauty</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T1.2.3.1.3">Sports</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T1.2.3.1.4">Toys</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S5.T1.2.3.1.5">Yelp</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.1.1.1"><math alttext="|\mathcal{U}|" class="ltx_Math" display="inline" id="S5.T1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.m1.1a"><mrow id="S5.T1.1.1.1.m1.1.2.2" xref="S5.T1.1.1.1.m1.1.2.1.cmml"><mo id="S5.T1.1.1.1.m1.1.2.2.1" stretchy="false" xref="S5.T1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml">𝒰</mi><mo id="S5.T1.1.1.1.m1.1.2.2.2" stretchy="false" xref="S5.T1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><apply id="S5.T1.1.1.1.m1.1.2.1.cmml" xref="S5.T1.1.1.1.m1.1.2.2"><abs id="S5.T1.1.1.1.m1.1.2.1.1.cmml" xref="S5.T1.1.1.1.m1.1.2.2.1"></abs><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">|\mathcal{U}|</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">| caligraphic_U |</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.1.2">22,363</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.1.3">35,598</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.1.4">19,412</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.1.5">30,431</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.2.2.1"><math alttext="|\mathcal{V}|" class="ltx_Math" display="inline" id="S5.T1.2.2.1.m1.1"><semantics id="S5.T1.2.2.1.m1.1a"><mrow id="S5.T1.2.2.1.m1.1.2.2" xref="S5.T1.2.2.1.m1.1.2.1.cmml"><mo id="S5.T1.2.2.1.m1.1.2.2.1" stretchy="false" xref="S5.T1.2.2.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.T1.2.2.1.m1.1.1" xref="S5.T1.2.2.1.m1.1.1.cmml">𝒱</mi><mo id="S5.T1.2.2.1.m1.1.2.2.2" stretchy="false" xref="S5.T1.2.2.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.1.m1.1b"><apply id="S5.T1.2.2.1.m1.1.2.1.cmml" xref="S5.T1.2.2.1.m1.1.2.2"><abs id="S5.T1.2.2.1.m1.1.2.1.1.cmml" xref="S5.T1.2.2.1.m1.1.2.2.1"></abs><ci id="S5.T1.2.2.1.m1.1.1.cmml" xref="S5.T1.2.2.1.m1.1.1">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.1.m1.1c">|\mathcal{V}|</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.1.m1.1d">| caligraphic_V |</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S5.T1.2.2.2">12,101</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.2.3">18,357</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.2.4">11,924</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.2.5">20,033</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.2.4.1.1"># Interactions</th>
<td class="ltx_td ltx_align_left" id="S5.T1.2.4.1.2">0.2m</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.4.1.3">0.3m</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.4.1.4">0.17m</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.4.1.5">0.3m</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.2.5.2.1">Avg. length</th>
<td class="ltx_td ltx_align_left" id="S5.T1.2.5.2.2">8.9</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.5.2.3">8.3</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.5.2.4">8.6</td>
<td class="ltx_td ltx_align_left" id="S5.T1.2.5.2.5">8.3</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T1.2.6.3.1">Sparsity</th>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T1.2.6.3.2">99.95%</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T1.2.6.3.3">99.95%</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T1.2.6.3.4">99.93%</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T1.2.6.3.5">99.95%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">To validate the effectiveness of our proposed approach, we follow previous works<cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib60" title="">2022</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib4" title="">2022</a>)</cite> to conduct experiments on four commonly used and publicly available datasets:</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Beauty, Sports, Toys<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://snap.stanford.edu/data/amazon/productGraph/categoryFiles/" title="">http://snap.stanford.edu/data/amazon/productGraph/categoryFiles/</a></span></span></span></span>: The Amazon-review dataset has emerged as a prominent resource for evaluating recommendation systems. For our study, we specifically choose three categories, namely ”Beauty,” ”Sports and Outdoors,” and ”Toys and Games.”</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">Yelp<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.yelp.com/dataset" title="">https://www.yelp.com/dataset</a></span></span></span></span>: The Yelp dataset is a widely used business review dataset that contains information about businesses, users, and reviews.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p2">
<p class="ltx_p" id="S5.SS1.SSS1.p2.1">We follow the preprocessing in <cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib60" title="">2022</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib4" title="">2022</a>)</cite> to guarantee a minimum of 5 interactions associated with each user and item.
Statistics of the preprocessed datasets are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.T1" title="Table 1 ‣ 5.1.1. Datasets ‣ 5.1. Experimental Settings ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2. </span>Compared Baselines and Target Models</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.1">To verify the superiority of DR4SR, we select two representative data-centric baselines:</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><math alttext="\infty" class="ltx_Math" display="inline" id="S5.I2.i1.p1.1.m1.1"><semantics id="S5.I2.i1.p1.1.m1.1a"><mi id="S5.I2.i1.p1.1.m1.1.1" mathvariant="normal" xref="S5.I2.i1.p1.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S5.I2.i1.p1.1.m1.1b"><infinity id="S5.I2.i1.p1.1.m1.1.1.cmml" xref="S5.I2.i1.p1.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i1.p1.1.m1.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="S5.I2.i1.p1.1.m1.1d">∞</annotation></semantics></math>-AE <cite class="ltx_cite ltx_citemacro_citep">(Sachdeva et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib41" title="">2022</a>)</cite>: an AutoEncoder-based framework, synthesizing user interaction data with sampling-based reconstruction.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1">MELT <cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib22" title="">2023</a>)</cite>: it focused on the long-tail problem through data generation for long-tail users and items, respectively.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.SS1.SSS2.p1.2">To fully demonstrate the cross-architecture generalizability of DR4SR, we select target models from various categories:</p>
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1">RNN-based: GRU4Rec<cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib12" title="">2016</a>)</cite> is a sequential recommender system that applies GRU layers to capture dynamic user preferences.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.1">Transformer-based: SASRec<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib21" title="">2018</a>)</cite> is a sequential recommendation model that leverages self-attention mechanisms<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib46" title="">2017</a>)</cite> to make item recommendations for the next user action.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i3.p1">
<p class="ltx_p" id="S5.I3.i3.p1.1">Denoising-based: FMLP<cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib83" title="">2022</a>)</cite> is one of the most representative denoising-based SR methods, which adopts a filter-enhanced MLP to remove noises in interaction sequences.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i4.p1">
<p class="ltx_p" id="S5.I3.i4.p1.1">GNN-based: GCE-GNN<cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib54" title="">2020</a>)</cite> constructs an item graph to capture global context information facilitating recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i5.p1">
<p class="ltx_p" id="S5.I3.i5.p1.1">Contrastive-learning-based: CL4SRec<cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib60" title="">2022</a>)</cite> is one of the most powerful contrastive sequential recommenders, which introduces three sequence-level augmentation strategies.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.SS1.SSS2.p1.3">The proposed framework is a data-centric framework, which is complementary to those model-centric methods. Therefore, we integrate DR4SR with all of them to validate the cross-architecture generalizability of DR4SR:</p>
<ul class="ltx_itemize" id="S5.I4">
<li class="ltx_item" id="S5.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i1.p1">
<p class="ltx_p" id="S5.I4.i1.p1.1">Backbone: We train one target model on the original dataset.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i2.p1">
<p class="ltx_p" id="S5.I4.i2.p1.1">DR4SR: We integrate DR4SR with the target model.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i3.p1">
<p class="ltx_p" id="S5.I4.i3.p1.1">DR4SR+: We integrate DR4SR+ with the target model.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3. </span>Evaluation Protocols</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">To assess the performance of the next-item recommendations, we adopt the widely-used leave-one-out strategy<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib21" title="">2018</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib60" title="">2022</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib4" title="">2022</a>)</cite>.
Considering evaluation metrics, we employ two ranking metrics Recall@{10, 20} and NDCG@{10, 20}. Furthermore, we follow the suggestion of Krichene and Rendle<cite class="ltx_cite ltx_citemacro_citep">(Krichene and Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib25" title="">2021</a>)</cite> to adopt the whole item set as the candidate item set during evaluation.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.4. </span>Implementation Details</h4>
<div class="ltx_para" id="S5.SS1.SSS4.p1">
<p class="ltx_p" id="S5.SS1.SSS4.p1.3">To ensure a fair comparison environment, we implement DR4SR and all target models based on an open-source recommender system library RecStudio<cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib29" title="">2023</a>)</cite>. The training process is configured with a maximum of 1000 epochs, and early stopping is employed if the NDCG@20 on the validation data does not improve for 20 consecutive epochs. The training batch size <math alttext="B" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.1.m1.1"><semantics id="S5.SS1.SSS4.p1.1.m1.1a"><mi id="S5.SS1.SSS4.p1.1.m1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.1.m1.1b"><ci id="S5.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.1.m1.1d">italic_B</annotation></semantics></math> is fixed to 256, Adam<cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib23" title="">2015</a>)</cite> with a learning rate of 1e-3 is used as the optimizer, the embedding size <math alttext="d" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.2.m2.1"><semantics id="S5.SS1.SSS4.p1.2.m2.1a"><mi id="S5.SS1.SSS4.p1.2.m2.1.1" xref="S5.SS1.SSS4.p1.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.2.m2.1b"><ci id="S5.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.2.m2.1d">italic_d</annotation></semantics></math> is set to 64, and the maximum sequence length <math alttext="N" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.3.m3.1"><semantics id="S5.SS1.SSS4.p1.3.m3.1a"><mi id="S5.SS1.SSS4.p1.3.m3.1.1" xref="S5.SS1.SSS4.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.3.m3.1b"><ci id="S5.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.3.m3.1d">italic_N</annotation></semantics></math> is set to 50 for all datasets. BCE loss is used for all baselines. Detailed hyper-parameter settings of each model can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.SS4" title="A.4. Detailed Hyper-parameters ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">A.4</span></a>. Notably, we fixed the hyper-parameters of each target model when integrating DR4SR with them.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.2.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S5.T2.3.2" style="font-size:90%;">Statistics of the regenerated datasets.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.4.1.1.1">Dataset</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.1.1.2">Beauty</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.1.1.3">Sport</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.1.1.4">Toys</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.1.1.5">Yelp</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.4.2.2.1">#users</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.2.2.2">22,363</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.2.2.3">35598</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.2.2.4">19412</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.2.2.5">30431</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.4.3.3.1">#items</th>
<td class="ltx_td ltx_align_left" id="S5.T2.4.3.3.2">12101</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.3.3.3">18357</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.3.3.4">11924</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.3.3.5">20033</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.4.4.4.1">#interactions</th>
<td class="ltx_td ltx_align_left" id="S5.T2.4.4.4.2">0.32m</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.4.4.3">0.45m</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.4.4.4">0.30m</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.4.4.5">0.52m</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.4.5.5.1">#Avg.length</th>
<td class="ltx_td ltx_align_left" id="S5.T2.4.5.5.2">4.0</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.5.5.3">4.2</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.5.5.4">3.7</td>
<td class="ltx_td ltx_align_left" id="S5.T2.4.5.5.5">4.1</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T2.4.6.6.1">Sparsity</th>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T2.4.6.6.2">99.87%</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T2.4.6.6.3">99.93%</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T2.4.6.6.4">99.87%</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T2.4.6.6.5">99.91%</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Overall Performance</h3>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.160.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S5.T3.161.2" style="font-size:90%;">The overall performance. Considering a target model, the best result is bolded while the second-best result is underlined. Superscript * means improvements are statistically significant with p¡0.05 while ** meaning p¡0.01.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T3.158" style="width:433.6pt;height:288.9pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-175.7pt,116.8pt) scale(0.552340072863427,0.552340072863427) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.158.158">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.158.158.159.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.158.158.159.1.1">Dataset</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T3.158.158.159.1.2">Beauty</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T3.158.158.159.1.3">Sports</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T3.158.158.159.1.4">Toys</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S5.T3.158.158.159.1.5">Yelp</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.160.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.158.158.160.2.1">Metric</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.2">R@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.3">R@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.4">N@10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.160.2.5">N@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.6">R@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.7">R@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.8">N@10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.160.2.9">N@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.10">R@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.11">R@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.12">N@10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.160.2.13">N@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.14">R@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.15">R@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.16">N@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.160.2.17">N@20</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.1.1.1">
<math alttext="\infty" class="ltx_Math" display="inline" id="S5.T3.1.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.1.m1.1a"><mi id="S5.T3.1.1.1.1.m1.1.1" mathvariant="normal" xref="S5.T3.1.1.1.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><infinity id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.1.m1.1d">∞</annotation></semantics></math>-AE</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.2">0.0478</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.3">0.0661</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.4">0.0262</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.1.1.5">0.0308</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.6">0.0256</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.7">0.0373</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.8">0.0144</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.1.1.9">0.0173</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.10">0.0450</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.11">0.0593</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.12">0.0268</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.1.1.13">0.0304</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.14">0.0252</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.15">0.0424</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.16">0.0121</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.17">0.0162</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.161.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.161.3.1">MELT</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.2">0.0577</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.3">0.0879</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.4">0.0303</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.161.3.5">0.0379</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.6">0.0311</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.7">0.0488</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.8">0.0163</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.161.3.9">0.0208</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.10">0.0709</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.11">0.0987</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.12">0.0401</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.161.3.13">0.0473</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.14">0.0293</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.15">0.0497</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.16">0.0143</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.161.3.17">0.0195</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.162.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.158.158.162.4.1">GRU4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.2">0.0204</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.3">0.0382</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.4">0.0107</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.158.158.162.4.5">0.0150</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.6">0.0160</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.7">0.0279</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.8">0.0085</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.158.158.162.4.9">0.0115</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.10">0.0212</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.11">0.0357</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.12">0.0099</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.158.158.162.4.13">0.0136</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.14">0.0215</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.15">0.0364</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.16">0.0105</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.158.158.162.4.17">0.0143</td>
</tr>
<tr class="ltx_tr" id="S5.T3.17.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.17.17.17.17">DR4SR</th>
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.2.2.2.1.1">0.0252<sup class="ltx_sup" id="S5.T3.2.2.2.1.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.2.2.2.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.3.3.2.1">0.0448<sup class="ltx_sup" id="S5.T3.3.3.3.2.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.3.3.3.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.4.4.4.3.1">0.0128<sup class="ltx_sup" id="S5.T3.4.4.4.3.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.4.4.4.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.5.5.5.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.5.5.4.1">0.0177<sup class="ltx_sup" id="S5.T3.5.5.5.4.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.5.5.5.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.6.6.6.5.1">0.0208<sup class="ltx_sup" id="S5.T3.6.6.6.5.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.6.6.6.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.7.7.7.6.1">0.0341<sup class="ltx_sup" id="S5.T3.7.7.7.6.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.7.7.7.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.8.8.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.8.8.8.7.1">0.0102<sup class="ltx_sup" id="S5.T3.8.8.8.7.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.8.8.8.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.9.9.9.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.9.9.9.8.1">0.0135<sup class="ltx_sup" id="S5.T3.9.9.9.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.9.9.9.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.10.10.10.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.10.10.10.9.1">0.0252<sup class="ltx_sup" id="S5.T3.10.10.10.9.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.10.10.10.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.11.11.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.11.11.11.10.1">0.0418<sup class="ltx_sup" id="S5.T3.11.11.11.10.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.11.11.11.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.12.12.12.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.12.12.12.11.1">0.0124<sup class="ltx_sup" id="S5.T3.12.12.12.11.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.12.12.12.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.13.13.13.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.13.13.13.12.1">0.0165<sup class="ltx_sup" id="S5.T3.13.13.13.12.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.13.13.13.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.14.14.14.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.14.14.14.13.1">0.0235<sup class="ltx_sup" id="S5.T3.14.14.14.13.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.14.14.14.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.15.15.15.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.15.15.15.14.1">0.0403<sup class="ltx_sup" id="S5.T3.15.15.15.14.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.15.15.15.14.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.16.16.16.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.16.16.16.15.1">0.0114<sup class="ltx_sup" id="S5.T3.16.16.16.15.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.16.16.16.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.17.17.17.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.17.17.17.16.1">0.0156<sup class="ltx_sup" id="S5.T3.17.17.17.16.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.17.17.17.16.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.163.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.163.5.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.2">23.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.3">17.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.4">19.6%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.163.5.5">18.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.6">30.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.7">22.2%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.8">20.0%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.163.5.9">17.4%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.10">18.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.11">22.4%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.12">25.3%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.163.5.13">21.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.14">9.30%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.15">10.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.16">8.57%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.163.5.17">9.09%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.33.33.33">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.33.33.33.17">DR4SR+</th>
<td class="ltx_td ltx_align_center" id="S5.T3.18.18.18.1"><span class="ltx_text ltx_font_bold" id="S5.T3.18.18.18.1.1">0.0292<sup class="ltx_sup" id="S5.T3.18.18.18.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.18.18.18.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.19.19.19.2"><span class="ltx_text ltx_font_bold" id="S5.T3.19.19.19.2.1">0.0473<sup class="ltx_sup" id="S5.T3.19.19.19.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.19.19.19.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.20.20.20.3"><span class="ltx_text ltx_font_bold" id="S5.T3.20.20.20.3.1">0.0149<sup class="ltx_sup" id="S5.T3.20.20.20.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.20.20.20.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.21.21.21.4"><span class="ltx_text ltx_font_bold" id="S5.T3.21.21.21.4.1">0.0194<sup class="ltx_sup" id="S5.T3.21.21.21.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.21.21.21.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.22.22.22.5"><span class="ltx_text ltx_font_bold" id="S5.T3.22.22.22.5.1">0.0223<sup class="ltx_sup" id="S5.T3.22.22.22.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.22.22.22.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.23.23.23.6"><span class="ltx_text ltx_font_bold" id="S5.T3.23.23.23.6.1">0.0360<sup class="ltx_sup" id="S5.T3.23.23.23.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.23.23.23.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.24.24.24.7"><span class="ltx_text ltx_font_bold" id="S5.T3.24.24.24.7.1">0.0116<sup class="ltx_sup" id="S5.T3.24.24.24.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.24.24.24.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.25.25.25.8"><span class="ltx_text ltx_font_bold" id="S5.T3.25.25.25.8.1">0.0151<sup class="ltx_sup" id="S5.T3.25.25.25.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.25.25.25.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.26.26.26.9"><span class="ltx_text ltx_font_bold" id="S5.T3.26.26.26.9.1">0.0274<sup class="ltx_sup" id="S5.T3.26.26.26.9.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.26.26.26.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.27.27.27.10"><span class="ltx_text ltx_font_bold" id="S5.T3.27.27.27.10.1">0.0456<sup class="ltx_sup" id="S5.T3.27.27.27.10.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.27.27.27.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.28.28.28.11"><span class="ltx_text ltx_font_bold" id="S5.T3.28.28.28.11.1">0.0134<sup class="ltx_sup" id="S5.T3.28.28.28.11.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.28.28.28.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.29.29.29.12"><span class="ltx_text ltx_font_bold" id="S5.T3.29.29.29.12.1">0.0179<sup class="ltx_sup" id="S5.T3.29.29.29.12.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.29.29.29.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.30.30.30.13"><span class="ltx_text ltx_font_bold" id="S5.T3.30.30.30.13.1">0.0243<sup class="ltx_sup" id="S5.T3.30.30.30.13.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.30.30.30.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.31.31.31.14"><span class="ltx_text ltx_font_bold" id="S5.T3.31.31.31.14.1">0.0415<sup class="ltx_sup" id="S5.T3.31.31.31.14.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.31.31.31.14.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.32.32.32.15"><span class="ltx_text ltx_font_bold" id="S5.T3.32.32.32.15.1">0.0120<sup class="ltx_sup" id="S5.T3.32.32.32.15.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.32.32.32.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.33.33.33.16"><span class="ltx_text ltx_font_bold" id="S5.T3.33.33.33.16.1">0.0164<sup class="ltx_sup" id="S5.T3.33.33.33.16.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.33.33.33.16.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.164.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.164.6.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.2">43.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.3">23.8%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.4">39.3%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.164.6.5">29.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.6">39.4%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.7">29.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.8">36.5%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.164.6.9">31.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.10">29.2%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.11">27.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.12">35.4%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.164.6.13">31.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.14">13.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.15">14.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.16">14.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.164.6.17">14.7%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.165.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.158.158.165.7.1">SASRec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.2">0.0553</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.3">0.0847</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.4">0.0291</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.165.7.5">0.0368</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.6">0.0297</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.7">0.0449</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.8">0.0156</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.165.7.9">0.0194</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.10">0.0682</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.11">0.0951</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.12">0.0381</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.165.7.13">0.0448</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.14">0.0289</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.15">0.0488</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.16">0.0143</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.165.7.17">0.0193</td>
</tr>
<tr class="ltx_tr" id="S5.T3.49.49.49">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.49.49.49.17">DR4SR</th>
<td class="ltx_td ltx_align_center" id="S5.T3.34.34.34.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.34.34.34.1.1">0.0595<sup class="ltx_sup" id="S5.T3.34.34.34.1.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.34.34.34.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.35.35.35.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.35.35.35.2.1">0.0906<sup class="ltx_sup" id="S5.T3.35.35.35.2.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.35.35.35.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.36.36.36.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.36.36.36.3.1">0.0317<sup class="ltx_sup" id="S5.T3.36.36.36.3.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.36.36.36.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.37.37.37.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.37.37.37.4.1">0.0395<sup class="ltx_sup" id="S5.T3.37.37.37.4.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.37.37.37.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.38.38.38.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.38.38.38.5.1">0.0330<sup class="ltx_sup" id="S5.T3.38.38.38.5.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.38.38.38.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.39.39.39.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.39.39.39.6.1">0.0512<sup class="ltx_sup" id="S5.T3.39.39.39.6.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.39.39.39.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.40.40.40.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.40.40.40.7.1">0.0174<sup class="ltx_sup" id="S5.T3.40.40.40.7.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.40.40.40.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.41.41.41.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.41.41.41.8.1">0.0220<sup class="ltx_sup" id="S5.T3.41.41.41.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.41.41.41.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.42.42.42.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.42.42.42.9.1">0.0762<sup class="ltx_sup" id="S5.T3.42.42.42.9.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.42.42.42.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.43.43.43.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.43.43.43.10.1">0.1049<sup class="ltx_sup" id="S5.T3.43.43.43.10.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.43.43.43.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.44.44.44.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.44.44.44.11.1">0.0432<sup class="ltx_sup" id="S5.T3.44.44.44.11.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.44.44.44.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.45.45.45.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.45.45.45.12.1">0.0504<sup class="ltx_sup" id="S5.T3.45.45.45.12.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.45.45.45.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.46.46.46.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.46.46.46.13.1">0.0304<sup class="ltx_sup" id="S5.T3.46.46.46.13.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.46.46.46.13.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.47.47.47.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.47.47.47.14.1">0.0512<sup class="ltx_sup" id="S5.T3.47.47.47.14.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.47.47.47.14.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.48.48.48.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.48.48.48.15.1">0.0151<sup class="ltx_sup" id="S5.T3.48.48.48.15.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.48.48.48.15.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.49.49.49.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.49.49.49.16.1">0.0202<sup class="ltx_sup" id="S5.T3.49.49.49.16.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.49.49.49.16.1.1.1">∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.166.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.166.8.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.2">7.59%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.3">6.97%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.4">8.93%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.166.8.5">7.34%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.6">11.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.7">14.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.8">11.5%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.166.8.9">13.4%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.10">11.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.11">10.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.12">13.4%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.166.8.13">12.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.14">5.19%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.15">4.92%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.16">5.59%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.166.8.17">4.66%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.65.65.65">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.65.65.65.17">DR4SR+</th>
<td class="ltx_td ltx_align_center" id="S5.T3.50.50.50.1"><span class="ltx_text ltx_font_bold" id="S5.T3.50.50.50.1.1">0.0619<sup class="ltx_sup" id="S5.T3.50.50.50.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.50.50.50.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.51.51.51.2"><span class="ltx_text ltx_font_bold" id="S5.T3.51.51.51.2.1">0.0919<sup class="ltx_sup" id="S5.T3.51.51.51.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.51.51.51.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.52.52.52.3"><span class="ltx_text ltx_font_bold" id="S5.T3.52.52.52.3.1">0.0337<sup class="ltx_sup" id="S5.T3.52.52.52.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.52.52.52.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.53.53.53.4"><span class="ltx_text ltx_font_bold" id="S5.T3.53.53.53.4.1">0.0412<sup class="ltx_sup" id="S5.T3.53.53.53.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.53.53.53.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.54.54.54.5"><span class="ltx_text ltx_font_bold" id="S5.T3.54.54.54.5.1">0.0349<sup class="ltx_sup" id="S5.T3.54.54.54.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.54.54.54.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.55.55.55.6"><span class="ltx_text ltx_font_bold" id="S5.T3.55.55.55.6.1">0.0525<sup class="ltx_sup" id="S5.T3.55.55.55.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.55.55.55.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.56.56.56.7"><span class="ltx_text ltx_font_bold" id="S5.T3.56.56.56.7.1">0.0191<sup class="ltx_sup" id="S5.T3.56.56.56.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.56.56.56.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.57.57.57.8"><span class="ltx_text ltx_font_bold" id="S5.T3.57.57.57.8.1">0.0235<sup class="ltx_sup" id="S5.T3.57.57.57.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.57.57.57.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.58.58.58.9"><span class="ltx_text ltx_font_bold" id="S5.T3.58.58.58.9.1">0.0773<sup class="ltx_sup" id="S5.T3.58.58.58.9.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.58.58.58.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.59.59.59.10"><span class="ltx_text ltx_font_bold" id="S5.T3.59.59.59.10.1">0.1068<sup class="ltx_sup" id="S5.T3.59.59.59.10.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.59.59.59.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.60.60.60.11"><span class="ltx_text ltx_font_bold" id="S5.T3.60.60.60.11.1">0.0453<sup class="ltx_sup" id="S5.T3.60.60.60.11.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.60.60.60.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.61.61.61.12"><span class="ltx_text ltx_font_bold" id="S5.T3.61.61.61.12.1">0.0527<sup class="ltx_sup" id="S5.T3.61.61.61.12.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.61.61.61.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.62.62.62.13"><span class="ltx_text ltx_font_bold" id="S5.T3.62.62.62.13.1">0.0317<sup class="ltx_sup" id="S5.T3.62.62.62.13.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.62.62.62.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.63.63.63.14"><span class="ltx_text ltx_font_bold" id="S5.T3.63.63.63.14.1">0.0523<sup class="ltx_sup" id="S5.T3.63.63.63.14.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.63.63.63.14.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.64.64.64.15"><span class="ltx_text ltx_font_bold" id="S5.T3.64.64.64.15.1">0.0159<sup class="ltx_sup" id="S5.T3.64.64.64.15.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.64.64.64.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.65.65.65.16"><span class="ltx_text ltx_font_bold" id="S5.T3.65.65.65.16.1">0.0211<sup class="ltx_sup" id="S5.T3.65.65.65.16.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.65.65.65.16.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.167.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.167.9.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.2">11.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.3">8.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.4">15.8%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.167.9.5">12.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.6">17.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.7">16.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.8">22.4%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.167.9.9">21.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.10">13.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.11">12.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.12">18.9%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.167.9.13">17.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.14">9.69%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.15">7.17%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.16">11.2%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.167.9.17">9.33%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.168.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.158.158.168.10.1">FMLP</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.2">0.0602</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.3">0.0934</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.4">0.0311</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.168.10.5">0.0394</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.6">0.0323</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.7">0.0524</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.8">0.0166</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.168.10.9">0.0217</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.10">0.0676</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.11">0.0982</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.12">0.0377</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.168.10.13">0.0447</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.14">0.0297</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.15">0.0495</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.16">0.0143</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.168.10.17">0.0197</td>
</tr>
<tr class="ltx_tr" id="S5.T3.78.78.78">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.78.78.78.14">DR4SR</th>
<td class="ltx_td ltx_align_center" id="S5.T3.66.66.66.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.66.66.66.1.1">0.0635<sup class="ltx_sup" id="S5.T3.66.66.66.1.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.66.66.66.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.67.67.67.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.67.67.67.2.1">0.0993<sup class="ltx_sup" id="S5.T3.67.67.67.2.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.67.67.67.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.68.68.68.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.68.68.68.3.1">0.0332<sup class="ltx_sup" id="S5.T3.68.68.68.3.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.68.68.68.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.78.78.78.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.78.78.78.15.1">0.0421</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.78.78.78.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.78.78.78.16.1">0.0345</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.78.78.78.17"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.78.78.78.17.1">0.0559</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.69.69.69.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.69.69.69.4.1">0.0177<sup class="ltx_sup" id="S5.T3.69.69.69.4.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.69.69.69.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.70.70.70.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.70.70.70.5.1">0.0230<sup class="ltx_sup" id="S5.T3.70.70.70.5.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.70.70.70.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.71.71.71.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.71.71.71.6.1">0.0717<sup class="ltx_sup" id="S5.T3.71.71.71.6.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.71.71.71.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.72.72.72.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.72.72.72.7.1">0.1061<sup class="ltx_sup" id="S5.T3.72.72.72.7.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.72.72.72.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.73.73.73.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.73.73.73.8.1">0.0400<sup class="ltx_sup" id="S5.T3.73.73.73.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.73.73.73.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.74.74.74.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.74.74.74.9.1">0.0486<sup class="ltx_sup" id="S5.T3.74.74.74.9.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.74.74.74.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.75.75.75.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.75.75.75.10.1">0.0316<sup class="ltx_sup" id="S5.T3.75.75.75.10.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.75.75.75.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.76.76.76.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.76.76.76.11.1">0.0524<sup class="ltx_sup" id="S5.T3.76.76.76.11.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.76.76.76.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.77.77.77.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.77.77.77.12.1">0.0158<sup class="ltx_sup" id="S5.T3.77.77.77.12.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.77.77.77.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.78.78.78.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.78.78.78.13.1">0.0210<sup class="ltx_sup" id="S5.T3.78.78.78.13.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.78.78.78.13.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.169.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.169.11.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.2">5.48%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.3">6.32%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.4">6.75%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.169.11.5">6.85%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.6">6.81%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.7">6.68</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.8">6.63%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.169.11.9">5.99%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.10">6.07%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.11">8.04%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.12">6.10%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.169.11.13">8.72%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.14">6.40%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.15">5.86%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.16">10.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.169.11.17">6.60%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.94.94.94">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.94.94.94.17">DR4SR+</th>
<td class="ltx_td ltx_align_center" id="S5.T3.79.79.79.1"><span class="ltx_text ltx_font_bold" id="S5.T3.79.79.79.1.1">0.0687<sup class="ltx_sup" id="S5.T3.79.79.79.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.79.79.79.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.80.80.80.2"><span class="ltx_text ltx_font_bold" id="S5.T3.80.80.80.2.1">0.1056<sup class="ltx_sup" id="S5.T3.80.80.80.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.80.80.80.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.81.81.81.3"><span class="ltx_text ltx_font_bold" id="S5.T3.81.81.81.3.1">0.0357<sup class="ltx_sup" id="S5.T3.81.81.81.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.81.81.81.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.82.82.82.4"><span class="ltx_text ltx_font_bold" id="S5.T3.82.82.82.4.1">0.0449<sup class="ltx_sup" id="S5.T3.82.82.82.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.82.82.82.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.83.83.83.5"><span class="ltx_text ltx_font_bold" id="S5.T3.83.83.83.5.1">0.0384<sup class="ltx_sup" id="S5.T3.83.83.83.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.83.83.83.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.84.84.84.6"><span class="ltx_text ltx_font_bold" id="S5.T3.84.84.84.6.1">0.0597<sup class="ltx_sup" id="S5.T3.84.84.84.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.84.84.84.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.85.85.85.7"><span class="ltx_text ltx_font_bold" id="S5.T3.85.85.85.7.1">0.0198<sup class="ltx_sup" id="S5.T3.85.85.85.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.85.85.85.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.86.86.86.8"><span class="ltx_text ltx_font_bold" id="S5.T3.86.86.86.8.1">0.0253<sup class="ltx_sup" id="S5.T3.86.86.86.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.86.86.86.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.87.87.87.9"><span class="ltx_text ltx_font_bold" id="S5.T3.87.87.87.9.1">0.0788<sup class="ltx_sup" id="S5.T3.87.87.87.9.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.87.87.87.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.88.88.88.10"><span class="ltx_text ltx_font_bold" id="S5.T3.88.88.88.10.1">0.1136<sup class="ltx_sup" id="S5.T3.88.88.88.10.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.88.88.88.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.89.89.89.11"><span class="ltx_text ltx_font_bold" id="S5.T3.89.89.89.11.1">0.0437<sup class="ltx_sup" id="S5.T3.89.89.89.11.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.89.89.89.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.90.90.90.12"><span class="ltx_text ltx_font_bold" id="S5.T3.90.90.90.12.1">0.0524<sup class="ltx_sup" id="S5.T3.90.90.90.12.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.90.90.90.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.91.91.91.13"><span class="ltx_text ltx_font_bold" id="S5.T3.91.91.91.13.1">0.0353<sup class="ltx_sup" id="S5.T3.91.91.91.13.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.91.91.91.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.92.92.92.14"><span class="ltx_text ltx_font_bold" id="S5.T3.92.92.92.14.1">0.0582<sup class="ltx_sup" id="S5.T3.92.92.92.14.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.92.92.92.14.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.93.93.93.15"><span class="ltx_text ltx_font_bold" id="S5.T3.93.93.93.15.1">0.0171<sup class="ltx_sup" id="S5.T3.93.93.93.15.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.93.93.93.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.94.94.94.16"><span class="ltx_text ltx_font_bold" id="S5.T3.94.94.94.16.1">0.0231<sup class="ltx_sup" id="S5.T3.94.94.94.16.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.94.94.94.16.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.170.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.170.12.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.2">14.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.3">13.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.4">14.8%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.170.12.5">14.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.6">18.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.7">13.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.8">19.3%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.170.12.9">16.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.10">16.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.11">15.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.12">15.9%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.170.12.13">17.2%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.14">18.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.15">17.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.16">19.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.170.12.17">17.3%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.171.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.158.158.171.13.1">GNN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.2">0.0570</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.3">0.0859</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.4">0.0311</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.171.13.5">0.0384</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.6">0.0311</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.7">0.0476</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.8">0.0167</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.171.13.9">0.0211</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.10">0.0697</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.11">0.0958</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.12">0.0403</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.171.13.13">0.0469</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.14">0.0242</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.15">0.0430</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.16">0.0118</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.171.13.17">0.0166</td>
</tr>
<tr class="ltx_tr" id="S5.T3.110.110.110">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.110.110.110.17">DR4SR</th>
<td class="ltx_td ltx_align_center" id="S5.T3.95.95.95.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.95.95.95.1.1">0.0611<sup class="ltx_sup" id="S5.T3.95.95.95.1.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.95.95.95.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.96.96.96.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.96.96.96.2.1">0.0926<sup class="ltx_sup" id="S5.T3.96.96.96.2.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.96.96.96.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.97.97.97.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.97.97.97.3.1">0.0324<sup class="ltx_sup" id="S5.T3.97.97.97.3.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.97.97.97.3.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.98.98.98.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.98.98.98.4.1">0.0406<sup class="ltx_sup" id="S5.T3.98.98.98.4.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.98.98.98.4.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.99.99.99.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.99.99.99.5.1">0.0336<sup class="ltx_sup" id="S5.T3.99.99.99.5.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.99.99.99.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.100.100.100.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.100.100.100.6.1">0.0525<sup class="ltx_sup" id="S5.T3.100.100.100.6.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.100.100.100.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.101.101.101.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.101.101.101.7.1">0.0182<sup class="ltx_sup" id="S5.T3.101.101.101.7.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.101.101.101.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.102.102.102.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.102.102.102.8.1">0.0230<sup class="ltx_sup" id="S5.T3.102.102.102.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.102.102.102.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.103.103.103.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.103.103.103.9.1">0.0736<sup class="ltx_sup" id="S5.T3.103.103.103.9.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.103.103.103.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.104.104.104.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.104.104.104.10.1">0.1031<sup class="ltx_sup" id="S5.T3.104.104.104.10.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.104.104.104.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.105.105.105.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.105.105.105.11.1">0.0424<sup class="ltx_sup" id="S5.T3.105.105.105.11.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.105.105.105.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.106.106.106.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.106.106.106.12.1">0.0498<sup class="ltx_sup" id="S5.T3.106.106.106.12.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.106.106.106.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.107.107.107.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.107.107.107.13.1">0.0268<sup class="ltx_sup" id="S5.T3.107.107.107.13.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.107.107.107.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.108.108.108.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.108.108.108.14.1">0.0451<sup class="ltx_sup" id="S5.T3.108.108.108.14.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.108.108.108.14.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.109.109.109.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.109.109.109.15.1">0.0129<sup class="ltx_sup" id="S5.T3.109.109.109.15.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.109.109.109.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.110.110.110.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.110.110.110.16.1">0.0175<sup class="ltx_sup" id="S5.T3.110.110.110.16.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.110.110.110.16.1.1.1">∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.172.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.172.14.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.2">7.19%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.3">7.80%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.4">4.18%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.172.14.5">5.73%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.6">8.04%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.7">10.3%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.8">8.98%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.172.14.9">9.00%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.10">5.60%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.11">7.62%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.12">5.21%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.172.14.13">6.18%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.14">10.7%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.15">4.88%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.16">9.32%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.172.14.17">5.42%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.126.126.126">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.126.126.126.17">DR4SR+</th>
<td class="ltx_td ltx_align_center" id="S5.T3.111.111.111.1"><span class="ltx_text ltx_font_bold" id="S5.T3.111.111.111.1.1">0.0637<sup class="ltx_sup" id="S5.T3.111.111.111.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.111.111.111.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.112.112.112.2"><span class="ltx_text ltx_font_bold" id="S5.T3.112.112.112.2.1">0.0953<sup class="ltx_sup" id="S5.T3.112.112.112.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.112.112.112.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.113.113.113.3"><span class="ltx_text ltx_font_bold" id="S5.T3.113.113.113.3.1">0.0334<sup class="ltx_sup" id="S5.T3.113.113.113.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.113.113.113.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.114.114.114.4"><span class="ltx_text ltx_font_bold" id="S5.T3.114.114.114.4.1">0.0414<sup class="ltx_sup" id="S5.T3.114.114.114.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.114.114.114.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.115.115.115.5"><span class="ltx_text ltx_font_bold" id="S5.T3.115.115.115.5.1">0.0351<sup class="ltx_sup" id="S5.T3.115.115.115.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.115.115.115.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.116.116.116.6"><span class="ltx_text ltx_font_bold" id="S5.T3.116.116.116.6.1">0.0545<sup class="ltx_sup" id="S5.T3.116.116.116.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.116.116.116.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.117.117.117.7"><span class="ltx_text ltx_font_bold" id="S5.T3.117.117.117.7.1">0.0189<sup class="ltx_sup" id="S5.T3.117.117.117.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.117.117.117.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.118.118.118.8"><span class="ltx_text ltx_font_bold" id="S5.T3.118.118.118.8.1">0.0238<sup class="ltx_sup" id="S5.T3.118.118.118.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.118.118.118.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.119.119.119.9"><span class="ltx_text ltx_font_bold" id="S5.T3.119.119.119.9.1">0.0771<sup class="ltx_sup" id="S5.T3.119.119.119.9.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.119.119.119.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.120.120.120.10"><span class="ltx_text ltx_font_bold" id="S5.T3.120.120.120.10.1">0.1082<sup class="ltx_sup" id="S5.T3.120.120.120.10.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.120.120.120.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.121.121.121.11"><span class="ltx_text ltx_font_bold" id="S5.T3.121.121.121.11.1">0.0442<sup class="ltx_sup" id="S5.T3.121.121.121.11.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.121.121.121.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.122.122.122.12"><span class="ltx_text ltx_font_bold" id="S5.T3.122.122.122.12.1">0.0521<sup class="ltx_sup" id="S5.T3.122.122.122.12.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.122.122.122.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.123.123.123.13"><span class="ltx_text ltx_font_bold" id="S5.T3.123.123.123.13.1">0.0272<sup class="ltx_sup" id="S5.T3.123.123.123.13.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.123.123.123.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.124.124.124.14"><span class="ltx_text ltx_font_bold" id="S5.T3.124.124.124.14.1">0.0471<sup class="ltx_sup" id="S5.T3.124.124.124.14.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.124.124.124.14.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.125.125.125.15"><span class="ltx_text ltx_font_bold" id="S5.T3.125.125.125.15.1">0.0134<sup class="ltx_sup" id="S5.T3.125.125.125.15.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.125.125.125.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.126.126.126.16"><span class="ltx_text ltx_font_bold" id="S5.T3.126.126.126.16.1">0.0184<sup class="ltx_sup" id="S5.T3.126.126.126.16.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.126.126.126.16.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.173.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.173.15.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.2">11.8%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.3">10.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.4">7.40%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.173.15.5">7.81%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.6">12.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.7">14.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.8">13.2%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.173.15.9">12.8%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.10">10.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.11">12.9%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.12">9.68%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.173.15.13">11.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.14">12.4%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.15">9.53%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.16">13.6%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.173.15.17">10.8%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.174.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.158.158.174.16.1">CL4SRec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.2">0.0653</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.3">0.0947</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.4">0.0370</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.174.16.5">0.0441</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.6">0.0381</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.7">0.0559</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.8">0.0215</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.174.16.9">0.0259</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.10">0.0781</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.11">0.1075</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.12">0.0456</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.158.158.174.16.13">0.0530</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.14">0.0322</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.15">0.0535</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.16">0.0159</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.158.158.174.16.17">0.0212</td>
</tr>
<tr class="ltx_tr" id="S5.T3.142.142.142">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.142.142.142.17">DR4SR</th>
<td class="ltx_td ltx_align_center" id="S5.T3.127.127.127.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.127.127.127.1.1">0.0732<sup class="ltx_sup" id="S5.T3.127.127.127.1.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.127.127.127.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.128.128.128.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.128.128.128.2.1">0.1016<sup class="ltx_sup" id="S5.T3.128.128.128.2.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.128.128.128.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.129.129.129.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.129.129.129.3.1">0.0423<sup class="ltx_sup" id="S5.T3.129.129.129.3.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.129.129.129.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.130.130.130.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.130.130.130.4.1">0.0495<sup class="ltx_sup" id="S5.T3.130.130.130.4.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.130.130.130.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.131.131.131.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.131.131.131.5.1">0.0401<sup class="ltx_sup" id="S5.T3.131.131.131.5.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.131.131.131.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.132.132.132.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.132.132.132.6.1">0.0600<sup class="ltx_sup" id="S5.T3.132.132.132.6.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.132.132.132.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.133.133.133.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.133.133.133.7.1">0.0227<sup class="ltx_sup" id="S5.T3.133.133.133.7.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.133.133.133.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.134.134.134.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.134.134.134.8.1">0.0274<sup class="ltx_sup" id="S5.T3.134.134.134.8.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.134.134.134.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.135.135.135.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.135.135.135.9.1">0.0821<sup class="ltx_sup" id="S5.T3.135.135.135.9.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.135.135.135.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.136.136.136.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.136.136.136.10.1">0.1113<sup class="ltx_sup" id="S5.T3.136.136.136.10.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.136.136.136.10.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.137.137.137.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.137.137.137.11.1">0.0481<sup class="ltx_sup" id="S5.T3.137.137.137.11.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.137.137.137.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.138.138.138.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.138.138.138.12.1">0.0551<sup class="ltx_sup" id="S5.T3.138.138.138.12.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.138.138.138.12.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.139.139.139.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.139.139.139.13.1">0.0344<sup class="ltx_sup" id="S5.T3.139.139.139.13.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.139.139.139.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.140.140.140.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.140.140.140.14.1">0.0561<sup class="ltx_sup" id="S5.T3.140.140.140.14.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.140.140.140.14.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.141.141.141.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.141.141.141.15.1">0.0174<sup class="ltx_sup" id="S5.T3.141.141.141.15.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.141.141.141.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.142.142.142.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.142.142.142.16.1">0.0229<sup class="ltx_sup" id="S5.T3.142.142.142.16.1.1"><span class="ltx_text ltx_font_italic" id="S5.T3.142.142.142.16.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.175.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.175.17.1">Improv</th>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.2">12.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.3">7.29%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.4">14.3%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.175.17.5">12.2%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.6">5.25%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.7">7.33%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.8">5.58%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.175.17.9">5.79%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.10">5.12%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.11">3.53%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.12">5.48%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.158.158.175.17.13">3.96%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.14">6.83%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.15">4.86%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.16">9.43%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.175.17.17">8.02%</td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.158">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.158.158.158.17">DR4SR+</th>
<td class="ltx_td ltx_align_center" id="S5.T3.143.143.143.1"><span class="ltx_text ltx_font_bold" id="S5.T3.143.143.143.1.1">00756<sup class="ltx_sup" id="S5.T3.143.143.143.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.143.143.143.1.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.144.144.144.2"><span class="ltx_text ltx_font_bold" id="S5.T3.144.144.144.2.1">0.1062<sup class="ltx_sup" id="S5.T3.144.144.144.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.144.144.144.2.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.145.145.145.3"><span class="ltx_text ltx_font_bold" id="S5.T3.145.145.145.3.1">0.0440<sup class="ltx_sup" id="S5.T3.145.145.145.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.145.145.145.3.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.146.146.146.4"><span class="ltx_text ltx_font_bold" id="S5.T3.146.146.146.4.1">0.0517<sup class="ltx_sup" id="S5.T3.146.146.146.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.146.146.146.4.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.147.147.147.5"><span class="ltx_text ltx_font_bold" id="S5.T3.147.147.147.5.1">0.0448<sup class="ltx_sup" id="S5.T3.147.147.147.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.147.147.147.5.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.148.148.148.6"><span class="ltx_text ltx_font_bold" id="S5.T3.148.148.148.6.1">0.0655<sup class="ltx_sup" id="S5.T3.148.148.148.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.148.148.148.6.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.149.149.149.7"><span class="ltx_text ltx_font_bold" id="S5.T3.149.149.149.7.1">0.0247<sup class="ltx_sup" id="S5.T3.149.149.149.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.149.149.149.7.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.150.150.150.8"><span class="ltx_text ltx_font_bold" id="S5.T3.150.150.150.8.1">0.0299<sup class="ltx_sup" id="S5.T3.150.150.150.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.150.150.150.8.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.151.151.151.9"><span class="ltx_text ltx_font_bold" id="S5.T3.151.151.151.9.1">0.0829<sup class="ltx_sup" id="S5.T3.151.151.151.9.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.151.151.151.9.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.152.152.152.10"><span class="ltx_text ltx_font_bold" id="S5.T3.152.152.152.10.1">0.1140<sup class="ltx_sup" id="S5.T3.152.152.152.10.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.152.152.152.10.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.153.153.153.11"><span class="ltx_text ltx_font_bold" id="S5.T3.153.153.153.11.1">0.0489<sup class="ltx_sup" id="S5.T3.153.153.153.11.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.153.153.153.11.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.154.154.154.12"><span class="ltx_text ltx_font_bold" id="S5.T3.154.154.154.12.1">0.0567<sup class="ltx_sup" id="S5.T3.154.154.154.12.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.154.154.154.12.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.155.155.155.13"><span class="ltx_text ltx_font_bold" id="S5.T3.155.155.155.13.1">0.0363<sup class="ltx_sup" id="S5.T3.155.155.155.13.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.155.155.155.13.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.156.156.156.14"><span class="ltx_text ltx_font_bold" id="S5.T3.156.156.156.14.1">0.0598<sup class="ltx_sup" id="S5.T3.156.156.156.14.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.156.156.156.14.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.157.157.157.15"><span class="ltx_text ltx_font_bold" id="S5.T3.157.157.157.15.1">0.0183<sup class="ltx_sup" id="S5.T3.157.157.157.15.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.157.157.157.15.1.1.1">∗∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.158.158.158.16"><span class="ltx_text ltx_font_bold" id="S5.T3.158.158.158.16.1">0.0241<sup class="ltx_sup" id="S5.T3.158.158.158.16.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S5.T3.158.158.158.16.1.1.1">∗∗</span></sup></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.158.158.176.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T3.158.158.176.18.1">Improv</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.2">15.8%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.3">1.12%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.4">18.9%</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.158.158.176.18.5">17.2%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.6">17.6%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.7">17.2%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.8">14.8%</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.158.158.176.18.9">15.4%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.10">6.15%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.11">6.05%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.12">7.24%</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.158.158.176.18.13">6.98%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.14">12.7%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.15">11.8%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.16">15.1%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.158.158.176.18.17">13.7%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We compared the performance of each target model with ”DR4SR” and ”DR4SR+” variants to verify the efficacy of the proposed framework. The statistics of regenerated datasets can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.T2" title="Table 2 ‣ 5.1.4. Implementation Details ‣ 5.1. Experimental Settings ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> in the Appendix. From the overall performance presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.T3" title="Table 3 ‣ 5.2. Overall Performance ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, we can draw the following conclusions: (1) DR4SR can regenerate an informative and generalizable dataset: Across all datasets and target models, we can observe a considerable performance enhancement when comparing the ”DR4SR” variant with target models. (2) Different target models prefer different datasets: An additional improvement can be observed when comparing the ”DR4SR” variant with the ”DR4SR+” variant. This is because DR4SR is independent of target models, which makes the regenerated dataset sub-optimal. (3) Denoising is just one aspect of the broader training data development problem: We can find that FMLP can yield significant performance improvement when integrated with DR4SR and DR4SR+. This is because dataset regeneration can additionally capture the one-to-many relationship of sequences and patterns. Moreover, dataset regeneration has the potential to discover latent transition patterns with the hybrid inference mode. (4) Data-centric and model-centric paradigms are complementary: The proposed data-centric paradigm has consistently demonstrated benefits across various datasets and target models, emphasizing the complementarity of the data-centric and model-centric paradigms. This underscores the potential for advancing recommender systems from a data-centric perspective.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Ablation Study</h3>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.2.1.1" style="font-size:90%;">Table 4</span>. </span><span class="ltx_text" id="S5.T4.3.2" style="font-size:90%;">Abalation study of DR4SR on NDCG@20.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.4.1.1.1">Dataset</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.1.1.2">Beauty</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.1.1.3">Sport</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.1.1.4">Toys</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.1.1.5">Yelp</td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.4.2.2.1">SASRec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.2.2.2">0.0368</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.2.2.3">0.0194</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.2.2.4">0.0448</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.2.2.5">0.0193</td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T4.4.3.3.1">DR4SR+</th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.3.3.2"><span class="ltx_text ltx_font_bold" id="S5.T4.4.3.3.2.1">0.0412</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.3.3.3"><span class="ltx_text ltx_font_bold" id="S5.T4.4.3.3.3.1">0.0235</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.3.3.4"><span class="ltx_text ltx_font_bold" id="S5.T4.4.3.3.4.1">0.0527</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.3.3.5"><span class="ltx_text ltx_font_bold" id="S5.T4.4.3.3.5.1">0.0211</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.4.4.4.1">(A) -diversity</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.4.4.2">0.0365</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.4.4.3">0.0211</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.4.4.4">0.0470</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.4.4.4.5">0.0196</td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T4.4.5.5.1">(B) pattern</th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.5.5.2">0.0181</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.5.5.3">0.0184</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.5.5.4">0.0407</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.5.5.5">0.0141</td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T4.4.6.6.1">(C) end-to-end</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.4.6.6.2">0.0026</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.4.6.6.3">0.0029</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.4.6.6.4">0.0067</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.4.6.6.5">0.0035</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">In this section, we aim to evaluate the efficacy of each module within DR4SR. An ablation study is conducted using SASRec as the target model. We have designed the following model variants: (A) ”-diversity”: This aims to confirm the significance of capturing the one-to-many relationship by replacing the diversity-promoted regenerator with a vanilla transformer. (B) ”pattern”: This seeks to substantiate the need for a trainable regenerator by employing patterns extracted based on predefined rules as the regenerated dataset. (C) ”end-to-end”: This endeavors to illustrate the importance of bi-level optimization by optimizing the dataset personalizer in an end-to-end fashion. Results are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.T4" title="Table 4 ‣ 5.3. Ablation Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">From the table, we can obtain the following conclusions: (1) Comparing (A) with ”DR4SR+”, we can observe significant performance loss, which demonstrates the necessity of modeling the one-to-many mapping relationship between the original sequences and patterns. (2) Comparing (B) and ”SASRec”, we can observe that using only the pattern dataset leads to a decrease in performance since many valuable infrequent patterns are ignored. Thus highlighting the superiority of the proposed powerful regenerator. (3) Comparing (C) and ”DR4SR+”, we find that the end-to-end learning approach yields poor performance, which is unsurprising as the end-to-end training may readily converge to a trivial solution where the dataset personalizer assigns zero scores to all data samples.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Advanced Study</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">To demonstrate the superiority of the proposed paradigm, we have conducted in-depth analysis experiments from various aspects. The obtained experimental results and analysis are as follows:</p>
</div>
<section class="ltx_subsubsection" id="S5.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.1. </span><span class="ltx_text ltx_font_bold" id="S5.SS4.SSS1.1.1">Analysis of efficiency of dataset personalization</span>
</h4>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T5.2.1.1" style="font-size:90%;">Table 5</span>. </span><span class="ltx_text" id="S5.T5.3.2" style="font-size:90%;">Time and Space Efficiency Analysis.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T5.4" style="width:433.6pt;height:101.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(23.7pt,-5.5pt) scale(1.12300206566762,1.12300206566762) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T5.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.4.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.4.1.1.1.2">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.4.1.1.1.3">Beauty</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.4.1.1.1.4">Sport</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.4.1.1.1.5">Toys</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.4.1.1.1.6">Yelp</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.4.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.4.1.2.1.1" rowspan="2"><span class="ltx_text" id="S5.T5.4.1.2.1.1.1">BASE</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.4.1.2.1.2">Runtime(s/epoch)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.2.1.3">7.618</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.2.1.4">15.345</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.2.1.5">13.370</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.2.1.6">17.738</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.3.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S5.T5.4.1.3.2.1">GPU memory (MB)</th>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.3.2.2">1930</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.3.2.3">2194</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.3.2.4">1968</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.3.2.5">2254</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T5.4.1.4.3.1" rowspan="2"><span class="ltx_text" id="S5.T5.4.1.4.3.1.1">w/ bi-level optimization</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.4.1.4.3.2">Runtime(s/epoch)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.4.3.3">9.476</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.4.3.4">18.952</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.4.3.5">14.213</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.4.3.6">22.41</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.5.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T5.4.1.5.4.1">GPU memory (MB)</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.5.4.2">2342</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.5.4.3">2626</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.5.4.4">2382</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.5.4.5">2688</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS4.SSS1.p1">
<p class="ltx_p" id="S5.SS4.SSS1.p1.1">Bi-level optimization is widely recognized for its inefficiency and high memory consumption<cite class="ltx_cite ltx_citemacro_citep">(Navon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib37" title="">2021</a>)</cite>, which hinders its practical applicability. Consequently, we conducted an efficiency analysis to validate the efficiency of the adopted bi-level optimization process. The experimental results are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.T5" title="Table 5 ‣ 5.4.1. Analysis of efficiency of dataset personalization ‣ 5.4. Advanced Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>. It can be observed from the results that the training of the dataset personalizer using the implicit differentiation method does not incur significant additional time and space overhead. This demonstrates that the regenerated dataset can be efficiently tailored to different target models.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.2. </span><span class="ltx_text ltx_font_bold" id="S5.SS4.SSS2.1.1">Analysis of data sample scores of different target models</span>
</h4>
<div class="ltx_para" id="S5.SS4.SSS2.p1">
<p class="ltx_p" id="S5.SS4.SSS2.p1.1">We randomly selected 25 sequences from the regenerated dataset and visualized the sample scores learned by different target models, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.F4" title="Figure 4 ‣ 5.4.2. Analysis of data sample scores of different target models ‣ 5.4. Advanced Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. The figure reveals noticeable variations in dataset preferences among different models. Notably, GRU4Rec demonstrates a higher degree of score variance compared to other methods, which exhibit more uniform weight assignments. This is because the powerful self-attention mechanism or filter-enhanced MLP can adaptively determine the utilization of items in the sequence to some extent. However, even among these methods, discernible preference differences can still be observed. These observations further validate the crucial role of the dataset personalizer.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="146" id="S5.F4.g1" src="x4.png" width="553"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">Scores assigned by the dataset personalizer for different target models on Toys. From left to right, the variances of the scores for each target model are 0.0280, 0.0244, 0.0241, 0.0248, and 0.0247.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="829" id="S5.F5.sf1.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F5.sf1.3.2" style="font-size:90%;">Different graphs</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="829" id="S5.F5.sf2.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F5.sf2.3.2" style="font-size:90%;">Different augmentations</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.2.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S5.F5.3.2" style="font-size:90%;">Relative NDCG@20 improvement of graphs and data augmentations on different datasets.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.3. </span><span class="ltx_text ltx_font_bold" id="S5.SS4.SSS3.1.1">Analysis of data forms that should be regenerated.</span>
</h4>
<div class="ltx_para" id="S5.SS4.SSS3.p1">
<p class="ltx_p" id="S5.SS4.SSS3.p1.1">After regenerating a dataset, we can construct a new graph for GNN and perform data augmentation based on the new dataset. This naturally raises the question of which dataset should be adopted for graph construction or data augmentation: the original or the regenerated one. To shed light on this matter, we further conducted two experiments. Firstly, we compared the effects of using different graphs, and the results are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.F5.sf1" title="In Figure 5 ‣ 5.4.2. Analysis of data sample scores of different target models ‣ 5.4. Advanced Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5(a)</span></a>. The results are subtle, with the original graph performing better on half of the dataset, while the regenerated graph yields superior results on the other half. Subsequently, we compared the effects of using different augmentation data, and the results are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.F5.sf2" title="In Figure 5 ‣ 5.4.2. Analysis of data sample scores of different target models ‣ 5.4. Advanced Study ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5(b)</span></a>. From the table, we can observe that DR4SR yields superior data augmentation samples for CL4SRec on the first two datasets. This is attributed to the regenerated sequences containing richer semantic information. However, for the last two datasets, we notice that there is no significant improvement.</p>
</div>
<div class="ltx_para" id="S5.SS4.SSS3.p2">
<p class="ltx_p" id="S5.SS4.SSS3.p2.1">Considering these results, we can observe that while DR4SR can provide curated sequence training datasets for diverse target models, certain advanced data formats such as graphs and data used for augmentation still need to be constructed based on the original dataset in certain scenarios. Therefore, we conclude that for the sequential recommendation, the scope of data regeneration can be extended beyond the interaction sequences. For instance, graph structure learning<cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib84" title="">2021</a>)</cite> can be employed to construct a more suitable correlation graph, and leverage learnable data augmentation<cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib15" title="">2023</a>; Zuo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib85" title="">2021</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib65" title="">2023c</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib63" title="">a</a>)</cite> can be utilized for contrastive learning. In this study, we primarily focus on regenerating sequences, and the exploration of regenerating other data forms will be addressed in future work.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>Hyper-parameter Sensitivity</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.2">In this subsection, we investigate the hyper-parameter sensitivity of the proposed paradigm. Specifically, we focus on the impact of two parameters on model performance, the diversity factor <math alttext="K" class="ltx_Math" display="inline" id="S5.SS5.p1.1.m1.1"><semantics id="S5.SS5.p1.1.m1.1a"><mi id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.1b"><ci id="S5.SS5.p1.1.m1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.1.m1.1d">italic_K</annotation></semantics></math> and the generative decoding probability <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS5.p1.2.m2.1"><semantics id="S5.SS5.p1.2.m2.1a"><mi id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.1b"><ci id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.2.m2.1d">italic_γ</annotation></semantics></math>. For the sake of simplicity, we conducted experiments on Toys and Beauty based on SASRec.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.1. </span>The diversity factor K</h4>
<figure class="ltx_figure" id="S5.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="619" id="S5.F6.sf1.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F6.sf1.3.2" style="font-size:90%;">Beauty</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="619" id="S5.F6.sf2.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F6.sf2.3.2" style="font-size:90%;">Toys</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.2.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S5.F6.3.2" style="font-size:90%;">Recommendation Performance w.r.t different K.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS5.SSS1.p1">
<p class="ltx_p" id="S5.SS5.SSS1.p1.1">We set K among <math alttext="[1,3,5,7,9]" class="ltx_Math" display="inline" id="S5.SS5.SSS1.p1.1.m1.5"><semantics id="S5.SS5.SSS1.p1.1.m1.5a"><mrow id="S5.SS5.SSS1.p1.1.m1.5.6.2" xref="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml"><mo id="S5.SS5.SSS1.p1.1.m1.5.6.2.1" stretchy="false" xref="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml">[</mo><mn id="S5.SS5.SSS1.p1.1.m1.1.1" xref="S5.SS5.SSS1.p1.1.m1.1.1.cmml">1</mn><mo id="S5.SS5.SSS1.p1.1.m1.5.6.2.2" xref="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.1.m1.2.2" xref="S5.SS5.SSS1.p1.1.m1.2.2.cmml">3</mn><mo id="S5.SS5.SSS1.p1.1.m1.5.6.2.3" xref="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.1.m1.3.3" xref="S5.SS5.SSS1.p1.1.m1.3.3.cmml">5</mn><mo id="S5.SS5.SSS1.p1.1.m1.5.6.2.4" xref="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.1.m1.4.4" xref="S5.SS5.SSS1.p1.1.m1.4.4.cmml">7</mn><mo id="S5.SS5.SSS1.p1.1.m1.5.6.2.5" xref="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.1.m1.5.5" xref="S5.SS5.SSS1.p1.1.m1.5.5.cmml">9</mn><mo id="S5.SS5.SSS1.p1.1.m1.5.6.2.6" stretchy="false" xref="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.1.m1.5b"><list id="S5.SS5.SSS1.p1.1.m1.5.6.1.cmml" xref="S5.SS5.SSS1.p1.1.m1.5.6.2"><cn id="S5.SS5.SSS1.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS5.SSS1.p1.1.m1.1.1">1</cn><cn id="S5.SS5.SSS1.p1.1.m1.2.2.cmml" type="integer" xref="S5.SS5.SSS1.p1.1.m1.2.2">3</cn><cn id="S5.SS5.SSS1.p1.1.m1.3.3.cmml" type="integer" xref="S5.SS5.SSS1.p1.1.m1.3.3">5</cn><cn id="S5.SS5.SSS1.p1.1.m1.4.4.cmml" type="integer" xref="S5.SS5.SSS1.p1.1.m1.4.4">7</cn><cn id="S5.SS5.SSS1.p1.1.m1.5.5.cmml" type="integer" xref="S5.SS5.SSS1.p1.1.m1.5.5">9</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.1.m1.5c">[1,3,5,7,9]</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS1.p1.1.m1.5d">[ 1 , 3 , 5 , 7 , 9 ]</annotation></semantics></math> and the results are depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.F6" title="Figure 6 ‣ 5.5.1. The diversity factor K ‣ 5.5. Hyper-parameter Sensitivity ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, where the performance exhibits an increasing trend as K increases. This is because by increasing K, we can effectively reduce confusion during training and simultaneously enhance the diversity of the regenerated data. Furthermore, once K exceeded a certain threshold, further increasing did not lead to significant changes. This indicates that the regenerator had already captured all available patterns, reaching a plateau phase.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.2. </span>The generative decoding probability <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS5.SSS2.1.m1.1"><semantics id="S5.SS5.SSS2.1.m1.1b"><mi id="S5.SS5.SSS2.1.m1.1.1" xref="S5.SS5.SSS2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.1.m1.1c"><ci id="S5.SS5.SSS2.1.m1.1.1.cmml" xref="S5.SS5.SSS2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.1.m1.1d">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.1.m1.1e">italic_γ</annotation></semantics></math>
</h4>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="583" id="S5.F7.sf1.g1" src="x9.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F7.sf1.3.2" style="font-size:90%;">Beauty</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="607" id="S5.F7.sf2.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F7.sf2.3.2" style="font-size:90%;">Toys</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.4.2.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S5.F7.2.1" style="font-size:90%;">Recommendation Performance w.r.t different <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.F7.2.1.m1.1"><semantics id="S5.F7.2.1.m1.1b"><mi id="S5.F7.2.1.m1.1.1" xref="S5.F7.2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.F7.2.1.m1.1c"><ci id="S5.F7.2.1.m1.1.1.cmml" xref="S5.F7.2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.1.m1.1d">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.F7.2.1.m1.1e">italic_γ</annotation></semantics></math>.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS5.SSS2.p1">
<p class="ltx_p" id="S5.SS5.SSS2.p1.4">We set the parameter <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS5.SSS2.p1.1.m1.1"><semantics id="S5.SS5.SSS2.p1.1.m1.1a"><mi id="S5.SS5.SSS2.p1.1.m1.1.1" xref="S5.SS5.SSS2.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.1.m1.1b"><ci id="S5.SS5.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS5.SSS2.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.p1.1.m1.1d">italic_γ</annotation></semantics></math> within the range of <math alttext="[0,0.1,0.3,0.5,1]" class="ltx_Math" display="inline" id="S5.SS5.SSS2.p1.2.m2.5"><semantics id="S5.SS5.SSS2.p1.2.m2.5a"><mrow id="S5.SS5.SSS2.p1.2.m2.5.6.2" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml"><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.1" stretchy="false" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">[</mo><mn id="S5.SS5.SSS2.p1.2.m2.1.1" xref="S5.SS5.SSS2.p1.2.m2.1.1.cmml">0</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.2" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.2.2" xref="S5.SS5.SSS2.p1.2.m2.2.2.cmml">0.1</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.3" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.3.3" xref="S5.SS5.SSS2.p1.2.m2.3.3.cmml">0.3</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.4" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.4.4" xref="S5.SS5.SSS2.p1.2.m2.4.4.cmml">0.5</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.5" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.5.5" xref="S5.SS5.SSS2.p1.2.m2.5.5.cmml">1</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.6" stretchy="false" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.2.m2.5b"><list id="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml" xref="S5.SS5.SSS2.p1.2.m2.5.6.2"><cn id="S5.SS5.SSS2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS5.SSS2.p1.2.m2.1.1">0</cn><cn id="S5.SS5.SSS2.p1.2.m2.2.2.cmml" type="float" xref="S5.SS5.SSS2.p1.2.m2.2.2">0.1</cn><cn id="S5.SS5.SSS2.p1.2.m2.3.3.cmml" type="float" xref="S5.SS5.SSS2.p1.2.m2.3.3">0.3</cn><cn id="S5.SS5.SSS2.p1.2.m2.4.4.cmml" type="float" xref="S5.SS5.SSS2.p1.2.m2.4.4">0.5</cn><cn id="S5.SS5.SSS2.p1.2.m2.5.5.cmml" type="integer" xref="S5.SS5.SSS2.p1.2.m2.5.5">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.2.m2.5c">[0,0.1,0.3,0.5,1]</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.p1.2.m2.5d">[ 0 , 0.1 , 0.3 , 0.5 , 1 ]</annotation></semantics></math> and visualized the results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S5.F7" title="Figure 7 ‣ 5.5.2. The generative decoding probability 𝛾 ‣ 5.5. Hyper-parameter Sensitivity ‣ 5. EXPERIMENTAL EVALUATION ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>. The performance initially shows an increasing trend followed by a decrease. This observation highlights the importance of striking a balance between exploration and exploitation during the regeneration process. When <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS5.SSS2.p1.3.m3.1"><semantics id="S5.SS5.SSS2.p1.3.m3.1a"><mi id="S5.SS5.SSS2.p1.3.m3.1.1" xref="S5.SS5.SSS2.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.3.m3.1b"><ci id="S5.SS5.SSS2.p1.3.m3.1.1.cmml" xref="S5.SS5.SSS2.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.p1.3.m3.1d">italic_γ</annotation></semantics></math> is too low, the regenerator is unable to sufficiently explore higher-order information. Conversely, when <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS5.SSS2.p1.4.m4.1"><semantics id="S5.SS5.SSS2.p1.4.m4.1a"><mi id="S5.SS5.SSS2.p1.4.m4.1.1" xref="S5.SS5.SSS2.p1.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.4.m4.1b"><ci id="S5.SS5.SSS2.p1.4.m4.1.1.cmml" xref="S5.SS5.SSS2.p1.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.p1.4.m4.1d">italic_γ</annotation></semantics></math> is set too high, the model underutilizes the existing information, leading to a decrease in the reliability of the generated results.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>CONCLUSIONS</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we have investigated a novel problem concerning the development of training data for sequential recommendations. To tackle this problem, we have introduced a data-centric dataset regeneration framework called DR4SR. Our framework has displayed exceptional cross-architecture generalizability and has underscored the complementary relationship between data-centric and model-centric paradigms. Moreover, we have extended DR4SR to a model-aware version, dubbed DR4SR+, which allows for personalized adaptation of the regenerated datasets to various target models. Additionally, we have conducted in-depth analysis to investigate the potential of the data-centric approach, providing valuable insights. For our future work, we intend to propose a more comprehensive framework that can regenerate various forms of data, such as sequences, graphs, and augmented data. We also plan to explore the integration of large language Models <cite class="ltx_cite ltx_citemacro_citep">(Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib18" title="">2024</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib11" title="">2023</a>)</cite> to guide the dataset regeneration process, enabling the generation of data that maintains both collaborative and semantic information.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bauer et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
André Bauer, Simon Trapp, Michael Stenger, Robert Leppich, Samuel Kounev, Mark Leznik, Kyle Chard, and Ian T. Foster. 2024.

</span>
<span class="ltx_bibblock">Comprehensive Exploration of Synthetic Data Generation: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">CoRR</em> abs/2401.02524 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hong Chen, Xin Wang, Ruobing Xie, Yuwei Zhou, and Wenwu Zhu. 2023.

</span>
<span class="ltx_bibblock">Cross-domain Recommendation with Behavioral Importance Perception. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the ACM Web Conference 2023, WWW 2023, Austin, TX, USA, 30 April 2023 - 4 May 2023</em>. 1294–1304.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yongjun Chen, Zhiwei Liu, Jia Li, Julian J. McAuley, and Caiming Xiong. 2022.

</span>
<span class="ltx_bibblock">Intent Contrastive Learning for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">WWW ’22: The ACM Web Conference 2022, Virtual Event, Lyon, France, April 25 - 29, 2022</em>. ACM, 2172–2182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Wenqi Fan, Xiaorui Liu, Wei Jin, Xiangyu Zhao, Jiliang Tang, and Qing Li. 2022.

</span>
<span class="ltx_bibblock">Graph Trend Filtering Networks for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">SIGIR ’22: The 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, Madrid, Spain, July 11 - 15, 2022</em>. 112–121.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Ian J. Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron C. Courville, and Yoshua Bengio. 2014.

</span>
<span class="ltx_bibblock">Generative Adversarial Networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">CoRR</em> abs/1406.2661 (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ziyao Guo, Kai Wang, George Cazenavette, Hui Li, Kaipeng Zhang, and Yang You. 2023.

</span>
<span class="ltx_bibblock">Towards Lossless Dataset Distillation via Difficulty-Aligned Trajectory Matching.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">CoRR</em> abs/2310.05773 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yongqiang Han, Hao Wang, Kefan Wang, Likang Wu, Zhi Li, Wei Guo, Yong Liu, Defu Lian, and Enhong Chen. 2024.

</span>
<span class="ltx_bibblock">END4Rec: Efficient Noise-Decoupling for Multi-Behavior Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">CoRR</em> abs/2403.17603 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yongqiang Han, Likang Wu, Hao Wang, Guifeng Wang, Mengdi Zhang, Zhi Li, Defu Lian, and Enhong Chen. 2023.

</span>
<span class="ltx_bibblock">Guesr: A global unsupervised data-enhancement with bucket-cluster sampling for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">International Conference on Database Systems for Advanced Applications</em>. Springer, 286–296.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, Yong-Dong Zhang, and Meng Wang. 2020.

</span>
<span class="ltx_bibblock">LightGCN: Simplifying and Powering Graph Convolution Network for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval, SIGIR 2020, Virtual Event, China, July 25-30, 2020</em>. 639–648.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhicheng He, Weiwen Liu, Wei Guo, Jiarui Qin, Yingxue Zhang, Yaochen Hu, and Ruiming Tang. 2023.

</span>
<span class="ltx_bibblock">A survey on user behavior modeling in recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">arXiv preprint arXiv:2302.11087</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2016.

</span>
<span class="ltx_bibblock">Session-based Recommendations with Recurrent Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">4th International Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016, Conference Track Proceedings</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel. 2020.

</span>
<span class="ltx_bibblock">Denoising Diffusion Probabilistic Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jonathan Ho, Chitwan Saharia, William Chan, David J. Fleet, Mohammad Norouzi, and Tim Salimans. 2022.

</span>
<span class="ltx_bibblock">Cascaded Diffusion Models for High Fidelity Image Generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">J. Mach. Learn. Res.</em> 23 (2022), 47:1–47:33.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Chengkai Hou, Jieyu Zhang, and Tianyi Zhou. 2023.

</span>
<span class="ltx_bibblock">When to Learn What: Model-Adaptive Data Augmentation Curriculum. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">IEEE/CVF International Conference on Computer Vision, ICCV 2023, Paris, France, October 1-6, 2023</em>. 1717–1728.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yupeng Hou, Shanlei Mu, Wayne Xin Zhao, Yaliang Li, Bolin Ding, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Towards Universal Sequence Representation Learning for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">KDD ’22: The 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Washington, DC, USA, August 14 - 18, 2022</em>. ACM, 585–593.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Wei-Ning Hsu, Yu Zhang, and James R. Glass. 2017.

</span>
<span class="ltx_bibblock">Unsupervised domain adaptation for robust speech recognition via variational autoencoder-based data augmentation. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">2017 IEEE Automatic Speech Recognition and Understanding Workshop, ASRU 2017, Okinawa, Japan, December 16-20, 2017</em>. 16–23.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xu Huang, Weiwen Liu, Xiaolong Chen, Xingmei Wang, Hao Wang, Defu Lian, Yasheng Wang, Ruiming Tang, and Enhong Chen. 2024.

</span>
<span class="ltx_bibblock">Understanding the planning of LLM agents: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">arXiv preprint arXiv:2402.02716</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jang et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Eric Jang, Shixiang Gu, and Ben Poole. 2017.

</span>
<span class="ltx_bibblock">Categorical Reparameterization with Gumbel-Softmax. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">5th International Conference on Learning Representations, ICLR 2017, Toulon, France, April 24-26, 2017, Conference Track Proceedings</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Wei Jin, Yao Ma, Xiaorui Liu, Xianfeng Tang, Suhang Wang, and Jiliang Tang. 2020.

</span>
<span class="ltx_bibblock">Graph Structure Learning for Robust Graph Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">KDD ’20: The 26th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Virtual Event, CA, USA, August 23-27, 2020</em>. 66–74.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian J. McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-Attentive Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">IEEE International Conference on Data Mining, ICDM 2018, Singapore, November 17-20, 2018</em>. IEEE Computer Society, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Kibum Kim, Dongmin Hyun, Sukwon Yun, and Chanyoung Park. 2023.

</span>
<span class="ltx_bibblock">MELT: Mutual Enhancement of Long-Tailed User and Item for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">SIGIR</em>. ACM, 68–77.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba. 2015.

</span>
<span class="ltx_bibblock">Adam: A Method for Stochastic Optimization. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">3rd International Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track Proceedings</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Welling (2014)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Max Welling. 2014.

</span>
<span class="ltx_bibblock">Auto-Encoding Variational Bayes. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">2nd International Conference on Learning Representations, ICLR 2014, Banff, AB, Canada, April 14-16, 2014, Conference Track Proceedings</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krichene and Rendle (2021)</span>
<span class="ltx_bibblock">
Walid Krichene and Steffen Rendle. 2021.

</span>
<span class="ltx_bibblock">On Sampled Metrics for Item Recommendation (Extended Abstract). In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence, IJCAI 2021, Virtual Event / Montreal, Canada, 19-27 August 2021</em>. 4784–4788.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lai et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Riwei Lai, Li Chen, Rui Chen, and Chi Zhang. 2024.

</span>
<span class="ltx_bibblock">A Survey on Data-Centric Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">arXiv preprint arXiv:2401.17878</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Jing Li, Pengjie Ren, Zhumin Chen, Zhaochun Ren, Tao Lian, and Jun Ma. 2017.

</span>
<span class="ltx_bibblock">Neural Attentive Session-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the 2017 ACM on Conference on Information and Knowledge Management, CIKM 2017, Singapore, November 06 - 10, 2017</em>. 1419–1428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jiacheng Li, Ming Wang, Jin Li, Jinmiao Fu, Xin Shen, Jingbo Shang, and Julian J. McAuley. 2023.

</span>
<span class="ltx_bibblock">Text Is All You Need: Learning Language Representations for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, KDD 2023, Long Beach, CA, USA, August 6-10, 2023</em>. ACM, 1258–1267.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Defu Lian, Xu Huang, Xiaolong Chen, Jin Chen, Xingmei Wang, Yankai Wang, Haoran Jin, Rui Fan, Zheng Liu, Le Wu, and Enhong Chen. 2023.

</span>
<span class="ltx_bibblock">RecStudio: Towards a Highly-Modularized Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">SIGIR</em>. ACM, 2890–2900.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Weilin Lin, Xiangyu Zhao, Yejing Wang, Yuanshao Zhu, and Wanyu Wang. 2023.

</span>
<span class="ltx_bibblock">AutoDenoise: Automatic Data Instance Denoising for Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">WWW</em>. ACM, 1003–1011.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Chong Liu, Xiaoyang Liu, Rongqin Zheng, Lixin Zhang, Xiaobo Liang, Juntao Li, Lijun Wu, Min Zhang, and Leyu Lin. 2023b.

</span>
<span class="ltx_bibblock">CT4Rec: Simple yet Effective Consistency Training for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">KDD</em>. ACM, 3901–3913.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Fan Liu, Zhiyong Cheng, Huilin Chen, Yinwei Wei, Liqiang Nie, and Mohan S. Kankanhalli. 2022a.

</span>
<span class="ltx_bibblock">Privacy-Preserving Synthetic Data Generation for Recommendation Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">SIGIR ’22: The 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, Madrid, Spain, July 11 - 15, 2022</em>. 1379–1389.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Weiwen Liu, Wei Guo, Yong Liu, Ruiming Tang, and Hao Wang. 2023a.

</span>
<span class="ltx_bibblock">User Behavior Modeling with Deep Learning for Recommendation: Recent Advances. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>. 1286–1287.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Yixin Liu, Yu Zheng, Daokun Zhang, Hongxu Chen, Hao Peng, and Shirui Pan. 2022b.

</span>
<span class="ltx_bibblock">Towards Unsupervised Deep Graph Structure Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">WWW ’22: The ACM Web Conference 2022, Virtual Event, Lyon, France, April 25 - 29, 2022</em>. 1392–1403.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhiwei Liu, Ziwei Fan, Yu Wang, and Philip S. Yu. 2021.

</span>
<span class="ltx_bibblock">Augmenting Sequential Recommendation with Pseudo-Prior Items via Reversely Pre-training Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">SIGIR ’21: The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, Virtual Event, Canada, July 11-15, 2021</em>. 1608–1612.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lorraine et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jonathan Lorraine, Paul Vicol, and David Duvenaud. 2020.

</span>
<span class="ltx_bibblock">Optimizing Millions of Hyperparameters by Implicit Differentiation. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">The 23rd International Conference on Artificial Intelligence and Statistics, AISTATS 2020, 26-28 August 2020, Online [Palermo, Sicily, Italy]</em>. 1540–1552.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Navon et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Aviv Navon, Idan Achituve, Haggai Maron, Gal Chechik, and Ethan Fetaya. 2021.

</span>
<span class="ltx_bibblock">Auxiliary Learning by Implicit Differentiation. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrov and Macdonald (2022)</span>
<span class="ltx_bibblock">
Aleksandr V. Petrov and Craig Macdonald. 2022.

</span>
<span class="ltx_bibblock">Effective and Efficient Training for Sequential Recommendation using Recency Sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">RecSys</em>. ACM, 81–91.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yuqi Qin, Pengfei Wang, and Chenliang Li. 2021.

</span>
<span class="ltx_bibblock">The World is Binary: Contrastive Learning for Denoising Next Basket Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">SIGIR ’21: The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, Virtual Event, Canada, July 11-15, 2021</em>. 859–868.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ruihong Qiu, Zi Huang, Hongzhi Yin, and Zijian Wang. 2022.

</span>
<span class="ltx_bibblock">Contrastive Learning for Representation Degeneration Problem in Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">WSDM ’22: The Fifteenth ACM International Conference on Web Search and Data Mining, Virtual Event / Tempe, AZ, USA, February 21 - 25, 2022</em>. ACM, 813–823.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sachdeva et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Noveen Sachdeva, Mehak Preet Dhaliwal, Carole-Jean Wu, and Julian J. McAuley. 2022.

</span>
<span class="ltx_bibblock">Infinite Recommendation Networks: A Data-Centric Approach. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Advances in Neural Information Processing Systems 35: Annual Conference on Neural Information Processing Systems 2022, NeurIPS 2022, New Orleans, LA, USA, November 28 - December 9, 2022</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sachdeva et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Noveen Sachdeva, Zexue He, Wang-Cheng Kang, Jianmo Ni, Derek Zhiyuan Cheng, and Julian J. McAuley. 2023.

</span>
<span class="ltx_bibblock">Farzi Data: Autoregressive Data Distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">CoRR</em> abs/2310.09983 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential Recommendation with Bidirectional Encoder Representations from Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management, CIKM 2019, Beijing, China, November 3-7, 2019</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized Top-N Sequential Recommendation via Convolutional Sequence Embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the Eleventh ACM International Conference on Web Search and Data Mining, WSDM 2018, Marina Del Rey, CA, USA, February 5-9, 2018</em>. ACM, 565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tong et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiaohai Tong, Pengfei Wang, Chenliang Li, Long Xia, and Shaozhang Niu. 2021.

</span>
<span class="ltx_bibblock">Pattern-enhanced Contrastive Policy Learning Network for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence, IJCAI 2021, Virtual Event / Montreal, Canada, 19-27 August 2021</em>. 1593–1599.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is All you Need. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017, December 4-9, 2017, Long Beach, CA, USA</em>. 5998–6008.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Cheng Wang, Jiacheng Sun, Zhenhua Dong, Ruixuan Li, and Rui Zhang. 2023.

</span>
<span class="ltx_bibblock">Gradient Matching for Categorical Data Distillation in CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proceedings of the 17th ACM Conference on Recommender Systems, RecSys 2023, Singapore, Singapore, September 18-22, 2023</em>. 161–170.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Hao Wang, Defu Lian, Hanghang Tong, Qi Liu, Zhenya Huang, and Enhong Chen. 2022b.

</span>
<span class="ltx_bibblock">HyperSoRec: Exploiting Hyperbolic User and Item Representations with Multiple Aspects for Social-aware Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">ACM Trans. Inf. Syst.</em> 40, 2 (2022), 24:1–24:28.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Hao Wang, Tong Xu, Qi Liu, Defu Lian, Enhong Chen, Dongfang Du, Han Wu, and Wen Su. 2019b.

</span>
<span class="ltx_bibblock">MCNE: An End-to-End Framework for Learning Multiple Conditional Network Representations of Social Network. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">KDD</em>. ACM, 1064–1072.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Shoujin Wang, Liang Hu, Yan Wang, Longbing Cao, Quan Z. Sheng, and Mehmet A. Orgun. 2019a.

</span>
<span class="ltx_bibblock">Sequential Recommender Systems: Challenges, Progress and Prospects. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">Proceedings of the Twenty-Eighth International Joint Conference on Artificial Intelligence, IJCAI 2019, Macao, China, August 10-16, 2019</em>. 6332–6338.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2022c)</span>
<span class="ltx_bibblock">
Shoujin Wang, Qi Zhang, Liang Hu, Xiuzhen Zhang, Yan Wang, and Charu Aggarwal. 2022c.

</span>
<span class="ltx_bibblock">Sequential/Session-based Recommendations: Challenges, Approaches, Applications and Opportunities. In <em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">SIGIR ’22: The 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, Madrid, Spain, July 11 - 15, 2022</em>. ACM, 3425–3428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Tongzhou Wang, Jun-Yan Zhu, Antonio Torralba, and Alexei A. Efros. 2018.

</span>
<span class="ltx_bibblock">Dataset Distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">CoRR</em> abs/1811.10959 (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Xin Wang, Amin Hosseininasab, Pablo Colunga, Serdar Kadıoğlu, and Willem-Jan van Hoeve. 2022a.

</span>
<span class="ltx_bibblock">Seq2Pat: Sequence-to-pattern generation for constraint-based sequential pattern mining. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 36. 12665–12671.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ziyang Wang, Wei Wei, Gao Cong, Xiao-Li Li, Xianling Mao, and Minghui Qiu. 2020.

</span>
<span class="ltx_bibblock">Global Context Enhanced Graph Neural Networks for Session-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval, SIGIR 2020, Virtual Event, China, July 25-30, 2020</em>. 169–178.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Jiahao Wu, Wenqi Fan, Shengcai Liu, Qijiong Liu, Rui He, Qing Li, and Ke Tang. 2023a.

</span>
<span class="ltx_bibblock">Dataset Condensation for Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">CoRR</em> abs/2310.01038 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Jiahao Wu, Qijiong Liu, Hengchang Hu, Wenqi Fan, Shengcai Liu, Qing Li, Xiao-Ming Wu, and Ke Tang. 2023b.

</span>
<span class="ltx_bibblock">Leveraging Large Language Models (LLMs) to Empower Training-Free Dataset Condensation for Content-Based Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">CoRR</em> abs/2310.09874 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib57.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Likang Wu, Zhi Zheng, Zhaopeng Qiu, Hao Wang, Hongchao Gu, Tingjia Shen, Chuan Qin, Chen Zhu, Hengshu Zhu, Qi Liu, Hui Xiong, and Enhong Chen. 2023c.

</span>
<span class="ltx_bibblock">A Survey on Large Language Models for Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.3.1">CoRR</em> abs/2305.19860 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib58.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Shu Wu, Yuyuan Tang, Yanqiao Zhu, Liang Wang, Xing Xie, and Tieniu Tan. 2018.

</span>
<span class="ltx_bibblock">Session-based Recommendation with Graph Neural Networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.3.1">CoRR</em> abs/1811.00855 (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Heming Xia, Zhe Yang, Qingxiu Dong, Peiyi Wang, Yongqi Li, Tao Ge, Tianyu Liu, Wenjie Li, and Zhifang Sui. 2024.

</span>
<span class="ltx_bibblock">Unlocking Efficiency in Large Language Model Inference: A Comprehensive Survey of Speculative Decoding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">CoRR</em> abs/2401.07851 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib60.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xu Xie, Fei Sun, Zhaoyang Liu, Shiwen Wu, Jinyang Gao, Jiandong Zhang, Bolin Ding, and Bin Cui. 2022.

</span>
<span class="ltx_bibblock">Contrastive Learning for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib60.3.1">38th IEEE International Conference on Data Engineering, ICDE 2022, Kuala Lumpur, Malaysia, May 9-12, 2022</em>. IEEE, 1259–1273.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib61.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chengfeng Xu, Pengpeng Zhao, Yanchi Liu, Victor S. Sheng, Jiajie Xu, Fuzhen Zhuang, Junhua Fang, and Xiaofang Zhou. 2019.

</span>
<span class="ltx_bibblock">Graph Contextualized Self-Attention Network for Session-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib61.3.1">Proceedings of the Twenty-Eighth International Joint Conference on Artificial Intelligence, IJCAI 2019, Macao, China, August 10-16, 2019</em>. 3940–3946.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib62.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
An Yan, Shuo Cheng, Wang-Cheng Kang, Mengting Wan, and Julian J. McAuley. 2019.

</span>
<span class="ltx_bibblock">CosRec: 2D Convolutional Neural Networks for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib62.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management, CIKM 2019, Beijing, China, November 3-7, 2019</em>. 2173–2176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib63.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xihong Yang, Jin Jiaqi, Siwei Wang, Ke Liang, Yue Liu, Yi Wen, Suyuan Liu, Sihang Zhou, Xinwang Liu, and En Zhu. 2023a.

</span>
<span class="ltx_bibblock">Dealmvc: Dual contrastive calibration for multi-view clustering. In <em class="ltx_emph ltx_font_italic" id="bib.bib63.3.1">Proceedings of the 31st ACM International Conference on Multimedia</em>. 337–346.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib64.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Xihong Yang, Yue Liu, Sihang Zhou, Siwei Wang, Wenxuan Tu, Qun Zheng, Xinwang Liu, Liming Fang, and En Zhu. 2023b.

</span>
<span class="ltx_bibblock">Cluster-guided Contrastive Graph Clustering Network. In <em class="ltx_emph ltx_font_italic" id="bib.bib64.3.1">Proceedings of the AAAI conference on artificial intelligence</em>, Vol. 37. 10834–10842.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib65.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Xihong Yang, Cheng Tan, Yue Liu, Ke Liang, Siwei Wang, Sihang Zhou, Jun Xia, Stan Z Li, Xinwang Liu, and En Zhu. 2023c.

</span>
<span class="ltx_bibblock">Convert: Contrastive graph clustering with reliable augmentation. In <em class="ltx_emph ltx_font_italic" id="bib.bib65.3.1">Proceedings of the 31st ACM International Conference on Multimedia</em>. 319–327.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yap et al<span class="ltx_text" id="bib.bib66.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Ghim-Eng Yap, Xiaoli Li, and Philip S. Yu. 2012.

</span>
<span class="ltx_bibblock">Effective Next-Items Recommendation via Personalized Sequential Pattern Mining. In <em class="ltx_emph ltx_font_italic" id="bib.bib66.3.1">Database Systems for Advanced Applications - 17th International Conference, DASFAA 2012, Busan, South Korea, April 15-19, 2012, Proceedings, Part II</em>. 48–64.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al<span class="ltx_text" id="bib.bib67.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Mingjia Yin, Hao Wang, Wei Guo, Yong Liu, Zhi Li, Sirui Zhao, Defu Lian, and Enhong Chen. 2024.

</span>
<span class="ltx_bibblock">Learning Partially Aligned Item Representation for Cross-Domain Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib67.3.1">arXiv preprint arXiv:2405.12473</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al<span class="ltx_text" id="bib.bib68.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Mingjia Yin, Hao Wang, Xiang Xu, Likang Wu, Sirui Zhao, Wei Guo, Yong Liu, Ruiming Tang, Defu Lian, and Enhong Chen. 2023.

</span>
<span class="ltx_bibblock">APGL4SR: A Generic Framework with Adaptive and Personalized Global Collaborative Information in Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib68.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management, CIKM 2023, Birmingham, United Kingdom, October 21-25, 2023</em>. ACM, 3009–3019.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib69.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Junliang Yu, Hongzhi Yin, Xin Xia, Tong Chen, Jundong Li, and Zi Huang. 2024b.

</span>
<span class="ltx_bibblock">Self-Supervised Learning for Recommender Systems: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib69.3.1">IEEE Trans. Knowl. Data Eng.</em> 36, 1 (2024), 335–355.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib70.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Ruonan Yu, Songhua Liu, and Xinchao Wang. 2024a.

</span>
<span class="ltx_bibblock">Dataset Distillation: A Comprehensive Review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib70.3.1">IEEE Trans. Pattern Anal. Mach. Intell.</em> 46, 1 (2024), 150–170.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al<span class="ltx_text" id="bib.bib71.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jiahao Yuan, Zihan Song, Mingyou Sun, Xiaoling Wang, and Wayne Xin Zhao. 2021.

</span>
<span class="ltx_bibblock">Dual Sparse Attention Network For Session-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib71.3.1">Thirty-Fifth AAAI Conference on Artificial Intelligence, AAAI 2021, Thirty-Third Conference on Innovative Applications of Artificial Intelligence, IAAI 2021, The Eleventh Symposium on Educational Advances in Artificial Intelligence, EAAI 2021, Virtual Event, February 2-9, 2021</em>. 4635–4643.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zha et al<span class="ltx_text" id="bib.bib72.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Daochen Zha, Zaid Pervaiz Bhat, Kwei-Herng Lai, Fan Yang, Zhimeng Jiang, Shaochen Zhong, and Xia Hu. 2023.

</span>
<span class="ltx_bibblock">Data-centric Artificial Intelligence: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib72.3.1">CoRR</em> abs/2303.10158 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib73.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
An Zhang, Wenchang Ma, Jingnan Zheng, Xiang Wang, and Tat-Seng Chua. 2023b.

</span>
<span class="ltx_bibblock">Robust Collaborative Filtering to Popularity Distribution Shift.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib73.3.1">CoRR</em> abs/2310.10696 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib74.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Chi Zhang, Rui Chen, Xiangyu Zhao, Qilong Han, and Li Li. 2023a.

</span>
<span class="ltx_bibblock">Denoising and Prompt-Tuning for Multi-Behavior Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib74.3.1">Proceedings of the ACM Web Conference 2023, WWW 2023, Austin, TX, USA, 30 April 2023 - 4 May 2023</em>. 1355–1363.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib75.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Luankang Zhang, Hao Wang, Suojuan Zhang, Mingjia Yin, Yongqiang Han, Jiaqing Zhang, Defu Lian, and Enhong Chen. 2024.

</span>
<span class="ltx_bibblock">A Unified Framework for Adaptive Representation Enhancement and Inversed Learning in Cross-Domain Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib75.3.1">arXiv preprint arXiv:2404.00268</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib76.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yuren Zhang, Enhong Chen, Binbin Jin, Hao Wang, Min Hou, Wei Huang, and Runlong Yu. 2022.

</span>
<span class="ltx_bibblock">Clustering based behavior sampling with long sequential data for CTR prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib76.3.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 2195–2200.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao and Bilen (2023)</span>
<span class="ltx_bibblock">
Bo Zhao and Hakan Bilen. 2023.

</span>
<span class="ltx_bibblock">Dataset Condensation with Distribution Matching. In <em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">IEEE/CVF Winter Conference on Applications of Computer Vision, WACV 2023, Waikoloa, HI, USA, January 2-7, 2023</em>. 6503–6512.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib78.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Bo Zhao, Konda Reddy Mopuri, and Hakan Bilen. 2021a.

</span>
<span class="ltx_bibblock">Dataset Condensation with Gradient Matching. In <em class="ltx_emph ltx_font_italic" id="bib.bib78.3.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib79.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Bo Zhao, Konda Reddy Mopuri, and Hakan Bilen. 2021b.

</span>
<span class="ltx_bibblock">Dataset Condensation with Gradient Matching. In <em class="ltx_emph ltx_font_italic" id="bib.bib79.3.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib80.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xin Zheng, Yixin Liu, Zhifeng Bao, Meng Fang, Xia Hu, Alan Wee-Chung Liew, and Shirui Pan. 2023.

</span>
<span class="ltx_bibblock">Towards Data-centric Graph Machine Learning: Review and Outlook.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib80.3.1">CoRR</em> abs/2309.10979 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib81.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Daquan Zhou, Kai Wang, Jianyang Gu, Xiangyu Peng, Dongze Lian, Yifan Zhang, Yang You, and Jiashi Feng. 2023.

</span>
<span class="ltx_bibblock">Dataset Quantization. In <em class="ltx_emph ltx_font_italic" id="bib.bib81.3.1">IEEE/CVF International Conference on Computer Vision, ICCV 2023, Paris, France, October 1-6, 2023</em>. 17159–17170.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib82.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Wang, Wayne Xin Zhao, Yutao Zhu, Sirui Wang, Fuzheng Zhang, Zhongyuan Wang, and Ji-Rong Wen. 2020.

</span>
<span class="ltx_bibblock">S3-rec: Self-supervised learning for sequential recommendation with mutual information maximization. In <em class="ltx_emph ltx_font_italic" id="bib.bib82.3.1">Proceedings of the 29th ACM international conference on information &amp; knowledge management</em>. 1893–1902.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib83.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Yu, Wayne Xin Zhao, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Filter-enhanced MLP is All You Need for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib83.3.1">WWW ’22: The ACM Web Conference 2022, Virtual Event, Lyon, France, April 25 - 29, 2022</em>. 2388–2399.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib84.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yanqiao Zhu, Weizhi Xu, Jinghao Zhang, Qiang Liu, Shu Wu, and Liang Wang. 2021.

</span>
<span class="ltx_bibblock">Deep Graph Structure Learning for Robust Representations: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib84.3.1">CoRR</em> abs/2103.03036 (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zuo et al<span class="ltx_text" id="bib.bib85.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xinyu Zuo, Pengfei Cao, Yubo Chen, Kang Liu, Jun Zhao, Weihua Peng, and Yuguang Chen. 2021.

</span>
<span class="ltx_bibblock">LearnDA: Learnable knowledge-guided data augmentation for event causality identification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib85.3.1">arXiv preprint arXiv:2106.01649</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>APPENDIX</h2>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T6.2.1.1" style="font-size:90%;">Table 6</span>. </span><span class="ltx_text" id="A1.T6.3.2" style="font-size:90%;">The overall performance on two additional datasets.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="A1.T6.4" style="width:433.6pt;height:47.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-190.4pt,21.0pt) scale(0.53241133225586,0.53241133225586) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T6.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.4.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.4.1.1.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.4.1.1.1.2">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.3">GRU4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.4">DR4SR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.4.1.1.1.5">DR4SR+</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.6">SASRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.7">DR4SR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.4.1.1.1.8">DR4SR+</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.9">FMLP</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.10">DR4SR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.4.1.1.1.11">DR4SR+</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.12">GNN</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.13">DR4SR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T6.4.1.1.1.14">DR4SR+</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.15">CL4SRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.16">DR4SR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.1.1.1.17">DR4SR+</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.4.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.1">Gowalla</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.2">R@20</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.3">0.1297</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.2.1.4.1">0.1325</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.5"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.2.1.5.1">0.1392</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.6">0.1672</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.2.1.7.1">0.1786</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.8"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.2.1.8.1">0.1856</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.9">0.1710</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.2.1.10.1">0.1811</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.11"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.2.1.11.1">0.1833</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.12">0.1274</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.2.1.13.1">0.1331</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.2.1.14"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.2.1.14.1">0.1348</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.15">0.2012</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.2.1.16.1">0.2064</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.2.1.17"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.2.1.17.1">0.2095</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.4.1.3.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A1.T6.4.1.3.2.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.4.1.3.2.2">N@20</th>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.3">0.0582</td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.3.2.4.1">0.0615</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T6.4.1.3.2.5"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.3.2.5.1">0.0634</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.6">0.0833</td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.3.2.7.1">0.0912</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T6.4.1.3.2.8"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.3.2.8.1">0.0934</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.9">0.0851</td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.3.2.10.1">0.0903</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T6.4.1.3.2.11"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.3.2.11.1">0.0922</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.12">0.0627</td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.3.2.13.1">0.0653</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T6.4.1.3.2.14"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.3.2.14.1">0.0662</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.15">0.0987</td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.3.2.16.1">0.1032</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.4.1.3.2.17"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.3.2.17.1">0.1048</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.4.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.1">Book</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.2">R@20</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.3">0.0223</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.4.3.4.1">0.0238</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.5"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.4.3.5.1">0.0245</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.6">0.0308</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.4.3.7.1">0.0343</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.8"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.4.3.8.1">0.0372</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.9">0.0388</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.4.3.10.1">0.0432</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.11"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.4.3.11.1">0.0444</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.12">0.0301</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.4.3.13.1">0.0332</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.4.1.4.3.14"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.4.3.14.1">0.0346</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.15">0.0367</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.4.3.16.1">0.0378</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.4.1.4.3.17"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.4.3.17.1">0.0386</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.4.1.5.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T6.4.1.5.4.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T6.4.1.5.4.2">N@20</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.3">0.0087</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.5.4.4.1">0.0098</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T6.4.1.5.4.5"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.5.4.5.1">0.0112</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.6">0.0125</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.5.4.7.1">0.0140</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T6.4.1.5.4.8"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.5.4.8.1">0.0154</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.9">0.0162</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.5.4.10.1">0.0181</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T6.4.1.5.4.11"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.5.4.11.1">0.0188</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.12">0.0129</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.5.4.13.1">0.0141</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T6.4.1.5.4.14"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.5.4.14.1">0.0148</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.15">0.0153</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.4.1.5.4.16.1">0.0161</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T6.4.1.5.4.17"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.5.4.17.1">0.0165</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1. </span>Pseudo Code of DR4SR and DR4SR+</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">The pipeline of DR4SR is detailed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#alg1" title="Algorithm 1 ‣ A.1. Pseudo Code of DR4SR and DR4SR+ ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, and the pipeline of DR4SR+ is detailed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#alg2" title="Algorithm 2 ‣ A.1. Pseudo Code of DR4SR and DR4SR+ ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Pseudo code of DR4SR</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>The original sequence dataset <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">caligraphic_X</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>A regenerated dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝒳</mi><mo id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝒳</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and scores for each data sample <math alttext="\mathbf{W}\in\mathbb{R}^{|\mathcal{X}^{\prime}|}" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mrow id="alg1.l2.m2.1.2" xref="alg1.l2.m2.1.2.cmml"><mi id="alg1.l2.m2.1.2.2" xref="alg1.l2.m2.1.2.2.cmml">𝐖</mi><mo id="alg1.l2.m2.1.2.1" xref="alg1.l2.m2.1.2.1.cmml">∈</mo><msup id="alg1.l2.m2.1.2.3" xref="alg1.l2.m2.1.2.3.cmml"><mi id="alg1.l2.m2.1.2.3.2" xref="alg1.l2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="alg1.l2.m2.1.1.1.1" xref="alg1.l2.m2.1.1.1.2.cmml"><mo id="alg1.l2.m2.1.1.1.1.2" stretchy="false" xref="alg1.l2.m2.1.1.1.2.1.cmml">|</mo><msup id="alg1.l2.m2.1.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.1.1.1.1.1.2" xref="alg1.l2.m2.1.1.1.1.1.2.cmml">𝒳</mi><mo id="alg1.l2.m2.1.1.1.1.1.3" xref="alg1.l2.m2.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l2.m2.1.1.1.1.3" stretchy="false" xref="alg1.l2.m2.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.2.cmml" xref="alg1.l2.m2.1.2"><in id="alg1.l2.m2.1.2.1.cmml" xref="alg1.l2.m2.1.2.1"></in><ci id="alg1.l2.m2.1.2.2.cmml" xref="alg1.l2.m2.1.2.2">𝐖</ci><apply id="alg1.l2.m2.1.2.3.cmml" xref="alg1.l2.m2.1.2.3"><csymbol cd="ambiguous" id="alg1.l2.m2.1.2.3.1.cmml" xref="alg1.l2.m2.1.2.3">superscript</csymbol><ci id="alg1.l2.m2.1.2.3.2.cmml" xref="alg1.l2.m2.1.2.3.2">ℝ</ci><apply id="alg1.l2.m2.1.1.1.2.cmml" xref="alg1.l2.m2.1.1.1.1"><abs id="alg1.l2.m2.1.1.1.2.1.cmml" xref="alg1.l2.m2.1.1.1.1.2"></abs><apply id="alg1.l2.m2.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l2.m2.1.1.1.1.1.2.cmml" xref="alg1.l2.m2.1.1.1.1.1.2">𝒳</ci><ci id="alg1.l2.m2.1.1.1.1.1.3.cmml" xref="alg1.l2.m2.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\mathbf{W}\in\mathbb{R}^{|\mathcal{X}^{\prime}|}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>Construct a pre-training dataset <math alttext="\mathcal{X}_{\text{pre}}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒳</mi><mtext id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒳</ci><ci id="alg1.l3.m1.1.1.3a.cmml" xref="alg1.l3.m1.1.1.3"><mtext id="alg1.l3.m1.1.1.3.cmml" mathsize="70%" xref="alg1.l3.m1.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{X}_{\text{pre}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_X start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT</annotation></semantics></math> as in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.SS2.SSS1" title="4.2.1. Construction of Pre-training Task ‣ 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.2.1</span></a>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.2.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l4.3">while</span> not converged <span class="ltx_text ltx_font_bold" id="alg1.l4.4">do</span> <span class="ltx_text" id="alg1.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l4.1.m1.1"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.1d">▷</annotation></semantics></math> Pre-training
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     Extract a batch of sequence-pattern pairs <math alttext="(s_{u},p_{i})" class="ltx_Math" display="inline" id="alg1.l5.m1.2"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.3.cmml"><mo id="alg1.l5.m1.2.2.2.3" stretchy="false" xref="alg1.l5.m1.2.2.3.cmml">(</mo><msub id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l5.m1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.3.cmml">u</mi></msub><mo id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.3.cmml">,</mo><msub id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml">p</mi><mi id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l5.m1.2.2.2.5" stretchy="false" xref="alg1.l5.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><interval closure="open" id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.2">𝑠</ci><ci id="alg1.l5.m1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.3">𝑢</ci></apply><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2">𝑝</ci><ci id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">(s_{u},p_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.2d">( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> from <math alttext="\mathcal{X}_{\text{pre}}" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">𝒳</mi><mtext id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝒳</ci><ci id="alg1.l5.m2.1.1.3a.cmml" xref="alg1.l5.m2.1.1.3"><mtext id="alg1.l5.m2.1.1.3.cmml" mathsize="70%" xref="alg1.l5.m2.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\mathcal{X}_{\text{pre}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">caligraphic_X start_POSTSUBSCRIPT pre end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     Get K memories <math alttext="\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K%
}\}=\text{Encoder}(s_{u})" class="ltx_Math" display="inline" id="alg1.l6.m1.5"><semantics id="alg1.l6.m1.5a"><mrow id="alg1.l6.m1.5.5" xref="alg1.l6.m1.5.5.cmml"><mrow id="alg1.l6.m1.4.4.3.3" xref="alg1.l6.m1.4.4.3.4.cmml"><mo id="alg1.l6.m1.4.4.3.3.4" stretchy="false" xref="alg1.l6.m1.4.4.3.4.cmml">{</mo><msubsup id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.2.2" xref="alg1.l6.m1.2.2.1.1.1.2.2.cmml">𝐦</mi><mn id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.3.cmml">1</mn><mo id="alg1.l6.m1.2.2.1.1.1.2.3" xref="alg1.l6.m1.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l6.m1.4.4.3.3.5" xref="alg1.l6.m1.4.4.3.4.cmml">,</mo><msubsup id="alg1.l6.m1.3.3.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.2.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.2.cmml">𝐦</mi><mn id="alg1.l6.m1.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">2</mn><mo id="alg1.l6.m1.3.3.2.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l6.m1.4.4.3.3.6" xref="alg1.l6.m1.4.4.3.4.cmml">,</mo><mi id="alg1.l6.m1.1.1" mathvariant="normal" xref="alg1.l6.m1.1.1.cmml">…</mi><mo id="alg1.l6.m1.4.4.3.3.7" xref="alg1.l6.m1.4.4.3.4.cmml">,</mo><msubsup id="alg1.l6.m1.4.4.3.3.3" xref="alg1.l6.m1.4.4.3.3.3.cmml"><mi id="alg1.l6.m1.4.4.3.3.3.2.2" xref="alg1.l6.m1.4.4.3.3.3.2.2.cmml">𝐦</mi><mi id="alg1.l6.m1.4.4.3.3.3.3" xref="alg1.l6.m1.4.4.3.3.3.3.cmml">K</mi><mo id="alg1.l6.m1.4.4.3.3.3.2.3" xref="alg1.l6.m1.4.4.3.3.3.2.3.cmml">′</mo></msubsup><mo id="alg1.l6.m1.4.4.3.3.8" stretchy="false" xref="alg1.l6.m1.4.4.3.4.cmml">}</mo></mrow><mo id="alg1.l6.m1.5.5.5" xref="alg1.l6.m1.5.5.5.cmml">=</mo><mrow id="alg1.l6.m1.5.5.4" xref="alg1.l6.m1.5.5.4.cmml"><mtext id="alg1.l6.m1.5.5.4.3" xref="alg1.l6.m1.5.5.4.3a.cmml">Encoder</mtext><mo id="alg1.l6.m1.5.5.4.2" xref="alg1.l6.m1.5.5.4.2.cmml">⁢</mo><mrow id="alg1.l6.m1.5.5.4.1.1" xref="alg1.l6.m1.5.5.4.1.1.1.cmml"><mo id="alg1.l6.m1.5.5.4.1.1.2" stretchy="false" xref="alg1.l6.m1.5.5.4.1.1.1.cmml">(</mo><msub id="alg1.l6.m1.5.5.4.1.1.1" xref="alg1.l6.m1.5.5.4.1.1.1.cmml"><mi id="alg1.l6.m1.5.5.4.1.1.1.2" xref="alg1.l6.m1.5.5.4.1.1.1.2.cmml">s</mi><mi id="alg1.l6.m1.5.5.4.1.1.1.3" xref="alg1.l6.m1.5.5.4.1.1.1.3.cmml">u</mi></msub><mo id="alg1.l6.m1.5.5.4.1.1.3" stretchy="false" xref="alg1.l6.m1.5.5.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.5b"><apply id="alg1.l6.m1.5.5.cmml" xref="alg1.l6.m1.5.5"><eq id="alg1.l6.m1.5.5.5.cmml" xref="alg1.l6.m1.5.5.5"></eq><set id="alg1.l6.m1.4.4.3.4.cmml" xref="alg1.l6.m1.4.4.3.3"><apply id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.2.2">𝐦</ci><ci id="alg1.l6.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.2.3">′</ci></apply><cn id="alg1.l6.m1.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l6.m1.2.2.1.1.1.3">1</cn></apply><apply id="alg1.l6.m1.3.3.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">subscript</csymbol><apply id="alg1.l6.m1.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">superscript</csymbol><ci id="alg1.l6.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2">𝐦</ci><ci id="alg1.l6.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.3">′</ci></apply><cn id="alg1.l6.m1.3.3.2.2.2.3.cmml" type="integer" xref="alg1.l6.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">…</ci><apply id="alg1.l6.m1.4.4.3.3.3.cmml" xref="alg1.l6.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.3.3.1.cmml" xref="alg1.l6.m1.4.4.3.3.3">subscript</csymbol><apply id="alg1.l6.m1.4.4.3.3.3.2.cmml" xref="alg1.l6.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.3.3.2.1.cmml" xref="alg1.l6.m1.4.4.3.3.3">superscript</csymbol><ci id="alg1.l6.m1.4.4.3.3.3.2.2.cmml" xref="alg1.l6.m1.4.4.3.3.3.2.2">𝐦</ci><ci id="alg1.l6.m1.4.4.3.3.3.2.3.cmml" xref="alg1.l6.m1.4.4.3.3.3.2.3">′</ci></apply><ci id="alg1.l6.m1.4.4.3.3.3.3.cmml" xref="alg1.l6.m1.4.4.3.3.3.3">𝐾</ci></apply></set><apply id="alg1.l6.m1.5.5.4.cmml" xref="alg1.l6.m1.5.5.4"><times id="alg1.l6.m1.5.5.4.2.cmml" xref="alg1.l6.m1.5.5.4.2"></times><ci id="alg1.l6.m1.5.5.4.3a.cmml" xref="alg1.l6.m1.5.5.4.3"><mtext id="alg1.l6.m1.5.5.4.3.cmml" xref="alg1.l6.m1.5.5.4.3">Encoder</mtext></ci><apply id="alg1.l6.m1.5.5.4.1.1.1.cmml" xref="alg1.l6.m1.5.5.4.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.5.5.4.1.1.1.1.cmml" xref="alg1.l6.m1.5.5.4.1.1">subscript</csymbol><ci id="alg1.l6.m1.5.5.4.1.1.1.2.cmml" xref="alg1.l6.m1.5.5.4.1.1.1.2">𝑠</ci><ci id="alg1.l6.m1.5.5.4.1.1.1.3.cmml" xref="alg1.l6.m1.5.5.4.1.1.1.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.5c">\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K%
}\}=\text{Encoder}(s_{u})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.5d">{ bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT } = Encoder ( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>     Get a category vector <math alttext="\pi=\text{DiversityPromoter}(p_{i})" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">π</mi><mo id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">=</mo><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><mtext id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3a.cmml">DiversityPromoter</mtext><mo id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l7.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l7.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"></eq><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝜋</ci><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></times><ci id="alg1.l7.m1.1.1.1.3a.cmml" xref="alg1.l7.m1.1.1.1.3"><mtext id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">DiversityPromoter</mtext></ci><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\pi=\text{DiversityPromoter}(p_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_π = DiversityPromoter ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     Get a mixed memory by <math alttext="\mathbf{m}_{\text{final}}=\sum_{k=1}^{K}\mathbf{\pi}_{k}\mathbf{m}^{\prime}_{k}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">𝐦</mi><mtext id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3a.cmml">final</mtext></msub><mo id="alg1.l8.m1.1.1.1" rspace="0.111em" xref="alg1.l8.m1.1.1.1.cmml">=</mo><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><msubsup id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml"><mo id="alg1.l8.m1.1.1.3.1.2.2" xref="alg1.l8.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l8.m1.1.1.3.1.2.3" xref="alg1.l8.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.1.2.3.2" xref="alg1.l8.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l8.m1.1.1.3.1.2.3.1" xref="alg1.l8.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l8.m1.1.1.3.1.2.3.3" xref="alg1.l8.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l8.m1.1.1.3.1.3" xref="alg1.l8.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml"><msub id="alg1.l8.m1.1.1.3.2.2" xref="alg1.l8.m1.1.1.3.2.2.cmml"><mi id="alg1.l8.m1.1.1.3.2.2.2" xref="alg1.l8.m1.1.1.3.2.2.2.cmml">π</mi><mi id="alg1.l8.m1.1.1.3.2.2.3" xref="alg1.l8.m1.1.1.3.2.2.3.cmml">k</mi></msub><mo id="alg1.l8.m1.1.1.3.2.1" xref="alg1.l8.m1.1.1.3.2.1.cmml">⁢</mo><msubsup id="alg1.l8.m1.1.1.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.2.3.2.2" xref="alg1.l8.m1.1.1.3.2.3.2.2.cmml">𝐦</mi><mi id="alg1.l8.m1.1.1.3.2.3.3" xref="alg1.l8.m1.1.1.3.2.3.3.cmml">k</mi><mo id="alg1.l8.m1.1.1.3.2.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><eq id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></eq><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝐦</ci><ci id="alg1.l8.m1.1.1.2.3a.cmml" xref="alg1.l8.m1.1.1.2.3"><mtext id="alg1.l8.m1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l8.m1.1.1.2.3">final</mtext></ci></apply><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><apply id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.1.cmml" xref="alg1.l8.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l8.m1.1.1.3.1.2.cmml" xref="alg1.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.2.1.cmml" xref="alg1.l8.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l8.m1.1.1.3.1.2.2.cmml" xref="alg1.l8.m1.1.1.3.1.2.2"></sum><apply id="alg1.l8.m1.1.1.3.1.2.3.cmml" xref="alg1.l8.m1.1.1.3.1.2.3"><eq id="alg1.l8.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l8.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.1.2.3.2">𝑘</ci><cn id="alg1.l8.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="alg1.l8.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l8.m1.1.1.3.1.3.cmml" xref="alg1.l8.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2"><times id="alg1.l8.m1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2.1"></times><apply id="alg1.l8.m1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.2.1.cmml" xref="alg1.l8.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2.2">𝜋</ci><ci id="alg1.l8.m1.1.1.3.2.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.2.3">𝑘</ci></apply><apply id="alg1.l8.m1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.2.3">subscript</csymbol><apply id="alg1.l8.m1.1.1.3.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2.3">superscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.3.2.2">𝐦</ci><ci id="alg1.l8.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3.2.3">′</ci></apply><ci id="alg1.l8.m1.1.1.3.2.3.3.cmml" xref="alg1.l8.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\mathbf{m}_{\text{final}}=\sum_{k=1}^{K}\mathbf{\pi}_{k}\mathbf{m}^{\prime}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">bold_m start_POSTSUBSCRIPT final end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>     Get a decoded sequence <math alttext="p_{i}^{\prime}=\text{Decoder}(p_{i},\mathbf{m}_{\text{final}})" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><msubsup id="alg1.l9.m1.2.2.4" xref="alg1.l9.m1.2.2.4.cmml"><mi id="alg1.l9.m1.2.2.4.2.2" xref="alg1.l9.m1.2.2.4.2.2.cmml">p</mi><mi id="alg1.l9.m1.2.2.4.2.3" xref="alg1.l9.m1.2.2.4.2.3.cmml">i</mi><mo id="alg1.l9.m1.2.2.4.3" xref="alg1.l9.m1.2.2.4.3.cmml">′</mo></msubsup><mo id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml">=</mo><mrow id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.2.cmml"><mtext id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.2.4a.cmml">Decoder</mtext><mo id="alg1.l9.m1.2.2.2.3" xref="alg1.l9.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.3.cmml"><mo id="alg1.l9.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l9.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l9.m1.2.2.2.2.2.4" xref="alg1.l9.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l9.m1.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml">𝐦</mi><mtext id="alg1.l9.m1.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.3a.cmml">final</mtext></msub><mo id="alg1.l9.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l9.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><eq id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3"></eq><apply id="alg1.l9.m1.2.2.4.cmml" xref="alg1.l9.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.4.1.cmml" xref="alg1.l9.m1.2.2.4">superscript</csymbol><apply id="alg1.l9.m1.2.2.4.2.cmml" xref="alg1.l9.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.4.2.1.cmml" xref="alg1.l9.m1.2.2.4">subscript</csymbol><ci id="alg1.l9.m1.2.2.4.2.2.cmml" xref="alg1.l9.m1.2.2.4.2.2">𝑝</ci><ci id="alg1.l9.m1.2.2.4.2.3.cmml" xref="alg1.l9.m1.2.2.4.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.2.2.4.3.cmml" xref="alg1.l9.m1.2.2.4.3">′</ci></apply><apply id="alg1.l9.m1.2.2.2.cmml" xref="alg1.l9.m1.2.2.2"><times id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.3"></times><ci id="alg1.l9.m1.2.2.2.4a.cmml" xref="alg1.l9.m1.2.2.2.4"><mtext id="alg1.l9.m1.2.2.2.4.cmml" xref="alg1.l9.m1.2.2.2.4">Decoder</mtext></ci><interval closure="open" id="alg1.l9.m1.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">𝐦</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.3a.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3"><mtext id="alg1.l9.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l9.m1.2.2.2.2.2.2.3">final</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">p_{i}^{\prime}=\text{Decoder}(p_{i},\mathbf{m}_{\text{final}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = Decoder ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_m start_POSTSUBSCRIPT final end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>     Optimize the dataset generator with Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E2" title="In 4.2.2. Diversity-promoted Regenerator ‣ 4.2. Model-agnostic Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l11.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l11.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.2.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l12.3">while</span> not converged <span class="ltx_text ltx_font_bold" id="alg1.l12.4">do</span> <span class="ltx_text" id="alg1.l12.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.1.m1.1d">▷</annotation></semantics></math> Inference
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>     Extract a sequence <math alttext="s_{u}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><msub id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">s</mi><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑠</ci><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">s_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> from the original dataset <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="alg1.l13.m2.1"><semantics id="alg1.l13.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.1d">caligraphic_X</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>     Get K memories <math alttext="\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K%
}\}=\text{Encoder}(s_{u})" class="ltx_Math" display="inline" id="alg1.l14.m1.5"><semantics id="alg1.l14.m1.5a"><mrow id="alg1.l14.m1.5.5" xref="alg1.l14.m1.5.5.cmml"><mrow id="alg1.l14.m1.4.4.3.3" xref="alg1.l14.m1.4.4.3.4.cmml"><mo id="alg1.l14.m1.4.4.3.3.4" stretchy="false" xref="alg1.l14.m1.4.4.3.4.cmml">{</mo><msubsup id="alg1.l14.m1.2.2.1.1.1" xref="alg1.l14.m1.2.2.1.1.1.cmml"><mi id="alg1.l14.m1.2.2.1.1.1.2.2" xref="alg1.l14.m1.2.2.1.1.1.2.2.cmml">𝐦</mi><mn id="alg1.l14.m1.2.2.1.1.1.3" xref="alg1.l14.m1.2.2.1.1.1.3.cmml">1</mn><mo id="alg1.l14.m1.2.2.1.1.1.2.3" xref="alg1.l14.m1.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l14.m1.4.4.3.3.5" xref="alg1.l14.m1.4.4.3.4.cmml">,</mo><msubsup id="alg1.l14.m1.3.3.2.2.2" xref="alg1.l14.m1.3.3.2.2.2.cmml"><mi id="alg1.l14.m1.3.3.2.2.2.2.2" xref="alg1.l14.m1.3.3.2.2.2.2.2.cmml">𝐦</mi><mn id="alg1.l14.m1.3.3.2.2.2.3" xref="alg1.l14.m1.3.3.2.2.2.3.cmml">2</mn><mo id="alg1.l14.m1.3.3.2.2.2.2.3" xref="alg1.l14.m1.3.3.2.2.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l14.m1.4.4.3.3.6" xref="alg1.l14.m1.4.4.3.4.cmml">,</mo><mi id="alg1.l14.m1.1.1" mathvariant="normal" xref="alg1.l14.m1.1.1.cmml">…</mi><mo id="alg1.l14.m1.4.4.3.3.7" xref="alg1.l14.m1.4.4.3.4.cmml">,</mo><msubsup id="alg1.l14.m1.4.4.3.3.3" xref="alg1.l14.m1.4.4.3.3.3.cmml"><mi id="alg1.l14.m1.4.4.3.3.3.2.2" xref="alg1.l14.m1.4.4.3.3.3.2.2.cmml">𝐦</mi><mi id="alg1.l14.m1.4.4.3.3.3.3" xref="alg1.l14.m1.4.4.3.3.3.3.cmml">K</mi><mo id="alg1.l14.m1.4.4.3.3.3.2.3" xref="alg1.l14.m1.4.4.3.3.3.2.3.cmml">′</mo></msubsup><mo id="alg1.l14.m1.4.4.3.3.8" stretchy="false" xref="alg1.l14.m1.4.4.3.4.cmml">}</mo></mrow><mo id="alg1.l14.m1.5.5.5" xref="alg1.l14.m1.5.5.5.cmml">=</mo><mrow id="alg1.l14.m1.5.5.4" xref="alg1.l14.m1.5.5.4.cmml"><mtext id="alg1.l14.m1.5.5.4.3" xref="alg1.l14.m1.5.5.4.3a.cmml">Encoder</mtext><mo id="alg1.l14.m1.5.5.4.2" xref="alg1.l14.m1.5.5.4.2.cmml">⁢</mo><mrow id="alg1.l14.m1.5.5.4.1.1" xref="alg1.l14.m1.5.5.4.1.1.1.cmml"><mo id="alg1.l14.m1.5.5.4.1.1.2" stretchy="false" xref="alg1.l14.m1.5.5.4.1.1.1.cmml">(</mo><msub id="alg1.l14.m1.5.5.4.1.1.1" xref="alg1.l14.m1.5.5.4.1.1.1.cmml"><mi id="alg1.l14.m1.5.5.4.1.1.1.2" xref="alg1.l14.m1.5.5.4.1.1.1.2.cmml">s</mi><mi id="alg1.l14.m1.5.5.4.1.1.1.3" xref="alg1.l14.m1.5.5.4.1.1.1.3.cmml">u</mi></msub><mo id="alg1.l14.m1.5.5.4.1.1.3" stretchy="false" xref="alg1.l14.m1.5.5.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.5b"><apply id="alg1.l14.m1.5.5.cmml" xref="alg1.l14.m1.5.5"><eq id="alg1.l14.m1.5.5.5.cmml" xref="alg1.l14.m1.5.5.5"></eq><set id="alg1.l14.m1.4.4.3.4.cmml" xref="alg1.l14.m1.4.4.3.3"><apply id="alg1.l14.m1.2.2.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1">subscript</csymbol><apply id="alg1.l14.m1.2.2.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l14.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l14.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l14.m1.2.2.1.1.1.2.2">𝐦</ci><ci id="alg1.l14.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l14.m1.2.2.1.1.1.2.3">′</ci></apply><cn id="alg1.l14.m1.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l14.m1.2.2.1.1.1.3">1</cn></apply><apply id="alg1.l14.m1.3.3.2.2.2.cmml" xref="alg1.l14.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.3.3.2.2.2.1.cmml" xref="alg1.l14.m1.3.3.2.2.2">subscript</csymbol><apply id="alg1.l14.m1.3.3.2.2.2.2.cmml" xref="alg1.l14.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l14.m1.3.3.2.2.2">superscript</csymbol><ci id="alg1.l14.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l14.m1.3.3.2.2.2.2.2">𝐦</ci><ci id="alg1.l14.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l14.m1.3.3.2.2.2.2.3">′</ci></apply><cn id="alg1.l14.m1.3.3.2.2.2.3.cmml" type="integer" xref="alg1.l14.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">…</ci><apply id="alg1.l14.m1.4.4.3.3.3.cmml" xref="alg1.l14.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.4.3.3.3.1.cmml" xref="alg1.l14.m1.4.4.3.3.3">subscript</csymbol><apply id="alg1.l14.m1.4.4.3.3.3.2.cmml" xref="alg1.l14.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.4.3.3.3.2.1.cmml" xref="alg1.l14.m1.4.4.3.3.3">superscript</csymbol><ci id="alg1.l14.m1.4.4.3.3.3.2.2.cmml" xref="alg1.l14.m1.4.4.3.3.3.2.2">𝐦</ci><ci id="alg1.l14.m1.4.4.3.3.3.2.3.cmml" xref="alg1.l14.m1.4.4.3.3.3.2.3">′</ci></apply><ci id="alg1.l14.m1.4.4.3.3.3.3.cmml" xref="alg1.l14.m1.4.4.3.3.3.3">𝐾</ci></apply></set><apply id="alg1.l14.m1.5.5.4.cmml" xref="alg1.l14.m1.5.5.4"><times id="alg1.l14.m1.5.5.4.2.cmml" xref="alg1.l14.m1.5.5.4.2"></times><ci id="alg1.l14.m1.5.5.4.3a.cmml" xref="alg1.l14.m1.5.5.4.3"><mtext id="alg1.l14.m1.5.5.4.3.cmml" xref="alg1.l14.m1.5.5.4.3">Encoder</mtext></ci><apply id="alg1.l14.m1.5.5.4.1.1.1.cmml" xref="alg1.l14.m1.5.5.4.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.4.1.1.1.1.cmml" xref="alg1.l14.m1.5.5.4.1.1">subscript</csymbol><ci id="alg1.l14.m1.5.5.4.1.1.1.2.cmml" xref="alg1.l14.m1.5.5.4.1.1.1.2">𝑠</ci><ci id="alg1.l14.m1.5.5.4.1.1.1.3.cmml" xref="alg1.l14.m1.5.5.4.1.1.1.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.5c">\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K%
}\}=\text{Encoder}(s_{u})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.5d">{ bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT } = Encoder ( italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>     Init the regenerated dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><msup id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">𝒳</mi><mo id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">superscript</csymbol><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝒳</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as an empty set

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l16.2">for</span> <math alttext="\mathbf{m}^{\prime}_{k}" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><msubsup id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi id="alg1.l16.m1.1.1.2.2" xref="alg1.l16.m1.1.1.2.2.cmml">𝐦</mi><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml">k</mi><mo id="alg1.l16.m1.1.1.2.3" xref="alg1.l16.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><apply id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1">superscript</csymbol><ci id="alg1.l16.m1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.2.2">𝐦</ci><ci id="alg1.l16.m1.1.1.2.3.cmml" xref="alg1.l16.m1.1.1.2.3">′</ci></apply><ci id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\mathbf{m}^{\prime}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K}\}" class="ltx_Math" display="inline" id="alg1.l16.m2.4"><semantics id="alg1.l16.m2.4a"><mrow id="alg1.l16.m2.4.4.3" xref="alg1.l16.m2.4.4.4.cmml"><mo id="alg1.l16.m2.4.4.3.4" stretchy="false" xref="alg1.l16.m2.4.4.4.cmml">{</mo><msubsup id="alg1.l16.m2.2.2.1.1" xref="alg1.l16.m2.2.2.1.1.cmml"><mi id="alg1.l16.m2.2.2.1.1.2.2" xref="alg1.l16.m2.2.2.1.1.2.2.cmml">𝐦</mi><mn id="alg1.l16.m2.2.2.1.1.3" xref="alg1.l16.m2.2.2.1.1.3.cmml">1</mn><mo id="alg1.l16.m2.2.2.1.1.2.3" xref="alg1.l16.m2.2.2.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l16.m2.4.4.3.5" xref="alg1.l16.m2.4.4.4.cmml">,</mo><msubsup id="alg1.l16.m2.3.3.2.2" xref="alg1.l16.m2.3.3.2.2.cmml"><mi id="alg1.l16.m2.3.3.2.2.2.2" xref="alg1.l16.m2.3.3.2.2.2.2.cmml">𝐦</mi><mn id="alg1.l16.m2.3.3.2.2.3" xref="alg1.l16.m2.3.3.2.2.3.cmml">2</mn><mo id="alg1.l16.m2.3.3.2.2.2.3" xref="alg1.l16.m2.3.3.2.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l16.m2.4.4.3.6" xref="alg1.l16.m2.4.4.4.cmml">,</mo><mi id="alg1.l16.m2.1.1" mathvariant="normal" xref="alg1.l16.m2.1.1.cmml">…</mi><mo id="alg1.l16.m2.4.4.3.7" xref="alg1.l16.m2.4.4.4.cmml">,</mo><msubsup id="alg1.l16.m2.4.4.3.3" xref="alg1.l16.m2.4.4.3.3.cmml"><mi id="alg1.l16.m2.4.4.3.3.2.2" xref="alg1.l16.m2.4.4.3.3.2.2.cmml">𝐦</mi><mi id="alg1.l16.m2.4.4.3.3.3" xref="alg1.l16.m2.4.4.3.3.3.cmml">K</mi><mo id="alg1.l16.m2.4.4.3.3.2.3" xref="alg1.l16.m2.4.4.3.3.2.3.cmml">′</mo></msubsup><mo id="alg1.l16.m2.4.4.3.8" stretchy="false" xref="alg1.l16.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.4b"><set id="alg1.l16.m2.4.4.4.cmml" xref="alg1.l16.m2.4.4.3"><apply id="alg1.l16.m2.2.2.1.1.cmml" xref="alg1.l16.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.2.2.1.1.1.cmml" xref="alg1.l16.m2.2.2.1.1">subscript</csymbol><apply id="alg1.l16.m2.2.2.1.1.2.cmml" xref="alg1.l16.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.2.2.1.1.2.1.cmml" xref="alg1.l16.m2.2.2.1.1">superscript</csymbol><ci id="alg1.l16.m2.2.2.1.1.2.2.cmml" xref="alg1.l16.m2.2.2.1.1.2.2">𝐦</ci><ci id="alg1.l16.m2.2.2.1.1.2.3.cmml" xref="alg1.l16.m2.2.2.1.1.2.3">′</ci></apply><cn id="alg1.l16.m2.2.2.1.1.3.cmml" type="integer" xref="alg1.l16.m2.2.2.1.1.3">1</cn></apply><apply id="alg1.l16.m2.3.3.2.2.cmml" xref="alg1.l16.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m2.3.3.2.2.1.cmml" xref="alg1.l16.m2.3.3.2.2">subscript</csymbol><apply id="alg1.l16.m2.3.3.2.2.2.cmml" xref="alg1.l16.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m2.3.3.2.2.2.1.cmml" xref="alg1.l16.m2.3.3.2.2">superscript</csymbol><ci id="alg1.l16.m2.3.3.2.2.2.2.cmml" xref="alg1.l16.m2.3.3.2.2.2.2">𝐦</ci><ci id="alg1.l16.m2.3.3.2.2.2.3.cmml" xref="alg1.l16.m2.3.3.2.2.2.3">′</ci></apply><cn id="alg1.l16.m2.3.3.2.2.3.cmml" type="integer" xref="alg1.l16.m2.3.3.2.2.3">2</cn></apply><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">…</ci><apply id="alg1.l16.m2.4.4.3.3.cmml" xref="alg1.l16.m2.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l16.m2.4.4.3.3.1.cmml" xref="alg1.l16.m2.4.4.3.3">subscript</csymbol><apply id="alg1.l16.m2.4.4.3.3.2.cmml" xref="alg1.l16.m2.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l16.m2.4.4.3.3.2.1.cmml" xref="alg1.l16.m2.4.4.3.3">superscript</csymbol><ci id="alg1.l16.m2.4.4.3.3.2.2.cmml" xref="alg1.l16.m2.4.4.3.3.2.2">𝐦</ci><ci id="alg1.l16.m2.4.4.3.3.2.3.cmml" xref="alg1.l16.m2.4.4.3.3.2.3">′</ci></apply><ci id="alg1.l16.m2.4.4.3.3.3.cmml" xref="alg1.l16.m2.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.4c">\{\mathbf{m}^{\prime}_{1},\mathbf{m}^{\prime}_{2},\dots,\mathbf{m}^{\prime}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.4d">{ bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l16.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span>         Init the regenerated pattern <math alttext="p_{i}^{\prime}" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><msubsup id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2.2" xref="alg1.l17.m1.1.1.2.2.cmml">p</mi><mi id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml">i</mi><mo id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2.2">𝑝</ci><ci id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">p_{i}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as the ¡BOS¿ token

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>         <span class="ltx_text ltx_font_bold" id="alg1.l18.2">while</span> <math alttext="v\neq" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml">v</mi><mo id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml">≠</mo><mi id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><neq id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"></neq><ci id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2">𝑣</ci><csymbol cd="latexml" id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">v\neq</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_v ≠</annotation></semantics></math> ¡EOS¿ token <span class="ltx_text ltx_font_bold" id="alg1.l18.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span>              Get a probability vector <math alttext="\mathbf{q}=\text{Decoder}(p_{i}^{\prime},\mathbf{m}^{\prime}_{k})" class="ltx_Math" display="inline" id="alg1.l19.m1.2"><semantics id="alg1.l19.m1.2a"><mrow id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml"><mi id="alg1.l19.m1.2.2.4" xref="alg1.l19.m1.2.2.4.cmml">𝐪</mi><mo id="alg1.l19.m1.2.2.3" xref="alg1.l19.m1.2.2.3.cmml">=</mo><mrow id="alg1.l19.m1.2.2.2" xref="alg1.l19.m1.2.2.2.cmml"><mtext id="alg1.l19.m1.2.2.2.4" xref="alg1.l19.m1.2.2.2.4a.cmml">Decoder</mtext><mo id="alg1.l19.m1.2.2.2.3" xref="alg1.l19.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l19.m1.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.3.cmml"><mo id="alg1.l19.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l19.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.l19.m1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l19.m1.1.1.1.1.1.1.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="alg1.l19.m1.1.1.1.1.1.1.2.3" xref="alg1.l19.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mo id="alg1.l19.m1.1.1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg1.l19.m1.2.2.2.2.2.4" xref="alg1.l19.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.l19.m1.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l19.m1.2.2.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.2.2.cmml">𝐦</mi><mi id="alg1.l19.m1.2.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.2.2.3.cmml">k</mi><mo id="alg1.l19.m1.2.2.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l19.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l19.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b"><apply id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2"><eq id="alg1.l19.m1.2.2.3.cmml" xref="alg1.l19.m1.2.2.3"></eq><ci id="alg1.l19.m1.2.2.4.cmml" xref="alg1.l19.m1.2.2.4">𝐪</ci><apply id="alg1.l19.m1.2.2.2.cmml" xref="alg1.l19.m1.2.2.2"><times id="alg1.l19.m1.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.3"></times><ci id="alg1.l19.m1.2.2.2.4a.cmml" xref="alg1.l19.m1.2.2.2.4"><mtext id="alg1.l19.m1.2.2.2.4.cmml" xref="alg1.l19.m1.2.2.2.4">Decoder</mtext></ci><interval closure="open" id="alg1.l19.m1.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2"><apply id="alg1.l19.m1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l19.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l19.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.3">′</ci></apply><apply id="alg1.l19.m1.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">subscript</csymbol><apply id="alg1.l19.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l19.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.2.2">𝐦</ci><ci id="alg1.l19.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.2.3">′</ci></apply><ci id="alg1.l19.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.2c">\mathbf{q}=\text{Decoder}(p_{i}^{\prime},\mathbf{m}^{\prime}_{k})</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.2d">bold_q = Decoder ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , bold_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>              <span class="ltx_text ltx_font_bold" id="alg1.l20.2">if</span> Generative decoding <span class="ltx_text ltx_font_bold" id="alg1.l20.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span>                  Get item <math alttext="v\in\mathcal{V}" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">v</mi><mo id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><in id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1"></in><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑣</ci><ci id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">v\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">italic_v ∈ caligraphic_V</annotation></semantics></math> with the highest probability

</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span>              <span class="ltx_text ltx_font_bold" id="alg1.l22.2">else</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span>                  Get item <math alttext="v\in s_{u}" class="ltx_Math" display="inline" id="alg1.l23.m1.1"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><mi id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml">v</mi><mo id="alg1.l23.m1.1.1.1" xref="alg1.l23.m1.1.1.1.cmml">∈</mo><msub id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"><mi id="alg1.l23.m1.1.1.3.2" xref="alg1.l23.m1.1.1.3.2.cmml">s</mi><mi id="alg1.l23.m1.1.1.3.3" xref="alg1.l23.m1.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><in id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1"></in><ci id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2">𝑣</ci><apply id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.3">subscript</csymbol><ci id="alg1.l23.m1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.3.2">𝑠</ci><ci id="alg1.l23.m1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">v\in s_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.1d">italic_v ∈ italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> with the highest probability

</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">24:</span></span>              <span class="ltx_text ltx_font_bold" id="alg1.l24.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l24.3">if</span>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l25.1.1.1" style="font-size:80%;">25:</span></span>              Update the regenerated pattern <math alttext="p_{i}^{\prime}\leftarrow Concat(p_{i}^{\prime},v)" class="ltx_Math" display="inline" id="alg1.l25.m1.2"><semantics id="alg1.l25.m1.2a"><mrow id="alg1.l25.m1.2.2" xref="alg1.l25.m1.2.2.cmml"><msubsup id="alg1.l25.m1.2.2.3" xref="alg1.l25.m1.2.2.3.cmml"><mi id="alg1.l25.m1.2.2.3.2.2" xref="alg1.l25.m1.2.2.3.2.2.cmml">p</mi><mi id="alg1.l25.m1.2.2.3.2.3" xref="alg1.l25.m1.2.2.3.2.3.cmml">i</mi><mo id="alg1.l25.m1.2.2.3.3" xref="alg1.l25.m1.2.2.3.3.cmml">′</mo></msubsup><mo id="alg1.l25.m1.2.2.2" stretchy="false" xref="alg1.l25.m1.2.2.2.cmml">←</mo><mrow id="alg1.l25.m1.2.2.1" xref="alg1.l25.m1.2.2.1.cmml"><mi id="alg1.l25.m1.2.2.1.3" xref="alg1.l25.m1.2.2.1.3.cmml">C</mi><mo id="alg1.l25.m1.2.2.1.2" xref="alg1.l25.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l25.m1.2.2.1.4" xref="alg1.l25.m1.2.2.1.4.cmml">o</mi><mo id="alg1.l25.m1.2.2.1.2a" xref="alg1.l25.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l25.m1.2.2.1.5" xref="alg1.l25.m1.2.2.1.5.cmml">n</mi><mo id="alg1.l25.m1.2.2.1.2b" xref="alg1.l25.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l25.m1.2.2.1.6" xref="alg1.l25.m1.2.2.1.6.cmml">c</mi><mo id="alg1.l25.m1.2.2.1.2c" xref="alg1.l25.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l25.m1.2.2.1.7" xref="alg1.l25.m1.2.2.1.7.cmml">a</mi><mo id="alg1.l25.m1.2.2.1.2d" xref="alg1.l25.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l25.m1.2.2.1.8" xref="alg1.l25.m1.2.2.1.8.cmml">t</mi><mo id="alg1.l25.m1.2.2.1.2e" xref="alg1.l25.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l25.m1.2.2.1.1.1" xref="alg1.l25.m1.2.2.1.1.2.cmml"><mo id="alg1.l25.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l25.m1.2.2.1.1.2.cmml">(</mo><msubsup id="alg1.l25.m1.2.2.1.1.1.1" xref="alg1.l25.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l25.m1.2.2.1.1.1.1.2.2" xref="alg1.l25.m1.2.2.1.1.1.1.2.2.cmml">p</mi><mi id="alg1.l25.m1.2.2.1.1.1.1.2.3" xref="alg1.l25.m1.2.2.1.1.1.1.2.3.cmml">i</mi><mo id="alg1.l25.m1.2.2.1.1.1.1.3" xref="alg1.l25.m1.2.2.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg1.l25.m1.2.2.1.1.1.3" xref="alg1.l25.m1.2.2.1.1.2.cmml">,</mo><mi id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml">v</mi><mo id="alg1.l25.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l25.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.2b"><apply id="alg1.l25.m1.2.2.cmml" xref="alg1.l25.m1.2.2"><ci id="alg1.l25.m1.2.2.2.cmml" xref="alg1.l25.m1.2.2.2">←</ci><apply id="alg1.l25.m1.2.2.3.cmml" xref="alg1.l25.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.3.1.cmml" xref="alg1.l25.m1.2.2.3">superscript</csymbol><apply id="alg1.l25.m1.2.2.3.2.cmml" xref="alg1.l25.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.3.2.1.cmml" xref="alg1.l25.m1.2.2.3">subscript</csymbol><ci id="alg1.l25.m1.2.2.3.2.2.cmml" xref="alg1.l25.m1.2.2.3.2.2">𝑝</ci><ci id="alg1.l25.m1.2.2.3.2.3.cmml" xref="alg1.l25.m1.2.2.3.2.3">𝑖</ci></apply><ci id="alg1.l25.m1.2.2.3.3.cmml" xref="alg1.l25.m1.2.2.3.3">′</ci></apply><apply id="alg1.l25.m1.2.2.1.cmml" xref="alg1.l25.m1.2.2.1"><times id="alg1.l25.m1.2.2.1.2.cmml" xref="alg1.l25.m1.2.2.1.2"></times><ci id="alg1.l25.m1.2.2.1.3.cmml" xref="alg1.l25.m1.2.2.1.3">𝐶</ci><ci id="alg1.l25.m1.2.2.1.4.cmml" xref="alg1.l25.m1.2.2.1.4">𝑜</ci><ci id="alg1.l25.m1.2.2.1.5.cmml" xref="alg1.l25.m1.2.2.1.5">𝑛</ci><ci id="alg1.l25.m1.2.2.1.6.cmml" xref="alg1.l25.m1.2.2.1.6">𝑐</ci><ci id="alg1.l25.m1.2.2.1.7.cmml" xref="alg1.l25.m1.2.2.1.7">𝑎</ci><ci id="alg1.l25.m1.2.2.1.8.cmml" xref="alg1.l25.m1.2.2.1.8">𝑡</ci><interval closure="open" id="alg1.l25.m1.2.2.1.1.2.cmml" xref="alg1.l25.m1.2.2.1.1.1"><apply id="alg1.l25.m1.2.2.1.1.1.1.cmml" xref="alg1.l25.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l25.m1.2.2.1.1.1.1">superscript</csymbol><apply id="alg1.l25.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l25.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l25.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l25.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l25.m1.2.2.1.1.1.1.2.2">𝑝</ci><ci id="alg1.l25.m1.2.2.1.1.1.1.2.3.cmml" xref="alg1.l25.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l25.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l25.m1.2.2.1.1.1.1.3">′</ci></apply><ci id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1">𝑣</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.2c">p_{i}^{\prime}\leftarrow Concat(p_{i}^{\prime},v)</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.2d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_C italic_o italic_n italic_c italic_a italic_t ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_v )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l26.1.1.1" style="font-size:80%;">26:</span></span>         <span class="ltx_text ltx_font_bold" id="alg1.l26.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l26.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l27.1.1.1" style="font-size:80%;">27:</span></span>         <math alttext="\mathcal{X}^{\prime}\leftarrow\mathcal{X}^{\prime}\cup{p_{i}^{\prime}}" class="ltx_Math" display="inline" id="alg1.l27.m1.1"><semantics id="alg1.l27.m1.1a"><mrow id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml"><msup id="alg1.l27.m1.1.1.2" xref="alg1.l27.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l27.m1.1.1.2.2" xref="alg1.l27.m1.1.1.2.2.cmml">𝒳</mi><mo id="alg1.l27.m1.1.1.2.3" xref="alg1.l27.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l27.m1.1.1.1" stretchy="false" xref="alg1.l27.m1.1.1.1.cmml">←</mo><mrow id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml"><msup id="alg1.l27.m1.1.1.3.2" xref="alg1.l27.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l27.m1.1.1.3.2.2" xref="alg1.l27.m1.1.1.3.2.2.cmml">𝒳</mi><mo id="alg1.l27.m1.1.1.3.2.3" xref="alg1.l27.m1.1.1.3.2.3.cmml">′</mo></msup><mo id="alg1.l27.m1.1.1.3.1" xref="alg1.l27.m1.1.1.3.1.cmml">∪</mo><msubsup id="alg1.l27.m1.1.1.3.3" xref="alg1.l27.m1.1.1.3.3.cmml"><mi id="alg1.l27.m1.1.1.3.3.2.2" xref="alg1.l27.m1.1.1.3.3.2.2.cmml">p</mi><mi id="alg1.l27.m1.1.1.3.3.2.3" xref="alg1.l27.m1.1.1.3.3.2.3.cmml">i</mi><mo id="alg1.l27.m1.1.1.3.3.3" xref="alg1.l27.m1.1.1.3.3.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1"><ci id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1">←</ci><apply id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.2.1.cmml" xref="alg1.l27.m1.1.1.2">superscript</csymbol><ci id="alg1.l27.m1.1.1.2.2.cmml" xref="alg1.l27.m1.1.1.2.2">𝒳</ci><ci id="alg1.l27.m1.1.1.2.3.cmml" xref="alg1.l27.m1.1.1.2.3">′</ci></apply><apply id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3"><union id="alg1.l27.m1.1.1.3.1.cmml" xref="alg1.l27.m1.1.1.3.1"></union><apply id="alg1.l27.m1.1.1.3.2.cmml" xref="alg1.l27.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.3.2.1.cmml" xref="alg1.l27.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l27.m1.1.1.3.2.2.cmml" xref="alg1.l27.m1.1.1.3.2.2">𝒳</ci><ci id="alg1.l27.m1.1.1.3.2.3.cmml" xref="alg1.l27.m1.1.1.3.2.3">′</ci></apply><apply id="alg1.l27.m1.1.1.3.3.cmml" xref="alg1.l27.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.3.3.1.cmml" xref="alg1.l27.m1.1.1.3.3">superscript</csymbol><apply id="alg1.l27.m1.1.1.3.3.2.cmml" xref="alg1.l27.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.3.3.2.1.cmml" xref="alg1.l27.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l27.m1.1.1.3.3.2.2.cmml" xref="alg1.l27.m1.1.1.3.3.2.2">𝑝</ci><ci id="alg1.l27.m1.1.1.3.3.2.3.cmml" xref="alg1.l27.m1.1.1.3.3.2.3">𝑖</ci></apply><ci id="alg1.l27.m1.1.1.3.3.3.cmml" xref="alg1.l27.m1.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">\mathcal{X}^{\prime}\leftarrow\mathcal{X}^{\prime}\cup{p_{i}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∪ italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l28.1.1.1" style="font-size:80%;">28:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l28.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l28.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l29.1.1.1" style="font-size:80%;">29:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l29.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l29.3">while</span>
</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Pseudo code of DR4SR+</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span>The regenerated sequence dataset <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><msup id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">𝒳</mi><mo id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1">superscript</csymbol><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝒳</ci><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, a target model <math alttext="f" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_f</annotation></semantics></math> with parameters <math alttext="\theta" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><mi id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_θ</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>A personalizer <math alttext="g" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_g</annotation></semantics></math> with parameters <math alttext="\phi" class="ltx_Math" display="inline" id="alg2.l2.m2.1"><semantics id="alg2.l2.m2.1a"><mi id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><ci id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m2.1d">italic_ϕ</annotation></semantics></math> that can assign scores <math alttext="\mathbf{W}\in\mathbb{R}^{|\mathcal{X}^{\prime}|}" class="ltx_Math" display="inline" id="alg2.l2.m3.1"><semantics id="alg2.l2.m3.1a"><mrow id="alg2.l2.m3.1.2" xref="alg2.l2.m3.1.2.cmml"><mi id="alg2.l2.m3.1.2.2" xref="alg2.l2.m3.1.2.2.cmml">𝐖</mi><mo id="alg2.l2.m3.1.2.1" xref="alg2.l2.m3.1.2.1.cmml">∈</mo><msup id="alg2.l2.m3.1.2.3" xref="alg2.l2.m3.1.2.3.cmml"><mi id="alg2.l2.m3.1.2.3.2" xref="alg2.l2.m3.1.2.3.2.cmml">ℝ</mi><mrow id="alg2.l2.m3.1.1.1.1" xref="alg2.l2.m3.1.1.1.2.cmml"><mo id="alg2.l2.m3.1.1.1.1.2" stretchy="false" xref="alg2.l2.m3.1.1.1.2.1.cmml">|</mo><msup id="alg2.l2.m3.1.1.1.1.1" xref="alg2.l2.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m3.1.1.1.1.1.2" xref="alg2.l2.m3.1.1.1.1.1.2.cmml">𝒳</mi><mo id="alg2.l2.m3.1.1.1.1.1.3" xref="alg2.l2.m3.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l2.m3.1.1.1.1.3" stretchy="false" xref="alg2.l2.m3.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m3.1b"><apply id="alg2.l2.m3.1.2.cmml" xref="alg2.l2.m3.1.2"><in id="alg2.l2.m3.1.2.1.cmml" xref="alg2.l2.m3.1.2.1"></in><ci id="alg2.l2.m3.1.2.2.cmml" xref="alg2.l2.m3.1.2.2">𝐖</ci><apply id="alg2.l2.m3.1.2.3.cmml" xref="alg2.l2.m3.1.2.3"><csymbol cd="ambiguous" id="alg2.l2.m3.1.2.3.1.cmml" xref="alg2.l2.m3.1.2.3">superscript</csymbol><ci id="alg2.l2.m3.1.2.3.2.cmml" xref="alg2.l2.m3.1.2.3.2">ℝ</ci><apply id="alg2.l2.m3.1.1.1.2.cmml" xref="alg2.l2.m3.1.1.1.1"><abs id="alg2.l2.m3.1.1.1.2.1.cmml" xref="alg2.l2.m3.1.1.1.1.2"></abs><apply id="alg2.l2.m3.1.1.1.1.1.cmml" xref="alg2.l2.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m3.1.1.1.1.1.1.cmml" xref="alg2.l2.m3.1.1.1.1.1">superscript</csymbol><ci id="alg2.l2.m3.1.1.1.1.1.2.cmml" xref="alg2.l2.m3.1.1.1.1.1.2">𝒳</ci><ci id="alg2.l2.m3.1.1.1.1.1.3.cmml" xref="alg2.l2.m3.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m3.1c">\mathbf{W}\in\mathbb{R}^{|\mathcal{X}^{\prime}|}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m3.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | end_POSTSUPERSCRIPT</annotation></semantics></math> for each data sample in <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="alg2.l2.m4.1"><semantics id="alg2.l2.m4.1a"><msup id="alg2.l2.m4.1.1" xref="alg2.l2.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m4.1.1.2" xref="alg2.l2.m4.1.1.2.cmml">𝒳</mi><mo id="alg2.l2.m4.1.1.3" xref="alg2.l2.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l2.m4.1b"><apply id="alg2.l2.m4.1.1.cmml" xref="alg2.l2.m4.1.1"><csymbol cd="ambiguous" id="alg2.l2.m4.1.1.1.cmml" xref="alg2.l2.m4.1.1">superscript</csymbol><ci id="alg2.l2.m4.1.1.2.cmml" xref="alg2.l2.m4.1.1.2">𝒳</ci><ci id="alg2.l2.m4.1.1.3.cmml" xref="alg2.l2.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m4.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m4.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span>Generate a dev dataset <math alttext="\mathcal{X}^{\prime}_{\text{dev}}" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><msubsup id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">𝒳</mi><mtext id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3a.cmml">dev</mtext><mo id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1">superscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝒳</ci><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">′</ci></apply><ci id="alg2.l3.m1.1.1.3a.cmml" xref="alg2.l3.m1.1.1.3"><mtext id="alg2.l3.m1.1.1.3.cmml" mathsize="70%" xref="alg2.l3.m1.1.1.3">dev</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\mathcal{X}^{\prime}_{\text{dev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT</annotation></semantics></math> by shuffling <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="alg2.l3.m2.1"><semantics id="alg2.l3.m2.1a"><msup id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m2.1.1.2" xref="alg2.l3.m2.1.1.2.cmml">𝒳</mi><mo id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">superscript</csymbol><ci id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1.2">𝒳</ci><ci id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m2.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l4.2">while</span> not converged <span class="ltx_text ltx_font_bold" id="alg2.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span>     // Lower optimization

</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l6.2">for</span> round = 1 <math alttext="\to T_{\text{lower}}" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml"></mi><mo id="alg2.l6.m1.1.1.1" stretchy="false" xref="alg2.l6.m1.1.1.1.cmml">→</mo><msub id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"><mi id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2.cmml">T</mi><mtext id="alg2.l6.m1.1.1.3.3" xref="alg2.l6.m1.1.1.3.3a.cmml">lower</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><ci id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">→</ci><csymbol cd="latexml" id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">absent</csymbol><apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3">subscript</csymbol><ci id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2">𝑇</ci><ci id="alg2.l6.m1.1.1.3.3a.cmml" xref="alg2.l6.m1.1.1.3.3"><mtext id="alg2.l6.m1.1.1.3.3.cmml" mathsize="70%" xref="alg2.l6.m1.1.1.3.3">lower</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\to T_{\text{lower}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">→ italic_T start_POSTSUBSCRIPT lower end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l6.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>         Extract a batch <math alttext="b" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_b</annotation></semantics></math> from <math alttext="\mathcal{X}^{\prime}" class="ltx_Math" display="inline" id="alg2.l7.m2.1"><semantics id="alg2.l7.m2.1a"><msup id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2.cmml">𝒳</mi><mo id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1">superscript</csymbol><ci id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2">𝒳</ci><ci id="alg2.l7.m2.1.1.3.cmml" xref="alg2.l7.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">\mathcal{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m2.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span>         Get data sample scores <math alttext="\mathbf{W}=g(b)" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.2" xref="alg2.l8.m1.1.2.cmml"><mi id="alg2.l8.m1.1.2.2" xref="alg2.l8.m1.1.2.2.cmml">𝐖</mi><mo id="alg2.l8.m1.1.2.1" xref="alg2.l8.m1.1.2.1.cmml">=</mo><mrow id="alg2.l8.m1.1.2.3" xref="alg2.l8.m1.1.2.3.cmml"><mi id="alg2.l8.m1.1.2.3.2" xref="alg2.l8.m1.1.2.3.2.cmml">g</mi><mo id="alg2.l8.m1.1.2.3.1" xref="alg2.l8.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l8.m1.1.2.3.3.2" xref="alg2.l8.m1.1.2.3.cmml"><mo id="alg2.l8.m1.1.2.3.3.2.1" stretchy="false" xref="alg2.l8.m1.1.2.3.cmml">(</mo><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">b</mi><mo id="alg2.l8.m1.1.2.3.3.2.2" stretchy="false" xref="alg2.l8.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.2.cmml" xref="alg2.l8.m1.1.2"><eq id="alg2.l8.m1.1.2.1.cmml" xref="alg2.l8.m1.1.2.1"></eq><ci id="alg2.l8.m1.1.2.2.cmml" xref="alg2.l8.m1.1.2.2">𝐖</ci><apply id="alg2.l8.m1.1.2.3.cmml" xref="alg2.l8.m1.1.2.3"><times id="alg2.l8.m1.1.2.3.1.cmml" xref="alg2.l8.m1.1.2.3.1"></times><ci id="alg2.l8.m1.1.2.3.2.cmml" xref="alg2.l8.m1.1.2.3.2">𝑔</ci><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\mathbf{W}=g(b)</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">bold_W = italic_g ( italic_b )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span>         Optimize <math alttext="f" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_f</annotation></semantics></math> based on Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E8" title="In 4.3.1. Dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l10.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l10.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">11:</span></span>     // Upper optimization

</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l12.1.1.1" style="font-size:80%;">12:</span></span>     Extract a batch <math alttext="b_{\text{dev}}" class="ltx_Math" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><msub id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">b</mi><mtext id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3a.cmml">dev</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1">subscript</csymbol><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">𝑏</ci><ci id="alg2.l12.m1.1.1.3a.cmml" xref="alg2.l12.m1.1.1.3"><mtext id="alg2.l12.m1.1.1.3.cmml" mathsize="70%" xref="alg2.l12.m1.1.1.3">dev</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">b_{\text{dev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">italic_b start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="\mathcal{X}^{\prime}_{\text{dev}}" class="ltx_Math" display="inline" id="alg2.l12.m2.1"><semantics id="alg2.l12.m2.1a"><msubsup id="alg2.l12.m2.1.1" xref="alg2.l12.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m2.1.1.2.2" xref="alg2.l12.m2.1.1.2.2.cmml">𝒳</mi><mtext id="alg2.l12.m2.1.1.3" xref="alg2.l12.m2.1.1.3a.cmml">dev</mtext><mo id="alg2.l12.m2.1.1.2.3" xref="alg2.l12.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l12.m2.1b"><apply id="alg2.l12.m2.1.1.cmml" xref="alg2.l12.m2.1.1"><csymbol cd="ambiguous" id="alg2.l12.m2.1.1.1.cmml" xref="alg2.l12.m2.1.1">subscript</csymbol><apply id="alg2.l12.m2.1.1.2.cmml" xref="alg2.l12.m2.1.1"><csymbol cd="ambiguous" id="alg2.l12.m2.1.1.2.1.cmml" xref="alg2.l12.m2.1.1">superscript</csymbol><ci id="alg2.l12.m2.1.1.2.2.cmml" xref="alg2.l12.m2.1.1.2.2">𝒳</ci><ci id="alg2.l12.m2.1.1.2.3.cmml" xref="alg2.l12.m2.1.1.2.3">′</ci></apply><ci id="alg2.l12.m2.1.1.3a.cmml" xref="alg2.l12.m2.1.1.3"><mtext id="alg2.l12.m2.1.1.3.cmml" mathsize="70%" xref="alg2.l12.m2.1.1.3">dev</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m2.1c">\mathcal{X}^{\prime}_{\text{dev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m2.1d">caligraphic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l13.1.1.1" style="font-size:80%;">13:</span></span>     Get <math alttext="\nabla_{\theta}L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="alg2.l13.m1.2"><semantics id="alg2.l13.m1.2a"><mrow id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2.cmml"><mrow id="alg2.l13.m1.2.2.3" xref="alg2.l13.m1.2.2.3.cmml"><msub id="alg2.l13.m1.2.2.3.1" xref="alg2.l13.m1.2.2.3.1.cmml"><mo id="alg2.l13.m1.2.2.3.1.2" xref="alg2.l13.m1.2.2.3.1.2.cmml">∇</mo><mi id="alg2.l13.m1.2.2.3.1.3" xref="alg2.l13.m1.2.2.3.1.3.cmml">θ</mi></msub><msub id="alg2.l13.m1.2.2.3.2" xref="alg2.l13.m1.2.2.3.2.cmml"><mi id="alg2.l13.m1.2.2.3.2.2" xref="alg2.l13.m1.2.2.3.2.2.cmml">L</mi><mtext id="alg2.l13.m1.2.2.3.2.3" xref="alg2.l13.m1.2.2.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="alg2.l13.m1.2.2.2" xref="alg2.l13.m1.2.2.2.cmml">⁢</mo><mrow id="alg2.l13.m1.2.2.1.1" xref="alg2.l13.m1.2.2.1.1.1.cmml"><mo id="alg2.l13.m1.2.2.1.1.2" stretchy="false" xref="alg2.l13.m1.2.2.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.2.2.1.1.1" xref="alg2.l13.m1.2.2.1.1.1.cmml"><msup id="alg2.l13.m1.2.2.1.1.1.2" xref="alg2.l13.m1.2.2.1.1.1.2.cmml"><mi id="alg2.l13.m1.2.2.1.1.1.2.2" xref="alg2.l13.m1.2.2.1.1.1.2.2.cmml">θ</mi><mo id="alg2.l13.m1.2.2.1.1.1.2.3" xref="alg2.l13.m1.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="alg2.l13.m1.2.2.1.1.1.1" xref="alg2.l13.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="alg2.l13.m1.2.2.1.1.1.3.2" xref="alg2.l13.m1.2.2.1.1.1.cmml"><mo id="alg2.l13.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="alg2.l13.m1.2.2.1.1.1.cmml">(</mo><mi id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">ϕ</mi><mo id="alg2.l13.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="alg2.l13.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l13.m1.2.2.1.1.3" stretchy="false" xref="alg2.l13.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.2b"><apply id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2"><times id="alg2.l13.m1.2.2.2.cmml" xref="alg2.l13.m1.2.2.2"></times><apply id="alg2.l13.m1.2.2.3.cmml" xref="alg2.l13.m1.2.2.3"><apply id="alg2.l13.m1.2.2.3.1.cmml" xref="alg2.l13.m1.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.3.1.1.cmml" xref="alg2.l13.m1.2.2.3.1">subscript</csymbol><ci id="alg2.l13.m1.2.2.3.1.2.cmml" xref="alg2.l13.m1.2.2.3.1.2">∇</ci><ci id="alg2.l13.m1.2.2.3.1.3.cmml" xref="alg2.l13.m1.2.2.3.1.3">𝜃</ci></apply><apply id="alg2.l13.m1.2.2.3.2.cmml" xref="alg2.l13.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.3.2.1.cmml" xref="alg2.l13.m1.2.2.3.2">subscript</csymbol><ci id="alg2.l13.m1.2.2.3.2.2.cmml" xref="alg2.l13.m1.2.2.3.2.2">𝐿</ci><ci id="alg2.l13.m1.2.2.3.2.3a.cmml" xref="alg2.l13.m1.2.2.3.2.3"><mtext id="alg2.l13.m1.2.2.3.2.3.cmml" mathsize="70%" xref="alg2.l13.m1.2.2.3.2.3">dev</mtext></ci></apply></apply><apply id="alg2.l13.m1.2.2.1.1.1.cmml" xref="alg2.l13.m1.2.2.1.1"><times id="alg2.l13.m1.2.2.1.1.1.1.cmml" xref="alg2.l13.m1.2.2.1.1.1.1"></times><apply id="alg2.l13.m1.2.2.1.1.1.2.cmml" xref="alg2.l13.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.1.1.1.2.1.cmml" xref="alg2.l13.m1.2.2.1.1.1.2">superscript</csymbol><ci id="alg2.l13.m1.2.2.1.1.1.2.2.cmml" xref="alg2.l13.m1.2.2.1.1.1.2.2">𝜃</ci><times id="alg2.l13.m1.2.2.1.1.1.2.3.cmml" xref="alg2.l13.m1.2.2.1.1.1.2.3"></times></apply><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.2c">\nabla_{\theta}L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.2d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math> with <math alttext="b_{\text{dev}}" class="ltx_Math" display="inline" id="alg2.l13.m2.1"><semantics id="alg2.l13.m2.1a"><msub id="alg2.l13.m2.1.1" xref="alg2.l13.m2.1.1.cmml"><mi id="alg2.l13.m2.1.1.2" xref="alg2.l13.m2.1.1.2.cmml">b</mi><mtext id="alg2.l13.m2.1.1.3" xref="alg2.l13.m2.1.1.3a.cmml">dev</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l13.m2.1b"><apply id="alg2.l13.m2.1.1.cmml" xref="alg2.l13.m2.1.1"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.1.cmml" xref="alg2.l13.m2.1.1">subscript</csymbol><ci id="alg2.l13.m2.1.1.2.cmml" xref="alg2.l13.m2.1.1.2">𝑏</ci><ci id="alg2.l13.m2.1.1.3a.cmml" xref="alg2.l13.m2.1.1.3"><mtext id="alg2.l13.m2.1.1.3.cmml" mathsize="70%" xref="alg2.l13.m2.1.1.3">dev</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m2.1c">b_{\text{dev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m2.1d">italic_b start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT</annotation></semantics></math> and Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E6" title="In 4.3.1. Dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l14.1.1.1" style="font-size:80%;">14:</span></span>     Get <math alttext="\nabla_{\phi}\theta^{*}(\phi)" class="ltx_Math" display="inline" id="alg2.l14.m1.1"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.2" xref="alg2.l14.m1.1.2.cmml"><mrow id="alg2.l14.m1.1.2.2" xref="alg2.l14.m1.1.2.2.cmml"><msub id="alg2.l14.m1.1.2.2.1" xref="alg2.l14.m1.1.2.2.1.cmml"><mo id="alg2.l14.m1.1.2.2.1.2" xref="alg2.l14.m1.1.2.2.1.2.cmml">∇</mo><mi id="alg2.l14.m1.1.2.2.1.3" xref="alg2.l14.m1.1.2.2.1.3.cmml">ϕ</mi></msub><msup id="alg2.l14.m1.1.2.2.2" xref="alg2.l14.m1.1.2.2.2.cmml"><mi id="alg2.l14.m1.1.2.2.2.2" xref="alg2.l14.m1.1.2.2.2.2.cmml">θ</mi><mo id="alg2.l14.m1.1.2.2.2.3" xref="alg2.l14.m1.1.2.2.2.3.cmml">∗</mo></msup></mrow><mo id="alg2.l14.m1.1.2.1" xref="alg2.l14.m1.1.2.1.cmml">⁢</mo><mrow id="alg2.l14.m1.1.2.3.2" xref="alg2.l14.m1.1.2.cmml"><mo id="alg2.l14.m1.1.2.3.2.1" stretchy="false" xref="alg2.l14.m1.1.2.cmml">(</mo><mi id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml">ϕ</mi><mo id="alg2.l14.m1.1.2.3.2.2" stretchy="false" xref="alg2.l14.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.2.cmml" xref="alg2.l14.m1.1.2"><times id="alg2.l14.m1.1.2.1.cmml" xref="alg2.l14.m1.1.2.1"></times><apply id="alg2.l14.m1.1.2.2.cmml" xref="alg2.l14.m1.1.2.2"><apply id="alg2.l14.m1.1.2.2.1.cmml" xref="alg2.l14.m1.1.2.2.1"><csymbol cd="ambiguous" id="alg2.l14.m1.1.2.2.1.1.cmml" xref="alg2.l14.m1.1.2.2.1">subscript</csymbol><ci id="alg2.l14.m1.1.2.2.1.2.cmml" xref="alg2.l14.m1.1.2.2.1.2">∇</ci><ci id="alg2.l14.m1.1.2.2.1.3.cmml" xref="alg2.l14.m1.1.2.2.1.3">italic-ϕ</ci></apply><apply id="alg2.l14.m1.1.2.2.2.cmml" xref="alg2.l14.m1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.2.2.2.1.cmml" xref="alg2.l14.m1.1.2.2.2">superscript</csymbol><ci id="alg2.l14.m1.1.2.2.2.2.cmml" xref="alg2.l14.m1.1.2.2.2.2">𝜃</ci><times id="alg2.l14.m1.1.2.2.2.3.cmml" xref="alg2.l14.m1.1.2.2.2.3"></times></apply></apply><ci id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">\nabla_{\phi}\theta^{*}(\phi)</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.1d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ )</annotation></semantics></math> by implicit differentiation

</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l15.1.1.1" style="font-size:80%;">15:</span></span>     Get <math alttext="\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="alg2.l15.m1.2"><semantics id="alg2.l15.m1.2a"><mrow id="alg2.l15.m1.2.2" xref="alg2.l15.m1.2.2.cmml"><mrow id="alg2.l15.m1.2.2.3" xref="alg2.l15.m1.2.2.3.cmml"><msub id="alg2.l15.m1.2.2.3.1" xref="alg2.l15.m1.2.2.3.1.cmml"><mo id="alg2.l15.m1.2.2.3.1.2" xref="alg2.l15.m1.2.2.3.1.2.cmml">∇</mo><mi id="alg2.l15.m1.2.2.3.1.3" xref="alg2.l15.m1.2.2.3.1.3.cmml">ϕ</mi></msub><msub id="alg2.l15.m1.2.2.3.2" xref="alg2.l15.m1.2.2.3.2.cmml"><mi id="alg2.l15.m1.2.2.3.2.2" xref="alg2.l15.m1.2.2.3.2.2.cmml">L</mi><mtext id="alg2.l15.m1.2.2.3.2.3" xref="alg2.l15.m1.2.2.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="alg2.l15.m1.2.2.2" xref="alg2.l15.m1.2.2.2.cmml">⁢</mo><mrow id="alg2.l15.m1.2.2.1.1" xref="alg2.l15.m1.2.2.1.1.1.cmml"><mo id="alg2.l15.m1.2.2.1.1.2" stretchy="false" xref="alg2.l15.m1.2.2.1.1.1.cmml">(</mo><mrow id="alg2.l15.m1.2.2.1.1.1" xref="alg2.l15.m1.2.2.1.1.1.cmml"><msup id="alg2.l15.m1.2.2.1.1.1.2" xref="alg2.l15.m1.2.2.1.1.1.2.cmml"><mi id="alg2.l15.m1.2.2.1.1.1.2.2" xref="alg2.l15.m1.2.2.1.1.1.2.2.cmml">θ</mi><mo id="alg2.l15.m1.2.2.1.1.1.2.3" xref="alg2.l15.m1.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="alg2.l15.m1.2.2.1.1.1.1" xref="alg2.l15.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="alg2.l15.m1.2.2.1.1.1.3.2" xref="alg2.l15.m1.2.2.1.1.1.cmml"><mo id="alg2.l15.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="alg2.l15.m1.2.2.1.1.1.cmml">(</mo><mi id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml">ϕ</mi><mo id="alg2.l15.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="alg2.l15.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l15.m1.2.2.1.1.3" stretchy="false" xref="alg2.l15.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.2b"><apply id="alg2.l15.m1.2.2.cmml" xref="alg2.l15.m1.2.2"><times id="alg2.l15.m1.2.2.2.cmml" xref="alg2.l15.m1.2.2.2"></times><apply id="alg2.l15.m1.2.2.3.cmml" xref="alg2.l15.m1.2.2.3"><apply id="alg2.l15.m1.2.2.3.1.cmml" xref="alg2.l15.m1.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.3.1.1.cmml" xref="alg2.l15.m1.2.2.3.1">subscript</csymbol><ci id="alg2.l15.m1.2.2.3.1.2.cmml" xref="alg2.l15.m1.2.2.3.1.2">∇</ci><ci id="alg2.l15.m1.2.2.3.1.3.cmml" xref="alg2.l15.m1.2.2.3.1.3">italic-ϕ</ci></apply><apply id="alg2.l15.m1.2.2.3.2.cmml" xref="alg2.l15.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.3.2.1.cmml" xref="alg2.l15.m1.2.2.3.2">subscript</csymbol><ci id="alg2.l15.m1.2.2.3.2.2.cmml" xref="alg2.l15.m1.2.2.3.2.2">𝐿</ci><ci id="alg2.l15.m1.2.2.3.2.3a.cmml" xref="alg2.l15.m1.2.2.3.2.3"><mtext id="alg2.l15.m1.2.2.3.2.3.cmml" mathsize="70%" xref="alg2.l15.m1.2.2.3.2.3">dev</mtext></ci></apply></apply><apply id="alg2.l15.m1.2.2.1.1.1.cmml" xref="alg2.l15.m1.2.2.1.1"><times id="alg2.l15.m1.2.2.1.1.1.1.cmml" xref="alg2.l15.m1.2.2.1.1.1.1"></times><apply id="alg2.l15.m1.2.2.1.1.1.2.cmml" xref="alg2.l15.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.1.1.1.2.1.cmml" xref="alg2.l15.m1.2.2.1.1.1.2">superscript</csymbol><ci id="alg2.l15.m1.2.2.1.1.1.2.2.cmml" xref="alg2.l15.m1.2.2.1.1.1.2.2">𝜃</ci><times id="alg2.l15.m1.2.2.1.1.1.2.3.cmml" xref="alg2.l15.m1.2.2.1.1.1.2.3"></times></apply><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.2c">\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.2d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math> as in Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.E11" title="In A.2. Detailed Derivations of Equation 10 ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">11</span></a>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l16.1.1.1" style="font-size:80%;">16:</span></span>     update <math alttext="\phi" class="ltx_Math" display="inline" id="alg2.l16.m1.1"><semantics id="alg2.l16.m1.1a"><mi id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><ci id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m1.1d">italic_ϕ</annotation></semantics></math> with <math alttext="\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="alg2.l16.m2.2"><semantics id="alg2.l16.m2.2a"><mrow id="alg2.l16.m2.2.2" xref="alg2.l16.m2.2.2.cmml"><mrow id="alg2.l16.m2.2.2.3" xref="alg2.l16.m2.2.2.3.cmml"><msub id="alg2.l16.m2.2.2.3.1" xref="alg2.l16.m2.2.2.3.1.cmml"><mo id="alg2.l16.m2.2.2.3.1.2" xref="alg2.l16.m2.2.2.3.1.2.cmml">∇</mo><mi id="alg2.l16.m2.2.2.3.1.3" xref="alg2.l16.m2.2.2.3.1.3.cmml">ϕ</mi></msub><msub id="alg2.l16.m2.2.2.3.2" xref="alg2.l16.m2.2.2.3.2.cmml"><mi id="alg2.l16.m2.2.2.3.2.2" xref="alg2.l16.m2.2.2.3.2.2.cmml">L</mi><mtext id="alg2.l16.m2.2.2.3.2.3" xref="alg2.l16.m2.2.2.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="alg2.l16.m2.2.2.2" xref="alg2.l16.m2.2.2.2.cmml">⁢</mo><mrow id="alg2.l16.m2.2.2.1.1" xref="alg2.l16.m2.2.2.1.1.1.cmml"><mo id="alg2.l16.m2.2.2.1.1.2" stretchy="false" xref="alg2.l16.m2.2.2.1.1.1.cmml">(</mo><mrow id="alg2.l16.m2.2.2.1.1.1" xref="alg2.l16.m2.2.2.1.1.1.cmml"><msup id="alg2.l16.m2.2.2.1.1.1.2" xref="alg2.l16.m2.2.2.1.1.1.2.cmml"><mi id="alg2.l16.m2.2.2.1.1.1.2.2" xref="alg2.l16.m2.2.2.1.1.1.2.2.cmml">θ</mi><mo id="alg2.l16.m2.2.2.1.1.1.2.3" xref="alg2.l16.m2.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="alg2.l16.m2.2.2.1.1.1.1" xref="alg2.l16.m2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="alg2.l16.m2.2.2.1.1.1.3.2" xref="alg2.l16.m2.2.2.1.1.1.cmml"><mo id="alg2.l16.m2.2.2.1.1.1.3.2.1" stretchy="false" xref="alg2.l16.m2.2.2.1.1.1.cmml">(</mo><mi id="alg2.l16.m2.1.1" xref="alg2.l16.m2.1.1.cmml">ϕ</mi><mo id="alg2.l16.m2.2.2.1.1.1.3.2.2" stretchy="false" xref="alg2.l16.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l16.m2.2.2.1.1.3" stretchy="false" xref="alg2.l16.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m2.2b"><apply id="alg2.l16.m2.2.2.cmml" xref="alg2.l16.m2.2.2"><times id="alg2.l16.m2.2.2.2.cmml" xref="alg2.l16.m2.2.2.2"></times><apply id="alg2.l16.m2.2.2.3.cmml" xref="alg2.l16.m2.2.2.3"><apply id="alg2.l16.m2.2.2.3.1.cmml" xref="alg2.l16.m2.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.3.1.1.cmml" xref="alg2.l16.m2.2.2.3.1">subscript</csymbol><ci id="alg2.l16.m2.2.2.3.1.2.cmml" xref="alg2.l16.m2.2.2.3.1.2">∇</ci><ci id="alg2.l16.m2.2.2.3.1.3.cmml" xref="alg2.l16.m2.2.2.3.1.3">italic-ϕ</ci></apply><apply id="alg2.l16.m2.2.2.3.2.cmml" xref="alg2.l16.m2.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.3.2.1.cmml" xref="alg2.l16.m2.2.2.3.2">subscript</csymbol><ci id="alg2.l16.m2.2.2.3.2.2.cmml" xref="alg2.l16.m2.2.2.3.2.2">𝐿</ci><ci id="alg2.l16.m2.2.2.3.2.3a.cmml" xref="alg2.l16.m2.2.2.3.2.3"><mtext id="alg2.l16.m2.2.2.3.2.3.cmml" mathsize="70%" xref="alg2.l16.m2.2.2.3.2.3">dev</mtext></ci></apply></apply><apply id="alg2.l16.m2.2.2.1.1.1.cmml" xref="alg2.l16.m2.2.2.1.1"><times id="alg2.l16.m2.2.2.1.1.1.1.cmml" xref="alg2.l16.m2.2.2.1.1.1.1"></times><apply id="alg2.l16.m2.2.2.1.1.1.2.cmml" xref="alg2.l16.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.1.1.1.2.1.cmml" xref="alg2.l16.m2.2.2.1.1.1.2">superscript</csymbol><ci id="alg2.l16.m2.2.2.1.1.1.2.2.cmml" xref="alg2.l16.m2.2.2.1.1.1.2.2">𝜃</ci><times id="alg2.l16.m2.2.2.1.1.1.2.3.cmml" xref="alg2.l16.m2.2.2.1.1.1.2.3"></times></apply><ci id="alg2.l16.m2.1.1.cmml" xref="alg2.l16.m2.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m2.2c">\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m2.2d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l17.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l17.3">while</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2. </span>Detailed Derivations of Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#S4.E10" title="In 4.3.2. Efficient optimization of dataset personalizer ‣ 4.3. Model-aware Dataset Regeneration ‣ 4. METHODOLOGY ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a>
</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">By applying the chain rule, we can compute calculate the implicit gradient of <math alttext="L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.2"><semantics id="A1.SS2.p1.1.m1.2a"><mrow id="A1.SS2.p1.1.m1.2.2" xref="A1.SS2.p1.1.m1.2.2.cmml"><msub id="A1.SS2.p1.1.m1.2.2.3" xref="A1.SS2.p1.1.m1.2.2.3.cmml"><mi id="A1.SS2.p1.1.m1.2.2.3.2" xref="A1.SS2.p1.1.m1.2.2.3.2.cmml">L</mi><mtext id="A1.SS2.p1.1.m1.2.2.3.3" xref="A1.SS2.p1.1.m1.2.2.3.3a.cmml">dev</mtext></msub><mo id="A1.SS2.p1.1.m1.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p1.1.m1.2.2.1.1" xref="A1.SS2.p1.1.m1.2.2.1.1.1.cmml"><mo id="A1.SS2.p1.1.m1.2.2.1.1.2" stretchy="false" xref="A1.SS2.p1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS2.p1.1.m1.2.2.1.1.1" xref="A1.SS2.p1.1.m1.2.2.1.1.1.cmml"><msup id="A1.SS2.p1.1.m1.2.2.1.1.1.2" xref="A1.SS2.p1.1.m1.2.2.1.1.1.2.cmml"><mi id="A1.SS2.p1.1.m1.2.2.1.1.1.2.2" xref="A1.SS2.p1.1.m1.2.2.1.1.1.2.2.cmml">θ</mi><mo id="A1.SS2.p1.1.m1.2.2.1.1.1.2.3" xref="A1.SS2.p1.1.m1.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.SS2.p1.1.m1.2.2.1.1.1.1" xref="A1.SS2.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS2.p1.1.m1.2.2.1.1.1.3.2" xref="A1.SS2.p1.1.m1.2.2.1.1.1.cmml"><mo id="A1.SS2.p1.1.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="A1.SS2.p1.1.m1.2.2.1.1.1.cmml">(</mo><mi id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">ϕ</mi><mo id="A1.SS2.p1.1.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="A1.SS2.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.1.m1.2.2.1.1.3" stretchy="false" xref="A1.SS2.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.2b"><apply id="A1.SS2.p1.1.m1.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2"><times id="A1.SS2.p1.1.m1.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2"></times><apply id="A1.SS2.p1.1.m1.2.2.3.cmml" xref="A1.SS2.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.2.3.1.cmml" xref="A1.SS2.p1.1.m1.2.2.3">subscript</csymbol><ci id="A1.SS2.p1.1.m1.2.2.3.2.cmml" xref="A1.SS2.p1.1.m1.2.2.3.2">𝐿</ci><ci id="A1.SS2.p1.1.m1.2.2.3.3a.cmml" xref="A1.SS2.p1.1.m1.2.2.3.3"><mtext id="A1.SS2.p1.1.m1.2.2.3.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.2.2.3.3">dev</mtext></ci></apply><apply id="A1.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1"><times id="A1.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.1.1"></times><apply id="A1.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.1.2">superscript</csymbol><ci id="A1.SS2.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.1.2.2">𝜃</ci><times id="A1.SS2.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="A1.SS2.p1.1.m1.2.2.1.1.1.2.3"></times></apply><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.2c">L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.2d">italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))=\nabla_{\theta}L_{\text{dev}}(%
\theta^{*}(\phi))\nabla_{\phi}\theta^{*}(\phi)." class="ltx_Math" display="block" id="A1.E11.m1.4"><semantics id="A1.E11.m1.4a"><mrow id="A1.E11.m1.4.4.1" xref="A1.E11.m1.4.4.1.1.cmml"><mrow id="A1.E11.m1.4.4.1.1" xref="A1.E11.m1.4.4.1.1.cmml"><mrow id="A1.E11.m1.4.4.1.1.1" xref="A1.E11.m1.4.4.1.1.1.cmml"><mrow id="A1.E11.m1.4.4.1.1.1.3" xref="A1.E11.m1.4.4.1.1.1.3.cmml"><msub id="A1.E11.m1.4.4.1.1.1.3.1" xref="A1.E11.m1.4.4.1.1.1.3.1.cmml"><mo id="A1.E11.m1.4.4.1.1.1.3.1.2" xref="A1.E11.m1.4.4.1.1.1.3.1.2.cmml">∇</mo><mi id="A1.E11.m1.4.4.1.1.1.3.1.3" xref="A1.E11.m1.4.4.1.1.1.3.1.3.cmml">ϕ</mi></msub><msub id="A1.E11.m1.4.4.1.1.1.3.2" xref="A1.E11.m1.4.4.1.1.1.3.2.cmml"><mi id="A1.E11.m1.4.4.1.1.1.3.2.2" xref="A1.E11.m1.4.4.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E11.m1.4.4.1.1.1.3.2.3" xref="A1.E11.m1.4.4.1.1.1.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="A1.E11.m1.4.4.1.1.1.2" xref="A1.E11.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.1.1.1.1.1" xref="A1.E11.m1.4.4.1.1.1.1.1.1.cmml"><mo id="A1.E11.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E11.m1.4.4.1.1.1.1.1.1" xref="A1.E11.m1.4.4.1.1.1.1.1.1.cmml"><msup id="A1.E11.m1.4.4.1.1.1.1.1.1.2" xref="A1.E11.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="A1.E11.m1.4.4.1.1.1.1.1.1.2.2" xref="A1.E11.m1.4.4.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="A1.E11.m1.4.4.1.1.1.1.1.1.2.3" xref="A1.E11.m1.4.4.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.E11.m1.4.4.1.1.1.1.1.1.1" xref="A1.E11.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.1.1.1.1.1.1.3.2" xref="A1.E11.m1.4.4.1.1.1.1.1.1.cmml"><mo id="A1.E11.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E11.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E11.m1.1.1" xref="A1.E11.m1.1.1.cmml">ϕ</mi><mo id="A1.E11.m1.4.4.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E11.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.4.4.1.1.3" xref="A1.E11.m1.4.4.1.1.3.cmml">=</mo><mrow id="A1.E11.m1.4.4.1.1.2" xref="A1.E11.m1.4.4.1.1.2.cmml"><mrow id="A1.E11.m1.4.4.1.1.2.3" xref="A1.E11.m1.4.4.1.1.2.3.cmml"><msub id="A1.E11.m1.4.4.1.1.2.3.1" xref="A1.E11.m1.4.4.1.1.2.3.1.cmml"><mo id="A1.E11.m1.4.4.1.1.2.3.1.2" rspace="0.167em" xref="A1.E11.m1.4.4.1.1.2.3.1.2.cmml">∇</mo><mi id="A1.E11.m1.4.4.1.1.2.3.1.3" xref="A1.E11.m1.4.4.1.1.2.3.1.3.cmml">θ</mi></msub><msub id="A1.E11.m1.4.4.1.1.2.3.2" xref="A1.E11.m1.4.4.1.1.2.3.2.cmml"><mi id="A1.E11.m1.4.4.1.1.2.3.2.2" xref="A1.E11.m1.4.4.1.1.2.3.2.2.cmml">L</mi><mtext id="A1.E11.m1.4.4.1.1.2.3.2.3" xref="A1.E11.m1.4.4.1.1.2.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="A1.E11.m1.4.4.1.1.2.2" xref="A1.E11.m1.4.4.1.1.2.2.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.1.1.2.1.1" xref="A1.E11.m1.4.4.1.1.2.1.1.1.cmml"><mo id="A1.E11.m1.4.4.1.1.2.1.1.2" stretchy="false" xref="A1.E11.m1.4.4.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E11.m1.4.4.1.1.2.1.1.1" xref="A1.E11.m1.4.4.1.1.2.1.1.1.cmml"><msup id="A1.E11.m1.4.4.1.1.2.1.1.1.2" xref="A1.E11.m1.4.4.1.1.2.1.1.1.2.cmml"><mi id="A1.E11.m1.4.4.1.1.2.1.1.1.2.2" xref="A1.E11.m1.4.4.1.1.2.1.1.1.2.2.cmml">θ</mi><mo id="A1.E11.m1.4.4.1.1.2.1.1.1.2.3" xref="A1.E11.m1.4.4.1.1.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.E11.m1.4.4.1.1.2.1.1.1.1" xref="A1.E11.m1.4.4.1.1.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.1.1.2.1.1.1.3.2" xref="A1.E11.m1.4.4.1.1.2.1.1.1.cmml"><mo id="A1.E11.m1.4.4.1.1.2.1.1.1.3.2.1" stretchy="false" xref="A1.E11.m1.4.4.1.1.2.1.1.1.cmml">(</mo><mi id="A1.E11.m1.2.2" xref="A1.E11.m1.2.2.cmml">ϕ</mi><mo id="A1.E11.m1.4.4.1.1.2.1.1.1.3.2.2" stretchy="false" xref="A1.E11.m1.4.4.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.4.4.1.1.2.1.1.3" stretchy="false" xref="A1.E11.m1.4.4.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E11.m1.4.4.1.1.2.2a" lspace="0.167em" xref="A1.E11.m1.4.4.1.1.2.2.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.1.1.2.4" xref="A1.E11.m1.4.4.1.1.2.4.cmml"><msub id="A1.E11.m1.4.4.1.1.2.4.1" xref="A1.E11.m1.4.4.1.1.2.4.1.cmml"><mo id="A1.E11.m1.4.4.1.1.2.4.1.2" rspace="0.167em" xref="A1.E11.m1.4.4.1.1.2.4.1.2.cmml">∇</mo><mi id="A1.E11.m1.4.4.1.1.2.4.1.3" xref="A1.E11.m1.4.4.1.1.2.4.1.3.cmml">ϕ</mi></msub><msup id="A1.E11.m1.4.4.1.1.2.4.2" xref="A1.E11.m1.4.4.1.1.2.4.2.cmml"><mi id="A1.E11.m1.4.4.1.1.2.4.2.2" xref="A1.E11.m1.4.4.1.1.2.4.2.2.cmml">θ</mi><mo id="A1.E11.m1.4.4.1.1.2.4.2.3" xref="A1.E11.m1.4.4.1.1.2.4.2.3.cmml">∗</mo></msup></mrow><mo id="A1.E11.m1.4.4.1.1.2.2b" xref="A1.E11.m1.4.4.1.1.2.2.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.1.1.2.5.2" xref="A1.E11.m1.4.4.1.1.2.cmml"><mo id="A1.E11.m1.4.4.1.1.2.5.2.1" stretchy="false" xref="A1.E11.m1.4.4.1.1.2.cmml">(</mo><mi id="A1.E11.m1.3.3" xref="A1.E11.m1.3.3.cmml">ϕ</mi><mo id="A1.E11.m1.4.4.1.1.2.5.2.2" stretchy="false" xref="A1.E11.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E11.m1.4.4.1.2" lspace="0em" xref="A1.E11.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.4b"><apply id="A1.E11.m1.4.4.1.1.cmml" xref="A1.E11.m1.4.4.1"><eq id="A1.E11.m1.4.4.1.1.3.cmml" xref="A1.E11.m1.4.4.1.1.3"></eq><apply id="A1.E11.m1.4.4.1.1.1.cmml" xref="A1.E11.m1.4.4.1.1.1"><times id="A1.E11.m1.4.4.1.1.1.2.cmml" xref="A1.E11.m1.4.4.1.1.1.2"></times><apply id="A1.E11.m1.4.4.1.1.1.3.cmml" xref="A1.E11.m1.4.4.1.1.1.3"><apply id="A1.E11.m1.4.4.1.1.1.3.1.cmml" xref="A1.E11.m1.4.4.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.1.3.1.1.cmml" xref="A1.E11.m1.4.4.1.1.1.3.1">subscript</csymbol><ci id="A1.E11.m1.4.4.1.1.1.3.1.2.cmml" xref="A1.E11.m1.4.4.1.1.1.3.1.2">∇</ci><ci id="A1.E11.m1.4.4.1.1.1.3.1.3.cmml" xref="A1.E11.m1.4.4.1.1.1.3.1.3">italic-ϕ</ci></apply><apply id="A1.E11.m1.4.4.1.1.1.3.2.cmml" xref="A1.E11.m1.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.1.3.2.1.cmml" xref="A1.E11.m1.4.4.1.1.1.3.2">subscript</csymbol><ci id="A1.E11.m1.4.4.1.1.1.3.2.2.cmml" xref="A1.E11.m1.4.4.1.1.1.3.2.2">𝐿</ci><ci id="A1.E11.m1.4.4.1.1.1.3.2.3a.cmml" xref="A1.E11.m1.4.4.1.1.1.3.2.3"><mtext id="A1.E11.m1.4.4.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E11.m1.4.4.1.1.1.3.2.3">dev</mtext></ci></apply></apply><apply id="A1.E11.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.E11.m1.4.4.1.1.1.1.1"><times id="A1.E11.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.4.4.1.1.1.1.1.1.1"></times><apply id="A1.E11.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E11.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.4.4.1.1.1.1.1.1.2.2">𝜃</ci><times id="A1.E11.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="A1.E11.m1.4.4.1.1.1.1.1.1.2.3"></times></apply><ci id="A1.E11.m1.1.1.cmml" xref="A1.E11.m1.1.1">italic-ϕ</ci></apply></apply><apply id="A1.E11.m1.4.4.1.1.2.cmml" xref="A1.E11.m1.4.4.1.1.2"><times id="A1.E11.m1.4.4.1.1.2.2.cmml" xref="A1.E11.m1.4.4.1.1.2.2"></times><apply id="A1.E11.m1.4.4.1.1.2.3.cmml" xref="A1.E11.m1.4.4.1.1.2.3"><apply id="A1.E11.m1.4.4.1.1.2.3.1.cmml" xref="A1.E11.m1.4.4.1.1.2.3.1"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.2.3.1.1.cmml" xref="A1.E11.m1.4.4.1.1.2.3.1">subscript</csymbol><ci id="A1.E11.m1.4.4.1.1.2.3.1.2.cmml" xref="A1.E11.m1.4.4.1.1.2.3.1.2">∇</ci><ci id="A1.E11.m1.4.4.1.1.2.3.1.3.cmml" xref="A1.E11.m1.4.4.1.1.2.3.1.3">𝜃</ci></apply><apply id="A1.E11.m1.4.4.1.1.2.3.2.cmml" xref="A1.E11.m1.4.4.1.1.2.3.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.2.3.2.1.cmml" xref="A1.E11.m1.4.4.1.1.2.3.2">subscript</csymbol><ci id="A1.E11.m1.4.4.1.1.2.3.2.2.cmml" xref="A1.E11.m1.4.4.1.1.2.3.2.2">𝐿</ci><ci id="A1.E11.m1.4.4.1.1.2.3.2.3a.cmml" xref="A1.E11.m1.4.4.1.1.2.3.2.3"><mtext id="A1.E11.m1.4.4.1.1.2.3.2.3.cmml" mathsize="70%" xref="A1.E11.m1.4.4.1.1.2.3.2.3">dev</mtext></ci></apply></apply><apply id="A1.E11.m1.4.4.1.1.2.1.1.1.cmml" xref="A1.E11.m1.4.4.1.1.2.1.1"><times id="A1.E11.m1.4.4.1.1.2.1.1.1.1.cmml" xref="A1.E11.m1.4.4.1.1.2.1.1.1.1"></times><apply id="A1.E11.m1.4.4.1.1.2.1.1.1.2.cmml" xref="A1.E11.m1.4.4.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.2.1.1.1.2.1.cmml" xref="A1.E11.m1.4.4.1.1.2.1.1.1.2">superscript</csymbol><ci id="A1.E11.m1.4.4.1.1.2.1.1.1.2.2.cmml" xref="A1.E11.m1.4.4.1.1.2.1.1.1.2.2">𝜃</ci><times id="A1.E11.m1.4.4.1.1.2.1.1.1.2.3.cmml" xref="A1.E11.m1.4.4.1.1.2.1.1.1.2.3"></times></apply><ci id="A1.E11.m1.2.2.cmml" xref="A1.E11.m1.2.2">italic-ϕ</ci></apply><apply id="A1.E11.m1.4.4.1.1.2.4.cmml" xref="A1.E11.m1.4.4.1.1.2.4"><apply id="A1.E11.m1.4.4.1.1.2.4.1.cmml" xref="A1.E11.m1.4.4.1.1.2.4.1"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.2.4.1.1.cmml" xref="A1.E11.m1.4.4.1.1.2.4.1">subscript</csymbol><ci id="A1.E11.m1.4.4.1.1.2.4.1.2.cmml" xref="A1.E11.m1.4.4.1.1.2.4.1.2">∇</ci><ci id="A1.E11.m1.4.4.1.1.2.4.1.3.cmml" xref="A1.E11.m1.4.4.1.1.2.4.1.3">italic-ϕ</ci></apply><apply id="A1.E11.m1.4.4.1.1.2.4.2.cmml" xref="A1.E11.m1.4.4.1.1.2.4.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.1.1.2.4.2.1.cmml" xref="A1.E11.m1.4.4.1.1.2.4.2">superscript</csymbol><ci id="A1.E11.m1.4.4.1.1.2.4.2.2.cmml" xref="A1.E11.m1.4.4.1.1.2.4.2.2">𝜃</ci><times id="A1.E11.m1.4.4.1.1.2.4.2.3.cmml" xref="A1.E11.m1.4.4.1.1.2.4.2.3"></times></apply></apply><ci id="A1.E11.m1.3.3.cmml" xref="A1.E11.m1.3.3">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.4c">\nabla_{\phi}L_{\text{dev}}(\theta^{*}(\phi))=\nabla_{\theta}L_{\text{dev}}(%
\theta^{*}(\phi))\nabla_{\phi}\theta^{*}(\phi).</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.4d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) ) = ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) ) ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.4">The first term <math alttext="\nabla_{\theta}L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m1.2"><semantics id="A1.SS2.p1.2.m1.2a"><mrow id="A1.SS2.p1.2.m1.2.2" xref="A1.SS2.p1.2.m1.2.2.cmml"><mrow id="A1.SS2.p1.2.m1.2.2.3" xref="A1.SS2.p1.2.m1.2.2.3.cmml"><msub id="A1.SS2.p1.2.m1.2.2.3.1" xref="A1.SS2.p1.2.m1.2.2.3.1.cmml"><mo id="A1.SS2.p1.2.m1.2.2.3.1.2" xref="A1.SS2.p1.2.m1.2.2.3.1.2.cmml">∇</mo><mi id="A1.SS2.p1.2.m1.2.2.3.1.3" xref="A1.SS2.p1.2.m1.2.2.3.1.3.cmml">θ</mi></msub><msub id="A1.SS2.p1.2.m1.2.2.3.2" xref="A1.SS2.p1.2.m1.2.2.3.2.cmml"><mi id="A1.SS2.p1.2.m1.2.2.3.2.2" xref="A1.SS2.p1.2.m1.2.2.3.2.2.cmml">L</mi><mtext id="A1.SS2.p1.2.m1.2.2.3.2.3" xref="A1.SS2.p1.2.m1.2.2.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="A1.SS2.p1.2.m1.2.2.2" xref="A1.SS2.p1.2.m1.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p1.2.m1.2.2.1.1" xref="A1.SS2.p1.2.m1.2.2.1.1.1.cmml"><mo id="A1.SS2.p1.2.m1.2.2.1.1.2" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS2.p1.2.m1.2.2.1.1.1" xref="A1.SS2.p1.2.m1.2.2.1.1.1.cmml"><msup id="A1.SS2.p1.2.m1.2.2.1.1.1.2" xref="A1.SS2.p1.2.m1.2.2.1.1.1.2.cmml"><mi id="A1.SS2.p1.2.m1.2.2.1.1.1.2.2" xref="A1.SS2.p1.2.m1.2.2.1.1.1.2.2.cmml">θ</mi><mo id="A1.SS2.p1.2.m1.2.2.1.1.1.2.3" xref="A1.SS2.p1.2.m1.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.SS2.p1.2.m1.2.2.1.1.1.1" xref="A1.SS2.p1.2.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS2.p1.2.m1.2.2.1.1.1.3.2" xref="A1.SS2.p1.2.m1.2.2.1.1.1.cmml"><mo id="A1.SS2.p1.2.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.1.1.1.cmml">(</mo><mi id="A1.SS2.p1.2.m1.1.1" xref="A1.SS2.p1.2.m1.1.1.cmml">ϕ</mi><mo id="A1.SS2.p1.2.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.2.m1.2.2.1.1.3" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m1.2b"><apply id="A1.SS2.p1.2.m1.2.2.cmml" xref="A1.SS2.p1.2.m1.2.2"><times id="A1.SS2.p1.2.m1.2.2.2.cmml" xref="A1.SS2.p1.2.m1.2.2.2"></times><apply id="A1.SS2.p1.2.m1.2.2.3.cmml" xref="A1.SS2.p1.2.m1.2.2.3"><apply id="A1.SS2.p1.2.m1.2.2.3.1.cmml" xref="A1.SS2.p1.2.m1.2.2.3.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.2.2.3.1.1.cmml" xref="A1.SS2.p1.2.m1.2.2.3.1">subscript</csymbol><ci id="A1.SS2.p1.2.m1.2.2.3.1.2.cmml" xref="A1.SS2.p1.2.m1.2.2.3.1.2">∇</ci><ci id="A1.SS2.p1.2.m1.2.2.3.1.3.cmml" xref="A1.SS2.p1.2.m1.2.2.3.1.3">𝜃</ci></apply><apply id="A1.SS2.p1.2.m1.2.2.3.2.cmml" xref="A1.SS2.p1.2.m1.2.2.3.2"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.2.2.3.2.1.cmml" xref="A1.SS2.p1.2.m1.2.2.3.2">subscript</csymbol><ci id="A1.SS2.p1.2.m1.2.2.3.2.2.cmml" xref="A1.SS2.p1.2.m1.2.2.3.2.2">𝐿</ci><ci id="A1.SS2.p1.2.m1.2.2.3.2.3a.cmml" xref="A1.SS2.p1.2.m1.2.2.3.2.3"><mtext id="A1.SS2.p1.2.m1.2.2.3.2.3.cmml" mathsize="70%" xref="A1.SS2.p1.2.m1.2.2.3.2.3">dev</mtext></ci></apply></apply><apply id="A1.SS2.p1.2.m1.2.2.1.1.1.cmml" xref="A1.SS2.p1.2.m1.2.2.1.1"><times id="A1.SS2.p1.2.m1.2.2.1.1.1.1.cmml" xref="A1.SS2.p1.2.m1.2.2.1.1.1.1"></times><apply id="A1.SS2.p1.2.m1.2.2.1.1.1.2.cmml" xref="A1.SS2.p1.2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.2.2.1.1.1.2.1.cmml" xref="A1.SS2.p1.2.m1.2.2.1.1.1.2">superscript</csymbol><ci id="A1.SS2.p1.2.m1.2.2.1.1.1.2.2.cmml" xref="A1.SS2.p1.2.m1.2.2.1.1.1.2.2">𝜃</ci><times id="A1.SS2.p1.2.m1.2.2.1.1.1.2.3.cmml" xref="A1.SS2.p1.2.m1.2.2.1.1.1.2.3"></times></apply><ci id="A1.SS2.p1.2.m1.1.1.cmml" xref="A1.SS2.p1.2.m1.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m1.2c">\nabla_{\theta}L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m1.2d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math> can be obtained with automatic differentiation (autograd) tools. As for the second term, we notice that <math alttext="\theta^{*}(\phi)" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m2.1"><semantics id="A1.SS2.p1.3.m2.1a"><mrow id="A1.SS2.p1.3.m2.1.2" xref="A1.SS2.p1.3.m2.1.2.cmml"><msup id="A1.SS2.p1.3.m2.1.2.2" xref="A1.SS2.p1.3.m2.1.2.2.cmml"><mi id="A1.SS2.p1.3.m2.1.2.2.2" xref="A1.SS2.p1.3.m2.1.2.2.2.cmml">θ</mi><mo id="A1.SS2.p1.3.m2.1.2.2.3" xref="A1.SS2.p1.3.m2.1.2.2.3.cmml">∗</mo></msup><mo id="A1.SS2.p1.3.m2.1.2.1" xref="A1.SS2.p1.3.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.p1.3.m2.1.2.3.2" xref="A1.SS2.p1.3.m2.1.2.cmml"><mo id="A1.SS2.p1.3.m2.1.2.3.2.1" stretchy="false" xref="A1.SS2.p1.3.m2.1.2.cmml">(</mo><mi id="A1.SS2.p1.3.m2.1.1" xref="A1.SS2.p1.3.m2.1.1.cmml">ϕ</mi><mo id="A1.SS2.p1.3.m2.1.2.3.2.2" stretchy="false" xref="A1.SS2.p1.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m2.1b"><apply id="A1.SS2.p1.3.m2.1.2.cmml" xref="A1.SS2.p1.3.m2.1.2"><times id="A1.SS2.p1.3.m2.1.2.1.cmml" xref="A1.SS2.p1.3.m2.1.2.1"></times><apply id="A1.SS2.p1.3.m2.1.2.2.cmml" xref="A1.SS2.p1.3.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p1.3.m2.1.2.2.1.cmml" xref="A1.SS2.p1.3.m2.1.2.2">superscript</csymbol><ci id="A1.SS2.p1.3.m2.1.2.2.2.cmml" xref="A1.SS2.p1.3.m2.1.2.2.2">𝜃</ci><times id="A1.SS2.p1.3.m2.1.2.2.3.cmml" xref="A1.SS2.p1.3.m2.1.2.2.3"></times></apply><ci id="A1.SS2.p1.3.m2.1.1.cmml" xref="A1.SS2.p1.3.m2.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m2.1c">\theta^{*}(\phi)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m2.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ )</annotation></semantics></math> is the optimal point of <math alttext="L_{\text{train}}(\theta;\phi)" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m3.2"><semantics id="A1.SS2.p1.4.m3.2a"><mrow id="A1.SS2.p1.4.m3.2.3" xref="A1.SS2.p1.4.m3.2.3.cmml"><msub id="A1.SS2.p1.4.m3.2.3.2" xref="A1.SS2.p1.4.m3.2.3.2.cmml"><mi id="A1.SS2.p1.4.m3.2.3.2.2" xref="A1.SS2.p1.4.m3.2.3.2.2.cmml">L</mi><mtext id="A1.SS2.p1.4.m3.2.3.2.3" xref="A1.SS2.p1.4.m3.2.3.2.3a.cmml">train</mtext></msub><mo id="A1.SS2.p1.4.m3.2.3.1" xref="A1.SS2.p1.4.m3.2.3.1.cmml">⁢</mo><mrow id="A1.SS2.p1.4.m3.2.3.3.2" xref="A1.SS2.p1.4.m3.2.3.3.1.cmml"><mo id="A1.SS2.p1.4.m3.2.3.3.2.1" stretchy="false" xref="A1.SS2.p1.4.m3.2.3.3.1.cmml">(</mo><mi id="A1.SS2.p1.4.m3.1.1" xref="A1.SS2.p1.4.m3.1.1.cmml">θ</mi><mo id="A1.SS2.p1.4.m3.2.3.3.2.2" xref="A1.SS2.p1.4.m3.2.3.3.1.cmml">;</mo><mi id="A1.SS2.p1.4.m3.2.2" xref="A1.SS2.p1.4.m3.2.2.cmml">ϕ</mi><mo id="A1.SS2.p1.4.m3.2.3.3.2.3" stretchy="false" xref="A1.SS2.p1.4.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m3.2b"><apply id="A1.SS2.p1.4.m3.2.3.cmml" xref="A1.SS2.p1.4.m3.2.3"><times id="A1.SS2.p1.4.m3.2.3.1.cmml" xref="A1.SS2.p1.4.m3.2.3.1"></times><apply id="A1.SS2.p1.4.m3.2.3.2.cmml" xref="A1.SS2.p1.4.m3.2.3.2"><csymbol cd="ambiguous" id="A1.SS2.p1.4.m3.2.3.2.1.cmml" xref="A1.SS2.p1.4.m3.2.3.2">subscript</csymbol><ci id="A1.SS2.p1.4.m3.2.3.2.2.cmml" xref="A1.SS2.p1.4.m3.2.3.2.2">𝐿</ci><ci id="A1.SS2.p1.4.m3.2.3.2.3a.cmml" xref="A1.SS2.p1.4.m3.2.3.2.3"><mtext id="A1.SS2.p1.4.m3.2.3.2.3.cmml" mathsize="70%" xref="A1.SS2.p1.4.m3.2.3.2.3">train</mtext></ci></apply><list id="A1.SS2.p1.4.m3.2.3.3.1.cmml" xref="A1.SS2.p1.4.m3.2.3.3.2"><ci id="A1.SS2.p1.4.m3.1.1.cmml" xref="A1.SS2.p1.4.m3.1.1">𝜃</ci><ci id="A1.SS2.p1.4.m3.2.2.cmml" xref="A1.SS2.p1.4.m3.2.2">italic-ϕ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m3.2c">L_{\text{train}}(\theta;\phi)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m3.2d">italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ ; italic_ϕ )</annotation></semantics></math>, so we have:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\theta}L_{\text{train}}(\theta^{*}(\phi),\phi)=0." class="ltx_Math" display="block" id="A1.E12.m1.3"><semantics id="A1.E12.m1.3a"><mrow id="A1.E12.m1.3.3.1" xref="A1.E12.m1.3.3.1.1.cmml"><mrow id="A1.E12.m1.3.3.1.1" xref="A1.E12.m1.3.3.1.1.cmml"><mrow id="A1.E12.m1.3.3.1.1.1" xref="A1.E12.m1.3.3.1.1.1.cmml"><mrow id="A1.E12.m1.3.3.1.1.1.3" xref="A1.E12.m1.3.3.1.1.1.3.cmml"><msub id="A1.E12.m1.3.3.1.1.1.3.1" xref="A1.E12.m1.3.3.1.1.1.3.1.cmml"><mo id="A1.E12.m1.3.3.1.1.1.3.1.2" xref="A1.E12.m1.3.3.1.1.1.3.1.2.cmml">∇</mo><mi id="A1.E12.m1.3.3.1.1.1.3.1.3" xref="A1.E12.m1.3.3.1.1.1.3.1.3.cmml">θ</mi></msub><msub id="A1.E12.m1.3.3.1.1.1.3.2" xref="A1.E12.m1.3.3.1.1.1.3.2.cmml"><mi id="A1.E12.m1.3.3.1.1.1.3.2.2" xref="A1.E12.m1.3.3.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E12.m1.3.3.1.1.1.3.2.3" xref="A1.E12.m1.3.3.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow><mo id="A1.E12.m1.3.3.1.1.1.2" xref="A1.E12.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.3.3.1.1.1.1.1" xref="A1.E12.m1.3.3.1.1.1.1.2.cmml"><mo id="A1.E12.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.3.3.1.1.1.1.2.cmml">(</mo><mrow id="A1.E12.m1.3.3.1.1.1.1.1.1" xref="A1.E12.m1.3.3.1.1.1.1.1.1.cmml"><msup id="A1.E12.m1.3.3.1.1.1.1.1.1.2" xref="A1.E12.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="A1.E12.m1.3.3.1.1.1.1.1.1.2.2" xref="A1.E12.m1.3.3.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="A1.E12.m1.3.3.1.1.1.1.1.1.2.3" xref="A1.E12.m1.3.3.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.E12.m1.3.3.1.1.1.1.1.1.1" xref="A1.E12.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E12.m1.3.3.1.1.1.1.1.1.3.2" xref="A1.E12.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E12.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1.cmml">ϕ</mi><mo id="A1.E12.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E12.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.3.3.1.1.1.1.1.3" xref="A1.E12.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="A1.E12.m1.2.2" xref="A1.E12.m1.2.2.cmml">ϕ</mi><mo id="A1.E12.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="A1.E12.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.3.3.1.1.2" xref="A1.E12.m1.3.3.1.1.2.cmml">=</mo><mn id="A1.E12.m1.3.3.1.1.3" xref="A1.E12.m1.3.3.1.1.3.cmml">0</mn></mrow><mo id="A1.E12.m1.3.3.1.2" lspace="0em" xref="A1.E12.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.3b"><apply id="A1.E12.m1.3.3.1.1.cmml" xref="A1.E12.m1.3.3.1"><eq id="A1.E12.m1.3.3.1.1.2.cmml" xref="A1.E12.m1.3.3.1.1.2"></eq><apply id="A1.E12.m1.3.3.1.1.1.cmml" xref="A1.E12.m1.3.3.1.1.1"><times id="A1.E12.m1.3.3.1.1.1.2.cmml" xref="A1.E12.m1.3.3.1.1.1.2"></times><apply id="A1.E12.m1.3.3.1.1.1.3.cmml" xref="A1.E12.m1.3.3.1.1.1.3"><apply id="A1.E12.m1.3.3.1.1.1.3.1.cmml" xref="A1.E12.m1.3.3.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.1.1.1.3.1.1.cmml" xref="A1.E12.m1.3.3.1.1.1.3.1">subscript</csymbol><ci id="A1.E12.m1.3.3.1.1.1.3.1.2.cmml" xref="A1.E12.m1.3.3.1.1.1.3.1.2">∇</ci><ci id="A1.E12.m1.3.3.1.1.1.3.1.3.cmml" xref="A1.E12.m1.3.3.1.1.1.3.1.3">𝜃</ci></apply><apply id="A1.E12.m1.3.3.1.1.1.3.2.cmml" xref="A1.E12.m1.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.1.1.1.3.2.1.cmml" xref="A1.E12.m1.3.3.1.1.1.3.2">subscript</csymbol><ci id="A1.E12.m1.3.3.1.1.1.3.2.2.cmml" xref="A1.E12.m1.3.3.1.1.1.3.2.2">𝐿</ci><ci id="A1.E12.m1.3.3.1.1.1.3.2.3a.cmml" xref="A1.E12.m1.3.3.1.1.1.3.2.3"><mtext id="A1.E12.m1.3.3.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E12.m1.3.3.1.1.1.3.2.3">train</mtext></ci></apply></apply><interval closure="open" id="A1.E12.m1.3.3.1.1.1.1.2.cmml" xref="A1.E12.m1.3.3.1.1.1.1.1"><apply id="A1.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E12.m1.3.3.1.1.1.1.1.1"><times id="A1.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.3.3.1.1.1.1.1.1.1"></times><apply id="A1.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E12.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.3.3.1.1.1.1.1.1.2.2">𝜃</ci><times id="A1.E12.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.3.3.1.1.1.1.1.1.2.3"></times></apply><ci id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1">italic-ϕ</ci></apply><ci id="A1.E12.m1.2.2.cmml" xref="A1.E12.m1.2.2">italic-ϕ</ci></interval></apply><cn id="A1.E12.m1.3.3.1.1.3.cmml" type="integer" xref="A1.E12.m1.3.3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.3c">\nabla_{\theta}L_{\text{train}}(\theta^{*}(\phi),\phi)=0.</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.3d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) , italic_ϕ ) = 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.5">Then, we calculate the gradient with respect to <math alttext="\phi" class="ltx_Math" display="inline" id="A1.SS2.p1.5.m1.1"><semantics id="A1.SS2.p1.5.m1.1a"><mi id="A1.SS2.p1.5.m1.1.1" xref="A1.SS2.p1.5.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m1.1b"><ci id="A1.SS2.p1.5.m1.1.1.cmml" xref="A1.SS2.p1.5.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.5.m1.1d">italic_ϕ</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.E12" title="In A.2. Detailed Derivations of Equation 10 ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">12</span></a>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}(\phi),\phi)\nabla_{\phi}\theta^%
{*}(\phi)+\nabla_{\phi}\nabla_{\theta}L_{\text{train}}(\theta^{*}(\phi),\phi)=0," class="ltx_Math" display="block" id="A1.E13.m1.6"><semantics id="A1.E13.m1.6a"><mrow id="A1.E13.m1.6.6.1" xref="A1.E13.m1.6.6.1.1.cmml"><mrow id="A1.E13.m1.6.6.1.1" xref="A1.E13.m1.6.6.1.1.cmml"><mrow id="A1.E13.m1.6.6.1.1.2" xref="A1.E13.m1.6.6.1.1.2.cmml"><mrow id="A1.E13.m1.6.6.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.cmml"><mrow id="A1.E13.m1.6.6.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.3.cmml"><msubsup id="A1.E13.m1.6.6.1.1.1.1.3.1" xref="A1.E13.m1.6.6.1.1.1.1.3.1.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.3.1.2.2" xref="A1.E13.m1.6.6.1.1.1.1.3.1.2.2.cmml">∇</mo><mi id="A1.E13.m1.6.6.1.1.1.1.3.1.2.3" xref="A1.E13.m1.6.6.1.1.1.1.3.1.2.3.cmml">θ</mi><mn id="A1.E13.m1.6.6.1.1.1.1.3.1.3" xref="A1.E13.m1.6.6.1.1.1.1.3.1.3.cmml">2</mn></msubsup><msub id="A1.E13.m1.6.6.1.1.1.1.3.2" xref="A1.E13.m1.6.6.1.1.1.1.3.2.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.3.2.2" xref="A1.E13.m1.6.6.1.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E13.m1.6.6.1.1.1.1.3.2.3" xref="A1.E13.m1.6.6.1.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.2.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.cmml"><msup id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1.3.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E13.m1.1.1" xref="A1.E13.m1.1.1.cmml">ϕ</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.2.cmml">,</mo><mi id="A1.E13.m1.2.2" xref="A1.E13.m1.2.2.cmml">ϕ</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.4" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.2.cmml">)</mo></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.2a" lspace="0.167em" xref="A1.E13.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.4" xref="A1.E13.m1.6.6.1.1.1.1.4.cmml"><msub id="A1.E13.m1.6.6.1.1.1.1.4.1" xref="A1.E13.m1.6.6.1.1.1.1.4.1.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.4.1.2" rspace="0.167em" xref="A1.E13.m1.6.6.1.1.1.1.4.1.2.cmml">∇</mo><mi id="A1.E13.m1.6.6.1.1.1.1.4.1.3" xref="A1.E13.m1.6.6.1.1.1.1.4.1.3.cmml">ϕ</mi></msub><msup id="A1.E13.m1.6.6.1.1.1.1.4.2" xref="A1.E13.m1.6.6.1.1.1.1.4.2.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.4.2.2" xref="A1.E13.m1.6.6.1.1.1.1.4.2.2.cmml">θ</mi><mo id="A1.E13.m1.6.6.1.1.1.1.4.2.3" xref="A1.E13.m1.6.6.1.1.1.1.4.2.3.cmml">∗</mo></msup></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.2b" xref="A1.E13.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.5.2" xref="A1.E13.m1.6.6.1.1.1.1.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.5.2.1" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.cmml">(</mo><mi id="A1.E13.m1.3.3" xref="A1.E13.m1.3.3.cmml">ϕ</mi><mo id="A1.E13.m1.6.6.1.1.1.1.5.2.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.2.3" xref="A1.E13.m1.6.6.1.1.2.3.cmml">+</mo><mrow id="A1.E13.m1.6.6.1.1.2.2" xref="A1.E13.m1.6.6.1.1.2.2.cmml"><mrow id="A1.E13.m1.6.6.1.1.2.2.3" xref="A1.E13.m1.6.6.1.1.2.2.3.cmml"><mrow id="A1.E13.m1.6.6.1.1.2.2.3.1" xref="A1.E13.m1.6.6.1.1.2.2.3.1.cmml"><msub id="A1.E13.m1.6.6.1.1.2.2.3.1.1" xref="A1.E13.m1.6.6.1.1.2.2.3.1.1.cmml"><mo id="A1.E13.m1.6.6.1.1.2.2.3.1.1.2" rspace="0.167em" xref="A1.E13.m1.6.6.1.1.2.2.3.1.1.2.cmml">∇</mo><mi id="A1.E13.m1.6.6.1.1.2.2.3.1.1.3" xref="A1.E13.m1.6.6.1.1.2.2.3.1.1.3.cmml">ϕ</mi></msub><msub id="A1.E13.m1.6.6.1.1.2.2.3.1.2" xref="A1.E13.m1.6.6.1.1.2.2.3.1.2.cmml"><mo id="A1.E13.m1.6.6.1.1.2.2.3.1.2.2" xref="A1.E13.m1.6.6.1.1.2.2.3.1.2.2.cmml">∇</mo><mi id="A1.E13.m1.6.6.1.1.2.2.3.1.2.3" xref="A1.E13.m1.6.6.1.1.2.2.3.1.2.3.cmml">θ</mi></msub></mrow><mo id="A1.E13.m1.6.6.1.1.2.2.3a" lspace="0.167em" xref="A1.E13.m1.6.6.1.1.2.2.3.cmml">⁡</mo><msub id="A1.E13.m1.6.6.1.1.2.2.3.2" xref="A1.E13.m1.6.6.1.1.2.2.3.2.cmml"><mi id="A1.E13.m1.6.6.1.1.2.2.3.2.2" xref="A1.E13.m1.6.6.1.1.2.2.3.2.2.cmml">L</mi><mtext id="A1.E13.m1.6.6.1.1.2.2.3.2.3" xref="A1.E13.m1.6.6.1.1.2.2.3.2.3a.cmml">train</mtext></msub></mrow><mo id="A1.E13.m1.6.6.1.1.2.2.2" xref="A1.E13.m1.6.6.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.2.2.1.1" xref="A1.E13.m1.6.6.1.1.2.2.1.2.cmml"><mo id="A1.E13.m1.6.6.1.1.2.2.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.2.2.1.2.cmml">(</mo><mrow id="A1.E13.m1.6.6.1.1.2.2.1.1.1" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml"><msup id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.cmml"><mi id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2.cmml">θ</mi><mo id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.E13.m1.6.6.1.1.2.2.1.1.1.1" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.2.2.1.1.1.3.2" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml"><mo id="A1.E13.m1.6.6.1.1.2.2.1.1.1.3.2.1" stretchy="false" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml">(</mo><mi id="A1.E13.m1.4.4" xref="A1.E13.m1.4.4.cmml">ϕ</mi><mo id="A1.E13.m1.6.6.1.1.2.2.1.1.1.3.2.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.2.2.1.1.3" xref="A1.E13.m1.6.6.1.1.2.2.1.2.cmml">,</mo><mi id="A1.E13.m1.5.5" xref="A1.E13.m1.5.5.cmml">ϕ</mi><mo id="A1.E13.m1.6.6.1.1.2.2.1.1.4" stretchy="false" xref="A1.E13.m1.6.6.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.3" xref="A1.E13.m1.6.6.1.1.3.cmml">=</mo><mn id="A1.E13.m1.6.6.1.1.4" xref="A1.E13.m1.6.6.1.1.4.cmml">0</mn></mrow><mo id="A1.E13.m1.6.6.1.2" xref="A1.E13.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.6b"><apply id="A1.E13.m1.6.6.1.1.cmml" xref="A1.E13.m1.6.6.1"><eq id="A1.E13.m1.6.6.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.3"></eq><apply id="A1.E13.m1.6.6.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2"><plus id="A1.E13.m1.6.6.1.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.2.3"></plus><apply id="A1.E13.m1.6.6.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1"><times id="A1.E13.m1.6.6.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.2"></times><apply id="A1.E13.m1.6.6.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3"><apply id="A1.E13.m1.6.6.1.1.1.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.3.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.1">superscript</csymbol><apply id="A1.E13.m1.6.6.1.1.1.1.3.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.3.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.1">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.3.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.1.2.2">∇</ci><ci id="A1.E13.m1.6.6.1.1.1.1.3.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.1.2.3">𝜃</ci></apply><cn id="A1.E13.m1.6.6.1.1.1.1.3.1.3.cmml" type="integer" xref="A1.E13.m1.6.6.1.1.1.1.3.1.3">2</cn></apply><apply id="A1.E13.m1.6.6.1.1.1.1.3.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.3.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.3.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.2.2">𝐿</ci><ci id="A1.E13.m1.6.6.1.1.1.1.3.2.3a.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.2.3"><mtext id="A1.E13.m1.6.6.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E13.m1.6.6.1.1.1.1.3.2.3">train</mtext></ci></apply></apply><interval closure="open" id="A1.E13.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1"><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1"><times id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1"></times><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.2">𝜃</ci><times id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.3"></times></apply><ci id="A1.E13.m1.1.1.cmml" xref="A1.E13.m1.1.1">italic-ϕ</ci></apply><ci id="A1.E13.m1.2.2.cmml" xref="A1.E13.m1.2.2">italic-ϕ</ci></interval><apply id="A1.E13.m1.6.6.1.1.1.1.4.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4"><apply id="A1.E13.m1.6.6.1.1.1.1.4.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.1"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.4.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.1">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.4.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.1.2">∇</ci><ci id="A1.E13.m1.6.6.1.1.1.1.4.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.1.3">italic-ϕ</ci></apply><apply id="A1.E13.m1.6.6.1.1.1.1.4.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.4.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.2">superscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.4.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.2.2">𝜃</ci><times id="A1.E13.m1.6.6.1.1.1.1.4.2.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.4.2.3"></times></apply></apply><ci id="A1.E13.m1.3.3.cmml" xref="A1.E13.m1.3.3">italic-ϕ</ci></apply><apply id="A1.E13.m1.6.6.1.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2"><times id="A1.E13.m1.6.6.1.1.2.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.2"></times><apply id="A1.E13.m1.6.6.1.1.2.2.3.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3"><apply id="A1.E13.m1.6.6.1.1.2.2.3.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1"><apply id="A1.E13.m1.6.6.1.1.2.2.3.1.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.1"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.2.2.3.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.1">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.2.2.3.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.1.2">∇</ci><ci id="A1.E13.m1.6.6.1.1.2.2.3.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.1.3">italic-ϕ</ci></apply><apply id="A1.E13.m1.6.6.1.1.2.2.3.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.2.2.3.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.2">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.2.2.3.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.2.2">∇</ci><ci id="A1.E13.m1.6.6.1.1.2.2.3.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.1.2.3">𝜃</ci></apply></apply><apply id="A1.E13.m1.6.6.1.1.2.2.3.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.2.2.3.2.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.2">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.2.2.3.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.2.2">𝐿</ci><ci id="A1.E13.m1.6.6.1.1.2.2.3.2.3a.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3.2.3"><mtext id="A1.E13.m1.6.6.1.1.2.2.3.2.3.cmml" mathsize="70%" xref="A1.E13.m1.6.6.1.1.2.2.3.2.3">train</mtext></ci></apply></apply><interval closure="open" id="A1.E13.m1.6.6.1.1.2.2.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1"><apply id="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1"><times id="A1.E13.m1.6.6.1.1.2.2.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.1"></times><apply id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2">superscript</csymbol><ci id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2">𝜃</ci><times id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3"></times></apply><ci id="A1.E13.m1.4.4.cmml" xref="A1.E13.m1.4.4">italic-ϕ</ci></apply><ci id="A1.E13.m1.5.5.cmml" xref="A1.E13.m1.5.5">italic-ϕ</ci></interval></apply></apply><cn id="A1.E13.m1.6.6.1.1.4.cmml" type="integer" xref="A1.E13.m1.6.6.1.1.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.6c">\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}(\phi),\phi)\nabla_{\phi}\theta^%
{*}(\phi)+\nabla_{\phi}\nabla_{\theta}L_{\text{train}}(\theta^{*}(\phi),\phi)=0,</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.6d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) , italic_ϕ ) ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) + ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) , italic_ϕ ) = 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.9">which leads to:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\phi}\theta^{*}(\phi)=-(\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}%
(\phi),\phi))^{-1}\cdot\nabla_{\phi}\nabla_{\theta}L_{\text{train}}(\theta^{*}%
(\phi),\phi)," class="ltx_Math" display="block" id="A1.E14.m1.6"><semantics id="A1.E14.m1.6a"><mrow id="A1.E14.m1.6.6.1" xref="A1.E14.m1.6.6.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1" xref="A1.E14.m1.6.6.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1.4" xref="A1.E14.m1.6.6.1.1.4.cmml"><mrow id="A1.E14.m1.6.6.1.1.4.2" xref="A1.E14.m1.6.6.1.1.4.2.cmml"><msub id="A1.E14.m1.6.6.1.1.4.2.1" xref="A1.E14.m1.6.6.1.1.4.2.1.cmml"><mo id="A1.E14.m1.6.6.1.1.4.2.1.2" xref="A1.E14.m1.6.6.1.1.4.2.1.2.cmml">∇</mo><mi id="A1.E14.m1.6.6.1.1.4.2.1.3" xref="A1.E14.m1.6.6.1.1.4.2.1.3.cmml">ϕ</mi></msub><msup id="A1.E14.m1.6.6.1.1.4.2.2" xref="A1.E14.m1.6.6.1.1.4.2.2.cmml"><mi id="A1.E14.m1.6.6.1.1.4.2.2.2" xref="A1.E14.m1.6.6.1.1.4.2.2.2.cmml">θ</mi><mo id="A1.E14.m1.6.6.1.1.4.2.2.3" xref="A1.E14.m1.6.6.1.1.4.2.2.3.cmml">∗</mo></msup></mrow><mo id="A1.E14.m1.6.6.1.1.4.1" xref="A1.E14.m1.6.6.1.1.4.1.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.4.3.2" xref="A1.E14.m1.6.6.1.1.4.cmml"><mo id="A1.E14.m1.6.6.1.1.4.3.2.1" stretchy="false" xref="A1.E14.m1.6.6.1.1.4.cmml">(</mo><mi id="A1.E14.m1.1.1" xref="A1.E14.m1.1.1.cmml">ϕ</mi><mo id="A1.E14.m1.6.6.1.1.4.3.2.2" stretchy="false" xref="A1.E14.m1.6.6.1.1.4.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.3" xref="A1.E14.m1.6.6.1.1.3.cmml">=</mo><mrow id="A1.E14.m1.6.6.1.1.2" xref="A1.E14.m1.6.6.1.1.2.cmml"><mo id="A1.E14.m1.6.6.1.1.2a" xref="A1.E14.m1.6.6.1.1.2.cmml">−</mo><mrow id="A1.E14.m1.6.6.1.1.2.2" xref="A1.E14.m1.6.6.1.1.2.2.cmml"><mrow id="A1.E14.m1.6.6.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.cmml"><msup id="A1.E14.m1.6.6.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.2" rspace="0.167em" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∇</mo><mi id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.3" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml">θ</mi><mn id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.3" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.3.cmml">2</mn></msubsup><msub id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E14.m1.2.2" xref="A1.E14.m1.2.2.cmml">ϕ</mi><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="A1.E14.m1.3.3" xref="A1.E14.m1.3.3.cmml">ϕ</mi><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A1.E14.m1.6.6.1.1.1.1.1.1.3" xref="A1.E14.m1.6.6.1.1.1.1.1.1.3.cmml"><mo id="A1.E14.m1.6.6.1.1.1.1.1.1.3a" xref="A1.E14.m1.6.6.1.1.1.1.1.1.3.cmml">−</mo><mn id="A1.E14.m1.6.6.1.1.1.1.1.1.3.2" xref="A1.E14.m1.6.6.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="A1.E14.m1.6.6.1.1.1.1.1.2" rspace="0.222em" xref="A1.E14.m1.6.6.1.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.E14.m1.6.6.1.1.1.1.1.3" xref="A1.E14.m1.6.6.1.1.1.1.1.3.cmml"><mrow id="A1.E14.m1.6.6.1.1.1.1.1.3.1" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.cmml"><msub id="A1.E14.m1.6.6.1.1.1.1.1.3.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.cmml"><mo id="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.2" rspace="0.167em" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.2.cmml">∇</mo><mi id="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.3" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.3.cmml">ϕ</mi></msub><msub id="A1.E14.m1.6.6.1.1.1.1.1.3.1.2" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.cmml"><mo id="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.2" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.2.cmml">∇</mo><mi id="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.3" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.3.cmml">θ</mi></msub></mrow><mo id="A1.E14.m1.6.6.1.1.1.1.1.3a" lspace="0.167em" xref="A1.E14.m1.6.6.1.1.1.1.1.3.cmml">⁡</mo><msub id="A1.E14.m1.6.6.1.1.1.1.1.3.2" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2.cmml"><mi id="A1.E14.m1.6.6.1.1.1.1.1.3.2.2" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E14.m1.6.6.1.1.1.1.1.3.2.3" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.2.2.3" xref="A1.E14.m1.6.6.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1" xref="A1.E14.m1.6.6.1.1.2.2.2.2.cmml"><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.2" stretchy="false" xref="A1.E14.m1.6.6.1.1.2.2.2.2.cmml">(</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.cmml"><msup id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.cmml"><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.cmml">θ</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3.cmml">∗</mo></msup><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.3.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.cmml"><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.3.2.1" stretchy="false" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.cmml">(</mo><mi id="A1.E14.m1.4.4" xref="A1.E14.m1.4.4.cmml">ϕ</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.3.2.2" stretchy="false" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.3" xref="A1.E14.m1.6.6.1.1.2.2.2.2.cmml">,</mo><mi id="A1.E14.m1.5.5" xref="A1.E14.m1.5.5.cmml">ϕ</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.4" stretchy="false" xref="A1.E14.m1.6.6.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E14.m1.6.6.1.2" xref="A1.E14.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.6b"><apply id="A1.E14.m1.6.6.1.1.cmml" xref="A1.E14.m1.6.6.1"><eq id="A1.E14.m1.6.6.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.3"></eq><apply id="A1.E14.m1.6.6.1.1.4.cmml" xref="A1.E14.m1.6.6.1.1.4"><times id="A1.E14.m1.6.6.1.1.4.1.cmml" xref="A1.E14.m1.6.6.1.1.4.1"></times><apply id="A1.E14.m1.6.6.1.1.4.2.cmml" xref="A1.E14.m1.6.6.1.1.4.2"><apply id="A1.E14.m1.6.6.1.1.4.2.1.cmml" xref="A1.E14.m1.6.6.1.1.4.2.1"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.4.2.1.1.cmml" xref="A1.E14.m1.6.6.1.1.4.2.1">subscript</csymbol><ci id="A1.E14.m1.6.6.1.1.4.2.1.2.cmml" xref="A1.E14.m1.6.6.1.1.4.2.1.2">∇</ci><ci id="A1.E14.m1.6.6.1.1.4.2.1.3.cmml" xref="A1.E14.m1.6.6.1.1.4.2.1.3">italic-ϕ</ci></apply><apply id="A1.E14.m1.6.6.1.1.4.2.2.cmml" xref="A1.E14.m1.6.6.1.1.4.2.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.4.2.2.1.cmml" xref="A1.E14.m1.6.6.1.1.4.2.2">superscript</csymbol><ci id="A1.E14.m1.6.6.1.1.4.2.2.2.cmml" xref="A1.E14.m1.6.6.1.1.4.2.2.2">𝜃</ci><times id="A1.E14.m1.6.6.1.1.4.2.2.3.cmml" xref="A1.E14.m1.6.6.1.1.4.2.2.3"></times></apply></apply><ci id="A1.E14.m1.1.1.cmml" xref="A1.E14.m1.1.1">italic-ϕ</ci></apply><apply id="A1.E14.m1.6.6.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2"><minus id="A1.E14.m1.6.6.1.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.2"></minus><apply id="A1.E14.m1.6.6.1.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2"><times id="A1.E14.m1.6.6.1.1.2.2.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.3"></times><apply id="A1.E14.m1.6.6.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1"><ci id="A1.E14.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.2">⋅</ci><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1"><times id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3"><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.2">∇</ci><ci id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.2.3">𝜃</ci></apply><cn id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.3.cmml" type="integer" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.3">2</cn></apply><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3">train</mtext></ci></apply></apply><interval closure="open" id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><times id="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3"></times></apply><ci id="A1.E14.m1.2.2.cmml" xref="A1.E14.m1.2.2">italic-ϕ</ci></apply><ci id="A1.E14.m1.3.3.cmml" xref="A1.E14.m1.3.3">italic-ϕ</ci></interval></apply><apply id="A1.E14.m1.6.6.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.3"><minus id="A1.E14.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.1.3"></minus><cn id="A1.E14.m1.6.6.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.E14.m1.6.6.1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="A1.E14.m1.6.6.1.1.1.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3"><apply id="A1.E14.m1.6.6.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1"><apply id="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.2">∇</ci><ci id="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.1.3">italic-ϕ</ci></apply><apply id="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.2">subscript</csymbol><ci id="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.2">∇</ci><ci id="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.1.2.3">𝜃</ci></apply></apply><apply id="A1.E14.m1.6.6.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E14.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2.2">𝐿</ci><ci id="A1.E14.m1.6.6.1.1.1.1.1.3.2.3a.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2.3"><mtext id="A1.E14.m1.6.6.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E14.m1.6.6.1.1.1.1.1.3.2.3">train</mtext></ci></apply></apply></apply><interval closure="open" id="A1.E14.m1.6.6.1.1.2.2.2.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1"><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1"><times id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1"></times><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2">superscript</csymbol><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2">𝜃</ci><times id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3"></times></apply><ci id="A1.E14.m1.4.4.cmml" xref="A1.E14.m1.4.4">italic-ϕ</ci></apply><ci id="A1.E14.m1.5.5.cmml" xref="A1.E14.m1.5.5">italic-ϕ</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.6c">\nabla_{\phi}\theta^{*}(\phi)=-(\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}%
(\phi),\phi))^{-1}\cdot\nabla_{\phi}\nabla_{\theta}L_{\text{train}}(\theta^{*}%
(\phi),\phi),</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.6d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) = - ( ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) , italic_ϕ ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ⋅ ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) , italic_ϕ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.7">where the Hessian inverse <math alttext="(\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}(\phi),\phi))^{-1}" class="ltx_Math" display="inline" id="A1.SS2.p1.6.m1.3"><semantics id="A1.SS2.p1.6.m1.3a"><msup id="A1.SS2.p1.6.m1.3.3" xref="A1.SS2.p1.6.m1.3.3.cmml"><mrow id="A1.SS2.p1.6.m1.3.3.1.1" xref="A1.SS2.p1.6.m1.3.3.1.1.1.cmml"><mo id="A1.SS2.p1.6.m1.3.3.1.1.2" stretchy="false" xref="A1.SS2.p1.6.m1.3.3.1.1.1.cmml">(</mo><mrow id="A1.SS2.p1.6.m1.3.3.1.1.1" xref="A1.SS2.p1.6.m1.3.3.1.1.1.cmml"><mrow id="A1.SS2.p1.6.m1.3.3.1.1.1.3" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.cmml"><msubsup id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.cmml"><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.2" rspace="0.167em" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.2.cmml">∇</mo><mi id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.3" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.3.cmml">θ</mi><mn id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.3" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.3.cmml">2</mn></msubsup><msub id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.cmml"><mi id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.2" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.3" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.2" xref="A1.SS2.p1.6.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.2.cmml"><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.2.cmml">(</mo><mrow id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.cmml"><msup id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.2" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.3" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.1" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.3.2" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A1.SS2.p1.6.m1.1.1" xref="A1.SS2.p1.6.m1.1.1.cmml">ϕ</mi><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.3" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="A1.SS2.p1.6.m1.2.2" xref="A1.SS2.p1.6.m1.2.2.cmml">ϕ</mi><mo id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.6.m1.3.3.1.1.3" stretchy="false" xref="A1.SS2.p1.6.m1.3.3.1.1.1.cmml">)</mo></mrow><mrow id="A1.SS2.p1.6.m1.3.3.3" xref="A1.SS2.p1.6.m1.3.3.3.cmml"><mo id="A1.SS2.p1.6.m1.3.3.3a" xref="A1.SS2.p1.6.m1.3.3.3.cmml">−</mo><mn id="A1.SS2.p1.6.m1.3.3.3.2" xref="A1.SS2.p1.6.m1.3.3.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m1.3b"><apply id="A1.SS2.p1.6.m1.3.3.cmml" xref="A1.SS2.p1.6.m1.3.3"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m1.3.3.2.cmml" xref="A1.SS2.p1.6.m1.3.3">superscript</csymbol><apply id="A1.SS2.p1.6.m1.3.3.1.1.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1"><times id="A1.SS2.p1.6.m1.3.3.1.1.1.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.2"></times><apply id="A1.SS2.p1.6.m1.3.3.1.1.1.3.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3"><apply id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1">superscript</csymbol><apply id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1">subscript</csymbol><ci id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.2">∇</ci><ci id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.3.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.2.3">𝜃</ci></apply><cn id="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.3.cmml" type="integer" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.1.3">2</cn></apply><apply id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2">subscript</csymbol><ci id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.2">𝐿</ci><ci id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.3a.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.3"><mtext id="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.SS2.p1.6.m1.3.3.1.1.1.3.2.3">train</mtext></ci></apply></apply><interval closure="open" id="A1.SS2.p1.6.m1.3.3.1.1.1.1.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1"><apply id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1"><times id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.1"></times><apply id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.2">𝜃</ci><times id="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.SS2.p1.6.m1.3.3.1.1.1.1.1.1.2.3"></times></apply><ci id="A1.SS2.p1.6.m1.1.1.cmml" xref="A1.SS2.p1.6.m1.1.1">italic-ϕ</ci></apply><ci id="A1.SS2.p1.6.m1.2.2.cmml" xref="A1.SS2.p1.6.m1.2.2">italic-ϕ</ci></interval></apply><apply id="A1.SS2.p1.6.m1.3.3.3.cmml" xref="A1.SS2.p1.6.m1.3.3.3"><minus id="A1.SS2.p1.6.m1.3.3.3.1.cmml" xref="A1.SS2.p1.6.m1.3.3.3"></minus><cn id="A1.SS2.p1.6.m1.3.3.3.2.cmml" type="integer" xref="A1.SS2.p1.6.m1.3.3.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m1.3c">(\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}(\phi),\phi))^{-1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.6.m1.3d">( ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) , italic_ϕ ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> can be approximated to <math alttext="\sum_{n=0}^{K}(I-\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}(\phi))^{n}" class="ltx_math_unparsed" display="inline" id="A1.SS2.p1.7.m2.1"><semantics id="A1.SS2.p1.7.m2.1a"><mrow id="A1.SS2.p1.7.m2.1b"><msubsup id="A1.SS2.p1.7.m2.1.2"><mo id="A1.SS2.p1.7.m2.1.2.2.2">∑</mo><mrow id="A1.SS2.p1.7.m2.1.2.2.3"><mi id="A1.SS2.p1.7.m2.1.2.2.3.2">n</mi><mo id="A1.SS2.p1.7.m2.1.2.2.3.1">=</mo><mn id="A1.SS2.p1.7.m2.1.2.2.3.3">0</mn></mrow><mi id="A1.SS2.p1.7.m2.1.2.3">K</mi></msubsup><mrow id="A1.SS2.p1.7.m2.1.3"><mo id="A1.SS2.p1.7.m2.1.3.1" lspace="0em" stretchy="false">(</mo><mi id="A1.SS2.p1.7.m2.1.3.2">I</mi><mo id="A1.SS2.p1.7.m2.1.3.3">−</mo><msubsup id="A1.SS2.p1.7.m2.1.3.4"><mo id="A1.SS2.p1.7.m2.1.3.4.2.2" rspace="0.167em">∇</mo><mi id="A1.SS2.p1.7.m2.1.3.4.2.3">θ</mi><mn id="A1.SS2.p1.7.m2.1.3.4.3">2</mn></msubsup><msub id="A1.SS2.p1.7.m2.1.3.5"><mi id="A1.SS2.p1.7.m2.1.3.5.2">L</mi><mtext id="A1.SS2.p1.7.m2.1.3.5.3">train</mtext></msub><msup id="A1.SS2.p1.7.m2.1.3.6"><mrow id="A1.SS2.p1.7.m2.1.3.6.2"><mo id="A1.SS2.p1.7.m2.1.3.6.2.1" stretchy="false">(</mo><msup id="A1.SS2.p1.7.m2.1.3.6.2.2"><mi id="A1.SS2.p1.7.m2.1.3.6.2.2.2">θ</mi><mo id="A1.SS2.p1.7.m2.1.3.6.2.2.3">∗</mo></msup><mrow id="A1.SS2.p1.7.m2.1.3.6.2.3"><mo id="A1.SS2.p1.7.m2.1.3.6.2.3.1" stretchy="false">(</mo><mi id="A1.SS2.p1.7.m2.1.1">ϕ</mi><mo id="A1.SS2.p1.7.m2.1.3.6.2.3.2" stretchy="false">)</mo></mrow><mo id="A1.SS2.p1.7.m2.1.3.6.2.4" stretchy="false">)</mo></mrow><mi id="A1.SS2.p1.7.m2.1.3.6.3">n</mi></msup></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS2.p1.7.m2.1c">\sum_{n=0}^{K}(I-\nabla_{\theta}^{2}L_{\text{train}}(\theta^{*}(\phi))^{n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.7.m2.1d">∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( italic_I - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) ) start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> with K-truncated Neumann series<cite class="ltx_cite ltx_citemacro_citep">(Lorraine et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib36" title="">2020</a>; Navon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib37" title="">2021</a>)</cite>. Therefore, we can obtain the following results:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\phi}\theta^{*}(\phi)=-\sum_{n=0}^{K}(I-\nabla_{\theta}^{2}L_{\text{%
train}}(\theta^{*}(\phi))^{n}\cdot\nabla_{\phi}\nabla_{\theta}L_{\text{train}}%
(\theta^{*}(\phi),\phi)." class="ltx_math_unparsed" display="block" id="A1.E15.m1.4"><semantics id="A1.E15.m1.4a"><mrow id="A1.E15.m1.4b"><msub id="A1.E15.m1.4.5"><mo id="A1.E15.m1.4.5.2">∇</mo><mi id="A1.E15.m1.4.5.3">ϕ</mi></msub><msup id="A1.E15.m1.4.6"><mi id="A1.E15.m1.4.6.2">θ</mi><mo id="A1.E15.m1.4.6.3">∗</mo></msup><mrow id="A1.E15.m1.4.7"><mo id="A1.E15.m1.4.7.1" stretchy="false">(</mo><mi id="A1.E15.m1.1.1">ϕ</mi><mo id="A1.E15.m1.4.7.2" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.4.8" rspace="0em">=</mo><mo id="A1.E15.m1.4.9" lspace="0em" rspace="0.055em">−</mo><munderover id="A1.E15.m1.4.10"><mo id="A1.E15.m1.4.10.2.2" movablelimits="false" rspace="0em">∑</mo><mrow id="A1.E15.m1.4.10.2.3"><mi id="A1.E15.m1.4.10.2.3.2">n</mi><mo id="A1.E15.m1.4.10.2.3.1">=</mo><mn id="A1.E15.m1.4.10.2.3.3">0</mn></mrow><mi id="A1.E15.m1.4.10.3">K</mi></munderover><mrow id="A1.E15.m1.4.11"><mo id="A1.E15.m1.4.11.1" stretchy="false">(</mo><mi id="A1.E15.m1.4.11.2">I</mi><mo id="A1.E15.m1.4.11.3">−</mo><msubsup id="A1.E15.m1.4.11.4"><mo id="A1.E15.m1.4.11.4.2.2" rspace="0.167em">∇</mo><mi id="A1.E15.m1.4.11.4.2.3">θ</mi><mn id="A1.E15.m1.4.11.4.3">2</mn></msubsup><msub id="A1.E15.m1.4.11.5"><mi id="A1.E15.m1.4.11.5.2">L</mi><mtext id="A1.E15.m1.4.11.5.3">train</mtext></msub><msup id="A1.E15.m1.4.11.6"><mrow id="A1.E15.m1.4.11.6.2"><mo id="A1.E15.m1.4.11.6.2.1" stretchy="false">(</mo><msup id="A1.E15.m1.4.11.6.2.2"><mi id="A1.E15.m1.4.11.6.2.2.2">θ</mi><mo id="A1.E15.m1.4.11.6.2.2.3">∗</mo></msup><mrow id="A1.E15.m1.4.11.6.2.3"><mo id="A1.E15.m1.4.11.6.2.3.1" stretchy="false">(</mo><mi id="A1.E15.m1.2.2">ϕ</mi><mo id="A1.E15.m1.4.11.6.2.3.2" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.4.11.6.2.4" rspace="0.055em" stretchy="false">)</mo></mrow><mi id="A1.E15.m1.4.11.6.3">n</mi></msup><mo id="A1.E15.m1.4.11.7" rspace="0.222em">⋅</mo><msub id="A1.E15.m1.4.11.8"><mo id="A1.E15.m1.4.11.8.2" rspace="0.167em">∇</mo><mi id="A1.E15.m1.4.11.8.3">ϕ</mi></msub><msub id="A1.E15.m1.4.11.9"><mo id="A1.E15.m1.4.11.9.2" rspace="0.167em">∇</mo><mi id="A1.E15.m1.4.11.9.3">θ</mi></msub><msub id="A1.E15.m1.4.11.10"><mi id="A1.E15.m1.4.11.10.2">L</mi><mtext id="A1.E15.m1.4.11.10.3">train</mtext></msub><mrow id="A1.E15.m1.4.11.11"><mo id="A1.E15.m1.4.11.11.1" stretchy="false">(</mo><msup id="A1.E15.m1.4.11.11.2"><mi id="A1.E15.m1.4.11.11.2.2">θ</mi><mo id="A1.E15.m1.4.11.11.2.3">∗</mo></msup><mrow id="A1.E15.m1.4.11.11.3"><mo id="A1.E15.m1.4.11.11.3.1" stretchy="false">(</mo><mi id="A1.E15.m1.3.3">ϕ</mi><mo id="A1.E15.m1.4.11.11.3.2" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.4.11.11.4">,</mo><mi id="A1.E15.m1.4.4">ϕ</mi><mo id="A1.E15.m1.4.11.11.5" stretchy="false">)</mo></mrow><mo id="A1.E15.m1.4.11.12" lspace="0em">.</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E15.m1.4c">\nabla_{\phi}\theta^{*}(\phi)=-\sum_{n=0}^{K}(I-\nabla_{\theta}^{2}L_{\text{%
train}}(\theta^{*}(\phi))^{n}\cdot\nabla_{\phi}\nabla_{\theta}L_{\text{train}}%
(\theta^{*}(\phi),\phi).</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.4d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) = - ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( italic_I - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) ) start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⋅ ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) , italic_ϕ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.8">Finally, the implicit gradient of <math alttext="L_{\text{dev}}(\theta^{*}(\phi))" class="ltx_Math" display="inline" id="A1.SS2.p1.8.m1.2"><semantics id="A1.SS2.p1.8.m1.2a"><mrow id="A1.SS2.p1.8.m1.2.2" xref="A1.SS2.p1.8.m1.2.2.cmml"><msub id="A1.SS2.p1.8.m1.2.2.3" xref="A1.SS2.p1.8.m1.2.2.3.cmml"><mi id="A1.SS2.p1.8.m1.2.2.3.2" xref="A1.SS2.p1.8.m1.2.2.3.2.cmml">L</mi><mtext id="A1.SS2.p1.8.m1.2.2.3.3" xref="A1.SS2.p1.8.m1.2.2.3.3a.cmml">dev</mtext></msub><mo id="A1.SS2.p1.8.m1.2.2.2" xref="A1.SS2.p1.8.m1.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p1.8.m1.2.2.1.1" xref="A1.SS2.p1.8.m1.2.2.1.1.1.cmml"><mo id="A1.SS2.p1.8.m1.2.2.1.1.2" stretchy="false" xref="A1.SS2.p1.8.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS2.p1.8.m1.2.2.1.1.1" xref="A1.SS2.p1.8.m1.2.2.1.1.1.cmml"><msup id="A1.SS2.p1.8.m1.2.2.1.1.1.2" xref="A1.SS2.p1.8.m1.2.2.1.1.1.2.cmml"><mi id="A1.SS2.p1.8.m1.2.2.1.1.1.2.2" xref="A1.SS2.p1.8.m1.2.2.1.1.1.2.2.cmml">θ</mi><mo id="A1.SS2.p1.8.m1.2.2.1.1.1.2.3" xref="A1.SS2.p1.8.m1.2.2.1.1.1.2.3.cmml">∗</mo></msup><mo id="A1.SS2.p1.8.m1.2.2.1.1.1.1" xref="A1.SS2.p1.8.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS2.p1.8.m1.2.2.1.1.1.3.2" xref="A1.SS2.p1.8.m1.2.2.1.1.1.cmml"><mo id="A1.SS2.p1.8.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="A1.SS2.p1.8.m1.2.2.1.1.1.cmml">(</mo><mi id="A1.SS2.p1.8.m1.1.1" xref="A1.SS2.p1.8.m1.1.1.cmml">ϕ</mi><mo id="A1.SS2.p1.8.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="A1.SS2.p1.8.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.8.m1.2.2.1.1.3" stretchy="false" xref="A1.SS2.p1.8.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.8.m1.2b"><apply id="A1.SS2.p1.8.m1.2.2.cmml" xref="A1.SS2.p1.8.m1.2.2"><times id="A1.SS2.p1.8.m1.2.2.2.cmml" xref="A1.SS2.p1.8.m1.2.2.2"></times><apply id="A1.SS2.p1.8.m1.2.2.3.cmml" xref="A1.SS2.p1.8.m1.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p1.8.m1.2.2.3.1.cmml" xref="A1.SS2.p1.8.m1.2.2.3">subscript</csymbol><ci id="A1.SS2.p1.8.m1.2.2.3.2.cmml" xref="A1.SS2.p1.8.m1.2.2.3.2">𝐿</ci><ci id="A1.SS2.p1.8.m1.2.2.3.3a.cmml" xref="A1.SS2.p1.8.m1.2.2.3.3"><mtext id="A1.SS2.p1.8.m1.2.2.3.3.cmml" mathsize="70%" xref="A1.SS2.p1.8.m1.2.2.3.3">dev</mtext></ci></apply><apply id="A1.SS2.p1.8.m1.2.2.1.1.1.cmml" xref="A1.SS2.p1.8.m1.2.2.1.1"><times id="A1.SS2.p1.8.m1.2.2.1.1.1.1.cmml" xref="A1.SS2.p1.8.m1.2.2.1.1.1.1"></times><apply id="A1.SS2.p1.8.m1.2.2.1.1.1.2.cmml" xref="A1.SS2.p1.8.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p1.8.m1.2.2.1.1.1.2.1.cmml" xref="A1.SS2.p1.8.m1.2.2.1.1.1.2">superscript</csymbol><ci id="A1.SS2.p1.8.m1.2.2.1.1.1.2.2.cmml" xref="A1.SS2.p1.8.m1.2.2.1.1.1.2.2">𝜃</ci><times id="A1.SS2.p1.8.m1.2.2.1.1.1.2.3.cmml" xref="A1.SS2.p1.8.m1.2.2.1.1.1.2.3"></times></apply><ci id="A1.SS2.p1.8.m1.1.1.cmml" xref="A1.SS2.p1.8.m1.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.8.m1.2c">L_{\text{dev}}(\theta^{*}(\phi))</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.8.m1.2d">italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_ϕ ) )</annotation></semantics></math> is:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\phi}L_{\text{dev}}=-\nabla_{\theta}L_{\text{dev}}\cdot\sum_{n=0}^{K}(%
I-\nabla_{\theta}^{2}L_{\text{train}})^{n}\cdot\nabla_{\phi}\nabla_{\theta}L_{%
\text{train}}," class="ltx_Math" display="block" id="A1.E16.m1.1"><semantics id="A1.E16.m1.1a"><mrow id="A1.E16.m1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml"><mrow id="A1.E16.m1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml"><mrow id="A1.E16.m1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.3.cmml"><msub id="A1.E16.m1.1.1.1.1.3.1" xref="A1.E16.m1.1.1.1.1.3.1.cmml"><mo id="A1.E16.m1.1.1.1.1.3.1.2" xref="A1.E16.m1.1.1.1.1.3.1.2.cmml">∇</mo><mi id="A1.E16.m1.1.1.1.1.3.1.3" xref="A1.E16.m1.1.1.1.1.3.1.3.cmml">ϕ</mi></msub><msub id="A1.E16.m1.1.1.1.1.3.2" xref="A1.E16.m1.1.1.1.1.3.2.cmml"><mi id="A1.E16.m1.1.1.1.1.3.2.2" xref="A1.E16.m1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E16.m1.1.1.1.1.3.2.3" xref="A1.E16.m1.1.1.1.1.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="A1.E16.m1.1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.E16.m1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.1.1.1.1.1a" rspace="0.167em" xref="A1.E16.m1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E16.m1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.cmml"><mrow id="A1.E16.m1.1.1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.1.1.3.cmml"><msub id="A1.E16.m1.1.1.1.1.1.1.3.1" xref="A1.E16.m1.1.1.1.1.1.1.3.1.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1.3.1.2" rspace="0.167em" xref="A1.E16.m1.1.1.1.1.1.1.3.1.2.cmml">∇</mo><mi id="A1.E16.m1.1.1.1.1.1.1.3.1.3" xref="A1.E16.m1.1.1.1.1.1.1.3.1.3.cmml">θ</mi></msub><msub id="A1.E16.m1.1.1.1.1.1.1.3.2" xref="A1.E16.m1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E16.m1.1.1.1.1.1.1.3.2.2" xref="A1.E16.m1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E16.m1.1.1.1.1.1.1.3.2.3" xref="A1.E16.m1.1.1.1.1.1.1.3.2.3a.cmml">dev</mtext></msub></mrow><mo id="A1.E16.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.055em" xref="A1.E16.m1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.E16.m1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.cmml"><munderover id="A1.E16.m1.1.1.1.1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.2" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.1" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.3" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mi id="A1.E16.m1.1.1.1.1.1.1.1.2.3" xref="A1.E16.m1.1.1.1.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="A1.E16.m1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.cmml"><msup id="A1.E16.m1.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">I</mi><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2" rspace="0.167em" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∇</mo><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml">θ</mi><mn id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml">2</mn></msubsup><msub id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow></mrow><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="A1.E16.m1.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.E16.m1.1.1.1.1.1.1.1.1.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.cmml"><msub id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.2" rspace="0.167em" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.2.cmml">∇</mo><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.3.cmml">ϕ</mi></msub><msub id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.cmml"><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∇</mo><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml">θ</mi></msub></mrow><mo id="A1.E16.m1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml">train</mtext></msub></mrow></mrow></mrow></mrow></mrow></mrow><mo id="A1.E16.m1.1.1.1.2" xref="A1.E16.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.1b"><apply id="A1.E16.m1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1"><eq id="A1.E16.m1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.2"></eq><apply id="A1.E16.m1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.3"><apply id="A1.E16.m1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.1.1.cmml" xref="A1.E16.m1.1.1.1.1.3.1">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.1.2.cmml" xref="A1.E16.m1.1.1.1.1.3.1.2">∇</ci><ci id="A1.E16.m1.1.1.1.1.3.1.3.cmml" xref="A1.E16.m1.1.1.1.1.3.1.3">italic-ϕ</ci></apply><apply id="A1.E16.m1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.1.1.1.1.3.2.2">𝐿</ci><ci id="A1.E16.m1.1.1.1.1.3.2.3a.cmml" xref="A1.E16.m1.1.1.1.1.3.2.3"><mtext id="A1.E16.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E16.m1.1.1.1.1.3.2.3">dev</mtext></ci></apply></apply><apply id="A1.E16.m1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1"><minus id="A1.E16.m1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1"></minus><apply id="A1.E16.m1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1"><ci id="A1.E16.m1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.2">⋅</ci><apply id="A1.E16.m1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3"><apply id="A1.E16.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.3.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.3.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.1.2">∇</ci><ci id="A1.E16.m1.1.1.1.1.1.1.3.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.1.3">𝜃</ci></apply><apply id="A1.E16.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="A1.E16.m1.1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E16.m1.1.1.1.1.1.1.3.2.3"><mtext id="A1.E16.m1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E16.m1.1.1.1.1.1.1.3.2.3">dev</mtext></ci></apply></apply><apply id="A1.E16.m1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1"><apply id="A1.E16.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E16.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="A1.E16.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3"><eq id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.2">𝑛</ci><cn id="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E16.m1.1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><ci id="A1.E16.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1"><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐼</ci><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.2">∇</ci><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.3">𝜃</ci></apply><cn id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml" type="integer" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.3">2</cn></apply><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">train</mtext></ci></apply></apply></apply><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3"><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1"><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.2">∇</ci><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.1.3">italic-ϕ</ci></apply><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.2">∇</ci><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.1.2.3">𝜃</ci></apply></apply><apply id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E16.m1.1.1.1.1.1.1.1.1.3.2.3">train</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.1c">\nabla_{\phi}L_{\text{dev}}=-\nabla_{\theta}L_{\text{dev}}\cdot\sum_{n=0}^{K}(%
I-\nabla_{\theta}^{2}L_{\text{train}})^{n}\cdot\nabla_{\phi}\nabla_{\theta}L_{%
\text{train}},</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.1d">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT = - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT dev end_POSTSUBSCRIPT ⋅ ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( italic_I - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⋅ ∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.10">where the parameters are omitted for the sake of brevity.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3. </span>Computational Complexity</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">The scale of datasets can be measured with the number of sequences N, maximum sequence length L, maximum pattern length M, and the number of extracted patterns q (empirically, q is of the same order of magnitude as N). We denote the diversity factor as K.</p>
</div>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.6">The pre-training dataset is constructed with sequential pattern mining, which is implemented with Seq2Pat <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib53" title="">2022a</a>)</cite> and its complexity is <math alttext="O(NMq)" class="ltx_Math" display="inline" id="A1.SS3.p2.1.m1.1"><semantics id="A1.SS3.p2.1.m1.1a"><mrow id="A1.SS3.p2.1.m1.1.1" xref="A1.SS3.p2.1.m1.1.1.cmml"><mi id="A1.SS3.p2.1.m1.1.1.3" xref="A1.SS3.p2.1.m1.1.1.3.cmml">O</mi><mo id="A1.SS3.p2.1.m1.1.1.2" xref="A1.SS3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS3.p2.1.m1.1.1.1.1" xref="A1.SS3.p2.1.m1.1.1.1.1.1.cmml"><mo id="A1.SS3.p2.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS3.p2.1.m1.1.1.1.1.1" xref="A1.SS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS3.p2.1.m1.1.1.1.1.1.2" xref="A1.SS3.p2.1.m1.1.1.1.1.1.2.cmml">N</mi><mo id="A1.SS3.p2.1.m1.1.1.1.1.1.1" xref="A1.SS3.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS3.p2.1.m1.1.1.1.1.1.3" xref="A1.SS3.p2.1.m1.1.1.1.1.1.3.cmml">M</mi><mo id="A1.SS3.p2.1.m1.1.1.1.1.1.1a" xref="A1.SS3.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS3.p2.1.m1.1.1.1.1.1.4" xref="A1.SS3.p2.1.m1.1.1.1.1.1.4.cmml">q</mi></mrow><mo id="A1.SS3.p2.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.1.m1.1b"><apply id="A1.SS3.p2.1.m1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1"><times id="A1.SS3.p2.1.m1.1.1.2.cmml" xref="A1.SS3.p2.1.m1.1.1.2"></times><ci id="A1.SS3.p2.1.m1.1.1.3.cmml" xref="A1.SS3.p2.1.m1.1.1.3">𝑂</ci><apply id="A1.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1"><times id="A1.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.1.1"></times><ci id="A1.SS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.1.2">𝑁</ci><ci id="A1.SS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.1.3">𝑀</ci><ci id="A1.SS3.p2.1.m1.1.1.1.1.1.4.cmml" xref="A1.SS3.p2.1.m1.1.1.1.1.1.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.1.m1.1c">O(NMq)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.1.m1.1d">italic_O ( italic_N italic_M italic_q )</annotation></semantics></math>. Empirically, this process can be accelerated with offline pre-computation or batching technique <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib53" title="">2022a</a>)</cite>. During pre-training, the regenerator needs to process each sequence. Considering the quadratic complexity of the self-attention mechanism, the overall complexity is <math alttext="O(qL^{2}d)" class="ltx_Math" display="inline" id="A1.SS3.p2.2.m2.1"><semantics id="A1.SS3.p2.2.m2.1a"><mrow id="A1.SS3.p2.2.m2.1.1" xref="A1.SS3.p2.2.m2.1.1.cmml"><mi id="A1.SS3.p2.2.m2.1.1.3" xref="A1.SS3.p2.2.m2.1.1.3.cmml">O</mi><mo id="A1.SS3.p2.2.m2.1.1.2" xref="A1.SS3.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS3.p2.2.m2.1.1.1.1" xref="A1.SS3.p2.2.m2.1.1.1.1.1.cmml"><mo id="A1.SS3.p2.2.m2.1.1.1.1.2" stretchy="false" xref="A1.SS3.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS3.p2.2.m2.1.1.1.1.1" xref="A1.SS3.p2.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS3.p2.2.m2.1.1.1.1.1.2" xref="A1.SS3.p2.2.m2.1.1.1.1.1.2.cmml">q</mi><mo id="A1.SS3.p2.2.m2.1.1.1.1.1.1" xref="A1.SS3.p2.2.m2.1.1.1.1.1.1.cmml">⁢</mo><msup id="A1.SS3.p2.2.m2.1.1.1.1.1.3" xref="A1.SS3.p2.2.m2.1.1.1.1.1.3.cmml"><mi id="A1.SS3.p2.2.m2.1.1.1.1.1.3.2" xref="A1.SS3.p2.2.m2.1.1.1.1.1.3.2.cmml">L</mi><mn id="A1.SS3.p2.2.m2.1.1.1.1.1.3.3" xref="A1.SS3.p2.2.m2.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="A1.SS3.p2.2.m2.1.1.1.1.1.1a" xref="A1.SS3.p2.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS3.p2.2.m2.1.1.1.1.1.4" xref="A1.SS3.p2.2.m2.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="A1.SS3.p2.2.m2.1.1.1.1.3" stretchy="false" xref="A1.SS3.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.2.m2.1b"><apply id="A1.SS3.p2.2.m2.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1"><times id="A1.SS3.p2.2.m2.1.1.2.cmml" xref="A1.SS3.p2.2.m2.1.1.2"></times><ci id="A1.SS3.p2.2.m2.1.1.3.cmml" xref="A1.SS3.p2.2.m2.1.1.3">𝑂</ci><apply id="A1.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1"><times id="A1.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.1.1"></times><ci id="A1.SS3.p2.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.1.2">𝑞</ci><apply id="A1.SS3.p2.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.1.3">superscript</csymbol><ci id="A1.SS3.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.1.3.2">𝐿</ci><cn id="A1.SS3.p2.2.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.SS3.p2.2.m2.1.1.1.1.1.3.3">2</cn></apply><ci id="A1.SS3.p2.2.m2.1.1.1.1.1.4.cmml" xref="A1.SS3.p2.2.m2.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.2.m2.1c">O(qL^{2}d)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.2.m2.1d">italic_O ( italic_q italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d )</annotation></semantics></math>. During inference, the complexity is <math alttext="O(KNL^{2}d)" class="ltx_Math" display="inline" id="A1.SS3.p2.3.m3.1"><semantics id="A1.SS3.p2.3.m3.1a"><mrow id="A1.SS3.p2.3.m3.1.1" xref="A1.SS3.p2.3.m3.1.1.cmml"><mi id="A1.SS3.p2.3.m3.1.1.3" xref="A1.SS3.p2.3.m3.1.1.3.cmml">O</mi><mo id="A1.SS3.p2.3.m3.1.1.2" xref="A1.SS3.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="A1.SS3.p2.3.m3.1.1.1.1" xref="A1.SS3.p2.3.m3.1.1.1.1.1.cmml"><mo id="A1.SS3.p2.3.m3.1.1.1.1.2" stretchy="false" xref="A1.SS3.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS3.p2.3.m3.1.1.1.1.1" xref="A1.SS3.p2.3.m3.1.1.1.1.1.cmml"><mi id="A1.SS3.p2.3.m3.1.1.1.1.1.2" xref="A1.SS3.p2.3.m3.1.1.1.1.1.2.cmml">K</mi><mo id="A1.SS3.p2.3.m3.1.1.1.1.1.1" xref="A1.SS3.p2.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS3.p2.3.m3.1.1.1.1.1.3" xref="A1.SS3.p2.3.m3.1.1.1.1.1.3.cmml">N</mi><mo id="A1.SS3.p2.3.m3.1.1.1.1.1.1a" xref="A1.SS3.p2.3.m3.1.1.1.1.1.1.cmml">⁢</mo><msup id="A1.SS3.p2.3.m3.1.1.1.1.1.4" xref="A1.SS3.p2.3.m3.1.1.1.1.1.4.cmml"><mi id="A1.SS3.p2.3.m3.1.1.1.1.1.4.2" xref="A1.SS3.p2.3.m3.1.1.1.1.1.4.2.cmml">L</mi><mn id="A1.SS3.p2.3.m3.1.1.1.1.1.4.3" xref="A1.SS3.p2.3.m3.1.1.1.1.1.4.3.cmml">2</mn></msup><mo id="A1.SS3.p2.3.m3.1.1.1.1.1.1b" xref="A1.SS3.p2.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS3.p2.3.m3.1.1.1.1.1.5" xref="A1.SS3.p2.3.m3.1.1.1.1.1.5.cmml">d</mi></mrow><mo id="A1.SS3.p2.3.m3.1.1.1.1.3" stretchy="false" xref="A1.SS3.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.3.m3.1b"><apply id="A1.SS3.p2.3.m3.1.1.cmml" xref="A1.SS3.p2.3.m3.1.1"><times id="A1.SS3.p2.3.m3.1.1.2.cmml" xref="A1.SS3.p2.3.m3.1.1.2"></times><ci id="A1.SS3.p2.3.m3.1.1.3.cmml" xref="A1.SS3.p2.3.m3.1.1.3">𝑂</ci><apply id="A1.SS3.p2.3.m3.1.1.1.1.1.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1"><times id="A1.SS3.p2.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1.1.1"></times><ci id="A1.SS3.p2.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1.1.2">𝐾</ci><ci id="A1.SS3.p2.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1.1.3">𝑁</ci><apply id="A1.SS3.p2.3.m3.1.1.1.1.1.4.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.SS3.p2.3.m3.1.1.1.1.1.4.1.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1.1.4">superscript</csymbol><ci id="A1.SS3.p2.3.m3.1.1.1.1.1.4.2.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1.1.4.2">𝐿</ci><cn id="A1.SS3.p2.3.m3.1.1.1.1.1.4.3.cmml" type="integer" xref="A1.SS3.p2.3.m3.1.1.1.1.1.4.3">2</cn></apply><ci id="A1.SS3.p2.3.m3.1.1.1.1.1.5.cmml" xref="A1.SS3.p2.3.m3.1.1.1.1.1.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.3.m3.1c">O(KNL^{2}d)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.3.m3.1d">italic_O ( italic_K italic_N italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d )</annotation></semantics></math>, as we need to regenerate K patterns from each sequence. Meanwhile, autoregressive decoding can be further accelerated with efficient decoding <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib59" title="">2024</a>)</cite>. As for dataset personalization, denote the complexity of the target model as <math alttext="a" class="ltx_Math" display="inline" id="A1.SS3.p2.4.m4.1"><semantics id="A1.SS3.p2.4.m4.1a"><mi id="A1.SS3.p2.4.m4.1.1" xref="A1.SS3.p2.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.4.m4.1b"><ci id="A1.SS3.p2.4.m4.1.1.cmml" xref="A1.SS3.p2.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.4.m4.1c">a</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.4.m4.1d">italic_a</annotation></semantics></math>. The additional overhead incurred by the bi-level optimization stems from the upper optimization conducted every <math alttext="T_{\text{lower}}" class="ltx_Math" display="inline" id="A1.SS3.p2.5.m5.1"><semantics id="A1.SS3.p2.5.m5.1a"><msub id="A1.SS3.p2.5.m5.1.1" xref="A1.SS3.p2.5.m5.1.1.cmml"><mi id="A1.SS3.p2.5.m5.1.1.2" xref="A1.SS3.p2.5.m5.1.1.2.cmml">T</mi><mtext id="A1.SS3.p2.5.m5.1.1.3" xref="A1.SS3.p2.5.m5.1.1.3a.cmml">lower</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.5.m5.1b"><apply id="A1.SS3.p2.5.m5.1.1.cmml" xref="A1.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS3.p2.5.m5.1.1.1.cmml" xref="A1.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="A1.SS3.p2.5.m5.1.1.2.cmml" xref="A1.SS3.p2.5.m5.1.1.2">𝑇</ci><ci id="A1.SS3.p2.5.m5.1.1.3a.cmml" xref="A1.SS3.p2.5.m5.1.1.3"><mtext id="A1.SS3.p2.5.m5.1.1.3.cmml" mathsize="70%" xref="A1.SS3.p2.5.m5.1.1.3">lower</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.5.m5.1c">T_{\text{lower}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.5.m5.1d">italic_T start_POSTSUBSCRIPT lower end_POSTSUBSCRIPT</annotation></semantics></math> rounds. In the upper optimization, complexity mainly results from the implicit gradient computation, which necessitates (K+2) backward for vector-Jacobi product<cite class="ltx_cite ltx_citemacro_citep">(Navon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib37" title="">2021</a>)</cite>. Herein, K represents the truncated number of Neumann series, which is fixed at 3. Consequently, the complexity merely amounts to <math alttext="O\left(\left(1+\frac{5}{T_{\text{lower}}}\right)a\right)" class="ltx_Math" display="inline" id="A1.SS3.p2.6.m6.1"><semantics id="A1.SS3.p2.6.m6.1a"><mrow id="A1.SS3.p2.6.m6.1.1" xref="A1.SS3.p2.6.m6.1.1.cmml"><mi id="A1.SS3.p2.6.m6.1.1.3" xref="A1.SS3.p2.6.m6.1.1.3.cmml">O</mi><mo id="A1.SS3.p2.6.m6.1.1.2" xref="A1.SS3.p2.6.m6.1.1.2.cmml">⁢</mo><mrow id="A1.SS3.p2.6.m6.1.1.1.1" xref="A1.SS3.p2.6.m6.1.1.1.1.1.cmml"><mo id="A1.SS3.p2.6.m6.1.1.1.1.2" xref="A1.SS3.p2.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS3.p2.6.m6.1.1.1.1.1" xref="A1.SS3.p2.6.m6.1.1.1.1.1.cmml"><mrow id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.cmml"><mo id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.2" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.cmml"><mn id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.2" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.1" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.1.cmml">+</mo><mfrac id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.cmml"><mn id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.2" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.2.cmml">5</mn><msub id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.2" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.2.cmml">T</mi><mtext id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.3" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.3a.cmml">lower</mtext></msub></mfrac></mrow><mo id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.3" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.SS3.p2.6.m6.1.1.1.1.1.2" xref="A1.SS3.p2.6.m6.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.SS3.p2.6.m6.1.1.1.1.1.3" xref="A1.SS3.p2.6.m6.1.1.1.1.1.3.cmml">a</mi></mrow><mo id="A1.SS3.p2.6.m6.1.1.1.1.3" xref="A1.SS3.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.6.m6.1b"><apply id="A1.SS3.p2.6.m6.1.1.cmml" xref="A1.SS3.p2.6.m6.1.1"><times id="A1.SS3.p2.6.m6.1.1.2.cmml" xref="A1.SS3.p2.6.m6.1.1.2"></times><ci id="A1.SS3.p2.6.m6.1.1.3.cmml" xref="A1.SS3.p2.6.m6.1.1.3">𝑂</ci><apply id="A1.SS3.p2.6.m6.1.1.1.1.1.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1"><times id="A1.SS3.p2.6.m6.1.1.1.1.1.2.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.2"></times><apply id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1"><plus id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.1"></plus><cn id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3"><divide id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3"></divide><cn id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.2">5</cn><apply id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.2">𝑇</ci><ci id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.3a.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.3"><mtext id="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.3.cmml" mathsize="50%" xref="A1.SS3.p2.6.m6.1.1.1.1.1.1.1.1.3.3.3">lower</mtext></ci></apply></apply></apply><ci id="A1.SS3.p2.6.m6.1.1.1.1.1.3.cmml" xref="A1.SS3.p2.6.m6.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.6.m6.1c">O\left(\left(1+\frac{5}{T_{\text{lower}}}\right)a\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.6.m6.1d">italic_O ( ( 1 + divide start_ARG 5 end_ARG start_ARG italic_T start_POSTSUBSCRIPT lower end_POSTSUBSCRIPT end_ARG ) italic_a )</annotation></semantics></math>. Therefore, with some acceleration strategies, DR4SR and DR4SR+ is scalable when applied to large datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4. </span>Detailed Hyper-parameters</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">We first introduce the hyper-parameter settings of target models: For GRU4Rec, we search the layer number among [2, 3], and dropout probability among [0.2, 0.5]. For SASRec, the layer number is 2, the dimension of hidden layers is 128, and the dropout probability is 0.5. For FMLP, the layer number is 2, the dimension of hidden layers is 256, and the dropout probability is 0.5. For GCE-GNN, we first replace its graph encoder with LightGCN<cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib10" title="">2020</a>)</cite> and its sequential encoder with SASRec<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#bib.bib21" title="">2018</a>)</cite>, which can significantly improve its performance. Then, we search the number of graph convolution layers among [2, 3]. For CL4SRec, we set the weight of contrastive learning loss to 0.1, the crop/mask/reorder rate in data augmentation is set to 0.2/0.7/0.2, and other hyper-parameters are the same as SASRec.</p>
</div>
<div class="ltx_para" id="A1.SS4.p2">
<p class="ltx_p" id="A1.SS4.p2.5">Then we consider particular hyper-parameters of DR4SR. For dataset regeneration, we set sliding window size <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.SS4.p2.1.m1.1"><semantics id="A1.SS4.p2.1.m1.1a"><mi id="A1.SS4.p2.1.m1.1.1" xref="A1.SS4.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.1.m1.1b"><ci id="A1.SS4.p2.1.m1.1.1.cmml" xref="A1.SS4.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.1.m1.1d">italic_α</annotation></semantics></math> to 5 for Beauty and 10 for others, and we set the threshold <math alttext="\beta" class="ltx_Math" display="inline" id="A1.SS4.p2.2.m2.1"><semantics id="A1.SS4.p2.2.m2.1a"><mi id="A1.SS4.p2.2.m2.1.1" xref="A1.SS4.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.2.m2.1b"><ci id="A1.SS4.p2.2.m2.1.1.cmml" xref="A1.SS4.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.2.m2.1d">italic_β</annotation></semantics></math> to 2 for all datasets. We fix the diversity number <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.p2.3.m3.1"><semantics id="A1.SS4.p2.3.m3.1a"><mi id="A1.SS4.p2.3.m3.1.1" xref="A1.SS4.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.3.m3.1b"><ci id="A1.SS4.p2.3.m3.1.1.cmml" xref="A1.SS4.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.3.m3.1d">italic_K</annotation></semantics></math> to 5, and the generative decoding probability <math alttext="\gamma" class="ltx_Math" display="inline" id="A1.SS4.p2.4.m4.1"><semantics id="A1.SS4.p2.4.m4.1a"><mi id="A1.SS4.p2.4.m4.1.1" xref="A1.SS4.p2.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.4.m4.1b"><ci id="A1.SS4.p2.4.m4.1.1.cmml" xref="A1.SS4.p2.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.4.m4.1d">italic_γ</annotation></semantics></math> to 0.1. For DR4SR+, we set <math alttext="T_{\text{lower}}" class="ltx_Math" display="inline" id="A1.SS4.p2.5.m5.1"><semantics id="A1.SS4.p2.5.m5.1a"><msub id="A1.SS4.p2.5.m5.1.1" xref="A1.SS4.p2.5.m5.1.1.cmml"><mi id="A1.SS4.p2.5.m5.1.1.2" xref="A1.SS4.p2.5.m5.1.1.2.cmml">T</mi><mtext id="A1.SS4.p2.5.m5.1.1.3" xref="A1.SS4.p2.5.m5.1.1.3a.cmml">lower</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.5.m5.1b"><apply id="A1.SS4.p2.5.m5.1.1.cmml" xref="A1.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS4.p2.5.m5.1.1.1.cmml" xref="A1.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="A1.SS4.p2.5.m5.1.1.2.cmml" xref="A1.SS4.p2.5.m5.1.1.2">𝑇</ci><ci id="A1.SS4.p2.5.m5.1.1.3a.cmml" xref="A1.SS4.p2.5.m5.1.1.3"><mtext id="A1.SS4.p2.5.m5.1.1.3.cmml" mathsize="70%" xref="A1.SS4.p2.5.m5.1.1.3">lower</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.5.m5.1c">T_{\text{lower}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.5.m5.1d">italic_T start_POSTSUBSCRIPT lower end_POSTSUBSCRIPT</annotation></semantics></math> to 30, and adopt SGD as the upper optimizer with learning rate and weight decay searched among [1e-3, 1e-2, 1e-1].</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5. </span>Generalization to More Datasets</h3>
<div class="ltx_para" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1">We provide the results on two additional datasets Amazon-book and Gowalla in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17795v3#A1.T6" title="Table 6 ‣ Appendix A APPENDIX ‣ Dataset Regeneration for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, where we can find that the proposed method can be generalized to datasets with large-scale or different distribution.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 11 02:06:11 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
