<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation</title>
<!--Generated on Mon Mar 25 08:46:25 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2403.01479v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S1" title="1 Introduction ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S2" title="2 Preliminaries ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S2.SS1" title="2.1 Multi-Head Attention ‣ 2 Preliminaries ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Multi-Head Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S2.SS2" title="2.2 Knowledge Distillation ‣ 2 Preliminaries ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Knowledge Distillation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S3" title="3 Related Works ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4" title="4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.SS1" title="4.1 Attention Map as a Knowledge ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Attention Map as a Knowledge</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.SS2" title="4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Attention Alignment Module</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.SS2.SSS1" title="4.2.1 Module Architecture ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Module Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.SS2.SSS2" title="4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Module Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.SS3" title="4.3 Comparison with Previous Methods ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Comparison with Previous Methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S5" title="5 Experiments ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S5.SS1" title="5.1 Datasets ‣ 5 Experiments ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S5.SS2" title="5.2 Distillation Settings ‣ 5 Experiments ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Distillation Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S5.SS3" title="5.3 Baselines ‣ 5 Experiments ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S5.SS4" title="5.4 Results on Low-resource datasets ‣ 5 Experiments ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Results on Low-resource datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S5.SS5" title="5.5 Results on High-resource dataset ‣ 5 Experiments ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Results on High-resource dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6" title="6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Analysis and Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.SS1" title="6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Effect of Fine-grained Alignment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.SS2" title="6.2 Decoder Distillation ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Decoder Distillation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.SS3" title="6.3 Effectiveness on Different Tasks ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Effectiveness on Different Tasks</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S7" title="7 Conclusion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S8" title="8 Limitations and Future work ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Limitations and Future work</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div aria-label="Conversion errors have been found" class="package-alerts ltx_document" role="status">
<button aria-label="Dismiss alert" onclick="closePopup()">
<span aria-hidden="true"><svg aria-hidden="true" focusable="false" height="20" role="presentation" viewbox="0 0 44 44" width="20">
<path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
<path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
</svg></span>
</button>
<p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
<ul arial-label="Unsupported packages used in this paper">
<li>failed: inconsolata</li>
</ul>
<p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
</div><div class="section" id="target-section"><div id="license-tr">License: CC BY-NC-SA 4.0</div><div id="watermark-tr">arXiv:2403.01479v3 [cs.CL] 25 Mar 2024</div></div>
<script>
            function closePopup() {
                document.querySelector('.package-alerts').style.display = 'none';
            }
        </script>
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Align-to-Distill: Trainable Attention Alignment for 
<br class="ltx_break"/>Knowledge Distillation in Neural Machine Translation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Heegon Jin, Seonil Son, Jemin Park, Youngseok Kim, Hyungjong Noh, Yeonsoo Lee
<br class="ltx_break"/>NC Research, AI Tech Center 
<br class="ltx_break"/>Seongnam, South Korea 
<br class="ltx_break"/>{heegon, deftson, hbk5844, kys159, nohhj0209, yeonsoo}@ncsoft.com
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">The advent of scalable deep models and large datasets has improved the performance of Neural Machine Translation (NMT).
Knowledge Distillation (KD) enhances efficiency by transferring knowledge from a teacher model to a more compact student model.
However, KD approaches to Transformer architecture often rely on heuristics, particularly when deciding which teacher layers to distill from.
In this paper, we introduce the “Align-to-Distill” (A2D) strategy, designed to address the feature mapping problem by adaptively aligning student attention heads with their teacher counterparts during training.
The Attention Alignment Module (AAM) in A2D performs a dense head-by-head comparison between student and teacher attention heads across layers, turning the combinatorial mapping heuristics into a learning problem.
Our experiments show the efficacy of A2D, demonstrating gains of up to +3.61 and +0.63 BLEU points for WMT-2022 De→Dsb and WMT-2014 En→De, respectively, compared to Transformer baselines. <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The code and data are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ncsoft/Align-to-Distill" title="">https://github.com/ncsoft/Align-to-Distill</a>.</span></span></span></p>
</div>
<span class="ltx_ERROR undefined" id="id1">\useunder</span>
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1"><span class="ltx_text ltx_ulem_uline" id="p1.1.1"></span><span class="ltx_ERROR undefined" id="p1.1.2">\ul</span>
</p>
</div>
<div class="ltx_para ltx_noindent" id="p2">
<p class="ltx_p ltx_align_center ltx_align_bottom" id="p2.1"><span class="ltx_text ltx_font_bold" id="p2.1.1">Align-to-Distill: Trainable Attention Alignment for 
<br class="ltx_break"/>Knowledge Distillation in Neural Machine Translation</span></p>
</div>
<div class="ltx_para" id="p3">
<br class="ltx_break"/>
<p class="ltx_p" id="p3.1"><span class="ltx_text" id="p3.1.1" style="width:433.6pt;"><span class="ltx_text" id="p3.1.1.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p3.1.1.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="p3.1.1.1.1.1.1">
<span class="ltx_td ltx_align_center" id="p3.1.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p3.1.1.1.1.1.1.1.1">Heegon Jin, Seonil Son, Jemin Park, Youngseok Kim, Hyungjong Noh, Yeonsoo Lee</span></span></span>
<span class="ltx_tr" id="p3.1.1.1.1.2.2">
<span class="ltx_td ltx_align_center" id="p3.1.1.1.1.2.2.1">NC Research, AI Tech Center</span></span>
<span class="ltx_tr" id="p3.1.1.1.1.3.3">
<span class="ltx_td ltx_align_center" id="p3.1.1.1.1.3.3.1">Seongnam, South Korea</span></span>
<span class="ltx_tr" id="p3.1.1.1.1.4.4">
<span class="ltx_td ltx_align_center" id="p3.1.1.1.1.4.4.1">{heegon, deftson, hbk5844, kys159, nohhj0209, yeonsoo}@ncsoft.com</span></span>
</span>
</span></span> </span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Transformer-based encoder-decoder models have achieved remarkable success in various natural language processing tasks <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib29" title="">2017</a>); Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib4" title="">2019</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib16" title="">2019</a>); Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib14" title="">2020</a>)</cite>, including Neural Machine Translation (NMT) <cite class="ltx_cite ltx_citemacro_cite">Sutskever et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib27" title="">2014</a>); Bahdanau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib2" title="">2015</a>); Sennrich et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib23" title="">2016</a>); Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib29" title="">2017</a>)</cite>.
However, the autoregressive decoding process often imposes a significant computational burden, especially as the number of layers and parameters escalates with increasing model complexity.
This presents substantial challenges when deploying the Transformer-based models for real-time applications <cite class="ltx_cite ltx_citemacro_cite">Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib7" title="">2017</a>)</cite> and online services <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib37" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">One of the possible solutions is to reduce the model size using knowledge distillation (KD) <cite class="ltx_cite ltx_citemacro_cite">Hinton et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib8" title="">2015</a>)</cite>.
KD facilitates the transfer of knowledge from a high-performing, large-parameter teacher model to a more moderately sized student model.
This process alleviates deployment challenges by generating a distilled model that is both lightweight and efficient, ensuring reduced inference times and lower computational resource requirements.
Furthermore, with the guidance of the teacher model, the student model can potentially achieve performance levels closer to those of the teacher model compared to training it without the teacher’s assistance.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">KD, initially proposed by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib3" title="">Bucila et al.</a>; <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib1" title="">Ba and Caruana</a>; <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib8" title="">Hinton et al.</a></cite>, involves transferring knowledge to the student model using responses from the network’s last layer.
Among its variants, Sequence-level KD <cite class="ltx_cite ltx_citemacro_cite">Kim and Rush (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib12" title="">2016</a>)</cite> and Selective KD <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib32" title="">2021</a>)</cite> leverage the final output and soft labels from teacher’s responses, respectively.
These strategies can be categorized as response-based KD <cite class="ltx_cite ltx_citemacro_cite">Gou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib6" title="">2021</a>)</cite>.
Meanwhile, not only the final layer outputs are used, but intermediate features from the teacher model’s layer are also used as a medium for a more effective and comprehensive distillation of knowledge <cite class="ltx_cite ltx_citemacro_cite">Romero et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib21" title="">2015</a>); Zagoruyko and Komodakis (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib36" title="">2017</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib25" title="">2019</a>); Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib26" title="">2020</a>)</cite>. These approaches belong to the category of feature-based KD <cite class="ltx_cite ltx_citemacro_cite">Gou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib6" title="">2021</a>)</cite>.
Most feature-based KD in Transformers has concentrated on compressing encoder-based models <cite class="ltx_cite ltx_citemacro_cite">Sanh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib22" title="">2019</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib25" title="">2019</a>); Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib33" title="">2020</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib26" title="">2020</a>); Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite>, including pre-trained models like BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib4" title="">2019</a>)</cite>.
On the other hand, some studies <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>); Shleifer and Rush (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib24" title="">2020</a>)</cite> have applied feature-based KD to the decoder for generative tasks.
However, they found it less effective compared to response-based KD for decoder distillation <cite class="ltx_cite ltx_citemacro_cite">Kim and Rush (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib12" title="">2016</a>); Kasai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib11" title="">2020</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib32" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">While extending KD to features across the layers does enrich knowledge transfer, it prompts an open question: ‘From which teacher layer should the student layer learn and from which should it not?’.
Instead of resolving this issue through trainable methods, several studies <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib25" title="">2019</a>); Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>); Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>); Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite> have circumvented the issue using heuristic approaches.
Those approaches require a heuristic skip or combination of teacher layers to align with the student layer.
However, as the number of layers increases, the complexity of heuristically selecting features grows, necessitating an exhaustive search for the optimal combination strategy.
For example, Combinatorial KD <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite> demonstrated that its peak performance relies on language-pair-specific feature mapping.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we introduce a novel KD strategy, Align-to-Distill (A2D), that addresses the feature mapping problem using a trainable Attention Alignment Module (AAM).
Unlike earlier KD methods that relied on combinatorial feature mapping heuristics, A2D provides an end-to-end trainable solution.
The adaptive alignment of features removes the necessity for a data-dependent mapping strategy.
Furthermore, AAM aligns the student attention map in each head with those of the teacher, resulting in more effective distillation compared to layer-wise feature mapping.
AAM enables each attention head in the student model to be compared with every head in the teacher model across different layers, by employing pointwise convolution with only a few additional parameters. As a result, there is no longer a need for head or layer parity between the student and teacher models.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Notably, our experimental results and analysis show that due to its fine-grained attention transfer in a head-wise manner, A2D is effectively applicable to the decoder of the Transformer, an area where previous feature-based KD approaches have typically struggled.
By compressing the decoder with A2D, we could reduce the cost of autoregressive inference while preserving its performance.
Our comprehensive studies on both high-resource and low-resource NMT tasks show that our method consistently outperforms state-of-the-art baselines, spanning both feature-based and response-based KD methods.
In particular, even with a smaller model size than the teacher, students trained with A2D can match or even surpass teacher performance in low-resource settings.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Our contribution is three-folded as follows:</p>
</div>
<div class="ltx_para" id="S1.p8">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce “Align-to-Distill” (A2D), a novel attention-based distillation method that can be effectively applied to the decoder of the transformer.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">A2D overcomes the limitations imposed by feature-mapping heuristics of previous distillation approaches by introducing a learnable alignment between attention heads across different layers.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">A2D enables fine-grained attention knowledge transfer from teacher to student, thereby outperforming state-of-the-art KD strategies in both high-resource and low-resource translation tasks.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Multi-Head Attention</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.3"><span class="ltx_text ltx_font_bold" id="S2.SS1.p1.3.1">Multi-head Attention (MHA)</span> is a core component of the Transformer architecture introduced by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib29" title="">Vaswani et al.</a></cite>. We use <math alttext="\mathbf{X}\in\mathcal{R}^{L\times d}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">𝐗</mi><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.3.2" xref="S2.SS1.p1.1.m1.1.1.3.3.2.cmml">L</mi><mo id="S2.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p1.1.m1.1.1.3.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><in id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></in><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝐗</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">ℛ</ci><apply id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3"><times id="S2.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.2">𝐿</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathbf{X}\in\mathcal{R}^{L\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">bold_X ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to denote the input to the Transformer layer, which is a sequence of embeddings fed into MHA, where <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_L</annotation></semantics></math> is the length of the text input and <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_d</annotation></semantics></math> is the dimension of model embedding.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.7">In the Transformer layer, the input sequence <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">bold_X</annotation></semantics></math> is mapped to three unique vector embeddings: the query (<math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">bold_Q</annotation></semantics></math>), the key (<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">bold_K</annotation></semantics></math>), and the value (<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">bold_V</annotation></semantics></math>). Each of these embeddings is associated with its own projection weight, denoted by <math alttext="\mathbf{W}_{q}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><msub id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">𝐖</mi><mi id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2">𝐖</ci><ci id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">\mathbf{W}_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">bold_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W}_{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><msub id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2" xref="S2.SS1.p2.6.m6.1.1.2.cmml">𝐖</mi><mi id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2">𝐖</ci><ci id="S2.SS1.p2.6.m6.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">\mathbf{W}_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">bold_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{W}_{v}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><msub id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml"><mi id="S2.SS1.p2.7.m7.1.1.2" xref="S2.SS1.p2.7.m7.1.1.2.cmml">𝐖</mi><mi id="S2.SS1.p2.7.m7.1.1.3" xref="S2.SS1.p2.7.m7.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><apply id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p2.7.m7.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.2">𝐖</ci><ci id="S2.SS1.p2.7.m7.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">\mathbf{W}_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">bold_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> respectively.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Q}=\mathbf{X}\mathbf{W}_{q},\mathbf{K}=\mathbf{X}\mathbf{W}_{k},%
\mathbf{V}=\mathbf{X}\mathbf{W}_{v}" class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.3.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">𝐐</mi><mo id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml">=</mo><msub id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml">𝐗𝐖</mi><mi id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.3a.cmml">,</mo><mrow id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.3.cmml"><mrow id="S2.E1.m1.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.1.1.cmml"><mi id="S2.E1.m1.2.2.2.2.1.1.2" xref="S2.E1.m1.2.2.2.2.1.1.2.cmml">𝐊</mi><mo id="S2.E1.m1.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml">=</mo><msub id="S2.E1.m1.2.2.2.2.1.1.3" xref="S2.E1.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E1.m1.2.2.2.2.1.1.3.2" xref="S2.E1.m1.2.2.2.2.1.1.3.2.cmml">𝐗𝐖</mi><mi id="S2.E1.m1.2.2.2.2.1.1.3.3" xref="S2.E1.m1.2.2.2.2.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S2.E1.m1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S2.E1.m1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.cmml">𝐕</mi><mo id="S2.E1.m1.2.2.2.2.2.2.1" xref="S2.E1.m1.2.2.2.2.2.2.1.cmml">=</mo><msub id="S2.E1.m1.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.3.2" xref="S2.E1.m1.2.2.2.2.2.2.3.2.cmml">𝐗𝐖</mi><mi id="S2.E1.m1.2.2.2.2.2.2.3.3" xref="S2.E1.m1.2.2.2.2.2.2.3.3.cmml">v</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.3a.cmml" xref="S2.E1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"></eq><ci id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2">𝐐</ci><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2">𝐗𝐖</ci><ci id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S2.E1.m1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.3a.cmml" xref="S2.E1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.2.2.2.2.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1"><eq id="S2.E1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1"></eq><ci id="S2.E1.m1.2.2.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.2">𝐊</ci><apply id="S2.E1.m1.2.2.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.3.2">𝐗𝐖</ci><ci id="S2.E1.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.3.3">𝑘</ci></apply></apply><apply id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2"><eq id="S2.E1.m1.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1"></eq><ci id="S2.E1.m1.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2">𝐕</ci><apply id="S2.E1.m1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.3.2">𝐗𝐖</ci><ci id="S2.E1.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\mathbf{Q}=\mathbf{X}\mathbf{W}_{q},\mathbf{K}=\mathbf{X}\mathbf{W}_{k},%
\mathbf{V}=\mathbf{X}\mathbf{W}_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">bold_Q = bold_XW start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_K = bold_XW start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , bold_V = bold_XW start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.6">Note that these projection weights (<math alttext="\mathbf{W}_{q|k|v}" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><msub id="S2.SS1.p3.1.m1.1.2" xref="S2.SS1.p3.1.m1.1.2.cmml"><mi id="S2.SS1.p3.1.m1.1.2.2" xref="S2.SS1.p3.1.m1.1.2.2.cmml">𝐖</mi><mrow id="S2.SS1.p3.1.m1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.3.cmml">q</mi><mo id="S2.SS1.p3.1.m1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.1.m1.1.1.1.4.2" xref="S2.SS1.p3.1.m1.1.1.1.4.1.cmml"><mo id="S2.SS1.p3.1.m1.1.1.1.4.2.1" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.4.1.1.cmml">|</mo><mi id="S2.SS1.p3.1.m1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.cmml">k</mi><mo id="S2.SS1.p3.1.m1.1.1.1.4.2.2" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.4.1.1.cmml">|</mo></mrow><mo id="S2.SS1.p3.1.m1.1.1.1.2a" xref="S2.SS1.p3.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p3.1.m1.1.1.1.5" xref="S2.SS1.p3.1.m1.1.1.1.5.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.2.1.cmml" xref="S2.SS1.p3.1.m1.1.2">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.2.2.cmml" xref="S2.SS1.p3.1.m1.1.2.2">𝐖</ci><apply id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1"><times id="S2.SS1.p3.1.m1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.2"></times><ci id="S2.SS1.p3.1.m1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.3">𝑞</ci><apply id="S2.SS1.p3.1.m1.1.1.1.4.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.4.2"><abs id="S2.SS1.p3.1.m1.1.1.1.4.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.4.2.1"></abs><ci id="S2.SS1.p3.1.m1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1">𝑘</ci></apply><ci id="S2.SS1.p3.1.m1.1.1.1.5.cmml" xref="S2.SS1.p3.1.m1.1.1.1.5">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\mathbf{W}_{q|k|v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">bold_W start_POSTSUBSCRIPT italic_q | italic_k | italic_v end_POSTSUBSCRIPT</annotation></semantics></math>) are unique for each attention head and layer.
The shape of <math alttext="\mathbf{W}_{q|k|v}" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><msub id="S2.SS1.p3.2.m2.1.2" xref="S2.SS1.p3.2.m2.1.2.cmml"><mi id="S2.SS1.p3.2.m2.1.2.2" xref="S2.SS1.p3.2.m2.1.2.2.cmml">𝐖</mi><mrow id="S2.SS1.p3.2.m2.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.1.3" xref="S2.SS1.p3.2.m2.1.1.1.3.cmml">q</mi><mo id="S2.SS1.p3.2.m2.1.1.1.2" xref="S2.SS1.p3.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p3.2.m2.1.1.1.4.2" xref="S2.SS1.p3.2.m2.1.1.1.4.1.cmml"><mo id="S2.SS1.p3.2.m2.1.1.1.4.2.1" stretchy="false" xref="S2.SS1.p3.2.m2.1.1.1.4.1.1.cmml">|</mo><mi id="S2.SS1.p3.2.m2.1.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.1.cmml">k</mi><mo id="S2.SS1.p3.2.m2.1.1.1.4.2.2" stretchy="false" xref="S2.SS1.p3.2.m2.1.1.1.4.1.1.cmml">|</mo></mrow><mo id="S2.SS1.p3.2.m2.1.1.1.2a" xref="S2.SS1.p3.2.m2.1.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p3.2.m2.1.1.1.5" xref="S2.SS1.p3.2.m2.1.1.1.5.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.2.cmml" xref="S2.SS1.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.2.1.cmml" xref="S2.SS1.p3.2.m2.1.2">subscript</csymbol><ci id="S2.SS1.p3.2.m2.1.2.2.cmml" xref="S2.SS1.p3.2.m2.1.2.2">𝐖</ci><apply id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1"><times id="S2.SS1.p3.2.m2.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1.2"></times><ci id="S2.SS1.p3.2.m2.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.1.3">𝑞</ci><apply id="S2.SS1.p3.2.m2.1.1.1.4.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.4.2"><abs id="S2.SS1.p3.2.m2.1.1.1.4.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.4.2.1"></abs><ci id="S2.SS1.p3.2.m2.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1">𝑘</ci></apply><ci id="S2.SS1.p3.2.m2.1.1.1.5.cmml" xref="S2.SS1.p3.2.m2.1.1.1.5">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">\mathbf{W}_{q|k|v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">bold_W start_POSTSUBSCRIPT italic_q | italic_k | italic_v end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="\mathcal{R}^{{d}\times d_{\mathrm{head}}}" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.1"><semantics id="S2.SS1.p3.3.m3.1a"><msup id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.3.m3.1.1.2" xref="S2.SS1.p3.3.m3.1.1.2.cmml">ℛ</mi><mrow id="S2.SS1.p3.3.m3.1.1.3" xref="S2.SS1.p3.3.m3.1.1.3.cmml"><mi id="S2.SS1.p3.3.m3.1.1.3.2" xref="S2.SS1.p3.3.m3.1.1.3.2.cmml">d</mi><mo id="S2.SS1.p3.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.3.m3.1.1.3.1.cmml">×</mo><msub id="S2.SS1.p3.3.m3.1.1.3.3" xref="S2.SS1.p3.3.m3.1.1.3.3.cmml"><mi id="S2.SS1.p3.3.m3.1.1.3.3.2" xref="S2.SS1.p3.3.m3.1.1.3.3.2.cmml">d</mi><mi id="S2.SS1.p3.3.m3.1.1.3.3.3" xref="S2.SS1.p3.3.m3.1.1.3.3.3.cmml">head</mi></msub></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><apply id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">superscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.2">ℛ</ci><apply id="S2.SS1.p3.3.m3.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3"><times id="S2.SS1.p3.3.m3.1.1.3.1.cmml" xref="S2.SS1.p3.3.m3.1.1.3.1"></times><ci id="S2.SS1.p3.3.m3.1.1.3.2.cmml" xref="S2.SS1.p3.3.m3.1.1.3.2">𝑑</ci><apply id="S2.SS1.p3.3.m3.1.1.3.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S2.SS1.p3.3.m3.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="S2.SS1.p3.3.m3.1.1.3.3.2">𝑑</ci><ci id="S2.SS1.p3.3.m3.1.1.3.3.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3.3.3">head</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">\mathcal{R}^{{d}\times d_{\mathrm{head}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.1d">caligraphic_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, which results in <math alttext="\mathbf{Q,~{}K,~{}V}\in\mathcal{R}^{{L}\times d_{\mathrm{head}}}" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.3"><semantics id="S2.SS1.p3.4.m4.3a"><mrow id="S2.SS1.p3.4.m4.3.4" xref="S2.SS1.p3.4.m4.3.4.cmml"><mrow id="S2.SS1.p3.4.m4.3.4.2.2" xref="S2.SS1.p3.4.m4.3.4.2.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">𝐐</mi><mo id="S2.SS1.p3.4.m4.3.4.2.2.1" rspace="0.497em" xref="S2.SS1.p3.4.m4.3.4.2.1.cmml">,</mo><mi id="S2.SS1.p3.4.m4.2.2" xref="S2.SS1.p3.4.m4.2.2.cmml">𝐊</mi><mo id="S2.SS1.p3.4.m4.3.4.2.2.2" rspace="0.497em" xref="S2.SS1.p3.4.m4.3.4.2.1.cmml">,</mo><mi id="S2.SS1.p3.4.m4.3.3" xref="S2.SS1.p3.4.m4.3.3.cmml">𝐕</mi></mrow><mo id="S2.SS1.p3.4.m4.3.4.1" xref="S2.SS1.p3.4.m4.3.4.1.cmml">∈</mo><msup id="S2.SS1.p3.4.m4.3.4.3" xref="S2.SS1.p3.4.m4.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.4.m4.3.4.3.2" xref="S2.SS1.p3.4.m4.3.4.3.2.cmml">ℛ</mi><mrow id="S2.SS1.p3.4.m4.3.4.3.3" xref="S2.SS1.p3.4.m4.3.4.3.3.cmml"><mi id="S2.SS1.p3.4.m4.3.4.3.3.2" xref="S2.SS1.p3.4.m4.3.4.3.3.2.cmml">L</mi><mo id="S2.SS1.p3.4.m4.3.4.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.4.m4.3.4.3.3.1.cmml">×</mo><msub id="S2.SS1.p3.4.m4.3.4.3.3.3" xref="S2.SS1.p3.4.m4.3.4.3.3.3.cmml"><mi id="S2.SS1.p3.4.m4.3.4.3.3.3.2" xref="S2.SS1.p3.4.m4.3.4.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p3.4.m4.3.4.3.3.3.3" xref="S2.SS1.p3.4.m4.3.4.3.3.3.3.cmml">head</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.3b"><apply id="S2.SS1.p3.4.m4.3.4.cmml" xref="S2.SS1.p3.4.m4.3.4"><in id="S2.SS1.p3.4.m4.3.4.1.cmml" xref="S2.SS1.p3.4.m4.3.4.1"></in><list id="S2.SS1.p3.4.m4.3.4.2.1.cmml" xref="S2.SS1.p3.4.m4.3.4.2.2"><ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">𝐐</ci><ci id="S2.SS1.p3.4.m4.2.2.cmml" xref="S2.SS1.p3.4.m4.2.2">𝐊</ci><ci id="S2.SS1.p3.4.m4.3.3.cmml" xref="S2.SS1.p3.4.m4.3.3">𝐕</ci></list><apply id="S2.SS1.p3.4.m4.3.4.3.cmml" xref="S2.SS1.p3.4.m4.3.4.3"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.3.4.3.1.cmml" xref="S2.SS1.p3.4.m4.3.4.3">superscript</csymbol><ci id="S2.SS1.p3.4.m4.3.4.3.2.cmml" xref="S2.SS1.p3.4.m4.3.4.3.2">ℛ</ci><apply id="S2.SS1.p3.4.m4.3.4.3.3.cmml" xref="S2.SS1.p3.4.m4.3.4.3.3"><times id="S2.SS1.p3.4.m4.3.4.3.3.1.cmml" xref="S2.SS1.p3.4.m4.3.4.3.3.1"></times><ci id="S2.SS1.p3.4.m4.3.4.3.3.2.cmml" xref="S2.SS1.p3.4.m4.3.4.3.3.2">𝐿</ci><apply id="S2.SS1.p3.4.m4.3.4.3.3.3.cmml" xref="S2.SS1.p3.4.m4.3.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.3.4.3.3.3.1.cmml" xref="S2.SS1.p3.4.m4.3.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p3.4.m4.3.4.3.3.3.2.cmml" xref="S2.SS1.p3.4.m4.3.4.3.3.3.2">𝑑</ci><ci id="S2.SS1.p3.4.m4.3.4.3.3.3.3.cmml" xref="S2.SS1.p3.4.m4.3.4.3.3.3.3">head</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.3c">\mathbf{Q,~{}K,~{}V}\in\mathcal{R}^{{L}\times d_{\mathrm{head}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.3d">bold_Q , bold_K , bold_V ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L × italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Head dimension <math alttext="d_{\mathrm{head}}" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m5.1"><semantics id="S2.SS1.p3.5.m5.1a"><msub id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">d</mi><mi id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml">head</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝑑</ci><ci id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3">head</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">d_{\mathrm{head}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m6.1"><semantics id="S2.SS1.p3.6.m6.1a"><mi id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><ci id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m6.1d">italic_d</annotation></semantics></math> divided by the number of attention heads in a layer.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">Scaled dot-product attention, <math alttext="\mathrm{attn}(\mathbf{X})" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><mrow id="S2.SS1.p4.1.m1.1.2" xref="S2.SS1.p4.1.m1.1.2.cmml"><mi id="S2.SS1.p4.1.m1.1.2.2" xref="S2.SS1.p4.1.m1.1.2.2.cmml">attn</mi><mo id="S2.SS1.p4.1.m1.1.2.1" xref="S2.SS1.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p4.1.m1.1.2.3.2" xref="S2.SS1.p4.1.m1.1.2.cmml"><mo id="S2.SS1.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS1.p4.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">𝐗</mi><mo id="S2.SS1.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS1.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.2"><times id="S2.SS1.p4.1.m1.1.2.1.cmml" xref="S2.SS1.p4.1.m1.1.2.1"></times><ci id="S2.SS1.p4.1.m1.1.2.2.cmml" xref="S2.SS1.p4.1.m1.1.2.2">attn</ci><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\mathrm{attn}(\mathbf{X})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">roman_attn ( bold_X )</annotation></semantics></math>, that each MHA head computes is defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{attn}(\mathbf{X})=s\Big{(}\mathbf{Q}\mathbf{K}^{\top}/\sqrt{d_{\mathrm%
{head}}}\Big{)}\mathbf{V}=\mathbf{H}\mathbf{V}\in\mathcal{R}^{L\times d_{%
\mathrm{head}}}" class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mrow id="S2.E2.m1.2.2.3" xref="S2.E2.m1.2.2.3.cmml"><mi id="S2.E2.m1.2.2.3.2" xref="S2.E2.m1.2.2.3.2.cmml">attn</mi><mo id="S2.E2.m1.2.2.3.1" xref="S2.E2.m1.2.2.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.3.3.2" xref="S2.E2.m1.2.2.3.cmml"><mo id="S2.E2.m1.2.2.3.3.2.1" stretchy="false" xref="S2.E2.m1.2.2.3.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">𝐗</mi><mo id="S2.E2.m1.2.2.3.3.2.2" stretchy="false" xref="S2.E2.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.4" xref="S2.E2.m1.2.2.4.cmml">=</mo><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.cmml"><mi id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.2.2.1.3.cmml">s</mi><mo id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.2" maxsize="160%" minsize="160%" xref="S2.E2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><msup id="S2.E2.m1.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.1.1.2.2.cmml">𝐐𝐊</mi><mo id="S2.E2.m1.2.2.1.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.1.1.2.3.cmml">⊤</mo></msup><mo id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.cmml">/</mo><msqrt id="S2.E2.m1.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.3.cmml"><msub id="S2.E2.m1.2.2.1.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.1.1.3.2.2.cmml">d</mi><mi id="S2.E2.m1.2.2.1.1.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.1.1.3.2.3.cmml">head</mi></msub></msqrt></mrow><mo id="S2.E2.m1.2.2.1.1.1.3" maxsize="160%" minsize="160%" xref="S2.E2.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.2.2.1.2a" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.4" xref="S2.E2.m1.2.2.1.4.cmml">𝐕</mi></mrow><mo id="S2.E2.m1.2.2.5" xref="S2.E2.m1.2.2.5.cmml">=</mo><mi id="S2.E2.m1.2.2.6" xref="S2.E2.m1.2.2.6.cmml">𝐇𝐕</mi><mo id="S2.E2.m1.2.2.7" xref="S2.E2.m1.2.2.7.cmml">∈</mo><msup id="S2.E2.m1.2.2.8" xref="S2.E2.m1.2.2.8.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.8.2" xref="S2.E2.m1.2.2.8.2.cmml">ℛ</mi><mrow id="S2.E2.m1.2.2.8.3" xref="S2.E2.m1.2.2.8.3.cmml"><mi id="S2.E2.m1.2.2.8.3.2" xref="S2.E2.m1.2.2.8.3.2.cmml">L</mi><mo id="S2.E2.m1.2.2.8.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.2.2.8.3.1.cmml">×</mo><msub id="S2.E2.m1.2.2.8.3.3" xref="S2.E2.m1.2.2.8.3.3.cmml"><mi id="S2.E2.m1.2.2.8.3.3.2" xref="S2.E2.m1.2.2.8.3.3.2.cmml">d</mi><mi id="S2.E2.m1.2.2.8.3.3.3" xref="S2.E2.m1.2.2.8.3.3.3.cmml">head</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><and id="S2.E2.m1.2.2a.cmml" xref="S2.E2.m1.2.2"></and><apply id="S2.E2.m1.2.2b.cmml" xref="S2.E2.m1.2.2"><eq id="S2.E2.m1.2.2.4.cmml" xref="S2.E2.m1.2.2.4"></eq><apply id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2.3"><times id="S2.E2.m1.2.2.3.1.cmml" xref="S2.E2.m1.2.2.3.1"></times><ci id="S2.E2.m1.2.2.3.2.cmml" xref="S2.E2.m1.2.2.3.2">attn</ci><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝐗</ci></apply><apply id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.2.2.1"><times id="S2.E2.m1.2.2.1.2.cmml" xref="S2.E2.m1.2.2.1.2"></times><ci id="S2.E2.m1.2.2.1.3.cmml" xref="S2.E2.m1.2.2.1.3">𝑠</ci><apply id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><divide id="S2.E2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"></divide><apply id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2">𝐐𝐊</ci><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.3">top</csymbol></apply><apply id="S2.E2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3"><root id="S2.E2.m1.2.2.1.1.1.1.3a.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3"></root><apply id="S2.E2.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.2.2">𝑑</ci><ci id="S2.E2.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.2.3">head</ci></apply></apply></apply><ci id="S2.E2.m1.2.2.1.4.cmml" xref="S2.E2.m1.2.2.1.4">𝐕</ci></apply></apply><apply id="S2.E2.m1.2.2c.cmml" xref="S2.E2.m1.2.2"><eq id="S2.E2.m1.2.2.5.cmml" xref="S2.E2.m1.2.2.5"></eq><share href="#S2.E2.m1.2.2.1.cmml" id="S2.E2.m1.2.2d.cmml" xref="S2.E2.m1.2.2"></share><ci id="S2.E2.m1.2.2.6.cmml" xref="S2.E2.m1.2.2.6">𝐇𝐕</ci></apply><apply id="S2.E2.m1.2.2e.cmml" xref="S2.E2.m1.2.2"><in id="S2.E2.m1.2.2.7.cmml" xref="S2.E2.m1.2.2.7"></in><share href="#S2.E2.m1.2.2.6.cmml" id="S2.E2.m1.2.2f.cmml" xref="S2.E2.m1.2.2"></share><apply id="S2.E2.m1.2.2.8.cmml" xref="S2.E2.m1.2.2.8"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.8.1.cmml" xref="S2.E2.m1.2.2.8">superscript</csymbol><ci id="S2.E2.m1.2.2.8.2.cmml" xref="S2.E2.m1.2.2.8.2">ℛ</ci><apply id="S2.E2.m1.2.2.8.3.cmml" xref="S2.E2.m1.2.2.8.3"><times id="S2.E2.m1.2.2.8.3.1.cmml" xref="S2.E2.m1.2.2.8.3.1"></times><ci id="S2.E2.m1.2.2.8.3.2.cmml" xref="S2.E2.m1.2.2.8.3.2">𝐿</ci><apply id="S2.E2.m1.2.2.8.3.3.cmml" xref="S2.E2.m1.2.2.8.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.8.3.3.1.cmml" xref="S2.E2.m1.2.2.8.3.3">subscript</csymbol><ci id="S2.E2.m1.2.2.8.3.3.2.cmml" xref="S2.E2.m1.2.2.8.3.3.2">𝑑</ci><ci id="S2.E2.m1.2.2.8.3.3.3.cmml" xref="S2.E2.m1.2.2.8.3.3.3">head</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\mathrm{attn}(\mathbf{X})=s\Big{(}\mathbf{Q}\mathbf{K}^{\top}/\sqrt{d_{\mathrm%
{head}}}\Big{)}\mathbf{V}=\mathbf{H}\mathbf{V}\in\mathcal{R}^{L\times d_{%
\mathrm{head}}}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">roman_attn ( bold_X ) = italic_s ( bold_QK start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT / square-root start_ARG italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT end_ARG ) bold_V = bold_HV ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L × italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p4.5">where <math alttext="s(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m1.1"><semantics id="S2.SS1.p4.2.m1.1a"><mrow id="S2.SS1.p4.2.m1.1.2" xref="S2.SS1.p4.2.m1.1.2.cmml"><mi id="S2.SS1.p4.2.m1.1.2.2" xref="S2.SS1.p4.2.m1.1.2.2.cmml">s</mi><mo id="S2.SS1.p4.2.m1.1.2.1" xref="S2.SS1.p4.2.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p4.2.m1.1.2.3.2" xref="S2.SS1.p4.2.m1.1.2.cmml"><mo id="S2.SS1.p4.2.m1.1.2.3.2.1" stretchy="false" xref="S2.SS1.p4.2.m1.1.2.cmml">(</mo><mo id="S2.SS1.p4.2.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS1.p4.2.m1.1.1.cmml">⋅</mo><mo id="S2.SS1.p4.2.m1.1.2.3.2.2" stretchy="false" xref="S2.SS1.p4.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m1.1b"><apply id="S2.SS1.p4.2.m1.1.2.cmml" xref="S2.SS1.p4.2.m1.1.2"><times id="S2.SS1.p4.2.m1.1.2.1.cmml" xref="S2.SS1.p4.2.m1.1.2.1"></times><ci id="S2.SS1.p4.2.m1.1.2.2.cmml" xref="S2.SS1.p4.2.m1.1.2.2">𝑠</ci><ci id="S2.SS1.p4.2.m1.1.1.cmml" xref="S2.SS1.p4.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m1.1c">s(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m1.1d">italic_s ( ⋅ )</annotation></semantics></math> denotes a softmax function.
The attention output denoted by <math alttext="\mathrm{attn(\mathbf{X})}" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m2.1"><semantics id="S2.SS1.p4.3.m2.1a"><mrow id="S2.SS1.p4.3.m2.1.2" xref="S2.SS1.p4.3.m2.1.2.cmml"><mi id="S2.SS1.p4.3.m2.1.2.2" xref="S2.SS1.p4.3.m2.1.2.2.cmml">attn</mi><mo id="S2.SS1.p4.3.m2.1.2.1" xref="S2.SS1.p4.3.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p4.3.m2.1.2.3.2" xref="S2.SS1.p4.3.m2.1.2.cmml"><mo id="S2.SS1.p4.3.m2.1.2.3.2.1" stretchy="false" xref="S2.SS1.p4.3.m2.1.2.cmml">(</mo><mi id="S2.SS1.p4.3.m2.1.1" xref="S2.SS1.p4.3.m2.1.1.cmml">𝐗</mi><mo id="S2.SS1.p4.3.m2.1.2.3.2.2" stretchy="false" xref="S2.SS1.p4.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m2.1b"><apply id="S2.SS1.p4.3.m2.1.2.cmml" xref="S2.SS1.p4.3.m2.1.2"><times id="S2.SS1.p4.3.m2.1.2.1.cmml" xref="S2.SS1.p4.3.m2.1.2.1"></times><ci id="S2.SS1.p4.3.m2.1.2.2.cmml" xref="S2.SS1.p4.3.m2.1.2.2">attn</ci><ci id="S2.SS1.p4.3.m2.1.1.cmml" xref="S2.SS1.p4.3.m2.1.1">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m2.1c">\mathrm{attn(\mathbf{X})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m2.1d">roman_attn ( bold_X )</annotation></semantics></math> is concatenated over <math alttext="d_{\mathrm{head}}" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m3.1"><semantics id="S2.SS1.p4.4.m3.1a"><msub id="S2.SS1.p4.4.m3.1.1" xref="S2.SS1.p4.4.m3.1.1.cmml"><mi id="S2.SS1.p4.4.m3.1.1.2" xref="S2.SS1.p4.4.m3.1.1.2.cmml">d</mi><mi id="S2.SS1.p4.4.m3.1.1.3" xref="S2.SS1.p4.4.m3.1.1.3.cmml">head</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m3.1b"><apply id="S2.SS1.p4.4.m3.1.1.cmml" xref="S2.SS1.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.4.m3.1.1.1.cmml" xref="S2.SS1.p4.4.m3.1.1">subscript</csymbol><ci id="S2.SS1.p4.4.m3.1.1.2.cmml" xref="S2.SS1.p4.4.m3.1.1.2">𝑑</ci><ci id="S2.SS1.p4.4.m3.1.1.3.cmml" xref="S2.SS1.p4.4.m3.1.1.3">head</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m3.1c">d_{\mathrm{head}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m3.1d">italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT</annotation></semantics></math> to form MHA of shape <math alttext="\mathcal{R}^{L\times d}" class="ltx_Math" display="inline" id="S2.SS1.p4.5.m4.1"><semantics id="S2.SS1.p4.5.m4.1a"><msup id="S2.SS1.p4.5.m4.1.1" xref="S2.SS1.p4.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.5.m4.1.1.2" xref="S2.SS1.p4.5.m4.1.1.2.cmml">ℛ</mi><mrow id="S2.SS1.p4.5.m4.1.1.3" xref="S2.SS1.p4.5.m4.1.1.3.cmml"><mi id="S2.SS1.p4.5.m4.1.1.3.2" xref="S2.SS1.p4.5.m4.1.1.3.2.cmml">L</mi><mo id="S2.SS1.p4.5.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p4.5.m4.1.1.3.1.cmml">×</mo><mi id="S2.SS1.p4.5.m4.1.1.3.3" xref="S2.SS1.p4.5.m4.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.5.m4.1b"><apply id="S2.SS1.p4.5.m4.1.1.cmml" xref="S2.SS1.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.5.m4.1.1.1.cmml" xref="S2.SS1.p4.5.m4.1.1">superscript</csymbol><ci id="S2.SS1.p4.5.m4.1.1.2.cmml" xref="S2.SS1.p4.5.m4.1.1.2">ℛ</ci><apply id="S2.SS1.p4.5.m4.1.1.3.cmml" xref="S2.SS1.p4.5.m4.1.1.3"><times id="S2.SS1.p4.5.m4.1.1.3.1.cmml" xref="S2.SS1.p4.5.m4.1.1.3.1"></times><ci id="S2.SS1.p4.5.m4.1.1.3.2.cmml" xref="S2.SS1.p4.5.m4.1.1.3.2">𝐿</ci><ci id="S2.SS1.p4.5.m4.1.1.3.3.cmml" xref="S2.SS1.p4.5.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.5.m4.1c">\mathcal{R}^{L\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.5.m4.1d">caligraphic_R start_POSTSUPERSCRIPT italic_L × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.2"><span class="ltx_text ltx_font_bold" id="S2.SS1.p5.2.1">Attention map</span> denoted by <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S2.SS1.p5.1.m1.1"><semantics id="S2.SS1.p5.1.m1.1a"><mi id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.1.m1.1d">bold_H</annotation></semantics></math> above, is the scaled dot-product of the query-key for each head, represented as <math alttext="s(\mathbf{QK^{\top}}/\sqrt{d_{\mathrm{head}})}\in\mathcal{R}^{L\times L}" class="ltx_math_unparsed" display="inline" id="S2.SS1.p5.2.m2.1"><semantics id="S2.SS1.p5.2.m2.1a"><mrow id="S2.SS1.p5.2.m2.1b"><mi id="S2.SS1.p5.2.m2.1.1">s</mi><mrow id="S2.SS1.p5.2.m2.1.2"><mo id="S2.SS1.p5.2.m2.1.2.1" stretchy="false">(</mo><msup id="S2.SS1.p5.2.m2.1.2.2"><mi id="S2.SS1.p5.2.m2.1.2.2.2">𝐐𝐊</mi><mo id="S2.SS1.p5.2.m2.1.2.2.3">⊤</mo></msup><mo id="S2.SS1.p5.2.m2.1.2.3">/</mo><msqrt id="S2.SS1.p5.2.m2.1.2.4"><mrow id="S2.SS1.p5.2.m2.1.2.4.2"><msub id="S2.SS1.p5.2.m2.1.2.4.2.1"><mi id="S2.SS1.p5.2.m2.1.2.4.2.1.2">d</mi><mi id="S2.SS1.p5.2.m2.1.2.4.2.1.3">head</mi></msub><mo id="S2.SS1.p5.2.m2.1.2.4.2.2" stretchy="false">)</mo></mrow></msqrt><mo id="S2.SS1.p5.2.m2.1.2.5">∈</mo><msup id="S2.SS1.p5.2.m2.1.2.6"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p5.2.m2.1.2.6.2">ℛ</mi><mrow id="S2.SS1.p5.2.m2.1.2.6.3"><mi id="S2.SS1.p5.2.m2.1.2.6.3.2">L</mi><mo id="S2.SS1.p5.2.m2.1.2.6.3.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S2.SS1.p5.2.m2.1.2.6.3.3">L</mi></mrow></msup></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">s(\mathbf{QK^{\top}}/\sqrt{d_{\mathrm{head}})}\in\mathcal{R}^{L\times L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.2.m2.1d">italic_s ( bold_QK start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT / square-root start_ARG italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT ) end_ARG ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.
To make clearer notion of distinct heads and layers, throughout the paper the attention map will appear as:</p>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}_{(m,n)}=s\left(\mathbf{Q}_{(m,n)}\mathbf{K}^{\top}_{(m,n)}/\sqrt{d_%
{\mathrm{head}}}\right)\in\mathcal{R}^{L\times L}" class="ltx_Math" display="block" id="S2.E3.m1.7"><semantics id="S2.E3.m1.7a"><mrow id="S2.E3.m1.7.7" xref="S2.E3.m1.7.7.cmml"><msub id="S2.E3.m1.7.7.3" xref="S2.E3.m1.7.7.3.cmml"><mi id="S2.E3.m1.7.7.3.2" xref="S2.E3.m1.7.7.3.2.cmml">𝐇</mi><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.3.cmml"><mo id="S2.E3.m1.2.2.2.4.1" stretchy="false" xref="S2.E3.m1.2.2.2.3.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">m</mi><mo id="S2.E3.m1.2.2.2.4.2" xref="S2.E3.m1.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">n</mi><mo id="S2.E3.m1.2.2.2.4.3" stretchy="false" xref="S2.E3.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo id="S2.E3.m1.7.7.4" xref="S2.E3.m1.7.7.4.cmml">=</mo><mrow id="S2.E3.m1.7.7.1" xref="S2.E3.m1.7.7.1.cmml"><mi id="S2.E3.m1.7.7.1.3" xref="S2.E3.m1.7.7.1.3.cmml">s</mi><mo id="S2.E3.m1.7.7.1.2" xref="S2.E3.m1.7.7.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mo id="S2.E3.m1.7.7.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.7.7.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.2.cmml"><msub id="S2.E3.m1.7.7.1.1.1.1.2.2" xref="S2.E3.m1.7.7.1.1.1.1.2.2.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.2.2.2" xref="S2.E3.m1.7.7.1.1.1.1.2.2.2.cmml">𝐐</mi><mrow id="S2.E3.m1.4.4.2.4" xref="S2.E3.m1.4.4.2.3.cmml"><mo id="S2.E3.m1.4.4.2.4.1" stretchy="false" xref="S2.E3.m1.4.4.2.3.cmml">(</mo><mi id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml">m</mi><mo id="S2.E3.m1.4.4.2.4.2" xref="S2.E3.m1.4.4.2.3.cmml">,</mo><mi id="S2.E3.m1.4.4.2.2" xref="S2.E3.m1.4.4.2.2.cmml">n</mi><mo id="S2.E3.m1.4.4.2.4.3" stretchy="false" xref="S2.E3.m1.4.4.2.3.cmml">)</mo></mrow></msub><mo id="S2.E3.m1.7.7.1.1.1.1.2.1" xref="S2.E3.m1.7.7.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S2.E3.m1.7.7.1.1.1.1.2.3" xref="S2.E3.m1.7.7.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.2.3.2.2" xref="S2.E3.m1.7.7.1.1.1.1.2.3.2.2.cmml">𝐊</mi><mrow id="S2.E3.m1.6.6.2.4" xref="S2.E3.m1.6.6.2.3.cmml"><mo id="S2.E3.m1.6.6.2.4.1" stretchy="false" xref="S2.E3.m1.6.6.2.3.cmml">(</mo><mi id="S2.E3.m1.5.5.1.1" xref="S2.E3.m1.5.5.1.1.cmml">m</mi><mo id="S2.E3.m1.6.6.2.4.2" xref="S2.E3.m1.6.6.2.3.cmml">,</mo><mi id="S2.E3.m1.6.6.2.2" xref="S2.E3.m1.6.6.2.2.cmml">n</mi><mo id="S2.E3.m1.6.6.2.4.3" stretchy="false" xref="S2.E3.m1.6.6.2.3.cmml">)</mo></mrow><mo id="S2.E3.m1.7.7.1.1.1.1.2.3.2.3" xref="S2.E3.m1.7.7.1.1.1.1.2.3.2.3.cmml">⊤</mo></msubsup></mrow><mo id="S2.E3.m1.7.7.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.cmml">/</mo><msqrt id="S2.E3.m1.7.7.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.3.cmml"><msub id="S2.E3.m1.7.7.1.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.3.2.2" xref="S2.E3.m1.7.7.1.1.1.1.3.2.2.cmml">d</mi><mi id="S2.E3.m1.7.7.1.1.1.1.3.2.3" xref="S2.E3.m1.7.7.1.1.1.1.3.2.3.cmml">head</mi></msub></msqrt></mrow><mo id="S2.E3.m1.7.7.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.7.7.5" xref="S2.E3.m1.7.7.5.cmml">∈</mo><msup id="S2.E3.m1.7.7.6" xref="S2.E3.m1.7.7.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.7.7.6.2" xref="S2.E3.m1.7.7.6.2.cmml">ℛ</mi><mrow id="S2.E3.m1.7.7.6.3" xref="S2.E3.m1.7.7.6.3.cmml"><mi id="S2.E3.m1.7.7.6.3.2" xref="S2.E3.m1.7.7.6.3.2.cmml">L</mi><mo id="S2.E3.m1.7.7.6.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E3.m1.7.7.6.3.1.cmml">×</mo><mi id="S2.E3.m1.7.7.6.3.3" xref="S2.E3.m1.7.7.6.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.7b"><apply id="S2.E3.m1.7.7.cmml" xref="S2.E3.m1.7.7"><and id="S2.E3.m1.7.7a.cmml" xref="S2.E3.m1.7.7"></and><apply id="S2.E3.m1.7.7b.cmml" xref="S2.E3.m1.7.7"><eq id="S2.E3.m1.7.7.4.cmml" xref="S2.E3.m1.7.7.4"></eq><apply id="S2.E3.m1.7.7.3.cmml" xref="S2.E3.m1.7.7.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.3.1.cmml" xref="S2.E3.m1.7.7.3">subscript</csymbol><ci id="S2.E3.m1.7.7.3.2.cmml" xref="S2.E3.m1.7.7.3.2">𝐇</ci><interval closure="open" id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑚</ci><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">𝑛</ci></interval></apply><apply id="S2.E3.m1.7.7.1.cmml" xref="S2.E3.m1.7.7.1"><times id="S2.E3.m1.7.7.1.2.cmml" xref="S2.E3.m1.7.7.1.2"></times><ci id="S2.E3.m1.7.7.1.3.cmml" xref="S2.E3.m1.7.7.1.3">𝑠</ci><apply id="S2.E3.m1.7.7.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1"><divide id="S2.E3.m1.7.7.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1"></divide><apply id="S2.E3.m1.7.7.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2"><times id="S2.E3.m1.7.7.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.1"></times><apply id="S2.E3.m1.7.7.1.1.1.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.2.2">𝐐</ci><interval closure="open" id="S2.E3.m1.4.4.2.3.cmml" xref="S2.E3.m1.4.4.2.4"><ci id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1">𝑚</ci><ci id="S2.E3.m1.4.4.2.2.cmml" xref="S2.E3.m1.4.4.2.2">𝑛</ci></interval></apply><apply id="S2.E3.m1.7.7.1.1.1.1.2.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3">subscript</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.2.3.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3">superscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.2.3.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.2.2">𝐊</ci><csymbol cd="latexml" id="S2.E3.m1.7.7.1.1.1.1.2.3.2.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.2.3">top</csymbol></apply><interval closure="open" id="S2.E3.m1.6.6.2.3.cmml" xref="S2.E3.m1.6.6.2.4"><ci id="S2.E3.m1.5.5.1.1.cmml" xref="S2.E3.m1.5.5.1.1">𝑚</ci><ci id="S2.E3.m1.6.6.2.2.cmml" xref="S2.E3.m1.6.6.2.2">𝑛</ci></interval></apply></apply><apply id="S2.E3.m1.7.7.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3"><root id="S2.E3.m1.7.7.1.1.1.1.3a.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3"></root><apply id="S2.E3.m1.7.7.1.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3.2.2">𝑑</ci><ci id="S2.E3.m1.7.7.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3.2.3">head</ci></apply></apply></apply></apply></apply><apply id="S2.E3.m1.7.7c.cmml" xref="S2.E3.m1.7.7"><in id="S2.E3.m1.7.7.5.cmml" xref="S2.E3.m1.7.7.5"></in><share href="#S2.E3.m1.7.7.1.cmml" id="S2.E3.m1.7.7d.cmml" xref="S2.E3.m1.7.7"></share><apply id="S2.E3.m1.7.7.6.cmml" xref="S2.E3.m1.7.7.6"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.6.1.cmml" xref="S2.E3.m1.7.7.6">superscript</csymbol><ci id="S2.E3.m1.7.7.6.2.cmml" xref="S2.E3.m1.7.7.6.2">ℛ</ci><apply id="S2.E3.m1.7.7.6.3.cmml" xref="S2.E3.m1.7.7.6.3"><times id="S2.E3.m1.7.7.6.3.1.cmml" xref="S2.E3.m1.7.7.6.3.1"></times><ci id="S2.E3.m1.7.7.6.3.2.cmml" xref="S2.E3.m1.7.7.6.3.2">𝐿</ci><ci id="S2.E3.m1.7.7.6.3.3.cmml" xref="S2.E3.m1.7.7.6.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.7c">\mathbf{H}_{(m,n)}=s\left(\mathbf{Q}_{(m,n)}\mathbf{K}^{\top}_{(m,n)}/\sqrt{d_%
{\mathrm{head}}}\right)\in\mathcal{R}^{L\times L}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.7d">bold_H start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT = italic_s ( bold_Q start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT bold_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT / square-root start_ARG italic_d start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT end_ARG ) ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p6.8">where <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p6.1.m1.1"><semantics id="S2.SS1.p6.1.m1.1a"><mi id="S2.SS1.p6.1.m1.1.1" xref="S2.SS1.p6.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.1b"><ci id="S2.SS1.p6.1.m1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.1.m1.1d">italic_m</annotation></semantics></math> and <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p6.2.m2.1"><semantics id="S2.SS1.p6.2.m2.1a"><mi id="S2.SS1.p6.2.m2.1.1" xref="S2.SS1.p6.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.2.m2.1b"><ci id="S2.SS1.p6.2.m2.1.1.cmml" xref="S2.SS1.p6.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.2.m2.1d">italic_n</annotation></semantics></math> serve as indices for head and layer inside the whole Transformer architecture.
Thus, <math alttext="\mathbf{H}_{(m,n)}" class="ltx_Math" display="inline" id="S2.SS1.p6.3.m3.2"><semantics id="S2.SS1.p6.3.m3.2a"><msub id="S2.SS1.p6.3.m3.2.3" xref="S2.SS1.p6.3.m3.2.3.cmml"><mi id="S2.SS1.p6.3.m3.2.3.2" xref="S2.SS1.p6.3.m3.2.3.2.cmml">𝐇</mi><mrow id="S2.SS1.p6.3.m3.2.2.2.4" xref="S2.SS1.p6.3.m3.2.2.2.3.cmml"><mo id="S2.SS1.p6.3.m3.2.2.2.4.1" stretchy="false" xref="S2.SS1.p6.3.m3.2.2.2.3.cmml">(</mo><mi id="S2.SS1.p6.3.m3.1.1.1.1" xref="S2.SS1.p6.3.m3.1.1.1.1.cmml">m</mi><mo id="S2.SS1.p6.3.m3.2.2.2.4.2" xref="S2.SS1.p6.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p6.3.m3.2.2.2.2" xref="S2.SS1.p6.3.m3.2.2.2.2.cmml">n</mi><mo id="S2.SS1.p6.3.m3.2.2.2.4.3" stretchy="false" xref="S2.SS1.p6.3.m3.2.2.2.3.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.3.m3.2b"><apply id="S2.SS1.p6.3.m3.2.3.cmml" xref="S2.SS1.p6.3.m3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.2.3.1.cmml" xref="S2.SS1.p6.3.m3.2.3">subscript</csymbol><ci id="S2.SS1.p6.3.m3.2.3.2.cmml" xref="S2.SS1.p6.3.m3.2.3.2">𝐇</ci><interval closure="open" id="S2.SS1.p6.3.m3.2.2.2.3.cmml" xref="S2.SS1.p6.3.m3.2.2.2.4"><ci id="S2.SS1.p6.3.m3.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.1.1.1.1">𝑚</ci><ci id="S2.SS1.p6.3.m3.2.2.2.2.cmml" xref="S2.SS1.p6.3.m3.2.2.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.3.m3.2c">\mathbf{H}_{(m,n)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.3.m3.2d">bold_H start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT</annotation></semantics></math> represents as attention map <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p6.4.m4.1"><semantics id="S2.SS1.p6.4.m4.1a"><mi id="S2.SS1.p6.4.m4.1.1" xref="S2.SS1.p6.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.4.m4.1b"><ci id="S2.SS1.p6.4.m4.1.1.cmml" xref="S2.SS1.p6.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.4.m4.1d">italic_m</annotation></semantics></math>-th head in <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p6.5.m5.1"><semantics id="S2.SS1.p6.5.m5.1a"><mi id="S2.SS1.p6.5.m5.1.1" xref="S2.SS1.p6.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.5.m5.1b"><ci id="S2.SS1.p6.5.m5.1.1.cmml" xref="S2.SS1.p6.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.5.m5.1d">italic_n</annotation></semantics></math>-th Transformer layer.
Similarly <math alttext="\mathbf{Q}_{(m,n)}" class="ltx_Math" display="inline" id="S2.SS1.p6.6.m6.2"><semantics id="S2.SS1.p6.6.m6.2a"><msub id="S2.SS1.p6.6.m6.2.3" xref="S2.SS1.p6.6.m6.2.3.cmml"><mi id="S2.SS1.p6.6.m6.2.3.2" xref="S2.SS1.p6.6.m6.2.3.2.cmml">𝐐</mi><mrow id="S2.SS1.p6.6.m6.2.2.2.4" xref="S2.SS1.p6.6.m6.2.2.2.3.cmml"><mo id="S2.SS1.p6.6.m6.2.2.2.4.1" stretchy="false" xref="S2.SS1.p6.6.m6.2.2.2.3.cmml">(</mo><mi id="S2.SS1.p6.6.m6.1.1.1.1" xref="S2.SS1.p6.6.m6.1.1.1.1.cmml">m</mi><mo id="S2.SS1.p6.6.m6.2.2.2.4.2" xref="S2.SS1.p6.6.m6.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p6.6.m6.2.2.2.2" xref="S2.SS1.p6.6.m6.2.2.2.2.cmml">n</mi><mo id="S2.SS1.p6.6.m6.2.2.2.4.3" stretchy="false" xref="S2.SS1.p6.6.m6.2.2.2.3.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.6.m6.2b"><apply id="S2.SS1.p6.6.m6.2.3.cmml" xref="S2.SS1.p6.6.m6.2.3"><csymbol cd="ambiguous" id="S2.SS1.p6.6.m6.2.3.1.cmml" xref="S2.SS1.p6.6.m6.2.3">subscript</csymbol><ci id="S2.SS1.p6.6.m6.2.3.2.cmml" xref="S2.SS1.p6.6.m6.2.3.2">𝐐</ci><interval closure="open" id="S2.SS1.p6.6.m6.2.2.2.3.cmml" xref="S2.SS1.p6.6.m6.2.2.2.4"><ci id="S2.SS1.p6.6.m6.1.1.1.1.cmml" xref="S2.SS1.p6.6.m6.1.1.1.1">𝑚</ci><ci id="S2.SS1.p6.6.m6.2.2.2.2.cmml" xref="S2.SS1.p6.6.m6.2.2.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.6.m6.2c">\mathbf{Q}_{(m,n)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.6.m6.2d">bold_Q start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{K}_{(m,n)}" class="ltx_Math" display="inline" id="S2.SS1.p6.7.m7.2"><semantics id="S2.SS1.p6.7.m7.2a"><msub id="S2.SS1.p6.7.m7.2.3" xref="S2.SS1.p6.7.m7.2.3.cmml"><mi id="S2.SS1.p6.7.m7.2.3.2" xref="S2.SS1.p6.7.m7.2.3.2.cmml">𝐊</mi><mrow id="S2.SS1.p6.7.m7.2.2.2.4" xref="S2.SS1.p6.7.m7.2.2.2.3.cmml"><mo id="S2.SS1.p6.7.m7.2.2.2.4.1" stretchy="false" xref="S2.SS1.p6.7.m7.2.2.2.3.cmml">(</mo><mi id="S2.SS1.p6.7.m7.1.1.1.1" xref="S2.SS1.p6.7.m7.1.1.1.1.cmml">m</mi><mo id="S2.SS1.p6.7.m7.2.2.2.4.2" xref="S2.SS1.p6.7.m7.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p6.7.m7.2.2.2.2" xref="S2.SS1.p6.7.m7.2.2.2.2.cmml">n</mi><mo id="S2.SS1.p6.7.m7.2.2.2.4.3" stretchy="false" xref="S2.SS1.p6.7.m7.2.2.2.3.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.7.m7.2b"><apply id="S2.SS1.p6.7.m7.2.3.cmml" xref="S2.SS1.p6.7.m7.2.3"><csymbol cd="ambiguous" id="S2.SS1.p6.7.m7.2.3.1.cmml" xref="S2.SS1.p6.7.m7.2.3">subscript</csymbol><ci id="S2.SS1.p6.7.m7.2.3.2.cmml" xref="S2.SS1.p6.7.m7.2.3.2">𝐊</ci><interval closure="open" id="S2.SS1.p6.7.m7.2.2.2.3.cmml" xref="S2.SS1.p6.7.m7.2.2.2.4"><ci id="S2.SS1.p6.7.m7.1.1.1.1.cmml" xref="S2.SS1.p6.7.m7.1.1.1.1">𝑚</ci><ci id="S2.SS1.p6.7.m7.2.2.2.2.cmml" xref="S2.SS1.p6.7.m7.2.2.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.7.m7.2c">\mathbf{K}_{(m,n)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.7.m7.2d">bold_K start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{V}_{(m,n)}" class="ltx_Math" display="inline" id="S2.SS1.p6.8.m8.2"><semantics id="S2.SS1.p6.8.m8.2a"><msub id="S2.SS1.p6.8.m8.2.3" xref="S2.SS1.p6.8.m8.2.3.cmml"><mi id="S2.SS1.p6.8.m8.2.3.2" xref="S2.SS1.p6.8.m8.2.3.2.cmml">𝐕</mi><mrow id="S2.SS1.p6.8.m8.2.2.2.4" xref="S2.SS1.p6.8.m8.2.2.2.3.cmml"><mo id="S2.SS1.p6.8.m8.2.2.2.4.1" stretchy="false" xref="S2.SS1.p6.8.m8.2.2.2.3.cmml">(</mo><mi id="S2.SS1.p6.8.m8.1.1.1.1" xref="S2.SS1.p6.8.m8.1.1.1.1.cmml">m</mi><mo id="S2.SS1.p6.8.m8.2.2.2.4.2" xref="S2.SS1.p6.8.m8.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p6.8.m8.2.2.2.2" xref="S2.SS1.p6.8.m8.2.2.2.2.cmml">n</mi><mo id="S2.SS1.p6.8.m8.2.2.2.4.3" stretchy="false" xref="S2.SS1.p6.8.m8.2.2.2.3.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.8.m8.2b"><apply id="S2.SS1.p6.8.m8.2.3.cmml" xref="S2.SS1.p6.8.m8.2.3"><csymbol cd="ambiguous" id="S2.SS1.p6.8.m8.2.3.1.cmml" xref="S2.SS1.p6.8.m8.2.3">subscript</csymbol><ci id="S2.SS1.p6.8.m8.2.3.2.cmml" xref="S2.SS1.p6.8.m8.2.3.2">𝐕</ci><interval closure="open" id="S2.SS1.p6.8.m8.2.2.2.3.cmml" xref="S2.SS1.p6.8.m8.2.2.2.4"><ci id="S2.SS1.p6.8.m8.1.1.1.1.cmml" xref="S2.SS1.p6.8.m8.1.1.1.1">𝑚</ci><ci id="S2.SS1.p6.8.m8.2.2.2.2.cmml" xref="S2.SS1.p6.8.m8.2.2.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.8.m8.2c">\mathbf{V}_{(m,n)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.8.m8.2d">bold_V start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT</annotation></semantics></math> refer to the query, key, and value of the same head.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Knowledge Distillation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.3">The idea of knowledge distillation from a larger neural network to a smaller network was proposed in <cite class="ltx_cite ltx_citemacro_cite">Hinton et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib8" title="">2015</a>)</cite>. In the paper, the output distribution of the larger teacher network is used as a soft target for training the student network.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{KD}}=-\sum_{x\in\mathcal{X}}p^{T}\mathrm{log}(p^{S})" class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><msub id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.3.2" xref="S2.E4.m1.1.1.3.2.cmml">ℒ</mi><mi id="S2.E4.m1.1.1.3.3" xref="S2.E4.m1.1.1.3.3.cmml">KD</mi></msub><mo id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1a" xref="S2.E4.m1.1.1.1.cmml">−</mo><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><munder id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml"><mo id="S2.E4.m1.1.1.1.1.2.2" movablelimits="false" xref="S2.E4.m1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E4.m1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1.2.3.2" xref="S2.E4.m1.1.1.1.1.2.3.2.cmml">x</mi><mo id="S2.E4.m1.1.1.1.1.2.3.1" xref="S2.E4.m1.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.1.1.2.3.3" xref="S2.E4.m1.1.1.1.1.2.3.3.cmml">𝒳</mi></mrow></munder><mrow id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><msup id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S2.E4.m1.1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.3.3.cmml">T</mi></msup><mo id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.1.4.cmml">log</mi><mo id="S2.E4.m1.1.1.1.1.1.2a" xref="S2.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E4.m1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml">S</mi></msup><mo id="S2.E4.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><eq id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2"></eq><apply id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.3.2">ℒ</ci><ci id="S2.E4.m1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.3.3">KD</ci></apply><apply id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><minus id="S2.E4.m1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1"></minus><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1"><apply id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2">subscript</csymbol><sum id="S2.E4.m1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2"></sum><apply id="S2.E4.m1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3"><in id="S2.E4.m1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.2.3.1"></in><ci id="S2.E4.m1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.2.3.2">𝑥</ci><ci id="S2.E4.m1.1.1.1.1.2.3.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3">𝒳</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2">𝑝</ci><ci id="S2.E4.m1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3.3">𝑇</ci></apply><ci id="S2.E4.m1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.1.4">log</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3">𝑆</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\mathcal{L}_{\mathrm{KD}}=-\sum_{x\in\mathcal{X}}p^{T}\mathrm{log}(p^{S})</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_x ∈ caligraphic_X end_POSTSUBSCRIPT italic_p start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_log ( italic_p start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.2">where <math alttext="p^{T}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msup id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">p</mi><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝑝</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">p^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_p start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="p^{S}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msup id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">p</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑝</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">p^{S}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_p start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT</annotation></semantics></math> denote the output distributions of the teacher and student.
The core idea of training the student to imitate the teacher extends further from comparing the output distribution to any valuable intermediate features. In general, the following loss function provides an abstraction.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\sum_{x\in\mathcal{X}}\mathrm{D}(f^{T}(x),f^{S}(x))" class="ltx_Math" display="block" id="S2.E5.m1.4"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4" xref="S2.E5.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.4.4.4" xref="S2.E5.m1.4.4.4.cmml">ℒ</mi><mo id="S2.E5.m1.4.4.3" rspace="0.111em" xref="S2.E5.m1.4.4.3.cmml">=</mo><mrow id="S2.E5.m1.4.4.2" xref="S2.E5.m1.4.4.2.cmml"><munder id="S2.E5.m1.4.4.2.3" xref="S2.E5.m1.4.4.2.3.cmml"><mo id="S2.E5.m1.4.4.2.3.2" movablelimits="false" xref="S2.E5.m1.4.4.2.3.2.cmml">∑</mo><mrow id="S2.E5.m1.4.4.2.3.3" xref="S2.E5.m1.4.4.2.3.3.cmml"><mi id="S2.E5.m1.4.4.2.3.3.2" xref="S2.E5.m1.4.4.2.3.3.2.cmml">x</mi><mo id="S2.E5.m1.4.4.2.3.3.1" xref="S2.E5.m1.4.4.2.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.4.4.2.3.3.3" xref="S2.E5.m1.4.4.2.3.3.3.cmml">𝒳</mi></mrow></munder><mrow id="S2.E5.m1.4.4.2.2" xref="S2.E5.m1.4.4.2.2.cmml"><mi id="S2.E5.m1.4.4.2.2.4" mathvariant="normal" xref="S2.E5.m1.4.4.2.2.4.cmml">D</mi><mo id="S2.E5.m1.4.4.2.2.3" xref="S2.E5.m1.4.4.2.2.3.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.2.2.2.2" xref="S2.E5.m1.4.4.2.2.2.3.cmml"><mo id="S2.E5.m1.4.4.2.2.2.2.3" stretchy="false" xref="S2.E5.m1.4.4.2.2.2.3.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.cmml"><msup id="S2.E5.m1.3.3.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2.cmml">f</mi><mi id="S2.E5.m1.3.3.1.1.1.1.1.2.3" xref="S2.E5.m1.3.3.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S2.E5.m1.3.3.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.3.2" xref="S2.E5.m1.3.3.1.1.1.1.1.cmml"><mo id="S2.E5.m1.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">x</mi><mo id="S2.E5.m1.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.2.2.2.2.4" xref="S2.E5.m1.4.4.2.2.2.3.cmml">,</mo><mrow id="S2.E5.m1.4.4.2.2.2.2.2" xref="S2.E5.m1.4.4.2.2.2.2.2.cmml"><msup id="S2.E5.m1.4.4.2.2.2.2.2.2" xref="S2.E5.m1.4.4.2.2.2.2.2.2.cmml"><mi id="S2.E5.m1.4.4.2.2.2.2.2.2.2" xref="S2.E5.m1.4.4.2.2.2.2.2.2.2.cmml">f</mi><mi id="S2.E5.m1.4.4.2.2.2.2.2.2.3" xref="S2.E5.m1.4.4.2.2.2.2.2.2.3.cmml">S</mi></msup><mo id="S2.E5.m1.4.4.2.2.2.2.2.1" xref="S2.E5.m1.4.4.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.2.2.2.2.2.3.2" xref="S2.E5.m1.4.4.2.2.2.2.2.cmml"><mo id="S2.E5.m1.4.4.2.2.2.2.2.3.2.1" stretchy="false" xref="S2.E5.m1.4.4.2.2.2.2.2.cmml">(</mo><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">x</mi><mo id="S2.E5.m1.4.4.2.2.2.2.2.3.2.2" stretchy="false" xref="S2.E5.m1.4.4.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.2.2.2.2.5" stretchy="false" xref="S2.E5.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.cmml" xref="S2.E5.m1.4.4"><eq id="S2.E5.m1.4.4.3.cmml" xref="S2.E5.m1.4.4.3"></eq><ci id="S2.E5.m1.4.4.4.cmml" xref="S2.E5.m1.4.4.4">ℒ</ci><apply id="S2.E5.m1.4.4.2.cmml" xref="S2.E5.m1.4.4.2"><apply id="S2.E5.m1.4.4.2.3.cmml" xref="S2.E5.m1.4.4.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.2.3.1.cmml" xref="S2.E5.m1.4.4.2.3">subscript</csymbol><sum id="S2.E5.m1.4.4.2.3.2.cmml" xref="S2.E5.m1.4.4.2.3.2"></sum><apply id="S2.E5.m1.4.4.2.3.3.cmml" xref="S2.E5.m1.4.4.2.3.3"><in id="S2.E5.m1.4.4.2.3.3.1.cmml" xref="S2.E5.m1.4.4.2.3.3.1"></in><ci id="S2.E5.m1.4.4.2.3.3.2.cmml" xref="S2.E5.m1.4.4.2.3.3.2">𝑥</ci><ci id="S2.E5.m1.4.4.2.3.3.3.cmml" xref="S2.E5.m1.4.4.2.3.3.3">𝒳</ci></apply></apply><apply id="S2.E5.m1.4.4.2.2.cmml" xref="S2.E5.m1.4.4.2.2"><times id="S2.E5.m1.4.4.2.2.3.cmml" xref="S2.E5.m1.4.4.2.2.3"></times><ci id="S2.E5.m1.4.4.2.2.4.cmml" xref="S2.E5.m1.4.4.2.2.4">D</ci><interval closure="open" id="S2.E5.m1.4.4.2.2.2.3.cmml" xref="S2.E5.m1.4.4.2.2.2.2"><apply id="S2.E5.m1.3.3.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1"><times id="S2.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1"></times><apply id="S2.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.2">𝑓</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝑥</ci></apply><apply id="S2.E5.m1.4.4.2.2.2.2.2.cmml" xref="S2.E5.m1.4.4.2.2.2.2.2"><times id="S2.E5.m1.4.4.2.2.2.2.2.1.cmml" xref="S2.E5.m1.4.4.2.2.2.2.2.1"></times><apply id="S2.E5.m1.4.4.2.2.2.2.2.2.cmml" xref="S2.E5.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S2.E5.m1.4.4.2.2.2.2.2.2">superscript</csymbol><ci id="S2.E5.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S2.E5.m1.4.4.2.2.2.2.2.2.2">𝑓</ci><ci id="S2.E5.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S2.E5.m1.4.4.2.2.2.2.2.2.3">𝑆</ci></apply><ci id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2">𝑥</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">\mathcal{L}=\sum_{x\in\mathcal{X}}\mathrm{D}(f^{T}(x),f^{S}(x))</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.4d">caligraphic_L = ∑ start_POSTSUBSCRIPT italic_x ∈ caligraphic_X end_POSTSUBSCRIPT roman_D ( italic_f start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_x ) , italic_f start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT ( italic_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.6">Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S2.E5" title="5 ‣ 2.2 Knowledge Distillation ‣ 2 Preliminaries ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">5</span></a>) compares the features of the teacher and student models (<math alttext="f^{T}(x)" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><msup id="S2.SS2.p2.1.m1.1.2.2" xref="S2.SS2.p2.1.m1.1.2.2.cmml"><mi id="S2.SS2.p2.1.m1.1.2.2.2" xref="S2.SS2.p2.1.m1.1.2.2.2.cmml">f</mi><mi id="S2.SS2.p2.1.m1.1.2.2.3" xref="S2.SS2.p2.1.m1.1.2.2.3.cmml">T</mi></msup><mo id="S2.SS2.p2.1.m1.1.2.1" xref="S2.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.1.m1.1.2.3.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><mo id="S2.SS2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS2.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">x</mi><mo id="S2.SS2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.2"><times id="S2.SS2.p2.1.m1.1.2.1.cmml" xref="S2.SS2.p2.1.m1.1.2.1"></times><apply id="S2.SS2.p2.1.m1.1.2.2.cmml" xref="S2.SS2.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.2.2.1.cmml" xref="S2.SS2.p2.1.m1.1.2.2">superscript</csymbol><ci id="S2.SS2.p2.1.m1.1.2.2.2.cmml" xref="S2.SS2.p2.1.m1.1.2.2.2">𝑓</ci><ci id="S2.SS2.p2.1.m1.1.2.2.3.cmml" xref="S2.SS2.p2.1.m1.1.2.2.3">𝑇</ci></apply><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">f^{T}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_f start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_x )</annotation></semantics></math>, <math alttext="f^{S}(x)" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.2" xref="S2.SS2.p2.2.m2.1.2.cmml"><msup id="S2.SS2.p2.2.m2.1.2.2" xref="S2.SS2.p2.2.m2.1.2.2.cmml"><mi id="S2.SS2.p2.2.m2.1.2.2.2" xref="S2.SS2.p2.2.m2.1.2.2.2.cmml">f</mi><mi id="S2.SS2.p2.2.m2.1.2.2.3" xref="S2.SS2.p2.2.m2.1.2.2.3.cmml">S</mi></msup><mo id="S2.SS2.p2.2.m2.1.2.1" xref="S2.SS2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.2.m2.1.2.3.2" xref="S2.SS2.p2.2.m2.1.2.cmml"><mo id="S2.SS2.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS2.p2.2.m2.1.2.cmml">(</mo><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">x</mi><mo id="S2.SS2.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.2.cmml" xref="S2.SS2.p2.2.m2.1.2"><times id="S2.SS2.p2.2.m2.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.2.1"></times><apply id="S2.SS2.p2.2.m2.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.2.2.1.cmml" xref="S2.SS2.p2.2.m2.1.2.2">superscript</csymbol><ci id="S2.SS2.p2.2.m2.1.2.2.2.cmml" xref="S2.SS2.p2.2.m2.1.2.2.2">𝑓</ci><ci id="S2.SS2.p2.2.m2.1.2.2.3.cmml" xref="S2.SS2.p2.2.m2.1.2.2.3">𝑆</ci></apply><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">f^{S}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_f start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT ( italic_x )</annotation></semantics></math>) for a given input <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_x</annotation></semantics></math> from a dataset <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">caligraphic_X</annotation></semantics></math> with a measure of dissimilarity (D).
There are a number of widely used choices for features to distill knowledge from, such as hidden states <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib25" title="">2019</a>); Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite> or attention maps <cite class="ltx_cite ltx_citemacro_cite">Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>); Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite>.
A common choice for <math alttext="\mathrm{D}" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1"><semantics id="S2.SS2.p2.5.m5.1a"><mi id="S2.SS2.p2.5.m5.1.1" mathvariant="normal" xref="S2.SS2.p2.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">D</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">\mathrm{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">roman_D</annotation></semantics></math> is Kullback-Leibler Divergence <cite class="ltx_cite ltx_citemacro_cite">Joyce (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib10" title="">2011</a>)</cite> or mean-squared error.
As the student network learns to imitate the features from the teacher with Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S2.E5" title="5 ‣ 2.2 Knowledge Distillation ‣ 2 Preliminaries ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">5</span></a>), the teacher model’s knowledge, represented by the feature <math alttext="f^{T}(x)" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m6.1"><semantics id="S2.SS2.p2.6.m6.1a"><mrow id="S2.SS2.p2.6.m6.1.2" xref="S2.SS2.p2.6.m6.1.2.cmml"><msup id="S2.SS2.p2.6.m6.1.2.2" xref="S2.SS2.p2.6.m6.1.2.2.cmml"><mi id="S2.SS2.p2.6.m6.1.2.2.2" xref="S2.SS2.p2.6.m6.1.2.2.2.cmml">f</mi><mi id="S2.SS2.p2.6.m6.1.2.2.3" xref="S2.SS2.p2.6.m6.1.2.2.3.cmml">T</mi></msup><mo id="S2.SS2.p2.6.m6.1.2.1" xref="S2.SS2.p2.6.m6.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.6.m6.1.2.3.2" xref="S2.SS2.p2.6.m6.1.2.cmml"><mo id="S2.SS2.p2.6.m6.1.2.3.2.1" stretchy="false" xref="S2.SS2.p2.6.m6.1.2.cmml">(</mo><mi id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">x</mi><mo id="S2.SS2.p2.6.m6.1.2.3.2.2" stretchy="false" xref="S2.SS2.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.2.cmml" xref="S2.SS2.p2.6.m6.1.2"><times id="S2.SS2.p2.6.m6.1.2.1.cmml" xref="S2.SS2.p2.6.m6.1.2.1"></times><apply id="S2.SS2.p2.6.m6.1.2.2.cmml" xref="S2.SS2.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.2.2.1.cmml" xref="S2.SS2.p2.6.m6.1.2.2">superscript</csymbol><ci id="S2.SS2.p2.6.m6.1.2.2.2.cmml" xref="S2.SS2.p2.6.m6.1.2.2.2">𝑓</ci><ci id="S2.SS2.p2.6.m6.1.2.2.3.cmml" xref="S2.SS2.p2.6.m6.1.2.2.3">𝑇</ci></apply><ci id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">f^{T}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.1d">italic_f start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_x )</annotation></semantics></math>, is transferred to the student.
This transfer of knowledge helps the student model converge to a better optimum that it could not reach on its own.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Related Works</h2>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="150" id="S3.F1.g1" src="extracted/5493287/framework_final.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
Attention Transfer with A2D.
The Attention Alignment Module (AAM), implemented as a pointwise convolution layer, produces intermediate attention maps from a collection of student attention maps.
The number of intermediate maps matches the total attention maps of the teacher model, encompassing all layers and heads.
These intermediate maps are then directly compared to the teacher’s attention maps using KL-Divergence, without any form of reduction.</figcaption>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In the field of feature-based KD studies, which incorporate intermediate representations of the teacher for KD, an aligning strategy has been explored to handle different architectural settings between the teacher and student. Since the teacher model generally has more layers than the student model, Patient KD <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib25" title="">2019</a>)</cite> proposed skipping every other layer or using only the last consecutive layers of the teacher model so that the number of matching layers becomes equal. Likewise, TinyBERT <cite class="ltx_cite ltx_citemacro_cite">Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>)</cite> formulated a layer-mapping function that selects hint layers to match the student layers at a similar depth level. Meanwhile, MiniLM <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib33" title="">2020</a>)</cite> circumvented the aligning issue by distilling only the last layer. However, it constrained the number of heads to be equivalent between teacher and student networks.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">To address the issue of skipped teacher layers, CKD <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite> proposed layer fusion, a method that projects several teacher layers into one fused layer. The fusion is then matched with the corresponding student layer, enabling distillation from all teacher layers. Although CKD benefits from the representations contained in more teacher layers, the mapping between fused teacher layers and student layers is set heuristically, before training. As a result, its optimal combination varies due to the training dataset, and the number of cases for mapping becomes intractable when the number of layers increases. Additionally, performance degradation was reported when the method was applied to the decoder part of the Transformer, regardless of the combination setting. This led to CKD being applied solely to the encoder side of the Transformer. While ALP-KD <cite class="ltx_cite ltx_citemacro_cite">Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite> made the mapping partially adaptive with an attention mechanism, it still requires dividing student layers into buckets, which involves heuristics, and the result is dependent on how the buckets are grouped. Both CKD and ALP-KD are layer-wise fusion distillation methods and do not consider more detailed mappings which can be found in attention heads.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we provide a detailed overview of the architecture and training of the Attention Alignment Module (AAM), the core component of our Align-to-Distill (A2D) approach.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S3.F1" title="Figure 1 ‣ 3 Related Works ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the overall framework.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Attention Map as a Knowledge</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The attention mechanism is a vital component in Transformer models, capturing the context and relationships between words in a sentence.
Attention alignment ensures that the student model, despite potential differences in network structure compared to the teacher model, focuses on the same word relationships and contextual nuances as the teacher.
This process allows the student model to gain insights beyond mere output mimicry; it learns the underlying relationships that the teacher model uses for prediction, effectively transferring knowledge from the teacher model to the student.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">A2D compares the attention maps in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S2.E3" title="3 ‣ 2.1 Multi-Head Attention ‣ 2 Preliminaries ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>) from the teacher and student for knowledge distillation.
As depicted previously the shape of the attention map is determined by the length of the input (i.e. <math alttext="\mathbf{H}_{(m,n)}\in\mathcal{R}^{L\times L}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.2"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.3" xref="S4.SS1.p2.1.m1.2.3.cmml"><msub id="S4.SS1.p2.1.m1.2.3.2" xref="S4.SS1.p2.1.m1.2.3.2.cmml"><mi id="S4.SS1.p2.1.m1.2.3.2.2" xref="S4.SS1.p2.1.m1.2.3.2.2.cmml">𝐇</mi><mrow id="S4.SS1.p2.1.m1.2.2.2.4" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml"><mo id="S4.SS1.p2.1.m1.2.2.2.4.1" stretchy="false" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">(</mo><mi id="S4.SS1.p2.1.m1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.cmml">m</mi><mo id="S4.SS1.p2.1.m1.2.2.2.4.2" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p2.1.m1.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.2.cmml">n</mi><mo id="S4.SS1.p2.1.m1.2.2.2.4.3" stretchy="false" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo id="S4.SS1.p2.1.m1.2.3.1" xref="S4.SS1.p2.1.m1.2.3.1.cmml">∈</mo><msup id="S4.SS1.p2.1.m1.2.3.3" xref="S4.SS1.p2.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.2.3.3.2" xref="S4.SS1.p2.1.m1.2.3.3.2.cmml">ℛ</mi><mrow id="S4.SS1.p2.1.m1.2.3.3.3" xref="S4.SS1.p2.1.m1.2.3.3.3.cmml"><mi id="S4.SS1.p2.1.m1.2.3.3.3.2" xref="S4.SS1.p2.1.m1.2.3.3.3.2.cmml">L</mi><mo id="S4.SS1.p2.1.m1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.1.m1.2.3.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.1.m1.2.3.3.3.3" xref="S4.SS1.p2.1.m1.2.3.3.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><apply id="S4.SS1.p2.1.m1.2.3.cmml" xref="S4.SS1.p2.1.m1.2.3"><in id="S4.SS1.p2.1.m1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.1"></in><apply id="S4.SS1.p2.1.m1.2.3.2.cmml" xref="S4.SS1.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.3.2.1.cmml" xref="S4.SS1.p2.1.m1.2.3.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.2.3.2.2.cmml" xref="S4.SS1.p2.1.m1.2.3.2.2">𝐇</ci><interval closure="open" id="S4.SS1.p2.1.m1.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.4"><ci id="S4.SS1.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1">𝑚</ci><ci id="S4.SS1.p2.1.m1.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2">𝑛</ci></interval></apply><apply id="S4.SS1.p2.1.m1.2.3.3.cmml" xref="S4.SS1.p2.1.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.3.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.3">superscript</csymbol><ci id="S4.SS1.p2.1.m1.2.3.3.2.cmml" xref="S4.SS1.p2.1.m1.2.3.3.2">ℛ</ci><apply id="S4.SS1.p2.1.m1.2.3.3.3.cmml" xref="S4.SS1.p2.1.m1.2.3.3.3"><times id="S4.SS1.p2.1.m1.2.3.3.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.3.3.1"></times><ci id="S4.SS1.p2.1.m1.2.3.3.3.2.cmml" xref="S4.SS1.p2.1.m1.2.3.3.3.2">𝐿</ci><ci id="S4.SS1.p2.1.m1.2.3.3.3.3.cmml" xref="S4.SS1.p2.1.m1.2.3.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">\mathbf{H}_{(m,n)}\in\mathcal{R}^{L\times L}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.2d">bold_H start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>), not by the model hyperparameters.
This eases the comparison between knowledge features between the teacher and student models on a different scale.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.3">In the encoder-decoder model, there exist three distinct attention that computes relation within, and in between the encoder and decoder input sequences: self-attention within the encoder and decoder, and cross-attention from encoder to decoder.
The A2D method incorporates all three types of attention maps for effective knowledge distillation:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S8.EGx1">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{(m,n)}^{\mathrm{enc-self}}\in\mathcal{R}^{L_{\mathrm{%
src}}\times L_{\mathrm{src}}}," class="ltx_Math" display="inline" id="S4.E6.m1.3"><semantics id="S4.E6.m1.3a"><mrow id="S4.E6.m1.3.3.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml"><msubsup id="S4.E6.m1.3.3.1.1.2" xref="S4.E6.m1.3.3.1.1.2.cmml"><mi id="S4.E6.m1.3.3.1.1.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.2.cmml">𝐇</mi><mrow id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.3.cmml"><mo id="S4.E6.m1.2.2.2.4.1" stretchy="false" xref="S4.E6.m1.2.2.2.3.cmml">(</mo><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">m</mi><mo id="S4.E6.m1.2.2.2.4.2" xref="S4.E6.m1.2.2.2.3.cmml">,</mo><mi id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">n</mi><mo id="S4.E6.m1.2.2.2.4.3" stretchy="false" xref="S4.E6.m1.2.2.2.3.cmml">)</mo></mrow><mrow id="S4.E6.m1.3.3.1.1.2.3" xref="S4.E6.m1.3.3.1.1.2.3.cmml"><mi id="S4.E6.m1.3.3.1.1.2.3.2" xref="S4.E6.m1.3.3.1.1.2.3.2.cmml">enc</mi><mo id="S4.E6.m1.3.3.1.1.2.3.1" xref="S4.E6.m1.3.3.1.1.2.3.1.cmml">−</mo><mi id="S4.E6.m1.3.3.1.1.2.3.3" xref="S4.E6.m1.3.3.1.1.2.3.3.cmml">self</mi></mrow></msubsup><mo id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml">∈</mo><msup id="S4.E6.m1.3.3.1.1.3" xref="S4.E6.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.3.3.1.1.3.2" xref="S4.E6.m1.3.3.1.1.3.2.cmml">ℛ</mi><mrow id="S4.E6.m1.3.3.1.1.3.3" xref="S4.E6.m1.3.3.1.1.3.3.cmml"><msub id="S4.E6.m1.3.3.1.1.3.3.2" xref="S4.E6.m1.3.3.1.1.3.3.2.cmml"><mi id="S4.E6.m1.3.3.1.1.3.3.2.2" xref="S4.E6.m1.3.3.1.1.3.3.2.2.cmml">L</mi><mi id="S4.E6.m1.3.3.1.1.3.3.2.3" xref="S4.E6.m1.3.3.1.1.3.3.2.3.cmml">src</mi></msub><mo id="S4.E6.m1.3.3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E6.m1.3.3.1.1.3.3.1.cmml">×</mo><msub id="S4.E6.m1.3.3.1.1.3.3.3" xref="S4.E6.m1.3.3.1.1.3.3.3.cmml"><mi id="S4.E6.m1.3.3.1.1.3.3.3.2" xref="S4.E6.m1.3.3.1.1.3.3.3.2.cmml">L</mi><mi id="S4.E6.m1.3.3.1.1.3.3.3.3" xref="S4.E6.m1.3.3.1.1.3.3.3.3.cmml">src</mi></msub></mrow></msup></mrow><mo id="S4.E6.m1.3.3.1.2" xref="S4.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b"><apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1"><in id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1"></in><apply id="S4.E6.m1.3.3.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2">superscript</csymbol><apply id="S4.E6.m1.3.3.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2">𝐇</ci><interval closure="open" id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.4"><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝑚</ci><ci id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2">𝑛</ci></interval></apply><apply id="S4.E6.m1.3.3.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.3"><minus id="S4.E6.m1.3.3.1.1.2.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.3.1"></minus><ci id="S4.E6.m1.3.3.1.1.2.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.3.2">enc</ci><ci id="S4.E6.m1.3.3.1.1.2.3.3.cmml" xref="S4.E6.m1.3.3.1.1.2.3.3">self</ci></apply></apply><apply id="S4.E6.m1.3.3.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.3">superscript</csymbol><ci id="S4.E6.m1.3.3.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2">ℛ</ci><apply id="S4.E6.m1.3.3.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.3.3"><times id="S4.E6.m1.3.3.1.1.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.3.3.1"></times><apply id="S4.E6.m1.3.3.1.1.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.3.2.1.cmml" xref="S4.E6.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.3.3.2.2.cmml" xref="S4.E6.m1.3.3.1.1.3.3.2.2">𝐿</ci><ci id="S4.E6.m1.3.3.1.1.3.3.2.3.cmml" xref="S4.E6.m1.3.3.1.1.3.3.2.3">src</ci></apply><apply id="S4.E6.m1.3.3.1.1.3.3.3.cmml" xref="S4.E6.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.3.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.3.3.2">𝐿</ci><ci id="S4.E6.m1.3.3.1.1.3.3.3.3.cmml" xref="S4.E6.m1.3.3.1.1.3.3.3.3">src</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.3c">\displaystyle\mathbf{H}_{(m,n)}^{\mathrm{enc-self}}\in\mathcal{R}^{L_{\mathrm{%
src}}\times L_{\mathrm{src}}},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.3d">bold_H start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_enc - roman_self end_POSTSUPERSCRIPT ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT roman_src end_POSTSUBSCRIPT × italic_L start_POSTSUBSCRIPT roman_src end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{(m,n)}^{\mathrm{dec-self}}\in\mathcal{R}^{L_{\mathrm{%
tgt}}\times L_{\mathrm{tgt}}}," class="ltx_Math" display="inline" id="S4.E7.m1.3"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml"><msubsup id="S4.E7.m1.3.3.1.1.2" xref="S4.E7.m1.3.3.1.1.2.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.2.cmml">𝐇</mi><mrow id="S4.E7.m1.2.2.2.4" xref="S4.E7.m1.2.2.2.3.cmml"><mo id="S4.E7.m1.2.2.2.4.1" stretchy="false" xref="S4.E7.m1.2.2.2.3.cmml">(</mo><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">m</mi><mo id="S4.E7.m1.2.2.2.4.2" xref="S4.E7.m1.2.2.2.3.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">n</mi><mo id="S4.E7.m1.2.2.2.4.3" stretchy="false" xref="S4.E7.m1.2.2.2.3.cmml">)</mo></mrow><mrow id="S4.E7.m1.3.3.1.1.2.3" xref="S4.E7.m1.3.3.1.1.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.2.3.2" xref="S4.E7.m1.3.3.1.1.2.3.2.cmml">dec</mi><mo id="S4.E7.m1.3.3.1.1.2.3.1" xref="S4.E7.m1.3.3.1.1.2.3.1.cmml">−</mo><mi id="S4.E7.m1.3.3.1.1.2.3.3" xref="S4.E7.m1.3.3.1.1.2.3.3.cmml">self</mi></mrow></msubsup><mo id="S4.E7.m1.3.3.1.1.1" xref="S4.E7.m1.3.3.1.1.1.cmml">∈</mo><msup id="S4.E7.m1.3.3.1.1.3" xref="S4.E7.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.3.3.1.1.3.2" xref="S4.E7.m1.3.3.1.1.3.2.cmml">ℛ</mi><mrow id="S4.E7.m1.3.3.1.1.3.3" xref="S4.E7.m1.3.3.1.1.3.3.cmml"><msub id="S4.E7.m1.3.3.1.1.3.3.2" xref="S4.E7.m1.3.3.1.1.3.3.2.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.2.2" xref="S4.E7.m1.3.3.1.1.3.3.2.2.cmml">L</mi><mi id="S4.E7.m1.3.3.1.1.3.3.2.3" xref="S4.E7.m1.3.3.1.1.3.3.2.3.cmml">tgt</mi></msub><mo id="S4.E7.m1.3.3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.3.3.1.1.3.3.1.cmml">×</mo><msub id="S4.E7.m1.3.3.1.1.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.3.2" xref="S4.E7.m1.3.3.1.1.3.3.3.2.cmml">L</mi><mi id="S4.E7.m1.3.3.1.1.3.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.3.cmml">tgt</mi></msub></mrow></msup></mrow><mo id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.3b"><apply id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1"><in id="S4.E7.m1.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1"></in><apply id="S4.E7.m1.3.3.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2">𝐇</ci><interval closure="open" id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.4"><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝑚</ci><ci id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2">𝑛</ci></interval></apply><apply id="S4.E7.m1.3.3.1.1.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.3"><minus id="S4.E7.m1.3.3.1.1.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.2.3.1"></minus><ci id="S4.E7.m1.3.3.1.1.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.2.3.2">dec</ci><ci id="S4.E7.m1.3.3.1.1.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.2.3.3">self</ci></apply></apply><apply id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2">ℛ</ci><apply id="S4.E7.m1.3.3.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3"><times id="S4.E7.m1.3.3.1.1.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.1"></times><apply id="S4.E7.m1.3.3.1.1.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.2.2">𝐿</ci><ci id="S4.E7.m1.3.3.1.1.3.3.2.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.2.3">tgt</ci></apply><apply id="S4.E7.m1.3.3.1.1.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2">𝐿</ci><ci id="S4.E7.m1.3.3.1.1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.3">tgt</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\displaystyle\mathbf{H}_{(m,n)}^{\mathrm{dec-self}}\in\mathcal{R}^{L_{\mathrm{%
tgt}}\times L_{\mathrm{tgt}}},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.3d">bold_H start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_self end_POSTSUPERSCRIPT ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT roman_tgt end_POSTSUBSCRIPT × italic_L start_POSTSUBSCRIPT roman_tgt end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{(m,n)}^{\mathrm{dec-cross}}\in\mathcal{R}^{L_{\mathrm%
{src}}\times L_{\mathrm{tgt}}}" class="ltx_Math" display="inline" id="S4.E8.m1.2"><semantics id="S4.E8.m1.2a"><mrow id="S4.E8.m1.2.3" xref="S4.E8.m1.2.3.cmml"><msubsup id="S4.E8.m1.2.3.2" xref="S4.E8.m1.2.3.2.cmml"><mi id="S4.E8.m1.2.3.2.2.2" xref="S4.E8.m1.2.3.2.2.2.cmml">𝐇</mi><mrow id="S4.E8.m1.2.2.2.4" xref="S4.E8.m1.2.2.2.3.cmml"><mo id="S4.E8.m1.2.2.2.4.1" stretchy="false" xref="S4.E8.m1.2.2.2.3.cmml">(</mo><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">m</mi><mo id="S4.E8.m1.2.2.2.4.2" xref="S4.E8.m1.2.2.2.3.cmml">,</mo><mi id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml">n</mi><mo id="S4.E8.m1.2.2.2.4.3" stretchy="false" xref="S4.E8.m1.2.2.2.3.cmml">)</mo></mrow><mrow id="S4.E8.m1.2.3.2.3" xref="S4.E8.m1.2.3.2.3.cmml"><mi id="S4.E8.m1.2.3.2.3.2" xref="S4.E8.m1.2.3.2.3.2.cmml">dec</mi><mo id="S4.E8.m1.2.3.2.3.1" xref="S4.E8.m1.2.3.2.3.1.cmml">−</mo><mi id="S4.E8.m1.2.3.2.3.3" xref="S4.E8.m1.2.3.2.3.3.cmml">cross</mi></mrow></msubsup><mo id="S4.E8.m1.2.3.1" xref="S4.E8.m1.2.3.1.cmml">∈</mo><msup id="S4.E8.m1.2.3.3" xref="S4.E8.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.2.3.3.2" xref="S4.E8.m1.2.3.3.2.cmml">ℛ</mi><mrow id="S4.E8.m1.2.3.3.3" xref="S4.E8.m1.2.3.3.3.cmml"><msub id="S4.E8.m1.2.3.3.3.2" xref="S4.E8.m1.2.3.3.3.2.cmml"><mi id="S4.E8.m1.2.3.3.3.2.2" xref="S4.E8.m1.2.3.3.3.2.2.cmml">L</mi><mi id="S4.E8.m1.2.3.3.3.2.3" xref="S4.E8.m1.2.3.3.3.2.3.cmml">src</mi></msub><mo id="S4.E8.m1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E8.m1.2.3.3.3.1.cmml">×</mo><msub id="S4.E8.m1.2.3.3.3.3" xref="S4.E8.m1.2.3.3.3.3.cmml"><mi id="S4.E8.m1.2.3.3.3.3.2" xref="S4.E8.m1.2.3.3.3.3.2.cmml">L</mi><mi id="S4.E8.m1.2.3.3.3.3.3" xref="S4.E8.m1.2.3.3.3.3.3.cmml">tgt</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.2b"><apply id="S4.E8.m1.2.3.cmml" xref="S4.E8.m1.2.3"><in id="S4.E8.m1.2.3.1.cmml" xref="S4.E8.m1.2.3.1"></in><apply id="S4.E8.m1.2.3.2.cmml" xref="S4.E8.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.3.2.1.cmml" xref="S4.E8.m1.2.3.2">superscript</csymbol><apply id="S4.E8.m1.2.3.2.2.cmml" xref="S4.E8.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.3.2.2.1.cmml" xref="S4.E8.m1.2.3.2">subscript</csymbol><ci id="S4.E8.m1.2.3.2.2.2.cmml" xref="S4.E8.m1.2.3.2.2.2">𝐇</ci><interval closure="open" id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.4"><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝑚</ci><ci id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2">𝑛</ci></interval></apply><apply id="S4.E8.m1.2.3.2.3.cmml" xref="S4.E8.m1.2.3.2.3"><minus id="S4.E8.m1.2.3.2.3.1.cmml" xref="S4.E8.m1.2.3.2.3.1"></minus><ci id="S4.E8.m1.2.3.2.3.2.cmml" xref="S4.E8.m1.2.3.2.3.2">dec</ci><ci id="S4.E8.m1.2.3.2.3.3.cmml" xref="S4.E8.m1.2.3.2.3.3">cross</ci></apply></apply><apply id="S4.E8.m1.2.3.3.cmml" xref="S4.E8.m1.2.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.3.3.1.cmml" xref="S4.E8.m1.2.3.3">superscript</csymbol><ci id="S4.E8.m1.2.3.3.2.cmml" xref="S4.E8.m1.2.3.3.2">ℛ</ci><apply id="S4.E8.m1.2.3.3.3.cmml" xref="S4.E8.m1.2.3.3.3"><times id="S4.E8.m1.2.3.3.3.1.cmml" xref="S4.E8.m1.2.3.3.3.1"></times><apply id="S4.E8.m1.2.3.3.3.2.cmml" xref="S4.E8.m1.2.3.3.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.3.3.3.2.1.cmml" xref="S4.E8.m1.2.3.3.3.2">subscript</csymbol><ci id="S4.E8.m1.2.3.3.3.2.2.cmml" xref="S4.E8.m1.2.3.3.3.2.2">𝐿</ci><ci id="S4.E8.m1.2.3.3.3.2.3.cmml" xref="S4.E8.m1.2.3.3.3.2.3">src</ci></apply><apply id="S4.E8.m1.2.3.3.3.3.cmml" xref="S4.E8.m1.2.3.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.3.3.3.3.1.cmml" xref="S4.E8.m1.2.3.3.3.3">subscript</csymbol><ci id="S4.E8.m1.2.3.3.3.3.2.cmml" xref="S4.E8.m1.2.3.3.3.3.2">𝐿</ci><ci id="S4.E8.m1.2.3.3.3.3.3.cmml" xref="S4.E8.m1.2.3.3.3.3.3">tgt</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.2c">\displaystyle\mathbf{H}_{(m,n)}^{\mathrm{dec-cross}}\in\mathcal{R}^{L_{\mathrm%
{src}}\times L_{\mathrm{tgt}}}</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.2d">bold_H start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_cross end_POSTSUPERSCRIPT ∈ caligraphic_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT roman_src end_POSTSUBSCRIPT × italic_L start_POSTSUBSCRIPT roman_tgt end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.2">Note that <math alttext="L_{\mathrm{src}}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">L</mi><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">src</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝐿</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">src</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">L_{\mathrm{src}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_L start_POSTSUBSCRIPT roman_src end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="L_{\mathrm{tgt}}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">L</mi><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">tgt</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝐿</ci><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">tgt</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">L_{\mathrm{tgt}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_L start_POSTSUBSCRIPT roman_tgt end_POSTSUBSCRIPT</annotation></semantics></math> are the lengths of the source and target sentences for machine translation, which make the shape of attention maps among three types of attention.
During the attention knowledge transfer, each type of attention map is compared between teacher and student, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Attention Alignment Module</h3>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Module Architecture</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.2">The student and teacher models share the same <math alttext="L_{\mathrm{src}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.1.m1.1"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><msub id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.1.m1.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.2.cmml">L</mi><mi id="S4.SS2.SSS1.p1.1.m1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.3.cmml">src</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><apply id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.2">𝐿</ci><ci id="S4.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.3">src</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">L_{\mathrm{src}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT roman_src end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="L_{\mathrm{tgt}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.2.m2.1"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><msub id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p1.2.m2.1.1.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml">L</mi><mi id="S4.SS2.SSS1.p1.2.m2.1.1.3" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml">tgt</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><apply id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2">𝐿</ci><ci id="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3">tgt</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">L_{\mathrm{tgt}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.2.m2.1d">italic_L start_POSTSUBSCRIPT roman_tgt end_POSTSUBSCRIPT</annotation></semantics></math> during distillation, leading to attention maps of the same shape for both models, regardless of model differences.
However, the number of attention maps in these models differs since the teacher model has more layers and more heads in each layer compared to the student model.
This discrepancy in numbers makes it infeasible to make a straightforward one-to-one mapping of attention maps between teacher and student models.
To resolve this, we devise an Attention Alignment Module (AAM) that generates intermediate attention maps, bridging the gap between the two groups of attention maps.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.1">AAM performs pointwise convolution (<math alttext="1\times 1" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.1.m1.1"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mrow id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml"><mn id="S4.SS2.SSS1.p2.1.m1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.SSS1.p2.1.m1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><apply id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1"><times id="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1"></times><cn id="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.SS2.SSS1.p2.1.m1.1.1.2">1</cn><cn id="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS1.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.1.m1.1d">1 × 1</annotation></semantics></math> Conv. as in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S3.F1" title="Figure 1 ‣ 3 Related Works ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>) on the student attention maps.
This operation creates an equal number of intermediate attention maps to the teacher maps.
Each intermediate map results from a weighted sum of all student attention maps.
Consequently, a one-to-one comparison between the teacher maps and the intermediate maps simulates transferring knowledge with a fully-connected mapping between teacher and student attention maps.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.1">Two desirable attributes of pointwise convolution take major roles in effective attention knowledge transfer: (1) convolution operation preserves sequential information in each attention map, while (2) allowing fully-connected weighted mapping between the groups.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p4">
<p class="ltx_p" id="S4.SS2.SSS1.p4.2">We can represent the intermediate attention maps, <math alttext="\mathbf{H}^{I}_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p4.1.m1.1"><semantics id="S4.SS2.SSS1.p4.1.m1.1a"><msubsup id="S4.SS2.SSS1.p4.1.m1.1.1" xref="S4.SS2.SSS1.p4.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p4.1.m1.1.1.2.2" xref="S4.SS2.SSS1.p4.1.m1.1.1.2.2.cmml">𝐇</mi><mi id="S4.SS2.SSS1.p4.1.m1.1.1.3" xref="S4.SS2.SSS1.p4.1.m1.1.1.3.cmml">c</mi><mi id="S4.SS2.SSS1.p4.1.m1.1.1.2.3" xref="S4.SS2.SSS1.p4.1.m1.1.1.2.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p4.1.m1.1b"><apply id="S4.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p4.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p4.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p4.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1.2.2">𝐇</ci><ci id="S4.SS2.SSS1.p4.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1.2.3">𝐼</ci></apply><ci id="S4.SS2.SSS1.p4.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p4.1.m1.1c">\mathbf{H}^{I}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p4.1.m1.1d">bold_H start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, from student attention maps, <math alttext="\mathbf{H}^{S}_{(m,n)}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p4.2.m2.2"><semantics id="S4.SS2.SSS1.p4.2.m2.2a"><msubsup id="S4.SS2.SSS1.p4.2.m2.2.3" xref="S4.SS2.SSS1.p4.2.m2.2.3.cmml"><mi id="S4.SS2.SSS1.p4.2.m2.2.3.2.2" xref="S4.SS2.SSS1.p4.2.m2.2.3.2.2.cmml">𝐇</mi><mrow id="S4.SS2.SSS1.p4.2.m2.2.2.2.4" xref="S4.SS2.SSS1.p4.2.m2.2.2.2.3.cmml"><mo id="S4.SS2.SSS1.p4.2.m2.2.2.2.4.1" stretchy="false" xref="S4.SS2.SSS1.p4.2.m2.2.2.2.3.cmml">(</mo><mi id="S4.SS2.SSS1.p4.2.m2.1.1.1.1" xref="S4.SS2.SSS1.p4.2.m2.1.1.1.1.cmml">m</mi><mo id="S4.SS2.SSS1.p4.2.m2.2.2.2.4.2" xref="S4.SS2.SSS1.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS1.p4.2.m2.2.2.2.2" xref="S4.SS2.SSS1.p4.2.m2.2.2.2.2.cmml">n</mi><mo id="S4.SS2.SSS1.p4.2.m2.2.2.2.4.3" stretchy="false" xref="S4.SS2.SSS1.p4.2.m2.2.2.2.3.cmml">)</mo></mrow><mi id="S4.SS2.SSS1.p4.2.m2.2.3.2.3" xref="S4.SS2.SSS1.p4.2.m2.2.3.2.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p4.2.m2.2b"><apply id="S4.SS2.SSS1.p4.2.m2.2.3.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p4.2.m2.2.3.1.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.3">subscript</csymbol><apply id="S4.SS2.SSS1.p4.2.m2.2.3.2.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p4.2.m2.2.3.2.1.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.3">superscript</csymbol><ci id="S4.SS2.SSS1.p4.2.m2.2.3.2.2.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.3.2.2">𝐇</ci><ci id="S4.SS2.SSS1.p4.2.m2.2.3.2.3.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.3.2.3">𝑆</ci></apply><interval closure="open" id="S4.SS2.SSS1.p4.2.m2.2.2.2.3.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.2.2.4"><ci id="S4.SS2.SSS1.p4.2.m2.1.1.1.1.cmml" xref="S4.SS2.SSS1.p4.2.m2.1.1.1.1">𝑚</ci><ci id="S4.SS2.SSS1.p4.2.m2.2.2.2.2.cmml" xref="S4.SS2.SSS1.p4.2.m2.2.2.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p4.2.m2.2c">\mathbf{H}^{S}_{(m,n)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p4.2.m2.2d">bold_H start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT</annotation></semantics></math> with the learnable parameters of AAM:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}^{I}_{c}=\sum_{m=1}^{M}\sum_{n=1}^{N}w_{(m,n),c}\mathbf{H}^{S}_{(m,n%
)}+b_{c},\\
(c\in{1,...,C})" class="ltx_Math" display="block" id="S4.E9.m1.11"><semantics id="S4.E9.m1.11a"><mrow id="S4.E9.m1.11.11" xref="S4.E9.m1.11.11.cmml"><msubsup id="S4.E9.m1.11.11.4" xref="S4.E9.m1.11.11.4.cmml"><mi id="S4.E9.m1.11.11.4.2.2" xref="S4.E9.m1.11.11.4.2.2.cmml">𝐇</mi><mi id="S4.E9.m1.11.11.4.3" xref="S4.E9.m1.11.11.4.3.cmml">c</mi><mi id="S4.E9.m1.11.11.4.2.3" xref="S4.E9.m1.11.11.4.2.3.cmml">I</mi></msubsup><mo id="S4.E9.m1.11.11.3" rspace="0.111em" xref="S4.E9.m1.11.11.3.cmml">=</mo><mrow id="S4.E9.m1.11.11.2.2" xref="S4.E9.m1.11.11.2.3.cmml"><mrow id="S4.E9.m1.10.10.1.1.1" xref="S4.E9.m1.10.10.1.1.1.cmml"><mrow id="S4.E9.m1.10.10.1.1.1.2" xref="S4.E9.m1.10.10.1.1.1.2.cmml"><munderover id="S4.E9.m1.10.10.1.1.1.2.1" xref="S4.E9.m1.10.10.1.1.1.2.1.cmml"><mo id="S4.E9.m1.10.10.1.1.1.2.1.2.2" movablelimits="false" rspace="0em" xref="S4.E9.m1.10.10.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.10.10.1.1.1.2.1.2.3" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3.cmml"><mi id="S4.E9.m1.10.10.1.1.1.2.1.2.3.2" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3.2.cmml">m</mi><mo id="S4.E9.m1.10.10.1.1.1.2.1.2.3.1" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S4.E9.m1.10.10.1.1.1.2.1.2.3.3" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.10.10.1.1.1.2.1.3" xref="S4.E9.m1.10.10.1.1.1.2.1.3.cmml">M</mi></munderover><mrow id="S4.E9.m1.10.10.1.1.1.2.2" xref="S4.E9.m1.10.10.1.1.1.2.2.cmml"><munderover id="S4.E9.m1.10.10.1.1.1.2.2.1" xref="S4.E9.m1.10.10.1.1.1.2.2.1.cmml"><mo id="S4.E9.m1.10.10.1.1.1.2.2.1.2.2" movablelimits="false" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.cmml"><mi id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.2" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.2.cmml">n</mi><mo id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.1" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.1.cmml">=</mo><mn id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.3" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.10.10.1.1.1.2.2.1.3" xref="S4.E9.m1.10.10.1.1.1.2.2.1.3.cmml">N</mi></munderover><mrow id="S4.E9.m1.10.10.1.1.1.2.2.2" xref="S4.E9.m1.10.10.1.1.1.2.2.2.cmml"><msub id="S4.E9.m1.10.10.1.1.1.2.2.2.2" xref="S4.E9.m1.10.10.1.1.1.2.2.2.2.cmml"><mi id="S4.E9.m1.10.10.1.1.1.2.2.2.2.2" xref="S4.E9.m1.10.10.1.1.1.2.2.2.2.2.cmml">w</mi><mrow id="S4.E9.m1.4.4.4.4" xref="S4.E9.m1.4.4.4.5.cmml"><mrow id="S4.E9.m1.4.4.4.4.1.2" xref="S4.E9.m1.4.4.4.4.1.1.cmml"><mo id="S4.E9.m1.4.4.4.4.1.2.1" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.cmml">(</mo><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">m</mi><mo id="S4.E9.m1.4.4.4.4.1.2.2" xref="S4.E9.m1.4.4.4.4.1.1.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">n</mi><mo id="S4.E9.m1.4.4.4.4.1.2.3" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.cmml">)</mo></mrow><mo id="S4.E9.m1.4.4.4.4.2" xref="S4.E9.m1.4.4.4.5.cmml">,</mo><mi id="S4.E9.m1.3.3.3.3" xref="S4.E9.m1.3.3.3.3.cmml">c</mi></mrow></msub><mo id="S4.E9.m1.10.10.1.1.1.2.2.2.1" xref="S4.E9.m1.10.10.1.1.1.2.2.2.1.cmml">⁢</mo><msubsup id="S4.E9.m1.10.10.1.1.1.2.2.2.3" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3.cmml"><mi id="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.2" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.2.cmml">𝐇</mi><mrow id="S4.E9.m1.6.6.2.4" xref="S4.E9.m1.6.6.2.3.cmml"><mo id="S4.E9.m1.6.6.2.4.1" stretchy="false" xref="S4.E9.m1.6.6.2.3.cmml">(</mo><mi id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1.cmml">m</mi><mo id="S4.E9.m1.6.6.2.4.2" xref="S4.E9.m1.6.6.2.3.cmml">,</mo><mi id="S4.E9.m1.6.6.2.2" xref="S4.E9.m1.6.6.2.2.cmml">n</mi><mo id="S4.E9.m1.6.6.2.4.3" stretchy="false" xref="S4.E9.m1.6.6.2.3.cmml">)</mo></mrow><mi id="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.3" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.3.cmml">S</mi></msubsup></mrow></mrow></mrow><mo id="S4.E9.m1.10.10.1.1.1.1" xref="S4.E9.m1.10.10.1.1.1.1.cmml">+</mo><msub id="S4.E9.m1.10.10.1.1.1.3" xref="S4.E9.m1.10.10.1.1.1.3.cmml"><mi id="S4.E9.m1.10.10.1.1.1.3.2" xref="S4.E9.m1.10.10.1.1.1.3.2.cmml">b</mi><mi id="S4.E9.m1.10.10.1.1.1.3.3" xref="S4.E9.m1.10.10.1.1.1.3.3.cmml">c</mi></msub></mrow><mo id="S4.E9.m1.11.11.2.2.3" xref="S4.E9.m1.11.11.2.3.cmml">,</mo><mrow id="S4.E9.m1.11.11.2.2.2.1" xref="S4.E9.m1.11.11.2.2.2.1.1.cmml"><mo id="S4.E9.m1.11.11.2.2.2.1.2" stretchy="false" xref="S4.E9.m1.11.11.2.2.2.1.1.cmml">(</mo><mrow id="S4.E9.m1.11.11.2.2.2.1.1" xref="S4.E9.m1.11.11.2.2.2.1.1.cmml"><mi id="S4.E9.m1.11.11.2.2.2.1.1.2" xref="S4.E9.m1.11.11.2.2.2.1.1.2.cmml">c</mi><mo id="S4.E9.m1.11.11.2.2.2.1.1.1" xref="S4.E9.m1.11.11.2.2.2.1.1.1.cmml">∈</mo><mrow id="S4.E9.m1.11.11.2.2.2.1.1.3.2" xref="S4.E9.m1.11.11.2.2.2.1.1.3.1.cmml"><mn id="S4.E9.m1.7.7" xref="S4.E9.m1.7.7.cmml">1</mn><mo id="S4.E9.m1.11.11.2.2.2.1.1.3.2.1" xref="S4.E9.m1.11.11.2.2.2.1.1.3.1.cmml">,</mo><mi id="S4.E9.m1.8.8" mathvariant="normal" xref="S4.E9.m1.8.8.cmml">…</mi><mo id="S4.E9.m1.11.11.2.2.2.1.1.3.2.2" xref="S4.E9.m1.11.11.2.2.2.1.1.3.1.cmml">,</mo><mi id="S4.E9.m1.9.9" xref="S4.E9.m1.9.9.cmml">C</mi></mrow></mrow><mo id="S4.E9.m1.11.11.2.2.2.1.3" stretchy="false" xref="S4.E9.m1.11.11.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.11b"><apply id="S4.E9.m1.11.11.cmml" xref="S4.E9.m1.11.11"><eq id="S4.E9.m1.11.11.3.cmml" xref="S4.E9.m1.11.11.3"></eq><apply id="S4.E9.m1.11.11.4.cmml" xref="S4.E9.m1.11.11.4"><csymbol cd="ambiguous" id="S4.E9.m1.11.11.4.1.cmml" xref="S4.E9.m1.11.11.4">subscript</csymbol><apply id="S4.E9.m1.11.11.4.2.cmml" xref="S4.E9.m1.11.11.4"><csymbol cd="ambiguous" id="S4.E9.m1.11.11.4.2.1.cmml" xref="S4.E9.m1.11.11.4">superscript</csymbol><ci id="S4.E9.m1.11.11.4.2.2.cmml" xref="S4.E9.m1.11.11.4.2.2">𝐇</ci><ci id="S4.E9.m1.11.11.4.2.3.cmml" xref="S4.E9.m1.11.11.4.2.3">𝐼</ci></apply><ci id="S4.E9.m1.11.11.4.3.cmml" xref="S4.E9.m1.11.11.4.3">𝑐</ci></apply><list id="S4.E9.m1.11.11.2.3.cmml" xref="S4.E9.m1.11.11.2.2"><apply id="S4.E9.m1.10.10.1.1.1.cmml" xref="S4.E9.m1.10.10.1.1.1"><plus id="S4.E9.m1.10.10.1.1.1.1.cmml" xref="S4.E9.m1.10.10.1.1.1.1"></plus><apply id="S4.E9.m1.10.10.1.1.1.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2"><apply id="S4.E9.m1.10.10.1.1.1.2.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.2.1.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1">superscript</csymbol><apply id="S4.E9.m1.10.10.1.1.1.2.1.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.2.1.2.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1">subscript</csymbol><sum id="S4.E9.m1.10.10.1.1.1.2.1.2.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1.2.2"></sum><apply id="S4.E9.m1.10.10.1.1.1.2.1.2.3.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3"><eq id="S4.E9.m1.10.10.1.1.1.2.1.2.3.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3.1"></eq><ci id="S4.E9.m1.10.10.1.1.1.2.1.2.3.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3.2">𝑚</ci><cn id="S4.E9.m1.10.10.1.1.1.2.1.2.3.3.cmml" type="integer" xref="S4.E9.m1.10.10.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.10.10.1.1.1.2.1.3.cmml" xref="S4.E9.m1.10.10.1.1.1.2.1.3">𝑀</ci></apply><apply id="S4.E9.m1.10.10.1.1.1.2.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2"><apply id="S4.E9.m1.10.10.1.1.1.2.2.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.2.2.1.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1">superscript</csymbol><apply id="S4.E9.m1.10.10.1.1.1.2.2.1.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.2.2.1.2.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1">subscript</csymbol><sum id="S4.E9.m1.10.10.1.1.1.2.2.1.2.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.2"></sum><apply id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3"><eq id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.1"></eq><ci id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.2">𝑛</ci><cn id="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.3.cmml" type="integer" xref="S4.E9.m1.10.10.1.1.1.2.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.10.10.1.1.1.2.2.1.3.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.1.3">𝑁</ci></apply><apply id="S4.E9.m1.10.10.1.1.1.2.2.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2"><times id="S4.E9.m1.10.10.1.1.1.2.2.2.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.1"></times><apply id="S4.E9.m1.10.10.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.10.10.1.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.2.2">𝑤</ci><list id="S4.E9.m1.4.4.4.5.cmml" xref="S4.E9.m1.4.4.4.4"><interval closure="open" id="S4.E9.m1.4.4.4.4.1.1.cmml" xref="S4.E9.m1.4.4.4.4.1.2"><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑚</ci><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">𝑛</ci></interval><ci id="S4.E9.m1.3.3.3.3.cmml" xref="S4.E9.m1.3.3.3.3">𝑐</ci></list></apply><apply id="S4.E9.m1.10.10.1.1.1.2.2.2.3.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.2.2.2.3.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3">subscript</csymbol><apply id="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.1.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3">superscript</csymbol><ci id="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.2.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.2">𝐇</ci><ci id="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.3.cmml" xref="S4.E9.m1.10.10.1.1.1.2.2.2.3.2.3">𝑆</ci></apply><interval closure="open" id="S4.E9.m1.6.6.2.3.cmml" xref="S4.E9.m1.6.6.2.4"><ci id="S4.E9.m1.5.5.1.1.cmml" xref="S4.E9.m1.5.5.1.1">𝑚</ci><ci id="S4.E9.m1.6.6.2.2.cmml" xref="S4.E9.m1.6.6.2.2">𝑛</ci></interval></apply></apply></apply></apply><apply id="S4.E9.m1.10.10.1.1.1.3.cmml" xref="S4.E9.m1.10.10.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.1.3.1.cmml" xref="S4.E9.m1.10.10.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.10.10.1.1.1.3.2.cmml" xref="S4.E9.m1.10.10.1.1.1.3.2">𝑏</ci><ci id="S4.E9.m1.10.10.1.1.1.3.3.cmml" xref="S4.E9.m1.10.10.1.1.1.3.3">𝑐</ci></apply></apply><apply id="S4.E9.m1.11.11.2.2.2.1.1.cmml" xref="S4.E9.m1.11.11.2.2.2.1"><in id="S4.E9.m1.11.11.2.2.2.1.1.1.cmml" xref="S4.E9.m1.11.11.2.2.2.1.1.1"></in><ci id="S4.E9.m1.11.11.2.2.2.1.1.2.cmml" xref="S4.E9.m1.11.11.2.2.2.1.1.2">𝑐</ci><list id="S4.E9.m1.11.11.2.2.2.1.1.3.1.cmml" xref="S4.E9.m1.11.11.2.2.2.1.1.3.2"><cn id="S4.E9.m1.7.7.cmml" type="integer" xref="S4.E9.m1.7.7">1</cn><ci id="S4.E9.m1.8.8.cmml" xref="S4.E9.m1.8.8">…</ci><ci id="S4.E9.m1.9.9.cmml" xref="S4.E9.m1.9.9">𝐶</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.11c">\mathbf{H}^{I}_{c}=\sum_{m=1}^{M}\sum_{n=1}^{N}w_{(m,n),c}\mathbf{H}^{S}_{(m,n%
)}+b_{c},\\
(c\in{1,...,C})</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.11d">bold_H start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT ( italic_m , italic_n ) , italic_c end_POSTSUBSCRIPT bold_H start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_m , italic_n ) end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , ( italic_c ∈ 1 , … , italic_C )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.p5">
<p class="ltx_p" id="S4.SS2.SSS1.p5.7">Here, <math alttext="w_{(m,n),c}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p5.1.m1.4"><semantics id="S4.SS2.SSS1.p5.1.m1.4a"><msub id="S4.SS2.SSS1.p5.1.m1.4.5" xref="S4.SS2.SSS1.p5.1.m1.4.5.cmml"><mi id="S4.SS2.SSS1.p5.1.m1.4.5.2" xref="S4.SS2.SSS1.p5.1.m1.4.5.2.cmml">w</mi><mrow id="S4.SS2.SSS1.p5.1.m1.4.4.4.4" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.5.cmml"><mrow id="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.2" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.1.cmml"><mo id="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.2.1" stretchy="false" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.1.cmml">(</mo><mi id="S4.SS2.SSS1.p5.1.m1.1.1.1.1" xref="S4.SS2.SSS1.p5.1.m1.1.1.1.1.cmml">m</mi><mo id="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.2.2" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.1.cmml">,</mo><mi id="S4.SS2.SSS1.p5.1.m1.2.2.2.2" xref="S4.SS2.SSS1.p5.1.m1.2.2.2.2.cmml">n</mi><mo id="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.2.3" stretchy="false" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS1.p5.1.m1.4.4.4.4.2" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.5.cmml">,</mo><mi id="S4.SS2.SSS1.p5.1.m1.3.3.3.3" xref="S4.SS2.SSS1.p5.1.m1.3.3.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p5.1.m1.4b"><apply id="S4.SS2.SSS1.p5.1.m1.4.5.cmml" xref="S4.SS2.SSS1.p5.1.m1.4.5"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p5.1.m1.4.5.1.cmml" xref="S4.SS2.SSS1.p5.1.m1.4.5">subscript</csymbol><ci id="S4.SS2.SSS1.p5.1.m1.4.5.2.cmml" xref="S4.SS2.SSS1.p5.1.m1.4.5.2">𝑤</ci><list id="S4.SS2.SSS1.p5.1.m1.4.4.4.5.cmml" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.4"><interval closure="open" id="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.1.cmml" xref="S4.SS2.SSS1.p5.1.m1.4.4.4.4.1.2"><ci id="S4.SS2.SSS1.p5.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p5.1.m1.1.1.1.1">𝑚</ci><ci id="S4.SS2.SSS1.p5.1.m1.2.2.2.2.cmml" xref="S4.SS2.SSS1.p5.1.m1.2.2.2.2">𝑛</ci></interval><ci id="S4.SS2.SSS1.p5.1.m1.3.3.3.3.cmml" xref="S4.SS2.SSS1.p5.1.m1.3.3.3.3">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p5.1.m1.4c">w_{(m,n),c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p5.1.m1.4d">italic_w start_POSTSUBSCRIPT ( italic_m , italic_n ) , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="b_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p5.2.m2.1"><semantics id="S4.SS2.SSS1.p5.2.m2.1a"><msub id="S4.SS2.SSS1.p5.2.m2.1.1" xref="S4.SS2.SSS1.p5.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p5.2.m2.1.1.2" xref="S4.SS2.SSS1.p5.2.m2.1.1.2.cmml">b</mi><mi id="S4.SS2.SSS1.p5.2.m2.1.1.3" xref="S4.SS2.SSS1.p5.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p5.2.m2.1b"><apply id="S4.SS2.SSS1.p5.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p5.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p5.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p5.2.m2.1.1.2">𝑏</ci><ci id="S4.SS2.SSS1.p5.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p5.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p5.2.m2.1c">b_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p5.2.m2.1d">italic_b start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> represent the weight and bias of AAM, respectively.
These parameters generate the <math alttext="c" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p5.3.m3.1"><semantics id="S4.SS2.SSS1.p5.3.m3.1a"><mi id="S4.SS2.SSS1.p5.3.m3.1.1" xref="S4.SS2.SSS1.p5.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p5.3.m3.1b"><ci id="S4.SS2.SSS1.p5.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p5.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p5.3.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p5.3.m3.1d">italic_c</annotation></semantics></math>-th intermediate attention map (<math alttext="c\in{1,...,C}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p5.4.m4.3"><semantics id="S4.SS2.SSS1.p5.4.m4.3a"><mrow id="S4.SS2.SSS1.p5.4.m4.3.4" xref="S4.SS2.SSS1.p5.4.m4.3.4.cmml"><mi id="S4.SS2.SSS1.p5.4.m4.3.4.2" xref="S4.SS2.SSS1.p5.4.m4.3.4.2.cmml">c</mi><mo id="S4.SS2.SSS1.p5.4.m4.3.4.1" xref="S4.SS2.SSS1.p5.4.m4.3.4.1.cmml">∈</mo><mrow id="S4.SS2.SSS1.p5.4.m4.3.4.3.2" xref="S4.SS2.SSS1.p5.4.m4.3.4.3.1.cmml"><mn id="S4.SS2.SSS1.p5.4.m4.1.1" xref="S4.SS2.SSS1.p5.4.m4.1.1.cmml">1</mn><mo id="S4.SS2.SSS1.p5.4.m4.3.4.3.2.1" xref="S4.SS2.SSS1.p5.4.m4.3.4.3.1.cmml">,</mo><mi id="S4.SS2.SSS1.p5.4.m4.2.2" mathvariant="normal" xref="S4.SS2.SSS1.p5.4.m4.2.2.cmml">…</mi><mo id="S4.SS2.SSS1.p5.4.m4.3.4.3.2.2" xref="S4.SS2.SSS1.p5.4.m4.3.4.3.1.cmml">,</mo><mi id="S4.SS2.SSS1.p5.4.m4.3.3" xref="S4.SS2.SSS1.p5.4.m4.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p5.4.m4.3b"><apply id="S4.SS2.SSS1.p5.4.m4.3.4.cmml" xref="S4.SS2.SSS1.p5.4.m4.3.4"><in id="S4.SS2.SSS1.p5.4.m4.3.4.1.cmml" xref="S4.SS2.SSS1.p5.4.m4.3.4.1"></in><ci id="S4.SS2.SSS1.p5.4.m4.3.4.2.cmml" xref="S4.SS2.SSS1.p5.4.m4.3.4.2">𝑐</ci><list id="S4.SS2.SSS1.p5.4.m4.3.4.3.1.cmml" xref="S4.SS2.SSS1.p5.4.m4.3.4.3.2"><cn id="S4.SS2.SSS1.p5.4.m4.1.1.cmml" type="integer" xref="S4.SS2.SSS1.p5.4.m4.1.1">1</cn><ci id="S4.SS2.SSS1.p5.4.m4.2.2.cmml" xref="S4.SS2.SSS1.p5.4.m4.2.2">…</ci><ci id="S4.SS2.SSS1.p5.4.m4.3.3.cmml" xref="S4.SS2.SSS1.p5.4.m4.3.3">𝐶</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p5.4.m4.3c">c\in{1,...,C}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p5.4.m4.3d">italic_c ∈ 1 , … , italic_C</annotation></semantics></math>), where <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p5.5.m5.1"><semantics id="S4.SS2.SSS1.p5.5.m5.1a"><mi id="S4.SS2.SSS1.p5.5.m5.1.1" xref="S4.SS2.SSS1.p5.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p5.5.m5.1b"><ci id="S4.SS2.SSS1.p5.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p5.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p5.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p5.5.m5.1d">italic_C</annotation></semantics></math> denotes the total number of teacher’s attention heads.
The variables <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p5.6.m6.1"><semantics id="S4.SS2.SSS1.p5.6.m6.1a"><mi id="S4.SS2.SSS1.p5.6.m6.1.1" xref="S4.SS2.SSS1.p5.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p5.6.m6.1b"><ci id="S4.SS2.SSS1.p5.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p5.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p5.6.m6.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p5.6.m6.1d">italic_M</annotation></semantics></math> and <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p5.7.m7.1"><semantics id="S4.SS2.SSS1.p5.7.m7.1a"><mi id="S4.SS2.SSS1.p5.7.m7.1.1" xref="S4.SS2.SSS1.p5.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p5.7.m7.1b"><ci id="S4.SS2.SSS1.p5.7.m7.1.1.cmml" xref="S4.SS2.SSS1.p5.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p5.7.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p5.7.m7.1d">italic_N</annotation></semantics></math> denote the number of student attention heads within a single layer, and the maximum layer depth of the student respectively.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p6">
<p class="ltx_p" id="S4.SS2.SSS1.p6.3">In summary, AAM is a pointwise convolution layer that generates <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p6.1.m1.1"><semantics id="S4.SS2.SSS1.p6.1.m1.1a"><mi id="S4.SS2.SSS1.p6.1.m1.1.1" xref="S4.SS2.SSS1.p6.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p6.1.m1.1b"><ci id="S4.SS2.SSS1.p6.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p6.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p6.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p6.1.m1.1d">italic_C</annotation></semantics></math> intermediate attention maps from a total of <math alttext="M*N" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p6.2.m2.1"><semantics id="S4.SS2.SSS1.p6.2.m2.1a"><mrow id="S4.SS2.SSS1.p6.2.m2.1.1" xref="S4.SS2.SSS1.p6.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p6.2.m2.1.1.2" xref="S4.SS2.SSS1.p6.2.m2.1.1.2.cmml">M</mi><mo id="S4.SS2.SSS1.p6.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p6.2.m2.1.1.1.cmml">*</mo><mi id="S4.SS2.SSS1.p6.2.m2.1.1.3" xref="S4.SS2.SSS1.p6.2.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p6.2.m2.1b"><apply id="S4.SS2.SSS1.p6.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p6.2.m2.1.1"><times id="S4.SS2.SSS1.p6.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p6.2.m2.1.1.1"></times><ci id="S4.SS2.SSS1.p6.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p6.2.m2.1.1.2">𝑀</ci><ci id="S4.SS2.SSS1.p6.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p6.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p6.2.m2.1c">M*N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p6.2.m2.1d">italic_M * italic_N</annotation></semantics></math> student attention maps.
The convolution operation of AAM ensures that a one-to-one comparison of intermediate maps to teacher attention maps functions similarly to a fully-connected comparison between student and teacher attention maps.
The trained weights of AAM (<math alttext="w_{(m,n),c}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p6.3.m3.4"><semantics id="S4.SS2.SSS1.p6.3.m3.4a"><msub id="S4.SS2.SSS1.p6.3.m3.4.5" xref="S4.SS2.SSS1.p6.3.m3.4.5.cmml"><mi id="S4.SS2.SSS1.p6.3.m3.4.5.2" xref="S4.SS2.SSS1.p6.3.m3.4.5.2.cmml">w</mi><mrow id="S4.SS2.SSS1.p6.3.m3.4.4.4.4" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.5.cmml"><mrow id="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.2" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.1.cmml"><mo id="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.2.1" stretchy="false" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.1.cmml">(</mo><mi id="S4.SS2.SSS1.p6.3.m3.1.1.1.1" xref="S4.SS2.SSS1.p6.3.m3.1.1.1.1.cmml">m</mi><mo id="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.2.2" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.1.cmml">,</mo><mi id="S4.SS2.SSS1.p6.3.m3.2.2.2.2" xref="S4.SS2.SSS1.p6.3.m3.2.2.2.2.cmml">n</mi><mo id="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.2.3" stretchy="false" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS1.p6.3.m3.4.4.4.4.2" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.5.cmml">,</mo><mi id="S4.SS2.SSS1.p6.3.m3.3.3.3.3" xref="S4.SS2.SSS1.p6.3.m3.3.3.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p6.3.m3.4b"><apply id="S4.SS2.SSS1.p6.3.m3.4.5.cmml" xref="S4.SS2.SSS1.p6.3.m3.4.5"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p6.3.m3.4.5.1.cmml" xref="S4.SS2.SSS1.p6.3.m3.4.5">subscript</csymbol><ci id="S4.SS2.SSS1.p6.3.m3.4.5.2.cmml" xref="S4.SS2.SSS1.p6.3.m3.4.5.2">𝑤</ci><list id="S4.SS2.SSS1.p6.3.m3.4.4.4.5.cmml" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.4"><interval closure="open" id="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.1.cmml" xref="S4.SS2.SSS1.p6.3.m3.4.4.4.4.1.2"><ci id="S4.SS2.SSS1.p6.3.m3.1.1.1.1.cmml" xref="S4.SS2.SSS1.p6.3.m3.1.1.1.1">𝑚</ci><ci id="S4.SS2.SSS1.p6.3.m3.2.2.2.2.cmml" xref="S4.SS2.SSS1.p6.3.m3.2.2.2.2">𝑛</ci></interval><ci id="S4.SS2.SSS1.p6.3.m3.3.3.3.3.cmml" xref="S4.SS2.SSS1.p6.3.m3.3.3.3.3">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p6.3.m3.4c">w_{(m,n),c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p6.3.m3.4d">italic_w start_POSTSUBSCRIPT ( italic_m , italic_n ) , italic_c end_POSTSUBSCRIPT</annotation></semantics></math>) after the distillation can be used to analyze the alignment between student and teacher attention heads (discussed further in the Analysis section; see Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.F2" title="Figure 2 ‣ 6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p7">
<p class="ltx_p" id="S4.SS2.SSS1.p7.2">Finally, the AAM only adds a small number of extra parameters and operations when determining map discrepancy, compared to the student model. These are estimated as <math alttext="M*N*C" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p7.1.m1.1"><semantics id="S4.SS2.SSS1.p7.1.m1.1a"><mrow id="S4.SS2.SSS1.p7.1.m1.1.1" xref="S4.SS2.SSS1.p7.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p7.1.m1.1.1.2" xref="S4.SS2.SSS1.p7.1.m1.1.1.2.cmml">M</mi><mo id="S4.SS2.SSS1.p7.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p7.1.m1.1.1.1.cmml">*</mo><mi id="S4.SS2.SSS1.p7.1.m1.1.1.3" xref="S4.SS2.SSS1.p7.1.m1.1.1.3.cmml">N</mi><mo id="S4.SS2.SSS1.p7.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p7.1.m1.1.1.1.cmml">*</mo><mi id="S4.SS2.SSS1.p7.1.m1.1.1.4" xref="S4.SS2.SSS1.p7.1.m1.1.1.4.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p7.1.m1.1b"><apply id="S4.SS2.SSS1.p7.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p7.1.m1.1.1"><times id="S4.SS2.SSS1.p7.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p7.1.m1.1.1.1"></times><ci id="S4.SS2.SSS1.p7.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p7.1.m1.1.1.2">𝑀</ci><ci id="S4.SS2.SSS1.p7.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p7.1.m1.1.1.3">𝑁</ci><ci id="S4.SS2.SSS1.p7.1.m1.1.1.4.cmml" xref="S4.SS2.SSS1.p7.1.m1.1.1.4">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p7.1.m1.1c">M*N*C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p7.1.m1.1d">italic_M * italic_N * italic_C</annotation></semantics></math> for parameters and <math alttext="C*L^{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p7.2.m2.1"><semantics id="S4.SS2.SSS1.p7.2.m2.1a"><mrow id="S4.SS2.SSS1.p7.2.m2.1.1" xref="S4.SS2.SSS1.p7.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p7.2.m2.1.1.2" xref="S4.SS2.SSS1.p7.2.m2.1.1.2.cmml">C</mi><mo id="S4.SS2.SSS1.p7.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p7.2.m2.1.1.1.cmml">*</mo><msup id="S4.SS2.SSS1.p7.2.m2.1.1.3" xref="S4.SS2.SSS1.p7.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSS1.p7.2.m2.1.1.3.2" xref="S4.SS2.SSS1.p7.2.m2.1.1.3.2.cmml">L</mi><mn id="S4.SS2.SSS1.p7.2.m2.1.1.3.3" xref="S4.SS2.SSS1.p7.2.m2.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p7.2.m2.1b"><apply id="S4.SS2.SSS1.p7.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p7.2.m2.1.1"><times id="S4.SS2.SSS1.p7.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p7.2.m2.1.1.1"></times><ci id="S4.SS2.SSS1.p7.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p7.2.m2.1.1.2">𝐶</ci><apply id="S4.SS2.SSS1.p7.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p7.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS1.p7.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p7.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS1.p7.2.m2.1.1.3.2">𝐿</ci><cn id="S4.SS2.SSS1.p7.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p7.2.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p7.2.m2.1c">C*L^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p7.2.m2.1d">italic_C * italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> for operations. After training, the AAM can be discarded, as it serves no function during inference.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Module Training</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.2">AAM generates intermediate attention maps (denoted as <math alttext="\mathbf{H}^{I}_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.1.m1.1"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><msubsup id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.2.cmml">𝐇</mi><mi id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml">c</mi><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.2">𝐇</ci><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.3">𝐼</ci></apply><ci id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">\mathbf{H}^{I}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.1d">bold_H start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>) that have the same number as the teacher attention maps, referred to as <math alttext="\mathbf{H}^{T}_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.2.m2.1"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><msubsup id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p1.2.m2.1.1.2.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.2.cmml">𝐇</mi><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml">c</mi><mi id="S4.SS2.SSS2.p1.2.m2.1.1.2.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><apply id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.2">𝐇</ci><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.3">𝑇</ci></apply><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">\mathbf{H}^{T}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.2.m2.1d">bold_H start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>.
We minimize the KL-Divergence between the attention distributions of the intermediate attention maps and the teacher attention maps as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{att}=\sum_{c=1}^{C}D_{KL}({\mathbf{H}^{T}_{c}}||{\mathbf{H}^{I}_{%
c}})." class="ltx_math_unparsed" display="block" id="S4.E10.m1.1"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1b"><msub id="S4.E10.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.2">ℒ</mi><mrow id="S4.E10.m1.1.1.3"><mi id="S4.E10.m1.1.1.3.2">a</mi><mo id="S4.E10.m1.1.1.3.1">⁢</mo><mi id="S4.E10.m1.1.1.3.3">t</mi><mo id="S4.E10.m1.1.1.3.1a">⁢</mo><mi id="S4.E10.m1.1.1.3.4">t</mi></mrow></msub><mo id="S4.E10.m1.1.2" rspace="0.111em">=</mo><munderover id="S4.E10.m1.1.3"><mo id="S4.E10.m1.1.3.2.2" movablelimits="false">∑</mo><mrow id="S4.E10.m1.1.3.2.3"><mi id="S4.E10.m1.1.3.2.3.2">c</mi><mo id="S4.E10.m1.1.3.2.3.1">=</mo><mn id="S4.E10.m1.1.3.2.3.3">1</mn></mrow><mi id="S4.E10.m1.1.3.3">C</mi></munderover><msub id="S4.E10.m1.1.4"><mi id="S4.E10.m1.1.4.2">D</mi><mrow id="S4.E10.m1.1.4.3"><mi id="S4.E10.m1.1.4.3.2">K</mi><mo id="S4.E10.m1.1.4.3.1">⁢</mo><mi id="S4.E10.m1.1.4.3.3">L</mi></mrow></msub><mrow id="S4.E10.m1.1.5"><mo id="S4.E10.m1.1.5.1" stretchy="false">(</mo><msubsup id="S4.E10.m1.1.5.2"><mi id="S4.E10.m1.1.5.2.2.2">𝐇</mi><mi id="S4.E10.m1.1.5.2.3">c</mi><mi id="S4.E10.m1.1.5.2.2.3">T</mi></msubsup><mo fence="false" id="S4.E10.m1.1.5.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.E10.m1.1.5.4" rspace="0.167em" stretchy="false">|</mo><msubsup id="S4.E10.m1.1.5.5"><mi id="S4.E10.m1.1.5.5.2.2">𝐇</mi><mi id="S4.E10.m1.1.5.5.3">c</mi><mi id="S4.E10.m1.1.5.5.2.3">I</mi></msubsup><mo id="S4.E10.m1.1.5.6" stretchy="false">)</mo></mrow><mo id="S4.E10.m1.1.6" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\mathcal{L}_{att}=\sum_{c=1}^{C}D_{KL}({\mathbf{H}^{T}_{c}}||{\mathbf{H}^{I}_{%
c}}).</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_a italic_t italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C end_POSTSUPERSCRIPT italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( bold_H start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT | | bold_H start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p1.4">This equation represents the attention transfer loss function, <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.3.m1.1"><semantics id="S4.SS2.SSS2.p1.3.m1.1a"><msub id="S4.SS2.SSS2.p1.3.m1.1.1" xref="S4.SS2.SSS2.p1.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p1.3.m1.1.1.2" xref="S4.SS2.SSS2.p1.3.m1.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p1.3.m1.1.1.3" xref="S4.SS2.SSS2.p1.3.m1.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m1.1b"><apply id="S4.SS2.SSS2.p1.3.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.3.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.3.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.3.m1.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p1.3.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.3.m1.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m1.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math>, which quantifies the difference between the teacher’s attention maps and the intermediate attention maps.
To break down further, <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.4.m2.1"><semantics id="S4.SS2.SSS2.p1.4.m2.1a"><msub id="S4.SS2.SSS2.p1.4.m2.1.1" xref="S4.SS2.SSS2.p1.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p1.4.m2.1.1.2" xref="S4.SS2.SSS2.p1.4.m2.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p1.4.m2.1.1.3" xref="S4.SS2.SSS2.p1.4.m2.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m2.1b"><apply id="S4.SS2.SSS2.p1.4.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.4.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.4.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.4.m2.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p1.4.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p1.4.m2.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m2.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.4.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> incorporates three different terms according to the types of attention maps.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{att}}=\mathcal{L}_{\mathrm{att}}^{\mathrm{enc-self}}+%
\frac{1}{2}\left(\mathcal{L}_{\mathrm{att}}^{\mathrm{dec-self}}+\mathcal{L}_{%
\mathrm{att}}^{\mathrm{dec-cross}}\right)" class="ltx_Math" display="block" id="S4.E11.m1.1"><semantics id="S4.E11.m1.1a"><mrow id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml"><msub id="S4.E11.m1.1.1.3" xref="S4.E11.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.3.2" xref="S4.E11.m1.1.1.3.2.cmml">ℒ</mi><mi id="S4.E11.m1.1.1.3.3" xref="S4.E11.m1.1.1.3.3.cmml">att</mi></msub><mo id="S4.E11.m1.1.1.2" xref="S4.E11.m1.1.1.2.cmml">=</mo><mrow id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.cmml"><msubsup id="S4.E11.m1.1.1.1.3" xref="S4.E11.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.3.2.2" xref="S4.E11.m1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.E11.m1.1.1.1.3.2.3" xref="S4.E11.m1.1.1.1.3.2.3.cmml">att</mi><mrow id="S4.E11.m1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.3.3.cmml"><mi id="S4.E11.m1.1.1.1.3.3.2" xref="S4.E11.m1.1.1.1.3.3.2.cmml">enc</mi><mo id="S4.E11.m1.1.1.1.3.3.1" xref="S4.E11.m1.1.1.1.3.3.1.cmml">−</mo><mi id="S4.E11.m1.1.1.1.3.3.3" xref="S4.E11.m1.1.1.1.3.3.3.cmml">self</mi></mrow></msubsup><mo id="S4.E11.m1.1.1.1.2" xref="S4.E11.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><mfrac id="S4.E11.m1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.3.cmml"><mn id="S4.E11.m1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.3.2.cmml">1</mn><mn id="S4.E11.m1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.3.3.cmml">2</mn></mfrac><mo id="S4.E11.m1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E11.m1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.1.1.1.1.2.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.2.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2.3.cmml">att</mi><mrow id="S4.E11.m1.1.1.1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.2.3.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.2.cmml">dec</mi><mo id="S4.E11.m1.1.1.1.1.1.1.1.2.3.1" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mi id="S4.E11.m1.1.1.1.1.1.1.1.2.3.3" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.3.cmml">self</mi></mrow></msubsup><mo id="S4.E11.m1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S4.E11.m1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.1.1.1.1.3.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.3.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2.3.cmml">att</mi><mrow id="S4.E11.m1.1.1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.2.cmml">dec</mi><mo id="S4.E11.m1.1.1.1.1.1.1.1.3.3.1" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mi id="S4.E11.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.3.cmml">cross</mi></mrow></msubsup></mrow><mo id="S4.E11.m1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><apply id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1"><eq id="S4.E11.m1.1.1.2.cmml" xref="S4.E11.m1.1.1.2"></eq><apply id="S4.E11.m1.1.1.3.cmml" xref="S4.E11.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.3.2">ℒ</ci><ci id="S4.E11.m1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.3.3">att</ci></apply><apply id="S4.E11.m1.1.1.1.cmml" xref="S4.E11.m1.1.1.1"><plus id="S4.E11.m1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.2"></plus><apply id="S4.E11.m1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.3">superscript</csymbol><apply id="S4.E11.m1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.3.2.1.cmml" xref="S4.E11.m1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.3.2.2.cmml" xref="S4.E11.m1.1.1.1.3.2.2">ℒ</ci><ci id="S4.E11.m1.1.1.1.3.2.3.cmml" xref="S4.E11.m1.1.1.1.3.2.3">att</ci></apply><apply id="S4.E11.m1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.3.3"><minus id="S4.E11.m1.1.1.1.3.3.1.cmml" xref="S4.E11.m1.1.1.1.3.3.1"></minus><ci id="S4.E11.m1.1.1.1.3.3.2.cmml" xref="S4.E11.m1.1.1.1.3.3.2">enc</ci><ci id="S4.E11.m1.1.1.1.3.3.3.cmml" xref="S4.E11.m1.1.1.1.3.3.3">self</ci></apply></apply><apply id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1"><times id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.2"></times><apply id="S4.E11.m1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.3"><divide id="S4.E11.m1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.3"></divide><cn id="S4.E11.m1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E11.m1.1.1.1.1.3.2">1</cn><cn id="S4.E11.m1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E11.m1.1.1.1.1.3.3">2</cn></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1"><plus id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2.2">ℒ</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2.3">att</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3"><minus id="S4.E11.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.2">dec</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3.3">self</ci></apply></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2.2">ℒ</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2.3">att</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3"><minus id="S4.E11.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.2">dec</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.3">cross</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">\mathcal{L}_{\mathrm{att}}=\mathcal{L}_{\mathrm{att}}^{\mathrm{enc-self}}+%
\frac{1}{2}\left(\mathcal{L}_{\mathrm{att}}^{\mathrm{dec-self}}+\mathcal{L}_{%
\mathrm{att}}^{\mathrm{dec-cross}}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_enc - roman_self end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_self end_POSTSUPERSCRIPT + caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_cross end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p2.4"><math alttext="\mathcal{L}_{\mathrm{att}}^{\mathrm{enc-self}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.1.m1.1"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><msubsup id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.1.m1.1.1.2.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p2.1.m1.1.1.2.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.3.cmml">att</mi><mrow id="S4.SS2.SSS2.p2.1.m1.1.1.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.2.cmml">enc</mi><mo id="S4.SS2.SSS2.p2.1.m1.1.1.3.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.1.cmml">−</mo><mi id="S4.SS2.SSS2.p2.1.m1.1.1.3.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.3.cmml">self</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><apply id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.2">ℒ</ci><ci id="S4.SS2.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.3">att</ci></apply><apply id="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.3"><minus id="S4.SS2.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.1"></minus><ci id="S4.SS2.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.2">enc</ci><ci id="S4.SS2.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.3">self</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">\mathcal{L}_{\mathrm{att}}^{\mathrm{enc-self}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_enc - roman_self end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{L}_{\mathrm{att}}^{\mathrm{dec-self}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.2.m2.1"><semantics id="S4.SS2.SSS2.p2.2.m2.1a"><msubsup id="S4.SS2.SSS2.p2.2.m2.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.2.m2.1.1.2.2" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p2.2.m2.1.1.2.3" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.3.cmml">att</mi><mrow id="S4.SS2.SSS2.p2.2.m2.1.1.3" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSS2.p2.2.m2.1.1.3.2" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.2.cmml">dec</mi><mo id="S4.SS2.SSS2.p2.2.m2.1.1.3.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.1.cmml">−</mo><mi id="S4.SS2.SSS2.p2.2.m2.1.1.3.3" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.3.cmml">self</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m2.1b"><apply id="S4.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.2">ℒ</ci><ci id="S4.SS2.SSS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.3">att</ci></apply><apply id="S4.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.3"><minus id="S4.SS2.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.1"></minus><ci id="S4.SS2.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.2">dec</ci><ci id="S4.SS2.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.3">self</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m2.1c">\mathcal{L}_{\mathrm{att}}^{\mathrm{dec-self}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_self end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\mathcal{L}_{\mathrm{att}}^{\mathrm{dec-cross}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.3.m3.1"><semantics id="S4.SS2.SSS2.p2.3.m3.1a"><msubsup id="S4.SS2.SSS2.p2.3.m3.1.1" xref="S4.SS2.SSS2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.3.m3.1.1.2.2" xref="S4.SS2.SSS2.p2.3.m3.1.1.2.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p2.3.m3.1.1.2.3" xref="S4.SS2.SSS2.p2.3.m3.1.1.2.3.cmml">att</mi><mrow id="S4.SS2.SSS2.p2.3.m3.1.1.3" xref="S4.SS2.SSS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.SSS2.p2.3.m3.1.1.3.2" xref="S4.SS2.SSS2.p2.3.m3.1.1.3.2.cmml">dec</mi><mo id="S4.SS2.SSS2.p2.3.m3.1.1.3.1" xref="S4.SS2.SSS2.p2.3.m3.1.1.3.1.cmml">−</mo><mi id="S4.SS2.SSS2.p2.3.m3.1.1.3.3" xref="S4.SS2.SSS2.p2.3.m3.1.1.3.3.cmml">cross</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.3.m3.1b"><apply id="S4.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.2.2">ℒ</ci><ci id="S4.SS2.SSS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.2.3">att</ci></apply><apply id="S4.SS2.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.3"><minus id="S4.SS2.SSS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.3.1"></minus><ci id="S4.SS2.SSS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.3.2">dec</ci><ci id="S4.SS2.SSS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1.3.3">cross</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.3.m3.1c">\mathcal{L}_{\mathrm{att}}^{\mathrm{dec-cross}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_cross end_POSTSUPERSCRIPT</annotation></semantics></math> above correspond to the loss in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E10" title="10 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">10</span></a>) estimates from three different types of attention maps in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E6" title="6 ‣ 4.1 Attention Map as a Knowledge ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">6</span></a>), (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E7" title="7 ‣ 4.1 Attention Map as a Knowledge ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">7</span></a>), (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E8" title="8 ‣ 4.1 Attention Map as a Knowledge ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">8</span></a>).
To balance the loss scale between the encoder and decoder, we divide the sum of losses for the decoder by 2.
To sum up, the attention transfer loss <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.4.m4.1"><semantics id="S4.SS2.SSS2.p2.4.m4.1a"><msub id="S4.SS2.SSS2.p2.4.m4.1.1" xref="S4.SS2.SSS2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.4.m4.1.1.2" xref="S4.SS2.SSS2.p2.4.m4.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p2.4.m4.1.1.3" xref="S4.SS2.SSS2.p2.4.m4.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.4.m4.1b"><apply id="S4.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.4.m4.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> incorporates three types of attention mechanism in the encoder-decoder model (i.e. self-attention of each encoder and decoder, and cross attention)
with balancing for the encoder and decoder-side losses.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p3">
<p class="ltx_p" id="S4.SS2.SSS2.p3.4">Since <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.1.m1.1"><semantics id="S4.SS2.SSS2.p3.1.m1.1a"><msub id="S4.SS2.SSS2.p3.1.m1.1.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.1.m1.1.1.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.1.m1.1b"><apply id="S4.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.1.m1.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> is orthogonal to the loss from knowledge distillation by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib8" title="">Hinton et al.</a></cite> (<math alttext="\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.2.m2.1"><semantics id="S4.SS2.SSS2.p3.2.m2.1a"><msub id="S4.SS2.SSS2.p3.2.m2.1.1" xref="S4.SS2.SSS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.2.m2.1.1.2" xref="S4.SS2.SSS2.p3.2.m2.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.2.m2.1.1.3" xref="S4.SS2.SSS2.p3.2.m2.1.1.3.cmml">KD</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.2.m2.1b"><apply id="S4.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1.3">KD</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.2.m2.1c">\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math>), it can be used jointly to give additional supervision.
Throughout the paper, we denote the distillation approach with only <math alttext="\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.3.m3.1"><semantics id="S4.SS2.SSS2.p3.3.m3.1a"><msub id="S4.SS2.SSS2.p3.3.m3.1.1" xref="S4.SS2.SSS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.3.m3.1.1.2" xref="S4.SS2.SSS2.p3.3.m3.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.3.m3.1.1.3" xref="S4.SS2.SSS2.p3.3.m3.1.1.3.cmml">KD</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.3.m3.1b"><apply id="S4.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1.3">KD</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.3.m3.1c">\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math> as vanilla KD.
To form a final loss for A2D, we add the cross-entropy loss <math alttext="\mathcal{L}_{\mathrm{CE}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.4.m4.1"><semantics id="S4.SS2.SSS2.p3.4.m4.1a"><msub id="S4.SS2.SSS2.p3.4.m4.1.1" xref="S4.SS2.SSS2.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.4.m4.1.1.2" xref="S4.SS2.SSS2.p3.4.m4.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.4.m4.1.1.3" xref="S4.SS2.SSS2.p3.4.m4.1.1.3.cmml">CE</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.4.m4.1b"><apply id="S4.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1.3">CE</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.4.m4.1c">\mathcal{L}_{\mathrm{CE}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT</annotation></semantics></math> of student model for translation task as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{\mathrm{CE}}+\lambda\mathcal{L}_{\mathrm{att}}+\mu%
\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="block" id="S4.E12.m1.1"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.2" xref="S4.E12.m1.1.1.2.cmml">ℒ</mi><mo id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.cmml">=</mo><mrow id="S4.E12.m1.1.1.3" xref="S4.E12.m1.1.1.3.cmml"><msub id="S4.E12.m1.1.1.3.2" xref="S4.E12.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.3.2.2" xref="S4.E12.m1.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.E12.m1.1.1.3.2.3" xref="S4.E12.m1.1.1.3.2.3.cmml">CE</mi></msub><mo id="S4.E12.m1.1.1.3.1" xref="S4.E12.m1.1.1.3.1.cmml">+</mo><mrow id="S4.E12.m1.1.1.3.3" xref="S4.E12.m1.1.1.3.3.cmml"><mi id="S4.E12.m1.1.1.3.3.2" xref="S4.E12.m1.1.1.3.3.2.cmml">λ</mi><mo id="S4.E12.m1.1.1.3.3.1" xref="S4.E12.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S4.E12.m1.1.1.3.3.3" xref="S4.E12.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.3.3.3.2" xref="S4.E12.m1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S4.E12.m1.1.1.3.3.3.3" xref="S4.E12.m1.1.1.3.3.3.3.cmml">att</mi></msub></mrow><mo id="S4.E12.m1.1.1.3.1a" xref="S4.E12.m1.1.1.3.1.cmml">+</mo><mrow id="S4.E12.m1.1.1.3.4" xref="S4.E12.m1.1.1.3.4.cmml"><mi id="S4.E12.m1.1.1.3.4.2" xref="S4.E12.m1.1.1.3.4.2.cmml">μ</mi><mo id="S4.E12.m1.1.1.3.4.1" xref="S4.E12.m1.1.1.3.4.1.cmml">⁢</mo><msub id="S4.E12.m1.1.1.3.4.3" xref="S4.E12.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.3.4.3.2" xref="S4.E12.m1.1.1.3.4.3.2.cmml">ℒ</mi><mi id="S4.E12.m1.1.1.3.4.3.3" xref="S4.E12.m1.1.1.3.4.3.3.cmml">KD</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1"><eq id="S4.E12.m1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"></eq><ci id="S4.E12.m1.1.1.2.cmml" xref="S4.E12.m1.1.1.2">ℒ</ci><apply id="S4.E12.m1.1.1.3.cmml" xref="S4.E12.m1.1.1.3"><plus id="S4.E12.m1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.3.1"></plus><apply id="S4.E12.m1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.3.2.1.cmml" xref="S4.E12.m1.1.1.3.2">subscript</csymbol><ci id="S4.E12.m1.1.1.3.2.2.cmml" xref="S4.E12.m1.1.1.3.2.2">ℒ</ci><ci id="S4.E12.m1.1.1.3.2.3.cmml" xref="S4.E12.m1.1.1.3.2.3">CE</ci></apply><apply id="S4.E12.m1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.3.3"><times id="S4.E12.m1.1.1.3.3.1.cmml" xref="S4.E12.m1.1.1.3.3.1"></times><ci id="S4.E12.m1.1.1.3.3.2.cmml" xref="S4.E12.m1.1.1.3.3.2">𝜆</ci><apply id="S4.E12.m1.1.1.3.3.3.cmml" xref="S4.E12.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.3.3.3.1.cmml" xref="S4.E12.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.E12.m1.1.1.3.3.3.2.cmml" xref="S4.E12.m1.1.1.3.3.3.2">ℒ</ci><ci id="S4.E12.m1.1.1.3.3.3.3.cmml" xref="S4.E12.m1.1.1.3.3.3.3">att</ci></apply></apply><apply id="S4.E12.m1.1.1.3.4.cmml" xref="S4.E12.m1.1.1.3.4"><times id="S4.E12.m1.1.1.3.4.1.cmml" xref="S4.E12.m1.1.1.3.4.1"></times><ci id="S4.E12.m1.1.1.3.4.2.cmml" xref="S4.E12.m1.1.1.3.4.2">𝜇</ci><apply id="S4.E12.m1.1.1.3.4.3.cmml" xref="S4.E12.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.3.4.3.1.cmml" xref="S4.E12.m1.1.1.3.4.3">subscript</csymbol><ci id="S4.E12.m1.1.1.3.4.3.2.cmml" xref="S4.E12.m1.1.1.3.4.3.2">ℒ</ci><ci id="S4.E12.m1.1.1.3.4.3.3.cmml" xref="S4.E12.m1.1.1.3.4.3.3">KD</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\mathcal{L}=\mathcal{L}_{\mathrm{CE}}+\lambda\mathcal{L}_{\mathrm{att}}+\mu%
\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT + italic_λ caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT + italic_μ caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p3.19">The student model and the AAM are collaboratively optimized through an end-to-end approach, as described in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E12" title="12 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">12</span></a>).
Given that <math alttext="H_{c}^{I}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.5.m1.1"><semantics id="S4.SS2.SSS2.p3.5.m1.1a"><msubsup id="S4.SS2.SSS2.p3.5.m1.1.1" xref="S4.SS2.SSS2.p3.5.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.5.m1.1.1.2.2" xref="S4.SS2.SSS2.p3.5.m1.1.1.2.2.cmml">H</mi><mi id="S4.SS2.SSS2.p3.5.m1.1.1.2.3" xref="S4.SS2.SSS2.p3.5.m1.1.1.2.3.cmml">c</mi><mi id="S4.SS2.SSS2.p3.5.m1.1.1.3" xref="S4.SS2.SSS2.p3.5.m1.1.1.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.5.m1.1b"><apply id="S4.SS2.SSS2.p3.5.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.5.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p3.5.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.5.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.5.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.5.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.5.m1.1.1.2.2">𝐻</ci><ci id="S4.SS2.SSS2.p3.5.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p3.5.m1.1.1.2.3">𝑐</ci></apply><ci id="S4.SS2.SSS2.p3.5.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.5.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.5.m1.1c">H_{c}^{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.5.m1.1d">italic_H start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math> is differentiable with respect to <math alttext="w_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.6.m2.1"><semantics id="S4.SS2.SSS2.p3.6.m2.1a"><msub id="S4.SS2.SSS2.p3.6.m2.1.1" xref="S4.SS2.SSS2.p3.6.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p3.6.m2.1.1.2" xref="S4.SS2.SSS2.p3.6.m2.1.1.2.cmml">w</mi><mi id="S4.SS2.SSS2.p3.6.m2.1.1.3" xref="S4.SS2.SSS2.p3.6.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.6.m2.1b"><apply id="S4.SS2.SSS2.p3.6.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.6.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.6.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p3.6.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.6.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p3.6.m2.1.1.2">𝑤</ci><ci id="S4.SS2.SSS2.p3.6.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p3.6.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.6.m2.1c">w_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.6.m2.1d">italic_w start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, the <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.7.m3.1"><semantics id="S4.SS2.SSS2.p3.7.m3.1a"><msub id="S4.SS2.SSS2.p3.7.m3.1.1" xref="S4.SS2.SSS2.p3.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.7.m3.1.1.2" xref="S4.SS2.SSS2.p3.7.m3.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.7.m3.1.1.3" xref="S4.SS2.SSS2.p3.7.m3.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.7.m3.1b"><apply id="S4.SS2.SSS2.p3.7.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.7.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p3.7.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.7.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p3.7.m3.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.7.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p3.7.m3.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.7.m3.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.7.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> from Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E10" title="10 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">10</span></a>) actively modifies <math alttext="w_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.8.m4.1"><semantics id="S4.SS2.SSS2.p3.8.m4.1a"><msub id="S4.SS2.SSS2.p3.8.m4.1.1" xref="S4.SS2.SSS2.p3.8.m4.1.1.cmml"><mi id="S4.SS2.SSS2.p3.8.m4.1.1.2" xref="S4.SS2.SSS2.p3.8.m4.1.1.2.cmml">w</mi><mi id="S4.SS2.SSS2.p3.8.m4.1.1.3" xref="S4.SS2.SSS2.p3.8.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.8.m4.1b"><apply id="S4.SS2.SSS2.p3.8.m4.1.1.cmml" xref="S4.SS2.SSS2.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.8.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p3.8.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.8.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p3.8.m4.1.1.2">𝑤</ci><ci id="S4.SS2.SSS2.p3.8.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p3.8.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.8.m4.1c">w_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.8.m4.1d">italic_w start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and the student’s parameters to minimize the KL-Divergence between the teacher’s attention maps and the intermediate attention maps.
At the same time, both <math alttext="\mathcal{L}_{\mathrm{CE}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.9.m5.1"><semantics id="S4.SS2.SSS2.p3.9.m5.1a"><msub id="S4.SS2.SSS2.p3.9.m5.1.1" xref="S4.SS2.SSS2.p3.9.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.9.m5.1.1.2" xref="S4.SS2.SSS2.p3.9.m5.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.9.m5.1.1.3" xref="S4.SS2.SSS2.p3.9.m5.1.1.3.cmml">CE</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.9.m5.1b"><apply id="S4.SS2.SSS2.p3.9.m5.1.1.cmml" xref="S4.SS2.SSS2.p3.9.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.9.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p3.9.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.9.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p3.9.m5.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.9.m5.1.1.3.cmml" xref="S4.SS2.SSS2.p3.9.m5.1.1.3">CE</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.9.m5.1c">\mathcal{L}_{\mathrm{CE}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.9.m5.1d">caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.10.m6.1"><semantics id="S4.SS2.SSS2.p3.10.m6.1a"><msub id="S4.SS2.SSS2.p3.10.m6.1.1" xref="S4.SS2.SSS2.p3.10.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.10.m6.1.1.2" xref="S4.SS2.SSS2.p3.10.m6.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.10.m6.1.1.3" xref="S4.SS2.SSS2.p3.10.m6.1.1.3.cmml">KD</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.10.m6.1b"><apply id="S4.SS2.SSS2.p3.10.m6.1.1.cmml" xref="S4.SS2.SSS2.p3.10.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.10.m6.1.1.1.cmml" xref="S4.SS2.SSS2.p3.10.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.10.m6.1.1.2.cmml" xref="S4.SS2.SSS2.p3.10.m6.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.10.m6.1.1.3.cmml" xref="S4.SS2.SSS2.p3.10.m6.1.1.3">KD</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.10.m6.1c">\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.10.m6.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math> indirectly affect the adjustment of <math alttext="w_{c}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.11.m7.1"><semantics id="S4.SS2.SSS2.p3.11.m7.1a"><msub id="S4.SS2.SSS2.p3.11.m7.1.1" xref="S4.SS2.SSS2.p3.11.m7.1.1.cmml"><mi id="S4.SS2.SSS2.p3.11.m7.1.1.2" xref="S4.SS2.SSS2.p3.11.m7.1.1.2.cmml">w</mi><mi id="S4.SS2.SSS2.p3.11.m7.1.1.3" xref="S4.SS2.SSS2.p3.11.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.11.m7.1b"><apply id="S4.SS2.SSS2.p3.11.m7.1.1.cmml" xref="S4.SS2.SSS2.p3.11.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.11.m7.1.1.1.cmml" xref="S4.SS2.SSS2.p3.11.m7.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.11.m7.1.1.2.cmml" xref="S4.SS2.SSS2.p3.11.m7.1.1.2">𝑤</ci><ci id="S4.SS2.SSS2.p3.11.m7.1.1.3.cmml" xref="S4.SS2.SSS2.p3.11.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.11.m7.1c">w_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.11.m7.1d">italic_w start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, since <math alttext="\mathbf{H}^{S}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.12.m8.1"><semantics id="S4.SS2.SSS2.p3.12.m8.1a"><msup id="S4.SS2.SSS2.p3.12.m8.1.1" xref="S4.SS2.SSS2.p3.12.m8.1.1.cmml"><mi id="S4.SS2.SSS2.p3.12.m8.1.1.2" xref="S4.SS2.SSS2.p3.12.m8.1.1.2.cmml">𝐇</mi><mi id="S4.SS2.SSS2.p3.12.m8.1.1.3" xref="S4.SS2.SSS2.p3.12.m8.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.12.m8.1b"><apply id="S4.SS2.SSS2.p3.12.m8.1.1.cmml" xref="S4.SS2.SSS2.p3.12.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.12.m8.1.1.1.cmml" xref="S4.SS2.SSS2.p3.12.m8.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p3.12.m8.1.1.2.cmml" xref="S4.SS2.SSS2.p3.12.m8.1.1.2">𝐇</ci><ci id="S4.SS2.SSS2.p3.12.m8.1.1.3.cmml" xref="S4.SS2.SSS2.p3.12.m8.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.12.m8.1c">\mathbf{H}^{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.12.m8.1d">bold_H start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT</annotation></semantics></math> is related to the student model’s predictions.
The hyperparameters <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.13.m9.1"><semantics id="S4.SS2.SSS2.p3.13.m9.1a"><mi id="S4.SS2.SSS2.p3.13.m9.1.1" xref="S4.SS2.SSS2.p3.13.m9.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.13.m9.1b"><ci id="S4.SS2.SSS2.p3.13.m9.1.1.cmml" xref="S4.SS2.SSS2.p3.13.m9.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.13.m9.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.13.m9.1d">italic_λ</annotation></semantics></math> and <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.14.m10.1"><semantics id="S4.SS2.SSS2.p3.14.m10.1a"><mi id="S4.SS2.SSS2.p3.14.m10.1.1" xref="S4.SS2.SSS2.p3.14.m10.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.14.m10.1b"><ci id="S4.SS2.SSS2.p3.14.m10.1.1.cmml" xref="S4.SS2.SSS2.p3.14.m10.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.14.m10.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.14.m10.1d">italic_μ</annotation></semantics></math> serve as modulating factors to balance the weights of <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.15.m11.1"><semantics id="S4.SS2.SSS2.p3.15.m11.1a"><msub id="S4.SS2.SSS2.p3.15.m11.1.1" xref="S4.SS2.SSS2.p3.15.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.15.m11.1.1.2" xref="S4.SS2.SSS2.p3.15.m11.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.15.m11.1.1.3" xref="S4.SS2.SSS2.p3.15.m11.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.15.m11.1b"><apply id="S4.SS2.SSS2.p3.15.m11.1.1.cmml" xref="S4.SS2.SSS2.p3.15.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.15.m11.1.1.1.cmml" xref="S4.SS2.SSS2.p3.15.m11.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.15.m11.1.1.2.cmml" xref="S4.SS2.SSS2.p3.15.m11.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.15.m11.1.1.3.cmml" xref="S4.SS2.SSS2.p3.15.m11.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.15.m11.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.15.m11.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.16.m12.1"><semantics id="S4.SS2.SSS2.p3.16.m12.1a"><msub id="S4.SS2.SSS2.p3.16.m12.1.1" xref="S4.SS2.SSS2.p3.16.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.16.m12.1.1.2" xref="S4.SS2.SSS2.p3.16.m12.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.16.m12.1.1.3" xref="S4.SS2.SSS2.p3.16.m12.1.1.3.cmml">KD</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.16.m12.1b"><apply id="S4.SS2.SSS2.p3.16.m12.1.1.cmml" xref="S4.SS2.SSS2.p3.16.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.16.m12.1.1.1.cmml" xref="S4.SS2.SSS2.p3.16.m12.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.16.m12.1.1.2.cmml" xref="S4.SS2.SSS2.p3.16.m12.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.16.m12.1.1.3.cmml" xref="S4.SS2.SSS2.p3.16.m12.1.1.3">KD</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.16.m12.1c">\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.16.m12.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math>. In line with Dynamic KD <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib15" title="">2021</a>)</cite>, we modulate the value of <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.17.m13.1"><semantics id="S4.SS2.SSS2.p3.17.m13.1a"><mi id="S4.SS2.SSS2.p3.17.m13.1.1" xref="S4.SS2.SSS2.p3.17.m13.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.17.m13.1b"><ci id="S4.SS2.SSS2.p3.17.m13.1.1.cmml" xref="S4.SS2.SSS2.p3.17.m13.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.17.m13.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.17.m13.1d">italic_λ</annotation></semantics></math> during training to adjust the supervision derived from <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.18.m14.1"><semantics id="S4.SS2.SSS2.p3.18.m14.1a"><msub id="S4.SS2.SSS2.p3.18.m14.1.1" xref="S4.SS2.SSS2.p3.18.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.18.m14.1.1.2" xref="S4.SS2.SSS2.p3.18.m14.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.18.m14.1.1.3" xref="S4.SS2.SSS2.p3.18.m14.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.18.m14.1b"><apply id="S4.SS2.SSS2.p3.18.m14.1.1.cmml" xref="S4.SS2.SSS2.p3.18.m14.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.18.m14.1.1.1.cmml" xref="S4.SS2.SSS2.p3.18.m14.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.18.m14.1.1.2.cmml" xref="S4.SS2.SSS2.p3.18.m14.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.18.m14.1.1.3.cmml" xref="S4.SS2.SSS2.p3.18.m14.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.18.m14.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.18.m14.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p3.19.m15.1"><semantics id="S4.SS2.SSS2.p3.19.m15.1a"><msub id="S4.SS2.SSS2.p3.19.m15.1.1" xref="S4.SS2.SSS2.p3.19.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p3.19.m15.1.1.2" xref="S4.SS2.SSS2.p3.19.m15.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.SSS2.p3.19.m15.1.1.3" xref="S4.SS2.SSS2.p3.19.m15.1.1.3.cmml">KD</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.19.m15.1b"><apply id="S4.SS2.SSS2.p3.19.m15.1.1.cmml" xref="S4.SS2.SSS2.p3.19.m15.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.19.m15.1.1.1.cmml" xref="S4.SS2.SSS2.p3.19.m15.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.19.m15.1.1.2.cmml" xref="S4.SS2.SSS2.p3.19.m15.1.1.2">ℒ</ci><ci id="S4.SS2.SSS2.p3.19.m15.1.1.3.cmml" xref="S4.SS2.SSS2.p3.19.m15.1.1.3">KD</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.19.m15.1c">\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.19.m15.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.45">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.3.4">Models</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1">De <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.m1.1.1" stretchy="false" xref="S4.T1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">→</annotation></semantics></math> En</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.2">De <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.m1.1a"><mo id="S4.T1.2.2.2.m1.1.1" stretchy="false" xref="S4.T1.2.2.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><ci id="S4.T1.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.m1.1d">→</annotation></semantics></math> Dsb</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3">En <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T1.3.3.3.m1.1"><semantics id="S4.T1.3.3.3.m1.1a"><mo id="S4.T1.3.3.3.m1.1.1" stretchy="false" xref="S4.T1.3.3.3.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.m1.1b"><ci id="S4.T1.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.m1.1d">→</annotation></semantics></math> Zh</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.6.4">Teacher (6-layer)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.1">36.79 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S4.T1.4.4.1.m1.1"><semantics id="S4.T1.4.4.1.m1.1a"><mrow id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml"><mo id="S4.T1.4.4.1.m1.1.1a" mathsize="70%" xref="S4.T1.4.4.1.m1.1.1.cmml">±</mo><mn id="S4.T1.4.4.1.m1.1.1.2" mathsize="70%" xref="S4.T1.4.4.1.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><apply id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.4.4.1.m1.1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.4.4.1.m1.1.1.2.cmml" type="float" xref="S4.T1.4.4.1.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.1.m1.1d">± 0.51</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.2">38.68 <math alttext="\scriptstyle\pm 2.02" class="ltx_Math" display="inline" id="S4.T1.5.5.2.m1.1"><semantics id="S4.T1.5.5.2.m1.1a"><mrow id="S4.T1.5.5.2.m1.1.1" xref="S4.T1.5.5.2.m1.1.1.cmml"><mo id="S4.T1.5.5.2.m1.1.1a" mathsize="70%" xref="S4.T1.5.5.2.m1.1.1.cmml">±</mo><mn id="S4.T1.5.5.2.m1.1.1.2" mathsize="70%" xref="S4.T1.5.5.2.m1.1.1.2.cmml">2.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.2.m1.1b"><apply id="S4.T1.5.5.2.m1.1.1.cmml" xref="S4.T1.5.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.5.5.2.m1.1.1.1.cmml" xref="S4.T1.5.5.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.5.5.2.m1.1.1.2.cmml" type="float" xref="S4.T1.5.5.2.m1.1.1.2">2.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.2.m1.1c">\scriptstyle\pm 2.02</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.2.m1.1d">± 2.02</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.6.3">23.97 <math alttext="\scriptstyle\pm 0.34" class="ltx_Math" display="inline" id="S4.T1.6.6.3.m1.1"><semantics id="S4.T1.6.6.3.m1.1a"><mrow id="S4.T1.6.6.3.m1.1.1" xref="S4.T1.6.6.3.m1.1.1.cmml"><mo id="S4.T1.6.6.3.m1.1.1a" mathsize="70%" xref="S4.T1.6.6.3.m1.1.1.cmml">±</mo><mn id="S4.T1.6.6.3.m1.1.1.2" mathsize="70%" xref="S4.T1.6.6.3.m1.1.1.2.cmml">0.34</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.3.m1.1b"><apply id="S4.T1.6.6.3.m1.1.1.cmml" xref="S4.T1.6.6.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.6.6.3.m1.1.1.1.cmml" xref="S4.T1.6.6.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.6.6.3.m1.1.1.2.cmml" type="float" xref="S4.T1.6.6.3.m1.1.1.2">0.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.3.m1.1c">\scriptstyle\pm 0.34</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.3.m1.1d">± 0.34</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.45.46.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="4" id="S4.T1.45.46.1.1" style="padding-bottom:2.15277pt;">Student (3-layer)</th>
</tr>
<tr class="ltx_tr" id="S4.T1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.9.9.4">No KD</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.1">36.24 <math alttext="\scriptstyle\pm 0.50" class="ltx_Math" display="inline" id="S4.T1.7.7.1.m1.1"><semantics id="S4.T1.7.7.1.m1.1a"><mrow id="S4.T1.7.7.1.m1.1.1" xref="S4.T1.7.7.1.m1.1.1.cmml"><mo id="S4.T1.7.7.1.m1.1.1a" mathsize="70%" xref="S4.T1.7.7.1.m1.1.1.cmml">±</mo><mn id="S4.T1.7.7.1.m1.1.1.2" mathsize="70%" xref="S4.T1.7.7.1.m1.1.1.2.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.1.m1.1b"><apply id="S4.T1.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.7.7.1.m1.1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.7.7.1.m1.1.1.2.cmml" type="float" xref="S4.T1.7.7.1.m1.1.1.2">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.1.m1.1c">\scriptstyle\pm 0.50</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.1.m1.1d">± 0.50</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.8.8.2">35.88 <math alttext="\scriptstyle\pm 1.97" class="ltx_Math" display="inline" id="S4.T1.8.8.2.m1.1"><semantics id="S4.T1.8.8.2.m1.1a"><mrow id="S4.T1.8.8.2.m1.1.1" xref="S4.T1.8.8.2.m1.1.1.cmml"><mo id="S4.T1.8.8.2.m1.1.1a" mathsize="70%" xref="S4.T1.8.8.2.m1.1.1.cmml">±</mo><mn id="S4.T1.8.8.2.m1.1.1.2" mathsize="70%" xref="S4.T1.8.8.2.m1.1.1.2.cmml">1.97</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.2.m1.1b"><apply id="S4.T1.8.8.2.m1.1.1.cmml" xref="S4.T1.8.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.8.8.2.m1.1.1.1.cmml" xref="S4.T1.8.8.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.8.8.2.m1.1.1.2.cmml" type="float" xref="S4.T1.8.8.2.m1.1.1.2">1.97</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.2.m1.1c">\scriptstyle\pm 1.97</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.2.m1.1d">± 1.97</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.9.9.3">23.20 <math alttext="\scriptstyle\pm 0.31" class="ltx_Math" display="inline" id="S4.T1.9.9.3.m1.1"><semantics id="S4.T1.9.9.3.m1.1a"><mrow id="S4.T1.9.9.3.m1.1.1" xref="S4.T1.9.9.3.m1.1.1.cmml"><mo id="S4.T1.9.9.3.m1.1.1a" mathsize="70%" xref="S4.T1.9.9.3.m1.1.1.cmml">±</mo><mn id="S4.T1.9.9.3.m1.1.1.2" mathsize="70%" xref="S4.T1.9.9.3.m1.1.1.2.cmml">0.31</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.3.m1.1b"><apply id="S4.T1.9.9.3.m1.1.1.cmml" xref="S4.T1.9.9.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.9.9.3.m1.1.1.1.cmml" xref="S4.T1.9.9.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.9.9.3.m1.1.1.2.cmml" type="float" xref="S4.T1.9.9.3.m1.1.1.2">0.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.3.m1.1c">\scriptstyle\pm 0.31</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.3.m1.1d">± 0.31</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.12.12.4">Vanilla KD <cite class="ltx_cite ltx_citemacro_cite">Hinton et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib8" title="">2015</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.10.10.1">37.00 <math alttext="\scriptstyle\pm 0.50" class="ltx_Math" display="inline" id="S4.T1.10.10.1.m1.1"><semantics id="S4.T1.10.10.1.m1.1a"><mrow id="S4.T1.10.10.1.m1.1.1" xref="S4.T1.10.10.1.m1.1.1.cmml"><mo id="S4.T1.10.10.1.m1.1.1a" mathsize="70%" xref="S4.T1.10.10.1.m1.1.1.cmml">±</mo><mn id="S4.T1.10.10.1.m1.1.1.2" mathsize="70%" xref="S4.T1.10.10.1.m1.1.1.2.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.1.m1.1b"><apply id="S4.T1.10.10.1.m1.1.1.cmml" xref="S4.T1.10.10.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.10.10.1.m1.1.1.1.cmml" xref="S4.T1.10.10.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.10.10.1.m1.1.1.2.cmml" type="float" xref="S4.T1.10.10.1.m1.1.1.2">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.1.m1.1c">\scriptstyle\pm 0.50</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.10.1.m1.1d">± 0.50</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.11.11.2">35.25 <math alttext="\scriptstyle\pm 1.96" class="ltx_Math" display="inline" id="S4.T1.11.11.2.m1.1"><semantics id="S4.T1.11.11.2.m1.1a"><mrow id="S4.T1.11.11.2.m1.1.1" xref="S4.T1.11.11.2.m1.1.1.cmml"><mo id="S4.T1.11.11.2.m1.1.1a" mathsize="70%" xref="S4.T1.11.11.2.m1.1.1.cmml">±</mo><mn id="S4.T1.11.11.2.m1.1.1.2" mathsize="70%" xref="S4.T1.11.11.2.m1.1.1.2.cmml">1.96</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.2.m1.1b"><apply id="S4.T1.11.11.2.m1.1.1.cmml" xref="S4.T1.11.11.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.11.11.2.m1.1.1.1.cmml" xref="S4.T1.11.11.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.11.11.2.m1.1.1.2.cmml" type="float" xref="S4.T1.11.11.2.m1.1.1.2">1.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.2.m1.1c">\scriptstyle\pm 1.96</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.11.2.m1.1d">± 1.96</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.12.12.3">24.47 <math alttext="\scriptstyle\pm 0.34" class="ltx_Math" display="inline" id="S4.T1.12.12.3.m1.1"><semantics id="S4.T1.12.12.3.m1.1a"><mrow id="S4.T1.12.12.3.m1.1.1" xref="S4.T1.12.12.3.m1.1.1.cmml"><mo id="S4.T1.12.12.3.m1.1.1a" mathsize="70%" xref="S4.T1.12.12.3.m1.1.1.cmml">±</mo><mn id="S4.T1.12.12.3.m1.1.1.2" mathsize="70%" xref="S4.T1.12.12.3.m1.1.1.2.cmml">0.34</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.3.m1.1b"><apply id="S4.T1.12.12.3.m1.1.1.cmml" xref="S4.T1.12.12.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.12.12.3.m1.1.1.1.cmml" xref="S4.T1.12.12.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.12.12.3.m1.1.1.2.cmml" type="float" xref="S4.T1.12.12.3.m1.1.1.2">0.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.3.m1.1c">\scriptstyle\pm 0.34</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.12.3.m1.1d">± 0.34</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.4">Sequence KD <cite class="ltx_cite ltx_citemacro_cite">Kim and Rush (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib12" title="">2016</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.13.13.1">36.61 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S4.T1.13.13.1.m1.1"><semantics id="S4.T1.13.13.1.m1.1a"><mrow id="S4.T1.13.13.1.m1.1.1" xref="S4.T1.13.13.1.m1.1.1.cmml"><mo id="S4.T1.13.13.1.m1.1.1a" mathsize="70%" xref="S4.T1.13.13.1.m1.1.1.cmml">±</mo><mn id="S4.T1.13.13.1.m1.1.1.2" mathsize="70%" xref="S4.T1.13.13.1.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.1.m1.1b"><apply id="S4.T1.13.13.1.m1.1.1.cmml" xref="S4.T1.13.13.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.13.13.1.m1.1.1.1.cmml" xref="S4.T1.13.13.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.13.13.1.m1.1.1.2.cmml" type="float" xref="S4.T1.13.13.1.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.1.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.13.1.m1.1d">± 0.51</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.14.14.2">33.41 <math alttext="\scriptstyle\pm 1.76" class="ltx_Math" display="inline" id="S4.T1.14.14.2.m1.1"><semantics id="S4.T1.14.14.2.m1.1a"><mrow id="S4.T1.14.14.2.m1.1.1" xref="S4.T1.14.14.2.m1.1.1.cmml"><mo id="S4.T1.14.14.2.m1.1.1a" mathsize="70%" xref="S4.T1.14.14.2.m1.1.1.cmml">±</mo><mn id="S4.T1.14.14.2.m1.1.1.2" mathsize="70%" xref="S4.T1.14.14.2.m1.1.1.2.cmml">1.76</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.2.m1.1b"><apply id="S4.T1.14.14.2.m1.1.1.cmml" xref="S4.T1.14.14.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.14.14.2.m1.1.1.1.cmml" xref="S4.T1.14.14.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.14.14.2.m1.1.1.2.cmml" type="float" xref="S4.T1.14.14.2.m1.1.1.2">1.76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.2.m1.1c">\scriptstyle\pm 1.76</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.14.2.m1.1d">± 1.76</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.3"><span class="ltx_text ltx_font_bold" id="S4.T1.15.15.3.1">24.67 <math alttext="\scriptstyle\pm 0.35" class="ltx_Math" display="inline" id="S4.T1.15.15.3.1.m1.1"><semantics id="S4.T1.15.15.3.1.m1.1a"><mrow id="S4.T1.15.15.3.1.m1.1.1" xref="S4.T1.15.15.3.1.m1.1.1.cmml"><mo id="S4.T1.15.15.3.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S4.T1.15.15.3.1.m1.1.1.cmml">±</mo><mn id="S4.T1.15.15.3.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S4.T1.15.15.3.1.m1.1.1.2.cmml">0.35</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.3.1.m1.1b"><apply id="S4.T1.15.15.3.1.m1.1.1.cmml" xref="S4.T1.15.15.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.15.15.3.1.m1.1.1.1.cmml" xref="S4.T1.15.15.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.15.15.3.1.m1.1.1.2.cmml" type="float" xref="S4.T1.15.15.3.1.m1.1.1.2">0.35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.3.1.m1.1c">\scriptstyle\pm 0.35</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.15.3.1.m1.1d">± 0.35</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.18.18.4">Selective KD <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib32" title="">2021</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.16.16.1">
<span class="ltx_ERROR undefined" id="S4.T1.16.16.1.1">\ul</span>37.30 <math alttext="\scriptstyle\pm 0.50" class="ltx_Math" display="inline" id="S4.T1.16.16.1.m1.1"><semantics id="S4.T1.16.16.1.m1.1a"><mrow id="S4.T1.16.16.1.m1.1.1" xref="S4.T1.16.16.1.m1.1.1.cmml"><mo id="S4.T1.16.16.1.m1.1.1a" mathsize="70%" xref="S4.T1.16.16.1.m1.1.1.cmml">±</mo><mn id="S4.T1.16.16.1.m1.1.1.2" mathsize="70%" xref="S4.T1.16.16.1.m1.1.1.2.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.16.16.1.m1.1b"><apply id="S4.T1.16.16.1.m1.1.1.cmml" xref="S4.T1.16.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.16.16.1.m1.1.1.1.cmml" xref="S4.T1.16.16.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.16.16.1.m1.1.1.2.cmml" type="float" xref="S4.T1.16.16.1.m1.1.1.2">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.16.1.m1.1c">\scriptstyle\pm 0.50</annotation><annotation encoding="application/x-llamapun" id="S4.T1.16.16.1.m1.1d">± 0.50</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.17.17.2">35.94 <math alttext="\scriptstyle\pm 1.95" class="ltx_Math" display="inline" id="S4.T1.17.17.2.m1.1"><semantics id="S4.T1.17.17.2.m1.1a"><mrow id="S4.T1.17.17.2.m1.1.1" xref="S4.T1.17.17.2.m1.1.1.cmml"><mo id="S4.T1.17.17.2.m1.1.1a" mathsize="70%" xref="S4.T1.17.17.2.m1.1.1.cmml">±</mo><mn id="S4.T1.17.17.2.m1.1.1.2" mathsize="70%" xref="S4.T1.17.17.2.m1.1.1.2.cmml">1.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.17.17.2.m1.1b"><apply id="S4.T1.17.17.2.m1.1.1.cmml" xref="S4.T1.17.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.17.17.2.m1.1.1.1.cmml" xref="S4.T1.17.17.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.17.17.2.m1.1.1.2.cmml" type="float" xref="S4.T1.17.17.2.m1.1.1.2">1.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.17.2.m1.1c">\scriptstyle\pm 1.95</annotation><annotation encoding="application/x-llamapun" id="S4.T1.17.17.2.m1.1d">± 1.95</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.18.18.3">22.66 <math alttext="\scriptstyle\pm 0.32" class="ltx_Math" display="inline" id="S4.T1.18.18.3.m1.1"><semantics id="S4.T1.18.18.3.m1.1a"><mrow id="S4.T1.18.18.3.m1.1.1" xref="S4.T1.18.18.3.m1.1.1.cmml"><mo id="S4.T1.18.18.3.m1.1.1a" mathsize="70%" xref="S4.T1.18.18.3.m1.1.1.cmml">±</mo><mn id="S4.T1.18.18.3.m1.1.1.2" mathsize="70%" xref="S4.T1.18.18.3.m1.1.1.2.cmml">0.32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.18.18.3.m1.1b"><apply id="S4.T1.18.18.3.m1.1.1.cmml" xref="S4.T1.18.18.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.18.18.3.m1.1.1.1.cmml" xref="S4.T1.18.18.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.18.18.3.m1.1.1.2.cmml" type="float" xref="S4.T1.18.18.3.m1.1.1.2">0.32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.18.3.m1.1c">\scriptstyle\pm 0.32</annotation><annotation encoding="application/x-llamapun" id="S4.T1.18.18.3.m1.1d">± 0.32</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.21.21.4">TinyBERT <cite class="ltx_cite ltx_citemacro_cite">Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.19.19.1">37.24 <math alttext="\scriptstyle\pm 0.52" class="ltx_Math" display="inline" id="S4.T1.19.19.1.m1.1"><semantics id="S4.T1.19.19.1.m1.1a"><mrow id="S4.T1.19.19.1.m1.1.1" xref="S4.T1.19.19.1.m1.1.1.cmml"><mo id="S4.T1.19.19.1.m1.1.1a" mathsize="70%" xref="S4.T1.19.19.1.m1.1.1.cmml">±</mo><mn id="S4.T1.19.19.1.m1.1.1.2" mathsize="70%" xref="S4.T1.19.19.1.m1.1.1.2.cmml">0.52</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.19.19.1.m1.1b"><apply id="S4.T1.19.19.1.m1.1.1.cmml" xref="S4.T1.19.19.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.19.19.1.m1.1.1.1.cmml" xref="S4.T1.19.19.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.19.19.1.m1.1.1.2.cmml" type="float" xref="S4.T1.19.19.1.m1.1.1.2">0.52</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.19.1.m1.1c">\scriptstyle\pm 0.52</annotation><annotation encoding="application/x-llamapun" id="S4.T1.19.19.1.m1.1d">± 0.52</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.20.20.2">38.01 <math alttext="\scriptstyle\pm 1.80" class="ltx_Math" display="inline" id="S4.T1.20.20.2.m1.1"><semantics id="S4.T1.20.20.2.m1.1a"><mrow id="S4.T1.20.20.2.m1.1.1" xref="S4.T1.20.20.2.m1.1.1.cmml"><mo id="S4.T1.20.20.2.m1.1.1a" mathsize="70%" xref="S4.T1.20.20.2.m1.1.1.cmml">±</mo><mn id="S4.T1.20.20.2.m1.1.1.2" mathsize="70%" xref="S4.T1.20.20.2.m1.1.1.2.cmml">1.80</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.20.20.2.m1.1b"><apply id="S4.T1.20.20.2.m1.1.1.cmml" xref="S4.T1.20.20.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.20.20.2.m1.1.1.1.cmml" xref="S4.T1.20.20.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.20.20.2.m1.1.1.2.cmml" type="float" xref="S4.T1.20.20.2.m1.1.1.2">1.80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.20.2.m1.1c">\scriptstyle\pm 1.80</annotation><annotation encoding="application/x-llamapun" id="S4.T1.20.20.2.m1.1d">± 1.80</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.21.21.3">24.31 <math alttext="\scriptstyle\pm 0.34" class="ltx_Math" display="inline" id="S4.T1.21.21.3.m1.1"><semantics id="S4.T1.21.21.3.m1.1a"><mrow id="S4.T1.21.21.3.m1.1.1" xref="S4.T1.21.21.3.m1.1.1.cmml"><mo id="S4.T1.21.21.3.m1.1.1a" mathsize="70%" xref="S4.T1.21.21.3.m1.1.1.cmml">±</mo><mn id="S4.T1.21.21.3.m1.1.1.2" mathsize="70%" xref="S4.T1.21.21.3.m1.1.1.2.cmml">0.34</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.21.21.3.m1.1b"><apply id="S4.T1.21.21.3.m1.1.1.cmml" xref="S4.T1.21.21.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.21.21.3.m1.1.1.1.cmml" xref="S4.T1.21.21.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.21.21.3.m1.1.1.2.cmml" type="float" xref="S4.T1.21.21.3.m1.1.1.2">0.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.21.21.3.m1.1c">\scriptstyle\pm 0.34</annotation><annotation encoding="application/x-llamapun" id="S4.T1.21.21.3.m1.1d">± 0.34</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.24.24.4">MiniLM <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib33" title="">2020</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.22.22.1">36.93 <math alttext="\scriptstyle\pm 0.50" class="ltx_Math" display="inline" id="S4.T1.22.22.1.m1.1"><semantics id="S4.T1.22.22.1.m1.1a"><mrow id="S4.T1.22.22.1.m1.1.1" xref="S4.T1.22.22.1.m1.1.1.cmml"><mo id="S4.T1.22.22.1.m1.1.1a" mathsize="70%" xref="S4.T1.22.22.1.m1.1.1.cmml">±</mo><mn id="S4.T1.22.22.1.m1.1.1.2" mathsize="70%" xref="S4.T1.22.22.1.m1.1.1.2.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.22.22.1.m1.1b"><apply id="S4.T1.22.22.1.m1.1.1.cmml" xref="S4.T1.22.22.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.22.22.1.m1.1.1.1.cmml" xref="S4.T1.22.22.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.22.22.1.m1.1.1.2.cmml" type="float" xref="S4.T1.22.22.1.m1.1.1.2">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.22.22.1.m1.1c">\scriptstyle\pm 0.50</annotation><annotation encoding="application/x-llamapun" id="S4.T1.22.22.1.m1.1d">± 0.50</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.23.23.2">36.43 <math alttext="\scriptstyle\pm 1.97" class="ltx_Math" display="inline" id="S4.T1.23.23.2.m1.1"><semantics id="S4.T1.23.23.2.m1.1a"><mrow id="S4.T1.23.23.2.m1.1.1" xref="S4.T1.23.23.2.m1.1.1.cmml"><mo id="S4.T1.23.23.2.m1.1.1a" mathsize="70%" xref="S4.T1.23.23.2.m1.1.1.cmml">±</mo><mn id="S4.T1.23.23.2.m1.1.1.2" mathsize="70%" xref="S4.T1.23.23.2.m1.1.1.2.cmml">1.97</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.23.23.2.m1.1b"><apply id="S4.T1.23.23.2.m1.1.1.cmml" xref="S4.T1.23.23.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.23.23.2.m1.1.1.1.cmml" xref="S4.T1.23.23.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.23.23.2.m1.1.1.2.cmml" type="float" xref="S4.T1.23.23.2.m1.1.1.2">1.97</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.23.23.2.m1.1c">\scriptstyle\pm 1.97</annotation><annotation encoding="application/x-llamapun" id="S4.T1.23.23.2.m1.1d">± 1.97</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.24.24.3">24.32 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S4.T1.24.24.3.m1.1"><semantics id="S4.T1.24.24.3.m1.1a"><mrow id="S4.T1.24.24.3.m1.1.1" xref="S4.T1.24.24.3.m1.1.1.cmml"><mo id="S4.T1.24.24.3.m1.1.1a" mathsize="70%" xref="S4.T1.24.24.3.m1.1.1.cmml">±</mo><mn id="S4.T1.24.24.3.m1.1.1.2" mathsize="70%" xref="S4.T1.24.24.3.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.24.24.3.m1.1b"><apply id="S4.T1.24.24.3.m1.1.1.cmml" xref="S4.T1.24.24.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.24.24.3.m1.1.1.1.cmml" xref="S4.T1.24.24.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.24.24.3.m1.1.1.2.cmml" type="float" xref="S4.T1.24.24.3.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.24.24.3.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S4.T1.24.24.3.m1.1d">± 0.33</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.27.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.27.27.4">ALP-KD <cite class="ltx_cite ltx_citemacro_cite">Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.25.25.1">37.13 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S4.T1.25.25.1.m1.1"><semantics id="S4.T1.25.25.1.m1.1a"><mrow id="S4.T1.25.25.1.m1.1.1" xref="S4.T1.25.25.1.m1.1.1.cmml"><mo id="S4.T1.25.25.1.m1.1.1a" mathsize="70%" xref="S4.T1.25.25.1.m1.1.1.cmml">±</mo><mn id="S4.T1.25.25.1.m1.1.1.2" mathsize="70%" xref="S4.T1.25.25.1.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.25.25.1.m1.1b"><apply id="S4.T1.25.25.1.m1.1.1.cmml" xref="S4.T1.25.25.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.25.25.1.m1.1.1.1.cmml" xref="S4.T1.25.25.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.25.25.1.m1.1.1.2.cmml" type="float" xref="S4.T1.25.25.1.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.25.25.1.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S4.T1.25.25.1.m1.1d">± 0.51</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.26.26.2">37.07 <math alttext="\scriptstyle\pm 2.05" class="ltx_Math" display="inline" id="S4.T1.26.26.2.m1.1"><semantics id="S4.T1.26.26.2.m1.1a"><mrow id="S4.T1.26.26.2.m1.1.1" xref="S4.T1.26.26.2.m1.1.1.cmml"><mo id="S4.T1.26.26.2.m1.1.1a" mathsize="70%" xref="S4.T1.26.26.2.m1.1.1.cmml">±</mo><mn id="S4.T1.26.26.2.m1.1.1.2" mathsize="70%" xref="S4.T1.26.26.2.m1.1.1.2.cmml">2.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.26.26.2.m1.1b"><apply id="S4.T1.26.26.2.m1.1.1.cmml" xref="S4.T1.26.26.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.26.26.2.m1.1.1.1.cmml" xref="S4.T1.26.26.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.26.26.2.m1.1.1.2.cmml" type="float" xref="S4.T1.26.26.2.m1.1.1.2">2.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.26.26.2.m1.1c">\scriptstyle\pm 2.05</annotation><annotation encoding="application/x-llamapun" id="S4.T1.26.26.2.m1.1d">± 2.05</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.27.27.3">24.36 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S4.T1.27.27.3.m1.1"><semantics id="S4.T1.27.27.3.m1.1a"><mrow id="S4.T1.27.27.3.m1.1.1" xref="S4.T1.27.27.3.m1.1.1.cmml"><mo id="S4.T1.27.27.3.m1.1.1a" mathsize="70%" xref="S4.T1.27.27.3.m1.1.1.cmml">±</mo><mn id="S4.T1.27.27.3.m1.1.1.2" mathsize="70%" xref="S4.T1.27.27.3.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.27.27.3.m1.1b"><apply id="S4.T1.27.27.3.m1.1.1.cmml" xref="S4.T1.27.27.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.27.27.3.m1.1.1.1.cmml" xref="S4.T1.27.27.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.27.27.3.m1.1.1.2.cmml" type="float" xref="S4.T1.27.27.3.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.27.27.3.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S4.T1.27.27.3.m1.1d">± 0.33</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.30.30">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.30.30.4"><span class="ltx_text ltx_font_bold" id="S4.T1.30.30.4.1">A2D (4 heads)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.28.28.1">37.17 <math alttext="\scriptstyle\pm 0.49" class="ltx_Math" display="inline" id="S4.T1.28.28.1.m1.1"><semantics id="S4.T1.28.28.1.m1.1a"><mrow id="S4.T1.28.28.1.m1.1.1" xref="S4.T1.28.28.1.m1.1.1.cmml"><mo id="S4.T1.28.28.1.m1.1.1a" mathsize="70%" xref="S4.T1.28.28.1.m1.1.1.cmml">±</mo><mn id="S4.T1.28.28.1.m1.1.1.2" mathsize="70%" xref="S4.T1.28.28.1.m1.1.1.2.cmml">0.49</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.28.28.1.m1.1b"><apply id="S4.T1.28.28.1.m1.1.1.cmml" xref="S4.T1.28.28.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.28.28.1.m1.1.1.1.cmml" xref="S4.T1.28.28.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.28.28.1.m1.1.1.2.cmml" type="float" xref="S4.T1.28.28.1.m1.1.1.2">0.49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.28.28.1.m1.1c">\scriptstyle\pm 0.49</annotation><annotation encoding="application/x-llamapun" id="S4.T1.28.28.1.m1.1d">± 0.49</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.29.29.2">
<span class="ltx_ERROR undefined" id="S4.T1.29.29.2.1">\ul</span>38.61 <math alttext="\scriptstyle\pm 1.96" class="ltx_Math" display="inline" id="S4.T1.29.29.2.m1.1"><semantics id="S4.T1.29.29.2.m1.1a"><mrow id="S4.T1.29.29.2.m1.1.1" xref="S4.T1.29.29.2.m1.1.1.cmml"><mo id="S4.T1.29.29.2.m1.1.1a" mathsize="70%" xref="S4.T1.29.29.2.m1.1.1.cmml">±</mo><mn id="S4.T1.29.29.2.m1.1.1.2" mathsize="70%" xref="S4.T1.29.29.2.m1.1.1.2.cmml">1.96</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.29.29.2.m1.1b"><apply id="S4.T1.29.29.2.m1.1.1.cmml" xref="S4.T1.29.29.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.29.29.2.m1.1.1.1.cmml" xref="S4.T1.29.29.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.29.29.2.m1.1.1.2.cmml" type="float" xref="S4.T1.29.29.2.m1.1.1.2">1.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.29.29.2.m1.1c">\scriptstyle\pm 1.96</annotation><annotation encoding="application/x-llamapun" id="S4.T1.29.29.2.m1.1d">± 1.96</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.30.30.3">
<span class="ltx_ERROR undefined" id="S4.T1.30.30.3.1">\ul</span>24.61 <math alttext="\scriptstyle\pm 0.32" class="ltx_Math" display="inline" id="S4.T1.30.30.3.m1.1"><semantics id="S4.T1.30.30.3.m1.1a"><mrow id="S4.T1.30.30.3.m1.1.1" xref="S4.T1.30.30.3.m1.1.1.cmml"><mo id="S4.T1.30.30.3.m1.1.1a" mathsize="70%" xref="S4.T1.30.30.3.m1.1.1.cmml">±</mo><mn id="S4.T1.30.30.3.m1.1.1.2" mathsize="70%" xref="S4.T1.30.30.3.m1.1.1.2.cmml">0.32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.30.30.3.m1.1b"><apply id="S4.T1.30.30.3.m1.1.1.cmml" xref="S4.T1.30.30.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.30.30.3.m1.1.1.1.cmml" xref="S4.T1.30.30.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.30.30.3.m1.1.1.2.cmml" type="float" xref="S4.T1.30.30.3.m1.1.1.2">0.32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.30.30.3.m1.1c">\scriptstyle\pm 0.32</annotation><annotation encoding="application/x-llamapun" id="S4.T1.30.30.3.m1.1d">± 0.32</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.33.33">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.33.33.4"><span class="ltx_text ltx_font_bold" id="S4.T1.33.33.4.1">A2D (8 heads)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.31.31.1"><span class="ltx_text ltx_font_bold" id="S4.T1.31.31.1.1">37.75 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S4.T1.31.31.1.1.m1.1"><semantics id="S4.T1.31.31.1.1.m1.1a"><mrow id="S4.T1.31.31.1.1.m1.1.1" xref="S4.T1.31.31.1.1.m1.1.1.cmml"><mo id="S4.T1.31.31.1.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S4.T1.31.31.1.1.m1.1.1.cmml">±</mo><mn id="S4.T1.31.31.1.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S4.T1.31.31.1.1.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.31.31.1.1.m1.1b"><apply id="S4.T1.31.31.1.1.m1.1.1.cmml" xref="S4.T1.31.31.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.31.31.1.1.m1.1.1.1.cmml" xref="S4.T1.31.31.1.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.31.31.1.1.m1.1.1.2.cmml" type="float" xref="S4.T1.31.31.1.1.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.31.31.1.1.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S4.T1.31.31.1.1.m1.1d">± 0.51</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.32.32.2"><span class="ltx_text ltx_font_bold" id="S4.T1.32.32.2.1">39.49 <math alttext="\scriptstyle\pm 2.06" class="ltx_Math" display="inline" id="S4.T1.32.32.2.1.m1.1"><semantics id="S4.T1.32.32.2.1.m1.1a"><mrow id="S4.T1.32.32.2.1.m1.1.1" xref="S4.T1.32.32.2.1.m1.1.1.cmml"><mo id="S4.T1.32.32.2.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S4.T1.32.32.2.1.m1.1.1.cmml">±</mo><mn id="S4.T1.32.32.2.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S4.T1.32.32.2.1.m1.1.1.2.cmml">2.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.32.32.2.1.m1.1b"><apply id="S4.T1.32.32.2.1.m1.1.1.cmml" xref="S4.T1.32.32.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.32.32.2.1.m1.1.1.1.cmml" xref="S4.T1.32.32.2.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.32.32.2.1.m1.1.1.2.cmml" type="float" xref="S4.T1.32.32.2.1.m1.1.1.2">2.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.32.32.2.1.m1.1c">\scriptstyle\pm 2.06</annotation><annotation encoding="application/x-llamapun" id="S4.T1.32.32.2.1.m1.1d">± 2.06</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.33.33.3">24.32 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S4.T1.33.33.3.m1.1"><semantics id="S4.T1.33.33.3.m1.1a"><mrow id="S4.T1.33.33.3.m1.1.1" xref="S4.T1.33.33.3.m1.1.1.cmml"><mo id="S4.T1.33.33.3.m1.1.1a" mathsize="70%" xref="S4.T1.33.33.3.m1.1.1.cmml">±</mo><mn id="S4.T1.33.33.3.m1.1.1.2" mathsize="70%" xref="S4.T1.33.33.3.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.33.33.3.m1.1b"><apply id="S4.T1.33.33.3.m1.1.1.cmml" xref="S4.T1.33.33.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.33.33.3.m1.1.1.1.cmml" xref="S4.T1.33.33.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.33.33.3.m1.1.1.2.cmml" type="float" xref="S4.T1.33.33.3.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.33.33.3.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S4.T1.33.33.3.m1.1d">± 0.33</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.45.47.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="4" id="S4.T1.45.47.2.1" style="padding-bottom:2.15277pt;">Student (2-layer)</th>
</tr>
<tr class="ltx_tr" id="S4.T1.36.36">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.36.36.4">No KD</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.34.34.1">35.56 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S4.T1.34.34.1.m1.1"><semantics id="S4.T1.34.34.1.m1.1a"><mrow id="S4.T1.34.34.1.m1.1.1" xref="S4.T1.34.34.1.m1.1.1.cmml"><mo id="S4.T1.34.34.1.m1.1.1a" mathsize="70%" xref="S4.T1.34.34.1.m1.1.1.cmml">±</mo><mn id="S4.T1.34.34.1.m1.1.1.2" mathsize="70%" xref="S4.T1.34.34.1.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.34.34.1.m1.1b"><apply id="S4.T1.34.34.1.m1.1.1.cmml" xref="S4.T1.34.34.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.34.34.1.m1.1.1.1.cmml" xref="S4.T1.34.34.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.34.34.1.m1.1.1.2.cmml" type="float" xref="S4.T1.34.34.1.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.34.34.1.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S4.T1.34.34.1.m1.1d">± 0.51</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.35.35.2">
<span class="ltx_ERROR undefined" id="S4.T1.35.35.2.1">\ul</span>35.89 <math alttext="\scriptstyle\pm 1.88" class="ltx_Math" display="inline" id="S4.T1.35.35.2.m1.1"><semantics id="S4.T1.35.35.2.m1.1a"><mrow id="S4.T1.35.35.2.m1.1.1" xref="S4.T1.35.35.2.m1.1.1.cmml"><mo id="S4.T1.35.35.2.m1.1.1a" mathsize="70%" xref="S4.T1.35.35.2.m1.1.1.cmml">±</mo><mn id="S4.T1.35.35.2.m1.1.1.2" mathsize="70%" xref="S4.T1.35.35.2.m1.1.1.2.cmml">1.88</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.35.35.2.m1.1b"><apply id="S4.T1.35.35.2.m1.1.1.cmml" xref="S4.T1.35.35.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.35.35.2.m1.1.1.1.cmml" xref="S4.T1.35.35.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.35.35.2.m1.1.1.2.cmml" type="float" xref="S4.T1.35.35.2.m1.1.1.2">1.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.35.35.2.m1.1c">\scriptstyle\pm 1.88</annotation><annotation encoding="application/x-llamapun" id="S4.T1.35.35.2.m1.1d">± 1.88</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.36.36.3"><span class="ltx_text ltx_font_bold" id="S4.T1.36.36.3.1">23.69 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S4.T1.36.36.3.1.m1.1"><semantics id="S4.T1.36.36.3.1.m1.1a"><mrow id="S4.T1.36.36.3.1.m1.1.1" xref="S4.T1.36.36.3.1.m1.1.1.cmml"><mo id="S4.T1.36.36.3.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S4.T1.36.36.3.1.m1.1.1.cmml">±</mo><mn id="S4.T1.36.36.3.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S4.T1.36.36.3.1.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.36.36.3.1.m1.1b"><apply id="S4.T1.36.36.3.1.m1.1.1.cmml" xref="S4.T1.36.36.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.36.36.3.1.m1.1.1.1.cmml" xref="S4.T1.36.36.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.36.36.3.1.m1.1.1.2.cmml" type="float" xref="S4.T1.36.36.3.1.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.36.36.3.1.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S4.T1.36.36.3.1.m1.1d">± 0.33</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.39.39">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.39.39.4">CKD-sc <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.37.37.1">
<span class="ltx_ERROR undefined" id="S4.T1.37.37.1.1">\ul</span>35.73 <math alttext="\scriptstyle\pm 0.49" class="ltx_Math" display="inline" id="S4.T1.37.37.1.m1.1"><semantics id="S4.T1.37.37.1.m1.1a"><mrow id="S4.T1.37.37.1.m1.1.1" xref="S4.T1.37.37.1.m1.1.1.cmml"><mo id="S4.T1.37.37.1.m1.1.1a" mathsize="70%" xref="S4.T1.37.37.1.m1.1.1.cmml">±</mo><mn id="S4.T1.37.37.1.m1.1.1.2" mathsize="70%" xref="S4.T1.37.37.1.m1.1.1.2.cmml">0.49</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.37.37.1.m1.1b"><apply id="S4.T1.37.37.1.m1.1.1.cmml" xref="S4.T1.37.37.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.37.37.1.m1.1.1.1.cmml" xref="S4.T1.37.37.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.37.37.1.m1.1.1.2.cmml" type="float" xref="S4.T1.37.37.1.m1.1.1.2">0.49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.37.37.1.m1.1c">\scriptstyle\pm 0.49</annotation><annotation encoding="application/x-llamapun" id="S4.T1.37.37.1.m1.1d">± 0.49</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.38.38.2">32.90 <math alttext="\scriptstyle\pm 1.85" class="ltx_Math" display="inline" id="S4.T1.38.38.2.m1.1"><semantics id="S4.T1.38.38.2.m1.1a"><mrow id="S4.T1.38.38.2.m1.1.1" xref="S4.T1.38.38.2.m1.1.1.cmml"><mo id="S4.T1.38.38.2.m1.1.1a" mathsize="70%" xref="S4.T1.38.38.2.m1.1.1.cmml">±</mo><mn id="S4.T1.38.38.2.m1.1.1.2" mathsize="70%" xref="S4.T1.38.38.2.m1.1.1.2.cmml">1.85</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.38.38.2.m1.1b"><apply id="S4.T1.38.38.2.m1.1.1.cmml" xref="S4.T1.38.38.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.38.38.2.m1.1.1.1.cmml" xref="S4.T1.38.38.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.38.38.2.m1.1.1.2.cmml" type="float" xref="S4.T1.38.38.2.m1.1.1.2">1.85</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.38.38.2.m1.1c">\scriptstyle\pm 1.85</annotation><annotation encoding="application/x-llamapun" id="S4.T1.38.38.2.m1.1d">± 1.85</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.39.39.3">22.55 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S4.T1.39.39.3.m1.1"><semantics id="S4.T1.39.39.3.m1.1a"><mrow id="S4.T1.39.39.3.m1.1.1" xref="S4.T1.39.39.3.m1.1.1.cmml"><mo id="S4.T1.39.39.3.m1.1.1a" mathsize="70%" xref="S4.T1.39.39.3.m1.1.1.cmml">±</mo><mn id="S4.T1.39.39.3.m1.1.1.2" mathsize="70%" xref="S4.T1.39.39.3.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.39.39.3.m1.1b"><apply id="S4.T1.39.39.3.m1.1.1.cmml" xref="S4.T1.39.39.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.39.39.3.m1.1.1.1.cmml" xref="S4.T1.39.39.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.39.39.3.m1.1.1.2.cmml" type="float" xref="S4.T1.39.39.3.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.39.39.3.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S4.T1.39.39.3.m1.1d">± 0.33</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.42.42">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.42.42.4">CKD-cc <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.40.40.1">35.46 <math alttext="\scriptstyle\pm 0.48" class="ltx_Math" display="inline" id="S4.T1.40.40.1.m1.1"><semantics id="S4.T1.40.40.1.m1.1a"><mrow id="S4.T1.40.40.1.m1.1.1" xref="S4.T1.40.40.1.m1.1.1.cmml"><mo id="S4.T1.40.40.1.m1.1.1a" mathsize="70%" xref="S4.T1.40.40.1.m1.1.1.cmml">±</mo><mn id="S4.T1.40.40.1.m1.1.1.2" mathsize="70%" xref="S4.T1.40.40.1.m1.1.1.2.cmml">0.48</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.40.40.1.m1.1b"><apply id="S4.T1.40.40.1.m1.1.1.cmml" xref="S4.T1.40.40.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.40.40.1.m1.1.1.1.cmml" xref="S4.T1.40.40.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.40.40.1.m1.1.1.2.cmml" type="float" xref="S4.T1.40.40.1.m1.1.1.2">0.48</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.40.40.1.m1.1c">\scriptstyle\pm 0.48</annotation><annotation encoding="application/x-llamapun" id="S4.T1.40.40.1.m1.1d">± 0.48</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.41.41.2">31.28 <math alttext="\scriptstyle\pm 1.74" class="ltx_Math" display="inline" id="S4.T1.41.41.2.m1.1"><semantics id="S4.T1.41.41.2.m1.1a"><mrow id="S4.T1.41.41.2.m1.1.1" xref="S4.T1.41.41.2.m1.1.1.cmml"><mo id="S4.T1.41.41.2.m1.1.1a" mathsize="70%" xref="S4.T1.41.41.2.m1.1.1.cmml">±</mo><mn id="S4.T1.41.41.2.m1.1.1.2" mathsize="70%" xref="S4.T1.41.41.2.m1.1.1.2.cmml">1.74</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.41.41.2.m1.1b"><apply id="S4.T1.41.41.2.m1.1.1.cmml" xref="S4.T1.41.41.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.41.41.2.m1.1.1.1.cmml" xref="S4.T1.41.41.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.41.41.2.m1.1.1.2.cmml" type="float" xref="S4.T1.41.41.2.m1.1.1.2">1.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.41.41.2.m1.1c">\scriptstyle\pm 1.74</annotation><annotation encoding="application/x-llamapun" id="S4.T1.41.41.2.m1.1d">± 1.74</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.42.42.3">22.86 <math alttext="\scriptstyle\pm 0.31" class="ltx_Math" display="inline" id="S4.T1.42.42.3.m1.1"><semantics id="S4.T1.42.42.3.m1.1a"><mrow id="S4.T1.42.42.3.m1.1.1" xref="S4.T1.42.42.3.m1.1.1.cmml"><mo id="S4.T1.42.42.3.m1.1.1a" mathsize="70%" xref="S4.T1.42.42.3.m1.1.1.cmml">±</mo><mn id="S4.T1.42.42.3.m1.1.1.2" mathsize="70%" xref="S4.T1.42.42.3.m1.1.1.2.cmml">0.31</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.42.42.3.m1.1b"><apply id="S4.T1.42.42.3.m1.1.1.cmml" xref="S4.T1.42.42.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.42.42.3.m1.1.1.1.cmml" xref="S4.T1.42.42.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.42.42.3.m1.1.1.2.cmml" type="float" xref="S4.T1.42.42.3.m1.1.1.2">0.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.42.42.3.m1.1c">\scriptstyle\pm 0.31</annotation><annotation encoding="application/x-llamapun" id="S4.T1.42.42.3.m1.1d">± 0.31</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.45.45">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S4.T1.45.45.4"><span class="ltx_text ltx_font_bold" id="S4.T1.45.45.4.1">A2D (4 heads)</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.43.43.1"><span class="ltx_text ltx_font_bold" id="S4.T1.43.43.1.1">36.68 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S4.T1.43.43.1.1.m1.1"><semantics id="S4.T1.43.43.1.1.m1.1a"><mrow id="S4.T1.43.43.1.1.m1.1.1" xref="S4.T1.43.43.1.1.m1.1.1.cmml"><mo id="S4.T1.43.43.1.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S4.T1.43.43.1.1.m1.1.1.cmml">±</mo><mn id="S4.T1.43.43.1.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S4.T1.43.43.1.1.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.43.43.1.1.m1.1b"><apply id="S4.T1.43.43.1.1.m1.1.1.cmml" xref="S4.T1.43.43.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.43.43.1.1.m1.1.1.1.cmml" xref="S4.T1.43.43.1.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.43.43.1.1.m1.1.1.2.cmml" type="float" xref="S4.T1.43.43.1.1.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.43.43.1.1.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S4.T1.43.43.1.1.m1.1d">± 0.51</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.44.44.2"><span class="ltx_text ltx_font_bold" id="S4.T1.44.44.2.1">37.06 <math alttext="\scriptstyle\pm 1.94" class="ltx_Math" display="inline" id="S4.T1.44.44.2.1.m1.1"><semantics id="S4.T1.44.44.2.1.m1.1a"><mrow id="S4.T1.44.44.2.1.m1.1.1" xref="S4.T1.44.44.2.1.m1.1.1.cmml"><mo id="S4.T1.44.44.2.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S4.T1.44.44.2.1.m1.1.1.cmml">±</mo><mn id="S4.T1.44.44.2.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S4.T1.44.44.2.1.m1.1.1.2.cmml">1.94</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.44.44.2.1.m1.1b"><apply id="S4.T1.44.44.2.1.m1.1.1.cmml" xref="S4.T1.44.44.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.44.44.2.1.m1.1.1.1.cmml" xref="S4.T1.44.44.2.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.44.44.2.1.m1.1.1.2.cmml" type="float" xref="S4.T1.44.44.2.1.m1.1.1.2">1.94</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.44.44.2.1.m1.1c">\scriptstyle\pm 1.94</annotation><annotation encoding="application/x-llamapun" id="S4.T1.44.44.2.1.m1.1d">± 1.94</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.45.45.3">
<span class="ltx_ERROR undefined" id="S4.T1.45.45.3.1">\ul</span>23.64 <math alttext="\scriptstyle\pm 0.34" class="ltx_Math" display="inline" id="S4.T1.45.45.3.m1.1"><semantics id="S4.T1.45.45.3.m1.1a"><mrow id="S4.T1.45.45.3.m1.1.1" xref="S4.T1.45.45.3.m1.1.1.cmml"><mo id="S4.T1.45.45.3.m1.1.1a" mathsize="70%" xref="S4.T1.45.45.3.m1.1.1.cmml">±</mo><mn id="S4.T1.45.45.3.m1.1.1.2" mathsize="70%" xref="S4.T1.45.45.3.m1.1.1.2.cmml">0.34</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.45.45.3.m1.1b"><apply id="S4.T1.45.45.3.m1.1.1.cmml" xref="S4.T1.45.45.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.45.45.3.m1.1.1.1.cmml" xref="S4.T1.45.45.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.45.45.3.m1.1.1.2.cmml" type="float" xref="S4.T1.45.45.3.m1.1.1.2">0.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.45.45.3.m1.1c">\scriptstyle\pm 0.34</annotation><annotation encoding="application/x-llamapun" id="S4.T1.45.45.3.m1.1d">± 0.34</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>BLEU scores of various KD approaches across language pairs. ‘No KD’ denotes student models trained exclusively with the cross-entropy loss. Each baseline model incorporates 4 attention heads per layer. For a direct comparison with CKD, we train our students with A2D across 2 layers. The highest scores among student models are highlighted in bold, while the second highest are underlined.
</figcaption>
</figure>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.1.1.2">Teacher</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.3">No KD</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.4">PKD</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.5">CKD-rc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.6">CKD-oc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.7"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.7.1">A2D</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.1">A2D (w/o <math alttext="\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><msub id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S4.T2.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.3.cmml">KD</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.2">ℒ</ci><ci id="S4.T2.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.m1.1.1.3">KD</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math>)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.5.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.2.2.1">27.70 <math alttext="\scriptstyle\pm 0.65" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml"><mo id="S4.T2.2.2.1.m1.1.1a" mathsize="70%" xref="S4.T2.2.2.1.m1.1.1.cmml">±</mo><mn id="S4.T2.2.2.1.m1.1.1.2" mathsize="70%" xref="S4.T2.2.2.1.m1.1.1.2.cmml">0.65</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><apply id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T2.2.2.1.m1.1.1.2.cmml" type="float" xref="S4.T2.2.2.1.m1.1.1.2">0.65</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\scriptstyle\pm 0.65</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">± 0.65</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.3.3.2">25.74 <math alttext="\scriptstyle\pm 0.61" class="ltx_Math" display="inline" id="S4.T2.3.3.2.m1.1"><semantics id="S4.T2.3.3.2.m1.1a"><mrow id="S4.T2.3.3.2.m1.1.1" xref="S4.T2.3.3.2.m1.1.1.cmml"><mo id="S4.T2.3.3.2.m1.1.1a" mathsize="70%" xref="S4.T2.3.3.2.m1.1.1.cmml">±</mo><mn id="S4.T2.3.3.2.m1.1.1.2" mathsize="70%" xref="S4.T2.3.3.2.m1.1.1.2.cmml">0.61</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.2.m1.1b"><apply id="S4.T2.3.3.2.m1.1.1.cmml" xref="S4.T2.3.3.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.3.3.2.m1.1.1.1.cmml" xref="S4.T2.3.3.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T2.3.3.2.m1.1.1.2.cmml" type="float" xref="S4.T2.3.3.2.m1.1.1.2">0.61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.2.m1.1c">\scriptstyle\pm 0.61</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.2.m1.1d">± 0.61</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.5.5.5">
<span class="ltx_ERROR undefined" id="S4.T2.5.5.5.1">\ul</span>23.38</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.5.5.6">
<span class="ltx_ERROR undefined" id="S4.T2.5.5.6.1">\ul</span>24.14</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.5.5.7">
<span class="ltx_ERROR undefined" id="S4.T2.5.5.7.1">\ul</span>23.97</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.4.3">
<span class="ltx_text ltx_font_bold" id="S4.T2.4.4.3.1">26.37</span> <math alttext="\scriptstyle\pm 0.64" class="ltx_Math" display="inline" id="S4.T2.4.4.3.m1.1"><semantics id="S4.T2.4.4.3.m1.1a"><mrow id="S4.T2.4.4.3.m1.1.1" xref="S4.T2.4.4.3.m1.1.1.cmml"><mo id="S4.T2.4.4.3.m1.1.1a" mathsize="70%" xref="S4.T2.4.4.3.m1.1.1.cmml">±</mo><mn id="S4.T2.4.4.3.m1.1.1.2" mathsize="70%" xref="S4.T2.4.4.3.m1.1.1.2.cmml">0.64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.3.m1.1b"><apply id="S4.T2.4.4.3.m1.1.1.cmml" xref="S4.T2.4.4.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.4.4.3.m1.1.1.1.cmml" xref="S4.T2.4.4.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T2.4.4.3.m1.1.1.2.cmml" type="float" xref="S4.T2.4.4.3.m1.1.1.2">0.64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.3.m1.1c">\scriptstyle\pm 0.64</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.3.m1.1d">± 0.64</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.5.5.4">25.97 <math alttext="\scriptstyle\pm 0.61" class="ltx_Math" display="inline" id="S4.T2.5.5.4.m1.1"><semantics id="S4.T2.5.5.4.m1.1a"><mrow id="S4.T2.5.5.4.m1.1.1" xref="S4.T2.5.5.4.m1.1.1.cmml"><mo id="S4.T2.5.5.4.m1.1.1a" mathsize="70%" xref="S4.T2.5.5.4.m1.1.1.cmml">±</mo><mn id="S4.T2.5.5.4.m1.1.1.2" mathsize="70%" xref="S4.T2.5.5.4.m1.1.1.2.cmml">0.61</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.4.m1.1b"><apply id="S4.T2.5.5.4.m1.1.1.cmml" xref="S4.T2.5.5.4.m1.1.1"><csymbol cd="latexml" id="S4.T2.5.5.4.m1.1.1.1.cmml" xref="S4.T2.5.5.4.m1.1.1">plus-or-minus</csymbol><cn id="S4.T2.5.5.4.m1.1.1.2.cmml" type="float" xref="S4.T2.5.5.4.m1.1.1.2">0.61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.4.m1.1c">\scriptstyle\pm 0.61</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.4.m1.1d">± 0.61</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>BLEU scores for WMT-2014 En <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S4.T2.8.m1.1"><semantics id="S4.T2.8.m1.1b"><mover accent="true" id="S4.T2.8.m1.1.1" xref="S4.T2.8.m1.1.1.cmml"><mo id="S4.T2.8.m1.1.1.2" stretchy="false" xref="S4.T2.8.m1.1.1.2.cmml">→</mo><mi id="S4.T2.8.m1.1.1.1" xref="S4.T2.8.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S4.T2.8.m1.1c"><apply id="S4.T2.8.m1.1.1.cmml" xref="S4.T2.8.m1.1.1"><csymbol cd="latexml" id="S4.T2.8.m1.1.1.1.cmml" xref="S4.T2.8.m1.1.1.1">absent</csymbol><ci id="S4.T2.8.m1.1.1.2.cmml" xref="S4.T2.8.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.m1.1d">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.m1.1e">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> De. ‘PKD’ and ‘CKD’ refer to Patient KD <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib25" title="">2019</a>)</cite> and Combinatorial KD <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite>, respectively. Underlined results are imported from CKD <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite>. Our reproduced teacher and No KD student model, used for A2D training on En <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S4.T2.9.m2.1"><semantics id="S4.T2.9.m2.1b"><mover accent="true" id="S4.T2.9.m2.1.1" xref="S4.T2.9.m2.1.1.cmml"><mo id="S4.T2.9.m2.1.1.2" stretchy="false" xref="S4.T2.9.m2.1.1.2.cmml">→</mo><mi id="S4.T2.9.m2.1.1.1" xref="S4.T2.9.m2.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S4.T2.9.m2.1c"><apply id="S4.T2.9.m2.1.1.cmml" xref="S4.T2.9.m2.1.1"><csymbol cd="latexml" id="S4.T2.9.m2.1.1.1.cmml" xref="S4.T2.9.m2.1.1.1">absent</csymbol><ci id="S4.T2.9.m2.1.1.2.cmml" xref="S4.T2.9.m2.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.m2.1d">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.m2.1e">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> De, yielded slightly better BLEU scores than those reported in the CKD paper, which are 27.03 and 24.31 respectively. Nevertheless, the trend of their model underperforming compared to No KD remains consistent.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Comparison with Previous Methods</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Previous works have also utilized attention distributions as knowledge features <cite class="ltx_cite ltx_citemacro_cite">Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib33" title="">2020</a>)</cite>. However, their approaches treat attention heads within the same layer as a singular unit for distillation.
Considering that the attention map from each head captures distinct information across the layer <cite class="ltx_cite ltx_citemacro_cite">Voita et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib30" title="">2019</a>); Gong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib5" title="">2021</a>)</cite>, establishing a rigid mapping between student and teacher layers imposes a potential loss of knowledge from the teacher.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">In contrast, A2D facilitates a flexible alignment between each individual attention head of the teacher and student models, eliminating the need for pre-defined mapping combinations <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite> or bucket divisions <cite class="ltx_cite ltx_citemacro_cite">Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite>.
Additionally, A2D is not bound by architectural constraints, such as matching the number of heads or layers, or embedding dimensions, between the teacher and student models.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.9">We use the public IWSLT and WMT datasets to evaluate our method on translation.
The datasets of low-resource scenario include the IWSLT-2014 German <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mover accent="true" id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mo id="S5.SS1.p1.1.m1.1.1.2" stretchy="false" xref="S5.SS1.p1.1.m1.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1">absent</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> English (De <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mover accent="true" id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mo id="S5.SS1.p1.2.m2.1.1.2" stretchy="false" xref="S5.SS1.p1.2.m2.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1">absent</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> En), IWSLT-2017 English <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mover accent="true" id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mo id="S5.SS1.p1.3.m3.1.1.2" stretchy="false" xref="S5.SS1.p1.3.m3.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1">absent</csymbol><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Chinese (En <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><mover accent="true" id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mo id="S5.SS1.p1.4.m4.1.1.2" stretchy="false" xref="S5.SS1.p1.4.m4.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.4.m4.1.1.1" xref="S5.SS1.p1.4.m4.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><csymbol cd="latexml" id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1.1">absent</csymbol><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Zh), WMT-2022 German <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.5.m5.1"><semantics id="S5.SS1.p1.5.m5.1a"><mover accent="true" id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml"><mo id="S5.SS1.p1.5.m5.1.1.2" stretchy="false" xref="S5.SS1.p1.5.m5.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.5.m5.1.1.1" xref="S5.SS1.p1.5.m5.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><apply id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1"><csymbol cd="latexml" id="S5.SS1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1.1">absent</csymbol><ci id="S5.SS1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m5.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Lower Sorbian (De <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.6.m6.1"><semantics id="S5.SS1.p1.6.m6.1a"><mover accent="true" id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml"><mo id="S5.SS1.p1.6.m6.1.1.2" stretchy="false" xref="S5.SS1.p1.6.m6.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.6.m6.1.1.1" xref="S5.SS1.p1.6.m6.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><apply id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1"><csymbol cd="latexml" id="S5.SS1.p1.6.m6.1.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1.1">absent</csymbol><ci id="S5.SS1.p1.6.m6.1.1.2.cmml" xref="S5.SS1.p1.6.m6.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.6.m6.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Dsb) translation.
Tokenization is done with Subword-NMT <cite class="ltx_cite ltx_citemacro_cite">Sennrich et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib23" title="">2016</a>)</cite> for IWSLT-2014 dataset and Sentencepiece <cite class="ltx_cite ltx_citemacro_cite">Kudo and Richardson (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib13" title="">2018</a>)</cite> for the others.
To prove the effectiveness of our method on high-resource scenarios, we evaluate NMT models on the WMT-2014 English <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.7.m7.1"><semantics id="S5.SS1.p1.7.m7.1a"><mover accent="true" id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml"><mo id="S5.SS1.p1.7.m7.1.1.2" stretchy="false" xref="S5.SS1.p1.7.m7.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.7.m7.1.1.1" xref="S5.SS1.p1.7.m7.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.1b"><apply id="S5.SS1.p1.7.m7.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1"><csymbol cd="latexml" id="S5.SS1.p1.7.m7.1.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1.1">absent</csymbol><ci id="S5.SS1.p1.7.m7.1.1.2.cmml" xref="S5.SS1.p1.7.m7.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.7.m7.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> German (En <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.8.m8.1"><semantics id="S5.SS1.p1.8.m8.1a"><mover accent="true" id="S5.SS1.p1.8.m8.1.1" xref="S5.SS1.p1.8.m8.1.1.cmml"><mo id="S5.SS1.p1.8.m8.1.1.2" stretchy="false" xref="S5.SS1.p1.8.m8.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.8.m8.1.1.1" xref="S5.SS1.p1.8.m8.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.8.m8.1b"><apply id="S5.SS1.p1.8.m8.1.1.cmml" xref="S5.SS1.p1.8.m8.1.1"><csymbol cd="latexml" id="S5.SS1.p1.8.m8.1.1.1.cmml" xref="S5.SS1.p1.8.m8.1.1.1">absent</csymbol><ci id="S5.SS1.p1.8.m8.1.1.2.cmml" xref="S5.SS1.p1.8.m8.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.8.m8.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.8.m8.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> De) datasets. we use newstest2013 datasets as a validation set and newstest2014 as the test set.
Data preparation for WMT-2014 En<math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS1.p1.9.m9.1"><semantics id="S5.SS1.p1.9.m9.1a"><mover accent="true" id="S5.SS1.p1.9.m9.1.1" xref="S5.SS1.p1.9.m9.1.1.cmml"><mo id="S5.SS1.p1.9.m9.1.1.2" stretchy="false" xref="S5.SS1.p1.9.m9.1.1.2.cmml">→</mo><mi id="S5.SS1.p1.9.m9.1.1.1" xref="S5.SS1.p1.9.m9.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.9.m9.1b"><apply id="S5.SS1.p1.9.m9.1.1.cmml" xref="S5.SS1.p1.9.m9.1.1"><csymbol cd="latexml" id="S5.SS1.p1.9.m9.1.1.1.cmml" xref="S5.SS1.p1.9.m9.1.1.1">absent</csymbol><ci id="S5.SS1.p1.9.m9.1.1.2.cmml" xref="S5.SS1.p1.9.m9.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.9.m9.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.9.m9.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math>De follows <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib29" title="">2017</a>)</cite> to ensure a fair comparison of baselines in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.T2" title="Table 2 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>.
</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Distillation Settings</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">For every experiment, the teacher and student are trained and evaluated with the same datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.3"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.3.1">Low-resource translation</span> Teacher models are 6-layer Transformers <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib29" title="">2017</a>)</cite> with 4 attention heads, hidden dimensions, and the feed-forward dimension of 512, and 1024 for each.
Unless specified otherwise, student models are 3-layer Transformers with the same hyperparameters as the teacher, except for the number of layers.
For a fair comparison with CKD <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite> which reported results with 2-layer student networks, we additionally test our approach for 2-layer Transformer students. To show that A2D does not require the same number of attention heads between student and teacher, we also present the results with student models having 8 attention heads. For loss scaling, in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E11" title="11 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">11</span></a>), <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">italic_λ</annotation></semantics></math> and <math alttext="\mu" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1"><semantics id="S5.SS2.p2.2.m2.1a"><mi id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><ci id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.2.m2.1d">italic_μ</annotation></semantics></math> are initially set to 1, and we set exponential decay on <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS2.p2.3.m3.1"><semantics id="S5.SS2.p2.3.m3.1a"><mi id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><ci id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.3.m3.1d">italic_λ</annotation></semantics></math> at a rate of 0.9 over epochs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.2"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.2.1">High-resource translation</span> To properly scale the model to the high-resource data, we enlarge the teacher model and student model to 12-layer and 4-layer, respectively.
The other hyperparameter settings such as attention heads and hidden dimension are set identically with <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib29" title="">2017</a>)</cite>.
To adjust to the increased number of attention maps, We used <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">italic_λ</annotation></semantics></math> of <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S5.SS2.p3.2.m2.1"><semantics id="S5.SS2.p3.2.m2.1a"><msub id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p3.2.m2.1.1.2" xref="S5.SS2.p3.2.m2.1.1.2.cmml">ℒ</mi><mi id="S5.SS2.p3.2.m2.1.1.3" xref="S5.SS2.p3.2.m2.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><apply id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.2.m2.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p3.2.m2.1.1.2.cmml" xref="S5.SS2.p3.2.m2.1.1.2">ℒ</ci><ci id="S5.SS2.p3.2.m2.1.1.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> as 0.1.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Baselines</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.2">Selective KD <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib32" title="">2021</a>)</cite> is a variant of vanilla KD <cite class="ltx_cite ltx_citemacro_cite">Hinton et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib8" title="">2015</a>)</cite> which selectively chooses words to distill based on entropy.
For selective KD, we use a “word rate" of 0.5.
For TinyBERT <cite class="ltx_cite ltx_citemacro_cite">Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>)</cite>, every other layer of the teacher model is correspondingly mapped to a layer in the student model.
MiniLM is originally proposed for knowledge distillation in the pre-training stage, so we augment the MiniLM objective with <math alttext="\mathcal{L}_{\mathrm{CE}}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">CE</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">ℒ</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">CE</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\mathcal{L}_{\mathrm{CE}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_CE end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{\mathrm{KD}}" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><msub id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">ℒ</mi><mi id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">KD</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">ℒ</ci><ci id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">KD</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\mathcal{L}_{\mathrm{KD}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_KD end_POSTSUBSCRIPT</annotation></semantics></math> for a fair comparison.
For ALP-KD <cite class="ltx_cite ltx_citemacro_cite">Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite>, we train the student with an attention mask spanned over all teacher layers.
For Combinatorial KD <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite> (CKD), ‘-sc’, ‘-cc’, ‘-rc’, and ‘-oc’ refer to its different layer mapping configurations.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Results on Low-resource datasets</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.2">Low-resource datasets present a unique challenge for NMT models, emphasizing the importance of effective knowledge distillation.
Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.T1" title="Table 1 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes all the results for low-resource NMT.
Models are compared with BLEU scores computed using sacreBLEU <cite class="ltx_cite ltx_citemacro_cite">Post (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib20" title="">2018</a>)</cite>, with a confidence interval of 95%, and the number of bootstrap resamples is 1000.
Previous KD methods, such as TinyBERT and MiniLM, impose a constraint that the number of heads in the student must match that of the teacher.
In contrast, A2D does not have this limitation regarding the number of attention heads, allowing us to train students with 8 heads using teachers with only 4 heads.
We also present the results of students with 8 heads in section <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6" title="6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">6</span></a>.
Doubling the number of attention heads from 4 to 8 does not alter the overall parameter count in the ’A2D (8heads)’ model. This is achieved by proportionally reducing the dimension per head (<math alttext="d_{head}=d_{model}/n_{head}" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><msub id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2.2" xref="S5.SS4.p1.1.m1.1.1.2.2.cmml">d</mi><mrow id="S5.SS4.p1.1.m1.1.1.2.3" xref="S5.SS4.p1.1.m1.1.1.2.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2.3.2" xref="S5.SS4.p1.1.m1.1.1.2.3.2.cmml">h</mi><mo id="S5.SS4.p1.1.m1.1.1.2.3.1" xref="S5.SS4.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.2.3.3" xref="S5.SS4.p1.1.m1.1.1.2.3.3.cmml">e</mi><mo id="S5.SS4.p1.1.m1.1.1.2.3.1a" xref="S5.SS4.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.2.3.4" xref="S5.SS4.p1.1.m1.1.1.2.3.4.cmml">a</mi><mo id="S5.SS4.p1.1.m1.1.1.2.3.1b" xref="S5.SS4.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.2.3.5" xref="S5.SS4.p1.1.m1.1.1.2.3.5.cmml">d</mi></mrow></msub><mo id="S5.SS4.p1.1.m1.1.1.1" xref="S5.SS4.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml"><msub id="S5.SS4.p1.1.m1.1.1.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.2.2" xref="S5.SS4.p1.1.m1.1.1.3.2.2.cmml">d</mi><mrow id="S5.SS4.p1.1.m1.1.1.3.2.3" xref="S5.SS4.p1.1.m1.1.1.3.2.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.2.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.3.2.cmml">m</mi><mo id="S5.SS4.p1.1.m1.1.1.3.2.3.1" xref="S5.SS4.p1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.2.3.3" xref="S5.SS4.p1.1.m1.1.1.3.2.3.3.cmml">o</mi><mo id="S5.SS4.p1.1.m1.1.1.3.2.3.1a" xref="S5.SS4.p1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.2.3.4" xref="S5.SS4.p1.1.m1.1.1.3.2.3.4.cmml">d</mi><mo id="S5.SS4.p1.1.m1.1.1.3.2.3.1b" xref="S5.SS4.p1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.2.3.5" xref="S5.SS4.p1.1.m1.1.1.3.2.3.5.cmml">e</mi><mo id="S5.SS4.p1.1.m1.1.1.3.2.3.1c" xref="S5.SS4.p1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.2.3.6" xref="S5.SS4.p1.1.m1.1.1.3.2.3.6.cmml">l</mi></mrow></msub><mo id="S5.SS4.p1.1.m1.1.1.3.1" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">/</mo><msub id="S5.SS4.p1.1.m1.1.1.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.3.2" xref="S5.SS4.p1.1.m1.1.1.3.3.2.cmml">n</mi><mrow id="S5.SS4.p1.1.m1.1.1.3.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.3.3.2" xref="S5.SS4.p1.1.m1.1.1.3.3.3.2.cmml">h</mi><mo id="S5.SS4.p1.1.m1.1.1.3.3.3.1" xref="S5.SS4.p1.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.3.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.3.3.cmml">e</mi><mo id="S5.SS4.p1.1.m1.1.1.3.3.3.1a" xref="S5.SS4.p1.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.3.3.4" xref="S5.SS4.p1.1.m1.1.1.3.3.3.4.cmml">a</mi><mo id="S5.SS4.p1.1.m1.1.1.3.3.3.1b" xref="S5.SS4.p1.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.3.3.5" xref="S5.SS4.p1.1.m1.1.1.3.3.3.5.cmml">d</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><eq id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1"></eq><apply id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2.2">𝑑</ci><apply id="S5.SS4.p1.1.m1.1.1.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.2.3"><times id="S5.SS4.p1.1.m1.1.1.2.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.2.3.1"></times><ci id="S5.SS4.p1.1.m1.1.1.2.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2.3.2">ℎ</ci><ci id="S5.SS4.p1.1.m1.1.1.2.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.2.3.3">𝑒</ci><ci id="S5.SS4.p1.1.m1.1.1.2.3.4.cmml" xref="S5.SS4.p1.1.m1.1.1.2.3.4">𝑎</ci><ci id="S5.SS4.p1.1.m1.1.1.2.3.5.cmml" xref="S5.SS4.p1.1.m1.1.1.2.3.5">𝑑</ci></apply></apply><apply id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><divide id="S5.SS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.1"></divide><apply id="S5.SS4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.2.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.3.2.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.2">𝑑</ci><apply id="S5.SS4.p1.1.m1.1.1.3.2.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3"><times id="S5.SS4.p1.1.m1.1.1.3.2.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3.1"></times><ci id="S5.SS4.p1.1.m1.1.1.3.2.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3.2">𝑚</ci><ci id="S5.SS4.p1.1.m1.1.1.3.2.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3.3">𝑜</ci><ci id="S5.SS4.p1.1.m1.1.1.3.2.3.4.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3.4">𝑑</ci><ci id="S5.SS4.p1.1.m1.1.1.3.2.3.5.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3.5">𝑒</ci><ci id="S5.SS4.p1.1.m1.1.1.3.2.3.6.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2.3.6">𝑙</ci></apply></apply><apply id="S5.SS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.3.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.2">𝑛</ci><apply id="S5.SS4.p1.1.m1.1.1.3.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.3"><times id="S5.SS4.p1.1.m1.1.1.3.3.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.3.1"></times><ci id="S5.SS4.p1.1.m1.1.1.3.3.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.3.2">ℎ</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.3.3">𝑒</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.3.4.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.3.4">𝑎</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.3.5.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3.3.5">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">d_{head}=d_{model}/n_{head}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT / italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT</annotation></semantics></math>) while keeping the feature dimension (<math alttext="d_{model}" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.1"><semantics id="S5.SS4.p1.2.m2.1a"><msub id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mi id="S5.SS4.p1.2.m2.1.1.2" xref="S5.SS4.p1.2.m2.1.1.2.cmml">d</mi><mrow id="S5.SS4.p1.2.m2.1.1.3" xref="S5.SS4.p1.2.m2.1.1.3.cmml"><mi id="S5.SS4.p1.2.m2.1.1.3.2" xref="S5.SS4.p1.2.m2.1.1.3.2.cmml">m</mi><mo id="S5.SS4.p1.2.m2.1.1.3.1" xref="S5.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.1.1.3.3" xref="S5.SS4.p1.2.m2.1.1.3.3.cmml">o</mi><mo id="S5.SS4.p1.2.m2.1.1.3.1a" xref="S5.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.1.1.3.4" xref="S5.SS4.p1.2.m2.1.1.3.4.cmml">d</mi><mo id="S5.SS4.p1.2.m2.1.1.3.1b" xref="S5.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.1.1.3.5" xref="S5.SS4.p1.2.m2.1.1.3.5.cmml">e</mi><mo id="S5.SS4.p1.2.m2.1.1.3.1c" xref="S5.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.1.1.3.6" xref="S5.SS4.p1.2.m2.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.2">𝑑</ci><apply id="S5.SS4.p1.2.m2.1.1.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3"><times id="S5.SS4.p1.2.m2.1.1.3.1.cmml" xref="S5.SS4.p1.2.m2.1.1.3.1"></times><ci id="S5.SS4.p1.2.m2.1.1.3.2.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S5.SS4.p1.2.m2.1.1.3.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3">𝑜</ci><ci id="S5.SS4.p1.2.m2.1.1.3.4.cmml" xref="S5.SS4.p1.2.m2.1.1.3.4">𝑑</ci><ci id="S5.SS4.p1.2.m2.1.1.3.5.cmml" xref="S5.SS4.p1.2.m2.1.1.3.5">𝑒</ci><ci id="S5.SS4.p1.2.m2.1.1.3.6.cmml" xref="S5.SS4.p1.2.m2.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">d_{model}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>) constant, thus ensuring a fair comparison.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">In the De → En and De → Dsb language pairs, students trained with A2D yield higher BLEU scores than those trained with other KD methods. For the En → Zh language pair, A2D yields superior results compared to other feature-based KD baselines and is on par with Sequence-level KD.
In all language pair settings, students trained with A2D surpass the performance of their teachers despite having only half the number of transformer layers.
Remarkably, the effectiveness of our method was most evident in the De <math alttext="\xrightarrow[]{}" class="ltx_Math" display="inline" id="S5.SS4.p2.1.m1.1"><semantics id="S5.SS4.p2.1.m1.1a"><mover accent="true" id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml"><mo id="S5.SS4.p2.1.m1.1.1.2" stretchy="false" xref="S5.SS4.p2.1.m1.1.1.2.cmml">→</mo><mi id="S5.SS4.p2.1.m1.1.1.1" xref="S5.SS4.p2.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><apply id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS4.p2.1.m1.1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1">absent</csymbol><ci id="S5.SS4.p2.1.m1.1.1.2.cmml" xref="S5.SS4.p2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">\xrightarrow[]{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Dsb dataset, which had the least amount of training data at 39K samples.
These results indicate that training with A2D allows students to achieve better generalization, particularly with low-resource training data.</p>
</div>
<div class="ltx_para" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1">To compare with CKD, we trained 2-layer students using A2D.
While the score of CKD varies on its mapping option, our model consistently outperforms CKD regardless of the dataset or their mapping option.
Moreover, a 2-layer student in De <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S5.SS4.p3.1.m1.1"><semantics id="S5.SS4.p3.1.m1.1a"><mover accent="true" id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml"><mo id="S5.SS4.p3.1.m1.1.1.2" stretchy="false" xref="S5.SS4.p3.1.m1.1.1.2.cmml">→</mo><mi id="S5.SS4.p3.1.m1.1.1.1" xref="S5.SS4.p3.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.1b"><apply id="S5.SS4.p3.1.m1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1"><csymbol cd="latexml" id="S5.SS4.p3.1.m1.1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1.1">absent</csymbol><ci id="S5.SS4.p3.1.m1.1.1.2.cmml" xref="S5.SS4.p3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> En achieves results comparable to its 6-layer teacher.
The results not only validate the robustness of A2D but also show that our learned alignment of attention heads is more effective for knowledge transfer than the heuristic mapping of CKD.</p>
</div>
<div class="ltx_para" id="S5.SS4.p4">
<p class="ltx_p" id="S5.SS4.p4.1">In low-resource settings, a student model could outperform the teacher under the guidance of the teacher model. This is due to the enhanced generalization provided by the regularization effect of distillation, as discussed in <cite class="ltx_cite ltx_citemacro_cite">Mobahi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib17" title="">2020</a>); Yuan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib35" title="">2020</a>)</cite>. The teacher model, often being larger and more complex, captures rich feature representations (such as attention maps) of the data. Through distillation, the student model learns these representations, which might be more generalizable than those learned from the relatively small amount of raw data alone.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Results on High-resource dataset</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">To assess the versatility of our method, we extended our experiments to the high-resource dataset.
Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.T2" title="Table 2 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a> describes our results with different baselines.
From our observations, traditional KD techniques like Patient KD and Combinatorial KD did not enhance the performance of the student models for high-resource data. Surprisingly, they even underperform compared to a student model trained without any KD techniques.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">However, a noticeable distinction arises when training the student model with the A2D approach, demonstrating a performance level similar to that of its teacher, even when modeled with only one-third number of the transformer layers compared to its teacher.
This performance gain remains even without integrating our method with vanilla KD, underscoring its effectiveness.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Analysis and Discussion</h2>
<figure class="ltx_table" id="S6.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.1.1.1"><math alttext="n_{\mathrm{head}}" class="ltx_Math" display="inline" id="S6.T3.1.1.1.m1.1"><semantics id="S6.T3.1.1.1.m1.1a"><msub id="S6.T3.1.1.1.m1.1.1" xref="S6.T3.1.1.1.m1.1.1.cmml"><mi id="S6.T3.1.1.1.m1.1.1.2" xref="S6.T3.1.1.1.m1.1.1.2.cmml">n</mi><mi id="S6.T3.1.1.1.m1.1.1.3" xref="S6.T3.1.1.1.m1.1.1.3.cmml">head</mi></msub><annotation-xml encoding="MathML-Content" id="S6.T3.1.1.1.m1.1b"><apply id="S6.T3.1.1.1.m1.1.1.cmml" xref="S6.T3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T3.1.1.1.m1.1.1.1.cmml" xref="S6.T3.1.1.1.m1.1.1">subscript</csymbol><ci id="S6.T3.1.1.1.m1.1.1.2.cmml" xref="S6.T3.1.1.1.m1.1.1.2">𝑛</ci><ci id="S6.T3.1.1.1.m1.1.1.3.cmml" xref="S6.T3.1.1.1.m1.1.1.3">head</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.1.1.1.m1.1c">n_{\mathrm{head}}</annotation><annotation encoding="application/x-llamapun" id="S6.T3.1.1.1.m1.1d">italic_n start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T3.3.3.4">A2D</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T3.3.3.5">No KD</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T3.2.2.2">
<math alttext="\Delta" class="ltx_Math" display="inline" id="S6.T3.2.2.2.m1.1"><semantics id="S6.T3.2.2.2.m1.1a"><mi id="S6.T3.2.2.2.m1.1.1" mathvariant="normal" xref="S6.T3.2.2.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S6.T3.2.2.2.m1.1b"><ci id="S6.T3.2.2.2.m1.1.1.cmml" xref="S6.T3.2.2.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.2.2.2.m1.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S6.T3.2.2.2.m1.1d">roman_Δ</annotation></semantics></math>BLEU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T3.3.3.3"><math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S6.T3.3.3.3.m1.1"><semantics id="S6.T3.3.3.3.m1.1a"><msub id="S6.T3.3.3.3.m1.1.1" xref="S6.T3.3.3.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.T3.3.3.3.m1.1.1.2" xref="S6.T3.3.3.3.m1.1.1.2.cmml">ℒ</mi><mi id="S6.T3.3.3.3.m1.1.1.3" xref="S6.T3.3.3.3.m1.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S6.T3.3.3.3.m1.1b"><apply id="S6.T3.3.3.3.m1.1.1.cmml" xref="S6.T3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S6.T3.3.3.3.m1.1.1.1.cmml" xref="S6.T3.3.3.3.m1.1.1">subscript</csymbol><ci id="S6.T3.3.3.3.m1.1.1.2.cmml" xref="S6.T3.3.3.3.m1.1.1.2">ℒ</ci><ci id="S6.T3.3.3.3.m1.1.1.3.cmml" xref="S6.T3.3.3.3.m1.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.3.3.3.m1.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S6.T3.3.3.3.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T3.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.3.4.1.1">2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.4.1.2">36.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.3.4.1.3">35.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.4.1.4">0.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.4.1.5">0.036</td>
</tr>
<tr class="ltx_tr" id="S6.T3.3.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.3.5.2.1">4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.5.2.2">37.17</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.3.5.2.3">36.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.5.2.4">0.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.5.2.5">0.024</td>
</tr>
<tr class="ltx_tr" id="S6.T3.3.6.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T3.3.6.3.1">8</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.6.3.2"><span class="ltx_text ltx_font_bold" id="S6.T3.3.6.3.2.1">37.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.3.6.3.3"><span class="ltx_text ltx_font_bold" id="S6.T3.3.6.3.3.1">36.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.6.3.4">1.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.6.3.5">0.016</td>
</tr>
<tr class="ltx_tr" id="S6.T3.3.7.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S6.T3.3.7.4.1">16</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S6.T3.3.7.4.2">37.19</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T3.3.7.4.3">35.78</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S6.T3.3.7.4.4">1.41</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S6.T3.3.7.4.5">0.013</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>BLEU score and our attention distillation loss (<math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S6.T3.7.m1.1"><semantics id="S6.T3.7.m1.1b"><msub id="S6.T3.7.m1.1.1" xref="S6.T3.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.T3.7.m1.1.1.2" xref="S6.T3.7.m1.1.1.2.cmml">ℒ</mi><mi id="S6.T3.7.m1.1.1.3" xref="S6.T3.7.m1.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S6.T3.7.m1.1c"><apply id="S6.T3.7.m1.1.1.cmml" xref="S6.T3.7.m1.1.1"><csymbol cd="ambiguous" id="S6.T3.7.m1.1.1.1.cmml" xref="S6.T3.7.m1.1.1">subscript</csymbol><ci id="S6.T3.7.m1.1.1.2.cmml" xref="S6.T3.7.m1.1.1.2">ℒ</ci><ci id="S6.T3.7.m1.1.1.3.cmml" xref="S6.T3.7.m1.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.7.m1.1d">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S6.T3.7.m1.1e">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math>) at convergence over a different number of heads (<math alttext="n_{\mathrm{head}}" class="ltx_Math" display="inline" id="S6.T3.8.m2.1"><semantics id="S6.T3.8.m2.1b"><msub id="S6.T3.8.m2.1.1" xref="S6.T3.8.m2.1.1.cmml"><mi id="S6.T3.8.m2.1.1.2" xref="S6.T3.8.m2.1.1.2.cmml">n</mi><mi id="S6.T3.8.m2.1.1.3" xref="S6.T3.8.m2.1.1.3.cmml">head</mi></msub><annotation-xml encoding="MathML-Content" id="S6.T3.8.m2.1c"><apply id="S6.T3.8.m2.1.1.cmml" xref="S6.T3.8.m2.1.1"><csymbol cd="ambiguous" id="S6.T3.8.m2.1.1.1.cmml" xref="S6.T3.8.m2.1.1">subscript</csymbol><ci id="S6.T3.8.m2.1.1.2.cmml" xref="S6.T3.8.m2.1.1.2">𝑛</ci><ci id="S6.T3.8.m2.1.1.3.cmml" xref="S6.T3.8.m2.1.1.3">head</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.8.m2.1d">n_{\mathrm{head}}</annotation><annotation encoding="application/x-llamapun" id="S6.T3.8.m2.1e">italic_n start_POSTSUBSCRIPT roman_head end_POSTSUBSCRIPT</annotation></semantics></math>) in A2D and No KD. <math alttext="\Delta" class="ltx_Math" display="inline" id="S6.T3.9.m3.1"><semantics id="S6.T3.9.m3.1b"><mi id="S6.T3.9.m3.1.1" mathvariant="normal" xref="S6.T3.9.m3.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S6.T3.9.m3.1c"><ci id="S6.T3.9.m3.1.1.cmml" xref="S6.T3.9.m3.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.9.m3.1d">\Delta</annotation><annotation encoding="application/x-llamapun" id="S6.T3.9.m3.1e">roman_Δ</annotation></semantics></math>BLEU indicates BLEU score difference between A2D and No KD.</figcaption>
</figure>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Effect of Fine-grained Alignment</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.12">We focus on two attributes of A2D that enable fine-grained alignment: (1) dense, head-wise distillation (2) the use of an attention map as a feature.
Our hypothesis is that the detailed head-wise attention alignment is what gives A2D-trained students an edge in performance. In Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.T3" title="Table 3 ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>, we present how our attention transfer loss and performance gap between students trained with A2D and students trained without KD vary with different numbers of attention heads at the point of convergence. Note that varying the number of heads in the student model does not change the total number of parameters.
Our observation suggests that as we reduce the <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1"><semantics id="S6.SS1.p1.1.m1.1a"><msub id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S6.SS1.p1.1.m1.1.1.3" xref="S6.SS1.p1.1.m1.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2">ℒ</ci><ci id="S6.SS1.p1.1.m1.1.1.3.cmml" xref="S6.SS1.p1.1.m1.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\Delta" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.1"><semantics id="S6.SS1.p1.2.m2.1a"><mi id="S6.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S6.SS1.p1.2.m2.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><ci id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.1d">roman_Δ</annotation></semantics></math>BLEU becomes more pronounced, which indicates the effectiveness of our method. This inverse correlation between <math alttext="\mathcal{L}_{\mathrm{att}}" class="ltx_Math" display="inline" id="S6.SS1.p1.3.m3.1"><semantics id="S6.SS1.p1.3.m3.1a"><msub id="S6.SS1.p1.3.m3.1.1" xref="S6.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.3.m3.1.1.2" xref="S6.SS1.p1.3.m3.1.1.2.cmml">ℒ</mi><mi id="S6.SS1.p1.3.m3.1.1.3" xref="S6.SS1.p1.3.m3.1.1.3.cmml">att</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.1b"><apply id="S6.SS1.p1.3.m3.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.3.m3.1.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S6.SS1.p1.3.m3.1.1.2.cmml" xref="S6.SS1.p1.3.m3.1.1.2">ℒ</ci><ci id="S6.SS1.p1.3.m3.1.1.3.cmml" xref="S6.SS1.p1.3.m3.1.1.3">att</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.1c">\mathcal{L}_{\mathrm{att}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Delta" class="ltx_Math" display="inline" id="S6.SS1.p1.4.m4.1"><semantics id="S6.SS1.p1.4.m4.1a"><mi id="S6.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S6.SS1.p1.4.m4.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.4.m4.1b"><ci id="S6.SS1.p1.4.m4.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.4.m4.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.4.m4.1d">roman_Δ</annotation></semantics></math>BLEU as the number of heads increases could be attributed to our attention alignment module (AAM), which generates intermediate attention maps from original student maps.
AAM draws <span class="ltx_text ltx_font_italic" id="S6.SS1.p1.12.1">all</span> the student attention maps (<math alttext="\mathbf{H}^{S}" class="ltx_Math" display="inline" id="S6.SS1.p1.5.m5.1"><semantics id="S6.SS1.p1.5.m5.1a"><msup id="S6.SS1.p1.5.m5.1.1" xref="S6.SS1.p1.5.m5.1.1.cmml"><mi id="S6.SS1.p1.5.m5.1.1.2" xref="S6.SS1.p1.5.m5.1.1.2.cmml">𝐇</mi><mi id="S6.SS1.p1.5.m5.1.1.3" xref="S6.SS1.p1.5.m5.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.5.m5.1b"><apply id="S6.SS1.p1.5.m5.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.5.m5.1.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S6.SS1.p1.5.m5.1.1.2.cmml" xref="S6.SS1.p1.5.m5.1.1.2">𝐇</ci><ci id="S6.SS1.p1.5.m5.1.1.3.cmml" xref="S6.SS1.p1.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.5.m5.1c">\mathbf{H}^{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.5.m5.1d">bold_H start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT</annotation></semantics></math>) to mimic <span class="ltx_text ltx_font_italic" id="S6.SS1.p1.12.2">each</span> teacher map (<math alttext="\mathbf{H}^{T}_{c}" class="ltx_Math" display="inline" id="S6.SS1.p1.6.m6.1"><semantics id="S6.SS1.p1.6.m6.1a"><msubsup id="S6.SS1.p1.6.m6.1.1" xref="S6.SS1.p1.6.m6.1.1.cmml"><mi id="S6.SS1.p1.6.m6.1.1.2.2" xref="S6.SS1.p1.6.m6.1.1.2.2.cmml">𝐇</mi><mi id="S6.SS1.p1.6.m6.1.1.3" xref="S6.SS1.p1.6.m6.1.1.3.cmml">c</mi><mi id="S6.SS1.p1.6.m6.1.1.2.3" xref="S6.SS1.p1.6.m6.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.6.m6.1b"><apply id="S6.SS1.p1.6.m6.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.6.m6.1.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1">subscript</csymbol><apply id="S6.SS1.p1.6.m6.1.1.2.cmml" xref="S6.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.6.m6.1.1.2.1.cmml" xref="S6.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S6.SS1.p1.6.m6.1.1.2.2.cmml" xref="S6.SS1.p1.6.m6.1.1.2.2">𝐇</ci><ci id="S6.SS1.p1.6.m6.1.1.2.3.cmml" xref="S6.SS1.p1.6.m6.1.1.2.3">𝑇</ci></apply><ci id="S6.SS1.p1.6.m6.1.1.3.cmml" xref="S6.SS1.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.6.m6.1c">\mathbf{H}^{T}_{c}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.6.m6.1d">bold_H start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>) via pointwise convolution operation; approximating <math alttext="\mathbf{H}^{T}" class="ltx_Math" display="inline" id="S6.SS1.p1.7.m7.1"><semantics id="S6.SS1.p1.7.m7.1a"><msup id="S6.SS1.p1.7.m7.1.1" xref="S6.SS1.p1.7.m7.1.1.cmml"><mi id="S6.SS1.p1.7.m7.1.1.2" xref="S6.SS1.p1.7.m7.1.1.2.cmml">𝐇</mi><mi id="S6.SS1.p1.7.m7.1.1.3" xref="S6.SS1.p1.7.m7.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.7.m7.1b"><apply id="S6.SS1.p1.7.m7.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.7.m7.1.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S6.SS1.p1.7.m7.1.1.2.cmml" xref="S6.SS1.p1.7.m7.1.1.2">𝐇</ci><ci id="S6.SS1.p1.7.m7.1.1.3.cmml" xref="S6.SS1.p1.7.m7.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.7.m7.1c">\mathbf{H}^{T}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.7.m7.1d">bold_H start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> from an increased number of <math alttext="\mathbf{H}^{S}" class="ltx_Math" display="inline" id="S6.SS1.p1.8.m8.1"><semantics id="S6.SS1.p1.8.m8.1a"><msup id="S6.SS1.p1.8.m8.1.1" xref="S6.SS1.p1.8.m8.1.1.cmml"><mi id="S6.SS1.p1.8.m8.1.1.2" xref="S6.SS1.p1.8.m8.1.1.2.cmml">𝐇</mi><mi id="S6.SS1.p1.8.m8.1.1.3" xref="S6.SS1.p1.8.m8.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.8.m8.1b"><apply id="S6.SS1.p1.8.m8.1.1.cmml" xref="S6.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.8.m8.1.1.1.cmml" xref="S6.SS1.p1.8.m8.1.1">superscript</csymbol><ci id="S6.SS1.p1.8.m8.1.1.2.cmml" xref="S6.SS1.p1.8.m8.1.1.2">𝐇</ci><ci id="S6.SS1.p1.8.m8.1.1.3.cmml" xref="S6.SS1.p1.8.m8.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.8.m8.1c">\mathbf{H}^{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.8.m8.1d">bold_H start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT</annotation></semantics></math> is more feasible.
However, employing an excessive number of heads might degrade the performance by reducing the expressiveness of each student’s attention head.
We hypothesize that the choice of <math alttext="n_{head}=16" class="ltx_Math" display="inline" id="S6.SS1.p1.9.m9.1"><semantics id="S6.SS1.p1.9.m9.1a"><mrow id="S6.SS1.p1.9.m9.1.1" xref="S6.SS1.p1.9.m9.1.1.cmml"><msub id="S6.SS1.p1.9.m9.1.1.2" xref="S6.SS1.p1.9.m9.1.1.2.cmml"><mi id="S6.SS1.p1.9.m9.1.1.2.2" xref="S6.SS1.p1.9.m9.1.1.2.2.cmml">n</mi><mrow id="S6.SS1.p1.9.m9.1.1.2.3" xref="S6.SS1.p1.9.m9.1.1.2.3.cmml"><mi id="S6.SS1.p1.9.m9.1.1.2.3.2" xref="S6.SS1.p1.9.m9.1.1.2.3.2.cmml">h</mi><mo id="S6.SS1.p1.9.m9.1.1.2.3.1" xref="S6.SS1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.9.m9.1.1.2.3.3" xref="S6.SS1.p1.9.m9.1.1.2.3.3.cmml">e</mi><mo id="S6.SS1.p1.9.m9.1.1.2.3.1a" xref="S6.SS1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.9.m9.1.1.2.3.4" xref="S6.SS1.p1.9.m9.1.1.2.3.4.cmml">a</mi><mo id="S6.SS1.p1.9.m9.1.1.2.3.1b" xref="S6.SS1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.9.m9.1.1.2.3.5" xref="S6.SS1.p1.9.m9.1.1.2.3.5.cmml">d</mi></mrow></msub><mo id="S6.SS1.p1.9.m9.1.1.1" xref="S6.SS1.p1.9.m9.1.1.1.cmml">=</mo><mn id="S6.SS1.p1.9.m9.1.1.3" xref="S6.SS1.p1.9.m9.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.9.m9.1b"><apply id="S6.SS1.p1.9.m9.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1"><eq id="S6.SS1.p1.9.m9.1.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1"></eq><apply id="S6.SS1.p1.9.m9.1.1.2.cmml" xref="S6.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.9.m9.1.1.2.1.cmml" xref="S6.SS1.p1.9.m9.1.1.2">subscript</csymbol><ci id="S6.SS1.p1.9.m9.1.1.2.2.cmml" xref="S6.SS1.p1.9.m9.1.1.2.2">𝑛</ci><apply id="S6.SS1.p1.9.m9.1.1.2.3.cmml" xref="S6.SS1.p1.9.m9.1.1.2.3"><times id="S6.SS1.p1.9.m9.1.1.2.3.1.cmml" xref="S6.SS1.p1.9.m9.1.1.2.3.1"></times><ci id="S6.SS1.p1.9.m9.1.1.2.3.2.cmml" xref="S6.SS1.p1.9.m9.1.1.2.3.2">ℎ</ci><ci id="S6.SS1.p1.9.m9.1.1.2.3.3.cmml" xref="S6.SS1.p1.9.m9.1.1.2.3.3">𝑒</ci><ci id="S6.SS1.p1.9.m9.1.1.2.3.4.cmml" xref="S6.SS1.p1.9.m9.1.1.2.3.4">𝑎</ci><ci id="S6.SS1.p1.9.m9.1.1.2.3.5.cmml" xref="S6.SS1.p1.9.m9.1.1.2.3.5">𝑑</ci></apply></apply><cn id="S6.SS1.p1.9.m9.1.1.3.cmml" type="integer" xref="S6.SS1.p1.9.m9.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.9.m9.1c">n_{head}=16</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.9.m9.1d">italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT = 16</annotation></semantics></math> was overly complex for a model with specifications <math alttext="d_{model}=512" class="ltx_Math" display="inline" id="S6.SS1.p1.10.m10.1"><semantics id="S6.SS1.p1.10.m10.1a"><mrow id="S6.SS1.p1.10.m10.1.1" xref="S6.SS1.p1.10.m10.1.1.cmml"><msub id="S6.SS1.p1.10.m10.1.1.2" xref="S6.SS1.p1.10.m10.1.1.2.cmml"><mi id="S6.SS1.p1.10.m10.1.1.2.2" xref="S6.SS1.p1.10.m10.1.1.2.2.cmml">d</mi><mrow id="S6.SS1.p1.10.m10.1.1.2.3" xref="S6.SS1.p1.10.m10.1.1.2.3.cmml"><mi id="S6.SS1.p1.10.m10.1.1.2.3.2" xref="S6.SS1.p1.10.m10.1.1.2.3.2.cmml">m</mi><mo id="S6.SS1.p1.10.m10.1.1.2.3.1" xref="S6.SS1.p1.10.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.10.m10.1.1.2.3.3" xref="S6.SS1.p1.10.m10.1.1.2.3.3.cmml">o</mi><mo id="S6.SS1.p1.10.m10.1.1.2.3.1a" xref="S6.SS1.p1.10.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.10.m10.1.1.2.3.4" xref="S6.SS1.p1.10.m10.1.1.2.3.4.cmml">d</mi><mo id="S6.SS1.p1.10.m10.1.1.2.3.1b" xref="S6.SS1.p1.10.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.10.m10.1.1.2.3.5" xref="S6.SS1.p1.10.m10.1.1.2.3.5.cmml">e</mi><mo id="S6.SS1.p1.10.m10.1.1.2.3.1c" xref="S6.SS1.p1.10.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.10.m10.1.1.2.3.6" xref="S6.SS1.p1.10.m10.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S6.SS1.p1.10.m10.1.1.1" xref="S6.SS1.p1.10.m10.1.1.1.cmml">=</mo><mn id="S6.SS1.p1.10.m10.1.1.3" xref="S6.SS1.p1.10.m10.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.10.m10.1b"><apply id="S6.SS1.p1.10.m10.1.1.cmml" xref="S6.SS1.p1.10.m10.1.1"><eq id="S6.SS1.p1.10.m10.1.1.1.cmml" xref="S6.SS1.p1.10.m10.1.1.1"></eq><apply id="S6.SS1.p1.10.m10.1.1.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.10.m10.1.1.2.1.cmml" xref="S6.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="S6.SS1.p1.10.m10.1.1.2.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2.2">𝑑</ci><apply id="S6.SS1.p1.10.m10.1.1.2.3.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3"><times id="S6.SS1.p1.10.m10.1.1.2.3.1.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.1"></times><ci id="S6.SS1.p1.10.m10.1.1.2.3.2.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.2">𝑚</ci><ci id="S6.SS1.p1.10.m10.1.1.2.3.3.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.3">𝑜</ci><ci id="S6.SS1.p1.10.m10.1.1.2.3.4.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.4">𝑑</ci><ci id="S6.SS1.p1.10.m10.1.1.2.3.5.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.5">𝑒</ci><ci id="S6.SS1.p1.10.m10.1.1.2.3.6.cmml" xref="S6.SS1.p1.10.m10.1.1.2.3.6">𝑙</ci></apply></apply><cn id="S6.SS1.p1.10.m10.1.1.3.cmml" type="integer" xref="S6.SS1.p1.10.m10.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.10.m10.1c">d_{model}=512</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.10.m10.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT = 512</annotation></semantics></math> and reduced the capacity of each head.
This led to the model’s optimal performance in BLEU with <math alttext="n_{head}=8" class="ltx_Math" display="inline" id="S6.SS1.p1.11.m11.1"><semantics id="S6.SS1.p1.11.m11.1a"><mrow id="S6.SS1.p1.11.m11.1.1" xref="S6.SS1.p1.11.m11.1.1.cmml"><msub id="S6.SS1.p1.11.m11.1.1.2" xref="S6.SS1.p1.11.m11.1.1.2.cmml"><mi id="S6.SS1.p1.11.m11.1.1.2.2" xref="S6.SS1.p1.11.m11.1.1.2.2.cmml">n</mi><mrow id="S6.SS1.p1.11.m11.1.1.2.3" xref="S6.SS1.p1.11.m11.1.1.2.3.cmml"><mi id="S6.SS1.p1.11.m11.1.1.2.3.2" xref="S6.SS1.p1.11.m11.1.1.2.3.2.cmml">h</mi><mo id="S6.SS1.p1.11.m11.1.1.2.3.1" xref="S6.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.11.m11.1.1.2.3.3" xref="S6.SS1.p1.11.m11.1.1.2.3.3.cmml">e</mi><mo id="S6.SS1.p1.11.m11.1.1.2.3.1a" xref="S6.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.11.m11.1.1.2.3.4" xref="S6.SS1.p1.11.m11.1.1.2.3.4.cmml">a</mi><mo id="S6.SS1.p1.11.m11.1.1.2.3.1b" xref="S6.SS1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.11.m11.1.1.2.3.5" xref="S6.SS1.p1.11.m11.1.1.2.3.5.cmml">d</mi></mrow></msub><mo id="S6.SS1.p1.11.m11.1.1.1" xref="S6.SS1.p1.11.m11.1.1.1.cmml">=</mo><mn id="S6.SS1.p1.11.m11.1.1.3" xref="S6.SS1.p1.11.m11.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.11.m11.1b"><apply id="S6.SS1.p1.11.m11.1.1.cmml" xref="S6.SS1.p1.11.m11.1.1"><eq id="S6.SS1.p1.11.m11.1.1.1.cmml" xref="S6.SS1.p1.11.m11.1.1.1"></eq><apply id="S6.SS1.p1.11.m11.1.1.2.cmml" xref="S6.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.11.m11.1.1.2.1.cmml" xref="S6.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S6.SS1.p1.11.m11.1.1.2.2.cmml" xref="S6.SS1.p1.11.m11.1.1.2.2">𝑛</ci><apply id="S6.SS1.p1.11.m11.1.1.2.3.cmml" xref="S6.SS1.p1.11.m11.1.1.2.3"><times id="S6.SS1.p1.11.m11.1.1.2.3.1.cmml" xref="S6.SS1.p1.11.m11.1.1.2.3.1"></times><ci id="S6.SS1.p1.11.m11.1.1.2.3.2.cmml" xref="S6.SS1.p1.11.m11.1.1.2.3.2">ℎ</ci><ci id="S6.SS1.p1.11.m11.1.1.2.3.3.cmml" xref="S6.SS1.p1.11.m11.1.1.2.3.3">𝑒</ci><ci id="S6.SS1.p1.11.m11.1.1.2.3.4.cmml" xref="S6.SS1.p1.11.m11.1.1.2.3.4">𝑎</ci><ci id="S6.SS1.p1.11.m11.1.1.2.3.5.cmml" xref="S6.SS1.p1.11.m11.1.1.2.3.5">𝑑</ci></apply></apply><cn id="S6.SS1.p1.11.m11.1.1.3.cmml" type="integer" xref="S6.SS1.p1.11.m11.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.11.m11.1c">n_{head}=8</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.11.m11.1d">italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT = 8</annotation></semantics></math>, but recorded a dip in performance when escalated to <math alttext="n_{head}=16" class="ltx_Math" display="inline" id="S6.SS1.p1.12.m12.1"><semantics id="S6.SS1.p1.12.m12.1a"><mrow id="S6.SS1.p1.12.m12.1.1" xref="S6.SS1.p1.12.m12.1.1.cmml"><msub id="S6.SS1.p1.12.m12.1.1.2" xref="S6.SS1.p1.12.m12.1.1.2.cmml"><mi id="S6.SS1.p1.12.m12.1.1.2.2" xref="S6.SS1.p1.12.m12.1.1.2.2.cmml">n</mi><mrow id="S6.SS1.p1.12.m12.1.1.2.3" xref="S6.SS1.p1.12.m12.1.1.2.3.cmml"><mi id="S6.SS1.p1.12.m12.1.1.2.3.2" xref="S6.SS1.p1.12.m12.1.1.2.3.2.cmml">h</mi><mo id="S6.SS1.p1.12.m12.1.1.2.3.1" xref="S6.SS1.p1.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.12.m12.1.1.2.3.3" xref="S6.SS1.p1.12.m12.1.1.2.3.3.cmml">e</mi><mo id="S6.SS1.p1.12.m12.1.1.2.3.1a" xref="S6.SS1.p1.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.12.m12.1.1.2.3.4" xref="S6.SS1.p1.12.m12.1.1.2.3.4.cmml">a</mi><mo id="S6.SS1.p1.12.m12.1.1.2.3.1b" xref="S6.SS1.p1.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S6.SS1.p1.12.m12.1.1.2.3.5" xref="S6.SS1.p1.12.m12.1.1.2.3.5.cmml">d</mi></mrow></msub><mo id="S6.SS1.p1.12.m12.1.1.1" xref="S6.SS1.p1.12.m12.1.1.1.cmml">=</mo><mn id="S6.SS1.p1.12.m12.1.1.3" xref="S6.SS1.p1.12.m12.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.12.m12.1b"><apply id="S6.SS1.p1.12.m12.1.1.cmml" xref="S6.SS1.p1.12.m12.1.1"><eq id="S6.SS1.p1.12.m12.1.1.1.cmml" xref="S6.SS1.p1.12.m12.1.1.1"></eq><apply id="S6.SS1.p1.12.m12.1.1.2.cmml" xref="S6.SS1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p1.12.m12.1.1.2.1.cmml" xref="S6.SS1.p1.12.m12.1.1.2">subscript</csymbol><ci id="S6.SS1.p1.12.m12.1.1.2.2.cmml" xref="S6.SS1.p1.12.m12.1.1.2.2">𝑛</ci><apply id="S6.SS1.p1.12.m12.1.1.2.3.cmml" xref="S6.SS1.p1.12.m12.1.1.2.3"><times id="S6.SS1.p1.12.m12.1.1.2.3.1.cmml" xref="S6.SS1.p1.12.m12.1.1.2.3.1"></times><ci id="S6.SS1.p1.12.m12.1.1.2.3.2.cmml" xref="S6.SS1.p1.12.m12.1.1.2.3.2">ℎ</ci><ci id="S6.SS1.p1.12.m12.1.1.2.3.3.cmml" xref="S6.SS1.p1.12.m12.1.1.2.3.3">𝑒</ci><ci id="S6.SS1.p1.12.m12.1.1.2.3.4.cmml" xref="S6.SS1.p1.12.m12.1.1.2.3.4">𝑎</ci><ci id="S6.SS1.p1.12.m12.1.1.2.3.5.cmml" xref="S6.SS1.p1.12.m12.1.1.2.3.5">𝑑</ci></apply></apply><cn id="S6.SS1.p1.12.m12.1.1.3.cmml" type="integer" xref="S6.SS1.p1.12.m12.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.12.m12.1c">n_{head}=16</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.12.m12.1d">italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d end_POSTSUBSCRIPT = 16</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.2">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.F2" title="Figure 2 ‣ 6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>, we present the connectivity between attention maps learned by AAM (pointwise convolution layer) with heatmap.
It shows that heads from students associate not only within but across the layers to form intermediate maps (<math alttext="\mathbf{H}^{I}" class="ltx_Math" display="inline" id="S6.SS1.p2.1.m1.1"><semantics id="S6.SS1.p2.1.m1.1a"><msup id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml"><mi id="S6.SS1.p2.1.m1.1.1.2" xref="S6.SS1.p2.1.m1.1.1.2.cmml">𝐇</mi><mi id="S6.SS1.p2.1.m1.1.1.3" xref="S6.SS1.p2.1.m1.1.1.3.cmml">I</mi></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b"><apply id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1">superscript</csymbol><ci id="S6.SS1.p2.1.m1.1.1.2.cmml" xref="S6.SS1.p2.1.m1.1.1.2">𝐇</ci><ci id="S6.SS1.p2.1.m1.1.1.3.cmml" xref="S6.SS1.p2.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">\mathbf{H}^{I}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.1.m1.1d">bold_H start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math>) that are purposed to emulate the teacher maps (<math alttext="\mathbf{H}^{T}" class="ltx_Math" display="inline" id="S6.SS1.p2.2.m2.1"><semantics id="S6.SS1.p2.2.m2.1a"><msup id="S6.SS1.p2.2.m2.1.1" xref="S6.SS1.p2.2.m2.1.1.cmml"><mi id="S6.SS1.p2.2.m2.1.1.2" xref="S6.SS1.p2.2.m2.1.1.2.cmml">𝐇</mi><mi id="S6.SS1.p2.2.m2.1.1.3" xref="S6.SS1.p2.2.m2.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.1b"><apply id="S6.SS1.p2.2.m2.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.1.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1">superscript</csymbol><ci id="S6.SS1.p2.2.m2.1.1.2.cmml" xref="S6.SS1.p2.2.m2.1.1.2">𝐇</ci><ci id="S6.SS1.p2.2.m2.1.1.3.cmml" xref="S6.SS1.p2.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.1c">\mathbf{H}^{T}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.2.m2.1d">bold_H start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>).
This suggests that transferring knowledge using entire layers as units may not be the most effective approach for knowledge transfer.
To justify the claim, we also carried out evaluations on the layer-wise variant of A2D, as demonstrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.T4" title="Table 4 ‣ 6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">4</span></a>.
Layer-wise A2D, which uses per-layer averaged maps as a knowledge feature, underperforms the original head-wise A2D by a significant margin on every language pair.
This observation reinforces our hypothesis emphasizing the impact of our head-wise comparison approach in distillation.</p>
</div>
<figure class="ltx_figure" id="S6.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="299" id="S6.F2.g1" src="extracted/5493287/analysis.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Attention head connection weights in the trained AAM. Axes indicate attention head numbers in the student (3 layers of 8 heads) and teacher (6 layers of 4 heads) models. The dashed grid shows layer boundaries. Darker colors signify stronger connections. Best viewed in color.</figcaption>
</figure>
<figure class="ltx_table" id="S6.T4">
<div class="ltx_inline-block ltx_transformed_outer" id="S6.T4.9" style="width:433.6pt;height:219.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(122.8pt,-62.3pt) scale(2.30512449522687,2.30512449522687) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T4.9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T4.9.9.10.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S6.T4.9.9.10.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T4.9.9.10.1.2">Layer-wise A2D</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T4.9.9.10.1.3">
<table class="ltx_tabular ltx_align_middle" id="S6.T4.9.9.10.1.3.1">
<tr class="ltx_tr" id="S6.T4.9.9.10.1.3.1.1">
<td class="ltx_td ltx_align_center" id="S6.T4.9.9.10.1.3.1.1.1">Head-wise A2D</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.9.10.1.3.1.2">
<td class="ltx_td ltx_align_center" id="S6.T4.9.9.10.1.3.1.2.1">(Default)</td>
</tr>
</table></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T4.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T4.1.1.1.1">De <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S6.T4.1.1.1.1.m1.1"><semantics id="S6.T4.1.1.1.1.m1.1a"><mover accent="true" id="S6.T4.1.1.1.1.m1.1.1" xref="S6.T4.1.1.1.1.m1.1.1.cmml"><mo id="S6.T4.1.1.1.1.m1.1.1.2" stretchy="false" xref="S6.T4.1.1.1.1.m1.1.1.2.cmml">→</mo><mi id="S6.T4.1.1.1.1.m1.1.1.1" xref="S6.T4.1.1.1.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S6.T4.1.1.1.1.m1.1b"><apply id="S6.T4.1.1.1.1.m1.1.1.cmml" xref="S6.T4.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S6.T4.1.1.1.1.m1.1.1.1.cmml" xref="S6.T4.1.1.1.1.m1.1.1.1">absent</csymbol><ci id="S6.T4.1.1.1.1.m1.1.1.2.cmml" xref="S6.T4.1.1.1.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.1.1.1.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S6.T4.1.1.1.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> En</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.2.2.2.2">37.01 <math alttext="\scriptstyle\pm 0.49" class="ltx_Math" display="inline" id="S6.T4.2.2.2.2.m1.1"><semantics id="S6.T4.2.2.2.2.m1.1a"><mrow id="S6.T4.2.2.2.2.m1.1.1" xref="S6.T4.2.2.2.2.m1.1.1.cmml"><mo id="S6.T4.2.2.2.2.m1.1.1a" mathsize="70%" xref="S6.T4.2.2.2.2.m1.1.1.cmml">±</mo><mn id="S6.T4.2.2.2.2.m1.1.1.2" mathsize="70%" xref="S6.T4.2.2.2.2.m1.1.1.2.cmml">0.49</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.2.2.2.2.m1.1b"><apply id="S6.T4.2.2.2.2.m1.1.1.cmml" xref="S6.T4.2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S6.T4.2.2.2.2.m1.1.1.1.cmml" xref="S6.T4.2.2.2.2.m1.1.1">plus-or-minus</csymbol><cn id="S6.T4.2.2.2.2.m1.1.1.2.cmml" type="float" xref="S6.T4.2.2.2.2.m1.1.1.2">0.49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.2.2.2.2.m1.1c">\scriptstyle\pm 0.49</annotation><annotation encoding="application/x-llamapun" id="S6.T4.2.2.2.2.m1.1d">± 0.49</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.3.3.3.3"><span class="ltx_text ltx_font_bold" id="S6.T4.3.3.3.3.1">37.75 <math alttext="\scriptstyle\pm 0.49" class="ltx_Math" display="inline" id="S6.T4.3.3.3.3.1.m1.1"><semantics id="S6.T4.3.3.3.3.1.m1.1a"><mrow id="S6.T4.3.3.3.3.1.m1.1.1" xref="S6.T4.3.3.3.3.1.m1.1.1.cmml"><mo id="S6.T4.3.3.3.3.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S6.T4.3.3.3.3.1.m1.1.1.cmml">±</mo><mn id="S6.T4.3.3.3.3.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S6.T4.3.3.3.3.1.m1.1.1.2.cmml">0.49</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.3.3.3.3.1.m1.1b"><apply id="S6.T4.3.3.3.3.1.m1.1.1.cmml" xref="S6.T4.3.3.3.3.1.m1.1.1"><csymbol cd="latexml" id="S6.T4.3.3.3.3.1.m1.1.1.1.cmml" xref="S6.T4.3.3.3.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S6.T4.3.3.3.3.1.m1.1.1.2.cmml" type="float" xref="S6.T4.3.3.3.3.1.m1.1.1.2">0.49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.3.3.3.3.1.m1.1c">\scriptstyle\pm 0.49</annotation><annotation encoding="application/x-llamapun" id="S6.T4.3.3.3.3.1.m1.1d">± 0.49</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T4.4.4.4.1">De <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S6.T4.4.4.4.1.m1.1"><semantics id="S6.T4.4.4.4.1.m1.1a"><mover accent="true" id="S6.T4.4.4.4.1.m1.1.1" xref="S6.T4.4.4.4.1.m1.1.1.cmml"><mo id="S6.T4.4.4.4.1.m1.1.1.2" stretchy="false" xref="S6.T4.4.4.4.1.m1.1.1.2.cmml">→</mo><mi id="S6.T4.4.4.4.1.m1.1.1.1" xref="S6.T4.4.4.4.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S6.T4.4.4.4.1.m1.1b"><apply id="S6.T4.4.4.4.1.m1.1.1.cmml" xref="S6.T4.4.4.4.1.m1.1.1"><csymbol cd="latexml" id="S6.T4.4.4.4.1.m1.1.1.1.cmml" xref="S6.T4.4.4.4.1.m1.1.1.1">absent</csymbol><ci id="S6.T4.4.4.4.1.m1.1.1.2.cmml" xref="S6.T4.4.4.4.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.4.4.4.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S6.T4.4.4.4.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Dsb</th>
<td class="ltx_td ltx_align_center" id="S6.T4.5.5.5.2">36.70 <math alttext="\scriptstyle\pm 1.96" class="ltx_Math" display="inline" id="S6.T4.5.5.5.2.m1.1"><semantics id="S6.T4.5.5.5.2.m1.1a"><mrow id="S6.T4.5.5.5.2.m1.1.1" xref="S6.T4.5.5.5.2.m1.1.1.cmml"><mo id="S6.T4.5.5.5.2.m1.1.1a" mathsize="70%" xref="S6.T4.5.5.5.2.m1.1.1.cmml">±</mo><mn id="S6.T4.5.5.5.2.m1.1.1.2" mathsize="70%" xref="S6.T4.5.5.5.2.m1.1.1.2.cmml">1.96</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.5.5.5.2.m1.1b"><apply id="S6.T4.5.5.5.2.m1.1.1.cmml" xref="S6.T4.5.5.5.2.m1.1.1"><csymbol cd="latexml" id="S6.T4.5.5.5.2.m1.1.1.1.cmml" xref="S6.T4.5.5.5.2.m1.1.1">plus-or-minus</csymbol><cn id="S6.T4.5.5.5.2.m1.1.1.2.cmml" type="float" xref="S6.T4.5.5.5.2.m1.1.1.2">1.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.5.5.5.2.m1.1c">\scriptstyle\pm 1.96</annotation><annotation encoding="application/x-llamapun" id="S6.T4.5.5.5.2.m1.1d">± 1.96</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S6.T4.6.6.6.3"><span class="ltx_text ltx_font_bold" id="S6.T4.6.6.6.3.1">39.49 <math alttext="\scriptstyle\pm 2.06" class="ltx_Math" display="inline" id="S6.T4.6.6.6.3.1.m1.1"><semantics id="S6.T4.6.6.6.3.1.m1.1a"><mrow id="S6.T4.6.6.6.3.1.m1.1.1" xref="S6.T4.6.6.6.3.1.m1.1.1.cmml"><mo id="S6.T4.6.6.6.3.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S6.T4.6.6.6.3.1.m1.1.1.cmml">±</mo><mn id="S6.T4.6.6.6.3.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S6.T4.6.6.6.3.1.m1.1.1.2.cmml">2.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.6.6.6.3.1.m1.1b"><apply id="S6.T4.6.6.6.3.1.m1.1.1.cmml" xref="S6.T4.6.6.6.3.1.m1.1.1"><csymbol cd="latexml" id="S6.T4.6.6.6.3.1.m1.1.1.1.cmml" xref="S6.T4.6.6.6.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S6.T4.6.6.6.3.1.m1.1.1.2.cmml" type="float" xref="S6.T4.6.6.6.3.1.m1.1.1.2">2.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.6.6.6.3.1.m1.1c">\scriptstyle\pm 2.06</annotation><annotation encoding="application/x-llamapun" id="S6.T4.6.6.6.3.1.m1.1d">± 2.06</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S6.T4.7.7.7.1">En <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S6.T4.7.7.7.1.m1.1"><semantics id="S6.T4.7.7.7.1.m1.1a"><mover accent="true" id="S6.T4.7.7.7.1.m1.1.1" xref="S6.T4.7.7.7.1.m1.1.1.cmml"><mo id="S6.T4.7.7.7.1.m1.1.1.2" stretchy="false" xref="S6.T4.7.7.7.1.m1.1.1.2.cmml">→</mo><mi id="S6.T4.7.7.7.1.m1.1.1.1" xref="S6.T4.7.7.7.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S6.T4.7.7.7.1.m1.1b"><apply id="S6.T4.7.7.7.1.m1.1.1.cmml" xref="S6.T4.7.7.7.1.m1.1.1"><csymbol cd="latexml" id="S6.T4.7.7.7.1.m1.1.1.1.cmml" xref="S6.T4.7.7.7.1.m1.1.1.1">absent</csymbol><ci id="S6.T4.7.7.7.1.m1.1.1.2.cmml" xref="S6.T4.7.7.7.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.7.7.7.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S6.T4.7.7.7.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Zh</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T4.8.8.8.2">24.07 <math alttext="\scriptstyle\pm 0.34" class="ltx_Math" display="inline" id="S6.T4.8.8.8.2.m1.1"><semantics id="S6.T4.8.8.8.2.m1.1a"><mrow id="S6.T4.8.8.8.2.m1.1.1" xref="S6.T4.8.8.8.2.m1.1.1.cmml"><mo id="S6.T4.8.8.8.2.m1.1.1a" mathsize="70%" xref="S6.T4.8.8.8.2.m1.1.1.cmml">±</mo><mn id="S6.T4.8.8.8.2.m1.1.1.2" mathsize="70%" xref="S6.T4.8.8.8.2.m1.1.1.2.cmml">0.34</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.8.8.8.2.m1.1b"><apply id="S6.T4.8.8.8.2.m1.1.1.cmml" xref="S6.T4.8.8.8.2.m1.1.1"><csymbol cd="latexml" id="S6.T4.8.8.8.2.m1.1.1.1.cmml" xref="S6.T4.8.8.8.2.m1.1.1">plus-or-minus</csymbol><cn id="S6.T4.8.8.8.2.m1.1.1.2.cmml" type="float" xref="S6.T4.8.8.8.2.m1.1.1.2">0.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.8.8.8.2.m1.1c">\scriptstyle\pm 0.34</annotation><annotation encoding="application/x-llamapun" id="S6.T4.8.8.8.2.m1.1d">± 0.34</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T4.9.9.9.3"><span class="ltx_text ltx_font_bold" id="S6.T4.9.9.9.3.1">24.32 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S6.T4.9.9.9.3.1.m1.1"><semantics id="S6.T4.9.9.9.3.1.m1.1a"><mrow id="S6.T4.9.9.9.3.1.m1.1.1" xref="S6.T4.9.9.9.3.1.m1.1.1.cmml"><mo id="S6.T4.9.9.9.3.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S6.T4.9.9.9.3.1.m1.1.1.cmml">±</mo><mn id="S6.T4.9.9.9.3.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S6.T4.9.9.9.3.1.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.9.9.9.3.1.m1.1b"><apply id="S6.T4.9.9.9.3.1.m1.1.1.cmml" xref="S6.T4.9.9.9.3.1.m1.1.1"><csymbol cd="latexml" id="S6.T4.9.9.9.3.1.m1.1.1.1.cmml" xref="S6.T4.9.9.9.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S6.T4.9.9.9.3.1.m1.1.1.2.cmml" type="float" xref="S6.T4.9.9.9.3.1.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.9.9.9.3.1.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S6.T4.9.9.9.3.1.m1.1d">± 0.33</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of our original A2D (head-wise distillation) with its layer-wise counterpart.</figcaption>
</figure>
<figure class="ltx_table" id="S6.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T5.18">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T5.18.19.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S6.T5.18.19.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T5.18.19.1.2">A2D (All)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T5.18.19.1.3">A2D (Enc-Self)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T5.18.19.1.4">A2D (Dec-All)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T5.18.19.1.5">A2D (Dec-Self)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T5.18.19.1.6">A2D (Dec-Cross)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T5.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.1.1">De <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S6.T5.1.1.1.m1.1"><semantics id="S6.T5.1.1.1.m1.1a"><mover accent="true" id="S6.T5.1.1.1.m1.1.1" xref="S6.T5.1.1.1.m1.1.1.cmml"><mo id="S6.T5.1.1.1.m1.1.1.2" stretchy="false" xref="S6.T5.1.1.1.m1.1.1.2.cmml">→</mo><mi id="S6.T5.1.1.1.m1.1.1.1" xref="S6.T5.1.1.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S6.T5.1.1.1.m1.1b"><apply id="S6.T5.1.1.1.m1.1.1.cmml" xref="S6.T5.1.1.1.m1.1.1"><csymbol cd="latexml" id="S6.T5.1.1.1.m1.1.1.1.cmml" xref="S6.T5.1.1.1.m1.1.1.1">absent</csymbol><ci id="S6.T5.1.1.1.m1.1.1.2.cmml" xref="S6.T5.1.1.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.1.1.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S6.T5.1.1.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> En</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.2.2.2"><span class="ltx_text ltx_font_bold" id="S6.T5.2.2.2.1">37.75 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S6.T5.2.2.2.1.m1.1"><semantics id="S6.T5.2.2.2.1.m1.1a"><mrow id="S6.T5.2.2.2.1.m1.1.1" xref="S6.T5.2.2.2.1.m1.1.1.cmml"><mo id="S6.T5.2.2.2.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S6.T5.2.2.2.1.m1.1.1.cmml">±</mo><mn id="S6.T5.2.2.2.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S6.T5.2.2.2.1.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.2.2.2.1.m1.1b"><apply id="S6.T5.2.2.2.1.m1.1.1.cmml" xref="S6.T5.2.2.2.1.m1.1.1"><csymbol cd="latexml" id="S6.T5.2.2.2.1.m1.1.1.1.cmml" xref="S6.T5.2.2.2.1.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.2.2.2.1.m1.1.1.2.cmml" type="float" xref="S6.T5.2.2.2.1.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.2.2.2.1.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S6.T5.2.2.2.1.m1.1d">± 0.51</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.3.3.3">37.39 <math alttext="\scriptstyle\pm 0.50" class="ltx_Math" display="inline" id="S6.T5.3.3.3.m1.1"><semantics id="S6.T5.3.3.3.m1.1a"><mrow id="S6.T5.3.3.3.m1.1.1" xref="S6.T5.3.3.3.m1.1.1.cmml"><mo id="S6.T5.3.3.3.m1.1.1a" mathsize="70%" xref="S6.T5.3.3.3.m1.1.1.cmml">±</mo><mn id="S6.T5.3.3.3.m1.1.1.2" mathsize="70%" xref="S6.T5.3.3.3.m1.1.1.2.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.3.3.3.m1.1b"><apply id="S6.T5.3.3.3.m1.1.1.cmml" xref="S6.T5.3.3.3.m1.1.1"><csymbol cd="latexml" id="S6.T5.3.3.3.m1.1.1.1.cmml" xref="S6.T5.3.3.3.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.3.3.3.m1.1.1.2.cmml" type="float" xref="S6.T5.3.3.3.m1.1.1.2">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.3.3.3.m1.1c">\scriptstyle\pm 0.50</annotation><annotation encoding="application/x-llamapun" id="S6.T5.3.3.3.m1.1d">± 0.50</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.4.4.4">37.21 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S6.T5.4.4.4.m1.1"><semantics id="S6.T5.4.4.4.m1.1a"><mrow id="S6.T5.4.4.4.m1.1.1" xref="S6.T5.4.4.4.m1.1.1.cmml"><mo id="S6.T5.4.4.4.m1.1.1a" mathsize="70%" xref="S6.T5.4.4.4.m1.1.1.cmml">±</mo><mn id="S6.T5.4.4.4.m1.1.1.2" mathsize="70%" xref="S6.T5.4.4.4.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.4.4.4.m1.1b"><apply id="S6.T5.4.4.4.m1.1.1.cmml" xref="S6.T5.4.4.4.m1.1.1"><csymbol cd="latexml" id="S6.T5.4.4.4.m1.1.1.1.cmml" xref="S6.T5.4.4.4.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.4.4.4.m1.1.1.2.cmml" type="float" xref="S6.T5.4.4.4.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.4.4.4.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S6.T5.4.4.4.m1.1d">± 0.51</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.5.5.5">37.16 <math alttext="\scriptstyle\pm 0.49" class="ltx_Math" display="inline" id="S6.T5.5.5.5.m1.1"><semantics id="S6.T5.5.5.5.m1.1a"><mrow id="S6.T5.5.5.5.m1.1.1" xref="S6.T5.5.5.5.m1.1.1.cmml"><mo id="S6.T5.5.5.5.m1.1.1a" mathsize="70%" xref="S6.T5.5.5.5.m1.1.1.cmml">±</mo><mn id="S6.T5.5.5.5.m1.1.1.2" mathsize="70%" xref="S6.T5.5.5.5.m1.1.1.2.cmml">0.49</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.5.5.5.m1.1b"><apply id="S6.T5.5.5.5.m1.1.1.cmml" xref="S6.T5.5.5.5.m1.1.1"><csymbol cd="latexml" id="S6.T5.5.5.5.m1.1.1.1.cmml" xref="S6.T5.5.5.5.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.5.5.5.m1.1.1.2.cmml" type="float" xref="S6.T5.5.5.5.m1.1.1.2">0.49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.5.5.5.m1.1c">\scriptstyle\pm 0.49</annotation><annotation encoding="application/x-llamapun" id="S6.T5.5.5.5.m1.1d">± 0.49</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.6.6.6">37.25 <math alttext="\scriptstyle\pm 0.51" class="ltx_Math" display="inline" id="S6.T5.6.6.6.m1.1"><semantics id="S6.T5.6.6.6.m1.1a"><mrow id="S6.T5.6.6.6.m1.1.1" xref="S6.T5.6.6.6.m1.1.1.cmml"><mo id="S6.T5.6.6.6.m1.1.1a" mathsize="70%" xref="S6.T5.6.6.6.m1.1.1.cmml">±</mo><mn id="S6.T5.6.6.6.m1.1.1.2" mathsize="70%" xref="S6.T5.6.6.6.m1.1.1.2.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.6.6.6.m1.1b"><apply id="S6.T5.6.6.6.m1.1.1.cmml" xref="S6.T5.6.6.6.m1.1.1"><csymbol cd="latexml" id="S6.T5.6.6.6.m1.1.1.1.cmml" xref="S6.T5.6.6.6.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.6.6.6.m1.1.1.2.cmml" type="float" xref="S6.T5.6.6.6.m1.1.1.2">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.6.6.6.m1.1c">\scriptstyle\pm 0.51</annotation><annotation encoding="application/x-llamapun" id="S6.T5.6.6.6.m1.1d">± 0.51</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T5.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.7.7.1">De <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S6.T5.7.7.1.m1.1"><semantics id="S6.T5.7.7.1.m1.1a"><mover accent="true" id="S6.T5.7.7.1.m1.1.1" xref="S6.T5.7.7.1.m1.1.1.cmml"><mo id="S6.T5.7.7.1.m1.1.1.2" stretchy="false" xref="S6.T5.7.7.1.m1.1.1.2.cmml">→</mo><mi id="S6.T5.7.7.1.m1.1.1.1" xref="S6.T5.7.7.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S6.T5.7.7.1.m1.1b"><apply id="S6.T5.7.7.1.m1.1.1.cmml" xref="S6.T5.7.7.1.m1.1.1"><csymbol cd="latexml" id="S6.T5.7.7.1.m1.1.1.1.cmml" xref="S6.T5.7.7.1.m1.1.1.1">absent</csymbol><ci id="S6.T5.7.7.1.m1.1.1.2.cmml" xref="S6.T5.7.7.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.7.7.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S6.T5.7.7.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Dsb</th>
<td class="ltx_td ltx_align_center" id="S6.T5.8.8.2"><span class="ltx_text ltx_font_bold" id="S6.T5.8.8.2.1">39.49 <math alttext="\scriptstyle\pm 2.06" class="ltx_Math" display="inline" id="S6.T5.8.8.2.1.m1.1"><semantics id="S6.T5.8.8.2.1.m1.1a"><mrow id="S6.T5.8.8.2.1.m1.1.1" xref="S6.T5.8.8.2.1.m1.1.1.cmml"><mo id="S6.T5.8.8.2.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S6.T5.8.8.2.1.m1.1.1.cmml">±</mo><mn id="S6.T5.8.8.2.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S6.T5.8.8.2.1.m1.1.1.2.cmml">2.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.8.8.2.1.m1.1b"><apply id="S6.T5.8.8.2.1.m1.1.1.cmml" xref="S6.T5.8.8.2.1.m1.1.1"><csymbol cd="latexml" id="S6.T5.8.8.2.1.m1.1.1.1.cmml" xref="S6.T5.8.8.2.1.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.8.8.2.1.m1.1.1.2.cmml" type="float" xref="S6.T5.8.8.2.1.m1.1.1.2">2.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.8.8.2.1.m1.1c">\scriptstyle\pm 2.06</annotation><annotation encoding="application/x-llamapun" id="S6.T5.8.8.2.1.m1.1d">± 2.06</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.9.9.3">36.80 <math alttext="\scriptstyle\pm 2.01" class="ltx_Math" display="inline" id="S6.T5.9.9.3.m1.1"><semantics id="S6.T5.9.9.3.m1.1a"><mrow id="S6.T5.9.9.3.m1.1.1" xref="S6.T5.9.9.3.m1.1.1.cmml"><mo id="S6.T5.9.9.3.m1.1.1a" mathsize="70%" xref="S6.T5.9.9.3.m1.1.1.cmml">±</mo><mn id="S6.T5.9.9.3.m1.1.1.2" mathsize="70%" xref="S6.T5.9.9.3.m1.1.1.2.cmml">2.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.9.9.3.m1.1b"><apply id="S6.T5.9.9.3.m1.1.1.cmml" xref="S6.T5.9.9.3.m1.1.1"><csymbol cd="latexml" id="S6.T5.9.9.3.m1.1.1.1.cmml" xref="S6.T5.9.9.3.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.9.9.3.m1.1.1.2.cmml" type="float" xref="S6.T5.9.9.3.m1.1.1.2">2.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.9.9.3.m1.1c">\scriptstyle\pm 2.01</annotation><annotation encoding="application/x-llamapun" id="S6.T5.9.9.3.m1.1d">± 2.01</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S6.T5.10.10.4">37.81 <math alttext="\scriptstyle\pm 1.95" class="ltx_Math" display="inline" id="S6.T5.10.10.4.m1.1"><semantics id="S6.T5.10.10.4.m1.1a"><mrow id="S6.T5.10.10.4.m1.1.1" xref="S6.T5.10.10.4.m1.1.1.cmml"><mo id="S6.T5.10.10.4.m1.1.1a" mathsize="70%" xref="S6.T5.10.10.4.m1.1.1.cmml">±</mo><mn id="S6.T5.10.10.4.m1.1.1.2" mathsize="70%" xref="S6.T5.10.10.4.m1.1.1.2.cmml">1.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.10.10.4.m1.1b"><apply id="S6.T5.10.10.4.m1.1.1.cmml" xref="S6.T5.10.10.4.m1.1.1"><csymbol cd="latexml" id="S6.T5.10.10.4.m1.1.1.1.cmml" xref="S6.T5.10.10.4.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.10.10.4.m1.1.1.2.cmml" type="float" xref="S6.T5.10.10.4.m1.1.1.2">1.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.10.10.4.m1.1c">\scriptstyle\pm 1.95</annotation><annotation encoding="application/x-llamapun" id="S6.T5.10.10.4.m1.1d">± 1.95</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S6.T5.11.11.5">36.81 <math alttext="\scriptstyle\pm 2.13" class="ltx_Math" display="inline" id="S6.T5.11.11.5.m1.1"><semantics id="S6.T5.11.11.5.m1.1a"><mrow id="S6.T5.11.11.5.m1.1.1" xref="S6.T5.11.11.5.m1.1.1.cmml"><mo id="S6.T5.11.11.5.m1.1.1a" mathsize="70%" xref="S6.T5.11.11.5.m1.1.1.cmml">±</mo><mn id="S6.T5.11.11.5.m1.1.1.2" mathsize="70%" xref="S6.T5.11.11.5.m1.1.1.2.cmml">2.13</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.11.11.5.m1.1b"><apply id="S6.T5.11.11.5.m1.1.1.cmml" xref="S6.T5.11.11.5.m1.1.1"><csymbol cd="latexml" id="S6.T5.11.11.5.m1.1.1.1.cmml" xref="S6.T5.11.11.5.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.11.11.5.m1.1.1.2.cmml" type="float" xref="S6.T5.11.11.5.m1.1.1.2">2.13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.11.11.5.m1.1c">\scriptstyle\pm 2.13</annotation><annotation encoding="application/x-llamapun" id="S6.T5.11.11.5.m1.1d">± 2.13</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S6.T5.12.12.6">37.66 <math alttext="\scriptstyle\pm 1.97" class="ltx_Math" display="inline" id="S6.T5.12.12.6.m1.1"><semantics id="S6.T5.12.12.6.m1.1a"><mrow id="S6.T5.12.12.6.m1.1.1" xref="S6.T5.12.12.6.m1.1.1.cmml"><mo id="S6.T5.12.12.6.m1.1.1a" mathsize="70%" xref="S6.T5.12.12.6.m1.1.1.cmml">±</mo><mn id="S6.T5.12.12.6.m1.1.1.2" mathsize="70%" xref="S6.T5.12.12.6.m1.1.1.2.cmml">1.97</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.12.12.6.m1.1b"><apply id="S6.T5.12.12.6.m1.1.1.cmml" xref="S6.T5.12.12.6.m1.1.1"><csymbol cd="latexml" id="S6.T5.12.12.6.m1.1.1.1.cmml" xref="S6.T5.12.12.6.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.12.12.6.m1.1.1.2.cmml" type="float" xref="S6.T5.12.12.6.m1.1.1.2">1.97</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.12.12.6.m1.1c">\scriptstyle\pm 1.97</annotation><annotation encoding="application/x-llamapun" id="S6.T5.12.12.6.m1.1d">± 1.97</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T5.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S6.T5.13.13.1">En <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S6.T5.13.13.1.m1.1"><semantics id="S6.T5.13.13.1.m1.1a"><mover accent="true" id="S6.T5.13.13.1.m1.1.1" xref="S6.T5.13.13.1.m1.1.1.cmml"><mo id="S6.T5.13.13.1.m1.1.1.2" stretchy="false" xref="S6.T5.13.13.1.m1.1.1.2.cmml">→</mo><mi id="S6.T5.13.13.1.m1.1.1.1" xref="S6.T5.13.13.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S6.T5.13.13.1.m1.1b"><apply id="S6.T5.13.13.1.m1.1.1.cmml" xref="S6.T5.13.13.1.m1.1.1"><csymbol cd="latexml" id="S6.T5.13.13.1.m1.1.1.1.cmml" xref="S6.T5.13.13.1.m1.1.1.1">absent</csymbol><ci id="S6.T5.13.13.1.m1.1.1.2.cmml" xref="S6.T5.13.13.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.13.13.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S6.T5.13.13.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Zh</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T5.14.14.2">24.32 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S6.T5.14.14.2.m1.1"><semantics id="S6.T5.14.14.2.m1.1a"><mrow id="S6.T5.14.14.2.m1.1.1" xref="S6.T5.14.14.2.m1.1.1.cmml"><mo id="S6.T5.14.14.2.m1.1.1a" mathsize="70%" xref="S6.T5.14.14.2.m1.1.1.cmml">±</mo><mn id="S6.T5.14.14.2.m1.1.1.2" mathsize="70%" xref="S6.T5.14.14.2.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.14.14.2.m1.1b"><apply id="S6.T5.14.14.2.m1.1.1.cmml" xref="S6.T5.14.14.2.m1.1.1"><csymbol cd="latexml" id="S6.T5.14.14.2.m1.1.1.1.cmml" xref="S6.T5.14.14.2.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.14.14.2.m1.1.1.2.cmml" type="float" xref="S6.T5.14.14.2.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.14.14.2.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S6.T5.14.14.2.m1.1d">± 0.33</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T5.15.15.3"><span class="ltx_text ltx_font_bold" id="S6.T5.15.15.3.1">24.77 <math alttext="\scriptstyle\pm 0.32" class="ltx_Math" display="inline" id="S6.T5.15.15.3.1.m1.1"><semantics id="S6.T5.15.15.3.1.m1.1a"><mrow id="S6.T5.15.15.3.1.m1.1.1" xref="S6.T5.15.15.3.1.m1.1.1.cmml"><mo id="S6.T5.15.15.3.1.m1.1.1a" mathsize="70%" mathvariant="normal" xref="S6.T5.15.15.3.1.m1.1.1.cmml">±</mo><mn id="S6.T5.15.15.3.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S6.T5.15.15.3.1.m1.1.1.2.cmml">0.32</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.15.15.3.1.m1.1b"><apply id="S6.T5.15.15.3.1.m1.1.1.cmml" xref="S6.T5.15.15.3.1.m1.1.1"><csymbol cd="latexml" id="S6.T5.15.15.3.1.m1.1.1.1.cmml" xref="S6.T5.15.15.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.15.15.3.1.m1.1.1.2.cmml" type="float" xref="S6.T5.15.15.3.1.m1.1.1.2">0.32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.15.15.3.1.m1.1c">\scriptstyle\pm 0.32</annotation><annotation encoding="application/x-llamapun" id="S6.T5.15.15.3.1.m1.1d">± 0.32</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T5.16.16.4">24.75 <math alttext="\scriptstyle\pm 0.35" class="ltx_Math" display="inline" id="S6.T5.16.16.4.m1.1"><semantics id="S6.T5.16.16.4.m1.1a"><mrow id="S6.T5.16.16.4.m1.1.1" xref="S6.T5.16.16.4.m1.1.1.cmml"><mo id="S6.T5.16.16.4.m1.1.1a" mathsize="70%" xref="S6.T5.16.16.4.m1.1.1.cmml">±</mo><mn id="S6.T5.16.16.4.m1.1.1.2" mathsize="70%" xref="S6.T5.16.16.4.m1.1.1.2.cmml">0.35</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.16.16.4.m1.1b"><apply id="S6.T5.16.16.4.m1.1.1.cmml" xref="S6.T5.16.16.4.m1.1.1"><csymbol cd="latexml" id="S6.T5.16.16.4.m1.1.1.1.cmml" xref="S6.T5.16.16.4.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.16.16.4.m1.1.1.2.cmml" type="float" xref="S6.T5.16.16.4.m1.1.1.2">0.35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.16.16.4.m1.1c">\scriptstyle\pm 0.35</annotation><annotation encoding="application/x-llamapun" id="S6.T5.16.16.4.m1.1d">± 0.35</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T5.17.17.5">24.67 <math alttext="\scriptstyle\pm 0.33" class="ltx_Math" display="inline" id="S6.T5.17.17.5.m1.1"><semantics id="S6.T5.17.17.5.m1.1a"><mrow id="S6.T5.17.17.5.m1.1.1" xref="S6.T5.17.17.5.m1.1.1.cmml"><mo id="S6.T5.17.17.5.m1.1.1a" mathsize="70%" xref="S6.T5.17.17.5.m1.1.1.cmml">±</mo><mn id="S6.T5.17.17.5.m1.1.1.2" mathsize="70%" xref="S6.T5.17.17.5.m1.1.1.2.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.17.17.5.m1.1b"><apply id="S6.T5.17.17.5.m1.1.1.cmml" xref="S6.T5.17.17.5.m1.1.1"><csymbol cd="latexml" id="S6.T5.17.17.5.m1.1.1.1.cmml" xref="S6.T5.17.17.5.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.17.17.5.m1.1.1.2.cmml" type="float" xref="S6.T5.17.17.5.m1.1.1.2">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.17.17.5.m1.1c">\scriptstyle\pm 0.33</annotation><annotation encoding="application/x-llamapun" id="S6.T5.17.17.5.m1.1d">± 0.33</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T5.18.18.6">24.64 <math alttext="\scriptstyle\pm 0.35" class="ltx_Math" display="inline" id="S6.T5.18.18.6.m1.1"><semantics id="S6.T5.18.18.6.m1.1a"><mrow id="S6.T5.18.18.6.m1.1.1" xref="S6.T5.18.18.6.m1.1.1.cmml"><mo id="S6.T5.18.18.6.m1.1.1a" mathsize="70%" xref="S6.T5.18.18.6.m1.1.1.cmml">±</mo><mn id="S6.T5.18.18.6.m1.1.1.2" mathsize="70%" xref="S6.T5.18.18.6.m1.1.1.2.cmml">0.35</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.18.18.6.m1.1b"><apply id="S6.T5.18.18.6.m1.1.1.cmml" xref="S6.T5.18.18.6.m1.1.1"><csymbol cd="latexml" id="S6.T5.18.18.6.m1.1.1.1.cmml" xref="S6.T5.18.18.6.m1.1.1">plus-or-minus</csymbol><cn id="S6.T5.18.18.6.m1.1.1.2.cmml" type="float" xref="S6.T5.18.18.6.m1.1.1.2">0.35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.18.18.6.m1.1c">\scriptstyle\pm 0.35</annotation><annotation encoding="application/x-llamapun" id="S6.T5.18.18.6.m1.1d">± 0.35</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation studies by applying A2D on different parts of Transformer. Dec-All setting indicates that both self-attention and cross-attention maps are used for A2D. For Dec-Self and Dec-Cross settings, we increased the weight of <math alttext="L_{\mathrm{att}}^{\mathrm{dec-self}}" class="ltx_Math" display="inline" id="S6.T5.22.m1.1"><semantics id="S6.T5.22.m1.1b"><msubsup id="S6.T5.22.m1.1.1" xref="S6.T5.22.m1.1.1.cmml"><mi id="S6.T5.22.m1.1.1.2.2" xref="S6.T5.22.m1.1.1.2.2.cmml">L</mi><mi id="S6.T5.22.m1.1.1.2.3" xref="S6.T5.22.m1.1.1.2.3.cmml">att</mi><mrow id="S6.T5.22.m1.1.1.3" xref="S6.T5.22.m1.1.1.3.cmml"><mi id="S6.T5.22.m1.1.1.3.2" xref="S6.T5.22.m1.1.1.3.2.cmml">dec</mi><mo id="S6.T5.22.m1.1.1.3.1" xref="S6.T5.22.m1.1.1.3.1.cmml">−</mo><mi id="S6.T5.22.m1.1.1.3.3" xref="S6.T5.22.m1.1.1.3.3.cmml">self</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S6.T5.22.m1.1c"><apply id="S6.T5.22.m1.1.1.cmml" xref="S6.T5.22.m1.1.1"><csymbol cd="ambiguous" id="S6.T5.22.m1.1.1.1.cmml" xref="S6.T5.22.m1.1.1">superscript</csymbol><apply id="S6.T5.22.m1.1.1.2.cmml" xref="S6.T5.22.m1.1.1"><csymbol cd="ambiguous" id="S6.T5.22.m1.1.1.2.1.cmml" xref="S6.T5.22.m1.1.1">subscript</csymbol><ci id="S6.T5.22.m1.1.1.2.2.cmml" xref="S6.T5.22.m1.1.1.2.2">𝐿</ci><ci id="S6.T5.22.m1.1.1.2.3.cmml" xref="S6.T5.22.m1.1.1.2.3">att</ci></apply><apply id="S6.T5.22.m1.1.1.3.cmml" xref="S6.T5.22.m1.1.1.3"><minus id="S6.T5.22.m1.1.1.3.1.cmml" xref="S6.T5.22.m1.1.1.3.1"></minus><ci id="S6.T5.22.m1.1.1.3.2.cmml" xref="S6.T5.22.m1.1.1.3.2">dec</ci><ci id="S6.T5.22.m1.1.1.3.3.cmml" xref="S6.T5.22.m1.1.1.3.3">self</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.22.m1.1d">L_{\mathrm{att}}^{\mathrm{dec-self}}</annotation><annotation encoding="application/x-llamapun" id="S6.T5.22.m1.1e">italic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_self end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="L_{\mathrm{att}}^{\mathrm{dec-cross}}" class="ltx_Math" display="inline" id="S6.T5.23.m2.1"><semantics id="S6.T5.23.m2.1b"><msubsup id="S6.T5.23.m2.1.1" xref="S6.T5.23.m2.1.1.cmml"><mi id="S6.T5.23.m2.1.1.2.2" xref="S6.T5.23.m2.1.1.2.2.cmml">L</mi><mi id="S6.T5.23.m2.1.1.2.3" xref="S6.T5.23.m2.1.1.2.3.cmml">att</mi><mrow id="S6.T5.23.m2.1.1.3" xref="S6.T5.23.m2.1.1.3.cmml"><mi id="S6.T5.23.m2.1.1.3.2" xref="S6.T5.23.m2.1.1.3.2.cmml">dec</mi><mo id="S6.T5.23.m2.1.1.3.1" xref="S6.T5.23.m2.1.1.3.1.cmml">−</mo><mi id="S6.T5.23.m2.1.1.3.3" xref="S6.T5.23.m2.1.1.3.3.cmml">cross</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S6.T5.23.m2.1c"><apply id="S6.T5.23.m2.1.1.cmml" xref="S6.T5.23.m2.1.1"><csymbol cd="ambiguous" id="S6.T5.23.m2.1.1.1.cmml" xref="S6.T5.23.m2.1.1">superscript</csymbol><apply id="S6.T5.23.m2.1.1.2.cmml" xref="S6.T5.23.m2.1.1"><csymbol cd="ambiguous" id="S6.T5.23.m2.1.1.2.1.cmml" xref="S6.T5.23.m2.1.1">subscript</csymbol><ci id="S6.T5.23.m2.1.1.2.2.cmml" xref="S6.T5.23.m2.1.1.2.2">𝐿</ci><ci id="S6.T5.23.m2.1.1.2.3.cmml" xref="S6.T5.23.m2.1.1.2.3">att</ci></apply><apply id="S6.T5.23.m2.1.1.3.cmml" xref="S6.T5.23.m2.1.1.3"><minus id="S6.T5.23.m2.1.1.3.1.cmml" xref="S6.T5.23.m2.1.1.3.1"></minus><ci id="S6.T5.23.m2.1.1.3.2.cmml" xref="S6.T5.23.m2.1.1.3.2">dec</ci><ci id="S6.T5.23.m2.1.1.3.3.cmml" xref="S6.T5.23.m2.1.1.3.3">cross</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.23.m2.1d">L_{\mathrm{att}}^{\mathrm{dec-cross}}</annotation><annotation encoding="application/x-llamapun" id="S6.T5.23.m2.1e">italic_L start_POSTSUBSCRIPT roman_att end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_dec - roman_cross end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="1/2" class="ltx_Math" display="inline" id="S6.T5.24.m3.1"><semantics id="S6.T5.24.m3.1b"><mrow id="S6.T5.24.m3.1.1" xref="S6.T5.24.m3.1.1.cmml"><mn id="S6.T5.24.m3.1.1.2" xref="S6.T5.24.m3.1.1.2.cmml">1</mn><mo id="S6.T5.24.m3.1.1.1" xref="S6.T5.24.m3.1.1.1.cmml">/</mo><mn id="S6.T5.24.m3.1.1.3" xref="S6.T5.24.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.24.m3.1c"><apply id="S6.T5.24.m3.1.1.cmml" xref="S6.T5.24.m3.1.1"><divide id="S6.T5.24.m3.1.1.1.cmml" xref="S6.T5.24.m3.1.1.1"></divide><cn id="S6.T5.24.m3.1.1.2.cmml" type="integer" xref="S6.T5.24.m3.1.1.2">1</cn><cn id="S6.T5.24.m3.1.1.3.cmml" type="integer" xref="S6.T5.24.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.24.m3.1d">1/2</annotation><annotation encoding="application/x-llamapun" id="S6.T5.24.m3.1e">1 / 2</annotation></semantics></math> to 1 respectively to match the loss scale on the Dec-All setting.</figcaption>
</figure>
<figure class="ltx_table" id="S6.T6">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T6.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T6.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.1">Model</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.2">#Params</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.3">CoLA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.4">MNLI-(m/mm)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.5">SST-2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.6">QNLI</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.7">MRPC</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.8">QQP</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.9">RTE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S6.T6.2.3.1.10">STS-B</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.2.3.1.11">Avg</td>
</tr>
<tr class="ltx_tr" id="S6.T6.2.4.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S6.T6.2.4.2.1"></th>
<td class="ltx_td ltx_border_r" id="S6.T6.2.4.2.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.3">(Mcc)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.4">(Acc)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.5">(Acc)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.6">(Acc)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.7">(F1)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.8">(Acc)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.9">(Acc)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.4.2.10">(Spear)</td>
<td class="ltx_td" id="S6.T6.2.4.2.11"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T6.1.1.1"><math alttext="\text{BERT}_{base}" class="ltx_Math" display="inline" id="S6.T6.1.1.1.m1.1"><semantics id="S6.T6.1.1.1.m1.1a"><msub id="S6.T6.1.1.1.m1.1.1" xref="S6.T6.1.1.1.m1.1.1.cmml"><mtext id="S6.T6.1.1.1.m1.1.1.2" xref="S6.T6.1.1.1.m1.1.1.2a.cmml">BERT</mtext><mrow id="S6.T6.1.1.1.m1.1.1.3" xref="S6.T6.1.1.1.m1.1.1.3.cmml"><mi id="S6.T6.1.1.1.m1.1.1.3.2" xref="S6.T6.1.1.1.m1.1.1.3.2.cmml">b</mi><mo id="S6.T6.1.1.1.m1.1.1.3.1" xref="S6.T6.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.T6.1.1.1.m1.1.1.3.3" xref="S6.T6.1.1.1.m1.1.1.3.3.cmml">a</mi><mo id="S6.T6.1.1.1.m1.1.1.3.1a" xref="S6.T6.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.T6.1.1.1.m1.1.1.3.4" xref="S6.T6.1.1.1.m1.1.1.3.4.cmml">s</mi><mo id="S6.T6.1.1.1.m1.1.1.3.1b" xref="S6.T6.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.T6.1.1.1.m1.1.1.3.5" xref="S6.T6.1.1.1.m1.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.T6.1.1.1.m1.1b"><apply id="S6.T6.1.1.1.m1.1.1.cmml" xref="S6.T6.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T6.1.1.1.m1.1.1.1.cmml" xref="S6.T6.1.1.1.m1.1.1">subscript</csymbol><ci id="S6.T6.1.1.1.m1.1.1.2a.cmml" xref="S6.T6.1.1.1.m1.1.1.2"><mtext id="S6.T6.1.1.1.m1.1.1.2.cmml" xref="S6.T6.1.1.1.m1.1.1.2">BERT</mtext></ci><apply id="S6.T6.1.1.1.m1.1.1.3.cmml" xref="S6.T6.1.1.1.m1.1.1.3"><times id="S6.T6.1.1.1.m1.1.1.3.1.cmml" xref="S6.T6.1.1.1.m1.1.1.3.1"></times><ci id="S6.T6.1.1.1.m1.1.1.3.2.cmml" xref="S6.T6.1.1.1.m1.1.1.3.2">𝑏</ci><ci id="S6.T6.1.1.1.m1.1.1.3.3.cmml" xref="S6.T6.1.1.1.m1.1.1.3.3">𝑎</ci><ci id="S6.T6.1.1.1.m1.1.1.3.4.cmml" xref="S6.T6.1.1.1.m1.1.1.3.4">𝑠</ci><ci id="S6.T6.1.1.1.m1.1.1.3.5.cmml" xref="S6.T6.1.1.1.m1.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.1.1.1.m1.1c">\text{BERT}_{base}</annotation><annotation encoding="application/x-llamapun" id="S6.T6.1.1.1.m1.1d">BERT start_POSTSUBSCRIPT italic_b italic_a italic_s italic_e end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.2">110M</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.3">58.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.4">84.5/84.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.5">91.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.6">91.3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.7">89.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.8">91.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.9">67.9</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.1.1.10">89.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.11">82.9</td>
</tr>
<tr class="ltx_tr" id="S6.T6.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T6.2.2.1"><math alttext="\text{BERT}_{6}" class="ltx_Math" display="inline" id="S6.T6.2.2.1.m1.1"><semantics id="S6.T6.2.2.1.m1.1a"><msub id="S6.T6.2.2.1.m1.1.1" xref="S6.T6.2.2.1.m1.1.1.cmml"><mtext id="S6.T6.2.2.1.m1.1.1.2" xref="S6.T6.2.2.1.m1.1.1.2a.cmml">BERT</mtext><mn id="S6.T6.2.2.1.m1.1.1.3" xref="S6.T6.2.2.1.m1.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S6.T6.2.2.1.m1.1b"><apply id="S6.T6.2.2.1.m1.1.1.cmml" xref="S6.T6.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T6.2.2.1.m1.1.1.1.cmml" xref="S6.T6.2.2.1.m1.1.1">subscript</csymbol><ci id="S6.T6.2.2.1.m1.1.1.2a.cmml" xref="S6.T6.2.2.1.m1.1.1.2"><mtext id="S6.T6.2.2.1.m1.1.1.2.cmml" xref="S6.T6.2.2.1.m1.1.1.2">BERT</mtext></ci><cn id="S6.T6.2.2.1.m1.1.1.3.cmml" type="integer" xref="S6.T6.2.2.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.2.2.1.m1.1c">\text{BERT}_{6}</annotation><annotation encoding="application/x-llamapun" id="S6.T6.2.2.1.m1.1d">BERT start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.2">66M</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.3">51.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.4">81.7/82.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.5">91.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.6">89.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.7">89.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.8">90.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.9">66.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.2.10">88.3</td>
<td class="ltx_td ltx_align_center" id="S6.T6.2.2.11">80.9</td>
</tr>
<tr class="ltx_tr" id="S6.T6.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T6.2.5.3.1">PD</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.2">66M</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.4">82.5/83.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.5">91.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.6">89.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.7"><span class="ltx_text ltx_font_bold" id="S6.T6.2.5.3.7.1">89.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.8">
<span class="ltx_ERROR undefined" id="S6.T6.2.5.3.8.1">\ul</span>90.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.9">66.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T6.2.5.3.10">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.2.5.3.11">-</td>
</tr>
<tr class="ltx_tr" id="S6.T6.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T6.2.6.4.1">PKD</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.2">66M</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.3">45.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.4">81.3/-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.5">91.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.6">88.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.7">85.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.8">88.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.9">66.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.6.4.10">86.2</td>
<td class="ltx_td ltx_align_center" id="S6.T6.2.6.4.11">79.2</td>
</tr>
<tr class="ltx_tr" id="S6.T6.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S6.T6.2.7.5.1">TinyBERT</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.2">66M</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.3">
<span class="ltx_ERROR undefined" id="S6.T6.2.7.5.3.1">\ul</span>53.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.4">
<span class="ltx_ERROR undefined" id="S6.T6.2.7.5.4.1">\ul</span>83.1/83.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.5"><span class="ltx_text ltx_font_bold" id="S6.T6.2.7.5.5.1">92.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.6">
<span class="ltx_ERROR undefined" id="S6.T6.2.7.5.6.1">\ul</span>89.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.7">88.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.8">90.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.9">
<span class="ltx_ERROR undefined" id="S6.T6.2.7.5.9.1">\ul</span>66.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T6.2.7.5.10">
<span class="ltx_ERROR undefined" id="S6.T6.2.7.5.10.1">\ul</span>88.3</td>
<td class="ltx_td ltx_align_center" id="S6.T6.2.7.5.11">
<span class="ltx_ERROR undefined" id="S6.T6.2.7.5.11.1">\ul</span>81.7</td>
</tr>
<tr class="ltx_tr" id="S6.T6.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.1"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.1.1">A2D</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.2">66M</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.3"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.3.1">58.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.4"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.4.1">83.2/83.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.5">
<span class="ltx_ERROR undefined" id="S6.T6.2.8.6.5.1">\ul</span>91.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.6"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.6.1">90.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.7">
<span class="ltx_ERROR undefined" id="S6.T6.2.8.6.7.1">\ul</span>89.2</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.8"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.8.1">90.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.9"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.9.1">67.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T6.2.8.6.10"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.10.1">88.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.2.8.6.11"><span class="ltx_text ltx_font_bold" id="S6.T6.2.8.6.11.1">82.5</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Evaluation results on the dev set of GLUE Benchmark. We use <math alttext="\text{BERT}_{base}" class="ltx_Math" display="inline" id="S6.T6.6.m1.1"><semantics id="S6.T6.6.m1.1b"><msub id="S6.T6.6.m1.1.1" xref="S6.T6.6.m1.1.1.cmml"><mtext id="S6.T6.6.m1.1.1.2" xref="S6.T6.6.m1.1.1.2a.cmml">BERT</mtext><mrow id="S6.T6.6.m1.1.1.3" xref="S6.T6.6.m1.1.1.3.cmml"><mi id="S6.T6.6.m1.1.1.3.2" xref="S6.T6.6.m1.1.1.3.2.cmml">b</mi><mo id="S6.T6.6.m1.1.1.3.1" xref="S6.T6.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.T6.6.m1.1.1.3.3" xref="S6.T6.6.m1.1.1.3.3.cmml">a</mi><mo id="S6.T6.6.m1.1.1.3.1b" xref="S6.T6.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.T6.6.m1.1.1.3.4" xref="S6.T6.6.m1.1.1.3.4.cmml">s</mi><mo id="S6.T6.6.m1.1.1.3.1c" xref="S6.T6.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.T6.6.m1.1.1.3.5" xref="S6.T6.6.m1.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.T6.6.m1.1c"><apply id="S6.T6.6.m1.1.1.cmml" xref="S6.T6.6.m1.1.1"><csymbol cd="ambiguous" id="S6.T6.6.m1.1.1.1.cmml" xref="S6.T6.6.m1.1.1">subscript</csymbol><ci id="S6.T6.6.m1.1.1.2a.cmml" xref="S6.T6.6.m1.1.1.2"><mtext id="S6.T6.6.m1.1.1.2.cmml" xref="S6.T6.6.m1.1.1.2">BERT</mtext></ci><apply id="S6.T6.6.m1.1.1.3.cmml" xref="S6.T6.6.m1.1.1.3"><times id="S6.T6.6.m1.1.1.3.1.cmml" xref="S6.T6.6.m1.1.1.3.1"></times><ci id="S6.T6.6.m1.1.1.3.2.cmml" xref="S6.T6.6.m1.1.1.3.2">𝑏</ci><ci id="S6.T6.6.m1.1.1.3.3.cmml" xref="S6.T6.6.m1.1.1.3.3">𝑎</ci><ci id="S6.T6.6.m1.1.1.3.4.cmml" xref="S6.T6.6.m1.1.1.3.4">𝑠</ci><ci id="S6.T6.6.m1.1.1.3.5.cmml" xref="S6.T6.6.m1.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.6.m1.1d">\text{BERT}_{base}</annotation><annotation encoding="application/x-llamapun" id="S6.T6.6.m1.1e">BERT start_POSTSUBSCRIPT italic_b italic_a italic_s italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\text{BERT}_{6}" class="ltx_Math" display="inline" id="S6.T6.7.m2.1"><semantics id="S6.T6.7.m2.1b"><msub id="S6.T6.7.m2.1.1" xref="S6.T6.7.m2.1.1.cmml"><mtext id="S6.T6.7.m2.1.1.2" xref="S6.T6.7.m2.1.1.2a.cmml">BERT</mtext><mn id="S6.T6.7.m2.1.1.3" xref="S6.T6.7.m2.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S6.T6.7.m2.1c"><apply id="S6.T6.7.m2.1.1.cmml" xref="S6.T6.7.m2.1.1"><csymbol cd="ambiguous" id="S6.T6.7.m2.1.1.1.cmml" xref="S6.T6.7.m2.1.1">subscript</csymbol><ci id="S6.T6.7.m2.1.1.2a.cmml" xref="S6.T6.7.m2.1.1.2"><mtext id="S6.T6.7.m2.1.1.2.cmml" xref="S6.T6.7.m2.1.1.2">BERT</mtext></ci><cn id="S6.T6.7.m2.1.1.3.cmml" type="integer" xref="S6.T6.7.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.7.m2.1d">\text{BERT}_{6}</annotation><annotation encoding="application/x-llamapun" id="S6.T6.7.m2.1e">BERT start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math> as teacher and student model, respectively. Both <math alttext="\text{BERT}_{6}" class="ltx_Math" display="inline" id="S6.T6.8.m3.1"><semantics id="S6.T6.8.m3.1b"><msub id="S6.T6.8.m3.1.1" xref="S6.T6.8.m3.1.1.cmml"><mtext id="S6.T6.8.m3.1.1.2" xref="S6.T6.8.m3.1.1.2a.cmml">BERT</mtext><mn id="S6.T6.8.m3.1.1.3" xref="S6.T6.8.m3.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S6.T6.8.m3.1c"><apply id="S6.T6.8.m3.1.1.cmml" xref="S6.T6.8.m3.1.1"><csymbol cd="ambiguous" id="S6.T6.8.m3.1.1.1.cmml" xref="S6.T6.8.m3.1.1">subscript</csymbol><ci id="S6.T6.8.m3.1.1.2a.cmml" xref="S6.T6.8.m3.1.1.2"><mtext id="S6.T6.8.m3.1.1.2.cmml" xref="S6.T6.8.m3.1.1.2">BERT</mtext></ci><cn id="S6.T6.8.m3.1.1.3.cmml" type="integer" xref="S6.T6.8.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.8.m3.1d">\text{BERT}_{6}</annotation><annotation encoding="application/x-llamapun" id="S6.T6.8.m3.1e">BERT start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math>, a 6-layer smaller variant of BERT, and ‘PD’, a distilled model, are released by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib28" title="">Turc et al.</a></cite>. The results of baselines are imported from  <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib18" title="">Park et al.</a></cite>.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Decoder Distillation</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">While previous feature-based KD methods focused on distilling encoder-only models <cite class="ltx_cite ltx_citemacro_cite">Jiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib9" title="">2020</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib33" title="">2020</a>); Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib19" title="">2021</a>)</cite> and did not discover effective KD settings for the decoder in NMT tasks <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib34" title="">2020</a>)</cite>, A2D distills both the encoder and decoder.</p>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">Our claim regarding the effectiveness of our method on the decoder is supported by the ablation studies presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.T5" title="Table 5 ‣ 6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">5</span></a>. Generally, applying A2D to both the encoder and decoder together yielded the best results. In the En <math alttext="\xrightarrow{}" class="ltx_Math" display="inline" id="S6.SS2.p2.1.m1.1"><semantics id="S6.SS2.p2.1.m1.1a"><mover accent="true" id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml"><mo id="S6.SS2.p2.1.m1.1.1.2" stretchy="false" xref="S6.SS2.p2.1.m1.1.1.2.cmml">→</mo><mi id="S6.SS2.p2.1.m1.1.1.1" xref="S6.SS2.p2.1.m1.1.1.1.cmml"></mi></mover><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><apply id="S6.SS2.p2.1.m1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1"><csymbol cd="latexml" id="S6.SS2.p2.1.m1.1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1.1">absent</csymbol><ci id="S6.SS2.p2.1.m1.1.1.2.cmml" xref="S6.SS2.p2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">\xrightarrow{}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.1.m1.1d">start_ARROW start_OVERACCENT end_OVERACCENT → end_ARROW</annotation></semantics></math> Zh direction, there is a slight performance degradation when using integrated encoder and decoder distillation compared to using encoder-only or decoder-only distillation. Nevertheless, our model trained with decoder-only distillation outperforms the one with distillation on both the encoder and decoder, demonstrating its effectiveness on the decoder.</p>
</div>
<div class="ltx_para" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.1">To investigate why A2D is effective on the decoder, we examine the AAM of the decoder, as described in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.F2" title="Figure 2 ‣ 6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>.
From the heatmap, we observe that the connection between heads tends to be sparse at the encoder level, with most values near 0.
Conversely, in the decoder, the connection between heads is more evenly distributed, with values shifting away from 0 and closer to 0.2.
Based on this observation, we believe that our soft, fine-grained connections between teacher-student features led to more successful KD for decoder tasks, as compared to the strict on/off connections proposed in earlier KD studies.
</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Effectiveness on Different Tasks</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">In this study, we assessed our method using NMT to demonstrate its potential beyond tasks solely associated with encoders.
Additionally, we present performance metrics for the A2D method when applied to encoder-only models on natural language understanding benchmarks given that most of the KD in natural language processing research has focused on the encoder-only models and tasks.
Specifically, we applied our method to BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib4" title="">2019</a>)</cite> distillation, benchmarked on the GLUE <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#bib.bib31" title="">2018</a>)</cite> dataset. The comparative results with baselines are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.T6" title="Table 6 ‣ 6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">6</span></a>. For training, we used fine-tuned teacher models for each GLUE task and then applied A2D to the corresponding student model. We experimented with the hyperparameter <math alttext="\lambda" class="ltx_Math" display="inline" id="S6.SS3.p1.1.m1.1"><semantics id="S6.SS3.p1.1.m1.1a"><mi id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.1b"><ci id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.1.m1.1d">italic_λ</annotation></semantics></math> of Equation (<a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S4.E12" title="12 ‣ 4.2.2 Module Training ‣ 4.2 Attention Alignment Module ‣ 4 Methodology ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">12</span></a>), selecting from the values {0.01, 0.02, 0.05, 0.1}. For all other configurations, we followed BERT’s settings. Notably, our method demonstrated superior performance over encoder-oriented baselines, even without dedicated task-specific hyperparameter tuning.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this paper, we introduce Align-to-Distill, a novel approach to knowledge distillation that enables a detailed alignment of attention heads between teacher and student models. We propose a strategy to overcome the need for heuristic feature mapping in a learnable manner. Our approach shows promising results in decoder distillation, effectively compressing models while preserving translation quality.

</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitations and Future work</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">Although A2D is architecturally flexible without constraints on hidden size or number of attention heads, the teacher and student models must share the same vocabulary. This requirement potentially restricts its broader applicability. Also, while our work demonstrates A2D’s effectiveness on the decoder module in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.01479v3#S6.T5" title="Table 5 ‣ 6.1 Effect of Fine-grained Alignment ‣ 6 Analysis and Discussion ‣ Align-to-Distill: Trainable Attention Alignment for Knowledge Distillation in Neural Machine Translation"><span class="ltx_text ltx_ref_tag">5</span></a>, we have not yet tested A2D on decoder-only models. The scope of this paper primarily focuses on encoder-decoder-based translation models. In future work, we plan to extend A2D’s application to decoder-only models. Moreover, the concept of A2D may encompass a broader range of architectures in future work, as the idea of adaptively aligning features is not restricted to using attention as a feature.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba and Caruana (2014)</span>
<span class="ltx_bibblock">
Jimmy Ba and Rich Caruana. 2014.

</span>
<span class="ltx_bibblock">Do deep nets really need to be deep?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in Neural Information Processing Systems: Annual Conference on Neural Information Processing Systems, (NIPS)</em>, pages 2654–2662.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahdanau et al. (2015)</span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio. 2015.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and translate.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Learning Representations, (ICLR) Conference Track Proceedings</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bucila et al. (2006)</span>
<span class="ltx_bibblock">
Cristian Bucila, Rich Caruana, and Alexandru Niculescu-Mizil. 2006.

</span>
<span class="ltx_bibblock">Model compression.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of International Conference on Knowledge Discovery and Data Mining, (SIGKDD)</em>, pages 535–541.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">BERT: pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, (NAACL-HLT)</em>, pages 4171–4186.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. (2021)</span>
<span class="ltx_bibblock">
Hongyu Gong, Yun Tang, Juan Pino, and Xian Li. 2021.

</span>
<span class="ltx_bibblock">Pay better attention to attention: Head selection in multilingual and multi-domain sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>, 34:2668–2681.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gou et al. (2021)</span>
<span class="ltx_bibblock">
Jianping Gou, Baosheng Yu, Stephen J. Maybank, and Dacheng Tao. 2021.

</span>
<span class="ltx_bibblock">Knowledge distillation: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Int. J. Comput. Vis.</em>, 129(6):1789–1819.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2017)</span>
<span class="ltx_bibblock">
Jiatao Gu, Graham Neubig, Kyunghyun Cho, and Victor O.K. Li. 2017.

</span>
<span class="ltx_bibblock">Learning to translate in real-time with neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 15th Conference of the European Chapter of the Association for Computational Linguistics: Volume 1, Long Papers</em>, pages 1053–1062. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton et al. (2015)</span>
<span class="ltx_bibblock">
Geoffrey E. Hinton, Oriol Vinyals, and Jeffrey Dean. 2015.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">CoRR</em>, abs/1503.02531.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiao et al. (2020)</span>
<span class="ltx_bibblock">
Xiaoqi Jiao, Yichun Yin, Lifeng Shang, Xin Jiang, Xiao Chen, Linlin Li, Fang Wang, and Qun Liu. 2020.

</span>
<span class="ltx_bibblock">Tinybert: Distilling BERT for natural language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Findings of the Association for Computational Linguistics: (EMNLP)</em>, pages 4163–4174.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joyce (2011)</span>
<span class="ltx_bibblock">
James M Joyce. 2011.

</span>
<span class="ltx_bibblock">Kullback-leibler divergence.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">International encyclopedia of statistical science</em>, pages 720–722. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kasai et al. (2020)</span>
<span class="ltx_bibblock">
Jungo Kasai, Nikolaos Pappas, Hao Peng, James Cross, and Noah A. Smith. 2020.

</span>
<span class="ltx_bibblock">Deep encoder, shallow decoder: Reevaluating non-autoregressive machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim and Rush (2016)</span>
<span class="ltx_bibblock">
Yoon Kim and Alexander M. Rush. 2016.

</span>
<span class="ltx_bibblock">Sequence-level knowledge distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing</em>, pages 1317–1327. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kudo and Richardson (2018)</span>
<span class="ltx_bibblock">
Taku Kudo and John Richardson. 2018.

</span>
<span class="ltx_bibblock">Sentencepiece: A simple and language independent subword tokenizer and detokenizer for neural text processing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing, (EMNLP)</em>, pages 66–71.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed, Omer Levy, Veselin Stoyanov, and Luke Zettlemoyer. 2020.

</span>
<span class="ltx_bibblock">BART: denoising sequence-to-sequence pre-training for natural language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, (ACL)</em>, pages 7871–7880.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Lei Li, Yankai Lin, Shuhuai Ren, Peng Li, Jie Zhou, and Xu Sun. 2021.

</span>
<span class="ltx_bibblock">Dynamic knowledge distillation for pre-trained language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing, EMNLP</em>, pages 379–389.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2019)</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. 2019.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized BERT pretraining approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">CoRR</em>, abs/1907.11692.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mobahi et al. (2020)</span>
<span class="ltx_bibblock">
Hossein Mobahi, Mehrdad Farajtabar, and Peter L. Bartlett. 2020.

</span>
<span class="ltx_bibblock">Self-distillation amplifies regularization in hilbert space.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. (2021)</span>
<span class="ltx_bibblock">
Geondo Park, Gyeongman Kim, and Eunho Yang. 2021.

</span>
<span class="ltx_bibblock">Distilling linguistic context for language model compression.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 364–378. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Passban et al. (2021)</span>
<span class="ltx_bibblock">
Peyman Passban, Yimeng Wu, Mehdi Rezagholizadeh, and Qun Liu. 2021.

</span>
<span class="ltx_bibblock">ALP-KD: attention-based layer projection for knowledge distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Conference on Innovative Applications of Artificial Intelligence, (IAAI), The Symposium on Educational Advances in Artificial Intelligence, (EAAI)</em>, pages 13657–13665.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Post (2018)</span>
<span class="ltx_bibblock">
Matt Post. 2018.

</span>
<span class="ltx_bibblock">A call for clarity in reporting BLEU scores.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the Third Conference on Machine Translation: Research Papers</em>, pages 186–191. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Romero et al. (2015)</span>
<span class="ltx_bibblock">
Adriana Romero, Nicolas Ballas, Samira Ebrahimi Kahou, Antoine Chassang, Carlo Gatta, and Yoshua Bengio. 2015.

</span>
<span class="ltx_bibblock">Fitnets: Hints for thin deep nets.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Conference on Learning Representations, (ICLR)</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al. (2019)</span>
<span class="ltx_bibblock">
Victor Sanh, Lysandre Debut, Julien Chaumond, and Thomas Wolf. 2019.

</span>
<span class="ltx_bibblock">Distilbert, a distilled version of BERT: smaller, faster, cheaper and lighter.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">CoRR</em>, abs/1910.01108.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et al. (2016)</span>
<span class="ltx_bibblock">
Rico Sennrich, Barry Haddow, and Alexandra Birch. 2016.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics, (ACL)</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shleifer and Rush (2020)</span>
<span class="ltx_bibblock">
Sam Shleifer and Alexander M. Rush. 2020.

</span>
<span class="ltx_bibblock">Pre-trained summarization distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">CoRR</em>, abs/2010.13002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Siqi Sun, Yu Cheng, Zhe Gan, and Jingjing Liu. 2019.

</span>
<span class="ltx_bibblock">Patient knowledge distillation for BERT model compression.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing and the International Joint Conference on Natural Language Processing, (EMNLP-IJCNLP)</em>, pages 4322–4331.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2020)</span>
<span class="ltx_bibblock">
Zhiqing Sun, Hongkun Yu, Xiaodan Song, Renjie Liu, Yiming Yang, and Denny Zhou. 2020.

</span>
<span class="ltx_bibblock">Mobilebert: a compact task-agnostic BERT for resource-limited devices.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics, (ACL)</em>, pages 2158–2170.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutskever et al. (2014)</span>
<span class="ltx_bibblock">
Ilya Sutskever, Oriol Vinyals, and Quoc V. Le. 2014.

</span>
<span class="ltx_bibblock">Sequence to sequence learning with neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in Neural Information Processing Systems: Annual Conference on Neural Information Processing Systems, (NIPS)</em>, pages 3104–3112.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Turc et al. (2019)</span>
<span class="ltx_bibblock">
Iulia Turc, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">Well-read students learn better: On the importance of pre-training compact models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv: Computation and Language</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems: Annual Conference on Neural Information Processing Systems, (NIPS)</em>, pages 5998–6008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Voita et al. (2019)</span>
<span class="ltx_bibblock">
Elena Voita, David Talbot, Fedor Moiseev, Rico Sennrich, and Ivan Titov. 2019.

</span>
<span class="ltx_bibblock">Analyzing multi-head self-attention: Specialized heads do the heavy lifting, the rest can be pruned.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics</em>, pages 5797–5808. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Alex Wang, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel Bowman. 2018.

</span>
<span class="ltx_bibblock">GLUE: A multi-task benchmark and analysis platform for natural language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 2018 EMNLP Workshop BlackboxNLP: Analyzing and Interpreting Neural Networks for NLP</em>, pages 353–355. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Fusheng Wang, Jianhao Yan, Fandong Meng, and Jie Zhou. 2021.

</span>
<span class="ltx_bibblock">Selective knowledge distillation for neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics and the International Joint Conference on Natural Language Processing, (ACL/IJCNLP)</em>, pages 6456–6466.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Wenhui Wang, Furu Wei, Li Dong, Hangbo Bao, Nan Yang, and Ming Zhou. 2020.

</span>
<span class="ltx_bibblock">Minilm: Deep self-attention distillation for task-agnostic compression of pre-trained transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems: Annual Conference on Neural Information Processing Systems, (NeurIPS)</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2020)</span>
<span class="ltx_bibblock">
Yimeng Wu, Peyman Passban, Mehdi Rezagholizadeh, and Qun Liu. 2020.

</span>
<span class="ltx_bibblock">Why skip if you can combine: A simple knowledge distillation technique for intermediate layers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing, (EMNLP)</em>, pages 1016–1021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2020)</span>
<span class="ltx_bibblock">
Li Yuan, Francis E. H. Tay, Guilin Li, Tao Wang, and Jiashi Feng. 2020.

</span>
<span class="ltx_bibblock">Revisiting knowledge distillation via label smoothing regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2020, Seattle, WA, USA, June 13-19, 2020</em>, pages 3902–3910. Computer Vision Foundation / IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zagoruyko and Komodakis (2017)</span>
<span class="ltx_bibblock">
Sergey Zagoruyko and Nikos Komodakis. 2017.

</span>
<span class="ltx_bibblock">Paying more attention to attention: Improving the performance of convolutional neural networks via attention transfer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">International Conference on Learning Representations, (ICLR)</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022)</span>
<span class="ltx_bibblock">
Jiawei Zhou, Jason Eisner, Michael Newman, Emmanouil Antonios Platanios, and Sam Thomson. 2022.

</span>
<span class="ltx_bibblock">Online semantic parsing for latency reduction in task-oriented dialogue.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 1554–1576. Association for Computational Linguistics.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Mar 25 08:46:25 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
