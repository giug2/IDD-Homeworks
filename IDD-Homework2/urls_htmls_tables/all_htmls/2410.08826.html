<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes</title>
<!--Generated on Fri Oct 11 13:57:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.08826v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S1" title="In Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2" title="In Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methods: the virtual colouring pipeline</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS1" title="In 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Motivating the pipeline architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS2" title="In 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Preparing the synthetic dataset - part I: spectra</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS2.SSS1" title="In 2.2 Preparing the synthetic dataset - part I: spectra ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>The spectra dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS3" title="In 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Training the Deep Embedding Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS4" title="In 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Preparing the synthetic dataset - part II: embedded MA-XRF images</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS5" title="In 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Training the virtual recolouring model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS5.SSS1" title="In 2.5 Training the virtual recolouring model ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5.1 </span>A note on colour distance and training loss: sRGB</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3" title="In Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Results: from MA-XRF to RGB</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.SS1" title="In 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Application on some test set cases</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S4" title="In Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Conclusions</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S4.SS1" title="In 4 Conclusions ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Next steps</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S5" title="In Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Code and Data Availability</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alessandro Bombini<span class="ltx_ERROR undefined" id="id9.9.id1">\orcidlink</span>0000-0001-7225-3355<sup class="ltx_sup" id="id10.10.id2"><span class="ltx_text ltx_font_italic" id="id10.10.id2.1">1,2</span></sup>, Fernando García-Avello Bofías<span class="ltx_ERROR undefined" id="id11.11.id3">\orcidlink</span>0000-0001-6640-8736<sup class="ltx_sup" id="id12.12.id4"><span class="ltx_text ltx_font_italic" id="id12.12.id4.1">1</span></sup>, Francesca Giambi<sup class="ltx_sup" id="id13.13.id5"><span class="ltx_text ltx_font_italic" id="id13.13.id5.1">3</span></sup><span class="ltx_ERROR undefined" id="id14.14.id6">\orcidlink</span>0000-0001-6446-7185, Chiara Ruberto<span class="ltx_ERROR undefined" id="id15.15.id7">\orcidlink</span>0000-0003-0321-7160<sup class="ltx_sup" id="id16.16.id8"><span class="ltx_text ltx_font_italic" id="id16.16.id8.1">1,4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_address"><sup class="ltx_sup" id="id17.17.id1"><span class="ltx_text ltx_font_italic" id="id17.17.id1.1">1</span></sup> Istituto Nazionale di Fisica Nucleare (INFN), Via Bruno Rossi 1, 50019 Sesto Fiorentino (FI), Italy
</span>
<span class="ltx_contact ltx_role_address"><sup class="ltx_sup" id="id18.18.id1"><span class="ltx_text ltx_font_italic" id="id18.18.id1.1">2</span></sup> ICSC - Centro Nazionale di Ricerca in High Performance Computing, Big Data &amp; Quantum Computing, Via Magnanelli 2, 40033 Casalecchio di Reno (BO), Italy
</span>
<span class="ltx_contact ltx_role_address"><sup class="ltx_sup" id="id19.19.id1"><span class="ltx_text ltx_font_italic" id="id19.19.id1.1">3</span></sup> Università degli Studi di Firenze, P.za di San Marco 4, 50121 Firenze (FI), Italy
</span>
<span class="ltx_contact ltx_role_address"><sup class="ltx_sup" id="id20.20.id1"><span class="ltx_text ltx_font_italic" id="id20.20.id1.1">4</span></sup> Dipartimento di Fisica, Università degli Studi di Firenze, Via Giovanni Sansone 1, 50019 Sesto Fiorentino (FI), Italy
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:bombini@fi.infn.it">bombini@fi.infn.it</a>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id21.id1">In this contribution, we define (and test) a pipeline to perform virtual painting recolouring using raw data of X-Ray Fluorescence (XRF) analysis on pictorial artworks. To circumvent the small dataset size, we generate a synthetic dataset, starting from a database of XRF spectra; furthermore, to ensure a better generalisation capacity (and to tackle the issue of in-memory size and inference time), we define a Deep Variational Embedding network to embed the XRF spectra into a lower dimensional, K-Means friendly, metric space.
We thus train a set of models to assign coloured images to embedded XRF images. We report here the devised pipeline performances in terms of visual quality metrics, and we close on a discussion on the results.</p>
</div>
<div class="ltx_para" id="p1">
<ul class="ltx_itemize" id="S0.I1">
<li class="ltx_item" id="S0.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="S0.I1.ix1.p1">
<p class="ltx_p" id="S0.I1.ix1.p1.1">October 11, 2024</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="p2">
<p class="ltx_p" id="p2.4"><span class="ltx_text ltx_font_italic" id="p2.4.1">Keywords</span>: Computer Vision and Cultural Heritage <math alttext="\cdot" class="ltx_Math" display="inline" id="p2.1.m1.1"><semantics id="p2.1.m1.1a"><mo id="p2.1.m1.1.1" xref="p2.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p2.1.m1.1b"><ci id="p2.1.m1.1.1.cmml" xref="p2.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p2.1.m1.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p2.1.m1.1d">⋅</annotation></semantics></math> Vision Transformers <math alttext="\cdot" class="ltx_Math" display="inline" id="p2.2.m2.1"><semantics id="p2.2.m2.1a"><mo id="p2.2.m2.1.1" xref="p2.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p2.2.m2.1b"><ci id="p2.2.m2.1.1.cmml" xref="p2.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p2.2.m2.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p2.2.m2.1d">⋅</annotation></semantics></math> MA-XRF <math alttext="\cdot" class="ltx_Math" display="inline" id="p2.3.m3.1"><semantics id="p2.3.m3.1a"><mo id="p2.3.m3.1.1" xref="p2.3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p2.3.m3.1b"><ci id="p2.3.m3.1.1.cmml" xref="p2.3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p2.3.m3.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p2.3.m3.1d">⋅</annotation></semantics></math> Heritage Science <math alttext="\cdot" class="ltx_Math" display="inline" id="p2.4.m4.1"><semantics id="p2.4.m4.1a"><mo id="p2.4.m4.1.1" xref="p2.4.m4.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p2.4.m4.1b"><ci id="p2.4.m4.1.1.cmml" xref="p2.4.m4.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p2.4.m4.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p2.4.m4.1d">⋅</annotation></semantics></math> Computer Vision</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The rise of Artificial Intelligence in the last decade had a tremendous impact on all academic fields. Statistical and deep learning methods have been ubiquitously employed to help researchers in their tasks, from the easier ones to the most complex ones. Yet, in many fields, there is still room to find suitable applications of such technologies.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In the field of nuclear physics for Cultural Heritage analysis and imaging (for a non-exhaustive list of relevant reviews to the subject, see, e.g. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib8" title="">8</a>]</cite> and references therein), the use of deep learning methods has begun and is spreading; for example, deep learning can be used to help researcher analyse data from non-destructive testing techniques, such as neutron imaging, gamma-ray spectroscopy, and/or X-ray based imaging techniques. These algorithms can help to identify patterns and correlations in the
data, providing valuable insights into the artwork’s composition, age, and condition <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib18" title="">18</a>]</cite> (for other Machine Learning approaches in Cultural Heritage, see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib19" title="">19</a>]</cite>, and references therein).</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">A relevant technique in the field of nuclear technologies applied to Cultural Heritage is X-Ray Fluorescence (XRF) spectrometry, especially in its Macro mapping version (MA-XRF). The XRF technique is employed in Cultural Heritage applications, since no sample pretreatment is required. Furthermore, XRF allows for non-invasive, non-destructive measurements, which is crucial in maintaining the integrity of the sample and the repeatably of the measurements (see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib3" title="">3</a>]</cite>, and references therein).</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In Macro X-Ray Fluorescence mapping (MA-XRF), the imaging apparatus produces a data cube of a scanned area of an artwork; each datacube pixel is formed by a spectrum containing fluorescence lines associated with the element composition of the pigment present in the pictorial layers. From there, it is possible to extract elemental distribution maps of the scanned area of the artwork, proving to be extremely useful for material characterisation, and also for understanding an artist’s painting and production techniques <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib20" title="">20</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">One possible application of Computer Vision techniques on data obtained form such techniques is <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">virtual colouring</span>, <em class="ltx_emph ltx_font_italic" id="S1.p5.1.2">i.e</em>.<span class="ltx_text" id="S1.p5.1.3"></span> the extraction of a RGB image out of a MA-XRF data cube of a pictorial artwork analysis. This task may be relevant in conservation science, since techniques such as MA-XRF are capable of detecting spectral signal (thus containing elemental information on pictorial pigments) even from degraded surfaces (either paintings or frescoes) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib8" title="">8</a>]</cite>, and also to study a series of subsurface features such as over-painted compositions, pentimenti, covered paint losses, retouching and other physical changes<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib26" title="">26</a>]</cite>. Thus, such pipeline may assist conservation scientist and heritage science experts in the interpretation of the MA-XRF data, granting an additional visual feedback (<em class="ltx_emph ltx_font_italic" id="S1.p5.1.4">i.e</em>.<span class="ltx_text" id="S1.p5.1.5"></span>, the reconstructed RGB image).</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Unfortunately, the availability of quality dataset for many of the learning task is usually hampered by various causes, such as slow data creation due to intrinsic apparatus speed limits, legal/Intellectual Property strict limits, difficulties in accessing study objects, limited availability and high cost of experimental apparatus, the necessity of high skilled and qualified personnel to use it, etc. Furthermore, data standardisation is far from the usual in other fields, due to the different, custom nature of the various measuring apparatus, as well as different measurement conditions, different detectors, etc.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">To tackle this issue, we define a pipeline to be applied use case by use case, capable of working without huge dataset. To do so, we resort to synthetic MA-XRF data generation, starting from a tabulated database of pigments’ XRF signal, and Deep Variational Embedding, to (a) reduce the disk size of the generated synthetic dataset, and (b) to extract relevant features and reduce the role of different measuring apparatus, conditions, and environmental impacts. Afterwards, we train a Vision Transformer to map synthetic, embedded MA-XRF maps to RGB images.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">This study is the first step towards the applicability of such pipeline in real-case scenario, where a domain adaptation learning technique will be added to apply, in an almost self-supervising manner, the whole pipeline to a real MA-XRF image obtained from an analysis conducted on a use case.</p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">In <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2" title="2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">2</span></a> we describe the building blocks of the aforementioned virtual recolouring pipeline; in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3" title="3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">3</span></a> we report the results of the training, and the inference of the pipeline on the test set. We close with <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S4" title="4 Conclusions ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">4</span></a> with a discussion. Finally, in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S5" title="5 Code and Data Availability ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">5</span></a> we report the link to the git repository containing the code used to produce the results presented in this contribution.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods: the virtual colouring pipeline</h2>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="458" id="S2.F1.g1" src="x1.png" width="813"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Visual Abstract of the pipeline devised in this Paper. The flow is described in the main text, and it comprises 4 steps: Synthetic Data Generation of spectral signal (in the red region in the figure); a trained Deep Embedding model (in the blue region); an embedded synthetic dataset of embedded MA-XRF images (in the yellow region), and finally a computer vision model to perform virtual recoloring. </figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section we describe the pipeline architecture design and implementation. The goal of the whole process is to assign a coloured image to a MA-XRF map, obtained using the movable apparatus developed at the INFN-CHNet node facility in Florence, LABEC (Laboratorio di tecniche nucleari per l’Ambiente e i BEni Culturali)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib8" title="">8</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">The pipeline relies on the following steps:</p>
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1">Generate a synthetic dataset of Spectral signal;</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1">train a Deep Embedding model to map spectra into lower dimensional metric space;</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1">Starting from RGB images, build a synthetic dataset of embedded MA-XRF images using the python package <span class="ltx_text ltx_font_smallcaps" id="S2.I1.i3.p1.1.1">ganX</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib30" title="">30</a>]</cite><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Either by creating full-fledged MA-XRF images and then embed them in the low dimensional latent space using the Deep Embedding model, or generate them directly in latent space.</span></span></span>;</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.1">Train a Computer Vision model to assign RGB images to (embedded) MA-XRF images.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S2.p2.2">This pipeline is visually reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.F1" title="In 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Motivating the pipeline architecture</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">X-ray Fluorescence (XRF) is a non-invasive, non-destructive analytical technique widely used in the study of cultural heritage, and it is well suited for analysis of pictorial artworks (for a nice introduction to the subject, see, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.1.1">e.g</em>.<span class="ltx_text" id="S2.SS1.p1.1.2"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib8" title="">8</a>]</cite> and references therein).</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">XRF employs X-ray beams emitted by radiogenic tube to excite atoms within the material composing the study object. As a result of the matter-radiation interaction, these atoms emit characteristic X-ray fluorescence radiation, which is collected in appropriate detectors, defining a spectrogram (<em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.1.1">i.e</em>.<span class="ltx_text" id="S2.SS1.p2.1.2"></span>, a histogram of counts in the X-ray range); by looking as such spectrogram, researchers are able to identify the chemical elements present in the material.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Due to material inhomogeneities (always present in the CH study objects), standard single spot XRF analysis may produce false results concerning the chemical composition of the substance under investigation. Thus, it has been developed the XRF macro-mapping imaging technique, known as Macro X-Ray Fluorescence mapping (MA-XRF), with scanning mode acquisition systems. MA-XRF allows to gather data on the sample’s material composition and the distribution of the distinctive components within the scanned area, which allows for the creation of elemental distribution maps <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib20" title="">20</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.4">The MA-XRF raw data can then be arranged into <span class="ltx_text ltx_font_italic" id="S2.SS1.p4.4.1">spectral datacubes</span>, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p4.4.2">i.e</em>.<span class="ltx_text" id="S2.SS1.p4.4.3"></span> a 3-D array <math alttext="I_{x,y;e}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.3"><semantics id="S2.SS1.p4.1.m1.3a"><msub id="S2.SS1.p4.1.m1.3.4" xref="S2.SS1.p4.1.m1.3.4.cmml"><mi id="S2.SS1.p4.1.m1.3.4.2" xref="S2.SS1.p4.1.m1.3.4.2.cmml">I</mi><mrow id="S2.SS1.p4.1.m1.3.3.3.5" xref="S2.SS1.p4.1.m1.3.3.3.4.cmml"><mi id="S2.SS1.p4.1.m1.1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.1.cmml">x</mi><mo id="S2.SS1.p4.1.m1.3.3.3.5.1" xref="S2.SS1.p4.1.m1.3.3.3.4.cmml">,</mo><mi id="S2.SS1.p4.1.m1.2.2.2.2" xref="S2.SS1.p4.1.m1.2.2.2.2.cmml">y</mi><mo id="S2.SS1.p4.1.m1.3.3.3.5.2" xref="S2.SS1.p4.1.m1.3.3.3.4.cmml">;</mo><mi id="S2.SS1.p4.1.m1.3.3.3.3" xref="S2.SS1.p4.1.m1.3.3.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.3b"><apply id="S2.SS1.p4.1.m1.3.4.cmml" xref="S2.SS1.p4.1.m1.3.4"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.3.4.1.cmml" xref="S2.SS1.p4.1.m1.3.4">subscript</csymbol><ci id="S2.SS1.p4.1.m1.3.4.2.cmml" xref="S2.SS1.p4.1.m1.3.4.2">𝐼</ci><list id="S2.SS1.p4.1.m1.3.3.3.4.cmml" xref="S2.SS1.p4.1.m1.3.3.3.5"><ci id="S2.SS1.p4.1.m1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1">𝑥</ci><ci id="S2.SS1.p4.1.m1.2.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.2.2">𝑦</ci><ci id="S2.SS1.p4.1.m1.3.3.3.3.cmml" xref="S2.SS1.p4.1.m1.3.3.3.3">𝑒</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.3c">I_{x,y;e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.3d">italic_I start_POSTSUBSCRIPT italic_x , italic_y ; italic_e end_POSTSUBSCRIPT</annotation></semantics></math>; the first two indeces are the (discretised) pixel positions, while the third index is the discretised energy (in KeV)/wavelength of the emitted fluorescence radiation. These datacubes may be of different sizes, depending on the <math alttext="X-Y" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.1"><semantics id="S2.SS1.p4.2.m2.1a"><mrow id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml"><mi id="S2.SS1.p4.2.m2.1.1.2" xref="S2.SS1.p4.2.m2.1.1.2.cmml">X</mi><mo id="S2.SS1.p4.2.m2.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.cmml">−</mo><mi id="S2.SS1.p4.2.m2.1.1.3" xref="S2.SS1.p4.2.m2.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><apply id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1"><minus id="S2.SS1.p4.2.m2.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1"></minus><ci id="S2.SS1.p4.2.m2.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1.2">𝑋</ci><ci id="S2.SS1.p4.2.m2.1.1.3.cmml" xref="S2.SS1.p4.2.m2.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">X-Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">italic_X - italic_Y</annotation></semantics></math> motors range used in the analysis set up, but usually have a fixed Energy depth, due to the Analog-to-Digital converter (ADC) used<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>For the apparatus employed in this work, the ADC has a 14-bit memory, thus having spectra with <math alttext="2^{14}=16384" class="ltx_Math" display="inline" id="footnote2.m1.1"><semantics id="footnote2.m1.1b"><mrow id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml"><msup id="footnote2.m1.1.1.2" xref="footnote2.m1.1.1.2.cmml"><mn id="footnote2.m1.1.1.2.2" xref="footnote2.m1.1.1.2.2.cmml">2</mn><mn id="footnote2.m1.1.1.2.3" xref="footnote2.m1.1.1.2.3.cmml">14</mn></msup><mo id="footnote2.m1.1.1.1" xref="footnote2.m1.1.1.1.cmml">=</mo><mn id="footnote2.m1.1.1.3" xref="footnote2.m1.1.1.3.cmml">16384</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><apply id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1"><eq id="footnote2.m1.1.1.1.cmml" xref="footnote2.m1.1.1.1"></eq><apply id="footnote2.m1.1.1.2.cmml" xref="footnote2.m1.1.1.2"><csymbol cd="ambiguous" id="footnote2.m1.1.1.2.1.cmml" xref="footnote2.m1.1.1.2">superscript</csymbol><cn id="footnote2.m1.1.1.2.2.cmml" type="integer" xref="footnote2.m1.1.1.2.2">2</cn><cn id="footnote2.m1.1.1.2.3.cmml" type="integer" xref="footnote2.m1.1.1.2.3">14</cn></apply><cn id="footnote2.m1.1.1.3.cmml" type="integer" xref="footnote2.m1.1.1.3">16384</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">2^{14}=16384</annotation><annotation encoding="application/x-llamapun" id="footnote2.m1.1e">2 start_POSTSUPERSCRIPT 14 end_POSTSUPERSCRIPT = 16384</annotation></semantics></math> energy bins.</span></span></span>. Nevertheless, to maintain spectra readability, the number of energy bins cannot be too low, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p4.4.4">i.e</em>.<span class="ltx_text" id="S2.SS1.p4.4.5"></span>, no less that <math alttext="O(500)" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.1"><semantics id="S2.SS1.p4.3.m3.1a"><mrow id="S2.SS1.p4.3.m3.1.2" xref="S2.SS1.p4.3.m3.1.2.cmml"><mi id="S2.SS1.p4.3.m3.1.2.2" xref="S2.SS1.p4.3.m3.1.2.2.cmml">O</mi><mo id="S2.SS1.p4.3.m3.1.2.1" xref="S2.SS1.p4.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p4.3.m3.1.2.3.2" xref="S2.SS1.p4.3.m3.1.2.cmml"><mo id="S2.SS1.p4.3.m3.1.2.3.2.1" stretchy="false" xref="S2.SS1.p4.3.m3.1.2.cmml">(</mo><mn id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">500</mn><mo id="S2.SS1.p4.3.m3.1.2.3.2.2" stretchy="false" xref="S2.SS1.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><apply id="S2.SS1.p4.3.m3.1.2.cmml" xref="S2.SS1.p4.3.m3.1.2"><times id="S2.SS1.p4.3.m3.1.2.1.cmml" xref="S2.SS1.p4.3.m3.1.2.1"></times><ci id="S2.SS1.p4.3.m3.1.2.2.cmml" xref="S2.SS1.p4.3.m3.1.2.2">𝑂</ci><cn id="S2.SS1.p4.3.m3.1.1.cmml" type="integer" xref="S2.SS1.p4.3.m3.1.1">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">O(500)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.1d">italic_O ( 500 )</annotation></semantics></math> bins; this means that <span class="ltx_text ltx_font_italic" id="S2.SS1.p4.4.6">each</span> MA-XRF image<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Here and in the following we use MA-XRF image and MA-XRF datacube as synonyms. The images obtained from the datacube by integrating the spectral signal in a certain energy interval are called <span class="ltx_text ltx_font_italic" id="footnote3.1">elemental maps</span>.</span></span></span> has a large disk occupation size (approximately, each MA-XRF image, once rebinned to, let us say, 512 bins, has a size which is <math alttext="512/3\sim 170" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m4.1"><semantics id="S2.SS1.p4.4.m4.1a"><mrow id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml"><mrow id="S2.SS1.p4.4.m4.1.1.2" xref="S2.SS1.p4.4.m4.1.1.2.cmml"><mn id="S2.SS1.p4.4.m4.1.1.2.2" xref="S2.SS1.p4.4.m4.1.1.2.2.cmml">512</mn><mo id="S2.SS1.p4.4.m4.1.1.2.1" xref="S2.SS1.p4.4.m4.1.1.2.1.cmml">/</mo><mn id="S2.SS1.p4.4.m4.1.1.2.3" xref="S2.SS1.p4.4.m4.1.1.2.3.cmml">3</mn></mrow><mo id="S2.SS1.p4.4.m4.1.1.1" xref="S2.SS1.p4.4.m4.1.1.1.cmml">∼</mo><mn id="S2.SS1.p4.4.m4.1.1.3" xref="S2.SS1.p4.4.m4.1.1.3.cmml">170</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><apply id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1"><csymbol cd="latexml" id="S2.SS1.p4.4.m4.1.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1.1">similar-to</csymbol><apply id="S2.SS1.p4.4.m4.1.1.2.cmml" xref="S2.SS1.p4.4.m4.1.1.2"><divide id="S2.SS1.p4.4.m4.1.1.2.1.cmml" xref="S2.SS1.p4.4.m4.1.1.2.1"></divide><cn id="S2.SS1.p4.4.m4.1.1.2.2.cmml" type="integer" xref="S2.SS1.p4.4.m4.1.1.2.2">512</cn><cn id="S2.SS1.p4.4.m4.1.1.2.3.cmml" type="integer" xref="S2.SS1.p4.4.m4.1.1.2.3">3</cn></apply><cn id="S2.SS1.p4.4.m4.1.1.3.cmml" type="integer" xref="S2.SS1.p4.4.m4.1.1.3">170</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">512/3\sim 170</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m4.1d">512 / 3 ∼ 170</annotation></semantics></math> times <span class="ltx_text ltx_font_italic" id="S2.SS1.p4.4.7">bigger</span> than an RGB image of the same height and width).</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.1">Furthermore, due to instrumental limitations, copyright and data management issues, as well as study objects availability, it is almost impossible to have a dataset of standardised MA-XRF images whose size is really suited for Deep Learning applications.</p>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.1">Additionally, the obtained spectra posses a set of features which are not related to the analysed object, but on the apparatus <span class="ltx_text ltx_font_italic" id="S2.SS1.p6.1.1">in se</span> (for more information about the physics of the XRF, see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib7" title="">7</a>]</cite>; while, for a more detailed description of difficulties experienced while applying learning techniques on imaging data of Cultural Heritage object, see
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib36" title="">36</a>]</cite>, and references therein).</p>
</div>
<div class="ltx_para" id="S2.SS1.p7">
<p class="ltx_p" id="S2.SS1.p7.1">To address all these issue, we resort to</p>
<ul class="ltx_itemize" id="S2.I2">
<li class="ltx_item" id="S2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I2.i1.p1">
<p class="ltx_p" id="S2.I2.i1.p1.1">Synthetic dataset generation;</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I2.i2.p1">
<p class="ltx_p" id="S2.I2.i2.p1.1">Deep Embedding in a low dimensional metric feature space;</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S2.SS1.p7.2">The deep embedding is useful either to extract relevant, apparatus-independent features of the material/pigment composition of the target object, and to reduce the in-memory size of MA-XRF images.</p>
</div>
<div class="ltx_para" id="S2.SS1.p8">
<p class="ltx_p" id="S2.SS1.p8.1">Furthermore, it is possible to add an <span class="ltx_text ltx_font_italic" id="S2.SS1.p8.1.1">unsupervised</span>, <span class="ltx_text ltx_font_italic" id="S2.SS1.p8.1.2">domain adaptation</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib37" title="">37</a>]</cite> step in the Deep Embedding model training, which may help in the inference of the whole recolouring pipeline on <span class="ltx_text ltx_font_italic" id="S2.SS1.p8.1.3">real</span> MA-XRF images.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Preparing the synthetic dataset - part I: spectra</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">To generate a meaningful Spectral Dataset, we started from a database of pigments’ XRF signal <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib38" title="">38</a>]</cite>. We extracted from there a subset of relevant pigments (a <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.1.1">palette</span>), comprising different pigments (Red pigments: Red Ochre, Cinnabar; Blue pigments: Cobalt Blue, Smaltino; Yellow pigments: Gold Ochre, Dark Ochre; Green pigments: Aegirine, Green Earth; Dark pigments: Caput Mortum, Ivory Black, Carbon Black; White pigment: Titanium white). This palette have been chosen due to its similarity with the palette used to create a mock-up, prepared in our laboratory: a replica of an Etruscan
wall painting from IV century BC from the “Tomba della Quadriga Infernale”<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.museoetruscosarteano.it/pagina4.php" title="">http://www.museoetruscosarteano.it/pagina4.php</a>.</span></span></span> in Sarteano (Siena, IT), obtained following the historical buon fresco technique <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib39" title="">39</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">From the aforementioned palette of couples [pigment XRF signal, pigment RGB], we have built a synthetic dataset of approximately <math alttext="312\,000" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mn id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">312 000</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><cn id="S2.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S2.SS2.p2.1.m1.1.1">312000</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">312\,000</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">312 000</annotation></semantics></math> images (we split them into 70% training set, 20% validation set, and 10% test set) using the Python package <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.p2.1.1">ganX</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib30" title="">30</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">As a seed, we have used all the images of Paintings and Frescoes available on wikidata <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib40" title="">40</a>]</cite>, and freely downloadable from there through the wikidata SPARQL query service<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://query.wikidata.org/" title="">https://query.wikidata.org/</a>.</span></span></span>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">The MA-XRF generation system works as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib30" title="">30</a>]</cite>; starting from the aforementioned palette, the data generation algorithm comprises two main parts:</p>
<ol class="ltx_enumerate" id="S2.I3">
<li class="ltx_item" id="S2.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I3.i1.p1">
<p class="ltx_p" id="S2.I3.i1.p1.1">A RGB clustering of the input image(s), performed with an iterative K-Means (<math alttext="\mathrm{IKMeans}" class="ltx_Math" display="inline" id="S2.I3.i1.p1.1.m1.1"><semantics id="S2.I3.i1.p1.1.m1.1a"><mi id="S2.I3.i1.p1.1.m1.1.1" xref="S2.I3.i1.p1.1.m1.1.1.cmml">IKMeans</mi><annotation-xml encoding="MathML-Content" id="S2.I3.i1.p1.1.m1.1b"><ci id="S2.I3.i1.p1.1.m1.1.1.cmml" xref="S2.I3.i1.p1.1.m1.1.1">IKMeans</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I3.i1.p1.1.m1.1c">\mathrm{IKMeans}</annotation><annotation encoding="application/x-llamapun" id="S2.I3.i1.p1.1.m1.1d">roman_IKMeans</annotation></semantics></math>) algorithm, to reduce the colour levels;</p>
</div>
</li>
<li class="ltx_item" id="S2.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I3.i2.p1">
<p class="ltx_p" id="S2.I3.i2.p1.1">A random extraction (Monte Carlo method) to generate a XRF spectra for each pixel, after having unsupervisedly associated a (set of) pigment(s) to each RGB pixel.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.1">To perform step 2., the algorithm computes, pixel-by-pixel, a similarity measure in RGB space (based on the Delta CIEDE 2000 distance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib42" title="">42</a>]</cite>), between the (clustered) RGB and the palette indexed pigments’ characteristic RGB. Furthermore, to (unsupervisedly) reduce the number of pigments for each pixel, an hard thresholding is performed on the similarity values (values below the threshold are set to zero). This process defines, for each pixel, a linear combination of XRF signals, seen as a probability distribution defining the probability that a certain signal is detected by the detector.</p>
</div>
<div class="ltx_para" id="S2.SS2.p6">
<p class="ltx_p" id="S2.SS2.p6.1">The full pseudocode of the MA-XRF data generation is reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#alg1" title="In 2.2 Preparing the synthetic dataset - part I: spectra ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a> (from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib30" title="">30</a>]</cite>).</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Generate MA-XRF</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.2.1.1" style="font-size:70%;">1:</span></span><span class="ltx_text ltx_font_smallcaps" id="alg1.l1.3" style="font-size:70%;">RGBclustering</span><span class="ltx_text" id="alg1.l1.4" style="font-size:70%;">, </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l1.5" style="font-size:70%;">distrToXrf</span><span class="ltx_text" id="alg1.l1.6" style="font-size:70%;">, </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l1.7" style="font-size:70%;">colorSimilarity</span><span class="ltx_text" id="alg1.l1.8" style="font-size:70%;"> </span><span class="ltx_text" id="alg1.l1.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l1.1.m1.1"><semantics id="alg1.l1.1.m1.1a"><mo id="alg1.l1.1.m1.1.1" xref="alg1.l1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l1.1.m1.1b"><ci id="alg1.l1.1.m1.1.1.cmml" xref="alg1.l1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.1.m1.1d">▷</annotation></semantics></math> Import relevant methods
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:70%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2" style="font-size:70%;">procedure</span><span class="ltx_text" id="alg1.l2.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l2.4" style="font-size:70%;">generateXRF</span><span class="ltx_text" id="alg1.l2.5" style="font-size:70%;">(pigments_dict_data = </span><math alttext="\mathcal{D}_{{color},{hist}}" class="ltx_Math" display="inline" id="alg1.l2.m1.2"><semantics id="alg1.l2.m1.2a"><msub id="alg1.l2.m1.2.3" xref="alg1.l2.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.2.3.2" mathsize="70%" xref="alg1.l2.m1.2.3.2.cmml">𝒟</mi><mrow id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.3.cmml"><mrow id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.1.2" mathsize="70%" xref="alg1.l2.m1.1.1.1.1.1.2.cmml">c</mi><mo id="alg1.l2.m1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.1.3" mathsize="70%" xref="alg1.l2.m1.1.1.1.1.1.3.cmml">o</mi><mo id="alg1.l2.m1.1.1.1.1.1.1a" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.1.4" mathsize="70%" xref="alg1.l2.m1.1.1.1.1.1.4.cmml">l</mi><mo id="alg1.l2.m1.1.1.1.1.1.1b" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.1.5" mathsize="70%" xref="alg1.l2.m1.1.1.1.1.1.5.cmml">o</mi><mo id="alg1.l2.m1.1.1.1.1.1.1c" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.1.6" mathsize="70%" xref="alg1.l2.m1.1.1.1.1.1.6.cmml">r</mi></mrow><mo id="alg1.l2.m1.2.2.2.2.3" mathsize="70%" xref="alg1.l2.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l2.m1.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.cmml"><mi id="alg1.l2.m1.2.2.2.2.2.2" mathsize="70%" xref="alg1.l2.m1.2.2.2.2.2.2.cmml">h</mi><mo id="alg1.l2.m1.2.2.2.2.2.1" xref="alg1.l2.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l2.m1.2.2.2.2.2.3" mathsize="70%" xref="alg1.l2.m1.2.2.2.2.2.3.cmml">i</mi><mo id="alg1.l2.m1.2.2.2.2.2.1a" xref="alg1.l2.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l2.m1.2.2.2.2.2.4" mathsize="70%" xref="alg1.l2.m1.2.2.2.2.2.4.cmml">s</mi><mo id="alg1.l2.m1.2.2.2.2.2.1b" xref="alg1.l2.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l2.m1.2.2.2.2.2.5" mathsize="70%" xref="alg1.l2.m1.2.2.2.2.2.5.cmml">t</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.3.cmml" xref="alg1.l2.m1.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.3.1.cmml" xref="alg1.l2.m1.2.3">subscript</csymbol><ci id="alg1.l2.m1.2.3.2.cmml" xref="alg1.l2.m1.2.3.2">𝒟</ci><list id="alg1.l2.m1.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2"><apply id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1"><times id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1"></times><ci id="alg1.l2.m1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.2">𝑐</ci><ci id="alg1.l2.m1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.3">𝑜</ci><ci id="alg1.l2.m1.1.1.1.1.1.4.cmml" xref="alg1.l2.m1.1.1.1.1.1.4">𝑙</ci><ci id="alg1.l2.m1.1.1.1.1.1.5.cmml" xref="alg1.l2.m1.1.1.1.1.1.5">𝑜</ci><ci id="alg1.l2.m1.1.1.1.1.1.6.cmml" xref="alg1.l2.m1.1.1.1.1.1.6">𝑟</ci></apply><apply id="alg1.l2.m1.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2"><times id="alg1.l2.m1.2.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.1"></times><ci id="alg1.l2.m1.2.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2">ℎ</ci><ci id="alg1.l2.m1.2.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.3">𝑖</ci><ci id="alg1.l2.m1.2.2.2.2.2.4.cmml" xref="alg1.l2.m1.2.2.2.2.2.4">𝑠</ci><ci id="alg1.l2.m1.2.2.2.2.2.5.cmml" xref="alg1.l2.m1.2.2.2.2.2.5">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">\mathcal{D}_{{color},{hist}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.2d">caligraphic_D start_POSTSUBSCRIPT italic_c italic_o italic_l italic_o italic_r , italic_h italic_i italic_s italic_t end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l2.6" style="font-size:70%;">, rgb_img = </span><math alttext="R" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" mathsize="70%" xref="alg1.l2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_R</annotation></semantics></math><span class="ltx_text" id="alg1.l2.7" style="font-size:70%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:70%;">3:</span></span><span class="ltx_text" id="alg1.l3.2" style="font-size:70%;">    </span><math alttext="R\leftarrow" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" mathsize="70%" xref="alg1.l3.m1.1.1.2.cmml">R</mi><mo id="alg1.l3.m1.1.1.1" mathsize="70%" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑅</ci><csymbol cd="latexml" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">R\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_R ←</annotation></semantics></math><span class="ltx_text" id="alg1.l3.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l3.4" style="font-size:70%;">RGBclustering</span><span class="ltx_text" id="alg1.l3.5" style="font-size:70%;">(</span><math alttext="R" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" mathsize="70%" xref="alg1.l3.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_R</annotation></semantics></math><span class="ltx_text" id="alg1.l3.6" style="font-size:70%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.2.1.1" style="font-size:70%;">4:</span></span><span class="ltx_text" id="alg1.l4.3" style="font-size:70%;">    init </span><math alttext="X" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" mathsize="70%" xref="alg1.l4.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_X</annotation></semantics></math><span class="ltx_text" id="alg1.l4.4" style="font-size:70%;">; </span><span class="ltx_text" id="alg1.l4.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l4.1.m1.1"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.1d">▷</annotation></semantics></math> Initialise empy XRF data cube
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.2.1.1" style="font-size:70%;">5:</span></span><span class="ltx_text" id="alg1.l5.3" style="font-size:70%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l5.4" style="font-size:70%;">for</span><span class="ltx_text" id="alg1.l5.5" style="font-size:70%;"> </span><math alttext="r\in R" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" mathsize="70%" xref="alg1.l5.m1.1.1.2.cmml">r</mi><mo id="alg1.l5.m1.1.1.1" mathsize="70%" xref="alg1.l5.m1.1.1.1.cmml">∈</mo><mi id="alg1.l5.m1.1.1.3" mathsize="70%" xref="alg1.l5.m1.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><in id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></in><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑟</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">r\in R</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_r ∈ italic_R</annotation></semantics></math><span class="ltx_text" id="alg1.l5.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l5.7" style="font-size:70%;">do</span><span class="ltx_text" id="alg1.l5.8" style="font-size:70%;"> </span><span class="ltx_text" id="alg1.l5.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Iterate over clusters
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.2.1.1" style="font-size:70%;">6:</span></span><span class="ltx_text" id="alg1.l6.3" style="font-size:70%;">       init </span><math alttext="d" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mi id="alg1.l6.m1.1.1" mathsize="70%" xref="alg1.l6.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_d</annotation></semantics></math><span class="ltx_text" id="alg1.l6.4" style="font-size:70%;">; </span><span class="ltx_text" id="alg1.l6.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Initialise empty distribution
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.2.1.1" style="font-size:70%;">7:</span></span><span class="ltx_text" id="alg1.l7.3" style="font-size:70%;">       </span><span class="ltx_text ltx_font_bold" id="alg1.l7.4" style="font-size:70%;">for</span><span class="ltx_text" id="alg1.l7.5" style="font-size:70%;"> </span><math alttext="(c,h)\in\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l7.m1.2"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.3" xref="alg1.l7.m1.2.3.cmml"><mrow id="alg1.l7.m1.2.3.2.2" xref="alg1.l7.m1.2.3.2.1.cmml"><mo id="alg1.l7.m1.2.3.2.2.1" maxsize="70%" minsize="70%" xref="alg1.l7.m1.2.3.2.1.cmml">(</mo><mi id="alg1.l7.m1.1.1" mathsize="70%" xref="alg1.l7.m1.1.1.cmml">c</mi><mo id="alg1.l7.m1.2.3.2.2.2" mathsize="70%" xref="alg1.l7.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l7.m1.2.2" mathsize="70%" xref="alg1.l7.m1.2.2.cmml">h</mi><mo id="alg1.l7.m1.2.3.2.2.3" maxsize="70%" minsize="70%" xref="alg1.l7.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg1.l7.m1.2.3.1" mathsize="70%" xref="alg1.l7.m1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.2.3.3" mathsize="70%" xref="alg1.l7.m1.2.3.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.3.cmml" xref="alg1.l7.m1.2.3"><in id="alg1.l7.m1.2.3.1.cmml" xref="alg1.l7.m1.2.3.1"></in><interval closure="open" id="alg1.l7.m1.2.3.2.1.cmml" xref="alg1.l7.m1.2.3.2.2"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑐</ci><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">ℎ</ci></interval><ci id="alg1.l7.m1.2.3.3.cmml" xref="alg1.l7.m1.2.3.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">(c,h)\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.2d">( italic_c , italic_h ) ∈ caligraphic_D</annotation></semantics></math><span class="ltx_text" id="alg1.l7.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l7.7" style="font-size:70%;">do</span><span class="ltx_text" id="alg1.l7.8" style="font-size:70%;"> </span><span class="ltx_text" id="alg1.l7.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Iterate over database
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:70%;">8:</span></span><span class="ltx_text" id="alg1.l8.2" style="font-size:70%;">          </span><math alttext="\alpha\leftarrow" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" mathsize="70%" xref="alg1.l8.m1.1.1.2.cmml">α</mi><mo id="alg1.l8.m1.1.1.1" mathsize="70%" stretchy="false" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝛼</ci><csymbol cd="latexml" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\alpha\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_α ←</annotation></semantics></math><span class="ltx_text" id="alg1.l8.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l8.4" style="font-size:70%;">colorSimilarity</span><span class="ltx_text" id="alg1.l8.5" style="font-size:70%;">(</span><math alttext="c,r" class="ltx_Math" display="inline" id="alg1.l8.m2.2"><semantics id="alg1.l8.m2.2a"><mrow id="alg1.l8.m2.2.3.2" xref="alg1.l8.m2.2.3.1.cmml"><mi id="alg1.l8.m2.1.1" mathsize="70%" xref="alg1.l8.m2.1.1.cmml">c</mi><mo id="alg1.l8.m2.2.3.2.1" mathsize="70%" xref="alg1.l8.m2.2.3.1.cmml">,</mo><mi id="alg1.l8.m2.2.2" mathsize="70%" xref="alg1.l8.m2.2.2.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.2b"><list id="alg1.l8.m2.2.3.1.cmml" xref="alg1.l8.m2.2.3.2"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝑐</ci><ci id="alg1.l8.m2.2.2.cmml" xref="alg1.l8.m2.2.2">𝑟</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.2c">c,r</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.2d">italic_c , italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l8.6" style="font-size:70%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:70%;">9:</span></span><span class="ltx_text" id="alg1.l9.2" style="font-size:70%;">          </span><span class="ltx_text ltx_font_bold" id="alg1.l9.3" style="font-size:70%;">if</span><span class="ltx_text" id="alg1.l9.4" style="font-size:70%;"> </span><math alttext="\alpha\geq\alpha_{th}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" mathsize="70%" xref="alg1.l9.m1.1.1.2.cmml">α</mi><mo id="alg1.l9.m1.1.1.1" mathsize="70%" xref="alg1.l9.m1.1.1.1.cmml">≥</mo><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" mathsize="70%" xref="alg1.l9.m1.1.1.3.2.cmml">α</mi><mrow id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.2" mathsize="70%" xref="alg1.l9.m1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.3.1" xref="alg1.l9.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.3.3" mathsize="70%" xref="alg1.l9.m1.1.1.3.3.3.cmml">h</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><geq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></geq><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝛼</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝛼</ci><apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"><times id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.1"></times><ci id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2">𝑡</ci><ci id="alg1.l9.m1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\alpha\geq\alpha_{th}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_α ≥ italic_α start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l9.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l9.6" style="font-size:70%;">then</span><span class="ltx_text" id="alg1.l9.7" style="font-size:70%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.2.1.1" style="font-size:70%;">10:</span></span><span class="ltx_text" id="alg1.l10.3" style="font-size:70%;">             </span><math alttext="d\leftarrow d+\alpha\cdot h" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" mathsize="70%" xref="alg1.l10.m1.1.1.2.cmml">d</mi><mo id="alg1.l10.m1.1.1.1" mathsize="70%" stretchy="false" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" mathsize="70%" xref="alg1.l10.m1.1.1.3.2.cmml">d</mi><mo id="alg1.l10.m1.1.1.3.1" mathsize="70%" xref="alg1.l10.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml"><mi id="alg1.l10.m1.1.1.3.3.2" mathsize="70%" xref="alg1.l10.m1.1.1.3.3.2.cmml">α</mi><mo id="alg1.l10.m1.1.1.3.3.1" lspace="0.222em" mathsize="70%" rspace="0.222em" xref="alg1.l10.m1.1.1.3.3.1.cmml">⋅</mo><mi id="alg1.l10.m1.1.1.3.3.3" mathsize="70%" xref="alg1.l10.m1.1.1.3.3.3.cmml">h</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑑</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><plus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></plus><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑑</ci><apply id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"><ci id="alg1.l10.m1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.1">⋅</ci><ci id="alg1.l10.m1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.2">𝛼</ci><ci id="alg1.l10.m1.1.1.3.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">d\leftarrow d+\alpha\cdot h</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_d ← italic_d + italic_α ⋅ italic_h</annotation></semantics></math><span class="ltx_text" id="alg1.l10.4" style="font-size:70%;"> </span><span class="ltx_text" id="alg1.l10.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l10.1.m1.1"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.1.m1.1d">▷</annotation></semantics></math> Sum thresholded distribution
                 </span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.2.1.1" style="font-size:70%;">11:</span></span><span class="ltx_text" id="alg1.l11.3" style="font-size:70%;">       </span><math alttext="d\leftarrow d/||{d}||" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.2" xref="alg1.l11.m1.1.2.cmml"><mi id="alg1.l11.m1.1.2.2" mathsize="70%" xref="alg1.l11.m1.1.2.2.cmml">d</mi><mo id="alg1.l11.m1.1.2.1" mathsize="70%" stretchy="false" xref="alg1.l11.m1.1.2.1.cmml">←</mo><mrow id="alg1.l11.m1.1.2.3" xref="alg1.l11.m1.1.2.3.cmml"><mi id="alg1.l11.m1.1.2.3.2" mathsize="70%" xref="alg1.l11.m1.1.2.3.2.cmml">d</mi><mo id="alg1.l11.m1.1.2.3.1" maxsize="70%" minsize="70%" stretchy="true" symmetric="true" xref="alg1.l11.m1.1.2.3.1.cmml">/</mo><mrow id="alg1.l11.m1.1.2.3.3.2" xref="alg1.l11.m1.1.2.3.3.1.cmml"><mo id="alg1.l11.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l11.m1.1.2.3.3.1.1.cmml">‖</mo><mi id="alg1.l11.m1.1.1" mathsize="70%" xref="alg1.l11.m1.1.1.cmml">d</mi><mo id="alg1.l11.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l11.m1.1.2.3.3.1.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.2.cmml" xref="alg1.l11.m1.1.2"><ci id="alg1.l11.m1.1.2.1.cmml" xref="alg1.l11.m1.1.2.1">←</ci><ci id="alg1.l11.m1.1.2.2.cmml" xref="alg1.l11.m1.1.2.2">𝑑</ci><apply id="alg1.l11.m1.1.2.3.cmml" xref="alg1.l11.m1.1.2.3"><divide id="alg1.l11.m1.1.2.3.1.cmml" xref="alg1.l11.m1.1.2.3.1"></divide><ci id="alg1.l11.m1.1.2.3.2.cmml" xref="alg1.l11.m1.1.2.3.2">𝑑</ci><apply id="alg1.l11.m1.1.2.3.3.1.cmml" xref="alg1.l11.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg1.l11.m1.1.2.3.3.1.1.cmml" xref="alg1.l11.m1.1.2.3.3.2.1">norm</csymbol><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">d\leftarrow d/||{d}||</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_d ← italic_d / | | italic_d | |</annotation></semantics></math><span class="ltx_text" id="alg1.l11.4" style="font-size:70%;"> </span><span class="ltx_text" id="alg1.l11.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l11.1.m1.1"><semantics id="alg1.l11.1.m1.1a"><mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b"><ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.1.m1.1d">▷</annotation></semantics></math> Normalise distribution
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.2.1.1" style="font-size:70%;">12:</span></span><span class="ltx_text" id="alg1.l12.3" style="font-size:70%;">       </span><math alttext="X[\textrm{idx}(X)==r]\leftarrow" class="ltx_math_unparsed" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1b"><mi id="alg1.l12.m1.1.2" mathsize="70%">X</mi><mrow id="alg1.l12.m1.1.3"><mo id="alg1.l12.m1.1.3.1" maxsize="70%" minsize="70%">[</mo><mtext id="alg1.l12.m1.1.3.2" mathsize="70%">idx</mtext><mrow id="alg1.l12.m1.1.3.3"><mo id="alg1.l12.m1.1.3.3.1" maxsize="70%" minsize="70%">(</mo><mi id="alg1.l12.m1.1.1" mathsize="70%">X</mi><mo id="alg1.l12.m1.1.3.3.2" maxsize="70%" minsize="70%">)</mo></mrow><mo id="alg1.l12.m1.1.3.4" mathsize="70%" rspace="0em">=</mo><mo id="alg1.l12.m1.1.3.5" lspace="0em" mathsize="70%">=</mo><mi id="alg1.l12.m1.1.3.6" mathsize="70%">r</mi><mo id="alg1.l12.m1.1.3.7" maxsize="70%" minsize="70%">]</mo></mrow><mo id="alg1.l12.m1.1.4" mathsize="70%" stretchy="false">←</mo></mrow><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">X[\textrm{idx}(X)==r]\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_X [ idx ( italic_X ) = = italic_r ] ←</annotation></semantics></math><span class="ltx_text" id="alg1.l12.4" style="font-size:70%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l12.5" style="font-size:70%;">distrToXrf</span><span class="ltx_text" id="alg1.l12.6" style="font-size:70%;">(</span><math alttext="d" class="ltx_Math" display="inline" id="alg1.l12.m2.1"><semantics id="alg1.l12.m2.1a"><mi id="alg1.l12.m2.1.1" mathsize="70%" xref="alg1.l12.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">italic_d</annotation></semantics></math><span class="ltx_text" id="alg1.l12.7" style="font-size:70%;">) </span><span class="ltx_text" id="alg1.l12.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.1.m1.1d">▷</annotation></semantics></math> Use Monte Carlo method only on the Cluster’s pixel
    </span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:70%;">13:</span></span><span class="ltx_text" id="alg1.l13.2" style="font-size:70%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l13.3" style="font-size:70%;">return</span><span class="ltx_text" id="alg1.l13.4" style="font-size:70%;"> </span><math alttext="X" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mi id="alg1.l13.m1.1.1" mathsize="70%" xref="alg1.l13.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_X</annotation></semantics></math><span class="ltx_text" id="alg1.l13.5" style="font-size:70%;">
</span>
</div>
</div>
</figure>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>The spectra dataset</h4>
<div class="ltx_para" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.1"><span class="ltx_text ltx_phantom" id="S2.SS2.SSS1.p1.1.1"><span style="visibility:hidden">.</span></span></p>
</div>
<div class="ltx_para" id="S2.SS2.SSS1.p2">
<p class="ltx_p" id="S2.SS2.SSS1.p2.1">From the dataset of MA-XRF images we randomly extracted a subset of 5 million spectra (by selecting random pixels spectra). We divided this set with a 70/20/10 % split for Training, Validation and Test, so that we have</p>
<ul class="ltx_itemize" id="S2.I4">
<li class="ltx_item" id="S2.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I4.i1.p1">
<p class="ltx_p" id="S2.I4.i1.p1.1">Train set shape:        <math alttext="[3.5\cdot 10^{6},512]" class="ltx_Math" display="inline" id="S2.I4.i1.p1.1.m1.2"><semantics id="S2.I4.i1.p1.1.m1.2a"><mrow id="S2.I4.i1.p1.1.m1.2.2.1" xref="S2.I4.i1.p1.1.m1.2.2.2.cmml"><mo id="S2.I4.i1.p1.1.m1.2.2.1.2" stretchy="false" xref="S2.I4.i1.p1.1.m1.2.2.2.cmml">[</mo><mrow id="S2.I4.i1.p1.1.m1.2.2.1.1" xref="S2.I4.i1.p1.1.m1.2.2.1.1.cmml"><mn id="S2.I4.i1.p1.1.m1.2.2.1.1.2" xref="S2.I4.i1.p1.1.m1.2.2.1.1.2.cmml">3.5</mn><mo id="S2.I4.i1.p1.1.m1.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.I4.i1.p1.1.m1.2.2.1.1.1.cmml">⋅</mo><msup id="S2.I4.i1.p1.1.m1.2.2.1.1.3" xref="S2.I4.i1.p1.1.m1.2.2.1.1.3.cmml"><mn id="S2.I4.i1.p1.1.m1.2.2.1.1.3.2" xref="S2.I4.i1.p1.1.m1.2.2.1.1.3.2.cmml">10</mn><mn id="S2.I4.i1.p1.1.m1.2.2.1.1.3.3" xref="S2.I4.i1.p1.1.m1.2.2.1.1.3.3.cmml">6</mn></msup></mrow><mo id="S2.I4.i1.p1.1.m1.2.2.1.3" xref="S2.I4.i1.p1.1.m1.2.2.2.cmml">,</mo><mn id="S2.I4.i1.p1.1.m1.1.1" xref="S2.I4.i1.p1.1.m1.1.1.cmml">512</mn><mo id="S2.I4.i1.p1.1.m1.2.2.1.4" stretchy="false" xref="S2.I4.i1.p1.1.m1.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I4.i1.p1.1.m1.2b"><interval closure="closed" id="S2.I4.i1.p1.1.m1.2.2.2.cmml" xref="S2.I4.i1.p1.1.m1.2.2.1"><apply id="S2.I4.i1.p1.1.m1.2.2.1.1.cmml" xref="S2.I4.i1.p1.1.m1.2.2.1.1"><ci id="S2.I4.i1.p1.1.m1.2.2.1.1.1.cmml" xref="S2.I4.i1.p1.1.m1.2.2.1.1.1">⋅</ci><cn id="S2.I4.i1.p1.1.m1.2.2.1.1.2.cmml" type="float" xref="S2.I4.i1.p1.1.m1.2.2.1.1.2">3.5</cn><apply id="S2.I4.i1.p1.1.m1.2.2.1.1.3.cmml" xref="S2.I4.i1.p1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.I4.i1.p1.1.m1.2.2.1.1.3.1.cmml" xref="S2.I4.i1.p1.1.m1.2.2.1.1.3">superscript</csymbol><cn id="S2.I4.i1.p1.1.m1.2.2.1.1.3.2.cmml" type="integer" xref="S2.I4.i1.p1.1.m1.2.2.1.1.3.2">10</cn><cn id="S2.I4.i1.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S2.I4.i1.p1.1.m1.2.2.1.1.3.3">6</cn></apply></apply><cn id="S2.I4.i1.p1.1.m1.1.1.cmml" type="integer" xref="S2.I4.i1.p1.1.m1.1.1">512</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.I4.i1.p1.1.m1.2c">[3.5\cdot 10^{6},512]</annotation><annotation encoding="application/x-llamapun" id="S2.I4.i1.p1.1.m1.2d">[ 3.5 ⋅ 10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT , 512 ]</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S2.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I4.i2.p1">
<p class="ltx_p" id="S2.I4.i2.p1.1">Validation set shape: <math alttext="[1.0\cdot 10^{6},512]" class="ltx_Math" display="inline" id="S2.I4.i2.p1.1.m1.2"><semantics id="S2.I4.i2.p1.1.m1.2a"><mrow id="S2.I4.i2.p1.1.m1.2.2.1" xref="S2.I4.i2.p1.1.m1.2.2.2.cmml"><mo id="S2.I4.i2.p1.1.m1.2.2.1.2" stretchy="false" xref="S2.I4.i2.p1.1.m1.2.2.2.cmml">[</mo><mrow id="S2.I4.i2.p1.1.m1.2.2.1.1" xref="S2.I4.i2.p1.1.m1.2.2.1.1.cmml"><mn id="S2.I4.i2.p1.1.m1.2.2.1.1.2" xref="S2.I4.i2.p1.1.m1.2.2.1.1.2.cmml">1.0</mn><mo id="S2.I4.i2.p1.1.m1.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.I4.i2.p1.1.m1.2.2.1.1.1.cmml">⋅</mo><msup id="S2.I4.i2.p1.1.m1.2.2.1.1.3" xref="S2.I4.i2.p1.1.m1.2.2.1.1.3.cmml"><mn id="S2.I4.i2.p1.1.m1.2.2.1.1.3.2" xref="S2.I4.i2.p1.1.m1.2.2.1.1.3.2.cmml">10</mn><mn id="S2.I4.i2.p1.1.m1.2.2.1.1.3.3" xref="S2.I4.i2.p1.1.m1.2.2.1.1.3.3.cmml">6</mn></msup></mrow><mo id="S2.I4.i2.p1.1.m1.2.2.1.3" xref="S2.I4.i2.p1.1.m1.2.2.2.cmml">,</mo><mn id="S2.I4.i2.p1.1.m1.1.1" xref="S2.I4.i2.p1.1.m1.1.1.cmml">512</mn><mo id="S2.I4.i2.p1.1.m1.2.2.1.4" stretchy="false" xref="S2.I4.i2.p1.1.m1.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I4.i2.p1.1.m1.2b"><interval closure="closed" id="S2.I4.i2.p1.1.m1.2.2.2.cmml" xref="S2.I4.i2.p1.1.m1.2.2.1"><apply id="S2.I4.i2.p1.1.m1.2.2.1.1.cmml" xref="S2.I4.i2.p1.1.m1.2.2.1.1"><ci id="S2.I4.i2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.I4.i2.p1.1.m1.2.2.1.1.1">⋅</ci><cn id="S2.I4.i2.p1.1.m1.2.2.1.1.2.cmml" type="float" xref="S2.I4.i2.p1.1.m1.2.2.1.1.2">1.0</cn><apply id="S2.I4.i2.p1.1.m1.2.2.1.1.3.cmml" xref="S2.I4.i2.p1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.I4.i2.p1.1.m1.2.2.1.1.3.1.cmml" xref="S2.I4.i2.p1.1.m1.2.2.1.1.3">superscript</csymbol><cn id="S2.I4.i2.p1.1.m1.2.2.1.1.3.2.cmml" type="integer" xref="S2.I4.i2.p1.1.m1.2.2.1.1.3.2">10</cn><cn id="S2.I4.i2.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S2.I4.i2.p1.1.m1.2.2.1.1.3.3">6</cn></apply></apply><cn id="S2.I4.i2.p1.1.m1.1.1.cmml" type="integer" xref="S2.I4.i2.p1.1.m1.1.1">512</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.I4.i2.p1.1.m1.2c">[1.0\cdot 10^{6},512]</annotation><annotation encoding="application/x-llamapun" id="S2.I4.i2.p1.1.m1.2d">[ 1.0 ⋅ 10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT , 512 ]</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S2.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I4.i3.p1">
<p class="ltx_p" id="S2.I4.i3.p1.1">Test set shape:          <math alttext="[0.5\cdot 10^{6},512]" class="ltx_Math" display="inline" id="S2.I4.i3.p1.1.m1.2"><semantics id="S2.I4.i3.p1.1.m1.2a"><mrow id="S2.I4.i3.p1.1.m1.2.2.1" xref="S2.I4.i3.p1.1.m1.2.2.2.cmml"><mo id="S2.I4.i3.p1.1.m1.2.2.1.2" stretchy="false" xref="S2.I4.i3.p1.1.m1.2.2.2.cmml">[</mo><mrow id="S2.I4.i3.p1.1.m1.2.2.1.1" xref="S2.I4.i3.p1.1.m1.2.2.1.1.cmml"><mn id="S2.I4.i3.p1.1.m1.2.2.1.1.2" xref="S2.I4.i3.p1.1.m1.2.2.1.1.2.cmml">0.5</mn><mo id="S2.I4.i3.p1.1.m1.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.I4.i3.p1.1.m1.2.2.1.1.1.cmml">⋅</mo><msup id="S2.I4.i3.p1.1.m1.2.2.1.1.3" xref="S2.I4.i3.p1.1.m1.2.2.1.1.3.cmml"><mn id="S2.I4.i3.p1.1.m1.2.2.1.1.3.2" xref="S2.I4.i3.p1.1.m1.2.2.1.1.3.2.cmml">10</mn><mn id="S2.I4.i3.p1.1.m1.2.2.1.1.3.3" xref="S2.I4.i3.p1.1.m1.2.2.1.1.3.3.cmml">6</mn></msup></mrow><mo id="S2.I4.i3.p1.1.m1.2.2.1.3" xref="S2.I4.i3.p1.1.m1.2.2.2.cmml">,</mo><mn id="S2.I4.i3.p1.1.m1.1.1" xref="S2.I4.i3.p1.1.m1.1.1.cmml">512</mn><mo id="S2.I4.i3.p1.1.m1.2.2.1.4" stretchy="false" xref="S2.I4.i3.p1.1.m1.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I4.i3.p1.1.m1.2b"><interval closure="closed" id="S2.I4.i3.p1.1.m1.2.2.2.cmml" xref="S2.I4.i3.p1.1.m1.2.2.1"><apply id="S2.I4.i3.p1.1.m1.2.2.1.1.cmml" xref="S2.I4.i3.p1.1.m1.2.2.1.1"><ci id="S2.I4.i3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.I4.i3.p1.1.m1.2.2.1.1.1">⋅</ci><cn id="S2.I4.i3.p1.1.m1.2.2.1.1.2.cmml" type="float" xref="S2.I4.i3.p1.1.m1.2.2.1.1.2">0.5</cn><apply id="S2.I4.i3.p1.1.m1.2.2.1.1.3.cmml" xref="S2.I4.i3.p1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.I4.i3.p1.1.m1.2.2.1.1.3.1.cmml" xref="S2.I4.i3.p1.1.m1.2.2.1.1.3">superscript</csymbol><cn id="S2.I4.i3.p1.1.m1.2.2.1.1.3.2.cmml" type="integer" xref="S2.I4.i3.p1.1.m1.2.2.1.1.3.2">10</cn><cn id="S2.I4.i3.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S2.I4.i3.p1.1.m1.2.2.1.1.3.3">6</cn></apply></apply><cn id="S2.I4.i3.p1.1.m1.1.1.cmml" type="integer" xref="S2.I4.i3.p1.1.m1.1.1">512</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.I4.i3.p1.1.m1.2c">[0.5\cdot 10^{6},512]</annotation><annotation encoding="application/x-llamapun" id="S2.I4.i3.p1.1.m1.2d">[ 0.5 ⋅ 10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT , 512 ]</annotation></semantics></math></p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Training the Deep Embedding Model</h3>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="325" id="S2.F2.g1" src="x2.png" width="788"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Visual representation of the Deep Variational Embedding model</figcaption>
</figure>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.5">The idea of this part of the pipeline is to train a Deep Variational Embedding model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib52" title="">52</a>]</cite> to dimensionally reduce the signal via relevant feature extraction; The whole process is self-supervised, since only spectra are used during training. The whole architecture comprises:</p>
<ol class="ltx_enumerate" id="S2.I5">
<li class="ltx_item" id="S2.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I5.i1.p1">
<p class="ltx_p" id="S2.I5.i1.p1.2">An Encoder <math alttext="\mathrm{Enc}:X\in\mathcal{M}\subseteq\mathbb{R}^{d=512}\mapsto\mu\in\mathcal{N%
}\subseteq\mathbb{R}^{n\ll 512}" class="ltx_Math" display="inline" id="S2.I5.i1.p1.1.m1.1"><semantics id="S2.I5.i1.p1.1.m1.1a"><mrow id="S2.I5.i1.p1.1.m1.1.1" xref="S2.I5.i1.p1.1.m1.1.1.cmml"><mi id="S2.I5.i1.p1.1.m1.1.1.2" xref="S2.I5.i1.p1.1.m1.1.1.2.cmml">Enc</mi><mo id="S2.I5.i1.p1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.I5.i1.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S2.I5.i1.p1.1.m1.1.1.3" xref="S2.I5.i1.p1.1.m1.1.1.3.cmml"><mi id="S2.I5.i1.p1.1.m1.1.1.3.2" xref="S2.I5.i1.p1.1.m1.1.1.3.2.cmml">X</mi><mo id="S2.I5.i1.p1.1.m1.1.1.3.3" xref="S2.I5.i1.p1.1.m1.1.1.3.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I5.i1.p1.1.m1.1.1.3.4" xref="S2.I5.i1.p1.1.m1.1.1.3.4.cmml">ℳ</mi><mo id="S2.I5.i1.p1.1.m1.1.1.3.5" xref="S2.I5.i1.p1.1.m1.1.1.3.5.cmml">⊆</mo><msup id="S2.I5.i1.p1.1.m1.1.1.3.6" xref="S2.I5.i1.p1.1.m1.1.1.3.6.cmml"><mi id="S2.I5.i1.p1.1.m1.1.1.3.6.2" mathvariant="normal" xref="S2.I5.i1.p1.1.m1.1.1.3.6.2.cmml">ℝ</mi><mrow id="S2.I5.i1.p1.1.m1.1.1.3.6.3" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3.cmml"><mi id="S2.I5.i1.p1.1.m1.1.1.3.6.3.2" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3.2.cmml">d</mi><mo id="S2.I5.i1.p1.1.m1.1.1.3.6.3.1" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3.1.cmml">=</mo><mn id="S2.I5.i1.p1.1.m1.1.1.3.6.3.3" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3.3.cmml">512</mn></mrow></msup><mo id="S2.I5.i1.p1.1.m1.1.1.3.7" stretchy="false" xref="S2.I5.i1.p1.1.m1.1.1.3.7.cmml">↦</mo><mi id="S2.I5.i1.p1.1.m1.1.1.3.8" xref="S2.I5.i1.p1.1.m1.1.1.3.8.cmml">μ</mi><mo id="S2.I5.i1.p1.1.m1.1.1.3.9" xref="S2.I5.i1.p1.1.m1.1.1.3.9.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I5.i1.p1.1.m1.1.1.3.10" xref="S2.I5.i1.p1.1.m1.1.1.3.10.cmml">𝒩</mi><mo id="S2.I5.i1.p1.1.m1.1.1.3.11" xref="S2.I5.i1.p1.1.m1.1.1.3.11.cmml">⊆</mo><msup id="S2.I5.i1.p1.1.m1.1.1.3.12" xref="S2.I5.i1.p1.1.m1.1.1.3.12.cmml"><mi id="S2.I5.i1.p1.1.m1.1.1.3.12.2" mathvariant="normal" xref="S2.I5.i1.p1.1.m1.1.1.3.12.2.cmml">ℝ</mi><mrow id="S2.I5.i1.p1.1.m1.1.1.3.12.3" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3.cmml"><mi id="S2.I5.i1.p1.1.m1.1.1.3.12.3.2" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3.2.cmml">n</mi><mo id="S2.I5.i1.p1.1.m1.1.1.3.12.3.1" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3.1.cmml">≪</mo><mn id="S2.I5.i1.p1.1.m1.1.1.3.12.3.3" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3.3.cmml">512</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I5.i1.p1.1.m1.1b"><apply id="S2.I5.i1.p1.1.m1.1.1.cmml" xref="S2.I5.i1.p1.1.m1.1.1"><ci id="S2.I5.i1.p1.1.m1.1.1.1.cmml" xref="S2.I5.i1.p1.1.m1.1.1.1">:</ci><ci id="S2.I5.i1.p1.1.m1.1.1.2.cmml" xref="S2.I5.i1.p1.1.m1.1.1.2">Enc</ci><apply id="S2.I5.i1.p1.1.m1.1.1.3.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"><and id="S2.I5.i1.p1.1.m1.1.1.3a.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"></and><apply id="S2.I5.i1.p1.1.m1.1.1.3b.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"><in id="S2.I5.i1.p1.1.m1.1.1.3.3.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.3"></in><ci id="S2.I5.i1.p1.1.m1.1.1.3.2.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.2">𝑋</ci><ci id="S2.I5.i1.p1.1.m1.1.1.3.4.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.4">ℳ</ci></apply><apply id="S2.I5.i1.p1.1.m1.1.1.3c.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"><subset id="S2.I5.i1.p1.1.m1.1.1.3.5.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.5"></subset><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i1.p1.1.m1.1.1.3.4.cmml" id="S2.I5.i1.p1.1.m1.1.1.3d.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"></share><apply id="S2.I5.i1.p1.1.m1.1.1.3.6.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.6"><csymbol cd="ambiguous" id="S2.I5.i1.p1.1.m1.1.1.3.6.1.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.6">superscript</csymbol><ci id="S2.I5.i1.p1.1.m1.1.1.3.6.2.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.6.2">ℝ</ci><apply id="S2.I5.i1.p1.1.m1.1.1.3.6.3.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3"><eq id="S2.I5.i1.p1.1.m1.1.1.3.6.3.1.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3.1"></eq><ci id="S2.I5.i1.p1.1.m1.1.1.3.6.3.2.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3.2">𝑑</ci><cn id="S2.I5.i1.p1.1.m1.1.1.3.6.3.3.cmml" type="integer" xref="S2.I5.i1.p1.1.m1.1.1.3.6.3.3">512</cn></apply></apply></apply><apply id="S2.I5.i1.p1.1.m1.1.1.3e.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S2.I5.i1.p1.1.m1.1.1.3.7.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.7">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i1.p1.1.m1.1.1.3.6.cmml" id="S2.I5.i1.p1.1.m1.1.1.3f.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"></share><ci id="S2.I5.i1.p1.1.m1.1.1.3.8.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.8">𝜇</ci></apply><apply id="S2.I5.i1.p1.1.m1.1.1.3g.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"><in id="S2.I5.i1.p1.1.m1.1.1.3.9.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.9"></in><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i1.p1.1.m1.1.1.3.8.cmml" id="S2.I5.i1.p1.1.m1.1.1.3h.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"></share><ci id="S2.I5.i1.p1.1.m1.1.1.3.10.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.10">𝒩</ci></apply><apply id="S2.I5.i1.p1.1.m1.1.1.3i.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"><subset id="S2.I5.i1.p1.1.m1.1.1.3.11.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.11"></subset><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i1.p1.1.m1.1.1.3.10.cmml" id="S2.I5.i1.p1.1.m1.1.1.3j.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3"></share><apply id="S2.I5.i1.p1.1.m1.1.1.3.12.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.12"><csymbol cd="ambiguous" id="S2.I5.i1.p1.1.m1.1.1.3.12.1.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.12">superscript</csymbol><ci id="S2.I5.i1.p1.1.m1.1.1.3.12.2.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.12.2">ℝ</ci><apply id="S2.I5.i1.p1.1.m1.1.1.3.12.3.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3"><csymbol cd="latexml" id="S2.I5.i1.p1.1.m1.1.1.3.12.3.1.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3.1">much-less-than</csymbol><ci id="S2.I5.i1.p1.1.m1.1.1.3.12.3.2.cmml" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3.2">𝑛</ci><cn id="S2.I5.i1.p1.1.m1.1.1.3.12.3.3.cmml" type="integer" xref="S2.I5.i1.p1.1.m1.1.1.3.12.3.3">512</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I5.i1.p1.1.m1.1c">\mathrm{Enc}:X\in\mathcal{M}\subseteq\mathbb{R}^{d=512}\mapsto\mu\in\mathcal{N%
}\subseteq\mathbb{R}^{n\ll 512}</annotation><annotation encoding="application/x-llamapun" id="S2.I5.i1.p1.1.m1.1d">roman_Enc : italic_X ∈ caligraphic_M ⊆ roman_ℝ start_POSTSUPERSCRIPT italic_d = 512 end_POSTSUPERSCRIPT ↦ italic_μ ∈ caligraphic_N ⊆ roman_ℝ start_POSTSUPERSCRIPT italic_n ≪ 512 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mu=\mathrm{Enc}[X]" class="ltx_Math" display="inline" id="S2.I5.i1.p1.2.m2.1"><semantics id="S2.I5.i1.p1.2.m2.1a"><mrow id="S2.I5.i1.p1.2.m2.1.2" xref="S2.I5.i1.p1.2.m2.1.2.cmml"><mi id="S2.I5.i1.p1.2.m2.1.2.2" xref="S2.I5.i1.p1.2.m2.1.2.2.cmml">μ</mi><mo id="S2.I5.i1.p1.2.m2.1.2.1" xref="S2.I5.i1.p1.2.m2.1.2.1.cmml">=</mo><mrow id="S2.I5.i1.p1.2.m2.1.2.3" xref="S2.I5.i1.p1.2.m2.1.2.3.cmml"><mi id="S2.I5.i1.p1.2.m2.1.2.3.2" xref="S2.I5.i1.p1.2.m2.1.2.3.2.cmml">Enc</mi><mo id="S2.I5.i1.p1.2.m2.1.2.3.1" xref="S2.I5.i1.p1.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="S2.I5.i1.p1.2.m2.1.2.3.3.2" xref="S2.I5.i1.p1.2.m2.1.2.3.3.1.cmml"><mo id="S2.I5.i1.p1.2.m2.1.2.3.3.2.1" stretchy="false" xref="S2.I5.i1.p1.2.m2.1.2.3.3.1.1.cmml">[</mo><mi id="S2.I5.i1.p1.2.m2.1.1" xref="S2.I5.i1.p1.2.m2.1.1.cmml">X</mi><mo id="S2.I5.i1.p1.2.m2.1.2.3.3.2.2" stretchy="false" xref="S2.I5.i1.p1.2.m2.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I5.i1.p1.2.m2.1b"><apply id="S2.I5.i1.p1.2.m2.1.2.cmml" xref="S2.I5.i1.p1.2.m2.1.2"><eq id="S2.I5.i1.p1.2.m2.1.2.1.cmml" xref="S2.I5.i1.p1.2.m2.1.2.1"></eq><ci id="S2.I5.i1.p1.2.m2.1.2.2.cmml" xref="S2.I5.i1.p1.2.m2.1.2.2">𝜇</ci><apply id="S2.I5.i1.p1.2.m2.1.2.3.cmml" xref="S2.I5.i1.p1.2.m2.1.2.3"><times id="S2.I5.i1.p1.2.m2.1.2.3.1.cmml" xref="S2.I5.i1.p1.2.m2.1.2.3.1"></times><ci id="S2.I5.i1.p1.2.m2.1.2.3.2.cmml" xref="S2.I5.i1.p1.2.m2.1.2.3.2">Enc</ci><apply id="S2.I5.i1.p1.2.m2.1.2.3.3.1.cmml" xref="S2.I5.i1.p1.2.m2.1.2.3.3.2"><csymbol cd="latexml" id="S2.I5.i1.p1.2.m2.1.2.3.3.1.1.cmml" xref="S2.I5.i1.p1.2.m2.1.2.3.3.2.1">delimited-[]</csymbol><ci id="S2.I5.i1.p1.2.m2.1.1.cmml" xref="S2.I5.i1.p1.2.m2.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I5.i1.p1.2.m2.1c">\mu=\mathrm{Enc}[X]</annotation><annotation encoding="application/x-llamapun" id="S2.I5.i1.p1.2.m2.1d">italic_μ = roman_Enc [ italic_X ]</annotation></semantics></math>;</p>
</div>
</li>
<li class="ltx_item" id="S2.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I5.i2.p1">
<p class="ltx_p" id="S2.I5.i2.p1.1">A clustering algorithm in latent space, <math alttext="\mathrm{IKMeans}:\mu^{(i)}\mapsto C_{I=1,\ldots N}" class="ltx_Math" display="inline" id="S2.I5.i2.p1.1.m1.3"><semantics id="S2.I5.i2.p1.1.m1.3a"><mrow id="S2.I5.i2.p1.1.m1.3.4" xref="S2.I5.i2.p1.1.m1.3.4.cmml"><mi id="S2.I5.i2.p1.1.m1.3.4.2" xref="S2.I5.i2.p1.1.m1.3.4.2.cmml">IKMeans</mi><mo id="S2.I5.i2.p1.1.m1.3.4.1" lspace="0.278em" rspace="0.278em" xref="S2.I5.i2.p1.1.m1.3.4.1.cmml">:</mo><mrow id="S2.I5.i2.p1.1.m1.3.4.3" xref="S2.I5.i2.p1.1.m1.3.4.3.cmml"><msup id="S2.I5.i2.p1.1.m1.3.4.3.2" xref="S2.I5.i2.p1.1.m1.3.4.3.2.cmml"><mi id="S2.I5.i2.p1.1.m1.3.4.3.2.2" xref="S2.I5.i2.p1.1.m1.3.4.3.2.2.cmml">μ</mi><mrow id="S2.I5.i2.p1.1.m1.1.1.1.3" xref="S2.I5.i2.p1.1.m1.3.4.3.2.cmml"><mo id="S2.I5.i2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.I5.i2.p1.1.m1.3.4.3.2.cmml">(</mo><mi id="S2.I5.i2.p1.1.m1.1.1.1.1" xref="S2.I5.i2.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S2.I5.i2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.I5.i2.p1.1.m1.3.4.3.2.cmml">)</mo></mrow></msup><mo id="S2.I5.i2.p1.1.m1.3.4.3.1" stretchy="false" xref="S2.I5.i2.p1.1.m1.3.4.3.1.cmml">↦</mo><msub id="S2.I5.i2.p1.1.m1.3.4.3.3" xref="S2.I5.i2.p1.1.m1.3.4.3.3.cmml"><mi id="S2.I5.i2.p1.1.m1.3.4.3.3.2" xref="S2.I5.i2.p1.1.m1.3.4.3.3.2.cmml">C</mi><mrow id="S2.I5.i2.p1.1.m1.3.3.2" xref="S2.I5.i2.p1.1.m1.3.3.2.cmml"><mi id="S2.I5.i2.p1.1.m1.3.3.2.4" xref="S2.I5.i2.p1.1.m1.3.3.2.4.cmml">I</mi><mo id="S2.I5.i2.p1.1.m1.3.3.2.3" xref="S2.I5.i2.p1.1.m1.3.3.2.3.cmml">=</mo><mrow id="S2.I5.i2.p1.1.m1.3.3.2.2.1" xref="S2.I5.i2.p1.1.m1.3.3.2.2.2.cmml"><mn id="S2.I5.i2.p1.1.m1.2.2.1.1" xref="S2.I5.i2.p1.1.m1.2.2.1.1.cmml">1</mn><mo id="S2.I5.i2.p1.1.m1.3.3.2.2.1.2" xref="S2.I5.i2.p1.1.m1.3.3.2.2.2.cmml">,</mo><mrow id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.cmml"><mi id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.2" mathvariant="normal" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.2.cmml">…</mi><mo id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.1" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.1.cmml">⁢</mo><mi id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.3" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.3.cmml">N</mi></mrow></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I5.i2.p1.1.m1.3b"><apply id="S2.I5.i2.p1.1.m1.3.4.cmml" xref="S2.I5.i2.p1.1.m1.3.4"><ci id="S2.I5.i2.p1.1.m1.3.4.1.cmml" xref="S2.I5.i2.p1.1.m1.3.4.1">:</ci><ci id="S2.I5.i2.p1.1.m1.3.4.2.cmml" xref="S2.I5.i2.p1.1.m1.3.4.2">IKMeans</ci><apply id="S2.I5.i2.p1.1.m1.3.4.3.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3"><csymbol cd="latexml" id="S2.I5.i2.p1.1.m1.3.4.3.1.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3.1">maps-to</csymbol><apply id="S2.I5.i2.p1.1.m1.3.4.3.2.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3.2"><csymbol cd="ambiguous" id="S2.I5.i2.p1.1.m1.3.4.3.2.1.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3.2">superscript</csymbol><ci id="S2.I5.i2.p1.1.m1.3.4.3.2.2.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3.2.2">𝜇</ci><ci id="S2.I5.i2.p1.1.m1.1.1.1.1.cmml" xref="S2.I5.i2.p1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.I5.i2.p1.1.m1.3.4.3.3.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3.3"><csymbol cd="ambiguous" id="S2.I5.i2.p1.1.m1.3.4.3.3.1.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3.3">subscript</csymbol><ci id="S2.I5.i2.p1.1.m1.3.4.3.3.2.cmml" xref="S2.I5.i2.p1.1.m1.3.4.3.3.2">𝐶</ci><apply id="S2.I5.i2.p1.1.m1.3.3.2.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2"><eq id="S2.I5.i2.p1.1.m1.3.3.2.3.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2.3"></eq><ci id="S2.I5.i2.p1.1.m1.3.3.2.4.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2.4">𝐼</ci><list id="S2.I5.i2.p1.1.m1.3.3.2.2.2.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1"><cn id="S2.I5.i2.p1.1.m1.2.2.1.1.cmml" type="integer" xref="S2.I5.i2.p1.1.m1.2.2.1.1">1</cn><apply id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1"><times id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.1.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.1"></times><ci id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.2.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.2">…</ci><ci id="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.3.cmml" xref="S2.I5.i2.p1.1.m1.3.3.2.2.1.1.3">𝑁</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I5.i2.p1.1.m1.3c">\mathrm{IKMeans}:\mu^{(i)}\mapsto C_{I=1,\ldots N}</annotation><annotation encoding="application/x-llamapun" id="S2.I5.i2.p1.1.m1.3d">roman_IKMeans : italic_μ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ↦ italic_C start_POSTSUBSCRIPT italic_I = 1 , … italic_N end_POSTSUBSCRIPT</annotation></semantics></math>; in this latent space, we can compute</p>
<ol class="ltx_enumerate" id="S2.I5.i2.I1">
<li class="ltx_item" id="S2.I5.i2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S2.I5.i2.I1.i1.p1">
<p class="ltx_p" id="S2.I5.i2.I1.i1.p1.1">a self-supervised clustering loss, based on the <span class="ltx_text ltx_font_italic" id="S2.I5.i2.I1.i1.p1.1.1">silhuette score</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib53" title="">53</a>]</cite>;</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{sil}(X,\tilde{X})\equiv\frac{1-\mathrm{silhouette}[C_{I=1,\ldots k%
}]}{2}\,,\quad C_{I=1,\ldots k}\leftarrow\mathrm{IKMeans}[\mathrm{Enc}[X]]\,." class="ltx_Math" display="block" id="S2.E1.m1.9"><semantics id="S2.E1.m1.9a"><mrow id="S2.E1.m1.9.9.1"><mrow id="S2.E1.m1.9.9.1.1.2" xref="S2.E1.m1.9.9.1.1.3.cmml"><mrow id="S2.E1.m1.9.9.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.cmml"><mrow id="S2.E1.m1.9.9.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.2.cmml"><msub id="S2.E1.m1.9.9.1.1.1.1.2.2" xref="S2.E1.m1.9.9.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.9.9.1.1.1.1.2.2.2" xref="S2.E1.m1.9.9.1.1.1.1.2.2.2.cmml">ℒ</mi><mrow id="S2.E1.m1.9.9.1.1.1.1.2.2.3" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.9.9.1.1.1.1.2.2.3.2" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.2.cmml">s</mi><mo id="S2.E1.m1.9.9.1.1.1.1.2.2.3.1" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.9.9.1.1.1.1.2.2.3.3" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.3.cmml">i</mi><mo id="S2.E1.m1.9.9.1.1.1.1.2.2.3.1a" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.9.9.1.1.1.1.2.2.3.4" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.4.cmml">l</mi></mrow></msub><mo id="S2.E1.m1.9.9.1.1.1.1.2.1" xref="S2.E1.m1.9.9.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.9.9.1.1.1.1.2.3.2" xref="S2.E1.m1.9.9.1.1.1.1.2.3.1.cmml"><mo id="S2.E1.m1.9.9.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.E1.m1.9.9.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">X</mi><mo id="S2.E1.m1.9.9.1.1.1.1.2.3.2.2" xref="S2.E1.m1.9.9.1.1.1.1.2.3.1.cmml">,</mo><mover accent="true" id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml"><mi id="S2.E1.m1.7.7.2" xref="S2.E1.m1.7.7.2.cmml">X</mi><mo id="S2.E1.m1.7.7.1" xref="S2.E1.m1.7.7.1.cmml">~</mo></mover><mo id="S2.E1.m1.9.9.1.1.1.1.2.3.2.3" stretchy="false" xref="S2.E1.m1.9.9.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.cmml">≡</mo><mfrac id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml"><mrow id="S2.E1.m1.3.3.3" xref="S2.E1.m1.3.3.3.cmml"><mn id="S2.E1.m1.3.3.3.5" xref="S2.E1.m1.3.3.3.5.cmml">1</mn><mo id="S2.E1.m1.3.3.3.4" xref="S2.E1.m1.3.3.3.4.cmml">−</mo><mrow id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.3.cmml"><mi id="S2.E1.m1.3.3.3.3.3" xref="S2.E1.m1.3.3.3.3.3.cmml">silhouette</mi><mo id="S2.E1.m1.3.3.3.3.2" xref="S2.E1.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.3.3.1.1" xref="S2.E1.m1.3.3.3.3.1.2.cmml"><mo id="S2.E1.m1.3.3.3.3.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.2.1.cmml">[</mo><msub id="S2.E1.m1.3.3.3.3.1.1.1" xref="S2.E1.m1.3.3.3.3.1.1.1.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml">C</mi><mrow id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.4.cmml">I</mi><mo id="S2.E1.m1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.3.cmml">=</mo><mrow id="S2.E1.m1.2.2.2.2.2.2.1" xref="S2.E1.m1.2.2.2.2.2.2.2.cmml"><mn id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">1</mn><mo id="S2.E1.m1.2.2.2.2.2.2.1.2" xref="S2.E1.m1.2.2.2.2.2.2.2.cmml">,</mo><mrow id="S2.E1.m1.2.2.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.2.2.1.1.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.1.1.2" mathvariant="normal" xref="S2.E1.m1.2.2.2.2.2.2.1.1.2.cmml">…</mi><mo id="S2.E1.m1.2.2.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.2.2.2.1.1.3" xref="S2.E1.m1.2.2.2.2.2.2.1.1.3.cmml">k</mi></mrow></mrow></mrow></msub><mo id="S2.E1.m1.3.3.3.3.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><mn id="S2.E1.m1.3.3.5" xref="S2.E1.m1.3.3.5.cmml">2</mn></mfrac></mrow><mo id="S2.E1.m1.9.9.1.1.2.3" lspace="0.170em" rspace="1.167em" xref="S2.E1.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.9.9.1.1.2.2" xref="S2.E1.m1.9.9.1.1.2.2.cmml"><msub id="S2.E1.m1.9.9.1.1.2.2.3" xref="S2.E1.m1.9.9.1.1.2.2.3.cmml"><mi id="S2.E1.m1.9.9.1.1.2.2.3.2" xref="S2.E1.m1.9.9.1.1.2.2.3.2.cmml">C</mi><mrow id="S2.E1.m1.5.5.2" xref="S2.E1.m1.5.5.2.cmml"><mi id="S2.E1.m1.5.5.2.4" xref="S2.E1.m1.5.5.2.4.cmml">I</mi><mo id="S2.E1.m1.5.5.2.3" xref="S2.E1.m1.5.5.2.3.cmml">=</mo><mrow id="S2.E1.m1.5.5.2.2.1" xref="S2.E1.m1.5.5.2.2.2.cmml"><mn id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml">1</mn><mo id="S2.E1.m1.5.5.2.2.1.2" xref="S2.E1.m1.5.5.2.2.2.cmml">,</mo><mrow id="S2.E1.m1.5.5.2.2.1.1" xref="S2.E1.m1.5.5.2.2.1.1.cmml"><mi id="S2.E1.m1.5.5.2.2.1.1.2" mathvariant="normal" xref="S2.E1.m1.5.5.2.2.1.1.2.cmml">…</mi><mo id="S2.E1.m1.5.5.2.2.1.1.1" xref="S2.E1.m1.5.5.2.2.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.2.2.1.1.3" xref="S2.E1.m1.5.5.2.2.1.1.3.cmml">k</mi></mrow></mrow></mrow></msub><mo id="S2.E1.m1.9.9.1.1.2.2.2" stretchy="false" xref="S2.E1.m1.9.9.1.1.2.2.2.cmml">←</mo><mrow id="S2.E1.m1.9.9.1.1.2.2.1" xref="S2.E1.m1.9.9.1.1.2.2.1.cmml"><mi id="S2.E1.m1.9.9.1.1.2.2.1.3" xref="S2.E1.m1.9.9.1.1.2.2.1.3.cmml">IKMeans</mi><mo id="S2.E1.m1.9.9.1.1.2.2.1.2" xref="S2.E1.m1.9.9.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.9.9.1.1.2.2.1.1.1" xref="S2.E1.m1.9.9.1.1.2.2.1.1.2.cmml"><mo id="S2.E1.m1.9.9.1.1.2.2.1.1.1.2" stretchy="false" xref="S2.E1.m1.9.9.1.1.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.cmml"><mi id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.2.cmml">Enc</mi><mo id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.2" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.1.cmml"><mo id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.1.1.cmml">[</mo><mi id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml">X</mi><mo id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E1.m1.9.9.1.1.2.2.1.1.1.3" stretchy="false" xref="S2.E1.m1.9.9.1.1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.9.9.1.2" lspace="0.170em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.9b"><apply id="S2.E1.m1.9.9.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.1.1.3a.cmml" xref="S2.E1.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.9.9.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1"><equivalent id="S2.E1.m1.9.9.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1"></equivalent><apply id="S2.E1.m1.9.9.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2"><times id="S2.E1.m1.9.9.1.1.1.1.2.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.1"></times><apply id="S2.E1.m1.9.9.1.1.1.1.2.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.9.9.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2.2">ℒ</ci><apply id="S2.E1.m1.9.9.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3"><times id="S2.E1.m1.9.9.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.1"></times><ci id="S2.E1.m1.9.9.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S2.E1.m1.9.9.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.3">𝑖</ci><ci id="S2.E1.m1.9.9.1.1.1.1.2.2.3.4.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.2.3.4">𝑙</ci></apply></apply><interval closure="open" id="S2.E1.m1.9.9.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.2.3.2"><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝑋</ci><apply id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7"><ci id="S2.E1.m1.7.7.1.cmml" xref="S2.E1.m1.7.7.1">~</ci><ci id="S2.E1.m1.7.7.2.cmml" xref="S2.E1.m1.7.7.2">𝑋</ci></apply></interval></apply><apply id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3"><divide id="S2.E1.m1.3.3.4.cmml" xref="S2.E1.m1.3.3"></divide><apply id="S2.E1.m1.3.3.3.cmml" xref="S2.E1.m1.3.3.3"><minus id="S2.E1.m1.3.3.3.4.cmml" xref="S2.E1.m1.3.3.3.4"></minus><cn id="S2.E1.m1.3.3.3.5.cmml" type="integer" xref="S2.E1.m1.3.3.3.5">1</cn><apply id="S2.E1.m1.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3"><times id="S2.E1.m1.3.3.3.3.2.cmml" xref="S2.E1.m1.3.3.3.3.2"></times><ci id="S2.E1.m1.3.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3.3">silhouette</ci><apply id="S2.E1.m1.3.3.3.3.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1"><csymbol cd="latexml" id="S2.E1.m1.3.3.3.3.1.2.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.3.3.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.2">𝐶</ci><apply id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2"><eq id="S2.E1.m1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.3"></eq><ci id="S2.E1.m1.2.2.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.2.2.4">𝐼</ci><list id="S2.E1.m1.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1"><cn id="S2.E1.m1.1.1.1.1.1.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.1">1</cn><apply id="S2.E1.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1"><times id="S2.E1.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1"></times><ci id="S2.E1.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.2">…</ci><ci id="S2.E1.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.3">𝑘</ci></apply></list></apply></apply></apply></apply></apply><cn id="S2.E1.m1.3.3.5.cmml" type="integer" xref="S2.E1.m1.3.3.5">2</cn></apply></apply><apply id="S2.E1.m1.9.9.1.1.2.2.cmml" xref="S2.E1.m1.9.9.1.1.2.2"><ci id="S2.E1.m1.9.9.1.1.2.2.2.cmml" xref="S2.E1.m1.9.9.1.1.2.2.2">←</ci><apply id="S2.E1.m1.9.9.1.1.2.2.3.cmml" xref="S2.E1.m1.9.9.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.1.1.2.2.3.1.cmml" xref="S2.E1.m1.9.9.1.1.2.2.3">subscript</csymbol><ci id="S2.E1.m1.9.9.1.1.2.2.3.2.cmml" xref="S2.E1.m1.9.9.1.1.2.2.3.2">𝐶</ci><apply id="S2.E1.m1.5.5.2.cmml" xref="S2.E1.m1.5.5.2"><eq id="S2.E1.m1.5.5.2.3.cmml" xref="S2.E1.m1.5.5.2.3"></eq><ci id="S2.E1.m1.5.5.2.4.cmml" xref="S2.E1.m1.5.5.2.4">𝐼</ci><list id="S2.E1.m1.5.5.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.1"><cn id="S2.E1.m1.4.4.1.1.cmml" type="integer" xref="S2.E1.m1.4.4.1.1">1</cn><apply id="S2.E1.m1.5.5.2.2.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1"><times id="S2.E1.m1.5.5.2.2.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1"></times><ci id="S2.E1.m1.5.5.2.2.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.2">…</ci><ci id="S2.E1.m1.5.5.2.2.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.3">𝑘</ci></apply></list></apply></apply><apply id="S2.E1.m1.9.9.1.1.2.2.1.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1"><times id="S2.E1.m1.9.9.1.1.2.2.1.2.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.2"></times><ci id="S2.E1.m1.9.9.1.1.2.2.1.3.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.3">IKMeans</ci><apply id="S2.E1.m1.9.9.1.1.2.2.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.9.9.1.1.2.2.1.1.2.1.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1"><times id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.1"></times><ci id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.2">Enc</ci><apply id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.1.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.2"><csymbol cd="latexml" id="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.1.1.cmml" xref="S2.E1.m1.9.9.1.1.2.2.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8">𝑋</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.9c">\mathcal{L}_{sil}(X,\tilde{X})\equiv\frac{1-\mathrm{silhouette}[C_{I=1,\ldots k%
}]}{2}\,,\quad C_{I=1,\ldots k}\leftarrow\mathrm{IKMeans}[\mathrm{Enc}[X]]\,.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.9d">caligraphic_L start_POSTSUBSCRIPT italic_s italic_i italic_l end_POSTSUBSCRIPT ( italic_X , over~ start_ARG italic_X end_ARG ) ≡ divide start_ARG 1 - roman_silhouette [ italic_C start_POSTSUBSCRIPT italic_I = 1 , … italic_k end_POSTSUBSCRIPT ] end_ARG start_ARG 2 end_ARG , italic_C start_POSTSUBSCRIPT italic_I = 1 , … italic_k end_POSTSUBSCRIPT ← roman_IKMeans [ roman_Enc [ italic_X ] ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S2.I5.i2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="S2.I5.i2.I1.i2.p1">
<p class="ltx_p" id="S2.I5.i2.I1.i2.p1.1">a variational loss, inspired by the infoVAE model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib55" title="">55</a>]</cite>, which is the Maximum-Mean Discrepancy (MMD) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib57" title="">57</a>]</cite>;</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{MMD}(q||p)=\mathbf{E}_{p(z),p(z^{\prime})}[k(z,z^{\prime})]-2\mathbf{E%
}_{q(z),p(z^{\prime})}[k(z,z^{\prime})]+\mathbf{E}_{q(z),q(z^{\prime})}[k(z,z^%
{\prime})]." class="ltx_math_unparsed" display="block" id="S2.E2.m1.9"><semantics id="S2.E2.m1.9a"><mrow id="S2.E2.m1.9b"><mi id="S2.E2.m1.9.10">MMD</mi><mrow id="S2.E2.m1.9.11"><mo id="S2.E2.m1.9.11.1" stretchy="false">(</mo><mi id="S2.E2.m1.9.11.2">q</mi><mo fence="false" id="S2.E2.m1.9.11.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S2.E2.m1.9.11.4" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E2.m1.9.11.5">p</mi><mo id="S2.E2.m1.9.11.6" stretchy="false">)</mo></mrow><mo id="S2.E2.m1.9.12">=</mo><msub id="S2.E2.m1.9.13"><mi id="S2.E2.m1.9.13.2">𝐄</mi><mrow id="S2.E2.m1.3.3.3.3"><mrow id="S2.E2.m1.2.2.2.2.1"><mi id="S2.E2.m1.2.2.2.2.1.2">p</mi><mo id="S2.E2.m1.2.2.2.2.1.1">⁢</mo><mrow id="S2.E2.m1.2.2.2.2.1.3.2"><mo id="S2.E2.m1.2.2.2.2.1.3.2.1" stretchy="false">(</mo><mi id="S2.E2.m1.1.1.1.1">z</mi><mo id="S2.E2.m1.2.2.2.2.1.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.3.3.3">,</mo><mrow id="S2.E2.m1.3.3.3.3.2"><mi id="S2.E2.m1.3.3.3.3.2.3">p</mi><mo id="S2.E2.m1.3.3.3.3.2.2">⁢</mo><mrow id="S2.E2.m1.3.3.3.3.2.1.1"><mo id="S2.E2.m1.3.3.3.3.2.1.1.2" stretchy="false">(</mo><msup id="S2.E2.m1.3.3.3.3.2.1.1.1"><mi id="S2.E2.m1.3.3.3.3.2.1.1.1.2">z</mi><mo id="S2.E2.m1.3.3.3.3.2.1.1.1.3">′</mo></msup><mo id="S2.E2.m1.3.3.3.3.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></msub><mrow id="S2.E2.m1.9.14"><mo id="S2.E2.m1.9.14.1" stretchy="false">[</mo><mi id="S2.E2.m1.9.14.2">k</mi><mrow id="S2.E2.m1.9.14.3"><mo id="S2.E2.m1.9.14.3.1" stretchy="false">(</mo><mi id="S2.E2.m1.9.14.3.2">z</mi><mo id="S2.E2.m1.9.14.3.3">,</mo><msup id="S2.E2.m1.9.14.3.4"><mi id="S2.E2.m1.9.14.3.4.2">z</mi><mo id="S2.E2.m1.9.14.3.4.3">′</mo></msup><mo id="S2.E2.m1.9.14.3.5" stretchy="false">)</mo></mrow><mo id="S2.E2.m1.9.14.4" stretchy="false">]</mo></mrow><mo id="S2.E2.m1.9.15">−</mo><mn id="S2.E2.m1.9.16">2</mn><msub id="S2.E2.m1.9.17"><mi id="S2.E2.m1.9.17.2">𝐄</mi><mrow id="S2.E2.m1.6.6.3.3"><mrow id="S2.E2.m1.5.5.2.2.1"><mi id="S2.E2.m1.5.5.2.2.1.2">q</mi><mo id="S2.E2.m1.5.5.2.2.1.1">⁢</mo><mrow id="S2.E2.m1.5.5.2.2.1.3.2"><mo id="S2.E2.m1.5.5.2.2.1.3.2.1" stretchy="false">(</mo><mi id="S2.E2.m1.4.4.1.1">z</mi><mo id="S2.E2.m1.5.5.2.2.1.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.3.3.3">,</mo><mrow id="S2.E2.m1.6.6.3.3.2"><mi id="S2.E2.m1.6.6.3.3.2.3">p</mi><mo id="S2.E2.m1.6.6.3.3.2.2">⁢</mo><mrow id="S2.E2.m1.6.6.3.3.2.1.1"><mo id="S2.E2.m1.6.6.3.3.2.1.1.2" stretchy="false">(</mo><msup id="S2.E2.m1.6.6.3.3.2.1.1.1"><mi id="S2.E2.m1.6.6.3.3.2.1.1.1.2">z</mi><mo id="S2.E2.m1.6.6.3.3.2.1.1.1.3">′</mo></msup><mo id="S2.E2.m1.6.6.3.3.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></msub><mrow id="S2.E2.m1.9.18"><mo id="S2.E2.m1.9.18.1" stretchy="false">[</mo><mi id="S2.E2.m1.9.18.2">k</mi><mrow id="S2.E2.m1.9.18.3"><mo id="S2.E2.m1.9.18.3.1" stretchy="false">(</mo><mi id="S2.E2.m1.9.18.3.2">z</mi><mo id="S2.E2.m1.9.18.3.3">,</mo><msup id="S2.E2.m1.9.18.3.4"><mi id="S2.E2.m1.9.18.3.4.2">z</mi><mo id="S2.E2.m1.9.18.3.4.3">′</mo></msup><mo id="S2.E2.m1.9.18.3.5" stretchy="false">)</mo></mrow><mo id="S2.E2.m1.9.18.4" stretchy="false">]</mo></mrow><mo id="S2.E2.m1.9.19">+</mo><msub id="S2.E2.m1.9.20"><mi id="S2.E2.m1.9.20.2">𝐄</mi><mrow id="S2.E2.m1.9.9.3.3"><mrow id="S2.E2.m1.8.8.2.2.1"><mi id="S2.E2.m1.8.8.2.2.1.2">q</mi><mo id="S2.E2.m1.8.8.2.2.1.1">⁢</mo><mrow id="S2.E2.m1.8.8.2.2.1.3.2"><mo id="S2.E2.m1.8.8.2.2.1.3.2.1" stretchy="false">(</mo><mi id="S2.E2.m1.7.7.1.1">z</mi><mo id="S2.E2.m1.8.8.2.2.1.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S2.E2.m1.9.9.3.3.3">,</mo><mrow id="S2.E2.m1.9.9.3.3.2"><mi id="S2.E2.m1.9.9.3.3.2.3">q</mi><mo id="S2.E2.m1.9.9.3.3.2.2">⁢</mo><mrow id="S2.E2.m1.9.9.3.3.2.1.1"><mo id="S2.E2.m1.9.9.3.3.2.1.1.2" stretchy="false">(</mo><msup id="S2.E2.m1.9.9.3.3.2.1.1.1"><mi id="S2.E2.m1.9.9.3.3.2.1.1.1.2">z</mi><mo id="S2.E2.m1.9.9.3.3.2.1.1.1.3">′</mo></msup><mo id="S2.E2.m1.9.9.3.3.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></msub><mrow id="S2.E2.m1.9.21"><mo id="S2.E2.m1.9.21.1" stretchy="false">[</mo><mi id="S2.E2.m1.9.21.2">k</mi><mrow id="S2.E2.m1.9.21.3"><mo id="S2.E2.m1.9.21.3.1" stretchy="false">(</mo><mi id="S2.E2.m1.9.21.3.2">z</mi><mo id="S2.E2.m1.9.21.3.3">,</mo><msup id="S2.E2.m1.9.21.3.4"><mi id="S2.E2.m1.9.21.3.4.2">z</mi><mo id="S2.E2.m1.9.21.3.4.3">′</mo></msup><mo id="S2.E2.m1.9.21.3.5" stretchy="false">)</mo></mrow><mo id="S2.E2.m1.9.21.4" stretchy="false">]</mo></mrow><mo id="S2.E2.m1.9.22" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E2.m1.9c">\mathrm{MMD}(q||p)=\mathbf{E}_{p(z),p(z^{\prime})}[k(z,z^{\prime})]-2\mathbf{E%
}_{q(z),p(z^{\prime})}[k(z,z^{\prime})]+\mathbf{E}_{q(z),q(z^{\prime})}[k(z,z^%
{\prime})].</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.9d">roman_MMD ( italic_q | | italic_p ) = bold_E start_POSTSUBSCRIPT italic_p ( italic_z ) , italic_p ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ italic_k ( italic_z , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] - 2 bold_E start_POSTSUBSCRIPT italic_q ( italic_z ) , italic_p ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ italic_k ( italic_z , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] + bold_E start_POSTSUBSCRIPT italic_q ( italic_z ) , italic_q ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ italic_k ( italic_z , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ol>
</div>
</li>
<li class="ltx_item" id="S2.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S2.I5.i3.p1">
<p class="ltx_p" id="S2.I5.i3.p1.2">A Decoder <math alttext="\mathrm{Dec}:\mu\in\mathcal{N}\subseteq\mathbb{R}^{n\ll 512}\mapsto X\in%
\mathcal{M}\subseteq\mathbb{R}^{d=512}" class="ltx_Math" display="inline" id="S2.I5.i3.p1.1.m1.1"><semantics id="S2.I5.i3.p1.1.m1.1a"><mrow id="S2.I5.i3.p1.1.m1.1.1" xref="S2.I5.i3.p1.1.m1.1.1.cmml"><mi id="S2.I5.i3.p1.1.m1.1.1.2" xref="S2.I5.i3.p1.1.m1.1.1.2.cmml">Dec</mi><mo id="S2.I5.i3.p1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.I5.i3.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S2.I5.i3.p1.1.m1.1.1.3" xref="S2.I5.i3.p1.1.m1.1.1.3.cmml"><mi id="S2.I5.i3.p1.1.m1.1.1.3.2" xref="S2.I5.i3.p1.1.m1.1.1.3.2.cmml">μ</mi><mo id="S2.I5.i3.p1.1.m1.1.1.3.3" xref="S2.I5.i3.p1.1.m1.1.1.3.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I5.i3.p1.1.m1.1.1.3.4" xref="S2.I5.i3.p1.1.m1.1.1.3.4.cmml">𝒩</mi><mo id="S2.I5.i3.p1.1.m1.1.1.3.5" xref="S2.I5.i3.p1.1.m1.1.1.3.5.cmml">⊆</mo><msup id="S2.I5.i3.p1.1.m1.1.1.3.6" xref="S2.I5.i3.p1.1.m1.1.1.3.6.cmml"><mi id="S2.I5.i3.p1.1.m1.1.1.3.6.2" mathvariant="normal" xref="S2.I5.i3.p1.1.m1.1.1.3.6.2.cmml">ℝ</mi><mrow id="S2.I5.i3.p1.1.m1.1.1.3.6.3" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3.cmml"><mi id="S2.I5.i3.p1.1.m1.1.1.3.6.3.2" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3.2.cmml">n</mi><mo id="S2.I5.i3.p1.1.m1.1.1.3.6.3.1" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3.1.cmml">≪</mo><mn id="S2.I5.i3.p1.1.m1.1.1.3.6.3.3" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3.3.cmml">512</mn></mrow></msup><mo id="S2.I5.i3.p1.1.m1.1.1.3.7" stretchy="false" xref="S2.I5.i3.p1.1.m1.1.1.3.7.cmml">↦</mo><mi id="S2.I5.i3.p1.1.m1.1.1.3.8" xref="S2.I5.i3.p1.1.m1.1.1.3.8.cmml">X</mi><mo id="S2.I5.i3.p1.1.m1.1.1.3.9" xref="S2.I5.i3.p1.1.m1.1.1.3.9.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I5.i3.p1.1.m1.1.1.3.10" xref="S2.I5.i3.p1.1.m1.1.1.3.10.cmml">ℳ</mi><mo id="S2.I5.i3.p1.1.m1.1.1.3.11" xref="S2.I5.i3.p1.1.m1.1.1.3.11.cmml">⊆</mo><msup id="S2.I5.i3.p1.1.m1.1.1.3.12" xref="S2.I5.i3.p1.1.m1.1.1.3.12.cmml"><mi id="S2.I5.i3.p1.1.m1.1.1.3.12.2" mathvariant="normal" xref="S2.I5.i3.p1.1.m1.1.1.3.12.2.cmml">ℝ</mi><mrow id="S2.I5.i3.p1.1.m1.1.1.3.12.3" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3.cmml"><mi id="S2.I5.i3.p1.1.m1.1.1.3.12.3.2" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3.2.cmml">d</mi><mo id="S2.I5.i3.p1.1.m1.1.1.3.12.3.1" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3.1.cmml">=</mo><mn id="S2.I5.i3.p1.1.m1.1.1.3.12.3.3" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3.3.cmml">512</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I5.i3.p1.1.m1.1b"><apply id="S2.I5.i3.p1.1.m1.1.1.cmml" xref="S2.I5.i3.p1.1.m1.1.1"><ci id="S2.I5.i3.p1.1.m1.1.1.1.cmml" xref="S2.I5.i3.p1.1.m1.1.1.1">:</ci><ci id="S2.I5.i3.p1.1.m1.1.1.2.cmml" xref="S2.I5.i3.p1.1.m1.1.1.2">Dec</ci><apply id="S2.I5.i3.p1.1.m1.1.1.3.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"><and id="S2.I5.i3.p1.1.m1.1.1.3a.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"></and><apply id="S2.I5.i3.p1.1.m1.1.1.3b.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"><in id="S2.I5.i3.p1.1.m1.1.1.3.3.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.3"></in><ci id="S2.I5.i3.p1.1.m1.1.1.3.2.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.2">𝜇</ci><ci id="S2.I5.i3.p1.1.m1.1.1.3.4.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.4">𝒩</ci></apply><apply id="S2.I5.i3.p1.1.m1.1.1.3c.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"><subset id="S2.I5.i3.p1.1.m1.1.1.3.5.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.5"></subset><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i3.p1.1.m1.1.1.3.4.cmml" id="S2.I5.i3.p1.1.m1.1.1.3d.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"></share><apply id="S2.I5.i3.p1.1.m1.1.1.3.6.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.6"><csymbol cd="ambiguous" id="S2.I5.i3.p1.1.m1.1.1.3.6.1.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.6">superscript</csymbol><ci id="S2.I5.i3.p1.1.m1.1.1.3.6.2.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.6.2">ℝ</ci><apply id="S2.I5.i3.p1.1.m1.1.1.3.6.3.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3"><csymbol cd="latexml" id="S2.I5.i3.p1.1.m1.1.1.3.6.3.1.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3.1">much-less-than</csymbol><ci id="S2.I5.i3.p1.1.m1.1.1.3.6.3.2.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3.2">𝑛</ci><cn id="S2.I5.i3.p1.1.m1.1.1.3.6.3.3.cmml" type="integer" xref="S2.I5.i3.p1.1.m1.1.1.3.6.3.3">512</cn></apply></apply></apply><apply id="S2.I5.i3.p1.1.m1.1.1.3e.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S2.I5.i3.p1.1.m1.1.1.3.7.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.7">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i3.p1.1.m1.1.1.3.6.cmml" id="S2.I5.i3.p1.1.m1.1.1.3f.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"></share><ci id="S2.I5.i3.p1.1.m1.1.1.3.8.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.8">𝑋</ci></apply><apply id="S2.I5.i3.p1.1.m1.1.1.3g.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"><in id="S2.I5.i3.p1.1.m1.1.1.3.9.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.9"></in><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i3.p1.1.m1.1.1.3.8.cmml" id="S2.I5.i3.p1.1.m1.1.1.3h.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"></share><ci id="S2.I5.i3.p1.1.m1.1.1.3.10.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.10">ℳ</ci></apply><apply id="S2.I5.i3.p1.1.m1.1.1.3i.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"><subset id="S2.I5.i3.p1.1.m1.1.1.3.11.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.11"></subset><share href="https://arxiv.org/html/2410.08826v1#S2.I5.i3.p1.1.m1.1.1.3.10.cmml" id="S2.I5.i3.p1.1.m1.1.1.3j.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3"></share><apply id="S2.I5.i3.p1.1.m1.1.1.3.12.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.12"><csymbol cd="ambiguous" id="S2.I5.i3.p1.1.m1.1.1.3.12.1.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.12">superscript</csymbol><ci id="S2.I5.i3.p1.1.m1.1.1.3.12.2.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.12.2">ℝ</ci><apply id="S2.I5.i3.p1.1.m1.1.1.3.12.3.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3"><eq id="S2.I5.i3.p1.1.m1.1.1.3.12.3.1.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3.1"></eq><ci id="S2.I5.i3.p1.1.m1.1.1.3.12.3.2.cmml" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3.2">𝑑</ci><cn id="S2.I5.i3.p1.1.m1.1.1.3.12.3.3.cmml" type="integer" xref="S2.I5.i3.p1.1.m1.1.1.3.12.3.3">512</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I5.i3.p1.1.m1.1c">\mathrm{Dec}:\mu\in\mathcal{N}\subseteq\mathbb{R}^{n\ll 512}\mapsto X\in%
\mathcal{M}\subseteq\mathbb{R}^{d=512}</annotation><annotation encoding="application/x-llamapun" id="S2.I5.i3.p1.1.m1.1d">roman_Dec : italic_μ ∈ caligraphic_N ⊆ roman_ℝ start_POSTSUPERSCRIPT italic_n ≪ 512 end_POSTSUPERSCRIPT ↦ italic_X ∈ caligraphic_M ⊆ roman_ℝ start_POSTSUPERSCRIPT italic_d = 512 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\tilde{X}=\mathrm{Dec}[\mu]" class="ltx_Math" display="inline" id="S2.I5.i3.p1.2.m2.1"><semantics id="S2.I5.i3.p1.2.m2.1a"><mrow id="S2.I5.i3.p1.2.m2.1.2" xref="S2.I5.i3.p1.2.m2.1.2.cmml"><mover accent="true" id="S2.I5.i3.p1.2.m2.1.2.2" xref="S2.I5.i3.p1.2.m2.1.2.2.cmml"><mi id="S2.I5.i3.p1.2.m2.1.2.2.2" xref="S2.I5.i3.p1.2.m2.1.2.2.2.cmml">X</mi><mo id="S2.I5.i3.p1.2.m2.1.2.2.1" xref="S2.I5.i3.p1.2.m2.1.2.2.1.cmml">~</mo></mover><mo id="S2.I5.i3.p1.2.m2.1.2.1" xref="S2.I5.i3.p1.2.m2.1.2.1.cmml">=</mo><mrow id="S2.I5.i3.p1.2.m2.1.2.3" xref="S2.I5.i3.p1.2.m2.1.2.3.cmml"><mi id="S2.I5.i3.p1.2.m2.1.2.3.2" xref="S2.I5.i3.p1.2.m2.1.2.3.2.cmml">Dec</mi><mo id="S2.I5.i3.p1.2.m2.1.2.3.1" xref="S2.I5.i3.p1.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="S2.I5.i3.p1.2.m2.1.2.3.3.2" xref="S2.I5.i3.p1.2.m2.1.2.3.3.1.cmml"><mo id="S2.I5.i3.p1.2.m2.1.2.3.3.2.1" stretchy="false" xref="S2.I5.i3.p1.2.m2.1.2.3.3.1.1.cmml">[</mo><mi id="S2.I5.i3.p1.2.m2.1.1" xref="S2.I5.i3.p1.2.m2.1.1.cmml">μ</mi><mo id="S2.I5.i3.p1.2.m2.1.2.3.3.2.2" stretchy="false" xref="S2.I5.i3.p1.2.m2.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I5.i3.p1.2.m2.1b"><apply id="S2.I5.i3.p1.2.m2.1.2.cmml" xref="S2.I5.i3.p1.2.m2.1.2"><eq id="S2.I5.i3.p1.2.m2.1.2.1.cmml" xref="S2.I5.i3.p1.2.m2.1.2.1"></eq><apply id="S2.I5.i3.p1.2.m2.1.2.2.cmml" xref="S2.I5.i3.p1.2.m2.1.2.2"><ci id="S2.I5.i3.p1.2.m2.1.2.2.1.cmml" xref="S2.I5.i3.p1.2.m2.1.2.2.1">~</ci><ci id="S2.I5.i3.p1.2.m2.1.2.2.2.cmml" xref="S2.I5.i3.p1.2.m2.1.2.2.2">𝑋</ci></apply><apply id="S2.I5.i3.p1.2.m2.1.2.3.cmml" xref="S2.I5.i3.p1.2.m2.1.2.3"><times id="S2.I5.i3.p1.2.m2.1.2.3.1.cmml" xref="S2.I5.i3.p1.2.m2.1.2.3.1"></times><ci id="S2.I5.i3.p1.2.m2.1.2.3.2.cmml" xref="S2.I5.i3.p1.2.m2.1.2.3.2">Dec</ci><apply id="S2.I5.i3.p1.2.m2.1.2.3.3.1.cmml" xref="S2.I5.i3.p1.2.m2.1.2.3.3.2"><csymbol cd="latexml" id="S2.I5.i3.p1.2.m2.1.2.3.3.1.1.cmml" xref="S2.I5.i3.p1.2.m2.1.2.3.3.2.1">delimited-[]</csymbol><ci id="S2.I5.i3.p1.2.m2.1.1.cmml" xref="S2.I5.i3.p1.2.m2.1.1">𝜇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I5.i3.p1.2.m2.1c">\tilde{X}=\mathrm{Dec}[\mu]</annotation><annotation encoding="application/x-llamapun" id="S2.I5.i3.p1.2.m2.1d">over~ start_ARG italic_X end_ARG = roman_Dec [ italic_μ ]</annotation></semantics></math>;</p>
<ol class="ltx_enumerate" id="S2.I5.i3.I1">
<li class="ltx_item" id="S2.I5.i3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S2.I5.i3.I1.i1.p1">
<p class="ltx_p" id="S2.I5.i3.I1.i1.p1.1">Compute a self-supervised reconstruction loss;</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{rec}(X,\tilde{X})=\frac{1}{N_{batch}}\sum_{a=1}^{N_{batch}}\frac{%
1}{d}\sum_{i=1}^{d}\left|X_{a,i}-\tilde{X}_{a,i}\right|^{2}\,." class="ltx_Math" display="block" id="S2.E3.m1.7"><semantics id="S2.E3.m1.7a"><mrow id="S2.E3.m1.7.7.1" xref="S2.E3.m1.7.7.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1" xref="S2.E3.m1.7.7.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1.3" xref="S2.E3.m1.7.7.1.1.3.cmml"><msub id="S2.E3.m1.7.7.1.1.3.2" xref="S2.E3.m1.7.7.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.7.7.1.1.3.2.2" xref="S2.E3.m1.7.7.1.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E3.m1.7.7.1.1.3.2.3" xref="S2.E3.m1.7.7.1.1.3.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.3.2.3.2" xref="S2.E3.m1.7.7.1.1.3.2.3.2.cmml">r</mi><mo id="S2.E3.m1.7.7.1.1.3.2.3.1" xref="S2.E3.m1.7.7.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.3.2.3.3" xref="S2.E3.m1.7.7.1.1.3.2.3.3.cmml">e</mi><mo id="S2.E3.m1.7.7.1.1.3.2.3.1a" xref="S2.E3.m1.7.7.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.3.2.3.4" xref="S2.E3.m1.7.7.1.1.3.2.3.4.cmml">c</mi></mrow></msub><mo id="S2.E3.m1.7.7.1.1.3.1" xref="S2.E3.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.3.3.2" xref="S2.E3.m1.7.7.1.1.3.3.1.cmml"><mo id="S2.E3.m1.7.7.1.1.3.3.2.1" stretchy="false" xref="S2.E3.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml">X</mi><mo id="S2.E3.m1.7.7.1.1.3.3.2.2" xref="S2.E3.m1.7.7.1.1.3.3.1.cmml">,</mo><mover accent="true" id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml"><mi id="S2.E3.m1.6.6.2" xref="S2.E3.m1.6.6.2.cmml">X</mi><mo id="S2.E3.m1.6.6.1" xref="S2.E3.m1.6.6.1.cmml">~</mo></mover><mo id="S2.E3.m1.7.7.1.1.3.3.2.3" stretchy="false" xref="S2.E3.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.7.7.1.1.2" xref="S2.E3.m1.7.7.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.7.7.1.1.1" xref="S2.E3.m1.7.7.1.1.1.cmml"><mfrac id="S2.E3.m1.7.7.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.3.cmml"><mn id="S2.E3.m1.7.7.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.3.2.cmml">1</mn><msub id="S2.E3.m1.7.7.1.1.1.3.3" xref="S2.E3.m1.7.7.1.1.1.3.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.3.3.2" xref="S2.E3.m1.7.7.1.1.1.3.3.2.cmml">N</mi><mrow id="S2.E3.m1.7.7.1.1.1.3.3.3" xref="S2.E3.m1.7.7.1.1.1.3.3.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.3.3.3.2" xref="S2.E3.m1.7.7.1.1.1.3.3.3.2.cmml">b</mi><mo id="S2.E3.m1.7.7.1.1.1.3.3.3.1" xref="S2.E3.m1.7.7.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.3.3.3.3" xref="S2.E3.m1.7.7.1.1.1.3.3.3.3.cmml">a</mi><mo id="S2.E3.m1.7.7.1.1.1.3.3.3.1a" xref="S2.E3.m1.7.7.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.3.3.3.4" xref="S2.E3.m1.7.7.1.1.1.3.3.3.4.cmml">t</mi><mo id="S2.E3.m1.7.7.1.1.1.3.3.3.1b" xref="S2.E3.m1.7.7.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.3.3.3.5" xref="S2.E3.m1.7.7.1.1.1.3.3.3.5.cmml">c</mi><mo id="S2.E3.m1.7.7.1.1.1.3.3.3.1c" xref="S2.E3.m1.7.7.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.3.3.3.6" xref="S2.E3.m1.7.7.1.1.1.3.3.3.6.cmml">h</mi></mrow></msub></mfrac><mo id="S2.E3.m1.7.7.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><munderover id="S2.E3.m1.7.7.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.2.cmml"><mo id="S2.E3.m1.7.7.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E3.m1.7.7.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.2.2.3" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.2.2.3.2" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3.2.cmml">a</mi><mo id="S2.E3.m1.7.7.1.1.1.1.2.2.3.1" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.7.7.1.1.1.1.2.2.3.3" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E3.m1.7.7.1.1.1.1.2.3" xref="S2.E3.m1.7.7.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.2.3.2" xref="S2.E3.m1.7.7.1.1.1.1.2.3.2.cmml">N</mi><mrow id="S2.E3.m1.7.7.1.1.1.1.2.3.3" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.2.3.3.2" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.2.cmml">b</mi><mo id="S2.E3.m1.7.7.1.1.1.1.2.3.3.1" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.1.2.3.3.3" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.3.cmml">a</mi><mo id="S2.E3.m1.7.7.1.1.1.1.2.3.3.1a" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.1.2.3.3.4" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.4.cmml">t</mi><mo id="S2.E3.m1.7.7.1.1.1.1.2.3.3.1b" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.1.2.3.3.5" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.5.cmml">c</mi><mo id="S2.E3.m1.7.7.1.1.1.1.2.3.3.1c" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.1.2.3.3.6" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.6.cmml">h</mi></mrow></msub></munderover><mrow id="S2.E3.m1.7.7.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.cmml"><mfrac id="S2.E3.m1.7.7.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.3.cmml"><mn id="S2.E3.m1.7.7.1.1.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.1.1.3.2.cmml">1</mn><mi id="S2.E3.m1.7.7.1.1.1.1.1.3.3" xref="S2.E3.m1.7.7.1.1.1.1.1.3.3.cmml">d</mi></mfrac><mo id="S2.E3.m1.7.7.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.cmml"><munderover id="S2.E3.m1.7.7.1.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.2.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.3.cmml">d</mi></munderover><msup id="S2.E3.m1.7.7.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml">X</mi><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">a</mi><mo id="S2.E3.m1.2.2.2.4.1" xref="S2.E3.m1.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">X</mi><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="S2.E3.m1.4.4.2.4" xref="S2.E3.m1.4.4.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml">a</mi><mo id="S2.E3.m1.4.4.2.4.1" xref="S2.E3.m1.4.4.2.3.cmml">,</mo><mi id="S2.E3.m1.4.4.2.2" xref="S2.E3.m1.4.4.2.2.cmml">i</mi></mrow></msub></mrow><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S2.E3.m1.7.7.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.7.7.1.2" lspace="0em" xref="S2.E3.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.7b"><apply id="S2.E3.m1.7.7.1.1.cmml" xref="S2.E3.m1.7.7.1"><eq id="S2.E3.m1.7.7.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.2"></eq><apply id="S2.E3.m1.7.7.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.3"><times id="S2.E3.m1.7.7.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.1"></times><apply id="S2.E3.m1.7.7.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.3.2.1.cmml" xref="S2.E3.m1.7.7.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.3.2.2.cmml" xref="S2.E3.m1.7.7.1.1.3.2.2">ℒ</ci><apply id="S2.E3.m1.7.7.1.1.3.2.3.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3"><times id="S2.E3.m1.7.7.1.1.3.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3.1"></times><ci id="S2.E3.m1.7.7.1.1.3.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3.2">𝑟</ci><ci id="S2.E3.m1.7.7.1.1.3.2.3.3.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3.3">𝑒</ci><ci id="S2.E3.m1.7.7.1.1.3.2.3.4.cmml" xref="S2.E3.m1.7.7.1.1.3.2.3.4">𝑐</ci></apply></apply><interval closure="open" id="S2.E3.m1.7.7.1.1.3.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3.3.2"><ci id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5">𝑋</ci><apply id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6"><ci id="S2.E3.m1.6.6.1.cmml" xref="S2.E3.m1.6.6.1">~</ci><ci id="S2.E3.m1.6.6.2.cmml" xref="S2.E3.m1.6.6.2">𝑋</ci></apply></interval></apply><apply id="S2.E3.m1.7.7.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1"><times id="S2.E3.m1.7.7.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.2"></times><apply id="S2.E3.m1.7.7.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.3"><divide id="S2.E3.m1.7.7.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.3"></divide><cn id="S2.E3.m1.7.7.1.1.1.3.2.cmml" type="integer" xref="S2.E3.m1.7.7.1.1.1.3.2">1</cn><apply id="S2.E3.m1.7.7.1.1.1.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.3.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.3.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.2">𝑁</ci><apply id="S2.E3.m1.7.7.1.1.1.3.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.3"><times id="S2.E3.m1.7.7.1.1.1.3.3.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.3.1"></times><ci id="S2.E3.m1.7.7.1.1.1.3.3.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.3.2">𝑏</ci><ci id="S2.E3.m1.7.7.1.1.1.3.3.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.3.3">𝑎</ci><ci id="S2.E3.m1.7.7.1.1.1.3.3.3.4.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.3.4">𝑡</ci><ci id="S2.E3.m1.7.7.1.1.1.3.3.3.5.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.3.5">𝑐</ci><ci id="S2.E3.m1.7.7.1.1.1.3.3.3.6.cmml" xref="S2.E3.m1.7.7.1.1.1.3.3.3.6">ℎ</ci></apply></apply></apply><apply id="S2.E3.m1.7.7.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1"><apply id="S2.E3.m1.7.7.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.7.7.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3"><eq id="S2.E3.m1.7.7.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.7.7.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3.2">𝑎</ci><cn id="S2.E3.m1.7.7.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.7.7.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E3.m1.7.7.1.1.1.1.2.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.2">𝑁</ci><apply id="S2.E3.m1.7.7.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3"><times id="S2.E3.m1.7.7.1.1.1.1.2.3.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.1"></times><ci id="S2.E3.m1.7.7.1.1.1.1.2.3.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.2">𝑏</ci><ci id="S2.E3.m1.7.7.1.1.1.1.2.3.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.3">𝑎</ci><ci id="S2.E3.m1.7.7.1.1.1.1.2.3.3.4.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.4">𝑡</ci><ci id="S2.E3.m1.7.7.1.1.1.1.2.3.3.5.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.5">𝑐</ci><ci id="S2.E3.m1.7.7.1.1.1.1.2.3.3.6.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2.3.3.6">ℎ</ci></apply></apply></apply><apply id="S2.E3.m1.7.7.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1"><times id="S2.E3.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.2"></times><apply id="S2.E3.m1.7.7.1.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.3"><divide id="S2.E3.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.3"></divide><cn id="S2.E3.m1.7.7.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E3.m1.7.7.1.1.1.1.1.3.2">1</cn><ci id="S2.E3.m1.7.7.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1"><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3"><eq id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1"><abs id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2"></abs><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1"><minus id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2">𝑋</ci><list id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑎</ci><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑋</ci></apply><list id="S2.E3.m1.4.4.2.3.cmml" xref="S2.E3.m1.4.4.2.4"><ci id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1">𝑎</ci><ci id="S2.E3.m1.4.4.2.2.cmml" xref="S2.E3.m1.4.4.2.2">𝑖</ci></list></apply></apply></apply><cn id="S2.E3.m1.7.7.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.7c">\mathcal{L}_{rec}(X,\tilde{X})=\frac{1}{N_{batch}}\sum_{a=1}^{N_{batch}}\frac{%
1}{d}\sum_{i=1}^{d}\left|X_{a,i}-\tilde{X}_{a,i}\right|^{2}\,.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.7d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT ( italic_X , over~ start_ARG italic_X end_ARG ) = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_b italic_a italic_t italic_c italic_h end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_a = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b italic_a italic_t italic_c italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_d end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_X start_POSTSUBSCRIPT italic_a , italic_i end_POSTSUBSCRIPT - over~ start_ARG italic_X end_ARG start_POSTSUBSCRIPT italic_a , italic_i end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
<p class="ltx_p" id="S2.SS3.p1.1">Thus, the full loss we use, inspired by <math alttext="\beta-" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">β</mi><mo id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">limit-from</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝛽</ci><minus id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\beta-</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_β -</annotation></semantics></math>VAEs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib47" title="">47</a>]</cite>, is</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{tot}^{(i)}(X,\tilde{X})=\mathcal{L}_{rec}(X,\tilde{X})+\beta(i)%
\mathcal{L}_{\mathrm{MMD}}(\mathrm{Enc}[X],\mathcal{N}(0,\mathbbold{1}_{d}))+%
\gamma(i)\mathcal{L}_{sil}(X,\tilde{X})," class="ltx_Math" display="block" id="S2.E4.m1.12"><semantics id="S2.E4.m1.12a"><mrow id="S2.E4.m1.12.12.1" xref="S2.E4.m1.12.12.1.1.cmml"><mrow id="S2.E4.m1.12.12.1.1" xref="S2.E4.m1.12.12.1.1.cmml"><mrow id="S2.E4.m1.12.12.1.1.4" xref="S2.E4.m1.12.12.1.1.4.cmml"><msubsup id="S2.E4.m1.12.12.1.1.4.2" xref="S2.E4.m1.12.12.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.12.12.1.1.4.2.2.2" xref="S2.E4.m1.12.12.1.1.4.2.2.2.cmml">ℒ</mi><mrow id="S2.E4.m1.12.12.1.1.4.2.2.3" xref="S2.E4.m1.12.12.1.1.4.2.2.3.cmml"><mi id="S2.E4.m1.12.12.1.1.4.2.2.3.2" xref="S2.E4.m1.12.12.1.1.4.2.2.3.2.cmml">t</mi><mo id="S2.E4.m1.12.12.1.1.4.2.2.3.1" xref="S2.E4.m1.12.12.1.1.4.2.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.12.12.1.1.4.2.2.3.3" xref="S2.E4.m1.12.12.1.1.4.2.2.3.3.cmml">o</mi><mo id="S2.E4.m1.12.12.1.1.4.2.2.3.1a" xref="S2.E4.m1.12.12.1.1.4.2.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.12.12.1.1.4.2.2.3.4" xref="S2.E4.m1.12.12.1.1.4.2.2.3.4.cmml">t</mi></mrow><mrow id="S2.E4.m1.1.1.1.3" xref="S2.E4.m1.12.12.1.1.4.2.cmml"><mo id="S2.E4.m1.1.1.1.3.1" stretchy="false" xref="S2.E4.m1.12.12.1.1.4.2.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">i</mi><mo id="S2.E4.m1.1.1.1.3.2" stretchy="false" xref="S2.E4.m1.12.12.1.1.4.2.cmml">)</mo></mrow></msubsup><mo id="S2.E4.m1.12.12.1.1.4.1" xref="S2.E4.m1.12.12.1.1.4.1.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.4.3.2" xref="S2.E4.m1.12.12.1.1.4.3.1.cmml"><mo id="S2.E4.m1.12.12.1.1.4.3.2.1" stretchy="false" xref="S2.E4.m1.12.12.1.1.4.3.1.cmml">(</mo><mi id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml">X</mi><mo id="S2.E4.m1.12.12.1.1.4.3.2.2" xref="S2.E4.m1.12.12.1.1.4.3.1.cmml">,</mo><mover accent="true" id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml"><mi id="S2.E4.m1.3.3.2" xref="S2.E4.m1.3.3.2.cmml">X</mi><mo id="S2.E4.m1.3.3.1" xref="S2.E4.m1.3.3.1.cmml">~</mo></mover><mo id="S2.E4.m1.12.12.1.1.4.3.2.3" stretchy="false" xref="S2.E4.m1.12.12.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.12.12.1.1.3" xref="S2.E4.m1.12.12.1.1.3.cmml">=</mo><mrow id="S2.E4.m1.12.12.1.1.2" xref="S2.E4.m1.12.12.1.1.2.cmml"><mrow id="S2.E4.m1.12.12.1.1.2.4" xref="S2.E4.m1.12.12.1.1.2.4.cmml"><msub id="S2.E4.m1.12.12.1.1.2.4.2" xref="S2.E4.m1.12.12.1.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.12.12.1.1.2.4.2.2" xref="S2.E4.m1.12.12.1.1.2.4.2.2.cmml">ℒ</mi><mrow id="S2.E4.m1.12.12.1.1.2.4.2.3" xref="S2.E4.m1.12.12.1.1.2.4.2.3.cmml"><mi id="S2.E4.m1.12.12.1.1.2.4.2.3.2" xref="S2.E4.m1.12.12.1.1.2.4.2.3.2.cmml">r</mi><mo id="S2.E4.m1.12.12.1.1.2.4.2.3.1" xref="S2.E4.m1.12.12.1.1.2.4.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.12.12.1.1.2.4.2.3.3" xref="S2.E4.m1.12.12.1.1.2.4.2.3.3.cmml">e</mi><mo id="S2.E4.m1.12.12.1.1.2.4.2.3.1a" xref="S2.E4.m1.12.12.1.1.2.4.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.12.12.1.1.2.4.2.3.4" xref="S2.E4.m1.12.12.1.1.2.4.2.3.4.cmml">c</mi></mrow></msub><mo id="S2.E4.m1.12.12.1.1.2.4.1" xref="S2.E4.m1.12.12.1.1.2.4.1.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.2.4.3.2" xref="S2.E4.m1.12.12.1.1.2.4.3.1.cmml"><mo id="S2.E4.m1.12.12.1.1.2.4.3.2.1" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.4.3.1.cmml">(</mo><mi id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml">X</mi><mo id="S2.E4.m1.12.12.1.1.2.4.3.2.2" xref="S2.E4.m1.12.12.1.1.2.4.3.1.cmml">,</mo><mover accent="true" id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml"><mi id="S2.E4.m1.5.5.2" xref="S2.E4.m1.5.5.2.cmml">X</mi><mo id="S2.E4.m1.5.5.1" xref="S2.E4.m1.5.5.1.cmml">~</mo></mover><mo id="S2.E4.m1.12.12.1.1.2.4.3.2.3" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.12.12.1.1.2.3" xref="S2.E4.m1.12.12.1.1.2.3.cmml">+</mo><mrow id="S2.E4.m1.12.12.1.1.2.2" xref="S2.E4.m1.12.12.1.1.2.2.cmml"><mi id="S2.E4.m1.12.12.1.1.2.2.4" xref="S2.E4.m1.12.12.1.1.2.2.4.cmml">β</mi><mo id="S2.E4.m1.12.12.1.1.2.2.3" xref="S2.E4.m1.12.12.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.2.2.5.2" xref="S2.E4.m1.12.12.1.1.2.2.cmml"><mo id="S2.E4.m1.12.12.1.1.2.2.5.2.1" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.2.cmml">(</mo><mi id="S2.E4.m1.6.6" xref="S2.E4.m1.6.6.cmml">i</mi><mo id="S2.E4.m1.12.12.1.1.2.2.5.2.2" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.2.cmml">)</mo></mrow><mo id="S2.E4.m1.12.12.1.1.2.2.3a" xref="S2.E4.m1.12.12.1.1.2.2.3.cmml">⁢</mo><msub id="S2.E4.m1.12.12.1.1.2.2.6" xref="S2.E4.m1.12.12.1.1.2.2.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.12.12.1.1.2.2.6.2" xref="S2.E4.m1.12.12.1.1.2.2.6.2.cmml">ℒ</mi><mi id="S2.E4.m1.12.12.1.1.2.2.6.3" xref="S2.E4.m1.12.12.1.1.2.2.6.3.cmml">MMD</mi></msub><mo id="S2.E4.m1.12.12.1.1.2.2.3b" xref="S2.E4.m1.12.12.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.2.2.2.2" xref="S2.E4.m1.12.12.1.1.2.2.2.3.cmml"><mo id="S2.E4.m1.12.12.1.1.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.2.2.3.cmml">(</mo><mrow id="S2.E4.m1.12.12.1.1.1.1.1.1.1" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.12.12.1.1.1.1.1.1.1.2" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.2.cmml">Enc</mi><mo id="S2.E4.m1.12.12.1.1.1.1.1.1.1.1" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.1.cmml"><mo id="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.1.1.cmml">[</mo><mi id="S2.E4.m1.7.7" xref="S2.E4.m1.7.7.cmml">X</mi><mo id="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E4.m1.12.12.1.1.2.2.2.2.4" xref="S2.E4.m1.12.12.1.1.2.2.2.3.cmml">,</mo><mrow id="S2.E4.m1.12.12.1.1.2.2.2.2.2" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.12.12.1.1.2.2.2.2.2.3" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.3.cmml">𝒩</mi><mo id="S2.E4.m1.12.12.1.1.2.2.2.2.2.2" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.2.cmml"><mo id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.2" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.2.cmml">(</mo><mn id="S2.E4.m1.8.8" xref="S2.E4.m1.8.8.cmml">0</mn><mo id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.3" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.2.cmml">,</mo><msub id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.cmml"><mn id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.2" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.2.cmml">𝟙</mn><mi id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.3" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.3.cmml">𝕕</mi></msub><mo id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.4" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.12.12.1.1.2.2.2.2.5" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.12.12.1.1.2.3a" xref="S2.E4.m1.12.12.1.1.2.3.cmml">+</mo><mrow id="S2.E4.m1.12.12.1.1.2.5" xref="S2.E4.m1.12.12.1.1.2.5.cmml"><mi id="S2.E4.m1.12.12.1.1.2.5.2" xref="S2.E4.m1.12.12.1.1.2.5.2.cmml">γ</mi><mo id="S2.E4.m1.12.12.1.1.2.5.1" xref="S2.E4.m1.12.12.1.1.2.5.1.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.2.5.3.2" xref="S2.E4.m1.12.12.1.1.2.5.cmml"><mo id="S2.E4.m1.12.12.1.1.2.5.3.2.1" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.5.cmml">(</mo><mi id="S2.E4.m1.9.9" xref="S2.E4.m1.9.9.cmml">𝕚</mi><mo id="S2.E4.m1.12.12.1.1.2.5.3.2.2" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.5.cmml">)</mo></mrow><mo id="S2.E4.m1.12.12.1.1.2.5.1a" xref="S2.E4.m1.12.12.1.1.2.5.1.cmml">⁢</mo><msub id="S2.E4.m1.12.12.1.1.2.5.4" xref="S2.E4.m1.12.12.1.1.2.5.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.12.12.1.1.2.5.4.2" xref="S2.E4.m1.12.12.1.1.2.5.4.2.cmml">ℒ</mi><mrow id="S2.E4.m1.12.12.1.1.2.5.4.3" xref="S2.E4.m1.12.12.1.1.2.5.4.3.cmml"><mi id="S2.E4.m1.12.12.1.1.2.5.4.3.2" xref="S2.E4.m1.12.12.1.1.2.5.4.3.2.cmml">𝕤</mi><mo id="S2.E4.m1.12.12.1.1.2.5.4.3.1" xref="S2.E4.m1.12.12.1.1.2.5.4.3.1.cmml">⁢</mo><mi id="S2.E4.m1.12.12.1.1.2.5.4.3.3" xref="S2.E4.m1.12.12.1.1.2.5.4.3.3.cmml">𝕚</mi><mo id="S2.E4.m1.12.12.1.1.2.5.4.3.1a" xref="S2.E4.m1.12.12.1.1.2.5.4.3.1.cmml">⁢</mo><mi id="S2.E4.m1.12.12.1.1.2.5.4.3.4" xref="S2.E4.m1.12.12.1.1.2.5.4.3.4.cmml">𝕝</mi></mrow></msub><mo id="S2.E4.m1.12.12.1.1.2.5.1b" xref="S2.E4.m1.12.12.1.1.2.5.1.cmml">⁢</mo><mrow id="S2.E4.m1.12.12.1.1.2.5.5.2" xref="S2.E4.m1.12.12.1.1.2.5.5.1.cmml"><mo id="S2.E4.m1.12.12.1.1.2.5.5.2.1" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.5.5.1.cmml">(</mo><mi id="S2.E4.m1.10.10" xref="S2.E4.m1.10.10.cmml">𝕏</mi><mo id="S2.E4.m1.12.12.1.1.2.5.5.2.2" xref="S2.E4.m1.12.12.1.1.2.5.5.1.cmml">,</mo><mover accent="true" id="S2.E4.m1.11.11" xref="S2.E4.m1.11.11.cmml"><mi id="S2.E4.m1.11.11.2" xref="S2.E4.m1.11.11.2.cmml">𝕏</mi><mo id="S2.E4.m1.11.11.1" xref="S2.E4.m1.11.11.1.cmml">~</mo></mover><mo id="S2.E4.m1.12.12.1.1.2.5.5.2.3" stretchy="false" xref="S2.E4.m1.12.12.1.1.2.5.5.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.12.12.1.2" xref="S2.E4.m1.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.12b"><apply id="S2.E4.m1.12.12.1.1.cmml" xref="S2.E4.m1.12.12.1"><eq id="S2.E4.m1.12.12.1.1.3.cmml" xref="S2.E4.m1.12.12.1.1.3"></eq><apply id="S2.E4.m1.12.12.1.1.4.cmml" xref="S2.E4.m1.12.12.1.1.4"><times id="S2.E4.m1.12.12.1.1.4.1.cmml" xref="S2.E4.m1.12.12.1.1.4.1"></times><apply id="S2.E4.m1.12.12.1.1.4.2.cmml" xref="S2.E4.m1.12.12.1.1.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.12.12.1.1.4.2.1.cmml" xref="S2.E4.m1.12.12.1.1.4.2">superscript</csymbol><apply id="S2.E4.m1.12.12.1.1.4.2.2.cmml" xref="S2.E4.m1.12.12.1.1.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.12.12.1.1.4.2.2.1.cmml" xref="S2.E4.m1.12.12.1.1.4.2">subscript</csymbol><ci id="S2.E4.m1.12.12.1.1.4.2.2.2.cmml" xref="S2.E4.m1.12.12.1.1.4.2.2.2">ℒ</ci><apply id="S2.E4.m1.12.12.1.1.4.2.2.3.cmml" xref="S2.E4.m1.12.12.1.1.4.2.2.3"><times id="S2.E4.m1.12.12.1.1.4.2.2.3.1.cmml" xref="S2.E4.m1.12.12.1.1.4.2.2.3.1"></times><ci id="S2.E4.m1.12.12.1.1.4.2.2.3.2.cmml" xref="S2.E4.m1.12.12.1.1.4.2.2.3.2">𝑡</ci><ci id="S2.E4.m1.12.12.1.1.4.2.2.3.3.cmml" xref="S2.E4.m1.12.12.1.1.4.2.2.3.3">𝑜</ci><ci id="S2.E4.m1.12.12.1.1.4.2.2.3.4.cmml" xref="S2.E4.m1.12.12.1.1.4.2.2.3.4">𝑡</ci></apply></apply><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑖</ci></apply><interval closure="open" id="S2.E4.m1.12.12.1.1.4.3.1.cmml" xref="S2.E4.m1.12.12.1.1.4.3.2"><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">𝑋</ci><apply id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3"><ci id="S2.E4.m1.3.3.1.cmml" xref="S2.E4.m1.3.3.1">~</ci><ci id="S2.E4.m1.3.3.2.cmml" xref="S2.E4.m1.3.3.2">𝑋</ci></apply></interval></apply><apply id="S2.E4.m1.12.12.1.1.2.cmml" xref="S2.E4.m1.12.12.1.1.2"><plus id="S2.E4.m1.12.12.1.1.2.3.cmml" xref="S2.E4.m1.12.12.1.1.2.3"></plus><apply id="S2.E4.m1.12.12.1.1.2.4.cmml" xref="S2.E4.m1.12.12.1.1.2.4"><times id="S2.E4.m1.12.12.1.1.2.4.1.cmml" xref="S2.E4.m1.12.12.1.1.2.4.1"></times><apply id="S2.E4.m1.12.12.1.1.2.4.2.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.12.12.1.1.2.4.2.1.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2">subscript</csymbol><ci id="S2.E4.m1.12.12.1.1.2.4.2.2.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2.2">ℒ</ci><apply id="S2.E4.m1.12.12.1.1.2.4.2.3.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2.3"><times id="S2.E4.m1.12.12.1.1.2.4.2.3.1.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2.3.1"></times><ci id="S2.E4.m1.12.12.1.1.2.4.2.3.2.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2.3.2">𝑟</ci><ci id="S2.E4.m1.12.12.1.1.2.4.2.3.3.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2.3.3">𝑒</ci><ci id="S2.E4.m1.12.12.1.1.2.4.2.3.4.cmml" xref="S2.E4.m1.12.12.1.1.2.4.2.3.4">𝑐</ci></apply></apply><interval closure="open" id="S2.E4.m1.12.12.1.1.2.4.3.1.cmml" xref="S2.E4.m1.12.12.1.1.2.4.3.2"><ci id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4">𝑋</ci><apply id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5"><ci id="S2.E4.m1.5.5.1.cmml" xref="S2.E4.m1.5.5.1">~</ci><ci id="S2.E4.m1.5.5.2.cmml" xref="S2.E4.m1.5.5.2">𝑋</ci></apply></interval></apply><apply id="S2.E4.m1.12.12.1.1.2.2.cmml" xref="S2.E4.m1.12.12.1.1.2.2"><times id="S2.E4.m1.12.12.1.1.2.2.3.cmml" xref="S2.E4.m1.12.12.1.1.2.2.3"></times><ci id="S2.E4.m1.12.12.1.1.2.2.4.cmml" xref="S2.E4.m1.12.12.1.1.2.2.4">𝛽</ci><ci id="S2.E4.m1.6.6.cmml" xref="S2.E4.m1.6.6">𝑖</ci><apply id="S2.E4.m1.12.12.1.1.2.2.6.cmml" xref="S2.E4.m1.12.12.1.1.2.2.6"><csymbol cd="ambiguous" id="S2.E4.m1.12.12.1.1.2.2.6.1.cmml" xref="S2.E4.m1.12.12.1.1.2.2.6">subscript</csymbol><ci id="S2.E4.m1.12.12.1.1.2.2.6.2.cmml" xref="S2.E4.m1.12.12.1.1.2.2.6.2">ℒ</ci><ci id="S2.E4.m1.12.12.1.1.2.2.6.3.cmml" xref="S2.E4.m1.12.12.1.1.2.2.6.3">MMD</ci></apply><interval closure="open" id="S2.E4.m1.12.12.1.1.2.2.2.3.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2"><apply id="S2.E4.m1.12.12.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1"><times id="S2.E4.m1.12.12.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.1"></times><ci id="S2.E4.m1.12.12.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.2">Enc</ci><apply id="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.2"><csymbol cd="latexml" id="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.1.1.cmml" xref="S2.E4.m1.12.12.1.1.1.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S2.E4.m1.7.7.cmml" xref="S2.E4.m1.7.7">𝑋</ci></apply></apply><apply id="S2.E4.m1.12.12.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2"><times id="S2.E4.m1.12.12.1.1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.2"></times><ci id="S2.E4.m1.12.12.1.1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.3">𝒩</ci><interval closure="open" id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.2.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1"><cn id="S2.E4.m1.8.8.cmml" type="integer" xref="S2.E4.m1.8.8">0</cn><apply id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1">subscript</csymbol><cn id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.2">1</cn><ci id="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E4.m1.12.12.1.1.2.2.2.2.2.1.1.1.3">𝕕</ci></apply></interval></apply></interval></apply><apply id="S2.E4.m1.12.12.1.1.2.5.cmml" xref="S2.E4.m1.12.12.1.1.2.5"><times id="S2.E4.m1.12.12.1.1.2.5.1.cmml" xref="S2.E4.m1.12.12.1.1.2.5.1"></times><ci id="S2.E4.m1.12.12.1.1.2.5.2.cmml" xref="S2.E4.m1.12.12.1.1.2.5.2">𝛾</ci><ci id="S2.E4.m1.9.9.cmml" xref="S2.E4.m1.9.9">𝕚</ci><apply id="S2.E4.m1.12.12.1.1.2.5.4.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4"><csymbol cd="ambiguous" id="S2.E4.m1.12.12.1.1.2.5.4.1.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4">subscript</csymbol><ci id="S2.E4.m1.12.12.1.1.2.5.4.2.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4.2">ℒ</ci><apply id="S2.E4.m1.12.12.1.1.2.5.4.3.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4.3"><times id="S2.E4.m1.12.12.1.1.2.5.4.3.1.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4.3.1"></times><ci id="S2.E4.m1.12.12.1.1.2.5.4.3.2.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4.3.2">𝕤</ci><ci id="S2.E4.m1.12.12.1.1.2.5.4.3.3.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4.3.3">𝕚</ci><ci id="S2.E4.m1.12.12.1.1.2.5.4.3.4.cmml" xref="S2.E4.m1.12.12.1.1.2.5.4.3.4">𝕝</ci></apply></apply><interval closure="open" id="S2.E4.m1.12.12.1.1.2.5.5.1.cmml" xref="S2.E4.m1.12.12.1.1.2.5.5.2"><ci id="S2.E4.m1.10.10.cmml" xref="S2.E4.m1.10.10">𝕏</ci><apply id="S2.E4.m1.11.11.cmml" xref="S2.E4.m1.11.11"><ci id="S2.E4.m1.11.11.1.cmml" xref="S2.E4.m1.11.11.1">~</ci><ci id="S2.E4.m1.11.11.2.cmml" xref="S2.E4.m1.11.11.2">𝕏</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.12c">\mathcal{L}_{tot}^{(i)}(X,\tilde{X})=\mathcal{L}_{rec}(X,\tilde{X})+\beta(i)%
\mathcal{L}_{\mathrm{MMD}}(\mathrm{Enc}[X],\mathcal{N}(0,\mathbbold{1}_{d}))+%
\gamma(i)\mathcal{L}_{sil}(X,\tilde{X}),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.12d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ( italic_X , over~ start_ARG italic_X end_ARG ) = caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT ( italic_X , over~ start_ARG italic_X end_ARG ) + italic_β ( italic_i ) caligraphic_L start_POSTSUBSCRIPT roman_MMD end_POSTSUBSCRIPT ( roman_Enc [ italic_X ] , caligraphic_N ( 0 , blackboard_1 start_POSTSUBSCRIPT blackboard_d end_POSTSUBSCRIPT ) ) + italic_γ ( blackboard_i ) caligraphic_L start_POSTSUBSCRIPT blackboard_s blackboard_i blackboard_l end_POSTSUBSCRIPT ( blackboard_X , over~ start_ARG blackboard_X end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.4">where <math alttext="i" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m1.1"><semantics id="S2.SS3.p1.2.m1.1a"><mi id="S2.SS3.p1.2.m1.1.1" xref="S2.SS3.p1.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m1.1b"><ci id="S2.SS3.p1.2.m1.1.1.cmml" xref="S2.SS3.p1.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m1.1d">italic_i</annotation></semantics></math> is the <math alttext="i-" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m2.1"><semantics id="S2.SS3.p1.3.m2.1a"><mrow id="S2.SS3.p1.3.m2.1.1" xref="S2.SS3.p1.3.m2.1.1.cmml"><mi id="S2.SS3.p1.3.m2.1.1.2" xref="S2.SS3.p1.3.m2.1.1.2.cmml">i</mi><mo id="S2.SS3.p1.3.m2.1.1.3" xref="S2.SS3.p1.3.m2.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m2.1b"><apply id="S2.SS3.p1.3.m2.1.1.cmml" xref="S2.SS3.p1.3.m2.1.1"><csymbol cd="latexml" id="S2.SS3.p1.3.m2.1.1.1.cmml" xref="S2.SS3.p1.3.m2.1.1">limit-from</csymbol><ci id="S2.SS3.p1.3.m2.1.1.2.cmml" xref="S2.SS3.p1.3.m2.1.1.2">𝑖</ci><minus id="S2.SS3.p1.3.m2.1.1.3.cmml" xref="S2.SS3.p1.3.m2.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m2.1c">i-</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m2.1d">italic_i -</annotation></semantics></math>th training epoch, and where <math alttext="\mathcal{L}_{\mathrm{MMD}}\equiv\mathrm{MMD}(\mathrm{Enc}[X]||\mathcal{N}(0,%
\mathbbold{1}_{d}))" class="ltx_math_unparsed" display="inline" id="S2.SS3.p1.4.m3.2"><semantics id="S2.SS3.p1.4.m3.2a"><mrow id="S2.SS3.p1.4.m3.2b"><msub id="S2.SS3.p1.4.m3.2.3"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.4.m3.2.3.2">ℒ</mi><mi id="S2.SS3.p1.4.m3.2.3.3">MMD</mi></msub><mo id="S2.SS3.p1.4.m3.2.4">≡</mo><mi id="S2.SS3.p1.4.m3.2.5">MMD</mi><mrow id="S2.SS3.p1.4.m3.2.6"><mo id="S2.SS3.p1.4.m3.2.6.1" stretchy="false">(</mo><mi id="S2.SS3.p1.4.m3.2.6.2">Enc</mi><mrow id="S2.SS3.p1.4.m3.2.6.3"><mo id="S2.SS3.p1.4.m3.2.6.3.1" stretchy="false">[</mo><mi id="S2.SS3.p1.4.m3.1.1">X</mi><mo id="S2.SS3.p1.4.m3.2.6.3.2" stretchy="false">]</mo></mrow><mo fence="false" id="S2.SS3.p1.4.m3.2.6.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S2.SS3.p1.4.m3.2.6.5" rspace="0.167em" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.4.m3.2.6.6">𝒩</mi><mrow id="S2.SS3.p1.4.m3.2.6.7"><mo id="S2.SS3.p1.4.m3.2.6.7.1" stretchy="false">(</mo><mn id="S2.SS3.p1.4.m3.2.2">0</mn><mo id="S2.SS3.p1.4.m3.2.6.7.2">,</mo><msub id="S2.SS3.p1.4.m3.2.6.7.3"><mn id="S2.SS3.p1.4.m3.2.6.7.3.2">𝟙</mn><mi id="S2.SS3.p1.4.m3.2.6.7.3.3">𝕕</mi></msub><mo id="S2.SS3.p1.4.m3.2.6.7.4" stretchy="false">)</mo></mrow><mo id="S2.SS3.p1.4.m3.2.6.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m3.2c">\mathcal{L}_{\mathrm{MMD}}\equiv\mathrm{MMD}(\mathrm{Enc}[X]||\mathcal{N}(0,%
\mathbbold{1}_{d}))</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.4.m3.2d">caligraphic_L start_POSTSUBSCRIPT roman_MMD end_POSTSUBSCRIPT ≡ roman_MMD ( roman_Enc [ italic_X ] | | caligraphic_N ( 0 , blackboard_1 start_POSTSUBSCRIPT blackboard_d end_POSTSUBSCRIPT ) )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">This architecture is based on the Deep Clustering Network (DCN) architecture of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib45" title="">45</a>]</cite> and the Variational Deep Embedding (VaDE) model of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib52" title="">52</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.6">The model hyperparameters were obtained using a grid-search method. The Encoder has 4+1 layer, while the decoder has 4 layers; the latent space has dimension <math alttext="3" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><mn id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><cn id="S2.SS3.p3.1.m1.1.1.cmml" type="integer" xref="S2.SS3.p3.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">3</annotation></semantics></math>, the Multi-Layer Perceptrons (MLPs) are Self-normalising Neural Networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib58" title="">58</a>]</cite>, and their sizes are <math alttext="512\mapsto 256\mapsto 128\mapsto 64\mapsto 32\mapsto 3+3" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><mrow id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mn id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">512</mn><mo id="S2.SS3.p3.2.m2.1.1.3" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.3.cmml">↦</mo><mn id="S2.SS3.p3.2.m2.1.1.4" xref="S2.SS3.p3.2.m2.1.1.4.cmml">256</mn><mo id="S2.SS3.p3.2.m2.1.1.5" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.5.cmml">↦</mo><mn id="S2.SS3.p3.2.m2.1.1.6" xref="S2.SS3.p3.2.m2.1.1.6.cmml">128</mn><mo id="S2.SS3.p3.2.m2.1.1.7" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.7.cmml">↦</mo><mn id="S2.SS3.p3.2.m2.1.1.8" xref="S2.SS3.p3.2.m2.1.1.8.cmml">64</mn><mo id="S2.SS3.p3.2.m2.1.1.9" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.9.cmml">↦</mo><mn id="S2.SS3.p3.2.m2.1.1.10" xref="S2.SS3.p3.2.m2.1.1.10.cmml">32</mn><mo id="S2.SS3.p3.2.m2.1.1.11" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.11.cmml">↦</mo><mrow id="S2.SS3.p3.2.m2.1.1.12" xref="S2.SS3.p3.2.m2.1.1.12.cmml"><mn id="S2.SS3.p3.2.m2.1.1.12.2" xref="S2.SS3.p3.2.m2.1.1.12.2.cmml">3</mn><mo id="S2.SS3.p3.2.m2.1.1.12.1" xref="S2.SS3.p3.2.m2.1.1.12.1.cmml">+</mo><mn id="S2.SS3.p3.2.m2.1.1.12.3" xref="S2.SS3.p3.2.m2.1.1.12.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><and id="S2.SS3.p3.2.m2.1.1a.cmml" xref="S2.SS3.p3.2.m2.1.1"></and><apply id="S2.SS3.p3.2.m2.1.1b.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3">maps-to</csymbol><cn id="S2.SS3.p3.2.m2.1.1.2.cmml" type="integer" xref="S2.SS3.p3.2.m2.1.1.2">512</cn><cn id="S2.SS3.p3.2.m2.1.1.4.cmml" type="integer" xref="S2.SS3.p3.2.m2.1.1.4">256</cn></apply><apply id="S2.SS3.p3.2.m2.1.1c.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS3.p3.2.m2.1.1.5.cmml" xref="S2.SS3.p3.2.m2.1.1.5">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.SS3.p3.2.m2.1.1.4.cmml" id="S2.SS3.p3.2.m2.1.1d.cmml" xref="S2.SS3.p3.2.m2.1.1"></share><cn id="S2.SS3.p3.2.m2.1.1.6.cmml" type="integer" xref="S2.SS3.p3.2.m2.1.1.6">128</cn></apply><apply id="S2.SS3.p3.2.m2.1.1e.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS3.p3.2.m2.1.1.7.cmml" xref="S2.SS3.p3.2.m2.1.1.7">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.SS3.p3.2.m2.1.1.6.cmml" id="S2.SS3.p3.2.m2.1.1f.cmml" xref="S2.SS3.p3.2.m2.1.1"></share><cn id="S2.SS3.p3.2.m2.1.1.8.cmml" type="integer" xref="S2.SS3.p3.2.m2.1.1.8">64</cn></apply><apply id="S2.SS3.p3.2.m2.1.1g.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS3.p3.2.m2.1.1.9.cmml" xref="S2.SS3.p3.2.m2.1.1.9">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.SS3.p3.2.m2.1.1.8.cmml" id="S2.SS3.p3.2.m2.1.1h.cmml" xref="S2.SS3.p3.2.m2.1.1"></share><cn id="S2.SS3.p3.2.m2.1.1.10.cmml" type="integer" xref="S2.SS3.p3.2.m2.1.1.10">32</cn></apply><apply id="S2.SS3.p3.2.m2.1.1i.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS3.p3.2.m2.1.1.11.cmml" xref="S2.SS3.p3.2.m2.1.1.11">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.SS3.p3.2.m2.1.1.10.cmml" id="S2.SS3.p3.2.m2.1.1j.cmml" xref="S2.SS3.p3.2.m2.1.1"></share><apply id="S2.SS3.p3.2.m2.1.1.12.cmml" xref="S2.SS3.p3.2.m2.1.1.12"><plus id="S2.SS3.p3.2.m2.1.1.12.1.cmml" xref="S2.SS3.p3.2.m2.1.1.12.1"></plus><cn id="S2.SS3.p3.2.m2.1.1.12.2.cmml" type="integer" xref="S2.SS3.p3.2.m2.1.1.12.2">3</cn><cn id="S2.SS3.p3.2.m2.1.1.12.3.cmml" type="integer" xref="S2.SS3.p3.2.m2.1.1.12.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">512\mapsto 256\mapsto 128\mapsto 64\mapsto 32\mapsto 3+3</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">512 ↦ 256 ↦ 128 ↦ 64 ↦ 32 ↦ 3 + 3</annotation></semantics></math> for the encoder, and <math alttext="3\mapsto 64\mapsto 128\mapsto 256\mapsto 512" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><mrow id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mn id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml">3</mn><mo id="S2.SS3.p3.3.m3.1.1.3" stretchy="false" xref="S2.SS3.p3.3.m3.1.1.3.cmml">↦</mo><mn id="S2.SS3.p3.3.m3.1.1.4" xref="S2.SS3.p3.3.m3.1.1.4.cmml">64</mn><mo id="S2.SS3.p3.3.m3.1.1.5" stretchy="false" xref="S2.SS3.p3.3.m3.1.1.5.cmml">↦</mo><mn id="S2.SS3.p3.3.m3.1.1.6" xref="S2.SS3.p3.3.m3.1.1.6.cmml">128</mn><mo id="S2.SS3.p3.3.m3.1.1.7" stretchy="false" xref="S2.SS3.p3.3.m3.1.1.7.cmml">↦</mo><mn id="S2.SS3.p3.3.m3.1.1.8" xref="S2.SS3.p3.3.m3.1.1.8.cmml">256</mn><mo id="S2.SS3.p3.3.m3.1.1.9" stretchy="false" xref="S2.SS3.p3.3.m3.1.1.9.cmml">↦</mo><mn id="S2.SS3.p3.3.m3.1.1.10" xref="S2.SS3.p3.3.m3.1.1.10.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><and id="S2.SS3.p3.3.m3.1.1a.cmml" xref="S2.SS3.p3.3.m3.1.1"></and><apply id="S2.SS3.p3.3.m3.1.1b.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="latexml" id="S2.SS3.p3.3.m3.1.1.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3">maps-to</csymbol><cn id="S2.SS3.p3.3.m3.1.1.2.cmml" type="integer" xref="S2.SS3.p3.3.m3.1.1.2">3</cn><cn id="S2.SS3.p3.3.m3.1.1.4.cmml" type="integer" xref="S2.SS3.p3.3.m3.1.1.4">64</cn></apply><apply id="S2.SS3.p3.3.m3.1.1c.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="latexml" id="S2.SS3.p3.3.m3.1.1.5.cmml" xref="S2.SS3.p3.3.m3.1.1.5">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.SS3.p3.3.m3.1.1.4.cmml" id="S2.SS3.p3.3.m3.1.1d.cmml" xref="S2.SS3.p3.3.m3.1.1"></share><cn id="S2.SS3.p3.3.m3.1.1.6.cmml" type="integer" xref="S2.SS3.p3.3.m3.1.1.6">128</cn></apply><apply id="S2.SS3.p3.3.m3.1.1e.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="latexml" id="S2.SS3.p3.3.m3.1.1.7.cmml" xref="S2.SS3.p3.3.m3.1.1.7">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.SS3.p3.3.m3.1.1.6.cmml" id="S2.SS3.p3.3.m3.1.1f.cmml" xref="S2.SS3.p3.3.m3.1.1"></share><cn id="S2.SS3.p3.3.m3.1.1.8.cmml" type="integer" xref="S2.SS3.p3.3.m3.1.1.8">256</cn></apply><apply id="S2.SS3.p3.3.m3.1.1g.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="latexml" id="S2.SS3.p3.3.m3.1.1.9.cmml" xref="S2.SS3.p3.3.m3.1.1.9">maps-to</csymbol><share href="https://arxiv.org/html/2410.08826v1#S2.SS3.p3.3.m3.1.1.8.cmml" id="S2.SS3.p3.3.m3.1.1h.cmml" xref="S2.SS3.p3.3.m3.1.1"></share><cn id="S2.SS3.p3.3.m3.1.1.10.cmml" type="integer" xref="S2.SS3.p3.3.m3.1.1.10">512</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">3\mapsto 64\mapsto 128\mapsto 256\mapsto 512</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">3 ↦ 64 ↦ 128 ↦ 256 ↦ 512</annotation></semantics></math> for the decoder. Furthermore, <math alttext="\gamma(i)=0.01" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><mrow id="S2.SS3.p3.4.m4.1.2" xref="S2.SS3.p3.4.m4.1.2.cmml"><mrow id="S2.SS3.p3.4.m4.1.2.2" xref="S2.SS3.p3.4.m4.1.2.2.cmml"><mi id="S2.SS3.p3.4.m4.1.2.2.2" xref="S2.SS3.p3.4.m4.1.2.2.2.cmml">γ</mi><mo id="S2.SS3.p3.4.m4.1.2.2.1" xref="S2.SS3.p3.4.m4.1.2.2.1.cmml">⁢</mo><mrow id="S2.SS3.p3.4.m4.1.2.2.3.2" xref="S2.SS3.p3.4.m4.1.2.2.cmml"><mo id="S2.SS3.p3.4.m4.1.2.2.3.2.1" stretchy="false" xref="S2.SS3.p3.4.m4.1.2.2.cmml">(</mo><mi id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml">i</mi><mo id="S2.SS3.p3.4.m4.1.2.2.3.2.2" stretchy="false" xref="S2.SS3.p3.4.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p3.4.m4.1.2.1" xref="S2.SS3.p3.4.m4.1.2.1.cmml">=</mo><mn id="S2.SS3.p3.4.m4.1.2.3" xref="S2.SS3.p3.4.m4.1.2.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.2.cmml" xref="S2.SS3.p3.4.m4.1.2"><eq id="S2.SS3.p3.4.m4.1.2.1.cmml" xref="S2.SS3.p3.4.m4.1.2.1"></eq><apply id="S2.SS3.p3.4.m4.1.2.2.cmml" xref="S2.SS3.p3.4.m4.1.2.2"><times id="S2.SS3.p3.4.m4.1.2.2.1.cmml" xref="S2.SS3.p3.4.m4.1.2.2.1"></times><ci id="S2.SS3.p3.4.m4.1.2.2.2.cmml" xref="S2.SS3.p3.4.m4.1.2.2.2">𝛾</ci><ci id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">𝑖</ci></apply><cn id="S2.SS3.p3.4.m4.1.2.3.cmml" type="float" xref="S2.SS3.p3.4.m4.1.2.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">\gamma(i)=0.01</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">italic_γ ( italic_i ) = 0.01</annotation></semantics></math> <math alttext="\forall i" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m5.1"><semantics id="S2.SS3.p3.5.m5.1a"><mrow id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml"><mo id="S2.SS3.p3.5.m5.1.1.1" rspace="0.167em" xref="S2.SS3.p3.5.m5.1.1.1.cmml">∀</mo><mi id="S2.SS3.p3.5.m5.1.1.2" xref="S2.SS3.p3.5.m5.1.1.2.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><apply id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1"><csymbol cd="latexml" id="S2.SS3.p3.5.m5.1.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1.1">for-all</csymbol><ci id="S2.SS3.p3.5.m5.1.1.2.cmml" xref="S2.SS3.p3.5.m5.1.1.2">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">\forall i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m5.1d">∀ italic_i</annotation></semantics></math>, while <math alttext="\beta(i)=0.01\cdot\Theta(i-30)" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m6.2"><semantics id="S2.SS3.p3.6.m6.2a"><mrow id="S2.SS3.p3.6.m6.2.2" xref="S2.SS3.p3.6.m6.2.2.cmml"><mrow id="S2.SS3.p3.6.m6.2.2.3" xref="S2.SS3.p3.6.m6.2.2.3.cmml"><mi id="S2.SS3.p3.6.m6.2.2.3.2" xref="S2.SS3.p3.6.m6.2.2.3.2.cmml">β</mi><mo id="S2.SS3.p3.6.m6.2.2.3.1" xref="S2.SS3.p3.6.m6.2.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.p3.6.m6.2.2.3.3.2" xref="S2.SS3.p3.6.m6.2.2.3.cmml"><mo id="S2.SS3.p3.6.m6.2.2.3.3.2.1" stretchy="false" xref="S2.SS3.p3.6.m6.2.2.3.cmml">(</mo><mi id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml">i</mi><mo id="S2.SS3.p3.6.m6.2.2.3.3.2.2" stretchy="false" xref="S2.SS3.p3.6.m6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p3.6.m6.2.2.2" xref="S2.SS3.p3.6.m6.2.2.2.cmml">=</mo><mrow id="S2.SS3.p3.6.m6.2.2.1" xref="S2.SS3.p3.6.m6.2.2.1.cmml"><mrow id="S2.SS3.p3.6.m6.2.2.1.3" xref="S2.SS3.p3.6.m6.2.2.1.3.cmml"><mn id="S2.SS3.p3.6.m6.2.2.1.3.2" xref="S2.SS3.p3.6.m6.2.2.1.3.2.cmml">0.01</mn><mo id="S2.SS3.p3.6.m6.2.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p3.6.m6.2.2.1.3.1.cmml">⋅</mo><mi id="S2.SS3.p3.6.m6.2.2.1.3.3" mathvariant="normal" xref="S2.SS3.p3.6.m6.2.2.1.3.3.cmml">Θ</mi></mrow><mo id="S2.SS3.p3.6.m6.2.2.1.2" xref="S2.SS3.p3.6.m6.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS3.p3.6.m6.2.2.1.1.1" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.cmml"><mo id="S2.SS3.p3.6.m6.2.2.1.1.1.2" stretchy="false" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p3.6.m6.2.2.1.1.1.1" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.cmml"><mi id="S2.SS3.p3.6.m6.2.2.1.1.1.1.2" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.2.cmml">i</mi><mo id="S2.SS3.p3.6.m6.2.2.1.1.1.1.1" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.1.cmml">−</mo><mn id="S2.SS3.p3.6.m6.2.2.1.1.1.1.3" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.3.cmml">30</mn></mrow><mo id="S2.SS3.p3.6.m6.2.2.1.1.1.3" stretchy="false" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.2b"><apply id="S2.SS3.p3.6.m6.2.2.cmml" xref="S2.SS3.p3.6.m6.2.2"><eq id="S2.SS3.p3.6.m6.2.2.2.cmml" xref="S2.SS3.p3.6.m6.2.2.2"></eq><apply id="S2.SS3.p3.6.m6.2.2.3.cmml" xref="S2.SS3.p3.6.m6.2.2.3"><times id="S2.SS3.p3.6.m6.2.2.3.1.cmml" xref="S2.SS3.p3.6.m6.2.2.3.1"></times><ci id="S2.SS3.p3.6.m6.2.2.3.2.cmml" xref="S2.SS3.p3.6.m6.2.2.3.2">𝛽</ci><ci id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1">𝑖</ci></apply><apply id="S2.SS3.p3.6.m6.2.2.1.cmml" xref="S2.SS3.p3.6.m6.2.2.1"><times id="S2.SS3.p3.6.m6.2.2.1.2.cmml" xref="S2.SS3.p3.6.m6.2.2.1.2"></times><apply id="S2.SS3.p3.6.m6.2.2.1.3.cmml" xref="S2.SS3.p3.6.m6.2.2.1.3"><ci id="S2.SS3.p3.6.m6.2.2.1.3.1.cmml" xref="S2.SS3.p3.6.m6.2.2.1.3.1">⋅</ci><cn id="S2.SS3.p3.6.m6.2.2.1.3.2.cmml" type="float" xref="S2.SS3.p3.6.m6.2.2.1.3.2">0.01</cn><ci id="S2.SS3.p3.6.m6.2.2.1.3.3.cmml" xref="S2.SS3.p3.6.m6.2.2.1.3.3">Θ</ci></apply><apply id="S2.SS3.p3.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS3.p3.6.m6.2.2.1.1.1"><minus id="S2.SS3.p3.6.m6.2.2.1.1.1.1.1.cmml" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.1"></minus><ci id="S2.SS3.p3.6.m6.2.2.1.1.1.1.2.cmml" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.2">𝑖</ci><cn id="S2.SS3.p3.6.m6.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.p3.6.m6.2.2.1.1.1.1.3">30</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.2c">\beta(i)=0.01\cdot\Theta(i-30)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m6.2d">italic_β ( italic_i ) = 0.01 ⋅ roman_Θ ( italic_i - 30 )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.1">A visual representation of the Deep Variational Embedding model is reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.F2" title="In 2.3 Training the Deep Embedding Model ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Preparing the synthetic dataset - part II: embedded MA-XRF images</h3>
<figure class="ltx_figure" id="S2.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="193" id="S2.F3.sf1.g1" src="extracted/5919322/img/data/input_0.png" width="197"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Example of an Embedded MA-XRF image</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="193" id="S2.F3.sf2.g1" src="extracted/5919322/img/data/RGB_0.png" width="197"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Relative RGB image</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Example of input-real output pair of the embedded dataset.</figcaption>
</figure>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">After having obtained a trained model following the procedure described in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS3" title="2.3 Training the Deep Embedding Model ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">2.3</span></a>, we can use it on the MA-XRF image dataset of <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS2" title="2.2 Preparing the synthetic dataset - part I: spectra ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">2.2</span></a>, and obtain a (disk occupation size reduced) dataset in embedded space, subbed embedded MA-XRF dataset.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">This grants us a dataset of size (we used the <span class="ltx_text ltx_font_smallcaps" id="S2.SS4.p2.1.1">PyTorch</span> <math alttext="[B,C,H,W]" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.4"><semantics id="S2.SS4.p2.1.m1.4a"><mrow id="S2.SS4.p2.1.m1.4.5.2" xref="S2.SS4.p2.1.m1.4.5.1.cmml"><mo id="S2.SS4.p2.1.m1.4.5.2.1" stretchy="false" xref="S2.SS4.p2.1.m1.4.5.1.cmml">[</mo><mi id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml">B</mi><mo id="S2.SS4.p2.1.m1.4.5.2.2" xref="S2.SS4.p2.1.m1.4.5.1.cmml">,</mo><mi id="S2.SS4.p2.1.m1.2.2" xref="S2.SS4.p2.1.m1.2.2.cmml">C</mi><mo id="S2.SS4.p2.1.m1.4.5.2.3" xref="S2.SS4.p2.1.m1.4.5.1.cmml">,</mo><mi id="S2.SS4.p2.1.m1.3.3" xref="S2.SS4.p2.1.m1.3.3.cmml">H</mi><mo id="S2.SS4.p2.1.m1.4.5.2.4" xref="S2.SS4.p2.1.m1.4.5.1.cmml">,</mo><mi id="S2.SS4.p2.1.m1.4.4" xref="S2.SS4.p2.1.m1.4.4.cmml">W</mi><mo id="S2.SS4.p2.1.m1.4.5.2.5" stretchy="false" xref="S2.SS4.p2.1.m1.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.4b"><list id="S2.SS4.p2.1.m1.4.5.1.cmml" xref="S2.SS4.p2.1.m1.4.5.2"><ci id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">𝐵</ci><ci id="S2.SS4.p2.1.m1.2.2.cmml" xref="S2.SS4.p2.1.m1.2.2">𝐶</ci><ci id="S2.SS4.p2.1.m1.3.3.cmml" xref="S2.SS4.p2.1.m1.3.3">𝐻</ci><ci id="S2.SS4.p2.1.m1.4.4.cmml" xref="S2.SS4.p2.1.m1.4.4">𝑊</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.4c">[B,C,H,W]</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.4d">[ italic_B , italic_C , italic_H , italic_W ]</annotation></semantics></math> ordering)</p>
<ul class="ltx_itemize" id="S2.I6">
<li class="ltx_item" id="S2.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I6.i1.p1">
<p class="ltx_p" id="S2.I6.i1.p1.1">Train set shape:           <math alttext="[208\,087,3,256,256]" class="ltx_Math" display="inline" id="S2.I6.i1.p1.1.m1.4"><semantics id="S2.I6.i1.p1.1.m1.4a"><mrow id="S2.I6.i1.p1.1.m1.4.5.2" xref="S2.I6.i1.p1.1.m1.4.5.1.cmml"><mo id="S2.I6.i1.p1.1.m1.4.5.2.1" stretchy="false" xref="S2.I6.i1.p1.1.m1.4.5.1.cmml">[</mo><mn id="S2.I6.i1.p1.1.m1.1.1" xref="S2.I6.i1.p1.1.m1.1.1.cmml">208 087</mn><mo id="S2.I6.i1.p1.1.m1.4.5.2.2" xref="S2.I6.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i1.p1.1.m1.2.2" xref="S2.I6.i1.p1.1.m1.2.2.cmml">3</mn><mo id="S2.I6.i1.p1.1.m1.4.5.2.3" xref="S2.I6.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i1.p1.1.m1.3.3" xref="S2.I6.i1.p1.1.m1.3.3.cmml">256</mn><mo id="S2.I6.i1.p1.1.m1.4.5.2.4" xref="S2.I6.i1.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i1.p1.1.m1.4.4" xref="S2.I6.i1.p1.1.m1.4.4.cmml">256</mn><mo id="S2.I6.i1.p1.1.m1.4.5.2.5" stretchy="false" xref="S2.I6.i1.p1.1.m1.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I6.i1.p1.1.m1.4b"><list id="S2.I6.i1.p1.1.m1.4.5.1.cmml" xref="S2.I6.i1.p1.1.m1.4.5.2"><cn id="S2.I6.i1.p1.1.m1.1.1.cmml" type="integer" xref="S2.I6.i1.p1.1.m1.1.1">208087</cn><cn id="S2.I6.i1.p1.1.m1.2.2.cmml" type="integer" xref="S2.I6.i1.p1.1.m1.2.2">3</cn><cn id="S2.I6.i1.p1.1.m1.3.3.cmml" type="integer" xref="S2.I6.i1.p1.1.m1.3.3">256</cn><cn id="S2.I6.i1.p1.1.m1.4.4.cmml" type="integer" xref="S2.I6.i1.p1.1.m1.4.4">256</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S2.I6.i1.p1.1.m1.4c">[208\,087,3,256,256]</annotation><annotation encoding="application/x-llamapun" id="S2.I6.i1.p1.1.m1.4d">[ 208 087 , 3 , 256 , 256 ]</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S2.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I6.i2.p1">
<p class="ltx_p" id="S2.I6.i2.p1.1">Validation set shape:   <math alttext="[\;\;60\,466,3,256,256]" class="ltx_Math" display="inline" id="S2.I6.i2.p1.1.m1.4"><semantics id="S2.I6.i2.p1.1.m1.4a"><mrow id="S2.I6.i2.p1.1.m1.4.5.2" xref="S2.I6.i2.p1.1.m1.4.5.1.cmml"><mo id="S2.I6.i2.p1.1.m1.4.5.2.1" stretchy="false" xref="S2.I6.i2.p1.1.m1.4.5.1.cmml">[</mo><mn id="S2.I6.i2.p1.1.m1.1.1" xref="S2.I6.i2.p1.1.m1.1.1.cmml">  60 466</mn><mo id="S2.I6.i2.p1.1.m1.4.5.2.2" xref="S2.I6.i2.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i2.p1.1.m1.2.2" xref="S2.I6.i2.p1.1.m1.2.2.cmml">3</mn><mo id="S2.I6.i2.p1.1.m1.4.5.2.3" xref="S2.I6.i2.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i2.p1.1.m1.3.3" xref="S2.I6.i2.p1.1.m1.3.3.cmml">256</mn><mo id="S2.I6.i2.p1.1.m1.4.5.2.4" xref="S2.I6.i2.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i2.p1.1.m1.4.4" xref="S2.I6.i2.p1.1.m1.4.4.cmml">256</mn><mo id="S2.I6.i2.p1.1.m1.4.5.2.5" stretchy="false" xref="S2.I6.i2.p1.1.m1.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I6.i2.p1.1.m1.4b"><list id="S2.I6.i2.p1.1.m1.4.5.1.cmml" xref="S2.I6.i2.p1.1.m1.4.5.2"><cn id="S2.I6.i2.p1.1.m1.1.1.cmml" type="integer" xref="S2.I6.i2.p1.1.m1.1.1">60466</cn><cn id="S2.I6.i2.p1.1.m1.2.2.cmml" type="integer" xref="S2.I6.i2.p1.1.m1.2.2">3</cn><cn id="S2.I6.i2.p1.1.m1.3.3.cmml" type="integer" xref="S2.I6.i2.p1.1.m1.3.3">256</cn><cn id="S2.I6.i2.p1.1.m1.4.4.cmml" type="integer" xref="S2.I6.i2.p1.1.m1.4.4">256</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S2.I6.i2.p1.1.m1.4c">[\;\;60\,466,3,256,256]</annotation><annotation encoding="application/x-llamapun" id="S2.I6.i2.p1.1.m1.4d">[ 60 466 , 3 , 256 , 256 ]</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S2.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I6.i3.p1">
<p class="ltx_p" id="S2.I6.i3.p1.1">Test set shape:            <math alttext="[\;\;30\,210,3,256,256]" class="ltx_Math" display="inline" id="S2.I6.i3.p1.1.m1.4"><semantics id="S2.I6.i3.p1.1.m1.4a"><mrow id="S2.I6.i3.p1.1.m1.4.5.2" xref="S2.I6.i3.p1.1.m1.4.5.1.cmml"><mo id="S2.I6.i3.p1.1.m1.4.5.2.1" stretchy="false" xref="S2.I6.i3.p1.1.m1.4.5.1.cmml">[</mo><mn id="S2.I6.i3.p1.1.m1.1.1" xref="S2.I6.i3.p1.1.m1.1.1.cmml">  30 210</mn><mo id="S2.I6.i3.p1.1.m1.4.5.2.2" xref="S2.I6.i3.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i3.p1.1.m1.2.2" xref="S2.I6.i3.p1.1.m1.2.2.cmml">3</mn><mo id="S2.I6.i3.p1.1.m1.4.5.2.3" xref="S2.I6.i3.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i3.p1.1.m1.3.3" xref="S2.I6.i3.p1.1.m1.3.3.cmml">256</mn><mo id="S2.I6.i3.p1.1.m1.4.5.2.4" xref="S2.I6.i3.p1.1.m1.4.5.1.cmml">,</mo><mn id="S2.I6.i3.p1.1.m1.4.4" xref="S2.I6.i3.p1.1.m1.4.4.cmml">256</mn><mo id="S2.I6.i3.p1.1.m1.4.5.2.5" stretchy="false" xref="S2.I6.i3.p1.1.m1.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I6.i3.p1.1.m1.4b"><list id="S2.I6.i3.p1.1.m1.4.5.1.cmml" xref="S2.I6.i3.p1.1.m1.4.5.2"><cn id="S2.I6.i3.p1.1.m1.1.1.cmml" type="integer" xref="S2.I6.i3.p1.1.m1.1.1">30210</cn><cn id="S2.I6.i3.p1.1.m1.2.2.cmml" type="integer" xref="S2.I6.i3.p1.1.m1.2.2">3</cn><cn id="S2.I6.i3.p1.1.m1.3.3.cmml" type="integer" xref="S2.I6.i3.p1.1.m1.3.3">256</cn><cn id="S2.I6.i3.p1.1.m1.4.4.cmml" type="integer" xref="S2.I6.i3.p1.1.m1.4.4">256</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S2.I6.i3.p1.1.m1.4c">[\;\;30\,210,3,256,256]</annotation><annotation encoding="application/x-llamapun" id="S2.I6.i3.p1.1.m1.4d">[ 30 210 , 3 , 256 , 256 ]</annotation></semantics></math></p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.1">Please notice that the embedded MA-XRF images have three channels, but are <span class="ltx_text ltx_font_italic" id="S2.SS4.p3.1.1">not</span> RGB images; it was a mere coincidence that the embedded space have the same dimensions as the target RGB space. Nevertheless, the approach described here would still work even if the two spaces have different dimensions.</p>
</div>
<div class="ltx_para" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.1">In <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.F3" title="In 2.4 Preparing the synthetic dataset - part II: embedded MA-XRF images ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> we report an example of a couple input-output <math alttext="[X,Y]" class="ltx_Math" display="inline" id="S2.SS4.p4.1.m1.2"><semantics id="S2.SS4.p4.1.m1.2a"><mrow id="S2.SS4.p4.1.m1.2.3.2" xref="S2.SS4.p4.1.m1.2.3.1.cmml"><mo id="S2.SS4.p4.1.m1.2.3.2.1" stretchy="false" xref="S2.SS4.p4.1.m1.2.3.1.cmml">[</mo><mi id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml">X</mi><mo id="S2.SS4.p4.1.m1.2.3.2.2" xref="S2.SS4.p4.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS4.p4.1.m1.2.2" xref="S2.SS4.p4.1.m1.2.2.cmml">Y</mi><mo id="S2.SS4.p4.1.m1.2.3.2.3" stretchy="false" xref="S2.SS4.p4.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.2b"><interval closure="closed" id="S2.SS4.p4.1.m1.2.3.1.cmml" xref="S2.SS4.p4.1.m1.2.3.2"><ci id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1">𝑋</ci><ci id="S2.SS4.p4.1.m1.2.2.cmml" xref="S2.SS4.p4.1.m1.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.2c">[X,Y]</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.2d">[ italic_X , italic_Y ]</annotation></semantics></math>. Notice that, due to the coincidence that the embedded space has 3 dimension, we can use false colours to represent the embedded MA-XRF.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Training the virtual recolouring model</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">We are now in the position to define a virtual recolouring model, whose goal is to map embedded MA-XRF images obtained in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS4" title="2.4 Preparing the synthetic dataset - part II: embedded MA-XRF images ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">2.4</span></a> to RGB images.</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="444" id="S2.F4.g1" src="x3.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Graphical representation of the SmallUViT model.</figcaption>
</figure>
<div class="ltx_para" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.1">As a model, we use a Vision Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib59" title="">59</a>]</cite> (for a nice survey, review, and introduction on Vision Transformers and their applications, see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib60" title="">60</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib62" title="">62</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib65" title="">65</a>]</cite>, and references therein). In particular, due to the limited size of the training dataset, we use a model based on the one presented in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib66" title="">66</a>]</cite>; <em class="ltx_emph ltx_font_italic" id="S2.SS5.p2.1.1">i.e</em>.<span class="ltx_text" id="S2.SS5.p2.1.2"></span>, we use <span class="ltx_text ltx_font_italic" id="S2.SS5.p2.1.3">Shifted Patch Tokenization</span> (SPT) embedding, and <span class="ltx_text ltx_font_italic" id="S2.SS5.p2.1.4">Locality Self-Attention</span> (LSA), whose aim is to solve the lack of locality inductive bias, and enable ViT models to learn from scratch on reduced-size datasets.</p>
</div>
<div class="ltx_para" id="S2.SS5.p3">
<p class="ltx_p" id="S2.SS5.p3.1">Furthermore, we employed long skip connections to form a U-ViT inner architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib67" title="">67</a>]</cite>. Each transformer block in the backbone has thus a LSA multi-head part, and a Feed Forward (FF) part; the Feed Forward part is comprised of a sequential model of Linear Layer, Dropout layer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib68" title="">68</a>]</cite>, GELU activation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib69" title="">69</a>]</cite>, followed again by a Linear layer and a dropout layer.</p>
</div>
<div class="ltx_para" id="S2.SS5.p4">
<p class="ltx_p" id="S2.SS5.p4.2">After the U-shaped transformer layers, we have a Linear layer followed by a rearranging layer of the elaborated visual tokens (done using the <span class="ltx_text ltx_font_smallcaps" id="S2.SS5.p4.2.1">einops</span> package <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib70" title="">70</a>]</cite>). The reconstructed tensor of shape <math alttext="(B,C,H,W)" class="ltx_Math" display="inline" id="S2.SS5.p4.1.m1.4"><semantics id="S2.SS5.p4.1.m1.4a"><mrow id="S2.SS5.p4.1.m1.4.5.2" xref="S2.SS5.p4.1.m1.4.5.1.cmml"><mo id="S2.SS5.p4.1.m1.4.5.2.1" stretchy="false" xref="S2.SS5.p4.1.m1.4.5.1.cmml">(</mo><mi id="S2.SS5.p4.1.m1.1.1" xref="S2.SS5.p4.1.m1.1.1.cmml">B</mi><mo id="S2.SS5.p4.1.m1.4.5.2.2" xref="S2.SS5.p4.1.m1.4.5.1.cmml">,</mo><mi id="S2.SS5.p4.1.m1.2.2" xref="S2.SS5.p4.1.m1.2.2.cmml">C</mi><mo id="S2.SS5.p4.1.m1.4.5.2.3" xref="S2.SS5.p4.1.m1.4.5.1.cmml">,</mo><mi id="S2.SS5.p4.1.m1.3.3" xref="S2.SS5.p4.1.m1.3.3.cmml">H</mi><mo id="S2.SS5.p4.1.m1.4.5.2.4" xref="S2.SS5.p4.1.m1.4.5.1.cmml">,</mo><mi id="S2.SS5.p4.1.m1.4.4" xref="S2.SS5.p4.1.m1.4.4.cmml">W</mi><mo id="S2.SS5.p4.1.m1.4.5.2.5" stretchy="false" xref="S2.SS5.p4.1.m1.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p4.1.m1.4b"><vector id="S2.SS5.p4.1.m1.4.5.1.cmml" xref="S2.SS5.p4.1.m1.4.5.2"><ci id="S2.SS5.p4.1.m1.1.1.cmml" xref="S2.SS5.p4.1.m1.1.1">𝐵</ci><ci id="S2.SS5.p4.1.m1.2.2.cmml" xref="S2.SS5.p4.1.m1.2.2">𝐶</ci><ci id="S2.SS5.p4.1.m1.3.3.cmml" xref="S2.SS5.p4.1.m1.3.3">𝐻</ci><ci id="S2.SS5.p4.1.m1.4.4.cmml" xref="S2.SS5.p4.1.m1.4.4">𝑊</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p4.1.m1.4c">(B,C,H,W)</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p4.1.m1.4d">( italic_B , italic_C , italic_H , italic_W )</annotation></semantics></math> is thus passed to a final convolutional layer with <math alttext="3\times 3" class="ltx_Math" display="inline" id="S2.SS5.p4.2.m2.1"><semantics id="S2.SS5.p4.2.m2.1a"><mrow id="S2.SS5.p4.2.m2.1.1" xref="S2.SS5.p4.2.m2.1.1.cmml"><mn id="S2.SS5.p4.2.m2.1.1.2" xref="S2.SS5.p4.2.m2.1.1.2.cmml">3</mn><mo id="S2.SS5.p4.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p4.2.m2.1.1.1.cmml">×</mo><mn id="S2.SS5.p4.2.m2.1.1.3" xref="S2.SS5.p4.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p4.2.m2.1b"><apply id="S2.SS5.p4.2.m2.1.1.cmml" xref="S2.SS5.p4.2.m2.1.1"><times id="S2.SS5.p4.2.m2.1.1.1.cmml" xref="S2.SS5.p4.2.m2.1.1.1"></times><cn id="S2.SS5.p4.2.m2.1.1.2.cmml" type="integer" xref="S2.SS5.p4.2.m2.1.1.2">3</cn><cn id="S2.SS5.p4.2.m2.1.1.3.cmml" type="integer" xref="S2.SS5.p4.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p4.2.m2.1c">3\times 3</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p4.2.m2.1d">3 × 3</annotation></semantics></math> kernel.</p>
</div>
<div class="ltx_para" id="S2.SS5.p5">
<p class="ltx_p" id="S2.SS5.p5.1">For simplicity, we will refer in thefollowing to this architecture as <span class="ltx_text ltx_font_bold" id="S2.SS5.p5.1.1">SmallUViT</span> (U-Net based Vision Transformer for Small dataset tasks).</p>
</div>
<div class="ltx_para" id="S2.SS5.p6">
<p class="ltx_p" id="S2.SS5.p6.1">We used <span class="ltx_text ltx_font_italic" id="S2.SS5.p6.1.1">Stochastic Depth</span> during training <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib71" title="">71</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib72" title="">72</a>]</cite> (in an implementation inspired to the <span class="ltx_text ltx_font_italic" id="S2.SS5.p6.1.2">PyTorch Image Models </span> (timm) library <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib73" title="">73</a>]</cite>, as done in the UViT paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib67" title="">67</a>]</cite>, following the recipe of the DeiT paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib74" title="">74</a>]</cite>). We have also used data augmentations during training using the standard <span class="ltx_text ltx_font_smallcaps" id="S2.SS5.p6.1.3">torchvision</span> transformations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib75" title="">75</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS5.p7">
<p class="ltx_p" id="S2.SS5.p7.1">During training, the learning rate is changed dynamically via the <span class="ltx_text ltx_font_smallcaps" id="S2.SS5.p7.1.1">PyTorch</span> native <span class="ltx_text ltx_font_smallcaps" id="S2.SS5.p7.1.2">ReduceLROnPLateu</span> function by monitoring the selected metric, which is the <span class="ltx_text ltx_font_italic" id="S2.SS5.p7.1.3">Multi-Scale Structural Similarity Index</span> (MS-SSIM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib76" title="">76</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib77" title="">77</a>]</cite> in the Lightning AI <span class="ltx_text ltx_font_smallcaps" id="S2.SS5.p7.1.4">torchmetrics</span> implementation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib78" title="">78</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS5.p8">
<p class="ltx_p" id="S2.SS5.p8.1">We arrived at the formulation of this architecture by trial-and-error on multiple architectures, starting from the plain ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib59" title="">59</a>]</cite>, the UViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib67" title="">67</a>]</cite>, the SWIN transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib79" title="">79</a>]</cite>, and the SEgmentation TRansformer (SETR) with progressive up-sampling design (SETR-PUP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib80" title="">80</a>]</cite>. We trained various implementation of such architecture (and mixture of them) on a reduced dataset (sampled from the full one), in a plain grid-search approach, finding the most performing one at (almost) fixed number of parameters, <em class="ltx_emph ltx_font_italic" id="S2.SS5.p8.1.1">i.e</em>.<span class="ltx_text" id="S2.SS5.p8.1.2"></span> the aforementioned SmallUViT<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>In this exploratory phase, we started by training convolutional-based networks which, at fixed model size, had worse performances on the loss and metric used.</span></span></span>.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.5.1 </span>A note on colour distance and training loss: sRGB</h4>
<div class="ltx_para" id="S2.SS5.SSS1.p1">
<p class="ltx_p" id="S2.SS5.SSS1.p1.1"><span class="ltx_text ltx_phantom" id="S2.SS5.SSS1.p1.1.1"><span style="visibility:hidden">.</span></span></p>
</div>
<div class="ltx_para" id="S2.SS5.SSS1.p2">
<p class="ltx_p" id="S2.SS5.SSS1.p2.3">To train the SmallUViT model we have used an ad hoc distance for the loss, to take in account perceptual differences in colors; due to its simple implementation, we used the CompuPhase <span class="ltx_text ltx_font_italic" id="S2.SS5.SSS1.p2.3.1">redmean</span> sRGB distance approximation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib81" title="">81</a>]</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Ax1.EGx1">
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\delta(C_{1},C_{2})" class="ltx_Math" display="inline" id="S2.E5.m1.2"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><mi id="S2.E5.m1.2.2.4" xref="S2.E5.m1.2.2.4.cmml">δ</mi><mo id="S2.E5.m1.2.2.3" xref="S2.E5.m1.2.2.3.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.3.cmml"><mo id="S2.E5.m1.2.2.2.2.3" stretchy="false" xref="S2.E5.m1.2.2.2.3.cmml">(</mo><msub id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">C</mi><mn id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E5.m1.2.2.2.2.4" xref="S2.E5.m1.2.2.2.3.cmml">,</mo><msub id="S2.E5.m1.2.2.2.2.2" xref="S2.E5.m1.2.2.2.2.2.cmml"><mi id="S2.E5.m1.2.2.2.2.2.2" xref="S2.E5.m1.2.2.2.2.2.2.cmml">C</mi><mn id="S2.E5.m1.2.2.2.2.2.3" xref="S2.E5.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.E5.m1.2.2.2.2.5" stretchy="false" xref="S2.E5.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><times id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2.3"></times><ci id="S2.E5.m1.2.2.4.cmml" xref="S2.E5.m1.2.2.4">𝛿</ci><interval closure="open" id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.2"><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2">𝐶</ci><cn id="S2.E5.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E5.m1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E5.m1.2.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.E5.m1.2.2.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2.2.2">𝐶</ci><cn id="S2.E5.m1.2.2.2.2.2.3.cmml" type="integer" xref="S2.E5.m1.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\displaystyle\delta(C_{1},C_{2})</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.2d">italic_δ ( italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_C start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sqrt{(2+r)\Delta r^{2}+4\Delta g^{2}+(3-r)\Delta b^{2}}\,,\quad
r%
\equiv\frac{r_{1}+r_{2}}{2}\,," class="ltx_Math" display="inline" id="S2.E5.m2.3"><semantics id="S2.E5.m2.3a"><mrow id="S2.E5.m2.3.3.1"><mrow id="S2.E5.m2.3.3.1.1.2" xref="S2.E5.m2.3.3.1.1.3.cmml"><mrow id="S2.E5.m2.3.3.1.1.1.1" xref="S2.E5.m2.3.3.1.1.1.1.cmml"><mi id="S2.E5.m2.3.3.1.1.1.1.2" xref="S2.E5.m2.3.3.1.1.1.1.2.cmml"></mi><mo id="S2.E5.m2.3.3.1.1.1.1.1" xref="S2.E5.m2.3.3.1.1.1.1.1.cmml">=</mo><msqrt id="S2.E5.m2.2.2" xref="S2.E5.m2.2.2.cmml"><mrow id="S2.E5.m2.2.2.2" xref="S2.E5.m2.2.2.2.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m2.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml"><mn id="S2.E5.m2.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.2.cmml">2</mn><mo id="S2.E5.m2.1.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E5.m2.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.3.cmml">r</mi></mrow><mo id="S2.E5.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E5.m2.1.1.1.1.3" mathvariant="normal" xref="S2.E5.m2.1.1.1.1.3.cmml">Δ</mi><mo id="S2.E5.m2.1.1.1.1.2a" xref="S2.E5.m2.1.1.1.1.2.cmml">⁢</mo><msup id="S2.E5.m2.1.1.1.1.4" xref="S2.E5.m2.1.1.1.1.4.cmml"><mi id="S2.E5.m2.1.1.1.1.4.2" xref="S2.E5.m2.1.1.1.1.4.2.cmml">r</mi><mn id="S2.E5.m2.1.1.1.1.4.3" xref="S2.E5.m2.1.1.1.1.4.3.cmml">2</mn></msup></mrow><mo id="S2.E5.m2.2.2.2.3" xref="S2.E5.m2.2.2.2.3.cmml">+</mo><mrow id="S2.E5.m2.2.2.2.4" xref="S2.E5.m2.2.2.2.4.cmml"><mn id="S2.E5.m2.2.2.2.4.2" xref="S2.E5.m2.2.2.2.4.2.cmml">4</mn><mo id="S2.E5.m2.2.2.2.4.1" xref="S2.E5.m2.2.2.2.4.1.cmml">⁢</mo><mi id="S2.E5.m2.2.2.2.4.3" mathvariant="normal" xref="S2.E5.m2.2.2.2.4.3.cmml">Δ</mi><mo id="S2.E5.m2.2.2.2.4.1a" xref="S2.E5.m2.2.2.2.4.1.cmml">⁢</mo><msup id="S2.E5.m2.2.2.2.4.4" xref="S2.E5.m2.2.2.2.4.4.cmml"><mi id="S2.E5.m2.2.2.2.4.4.2" xref="S2.E5.m2.2.2.2.4.4.2.cmml">g</mi><mn id="S2.E5.m2.2.2.2.4.4.3" xref="S2.E5.m2.2.2.2.4.4.3.cmml">2</mn></msup></mrow><mo id="S2.E5.m2.2.2.2.3a" xref="S2.E5.m2.2.2.2.3.cmml">+</mo><mrow id="S2.E5.m2.2.2.2.2" xref="S2.E5.m2.2.2.2.2.cmml"><mrow id="S2.E5.m2.2.2.2.2.1.1" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml"><mo id="S2.E5.m2.2.2.2.2.1.1.2" stretchy="false" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m2.2.2.2.2.1.1.1" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml"><mn id="S2.E5.m2.2.2.2.2.1.1.1.2" xref="S2.E5.m2.2.2.2.2.1.1.1.2.cmml">3</mn><mo id="S2.E5.m2.2.2.2.2.1.1.1.1" xref="S2.E5.m2.2.2.2.2.1.1.1.1.cmml">−</mo><mi id="S2.E5.m2.2.2.2.2.1.1.1.3" xref="S2.E5.m2.2.2.2.2.1.1.1.3.cmml">r</mi></mrow><mo id="S2.E5.m2.2.2.2.2.1.1.3" stretchy="false" xref="S2.E5.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m2.2.2.2.2.2" xref="S2.E5.m2.2.2.2.2.2.cmml">⁢</mo><mi id="S2.E5.m2.2.2.2.2.3" mathvariant="normal" xref="S2.E5.m2.2.2.2.2.3.cmml">Δ</mi><mo id="S2.E5.m2.2.2.2.2.2a" xref="S2.E5.m2.2.2.2.2.2.cmml">⁢</mo><msup id="S2.E5.m2.2.2.2.2.4" xref="S2.E5.m2.2.2.2.2.4.cmml"><mi id="S2.E5.m2.2.2.2.2.4.2" xref="S2.E5.m2.2.2.2.2.4.2.cmml">b</mi><mn id="S2.E5.m2.2.2.2.2.4.3" xref="S2.E5.m2.2.2.2.2.4.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><mo id="S2.E5.m2.3.3.1.1.2.3" lspace="0.170em" rspace="1.167em" xref="S2.E5.m2.3.3.1.1.3a.cmml">,</mo><mrow id="S2.E5.m2.3.3.1.1.2.2" xref="S2.E5.m2.3.3.1.1.2.2.cmml"><mi id="S2.E5.m2.3.3.1.1.2.2.2" xref="S2.E5.m2.3.3.1.1.2.2.2.cmml">r</mi><mo id="S2.E5.m2.3.3.1.1.2.2.1" xref="S2.E5.m2.3.3.1.1.2.2.1.cmml">≡</mo><mstyle displaystyle="true" id="S2.E5.m2.3.3.1.1.2.2.3" xref="S2.E5.m2.3.3.1.1.2.2.3.cmml"><mfrac id="S2.E5.m2.3.3.1.1.2.2.3a" xref="S2.E5.m2.3.3.1.1.2.2.3.cmml"><mrow id="S2.E5.m2.3.3.1.1.2.2.3.2" xref="S2.E5.m2.3.3.1.1.2.2.3.2.cmml"><msub id="S2.E5.m2.3.3.1.1.2.2.3.2.2" xref="S2.E5.m2.3.3.1.1.2.2.3.2.2.cmml"><mi id="S2.E5.m2.3.3.1.1.2.2.3.2.2.2" xref="S2.E5.m2.3.3.1.1.2.2.3.2.2.2.cmml">r</mi><mn id="S2.E5.m2.3.3.1.1.2.2.3.2.2.3" xref="S2.E5.m2.3.3.1.1.2.2.3.2.2.3.cmml">1</mn></msub><mo id="S2.E5.m2.3.3.1.1.2.2.3.2.1" xref="S2.E5.m2.3.3.1.1.2.2.3.2.1.cmml">+</mo><msub id="S2.E5.m2.3.3.1.1.2.2.3.2.3" xref="S2.E5.m2.3.3.1.1.2.2.3.2.3.cmml"><mi id="S2.E5.m2.3.3.1.1.2.2.3.2.3.2" xref="S2.E5.m2.3.3.1.1.2.2.3.2.3.2.cmml">r</mi><mn id="S2.E5.m2.3.3.1.1.2.2.3.2.3.3" xref="S2.E5.m2.3.3.1.1.2.2.3.2.3.3.cmml">2</mn></msub></mrow><mn id="S2.E5.m2.3.3.1.1.2.2.3.3" xref="S2.E5.m2.3.3.1.1.2.2.3.3.cmml">2</mn></mfrac></mstyle></mrow></mrow><mo id="S2.E5.m2.3.3.1.2" lspace="0.170em">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.3b"><apply id="S2.E5.m2.3.3.1.1.3.cmml" xref="S2.E5.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.1.1.3a.cmml" xref="S2.E5.m2.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E5.m2.3.3.1.1.1.1.cmml" xref="S2.E5.m2.3.3.1.1.1.1"><eq id="S2.E5.m2.3.3.1.1.1.1.1.cmml" xref="S2.E5.m2.3.3.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E5.m2.3.3.1.1.1.1.2.cmml" xref="S2.E5.m2.3.3.1.1.1.1.2">absent</csymbol><apply id="S2.E5.m2.2.2.cmml" xref="S2.E5.m2.2.2"><root id="S2.E5.m2.2.2a.cmml" xref="S2.E5.m2.2.2"></root><apply id="S2.E5.m2.2.2.2.cmml" xref="S2.E5.m2.2.2.2"><plus id="S2.E5.m2.2.2.2.3.cmml" xref="S2.E5.m2.2.2.2.3"></plus><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1"><times id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2"></times><apply id="S2.E5.m2.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1"><plus id="S2.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1"></plus><cn id="S2.E5.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E5.m2.1.1.1.1.1.1.1.2">2</cn><ci id="S2.E5.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.3">𝑟</ci></apply><ci id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3">Δ</ci><apply id="S2.E5.m2.1.1.1.1.4.cmml" xref="S2.E5.m2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.4.1.cmml" xref="S2.E5.m2.1.1.1.1.4">superscript</csymbol><ci id="S2.E5.m2.1.1.1.1.4.2.cmml" xref="S2.E5.m2.1.1.1.1.4.2">𝑟</ci><cn id="S2.E5.m2.1.1.1.1.4.3.cmml" type="integer" xref="S2.E5.m2.1.1.1.1.4.3">2</cn></apply></apply><apply id="S2.E5.m2.2.2.2.4.cmml" xref="S2.E5.m2.2.2.2.4"><times id="S2.E5.m2.2.2.2.4.1.cmml" xref="S2.E5.m2.2.2.2.4.1"></times><cn id="S2.E5.m2.2.2.2.4.2.cmml" type="integer" xref="S2.E5.m2.2.2.2.4.2">4</cn><ci id="S2.E5.m2.2.2.2.4.3.cmml" xref="S2.E5.m2.2.2.2.4.3">Δ</ci><apply id="S2.E5.m2.2.2.2.4.4.cmml" xref="S2.E5.m2.2.2.2.4.4"><csymbol cd="ambiguous" id="S2.E5.m2.2.2.2.4.4.1.cmml" xref="S2.E5.m2.2.2.2.4.4">superscript</csymbol><ci id="S2.E5.m2.2.2.2.4.4.2.cmml" xref="S2.E5.m2.2.2.2.4.4.2">𝑔</ci><cn id="S2.E5.m2.2.2.2.4.4.3.cmml" type="integer" xref="S2.E5.m2.2.2.2.4.4.3">2</cn></apply></apply><apply id="S2.E5.m2.2.2.2.2.cmml" xref="S2.E5.m2.2.2.2.2"><times id="S2.E5.m2.2.2.2.2.2.cmml" xref="S2.E5.m2.2.2.2.2.2"></times><apply id="S2.E5.m2.2.2.2.2.1.1.1.cmml" xref="S2.E5.m2.2.2.2.2.1.1"><minus id="S2.E5.m2.2.2.2.2.1.1.1.1.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.1"></minus><cn id="S2.E5.m2.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S2.E5.m2.2.2.2.2.1.1.1.2">3</cn><ci id="S2.E5.m2.2.2.2.2.1.1.1.3.cmml" xref="S2.E5.m2.2.2.2.2.1.1.1.3">𝑟</ci></apply><ci id="S2.E5.m2.2.2.2.2.3.cmml" xref="S2.E5.m2.2.2.2.2.3">Δ</ci><apply id="S2.E5.m2.2.2.2.2.4.cmml" xref="S2.E5.m2.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E5.m2.2.2.2.2.4.1.cmml" xref="S2.E5.m2.2.2.2.2.4">superscript</csymbol><ci id="S2.E5.m2.2.2.2.2.4.2.cmml" xref="S2.E5.m2.2.2.2.2.4.2">𝑏</ci><cn id="S2.E5.m2.2.2.2.2.4.3.cmml" type="integer" xref="S2.E5.m2.2.2.2.2.4.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.E5.m2.3.3.1.1.2.2.cmml" xref="S2.E5.m2.3.3.1.1.2.2"><equivalent id="S2.E5.m2.3.3.1.1.2.2.1.cmml" xref="S2.E5.m2.3.3.1.1.2.2.1"></equivalent><ci id="S2.E5.m2.3.3.1.1.2.2.2.cmml" xref="S2.E5.m2.3.3.1.1.2.2.2">𝑟</ci><apply id="S2.E5.m2.3.3.1.1.2.2.3.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3"><divide id="S2.E5.m2.3.3.1.1.2.2.3.1.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3"></divide><apply id="S2.E5.m2.3.3.1.1.2.2.3.2.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2"><plus id="S2.E5.m2.3.3.1.1.2.2.3.2.1.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2.1"></plus><apply id="S2.E5.m2.3.3.1.1.2.2.3.2.2.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.1.1.2.2.3.2.2.1.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2.2">subscript</csymbol><ci id="S2.E5.m2.3.3.1.1.2.2.3.2.2.2.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2.2.2">𝑟</ci><cn id="S2.E5.m2.3.3.1.1.2.2.3.2.2.3.cmml" type="integer" xref="S2.E5.m2.3.3.1.1.2.2.3.2.2.3">1</cn></apply><apply id="S2.E5.m2.3.3.1.1.2.2.3.2.3.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.1.1.2.2.3.2.3.1.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2.3">subscript</csymbol><ci id="S2.E5.m2.3.3.1.1.2.2.3.2.3.2.cmml" xref="S2.E5.m2.3.3.1.1.2.2.3.2.3.2">𝑟</ci><cn id="S2.E5.m2.3.3.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S2.E5.m2.3.3.1.1.2.2.3.2.3.3">2</cn></apply></apply><cn id="S2.E5.m2.3.3.1.1.2.2.3.3.cmml" type="integer" xref="S2.E5.m2.3.3.1.1.2.2.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.3c">\displaystyle=\sqrt{(2+r)\Delta r^{2}+4\Delta g^{2}+(3-r)\Delta b^{2}}\,,\quad
r%
\equiv\frac{r_{1}+r_{2}}{2}\,,</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m2.3d">= square-root start_ARG ( 2 + italic_r ) roman_Δ italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 roman_Δ italic_g start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( 3 - italic_r ) roman_Δ italic_b start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG , italic_r ≡ divide start_ARG italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.SSS1.p2.2">where <math alttext="C_{i}=[r_{i},g_{i},b_{i}]" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p2.1.m1.3"><semantics id="S2.SS5.SSS1.p2.1.m1.3a"><mrow id="S2.SS5.SSS1.p2.1.m1.3.3" xref="S2.SS5.SSS1.p2.1.m1.3.3.cmml"><msub id="S2.SS5.SSS1.p2.1.m1.3.3.5" xref="S2.SS5.SSS1.p2.1.m1.3.3.5.cmml"><mi id="S2.SS5.SSS1.p2.1.m1.3.3.5.2" xref="S2.SS5.SSS1.p2.1.m1.3.3.5.2.cmml">C</mi><mi id="S2.SS5.SSS1.p2.1.m1.3.3.5.3" xref="S2.SS5.SSS1.p2.1.m1.3.3.5.3.cmml">i</mi></msub><mo id="S2.SS5.SSS1.p2.1.m1.3.3.4" xref="S2.SS5.SSS1.p2.1.m1.3.3.4.cmml">=</mo><mrow id="S2.SS5.SSS1.p2.1.m1.3.3.3.3" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.4.cmml"><mo id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.4" stretchy="false" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.4.cmml">[</mo><msub id="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1" xref="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.2" xref="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.2.cmml">r</mi><mi id="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.5" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.4.cmml">,</mo><msub id="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2" xref="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.2" xref="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.2.cmml">g</mi><mi id="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.3" xref="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.6" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.4.cmml">,</mo><msub id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.cmml"><mi id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.2" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.2.cmml">b</mi><mi id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.3" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.7" stretchy="false" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p2.1.m1.3b"><apply id="S2.SS5.SSS1.p2.1.m1.3.3.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3"><eq id="S2.SS5.SSS1.p2.1.m1.3.3.4.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.4"></eq><apply id="S2.SS5.SSS1.p2.1.m1.3.3.5.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.5"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p2.1.m1.3.3.5.1.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.5">subscript</csymbol><ci id="S2.SS5.SSS1.p2.1.m1.3.3.5.2.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.5.2">𝐶</ci><ci id="S2.SS5.SSS1.p2.1.m1.3.3.5.3.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.5.3">𝑖</ci></apply><list id="S2.SS5.SSS1.p2.1.m1.3.3.3.4.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3"><apply id="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.2">𝑟</ci><ci id="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS5.SSS1.p2.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.cmml" xref="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.2">𝑔</ci><ci id="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS5.SSS1.p2.1.m1.2.2.2.2.2.3">𝑖</ci></apply><apply id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.1.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.2.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.2">𝑏</ci><ci id="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.3.cmml" xref="S2.SS5.SSS1.p2.1.m1.3.3.3.3.3.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p2.1.m1.3c">C_{i}=[r_{i},g_{i},b_{i}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p2.1.m1.3d">italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = [ italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ]</annotation></semantics></math>, <math alttext="\Delta r\equiv r_{2}-r_{1}" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p2.2.m2.1"><semantics id="S2.SS5.SSS1.p2.2.m2.1a"><mrow id="S2.SS5.SSS1.p2.2.m2.1.1" xref="S2.SS5.SSS1.p2.2.m2.1.1.cmml"><mrow id="S2.SS5.SSS1.p2.2.m2.1.1.2" xref="S2.SS5.SSS1.p2.2.m2.1.1.2.cmml"><mi id="S2.SS5.SSS1.p2.2.m2.1.1.2.2" mathvariant="normal" xref="S2.SS5.SSS1.p2.2.m2.1.1.2.2.cmml">Δ</mi><mo id="S2.SS5.SSS1.p2.2.m2.1.1.2.1" xref="S2.SS5.SSS1.p2.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S2.SS5.SSS1.p2.2.m2.1.1.2.3" xref="S2.SS5.SSS1.p2.2.m2.1.1.2.3.cmml">r</mi></mrow><mo id="S2.SS5.SSS1.p2.2.m2.1.1.1" xref="S2.SS5.SSS1.p2.2.m2.1.1.1.cmml">≡</mo><mrow id="S2.SS5.SSS1.p2.2.m2.1.1.3" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.cmml"><msub id="S2.SS5.SSS1.p2.2.m2.1.1.3.2" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.2.cmml"><mi id="S2.SS5.SSS1.p2.2.m2.1.1.3.2.2" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.2.2.cmml">r</mi><mn id="S2.SS5.SSS1.p2.2.m2.1.1.3.2.3" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.2.3.cmml">2</mn></msub><mo id="S2.SS5.SSS1.p2.2.m2.1.1.3.1" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.1.cmml">−</mo><msub id="S2.SS5.SSS1.p2.2.m2.1.1.3.3" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.3.cmml"><mi id="S2.SS5.SSS1.p2.2.m2.1.1.3.3.2" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.3.2.cmml">r</mi><mn id="S2.SS5.SSS1.p2.2.m2.1.1.3.3.3" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p2.2.m2.1b"><apply id="S2.SS5.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1"><equivalent id="S2.SS5.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.1"></equivalent><apply id="S2.SS5.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.2"><times id="S2.SS5.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.2.1"></times><ci id="S2.SS5.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.2.2">Δ</ci><ci id="S2.SS5.SSS1.p2.2.m2.1.1.2.3.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.2.3">𝑟</ci></apply><apply id="S2.SS5.SSS1.p2.2.m2.1.1.3.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3"><minus id="S2.SS5.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.1"></minus><apply id="S2.SS5.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p2.2.m2.1.1.3.2.1.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.2">subscript</csymbol><ci id="S2.SS5.SSS1.p2.2.m2.1.1.3.2.2.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.2.2">𝑟</ci><cn id="S2.SS5.SSS1.p2.2.m2.1.1.3.2.3.cmml" type="integer" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.2.3">2</cn></apply><apply id="S2.SS5.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.3">subscript</csymbol><ci id="S2.SS5.SSS1.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.3.2">𝑟</ci><cn id="S2.SS5.SSS1.p2.2.m2.1.1.3.3.3.cmml" type="integer" xref="S2.SS5.SSS1.p2.2.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p2.2.m2.1c">\Delta r\equiv r_{2}-r_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p2.2.m2.1d">roman_Δ italic_r ≡ italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, and similarly for the other channels.</p>
</div>
<div class="ltx_para" id="S2.SS5.SSS1.p3">
<p class="ltx_p" id="S2.SS5.SSS1.p3.3">Thus the loss is</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{sRGB}}(y,\hat{y})=\frac{1}{H\cdot W}\sum_{h,w}\frac{1}{N_%
{b}}\sum_{b=1}^{N_{b}}\delta(y_{b,c,h,w},\hat{y}_{b,c,h,w})\,," class="ltx_Math" display="block" id="S2.E6.m1.13"><semantics id="S2.E6.m1.13a"><mrow id="S2.E6.m1.13.13.1" xref="S2.E6.m1.13.13.1.1.cmml"><mrow id="S2.E6.m1.13.13.1.1" xref="S2.E6.m1.13.13.1.1.cmml"><mrow id="S2.E6.m1.13.13.1.1.4" xref="S2.E6.m1.13.13.1.1.4.cmml"><msub id="S2.E6.m1.13.13.1.1.4.2" xref="S2.E6.m1.13.13.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.13.13.1.1.4.2.2" xref="S2.E6.m1.13.13.1.1.4.2.2.cmml">ℒ</mi><mi id="S2.E6.m1.13.13.1.1.4.2.3" xref="S2.E6.m1.13.13.1.1.4.2.3.cmml">sRGB</mi></msub><mo id="S2.E6.m1.13.13.1.1.4.1" xref="S2.E6.m1.13.13.1.1.4.1.cmml">⁢</mo><mrow id="S2.E6.m1.13.13.1.1.4.3.2" xref="S2.E6.m1.13.13.1.1.4.3.1.cmml"><mo id="S2.E6.m1.13.13.1.1.4.3.2.1" stretchy="false" xref="S2.E6.m1.13.13.1.1.4.3.1.cmml">(</mo><mi id="S2.E6.m1.11.11" xref="S2.E6.m1.11.11.cmml">y</mi><mo id="S2.E6.m1.13.13.1.1.4.3.2.2" xref="S2.E6.m1.13.13.1.1.4.3.1.cmml">,</mo><mover accent="true" id="S2.E6.m1.12.12" xref="S2.E6.m1.12.12.cmml"><mi id="S2.E6.m1.12.12.2" xref="S2.E6.m1.12.12.2.cmml">y</mi><mo id="S2.E6.m1.12.12.1" xref="S2.E6.m1.12.12.1.cmml">^</mo></mover><mo id="S2.E6.m1.13.13.1.1.4.3.2.3" stretchy="false" xref="S2.E6.m1.13.13.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.13.13.1.1.3" xref="S2.E6.m1.13.13.1.1.3.cmml">=</mo><mrow id="S2.E6.m1.13.13.1.1.2" xref="S2.E6.m1.13.13.1.1.2.cmml"><mfrac id="S2.E6.m1.13.13.1.1.2.4" xref="S2.E6.m1.13.13.1.1.2.4.cmml"><mn id="S2.E6.m1.13.13.1.1.2.4.2" xref="S2.E6.m1.13.13.1.1.2.4.2.cmml">1</mn><mrow id="S2.E6.m1.13.13.1.1.2.4.3" xref="S2.E6.m1.13.13.1.1.2.4.3.cmml"><mi id="S2.E6.m1.13.13.1.1.2.4.3.2" xref="S2.E6.m1.13.13.1.1.2.4.3.2.cmml">H</mi><mo id="S2.E6.m1.13.13.1.1.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E6.m1.13.13.1.1.2.4.3.1.cmml">⋅</mo><mi id="S2.E6.m1.13.13.1.1.2.4.3.3" xref="S2.E6.m1.13.13.1.1.2.4.3.3.cmml">W</mi></mrow></mfrac><mo id="S2.E6.m1.13.13.1.1.2.3" xref="S2.E6.m1.13.13.1.1.2.3.cmml">⁢</mo><mrow id="S2.E6.m1.13.13.1.1.2.2" xref="S2.E6.m1.13.13.1.1.2.2.cmml"><munder id="S2.E6.m1.13.13.1.1.2.2.3" xref="S2.E6.m1.13.13.1.1.2.2.3.cmml"><mo id="S2.E6.m1.13.13.1.1.2.2.3.2" movablelimits="false" xref="S2.E6.m1.13.13.1.1.2.2.3.2.cmml">∑</mo><mrow id="S2.E6.m1.2.2.2.4" xref="S2.E6.m1.2.2.2.3.cmml"><mi id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml">h</mi><mo id="S2.E6.m1.2.2.2.4.1" xref="S2.E6.m1.2.2.2.3.cmml">,</mo><mi id="S2.E6.m1.2.2.2.2" xref="S2.E6.m1.2.2.2.2.cmml">w</mi></mrow></munder><mrow id="S2.E6.m1.13.13.1.1.2.2.2" xref="S2.E6.m1.13.13.1.1.2.2.2.cmml"><mfrac id="S2.E6.m1.13.13.1.1.2.2.2.4" xref="S2.E6.m1.13.13.1.1.2.2.2.4.cmml"><mn id="S2.E6.m1.13.13.1.1.2.2.2.4.2" xref="S2.E6.m1.13.13.1.1.2.2.2.4.2.cmml">1</mn><msub id="S2.E6.m1.13.13.1.1.2.2.2.4.3" xref="S2.E6.m1.13.13.1.1.2.2.2.4.3.cmml"><mi id="S2.E6.m1.13.13.1.1.2.2.2.4.3.2" xref="S2.E6.m1.13.13.1.1.2.2.2.4.3.2.cmml">N</mi><mi id="S2.E6.m1.13.13.1.1.2.2.2.4.3.3" xref="S2.E6.m1.13.13.1.1.2.2.2.4.3.3.cmml">b</mi></msub></mfrac><mo id="S2.E6.m1.13.13.1.1.2.2.2.3" xref="S2.E6.m1.13.13.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E6.m1.13.13.1.1.2.2.2.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.cmml"><munderover id="S2.E6.m1.13.13.1.1.2.2.2.2.3" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.cmml"><mo id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.2" movablelimits="false" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.cmml"><mi id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.2.cmml">b</mi><mo id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.1" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.3" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S2.E6.m1.13.13.1.1.2.2.2.2.3.3" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.cmml"><mi id="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.2.cmml">N</mi><mi id="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.3" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.3.cmml">b</mi></msub></munderover><mrow id="S2.E6.m1.13.13.1.1.2.2.2.2.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.cmml"><mi id="S2.E6.m1.13.13.1.1.2.2.2.2.2.4" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.4.cmml">δ</mi><mo id="S2.E6.m1.13.13.1.1.2.2.2.2.2.3" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.3.cmml"><mo id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.3" stretchy="false" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.3.cmml">(</mo><msub id="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E6.m1.6.6.4.6" xref="S2.E6.m1.6.6.4.5.cmml"><mi id="S2.E6.m1.3.3.1.1" xref="S2.E6.m1.3.3.1.1.cmml">b</mi><mo id="S2.E6.m1.6.6.4.6.1" xref="S2.E6.m1.6.6.4.5.cmml">,</mo><mi id="S2.E6.m1.4.4.2.2" xref="S2.E6.m1.4.4.2.2.cmml">c</mi><mo id="S2.E6.m1.6.6.4.6.2" xref="S2.E6.m1.6.6.4.5.cmml">,</mo><mi id="S2.E6.m1.5.5.3.3" xref="S2.E6.m1.5.5.3.3.cmml">h</mi><mo id="S2.E6.m1.6.6.4.6.3" xref="S2.E6.m1.6.6.4.5.cmml">,</mo><mi id="S2.E6.m1.6.6.4.4" xref="S2.E6.m1.6.6.4.4.cmml">w</mi></mrow></msub><mo id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.4" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.3.cmml">,</mo><msub id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.2" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.1" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S2.E6.m1.10.10.4.6" xref="S2.E6.m1.10.10.4.5.cmml"><mi id="S2.E6.m1.7.7.1.1" xref="S2.E6.m1.7.7.1.1.cmml">b</mi><mo id="S2.E6.m1.10.10.4.6.1" xref="S2.E6.m1.10.10.4.5.cmml">,</mo><mi id="S2.E6.m1.8.8.2.2" xref="S2.E6.m1.8.8.2.2.cmml">c</mi><mo id="S2.E6.m1.10.10.4.6.2" xref="S2.E6.m1.10.10.4.5.cmml">,</mo><mi id="S2.E6.m1.9.9.3.3" xref="S2.E6.m1.9.9.3.3.cmml">h</mi><mo id="S2.E6.m1.10.10.4.6.3" xref="S2.E6.m1.10.10.4.5.cmml">,</mo><mi id="S2.E6.m1.10.10.4.4" xref="S2.E6.m1.10.10.4.4.cmml">w</mi></mrow></msub><mo id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.5" rspace="0.170em" stretchy="false" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.E6.m1.13.13.1.2" xref="S2.E6.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.13b"><apply id="S2.E6.m1.13.13.1.1.cmml" xref="S2.E6.m1.13.13.1"><eq id="S2.E6.m1.13.13.1.1.3.cmml" xref="S2.E6.m1.13.13.1.1.3"></eq><apply id="S2.E6.m1.13.13.1.1.4.cmml" xref="S2.E6.m1.13.13.1.1.4"><times id="S2.E6.m1.13.13.1.1.4.1.cmml" xref="S2.E6.m1.13.13.1.1.4.1"></times><apply id="S2.E6.m1.13.13.1.1.4.2.cmml" xref="S2.E6.m1.13.13.1.1.4.2"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.4.2.1.cmml" xref="S2.E6.m1.13.13.1.1.4.2">subscript</csymbol><ci id="S2.E6.m1.13.13.1.1.4.2.2.cmml" xref="S2.E6.m1.13.13.1.1.4.2.2">ℒ</ci><ci id="S2.E6.m1.13.13.1.1.4.2.3.cmml" xref="S2.E6.m1.13.13.1.1.4.2.3">sRGB</ci></apply><interval closure="open" id="S2.E6.m1.13.13.1.1.4.3.1.cmml" xref="S2.E6.m1.13.13.1.1.4.3.2"><ci id="S2.E6.m1.11.11.cmml" xref="S2.E6.m1.11.11">𝑦</ci><apply id="S2.E6.m1.12.12.cmml" xref="S2.E6.m1.12.12"><ci id="S2.E6.m1.12.12.1.cmml" xref="S2.E6.m1.12.12.1">^</ci><ci id="S2.E6.m1.12.12.2.cmml" xref="S2.E6.m1.12.12.2">𝑦</ci></apply></interval></apply><apply id="S2.E6.m1.13.13.1.1.2.cmml" xref="S2.E6.m1.13.13.1.1.2"><times id="S2.E6.m1.13.13.1.1.2.3.cmml" xref="S2.E6.m1.13.13.1.1.2.3"></times><apply id="S2.E6.m1.13.13.1.1.2.4.cmml" xref="S2.E6.m1.13.13.1.1.2.4"><divide id="S2.E6.m1.13.13.1.1.2.4.1.cmml" xref="S2.E6.m1.13.13.1.1.2.4"></divide><cn id="S2.E6.m1.13.13.1.1.2.4.2.cmml" type="integer" xref="S2.E6.m1.13.13.1.1.2.4.2">1</cn><apply id="S2.E6.m1.13.13.1.1.2.4.3.cmml" xref="S2.E6.m1.13.13.1.1.2.4.3"><ci id="S2.E6.m1.13.13.1.1.2.4.3.1.cmml" xref="S2.E6.m1.13.13.1.1.2.4.3.1">⋅</ci><ci id="S2.E6.m1.13.13.1.1.2.4.3.2.cmml" xref="S2.E6.m1.13.13.1.1.2.4.3.2">𝐻</ci><ci id="S2.E6.m1.13.13.1.1.2.4.3.3.cmml" xref="S2.E6.m1.13.13.1.1.2.4.3.3">𝑊</ci></apply></apply><apply id="S2.E6.m1.13.13.1.1.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2"><apply id="S2.E6.m1.13.13.1.1.2.2.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.2.2.3.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.3">subscript</csymbol><sum id="S2.E6.m1.13.13.1.1.2.2.3.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.3.2"></sum><list id="S2.E6.m1.2.2.2.3.cmml" xref="S2.E6.m1.2.2.2.4"><ci id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1">ℎ</ci><ci id="S2.E6.m1.2.2.2.2.cmml" xref="S2.E6.m1.2.2.2.2">𝑤</ci></list></apply><apply id="S2.E6.m1.13.13.1.1.2.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2"><times id="S2.E6.m1.13.13.1.1.2.2.2.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.3"></times><apply id="S2.E6.m1.13.13.1.1.2.2.2.4.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.4"><divide id="S2.E6.m1.13.13.1.1.2.2.2.4.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.4"></divide><cn id="S2.E6.m1.13.13.1.1.2.2.2.4.2.cmml" type="integer" xref="S2.E6.m1.13.13.1.1.2.2.2.4.2">1</cn><apply id="S2.E6.m1.13.13.1.1.2.2.2.4.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.4.3"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.2.2.2.4.3.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.4.3">subscript</csymbol><ci id="S2.E6.m1.13.13.1.1.2.2.2.4.3.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.4.3.2">𝑁</ci><ci id="S2.E6.m1.13.13.1.1.2.2.2.4.3.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.4.3.3">𝑏</ci></apply></apply><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2"><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.2.2.2.2.3.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3">superscript</csymbol><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3">subscript</csymbol><sum id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.2"></sum><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3"><eq id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.1"></eq><ci id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.2">𝑏</ci><cn id="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.2">𝑁</ci><ci id="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.3.3.3">𝑏</ci></apply></apply><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2"><times id="S2.E6.m1.13.13.1.1.2.2.2.2.2.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.3"></times><ci id="S2.E6.m1.13.13.1.1.2.2.2.2.2.4.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.4">𝛿</ci><interval closure="open" id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2"><apply id="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.13.13.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><list id="S2.E6.m1.6.6.4.5.cmml" xref="S2.E6.m1.6.6.4.6"><ci id="S2.E6.m1.3.3.1.1.cmml" xref="S2.E6.m1.3.3.1.1">𝑏</ci><ci id="S2.E6.m1.4.4.2.2.cmml" xref="S2.E6.m1.4.4.2.2">𝑐</ci><ci id="S2.E6.m1.5.5.3.3.cmml" xref="S2.E6.m1.5.5.3.3">ℎ</ci><ci id="S2.E6.m1.6.6.4.4.cmml" xref="S2.E6.m1.6.6.4.4">𝑤</ci></list></apply><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2"><ci id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E6.m1.13.13.1.1.2.2.2.2.2.2.2.2.2.2">𝑦</ci></apply><list id="S2.E6.m1.10.10.4.5.cmml" xref="S2.E6.m1.10.10.4.6"><ci id="S2.E6.m1.7.7.1.1.cmml" xref="S2.E6.m1.7.7.1.1">𝑏</ci><ci id="S2.E6.m1.8.8.2.2.cmml" xref="S2.E6.m1.8.8.2.2">𝑐</ci><ci id="S2.E6.m1.9.9.3.3.cmml" xref="S2.E6.m1.9.9.3.3">ℎ</ci><ci id="S2.E6.m1.10.10.4.4.cmml" xref="S2.E6.m1.10.10.4.4">𝑤</ci></list></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.13c">\mathcal{L}_{\mathrm{sRGB}}(y,\hat{y})=\frac{1}{H\cdot W}\sum_{h,w}\frac{1}{N_%
{b}}\sum_{b=1}^{N_{b}}\delta(y_{b,c,h,w},\hat{y}_{b,c,h,w})\,,</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.13d">caligraphic_L start_POSTSUBSCRIPT roman_sRGB end_POSTSUBSCRIPT ( italic_y , over^ start_ARG italic_y end_ARG ) = divide start_ARG 1 end_ARG start_ARG italic_H ⋅ italic_W end_ARG ∑ start_POSTSUBSCRIPT italic_h , italic_w end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_b = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_δ ( italic_y start_POSTSUBSCRIPT italic_b , italic_c , italic_h , italic_w end_POSTSUBSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_b , italic_c , italic_h , italic_w end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.SSS1.p3.2">where <math alttext="y_{b,c,h,w}=\mathrm{SmallUViT}[x_{b,c^{\prime},h,w}]" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p3.1.m1.9"><semantics id="S2.SS5.SSS1.p3.1.m1.9a"><mrow id="S2.SS5.SSS1.p3.1.m1.9.9" xref="S2.SS5.SSS1.p3.1.m1.9.9.cmml"><msub id="S2.SS5.SSS1.p3.1.m1.9.9.3" xref="S2.SS5.SSS1.p3.1.m1.9.9.3.cmml"><mi id="S2.SS5.SSS1.p3.1.m1.9.9.3.2" xref="S2.SS5.SSS1.p3.1.m1.9.9.3.2.cmml">y</mi><mrow id="S2.SS5.SSS1.p3.1.m1.4.4.4.6" xref="S2.SS5.SSS1.p3.1.m1.4.4.4.5.cmml"><mi id="S2.SS5.SSS1.p3.1.m1.1.1.1.1" xref="S2.SS5.SSS1.p3.1.m1.1.1.1.1.cmml">b</mi><mo id="S2.SS5.SSS1.p3.1.m1.4.4.4.6.1" xref="S2.SS5.SSS1.p3.1.m1.4.4.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.1.m1.2.2.2.2" xref="S2.SS5.SSS1.p3.1.m1.2.2.2.2.cmml">c</mi><mo id="S2.SS5.SSS1.p3.1.m1.4.4.4.6.2" xref="S2.SS5.SSS1.p3.1.m1.4.4.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.1.m1.3.3.3.3" xref="S2.SS5.SSS1.p3.1.m1.3.3.3.3.cmml">h</mi><mo id="S2.SS5.SSS1.p3.1.m1.4.4.4.6.3" xref="S2.SS5.SSS1.p3.1.m1.4.4.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.1.m1.4.4.4.4" xref="S2.SS5.SSS1.p3.1.m1.4.4.4.4.cmml">w</mi></mrow></msub><mo id="S2.SS5.SSS1.p3.1.m1.9.9.2" xref="S2.SS5.SSS1.p3.1.m1.9.9.2.cmml">=</mo><mrow id="S2.SS5.SSS1.p3.1.m1.9.9.1" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.cmml"><mi id="S2.SS5.SSS1.p3.1.m1.9.9.1.3" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.3.cmml">SmallUViT</mi><mo id="S2.SS5.SSS1.p3.1.m1.9.9.1.2" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.2.cmml">⁢</mo><mrow id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.2.cmml"><mo id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.2" stretchy="false" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.2.1.cmml">[</mo><msub id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1.cmml"><mi id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1.2" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS5.SSS1.p3.1.m1.8.8.4.4" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.5.cmml"><mi id="S2.SS5.SSS1.p3.1.m1.5.5.1.1" xref="S2.SS5.SSS1.p3.1.m1.5.5.1.1.cmml">b</mi><mo id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.2" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.5.cmml">,</mo><msup id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.cmml"><mi id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.2" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.2.cmml">c</mi><mo id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.3" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.3.cmml">′</mo></msup><mo id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.3" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.1.m1.6.6.2.2" xref="S2.SS5.SSS1.p3.1.m1.6.6.2.2.cmml">h</mi><mo id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.4" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.1.m1.7.7.3.3" xref="S2.SS5.SSS1.p3.1.m1.7.7.3.3.cmml">w</mi></mrow></msub><mo id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.3" stretchy="false" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p3.1.m1.9b"><apply id="S2.SS5.SSS1.p3.1.m1.9.9.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9"><eq id="S2.SS5.SSS1.p3.1.m1.9.9.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.2"></eq><apply id="S2.SS5.SSS1.p3.1.m1.9.9.3.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.3"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p3.1.m1.9.9.3.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.3">subscript</csymbol><ci id="S2.SS5.SSS1.p3.1.m1.9.9.3.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.3.2">𝑦</ci><list id="S2.SS5.SSS1.p3.1.m1.4.4.4.5.cmml" xref="S2.SS5.SSS1.p3.1.m1.4.4.4.6"><ci id="S2.SS5.SSS1.p3.1.m1.1.1.1.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.1.1.1.1">𝑏</ci><ci id="S2.SS5.SSS1.p3.1.m1.2.2.2.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.2.2.2.2">𝑐</ci><ci id="S2.SS5.SSS1.p3.1.m1.3.3.3.3.cmml" xref="S2.SS5.SSS1.p3.1.m1.3.3.3.3">ℎ</ci><ci id="S2.SS5.SSS1.p3.1.m1.4.4.4.4.cmml" xref="S2.SS5.SSS1.p3.1.m1.4.4.4.4">𝑤</ci></list></apply><apply id="S2.SS5.SSS1.p3.1.m1.9.9.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1"><times id="S2.SS5.SSS1.p3.1.m1.9.9.1.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.2"></times><ci id="S2.SS5.SSS1.p3.1.m1.9.9.1.3.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.3">SmallUViT</ci><apply id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1"><csymbol cd="latexml" id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.2.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1">subscript</csymbol><ci id="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.9.9.1.1.1.1.2">𝑥</ci><list id="S2.SS5.SSS1.p3.1.m1.8.8.4.5.cmml" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4"><ci id="S2.SS5.SSS1.p3.1.m1.5.5.1.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.5.5.1.1">𝑏</ci><apply id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.1.cmml" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1">superscript</csymbol><ci id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.2">𝑐</ci><ci id="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.3.cmml" xref="S2.SS5.SSS1.p3.1.m1.8.8.4.4.1.3">′</ci></apply><ci id="S2.SS5.SSS1.p3.1.m1.6.6.2.2.cmml" xref="S2.SS5.SSS1.p3.1.m1.6.6.2.2">ℎ</ci><ci id="S2.SS5.SSS1.p3.1.m1.7.7.3.3.cmml" xref="S2.SS5.SSS1.p3.1.m1.7.7.3.3">𝑤</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p3.1.m1.9c">y_{b,c,h,w}=\mathrm{SmallUViT}[x_{b,c^{\prime},h,w}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p3.1.m1.9d">italic_y start_POSTSUBSCRIPT italic_b , italic_c , italic_h , italic_w end_POSTSUBSCRIPT = roman_SmallUViT [ italic_x start_POSTSUBSCRIPT italic_b , italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_h , italic_w end_POSTSUBSCRIPT ]</annotation></semantics></math> is the model prediction, while <math alttext="\hat{y}_{b,c,h,w}" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p3.2.m2.4"><semantics id="S2.SS5.SSS1.p3.2.m2.4a"><msub id="S2.SS5.SSS1.p3.2.m2.4.5" xref="S2.SS5.SSS1.p3.2.m2.4.5.cmml"><mover accent="true" id="S2.SS5.SSS1.p3.2.m2.4.5.2" xref="S2.SS5.SSS1.p3.2.m2.4.5.2.cmml"><mi id="S2.SS5.SSS1.p3.2.m2.4.5.2.2" xref="S2.SS5.SSS1.p3.2.m2.4.5.2.2.cmml">y</mi><mo id="S2.SS5.SSS1.p3.2.m2.4.5.2.1" xref="S2.SS5.SSS1.p3.2.m2.4.5.2.1.cmml">^</mo></mover><mrow id="S2.SS5.SSS1.p3.2.m2.4.4.4.6" xref="S2.SS5.SSS1.p3.2.m2.4.4.4.5.cmml"><mi id="S2.SS5.SSS1.p3.2.m2.1.1.1.1" xref="S2.SS5.SSS1.p3.2.m2.1.1.1.1.cmml">b</mi><mo id="S2.SS5.SSS1.p3.2.m2.4.4.4.6.1" xref="S2.SS5.SSS1.p3.2.m2.4.4.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.2.m2.2.2.2.2" xref="S2.SS5.SSS1.p3.2.m2.2.2.2.2.cmml">c</mi><mo id="S2.SS5.SSS1.p3.2.m2.4.4.4.6.2" xref="S2.SS5.SSS1.p3.2.m2.4.4.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.2.m2.3.3.3.3" xref="S2.SS5.SSS1.p3.2.m2.3.3.3.3.cmml">h</mi><mo id="S2.SS5.SSS1.p3.2.m2.4.4.4.6.3" xref="S2.SS5.SSS1.p3.2.m2.4.4.4.5.cmml">,</mo><mi id="S2.SS5.SSS1.p3.2.m2.4.4.4.4" xref="S2.SS5.SSS1.p3.2.m2.4.4.4.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p3.2.m2.4b"><apply id="S2.SS5.SSS1.p3.2.m2.4.5.cmml" xref="S2.SS5.SSS1.p3.2.m2.4.5"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p3.2.m2.4.5.1.cmml" xref="S2.SS5.SSS1.p3.2.m2.4.5">subscript</csymbol><apply id="S2.SS5.SSS1.p3.2.m2.4.5.2.cmml" xref="S2.SS5.SSS1.p3.2.m2.4.5.2"><ci id="S2.SS5.SSS1.p3.2.m2.4.5.2.1.cmml" xref="S2.SS5.SSS1.p3.2.m2.4.5.2.1">^</ci><ci id="S2.SS5.SSS1.p3.2.m2.4.5.2.2.cmml" xref="S2.SS5.SSS1.p3.2.m2.4.5.2.2">𝑦</ci></apply><list id="S2.SS5.SSS1.p3.2.m2.4.4.4.5.cmml" xref="S2.SS5.SSS1.p3.2.m2.4.4.4.6"><ci id="S2.SS5.SSS1.p3.2.m2.1.1.1.1.cmml" xref="S2.SS5.SSS1.p3.2.m2.1.1.1.1">𝑏</ci><ci id="S2.SS5.SSS1.p3.2.m2.2.2.2.2.cmml" xref="S2.SS5.SSS1.p3.2.m2.2.2.2.2">𝑐</ci><ci id="S2.SS5.SSS1.p3.2.m2.3.3.3.3.cmml" xref="S2.SS5.SSS1.p3.2.m2.3.3.3.3">ℎ</ci><ci id="S2.SS5.SSS1.p3.2.m2.4.4.4.4.cmml" xref="S2.SS5.SSS1.p3.2.m2.4.4.4.4">𝑤</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p3.2.m2.4c">\hat{y}_{b,c,h,w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p3.2.m2.4d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_b , italic_c , italic_h , italic_w end_POSTSUBSCRIPT</annotation></semantics></math> is the ground truth.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results: from MA-XRF to RGB</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Among the possible hyperparameter set selection at fixed VRAM occupation size we could handle with our set-up at this stage<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>We Trained the model on a NVIDIA Tesla T4 GPU with 16 Gb vRAM, located on a node with 128 Gb RAM, 2x Intel Xenon Gold CPU.</span></span></span>, we selected the best model architecture via a plain grid search.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.2">The selected model has 3 485 076 trainable parameters, obtained by 3+1+3 Transformer layers in the in/mid/out U-ViT blocks, a <math alttext="16\times 16" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mn id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">16</mn><mo id="S3.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p2.1.m1.1.1.1.cmml">×</mo><mn id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><times id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1"></times><cn id="S3.p2.1.m1.1.1.2.cmml" type="integer" xref="S3.p2.1.m1.1.1.2">16</cn><cn id="S3.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.p2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">16\times 16</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">16 × 16</annotation></semantics></math> patch size, 9 heads per MultiHead block, 192 embed dimension size, 2 MLP-to-Dim factor, and a head dimension of 32. The dropout rate and the stochastic depth rate are both set to <math alttext="0.1" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mn id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><cn id="S3.p2.2.m2.1.1.cmml" type="float" xref="S3.p2.2.m2.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">0.1</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">We trained the SmallUViT model for 100 epochs, using the schemes described in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S2.SS5" title="2.5 Training the virtual recolouring model ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">2.5</span></a>;</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="319" id="S3.F5.g1" src="extracted/5919322/img/training/training_history_plot.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Training history Plot</figcaption>
</figure>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">The result of the training is reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F5" title="In 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>; the discrepancy between validation and train loss/metric may be traced back to the presence of Dropout and Stochastic Depth during training.</p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.3">Applied on the <math alttext="30\,210" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><mn id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">30 210</mn><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><cn id="S3.p5.1.m1.1.1.cmml" type="integer" xref="S3.p5.1.m1.1.1">30210</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">30\,210</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">30 210</annotation></semantics></math> images in the test set, we get a sRGB loss of <math alttext="\mathcal{L}_{\text{test}}=0.1148" class="ltx_Math" display="inline" id="S3.p5.2.m2.1"><semantics id="S3.p5.2.m2.1a"><mrow id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><msub id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.2.m2.1.1.2.2" xref="S3.p5.2.m2.1.1.2.2.cmml">ℒ</mi><mtext id="S3.p5.2.m2.1.1.2.3" xref="S3.p5.2.m2.1.1.2.3a.cmml">test</mtext></msub><mo id="S3.p5.2.m2.1.1.1" xref="S3.p5.2.m2.1.1.1.cmml">=</mo><mn id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml">0.1148</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><eq id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1.1"></eq><apply id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.2.1.cmml" xref="S3.p5.2.m2.1.1.2">subscript</csymbol><ci id="S3.p5.2.m2.1.1.2.2.cmml" xref="S3.p5.2.m2.1.1.2.2">ℒ</ci><ci id="S3.p5.2.m2.1.1.2.3a.cmml" xref="S3.p5.2.m2.1.1.2.3"><mtext id="S3.p5.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S3.p5.2.m2.1.1.2.3">test</mtext></ci></apply><cn id="S3.p5.2.m2.1.1.3.cmml" type="float" xref="S3.p5.2.m2.1.1.3">0.1148</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\mathcal{L}_{\text{test}}=0.1148</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT test end_POSTSUBSCRIPT = 0.1148</annotation></semantics></math>, and an MS-SSIM metric value of <math alttext="\mathcal{M}_{\text{test}}=0.9196" class="ltx_Math" display="inline" id="S3.p5.3.m3.1"><semantics id="S3.p5.3.m3.1a"><mrow id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml"><msub id="S3.p5.3.m3.1.1.2" xref="S3.p5.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.3.m3.1.1.2.2" xref="S3.p5.3.m3.1.1.2.2.cmml">ℳ</mi><mtext id="S3.p5.3.m3.1.1.2.3" xref="S3.p5.3.m3.1.1.2.3a.cmml">test</mtext></msub><mo id="S3.p5.3.m3.1.1.1" xref="S3.p5.3.m3.1.1.1.cmml">=</mo><mn id="S3.p5.3.m3.1.1.3" xref="S3.p5.3.m3.1.1.3.cmml">0.9196</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"><eq id="S3.p5.3.m3.1.1.1.cmml" xref="S3.p5.3.m3.1.1.1"></eq><apply id="S3.p5.3.m3.1.1.2.cmml" xref="S3.p5.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.1.2.1.cmml" xref="S3.p5.3.m3.1.1.2">subscript</csymbol><ci id="S3.p5.3.m3.1.1.2.2.cmml" xref="S3.p5.3.m3.1.1.2.2">ℳ</ci><ci id="S3.p5.3.m3.1.1.2.3a.cmml" xref="S3.p5.3.m3.1.1.2.3"><mtext id="S3.p5.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S3.p5.3.m3.1.1.2.3">test</mtext></ci></apply><cn id="S3.p5.3.m3.1.1.3.cmml" type="float" xref="S3.p5.3.m3.1.1.3">0.9196</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">\mathcal{M}_{\text{test}}=0.9196</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT test end_POSTSUBSCRIPT = 0.9196</annotation></semantics></math>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Application on some test set cases</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We now report few examples extracted from the test dataset. For each example, we show a triplet of figures: the leftmost one, is the embedded synthetic MA-XRF image; the middle one, is the output of the SmallUViT; the rightmost one, is the true RGB image. On top of the image in the middle are reported two metric scores, computed between the prediction and the target: the Multi-Scale Similarity Index, and the <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.1">Universal Image Quality Index</span> (UiQi) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib82" title="">82</a>]</cite>. The four examples presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F6" title="In 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">figs.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F7" title="Figure 7 ‣ 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">7</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F8" title="Figure 8 ‣ 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">8</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F9" title="Figure 9 ‣ 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">9</span></a> are selected because they present relevant feature of the inference of the model (pros and cons); they are not the ones with the higher MS-SSIM nor UiQi scores in the test dataset. Furthermore, we choose to show the comparison of the inferred RGB with the actual (resized) image, and not with its <math alttext="\mathrm{IKMeans}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">IKMeans</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">IKMeans</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathrm{IKMeans}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">roman_IKMeans</annotation></semantics></math> clustered version employed in the synthetic dataset generating algorithm (we refer to <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#alg1" title="In 2.2 Preparing the synthetic dataset - part I: spectra ‣ 2 Methods: the virtual colouring pipeline ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="187" id="S3.F6.g1" src="extracted/5919322/img/test/SmallUViT_NEW_PALETTE_inference_0.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Example number 0</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="183" id="S3.F7.g1" src="extracted/5919322/img/test/SmallUViT_NEW_PALETTE_inference_2.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Example number 1</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="187" id="S3.F8.g1" src="extracted/5919322/img/test/SmallUViT_NEW_PALETTE_inference_6.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Example number 2</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="184" id="S3.F9.g1" src="extracted/5919322/img/test/SmallUViT_NEW_PALETTE_inference_15.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Example number 3</figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">From the presented images, we already seen pros and cons of the trained model. Even if the model was limited, the pipeline cumbersome, the task complex and the computing power limited, we were able to extrapolate a set of RGB images out of (embedded, synthetic) MA-XRF data cubes. This is quite comforting.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">Nevertheless, even if the MS-SSIM score is quite high (around <math alttext="0.9" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mn id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><cn id="S3.SS1.p3.1.m1.1.1.cmml" type="float" xref="S3.SS1.p3.1.m1.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">0.9</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">0.9</annotation></semantics></math>), and, overall, the network was capable of assigning colors to semantic regions of the images, we may spot few issues, as partially signalled by the low UiQi scores.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">Interesting examples are <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F6" title="In 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F7" title="In 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>; the network was able of identifying the dark colours (the blueish black and the dark blue of the background, as well as the black of the jacket), the light colours (the white and the light blue of the man’s Ruff), and, quite surprisingly, the red, which is given (in the example) by the embedding of signals formed (in part) by a red ochre, which is, in composition, quite similar to the Gold Ochre<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>At least, in the spectra contained in the database we use. See <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://infraart.inoe.ro/sample/1578/show/" title="">https://infraart.inoe.ro/sample/1578/show/</a> and <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://infraart.inoe.ro/sample/130/show/" title="">https://infraart.inoe.ro/sample/130/show/</a> for yellow and red ochre, respectively. From <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib38" title="">38</a>]</cite>.</span></span></span>. Yet, the incarnate has been not properly coloured, at least in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F7" title="In 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a> (instead, for the peculiar visual aspect of <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F6" title="In 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, the <math alttext="\mathrm{IKMeans}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">IKMeans</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">IKMeans</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathrm{IKMeans}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">roman_IKMeans</annotation></semantics></math> clustering performed on the RGB has to be blamed, see <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F10.sf1" title="In Figure 10 ‣ 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">10a</span></a>). The poor performance on such incarnate may also be attributed to the complex pigment selection during this image generation - fact that can be hinted from the false rgb representation of the embedded synthetic MA-XRF.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">In <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F8" title="In 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a>, the model correctly coloured the frame’s yellow (a difficult pigment), the leaves’ greens are quite correctly identified and, apart from a slight colour deviation, so are the ground and horses colours. Yet, no clouds appears in the sky. This is due to the aforementioned RGB clustering (see <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F10.sf3" title="In Figure 10 ‣ 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">10c</span></a>).</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">Finally, <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3.F9" title="In 3.1 Application on some test set cases ‣ 3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a> presents an interesting artefact. While the background greens, the incarnate, the beard, and, partly, the uniform colours have been partly identified, the turban red posed a difficult task to the network, and it creates a patching artefact.</p>
</div>
<figure class="ltx_figure" id="S3.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="259" id="S3.F10.sf1.g1" src="extracted/5919322/img/test/clust_rgb_0.png" width="269"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Clustered RGB 0</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="259" id="S3.F10.sf2.g1" src="extracted/5919322/img/test/clust_rgb_2.png" width="269"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Clustered RGB 1</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F10.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="259" id="S3.F10.sf3.g1" src="extracted/5919322/img/test/clust_rgb_6.png" width="269"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Clustered RGB 2</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F10.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="259" id="S3.F10.sf4.g1" src="extracted/5919322/img/test/clust_rgb_15.png" width="269"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Clustered RGB 2</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Clustered RGB test images.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusions</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this contribution we report the design and a first test of a pipeline aimed at virtual recolour MA-XRF data cubes. This task is intended to furnish restoration scientist and heritage scientist a visual aid to help them elaborate the raw data obtained from nuclear imaging performed on pictorial artworks, especially in those situation where the study object suffers from loss of visual readability.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">The goal of the pipeline design is to perform the task starting from synthetic data, to overcome the lack of availability of data. Furthermore, the pipeline has an intermediate step to (a) address the high per-MA-XRF image disk size, and (b) extract relevant spectral features, regardless of experimental/environmental conditions.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">Thus, the designed pipeline comprises two trained models:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">A Deep Embedding model working on single spectra;</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">A Vision Transformer to elaborate embedded.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">We have shown that, a part from some difficulties inherited by the synthetic dataset generation algorithm, we have a pipeline capable of performing the end-to-end task.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Next steps</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">After having motivated the pipeline design and architecture, the next step is apply it on a recolouring use case task. To do so, the crucial part is devising an appropriate <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.1">domain adaptation</span> technique to handle the domain shift between the synthetic dataset and the real MA-XRF data. The fact that the pipeline relies on two networks allows us to perform the domain adaption unsupervisingly on one training only, <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.1.2">i.e</em>.<span class="ltx_text" id="S4.SS1.p1.1.3"></span> add the domain adaptation (<em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.1.4">e.g</em>.<span class="ltx_text" id="S4.SS1.p1.1.5"></span>, as an adversarial step as shown in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib83" title="">83</a>]</cite>), while also giving us the opportunity the tackle each issues arising from the network disjointly and in parallel.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">The first and foremost issue it is possible to trace back, is the limited size of the dataset. We plan to enlarge it by removing the restriction of scraped images from WikiData to be either paintings or frescoes. This, of course, alters the domain of the dataset, including scenes not usually represented in the domain of application of the network (<em class="ltx_emph ltx_font_italic" id="S4.SS1.p2.1.1">i.e</em>.<span class="ltx_text" id="S4.SS1.p2.1.2"></span>, pictorial artworks). Nevertheless, the goal is to split the train into two parts:</p>
<ol class="ltx_enumerate" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1">A first self-supervised step, to force the ViT to learn the semantic aspects of images (using the enlarged dataset);</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1">A second step, where the pretrained network should learn how to assign colours (using the pictorial artwork dataset).</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">Furthermore, in <a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#S3" title="3 Results: from MA-XRF to RGB ‣ Towards virtual painting recolouring using Vision Transformer on X-Ray Fluorescence datacubes"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">3</span></a> we have reported few limitations shown by the network; mainly, its inability to reconstruct visual appearances lost during the rgb clustering step in the synthetic dataset generation algorithm. One way to tackle this issue would be to add a <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.1.1">generative</span> part to the model, in order to infer something not properly encoded in the model’s input. To do so, we plan to implement a <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p3.1.2">Pix2Pix</span> approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib84" title="">84</a>]</cite>, using SmallUViT as backbone (for a review on GAN approaches with ViT, see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib85" title="">85</a>]</cite> and references therein).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Code and Data Availability</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">The code used in this project can be found at the ICSC Spoke 2 repository <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://baltig.infn.it/chnet/fast-extended-vision-smalluvit" title="">https://baltig.infn.it/chnet/fast-extended-vision-smalluvit</a>.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">To conduct the work presented in this contribution, we resorted to the cloud computing Software-as-a-Service infrastructure made available by the ML_INFN initiative (“Machine Learning at INFN”) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib86" title="">86</a>]</cite>, aim to foster Machine Learning activities at the Italian National Institute for Nuclear Physics (INFN), as well as some servers made available by INFN-CHNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib28" title="">28</a>]</cite>, the network devoted to the application of nuclear techniques to Cultural Heritage.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">We would also like to thank the authors of the site <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://infraart.inoe.ro/" title="">https://infraart.inoe.ro/</a> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08826v1#bib.bib38" title="">38</a>]</cite>, and WikiData <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.wikidata.org" title="">https://www.wikidata.org</a> and WikiMedia commons <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://commons.wikimedia.org" title="">https://commons.wikimedia.org</a>.</p>
</div>
<section class="ltx_subsection" id="Sx1.SSx1">
<h3 class="ltx_title ltx_title_subsection">Funding</h3>
<div class="ltx_para" id="Sx1.SSx1.p1">
<p class="ltx_p" id="Sx1.SSx1.p1.1">This work is supported by ICSC – Centro Nazionale di Ricerca in High Performance Computing, Big Data and Quantum Computing, funded by European Union – NextGenerationEU, by the European Commission within the Framework Programme Horizon 2020 with the project “4CH - Competence Centre for the Conservation of Cultural Heritage” (GA n.101004468 – 4CH) and by the project AIRES–CH - Artificial Intelligence for digital REStoration of Cultural Heritage jointly funded by the Tuscany Region (Progetto Giovani Sì) and INFN.</p>
</div>
<div class="ltx_para" id="Sx1.SSx1.p2">
<p class="ltx_p" id="Sx1.SSx1.p2.1">The work of AB was funded by Progetto ICSC - Spoke 2 - Codice CN00000013 - CUP I53C21000340006 - Missione 4 Istruzione e ricerca - Componente 2 Dalla ricerca all’impresa – Investimento 1.4.</p>
</div>
<div class="ltx_para" id="Sx1.SSx1.p3">
<p class="ltx_p" id="Sx1.SSx1.p3.1">The work of FGAB was funded by the research grant titled “Artificial Intelligence and Big Data” and funded by the AIRES-CH Project cod. 291514 (CUP I95F21001120008).</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">References</h2>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jenkins R and Vries J L 1969 <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Practical X-ray spectrometry</span> 2nd ed Philips technical library (New York: Springer) ISBN 978-1-4684-6284-5

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Knoll G F 2010 <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Radiation Detection And Measurement</span> 4th ed (John Wiley &amp; Sons Inc.) ISBN 978-0-470-13148-0

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Mandò P A and Przybyłowicz W J 2016 <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Particle-Induced X-Ray Emission (PIXE)</span> (American Cancer Society) pp 1–48 ISBN 9780470027318 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/9780470027318.a6210.pub3" title="">https://onlinelibrary.wiley.com/doi/abs/10.1002/9780470027318.a6210.pub3</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Grieken R E V and Markowicz A A 1993 Handbook of x-ray spectrometry: Methods and techniques URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:118828992" title="">https://api.semanticscholar.org/CorpusID:118828992</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Jenkins R 1995 <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Quantitative X-ray spectrometry</span> (CRC Press)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Janssens K, Adams F C and Rindby A 2000 Microscopic x-ray fluorescence analysis URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:106479701" title="">https://api.semanticscholar.org/CorpusID:106479701</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Verma H R 2007 Atomic and nuclear analytical methods URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:137503330" title="">https://api.semanticscholar.org/CorpusID:137503330</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Ruberto C 2023 <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Rendiconti Lincei. Scienze Fisiche e Naturali</span> <span class="ltx_text ltx_font_bold" id="bib.bib8.2.2">34</span> 889–906 ISSN 1720-0776 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/s12210-023-01175-z" title="">https://doi.org/10.1007/s12210-023-01175-z</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Kleynhans T, Schmidt Patterson C M, Dooley K A, Messinger D W and Delaney J K 2020 <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Heritage Science</span> <span class="ltx_text ltx_font_bold" id="bib.bib9.2.2">8</span> 84 ISSN 2050-7445

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Licciardi G A and Del Frate F 2011 <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">IEEE Transactions on Geoscience and Remote Sensing</span> <span class="ltx_text ltx_font_bold" id="bib.bib10.2.2">49</span> 4163–4172

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Zhang X, Sun Y, Zhang J, Wu P and Jiao L 2018 <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">IEEE Geoscience and Remote Sensing Letters</span> <span class="ltx_text ltx_font_bold" id="bib.bib11.2.2">15</span> 1755–1759

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Wang M, Zhao M, Chen J and Rahardja S 2019 <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">IEEE Geoscience and Remote Sensing Letters</span> <span class="ltx_text ltx_font_bold" id="bib.bib12.2.2">16</span> 1467–1471

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Kogou S, Lee L, Shahtahmassebi G and Liang H 2020 <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">X-Ray Spectrometry</span> <span class="ltx_text ltx_font_bold" id="bib.bib13.2.2">50</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Vermeulen M, McGeachy A, Xu B, Chopp H, Katsaggelos A, Meyers R, Alfeld M and Walton M 2022 <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">J. Anal. At. Spectrom.</span> <span class="ltx_text ltx_font_bold" id="bib.bib14.2.2">37</span>(10) 2130–2143 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1039/D2JA00114D" title="">http://dx.doi.org/10.1039/D2JA00114D</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Jones C, Daly N S, Higgitt C and Rodrigues M R D 2022 <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Heritage Science</span> <span class="ltx_text ltx_font_bold" id="bib.bib15.2.2">10</span> 88 ISSN 2050-7445 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1186/s40494-022-00716-3" title="">https://doi.org/10.1186/s40494-022-00716-3</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Bingjie X, Wu Y, Hao P, Vermeulen M, McGeachy A, Smith K, Eremin K, Rayner G, Verri G, Willomitzer F, Alfeld M, Tumblin J, Katsaggelos A and Walton M 2022 Can deep learning assist automatic identification of layered pigments from xrf data? URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2207.12651" title="">https://arxiv.org/abs/2207.12651</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Dirks M C and Poole D 2022 <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">ArXiv</span> <span class="ltx_text ltx_font_bold" id="bib.bib17.2.2">abs/2210.12239</span> URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:253098616" title="">https://api.semanticscholar.org/CorpusID:253098616</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Liu L, Miteva T, Delnevo G, Mirri S, Walter P, de Viguerie L and Pouyet E 2023 <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Sensors (Basel, Switzerland)</span> <span class="ltx_text ltx_font_bold" id="bib.bib18.2.2">23</span> URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:257135358" title="">https://api.semanticscholar.org/CorpusID:257135358</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Fiorucci M, Khoroshiltseva M, Pontil M, Traviglia A, Del Bue A and James S 2020 <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Pattern Recognition Letters</span> <span class="ltx_text ltx_font_bold" id="bib.bib19.2.2">133</span> 102–108 ISSN 0167-8655

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Alfeld M 2020 <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">Microscopy and Microanalysis</span> <span class="ltx_text ltx_font_bold" id="bib.bib20.2.2">26</span> 72–75

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Alberti R, Crupi V, Frontoni R, Galli G, La Russa M F, Licchelli M, Majolino D, Malagodi M, Rossi B, Ruffolo S A and Venuti V 2017 <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">J. Anal. At. Spectrom.</span> <span class="ltx_text ltx_font_bold" id="bib.bib21.2.2">32</span>(1) 117–129 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1039/C6JA00249H" title="">http://dx.doi.org/10.1039/C6JA00249H</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Fiorillo F, Fiorentino S, Montanari M, Roversi Monaco C, Del Bianco A and Vandini M 2020 <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Heritage Science</span> <span class="ltx_text ltx_font_bold" id="bib.bib22.2.2">8</span> 10 ISSN 2050-7445 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1186/s40494-020-0354-y" title="">https://doi.org/10.1186/s40494-020-0354-y</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Dik J, Janssens K, Van Der Snickt G, van der Loeff L, Rickers K and Cotte M 2008 <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Analytical Chemistry</span> <span class="ltx_text ltx_font_bold" id="bib.bib23.2.2">80</span> 6436–6442 ISSN 0003-2700 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1021/ac800965g" title="">https://doi.org/10.1021/ac800965g</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Dredge P, Ives S, Howard D L, Spiers K M, Yip A and Kenderdine S 2015 <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Applied Physics A</span> <span class="ltx_text ltx_font_bold" id="bib.bib24.2.2">121</span> 789–800

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Martins A, Coddington J, Van der Snickt G, van Driel B, McGlinchey C, Dahlberg D, Janssens K and Dik J 2016 <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Heritage Science</span> <span class="ltx_text ltx_font_bold" id="bib.bib25.2.2">4</span> 1–13

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Van der Snickt G, Legrand S, Slama I, Van Zuien E, Gruber G, Van der Stighelen K, Klaassen L, Oberthaler E and Janssens K 2018 <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Microchemical Journal</span> <span class="ltx_text ltx_font_bold" id="bib.bib26.2.2">138</span> 238–245 ISSN 0026-265X URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S0026265X17308779" title="">https://www.sciencedirect.com/science/article/pii/S0026265X17308779</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Taccetti F, Castelli L, Czelusniak C, Gelli N, Mazzinghi A, Palla L, Ruberto C, Censori C, Lo Giudice A, Re A, Zafiropulos D, Arneodo F, Conicella V, Di Giovanni A, Torres R, Castella F, Mastrangelo N, Gallegos D, Tascon M, Marte F and Giuntini L 2019 <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Rendiconti Lincei. Scienze Fisiche e Naturali</span> <span class="ltx_text ltx_font_bold" id="bib.bib27.2.2">30</span> 307–322 ISSN 1720-0776

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Giuntini L, Castelli L, Massi M, Fedi M, Czelusniak C, Gelli N, Liccioli L, Giambi F, Ruberto C, Mazzinghi A, Barone S, Marchegiani F, Nisi S, Lubritto C, Altieri S, Tortora L, Branchini P, Fabbri A, Graziani V, Lins S B, Guidorzi L, Lo Giudice A, Re A, Sottili L, Balerna A, Cestelli Guidi M, Pronti L, Romani M, Albertin F, Bettuzzi M, Brancaccio R, Morigi M P, Alloni D, Salvini A, Smilgys B, Prata M, Altieri S, Bonesini M, Di Martino D, Clemenza M, Carpinelli M, Oliva P, Sipala V, Gueli A M, Pasquale S, Stella G, Pepponi G, Grazzi F and Taccetti F 2021 <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Applied Sciences</span> <span class="ltx_text ltx_font_bold" id="bib.bib28.2.2">11</span> ISSN 2076-3417

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Chiari M, Barone S, Bombini A, Calzolai G, Carraresi L, Castelli L, Czelusniak C, Fedi M E, Gelli N, Giambi F, Giardi F, Giuntini L, Lagomarsino S, Liccioli L, Lucarelli F, Manetti M, Massi M, Mazzinghi A, Nava S, Ottanelli P, Sciortino S, Ruberto C, Sodi L, Taccetti F and Mandò P A 2021 <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">The European Physical Journal Plus</span> <span class="ltx_text ltx_font_bold" id="bib.bib29.2.2">136</span> 472 ISSN 2190-5444 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1140/epjp/s13360-021-01411-1" title="">https://doi.org/10.1140/epjp/s13360-021-01411-1</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Bombini A 2023 ganX – generate artificially new XRF a python library to generate MA-XRF raw data out of RGB images (<span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2304.14078" title="">2304.14078</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Bombini A, Anderlini L, dell’Agnello L, Giacomini F, Ruberto C and Taccetti F 2022 The AIRES-CH Project: Artificial Intelligence for Digital REStoration of Cultural Heritages Using Nuclear Imaging and Multidimensional Adversarial Neural Networks <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Image Analysis and Processing – ICIAP 2022</span> ed Sclaroff S, Distante C, Leo M, Farinella G M and Tombari F (Cham: Springer International Publishing) pp 685–700 ISBN 978-3-031-06427-2

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Bombini A, Anderlini L, dell’Agnello L, Giacomini F, Ruberto C and Taccetti F 2022 Hyperparameter Optimisation of Artificial Intelligence for Digital REStoration of Cultural Heritages (AIRES-CH) Models <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Computational Science and Its Applications – ICCSA 2022 Workshops</span> ed Gervasi O, Murgante B, Misra S, Rocha A M A C and Garau C (Cham: Springer International Publishing) pp 91–106 ISBN 978-3-031-10536-4 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-031-10536-4_7" title="">https://doi.org/10.1007/978-3-031-10536-4_7</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Bombini A, Bofías F G A, Bracci C, Ginolfi M and Ruberto C 2024 Datacube segmentation via deep spectral clustering (<span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2401.17695" title="">2401.17695</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Bombini A, Bofías F G A, Ruberto C and Taccetti F 2023 <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Rendiconti Lincei. Scienze Fisiche e Naturali</span> <span class="ltx_text ltx_font_bold" id="bib.bib34.2.2">34</span> 867 – 887 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:259707375" title="">https://api.semanticscholar.org/CorpusID:259707375</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Zheng X, Kankanallu V R, Lo C A, Pattammattel A, Chu Y, Chen-Wiegart Y C K and Huang X 2024 <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">Optica</span> <span class="ltx_text ltx_font_bold" id="bib.bib35.2.2">11</span> 146–154

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Andric V, Kvascev G, Cvetanovic M, Stojanovic S, Bacanin N and Gajic-Kvascev M 2024 <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">Scientific Reports</span> <span class="ltx_text ltx_font_bold" id="bib.bib36.2.2">14</span> 3666

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Ganin Y, Ustinova E, Ajakan H, Germain P, Larochelle H, Laviolette F, Marchand M and Lempitsky V 2016 Domain-adversarial training of neural networks (<span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1505.07818" title="">1505.07818</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Cortea I M, Chiroşca A, Angheluţă L M and Seriţan G 2023 <span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">J. Comput. Cult. Herit.</span> <span class="ltx_text ltx_font_bold" id="bib.bib38.2.2">16</span> ISSN 1556-4673 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3593427" title="">https://doi.org/10.1145/3593427</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Del Vescovo D and Fregolent A 2005 <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">Journal of Sound and Vibration</span> <span class="ltx_text ltx_font_bold" id="bib.bib39.2.2">284</span> 1015–1031 ISSN 0022-460X URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S0022460X04006121" title="">https://www.sciencedirect.com/science/article/pii/S0022460X04006121</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Vrandečić D and Krötzsch M 2014 <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">Commun. ACM</span> <span class="ltx_text ltx_font_bold" id="bib.bib40.2.2">57</span> 78–85 ISSN 0001-0782 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2629489" title="">https://doi.org/10.1145/2629489</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Luo M R, Cui G and Rigg B 2001 <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">Color Research &amp; Application</span> <span class="ltx_text ltx_font_bold" id="bib.bib41.2.2">26</span> 340–350 (<span class="ltx_text ltx_font_italic" id="bib.bib41.3.3">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://onlinelibrary.wiley.com/doi/pdf/10.1002/col.1049" title="">https://onlinelibrary.wiley.com/doi/pdf/10.1002/col.1049</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/col.1049" title="">https://onlinelibrary.wiley.com/doi/abs/10.1002/col.1049</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Sharma G, Wu W and Dalal E N 2005 <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Color Research &amp; Application</span> <span class="ltx_text ltx_font_bold" id="bib.bib42.2.2">30</span> 21–30 (<span class="ltx_text ltx_font_italic" id="bib.bib42.3.3">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://onlinelibrary.wiley.com/doi/pdf/10.1002/col.20070" title="">https://onlinelibrary.wiley.com/doi/pdf/10.1002/col.20070</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/col.20070" title="">https://onlinelibrary.wiley.com/doi/abs/10.1002/col.20070</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Song C, Liu F, Huang Y, Wang L and Tan T 2013 Auto-encoder based data clustering <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">Progress in Pattern Recognition, Image Analysis, Computer Vision, and Applications: 18th Iberoamerican Congress, CIARP 2013, Havana, Cuba, November 20-23, 2013, Proceedings, Part I 18</span> (Springer) pp 117–124

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Mrabah N, Khan N M, Ksantini R and Lachiri Z 2020 <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">Neural Networks</span> <span class="ltx_text ltx_font_bold" id="bib.bib44.2.2">130</span> 206–228

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Yang B, Fu X, Sidiropoulos N D and Hong M 2017 Towards k-means-friendly spaces: Simultaneous deep learning and clustering (<span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1610.04794" title="">1610.04794</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Guo X, Gao L, Liu X and Yin J 2017 Improved deep embedded clustering with local structure preservation. <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">Ijcai</span> vol 17 pp 1753–1759

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Higgins I, Matthey L, Pal A, Burgess C P, Glorot X, Botvinick M M, Mohamed S and Lerchner A 2016 beta-vae: Learning basic visual concepts with a constrained variational framework <span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">International Conference on Learning Representations</span> URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:46798026" title="">https://api.semanticscholar.org/CorpusID:46798026</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Goodfellow I, Bengio Y and Courville A 2016 <span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">Deep Learning</span> (MIT Press) <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.deeplearningbook.org" title="">http://www.deeplearningbook.org</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Kingma D P and Welling M 2019 <span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">Foundations and Trends® in Machine Learning</span> <span class="ltx_text ltx_font_bold" id="bib.bib49.2.2">12</span> 307–392 ISSN 1935-8245 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1561/2200000056" title="">http://dx.doi.org/10.1561/2200000056</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Bengio Y, Courville A and Vincent P 2013 <span class="ltx_text ltx_font_italic" id="bib.bib50.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</span> <span class="ltx_text ltx_font_bold" id="bib.bib50.2.2">35</span> 1798–1828

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Prince S J 2023 <span class="ltx_text ltx_font_italic" id="bib.bib51.1.1">Understanding Deep Learning</span> (MIT Press) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://udlbook.com" title="">http://udlbook.com</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Jiang Z, Zheng Y, Tan H, Tang B and Zhou H 2017 Variational deep embedding: An unsupervised and generative approach to clustering (<span class="ltx_text ltx_font_italic" id="bib.bib52.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1611.05148" title="">1611.05148</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Kaufman L and Rousseeuw P J 1990 <span class="ltx_text ltx_font_italic" id="bib.bib53.1.1">Finding Groups in Data: An Introduction to Cluster Analysis</span> A Wiley-Interscience publication (Wiley) ISBN 9780471878766 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://books.google.it/books?id=Q5wQAQAAIAAJ" title="">https://books.google.it/books?id=Q5wQAQAAIAAJ</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Zhao S, Song J and Ermon S 2018 Infovae: Information maximizing variational autoencoders (<span class="ltx_text ltx_font_italic" id="bib.bib54.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1706.02262" title="">1706.02262</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Zhao S, Song J and Ermon S 2019 Infovae: Balancing learning and inference in variational autoencoders <span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">AAAI Conference on Artificial Intelligence</span> URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:59593773" title="">https://api.semanticscholar.org/CorpusID:59593773</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Gretton A, Borgwardt K, Rasch M J, Scholkopf B and Smola A J 2008 A kernel method for the two-sample problem (<span class="ltx_text ltx_font_italic" id="bib.bib56.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="0805.2368" title="">0805.2368</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Li Y, Swersky K and Zemel R 2015 Generative moment matching networks (<span class="ltx_text ltx_font_italic" id="bib.bib57.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1502.02761" title="">1502.02761</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Klambauer G, Unterthiner T, Mayr A and Hochreiter S 2017 Self-normalizing neural networks (<span class="ltx_text ltx_font_italic" id="bib.bib58.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1706.02515" title="">1706.02515</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Dosovitskiy A, Beyer L, Kolesnikov A, Weissenborn D, Zhai X, Unterthiner T, Dehghani M, Minderer M, Heigold G, Gelly S, Uszkoreit J and Houlsby N 2021 An image is worth 16x16 words: Transformers for image recognition at scale (<span class="ltx_text ltx_font_italic" id="bib.bib59.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2010.11929" title="">2010.11929</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Han K, Wang Y, Chen H, Chen X, Guo J, Liu Z, Tang Y, Xiao A, Xu C, Xu Y, Yang Z, Zhang Y and Tao D 2020 <span class="ltx_text ltx_font_italic" id="bib.bib60.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</span> <span class="ltx_text ltx_font_bold" id="bib.bib60.2.2">PP</span> 1–1 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:236986986" title="">https://api.semanticscholar.org/CorpusID:236986986</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Li X, Ding H, Zhang W, Yuan H, Pang J, Cheng G, Chen K, Liu Z and Loy C C 2023 <span class="ltx_text ltx_font_italic" id="bib.bib61.1.1">ArXiv</span> <span class="ltx_text ltx_font_bold" id="bib.bib61.2.2">abs/2304.09854</span> URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:258212528" title="">https://api.semanticscholar.org/CorpusID:258212528</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Thisanke H, Deshan C, Chamith K, Seneviratne S, Vidanaarachchi R and Herath D 2023 Semantic segmentation using vision transformers: A survey (<span class="ltx_text ltx_font_italic" id="bib.bib62.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2305.03273" title="">2305.03273</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Shamshad F, Khan S, Zamir S W, Khan M H, Hayat M, Khan F S and Fu H 2023 <span class="ltx_text ltx_font_italic" id="bib.bib63.1.1">Medical Image Analysis</span> <span class="ltx_text ltx_font_bold" id="bib.bib63.2.2">88</span> 102802 ISSN 1361-8415 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S1361841523000634" title="">https://www.sciencedirect.com/science/article/pii/S1361841523000634</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Jamil S, Jalil Piran M and Kwon O J 2023 <span class="ltx_text ltx_font_italic" id="bib.bib64.1.1">Drones</span> <span class="ltx_text ltx_font_bold" id="bib.bib64.2.2">7</span> ISSN 2504-446X URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.mdpi.com/2504-446X/7/5/287" title="">https://www.mdpi.com/2504-446X/7/5/287</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Touvron H, Cord M, Douze M, Massa F, Sablayrolles A and Jégou H 2021 Training data-efficient image transformers &amp; distillation through attention (<span class="ltx_text ltx_font_italic" id="bib.bib65.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2012.12877" title="">2012.12877</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
Lee S H, Lee S and Song B C 2021 Vision transformer for small-size datasets (<span class="ltx_text ltx_font_italic" id="bib.bib66.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2112.13492" title="">2112.13492</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
Bao F, Nie S, Xue K, Cao Y, Li C, Su H and Zhu J 2023 All are worth words: A vit backbone for diffusion models (<span class="ltx_text ltx_font_italic" id="bib.bib67.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2209.12152" title="">2209.12152</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
Srivastava N, Hinton G, Krizhevsky A, Sutskever I and Salakhutdinov R 2014 <span class="ltx_text ltx_font_italic" id="bib.bib68.1.1">Journal of Machine Learning Research</span> <span class="ltx_text ltx_font_bold" id="bib.bib68.2.2">15</span> 1929–1958 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v15/srivastava14a.html" title="">http://jmlr.org/papers/v15/srivastava14a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
Hendrycks D and Gimpel K 2023 Gaussian error linear units (gelus) (<span class="ltx_text ltx_font_italic" id="bib.bib69.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1606.08415" title="">1606.08415</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1606.08415" title="">https://arxiv.org/abs/1606.08415</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
Rogozhnikov A 2022 Einops: Clear and Reliable Tensor Manipulations with Einstein-like Notation <span class="ltx_text ltx_font_italic" id="bib.bib70.1.1">International Conference on Learning Representations</span> URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=oapKSVM2bcj" title="">https://openreview.net/forum?id=oapKSVM2bcj</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
Huang G, Sun Y, Liu Z, Sedra D and Weinberger K 2016 Deep networks with stochastic depth (<span class="ltx_text ltx_font_italic" id="bib.bib71.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1603.09382" title="">1603.09382</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Wightman R, Touvron H and Jégou H 2021 Resnet strikes back: An improved training procedure in timm (<span class="ltx_text ltx_font_italic" id="bib.bib72.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2110.00476" title="">2110.00476</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
Wightman R 2019 Pytorch image models <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/rwightman/pytorch-image-models" title="">https://github.com/rwightman/pytorch-image-models</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock">
Touvron H, Cord M, Douze M, Massa F, Sablayrolles A and Jégou H 2021 Training data-efficient image transformers &amp; distillation through attention (<span class="ltx_text ltx_font_italic" id="bib.bib74.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2012.12877" title="">2012.12877</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2012.12877" title="">https://arxiv.org/abs/2012.12877</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock">
maintainers T and contributors 2016 TorchVision: PyTorch’s Computer Vision library URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/pytorch/vision" title="">https://github.com/pytorch/vision</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock">
Wang Z, Simoncelli E and Bovik A 2003 Multiscale structural similarity for image quality assessment

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock">
Zhao H, Gallo O, Frosio I and Kautz J 2015 <span class="ltx_text ltx_font_italic" id="bib.bib77.1.1">CoRR</span> <span class="ltx_text ltx_font_bold" id="bib.bib77.2.2">abs/1511.08861</span> (<span class="ltx_text ltx_font_italic" id="bib.bib77.3.3">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1511.08861" title="">1511.08861</a>)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock">
Nicki Skafte Detlefsen, Jiri Borovec, Justus Schock, Ananya Harsh, Teddy Koker, Luca Di Liello, Daniel Stancl, Changsheng Quan, Maxim Grechkin and William Falcon 2022 TorchMetrics - Measuring Reproducibility in PyTorch URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Lightning-AI/torchmetrics" title="">https://github.com/Lightning-AI/torchmetrics</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_tag_bibitem">[79]</span>
<span class="ltx_bibblock">
Liu Z, Lin Y, Cao Y, Hu H, Wei Y, Zhang Z, Lin S and Guo B 2021 Swin transformer: Hierarchical vision transformer using shifted windows (<span class="ltx_text ltx_font_italic" id="bib.bib79.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2103.14030" title="">2103.14030</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2103.14030" title="">https://arxiv.org/abs/2103.14030</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_tag_bibitem">[80]</span>
<span class="ltx_bibblock">
Zheng S, Lu J, Zhao H, Zhu X, Luo Z, Wang Y, Fu Y, Feng J, Xiang T, Torr P H S and Zhang L 2021 Rethinking semantic segmentation from a sequence-to-sequence perspective with transformers (<span class="ltx_text ltx_font_italic" id="bib.bib80.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2012.15840" title="">2012.15840</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2012.15840" title="">https://arxiv.org/abs/2012.15840</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_tag_bibitem">[81]</span>
<span class="ltx_bibblock">
Thiadmer Riemersma 2019 srgb distance <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.compuphase.com/cmetric.htm" title="">https://www.compuphase.com/cmetric.htm</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_tag_bibitem">[82]</span>
<span class="ltx_bibblock">
Wang Z and Bovik A 2002 <span class="ltx_text ltx_font_italic" id="bib.bib82.1.1">IEEE Signal Processing Letters</span> <span class="ltx_text ltx_font_bold" id="bib.bib82.2.2">9</span> 81–84 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ece.uwaterloo.ca/~z70wang/publications/quality_2c.pdf" title="">https://ece.uwaterloo.ca/~z70wang/publications/quality_2c.pdf</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_tag_bibitem">[83]</span>
<span class="ltx_bibblock">
Sun T, Lu C and Ling H 2023 Domain adaptation with adversarial training on penultimate activations (<span class="ltx_text ltx_font_italic" id="bib.bib83.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2208.12853" title="">2208.12853</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2208.12853" title="">https://arxiv.org/abs/2208.12853</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_tag_bibitem">[84]</span>
<span class="ltx_bibblock">
Isola P, Zhu J Y, Zhou T and Efros A A 2018 Image-to-image translation with conditional adversarial networks (<span class="ltx_text ltx_font_italic" id="bib.bib84.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="1611.07004" title="">1611.07004</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1611.07004" title="">https://arxiv.org/abs/1611.07004</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_tag_bibitem">[85]</span>
<span class="ltx_bibblock">
Dubey S R and Singh S K 2023 Transformer-based generative adversarial networks in computer vision: A comprehensive survey (<span class="ltx_text ltx_font_italic" id="bib.bib85.1.1">Preprint</span> <a class="ltx_ref ltx_url ltx_font_typewriter" href="2302.08641" title="">2302.08641</a>) URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2302.08641" title="">https://arxiv.org/abs/2302.08641</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_tag_bibitem">[86]</span>
<span class="ltx_bibblock">
Anderlini, Lucio, Boccali, Tommaso, Dal Pra, Stefano, Duma, Doina Cristina, Giommi, Luca, Spiga, Daniele and Vino, Gioacchino 2024 <span class="ltx_text ltx_font_italic" id="bib.bib86.1.1">EPJ Web of Conf.</span> <span class="ltx_text ltx_font_bold" id="bib.bib86.2.2">295</span> 08013 URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1051/epjconf/202429508013" title="">https://doi.org/10.1051/epjconf/202429508013</a>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct 11 13:57:13 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
