<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2108.07931] Learning Federated Representations and Recommendations with Limited Negatives</title><meta property="og:description" content="Deep retrieval models are widely used for learning entity representations and recommendations. Federated learning provides a privacy-preserving way to train these models without requiring centralization of user data. H…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning Federated Representations and Recommendations with Limited Negatives">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Learning Federated Representations and Recommendations with Limited Negatives">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2108.07931">

<!--Generated on Wed Mar  6 23:00:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Learning Federated Representations and Recommendations with Limited Negatives</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Lin Ning 
<br class="ltx_break">Google Research 
<br class="ltx_break">linning@google.com 
<br class="ltx_break">&amp;Karan Singhal 
<br class="ltx_break">Google Research 
<br class="ltx_break">karansinghal@google.com 
<br class="ltx_break">&amp;Ellie X. Zhou 
<br class="ltx_break">Google 
<br class="ltx_break">ezhou@google.com 
<br class="ltx_break">&amp;Sushant Prakash 
<br class="ltx_break">Google Research 
<br class="ltx_break">sush@google.com
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Deep retrieval models are widely used for learning entity representations and recommendations. Federated learning provides a privacy-preserving way to train these models without requiring centralization of user data. However, federated deep retrieval models usually perform much worse than their centralized counterparts due to non-IID (independent and identically distributed) training data on clients, an intrinsic property of federated learning that limits negatives available for training. We demonstrate that this issue is distinct from the commonly studied client drift problem. This work proposes <span id="id1.id1.1" class="ltx_text ltx_font_italic">batch-insensitive losses</span> as a way to alleviate the non-IID negatives issue for federated movie recommendations. We explore a variety of techniques and identify that batch-insensitive losses can effectively improve the performance of federated deep retrieval models, increasing the relative recall of the federated model by up to 93.15% and reducing the relative gap in recall between it and a centralized model from 27.22% - 43.14% to 0.53% - 2.42%. We also open-source our code framework to accelerate further research and applications of federated deep retrieval models.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Recent years have witnessed the successes of deep retrieval models in many large-scale recommendation systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and natural language tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. While these models largely improve user experience by enabling personalization and representation learning, they can also raise privacy concerns as user data typically needs to be sent to a centralized server for training.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Federated learning (FL) is a decentralized training strategy in which clients collaborate with a coordinating server to train a machine learning model <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. It provides opportunities to leverage distributed client data to learn useful models while preserving user privacy. Bringing deep retrieval models to FL is a promising way to power recommendations and learn representations for users and items while addressing privacy concerns by reducing the centralization of user data.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">In this work, we observe a challenge with training federated deep retrieval models: the insufficiency of negative examples available on a client’s device. A deep retrieval model (shown in <a href="#S2.F1" title="In 2 Federated Deep Retrieval Model ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>) learns embeddings representing users’ contexts and items like movies, songs, or websites. For the model to learn meaningful embeddings, it generally uses two types of examples: positive examples and negative examples. The positive examples pull embeddings of the training <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">(context, item)</span> pairs to be close together in an embedding space, while the negative examples push embeddings of unrelated pairs farther apart. Negative examples are typically required to prevent <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">embedding space collapse</em>, where learned representations collapse to a single point and are no longer informative.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Typically, negative examples are produced by sampling items from training data. In centralized training, training data is usually assumed to be independent and identically distributed (IID). Therefore, negatives can be sampled reliably from the overall training distribution. However, the IID data assumption does not hold for federated learning since clients generate data locally based on their circumstances. That means, on each device, negatives may not be present. Even if they are present, they may be relatively few and relatively similar. In practice, we observe that this leads to significant performance degradation when FL is applied naively, beyond the typical degradation observed for <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">e.g.,</span> classification in the FL setting.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">This work focuses on understanding and alleviating the non-IID issue for deep retrieval models. We make the following <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">key contributions</span>:</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Observe that naive federated training of deep retrieval models causes an unusually steep performance drop. Show that performance degradation is primarily caused by sampling negatives from non-IID data, not the typical client drift issue or other aspects of federated training.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Introduce <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">batch-insensitive losses</span> as a class of objectives to alleviate the issue in this setting.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Perform empirical evaluation of different training objectives in a movie recommendation setting, showing that batch-insensitive losses enable performant federated deep retrieval.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i4.p1.1" class="ltx_p">Release an open-source framework to accelerate further research and practical applications of federated deep retrieval models.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://git.io/federated_dual_encoder" title="" class="ltx_ref ltx_href">https://git.io/federated_dual_encoder</a></span></span></span></p>
</div>
</li>
</ul>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p"><span id="S1.p7.1.1" class="ltx_text ltx_font_bold">Related Work: </span> Most previous research has focused on mitigating the non-IID data issue <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> for improving general model convergence in federated learning settings. These works study the general problem of heterogeneity in client data causing <em id="S1.p7.1.2" class="ltx_emph ltx_font_italic">client drift</em> when clients perform multiple local computation steps, as in <span id="S1.p7.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. However, some of them require sharing some training data across clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, and most of them study image classification tasks. The developed techniques are not fully relevant to the deep retrieval model, which sees unusually severe performance degradation due to explicit reliance on sampling negatives for training. Though also caused by non-IID data, this issue is orthogonal to the client drift issue: it occurs even when clients perform one local update step. We can combine the techniques explored in this work with previous techniques for addressing client drift. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> also studies the effectiveness of hinge loss and spreadout regularizer in federated learning. However, it focuses on classification tasks and only considers extreme cases where each user has no access to negative examples. Our work focuses on a more realistic setting, aiming to understand and increase the performance of representation learning and item recommendation with deep retrieval models when each client has access to some but limited and relatively similar negative examples. More broadly, we propose batch-insensitive losses, which can be generally valuable for alleviating non-IID data issues in other federated learning tasks.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Federated Deep Retrieval Model</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2108.07931/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="207" height="153" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An illustration of a deep retrieval model.</figcaption>
</figure>
<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">Deep retrieval models are also referred to as dual encoder, two-tower, or encoder-encoder models depending on the setting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. This general framework has been successfully deployed in a variety of real-world applications in embedding and recommendation learning. As illustrated in <a href="#S2.F1" title="In 2 Federated Deep Retrieval Model ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>, a deep retrieval model consists of two encoders, each of which can be a fully-connected network, convolutional neural network, Transformer, and so on, depending on the task. The input consists of <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">(context, item)</span> pairs encoded by the left and right encoders, respectively. For example, in a movie recommendation use-case, a context might be a sequence of previous movies a user has watched, and the item is the next movie they watch. The goals of applying a deep retrieval model in this setting would be to learn a model that can predict the next movie given an unseen sequence of previous movies and learn encoders that produce embeddings for users and movies.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.13" class="ltx_p">More formally, we denote the feature vectors representing contexts and items as <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathbf{x}</annotation></semantics></math> and <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbf{y}</annotation></semantics></math>. The two encoders are denoted as two parameterized functions <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.p2.3.m3.1a"><mrow id="S2.p2.3.m3.1.2" xref="S2.p2.3.m3.1.2.cmml"><mi id="S2.p2.3.m3.1.2.2" xref="S2.p2.3.m3.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.p2.3.m3.1.2.1" xref="S2.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S2.p2.3.m3.1.2.3.2" xref="S2.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S2.p2.3.m3.1.2.3.2.1" xref="S2.p2.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.3.m3.1.2.3.2.2" xref="S2.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.2.cmml" xref="S2.p2.3.m3.1.2"><times id="S2.p2.3.m3.1.2.1.cmml" xref="S2.p2.3.m3.1.2.1"></times><ci id="S2.p2.3.m3.1.2.2.cmml" xref="S2.p2.3.m3.1.2.2">𝑓</ci><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">f(\cdot)</annotation></semantics></math> and <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.2" xref="S2.p2.4.m4.1.2.cmml"><mi id="S2.p2.4.m4.1.2.2" xref="S2.p2.4.m4.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.p2.4.m4.1.2.1" xref="S2.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S2.p2.4.m4.1.2.3.2" xref="S2.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S2.p2.4.m4.1.2.3.2.1" xref="S2.p2.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.4.m4.1.2.3.2.2" xref="S2.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.2.cmml" xref="S2.p2.4.m4.1.2"><times id="S2.p2.4.m4.1.2.1.cmml" xref="S2.p2.4.m4.1.2.1"></times><ci id="S2.p2.4.m4.1.2.2.cmml" xref="S2.p2.4.m4.1.2.2">𝑔</ci><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">g(\cdot)</annotation></semantics></math>, with <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="f(\mathbf{x})" display="inline"><semantics id="S2.p2.5.m5.1a"><mrow id="S2.p2.5.m5.1.2" xref="S2.p2.5.m5.1.2.cmml"><mi id="S2.p2.5.m5.1.2.2" xref="S2.p2.5.m5.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.p2.5.m5.1.2.1" xref="S2.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S2.p2.5.m5.1.2.3.2" xref="S2.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S2.p2.5.m5.1.2.3.2.1" xref="S2.p2.5.m5.1.2.cmml">(</mo><mi id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.p2.5.m5.1.2.3.2.2" xref="S2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.2.cmml" xref="S2.p2.5.m5.1.2"><times id="S2.p2.5.m5.1.2.1.cmml" xref="S2.p2.5.m5.1.2.1"></times><ci id="S2.p2.5.m5.1.2.2.cmml" xref="S2.p2.5.m5.1.2.2">𝑓</ci><ci id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">f(\mathbf{x})</annotation></semantics></math> and <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="g(\mathbf{y})" display="inline"><semantics id="S2.p2.6.m6.1a"><mrow id="S2.p2.6.m6.1.2" xref="S2.p2.6.m6.1.2.cmml"><mi id="S2.p2.6.m6.1.2.2" xref="S2.p2.6.m6.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.p2.6.m6.1.2.1" xref="S2.p2.6.m6.1.2.1.cmml">​</mo><mrow id="S2.p2.6.m6.1.2.3.2" xref="S2.p2.6.m6.1.2.cmml"><mo stretchy="false" id="S2.p2.6.m6.1.2.3.2.1" xref="S2.p2.6.m6.1.2.cmml">(</mo><mi id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">𝐲</mi><mo stretchy="false" id="S2.p2.6.m6.1.2.3.2.2" xref="S2.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.2.cmml" xref="S2.p2.6.m6.1.2"><times id="S2.p2.6.m6.1.2.1.cmml" xref="S2.p2.6.m6.1.2.1"></times><ci id="S2.p2.6.m6.1.2.2.cmml" xref="S2.p2.6.m6.1.2.2">𝑔</ci><ci id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">g(\mathbf{y})</annotation></semantics></math> mapping <math id="S2.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.p2.7.m7.1a"><mi id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><ci id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">\mathbf{x}</annotation></semantics></math> and <math id="S2.p2.8.m8.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S2.p2.8.m8.1a"><mi id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><ci id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">\mathbf{y}</annotation></semantics></math> to a shared embedding space. The model outputs the similarity score between the encoded context and item, <span id="S2.p2.13.1" class="ltx_text ltx_font_italic">e.g.,</span> the inner product of context and item embeddings, <math id="S2.p2.9.m9.6" class="ltx_Math" alttext="s(\mathbf{x},\mathbf{y})=\big{\langle}f(\mathbf{x}),g(\mathbf{y})\big{\rangle}" display="inline"><semantics id="S2.p2.9.m9.6a"><mrow id="S2.p2.9.m9.6.6" xref="S2.p2.9.m9.6.6.cmml"><mrow id="S2.p2.9.m9.6.6.4" xref="S2.p2.9.m9.6.6.4.cmml"><mi id="S2.p2.9.m9.6.6.4.2" xref="S2.p2.9.m9.6.6.4.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p2.9.m9.6.6.4.1" xref="S2.p2.9.m9.6.6.4.1.cmml">​</mo><mrow id="S2.p2.9.m9.6.6.4.3.2" xref="S2.p2.9.m9.6.6.4.3.1.cmml"><mo stretchy="false" id="S2.p2.9.m9.6.6.4.3.2.1" xref="S2.p2.9.m9.6.6.4.3.1.cmml">(</mo><mi id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml">𝐱</mi><mo id="S2.p2.9.m9.6.6.4.3.2.2" xref="S2.p2.9.m9.6.6.4.3.1.cmml">,</mo><mi id="S2.p2.9.m9.2.2" xref="S2.p2.9.m9.2.2.cmml">𝐲</mi><mo stretchy="false" id="S2.p2.9.m9.6.6.4.3.2.3" xref="S2.p2.9.m9.6.6.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.p2.9.m9.6.6.3" xref="S2.p2.9.m9.6.6.3.cmml">=</mo><mrow id="S2.p2.9.m9.6.6.2.2" xref="S2.p2.9.m9.6.6.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S2.p2.9.m9.6.6.2.2.3" xref="S2.p2.9.m9.6.6.2.3.cmml">⟨</mo><mrow id="S2.p2.9.m9.5.5.1.1.1" xref="S2.p2.9.m9.5.5.1.1.1.cmml"><mi id="S2.p2.9.m9.5.5.1.1.1.2" xref="S2.p2.9.m9.5.5.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.p2.9.m9.5.5.1.1.1.1" xref="S2.p2.9.m9.5.5.1.1.1.1.cmml">​</mo><mrow id="S2.p2.9.m9.5.5.1.1.1.3.2" xref="S2.p2.9.m9.5.5.1.1.1.cmml"><mo stretchy="false" id="S2.p2.9.m9.5.5.1.1.1.3.2.1" xref="S2.p2.9.m9.5.5.1.1.1.cmml">(</mo><mi id="S2.p2.9.m9.3.3" xref="S2.p2.9.m9.3.3.cmml">𝐱</mi><mo stretchy="false" id="S2.p2.9.m9.5.5.1.1.1.3.2.2" xref="S2.p2.9.m9.5.5.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p2.9.m9.6.6.2.2.4" xref="S2.p2.9.m9.6.6.2.3.cmml">,</mo><mrow id="S2.p2.9.m9.6.6.2.2.2" xref="S2.p2.9.m9.6.6.2.2.2.cmml"><mi id="S2.p2.9.m9.6.6.2.2.2.2" xref="S2.p2.9.m9.6.6.2.2.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.p2.9.m9.6.6.2.2.2.1" xref="S2.p2.9.m9.6.6.2.2.2.1.cmml">​</mo><mrow id="S2.p2.9.m9.6.6.2.2.2.3.2" xref="S2.p2.9.m9.6.6.2.2.2.cmml"><mo stretchy="false" id="S2.p2.9.m9.6.6.2.2.2.3.2.1" xref="S2.p2.9.m9.6.6.2.2.2.cmml">(</mo><mi id="S2.p2.9.m9.4.4" xref="S2.p2.9.m9.4.4.cmml">𝐲</mi><mo stretchy="false" id="S2.p2.9.m9.6.6.2.2.2.3.2.2" xref="S2.p2.9.m9.6.6.2.2.2.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S2.p2.9.m9.6.6.2.2.5" xref="S2.p2.9.m9.6.6.2.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.6b"><apply id="S2.p2.9.m9.6.6.cmml" xref="S2.p2.9.m9.6.6"><eq id="S2.p2.9.m9.6.6.3.cmml" xref="S2.p2.9.m9.6.6.3"></eq><apply id="S2.p2.9.m9.6.6.4.cmml" xref="S2.p2.9.m9.6.6.4"><times id="S2.p2.9.m9.6.6.4.1.cmml" xref="S2.p2.9.m9.6.6.4.1"></times><ci id="S2.p2.9.m9.6.6.4.2.cmml" xref="S2.p2.9.m9.6.6.4.2">𝑠</ci><interval closure="open" id="S2.p2.9.m9.6.6.4.3.1.cmml" xref="S2.p2.9.m9.6.6.4.3.2"><ci id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1">𝐱</ci><ci id="S2.p2.9.m9.2.2.cmml" xref="S2.p2.9.m9.2.2">𝐲</ci></interval></apply><list id="S2.p2.9.m9.6.6.2.3.cmml" xref="S2.p2.9.m9.6.6.2.2"><apply id="S2.p2.9.m9.5.5.1.1.1.cmml" xref="S2.p2.9.m9.5.5.1.1.1"><times id="S2.p2.9.m9.5.5.1.1.1.1.cmml" xref="S2.p2.9.m9.5.5.1.1.1.1"></times><ci id="S2.p2.9.m9.5.5.1.1.1.2.cmml" xref="S2.p2.9.m9.5.5.1.1.1.2">𝑓</ci><ci id="S2.p2.9.m9.3.3.cmml" xref="S2.p2.9.m9.3.3">𝐱</ci></apply><apply id="S2.p2.9.m9.6.6.2.2.2.cmml" xref="S2.p2.9.m9.6.6.2.2.2"><times id="S2.p2.9.m9.6.6.2.2.2.1.cmml" xref="S2.p2.9.m9.6.6.2.2.2.1"></times><ci id="S2.p2.9.m9.6.6.2.2.2.2.cmml" xref="S2.p2.9.m9.6.6.2.2.2.2">𝑔</ci><ci id="S2.p2.9.m9.4.4.cmml" xref="S2.p2.9.m9.4.4">𝐲</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.6c">s(\mathbf{x},\mathbf{y})=\big{\langle}f(\mathbf{x}),g(\mathbf{y})\big{\rangle}</annotation></semantics></math>. A loss function is applied to enforce that positive examples (<span id="S2.p2.13.2" class="ltx_text ltx_font_italic">i.e.,</span> similar context and item pairs) have high similarity, and negative examples have low similarity.
Once the parameterized functions <math id="S2.p2.10.m10.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.p2.10.m10.1a"><mrow id="S2.p2.10.m10.1.2" xref="S2.p2.10.m10.1.2.cmml"><mi id="S2.p2.10.m10.1.2.2" xref="S2.p2.10.m10.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.p2.10.m10.1.2.1" xref="S2.p2.10.m10.1.2.1.cmml">​</mo><mrow id="S2.p2.10.m10.1.2.3.2" xref="S2.p2.10.m10.1.2.cmml"><mo stretchy="false" id="S2.p2.10.m10.1.2.3.2.1" xref="S2.p2.10.m10.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.10.m10.1.2.3.2.2" xref="S2.p2.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><apply id="S2.p2.10.m10.1.2.cmml" xref="S2.p2.10.m10.1.2"><times id="S2.p2.10.m10.1.2.1.cmml" xref="S2.p2.10.m10.1.2.1"></times><ci id="S2.p2.10.m10.1.2.2.cmml" xref="S2.p2.10.m10.1.2.2">𝑓</ci><ci id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">f(\cdot)</annotation></semantics></math> and <math id="S2.p2.11.m11.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S2.p2.11.m11.1a"><mrow id="S2.p2.11.m11.1.2" xref="S2.p2.11.m11.1.2.cmml"><mi id="S2.p2.11.m11.1.2.2" xref="S2.p2.11.m11.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.p2.11.m11.1.2.1" xref="S2.p2.11.m11.1.2.1.cmml">​</mo><mrow id="S2.p2.11.m11.1.2.3.2" xref="S2.p2.11.m11.1.2.cmml"><mo stretchy="false" id="S2.p2.11.m11.1.2.3.2.1" xref="S2.p2.11.m11.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.11.m11.1.1" xref="S2.p2.11.m11.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.11.m11.1.2.3.2.2" xref="S2.p2.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.11.m11.1b"><apply id="S2.p2.11.m11.1.2.cmml" xref="S2.p2.11.m11.1.2"><times id="S2.p2.11.m11.1.2.1.cmml" xref="S2.p2.11.m11.1.2.1"></times><ci id="S2.p2.11.m11.1.2.2.cmml" xref="S2.p2.11.m11.1.2.2">𝑔</ci><ci id="S2.p2.11.m11.1.1.cmml" xref="S2.p2.11.m11.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m11.1c">g(\cdot)</annotation></semantics></math> are learned, the model can predict relevant items given a new context. The representations produced by <math id="S2.p2.12.m12.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.p2.12.m12.1a"><mrow id="S2.p2.12.m12.1.2" xref="S2.p2.12.m12.1.2.cmml"><mi id="S2.p2.12.m12.1.2.2" xref="S2.p2.12.m12.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.p2.12.m12.1.2.1" xref="S2.p2.12.m12.1.2.1.cmml">​</mo><mrow id="S2.p2.12.m12.1.2.3.2" xref="S2.p2.12.m12.1.2.cmml"><mo stretchy="false" id="S2.p2.12.m12.1.2.3.2.1" xref="S2.p2.12.m12.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.12.m12.1.1" xref="S2.p2.12.m12.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.12.m12.1.2.3.2.2" xref="S2.p2.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.12.m12.1b"><apply id="S2.p2.12.m12.1.2.cmml" xref="S2.p2.12.m12.1.2"><times id="S2.p2.12.m12.1.2.1.cmml" xref="S2.p2.12.m12.1.2.1"></times><ci id="S2.p2.12.m12.1.2.2.cmml" xref="S2.p2.12.m12.1.2.2">𝑓</ci><ci id="S2.p2.12.m12.1.1.cmml" xref="S2.p2.12.m12.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m12.1c">f(\cdot)</annotation></semantics></math> and <math id="S2.p2.13.m13.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S2.p2.13.m13.1a"><mrow id="S2.p2.13.m13.1.2" xref="S2.p2.13.m13.1.2.cmml"><mi id="S2.p2.13.m13.1.2.2" xref="S2.p2.13.m13.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.p2.13.m13.1.2.1" xref="S2.p2.13.m13.1.2.1.cmml">​</mo><mrow id="S2.p2.13.m13.1.2.3.2" xref="S2.p2.13.m13.1.2.cmml"><mo stretchy="false" id="S2.p2.13.m13.1.2.3.2.1" xref="S2.p2.13.m13.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.13.m13.1.1" xref="S2.p2.13.m13.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.13.m13.1.2.3.2.2" xref="S2.p2.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.13.m13.1b"><apply id="S2.p2.13.m13.1.2.cmml" xref="S2.p2.13.m13.1.2"><times id="S2.p2.13.m13.1.2.1.cmml" xref="S2.p2.13.m13.1.2.1"></times><ci id="S2.p2.13.m13.1.2.2.cmml" xref="S2.p2.13.m13.1.2.2">𝑔</ci><ci id="S2.p2.13.m13.1.1.cmml" xref="S2.p2.13.m13.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m13.1c">g(\cdot)</annotation></semantics></math> are general representations of user contexts and items and can also be used for other downstream applications, such as classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.11" class="ltx_p"><span id="S2.p3.11.1" class="ltx_text ltx_font_bold">Loss Function: </span> The loss function plays a key role in training a deep retrieval model. The most commonly used one <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> is softmax cross-entropy loss over similarities :
<math id="S2.p3.1.m1.8" class="ltx_Math" alttext="\ell(\mathbf{X}_{i},\mathbf{Y}_{i})=-\log(e^{s(\mathbf{X}_{i},\mathbf{Y}_{i})}/\sum_{\mathbf{Y}_{j}\in\mathcal{N}}e^{s(\mathbf{X}_{i},\mathbf{Y}_{j})})" display="inline"><semantics id="S2.p3.1.m1.8a"><mrow id="S2.p3.1.m1.8.8" xref="S2.p3.1.m1.8.8.cmml"><mrow id="S2.p3.1.m1.7.7.2" xref="S2.p3.1.m1.7.7.2.cmml"><mi mathvariant="normal" id="S2.p3.1.m1.7.7.2.4" xref="S2.p3.1.m1.7.7.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.p3.1.m1.7.7.2.3" xref="S2.p3.1.m1.7.7.2.3.cmml">​</mo><mrow id="S2.p3.1.m1.7.7.2.2.2" xref="S2.p3.1.m1.7.7.2.2.3.cmml"><mo stretchy="false" id="S2.p3.1.m1.7.7.2.2.2.3" xref="S2.p3.1.m1.7.7.2.2.3.cmml">(</mo><msub id="S2.p3.1.m1.6.6.1.1.1.1" xref="S2.p3.1.m1.6.6.1.1.1.1.cmml"><mi id="S2.p3.1.m1.6.6.1.1.1.1.2" xref="S2.p3.1.m1.6.6.1.1.1.1.2.cmml">𝐗</mi><mi id="S2.p3.1.m1.6.6.1.1.1.1.3" xref="S2.p3.1.m1.6.6.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p3.1.m1.7.7.2.2.2.4" xref="S2.p3.1.m1.7.7.2.2.3.cmml">,</mo><msub id="S2.p3.1.m1.7.7.2.2.2.2" xref="S2.p3.1.m1.7.7.2.2.2.2.cmml"><mi id="S2.p3.1.m1.7.7.2.2.2.2.2" xref="S2.p3.1.m1.7.7.2.2.2.2.2.cmml">𝐘</mi><mi id="S2.p3.1.m1.7.7.2.2.2.2.3" xref="S2.p3.1.m1.7.7.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.p3.1.m1.7.7.2.2.2.5" xref="S2.p3.1.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.p3.1.m1.8.8.4" xref="S2.p3.1.m1.8.8.4.cmml">=</mo><mrow id="S2.p3.1.m1.8.8.3" xref="S2.p3.1.m1.8.8.3.cmml"><mo rspace="0.167em" id="S2.p3.1.m1.8.8.3a" xref="S2.p3.1.m1.8.8.3.cmml">−</mo><mrow id="S2.p3.1.m1.8.8.3.1.1" xref="S2.p3.1.m1.8.8.3.1.2.cmml"><mi id="S2.p3.1.m1.5.5" xref="S2.p3.1.m1.5.5.cmml">log</mi><mo id="S2.p3.1.m1.8.8.3.1.1a" xref="S2.p3.1.m1.8.8.3.1.2.cmml">⁡</mo><mrow id="S2.p3.1.m1.8.8.3.1.1.1" xref="S2.p3.1.m1.8.8.3.1.2.cmml"><mo stretchy="false" id="S2.p3.1.m1.8.8.3.1.1.1.2" xref="S2.p3.1.m1.8.8.3.1.2.cmml">(</mo><mrow id="S2.p3.1.m1.8.8.3.1.1.1.1" xref="S2.p3.1.m1.8.8.3.1.1.1.1.cmml"><msup id="S2.p3.1.m1.8.8.3.1.1.1.1.2" xref="S2.p3.1.m1.8.8.3.1.1.1.1.2.cmml"><mi id="S2.p3.1.m1.8.8.3.1.1.1.1.2.2" xref="S2.p3.1.m1.8.8.3.1.1.1.1.2.2.cmml">e</mi><mrow id="S2.p3.1.m1.2.2.2" xref="S2.p3.1.m1.2.2.2.cmml"><mi id="S2.p3.1.m1.2.2.2.4" xref="S2.p3.1.m1.2.2.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p3.1.m1.2.2.2.3" xref="S2.p3.1.m1.2.2.2.3.cmml">​</mo><mrow id="S2.p3.1.m1.2.2.2.2.2" xref="S2.p3.1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.p3.1.m1.2.2.2.2.2.3" xref="S2.p3.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S2.p3.1.m1.1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S2.p3.1.m1.1.1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p3.1.m1.2.2.2.2.2.4" xref="S2.p3.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.p3.1.m1.2.2.2.2.2.2" xref="S2.p3.1.m1.2.2.2.2.2.2.cmml"><mi id="S2.p3.1.m1.2.2.2.2.2.2.2" xref="S2.p3.1.m1.2.2.2.2.2.2.2.cmml">𝐘</mi><mi id="S2.p3.1.m1.2.2.2.2.2.2.3" xref="S2.p3.1.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.p3.1.m1.2.2.2.2.2.5" xref="S2.p3.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></msup><mo rspace="0.055em" id="S2.p3.1.m1.8.8.3.1.1.1.1.1" xref="S2.p3.1.m1.8.8.3.1.1.1.1.1.cmml">/</mo><mrow id="S2.p3.1.m1.8.8.3.1.1.1.1.3" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.cmml"><msub id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.cmml"><mo id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.2" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.cmml"><msub id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.cmml"><mi id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.2" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.2.cmml">𝐘</mi><mi id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.3" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.3.cmml">j</mi></msub><mo id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.1" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.3" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.3.cmml">𝒩</mi></mrow></msub><msup id="S2.p3.1.m1.8.8.3.1.1.1.1.3.2" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.2.cmml"><mi id="S2.p3.1.m1.8.8.3.1.1.1.1.3.2.2" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.2.2.cmml">e</mi><mrow id="S2.p3.1.m1.4.4.2" xref="S2.p3.1.m1.4.4.2.cmml"><mi id="S2.p3.1.m1.4.4.2.4" xref="S2.p3.1.m1.4.4.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.p3.1.m1.4.4.2.3" xref="S2.p3.1.m1.4.4.2.3.cmml">​</mo><mrow id="S2.p3.1.m1.4.4.2.2.2" xref="S2.p3.1.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="S2.p3.1.m1.4.4.2.2.2.3" xref="S2.p3.1.m1.4.4.2.2.3.cmml">(</mo><msub id="S2.p3.1.m1.3.3.1.1.1.1" xref="S2.p3.1.m1.3.3.1.1.1.1.cmml"><mi id="S2.p3.1.m1.3.3.1.1.1.1.2" xref="S2.p3.1.m1.3.3.1.1.1.1.2.cmml">𝐗</mi><mi id="S2.p3.1.m1.3.3.1.1.1.1.3" xref="S2.p3.1.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p3.1.m1.4.4.2.2.2.4" xref="S2.p3.1.m1.4.4.2.2.3.cmml">,</mo><msub id="S2.p3.1.m1.4.4.2.2.2.2" xref="S2.p3.1.m1.4.4.2.2.2.2.cmml"><mi id="S2.p3.1.m1.4.4.2.2.2.2.2" xref="S2.p3.1.m1.4.4.2.2.2.2.2.cmml">𝐘</mi><mi id="S2.p3.1.m1.4.4.2.2.2.2.3" xref="S2.p3.1.m1.4.4.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S2.p3.1.m1.4.4.2.2.2.5" xref="S2.p3.1.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></msup></mrow></mrow><mo stretchy="false" id="S2.p3.1.m1.8.8.3.1.1.1.3" xref="S2.p3.1.m1.8.8.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.8b"><apply id="S2.p3.1.m1.8.8.cmml" xref="S2.p3.1.m1.8.8"><eq id="S2.p3.1.m1.8.8.4.cmml" xref="S2.p3.1.m1.8.8.4"></eq><apply id="S2.p3.1.m1.7.7.2.cmml" xref="S2.p3.1.m1.7.7.2"><times id="S2.p3.1.m1.7.7.2.3.cmml" xref="S2.p3.1.m1.7.7.2.3"></times><ci id="S2.p3.1.m1.7.7.2.4.cmml" xref="S2.p3.1.m1.7.7.2.4">ℓ</ci><interval closure="open" id="S2.p3.1.m1.7.7.2.2.3.cmml" xref="S2.p3.1.m1.7.7.2.2.2"><apply id="S2.p3.1.m1.6.6.1.1.1.1.cmml" xref="S2.p3.1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.6.6.1.1.1.1.1.cmml" xref="S2.p3.1.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.6.6.1.1.1.1.2.cmml" xref="S2.p3.1.m1.6.6.1.1.1.1.2">𝐗</ci><ci id="S2.p3.1.m1.6.6.1.1.1.1.3.cmml" xref="S2.p3.1.m1.6.6.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p3.1.m1.7.7.2.2.2.2.cmml" xref="S2.p3.1.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.7.7.2.2.2.2.1.cmml" xref="S2.p3.1.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S2.p3.1.m1.7.7.2.2.2.2.2.cmml" xref="S2.p3.1.m1.7.7.2.2.2.2.2">𝐘</ci><ci id="S2.p3.1.m1.7.7.2.2.2.2.3.cmml" xref="S2.p3.1.m1.7.7.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S2.p3.1.m1.8.8.3.cmml" xref="S2.p3.1.m1.8.8.3"><minus id="S2.p3.1.m1.8.8.3.2.cmml" xref="S2.p3.1.m1.8.8.3"></minus><apply id="S2.p3.1.m1.8.8.3.1.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1"><log id="S2.p3.1.m1.5.5.cmml" xref="S2.p3.1.m1.5.5"></log><apply id="S2.p3.1.m1.8.8.3.1.1.1.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1"><divide id="S2.p3.1.m1.8.8.3.1.1.1.1.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.1"></divide><apply id="S2.p3.1.m1.8.8.3.1.1.1.1.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.8.8.3.1.1.1.1.2.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.2">superscript</csymbol><ci id="S2.p3.1.m1.8.8.3.1.1.1.1.2.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.2.2">𝑒</ci><apply id="S2.p3.1.m1.2.2.2.cmml" xref="S2.p3.1.m1.2.2.2"><times id="S2.p3.1.m1.2.2.2.3.cmml" xref="S2.p3.1.m1.2.2.2.3"></times><ci id="S2.p3.1.m1.2.2.2.4.cmml" xref="S2.p3.1.m1.2.2.2.4">𝑠</ci><interval closure="open" id="S2.p3.1.m1.2.2.2.2.3.cmml" xref="S2.p3.1.m1.2.2.2.2.2"><apply id="S2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1.1.1.1.2">𝐗</ci><ci id="S2.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p3.1.m1.2.2.2.2.2.2.cmml" xref="S2.p3.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.2.2.2.2.2.2.1.cmml" xref="S2.p3.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.p3.1.m1.2.2.2.2.2.2.2.cmml" xref="S2.p3.1.m1.2.2.2.2.2.2.2">𝐘</ci><ci id="S2.p3.1.m1.2.2.2.2.2.2.3.cmml" xref="S2.p3.1.m1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S2.p3.1.m1.8.8.3.1.1.1.1.3.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3"><apply id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1">subscript</csymbol><sum id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.2"></sum><apply id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3"><in id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.1"></in><apply id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2">subscript</csymbol><ci id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.2">𝐘</ci><ci id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.3.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.2.3">𝑗</ci></apply><ci id="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.3.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.1.3.3">𝒩</ci></apply></apply><apply id="S2.p3.1.m1.8.8.3.1.1.1.1.3.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.8.8.3.1.1.1.1.3.2.1.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.2">superscript</csymbol><ci id="S2.p3.1.m1.8.8.3.1.1.1.1.3.2.2.cmml" xref="S2.p3.1.m1.8.8.3.1.1.1.1.3.2.2">𝑒</ci><apply id="S2.p3.1.m1.4.4.2.cmml" xref="S2.p3.1.m1.4.4.2"><times id="S2.p3.1.m1.4.4.2.3.cmml" xref="S2.p3.1.m1.4.4.2.3"></times><ci id="S2.p3.1.m1.4.4.2.4.cmml" xref="S2.p3.1.m1.4.4.2.4">𝑠</ci><interval closure="open" id="S2.p3.1.m1.4.4.2.2.3.cmml" xref="S2.p3.1.m1.4.4.2.2.2"><apply id="S2.p3.1.m1.3.3.1.1.1.1.cmml" xref="S2.p3.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.p3.1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.p3.1.m1.3.3.1.1.1.1.2">𝐗</ci><ci id="S2.p3.1.m1.3.3.1.1.1.1.3.cmml" xref="S2.p3.1.m1.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p3.1.m1.4.4.2.2.2.2.cmml" xref="S2.p3.1.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.4.4.2.2.2.2.1.cmml" xref="S2.p3.1.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S2.p3.1.m1.4.4.2.2.2.2.2.cmml" xref="S2.p3.1.m1.4.4.2.2.2.2.2">𝐘</ci><ci id="S2.p3.1.m1.4.4.2.2.2.2.3.cmml" xref="S2.p3.1.m1.4.4.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.8c">\ell(\mathbf{X}_{i},\mathbf{Y}_{i})=-\log(e^{s(\mathbf{X}_{i},\mathbf{Y}_{i})}/\sum_{\mathbf{Y}_{j}\in\mathcal{N}}e^{s(\mathbf{X}_{i},\mathbf{Y}_{j})})</annotation></semantics></math>. <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S2.p3.2.m2.1a"><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathbf{X}</annotation></semantics></math> and <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S2.p3.3.m3.1a"><mi id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><ci id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">\mathbf{Y}</annotation></semantics></math> represent all the contexts and items in a batch, and <math id="S2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S2.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><ci id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">\mathcal{N}</annotation></semantics></math> is a set of negative labels used to construct negative example pairs <math id="S2.p3.5.m5.2" class="ltx_Math" alttext="(\mathbf{X}_{i},\mathbf{Y}_{j})" display="inline"><semantics id="S2.p3.5.m5.2a"><mrow id="S2.p3.5.m5.2.2.2" xref="S2.p3.5.m5.2.2.3.cmml"><mo stretchy="false" id="S2.p3.5.m5.2.2.2.3" xref="S2.p3.5.m5.2.2.3.cmml">(</mo><msub id="S2.p3.5.m5.1.1.1.1" xref="S2.p3.5.m5.1.1.1.1.cmml"><mi id="S2.p3.5.m5.1.1.1.1.2" xref="S2.p3.5.m5.1.1.1.1.2.cmml">𝐗</mi><mi id="S2.p3.5.m5.1.1.1.1.3" xref="S2.p3.5.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p3.5.m5.2.2.2.4" xref="S2.p3.5.m5.2.2.3.cmml">,</mo><msub id="S2.p3.5.m5.2.2.2.2" xref="S2.p3.5.m5.2.2.2.2.cmml"><mi id="S2.p3.5.m5.2.2.2.2.2" xref="S2.p3.5.m5.2.2.2.2.2.cmml">𝐘</mi><mi id="S2.p3.5.m5.2.2.2.2.3" xref="S2.p3.5.m5.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S2.p3.5.m5.2.2.2.5" xref="S2.p3.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.2b"><interval closure="open" id="S2.p3.5.m5.2.2.3.cmml" xref="S2.p3.5.m5.2.2.2"><apply id="S2.p3.5.m5.1.1.1.1.cmml" xref="S2.p3.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m5.1.1.1.1.1.cmml" xref="S2.p3.5.m5.1.1.1.1">subscript</csymbol><ci id="S2.p3.5.m5.1.1.1.1.2.cmml" xref="S2.p3.5.m5.1.1.1.1.2">𝐗</ci><ci id="S2.p3.5.m5.1.1.1.1.3.cmml" xref="S2.p3.5.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p3.5.m5.2.2.2.2.cmml" xref="S2.p3.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S2.p3.5.m5.2.2.2.2.1.cmml" xref="S2.p3.5.m5.2.2.2.2">subscript</csymbol><ci id="S2.p3.5.m5.2.2.2.2.2.cmml" xref="S2.p3.5.m5.2.2.2.2.2">𝐘</ci><ci id="S2.p3.5.m5.2.2.2.2.3.cmml" xref="S2.p3.5.m5.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.2c">(\mathbf{X}_{i},\mathbf{Y}_{j})</annotation></semantics></math>. The model is incentivized to maximize the similarity between positive example pairs and minimize the similarity between negative example pairs. Note that if it only did the former, then the embedding space produced by <math id="S2.p3.6.m6.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.p3.6.m6.1a"><mrow id="S2.p3.6.m6.1.2" xref="S2.p3.6.m6.1.2.cmml"><mi id="S2.p3.6.m6.1.2.2" xref="S2.p3.6.m6.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.p3.6.m6.1.2.1" xref="S2.p3.6.m6.1.2.1.cmml">​</mo><mrow id="S2.p3.6.m6.1.2.3.2" xref="S2.p3.6.m6.1.2.cmml"><mo stretchy="false" id="S2.p3.6.m6.1.2.3.2.1" xref="S2.p3.6.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p3.6.m6.1.2.3.2.2" xref="S2.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><apply id="S2.p3.6.m6.1.2.cmml" xref="S2.p3.6.m6.1.2"><times id="S2.p3.6.m6.1.2.1.cmml" xref="S2.p3.6.m6.1.2.1"></times><ci id="S2.p3.6.m6.1.2.2.cmml" xref="S2.p3.6.m6.1.2.2">𝑓</ci><ci id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">f(\cdot)</annotation></semantics></math> and <math id="S2.p3.7.m7.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S2.p3.7.m7.1a"><mrow id="S2.p3.7.m7.1.2" xref="S2.p3.7.m7.1.2.cmml"><mi id="S2.p3.7.m7.1.2.2" xref="S2.p3.7.m7.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.1.2.1" xref="S2.p3.7.m7.1.2.1.cmml">​</mo><mrow id="S2.p3.7.m7.1.2.3.2" xref="S2.p3.7.m7.1.2.cmml"><mo stretchy="false" id="S2.p3.7.m7.1.2.3.2.1" xref="S2.p3.7.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p3.7.m7.1.2.3.2.2" xref="S2.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><apply id="S2.p3.7.m7.1.2.cmml" xref="S2.p3.7.m7.1.2"><times id="S2.p3.7.m7.1.2.1.cmml" xref="S2.p3.7.m7.1.2.1"></times><ci id="S2.p3.7.m7.1.2.2.cmml" xref="S2.p3.7.m7.1.2.2">𝑔</ci><ci id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">g(\cdot)</annotation></semantics></math> would collapse. Therefore, negative examples are important to learn a good model. A standard method for getting negatives is to use in-batch negatives <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, which means given a training batch and any (<math id="S2.p3.8.m8.1" class="ltx_Math" alttext="\mathbf{X}_{i}" display="inline"><semantics id="S2.p3.8.m8.1a"><msub id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml"><mi id="S2.p3.8.m8.1.1.2" xref="S2.p3.8.m8.1.1.2.cmml">𝐗</mi><mi id="S2.p3.8.m8.1.1.3" xref="S2.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><apply id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.1.cmml" xref="S2.p3.8.m8.1.1">subscript</csymbol><ci id="S2.p3.8.m8.1.1.2.cmml" xref="S2.p3.8.m8.1.1.2">𝐗</ci><ci id="S2.p3.8.m8.1.1.3.cmml" xref="S2.p3.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">\mathbf{X}_{i}</annotation></semantics></math>, <math id="S2.p3.9.m9.1" class="ltx_Math" alttext="\mathbf{Y}_{i}" display="inline"><semantics id="S2.p3.9.m9.1a"><msub id="S2.p3.9.m9.1.1" xref="S2.p3.9.m9.1.1.cmml"><mi id="S2.p3.9.m9.1.1.2" xref="S2.p3.9.m9.1.1.2.cmml">𝐘</mi><mi id="S2.p3.9.m9.1.1.3" xref="S2.p3.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.9.m9.1b"><apply id="S2.p3.9.m9.1.1.cmml" xref="S2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.1.cmml" xref="S2.p3.9.m9.1.1">subscript</csymbol><ci id="S2.p3.9.m9.1.1.2.cmml" xref="S2.p3.9.m9.1.1.2">𝐘</ci><ci id="S2.p3.9.m9.1.1.3.cmml" xref="S2.p3.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m9.1c">\mathbf{Y}_{i}</annotation></semantics></math>) pair in the batch, all other items <math id="S2.p3.10.m10.2" class="ltx_Math" alttext="\mathbf{Y}_{j,j\neq i}" display="inline"><semantics id="S2.p3.10.m10.2a"><msub id="S2.p3.10.m10.2.3" xref="S2.p3.10.m10.2.3.cmml"><mi id="S2.p3.10.m10.2.3.2" xref="S2.p3.10.m10.2.3.2.cmml">𝐘</mi><mrow id="S2.p3.10.m10.2.2.2" xref="S2.p3.10.m10.2.2.2.cmml"><mrow id="S2.p3.10.m10.2.2.2.4.2" xref="S2.p3.10.m10.2.2.2.4.1.cmml"><mi id="S2.p3.10.m10.1.1.1.1" xref="S2.p3.10.m10.1.1.1.1.cmml">j</mi><mo id="S2.p3.10.m10.2.2.2.4.2.1" xref="S2.p3.10.m10.2.2.2.4.1.cmml">,</mo><mi id="S2.p3.10.m10.2.2.2.2" xref="S2.p3.10.m10.2.2.2.2.cmml">j</mi></mrow><mo id="S2.p3.10.m10.2.2.2.3" xref="S2.p3.10.m10.2.2.2.3.cmml">≠</mo><mi id="S2.p3.10.m10.2.2.2.5" xref="S2.p3.10.m10.2.2.2.5.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p3.10.m10.2b"><apply id="S2.p3.10.m10.2.3.cmml" xref="S2.p3.10.m10.2.3"><csymbol cd="ambiguous" id="S2.p3.10.m10.2.3.1.cmml" xref="S2.p3.10.m10.2.3">subscript</csymbol><ci id="S2.p3.10.m10.2.3.2.cmml" xref="S2.p3.10.m10.2.3.2">𝐘</ci><apply id="S2.p3.10.m10.2.2.2.cmml" xref="S2.p3.10.m10.2.2.2"><neq id="S2.p3.10.m10.2.2.2.3.cmml" xref="S2.p3.10.m10.2.2.2.3"></neq><list id="S2.p3.10.m10.2.2.2.4.1.cmml" xref="S2.p3.10.m10.2.2.2.4.2"><ci id="S2.p3.10.m10.1.1.1.1.cmml" xref="S2.p3.10.m10.1.1.1.1">𝑗</ci><ci id="S2.p3.10.m10.2.2.2.2.cmml" xref="S2.p3.10.m10.2.2.2.2">𝑗</ci></list><ci id="S2.p3.10.m10.2.2.2.5.cmml" xref="S2.p3.10.m10.2.2.2.5">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m10.2c">\mathbf{Y}_{j,j\neq i}</annotation></semantics></math> in the same batch are treated as negatives for <math id="S2.p3.11.m11.1" class="ltx_Math" alttext="\mathbf{X}_{i}" display="inline"><semantics id="S2.p3.11.m11.1a"><msub id="S2.p3.11.m11.1.1" xref="S2.p3.11.m11.1.1.cmml"><mi id="S2.p3.11.m11.1.1.2" xref="S2.p3.11.m11.1.1.2.cmml">𝐗</mi><mi id="S2.p3.11.m11.1.1.3" xref="S2.p3.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.11.m11.1b"><apply id="S2.p3.11.m11.1.1.cmml" xref="S2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S2.p3.11.m11.1.1.1.cmml" xref="S2.p3.11.m11.1.1">subscript</csymbol><ci id="S2.p3.11.m11.1.1.2.cmml" xref="S2.p3.11.m11.1.1.2">𝐗</ci><ci id="S2.p3.11.m11.1.1.3.cmml" xref="S2.p3.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.11.m11.1c">\mathbf{X}_{i}</annotation></semantics></math>. We refer to this as <em id="S2.p3.11.2" class="ltx_emph ltx_font_italic">batch softmax</em> below.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">Federated training of a deep retrieval model involves three main steps in each training round. First, a central server sends the current model to several randomly sampled clients. Second, each sampled client trains on its dataset and updates its model locally. Finally, the local model updates are sent back to the server and aggregated to update the server model. The de-facto standard federated optimization method is <span id="S2.p4.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Each client updates its model multiple times before sending the model update back to the server to be averaged. We also later refer to <span id="S2.p4.1.2" class="ltx_text ltx_font_smallcaps">FedSGD</span>, where each client only runs a single local training step at each round, similar to standard distributed training.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p">As discussed in <a href="#S4.SS2" title="4.2 Effect of Non-IID Data ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>, naively applying federated learning to this setting produces a steep performance drop, worse than typical when comparing centralized and federated performance. We will show that training degrades due to non-IID negatives. Note that this is distinct from the <span id="S2.p5.1.1" class="ltx_text ltx_font_italic">client drift</span> phenomenon discussed in other works <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, which causes slight performance deterioration when clients take multiple local steps. In contrast, the problem we observe occurs even in the <span id="S2.p5.1.2" class="ltx_text ltx_font_smallcaps">FedSGD</span> regime (see <a href="#S4.F3" title="In 4.2 Effect of Non-IID Data ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>). This work aims to characterize this problem better and propose methods that enable federated deep retrieval models to perform comparably to centralized counterparts.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Batch-Insensitive Losses</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">We propose <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">batch-insensitive losses</span> as a potential solution to address the non-IID data issue.</p>
</div>
<div id="Thmdefinition1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmdefinition1.1.1.1" class="ltx_text ltx_font_bold">Definition 1</span></span><span id="Thmdefinition1.2.2" class="ltx_text ltx_font_bold"> </span>(Batch-Insensitive Loss)<span id="Thmdefinition1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmdefinition1.p1" class="ltx_para">
<p id="Thmdefinition1.p1.4" class="ltx_p"><span id="Thmdefinition1.p1.4.4" class="ltx_text ltx_font_italic">Given a batch of N examples and two parameterized functions <math id="Thmdefinition1.p1.1.1.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><mrow id="Thmdefinition1.p1.1.1.m1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.2.cmml"><mi id="Thmdefinition1.p1.1.1.m1.1.2.2" xref="Thmdefinition1.p1.1.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Thmdefinition1.p1.1.1.m1.1.2.1" xref="Thmdefinition1.p1.1.1.m1.1.2.1.cmml">​</mo><mrow id="Thmdefinition1.p1.1.1.m1.1.2.3.2" xref="Thmdefinition1.p1.1.1.m1.1.2.cmml"><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.2.3.2.1" xref="Thmdefinition1.p1.1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.2.3.2.2" xref="Thmdefinition1.p1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><apply id="Thmdefinition1.p1.1.1.m1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.2"><times id="Thmdefinition1.p1.1.1.m1.1.2.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.2.1"></times><ci id="Thmdefinition1.p1.1.1.m1.1.2.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.2.2">𝑓</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">f(\cdot)</annotation></semantics></math> and <math id="Thmdefinition1.p1.2.2.m2.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="Thmdefinition1.p1.2.2.m2.1a"><mrow id="Thmdefinition1.p1.2.2.m2.1.2" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml"><mi id="Thmdefinition1.p1.2.2.m2.1.2.2" xref="Thmdefinition1.p1.2.2.m2.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="Thmdefinition1.p1.2.2.m2.1.2.1" xref="Thmdefinition1.p1.2.2.m2.1.2.1.cmml">​</mo><mrow id="Thmdefinition1.p1.2.2.m2.1.2.3.2" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml"><mo stretchy="false" id="Thmdefinition1.p1.2.2.m2.1.2.3.2.1" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="Thmdefinition1.p1.2.2.m2.1.2.3.2.2" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.1b"><apply id="Thmdefinition1.p1.2.2.m2.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.2"><times id="Thmdefinition1.p1.2.2.m2.1.2.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.2.1"></times><ci id="Thmdefinition1.p1.2.2.m2.1.2.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.2.2">𝑔</ci><ci id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.1c">g(\cdot)</annotation></semantics></math>, with all contexts and items in the batch denoted as <math id="Thmdefinition1.p1.3.3.m3.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="Thmdefinition1.p1.3.3.m3.1a"><mi id="Thmdefinition1.p1.3.3.m3.1.1" xref="Thmdefinition1.p1.3.3.m3.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.m3.1b"><ci id="Thmdefinition1.p1.3.3.m3.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.m3.1c">\mathbf{X}</annotation></semantics></math> and <math id="Thmdefinition1.p1.4.4.m4.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="Thmdefinition1.p1.4.4.m4.1a"><mi id="Thmdefinition1.p1.4.4.m4.1.1" xref="Thmdefinition1.p1.4.4.m4.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.4.m4.1b"><ci id="Thmdefinition1.p1.4.4.m4.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.4.m4.1c">\mathbf{Y}</annotation></semantics></math>, a loss function is batch-insensitive if it satisfies</span></p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\ell_{BI}(\mathbf{X},\mathbf{Y})=\frac{1}{N}\sum_{i=0}^{N}\ell_{BI}(f(\mathbf{X}_{i}),g(\mathbf{Y}_{i}))." display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml"><msub id="S3.E1.m1.3.3.1.1.4.2" xref="S3.E1.m1.3.3.1.1.4.2.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.1.1.4.2.2" xref="S3.E1.m1.3.3.1.1.4.2.2.cmml">ℓ</mi><mrow id="S3.E1.m1.3.3.1.1.4.2.3" xref="S3.E1.m1.3.3.1.1.4.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.4.2.3.2" xref="S3.E1.m1.3.3.1.1.4.2.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.4.2.3.1" xref="S3.E1.m1.3.3.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.4.2.3.3" xref="S3.E1.m1.3.3.1.1.4.2.3.3.cmml">I</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.4.1" xref="S3.E1.m1.3.3.1.1.4.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.4.3.2" xref="S3.E1.m1.3.3.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.4.3.2.1" xref="S3.E1.m1.3.3.1.1.4.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐗</mi><mo id="S3.E1.m1.3.3.1.1.4.3.2.2" xref="S3.E1.m1.3.3.1.1.4.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝐘</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.4.3.2.3" xref="S3.E1.m1.3.3.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><mfrac id="S3.E1.m1.3.3.1.1.2.4" xref="S3.E1.m1.3.3.1.1.2.4.cmml"><mn id="S3.E1.m1.3.3.1.1.2.4.2" xref="S3.E1.m1.3.3.1.1.2.4.2.cmml">1</mn><mi id="S3.E1.m1.3.3.1.1.2.4.3" xref="S3.E1.m1.3.3.1.1.2.4.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><munderover id="S3.E1.m1.3.3.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.2.2.3.2.2" xref="S3.E1.m1.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.3.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.3.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.2.2.3.2.3.1" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.2.2.3.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="S3.E1.m1.3.3.1.1.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.3.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml"><msub id="S3.E1.m1.3.3.1.1.2.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.2.4.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.1.1.2.2.2.4.2" xref="S3.E1.m1.3.3.1.1.2.2.2.4.2.cmml">ℓ</mi><mrow id="S3.E1.m1.3.3.1.1.2.2.2.4.3" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.4.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.2.4.3.1" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.2.2.2.4.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.3.cmml">I</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.2.cmml">𝐘</mi><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.5" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"></eq><apply id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"><times id="S3.E1.m1.3.3.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.4.1"></times><apply id="S3.E1.m1.3.3.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.2.1.cmml" xref="S3.E1.m1.3.3.1.1.4.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.4.2.2.cmml" xref="S3.E1.m1.3.3.1.1.4.2.2">ℓ</ci><apply id="S3.E1.m1.3.3.1.1.4.2.3.cmml" xref="S3.E1.m1.3.3.1.1.4.2.3"><times id="S3.E1.m1.3.3.1.1.4.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.4.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.4.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.4.2.3.2">𝐵</ci><ci id="S3.E1.m1.3.3.1.1.4.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.4.2.3.3">𝐼</ci></apply></apply><interval closure="open" id="S3.E1.m1.3.3.1.1.4.3.1.cmml" xref="S3.E1.m1.3.3.1.1.4.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐗</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐘</ci></interval></apply><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><times id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3"></times><apply id="S3.E1.m1.3.3.1.1.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.4"><divide id="S3.E1.m1.3.3.1.1.2.4.1.cmml" xref="S3.E1.m1.3.3.1.1.2.4"></divide><cn type="integer" id="S3.E1.m1.3.3.1.1.2.4.2.cmml" xref="S3.E1.m1.3.3.1.1.2.4.2">1</cn><ci id="S3.E1.m1.3.3.1.1.2.4.3.cmml" xref="S3.E1.m1.3.3.1.1.2.4.3">𝑁</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3"><eq id="S3.E1.m1.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.3">0</cn></apply></apply><ci id="S3.E1.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.3">𝑁</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3"></times><apply id="S3.E1.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.4.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.4.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.2">ℓ</ci><apply id="S3.E1.m1.3.3.1.1.2.2.2.4.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3"><times id="S3.E1.m1.3.3.1.1.2.2.2.4.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.1"></times><ci id="S3.E1.m1.3.3.1.1.2.2.2.4.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.2">𝐵</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.4.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.3">𝐼</ci></apply></apply><interval closure="open" id="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2"></times><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3">𝑔</ci><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.2">𝐘</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\ell_{BI}(\mathbf{X},\mathbf{Y})=\frac{1}{N}\sum_{i=0}^{N}\ell_{BI}(f(\mathbf{X}_{i}),g(\mathbf{Y}_{i})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">It follows that applying a batch-insensitive loss over several batches of data in parallel (not in sequence) produces the same average loss and gradient update no matter how the examples are batched. We use this to show that we can produce the same gradient update between federated and centralized learning, providing a natural justification for batch-insensitive losses.</p>
</div>
<div id="Thmproposition1" class="ltx_theorem ltx_theorem_proposition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmproposition1.1.1.1" class="ltx_text ltx_font_bold">Proposition 1</span></span><span id="Thmproposition1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmproposition1.p1" class="ltx_para">
<p id="Thmproposition1.p1.10" class="ltx_p"><span id="Thmproposition1.p1.10.10" class="ltx_text ltx_font_italic">Let <math id="Thmproposition1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="Thmproposition1.p1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.1.1.m1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.1.1.m1.1b"><ci id="Thmproposition1.p1.1.1.m1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.1.1.m1.1c">\mathcal{C}</annotation></semantics></math> be a collection of clients sampled at round <math id="Thmproposition1.p1.2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Thmproposition1.p1.2.2.m2.1a"><mi id="Thmproposition1.p1.2.2.m2.1.1" xref="Thmproposition1.p1.2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.2.2.m2.1b"><ci id="Thmproposition1.p1.2.2.m2.1.1.cmml" xref="Thmproposition1.p1.2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.2.2.m2.1c">k</annotation></semantics></math> for federated learning. Denote the aggregated update to the model for that round under <span id="Thmproposition1.p1.10.10.1" class="ltx_text ltx_font_smallcaps">FedSGD</span> as <math id="Thmproposition1.p1.3.3.m3.3" class="ltx_Math" alttext="\Delta_{k,fedsgd}(\mathcal{C})" display="inline"><semantics id="Thmproposition1.p1.3.3.m3.3a"><mrow id="Thmproposition1.p1.3.3.m3.3.4" xref="Thmproposition1.p1.3.3.m3.3.4.cmml"><msub id="Thmproposition1.p1.3.3.m3.3.4.2" xref="Thmproposition1.p1.3.3.m3.3.4.2.cmml"><mi mathvariant="normal" id="Thmproposition1.p1.3.3.m3.3.4.2.2" xref="Thmproposition1.p1.3.3.m3.3.4.2.2.cmml">Δ</mi><mrow id="Thmproposition1.p1.3.3.m3.2.2.2.2" xref="Thmproposition1.p1.3.3.m3.2.2.2.3.cmml"><mi id="Thmproposition1.p1.3.3.m3.1.1.1.1" xref="Thmproposition1.p1.3.3.m3.1.1.1.1.cmml">k</mi><mo id="Thmproposition1.p1.3.3.m3.2.2.2.2.2" xref="Thmproposition1.p1.3.3.m3.2.2.2.3.cmml">,</mo><mrow id="Thmproposition1.p1.3.3.m3.2.2.2.2.1" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.cmml"><mi id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.2" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.3" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1a" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.4" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1b" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.5" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1c" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.6" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1d" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.7" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.3.3.m3.3.4.1" xref="Thmproposition1.p1.3.3.m3.3.4.1.cmml">​</mo><mrow id="Thmproposition1.p1.3.3.m3.3.4.3.2" xref="Thmproposition1.p1.3.3.m3.3.4.cmml"><mo stretchy="false" id="Thmproposition1.p1.3.3.m3.3.4.3.2.1" xref="Thmproposition1.p1.3.3.m3.3.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.3.3.m3.3.3" xref="Thmproposition1.p1.3.3.m3.3.3.cmml">𝒞</mi><mo stretchy="false" id="Thmproposition1.p1.3.3.m3.3.4.3.2.2" xref="Thmproposition1.p1.3.3.m3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.3.3.m3.3b"><apply id="Thmproposition1.p1.3.3.m3.3.4.cmml" xref="Thmproposition1.p1.3.3.m3.3.4"><times id="Thmproposition1.p1.3.3.m3.3.4.1.cmml" xref="Thmproposition1.p1.3.3.m3.3.4.1"></times><apply id="Thmproposition1.p1.3.3.m3.3.4.2.cmml" xref="Thmproposition1.p1.3.3.m3.3.4.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.3.3.m3.3.4.2.1.cmml" xref="Thmproposition1.p1.3.3.m3.3.4.2">subscript</csymbol><ci id="Thmproposition1.p1.3.3.m3.3.4.2.2.cmml" xref="Thmproposition1.p1.3.3.m3.3.4.2.2">Δ</ci><list id="Thmproposition1.p1.3.3.m3.2.2.2.3.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2"><ci id="Thmproposition1.p1.3.3.m3.1.1.1.1.cmml" xref="Thmproposition1.p1.3.3.m3.1.1.1.1">𝑘</ci><apply id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1"><times id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.1"></times><ci id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.2.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.2">𝑓</ci><ci id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.3.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.3">𝑒</ci><ci id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.4.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.4">𝑑</ci><ci id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.5.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.5">𝑠</ci><ci id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.6.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.6">𝑔</ci><ci id="Thmproposition1.p1.3.3.m3.2.2.2.2.1.7.cmml" xref="Thmproposition1.p1.3.3.m3.2.2.2.2.1.7">𝑑</ci></apply></list></apply><ci id="Thmproposition1.p1.3.3.m3.3.3.cmml" xref="Thmproposition1.p1.3.3.m3.3.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.3.3.m3.3c">\Delta_{k,fedsgd}(\mathcal{C})</annotation></semantics></math>. Let <math id="Thmproposition1.p1.4.4.m4.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="Thmproposition1.p1.4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.4.4.m4.1.1" xref="Thmproposition1.p1.4.4.m4.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.4.4.m4.1b"><ci id="Thmproposition1.p1.4.4.m4.1.1.cmml" xref="Thmproposition1.p1.4.4.m4.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.4.4.m4.1c">\mathcal{E}</annotation></semantics></math> be the collection of all training examples from clients in <math id="Thmproposition1.p1.5.5.m5.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="Thmproposition1.p1.5.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.5.5.m5.1.1" xref="Thmproposition1.p1.5.5.m5.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.5.5.m5.1b"><ci id="Thmproposition1.p1.5.5.m5.1.1.cmml" xref="Thmproposition1.p1.5.5.m5.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.5.5.m5.1c">\mathcal{C}</annotation></semantics></math>. Denote the model update of centralized training using SGD with all examples in <math id="Thmproposition1.p1.6.6.m6.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="Thmproposition1.p1.6.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.6.6.m6.1.1" xref="Thmproposition1.p1.6.6.m6.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.6.6.m6.1b"><ci id="Thmproposition1.p1.6.6.m6.1.1.cmml" xref="Thmproposition1.p1.6.6.m6.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.6.6.m6.1c">\mathcal{E}</annotation></semantics></math> in a batch is <math id="Thmproposition1.p1.7.7.m7.3" class="ltx_Math" alttext="\Delta_{k,sgd}(\mathcal{E})" display="inline"><semantics id="Thmproposition1.p1.7.7.m7.3a"><mrow id="Thmproposition1.p1.7.7.m7.3.4" xref="Thmproposition1.p1.7.7.m7.3.4.cmml"><msub id="Thmproposition1.p1.7.7.m7.3.4.2" xref="Thmproposition1.p1.7.7.m7.3.4.2.cmml"><mi mathvariant="normal" id="Thmproposition1.p1.7.7.m7.3.4.2.2" xref="Thmproposition1.p1.7.7.m7.3.4.2.2.cmml">Δ</mi><mrow id="Thmproposition1.p1.7.7.m7.2.2.2.2" xref="Thmproposition1.p1.7.7.m7.2.2.2.3.cmml"><mi id="Thmproposition1.p1.7.7.m7.1.1.1.1" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.cmml">k</mi><mo id="Thmproposition1.p1.7.7.m7.2.2.2.2.2" xref="Thmproposition1.p1.7.7.m7.2.2.2.3.cmml">,</mo><mrow id="Thmproposition1.p1.7.7.m7.2.2.2.2.1" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.cmml"><mi id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.2" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.1" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.1.cmml">​</mo><mi id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.3" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.1a" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.1.cmml">​</mo><mi id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.4" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.4.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.7.7.m7.3.4.1" xref="Thmproposition1.p1.7.7.m7.3.4.1.cmml">​</mo><mrow id="Thmproposition1.p1.7.7.m7.3.4.3.2" xref="Thmproposition1.p1.7.7.m7.3.4.cmml"><mo stretchy="false" id="Thmproposition1.p1.7.7.m7.3.4.3.2.1" xref="Thmproposition1.p1.7.7.m7.3.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.7.7.m7.3.3" xref="Thmproposition1.p1.7.7.m7.3.3.cmml">ℰ</mi><mo stretchy="false" id="Thmproposition1.p1.7.7.m7.3.4.3.2.2" xref="Thmproposition1.p1.7.7.m7.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.7.7.m7.3b"><apply id="Thmproposition1.p1.7.7.m7.3.4.cmml" xref="Thmproposition1.p1.7.7.m7.3.4"><times id="Thmproposition1.p1.7.7.m7.3.4.1.cmml" xref="Thmproposition1.p1.7.7.m7.3.4.1"></times><apply id="Thmproposition1.p1.7.7.m7.3.4.2.cmml" xref="Thmproposition1.p1.7.7.m7.3.4.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.7.7.m7.3.4.2.1.cmml" xref="Thmproposition1.p1.7.7.m7.3.4.2">subscript</csymbol><ci id="Thmproposition1.p1.7.7.m7.3.4.2.2.cmml" xref="Thmproposition1.p1.7.7.m7.3.4.2.2">Δ</ci><list id="Thmproposition1.p1.7.7.m7.2.2.2.3.cmml" xref="Thmproposition1.p1.7.7.m7.2.2.2.2"><ci id="Thmproposition1.p1.7.7.m7.1.1.1.1.cmml" xref="Thmproposition1.p1.7.7.m7.1.1.1.1">𝑘</ci><apply id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.cmml" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1"><times id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.1.cmml" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.1"></times><ci id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.2.cmml" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.2">𝑠</ci><ci id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.3.cmml" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.3">𝑔</ci><ci id="Thmproposition1.p1.7.7.m7.2.2.2.2.1.4.cmml" xref="Thmproposition1.p1.7.7.m7.2.2.2.2.1.4">𝑑</ci></apply></list></apply><ci id="Thmproposition1.p1.7.7.m7.3.3.cmml" xref="Thmproposition1.p1.7.7.m7.3.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.7.7.m7.3c">\Delta_{k,sgd}(\mathcal{E})</annotation></semantics></math>.
Using the same batch-insensitive loss <math id="Thmproposition1.p1.8.8.m8.1" class="ltx_Math" alttext="\ell_{BI}" display="inline"><semantics id="Thmproposition1.p1.8.8.m8.1a"><msub id="Thmproposition1.p1.8.8.m8.1.1" xref="Thmproposition1.p1.8.8.m8.1.1.cmml"><mi mathvariant="normal" id="Thmproposition1.p1.8.8.m8.1.1.2" xref="Thmproposition1.p1.8.8.m8.1.1.2.cmml">ℓ</mi><mrow id="Thmproposition1.p1.8.8.m8.1.1.3" xref="Thmproposition1.p1.8.8.m8.1.1.3.cmml"><mi id="Thmproposition1.p1.8.8.m8.1.1.3.2" xref="Thmproposition1.p1.8.8.m8.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.8.8.m8.1.1.3.1" xref="Thmproposition1.p1.8.8.m8.1.1.3.1.cmml">​</mo><mi id="Thmproposition1.p1.8.8.m8.1.1.3.3" xref="Thmproposition1.p1.8.8.m8.1.1.3.3.cmml">I</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.8.8.m8.1b"><apply id="Thmproposition1.p1.8.8.m8.1.1.cmml" xref="Thmproposition1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmproposition1.p1.8.8.m8.1.1.1.cmml" xref="Thmproposition1.p1.8.8.m8.1.1">subscript</csymbol><ci id="Thmproposition1.p1.8.8.m8.1.1.2.cmml" xref="Thmproposition1.p1.8.8.m8.1.1.2">ℓ</ci><apply id="Thmproposition1.p1.8.8.m8.1.1.3.cmml" xref="Thmproposition1.p1.8.8.m8.1.1.3"><times id="Thmproposition1.p1.8.8.m8.1.1.3.1.cmml" xref="Thmproposition1.p1.8.8.m8.1.1.3.1"></times><ci id="Thmproposition1.p1.8.8.m8.1.1.3.2.cmml" xref="Thmproposition1.p1.8.8.m8.1.1.3.2">𝐵</ci><ci id="Thmproposition1.p1.8.8.m8.1.1.3.3.cmml" xref="Thmproposition1.p1.8.8.m8.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.8.8.m8.1c">\ell_{BI}</annotation></semantics></math> as training objective, the same model initialization <math id="Thmproposition1.p1.9.9.m9.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="Thmproposition1.p1.9.9.m9.1a"><mi mathvariant="normal" id="Thmproposition1.p1.9.9.m9.1.1" xref="Thmproposition1.p1.9.9.m9.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.9.9.m9.1b"><ci id="Thmproposition1.p1.9.9.m9.1.1.cmml" xref="Thmproposition1.p1.9.9.m9.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.9.9.m9.1c">\Theta</annotation></semantics></math>, and the same learning rate <math id="Thmproposition1.p1.10.10.m10.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="Thmproposition1.p1.10.10.m10.1a"><mi id="Thmproposition1.p1.10.10.m10.1.1" xref="Thmproposition1.p1.10.10.m10.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.10.10.m10.1b"><ci id="Thmproposition1.p1.10.10.m10.1.1.cmml" xref="Thmproposition1.p1.10.10.m10.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.10.10.m10.1c">\eta</annotation></semantics></math>, we have</span></p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.8" class="ltx_Math" alttext="\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)\equiv\Delta_{k,sgd}(\mathcal{E}|\ell_{BI},\Theta)" display="block"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.cmml"><msub id="S3.E2.m1.7.7.1.3" xref="S3.E2.m1.7.7.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.7.7.1.3.2" xref="S3.E2.m1.7.7.1.3.2.cmml">Δ</mi><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">k</mi><mo id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1a" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.4" xref="S3.E2.m1.2.2.2.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1b" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.5" xref="S3.E2.m1.2.2.2.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1c" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.6" xref="S3.E2.m1.2.2.2.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1d" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.7" xref="S3.E2.m1.2.2.2.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.7.7.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.3.cmml">𝒞</mi><mo fence="false" id="S3.E2.m1.7.7.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">|</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml">ℓ</mi><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.3.cmml">I</mi></mrow></msub><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.3" xref="S3.E2.m1.8.8.3.cmml">≡</mo><mrow id="S3.E2.m1.8.8.2" xref="S3.E2.m1.8.8.2.cmml"><msub id="S3.E2.m1.8.8.2.3" xref="S3.E2.m1.8.8.2.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.8.8.2.3.2" xref="S3.E2.m1.8.8.2.3.2.cmml">Δ</mi><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">k</mi><mo id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E2.m1.4.4.2.2.1" xref="S3.E2.m1.4.4.2.2.1.cmml"><mi id="S3.E2.m1.4.4.2.2.1.2" xref="S3.E2.m1.4.4.2.2.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.1.1" xref="S3.E2.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.4.4.2.2.1.3" xref="S3.E2.m1.4.4.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.1.1a" xref="S3.E2.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.4.4.2.2.1.4" xref="S3.E2.m1.4.4.2.2.1.4.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.2.2" xref="S3.E2.m1.8.8.2.2.cmml">​</mo><mrow id="S3.E2.m1.8.8.2.1.1" xref="S3.E2.m1.8.8.2.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.2.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.8.8.2.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.8.8.2.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.3.cmml">ℰ</mi><mo fence="false" id="S3.E2.m1.8.8.2.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.2.cmml">|</mo><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.2.cmml"><msub id="S3.E2.m1.8.8.2.1.1.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.2.cmml">ℓ</mi><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.3.cmml">I</mi></mrow></msub><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="S3.E2.m1.8.8.2.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8"><equivalent id="S3.E2.m1.8.8.3.cmml" xref="S3.E2.m1.8.8.3"></equivalent><apply id="S3.E2.m1.7.7.1.cmml" xref="S3.E2.m1.7.7.1"><times id="S3.E2.m1.7.7.1.2.cmml" xref="S3.E2.m1.7.7.1.2"></times><apply id="S3.E2.m1.7.7.1.3.cmml" xref="S3.E2.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.3.1.cmml" xref="S3.E2.m1.7.7.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.3.2.cmml" xref="S3.E2.m1.7.7.1.3.2">Δ</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑘</ci><apply id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1"><times id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"></times><ci id="S3.E2.m1.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.2">𝑓</ci><ci id="S3.E2.m1.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.3">𝑒</ci><ci id="S3.E2.m1.2.2.2.2.1.4.cmml" xref="S3.E2.m1.2.2.2.2.1.4">𝑑</ci><ci id="S3.E2.m1.2.2.2.2.1.5.cmml" xref="S3.E2.m1.2.2.2.2.1.5">𝑠</ci><ci id="S3.E2.m1.2.2.2.2.1.6.cmml" xref="S3.E2.m1.2.2.2.2.1.6">𝑔</ci><ci id="S3.E2.m1.2.2.2.2.1.7.cmml" xref="S3.E2.m1.2.2.2.2.1.7">𝑑</ci></apply></list></apply><apply id="S3.E2.m1.7.7.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2">conditional</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3">𝒞</ci><list id="S3.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2">ℓ</ci><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3"><times id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2">𝐵</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.3">𝐼</ci></apply></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">Θ</ci></list></apply></apply><apply id="S3.E2.m1.8.8.2.cmml" xref="S3.E2.m1.8.8.2"><times id="S3.E2.m1.8.8.2.2.cmml" xref="S3.E2.m1.8.8.2.2"></times><apply id="S3.E2.m1.8.8.2.3.cmml" xref="S3.E2.m1.8.8.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.3.1.cmml" xref="S3.E2.m1.8.8.2.3">subscript</csymbol><ci id="S3.E2.m1.8.8.2.3.2.cmml" xref="S3.E2.m1.8.8.2.3.2">Δ</ci><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.2"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑘</ci><apply id="S3.E2.m1.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1"><times id="S3.E2.m1.4.4.2.2.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1"></times><ci id="S3.E2.m1.4.4.2.2.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.2">𝑠</ci><ci id="S3.E2.m1.4.4.2.2.1.3.cmml" xref="S3.E2.m1.4.4.2.2.1.3">𝑔</ci><ci id="S3.E2.m1.4.4.2.2.1.4.cmml" xref="S3.E2.m1.4.4.2.2.1.4">𝑑</ci></apply></list></apply><apply id="S3.E2.m1.8.8.2.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.2.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.2">conditional</csymbol><ci id="S3.E2.m1.8.8.2.1.1.1.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.3">ℰ</ci><list id="S3.E2.m1.8.8.2.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1"><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.2">ℓ</ci><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3"><times id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.2">𝐵</ci><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.3.3">𝐼</ci></apply></apply><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">Θ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)\equiv\Delta_{k,sgd}(\mathcal{E}|\ell_{BI},\Theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.2" class="ltx_p">See <a href="#A1" title="Appendix A Proof of Proposition 1 ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a> for proof. <a href="#Thmproposition1" title="Proposition 1. ‣ 3 Batch-Insensitive Losses ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> shows that <span id="S3.p3.2.1" class="ltx_text ltx_font_smallcaps">FedSGD</span> with <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\ell_{BI}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><mi id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.1.1.3.1" xref="S3.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml">I</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">ℓ</ci><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><times id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3.1"></times><ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">𝐵</ci><ci id="S3.p3.1.m1.1.1.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\ell_{BI}</annotation></semantics></math> approximates standard large-batch SGD when the number of clients per round is large (so <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\mathcal{E}</annotation></semantics></math> is representative of the centralized data). This motivates using batch-insensitive losses to mitigate the non-IID data issue.</p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.1" class="ltx_p">Note that batch softmax loss does not have these properties and is batch-sensitive. We now describe specific batch-insensitive losses for the deep retrieval setting.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Hinge Loss + Spreadout Regularizer</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">This loss is a variation of contrastive loss, composed of a positive term pushing positive examples together (hinge loss) and a negative term preventing embedding collapse (spreadout regularization). This combination was first introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.9" class="ltx_p"><span id="S3.SS1.p2.9.1" class="ltx_text ltx_font_bold">Hinge Loss: </span>
Given a positive example pair (<math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbf{x}</annotation></semantics></math>,<math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{y}</annotation></semantics></math>), where <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathbf{x}</annotation></semantics></math> and <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathbf{y}</annotation></semantics></math> are context and item features, the hinge loss is defined as
<math id="S3.SS1.p2.5.m5.6" class="ltx_math_unparsed" alttext="\ell(\mathbf{x},\mathbf{y})=\max({0,\beta-f(\mathbf{x})\cdot g(\mathbf{y})})^{2}," display="inline"><semantics id="S3.SS1.p2.5.m5.6a"><mrow id="S3.SS1.p2.5.m5.6b"><mi mathvariant="normal" id="S3.SS1.p2.5.m5.6.7">ℓ</mi><mrow id="S3.SS1.p2.5.m5.6.8"><mo stretchy="false" id="S3.SS1.p2.5.m5.6.8.1">(</mo><mi id="S3.SS1.p2.5.m5.1.1">𝐱</mi><mo id="S3.SS1.p2.5.m5.6.8.2">,</mo><mi id="S3.SS1.p2.5.m5.2.2">𝐲</mi><mo stretchy="false" id="S3.SS1.p2.5.m5.6.8.3">)</mo></mrow><mo id="S3.SS1.p2.5.m5.6.9">=</mo><mi id="S3.SS1.p2.5.m5.5.5">max</mi><msup id="S3.SS1.p2.5.m5.6.10"><mrow id="S3.SS1.p2.5.m5.6.10.2"><mo stretchy="false" id="S3.SS1.p2.5.m5.6.10.2.1">(</mo><mn id="S3.SS1.p2.5.m5.6.6">0</mn><mo id="S3.SS1.p2.5.m5.6.10.2.2">,</mo><mi id="S3.SS1.p2.5.m5.6.10.2.3">β</mi><mo id="S3.SS1.p2.5.m5.6.10.2.4">−</mo><mi id="S3.SS1.p2.5.m5.6.10.2.5">f</mi><mrow id="S3.SS1.p2.5.m5.6.10.2.6"><mo stretchy="false" id="S3.SS1.p2.5.m5.6.10.2.6.1">(</mo><mi id="S3.SS1.p2.5.m5.3.3">𝐱</mi><mo rspace="0.055em" stretchy="false" id="S3.SS1.p2.5.m5.6.10.2.6.2">)</mo></mrow><mo rspace="0.222em" id="S3.SS1.p2.5.m5.6.10.2.7">⋅</mo><mi id="S3.SS1.p2.5.m5.6.10.2.8">g</mi><mrow id="S3.SS1.p2.5.m5.6.10.2.9"><mo stretchy="false" id="S3.SS1.p2.5.m5.6.10.2.9.1">(</mo><mi id="S3.SS1.p2.5.m5.4.4">𝐲</mi><mo stretchy="false" id="S3.SS1.p2.5.m5.6.10.2.9.2">)</mo></mrow><mo stretchy="false" id="S3.SS1.p2.5.m5.6.10.2.10">)</mo></mrow><mn id="S3.SS1.p2.5.m5.6.10.3">2</mn></msup><mo id="S3.SS1.p2.5.m5.6.11">,</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.6c">\ell(\mathbf{x},\mathbf{y})=\max({0,\beta-f(\mathbf{x})\cdot g(\mathbf{y})})^{2},</annotation></semantics></math>
where <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="f(\mathbf{x})" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.2" xref="S3.SS1.p2.6.m6.1.2.cmml"><mi id="S3.SS1.p2.6.m6.1.2.2" xref="S3.SS1.p2.6.m6.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.6.m6.1.2.1" xref="S3.SS1.p2.6.m6.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.6.m6.1.2.3.2" xref="S3.SS1.p2.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.1.2.3.2.1" xref="S3.SS1.p2.6.m6.1.2.cmml">(</mo><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.SS1.p2.6.m6.1.2.3.2.2" xref="S3.SS1.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.2.cmml" xref="S3.SS1.p2.6.m6.1.2"><times id="S3.SS1.p2.6.m6.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2.1"></times><ci id="S3.SS1.p2.6.m6.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2.2">𝑓</ci><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">f(\mathbf{x})</annotation></semantics></math> is the context embedding, <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="g(\mathbf{y})" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mrow id="S3.SS1.p2.7.m7.1.2" xref="S3.SS1.p2.7.m7.1.2.cmml"><mi id="S3.SS1.p2.7.m7.1.2.2" xref="S3.SS1.p2.7.m7.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.1.2.1" xref="S3.SS1.p2.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.7.m7.1.2.3.2" xref="S3.SS1.p2.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.1.2.3.2.1" xref="S3.SS1.p2.7.m7.1.2.cmml">(</mo><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">𝐲</mi><mo stretchy="false" id="S3.SS1.p2.7.m7.1.2.3.2.2" xref="S3.SS1.p2.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.2.cmml" xref="S3.SS1.p2.7.m7.1.2"><times id="S3.SS1.p2.7.m7.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.1"></times><ci id="S3.SS1.p2.7.m7.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2">𝑔</ci><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">g(\mathbf{y})</annotation></semantics></math> is the item embedding, and <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\beta</annotation></semantics></math> is a tunable margin set to <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><mn id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><cn type="float" id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">0.9</annotation></semantics></math> in this work.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.9" class="ltx_p"><span id="S3.SS1.p3.9.1" class="ltx_text ltx_font_bold">Spreadout Regularization: </span>
Spreadout regularizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> maximizes the spread of embeddings in an embedding space. Given an embedding vocabulary <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">V</annotation></semantics></math> and the corresponding embedding weights <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">W</annotation></semantics></math>, spreadout regularizer can be formulated as
<math id="S3.SS1.p3.3.m3.2" class="ltx_Math" alttext="\ell_{sr}(W)=\sum_{v\in V}\sum_{v^{\prime}\neq v}(-d^{2}(w_{v},w_{v^{\prime}}))," display="inline"><semantics id="S3.SS1.p3.3.m3.2a"><mrow id="S3.SS1.p3.3.m3.2.2.1" xref="S3.SS1.p3.3.m3.2.2.1.1.cmml"><mrow id="S3.SS1.p3.3.m3.2.2.1.1" xref="S3.SS1.p3.3.m3.2.2.1.1.cmml"><mrow id="S3.SS1.p3.3.m3.2.2.1.1.3" xref="S3.SS1.p3.3.m3.2.2.1.1.3.cmml"><msub id="S3.SS1.p3.3.m3.2.2.1.1.3.2" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.SS1.p3.3.m3.2.2.1.1.3.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.2.cmml">ℓ</mi><mrow id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.cmml"><mi id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.2" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.1" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.3" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.3.cmml">r</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.2.2.1.1.3.1" xref="S3.SS1.p3.3.m3.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.SS1.p3.3.m3.2.2.1.1.3.3.2" xref="S3.SS1.p3.3.m3.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p3.3.m3.2.2.1.1.3.3.2.1" xref="S3.SS1.p3.3.m3.2.2.1.1.3.cmml">(</mo><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">W</mi><mo stretchy="false" id="S3.SS1.p3.3.m3.2.2.1.1.3.3.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.SS1.p3.3.m3.2.2.1.1.2" xref="S3.SS1.p3.3.m3.2.2.1.1.2.cmml">=</mo><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1" xref="S3.SS1.p3.3.m3.2.2.1.1.1.cmml"><msub id="S3.SS1.p3.3.m3.2.2.1.1.1.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.cmml"><mo rspace="0em" id="S3.SS1.p3.3.m3.2.2.1.1.1.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.cmml"><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.2.cmml">v</mi><mo id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.1" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.1.cmml">∈</mo><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.3.cmml">V</mi></mrow></msub><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1.1" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.cmml"><msub id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.cmml"><mo rspace="0em" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.cmml"><msup id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.cmml"><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.2.cmml">v</mi><mo id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.3.cmml">′</mo></msup><mo id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.1" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.1.cmml">≠</mo><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.3.cmml">v</mi></mrow></msub><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1a" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.cmml"><msup id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.2.cmml">d</mi><mn id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.4" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml">w</mi><msup id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">v</mi><mo id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">′</mo></msup></msub><mo stretchy="false" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.5" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.3" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.SS1.p3.3.m3.2.2.1.2" xref="S3.SS1.p3.3.m3.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.2b"><apply id="S3.SS1.p3.3.m3.2.2.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1"><eq id="S3.SS1.p3.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.2"></eq><apply id="S3.SS1.p3.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3"><times id="S3.SS1.p3.3.m3.2.2.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.1"></times><apply id="S3.SS1.p3.3.m3.2.2.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.3.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.1.1.3.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.2">ℓ</ci><apply id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3"><times id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.1"></times><ci id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.2">𝑠</ci><ci id="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.3.2.3.3">𝑟</ci></apply></apply><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑊</ci></apply><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1"><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2">subscript</csymbol><sum id="S3.SS1.p3.3.m3.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.2"></sum><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3"><in id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.1"></in><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.2">𝑣</ci><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.2.3.3">𝑉</ci></apply></apply><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1"><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.2"></sum><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3"><neq id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.1"></neq><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2">superscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.2">𝑣</ci><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.2.3">′</ci></apply><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.2.3.3">𝑣</ci></apply></apply><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1"><minus id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1"></minus><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2"><times id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.3"></times><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4">superscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.2">𝑑</ci><cn type="integer" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.4.3">2</cn></apply><interval closure="open" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2"><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.2">𝑤</ci><apply id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.2">𝑣</ci><ci id="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.SS1.p3.3.m3.2.2.1.1.1.1.1.1.1.2.2.2.2.3.3">′</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.2c">\ell_{sr}(W)=\sum_{v\in V}\sum_{v^{\prime}\neq v}(-d^{2}(w_{v},w_{v^{\prime}})),</annotation></semantics></math>
where <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">d</annotation></semantics></math> is a measure of distance, <span id="S3.SS1.p3.9.2" class="ltx_text ltx_font_italic">e.g.,</span> Euclidean distance or negative dot product. When combined with L2 normalization, the objective pushes embeddings in <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">W</annotation></semantics></math> apart on a hypersphere. It can be used with any loss function in the form of
<math id="S3.SS1.p3.6.m6.3" class="ltx_Math" alttext="\ell_{(\cdot)\cdot sr}=\ell_{(\cdot)}+\alpha\ell_{sr}," display="inline"><semantics id="S3.SS1.p3.6.m6.3a"><mrow id="S3.SS1.p3.6.m6.3.3.1" xref="S3.SS1.p3.6.m6.3.3.1.1.cmml"><mrow id="S3.SS1.p3.6.m6.3.3.1.1" xref="S3.SS1.p3.6.m6.3.3.1.1.cmml"><msub id="S3.SS1.p3.6.m6.3.3.1.1.2" xref="S3.SS1.p3.6.m6.3.3.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p3.6.m6.3.3.1.1.2.2" xref="S3.SS1.p3.6.m6.3.3.1.1.2.2.cmml">ℓ</mi><mrow id="S3.SS1.p3.6.m6.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.cmml"><mrow id="S3.SS1.p3.6.m6.1.1.1.3" xref="S3.SS1.p3.6.m6.1.1.1.3.cmml"><mrow id="S3.SS1.p3.6.m6.1.1.1.3.2.2" xref="S3.SS1.p3.6.m6.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p3.6.m6.1.1.1.3.2.2.1" xref="S3.SS1.p3.6.m6.1.1.1.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p3.6.m6.1.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.1.cmml">⋅</mo><mo rspace="0.055em" stretchy="false" id="S3.SS1.p3.6.m6.1.1.1.3.2.2.2" xref="S3.SS1.p3.6.m6.1.1.1.3.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.SS1.p3.6.m6.1.1.1.3.1" xref="S3.SS1.p3.6.m6.1.1.1.3.1.cmml">⋅</mo><mi id="S3.SS1.p3.6.m6.1.1.1.3.3" xref="S3.SS1.p3.6.m6.1.1.1.3.3.cmml">s</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p3.6.m6.1.1.1.2" xref="S3.SS1.p3.6.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS1.p3.6.m6.1.1.1.4" xref="S3.SS1.p3.6.m6.1.1.1.4.cmml">r</mi></mrow></msub><mo id="S3.SS1.p3.6.m6.3.3.1.1.1" xref="S3.SS1.p3.6.m6.3.3.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.6.m6.3.3.1.1.3" xref="S3.SS1.p3.6.m6.3.3.1.1.3.cmml"><msub id="S3.SS1.p3.6.m6.3.3.1.1.3.2" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.SS1.p3.6.m6.3.3.1.1.3.2.2" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2.2.cmml">ℓ</mi><mrow id="S3.SS1.p3.6.m6.2.2.1.3" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2.cmml"><mo stretchy="false" id="S3.SS1.p3.6.m6.2.2.1.3.1" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p3.6.m6.2.2.1.1" xref="S3.SS1.p3.6.m6.2.2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p3.6.m6.2.2.1.3.2" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2.cmml">)</mo></mrow></msub><mo id="S3.SS1.p3.6.m6.3.3.1.1.3.1" xref="S3.SS1.p3.6.m6.3.3.1.1.3.1.cmml">+</mo><mrow id="S3.SS1.p3.6.m6.3.3.1.1.3.3" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.cmml"><mi id="S3.SS1.p3.6.m6.3.3.1.1.3.3.2" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.6.m6.3.3.1.1.3.3.1" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.1.cmml">​</mo><msub id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.cmml"><mi mathvariant="normal" id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.2" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.2.cmml">ℓ</mi><mrow id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.cmml"><mi id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.2" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.1" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.3" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.3.cmml">r</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.SS1.p3.6.m6.3.3.1.2" xref="S3.SS1.p3.6.m6.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.3b"><apply id="S3.SS1.p3.6.m6.3.3.1.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1"><eq id="S3.SS1.p3.6.m6.3.3.1.1.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.1"></eq><apply id="S3.SS1.p3.6.m6.3.3.1.1.2.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.3.3.1.1.2.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.6.m6.3.3.1.1.2.2.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.2.2">ℓ</ci><apply id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1"><times id="S3.SS1.p3.6.m6.1.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.1.2"></times><apply id="S3.SS1.p3.6.m6.1.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.1.3"><ci id="S3.SS1.p3.6.m6.1.1.1.3.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1.3.1">⋅</ci><ci id="S3.SS1.p3.6.m6.1.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1.1">⋅</ci><ci id="S3.SS1.p3.6.m6.1.1.1.3.3.cmml" xref="S3.SS1.p3.6.m6.1.1.1.3.3">𝑠</ci></apply><ci id="S3.SS1.p3.6.m6.1.1.1.4.cmml" xref="S3.SS1.p3.6.m6.1.1.1.4">𝑟</ci></apply></apply><apply id="S3.SS1.p3.6.m6.3.3.1.1.3.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3"><plus id="S3.SS1.p3.6.m6.3.3.1.1.3.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.1"></plus><apply id="S3.SS1.p3.6.m6.3.3.1.1.3.2.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.3.3.1.1.3.2.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p3.6.m6.3.3.1.1.3.2.2.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.2.2">ℓ</ci><ci id="S3.SS1.p3.6.m6.2.2.1.1.cmml" xref="S3.SS1.p3.6.m6.2.2.1.1">⋅</ci></apply><apply id="S3.SS1.p3.6.m6.3.3.1.1.3.3.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3"><times id="S3.SS1.p3.6.m6.3.3.1.1.3.3.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.1"></times><ci id="S3.SS1.p3.6.m6.3.3.1.1.3.3.2.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.2">𝛼</ci><apply id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.2.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.2">ℓ</ci><apply id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3"><times id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.1"></times><ci id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.2.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.2">𝑠</ci><ci id="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p3.6.m6.3.3.1.1.3.3.3.3.3">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.3c">\ell_{(\cdot)\cdot sr}=\ell_{(\cdot)}+\alpha\ell_{sr},</annotation></semantics></math>
where <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="\ell_{(\cdot)}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.2" xref="S3.SS1.p3.7.m7.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p3.7.m7.1.2.2" xref="S3.SS1.p3.7.m7.1.2.2.cmml">ℓ</mi><mrow id="S3.SS1.p3.7.m7.1.1.1.3" xref="S3.SS1.p3.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.7.m7.1.1.1.3.1" xref="S3.SS1.p3.7.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p3.7.m7.1.1.1.1" xref="S3.SS1.p3.7.m7.1.1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p3.7.m7.1.1.1.3.2" xref="S3.SS1.p3.7.m7.1.2.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.2.cmml" xref="S3.SS1.p3.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.2.1.cmml" xref="S3.SS1.p3.7.m7.1.2">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.2.2.cmml" xref="S3.SS1.p3.7.m7.1.2.2">ℓ</ci><ci id="S3.SS1.p3.7.m7.1.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\ell_{(\cdot)}</annotation></semantics></math> is the original loss function, <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="\ell_{sr}" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><msub id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p3.8.m8.1.1.2" xref="S3.SS1.p3.8.m8.1.1.2.cmml">ℓ</mi><mrow id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml"><mi id="S3.SS1.p3.8.m8.1.1.3.2" xref="S3.SS1.p3.8.m8.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.8.m8.1.1.3.1" xref="S3.SS1.p3.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.8.m8.1.1.3.3" xref="S3.SS1.p3.8.m8.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2">ℓ</ci><apply id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3"><times id="S3.SS1.p3.8.m8.1.1.3.1.cmml" xref="S3.SS1.p3.8.m8.1.1.3.1"></times><ci id="S3.SS1.p3.8.m8.1.1.3.2.cmml" xref="S3.SS1.p3.8.m8.1.1.3.2">𝑠</ci><ci id="S3.SS1.p3.8.m8.1.1.3.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">\ell_{sr}</annotation></semantics></math> is the spreadout regularizer, and <math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><mi id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><ci id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">\alpha</annotation></semantics></math> trades off the regularization term and the original loss.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.1" class="ltx_p">Unlike softmax cross-entropy, hinge loss only considers positive examples; the loss can be trivially minimized by collapsing embeddings into a single point. To avoid collapse, we apply spreadout regularizer to the model’s shared embedding table described in <a href="#S4.SS1" title="4.1 Experiment Setting ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.1</span></a>, pushing items in the embedding vocabulary to have orthogonal embeddings. The resulting combined loss pushes positive pairs closer while pushing negatives apart, resulting in a full loss for deep retrieval. Both hinge loss and spreadout regularizer are batch-insensitive based on <a href="#Thmdefinition1" title="Definition 1 (Batch-Insensitive Loss). ‣ 3 Batch-Insensitive Losses ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Definition</span> <span class="ltx_text ltx_ref_tag">1</span></a>. It is easy to show that a linear combination of them is also batch-insensitive.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Global Softmax</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.6" class="ltx_p">The <em id="S3.SS2.p1.6.1" class="ltx_emph ltx_font_italic">global softmax</em> loss is defined as
<math id="S3.SS2.p1.1.m1.6" class="ltx_Math" alttext="\ell(\mathbf{X}_{i},\mathbf{Y}_{i})=-\log(e^{f(\mathbf{X}_{i})\cdot g(\mathbf{Y}_{i})}/\sum_{\mathbf{Y}_{j}\in V}e^{f(\mathbf{X}_{i})\cdot g(\mathbf{Y}_{j})})," display="inline"><semantics id="S3.SS2.p1.1.m1.6a"><mrow id="S3.SS2.p1.1.m1.6.6.1" xref="S3.SS2.p1.1.m1.6.6.1.1.cmml"><mrow id="S3.SS2.p1.1.m1.6.6.1.1" xref="S3.SS2.p1.1.m1.6.6.1.1.cmml"><mrow id="S3.SS2.p1.1.m1.6.6.1.1.2" xref="S3.SS2.p1.1.m1.6.6.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS2.p1.1.m1.6.6.1.1.2.4" xref="S3.SS2.p1.1.m1.6.6.1.1.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.6.6.1.1.2.3" xref="S3.SS2.p1.1.m1.6.6.1.1.2.3.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.3" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.3.cmml">(</mo><msub id="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.4" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.2" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.2.cmml">𝐘</mi><mi id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.3" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.5" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.1.m1.6.6.1.1.4" xref="S3.SS2.p1.1.m1.6.6.1.1.4.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.6.6.1.1.3" xref="S3.SS2.p1.1.m1.6.6.1.1.3.cmml"><mo rspace="0.167em" id="S3.SS2.p1.1.m1.6.6.1.1.3a" xref="S3.SS2.p1.1.m1.6.6.1.1.3.cmml">−</mo><mrow id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.2.cmml"><mi id="S3.SS2.p1.1.m1.5.5" xref="S3.SS2.p1.1.m1.5.5.cmml">log</mi><mo id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1a" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.2.cmml">⁡</mo><mrow id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.2.cmml">(</mo><mrow id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.cmml"><msup id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2.2.cmml">e</mi><mrow id="S3.SS2.p1.1.m1.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.cmml"><mrow id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml"><mrow id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.SS2.p1.1.m1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.2.cmml">⋅</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.3.cmml">g</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.2.2.2.3" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.2.2.2.2.1" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.2.2.2.2.1.2" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml">(</mo><msub id="S3.SS2.p1.1.m1.2.2.2.2.1.1" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml">𝐘</mi><mi id="S3.SS2.p1.1.m1.2.2.2.2.1.1.3" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.2.2.2.2.1.3" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup><mo rspace="0.055em" id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.1" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.1.cmml">/</mo><mrow id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.cmml"><msub id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.cmml"><mo id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.cmml"><msub id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.cmml"><mi id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.2.cmml">𝐘</mi><mi id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.3" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.3.cmml">j</mi></msub><mo id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.1" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.1.cmml">∈</mo><mi id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.3" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.3.cmml">V</mi></mrow></msub><msup id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2.cmml"><mi id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2.2" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2.2.cmml">e</mi><mrow id="S3.SS2.p1.1.m1.4.4.2" xref="S3.SS2.p1.1.m1.4.4.2.cmml"><mrow id="S3.SS2.p1.1.m1.3.3.1.1" xref="S3.SS2.p1.1.m1.3.3.1.1.cmml"><mrow id="S3.SS2.p1.1.m1.3.3.1.1.1" xref="S3.SS2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.3.3.1.1.1.3" xref="S3.SS2.p1.1.m1.3.3.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.3.3.1.1.1.2" xref="S3.SS2.p1.1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.SS2.p1.1.m1.3.3.1.1.2" xref="S3.SS2.p1.1.m1.3.3.1.1.2.cmml">⋅</mo><mi id="S3.SS2.p1.1.m1.3.3.1.1.3" xref="S3.SS2.p1.1.m1.3.3.1.1.3.cmml">g</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.4.4.2.3" xref="S3.SS2.p1.1.m1.4.4.2.3.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.4.4.2.2.1" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.4.4.2.2.1.2" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.cmml">(</mo><msub id="S3.SS2.p1.1.m1.4.4.2.2.1.1" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.cmml"><mi id="S3.SS2.p1.1.m1.4.4.2.2.1.1.2" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.2.cmml">𝐘</mi><mi id="S3.SS2.p1.1.m1.4.4.2.2.1.1.3" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.4.4.2.2.1.3" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.3" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.SS2.p1.1.m1.6.6.1.2" xref="S3.SS2.p1.1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.6b"><apply id="S3.SS2.p1.1.m1.6.6.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1"><eq id="S3.SS2.p1.1.m1.6.6.1.1.4.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.4"></eq><apply id="S3.SS2.p1.1.m1.6.6.1.1.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2"><times id="S3.SS2.p1.1.m1.6.6.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2.3"></times><ci id="S3.SS2.p1.1.m1.6.6.1.1.2.4.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2.4">ℓ</ci><interval closure="open" id="S3.SS2.p1.1.m1.6.6.1.1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2"><apply id="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.2">𝐗</ci><ci id="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.2">𝐘</ci><ci id="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3"><minus id="S3.SS2.p1.1.m1.6.6.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3"></minus><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1"><log id="S3.SS2.p1.1.m1.5.5.cmml" xref="S3.SS2.p1.1.m1.5.5"></log><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1"><divide id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.1"></divide><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.2.2">𝑒</ci><apply id="S3.SS2.p1.1.m1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2"><times id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.3"></times><apply id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1"><ci id="S3.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.2">⋅</ci><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1"><times id="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2"></times><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3">𝑓</ci><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S3.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2">𝐘</ci><ci id="S3.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3"><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1">subscript</csymbol><sum id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.2"></sum><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3"><in id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.1"></in><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.2">𝐘</ci><ci id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.3.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.1.3.3">𝑉</ci></apply></apply><apply id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2.1.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2.2.cmml" xref="S3.SS2.p1.1.m1.6.6.1.1.3.1.1.1.1.3.2.2">𝑒</ci><apply id="S3.SS2.p1.1.m1.4.4.2.cmml" xref="S3.SS2.p1.1.m1.4.4.2"><times id="S3.SS2.p1.1.m1.4.4.2.3.cmml" xref="S3.SS2.p1.1.m1.4.4.2.3"></times><apply id="S3.SS2.p1.1.m1.3.3.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1"><ci id="S3.SS2.p1.1.m1.3.3.1.1.2.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.2">⋅</ci><apply id="S3.SS2.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1"><times id="S3.SS2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.2"></times><ci id="S3.SS2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.3">𝑓</ci><apply id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.2">𝐗</ci><ci id="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S3.SS2.p1.1.m1.3.3.1.1.3.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.3">𝑔</ci></apply><apply id="S3.SS2.p1.1.m1.4.4.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.2.2.1.1.2.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.2">𝐘</ci><ci id="S3.SS2.p1.1.m1.4.4.2.2.1.1.3.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.6c">\ell(\mathbf{X}_{i},\mathbf{Y}_{i})=-\log(e^{f(\mathbf{X}_{i})\cdot g(\mathbf{Y}_{i})}/\sum_{\mathbf{Y}_{j}\in V}e^{f(\mathbf{X}_{i})\cdot g(\mathbf{Y}_{j})}),</annotation></semantics></math>
where <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">V</annotation></semantics></math> is the vocabulary of possible items to predict. Global softmax is an extreme case of negative sampling. For any (<math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{X}_{i}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">𝐗</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝐗</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{X}_{i}</annotation></semantics></math>, <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{Y}_{i}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝐘</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝐘</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathbf{Y}_{i}</annotation></semantics></math>) pair, all the items <math id="S3.SS2.p1.5.m5.2" class="ltx_Math" alttext="\mathbf{Y}_{j,j\neq i}\in V" display="inline"><semantics id="S3.SS2.p1.5.m5.2a"><mrow id="S3.SS2.p1.5.m5.2.3" xref="S3.SS2.p1.5.m5.2.3.cmml"><msub id="S3.SS2.p1.5.m5.2.3.2" xref="S3.SS2.p1.5.m5.2.3.2.cmml"><mi id="S3.SS2.p1.5.m5.2.3.2.2" xref="S3.SS2.p1.5.m5.2.3.2.2.cmml">𝐘</mi><mrow id="S3.SS2.p1.5.m5.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.cmml"><mrow id="S3.SS2.p1.5.m5.2.2.2.4.2" xref="S3.SS2.p1.5.m5.2.2.2.4.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml">j</mi><mo id="S3.SS2.p1.5.m5.2.2.2.4.2.1" xref="S3.SS2.p1.5.m5.2.2.2.4.1.cmml">,</mo><mi id="S3.SS2.p1.5.m5.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.cmml">j</mi></mrow><mo id="S3.SS2.p1.5.m5.2.2.2.3" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml">≠</mo><mi id="S3.SS2.p1.5.m5.2.2.2.5" xref="S3.SS2.p1.5.m5.2.2.2.5.cmml">i</mi></mrow></msub><mo id="S3.SS2.p1.5.m5.2.3.1" xref="S3.SS2.p1.5.m5.2.3.1.cmml">∈</mo><mi id="S3.SS2.p1.5.m5.2.3.3" xref="S3.SS2.p1.5.m5.2.3.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.2b"><apply id="S3.SS2.p1.5.m5.2.3.cmml" xref="S3.SS2.p1.5.m5.2.3"><in id="S3.SS2.p1.5.m5.2.3.1.cmml" xref="S3.SS2.p1.5.m5.2.3.1"></in><apply id="S3.SS2.p1.5.m5.2.3.2.cmml" xref="S3.SS2.p1.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.3.2.1.cmml" xref="S3.SS2.p1.5.m5.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.2.3.2.2.cmml" xref="S3.SS2.p1.5.m5.2.3.2.2">𝐘</ci><apply id="S3.SS2.p1.5.m5.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2"><neq id="S3.SS2.p1.5.m5.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.3"></neq><list id="S3.SS2.p1.5.m5.2.2.2.4.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.4.2"><ci id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">𝑗</ci><ci id="S3.SS2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2">𝑗</ci></list><ci id="S3.SS2.p1.5.m5.2.2.2.5.cmml" xref="S3.SS2.p1.5.m5.2.2.2.5">𝑖</ci></apply></apply><ci id="S3.SS2.p1.5.m5.2.3.3.cmml" xref="S3.SS2.p1.5.m5.2.3.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.2c">\mathbf{Y}_{j,j\neq i}\in V</annotation></semantics></math> are treated as negatives for <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{X}_{i}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">𝐗</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝐗</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathbf{X}_{i}</annotation></semantics></math>, and are used to calculate the softmax loss. For a larger scale model, only a subset of items can be sampled randomly instead. In either case, the loss is batch-insensitive on expectation according to <a href="#Thmdefinition1" title="Definition 1 (Batch-Insensitive Loss). ‣ 3 Batch-Insensitive Losses ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Definition</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">We evaluate the efficacy of batch-insensitive losses on the non-IID negatives issue with a movie recommendation task. We train and evaluate a deep retrieval model on the MovieLens 1M dataset <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://grouplens.org/datasets/movielens/1m/" title="" class="ltx_ref ltx_href">https://grouplens.org/datasets/movielens/1m/</a></span></span></span>. The model takes in a user’s movie-watching history and predicts a relevant next movie for this user.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Setting</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">Below we describe details on the dataset, model, and tasks. Additional details can be found in our open-source code framework for federated deep retrieval (see <a href="#S5" title="5 Open-Source Framework ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Dataset: </span> As shown in Table 1, the MovieLens 1M dataset contains approximately 1 million ratings from 6040 users on 3952 movies. Examples are created by taking moving "windows" of the movie sequence (sorted by timestamps) for each user, resulting in context inputs containing ten movie IDs and item inputs representing one next movie ID. For centralized training, examples are randomly shuffled across all users and split to train and test datasets. The train dataset has 894,752 examples, and the test dataset has 99,417 examples. We refer to these as <span id="S4.SS1.p2.1.2" class="ltx_text ltx_font_italic">centralized datasets</span> later in this section. For federated training, all examples are grouped by user, forming a natural data partitioning across clients. The train and test examples are split by user ids, resulting in 4832 train, 603 validation, and 605 test users. We refer to these as <span id="S4.SS1.p2.1.3" class="ltx_text ltx_font_italic">federated datasets</span>. We sample 100 clients for each training round.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2108.07931/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="194" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>ID-based deep retrieval model for movie recommendation.</figcaption>
</figure>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Model Architecture: </span>
<a href="#S4.F2" title="In 4.1 Experiment Setting ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> illustrates the architecture of the ID-based deep retrieval model used for experiments. It takes a sequence of movie IDs (the movie watching history) as the context and the next movie ID as the item to form the <span id="S4.SS1.p3.1.2" class="ltx_text ltx_font_italic">(context, item)</span> pair. The context encoder is a bag-of-word encoder, and the item tower is a simple embedding lookup tower. The two towers share the same bottom embedding layer, which maps from movie ID to dense embedding. The two towers generate context and item embeddings respectively, and similarity is enforced between the positive (context, label) pairs. To make the comparison consistent and fair, we set the batch size to 16 for all experiments. The output dimension of the shared embedding layer is 16. The encoded context embedding and item embedding are also 16-dimensional and L2-normalized.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">Federated and Centralized Experiments: </span> One of our goals in this work is to reduce the gap between federated and centralized deep retrieval model performance. We run experiments for both centralized and federated training and compare performance. Interestingly, we observe that batch-insensitive losses can also improve centralized performance, so we also compare against this. We refer to these models as <em id="S4.SS1.p4.1.2" class="ltx_emph ltx_font_italic">Improved Centralized</em> later in this section. In both settings, we measure test recall@k for <math id="S4.SS1.p4.1.m1.3" class="ltx_Math" alttext="k\in[1,5,10]" display="inline"><semantics id="S4.SS1.p4.1.m1.3a"><mrow id="S4.SS1.p4.1.m1.3.4" xref="S4.SS1.p4.1.m1.3.4.cmml"><mi id="S4.SS1.p4.1.m1.3.4.2" xref="S4.SS1.p4.1.m1.3.4.2.cmml">k</mi><mo id="S4.SS1.p4.1.m1.3.4.1" xref="S4.SS1.p4.1.m1.3.4.1.cmml">∈</mo><mrow id="S4.SS1.p4.1.m1.3.4.3.2" xref="S4.SS1.p4.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS1.p4.1.m1.3.4.3.2.1" xref="S4.SS1.p4.1.m1.3.4.3.1.cmml">[</mo><mn id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">1</mn><mo id="S4.SS1.p4.1.m1.3.4.3.2.2" xref="S4.SS1.p4.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p4.1.m1.2.2" xref="S4.SS1.p4.1.m1.2.2.cmml">5</mn><mo id="S4.SS1.p4.1.m1.3.4.3.2.3" xref="S4.SS1.p4.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p4.1.m1.3.3" xref="S4.SS1.p4.1.m1.3.3.cmml">10</mn><mo stretchy="false" id="S4.SS1.p4.1.m1.3.4.3.2.4" xref="S4.SS1.p4.1.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.3b"><apply id="S4.SS1.p4.1.m1.3.4.cmml" xref="S4.SS1.p4.1.m1.3.4"><in id="S4.SS1.p4.1.m1.3.4.1.cmml" xref="S4.SS1.p4.1.m1.3.4.1"></in><ci id="S4.SS1.p4.1.m1.3.4.2.cmml" xref="S4.SS1.p4.1.m1.3.4.2">𝑘</ci><list id="S4.SS1.p4.1.m1.3.4.3.1.cmml" xref="S4.SS1.p4.1.m1.3.4.3.2"><cn type="integer" id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">1</cn><cn type="integer" id="S4.SS1.p4.1.m1.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2">5</cn><cn type="integer" id="S4.SS1.p4.1.m1.3.3.cmml" xref="S4.SS1.p4.1.m1.3.3">10</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.3c">k\in[1,5,10]</annotation></semantics></math>, the fraction of examples for which the correct next movie is within the top k nearest item embeddings for an unseen context.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Effect of Non-IID Data</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">To study the effect of non-IID data on federated learning in this setting, we train the ID-based deep retrieval model on federated datasets using <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. The model is trained with the standard batch softmax cross-entropy loss. We compare recall across items within a batch (batch recall) with centralized training. As shown in <a href="#S4.F4" title="In 4.2 Effect of Non-IID Data ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>, the federated model experiences significant performance degradation, especially for recall@1. It is worth noting that performance degradation occurs even when training with <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedSGD</span>, as illustrated in <a href="#S4.F3" title="In 4.2 Effect of Non-IID Data ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>. It indicates that client drift, which occurs when clients take multiple local steps with non-IID data, is not the only cause.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p">To test whether non-IID data causes this performance degradation, we train a <em id="S4.SS2.p2.1.1" class="ltx_emph ltx_font_italic">Federated Shuffled</em> model where data is IID across clients. In this experiment, all examples are shuffled across users while the number of examples per user remains the same. This ensures the same number of local steps taken on each client as before and isolates the effect of non-IID data on federated learning. As shown in <a href="#S4.F4" title="In 4.2 Effect of Non-IID Data ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>, the Federated Shuffled result roughly matches the centralized result. We then conclude that non-IIDness causes the performance degradation, not federated training in itself.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p">However, although shuffling examples across users could resolve the non-IID data issue, we cannot do it in practice due to privacy and communication limitations.</p>
</div>
<figure id="S4.T1" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>MovieLens 1M Dataset Statistics. ‘E’ is short for ‘Examples’ and ‘U’ is short for ‘Users’.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Num</th>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<th id="S4.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Ratings</th>
<th id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1,000,209</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.3.1" class="ltx_tr">
<th id="S4.T1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Users</th>
<td id="S4.T1.1.3.1.2" class="ltx_td ltx_align_center">6040</td>
</tr>
<tr id="S4.T1.1.4.2" class="ltx_tr">
<th id="S4.T1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Movies</th>
<td id="S4.T1.1.4.2.2" class="ltx_td ltx_align_center ltx_border_bb">3952</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<table id="S4.T1.2" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.2.1.1" class="ltx_tr">
<th id="S4.T1.2.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T1.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Centralized</th>
<th id="S4.T1.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Federated</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.2.2.1" class="ltx_tr">
<th id="S4.T1.2.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Split Strategy</th>
<td id="S4.T1.2.2.1.2" class="ltx_td ltx_align_center ltx_border_t">By Example</td>
<td id="S4.T1.2.2.1.3" class="ltx_td ltx_align_center ltx_border_t">By User</td>
</tr>
<tr id="S4.T1.2.3.2" class="ltx_tr">
<th id="S4.T1.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Train Data</th>
<td id="S4.T1.2.3.2.2" class="ltx_td ltx_align_center">894,753 E</td>
<td id="S4.T1.2.3.2.3" class="ltx_td ltx_align_center">4832 U</td>
</tr>
<tr id="S4.T1.2.4.3" class="ltx_tr">
<th id="S4.T1.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Test Data</th>
<td id="S4.T1.2.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">99,417 E</td>
<td id="S4.T1.2.4.3.3" class="ltx_td ltx_align_center ltx_border_bb">605 U</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
<figure id="S4.SS2.2" class="ltx_figure">
<div id="S4.SS2.2.3" class="ltx_block">
<figure id="S4.F3" class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" style="width:195.1pt;"><img src="/html/2108.07931/assets/x3.png" id="S4.SS2.1.1.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Model performance with batch softmax loss. Federated training uses <span id="S4.F3.2.1" class="ltx_text ltx_font_smallcaps">FedSGD</span>.</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" style="width:195.1pt;"><img src="/html/2108.07931/assets/x4.png" id="S4.SS2.2.2.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Model performance with batch softmax loss. Federated training uses <span id="S4.F4.2.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>.</figcaption>
</figure>
</div>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Federated and Centralized Results</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">This section studies the model performance with four different loss functions: batch softmax (BS), batch softmax with spreadout regularizer (BS+S), and two batch-insensitive losses (see <a href="#S3" title="3 Batch-Insensitive Losses ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a>): hinge loss with spreadout (H+S) and global softmax (GS). All the federated models are trained with <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We compare recall calculated globally across all items, which has no dependence on examples in a batch, enabling fair comparison.</p>
</div>
<figure id="S4.F5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2108.07931/assets/x5.png" id="S4.SS3.1.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="461" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Comparison of centralized and federated models when training with different loss functions: batch softmax, batch softmax with spreadout regularizer, hinge loss with spreadout regularizer, and global softmax. The last two are batch-insensitive losses.</figcaption>
</figure>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Batch Softmax (BS): </span>
Batch softmax is the standard loss function for training a deep retrieval model. It is calculated with in-batch negatives as described in <a href="#S2" title="2 Federated Deep Retrieval Model ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">2</span></a>. <a href="#S4.F5" title="In 4.3 Federated and Centralized Results ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>(a) shows a large gap between centralized and federated global recalls, similar to the batch recall results in <a href="#S4.SS2" title="4.2 Effect of Non-IID Data ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Batch Softmax + Spreadout (BS+S): </span>
<a href="#S4.F5" title="In 4.3 Federated and Centralized Results ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>(b) presents results of training with batch softmax combined with spreadout regularization. With spreadout regularizer, the recall values of the federated model almost match those of the batch softmax centralized model, which is trained without spreadout regularizer. However, spreadout regularizer also improves centralized training. The federated model still performs significantly worse compared to the improved centralized model.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p">The results indicate that spreadout regularization itself is not enough to solve the issue with the non-IID negatives. Although spreadout regularizer pushes embeddings of unrelated pairs farther apart, batch softmax loss still depends on in-batch negatives and can still lead to worse model quality. Therefore, we need a loss function less affected by the training data distribution, motivating batch-insensitive losses.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.1" class="ltx_p"><span id="S4.SS3.p5.1.1" class="ltx_text ltx_font_bold">Batch-Insensitive Losses (H+S and GS): </span>
<a href="#S4.F5" title="In 4.3 Federated and Centralized Results ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>(c) and <a href="#S4.F5" title="In 4.3 Federated and Centralized Results ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>(d) show the training results with the two types of batch-insensitive losses. With the combination of hinge loss and spreadout regularizer, both the improved centralized model and the federated model perform much better than the baseline model (<a href="#S4.F5" title="In 4.3 Federated and Centralized Results ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>(d)). Also, the gap between improved centralized and federated models is much smaller than with batch softmax. With global softmax (<a href="#S4.F5" title="In 4.3 Federated and Centralized Results ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>(c)), the federated model performs almost the same as the improved centralized model, and both perform significantly better than the batch softmax centralized model. Both of the results indicate that batch-insensitive loss alleviates the performance degradation caused by non-IID negatives effectively.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para ltx_noindent">
<p id="S4.SS3.p6.1" class="ltx_p">We caution that applying global softmax may not be appropriate in all settings. In these experiments, we use all the items in the movie vocabulary as the negatives. In practice, when dealing with items with large or unbounded vocabulary size, we may need other strategies as global softmax is computationally expensive.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>An overall recall comparison between centralized, improved centralized, and federated models. The performance drop is calculated as <math id="S4.T2.4.m1.1" class="ltx_Math" alttext="(R_{c}-R_{f})/R_{c}" display="inline"><semantics id="S4.T2.4.m1.1b"><mrow id="S4.T2.4.m1.1.1" xref="S4.T2.4.m1.1.1.cmml"><mrow id="S4.T2.4.m1.1.1.1.1" xref="S4.T2.4.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.T2.4.m1.1.1.1.1.2" xref="S4.T2.4.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T2.4.m1.1.1.1.1.1" xref="S4.T2.4.m1.1.1.1.1.1.cmml"><msub id="S4.T2.4.m1.1.1.1.1.1.2" xref="S4.T2.4.m1.1.1.1.1.1.2.cmml"><mi id="S4.T2.4.m1.1.1.1.1.1.2.2" xref="S4.T2.4.m1.1.1.1.1.1.2.2.cmml">R</mi><mi id="S4.T2.4.m1.1.1.1.1.1.2.3" xref="S4.T2.4.m1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S4.T2.4.m1.1.1.1.1.1.1" xref="S4.T2.4.m1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.T2.4.m1.1.1.1.1.1.3" xref="S4.T2.4.m1.1.1.1.1.1.3.cmml"><mi id="S4.T2.4.m1.1.1.1.1.1.3.2" xref="S4.T2.4.m1.1.1.1.1.1.3.2.cmml">R</mi><mi id="S4.T2.4.m1.1.1.1.1.1.3.3" xref="S4.T2.4.m1.1.1.1.1.1.3.3.cmml">f</mi></msub></mrow><mo stretchy="false" id="S4.T2.4.m1.1.1.1.1.3" xref="S4.T2.4.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.T2.4.m1.1.1.2" xref="S4.T2.4.m1.1.1.2.cmml">/</mo><msub id="S4.T2.4.m1.1.1.3" xref="S4.T2.4.m1.1.1.3.cmml"><mi id="S4.T2.4.m1.1.1.3.2" xref="S4.T2.4.m1.1.1.3.2.cmml">R</mi><mi id="S4.T2.4.m1.1.1.3.3" xref="S4.T2.4.m1.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.m1.1c"><apply id="S4.T2.4.m1.1.1.cmml" xref="S4.T2.4.m1.1.1"><divide id="S4.T2.4.m1.1.1.2.cmml" xref="S4.T2.4.m1.1.1.2"></divide><apply id="S4.T2.4.m1.1.1.1.1.1.cmml" xref="S4.T2.4.m1.1.1.1.1"><minus id="S4.T2.4.m1.1.1.1.1.1.1.cmml" xref="S4.T2.4.m1.1.1.1.1.1.1"></minus><apply id="S4.T2.4.m1.1.1.1.1.1.2.cmml" xref="S4.T2.4.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.4.m1.1.1.1.1.1.2.1.cmml" xref="S4.T2.4.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.T2.4.m1.1.1.1.1.1.2.2.cmml" xref="S4.T2.4.m1.1.1.1.1.1.2.2">𝑅</ci><ci id="S4.T2.4.m1.1.1.1.1.1.2.3.cmml" xref="S4.T2.4.m1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S4.T2.4.m1.1.1.1.1.1.3.cmml" xref="S4.T2.4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.T2.4.m1.1.1.1.1.1.3.1.cmml" xref="S4.T2.4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.T2.4.m1.1.1.1.1.1.3.2.cmml" xref="S4.T2.4.m1.1.1.1.1.1.3.2">𝑅</ci><ci id="S4.T2.4.m1.1.1.1.1.1.3.3.cmml" xref="S4.T2.4.m1.1.1.1.1.1.3.3">𝑓</ci></apply></apply><apply id="S4.T2.4.m1.1.1.3.cmml" xref="S4.T2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T2.4.m1.1.1.3.1.cmml" xref="S4.T2.4.m1.1.1.3">subscript</csymbol><ci id="S4.T2.4.m1.1.1.3.2.cmml" xref="S4.T2.4.m1.1.1.3.2">𝑅</ci><ci id="S4.T2.4.m1.1.1.3.3.cmml" xref="S4.T2.4.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m1.1d">(R_{c}-R_{f})/R_{c}</annotation></semantics></math>, where <math id="S4.T2.5.m2.1" class="ltx_Math" alttext="R_{c}" display="inline"><semantics id="S4.T2.5.m2.1b"><msub id="S4.T2.5.m2.1.1" xref="S4.T2.5.m2.1.1.cmml"><mi id="S4.T2.5.m2.1.1.2" xref="S4.T2.5.m2.1.1.2.cmml">R</mi><mi id="S4.T2.5.m2.1.1.3" xref="S4.T2.5.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.5.m2.1c"><apply id="S4.T2.5.m2.1.1.cmml" xref="S4.T2.5.m2.1.1"><csymbol cd="ambiguous" id="S4.T2.5.m2.1.1.1.cmml" xref="S4.T2.5.m2.1.1">subscript</csymbol><ci id="S4.T2.5.m2.1.1.2.cmml" xref="S4.T2.5.m2.1.1.2">𝑅</ci><ci id="S4.T2.5.m2.1.1.3.cmml" xref="S4.T2.5.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m2.1d">R_{c}</annotation></semantics></math> is the centralized global recall, and <math id="S4.T2.6.m3.1" class="ltx_Math" alttext="R_{f}" display="inline"><semantics id="S4.T2.6.m3.1b"><msub id="S4.T2.6.m3.1.1" xref="S4.T2.6.m3.1.1.cmml"><mi id="S4.T2.6.m3.1.1.2" xref="S4.T2.6.m3.1.1.2.cmml">R</mi><mi id="S4.T2.6.m3.1.1.3" xref="S4.T2.6.m3.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.6.m3.1c"><apply id="S4.T2.6.m3.1.1.cmml" xref="S4.T2.6.m3.1.1"><csymbol cd="ambiguous" id="S4.T2.6.m3.1.1.1.cmml" xref="S4.T2.6.m3.1.1">subscript</csymbol><ci id="S4.T2.6.m3.1.1.2.cmml" xref="S4.T2.6.m3.1.1.2">𝑅</ci><ci id="S4.T2.6.m3.1.1.3.cmml" xref="S4.T2.6.m3.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.m3.1d">R_{f}</annotation></semantics></math> is the federated global recall.</figcaption>
<table id="S4.T2.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.7.1.1" class="ltx_tr">
<th id="S4.T2.7.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S4.T2.7.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.1.1.1.1.1" class="ltx_p" style="width:13.0pt;"></span>
</span>
</th>
<th id="S4.T2.7.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S4.T2.7.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.1.1.2.1.1" class="ltx_p" style="width:30.4pt;">Centralized</span>
</span>
</th>
<th id="S4.T2.7.1.1.3" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="3">Improved Centralized</th>
<th id="S4.T2.7.1.1.4" class="ltx_td ltx_align_top ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S4.T2.7.1.1.5" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="4">Federated</th>
<th id="S4.T2.7.1.1.6" class="ltx_td ltx_align_top ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S4.T2.7.1.1.7" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="4">Performance Drop</th>
</tr>
<tr id="S4.T2.7.2.2" class="ltx_tr">
<th id="S4.T2.7.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="S4.T2.7.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.1.1.1" class="ltx_p" style="width:13.0pt;"></span>
</span>
</th>
<th id="S4.T2.7.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="S4.T2.7.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.2.1.1" class="ltx_p" style="width:30.4pt;">BS</span>
</span>
</th>
<th id="S4.T2.7.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.3.1.1" class="ltx_p" style="width:13.0pt;">BS+S</span>
</span>
</th>
<th id="S4.T2.7.2.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.4.1.1" class="ltx_p" style="width:13.0pt;">H+S</span>
</span>
</th>
<th id="S4.T2.7.2.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.5.1.1" class="ltx_p" style="width:13.0pt;">GS</span>
</span>
</th>
<th id="S4.T2.7.2.2.6" class="ltx_td ltx_align_top ltx_th ltx_th_column"></th>
<th id="S4.T2.7.2.2.7" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.7.1.1" class="ltx_p" style="width:13.0pt;">BS</span>
</span>
</th>
<th id="S4.T2.7.2.2.8" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.8.1.1" class="ltx_p" style="width:13.0pt;">BS+S</span>
</span>
</th>
<th id="S4.T2.7.2.2.9" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.9.1.1" class="ltx_p" style="width:13.0pt;">H+S</span>
</span>
</th>
<th id="S4.T2.7.2.2.10" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.10.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.10.1.1" class="ltx_p" style="width:20.2pt;">GS</span>
</span>
</th>
<th id="S4.T2.7.2.2.11" class="ltx_td ltx_align_top ltx_th ltx_th_column"></th>
<th id="S4.T2.7.2.2.12" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.12.1.1" class="ltx_p" style="width:16.6pt;">BS</span>
</span>
</th>
<th id="S4.T2.7.2.2.13" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.13.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.13.1.1" class="ltx_p" style="width:16.6pt;">BS+S</span>
</span>
</th>
<th id="S4.T2.7.2.2.14" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.14.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.14.1.1" class="ltx_p" style="width:16.6pt;">H+S</span>
</span>
</th>
<th id="S4.T2.7.2.2.15" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S4.T2.7.2.2.15.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.2.2.15.1.1" class="ltx_p" style="width:16.6pt;">GS</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.7.3.1" class="ltx_tr">
<td id="S4.T2.7.3.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.1.1.1" class="ltx_p" style="width:13.0pt;">R@1</span>
</span>
</td>
<td id="S4.T2.7.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.2.1.1" class="ltx_p" style="width:30.4pt;">1.02</span>
</span>
</td>
<td id="S4.T2.7.3.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.3.1.1" class="ltx_p" style="width:13.0pt;">1.21</span>
</span>
</td>
<td id="S4.T2.7.3.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.4.1.1" class="ltx_p" style="width:13.0pt;"><span id="S4.T2.7.3.1.4.1.1.1" class="ltx_text ltx_font_bold">1.27</span></span>
</span>
</td>
<td id="S4.T2.7.3.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.5.1.1" class="ltx_p" style="width:13.0pt;">1.24</span>
</span>
</td>
<td id="S4.T2.7.3.1.6" class="ltx_td ltx_align_top ltx_border_t"></td>
<td id="S4.T2.7.3.1.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.7.1.1" class="ltx_p" style="width:13.0pt;">0.58</span>
</span>
</td>
<td id="S4.T2.7.3.1.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.8.1.1" class="ltx_p" style="width:13.0pt;">0.88</span>
</span>
</td>
<td id="S4.T2.7.3.1.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.9.1.1" class="ltx_p" style="width:13.0pt;">1.17</span>
</span>
</td>
<td id="S4.T2.7.3.1.10" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.10.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.10.1.1" class="ltx_p" style="width:20.2pt;"><span id="S4.T2.7.3.1.10.1.1.1" class="ltx_text ltx_font_bold">1.21</span></span>
</span>
</td>
<td id="S4.T2.7.3.1.11" class="ltx_td ltx_align_top ltx_border_t"></td>
<td id="S4.T2.7.3.1.12" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.12.1.1" class="ltx_p" style="width:16.6pt;">43.14%</span>
</span>
</td>
<td id="S4.T2.7.3.1.13" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.13.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.13.1.1" class="ltx_p" style="width:16.6pt;">27.27%</span>
</span>
</td>
<td id="S4.T2.7.3.1.14" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.14.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.14.1.1" class="ltx_p" style="width:16.6pt;">7.87%</span>
</span>
</td>
<td id="S4.T2.7.3.1.15" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S4.T2.7.3.1.15.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.3.1.15.1.1" class="ltx_p" style="width:16.6pt;"><span id="S4.T2.7.3.1.15.1.1.1" class="ltx_text ltx_font_bold">2.42</span>%</span>
</span>
</td>
</tr>
<tr id="S4.T2.7.4.2" class="ltx_tr">
<td id="S4.T2.7.4.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.1.1.1" class="ltx_p" style="width:13.0pt;">R@5</span>
</span>
</td>
<td id="S4.T2.7.4.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.2.1.1" class="ltx_p" style="width:30.4pt;">4.2</span>
</span>
</td>
<td id="S4.T2.7.4.2.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.3.1.1" class="ltx_p" style="width:13.0pt;">5.15</span>
</span>
</td>
<td id="S4.T2.7.4.2.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.4.1.1" class="ltx_p" style="width:13.0pt;"><span id="S4.T2.7.4.2.4.1.1.1" class="ltx_text ltx_font_bold">6.08</span></span>
</span>
</td>
<td id="S4.T2.7.4.2.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.5.1.1" class="ltx_p" style="width:13.0pt;">5.34</span>
</span>
</td>
<td id="S4.T2.7.4.2.6" class="ltx_td ltx_align_top"></td>
<td id="S4.T2.7.4.2.7" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.7.1.1" class="ltx_p" style="width:13.0pt;">2.88</span>
</span>
</td>
<td id="S4.T2.7.4.2.8" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.8.1.1" class="ltx_p" style="width:13.0pt;">4.01</span>
</span>
</td>
<td id="S4.T2.7.4.2.9" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.9.1.1" class="ltx_p" style="width:13.0pt;"><span id="S4.T2.7.4.2.9.1.1.1" class="ltx_text ltx_font_bold">5.56</span></span>
</span>
</td>
<td id="S4.T2.7.4.2.10" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.10.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.10.1.1" class="ltx_p" style="width:20.2pt;">5.25</span>
</span>
</td>
<td id="S4.T2.7.4.2.11" class="ltx_td ltx_align_top"></td>
<td id="S4.T2.7.4.2.12" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.12.1.1" class="ltx_p" style="width:16.6pt;">31.43%</span>
</span>
</td>
<td id="S4.T2.7.4.2.13" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.13.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.13.1.1" class="ltx_p" style="width:16.6pt;">22.14%</span>
</span>
</td>
<td id="S4.T2.7.4.2.14" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.14.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.14.1.1" class="ltx_p" style="width:16.6pt;">8.55%</span>
</span>
</td>
<td id="S4.T2.7.4.2.15" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.T2.7.4.2.15.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.4.2.15.1.1" class="ltx_p" style="width:16.6pt;"><span id="S4.T2.7.4.2.15.1.1.1" class="ltx_text ltx_font_bold">1.69</span>%</span>
</span>
</td>
</tr>
<tr id="S4.T2.7.5.3" class="ltx_tr">
<td id="S4.T2.7.5.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.1.1.1" class="ltx_p" style="width:13.0pt;">R@10</span>
</span>
</td>
<td id="S4.T2.7.5.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.2.1.1" class="ltx_p" style="width:30.4pt;">7.42</span>
</span>
</td>
<td id="S4.T2.7.5.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.3.1.1" class="ltx_p" style="width:13.0pt;">8.93</span>
</span>
</td>
<td id="S4.T2.7.5.3.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.4.1.1" class="ltx_p" style="width:13.0pt;"><span id="S4.T2.7.5.3.4.1.1.1" class="ltx_text ltx_font_bold">11.15</span></span>
</span>
</td>
<td id="S4.T2.7.5.3.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.5.1.1" class="ltx_p" style="width:13.0pt;">9.46</span>
</span>
</td>
<td id="S4.T2.7.5.3.6" class="ltx_td ltx_align_top ltx_border_bb"></td>
<td id="S4.T2.7.5.3.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.7.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.7.1.1" class="ltx_p" style="width:13.0pt;">5.4</span>
</span>
</td>
<td id="S4.T2.7.5.3.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.8.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.8.1.1" class="ltx_p" style="width:13.0pt;">7.29</span>
</span>
</td>
<td id="S4.T2.7.5.3.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.9.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.9.1.1" class="ltx_p" style="width:13.0pt;"><span id="S4.T2.7.5.3.9.1.1.1" class="ltx_text ltx_font_bold">10.43</span></span>
</span>
</td>
<td id="S4.T2.7.5.3.10" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.10.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.10.1.1" class="ltx_p" style="width:20.2pt;">9.41</span>
</span>
</td>
<td id="S4.T2.7.5.3.11" class="ltx_td ltx_align_top ltx_border_bb"></td>
<td id="S4.T2.7.5.3.12" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.12.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.12.1.1" class="ltx_p" style="width:16.6pt;">27.22%</span>
</span>
</td>
<td id="S4.T2.7.5.3.13" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.13.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.13.1.1" class="ltx_p" style="width:16.6pt;">18.37%</span>
</span>
</td>
<td id="S4.T2.7.5.3.14" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.14.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.14.1.1" class="ltx_p" style="width:16.6pt;">6.46%</span>
</span>
</td>
<td id="S4.T2.7.5.3.15" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S4.T2.7.5.3.15.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.7.5.3.15.1.1" class="ltx_p" style="width:16.6pt;"><span id="S4.T2.7.5.3.15.1.1.1" class="ltx_text ltx_font_bold">0.53</span>%</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p7" class="ltx_para ltx_noindent">
<p id="S4.SS3.p7.1" class="ltx_p"><span id="S4.SS3.p7.1.1" class="ltx_text ltx_font_bold">Overall Comparison: </span>
<a href="#S4.T2" title="In 4.3 Federated and Centralized Results ‣ 4 Evaluation ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a> gives an overall performance comparison between centralized, improved centralized, and federated models under different losses.</p>
</div>
<div id="S4.SS3.p8" class="ltx_para ltx_noindent">
<p id="S4.SS3.p8.1" class="ltx_p">Training with batch-insensitive losses (H+S, GS) achieves the highest recall for both centralized and federated models. In particular, hinge loss with spreadout regularizer appears to perform slightly better than global softmax in terms of absolute recall, but both perform significantly better than batch-sensitive losses (BS, BS+S).</p>
</div>
<div id="S4.SS3.p9" class="ltx_para ltx_noindent">
<p id="S4.SS3.p9.1" class="ltx_p">We also observe that global softmax incurs the smallest performance gap between centralized and federated training. Hinge loss with spreadout regularizer has the next smallest performance gap, and batch-sensitive techniques have a more significant performance gap as expected. We expect that the remaining performance drop between centralized and federated models results from client drift (clients are still taking multiple local steps). This suggests that combining batch-insensitive losses with approaches to address client drift may be a promising future direction.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Open-Source Framework</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We are releasing a general code framework for experimenting with federated deep retrieval models built on the TensorFlow Federated library<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://www.tensorflow.org/federated" title="" class="ltx_ref ltx_href">https://www.tensorflow.org/federated</a></span></span></span>. The code is released under Apache License 2.0. The framework enables reproduction of our experiments and provides a flexible, well-documented interface for researchers to train federated and centralized deep retrieval models with different models and losses. We provide libraries for training and evaluation for MovieLens next movie prediction, which can be easily extended for new tasks. We hope that this framework spurs further research and lowers the barrier to more practical applications.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">This work investigates the effect of non-IID negatives on federated training of deep retrieval models and proposes batch-insensitive losses to alleviate the issue. We compare model performance using various loss functions and show that batch-insensitive losses produce better federated deep retrieval models that can approximately match centralized models. We also open-source our code framework to accelerate future research and applications. Note that our proposed techniques do not directly address the separate, well-studied issue of client drift when clients do multiple steps of local training–approaches addressing this issue are complementary and can be combined with our work.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.p1.1" class="ltx_p">We thank Warren Morningstar, Chung-Ching Chang, and Zachary Garrett and for their helpful comments and discussions. We also thank Warren Morningstar for his contribution to the federated training pipeline.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Muthuraman Chidambaram, Yinfei Yang, Daniel Cer, Steve Yuan, Yun-Hsuan Sung,
Brian Strope, and Ray Kurzweil.

</span>
<span class="ltx_bibblock">Learning cross-lingual sentence representations via a multi-task
dual-encoder model.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1810.12836</span>, 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin.

</span>
<span class="ltx_bibblock">Deep neural networks for youtube recommendations.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Proceedings of the 10th ACM Conference on Recommender
Systems</span>, New York, NY, USA, 2016.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Daniel Gillick, Sayali Kulkarni, Larry Lansing, Alessandro Presta, Jason
Baldridge, Eugene Ie, and Diego Garcia-Olano.

</span>
<span class="ltx_bibblock">Learning dense representations for entity retrieval.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.10506</span>, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Daniel Gillick, Alessandro Presta, and Gaurav Singh Tomar.

</span>
<span class="ltx_bibblock">End-to-end retrieval in continuous space.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1811.08008</span>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Matthew Henderson, Rami Al-Rfou, Brian Strope, Yun hsuan Sung, László
Lukács, Ruiqi Guo, Sanjiv Kumar, Balint Miklos, and Ray Kurzweil.

</span>
<span class="ltx_bibblock">Efficient natural language response suggestion for smart reply.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">ArXiv e-prints</span>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Kevin Hsieh, Amar Phanishayee, Onur Mutlu, and Phillip Gibbons.

</span>
<span class="ltx_bibblock">The non-iid data quagmire of decentralized machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
4387–4398. PMLR, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Jyun-Yu Jiang, Tao Wu, Georgios Roumpos, Heng-Tze Cheng, Xinyang Yi, Ed Chi,
Harish Ganapathy, Nitin Jindal, Pei Cao, and Wei Wang.

</span>
<span class="ltx_bibblock">End-to-end deep attentive personalized item retrieval for online
content-sharing platforms.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Proceedings of The Web Conference 2020</span>, pages 2870–2877,
2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Martin Jaggi, Satyen Kale, Mehryar Mohri, Sashank J
Reddi, Sebastian U Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Mime: Mimicking centralized stochastic algorithms in federated
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2008.03606</span>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.06127</span>, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Xiaoxiao Li, Meirui Jiang, Xiaofei Zhang, Michael Kamp, and Qi Dou.

</span>
<span class="ltx_bibblock">Fedbn: Federated learning on non-iid features via local batch
normalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2102.07623</span>, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Jilin Chen, Lichan Hong, and Ed H Chi.

</span>
<span class="ltx_bibblock">Modeling task relationships in multi-task learning with multi-gate
mixture-of-experts.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Proceedings of the 24th ACM SIGKDD International Conference
on Knowledge Discovery &amp; Data Mining</span>, pages 1930–1939, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics (AISTATS)</span>, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Pavel Sountsov and Sunita Sarawagi.

</span>
<span class="ltx_bibblock">Length bias in encoder decoder models and a case for global
conditioning.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.03402</span>, 2016.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Maksims Volkovs, Guang Wei Yu, and Tomi Poutanen.

</span>
<span class="ltx_bibblock">Dropoutnet: Addressing cold start in recommender systems.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">NIPS</span>, pages 4957–4966, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Ji Yang, Xinyang Yi, Derek Zhiyuan Cheng, Lichan Hong, Yang Li, Simon
Xiaoming Wang, Taibai Xu, and Ed H Chi.

</span>
<span class="ltx_bibblock">Mixed negative sampling for learning two-tower neural networks in
recommendations.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Companion Proceedings of the Web Conference 2020</span>, pages
441–447, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Yinfei Yanga, Steve Yuanc, Daniel Cera, Sheng-yi Konga, Noah Constanta, Petr
Pilarc, Heming Gea, Yun-Hsuan Sunga, Brian Stropea, and Ray Kurzweila.

</span>
<span class="ltx_bibblock">Learning semantic textual similarity from conversations.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">ACL 2018</span>, page 164, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Xinyang Yi, Ji Yang, Lichan Hong, Derek Zhiyuan Cheng, Lukasz Heldt,
Aditee Ajit Kumthekar, Zhe Zhao, Li Wei, and Ed Chi, editors.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Sampling-Bias-Corrected Neural Modeling for Large Corpus Item
Recommendations</span>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Tehrim Yoon, Sumin Shin, Sung Ju Hwang, and Eunho Yang.

</span>
<span class="ltx_bibblock">Fedmix: Approximation of mixup under mean augmented federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Felix X. Yu, Ankit Singh Rawat, Aditya Krishna Menon, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Federated learning with only positive labels, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Xu Zhang, Felix X. Yu, Sanjiv Kumar, and Shih-Fu Chang.

</span>
<span class="ltx_bibblock">Learning spread-out local feature descriptors, 2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1806.00582</span>, 2018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Proof of Proposition 1</h2>

<div id="A1.6" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="A1.1.p1" class="ltx_para ltx_noindent">
<p id="A1.1.p1.9" class="ltx_p">Assume <math id="A1.1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="A1.1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.1.m1.1.1" xref="A1.1.p1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.1.m1.1b"><ci id="A1.1.p1.1.m1.1.1.cmml" xref="A1.1.p1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.1.m1.1c">\mathcal{C}</annotation></semantics></math> contains <math id="A1.1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A1.1.p1.2.m2.1a"><mi id="A1.1.p1.2.m2.1.1" xref="A1.1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.2.m2.1b"><ci id="A1.1.p1.2.m2.1.1.cmml" xref="A1.1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.2.m2.1c">M</annotation></semantics></math> clients. A client <math id="A1.1.p1.3.m3.1" class="ltx_Math" alttext="c_{i}\in\mathcal{C}" display="inline"><semantics id="A1.1.p1.3.m3.1a"><mrow id="A1.1.p1.3.m3.1.1" xref="A1.1.p1.3.m3.1.1.cmml"><msub id="A1.1.p1.3.m3.1.1.2" xref="A1.1.p1.3.m3.1.1.2.cmml"><mi id="A1.1.p1.3.m3.1.1.2.2" xref="A1.1.p1.3.m3.1.1.2.2.cmml">c</mi><mi id="A1.1.p1.3.m3.1.1.2.3" xref="A1.1.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="A1.1.p1.3.m3.1.1.1" xref="A1.1.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.3.m3.1.1.3" xref="A1.1.p1.3.m3.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.3.m3.1b"><apply id="A1.1.p1.3.m3.1.1.cmml" xref="A1.1.p1.3.m3.1.1"><in id="A1.1.p1.3.m3.1.1.1.cmml" xref="A1.1.p1.3.m3.1.1.1"></in><apply id="A1.1.p1.3.m3.1.1.2.cmml" xref="A1.1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.1.p1.3.m3.1.1.2.1.cmml" xref="A1.1.p1.3.m3.1.1.2">subscript</csymbol><ci id="A1.1.p1.3.m3.1.1.2.2.cmml" xref="A1.1.p1.3.m3.1.1.2.2">𝑐</ci><ci id="A1.1.p1.3.m3.1.1.2.3.cmml" xref="A1.1.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="A1.1.p1.3.m3.1.1.3.cmml" xref="A1.1.p1.3.m3.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.3.m3.1c">c_{i}\in\mathcal{C}</annotation></semantics></math> has <math id="A1.1.p1.4.m4.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="A1.1.p1.4.m4.1a"><msub id="A1.1.p1.4.m4.1.1" xref="A1.1.p1.4.m4.1.1.cmml"><mi id="A1.1.p1.4.m4.1.1.2" xref="A1.1.p1.4.m4.1.1.2.cmml">N</mi><mi id="A1.1.p1.4.m4.1.1.3" xref="A1.1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.4.m4.1b"><apply id="A1.1.p1.4.m4.1.1.cmml" xref="A1.1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.1.p1.4.m4.1.1.1.cmml" xref="A1.1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.1.p1.4.m4.1.1.2.cmml" xref="A1.1.p1.4.m4.1.1.2">𝑁</ci><ci id="A1.1.p1.4.m4.1.1.3.cmml" xref="A1.1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.4.m4.1c">N_{i}</annotation></semantics></math> examples locally. With <span id="A1.1.p1.9.1" class="ltx_text ltx_font_smallcaps">FedSGD</span>, a client <math id="A1.1.p1.5.m5.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="A1.1.p1.5.m5.1a"><msub id="A1.1.p1.5.m5.1.1" xref="A1.1.p1.5.m5.1.1.cmml"><mi id="A1.1.p1.5.m5.1.1.2" xref="A1.1.p1.5.m5.1.1.2.cmml">c</mi><mi id="A1.1.p1.5.m5.1.1.3" xref="A1.1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.5.m5.1b"><apply id="A1.1.p1.5.m5.1.1.cmml" xref="A1.1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.1.p1.5.m5.1.1.1.cmml" xref="A1.1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.1.p1.5.m5.1.1.2.cmml" xref="A1.1.p1.5.m5.1.1.2">𝑐</ci><ci id="A1.1.p1.5.m5.1.1.3.cmml" xref="A1.1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.5.m5.1c">c_{i}</annotation></semantics></math> only train model for a single step for each training round, with a batch size of <math id="A1.1.p1.6.m6.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="A1.1.p1.6.m6.1a"><msub id="A1.1.p1.6.m6.1.1" xref="A1.1.p1.6.m6.1.1.cmml"><mi id="A1.1.p1.6.m6.1.1.2" xref="A1.1.p1.6.m6.1.1.2.cmml">N</mi><mi id="A1.1.p1.6.m6.1.1.3" xref="A1.1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.6.m6.1b"><apply id="A1.1.p1.6.m6.1.1.cmml" xref="A1.1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.1.p1.6.m6.1.1.1.cmml" xref="A1.1.p1.6.m6.1.1">subscript</csymbol><ci id="A1.1.p1.6.m6.1.1.2.cmml" xref="A1.1.p1.6.m6.1.1.2">𝑁</ci><ci id="A1.1.p1.6.m6.1.1.3.cmml" xref="A1.1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.6.m6.1c">N_{i}</annotation></semantics></math>. Since the model is trained with a batch insensitive loss <math id="A1.1.p1.7.m7.1" class="ltx_Math" alttext="\ell_{BI}" display="inline"><semantics id="A1.1.p1.7.m7.1a"><msub id="A1.1.p1.7.m7.1.1" xref="A1.1.p1.7.m7.1.1.cmml"><mi mathvariant="normal" id="A1.1.p1.7.m7.1.1.2" xref="A1.1.p1.7.m7.1.1.2.cmml">ℓ</mi><mrow id="A1.1.p1.7.m7.1.1.3" xref="A1.1.p1.7.m7.1.1.3.cmml"><mi id="A1.1.p1.7.m7.1.1.3.2" xref="A1.1.p1.7.m7.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.1.p1.7.m7.1.1.3.1" xref="A1.1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="A1.1.p1.7.m7.1.1.3.3" xref="A1.1.p1.7.m7.1.1.3.3.cmml">I</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.7.m7.1b"><apply id="A1.1.p1.7.m7.1.1.cmml" xref="A1.1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.1.p1.7.m7.1.1.1.cmml" xref="A1.1.p1.7.m7.1.1">subscript</csymbol><ci id="A1.1.p1.7.m7.1.1.2.cmml" xref="A1.1.p1.7.m7.1.1.2">ℓ</ci><apply id="A1.1.p1.7.m7.1.1.3.cmml" xref="A1.1.p1.7.m7.1.1.3"><times id="A1.1.p1.7.m7.1.1.3.1.cmml" xref="A1.1.p1.7.m7.1.1.3.1"></times><ci id="A1.1.p1.7.m7.1.1.3.2.cmml" xref="A1.1.p1.7.m7.1.1.3.2">𝐵</ci><ci id="A1.1.p1.7.m7.1.1.3.3.cmml" xref="A1.1.p1.7.m7.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.7.m7.1c">\ell_{BI}</annotation></semantics></math>, with <a href="#S3.E1" title="In Definition 1 (Batch-Insensitive Loss). ‣ 3 Batch-Insensitive Losses ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a>, we derive that the local model gradient of client <math id="A1.1.p1.8.m8.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="A1.1.p1.8.m8.1a"><msub id="A1.1.p1.8.m8.1.1" xref="A1.1.p1.8.m8.1.1.cmml"><mi id="A1.1.p1.8.m8.1.1.2" xref="A1.1.p1.8.m8.1.1.2.cmml">c</mi><mi id="A1.1.p1.8.m8.1.1.3" xref="A1.1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.8.m8.1b"><apply id="A1.1.p1.8.m8.1.1.cmml" xref="A1.1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A1.1.p1.8.m8.1.1.1.cmml" xref="A1.1.p1.8.m8.1.1">subscript</csymbol><ci id="A1.1.p1.8.m8.1.1.2.cmml" xref="A1.1.p1.8.m8.1.1.2">𝑐</ci><ci id="A1.1.p1.8.m8.1.1.3.cmml" xref="A1.1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.8.m8.1c">c_{i}</annotation></semantics></math> at the end of training round <math id="A1.1.p1.9.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.1.p1.9.m9.1a"><mi id="A1.1.p1.9.m9.1.1" xref="A1.1.p1.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.9.m9.1b"><ci id="A1.1.p1.9.m9.1.1.cmml" xref="A1.1.p1.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.9.m9.1c">k</annotation></semantics></math> is</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="A1.E3.m1.53" class="ltx_Math" alttext="\displaystyle\begin{split}\nabla\ell_{C_{i}}&amp;=\nabla\frac{1}{N_{i}}\sum^{N_{i}}_{j=0}\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\\
&amp;=\frac{1}{N_{i}}\sum^{N-i}_{j=0}\nabla\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\end{split}" display="inline"><semantics id="A1.E3.m1.53a"><mtable columnspacing="0pt" rowspacing="0pt" id="A1.E3.m1.53.53.8" xref="A1.E3.m1.49.49.4.cmml"><mtr id="A1.E3.m1.53.53.8a" xref="A1.E3.m1.49.49.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E3.m1.53.53.8b" xref="A1.E3.m1.49.49.4.cmml"><mrow id="A1.E3.m1.3.3.3.3.3a" xref="A1.E3.m1.49.49.4.cmml"><mo rspace="0.167em" id="A1.E3.m1.1.1.1.1.1.1" xref="A1.E3.m1.1.1.1.1.1.1.cmml">∇</mo><msub id="A1.E3.m1.3.3.3.3.3a.4" xref="A1.E3.m1.49.49.4.cmml"><mi mathvariant="normal" id="A1.E3.m1.2.2.2.2.2.2" xref="A1.E3.m1.2.2.2.2.2.2.cmml">ℓ</mi><msub id="A1.E3.m1.3.3.3.3.3.3.1" xref="A1.E3.m1.3.3.3.3.3.3.1.cmml"><mi id="A1.E3.m1.3.3.3.3.3.3.1.2" xref="A1.E3.m1.3.3.3.3.3.3.1.2.cmml">C</mi><mi id="A1.E3.m1.3.3.3.3.3.3.1.3" xref="A1.E3.m1.3.3.3.3.3.3.1.3.cmml">i</mi></msub></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E3.m1.53.53.8c" xref="A1.E3.m1.49.49.4.cmml"><mrow id="A1.E3.m1.51.51.6.47.26.23" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.51.51.6.47.26.23.24" xref="A1.E3.m1.49.49.4a.cmml"></mi><mo id="A1.E3.m1.4.4.4.4.1.1" xref="A1.E3.m1.4.4.4.4.1.1.cmml">=</mo><mrow id="A1.E3.m1.51.51.6.47.26.23.23" xref="A1.E3.m1.49.49.4.cmml"><mrow id="A1.E3.m1.51.51.6.47.26.23.23.4" xref="A1.E3.m1.49.49.4.cmml"><mo rspace="0.167em" id="A1.E3.m1.5.5.5.5.2.2" xref="A1.E3.m1.5.5.5.5.2.2.cmml">∇</mo><mstyle displaystyle="true" id="A1.E3.m1.6.6.6.6.3.3" xref="A1.E3.m1.6.6.6.6.3.3.cmml"><mfrac id="A1.E3.m1.6.6.6.6.3.3a" xref="A1.E3.m1.6.6.6.6.3.3.cmml"><mn id="A1.E3.m1.6.6.6.6.3.3.2" xref="A1.E3.m1.6.6.6.6.3.3.2.cmml">1</mn><msub id="A1.E3.m1.6.6.6.6.3.3.3" xref="A1.E3.m1.6.6.6.6.3.3.3.cmml"><mi id="A1.E3.m1.6.6.6.6.3.3.3.2" xref="A1.E3.m1.6.6.6.6.3.3.3.2.cmml">N</mi><mi id="A1.E3.m1.6.6.6.6.3.3.3.3" xref="A1.E3.m1.6.6.6.6.3.3.3.3.cmml">i</mi></msub></mfrac></mstyle></mrow><mo lspace="0em" rspace="0em" id="A1.E3.m1.51.51.6.47.26.23.23.3" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.51.51.6.47.26.23.23.2" xref="A1.E3.m1.49.49.4.cmml"><mstyle displaystyle="true" id="A1.E3.m1.51.51.6.47.26.23.23.2.3" xref="A1.E3.m1.49.49.4.cmml"><munderover id="A1.E3.m1.51.51.6.47.26.23.23.2.3a" xref="A1.E3.m1.49.49.4.cmml"><mo movablelimits="false" id="A1.E3.m1.7.7.7.7.4.4" xref="A1.E3.m1.7.7.7.7.4.4.cmml">∑</mo><mrow id="A1.E3.m1.9.9.9.9.6.6.1" xref="A1.E3.m1.9.9.9.9.6.6.1.cmml"><mi id="A1.E3.m1.9.9.9.9.6.6.1.2" xref="A1.E3.m1.9.9.9.9.6.6.1.2.cmml">j</mi><mo id="A1.E3.m1.9.9.9.9.6.6.1.1" xref="A1.E3.m1.9.9.9.9.6.6.1.1.cmml">=</mo><mn id="A1.E3.m1.9.9.9.9.6.6.1.3" xref="A1.E3.m1.9.9.9.9.6.6.1.3.cmml">0</mn></mrow><msub id="A1.E3.m1.8.8.8.8.5.5.1" xref="A1.E3.m1.8.8.8.8.5.5.1.cmml"><mi id="A1.E3.m1.8.8.8.8.5.5.1.2" xref="A1.E3.m1.8.8.8.8.5.5.1.2.cmml">N</mi><mi id="A1.E3.m1.8.8.8.8.5.5.1.3" xref="A1.E3.m1.8.8.8.8.5.5.1.3.cmml">i</mi></msub></munderover></mstyle><mrow id="A1.E3.m1.51.51.6.47.26.23.23.2.2" xref="A1.E3.m1.49.49.4.cmml"><msub id="A1.E3.m1.51.51.6.47.26.23.23.2.2.4" xref="A1.E3.m1.49.49.4.cmml"><mi mathvariant="normal" id="A1.E3.m1.10.10.10.10.7.7" xref="A1.E3.m1.10.10.10.10.7.7.cmml">ℓ</mi><mrow id="A1.E3.m1.11.11.11.11.8.8.1" xref="A1.E3.m1.11.11.11.11.8.8.1.cmml"><mi id="A1.E3.m1.11.11.11.11.8.8.1.2" xref="A1.E3.m1.11.11.11.11.8.8.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E3.m1.11.11.11.11.8.8.1.1" xref="A1.E3.m1.11.11.11.11.8.8.1.1.cmml">​</mo><mi id="A1.E3.m1.11.11.11.11.8.8.1.3" xref="A1.E3.m1.11.11.11.11.8.8.1.3.cmml">I</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E3.m1.51.51.6.47.26.23.23.2.2.3" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.51.51.6.47.26.23.23.2.2.2.2" xref="A1.E3.m1.49.49.4.cmml"><mo stretchy="false" id="A1.E3.m1.12.12.12.12.9.9" xref="A1.E3.m1.49.49.4a.cmml">(</mo><mrow id="A1.E3.m1.50.50.5.46.25.22.22.1.1.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.13.13.13.13.10.10" xref="A1.E3.m1.13.13.13.13.10.10.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E3.m1.50.50.5.46.25.22.22.1.1.1.1.1.2" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.50.50.5.46.25.22.22.1.1.1.1.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mo stretchy="false" id="A1.E3.m1.14.14.14.14.11.11" xref="A1.E3.m1.49.49.4a.cmml">(</mo><msub id="A1.E3.m1.50.50.5.46.25.22.22.1.1.1.1.1.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.15.15.15.15.12.12" xref="A1.E3.m1.15.15.15.15.12.12.cmml">𝐗</mi><mi id="A1.E3.m1.16.16.16.16.13.13.1" xref="A1.E3.m1.16.16.16.16.13.13.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E3.m1.17.17.17.17.14.14" xref="A1.E3.m1.49.49.4a.cmml">)</mo></mrow></mrow><mo id="A1.E3.m1.18.18.18.18.15.15" xref="A1.E3.m1.49.49.4a.cmml">,</mo><mrow id="A1.E3.m1.51.51.6.47.26.23.23.2.2.2.2.2" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.19.19.19.19.16.16" xref="A1.E3.m1.19.19.19.19.16.16.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E3.m1.51.51.6.47.26.23.23.2.2.2.2.2.2" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.51.51.6.47.26.23.23.2.2.2.2.2.1.1" xref="A1.E3.m1.49.49.4.cmml"><mo stretchy="false" id="A1.E3.m1.20.20.20.20.17.17" xref="A1.E3.m1.49.49.4a.cmml">(</mo><msub id="A1.E3.m1.51.51.6.47.26.23.23.2.2.2.2.2.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.21.21.21.21.18.18" xref="A1.E3.m1.21.21.21.21.18.18.cmml">𝐘</mi><mi id="A1.E3.m1.22.22.22.22.19.19.1" xref="A1.E3.m1.22.22.22.22.19.19.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E3.m1.23.23.23.23.20.20" xref="A1.E3.m1.49.49.4a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E3.m1.24.24.24.24.21.21" xref="A1.E3.m1.49.49.4a.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E3.m1.53.53.8d" xref="A1.E3.m1.49.49.4.cmml"><mtd id="A1.E3.m1.53.53.8e" xref="A1.E3.m1.49.49.4a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E3.m1.53.53.8f" xref="A1.E3.m1.49.49.4.cmml"><mrow id="A1.E3.m1.53.53.8.49.23.23" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.53.53.8.49.23.23.24" xref="A1.E3.m1.49.49.4a.cmml"></mi><mo id="A1.E3.m1.25.25.25.1.1.1" xref="A1.E3.m1.25.25.25.1.1.1.cmml">=</mo><mrow id="A1.E3.m1.53.53.8.49.23.23.23" xref="A1.E3.m1.49.49.4.cmml"><mstyle displaystyle="true" id="A1.E3.m1.26.26.26.2.2.2" xref="A1.E3.m1.26.26.26.2.2.2.cmml"><mfrac id="A1.E3.m1.26.26.26.2.2.2a" xref="A1.E3.m1.26.26.26.2.2.2.cmml"><mn id="A1.E3.m1.26.26.26.2.2.2.2" xref="A1.E3.m1.26.26.26.2.2.2.2.cmml">1</mn><msub id="A1.E3.m1.26.26.26.2.2.2.3" xref="A1.E3.m1.26.26.26.2.2.2.3.cmml"><mi id="A1.E3.m1.26.26.26.2.2.2.3.2" xref="A1.E3.m1.26.26.26.2.2.2.3.2.cmml">N</mi><mi id="A1.E3.m1.26.26.26.2.2.2.3.3" xref="A1.E3.m1.26.26.26.2.2.2.3.3.cmml">i</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A1.E3.m1.53.53.8.49.23.23.23.3" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.53.53.8.49.23.23.23.2" xref="A1.E3.m1.49.49.4.cmml"><mstyle displaystyle="true" id="A1.E3.m1.53.53.8.49.23.23.23.2.3" xref="A1.E3.m1.49.49.4.cmml"><munderover id="A1.E3.m1.53.53.8.49.23.23.23.2.3a" xref="A1.E3.m1.49.49.4.cmml"><mo movablelimits="false" id="A1.E3.m1.27.27.27.3.3.3" xref="A1.E3.m1.27.27.27.3.3.3.cmml">∑</mo><mrow id="A1.E3.m1.29.29.29.5.5.5.1" xref="A1.E3.m1.29.29.29.5.5.5.1.cmml"><mi id="A1.E3.m1.29.29.29.5.5.5.1.2" xref="A1.E3.m1.29.29.29.5.5.5.1.2.cmml">j</mi><mo id="A1.E3.m1.29.29.29.5.5.5.1.1" xref="A1.E3.m1.29.29.29.5.5.5.1.1.cmml">=</mo><mn id="A1.E3.m1.29.29.29.5.5.5.1.3" xref="A1.E3.m1.29.29.29.5.5.5.1.3.cmml">0</mn></mrow><mrow id="A1.E3.m1.28.28.28.4.4.4.1" xref="A1.E3.m1.28.28.28.4.4.4.1.cmml"><mi id="A1.E3.m1.28.28.28.4.4.4.1.2" xref="A1.E3.m1.28.28.28.4.4.4.1.2.cmml">N</mi><mo id="A1.E3.m1.28.28.28.4.4.4.1.1" xref="A1.E3.m1.28.28.28.4.4.4.1.1.cmml">−</mo><mi id="A1.E3.m1.28.28.28.4.4.4.1.3" xref="A1.E3.m1.28.28.28.4.4.4.1.3.cmml">i</mi></mrow></munderover></mstyle><mrow id="A1.E3.m1.53.53.8.49.23.23.23.2.2" xref="A1.E3.m1.49.49.4.cmml"><mrow id="A1.E3.m1.53.53.8.49.23.23.23.2.2.4" xref="A1.E3.m1.49.49.4.cmml"><mo lspace="0.167em" rspace="0.167em" id="A1.E3.m1.30.30.30.6.6.6" xref="A1.E3.m1.30.30.30.6.6.6.cmml">∇</mo><msub id="A1.E3.m1.53.53.8.49.23.23.23.2.2.4.1" xref="A1.E3.m1.49.49.4.cmml"><mi mathvariant="normal" id="A1.E3.m1.31.31.31.7.7.7" xref="A1.E3.m1.31.31.31.7.7.7.cmml">ℓ</mi><mrow id="A1.E3.m1.32.32.32.8.8.8.1" xref="A1.E3.m1.32.32.32.8.8.8.1.cmml"><mi id="A1.E3.m1.32.32.32.8.8.8.1.2" xref="A1.E3.m1.32.32.32.8.8.8.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E3.m1.32.32.32.8.8.8.1.1" xref="A1.E3.m1.32.32.32.8.8.8.1.1.cmml">​</mo><mi id="A1.E3.m1.32.32.32.8.8.8.1.3" xref="A1.E3.m1.32.32.32.8.8.8.1.3.cmml">I</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A1.E3.m1.53.53.8.49.23.23.23.2.2.3" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.53.53.8.49.23.23.23.2.2.2.2" xref="A1.E3.m1.49.49.4.cmml"><mo stretchy="false" id="A1.E3.m1.33.33.33.9.9.9" xref="A1.E3.m1.49.49.4a.cmml">(</mo><mrow id="A1.E3.m1.52.52.7.48.22.22.22.1.1.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.34.34.34.10.10.10" xref="A1.E3.m1.34.34.34.10.10.10.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E3.m1.52.52.7.48.22.22.22.1.1.1.1.1.2" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.52.52.7.48.22.22.22.1.1.1.1.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mo stretchy="false" id="A1.E3.m1.35.35.35.11.11.11" xref="A1.E3.m1.49.49.4a.cmml">(</mo><msub id="A1.E3.m1.52.52.7.48.22.22.22.1.1.1.1.1.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.36.36.36.12.12.12" xref="A1.E3.m1.36.36.36.12.12.12.cmml">𝐗</mi><mi id="A1.E3.m1.37.37.37.13.13.13.1" xref="A1.E3.m1.37.37.37.13.13.13.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E3.m1.38.38.38.14.14.14" xref="A1.E3.m1.49.49.4a.cmml">)</mo></mrow></mrow><mo id="A1.E3.m1.39.39.39.15.15.15" xref="A1.E3.m1.49.49.4a.cmml">,</mo><mrow id="A1.E3.m1.53.53.8.49.23.23.23.2.2.2.2.2" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.40.40.40.16.16.16" xref="A1.E3.m1.40.40.40.16.16.16.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E3.m1.53.53.8.49.23.23.23.2.2.2.2.2.2" xref="A1.E3.m1.49.49.4a.cmml">​</mo><mrow id="A1.E3.m1.53.53.8.49.23.23.23.2.2.2.2.2.1.1" xref="A1.E3.m1.49.49.4.cmml"><mo stretchy="false" id="A1.E3.m1.41.41.41.17.17.17" xref="A1.E3.m1.49.49.4a.cmml">(</mo><msub id="A1.E3.m1.53.53.8.49.23.23.23.2.2.2.2.2.1.1.1" xref="A1.E3.m1.49.49.4.cmml"><mi id="A1.E3.m1.42.42.42.18.18.18" xref="A1.E3.m1.42.42.42.18.18.18.cmml">𝐘</mi><mi id="A1.E3.m1.43.43.43.19.19.19.1" xref="A1.E3.m1.43.43.43.19.19.19.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E3.m1.44.44.44.20.20.20" xref="A1.E3.m1.49.49.4a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E3.m1.45.45.45.21.21.21" xref="A1.E3.m1.49.49.4a.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E3.m1.53b"><apply id="A1.E3.m1.49.49.4.cmml" xref="A1.E3.m1.53.53.8"><and id="A1.E3.m1.49.49.4a.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24"></and><apply id="A1.E3.m1.49.49.4b.cmml" xref="A1.E3.m1.53.53.8"><eq id="A1.E3.m1.4.4.4.4.1.1.cmml" xref="A1.E3.m1.4.4.4.4.1.1"></eq><apply id="A1.E3.m1.49.49.4.6.cmml" xref="A1.E3.m1.53.53.8"><ci id="A1.E3.m1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.1.1.1.1.1.1">∇</ci><apply id="A1.E3.m1.49.49.4.6.2.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.49.49.4.6.2.1.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24">subscript</csymbol><ci id="A1.E3.m1.2.2.2.2.2.2.cmml" xref="A1.E3.m1.2.2.2.2.2.2">ℓ</ci><apply id="A1.E3.m1.3.3.3.3.3.3.1.cmml" xref="A1.E3.m1.3.3.3.3.3.3.1"><csymbol cd="ambiguous" id="A1.E3.m1.3.3.3.3.3.3.1.1.cmml" xref="A1.E3.m1.3.3.3.3.3.3.1">subscript</csymbol><ci id="A1.E3.m1.3.3.3.3.3.3.1.2.cmml" xref="A1.E3.m1.3.3.3.3.3.3.1.2">𝐶</ci><ci id="A1.E3.m1.3.3.3.3.3.3.1.3.cmml" xref="A1.E3.m1.3.3.3.3.3.3.1.3">𝑖</ci></apply></apply></apply><apply id="A1.E3.m1.47.47.2.2.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.47.47.2.2.3.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24"></times><apply id="A1.E3.m1.47.47.2.2.4.cmml" xref="A1.E3.m1.53.53.8"><ci id="A1.E3.m1.5.5.5.5.2.2.cmml" xref="A1.E3.m1.5.5.5.5.2.2">∇</ci><apply id="A1.E3.m1.6.6.6.6.3.3.cmml" xref="A1.E3.m1.6.6.6.6.3.3"><divide id="A1.E3.m1.6.6.6.6.3.3.1.cmml" xref="A1.E3.m1.6.6.6.6.3.3"></divide><cn type="integer" id="A1.E3.m1.6.6.6.6.3.3.2.cmml" xref="A1.E3.m1.6.6.6.6.3.3.2">1</cn><apply id="A1.E3.m1.6.6.6.6.3.3.3.cmml" xref="A1.E3.m1.6.6.6.6.3.3.3"><csymbol cd="ambiguous" id="A1.E3.m1.6.6.6.6.3.3.3.1.cmml" xref="A1.E3.m1.6.6.6.6.3.3.3">subscript</csymbol><ci id="A1.E3.m1.6.6.6.6.3.3.3.2.cmml" xref="A1.E3.m1.6.6.6.6.3.3.3.2">𝑁</ci><ci id="A1.E3.m1.6.6.6.6.3.3.3.3.cmml" xref="A1.E3.m1.6.6.6.6.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="A1.E3.m1.47.47.2.2.2.cmml" xref="A1.E3.m1.53.53.8"><apply id="A1.E3.m1.47.47.2.2.2.3.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.47.47.2.2.2.3.1.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24">subscript</csymbol><apply id="A1.E3.m1.47.47.2.2.2.3.2.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.47.47.2.2.2.3.2.1.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24">superscript</csymbol><sum id="A1.E3.m1.7.7.7.7.4.4.cmml" xref="A1.E3.m1.7.7.7.7.4.4"></sum><apply id="A1.E3.m1.8.8.8.8.5.5.1.cmml" xref="A1.E3.m1.8.8.8.8.5.5.1"><csymbol cd="ambiguous" id="A1.E3.m1.8.8.8.8.5.5.1.1.cmml" xref="A1.E3.m1.8.8.8.8.5.5.1">subscript</csymbol><ci id="A1.E3.m1.8.8.8.8.5.5.1.2.cmml" xref="A1.E3.m1.8.8.8.8.5.5.1.2">𝑁</ci><ci id="A1.E3.m1.8.8.8.8.5.5.1.3.cmml" xref="A1.E3.m1.8.8.8.8.5.5.1.3">𝑖</ci></apply></apply><apply id="A1.E3.m1.9.9.9.9.6.6.1.cmml" xref="A1.E3.m1.9.9.9.9.6.6.1"><eq id="A1.E3.m1.9.9.9.9.6.6.1.1.cmml" xref="A1.E3.m1.9.9.9.9.6.6.1.1"></eq><ci id="A1.E3.m1.9.9.9.9.6.6.1.2.cmml" xref="A1.E3.m1.9.9.9.9.6.6.1.2">𝑗</ci><cn type="integer" id="A1.E3.m1.9.9.9.9.6.6.1.3.cmml" xref="A1.E3.m1.9.9.9.9.6.6.1.3">0</cn></apply></apply><apply id="A1.E3.m1.47.47.2.2.2.2.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.47.47.2.2.2.2.3.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24"></times><apply id="A1.E3.m1.47.47.2.2.2.2.4.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.47.47.2.2.2.2.4.1.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24">subscript</csymbol><ci id="A1.E3.m1.10.10.10.10.7.7.cmml" xref="A1.E3.m1.10.10.10.10.7.7">ℓ</ci><apply id="A1.E3.m1.11.11.11.11.8.8.1.cmml" xref="A1.E3.m1.11.11.11.11.8.8.1"><times id="A1.E3.m1.11.11.11.11.8.8.1.1.cmml" xref="A1.E3.m1.11.11.11.11.8.8.1.1"></times><ci id="A1.E3.m1.11.11.11.11.8.8.1.2.cmml" xref="A1.E3.m1.11.11.11.11.8.8.1.2">𝐵</ci><ci id="A1.E3.m1.11.11.11.11.8.8.1.3.cmml" xref="A1.E3.m1.11.11.11.11.8.8.1.3">𝐼</ci></apply></apply><interval closure="open" id="A1.E3.m1.47.47.2.2.2.2.2.3.cmml" xref="A1.E3.m1.53.53.8"><apply id="A1.E3.m1.46.46.1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.46.46.1.1.1.1.1.1.1.2.cmml" xref="A1.E3.m1.53.53.8"></times><ci id="A1.E3.m1.13.13.13.13.10.10.cmml" xref="A1.E3.m1.13.13.13.13.10.10">𝑓</ci><apply id="A1.E3.m1.46.46.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.46.46.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8">subscript</csymbol><ci id="A1.E3.m1.15.15.15.15.12.12.cmml" xref="A1.E3.m1.15.15.15.15.12.12">𝐗</ci><ci id="A1.E3.m1.16.16.16.16.13.13.1.cmml" xref="A1.E3.m1.16.16.16.16.13.13.1">𝑗</ci></apply></apply><apply id="A1.E3.m1.47.47.2.2.2.2.2.2.2.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.47.47.2.2.2.2.2.2.2.2.cmml" xref="A1.E3.m1.53.53.8"></times><ci id="A1.E3.m1.19.19.19.19.16.16.cmml" xref="A1.E3.m1.19.19.19.19.16.16">𝑔</ci><apply id="A1.E3.m1.47.47.2.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.47.47.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8">subscript</csymbol><ci id="A1.E3.m1.21.21.21.21.18.18.cmml" xref="A1.E3.m1.21.21.21.21.18.18">𝐘</ci><ci id="A1.E3.m1.22.22.22.22.19.19.1.cmml" xref="A1.E3.m1.22.22.22.22.19.19.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply><apply id="A1.E3.m1.49.49.4c.cmml" xref="A1.E3.m1.53.53.8"><eq id="A1.E3.m1.25.25.25.1.1.1.cmml" xref="A1.E3.m1.25.25.25.1.1.1"></eq><share href="#A1.E3.m1.47.47.2.2.cmml" id="A1.E3.m1.49.49.4d.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24"></share><apply id="A1.E3.m1.49.49.4.4.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.49.49.4.4.3.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24"></times><apply id="A1.E3.m1.26.26.26.2.2.2.cmml" xref="A1.E3.m1.26.26.26.2.2.2"><divide id="A1.E3.m1.26.26.26.2.2.2.1.cmml" xref="A1.E3.m1.26.26.26.2.2.2"></divide><cn type="integer" id="A1.E3.m1.26.26.26.2.2.2.2.cmml" xref="A1.E3.m1.26.26.26.2.2.2.2">1</cn><apply id="A1.E3.m1.26.26.26.2.2.2.3.cmml" xref="A1.E3.m1.26.26.26.2.2.2.3"><csymbol cd="ambiguous" id="A1.E3.m1.26.26.26.2.2.2.3.1.cmml" xref="A1.E3.m1.26.26.26.2.2.2.3">subscript</csymbol><ci id="A1.E3.m1.26.26.26.2.2.2.3.2.cmml" xref="A1.E3.m1.26.26.26.2.2.2.3.2">𝑁</ci><ci id="A1.E3.m1.26.26.26.2.2.2.3.3.cmml" xref="A1.E3.m1.26.26.26.2.2.2.3.3">𝑖</ci></apply></apply><apply id="A1.E3.m1.49.49.4.4.2.cmml" xref="A1.E3.m1.53.53.8"><apply id="A1.E3.m1.49.49.4.4.2.3.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.49.49.4.4.2.3.1.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24">subscript</csymbol><apply id="A1.E3.m1.49.49.4.4.2.3.2.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.49.49.4.4.2.3.2.1.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24">superscript</csymbol><sum id="A1.E3.m1.27.27.27.3.3.3.cmml" xref="A1.E3.m1.27.27.27.3.3.3"></sum><apply id="A1.E3.m1.28.28.28.4.4.4.1.cmml" xref="A1.E3.m1.28.28.28.4.4.4.1"><minus id="A1.E3.m1.28.28.28.4.4.4.1.1.cmml" xref="A1.E3.m1.28.28.28.4.4.4.1.1"></minus><ci id="A1.E3.m1.28.28.28.4.4.4.1.2.cmml" xref="A1.E3.m1.28.28.28.4.4.4.1.2">𝑁</ci><ci id="A1.E3.m1.28.28.28.4.4.4.1.3.cmml" xref="A1.E3.m1.28.28.28.4.4.4.1.3">𝑖</ci></apply></apply><apply id="A1.E3.m1.29.29.29.5.5.5.1.cmml" xref="A1.E3.m1.29.29.29.5.5.5.1"><eq id="A1.E3.m1.29.29.29.5.5.5.1.1.cmml" xref="A1.E3.m1.29.29.29.5.5.5.1.1"></eq><ci id="A1.E3.m1.29.29.29.5.5.5.1.2.cmml" xref="A1.E3.m1.29.29.29.5.5.5.1.2">𝑗</ci><cn type="integer" id="A1.E3.m1.29.29.29.5.5.5.1.3.cmml" xref="A1.E3.m1.29.29.29.5.5.5.1.3">0</cn></apply></apply><apply id="A1.E3.m1.49.49.4.4.2.2.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.49.49.4.4.2.2.3.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24"></times><apply id="A1.E3.m1.49.49.4.4.2.2.4.cmml" xref="A1.E3.m1.53.53.8"><ci id="A1.E3.m1.30.30.30.6.6.6.cmml" xref="A1.E3.m1.30.30.30.6.6.6">∇</ci><apply id="A1.E3.m1.49.49.4.4.2.2.4.2.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.49.49.4.4.2.2.4.2.1.cmml" xref="A1.E3.m1.51.51.6.47.26.23.24">subscript</csymbol><ci id="A1.E3.m1.31.31.31.7.7.7.cmml" xref="A1.E3.m1.31.31.31.7.7.7">ℓ</ci><apply id="A1.E3.m1.32.32.32.8.8.8.1.cmml" xref="A1.E3.m1.32.32.32.8.8.8.1"><times id="A1.E3.m1.32.32.32.8.8.8.1.1.cmml" xref="A1.E3.m1.32.32.32.8.8.8.1.1"></times><ci id="A1.E3.m1.32.32.32.8.8.8.1.2.cmml" xref="A1.E3.m1.32.32.32.8.8.8.1.2">𝐵</ci><ci id="A1.E3.m1.32.32.32.8.8.8.1.3.cmml" xref="A1.E3.m1.32.32.32.8.8.8.1.3">𝐼</ci></apply></apply></apply><interval closure="open" id="A1.E3.m1.49.49.4.4.2.2.2.3.cmml" xref="A1.E3.m1.53.53.8"><apply id="A1.E3.m1.48.48.3.3.1.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.48.48.3.3.1.1.1.1.1.2.cmml" xref="A1.E3.m1.53.53.8"></times><ci id="A1.E3.m1.34.34.34.10.10.10.cmml" xref="A1.E3.m1.34.34.34.10.10.10">𝑓</ci><apply id="A1.E3.m1.48.48.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.48.48.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8">subscript</csymbol><ci id="A1.E3.m1.36.36.36.12.12.12.cmml" xref="A1.E3.m1.36.36.36.12.12.12">𝐗</ci><ci id="A1.E3.m1.37.37.37.13.13.13.1.cmml" xref="A1.E3.m1.37.37.37.13.13.13.1">𝑗</ci></apply></apply><apply id="A1.E3.m1.49.49.4.4.2.2.2.2.2.cmml" xref="A1.E3.m1.53.53.8"><times id="A1.E3.m1.49.49.4.4.2.2.2.2.2.2.cmml" xref="A1.E3.m1.53.53.8"></times><ci id="A1.E3.m1.40.40.40.16.16.16.cmml" xref="A1.E3.m1.40.40.40.16.16.16">𝑔</ci><apply id="A1.E3.m1.49.49.4.4.2.2.2.2.2.1.1.1.cmml" xref="A1.E3.m1.53.53.8"><csymbol cd="ambiguous" id="A1.E3.m1.49.49.4.4.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E3.m1.53.53.8">subscript</csymbol><ci id="A1.E3.m1.42.42.42.18.18.18.cmml" xref="A1.E3.m1.42.42.42.18.18.18">𝐘</ci><ci id="A1.E3.m1.43.43.43.19.19.19.1.cmml" xref="A1.E3.m1.43.43.43.19.19.19.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E3.m1.53c">\displaystyle\begin{split}\nabla\ell_{C_{i}}&amp;=\nabla\frac{1}{N_{i}}\sum^{N_{i}}_{j=0}\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\\
&amp;=\frac{1}{N_{i}}\sum^{N-i}_{j=0}\nabla\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.2.p2" class="ltx_para ltx_noindent">
<p id="A1.2.p2.1" class="ltx_p">The local model gradient of all the clients are aggregated to update the server model. Therefore, the server model update at step <math id="A1.2.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.2.p2.1.m1.1a"><mi id="A1.2.p2.1.m1.1.1" xref="A1.2.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.2.p2.1.m1.1b"><ci id="A1.2.p2.1.m1.1.1.cmml" xref="A1.2.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.2.p2.1.m1.1c">k</annotation></semantics></math> is</p>
</div>
<div id="A1.3.p3" class="ltx_para ltx_noindent">
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="A1.E4.m1.22" class="ltx_Math" alttext="\displaystyle\begin{split}\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)&amp;=\eta_{s,fedsgd}\cdot\frac{\sum^{M}_{i=0}\nabla\ell_{C_{i}}}{\sum^{M}_{i=0}N_{i}}\\
&amp;=\eta_{s,fedsgd}\cdot\frac{\sum^{M}_{i=0}\sum^{N_{i}}_{j=0}\nabla\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))}{\sum^{M}_{i=0}N_{i}}\end{split}" display="inline"><semantics id="A1.E4.m1.22a"><mtable columnspacing="0pt" rowspacing="0pt" id="A1.E4.m1.22.22.2" xref="A1.E4.m1.21.21.1.cmml"><mtr id="A1.E4.m1.22.22.2a" xref="A1.E4.m1.21.21.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E4.m1.22.22.2b" xref="A1.E4.m1.21.21.1.cmml"><mrow id="A1.E4.m1.22.22.2.21.16.11" xref="A1.E4.m1.21.21.1.cmml"><msub id="A1.E4.m1.22.22.2.21.16.11.13" xref="A1.E4.m1.21.21.1.cmml"><mi mathvariant="normal" id="A1.E4.m1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.cmml">Δ</mi><mrow id="A1.E4.m1.2.2.2.2.2.2.1.2" xref="A1.E4.m1.2.2.2.2.2.2.1.3.cmml"><mi id="A1.E4.m1.2.2.2.2.2.2.1.1" xref="A1.E4.m1.2.2.2.2.2.2.1.1.cmml">k</mi><mo id="A1.E4.m1.2.2.2.2.2.2.1.2.2" xref="A1.E4.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mrow id="A1.E4.m1.2.2.2.2.2.2.1.2.1" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.cmml"><mi id="A1.E4.m1.2.2.2.2.2.2.1.2.1.2" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.2.2.2.2.2.2.1.2.1.1" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.2.2.2.2.2.2.1.2.1.3" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.2.2.2.2.2.2.1.2.1.1a" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.2.2.2.2.2.2.1.2.1.4" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.2.2.2.2.2.2.1.2.1.1b" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.2.2.2.2.2.2.1.2.1.5" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.2.2.2.2.2.2.1.2.1.1c" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.2.2.2.2.2.2.1.2.1.6" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.2.2.2.2.2.2.1.2.1.1d" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.2.2.2.2.2.2.1.2.1.7" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E4.m1.22.22.2.21.16.11.12" xref="A1.E4.m1.21.21.1a.cmml">​</mo><mrow id="A1.E4.m1.22.22.2.21.16.11.11.1" xref="A1.E4.m1.21.21.1.cmml"><mo stretchy="false" id="A1.E4.m1.3.3.3.3.3.3" xref="A1.E4.m1.21.21.1a.cmml">(</mo><mrow id="A1.E4.m1.22.22.2.21.16.11.11.1.1" xref="A1.E4.m1.21.21.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E4.m1.4.4.4.4.4.4" xref="A1.E4.m1.4.4.4.4.4.4.cmml">𝒞</mi><mo fence="false" id="A1.E4.m1.5.5.5.5.5.5" xref="A1.E4.m1.5.5.5.5.5.5.cmml">|</mo><mrow id="A1.E4.m1.22.22.2.21.16.11.11.1.1.1.1" xref="A1.E4.m1.21.21.1.cmml"><msub id="A1.E4.m1.22.22.2.21.16.11.11.1.1.1.1.1" xref="A1.E4.m1.21.21.1.cmml"><mi mathvariant="normal" id="A1.E4.m1.6.6.6.6.6.6" xref="A1.E4.m1.6.6.6.6.6.6.cmml">ℓ</mi><mrow id="A1.E4.m1.7.7.7.7.7.7.1" xref="A1.E4.m1.7.7.7.7.7.7.1.cmml"><mi id="A1.E4.m1.7.7.7.7.7.7.1.2" xref="A1.E4.m1.7.7.7.7.7.7.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.7.7.7.7.7.7.1.1" xref="A1.E4.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="A1.E4.m1.7.7.7.7.7.7.1.3" xref="A1.E4.m1.7.7.7.7.7.7.1.3.cmml">I</mi></mrow></msub><mo id="A1.E4.m1.8.8.8.8.8.8" xref="A1.E4.m1.21.21.1a.cmml">,</mo><mi mathvariant="normal" id="A1.E4.m1.9.9.9.9.9.9" xref="A1.E4.m1.9.9.9.9.9.9.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="A1.E4.m1.10.10.10.10.10.10" xref="A1.E4.m1.21.21.1a.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E4.m1.22.22.2c" xref="A1.E4.m1.21.21.1.cmml"><mrow id="A1.E4.m1.15.15.15.15.5a" xref="A1.E4.m1.21.21.1.cmml"><mi id="A1.E4.m1.15.15.15.15.5a.6" xref="A1.E4.m1.21.21.1a.cmml"></mi><mo id="A1.E4.m1.11.11.11.11.1.1" xref="A1.E4.m1.11.11.11.11.1.1.cmml">=</mo><mrow id="A1.E4.m1.15.15.15.15.5a.7" xref="A1.E4.m1.21.21.1.cmml"><msub id="A1.E4.m1.15.15.15.15.5a.7.1" xref="A1.E4.m1.21.21.1.cmml"><mi id="A1.E4.m1.12.12.12.12.2.2" xref="A1.E4.m1.12.12.12.12.2.2.cmml">η</mi><mrow id="A1.E4.m1.13.13.13.13.3.3.1.2" xref="A1.E4.m1.13.13.13.13.3.3.1.3.cmml"><mi id="A1.E4.m1.13.13.13.13.3.3.1.1" xref="A1.E4.m1.13.13.13.13.3.3.1.1.cmml">s</mi><mo id="A1.E4.m1.13.13.13.13.3.3.1.2.2" xref="A1.E4.m1.13.13.13.13.3.3.1.3.cmml">,</mo><mrow id="A1.E4.m1.13.13.13.13.3.3.1.2.1" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.cmml"><mi id="A1.E4.m1.13.13.13.13.3.3.1.2.1.2" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.13.13.13.13.3.3.1.2.1.1" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.13.13.13.13.3.3.1.2.1.3" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.13.13.13.13.3.3.1.2.1.1a" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.13.13.13.13.3.3.1.2.1.4" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.13.13.13.13.3.3.1.2.1.1b" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.13.13.13.13.3.3.1.2.1.5" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.13.13.13.13.3.3.1.2.1.1c" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.13.13.13.13.3.3.1.2.1.6" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.13.13.13.13.3.3.1.2.1.1d" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.13.13.13.13.3.3.1.2.1.7" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E4.m1.14.14.14.14.4.4" xref="A1.E4.m1.14.14.14.14.4.4.cmml">⋅</mo><mstyle displaystyle="true" id="A1.E4.m1.15.15.15.15.5.5" xref="A1.E4.m1.15.15.15.15.5.5.cmml"><mfrac id="A1.E4.m1.15.15.15.15.5.5a" xref="A1.E4.m1.15.15.15.15.5.5.cmml"><mrow id="A1.E4.m1.15.15.15.15.5.5.2" xref="A1.E4.m1.15.15.15.15.5.5.2.cmml"><msubsup id="A1.E4.m1.15.15.15.15.5.5.2.1" xref="A1.E4.m1.15.15.15.15.5.5.2.1.cmml"><mo id="A1.E4.m1.15.15.15.15.5.5.2.1.2.2" xref="A1.E4.m1.15.15.15.15.5.5.2.1.2.2.cmml">∑</mo><mrow id="A1.E4.m1.15.15.15.15.5.5.2.1.3" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3.cmml"><mi id="A1.E4.m1.15.15.15.15.5.5.2.1.3.2" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3.2.cmml">i</mi><mo id="A1.E4.m1.15.15.15.15.5.5.2.1.3.1" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3.1.cmml">=</mo><mn id="A1.E4.m1.15.15.15.15.5.5.2.1.3.3" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3.3.cmml">0</mn></mrow><mi id="A1.E4.m1.15.15.15.15.5.5.2.1.2.3" xref="A1.E4.m1.15.15.15.15.5.5.2.1.2.3.cmml">M</mi></msubsup><mrow id="A1.E4.m1.15.15.15.15.5.5.2.2" xref="A1.E4.m1.15.15.15.15.5.5.2.2.cmml"><mo rspace="0.167em" id="A1.E4.m1.15.15.15.15.5.5.2.2.1" xref="A1.E4.m1.15.15.15.15.5.5.2.2.1.cmml">∇</mo><msub id="A1.E4.m1.15.15.15.15.5.5.2.2.2" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.cmml"><mi mathvariant="normal" id="A1.E4.m1.15.15.15.15.5.5.2.2.2.2" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.2.cmml">ℓ</mi><msub id="A1.E4.m1.15.15.15.15.5.5.2.2.2.3" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.cmml"><mi id="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.2" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.2.cmml">C</mi><mi id="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.3" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.3.cmml">i</mi></msub></msub></mrow></mrow><mrow id="A1.E4.m1.15.15.15.15.5.5.3" xref="A1.E4.m1.15.15.15.15.5.5.3.cmml"><msubsup id="A1.E4.m1.15.15.15.15.5.5.3.1" xref="A1.E4.m1.15.15.15.15.5.5.3.1.cmml"><mo id="A1.E4.m1.15.15.15.15.5.5.3.1.2.2" xref="A1.E4.m1.15.15.15.15.5.5.3.1.2.2.cmml">∑</mo><mrow id="A1.E4.m1.15.15.15.15.5.5.3.1.3" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3.cmml"><mi id="A1.E4.m1.15.15.15.15.5.5.3.1.3.2" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3.2.cmml">i</mi><mo id="A1.E4.m1.15.15.15.15.5.5.3.1.3.1" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3.1.cmml">=</mo><mn id="A1.E4.m1.15.15.15.15.5.5.3.1.3.3" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3.3.cmml">0</mn></mrow><mi id="A1.E4.m1.15.15.15.15.5.5.3.1.2.3" xref="A1.E4.m1.15.15.15.15.5.5.3.1.2.3.cmml">M</mi></msubsup><msub id="A1.E4.m1.15.15.15.15.5.5.3.2" xref="A1.E4.m1.15.15.15.15.5.5.3.2.cmml"><mi id="A1.E4.m1.15.15.15.15.5.5.3.2.2" xref="A1.E4.m1.15.15.15.15.5.5.3.2.2.cmml">N</mi><mi id="A1.E4.m1.15.15.15.15.5.5.3.2.3" xref="A1.E4.m1.15.15.15.15.5.5.3.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle></mrow></mrow></mtd></mtr><mtr id="A1.E4.m1.22.22.2d" xref="A1.E4.m1.21.21.1.cmml"><mtd id="A1.E4.m1.22.22.2e" xref="A1.E4.m1.21.21.1a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E4.m1.22.22.2f" xref="A1.E4.m1.21.21.1.cmml"><mrow id="A1.E4.m1.20.20.20.5.5a" xref="A1.E4.m1.21.21.1.cmml"><mi id="A1.E4.m1.20.20.20.5.5a.6" xref="A1.E4.m1.21.21.1a.cmml"></mi><mo id="A1.E4.m1.16.16.16.1.1.1" xref="A1.E4.m1.16.16.16.1.1.1.cmml">=</mo><mrow id="A1.E4.m1.20.20.20.5.5a.7" xref="A1.E4.m1.21.21.1.cmml"><msub id="A1.E4.m1.20.20.20.5.5a.7.1" xref="A1.E4.m1.21.21.1.cmml"><mi id="A1.E4.m1.17.17.17.2.2.2" xref="A1.E4.m1.17.17.17.2.2.2.cmml">η</mi><mrow id="A1.E4.m1.18.18.18.3.3.3.1.2" xref="A1.E4.m1.18.18.18.3.3.3.1.3.cmml"><mi id="A1.E4.m1.18.18.18.3.3.3.1.1" xref="A1.E4.m1.18.18.18.3.3.3.1.1.cmml">s</mi><mo id="A1.E4.m1.18.18.18.3.3.3.1.2.2" xref="A1.E4.m1.18.18.18.3.3.3.1.3.cmml">,</mo><mrow id="A1.E4.m1.18.18.18.3.3.3.1.2.1" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.cmml"><mi id="A1.E4.m1.18.18.18.3.3.3.1.2.1.2" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.18.18.18.3.3.3.1.2.1.1" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.18.18.18.3.3.3.1.2.1.3" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.18.18.18.3.3.3.1.2.1.1a" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.18.18.18.3.3.3.1.2.1.4" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.18.18.18.3.3.3.1.2.1.1b" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.18.18.18.3.3.3.1.2.1.5" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.18.18.18.3.3.3.1.2.1.1c" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.18.18.18.3.3.3.1.2.1.6" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.18.18.18.3.3.3.1.2.1.1d" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E4.m1.18.18.18.3.3.3.1.2.1.7" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E4.m1.19.19.19.4.4.4" xref="A1.E4.m1.19.19.19.4.4.4.cmml">⋅</mo><mstyle displaystyle="true" id="A1.E4.m1.20.20.20.5.5.5" xref="A1.E4.m1.20.20.20.5.5.5.cmml"><mfrac id="A1.E4.m1.20.20.20.5.5.5a" xref="A1.E4.m1.20.20.20.5.5.5.cmml"><mrow id="A1.E4.m1.20.20.20.5.5.5.2" xref="A1.E4.m1.20.20.20.5.5.5.2.cmml"><msubsup id="A1.E4.m1.20.20.20.5.5.5.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.3.cmml"><mo id="A1.E4.m1.20.20.20.5.5.5.2.3.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.3.2.2.cmml">∑</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.2.3.3" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.2.3.3.2" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3.2.cmml">i</mi><mo id="A1.E4.m1.20.20.20.5.5.5.2.3.3.1" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3.1.cmml">=</mo><mn id="A1.E4.m1.20.20.20.5.5.5.2.3.3.3" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3.3.cmml">0</mn></mrow><mi id="A1.E4.m1.20.20.20.5.5.5.2.3.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.3.2.3.cmml">M</mi></msubsup><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.cmml"><msubsup id="A1.E4.m1.20.20.20.5.5.5.2.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.cmml"><mo lspace="0.167em" id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.2.cmml">∑</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.2.cmml">j</mi><mo id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.1" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.1.cmml">=</mo><mn id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.3.cmml">0</mn></mrow><msub id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.2.cmml">N</mi><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.3.cmml">i</mi></msub></msubsup><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.cmml"><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.cmml"><mo rspace="0.167em" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.1" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.1.cmml">∇</mo><msub id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.cmml"><mi mathvariant="normal" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.2.cmml">ℓ</mi><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.1" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.1.cmml">​</mo><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.3.cmml">I</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.3.cmml">​</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.3.cmml">(</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.3" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.2" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.2" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.2" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.3" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.3" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.4" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.3.cmml">,</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.2.cmml">​</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.2" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.2.cmml">𝐘</mi><mi id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.3" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.5" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mrow id="A1.E4.m1.20.20.20.5.5.5.4" xref="A1.E4.m1.20.20.20.5.5.5.4.cmml"><msubsup id="A1.E4.m1.20.20.20.5.5.5.4.1" xref="A1.E4.m1.20.20.20.5.5.5.4.1.cmml"><mo id="A1.E4.m1.20.20.20.5.5.5.4.1.2.2" xref="A1.E4.m1.20.20.20.5.5.5.4.1.2.2.cmml">∑</mo><mrow id="A1.E4.m1.20.20.20.5.5.5.4.1.3" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.4.1.3.2" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3.2.cmml">i</mi><mo id="A1.E4.m1.20.20.20.5.5.5.4.1.3.1" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3.1.cmml">=</mo><mn id="A1.E4.m1.20.20.20.5.5.5.4.1.3.3" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3.3.cmml">0</mn></mrow><mi id="A1.E4.m1.20.20.20.5.5.5.4.1.2.3" xref="A1.E4.m1.20.20.20.5.5.5.4.1.2.3.cmml">M</mi></msubsup><msub id="A1.E4.m1.20.20.20.5.5.5.4.2" xref="A1.E4.m1.20.20.20.5.5.5.4.2.cmml"><mi id="A1.E4.m1.20.20.20.5.5.5.4.2.2" xref="A1.E4.m1.20.20.20.5.5.5.4.2.2.cmml">N</mi><mi id="A1.E4.m1.20.20.20.5.5.5.4.2.3" xref="A1.E4.m1.20.20.20.5.5.5.4.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E4.m1.22b"><apply id="A1.E4.m1.21.21.1.cmml" xref="A1.E4.m1.22.22.2"><and id="A1.E4.m1.21.21.1a.cmml" xref="A1.E4.m1.22.22.2.21.16.11.12"></and><apply id="A1.E4.m1.21.21.1b.cmml" xref="A1.E4.m1.22.22.2"><eq id="A1.E4.m1.11.11.11.11.1.1.cmml" xref="A1.E4.m1.11.11.11.11.1.1"></eq><apply id="A1.E4.m1.21.21.1.1.cmml" xref="A1.E4.m1.22.22.2"><times id="A1.E4.m1.21.21.1.1.2.cmml" xref="A1.E4.m1.22.22.2.21.16.11.12"></times><apply id="A1.E4.m1.21.21.1.1.3.cmml" xref="A1.E4.m1.22.22.2"><csymbol cd="ambiguous" id="A1.E4.m1.21.21.1.1.3.1.cmml" xref="A1.E4.m1.22.22.2.21.16.11.12">subscript</csymbol><ci id="A1.E4.m1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1">Δ</ci><list id="A1.E4.m1.2.2.2.2.2.2.1.3.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2"><ci id="A1.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.1">𝑘</ci><apply id="A1.E4.m1.2.2.2.2.2.2.1.2.1.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1"><times id="A1.E4.m1.2.2.2.2.2.2.1.2.1.1.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.1"></times><ci id="A1.E4.m1.2.2.2.2.2.2.1.2.1.2.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.2">𝑓</ci><ci id="A1.E4.m1.2.2.2.2.2.2.1.2.1.3.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.3">𝑒</ci><ci id="A1.E4.m1.2.2.2.2.2.2.1.2.1.4.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.4">𝑑</ci><ci id="A1.E4.m1.2.2.2.2.2.2.1.2.1.5.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.5">𝑠</ci><ci id="A1.E4.m1.2.2.2.2.2.2.1.2.1.6.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.6">𝑔</ci><ci id="A1.E4.m1.2.2.2.2.2.2.1.2.1.7.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.2.1.7">𝑑</ci></apply></list></apply><apply id="A1.E4.m1.21.21.1.1.1.1.1.cmml" xref="A1.E4.m1.22.22.2"><csymbol cd="latexml" id="A1.E4.m1.5.5.5.5.5.5.cmml" xref="A1.E4.m1.5.5.5.5.5.5">conditional</csymbol><ci id="A1.E4.m1.4.4.4.4.4.4.cmml" xref="A1.E4.m1.4.4.4.4.4.4">𝒞</ci><list id="A1.E4.m1.21.21.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.22.22.2"><apply id="A1.E4.m1.21.21.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.22.22.2"><csymbol cd="ambiguous" id="A1.E4.m1.21.21.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.22.22.2">subscript</csymbol><ci id="A1.E4.m1.6.6.6.6.6.6.cmml" xref="A1.E4.m1.6.6.6.6.6.6">ℓ</ci><apply id="A1.E4.m1.7.7.7.7.7.7.1.cmml" xref="A1.E4.m1.7.7.7.7.7.7.1"><times id="A1.E4.m1.7.7.7.7.7.7.1.1.cmml" xref="A1.E4.m1.7.7.7.7.7.7.1.1"></times><ci id="A1.E4.m1.7.7.7.7.7.7.1.2.cmml" xref="A1.E4.m1.7.7.7.7.7.7.1.2">𝐵</ci><ci id="A1.E4.m1.7.7.7.7.7.7.1.3.cmml" xref="A1.E4.m1.7.7.7.7.7.7.1.3">𝐼</ci></apply></apply><ci id="A1.E4.m1.9.9.9.9.9.9.cmml" xref="A1.E4.m1.9.9.9.9.9.9">Θ</ci></list></apply></apply><apply id="A1.E4.m1.21.21.1.4.cmml" xref="A1.E4.m1.22.22.2"><ci id="A1.E4.m1.14.14.14.14.4.4.cmml" xref="A1.E4.m1.14.14.14.14.4.4">⋅</ci><apply id="A1.E4.m1.21.21.1.4.2.cmml" xref="A1.E4.m1.22.22.2"><csymbol cd="ambiguous" id="A1.E4.m1.21.21.1.4.2.1.cmml" xref="A1.E4.m1.22.22.2.21.16.11.12">subscript</csymbol><ci id="A1.E4.m1.12.12.12.12.2.2.cmml" xref="A1.E4.m1.12.12.12.12.2.2">𝜂</ci><list id="A1.E4.m1.13.13.13.13.3.3.1.3.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2"><ci id="A1.E4.m1.13.13.13.13.3.3.1.1.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.1">𝑠</ci><apply id="A1.E4.m1.13.13.13.13.3.3.1.2.1.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1"><times id="A1.E4.m1.13.13.13.13.3.3.1.2.1.1.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.1"></times><ci id="A1.E4.m1.13.13.13.13.3.3.1.2.1.2.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.2">𝑓</ci><ci id="A1.E4.m1.13.13.13.13.3.3.1.2.1.3.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.3">𝑒</ci><ci id="A1.E4.m1.13.13.13.13.3.3.1.2.1.4.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.4">𝑑</ci><ci id="A1.E4.m1.13.13.13.13.3.3.1.2.1.5.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.5">𝑠</ci><ci id="A1.E4.m1.13.13.13.13.3.3.1.2.1.6.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.6">𝑔</ci><ci id="A1.E4.m1.13.13.13.13.3.3.1.2.1.7.cmml" xref="A1.E4.m1.13.13.13.13.3.3.1.2.1.7">𝑑</ci></apply></list></apply><apply id="A1.E4.m1.15.15.15.15.5.5.cmml" xref="A1.E4.m1.15.15.15.15.5.5"><divide id="A1.E4.m1.15.15.15.15.5.5.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5"></divide><apply id="A1.E4.m1.15.15.15.15.5.5.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2"><apply id="A1.E4.m1.15.15.15.15.5.5.2.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1"><csymbol cd="ambiguous" id="A1.E4.m1.15.15.15.15.5.5.2.1.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1">subscript</csymbol><apply id="A1.E4.m1.15.15.15.15.5.5.2.1.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1"><csymbol cd="ambiguous" id="A1.E4.m1.15.15.15.15.5.5.2.1.2.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1">superscript</csymbol><sum id="A1.E4.m1.15.15.15.15.5.5.2.1.2.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1.2.2"></sum><ci id="A1.E4.m1.15.15.15.15.5.5.2.1.2.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1.2.3">𝑀</ci></apply><apply id="A1.E4.m1.15.15.15.15.5.5.2.1.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3"><eq id="A1.E4.m1.15.15.15.15.5.5.2.1.3.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3.1"></eq><ci id="A1.E4.m1.15.15.15.15.5.5.2.1.3.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3.2">𝑖</ci><cn type="integer" id="A1.E4.m1.15.15.15.15.5.5.2.1.3.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.1.3.3">0</cn></apply></apply><apply id="A1.E4.m1.15.15.15.15.5.5.2.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2"><ci id="A1.E4.m1.15.15.15.15.5.5.2.2.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.1">∇</ci><apply id="A1.E4.m1.15.15.15.15.5.5.2.2.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2"><csymbol cd="ambiguous" id="A1.E4.m1.15.15.15.15.5.5.2.2.2.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2">subscript</csymbol><ci id="A1.E4.m1.15.15.15.15.5.5.2.2.2.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.2">ℓ</ci><apply id="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.3"><csymbol cd="ambiguous" id="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.3">subscript</csymbol><ci id="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.2">𝐶</ci><ci id="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.2.2.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="A1.E4.m1.15.15.15.15.5.5.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3"><apply id="A1.E4.m1.15.15.15.15.5.5.3.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1"><csymbol cd="ambiguous" id="A1.E4.m1.15.15.15.15.5.5.3.1.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1">subscript</csymbol><apply id="A1.E4.m1.15.15.15.15.5.5.3.1.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1"><csymbol cd="ambiguous" id="A1.E4.m1.15.15.15.15.5.5.3.1.2.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1">superscript</csymbol><sum id="A1.E4.m1.15.15.15.15.5.5.3.1.2.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1.2.2"></sum><ci id="A1.E4.m1.15.15.15.15.5.5.3.1.2.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1.2.3">𝑀</ci></apply><apply id="A1.E4.m1.15.15.15.15.5.5.3.1.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3"><eq id="A1.E4.m1.15.15.15.15.5.5.3.1.3.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3.1"></eq><ci id="A1.E4.m1.15.15.15.15.5.5.3.1.3.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3.2">𝑖</ci><cn type="integer" id="A1.E4.m1.15.15.15.15.5.5.3.1.3.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.1.3.3">0</cn></apply></apply><apply id="A1.E4.m1.15.15.15.15.5.5.3.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.2"><csymbol cd="ambiguous" id="A1.E4.m1.15.15.15.15.5.5.3.2.1.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.2">subscript</csymbol><ci id="A1.E4.m1.15.15.15.15.5.5.3.2.2.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.2.2">𝑁</ci><ci id="A1.E4.m1.15.15.15.15.5.5.3.2.3.cmml" xref="A1.E4.m1.15.15.15.15.5.5.3.2.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="A1.E4.m1.21.21.1c.cmml" xref="A1.E4.m1.22.22.2"><eq id="A1.E4.m1.16.16.16.1.1.1.cmml" xref="A1.E4.m1.16.16.16.1.1.1"></eq><share href="#A1.E4.m1.21.21.1.4.cmml" id="A1.E4.m1.21.21.1d.cmml" xref="A1.E4.m1.22.22.2.21.16.11.12"></share><apply id="A1.E4.m1.21.21.1.6.cmml" xref="A1.E4.m1.22.22.2"><ci id="A1.E4.m1.19.19.19.4.4.4.cmml" xref="A1.E4.m1.19.19.19.4.4.4">⋅</ci><apply id="A1.E4.m1.21.21.1.6.2.cmml" xref="A1.E4.m1.22.22.2"><csymbol cd="ambiguous" id="A1.E4.m1.21.21.1.6.2.1.cmml" xref="A1.E4.m1.22.22.2.21.16.11.12">subscript</csymbol><ci id="A1.E4.m1.17.17.17.2.2.2.cmml" xref="A1.E4.m1.17.17.17.2.2.2">𝜂</ci><list id="A1.E4.m1.18.18.18.3.3.3.1.3.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2"><ci id="A1.E4.m1.18.18.18.3.3.3.1.1.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.1">𝑠</ci><apply id="A1.E4.m1.18.18.18.3.3.3.1.2.1.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1"><times id="A1.E4.m1.18.18.18.3.3.3.1.2.1.1.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.1"></times><ci id="A1.E4.m1.18.18.18.3.3.3.1.2.1.2.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.2">𝑓</ci><ci id="A1.E4.m1.18.18.18.3.3.3.1.2.1.3.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.3">𝑒</ci><ci id="A1.E4.m1.18.18.18.3.3.3.1.2.1.4.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.4">𝑑</ci><ci id="A1.E4.m1.18.18.18.3.3.3.1.2.1.5.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.5">𝑠</ci><ci id="A1.E4.m1.18.18.18.3.3.3.1.2.1.6.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.6">𝑔</ci><ci id="A1.E4.m1.18.18.18.3.3.3.1.2.1.7.cmml" xref="A1.E4.m1.18.18.18.3.3.3.1.2.1.7">𝑑</ci></apply></list></apply><apply id="A1.E4.m1.20.20.20.5.5.5.cmml" xref="A1.E4.m1.20.20.20.5.5.5"><divide id="A1.E4.m1.20.20.20.5.5.5.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5"></divide><apply id="A1.E4.m1.20.20.20.5.5.5.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2"><apply id="A1.E4.m1.20.20.20.5.5.5.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.2.3.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3">subscript</csymbol><apply id="A1.E4.m1.20.20.20.5.5.5.2.3.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.2.3.2.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3">superscript</csymbol><sum id="A1.E4.m1.20.20.20.5.5.5.2.3.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3.2.2"></sum><ci id="A1.E4.m1.20.20.20.5.5.5.2.3.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3.2.3">𝑀</ci></apply><apply id="A1.E4.m1.20.20.20.5.5.5.2.3.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3"><eq id="A1.E4.m1.20.20.20.5.5.5.2.3.3.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3.1"></eq><ci id="A1.E4.m1.20.20.20.5.5.5.2.3.3.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3.2">𝑖</ci><cn type="integer" id="A1.E4.m1.20.20.20.5.5.5.2.3.3.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.3.3.3">0</cn></apply></apply><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2"><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.2.2.3.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3">subscript</csymbol><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3">superscript</csymbol><sum id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.2"></sum><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3">subscript</csymbol><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.2">𝑁</ci><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3"><eq id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.1"></eq><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.2">𝑗</ci><cn type="integer" id="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.3.3.3">0</cn></apply></apply><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2"><times id="A1.E4.m1.20.20.20.5.5.5.2.2.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.3"></times><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4"><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.1">∇</ci><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2">subscript</csymbol><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.2">ℓ</ci><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3"><times id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.1"></times><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.2">𝐵</ci><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.4.2.3.3">𝐼</ci></apply></apply></apply><interval closure="open" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2"><apply id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1"><times id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.2"></times><ci id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.3">𝑓</ci><apply id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2"><times id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.2"></times><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.3">𝑔</ci><apply id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.2">𝐘</ci><ci id="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.2.2.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></interval></apply></apply></apply><apply id="A1.E4.m1.20.20.20.5.5.5.4.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4"><apply id="A1.E4.m1.20.20.20.5.5.5.4.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.4.1.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1">subscript</csymbol><apply id="A1.E4.m1.20.20.20.5.5.5.4.1.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.4.1.2.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1">superscript</csymbol><sum id="A1.E4.m1.20.20.20.5.5.5.4.1.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1.2.2"></sum><ci id="A1.E4.m1.20.20.20.5.5.5.4.1.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1.2.3">𝑀</ci></apply><apply id="A1.E4.m1.20.20.20.5.5.5.4.1.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3"><eq id="A1.E4.m1.20.20.20.5.5.5.4.1.3.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3.1"></eq><ci id="A1.E4.m1.20.20.20.5.5.5.4.1.3.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3.2">𝑖</ci><cn type="integer" id="A1.E4.m1.20.20.20.5.5.5.4.1.3.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.1.3.3">0</cn></apply></apply><apply id="A1.E4.m1.20.20.20.5.5.5.4.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.2"><csymbol cd="ambiguous" id="A1.E4.m1.20.20.20.5.5.5.4.2.1.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.2">subscript</csymbol><ci id="A1.E4.m1.20.20.20.5.5.5.4.2.2.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.2.2">𝑁</ci><ci id="A1.E4.m1.20.20.20.5.5.5.4.2.3.cmml" xref="A1.E4.m1.20.20.20.5.5.5.4.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E4.m1.22c">\displaystyle\begin{split}\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)&amp;=\eta_{s,fedsgd}\cdot\frac{\sum^{M}_{i=0}\nabla\ell_{C_{i}}}{\sum^{M}_{i=0}N_{i}}\\
&amp;=\eta_{s,fedsgd}\cdot\frac{\sum^{M}_{i=0}\sum^{N_{i}}_{j=0}\nabla\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))}{\sum^{M}_{i=0}N_{i}}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.4.p4" class="ltx_para ltx_noindent">
<p id="A1.4.p4.3" class="ltx_p">Let <math id="A1.4.p4.1.m1.1" class="ltx_Math" alttext="N_{\mathcal{E}}" display="inline"><semantics id="A1.4.p4.1.m1.1a"><msub id="A1.4.p4.1.m1.1.1" xref="A1.4.p4.1.m1.1.1.cmml"><mi id="A1.4.p4.1.m1.1.1.2" xref="A1.4.p4.1.m1.1.1.2.cmml">N</mi><mi class="ltx_font_mathcaligraphic" id="A1.4.p4.1.m1.1.1.3" xref="A1.4.p4.1.m1.1.1.3.cmml">ℰ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.4.p4.1.m1.1b"><apply id="A1.4.p4.1.m1.1.1.cmml" xref="A1.4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.4.p4.1.m1.1.1.1.cmml" xref="A1.4.p4.1.m1.1.1">subscript</csymbol><ci id="A1.4.p4.1.m1.1.1.2.cmml" xref="A1.4.p4.1.m1.1.1.2">𝑁</ci><ci id="A1.4.p4.1.m1.1.1.3.cmml" xref="A1.4.p4.1.m1.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.4.p4.1.m1.1c">N_{\mathcal{E}}</annotation></semantics></math> be the number of total examples in <math id="A1.4.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="A1.4.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A1.4.p4.2.m2.1.1" xref="A1.4.p4.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="A1.4.p4.2.m2.1b"><ci id="A1.4.p4.2.m2.1.1.cmml" xref="A1.4.p4.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.4.p4.2.m2.1c">\mathcal{E}</annotation></semantics></math>, we have <math id="A1.4.p4.3.m3.1" class="ltx_Math" alttext="N_{\mathcal{E}}=\sum^{M}_{i=0}N_{i}" display="inline"><semantics id="A1.4.p4.3.m3.1a"><mrow id="A1.4.p4.3.m3.1.1" xref="A1.4.p4.3.m3.1.1.cmml"><msub id="A1.4.p4.3.m3.1.1.2" xref="A1.4.p4.3.m3.1.1.2.cmml"><mi id="A1.4.p4.3.m3.1.1.2.2" xref="A1.4.p4.3.m3.1.1.2.2.cmml">N</mi><mi class="ltx_font_mathcaligraphic" id="A1.4.p4.3.m3.1.1.2.3" xref="A1.4.p4.3.m3.1.1.2.3.cmml">ℰ</mi></msub><mo rspace="0.111em" id="A1.4.p4.3.m3.1.1.1" xref="A1.4.p4.3.m3.1.1.1.cmml">=</mo><mrow id="A1.4.p4.3.m3.1.1.3" xref="A1.4.p4.3.m3.1.1.3.cmml"><msubsup id="A1.4.p4.3.m3.1.1.3.1" xref="A1.4.p4.3.m3.1.1.3.1.cmml"><mo id="A1.4.p4.3.m3.1.1.3.1.2.2" xref="A1.4.p4.3.m3.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.4.p4.3.m3.1.1.3.1.3" xref="A1.4.p4.3.m3.1.1.3.1.3.cmml"><mi id="A1.4.p4.3.m3.1.1.3.1.3.2" xref="A1.4.p4.3.m3.1.1.3.1.3.2.cmml">i</mi><mo id="A1.4.p4.3.m3.1.1.3.1.3.1" xref="A1.4.p4.3.m3.1.1.3.1.3.1.cmml">=</mo><mn id="A1.4.p4.3.m3.1.1.3.1.3.3" xref="A1.4.p4.3.m3.1.1.3.1.3.3.cmml">0</mn></mrow><mi id="A1.4.p4.3.m3.1.1.3.1.2.3" xref="A1.4.p4.3.m3.1.1.3.1.2.3.cmml">M</mi></msubsup><msub id="A1.4.p4.3.m3.1.1.3.2" xref="A1.4.p4.3.m3.1.1.3.2.cmml"><mi id="A1.4.p4.3.m3.1.1.3.2.2" xref="A1.4.p4.3.m3.1.1.3.2.2.cmml">N</mi><mi id="A1.4.p4.3.m3.1.1.3.2.3" xref="A1.4.p4.3.m3.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.4.p4.3.m3.1b"><apply id="A1.4.p4.3.m3.1.1.cmml" xref="A1.4.p4.3.m3.1.1"><eq id="A1.4.p4.3.m3.1.1.1.cmml" xref="A1.4.p4.3.m3.1.1.1"></eq><apply id="A1.4.p4.3.m3.1.1.2.cmml" xref="A1.4.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.4.p4.3.m3.1.1.2.1.cmml" xref="A1.4.p4.3.m3.1.1.2">subscript</csymbol><ci id="A1.4.p4.3.m3.1.1.2.2.cmml" xref="A1.4.p4.3.m3.1.1.2.2">𝑁</ci><ci id="A1.4.p4.3.m3.1.1.2.3.cmml" xref="A1.4.p4.3.m3.1.1.2.3">ℰ</ci></apply><apply id="A1.4.p4.3.m3.1.1.3.cmml" xref="A1.4.p4.3.m3.1.1.3"><apply id="A1.4.p4.3.m3.1.1.3.1.cmml" xref="A1.4.p4.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="A1.4.p4.3.m3.1.1.3.1.1.cmml" xref="A1.4.p4.3.m3.1.1.3.1">subscript</csymbol><apply id="A1.4.p4.3.m3.1.1.3.1.2.cmml" xref="A1.4.p4.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="A1.4.p4.3.m3.1.1.3.1.2.1.cmml" xref="A1.4.p4.3.m3.1.1.3.1">superscript</csymbol><sum id="A1.4.p4.3.m3.1.1.3.1.2.2.cmml" xref="A1.4.p4.3.m3.1.1.3.1.2.2"></sum><ci id="A1.4.p4.3.m3.1.1.3.1.2.3.cmml" xref="A1.4.p4.3.m3.1.1.3.1.2.3">𝑀</ci></apply><apply id="A1.4.p4.3.m3.1.1.3.1.3.cmml" xref="A1.4.p4.3.m3.1.1.3.1.3"><eq id="A1.4.p4.3.m3.1.1.3.1.3.1.cmml" xref="A1.4.p4.3.m3.1.1.3.1.3.1"></eq><ci id="A1.4.p4.3.m3.1.1.3.1.3.2.cmml" xref="A1.4.p4.3.m3.1.1.3.1.3.2">𝑖</ci><cn type="integer" id="A1.4.p4.3.m3.1.1.3.1.3.3.cmml" xref="A1.4.p4.3.m3.1.1.3.1.3.3">0</cn></apply></apply><apply id="A1.4.p4.3.m3.1.1.3.2.cmml" xref="A1.4.p4.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="A1.4.p4.3.m3.1.1.3.2.1.cmml" xref="A1.4.p4.3.m3.1.1.3.2">subscript</csymbol><ci id="A1.4.p4.3.m3.1.1.3.2.2.cmml" xref="A1.4.p4.3.m3.1.1.3.2.2">𝑁</ci><ci id="A1.4.p4.3.m3.1.1.3.2.3.cmml" xref="A1.4.p4.3.m3.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.4.p4.3.m3.1c">N_{\mathcal{E}}=\sum^{M}_{i=0}N_{i}</annotation></semantics></math>. Then the server model update becomes</p>
<table id="A1.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E5.m1.8" class="ltx_Math" alttext="\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)=\eta_{s,fedsgd}\cdot\frac{1}{N_{\mathcal{E}}}\sum^{N_{\mathcal{E}}}_{i=0}\nabla\ell_{BI}(f(\mathbf{X}_{i}),g(\mathbf{Y}_{i}))" display="block"><semantics id="A1.E5.m1.8a"><mrow id="A1.E5.m1.8.8" xref="A1.E5.m1.8.8.cmml"><mrow id="A1.E5.m1.6.6.1" xref="A1.E5.m1.6.6.1.cmml"><msub id="A1.E5.m1.6.6.1.3" xref="A1.E5.m1.6.6.1.3.cmml"><mi mathvariant="normal" id="A1.E5.m1.6.6.1.3.2" xref="A1.E5.m1.6.6.1.3.2.cmml">Δ</mi><mrow id="A1.E5.m1.2.2.2.2" xref="A1.E5.m1.2.2.2.3.cmml"><mi id="A1.E5.m1.1.1.1.1" xref="A1.E5.m1.1.1.1.1.cmml">k</mi><mo id="A1.E5.m1.2.2.2.2.2" xref="A1.E5.m1.2.2.2.3.cmml">,</mo><mrow id="A1.E5.m1.2.2.2.2.1" xref="A1.E5.m1.2.2.2.2.1.cmml"><mi id="A1.E5.m1.2.2.2.2.1.2" xref="A1.E5.m1.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.2.2.2.2.1.1" xref="A1.E5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.2.2.2.2.1.3" xref="A1.E5.m1.2.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.2.2.2.2.1.1a" xref="A1.E5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.2.2.2.2.1.4" xref="A1.E5.m1.2.2.2.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.2.2.2.2.1.1b" xref="A1.E5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.2.2.2.2.1.5" xref="A1.E5.m1.2.2.2.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.2.2.2.2.1.1c" xref="A1.E5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.2.2.2.2.1.6" xref="A1.E5.m1.2.2.2.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.2.2.2.2.1.1d" xref="A1.E5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.2.2.2.2.1.7" xref="A1.E5.m1.2.2.2.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E5.m1.6.6.1.2" xref="A1.E5.m1.6.6.1.2.cmml">​</mo><mrow id="A1.E5.m1.6.6.1.1.1" xref="A1.E5.m1.6.6.1.1.1.1.cmml"><mo stretchy="false" id="A1.E5.m1.6.6.1.1.1.2" xref="A1.E5.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A1.E5.m1.6.6.1.1.1.1" xref="A1.E5.m1.6.6.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.6.6.1.1.1.1.3" xref="A1.E5.m1.6.6.1.1.1.1.3.cmml">𝒞</mi><mo fence="false" id="A1.E5.m1.6.6.1.1.1.1.2" xref="A1.E5.m1.6.6.1.1.1.1.2.cmml">|</mo><mrow id="A1.E5.m1.6.6.1.1.1.1.1.1" xref="A1.E5.m1.6.6.1.1.1.1.1.2.cmml"><msub id="A1.E5.m1.6.6.1.1.1.1.1.1.1" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A1.E5.m1.6.6.1.1.1.1.1.1.1.2" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.2.cmml">ℓ</mi><mrow id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.2" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.1" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.3" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.3.cmml">I</mi></mrow></msub><mo id="A1.E5.m1.6.6.1.1.1.1.1.1.2" xref="A1.E5.m1.6.6.1.1.1.1.1.2.cmml">,</mo><mi mathvariant="normal" id="A1.E5.m1.5.5" xref="A1.E5.m1.5.5.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="A1.E5.m1.6.6.1.1.1.3" xref="A1.E5.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.8.8.4" xref="A1.E5.m1.8.8.4.cmml">=</mo><mrow id="A1.E5.m1.8.8.3" xref="A1.E5.m1.8.8.3.cmml"><mrow id="A1.E5.m1.8.8.3.4" xref="A1.E5.m1.8.8.3.4.cmml"><msub id="A1.E5.m1.8.8.3.4.2" xref="A1.E5.m1.8.8.3.4.2.cmml"><mi id="A1.E5.m1.8.8.3.4.2.2" xref="A1.E5.m1.8.8.3.4.2.2.cmml">η</mi><mrow id="A1.E5.m1.4.4.2.2" xref="A1.E5.m1.4.4.2.3.cmml"><mi id="A1.E5.m1.3.3.1.1" xref="A1.E5.m1.3.3.1.1.cmml">s</mi><mo id="A1.E5.m1.4.4.2.2.2" xref="A1.E5.m1.4.4.2.3.cmml">,</mo><mrow id="A1.E5.m1.4.4.2.2.1" xref="A1.E5.m1.4.4.2.2.1.cmml"><mi id="A1.E5.m1.4.4.2.2.1.2" xref="A1.E5.m1.4.4.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.4.4.2.2.1.1" xref="A1.E5.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.4.4.2.2.1.3" xref="A1.E5.m1.4.4.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.4.4.2.2.1.1a" xref="A1.E5.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.4.4.2.2.1.4" xref="A1.E5.m1.4.4.2.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.4.4.2.2.1.1b" xref="A1.E5.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.4.4.2.2.1.5" xref="A1.E5.m1.4.4.2.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.4.4.2.2.1.1c" xref="A1.E5.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.4.4.2.2.1.6" xref="A1.E5.m1.4.4.2.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.4.4.2.2.1.1d" xref="A1.E5.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.E5.m1.4.4.2.2.1.7" xref="A1.E5.m1.4.4.2.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E5.m1.8.8.3.4.1" xref="A1.E5.m1.8.8.3.4.1.cmml">⋅</mo><mfrac id="A1.E5.m1.8.8.3.4.3" xref="A1.E5.m1.8.8.3.4.3.cmml"><mn id="A1.E5.m1.8.8.3.4.3.2" xref="A1.E5.m1.8.8.3.4.3.2.cmml">1</mn><msub id="A1.E5.m1.8.8.3.4.3.3" xref="A1.E5.m1.8.8.3.4.3.3.cmml"><mi id="A1.E5.m1.8.8.3.4.3.3.2" xref="A1.E5.m1.8.8.3.4.3.3.2.cmml">N</mi><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.8.8.3.4.3.3.3" xref="A1.E5.m1.8.8.3.4.3.3.3.cmml">ℰ</mi></msub></mfrac></mrow><mo lspace="0em" rspace="0em" id="A1.E5.m1.8.8.3.3" xref="A1.E5.m1.8.8.3.3.cmml">​</mo><mrow id="A1.E5.m1.8.8.3.2" xref="A1.E5.m1.8.8.3.2.cmml"><munderover id="A1.E5.m1.8.8.3.2.3" xref="A1.E5.m1.8.8.3.2.3.cmml"><mo movablelimits="false" id="A1.E5.m1.8.8.3.2.3.2.2" xref="A1.E5.m1.8.8.3.2.3.2.2.cmml">∑</mo><mrow id="A1.E5.m1.8.8.3.2.3.3" xref="A1.E5.m1.8.8.3.2.3.3.cmml"><mi id="A1.E5.m1.8.8.3.2.3.3.2" xref="A1.E5.m1.8.8.3.2.3.3.2.cmml">i</mi><mo id="A1.E5.m1.8.8.3.2.3.3.1" xref="A1.E5.m1.8.8.3.2.3.3.1.cmml">=</mo><mn id="A1.E5.m1.8.8.3.2.3.3.3" xref="A1.E5.m1.8.8.3.2.3.3.3.cmml">0</mn></mrow><msub id="A1.E5.m1.8.8.3.2.3.2.3" xref="A1.E5.m1.8.8.3.2.3.2.3.cmml"><mi id="A1.E5.m1.8.8.3.2.3.2.3.2" xref="A1.E5.m1.8.8.3.2.3.2.3.2.cmml">N</mi><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.8.8.3.2.3.2.3.3" xref="A1.E5.m1.8.8.3.2.3.2.3.3.cmml">ℰ</mi></msub></munderover><mrow id="A1.E5.m1.8.8.3.2.2" xref="A1.E5.m1.8.8.3.2.2.cmml"><mrow id="A1.E5.m1.8.8.3.2.2.4" xref="A1.E5.m1.8.8.3.2.2.4.cmml"><mo rspace="0.167em" id="A1.E5.m1.8.8.3.2.2.4.1" xref="A1.E5.m1.8.8.3.2.2.4.1.cmml">∇</mo><msub id="A1.E5.m1.8.8.3.2.2.4.2" xref="A1.E5.m1.8.8.3.2.2.4.2.cmml"><mi mathvariant="normal" id="A1.E5.m1.8.8.3.2.2.4.2.2" xref="A1.E5.m1.8.8.3.2.2.4.2.2.cmml">ℓ</mi><mrow id="A1.E5.m1.8.8.3.2.2.4.2.3" xref="A1.E5.m1.8.8.3.2.2.4.2.3.cmml"><mi id="A1.E5.m1.8.8.3.2.2.4.2.3.2" xref="A1.E5.m1.8.8.3.2.2.4.2.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.8.8.3.2.2.4.2.3.1" xref="A1.E5.m1.8.8.3.2.2.4.2.3.1.cmml">​</mo><mi id="A1.E5.m1.8.8.3.2.2.4.2.3.3" xref="A1.E5.m1.8.8.3.2.2.4.2.3.3.cmml">I</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A1.E5.m1.8.8.3.2.2.3" xref="A1.E5.m1.8.8.3.2.2.3.cmml">​</mo><mrow id="A1.E5.m1.8.8.3.2.2.2.2" xref="A1.E5.m1.8.8.3.2.2.2.3.cmml"><mo stretchy="false" id="A1.E5.m1.8.8.3.2.2.2.2.3" xref="A1.E5.m1.8.8.3.2.2.2.3.cmml">(</mo><mrow id="A1.E5.m1.7.7.2.1.1.1.1.1" xref="A1.E5.m1.7.7.2.1.1.1.1.1.cmml"><mi id="A1.E5.m1.7.7.2.1.1.1.1.1.3" xref="A1.E5.m1.7.7.2.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.7.7.2.1.1.1.1.1.2" xref="A1.E5.m1.7.7.2.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.2" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.2" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.3" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.3" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.8.8.3.2.2.2.2.4" xref="A1.E5.m1.8.8.3.2.2.2.3.cmml">,</mo><mrow id="A1.E5.m1.8.8.3.2.2.2.2.2" xref="A1.E5.m1.8.8.3.2.2.2.2.2.cmml"><mi id="A1.E5.m1.8.8.3.2.2.2.2.2.3" xref="A1.E5.m1.8.8.3.2.2.2.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E5.m1.8.8.3.2.2.2.2.2.2" xref="A1.E5.m1.8.8.3.2.2.2.2.2.2.cmml">​</mo><mrow id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.2" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.2" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.2.cmml">𝐘</mi><mi id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.3" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.3" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E5.m1.8.8.3.2.2.2.2.5" xref="A1.E5.m1.8.8.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.8b"><apply id="A1.E5.m1.8.8.cmml" xref="A1.E5.m1.8.8"><eq id="A1.E5.m1.8.8.4.cmml" xref="A1.E5.m1.8.8.4"></eq><apply id="A1.E5.m1.6.6.1.cmml" xref="A1.E5.m1.6.6.1"><times id="A1.E5.m1.6.6.1.2.cmml" xref="A1.E5.m1.6.6.1.2"></times><apply id="A1.E5.m1.6.6.1.3.cmml" xref="A1.E5.m1.6.6.1.3"><csymbol cd="ambiguous" id="A1.E5.m1.6.6.1.3.1.cmml" xref="A1.E5.m1.6.6.1.3">subscript</csymbol><ci id="A1.E5.m1.6.6.1.3.2.cmml" xref="A1.E5.m1.6.6.1.3.2">Δ</ci><list id="A1.E5.m1.2.2.2.3.cmml" xref="A1.E5.m1.2.2.2.2"><ci id="A1.E5.m1.1.1.1.1.cmml" xref="A1.E5.m1.1.1.1.1">𝑘</ci><apply id="A1.E5.m1.2.2.2.2.1.cmml" xref="A1.E5.m1.2.2.2.2.1"><times id="A1.E5.m1.2.2.2.2.1.1.cmml" xref="A1.E5.m1.2.2.2.2.1.1"></times><ci id="A1.E5.m1.2.2.2.2.1.2.cmml" xref="A1.E5.m1.2.2.2.2.1.2">𝑓</ci><ci id="A1.E5.m1.2.2.2.2.1.3.cmml" xref="A1.E5.m1.2.2.2.2.1.3">𝑒</ci><ci id="A1.E5.m1.2.2.2.2.1.4.cmml" xref="A1.E5.m1.2.2.2.2.1.4">𝑑</ci><ci id="A1.E5.m1.2.2.2.2.1.5.cmml" xref="A1.E5.m1.2.2.2.2.1.5">𝑠</ci><ci id="A1.E5.m1.2.2.2.2.1.6.cmml" xref="A1.E5.m1.2.2.2.2.1.6">𝑔</ci><ci id="A1.E5.m1.2.2.2.2.1.7.cmml" xref="A1.E5.m1.2.2.2.2.1.7">𝑑</ci></apply></list></apply><apply id="A1.E5.m1.6.6.1.1.1.1.cmml" xref="A1.E5.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.E5.m1.6.6.1.1.1.1.2.cmml" xref="A1.E5.m1.6.6.1.1.1.1.2">conditional</csymbol><ci id="A1.E5.m1.6.6.1.1.1.1.3.cmml" xref="A1.E5.m1.6.6.1.1.1.1.3">𝒞</ci><list id="A1.E5.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1"><apply id="A1.E5.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E5.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.2">ℓ</ci><apply id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3"><times id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.1"></times><ci id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.2">𝐵</ci><ci id="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E5.m1.6.6.1.1.1.1.1.1.1.3.3">𝐼</ci></apply></apply><ci id="A1.E5.m1.5.5.cmml" xref="A1.E5.m1.5.5">Θ</ci></list></apply></apply><apply id="A1.E5.m1.8.8.3.cmml" xref="A1.E5.m1.8.8.3"><times id="A1.E5.m1.8.8.3.3.cmml" xref="A1.E5.m1.8.8.3.3"></times><apply id="A1.E5.m1.8.8.3.4.cmml" xref="A1.E5.m1.8.8.3.4"><ci id="A1.E5.m1.8.8.3.4.1.cmml" xref="A1.E5.m1.8.8.3.4.1">⋅</ci><apply id="A1.E5.m1.8.8.3.4.2.cmml" xref="A1.E5.m1.8.8.3.4.2"><csymbol cd="ambiguous" id="A1.E5.m1.8.8.3.4.2.1.cmml" xref="A1.E5.m1.8.8.3.4.2">subscript</csymbol><ci id="A1.E5.m1.8.8.3.4.2.2.cmml" xref="A1.E5.m1.8.8.3.4.2.2">𝜂</ci><list id="A1.E5.m1.4.4.2.3.cmml" xref="A1.E5.m1.4.4.2.2"><ci id="A1.E5.m1.3.3.1.1.cmml" xref="A1.E5.m1.3.3.1.1">𝑠</ci><apply id="A1.E5.m1.4.4.2.2.1.cmml" xref="A1.E5.m1.4.4.2.2.1"><times id="A1.E5.m1.4.4.2.2.1.1.cmml" xref="A1.E5.m1.4.4.2.2.1.1"></times><ci id="A1.E5.m1.4.4.2.2.1.2.cmml" xref="A1.E5.m1.4.4.2.2.1.2">𝑓</ci><ci id="A1.E5.m1.4.4.2.2.1.3.cmml" xref="A1.E5.m1.4.4.2.2.1.3">𝑒</ci><ci id="A1.E5.m1.4.4.2.2.1.4.cmml" xref="A1.E5.m1.4.4.2.2.1.4">𝑑</ci><ci id="A1.E5.m1.4.4.2.2.1.5.cmml" xref="A1.E5.m1.4.4.2.2.1.5">𝑠</ci><ci id="A1.E5.m1.4.4.2.2.1.6.cmml" xref="A1.E5.m1.4.4.2.2.1.6">𝑔</ci><ci id="A1.E5.m1.4.4.2.2.1.7.cmml" xref="A1.E5.m1.4.4.2.2.1.7">𝑑</ci></apply></list></apply><apply id="A1.E5.m1.8.8.3.4.3.cmml" xref="A1.E5.m1.8.8.3.4.3"><divide id="A1.E5.m1.8.8.3.4.3.1.cmml" xref="A1.E5.m1.8.8.3.4.3"></divide><cn type="integer" id="A1.E5.m1.8.8.3.4.3.2.cmml" xref="A1.E5.m1.8.8.3.4.3.2">1</cn><apply id="A1.E5.m1.8.8.3.4.3.3.cmml" xref="A1.E5.m1.8.8.3.4.3.3"><csymbol cd="ambiguous" id="A1.E5.m1.8.8.3.4.3.3.1.cmml" xref="A1.E5.m1.8.8.3.4.3.3">subscript</csymbol><ci id="A1.E5.m1.8.8.3.4.3.3.2.cmml" xref="A1.E5.m1.8.8.3.4.3.3.2">𝑁</ci><ci id="A1.E5.m1.8.8.3.4.3.3.3.cmml" xref="A1.E5.m1.8.8.3.4.3.3.3">ℰ</ci></apply></apply></apply><apply id="A1.E5.m1.8.8.3.2.cmml" xref="A1.E5.m1.8.8.3.2"><apply id="A1.E5.m1.8.8.3.2.3.cmml" xref="A1.E5.m1.8.8.3.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.8.8.3.2.3.1.cmml" xref="A1.E5.m1.8.8.3.2.3">subscript</csymbol><apply id="A1.E5.m1.8.8.3.2.3.2.cmml" xref="A1.E5.m1.8.8.3.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.8.8.3.2.3.2.1.cmml" xref="A1.E5.m1.8.8.3.2.3">superscript</csymbol><sum id="A1.E5.m1.8.8.3.2.3.2.2.cmml" xref="A1.E5.m1.8.8.3.2.3.2.2"></sum><apply id="A1.E5.m1.8.8.3.2.3.2.3.cmml" xref="A1.E5.m1.8.8.3.2.3.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.8.8.3.2.3.2.3.1.cmml" xref="A1.E5.m1.8.8.3.2.3.2.3">subscript</csymbol><ci id="A1.E5.m1.8.8.3.2.3.2.3.2.cmml" xref="A1.E5.m1.8.8.3.2.3.2.3.2">𝑁</ci><ci id="A1.E5.m1.8.8.3.2.3.2.3.3.cmml" xref="A1.E5.m1.8.8.3.2.3.2.3.3">ℰ</ci></apply></apply><apply id="A1.E5.m1.8.8.3.2.3.3.cmml" xref="A1.E5.m1.8.8.3.2.3.3"><eq id="A1.E5.m1.8.8.3.2.3.3.1.cmml" xref="A1.E5.m1.8.8.3.2.3.3.1"></eq><ci id="A1.E5.m1.8.8.3.2.3.3.2.cmml" xref="A1.E5.m1.8.8.3.2.3.3.2">𝑖</ci><cn type="integer" id="A1.E5.m1.8.8.3.2.3.3.3.cmml" xref="A1.E5.m1.8.8.3.2.3.3.3">0</cn></apply></apply><apply id="A1.E5.m1.8.8.3.2.2.cmml" xref="A1.E5.m1.8.8.3.2.2"><times id="A1.E5.m1.8.8.3.2.2.3.cmml" xref="A1.E5.m1.8.8.3.2.2.3"></times><apply id="A1.E5.m1.8.8.3.2.2.4.cmml" xref="A1.E5.m1.8.8.3.2.2.4"><ci id="A1.E5.m1.8.8.3.2.2.4.1.cmml" xref="A1.E5.m1.8.8.3.2.2.4.1">∇</ci><apply id="A1.E5.m1.8.8.3.2.2.4.2.cmml" xref="A1.E5.m1.8.8.3.2.2.4.2"><csymbol cd="ambiguous" id="A1.E5.m1.8.8.3.2.2.4.2.1.cmml" xref="A1.E5.m1.8.8.3.2.2.4.2">subscript</csymbol><ci id="A1.E5.m1.8.8.3.2.2.4.2.2.cmml" xref="A1.E5.m1.8.8.3.2.2.4.2.2">ℓ</ci><apply id="A1.E5.m1.8.8.3.2.2.4.2.3.cmml" xref="A1.E5.m1.8.8.3.2.2.4.2.3"><times id="A1.E5.m1.8.8.3.2.2.4.2.3.1.cmml" xref="A1.E5.m1.8.8.3.2.2.4.2.3.1"></times><ci id="A1.E5.m1.8.8.3.2.2.4.2.3.2.cmml" xref="A1.E5.m1.8.8.3.2.2.4.2.3.2">𝐵</ci><ci id="A1.E5.m1.8.8.3.2.2.4.2.3.3.cmml" xref="A1.E5.m1.8.8.3.2.2.4.2.3.3">𝐼</ci></apply></apply></apply><interval closure="open" id="A1.E5.m1.8.8.3.2.2.2.3.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2"><apply id="A1.E5.m1.7.7.2.1.1.1.1.1.cmml" xref="A1.E5.m1.7.7.2.1.1.1.1.1"><times id="A1.E5.m1.7.7.2.1.1.1.1.1.2.cmml" xref="A1.E5.m1.7.7.2.1.1.1.1.1.2"></times><ci id="A1.E5.m1.7.7.2.1.1.1.1.1.3.cmml" xref="A1.E5.m1.7.7.2.1.1.1.1.1.3">𝑓</ci><apply id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E5.m1.7.7.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E5.m1.8.8.3.2.2.2.2.2.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2.2"><times id="A1.E5.m1.8.8.3.2.2.2.2.2.2.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2.2.2"></times><ci id="A1.E5.m1.8.8.3.2.2.2.2.2.3.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2.2.3">𝑔</ci><apply id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.2">𝐘</ci><ci id="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E5.m1.8.8.3.2.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.8c">\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)=\eta_{s,fedsgd}\cdot\frac{1}{N_{\mathcal{E}}}\sum^{N_{\mathcal{E}}}_{i=0}\nabla\ell_{BI}(f(\mathbf{X}_{i}),g(\mathbf{Y}_{i}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.5.p5" class="ltx_para ltx_noindent">
<p id="A1.5.p5.1" class="ltx_p">For centralized training with SGD with all examples in <math id="A1.5.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="A1.5.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.5.p5.1.m1.1.1" xref="A1.5.p5.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="A1.5.p5.1.m1.1b"><ci id="A1.5.p5.1.m1.1.1.cmml" xref="A1.5.p5.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.5.p5.1.m1.1c">\mathcal{E}</annotation></semantics></math> in a batch, the model update at step k is</p>
<table id="A1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="A1.E6.m1.68" class="ltx_Math" alttext="\displaystyle\begin{split}\Delta_{k,sgd}(\mathcal{E}|\ell_{BI},\Theta)&amp;=\eta_{s,sgd}\cdot\nabla\frac{1}{N_{\mathcal{E}}}\sum^{N_{\mathcal{E}}}_{i=0}\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\\
&amp;=\eta_{s,sgd}\cdot\frac{1}{N_{E}}\sum^{N_{\mathcal{E}}}_{i=0}\nabla\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\end{split}" display="inline"><semantics id="A1.E6.m1.68a"><mtable columnspacing="0pt" rowspacing="0pt" id="A1.E6.m1.68.68.10" xref="A1.E6.m1.63.63.5.cmml"><mtr id="A1.E6.m1.68.68.10a" xref="A1.E6.m1.63.63.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E6.m1.68.68.10b" xref="A1.E6.m1.63.63.5.cmml"><mrow id="A1.E6.m1.64.64.6.59.35.11" xref="A1.E6.m1.63.63.5.cmml"><msub id="A1.E6.m1.64.64.6.59.35.11.13" xref="A1.E6.m1.63.63.5.cmml"><mi mathvariant="normal" id="A1.E6.m1.1.1.1.1.1.1" xref="A1.E6.m1.1.1.1.1.1.1.cmml">Δ</mi><mrow id="A1.E6.m1.2.2.2.2.2.2.1.2" xref="A1.E6.m1.2.2.2.2.2.2.1.3.cmml"><mi id="A1.E6.m1.2.2.2.2.2.2.1.1" xref="A1.E6.m1.2.2.2.2.2.2.1.1.cmml">k</mi><mo id="A1.E6.m1.2.2.2.2.2.2.1.2.2" xref="A1.E6.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mrow id="A1.E6.m1.2.2.2.2.2.2.1.2.1" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.cmml"><mi id="A1.E6.m1.2.2.2.2.2.2.1.2.1.2" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.2.2.2.2.1.2.1.1" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="A1.E6.m1.2.2.2.2.2.2.1.2.1.3" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.2.2.2.2.1.2.1.1a" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="A1.E6.m1.2.2.2.2.2.2.1.2.1.4" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.4.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E6.m1.64.64.6.59.35.11.12" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.64.64.6.59.35.11.11.1" xref="A1.E6.m1.63.63.5.cmml"><mo stretchy="false" id="A1.E6.m1.3.3.3.3.3.3" xref="A1.E6.m1.63.63.5a.cmml">(</mo><mrow id="A1.E6.m1.64.64.6.59.35.11.11.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E6.m1.4.4.4.4.4.4" xref="A1.E6.m1.4.4.4.4.4.4.cmml">ℰ</mi><mo fence="false" id="A1.E6.m1.5.5.5.5.5.5" xref="A1.E6.m1.5.5.5.5.5.5.cmml">|</mo><mrow id="A1.E6.m1.64.64.6.59.35.11.11.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><msub id="A1.E6.m1.64.64.6.59.35.11.11.1.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi mathvariant="normal" id="A1.E6.m1.6.6.6.6.6.6" xref="A1.E6.m1.6.6.6.6.6.6.cmml">ℓ</mi><mrow id="A1.E6.m1.7.7.7.7.7.7.1" xref="A1.E6.m1.7.7.7.7.7.7.1.cmml"><mi id="A1.E6.m1.7.7.7.7.7.7.1.2" xref="A1.E6.m1.7.7.7.7.7.7.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.7.7.7.7.7.7.1.1" xref="A1.E6.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="A1.E6.m1.7.7.7.7.7.7.1.3" xref="A1.E6.m1.7.7.7.7.7.7.1.3.cmml">I</mi></mrow></msub><mo id="A1.E6.m1.8.8.8.8.8.8" xref="A1.E6.m1.63.63.5a.cmml">,</mo><mi mathvariant="normal" id="A1.E6.m1.9.9.9.9.9.9" xref="A1.E6.m1.9.9.9.9.9.9.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="A1.E6.m1.10.10.10.10.10.10" xref="A1.E6.m1.63.63.5a.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E6.m1.68.68.10c" xref="A1.E6.m1.63.63.5.cmml"><mrow id="A1.E6.m1.66.66.8.61.37.26" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.66.66.8.61.37.26.27" xref="A1.E6.m1.63.63.5a.cmml"></mi><mo id="A1.E6.m1.11.11.11.11.1.1" xref="A1.E6.m1.11.11.11.11.1.1.cmml">=</mo><mrow id="A1.E6.m1.66.66.8.61.37.26.26" xref="A1.E6.m1.63.63.5.cmml"><mrow id="A1.E6.m1.66.66.8.61.37.26.26.4" xref="A1.E6.m1.63.63.5.cmml"><msub id="A1.E6.m1.66.66.8.61.37.26.26.4.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.12.12.12.12.2.2" xref="A1.E6.m1.12.12.12.12.2.2.cmml">η</mi><mrow id="A1.E6.m1.13.13.13.13.3.3.1.2" xref="A1.E6.m1.13.13.13.13.3.3.1.3.cmml"><mi id="A1.E6.m1.13.13.13.13.3.3.1.1" xref="A1.E6.m1.13.13.13.13.3.3.1.1.cmml">s</mi><mo id="A1.E6.m1.13.13.13.13.3.3.1.2.2" xref="A1.E6.m1.13.13.13.13.3.3.1.3.cmml">,</mo><mrow id="A1.E6.m1.13.13.13.13.3.3.1.2.1" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.cmml"><mi id="A1.E6.m1.13.13.13.13.3.3.1.2.1.2" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.13.13.13.13.3.3.1.2.1.1" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E6.m1.13.13.13.13.3.3.1.2.1.3" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.13.13.13.13.3.3.1.2.1.1a" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E6.m1.13.13.13.13.3.3.1.2.1.4" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.4.cmml">d</mi></mrow></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E6.m1.14.14.14.14.4.4" xref="A1.E6.m1.14.14.14.14.4.4.cmml">⋅</mo><mrow id="A1.E6.m1.66.66.8.61.37.26.26.4.2" xref="A1.E6.m1.63.63.5.cmml"><mo rspace="0.167em" id="A1.E6.m1.15.15.15.15.5.5" xref="A1.E6.m1.15.15.15.15.5.5.cmml">∇</mo><mstyle displaystyle="true" id="A1.E6.m1.16.16.16.16.6.6" xref="A1.E6.m1.16.16.16.16.6.6.cmml"><mfrac id="A1.E6.m1.16.16.16.16.6.6a" xref="A1.E6.m1.16.16.16.16.6.6.cmml"><mn id="A1.E6.m1.16.16.16.16.6.6.2" xref="A1.E6.m1.16.16.16.16.6.6.2.cmml">1</mn><msub id="A1.E6.m1.16.16.16.16.6.6.3" xref="A1.E6.m1.16.16.16.16.6.6.3.cmml"><mi id="A1.E6.m1.16.16.16.16.6.6.3.2" xref="A1.E6.m1.16.16.16.16.6.6.3.2.cmml">N</mi><mi class="ltx_font_mathcaligraphic" id="A1.E6.m1.16.16.16.16.6.6.3.3" xref="A1.E6.m1.16.16.16.16.6.6.3.3.cmml">ℰ</mi></msub></mfrac></mstyle></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.E6.m1.66.66.8.61.37.26.26.3" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.66.66.8.61.37.26.26.2" xref="A1.E6.m1.63.63.5.cmml"><mstyle displaystyle="true" id="A1.E6.m1.66.66.8.61.37.26.26.2.3" xref="A1.E6.m1.63.63.5.cmml"><munderover id="A1.E6.m1.66.66.8.61.37.26.26.2.3a" xref="A1.E6.m1.63.63.5.cmml"><mo movablelimits="false" id="A1.E6.m1.17.17.17.17.7.7" xref="A1.E6.m1.17.17.17.17.7.7.cmml">∑</mo><mrow id="A1.E6.m1.19.19.19.19.9.9.1" xref="A1.E6.m1.19.19.19.19.9.9.1.cmml"><mi id="A1.E6.m1.19.19.19.19.9.9.1.2" xref="A1.E6.m1.19.19.19.19.9.9.1.2.cmml">i</mi><mo id="A1.E6.m1.19.19.19.19.9.9.1.1" xref="A1.E6.m1.19.19.19.19.9.9.1.1.cmml">=</mo><mn id="A1.E6.m1.19.19.19.19.9.9.1.3" xref="A1.E6.m1.19.19.19.19.9.9.1.3.cmml">0</mn></mrow><msub id="A1.E6.m1.18.18.18.18.8.8.1" xref="A1.E6.m1.18.18.18.18.8.8.1.cmml"><mi id="A1.E6.m1.18.18.18.18.8.8.1.2" xref="A1.E6.m1.18.18.18.18.8.8.1.2.cmml">N</mi><mi class="ltx_font_mathcaligraphic" id="A1.E6.m1.18.18.18.18.8.8.1.3" xref="A1.E6.m1.18.18.18.18.8.8.1.3.cmml">ℰ</mi></msub></munderover></mstyle><mrow id="A1.E6.m1.66.66.8.61.37.26.26.2.2" xref="A1.E6.m1.63.63.5.cmml"><msub id="A1.E6.m1.66.66.8.61.37.26.26.2.2.4" xref="A1.E6.m1.63.63.5.cmml"><mi mathvariant="normal" id="A1.E6.m1.20.20.20.20.10.10" xref="A1.E6.m1.20.20.20.20.10.10.cmml">ℓ</mi><mrow id="A1.E6.m1.21.21.21.21.11.11.1" xref="A1.E6.m1.21.21.21.21.11.11.1.cmml"><mi id="A1.E6.m1.21.21.21.21.11.11.1.2" xref="A1.E6.m1.21.21.21.21.11.11.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.21.21.21.21.11.11.1.1" xref="A1.E6.m1.21.21.21.21.11.11.1.1.cmml">​</mo><mi id="A1.E6.m1.21.21.21.21.11.11.1.3" xref="A1.E6.m1.21.21.21.21.11.11.1.3.cmml">I</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E6.m1.66.66.8.61.37.26.26.2.2.3" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.66.66.8.61.37.26.26.2.2.2.2" xref="A1.E6.m1.63.63.5.cmml"><mo stretchy="false" id="A1.E6.m1.22.22.22.22.12.12" xref="A1.E6.m1.63.63.5a.cmml">(</mo><mrow id="A1.E6.m1.65.65.7.60.36.25.25.1.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.23.23.23.23.13.13" xref="A1.E6.m1.23.23.23.23.13.13.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.65.65.7.60.36.25.25.1.1.1.1.1.2" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.65.65.7.60.36.25.25.1.1.1.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mo stretchy="false" id="A1.E6.m1.24.24.24.24.14.14" xref="A1.E6.m1.63.63.5a.cmml">(</mo><msub id="A1.E6.m1.65.65.7.60.36.25.25.1.1.1.1.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.25.25.25.25.15.15" xref="A1.E6.m1.25.25.25.25.15.15.cmml">𝐗</mi><mi id="A1.E6.m1.26.26.26.26.16.16.1" xref="A1.E6.m1.26.26.26.26.16.16.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E6.m1.27.27.27.27.17.17" xref="A1.E6.m1.63.63.5a.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.28.28.28.28.18.18" xref="A1.E6.m1.63.63.5a.cmml">,</mo><mrow id="A1.E6.m1.66.66.8.61.37.26.26.2.2.2.2.2" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.29.29.29.29.19.19" xref="A1.E6.m1.29.29.29.29.19.19.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.66.66.8.61.37.26.26.2.2.2.2.2.2" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.66.66.8.61.37.26.26.2.2.2.2.2.1.1" xref="A1.E6.m1.63.63.5.cmml"><mo stretchy="false" id="A1.E6.m1.30.30.30.30.20.20" xref="A1.E6.m1.63.63.5a.cmml">(</mo><msub id="A1.E6.m1.66.66.8.61.37.26.26.2.2.2.2.2.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.31.31.31.31.21.21" xref="A1.E6.m1.31.31.31.31.21.21.cmml">𝐘</mi><mi id="A1.E6.m1.32.32.32.32.22.22.1" xref="A1.E6.m1.32.32.32.32.22.22.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E6.m1.33.33.33.33.23.23" xref="A1.E6.m1.63.63.5a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E6.m1.34.34.34.34.24.24" xref="A1.E6.m1.63.63.5a.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E6.m1.68.68.10d" xref="A1.E6.m1.63.63.5.cmml"><mtd id="A1.E6.m1.68.68.10e" xref="A1.E6.m1.63.63.5a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E6.m1.68.68.10f" xref="A1.E6.m1.63.63.5.cmml"><mrow id="A1.E6.m1.68.68.10.63.26.26" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.68.68.10.63.26.26.27" xref="A1.E6.m1.63.63.5a.cmml"></mi><mo id="A1.E6.m1.35.35.35.1.1.1" xref="A1.E6.m1.35.35.35.1.1.1.cmml">=</mo><mrow id="A1.E6.m1.68.68.10.63.26.26.26" xref="A1.E6.m1.63.63.5.cmml"><mrow id="A1.E6.m1.68.68.10.63.26.26.26.4" xref="A1.E6.m1.63.63.5.cmml"><msub id="A1.E6.m1.68.68.10.63.26.26.26.4.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.36.36.36.2.2.2" xref="A1.E6.m1.36.36.36.2.2.2.cmml">η</mi><mrow id="A1.E6.m1.37.37.37.3.3.3.1.2" xref="A1.E6.m1.37.37.37.3.3.3.1.3.cmml"><mi id="A1.E6.m1.37.37.37.3.3.3.1.1" xref="A1.E6.m1.37.37.37.3.3.3.1.1.cmml">s</mi><mo id="A1.E6.m1.37.37.37.3.3.3.1.2.2" xref="A1.E6.m1.37.37.37.3.3.3.1.3.cmml">,</mo><mrow id="A1.E6.m1.37.37.37.3.3.3.1.2.1" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.cmml"><mi id="A1.E6.m1.37.37.37.3.3.3.1.2.1.2" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.37.37.37.3.3.3.1.2.1.1" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E6.m1.37.37.37.3.3.3.1.2.1.3" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.37.37.37.3.3.3.1.2.1.1a" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.1.cmml">​</mo><mi id="A1.E6.m1.37.37.37.3.3.3.1.2.1.4" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.4.cmml">d</mi></mrow></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E6.m1.38.38.38.4.4.4" xref="A1.E6.m1.38.38.38.4.4.4.cmml">⋅</mo><mstyle displaystyle="true" id="A1.E6.m1.39.39.39.5.5.5" xref="A1.E6.m1.39.39.39.5.5.5.cmml"><mfrac id="A1.E6.m1.39.39.39.5.5.5a" xref="A1.E6.m1.39.39.39.5.5.5.cmml"><mn id="A1.E6.m1.39.39.39.5.5.5.2" xref="A1.E6.m1.39.39.39.5.5.5.2.cmml">1</mn><msub id="A1.E6.m1.39.39.39.5.5.5.3" xref="A1.E6.m1.39.39.39.5.5.5.3.cmml"><mi id="A1.E6.m1.39.39.39.5.5.5.3.2" xref="A1.E6.m1.39.39.39.5.5.5.3.2.cmml">N</mi><mi id="A1.E6.m1.39.39.39.5.5.5.3.3" xref="A1.E6.m1.39.39.39.5.5.5.3.3.cmml">E</mi></msub></mfrac></mstyle></mrow><mo lspace="0em" rspace="0em" id="A1.E6.m1.68.68.10.63.26.26.26.3" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.68.68.10.63.26.26.26.2" xref="A1.E6.m1.63.63.5.cmml"><mstyle displaystyle="true" id="A1.E6.m1.68.68.10.63.26.26.26.2.3" xref="A1.E6.m1.63.63.5.cmml"><munderover id="A1.E6.m1.68.68.10.63.26.26.26.2.3a" xref="A1.E6.m1.63.63.5.cmml"><mo movablelimits="false" id="A1.E6.m1.40.40.40.6.6.6" xref="A1.E6.m1.40.40.40.6.6.6.cmml">∑</mo><mrow id="A1.E6.m1.42.42.42.8.8.8.1" xref="A1.E6.m1.42.42.42.8.8.8.1.cmml"><mi id="A1.E6.m1.42.42.42.8.8.8.1.2" xref="A1.E6.m1.42.42.42.8.8.8.1.2.cmml">i</mi><mo id="A1.E6.m1.42.42.42.8.8.8.1.1" xref="A1.E6.m1.42.42.42.8.8.8.1.1.cmml">=</mo><mn id="A1.E6.m1.42.42.42.8.8.8.1.3" xref="A1.E6.m1.42.42.42.8.8.8.1.3.cmml">0</mn></mrow><msub id="A1.E6.m1.41.41.41.7.7.7.1" xref="A1.E6.m1.41.41.41.7.7.7.1.cmml"><mi id="A1.E6.m1.41.41.41.7.7.7.1.2" xref="A1.E6.m1.41.41.41.7.7.7.1.2.cmml">N</mi><mi class="ltx_font_mathcaligraphic" id="A1.E6.m1.41.41.41.7.7.7.1.3" xref="A1.E6.m1.41.41.41.7.7.7.1.3.cmml">ℰ</mi></msub></munderover></mstyle><mrow id="A1.E6.m1.68.68.10.63.26.26.26.2.2" xref="A1.E6.m1.63.63.5.cmml"><mrow id="A1.E6.m1.68.68.10.63.26.26.26.2.2.4" xref="A1.E6.m1.63.63.5.cmml"><mo lspace="0.167em" rspace="0.167em" id="A1.E6.m1.43.43.43.9.9.9" xref="A1.E6.m1.43.43.43.9.9.9.cmml">∇</mo><msub id="A1.E6.m1.68.68.10.63.26.26.26.2.2.4.1" xref="A1.E6.m1.63.63.5.cmml"><mi mathvariant="normal" id="A1.E6.m1.44.44.44.10.10.10" xref="A1.E6.m1.44.44.44.10.10.10.cmml">ℓ</mi><mrow id="A1.E6.m1.45.45.45.11.11.11.1" xref="A1.E6.m1.45.45.45.11.11.11.1.cmml"><mi id="A1.E6.m1.45.45.45.11.11.11.1.2" xref="A1.E6.m1.45.45.45.11.11.11.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.45.45.45.11.11.11.1.1" xref="A1.E6.m1.45.45.45.11.11.11.1.1.cmml">​</mo><mi id="A1.E6.m1.45.45.45.11.11.11.1.3" xref="A1.E6.m1.45.45.45.11.11.11.1.3.cmml">I</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A1.E6.m1.68.68.10.63.26.26.26.2.2.3" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.68.68.10.63.26.26.26.2.2.2.2" xref="A1.E6.m1.63.63.5.cmml"><mo stretchy="false" id="A1.E6.m1.46.46.46.12.12.12" xref="A1.E6.m1.63.63.5a.cmml">(</mo><mrow id="A1.E6.m1.67.67.9.62.25.25.25.1.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.47.47.47.13.13.13" xref="A1.E6.m1.47.47.47.13.13.13.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.67.67.9.62.25.25.25.1.1.1.1.1.2" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.67.67.9.62.25.25.25.1.1.1.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mo stretchy="false" id="A1.E6.m1.48.48.48.14.14.14" xref="A1.E6.m1.63.63.5a.cmml">(</mo><msub id="A1.E6.m1.67.67.9.62.25.25.25.1.1.1.1.1.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.49.49.49.15.15.15" xref="A1.E6.m1.49.49.49.15.15.15.cmml">𝐗</mi><mi id="A1.E6.m1.50.50.50.16.16.16.1" xref="A1.E6.m1.50.50.50.16.16.16.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E6.m1.51.51.51.17.17.17" xref="A1.E6.m1.63.63.5a.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.52.52.52.18.18.18" xref="A1.E6.m1.63.63.5a.cmml">,</mo><mrow id="A1.E6.m1.68.68.10.63.26.26.26.2.2.2.2.2" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.53.53.53.19.19.19" xref="A1.E6.m1.53.53.53.19.19.19.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.68.68.10.63.26.26.26.2.2.2.2.2.2" xref="A1.E6.m1.63.63.5a.cmml">​</mo><mrow id="A1.E6.m1.68.68.10.63.26.26.26.2.2.2.2.2.1.1" xref="A1.E6.m1.63.63.5.cmml"><mo stretchy="false" id="A1.E6.m1.54.54.54.20.20.20" xref="A1.E6.m1.63.63.5a.cmml">(</mo><msub id="A1.E6.m1.68.68.10.63.26.26.26.2.2.2.2.2.1.1.1" xref="A1.E6.m1.63.63.5.cmml"><mi id="A1.E6.m1.55.55.55.21.21.21" xref="A1.E6.m1.55.55.55.21.21.21.cmml">𝐘</mi><mi id="A1.E6.m1.56.56.56.22.22.22.1" xref="A1.E6.m1.56.56.56.22.22.22.1.cmml">j</mi></msub><mo stretchy="false" id="A1.E6.m1.57.57.57.23.23.23" xref="A1.E6.m1.63.63.5a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E6.m1.58.58.58.24.24.24" xref="A1.E6.m1.63.63.5a.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E6.m1.68b"><apply id="A1.E6.m1.63.63.5.cmml" xref="A1.E6.m1.68.68.10"><and id="A1.E6.m1.63.63.5a.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12"></and><apply id="A1.E6.m1.63.63.5b.cmml" xref="A1.E6.m1.68.68.10"><eq id="A1.E6.m1.11.11.11.11.1.1.cmml" xref="A1.E6.m1.11.11.11.11.1.1"></eq><apply id="A1.E6.m1.59.59.1.1.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.59.59.1.1.2.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12"></times><apply id="A1.E6.m1.59.59.1.1.3.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.59.59.1.1.3.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">subscript</csymbol><ci id="A1.E6.m1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.1.1.1.1.1.1">Δ</ci><list id="A1.E6.m1.2.2.2.2.2.2.1.3.cmml" xref="A1.E6.m1.2.2.2.2.2.2.1.2"><ci id="A1.E6.m1.2.2.2.2.2.2.1.1.cmml" xref="A1.E6.m1.2.2.2.2.2.2.1.1">𝑘</ci><apply id="A1.E6.m1.2.2.2.2.2.2.1.2.1.cmml" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1"><times id="A1.E6.m1.2.2.2.2.2.2.1.2.1.1.cmml" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.1"></times><ci id="A1.E6.m1.2.2.2.2.2.2.1.2.1.2.cmml" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.2">𝑠</ci><ci id="A1.E6.m1.2.2.2.2.2.2.1.2.1.3.cmml" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.3">𝑔</ci><ci id="A1.E6.m1.2.2.2.2.2.2.1.2.1.4.cmml" xref="A1.E6.m1.2.2.2.2.2.2.1.2.1.4">𝑑</ci></apply></list></apply><apply id="A1.E6.m1.59.59.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="latexml" id="A1.E6.m1.5.5.5.5.5.5.cmml" xref="A1.E6.m1.5.5.5.5.5.5">conditional</csymbol><ci id="A1.E6.m1.4.4.4.4.4.4.cmml" xref="A1.E6.m1.4.4.4.4.4.4">ℰ</ci><list id="A1.E6.m1.59.59.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.68.68.10"><apply id="A1.E6.m1.59.59.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.59.59.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10">subscript</csymbol><ci id="A1.E6.m1.6.6.6.6.6.6.cmml" xref="A1.E6.m1.6.6.6.6.6.6">ℓ</ci><apply id="A1.E6.m1.7.7.7.7.7.7.1.cmml" xref="A1.E6.m1.7.7.7.7.7.7.1"><times id="A1.E6.m1.7.7.7.7.7.7.1.1.cmml" xref="A1.E6.m1.7.7.7.7.7.7.1.1"></times><ci id="A1.E6.m1.7.7.7.7.7.7.1.2.cmml" xref="A1.E6.m1.7.7.7.7.7.7.1.2">𝐵</ci><ci id="A1.E6.m1.7.7.7.7.7.7.1.3.cmml" xref="A1.E6.m1.7.7.7.7.7.7.1.3">𝐼</ci></apply></apply><ci id="A1.E6.m1.9.9.9.9.9.9.cmml" xref="A1.E6.m1.9.9.9.9.9.9">Θ</ci></list></apply></apply><apply id="A1.E6.m1.61.61.3.3.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.61.61.3.3.3.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12"></times><apply id="A1.E6.m1.61.61.3.3.4.cmml" xref="A1.E6.m1.68.68.10"><ci id="A1.E6.m1.14.14.14.14.4.4.cmml" xref="A1.E6.m1.14.14.14.14.4.4">⋅</ci><apply id="A1.E6.m1.61.61.3.3.4.2.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.61.61.3.3.4.2.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">subscript</csymbol><ci id="A1.E6.m1.12.12.12.12.2.2.cmml" xref="A1.E6.m1.12.12.12.12.2.2">𝜂</ci><list id="A1.E6.m1.13.13.13.13.3.3.1.3.cmml" xref="A1.E6.m1.13.13.13.13.3.3.1.2"><ci id="A1.E6.m1.13.13.13.13.3.3.1.1.cmml" xref="A1.E6.m1.13.13.13.13.3.3.1.1">𝑠</ci><apply id="A1.E6.m1.13.13.13.13.3.3.1.2.1.cmml" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1"><times id="A1.E6.m1.13.13.13.13.3.3.1.2.1.1.cmml" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.1"></times><ci id="A1.E6.m1.13.13.13.13.3.3.1.2.1.2.cmml" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.2">𝑠</ci><ci id="A1.E6.m1.13.13.13.13.3.3.1.2.1.3.cmml" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.3">𝑔</ci><ci id="A1.E6.m1.13.13.13.13.3.3.1.2.1.4.cmml" xref="A1.E6.m1.13.13.13.13.3.3.1.2.1.4">𝑑</ci></apply></list></apply><apply id="A1.E6.m1.61.61.3.3.4.3.cmml" xref="A1.E6.m1.68.68.10"><ci id="A1.E6.m1.15.15.15.15.5.5.cmml" xref="A1.E6.m1.15.15.15.15.5.5">∇</ci><apply id="A1.E6.m1.16.16.16.16.6.6.cmml" xref="A1.E6.m1.16.16.16.16.6.6"><divide id="A1.E6.m1.16.16.16.16.6.6.1.cmml" xref="A1.E6.m1.16.16.16.16.6.6"></divide><cn type="integer" id="A1.E6.m1.16.16.16.16.6.6.2.cmml" xref="A1.E6.m1.16.16.16.16.6.6.2">1</cn><apply id="A1.E6.m1.16.16.16.16.6.6.3.cmml" xref="A1.E6.m1.16.16.16.16.6.6.3"><csymbol cd="ambiguous" id="A1.E6.m1.16.16.16.16.6.6.3.1.cmml" xref="A1.E6.m1.16.16.16.16.6.6.3">subscript</csymbol><ci id="A1.E6.m1.16.16.16.16.6.6.3.2.cmml" xref="A1.E6.m1.16.16.16.16.6.6.3.2">𝑁</ci><ci id="A1.E6.m1.16.16.16.16.6.6.3.3.cmml" xref="A1.E6.m1.16.16.16.16.6.6.3.3">ℰ</ci></apply></apply></apply></apply><apply id="A1.E6.m1.61.61.3.3.2.cmml" xref="A1.E6.m1.68.68.10"><apply id="A1.E6.m1.61.61.3.3.2.3.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.61.61.3.3.2.3.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">subscript</csymbol><apply id="A1.E6.m1.61.61.3.3.2.3.2.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.61.61.3.3.2.3.2.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">superscript</csymbol><sum id="A1.E6.m1.17.17.17.17.7.7.cmml" xref="A1.E6.m1.17.17.17.17.7.7"></sum><apply id="A1.E6.m1.18.18.18.18.8.8.1.cmml" xref="A1.E6.m1.18.18.18.18.8.8.1"><csymbol cd="ambiguous" id="A1.E6.m1.18.18.18.18.8.8.1.1.cmml" xref="A1.E6.m1.18.18.18.18.8.8.1">subscript</csymbol><ci id="A1.E6.m1.18.18.18.18.8.8.1.2.cmml" xref="A1.E6.m1.18.18.18.18.8.8.1.2">𝑁</ci><ci id="A1.E6.m1.18.18.18.18.8.8.1.3.cmml" xref="A1.E6.m1.18.18.18.18.8.8.1.3">ℰ</ci></apply></apply><apply id="A1.E6.m1.19.19.19.19.9.9.1.cmml" xref="A1.E6.m1.19.19.19.19.9.9.1"><eq id="A1.E6.m1.19.19.19.19.9.9.1.1.cmml" xref="A1.E6.m1.19.19.19.19.9.9.1.1"></eq><ci id="A1.E6.m1.19.19.19.19.9.9.1.2.cmml" xref="A1.E6.m1.19.19.19.19.9.9.1.2">𝑖</ci><cn type="integer" id="A1.E6.m1.19.19.19.19.9.9.1.3.cmml" xref="A1.E6.m1.19.19.19.19.9.9.1.3">0</cn></apply></apply><apply id="A1.E6.m1.61.61.3.3.2.2.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.61.61.3.3.2.2.3.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12"></times><apply id="A1.E6.m1.61.61.3.3.2.2.4.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.61.61.3.3.2.2.4.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">subscript</csymbol><ci id="A1.E6.m1.20.20.20.20.10.10.cmml" xref="A1.E6.m1.20.20.20.20.10.10">ℓ</ci><apply id="A1.E6.m1.21.21.21.21.11.11.1.cmml" xref="A1.E6.m1.21.21.21.21.11.11.1"><times id="A1.E6.m1.21.21.21.21.11.11.1.1.cmml" xref="A1.E6.m1.21.21.21.21.11.11.1.1"></times><ci id="A1.E6.m1.21.21.21.21.11.11.1.2.cmml" xref="A1.E6.m1.21.21.21.21.11.11.1.2">𝐵</ci><ci id="A1.E6.m1.21.21.21.21.11.11.1.3.cmml" xref="A1.E6.m1.21.21.21.21.11.11.1.3">𝐼</ci></apply></apply><interval closure="open" id="A1.E6.m1.61.61.3.3.2.2.2.3.cmml" xref="A1.E6.m1.68.68.10"><apply id="A1.E6.m1.60.60.2.2.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.60.60.2.2.1.1.1.1.1.2.cmml" xref="A1.E6.m1.68.68.10"></times><ci id="A1.E6.m1.23.23.23.23.13.13.cmml" xref="A1.E6.m1.23.23.23.23.13.13">𝑓</ci><apply id="A1.E6.m1.60.60.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.60.60.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10">subscript</csymbol><ci id="A1.E6.m1.25.25.25.25.15.15.cmml" xref="A1.E6.m1.25.25.25.25.15.15">𝐗</ci><ci id="A1.E6.m1.26.26.26.26.16.16.1.cmml" xref="A1.E6.m1.26.26.26.26.16.16.1">𝑗</ci></apply></apply><apply id="A1.E6.m1.61.61.3.3.2.2.2.2.2.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.61.61.3.3.2.2.2.2.2.2.cmml" xref="A1.E6.m1.68.68.10"></times><ci id="A1.E6.m1.29.29.29.29.19.19.cmml" xref="A1.E6.m1.29.29.29.29.19.19">𝑔</ci><apply id="A1.E6.m1.61.61.3.3.2.2.2.2.2.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.61.61.3.3.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10">subscript</csymbol><ci id="A1.E6.m1.31.31.31.31.21.21.cmml" xref="A1.E6.m1.31.31.31.31.21.21">𝐘</ci><ci id="A1.E6.m1.32.32.32.32.22.22.1.cmml" xref="A1.E6.m1.32.32.32.32.22.22.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply><apply id="A1.E6.m1.63.63.5c.cmml" xref="A1.E6.m1.68.68.10"><eq id="A1.E6.m1.35.35.35.1.1.1.cmml" xref="A1.E6.m1.35.35.35.1.1.1"></eq><share href="#A1.E6.m1.61.61.3.3.cmml" id="A1.E6.m1.63.63.5d.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12"></share><apply id="A1.E6.m1.63.63.5.5.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.63.63.5.5.3.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12"></times><apply id="A1.E6.m1.63.63.5.5.4.cmml" xref="A1.E6.m1.68.68.10"><ci id="A1.E6.m1.38.38.38.4.4.4.cmml" xref="A1.E6.m1.38.38.38.4.4.4">⋅</ci><apply id="A1.E6.m1.63.63.5.5.4.2.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.63.63.5.5.4.2.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">subscript</csymbol><ci id="A1.E6.m1.36.36.36.2.2.2.cmml" xref="A1.E6.m1.36.36.36.2.2.2">𝜂</ci><list id="A1.E6.m1.37.37.37.3.3.3.1.3.cmml" xref="A1.E6.m1.37.37.37.3.3.3.1.2"><ci id="A1.E6.m1.37.37.37.3.3.3.1.1.cmml" xref="A1.E6.m1.37.37.37.3.3.3.1.1">𝑠</ci><apply id="A1.E6.m1.37.37.37.3.3.3.1.2.1.cmml" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1"><times id="A1.E6.m1.37.37.37.3.3.3.1.2.1.1.cmml" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.1"></times><ci id="A1.E6.m1.37.37.37.3.3.3.1.2.1.2.cmml" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.2">𝑠</ci><ci id="A1.E6.m1.37.37.37.3.3.3.1.2.1.3.cmml" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.3">𝑔</ci><ci id="A1.E6.m1.37.37.37.3.3.3.1.2.1.4.cmml" xref="A1.E6.m1.37.37.37.3.3.3.1.2.1.4">𝑑</ci></apply></list></apply><apply id="A1.E6.m1.39.39.39.5.5.5.cmml" xref="A1.E6.m1.39.39.39.5.5.5"><divide id="A1.E6.m1.39.39.39.5.5.5.1.cmml" xref="A1.E6.m1.39.39.39.5.5.5"></divide><cn type="integer" id="A1.E6.m1.39.39.39.5.5.5.2.cmml" xref="A1.E6.m1.39.39.39.5.5.5.2">1</cn><apply id="A1.E6.m1.39.39.39.5.5.5.3.cmml" xref="A1.E6.m1.39.39.39.5.5.5.3"><csymbol cd="ambiguous" id="A1.E6.m1.39.39.39.5.5.5.3.1.cmml" xref="A1.E6.m1.39.39.39.5.5.5.3">subscript</csymbol><ci id="A1.E6.m1.39.39.39.5.5.5.3.2.cmml" xref="A1.E6.m1.39.39.39.5.5.5.3.2">𝑁</ci><ci id="A1.E6.m1.39.39.39.5.5.5.3.3.cmml" xref="A1.E6.m1.39.39.39.5.5.5.3.3">𝐸</ci></apply></apply></apply><apply id="A1.E6.m1.63.63.5.5.2.cmml" xref="A1.E6.m1.68.68.10"><apply id="A1.E6.m1.63.63.5.5.2.3.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.63.63.5.5.2.3.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">subscript</csymbol><apply id="A1.E6.m1.63.63.5.5.2.3.2.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.63.63.5.5.2.3.2.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">superscript</csymbol><sum id="A1.E6.m1.40.40.40.6.6.6.cmml" xref="A1.E6.m1.40.40.40.6.6.6"></sum><apply id="A1.E6.m1.41.41.41.7.7.7.1.cmml" xref="A1.E6.m1.41.41.41.7.7.7.1"><csymbol cd="ambiguous" id="A1.E6.m1.41.41.41.7.7.7.1.1.cmml" xref="A1.E6.m1.41.41.41.7.7.7.1">subscript</csymbol><ci id="A1.E6.m1.41.41.41.7.7.7.1.2.cmml" xref="A1.E6.m1.41.41.41.7.7.7.1.2">𝑁</ci><ci id="A1.E6.m1.41.41.41.7.7.7.1.3.cmml" xref="A1.E6.m1.41.41.41.7.7.7.1.3">ℰ</ci></apply></apply><apply id="A1.E6.m1.42.42.42.8.8.8.1.cmml" xref="A1.E6.m1.42.42.42.8.8.8.1"><eq id="A1.E6.m1.42.42.42.8.8.8.1.1.cmml" xref="A1.E6.m1.42.42.42.8.8.8.1.1"></eq><ci id="A1.E6.m1.42.42.42.8.8.8.1.2.cmml" xref="A1.E6.m1.42.42.42.8.8.8.1.2">𝑖</ci><cn type="integer" id="A1.E6.m1.42.42.42.8.8.8.1.3.cmml" xref="A1.E6.m1.42.42.42.8.8.8.1.3">0</cn></apply></apply><apply id="A1.E6.m1.63.63.5.5.2.2.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.63.63.5.5.2.2.3.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12"></times><apply id="A1.E6.m1.63.63.5.5.2.2.4.cmml" xref="A1.E6.m1.68.68.10"><ci id="A1.E6.m1.43.43.43.9.9.9.cmml" xref="A1.E6.m1.43.43.43.9.9.9">∇</ci><apply id="A1.E6.m1.63.63.5.5.2.2.4.2.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.63.63.5.5.2.2.4.2.1.cmml" xref="A1.E6.m1.64.64.6.59.35.11.12">subscript</csymbol><ci id="A1.E6.m1.44.44.44.10.10.10.cmml" xref="A1.E6.m1.44.44.44.10.10.10">ℓ</ci><apply id="A1.E6.m1.45.45.45.11.11.11.1.cmml" xref="A1.E6.m1.45.45.45.11.11.11.1"><times id="A1.E6.m1.45.45.45.11.11.11.1.1.cmml" xref="A1.E6.m1.45.45.45.11.11.11.1.1"></times><ci id="A1.E6.m1.45.45.45.11.11.11.1.2.cmml" xref="A1.E6.m1.45.45.45.11.11.11.1.2">𝐵</ci><ci id="A1.E6.m1.45.45.45.11.11.11.1.3.cmml" xref="A1.E6.m1.45.45.45.11.11.11.1.3">𝐼</ci></apply></apply></apply><interval closure="open" id="A1.E6.m1.63.63.5.5.2.2.2.3.cmml" xref="A1.E6.m1.68.68.10"><apply id="A1.E6.m1.62.62.4.4.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.62.62.4.4.1.1.1.1.1.2.cmml" xref="A1.E6.m1.68.68.10"></times><ci id="A1.E6.m1.47.47.47.13.13.13.cmml" xref="A1.E6.m1.47.47.47.13.13.13">𝑓</ci><apply id="A1.E6.m1.62.62.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.62.62.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10">subscript</csymbol><ci id="A1.E6.m1.49.49.49.15.15.15.cmml" xref="A1.E6.m1.49.49.49.15.15.15">𝐗</ci><ci id="A1.E6.m1.50.50.50.16.16.16.1.cmml" xref="A1.E6.m1.50.50.50.16.16.16.1">𝑗</ci></apply></apply><apply id="A1.E6.m1.63.63.5.5.2.2.2.2.2.cmml" xref="A1.E6.m1.68.68.10"><times id="A1.E6.m1.63.63.5.5.2.2.2.2.2.2.cmml" xref="A1.E6.m1.68.68.10"></times><ci id="A1.E6.m1.53.53.53.19.19.19.cmml" xref="A1.E6.m1.53.53.53.19.19.19">𝑔</ci><apply id="A1.E6.m1.63.63.5.5.2.2.2.2.2.1.1.1.cmml" xref="A1.E6.m1.68.68.10"><csymbol cd="ambiguous" id="A1.E6.m1.63.63.5.5.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E6.m1.68.68.10">subscript</csymbol><ci id="A1.E6.m1.55.55.55.21.21.21.cmml" xref="A1.E6.m1.55.55.55.21.21.21">𝐘</ci><ci id="A1.E6.m1.56.56.56.22.22.22.1.cmml" xref="A1.E6.m1.56.56.56.22.22.22.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.68c">\displaystyle\begin{split}\Delta_{k,sgd}(\mathcal{E}|\ell_{BI},\Theta)&amp;=\eta_{s,sgd}\cdot\nabla\frac{1}{N_{\mathcal{E}}}\sum^{N_{\mathcal{E}}}_{i=0}\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\\
&amp;=\eta_{s,sgd}\cdot\frac{1}{N_{E}}\sum^{N_{\mathcal{E}}}_{i=0}\nabla\ell_{BI}(f(\mathbf{X}_{j}),g(\mathbf{Y}_{j}))\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.6.p6" class="ltx_para">
<p id="A1.6.p6.1" class="ltx_p">Note that <math id="A1.6.p6.1.m1.4" class="ltx_Math" alttext="\eta_{s,fedsgd}=\eta_{s,sgd}" display="inline"><semantics id="A1.6.p6.1.m1.4a"><mrow id="A1.6.p6.1.m1.4.5" xref="A1.6.p6.1.m1.4.5.cmml"><msub id="A1.6.p6.1.m1.4.5.2" xref="A1.6.p6.1.m1.4.5.2.cmml"><mi id="A1.6.p6.1.m1.4.5.2.2" xref="A1.6.p6.1.m1.4.5.2.2.cmml">η</mi><mrow id="A1.6.p6.1.m1.2.2.2.2" xref="A1.6.p6.1.m1.2.2.2.3.cmml"><mi id="A1.6.p6.1.m1.1.1.1.1" xref="A1.6.p6.1.m1.1.1.1.1.cmml">s</mi><mo id="A1.6.p6.1.m1.2.2.2.2.2" xref="A1.6.p6.1.m1.2.2.2.3.cmml">,</mo><mrow id="A1.6.p6.1.m1.2.2.2.2.1" xref="A1.6.p6.1.m1.2.2.2.2.1.cmml"><mi id="A1.6.p6.1.m1.2.2.2.2.1.2" xref="A1.6.p6.1.m1.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.6.p6.1.m1.2.2.2.2.1.1" xref="A1.6.p6.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.6.p6.1.m1.2.2.2.2.1.3" xref="A1.6.p6.1.m1.2.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.6.p6.1.m1.2.2.2.2.1.1a" xref="A1.6.p6.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.6.p6.1.m1.2.2.2.2.1.4" xref="A1.6.p6.1.m1.2.2.2.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.6.p6.1.m1.2.2.2.2.1.1b" xref="A1.6.p6.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.6.p6.1.m1.2.2.2.2.1.5" xref="A1.6.p6.1.m1.2.2.2.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.6.p6.1.m1.2.2.2.2.1.1c" xref="A1.6.p6.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.6.p6.1.m1.2.2.2.2.1.6" xref="A1.6.p6.1.m1.2.2.2.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.6.p6.1.m1.2.2.2.2.1.1d" xref="A1.6.p6.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.6.p6.1.m1.2.2.2.2.1.7" xref="A1.6.p6.1.m1.2.2.2.2.1.7.cmml">d</mi></mrow></mrow></msub><mo id="A1.6.p6.1.m1.4.5.1" xref="A1.6.p6.1.m1.4.5.1.cmml">=</mo><msub id="A1.6.p6.1.m1.4.5.3" xref="A1.6.p6.1.m1.4.5.3.cmml"><mi id="A1.6.p6.1.m1.4.5.3.2" xref="A1.6.p6.1.m1.4.5.3.2.cmml">η</mi><mrow id="A1.6.p6.1.m1.4.4.2.2" xref="A1.6.p6.1.m1.4.4.2.3.cmml"><mi id="A1.6.p6.1.m1.3.3.1.1" xref="A1.6.p6.1.m1.3.3.1.1.cmml">s</mi><mo id="A1.6.p6.1.m1.4.4.2.2.2" xref="A1.6.p6.1.m1.4.4.2.3.cmml">,</mo><mrow id="A1.6.p6.1.m1.4.4.2.2.1" xref="A1.6.p6.1.m1.4.4.2.2.1.cmml"><mi id="A1.6.p6.1.m1.4.4.2.2.1.2" xref="A1.6.p6.1.m1.4.4.2.2.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.6.p6.1.m1.4.4.2.2.1.1" xref="A1.6.p6.1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.6.p6.1.m1.4.4.2.2.1.3" xref="A1.6.p6.1.m1.4.4.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.6.p6.1.m1.4.4.2.2.1.1a" xref="A1.6.p6.1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.6.p6.1.m1.4.4.2.2.1.4" xref="A1.6.p6.1.m1.4.4.2.2.1.4.cmml">d</mi></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.6.p6.1.m1.4b"><apply id="A1.6.p6.1.m1.4.5.cmml" xref="A1.6.p6.1.m1.4.5"><eq id="A1.6.p6.1.m1.4.5.1.cmml" xref="A1.6.p6.1.m1.4.5.1"></eq><apply id="A1.6.p6.1.m1.4.5.2.cmml" xref="A1.6.p6.1.m1.4.5.2"><csymbol cd="ambiguous" id="A1.6.p6.1.m1.4.5.2.1.cmml" xref="A1.6.p6.1.m1.4.5.2">subscript</csymbol><ci id="A1.6.p6.1.m1.4.5.2.2.cmml" xref="A1.6.p6.1.m1.4.5.2.2">𝜂</ci><list id="A1.6.p6.1.m1.2.2.2.3.cmml" xref="A1.6.p6.1.m1.2.2.2.2"><ci id="A1.6.p6.1.m1.1.1.1.1.cmml" xref="A1.6.p6.1.m1.1.1.1.1">𝑠</ci><apply id="A1.6.p6.1.m1.2.2.2.2.1.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1"><times id="A1.6.p6.1.m1.2.2.2.2.1.1.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1.1"></times><ci id="A1.6.p6.1.m1.2.2.2.2.1.2.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1.2">𝑓</ci><ci id="A1.6.p6.1.m1.2.2.2.2.1.3.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1.3">𝑒</ci><ci id="A1.6.p6.1.m1.2.2.2.2.1.4.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1.4">𝑑</ci><ci id="A1.6.p6.1.m1.2.2.2.2.1.5.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1.5">𝑠</ci><ci id="A1.6.p6.1.m1.2.2.2.2.1.6.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1.6">𝑔</ci><ci id="A1.6.p6.1.m1.2.2.2.2.1.7.cmml" xref="A1.6.p6.1.m1.2.2.2.2.1.7">𝑑</ci></apply></list></apply><apply id="A1.6.p6.1.m1.4.5.3.cmml" xref="A1.6.p6.1.m1.4.5.3"><csymbol cd="ambiguous" id="A1.6.p6.1.m1.4.5.3.1.cmml" xref="A1.6.p6.1.m1.4.5.3">subscript</csymbol><ci id="A1.6.p6.1.m1.4.5.3.2.cmml" xref="A1.6.p6.1.m1.4.5.3.2">𝜂</ci><list id="A1.6.p6.1.m1.4.4.2.3.cmml" xref="A1.6.p6.1.m1.4.4.2.2"><ci id="A1.6.p6.1.m1.3.3.1.1.cmml" xref="A1.6.p6.1.m1.3.3.1.1">𝑠</ci><apply id="A1.6.p6.1.m1.4.4.2.2.1.cmml" xref="A1.6.p6.1.m1.4.4.2.2.1"><times id="A1.6.p6.1.m1.4.4.2.2.1.1.cmml" xref="A1.6.p6.1.m1.4.4.2.2.1.1"></times><ci id="A1.6.p6.1.m1.4.4.2.2.1.2.cmml" xref="A1.6.p6.1.m1.4.4.2.2.1.2">𝑠</ci><ci id="A1.6.p6.1.m1.4.4.2.2.1.3.cmml" xref="A1.6.p6.1.m1.4.4.2.2.1.3">𝑔</ci><ci id="A1.6.p6.1.m1.4.4.2.2.1.4.cmml" xref="A1.6.p6.1.m1.4.4.2.2.1.4">𝑑</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.6.p6.1.m1.4c">\eta_{s,fedsgd}=\eta_{s,sgd}</annotation></semantics></math>. Therefore, with <a href="#A1.E5" title="In Proof. ‣ Appendix A Proof of Proposition 1 ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">5</span></a> and <a href="#A1.E6" title="In Proof. ‣ Appendix A Proof of Proposition 1 ‣ Learning Federated Representations and Recommendations with Limited Negatives" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">6</span></a>, we prove that</p>
<table id="A1.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex1.m1.8" class="ltx_Math" alttext="\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)\equiv\Delta_{k,sgd}(\mathcal{E}|\ell_{BI},\Theta)" display="block"><semantics id="A1.Ex1.m1.8a"><mrow id="A1.Ex1.m1.8.8" xref="A1.Ex1.m1.8.8.cmml"><mrow id="A1.Ex1.m1.7.7.1" xref="A1.Ex1.m1.7.7.1.cmml"><msub id="A1.Ex1.m1.7.7.1.3" xref="A1.Ex1.m1.7.7.1.3.cmml"><mi mathvariant="normal" id="A1.Ex1.m1.7.7.1.3.2" xref="A1.Ex1.m1.7.7.1.3.2.cmml">Δ</mi><mrow id="A1.Ex1.m1.2.2.2.2" xref="A1.Ex1.m1.2.2.2.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.cmml">k</mi><mo id="A1.Ex1.m1.2.2.2.2.2" xref="A1.Ex1.m1.2.2.2.3.cmml">,</mo><mrow id="A1.Ex1.m1.2.2.2.2.1" xref="A1.Ex1.m1.2.2.2.2.1.cmml"><mi id="A1.Ex1.m1.2.2.2.2.1.2" xref="A1.Ex1.m1.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.2.2.2.2.1.1" xref="A1.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.Ex1.m1.2.2.2.2.1.3" xref="A1.Ex1.m1.2.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.2.2.2.2.1.1a" xref="A1.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.Ex1.m1.2.2.2.2.1.4" xref="A1.Ex1.m1.2.2.2.2.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.2.2.2.2.1.1b" xref="A1.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.Ex1.m1.2.2.2.2.1.5" xref="A1.Ex1.m1.2.2.2.2.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.2.2.2.2.1.1c" xref="A1.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.Ex1.m1.2.2.2.2.1.6" xref="A1.Ex1.m1.2.2.2.2.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.2.2.2.2.1.1d" xref="A1.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="A1.Ex1.m1.2.2.2.2.1.7" xref="A1.Ex1.m1.2.2.2.2.1.7.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.7.7.1.2" xref="A1.Ex1.m1.7.7.1.2.cmml">​</mo><mrow id="A1.Ex1.m1.7.7.1.1.1" xref="A1.Ex1.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex1.m1.7.7.1.1.1.2" xref="A1.Ex1.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.7.7.1.1.1.1" xref="A1.Ex1.m1.7.7.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m1.7.7.1.1.1.1.3" xref="A1.Ex1.m1.7.7.1.1.1.1.3.cmml">𝒞</mi><mo fence="false" id="A1.Ex1.m1.7.7.1.1.1.1.2" xref="A1.Ex1.m1.7.7.1.1.1.1.2.cmml">|</mo><mrow id="A1.Ex1.m1.7.7.1.1.1.1.1.1" xref="A1.Ex1.m1.7.7.1.1.1.1.1.2.cmml"><msub id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.2" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.2.cmml">ℓ</mi><mrow id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.1" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3.cmml">I</mi></mrow></msub><mo id="A1.Ex1.m1.7.7.1.1.1.1.1.1.2" xref="A1.Ex1.m1.7.7.1.1.1.1.1.2.cmml">,</mo><mi mathvariant="normal" id="A1.Ex1.m1.5.5" xref="A1.Ex1.m1.5.5.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="A1.Ex1.m1.7.7.1.1.1.3" xref="A1.Ex1.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex1.m1.8.8.3" xref="A1.Ex1.m1.8.8.3.cmml">≡</mo><mrow id="A1.Ex1.m1.8.8.2" xref="A1.Ex1.m1.8.8.2.cmml"><msub id="A1.Ex1.m1.8.8.2.3" xref="A1.Ex1.m1.8.8.2.3.cmml"><mi mathvariant="normal" id="A1.Ex1.m1.8.8.2.3.2" xref="A1.Ex1.m1.8.8.2.3.2.cmml">Δ</mi><mrow id="A1.Ex1.m1.4.4.2.2" xref="A1.Ex1.m1.4.4.2.3.cmml"><mi id="A1.Ex1.m1.3.3.1.1" xref="A1.Ex1.m1.3.3.1.1.cmml">k</mi><mo id="A1.Ex1.m1.4.4.2.2.2" xref="A1.Ex1.m1.4.4.2.3.cmml">,</mo><mrow id="A1.Ex1.m1.4.4.2.2.1" xref="A1.Ex1.m1.4.4.2.2.1.cmml"><mi id="A1.Ex1.m1.4.4.2.2.1.2" xref="A1.Ex1.m1.4.4.2.2.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.4.4.2.2.1.1" xref="A1.Ex1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.Ex1.m1.4.4.2.2.1.3" xref="A1.Ex1.m1.4.4.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.4.4.2.2.1.1a" xref="A1.Ex1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A1.Ex1.m1.4.4.2.2.1.4" xref="A1.Ex1.m1.4.4.2.2.1.4.cmml">d</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.8.8.2.2" xref="A1.Ex1.m1.8.8.2.2.cmml">​</mo><mrow id="A1.Ex1.m1.8.8.2.1.1" xref="A1.Ex1.m1.8.8.2.1.1.1.cmml"><mo stretchy="false" id="A1.Ex1.m1.8.8.2.1.1.2" xref="A1.Ex1.m1.8.8.2.1.1.1.cmml">(</mo><mrow id="A1.Ex1.m1.8.8.2.1.1.1" xref="A1.Ex1.m1.8.8.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m1.8.8.2.1.1.1.3" xref="A1.Ex1.m1.8.8.2.1.1.1.3.cmml">ℰ</mi><mo fence="false" id="A1.Ex1.m1.8.8.2.1.1.1.2" xref="A1.Ex1.m1.8.8.2.1.1.1.2.cmml">|</mo><mrow id="A1.Ex1.m1.8.8.2.1.1.1.1.1" xref="A1.Ex1.m1.8.8.2.1.1.1.1.2.cmml"><msub id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.2" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.2.cmml">ℓ</mi><mrow id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.2" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.1" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.3" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.3.cmml">I</mi></mrow></msub><mo id="A1.Ex1.m1.8.8.2.1.1.1.1.1.2" xref="A1.Ex1.m1.8.8.2.1.1.1.1.2.cmml">,</mo><mi mathvariant="normal" id="A1.Ex1.m1.6.6" xref="A1.Ex1.m1.6.6.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="A1.Ex1.m1.8.8.2.1.1.3" xref="A1.Ex1.m1.8.8.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.8b"><apply id="A1.Ex1.m1.8.8.cmml" xref="A1.Ex1.m1.8.8"><equivalent id="A1.Ex1.m1.8.8.3.cmml" xref="A1.Ex1.m1.8.8.3"></equivalent><apply id="A1.Ex1.m1.7.7.1.cmml" xref="A1.Ex1.m1.7.7.1"><times id="A1.Ex1.m1.7.7.1.2.cmml" xref="A1.Ex1.m1.7.7.1.2"></times><apply id="A1.Ex1.m1.7.7.1.3.cmml" xref="A1.Ex1.m1.7.7.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.7.7.1.3.1.cmml" xref="A1.Ex1.m1.7.7.1.3">subscript</csymbol><ci id="A1.Ex1.m1.7.7.1.3.2.cmml" xref="A1.Ex1.m1.7.7.1.3.2">Δ</ci><list id="A1.Ex1.m1.2.2.2.3.cmml" xref="A1.Ex1.m1.2.2.2.2"><ci id="A1.Ex1.m1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1">𝑘</ci><apply id="A1.Ex1.m1.2.2.2.2.1.cmml" xref="A1.Ex1.m1.2.2.2.2.1"><times id="A1.Ex1.m1.2.2.2.2.1.1.cmml" xref="A1.Ex1.m1.2.2.2.2.1.1"></times><ci id="A1.Ex1.m1.2.2.2.2.1.2.cmml" xref="A1.Ex1.m1.2.2.2.2.1.2">𝑓</ci><ci id="A1.Ex1.m1.2.2.2.2.1.3.cmml" xref="A1.Ex1.m1.2.2.2.2.1.3">𝑒</ci><ci id="A1.Ex1.m1.2.2.2.2.1.4.cmml" xref="A1.Ex1.m1.2.2.2.2.1.4">𝑑</ci><ci id="A1.Ex1.m1.2.2.2.2.1.5.cmml" xref="A1.Ex1.m1.2.2.2.2.1.5">𝑠</ci><ci id="A1.Ex1.m1.2.2.2.2.1.6.cmml" xref="A1.Ex1.m1.2.2.2.2.1.6">𝑔</ci><ci id="A1.Ex1.m1.2.2.2.2.1.7.cmml" xref="A1.Ex1.m1.2.2.2.2.1.7">𝑑</ci></apply></list></apply><apply id="A1.Ex1.m1.7.7.1.1.1.1.cmml" xref="A1.Ex1.m1.7.7.1.1.1"><csymbol cd="latexml" id="A1.Ex1.m1.7.7.1.1.1.1.2.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.2">conditional</csymbol><ci id="A1.Ex1.m1.7.7.1.1.1.1.3.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.3">𝒞</ci><list id="A1.Ex1.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1"><apply id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.2">ℓ</ci><apply id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3"><times id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.1"></times><ci id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.2">𝐵</ci><ci id="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.7.7.1.1.1.1.1.1.1.3.3">𝐼</ci></apply></apply><ci id="A1.Ex1.m1.5.5.cmml" xref="A1.Ex1.m1.5.5">Θ</ci></list></apply></apply><apply id="A1.Ex1.m1.8.8.2.cmml" xref="A1.Ex1.m1.8.8.2"><times id="A1.Ex1.m1.8.8.2.2.cmml" xref="A1.Ex1.m1.8.8.2.2"></times><apply id="A1.Ex1.m1.8.8.2.3.cmml" xref="A1.Ex1.m1.8.8.2.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.8.8.2.3.1.cmml" xref="A1.Ex1.m1.8.8.2.3">subscript</csymbol><ci id="A1.Ex1.m1.8.8.2.3.2.cmml" xref="A1.Ex1.m1.8.8.2.3.2">Δ</ci><list id="A1.Ex1.m1.4.4.2.3.cmml" xref="A1.Ex1.m1.4.4.2.2"><ci id="A1.Ex1.m1.3.3.1.1.cmml" xref="A1.Ex1.m1.3.3.1.1">𝑘</ci><apply id="A1.Ex1.m1.4.4.2.2.1.cmml" xref="A1.Ex1.m1.4.4.2.2.1"><times id="A1.Ex1.m1.4.4.2.2.1.1.cmml" xref="A1.Ex1.m1.4.4.2.2.1.1"></times><ci id="A1.Ex1.m1.4.4.2.2.1.2.cmml" xref="A1.Ex1.m1.4.4.2.2.1.2">𝑠</ci><ci id="A1.Ex1.m1.4.4.2.2.1.3.cmml" xref="A1.Ex1.m1.4.4.2.2.1.3">𝑔</ci><ci id="A1.Ex1.m1.4.4.2.2.1.4.cmml" xref="A1.Ex1.m1.4.4.2.2.1.4">𝑑</ci></apply></list></apply><apply id="A1.Ex1.m1.8.8.2.1.1.1.cmml" xref="A1.Ex1.m1.8.8.2.1.1"><csymbol cd="latexml" id="A1.Ex1.m1.8.8.2.1.1.1.2.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.2">conditional</csymbol><ci id="A1.Ex1.m1.8.8.2.1.1.1.3.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.3">ℰ</ci><list id="A1.Ex1.m1.8.8.2.1.1.1.1.2.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1"><apply id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.2">ℓ</ci><apply id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3"><times id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.1"></times><ci id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.2">𝐵</ci><ci id="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.8.8.2.1.1.1.1.1.1.3.3">𝐼</ci></apply></apply><ci id="A1.Ex1.m1.6.6.cmml" xref="A1.Ex1.m1.6.6">Θ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.8c">\Delta_{k,fedsgd}(\mathcal{C}|\ell_{BI},\Theta)\equiv\Delta_{k,sgd}(\mathcal{E}|\ell_{BI},\Theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.6.p6.2" class="ltx_p">∎</p>
</div>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2108.07930" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2108.07931" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2108.07931">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2108.07931" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2108.07932" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar  6 23:00:01 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
