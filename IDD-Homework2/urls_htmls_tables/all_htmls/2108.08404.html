<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2108.08404] Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE</title><meta property="og:description" content="Anomaly detection has been a challenging task given high-dimensional multivariate time series data generated by networked sensors and actuators in Cyber-Physical Systems (CPS). Besides the highly nonlinear, complex, an…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2108.08404">

<!--Generated on Tue Feb 27 04:04:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Anomaly Detection,  Federate Learning,  Network Security,  Data-efficient Machine Learning
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Variational Learning for Anomaly Detection in Multivariate Time Series
<br class="ltx_break"><span id="id11.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>*These authors contributed equally to this work</span></span></span>
<span id="id12.id2" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>978-1-6654-4331-9/21/$31.00 ©2021 IEEE</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kai Zhang<sup id="id13.11.id1" class="ltx_sup"><span id="id13.11.id1.1" class="ltx_text ltx_font_italic">1∗</span></sup>, Yushan Jiang<sup id="id14.12.id2" class="ltx_sup"><span id="id14.12.id2.1" class="ltx_text ltx_font_italic">1∗</span></sup>, Lee Seversky<sup id="id15.13.id3" class="ltx_sup"><span id="id15.13.id3.1" class="ltx_text ltx_font_italic">2</span></sup>, Chengtao Xu<sup id="id16.14.id4" class="ltx_sup"><span id="id16.14.id4.1" class="ltx_text ltx_font_italic">1</span></sup>, Dahai Liu<sup id="id17.15.id5" class="ltx_sup"><span id="id17.15.id5.1" class="ltx_text ltx_font_italic">1</span></sup>, Houbing Song<sup id="id18.16.id6" class="ltx_sup"><span id="id18.16.id6.1" class="ltx_text ltx_font_italic">1</span></sup>
<br class="ltx_break"><sup id="id19.17.id7" class="ltx_sup"><span id="id19.17.id7.1" class="ltx_text ltx_font_italic">1</span></sup>Embry-Riddle Aeronautical University, Daytona Beach, FL 32114
<br class="ltx_break"><sup id="id20.18.id8" class="ltx_sup"><span id="id20.18.id8.1" class="ltx_text ltx_font_italic">2</span></sup>Air Force Research Laboratory, Rome, NY 13441
<br class="ltx_break"><sup id="id21.19.id9" class="ltx_sup"><span id="id21.19.id9.1" class="ltx_text ltx_font_italic">1</span></sup>{zhangk3, jiangy2, xuc3}@my.erau.edu, dahai.liu@erau.edu, h.song@ieee.org
<br class="ltx_break"><sup id="id22.20.id10" class="ltx_sup"><span id="id22.20.id10.1" class="ltx_text ltx_font_italic">2</span></sup>lee.seversky@us.af.mil
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id23.id1" class="ltx_p">Anomaly detection has been a challenging task given high-dimensional multivariate time series data generated by networked sensors and actuators in Cyber-Physical Systems (CPS). Besides the highly nonlinear, complex, and dynamic nature of such time series, the lack of labeled data impedes data exploitation in a supervised manner and thus prevents an accurate detection of abnormal phenomenons. On the other hand, the collected data at the edge of the network is often privacy sensitive and large in quantity, which may hinder the centralized training at the main server. To tackle these issues, we propose an unsupervised time series anomaly detection framework in a federated fashion to continuously monitor the behaviors of interconnected devices within a network and alert for abnormal incidents so that countermeasures can be taken before undesired consequences occur. To be specific, we leave the training data distributed at the edge to learn a shared Variational Autoencoder (VAE) based on Convolutional Gated Recurrent Unit (ConvGRU) model, which jointly captures feature and temporal dependencies in the multivariate time series data for representation learning and downstream anomaly detection tasks. Experiments on three real-world networked sensor datasets illustrate the advantage of our approach over other state-of-the-art models. We also conduct extensive experiments to demonstrate the effectiveness of our detection framework under non-federated and federated settings in terms of overall performance and detection latency.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Anomaly Detection, Federate Learning, Network Security, Data-efficient Machine Learning

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Anomaly detection has been an important research topic in data mining community, where fruitful progress has been made with a wide range of critical applications in emergent Cyber-Physical Systems (CPS). Efficient and accurate anomaly detection helps to monitor system status continuously and alert for potential incidents so that interposition can be timely executed to mitigate the negative consequential impact <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Meanwhile, a massive amount of multivariate time series data become available with the rising of real-world sensor embedded systems, which favors the utilization of data-driven detection methods. However, this task is challenging due to the nature of collected data from inter-connected sensor networks: the collected data is usually highly imbalanced with very few labeled anomalies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, hindering the usage of supervised learning methods which require sufficient labeled data for model training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>; furthermore, it is hard to detect unseen anomalies without a known priori. Due to these constraints, unsupervised learning appears to be the desired choice in our methodology to detect anomalous events.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A rich body of literature exists on detecting multivariate time series anomalies in an unsupervised way (see <a href="#S2" title="II Related Work ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">§</span> <span class="ltx_text ltx_ref_tag">II</span></a>). The core idea behind these approaches is to <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">learn robust latent representations to capture normal patterns of multivariate time series considering various dependencies.</span> The more different a sample is from the normal patterns, the more likely it is considered as an anomaly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Although many effective algorithms especially deep learning-based methods have been proposed, the authors did not consider the aspect that heterogeneous behaviors of various networks in CPS exist in the form of isolated islands for privacy reasons. On the other hand, newly-deployed devices cannot provide sufficient data in a short time for training a robust anomaly detection model by themselves.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To deal with the data scarcity and privacy-preserving problems, we propose <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">FedAnomaly</span>, an unsupervised federated anomaly detection framework based on Variational Auto-Encoder (VAE) with elaborated Convolutional GRU (ConvGRU). Our approach innovatively glues federated learning and deep generative model with the following two key techniques: (a) We propose to use ConvGRU, a convolution gated sequential learning model, to explicitly and jointly capture temporal and feature-level dependencies in the multivariate time series for representation learning and downstream anomaly detection tasks; and (b) To help capture robust representations of time series at cross-silos, we adopted VAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> with Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, a paradigm aiming at building machine learning models based on distributed datasets across multiple devices while preventing data leakage <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, into an anomaly detection system. In this system, VAE offers a combination of highly flexible non-linear mapping between the latent random state and the observed output that results in effective approximate inference <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
The main contributions of this paper are:</p>
</div>
<div id="S1.p4" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We employ a federated deep generative model for time series anomaly detection for the first time.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">This is the first work leveraging ConvGRU in an outlier detection system to jointly capture the underlying feature-level and temporal patterns of multivariate time series. The experiments on three real-world datasets show that our approach outperforms the state-of-the-art model regarding F1 scores.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Further experiments and analysis demonstrate the effectiveness of our detection framework under non-federated and federated settings in terms of overall evaluation metrics, the detection of contiguous anomaly segments, and detection latency.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The remainder of this paper is organized as follows: Section <a href="#S2" title="II Related Work ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> reviews cutting-edge methods for multivariate time series anomaly detection. Section <a href="#S3" title="III Methodology ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> presents our framework. The experimental setup and results are described in Section <a href="#S4" title="IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>, demonstrating the effectiveness of our framework in multiple aspects. Section <a href="#S5" title="V Conclusions and Future work ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> concludes our paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Abundant literature focuses on multivariate time series anomaly detection. Broadly, they can be classified into two categories, namely <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">predictive models</span> and <span id="S2.p1.1.2" class="ltx_text ltx_font_italic">generative models</span>. In this section, we first review the state-of-the-art approaches based on these two paradigms to detect anomalies in multivariate time series, then discuss pioneering work about outlier identification using federated learning architecture.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Predictive Models</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">A predictive model detects anomalies in terms of prediction error <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Variations of recurrent neural networks (RNNs) such as Long Short-Term Memory (LSTM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and Gated Recurrent Unit (GRU) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> are the most popular methods to predict the next single or multiple time steps in anomaly detection. For example, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> applied LSTM for multivariate time series prediction and identified anomalies in the spacecraft using prediction error with dynamic thresholds. Different from forecasting the future trend of time series, Lin et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> extracted the embedding of the local information over a short window using VAE and employed LSTM to predict the next window’s embedding. Capturing temporal patterns is not the only way to identify outliers in a sequence. Microsoft <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> combined spectral residual (SR) and convolutional neural network (CNN) for time series anomaly detection, in which SR captures the spectrum information (a saliency map) of a sequence, and CNN classifies anomalies. Recently, graph neural network for anomaly detection has been an active research topic since it is intractable for conventional machine learning methods to model complicated dependencies among entities in a network. Deng et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> used a graph structured learning approach with graph attention network to predict the expected behavior of time series, additionally providing explainability for the detected anomalies based on attention weights. Chen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> proposed the influence propagation convolution to model the anomaly information flow between graph nodes for multivariate time series anomaly detection.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Generative Models</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The core idea of generative models is to learn the representation of normal patterns instead of anomalies in a time series. The state-of-the-art deep generative models for anomaly detection include DAGMM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, VAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, and GAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Generally speaking, they all first recognize normal regions in some latent feature spaces, and then evaluate how far an observation is from the normal regions to detect anomalies. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Due to the mode collapse and non-convergence problem of GAN, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> adopted an adversarial strategy to amplify the reconstruction error of inputs containing anomalies. To be specific, two autoencoders are trained to reconstruct normal input, then they are trained in an adversarial way where one autoencoder will seek to fool the other one. A few researchers endeavored to integrate the advantages of predictive and generative manners <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. For instance, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> leveraged a joint optimization target in terms of prediction error and reconstruction error, specifically, the predictive component based on GRU forecasts the value at the next step while the generative component based on VAE obtains the distribution of entire time series.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">It is noteworthy that DAGMM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, which was not designed for multivariate time series, neglects the inherent temporal dependencies of time series. On the contrary, prior works on VAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and GAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> only consider temporal dependency while not explicitly addressing latent interactions among features.
Moreover, despite the great promise of generative models in anomaly detection, simply replacing the feed-forward layer with RNN in a VAE does not perform well according to our experimental results (see <a href="#S4.SS4" title="IV-D Comparison with Baseline Models ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">§</span> <span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-D</span></span></a>). Along this direction, we are interested in developing a generative model which can capture both feature-level and temporal dependencies (see <a href="#S3.SS3" title="III-C Convolutional Gated Recurrent Unit (ConvGRU) ‣ III Methodology ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">§</span> <span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>).</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Federated Learning for Anomaly Detection</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Federated learning (FL) enables a large amount of edge computing devices to jointly learn a model without data sharing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. As a well-known algorithm, FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> runs stochastic gradient descent (SGD) on local devices (say on randomly selected clients) and averages updates per round of communication between parameter server and clients. Such a setting empowers training a robust model for detecting anomalies in CPS since it tackles the data scarcity problem from a privacy-preserving perspective. DÏoT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> firstly employed FL approach to anomaly-detection-based intrusion detection. To alleviate the heterogeneity of network traffic packets from different devices, they mapped packet sequences as symbols, which are then fed into pre-trained GRU model to determine possible intrusions by estimating the occurrence probabilities of each symbol based on its preceding symbols. Communication is the other primary bottleneck for FL since edge devices typically operate at lower rate links that are potentially expensive and unreliable <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Therefore, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> applied sparsification technique to achieve compressed gradients for reducing communication cost. Moreover, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> proposed multi-task federated learning for network anomaly detection, which helps provide more network information such as traffic characteristics to human operators. Different from aforementioned works that focus on federated predictive models, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> adopted a generative model, DAGMM, in a federated fashion. We also propose a federated generative model in the paper, but we use ConvGRU-VAE to capture feature and temporal dependencies jointly. Moreover, we evaluate our model with real-world and high-dimensional network datasets instead of redundant and non-sequential data (say KDD-99) like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Methodology</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we present the problem statement of multivariate time series anomaly detection in the federated learning setting, followed by the overall structure of our system. In addition, we provide an introduction to the key components of our framework in detail.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2108.08404/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="202" height="121" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S3.F1.2.1" class="ltx_text" style="font-size:90%;">The overview of the federated learning paradigm: In our problem setting, each sensor or edge device measures the metric and sends it to the entity server (client). Afterward, the entity server trains the local model on its collected network metrics, and uploads the gradients to the cloud aggregator. There are two procedures on the aggregator side: (a) it initializes the global model and distributes it to edges, and (b) it aggregates the uploaded parameters and sends them back to clients.</span></figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Problem Statement</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In this paper, our objective is to find anomalies in entities based on multivariate time series anomaly detection, which is divided into two stages – training stage and detection stage.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.11" class="ltx_p">In the training stage, our goal is to learn the representation of normal time series. As shown in Fig. <a href="#S3.F1" title="Figure 1 ‣ III Methodology ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the training set consists of the sensor and/or actuator data over a certain period from different entities. To be specific, the training data is defined as: <math id="S3.SS1.p2.1.m1.4" class="ltx_Math" alttext="{\boldsymbol{X}_{train}}=\left(\boldsymbol{X}_{1},\boldsymbol{X}_{2},\ldots,\boldsymbol{X}_{L}\right)^{T}\in\mathbb{R}^{N\times L\times F}" display="inline"><semantics id="S3.SS1.p2.1.m1.4a"><mrow id="S3.SS1.p2.1.m1.4.4" xref="S3.SS1.p2.1.m1.4.4.cmml"><msub id="S3.SS1.p2.1.m1.4.4.5" xref="S3.SS1.p2.1.m1.4.4.5.cmml"><mi id="S3.SS1.p2.1.m1.4.4.5.2" xref="S3.SS1.p2.1.m1.4.4.5.2.cmml">𝑿</mi><mrow id="S3.SS1.p2.1.m1.4.4.5.3" xref="S3.SS1.p2.1.m1.4.4.5.3.cmml"><mi id="S3.SS1.p2.1.m1.4.4.5.3.2" xref="S3.SS1.p2.1.m1.4.4.5.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.4.4.5.3.1" xref="S3.SS1.p2.1.m1.4.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.4.4.5.3.3" xref="S3.SS1.p2.1.m1.4.4.5.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.4.4.5.3.1a" xref="S3.SS1.p2.1.m1.4.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.4.4.5.3.4" xref="S3.SS1.p2.1.m1.4.4.5.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.4.4.5.3.1b" xref="S3.SS1.p2.1.m1.4.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.4.4.5.3.5" xref="S3.SS1.p2.1.m1.4.4.5.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.4.4.5.3.1c" xref="S3.SS1.p2.1.m1.4.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.4.4.5.3.6" xref="S3.SS1.p2.1.m1.4.4.5.3.6.cmml">n</mi></mrow></msub><mo id="S3.SS1.p2.1.m1.4.4.6" xref="S3.SS1.p2.1.m1.4.4.6.cmml">=</mo><msup id="S3.SS1.p2.1.m1.4.4.3" xref="S3.SS1.p2.1.m1.4.4.3.cmml"><mrow id="S3.SS1.p2.1.m1.4.4.3.3.3" xref="S3.SS1.p2.1.m1.4.4.3.3.4.cmml"><mo id="S3.SS1.p2.1.m1.4.4.3.3.3.4" xref="S3.SS1.p2.1.m1.4.4.3.3.4.cmml">(</mo><msub id="S3.SS1.p2.1.m1.2.2.1.1.1.1" xref="S3.SS1.p2.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.2.2.1.1.1.1.2" xref="S3.SS1.p2.1.m1.2.2.1.1.1.1.2.cmml">𝑿</mi><mn id="S3.SS1.p2.1.m1.2.2.1.1.1.1.3" xref="S3.SS1.p2.1.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.1.m1.4.4.3.3.3.5" xref="S3.SS1.p2.1.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.SS1.p2.1.m1.3.3.2.2.2.2" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2.cmml"><mi id="S3.SS1.p2.1.m1.3.3.2.2.2.2.2" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2.2.cmml">𝑿</mi><mn id="S3.SS1.p2.1.m1.3.3.2.2.2.2.3" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p2.1.m1.4.4.3.3.3.6" xref="S3.SS1.p2.1.m1.4.4.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p2.1.m1.4.4.3.3.3.7" xref="S3.SS1.p2.1.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.SS1.p2.1.m1.4.4.3.3.3.3" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.4.4.3.3.3.3.2" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3.2.cmml">𝑿</mi><mi id="S3.SS1.p2.1.m1.4.4.3.3.3.3.3" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3.3.cmml">L</mi></msub><mo id="S3.SS1.p2.1.m1.4.4.3.3.3.8" xref="S3.SS1.p2.1.m1.4.4.3.3.4.cmml">)</mo></mrow><mi id="S3.SS1.p2.1.m1.4.4.3.5" xref="S3.SS1.p2.1.m1.4.4.3.5.cmml">T</mi></msup><mo id="S3.SS1.p2.1.m1.4.4.7" xref="S3.SS1.p2.1.m1.4.4.7.cmml">∈</mo><msup id="S3.SS1.p2.1.m1.4.4.8" xref="S3.SS1.p2.1.m1.4.4.8.cmml"><mi id="S3.SS1.p2.1.m1.4.4.8.2" xref="S3.SS1.p2.1.m1.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.1.m1.4.4.8.3" xref="S3.SS1.p2.1.m1.4.4.8.3.cmml"><mi id="S3.SS1.p2.1.m1.4.4.8.3.2" xref="S3.SS1.p2.1.m1.4.4.8.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.4.4.8.3.1" xref="S3.SS1.p2.1.m1.4.4.8.3.1.cmml">×</mo><mi id="S3.SS1.p2.1.m1.4.4.8.3.3" xref="S3.SS1.p2.1.m1.4.4.8.3.3.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.4.4.8.3.1a" xref="S3.SS1.p2.1.m1.4.4.8.3.1.cmml">×</mo><mi id="S3.SS1.p2.1.m1.4.4.8.3.4" xref="S3.SS1.p2.1.m1.4.4.8.3.4.cmml">F</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.4b"><apply id="S3.SS1.p2.1.m1.4.4.cmml" xref="S3.SS1.p2.1.m1.4.4"><and id="S3.SS1.p2.1.m1.4.4a.cmml" xref="S3.SS1.p2.1.m1.4.4"></and><apply id="S3.SS1.p2.1.m1.4.4b.cmml" xref="S3.SS1.p2.1.m1.4.4"><eq id="S3.SS1.p2.1.m1.4.4.6.cmml" xref="S3.SS1.p2.1.m1.4.4.6"></eq><apply id="S3.SS1.p2.1.m1.4.4.5.cmml" xref="S3.SS1.p2.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.4.4.5.1.cmml" xref="S3.SS1.p2.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS1.p2.1.m1.4.4.5.2.cmml" xref="S3.SS1.p2.1.m1.4.4.5.2">𝑿</ci><apply id="S3.SS1.p2.1.m1.4.4.5.3.cmml" xref="S3.SS1.p2.1.m1.4.4.5.3"><times id="S3.SS1.p2.1.m1.4.4.5.3.1.cmml" xref="S3.SS1.p2.1.m1.4.4.5.3.1"></times><ci id="S3.SS1.p2.1.m1.4.4.5.3.2.cmml" xref="S3.SS1.p2.1.m1.4.4.5.3.2">𝑡</ci><ci id="S3.SS1.p2.1.m1.4.4.5.3.3.cmml" xref="S3.SS1.p2.1.m1.4.4.5.3.3">𝑟</ci><ci id="S3.SS1.p2.1.m1.4.4.5.3.4.cmml" xref="S3.SS1.p2.1.m1.4.4.5.3.4">𝑎</ci><ci id="S3.SS1.p2.1.m1.4.4.5.3.5.cmml" xref="S3.SS1.p2.1.m1.4.4.5.3.5">𝑖</ci><ci id="S3.SS1.p2.1.m1.4.4.5.3.6.cmml" xref="S3.SS1.p2.1.m1.4.4.5.3.6">𝑛</ci></apply></apply><apply id="S3.SS1.p2.1.m1.4.4.3.cmml" xref="S3.SS1.p2.1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.4.4.3.4.cmml" xref="S3.SS1.p2.1.m1.4.4.3">superscript</csymbol><vector id="S3.SS1.p2.1.m1.4.4.3.3.4.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3"><apply id="S3.SS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.1.2">𝑿</ci><cn type="integer" id="S3.SS1.p2.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2.2">𝑿</ci><cn type="integer" id="S3.SS1.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">…</ci><apply id="S3.SS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3.2">𝑿</ci><ci id="S3.SS1.p2.1.m1.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3.3">𝐿</ci></apply></vector><ci id="S3.SS1.p2.1.m1.4.4.3.5.cmml" xref="S3.SS1.p2.1.m1.4.4.3.5">𝑇</ci></apply></apply><apply id="S3.SS1.p2.1.m1.4.4c.cmml" xref="S3.SS1.p2.1.m1.4.4"><in id="S3.SS1.p2.1.m1.4.4.7.cmml" xref="S3.SS1.p2.1.m1.4.4.7"></in><share href="#S3.SS1.p2.1.m1.4.4.3.cmml" id="S3.SS1.p2.1.m1.4.4d.cmml" xref="S3.SS1.p2.1.m1.4.4"></share><apply id="S3.SS1.p2.1.m1.4.4.8.cmml" xref="S3.SS1.p2.1.m1.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.4.4.8.1.cmml" xref="S3.SS1.p2.1.m1.4.4.8">superscript</csymbol><ci id="S3.SS1.p2.1.m1.4.4.8.2.cmml" xref="S3.SS1.p2.1.m1.4.4.8.2">ℝ</ci><apply id="S3.SS1.p2.1.m1.4.4.8.3.cmml" xref="S3.SS1.p2.1.m1.4.4.8.3"><times id="S3.SS1.p2.1.m1.4.4.8.3.1.cmml" xref="S3.SS1.p2.1.m1.4.4.8.3.1"></times><ci id="S3.SS1.p2.1.m1.4.4.8.3.2.cmml" xref="S3.SS1.p2.1.m1.4.4.8.3.2">𝑁</ci><ci id="S3.SS1.p2.1.m1.4.4.8.3.3.cmml" xref="S3.SS1.p2.1.m1.4.4.8.3.3">𝐿</ci><ci id="S3.SS1.p2.1.m1.4.4.8.3.4.cmml" xref="S3.SS1.p2.1.m1.4.4.8.3.4">𝐹</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.4c">{\boldsymbol{X}_{train}}=\left(\boldsymbol{X}_{1},\boldsymbol{X}_{2},\ldots,\boldsymbol{X}_{L}\right)^{T}\in\mathbb{R}^{N\times L\times F}</annotation></semantics></math>, where <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">N</annotation></semantics></math> denotes the number of entities, <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">F</annotation></semantics></math> denotes the number of (sensor) metrics of each entity, and <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">L</annotation></semantics></math> denotes the number of timestamps in a training sequence. For each timestamp <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">t</annotation></semantics></math>, <math id="S3.SS1.p2.6.m6.4" class="ltx_Math" alttext="\boldsymbol{X}_{t}=\left(\boldsymbol{x}_{t}^{1},\boldsymbol{x}_{t}^{2},\ldots,\boldsymbol{x}_{t}^{N}\right)^{T}\in\mathbb{R}^{N\times F}" display="inline"><semantics id="S3.SS1.p2.6.m6.4a"><mrow id="S3.SS1.p2.6.m6.4.4" xref="S3.SS1.p2.6.m6.4.4.cmml"><msub id="S3.SS1.p2.6.m6.4.4.5" xref="S3.SS1.p2.6.m6.4.4.5.cmml"><mi id="S3.SS1.p2.6.m6.4.4.5.2" xref="S3.SS1.p2.6.m6.4.4.5.2.cmml">𝑿</mi><mi id="S3.SS1.p2.6.m6.4.4.5.3" xref="S3.SS1.p2.6.m6.4.4.5.3.cmml">t</mi></msub><mo id="S3.SS1.p2.6.m6.4.4.6" xref="S3.SS1.p2.6.m6.4.4.6.cmml">=</mo><msup id="S3.SS1.p2.6.m6.4.4.3" xref="S3.SS1.p2.6.m6.4.4.3.cmml"><mrow id="S3.SS1.p2.6.m6.4.4.3.3.3" xref="S3.SS1.p2.6.m6.4.4.3.3.4.cmml"><mo id="S3.SS1.p2.6.m6.4.4.3.3.3.4" xref="S3.SS1.p2.6.m6.4.4.3.3.4.cmml">(</mo><msubsup id="S3.SS1.p2.6.m6.2.2.1.1.1.1" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.2" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.3" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.3.cmml">t</mi><mn id="S3.SS1.p2.6.m6.2.2.1.1.1.1.3" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p2.6.m6.4.4.3.3.3.5" xref="S3.SS1.p2.6.m6.4.4.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p2.6.m6.3.3.2.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml"><mi id="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.2.cmml">𝒙</mi><mi id="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.3" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.3.cmml">t</mi><mn id="S3.SS1.p2.6.m6.3.3.2.2.2.2.3" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p2.6.m6.4.4.3.3.3.6" xref="S3.SS1.p2.6.m6.4.4.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">…</mi><mo id="S3.SS1.p2.6.m6.4.4.3.3.3.7" xref="S3.SS1.p2.6.m6.4.4.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p2.6.m6.4.4.3.3.3.3" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.2" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.2.cmml">𝒙</mi><mi id="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.3" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.3.cmml">t</mi><mi id="S3.SS1.p2.6.m6.4.4.3.3.3.3.3" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.3.cmml">N</mi></msubsup><mo id="S3.SS1.p2.6.m6.4.4.3.3.3.8" xref="S3.SS1.p2.6.m6.4.4.3.3.4.cmml">)</mo></mrow><mi id="S3.SS1.p2.6.m6.4.4.3.5" xref="S3.SS1.p2.6.m6.4.4.3.5.cmml">T</mi></msup><mo id="S3.SS1.p2.6.m6.4.4.7" xref="S3.SS1.p2.6.m6.4.4.7.cmml">∈</mo><msup id="S3.SS1.p2.6.m6.4.4.8" xref="S3.SS1.p2.6.m6.4.4.8.cmml"><mi id="S3.SS1.p2.6.m6.4.4.8.2" xref="S3.SS1.p2.6.m6.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.6.m6.4.4.8.3" xref="S3.SS1.p2.6.m6.4.4.8.3.cmml"><mi id="S3.SS1.p2.6.m6.4.4.8.3.2" xref="S3.SS1.p2.6.m6.4.4.8.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.6.m6.4.4.8.3.1" xref="S3.SS1.p2.6.m6.4.4.8.3.1.cmml">×</mo><mi id="S3.SS1.p2.6.m6.4.4.8.3.3" xref="S3.SS1.p2.6.m6.4.4.8.3.3.cmml">F</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.4b"><apply id="S3.SS1.p2.6.m6.4.4.cmml" xref="S3.SS1.p2.6.m6.4.4"><and id="S3.SS1.p2.6.m6.4.4a.cmml" xref="S3.SS1.p2.6.m6.4.4"></and><apply id="S3.SS1.p2.6.m6.4.4b.cmml" xref="S3.SS1.p2.6.m6.4.4"><eq id="S3.SS1.p2.6.m6.4.4.6.cmml" xref="S3.SS1.p2.6.m6.4.4.6"></eq><apply id="S3.SS1.p2.6.m6.4.4.5.cmml" xref="S3.SS1.p2.6.m6.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.4.4.5.1.cmml" xref="S3.SS1.p2.6.m6.4.4.5">subscript</csymbol><ci id="S3.SS1.p2.6.m6.4.4.5.2.cmml" xref="S3.SS1.p2.6.m6.4.4.5.2">𝑿</ci><ci id="S3.SS1.p2.6.m6.4.4.5.3.cmml" xref="S3.SS1.p2.6.m6.4.4.5.3">𝑡</ci></apply><apply id="S3.SS1.p2.6.m6.4.4.3.cmml" xref="S3.SS1.p2.6.m6.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.4.4.3.4.cmml" xref="S3.SS1.p2.6.m6.4.4.3">superscript</csymbol><vector id="S3.SS1.p2.6.m6.4.4.3.3.4.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3"><apply id="S3.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.2">𝒙</ci><ci id="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.2">𝒙</ci><ci id="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.p2.6.m6.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">…</ci><apply id="S3.SS1.p2.6.m6.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3">superscript</csymbol><apply id="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.1.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.2.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.2">𝒙</ci><ci id="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.3.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.6.m6.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.3">𝑁</ci></apply></vector><ci id="S3.SS1.p2.6.m6.4.4.3.5.cmml" xref="S3.SS1.p2.6.m6.4.4.3.5">𝑇</ci></apply></apply><apply id="S3.SS1.p2.6.m6.4.4c.cmml" xref="S3.SS1.p2.6.m6.4.4"><in id="S3.SS1.p2.6.m6.4.4.7.cmml" xref="S3.SS1.p2.6.m6.4.4.7"></in><share href="#S3.SS1.p2.6.m6.4.4.3.cmml" id="S3.SS1.p2.6.m6.4.4d.cmml" xref="S3.SS1.p2.6.m6.4.4"></share><apply id="S3.SS1.p2.6.m6.4.4.8.cmml" xref="S3.SS1.p2.6.m6.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.4.4.8.1.cmml" xref="S3.SS1.p2.6.m6.4.4.8">superscript</csymbol><ci id="S3.SS1.p2.6.m6.4.4.8.2.cmml" xref="S3.SS1.p2.6.m6.4.4.8.2">ℝ</ci><apply id="S3.SS1.p2.6.m6.4.4.8.3.cmml" xref="S3.SS1.p2.6.m6.4.4.8.3"><times id="S3.SS1.p2.6.m6.4.4.8.3.1.cmml" xref="S3.SS1.p2.6.m6.4.4.8.3.1"></times><ci id="S3.SS1.p2.6.m6.4.4.8.3.2.cmml" xref="S3.SS1.p2.6.m6.4.4.8.3.2">𝑁</ci><ci id="S3.SS1.p2.6.m6.4.4.8.3.3.cmml" xref="S3.SS1.p2.6.m6.4.4.8.3.3">𝐹</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.4c">\boldsymbol{X}_{t}=\left(\boldsymbol{x}_{t}^{1},\boldsymbol{x}_{t}^{2},\ldots,\boldsymbol{x}_{t}^{N}\right)^{T}\in\mathbb{R}^{N\times F}</annotation></semantics></math> denotes the status of the whole network with all metrics of all entities, where <math id="S3.SS1.p2.7.m7.7" class="ltx_Math" alttext="\boldsymbol{x}_{t}^{i}=\left(\boldsymbol{x}_{t}^{i,1},\ldots,\boldsymbol{x}_{t}^{i,F}\right)^{T}\in\mathbb{R}^{F}" display="inline"><semantics id="S3.SS1.p2.7.m7.7a"><mrow id="S3.SS1.p2.7.m7.7.7" xref="S3.SS1.p2.7.m7.7.7.cmml"><msubsup id="S3.SS1.p2.7.m7.7.7.4" xref="S3.SS1.p2.7.m7.7.7.4.cmml"><mi id="S3.SS1.p2.7.m7.7.7.4.2.2" xref="S3.SS1.p2.7.m7.7.7.4.2.2.cmml">𝒙</mi><mi id="S3.SS1.p2.7.m7.7.7.4.2.3" xref="S3.SS1.p2.7.m7.7.7.4.2.3.cmml">t</mi><mi id="S3.SS1.p2.7.m7.7.7.4.3" xref="S3.SS1.p2.7.m7.7.7.4.3.cmml">i</mi></msubsup><mo id="S3.SS1.p2.7.m7.7.7.5" xref="S3.SS1.p2.7.m7.7.7.5.cmml">=</mo><msup id="S3.SS1.p2.7.m7.7.7.2" xref="S3.SS1.p2.7.m7.7.7.2.cmml"><mrow id="S3.SS1.p2.7.m7.7.7.2.2.2" xref="S3.SS1.p2.7.m7.7.7.2.2.3.cmml"><mo id="S3.SS1.p2.7.m7.7.7.2.2.2.3" xref="S3.SS1.p2.7.m7.7.7.2.2.3.cmml">(</mo><msubsup id="S3.SS1.p2.7.m7.6.6.1.1.1.1" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1.cmml"><mi id="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.2" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.3" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS1.p2.7.m7.2.2.2.4" xref="S3.SS1.p2.7.m7.2.2.2.3.cmml"><mi id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.7.m7.2.2.2.4.1" xref="S3.SS1.p2.7.m7.2.2.2.3.cmml">,</mo><mn id="S3.SS1.p2.7.m7.2.2.2.2" xref="S3.SS1.p2.7.m7.2.2.2.2.cmml">1</mn></mrow></msubsup><mo id="S3.SS1.p2.7.m7.7.7.2.2.2.4" xref="S3.SS1.p2.7.m7.7.7.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.7.m7.5.5" xref="S3.SS1.p2.7.m7.5.5.cmml">…</mi><mo id="S3.SS1.p2.7.m7.7.7.2.2.2.5" xref="S3.SS1.p2.7.m7.7.7.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p2.7.m7.7.7.2.2.2.2" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2.cmml"><mi id="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.2" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.2.cmml">𝒙</mi><mi id="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.3" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.3.cmml">t</mi><mrow id="S3.SS1.p2.7.m7.4.4.2.4" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml"><mi id="S3.SS1.p2.7.m7.3.3.1.1" xref="S3.SS1.p2.7.m7.3.3.1.1.cmml">i</mi><mo id="S3.SS1.p2.7.m7.4.4.2.4.1" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p2.7.m7.4.4.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.cmml">F</mi></mrow></msubsup><mo id="S3.SS1.p2.7.m7.7.7.2.2.2.6" xref="S3.SS1.p2.7.m7.7.7.2.2.3.cmml">)</mo></mrow><mi id="S3.SS1.p2.7.m7.7.7.2.4" xref="S3.SS1.p2.7.m7.7.7.2.4.cmml">T</mi></msup><mo id="S3.SS1.p2.7.m7.7.7.6" xref="S3.SS1.p2.7.m7.7.7.6.cmml">∈</mo><msup id="S3.SS1.p2.7.m7.7.7.7" xref="S3.SS1.p2.7.m7.7.7.7.cmml"><mi id="S3.SS1.p2.7.m7.7.7.7.2" xref="S3.SS1.p2.7.m7.7.7.7.2.cmml">ℝ</mi><mi id="S3.SS1.p2.7.m7.7.7.7.3" xref="S3.SS1.p2.7.m7.7.7.7.3.cmml">F</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.7b"><apply id="S3.SS1.p2.7.m7.7.7.cmml" xref="S3.SS1.p2.7.m7.7.7"><and id="S3.SS1.p2.7.m7.7.7a.cmml" xref="S3.SS1.p2.7.m7.7.7"></and><apply id="S3.SS1.p2.7.m7.7.7b.cmml" xref="S3.SS1.p2.7.m7.7.7"><eq id="S3.SS1.p2.7.m7.7.7.5.cmml" xref="S3.SS1.p2.7.m7.7.7.5"></eq><apply id="S3.SS1.p2.7.m7.7.7.4.cmml" xref="S3.SS1.p2.7.m7.7.7.4"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.7.7.4.1.cmml" xref="S3.SS1.p2.7.m7.7.7.4">superscript</csymbol><apply id="S3.SS1.p2.7.m7.7.7.4.2.cmml" xref="S3.SS1.p2.7.m7.7.7.4"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.7.7.4.2.1.cmml" xref="S3.SS1.p2.7.m7.7.7.4">subscript</csymbol><ci id="S3.SS1.p2.7.m7.7.7.4.2.2.cmml" xref="S3.SS1.p2.7.m7.7.7.4.2.2">𝒙</ci><ci id="S3.SS1.p2.7.m7.7.7.4.2.3.cmml" xref="S3.SS1.p2.7.m7.7.7.4.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.7.m7.7.7.4.3.cmml" xref="S3.SS1.p2.7.m7.7.7.4.3">𝑖</ci></apply><apply id="S3.SS1.p2.7.m7.7.7.2.cmml" xref="S3.SS1.p2.7.m7.7.7.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.7.7.2.3.cmml" xref="S3.SS1.p2.7.m7.7.7.2">superscript</csymbol><vector id="S3.SS1.p2.7.m7.7.7.2.2.3.cmml" xref="S3.SS1.p2.7.m7.7.7.2.2.2"><apply id="S3.SS1.p2.7.m7.6.6.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.6.6.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.2">𝒙</ci><ci id="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.7.m7.6.6.1.1.1.1.2.3">𝑡</ci></apply><list id="S3.SS1.p2.7.m7.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.2.2.2.4"><ci id="S3.SS1.p2.7.m7.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1">𝑖</ci><cn type="integer" id="S3.SS1.p2.7.m7.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.2.2.2.2">1</cn></list></apply><ci id="S3.SS1.p2.7.m7.5.5.cmml" xref="S3.SS1.p2.7.m7.5.5">…</ci><apply id="S3.SS1.p2.7.m7.7.7.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.7.7.2.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.2">𝒙</ci><ci id="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.7.7.2.2.2.2.2.3">𝑡</ci></apply><list id="S3.SS1.p2.7.m7.4.4.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4"><ci id="S3.SS1.p2.7.m7.3.3.1.1.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1">𝑖</ci><ci id="S3.SS1.p2.7.m7.4.4.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2">𝐹</ci></list></apply></vector><ci id="S3.SS1.p2.7.m7.7.7.2.4.cmml" xref="S3.SS1.p2.7.m7.7.7.2.4">𝑇</ci></apply></apply><apply id="S3.SS1.p2.7.m7.7.7c.cmml" xref="S3.SS1.p2.7.m7.7.7"><in id="S3.SS1.p2.7.m7.7.7.6.cmml" xref="S3.SS1.p2.7.m7.7.7.6"></in><share href="#S3.SS1.p2.7.m7.7.7.2.cmml" id="S3.SS1.p2.7.m7.7.7d.cmml" xref="S3.SS1.p2.7.m7.7.7"></share><apply id="S3.SS1.p2.7.m7.7.7.7.cmml" xref="S3.SS1.p2.7.m7.7.7.7"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.7.7.7.1.cmml" xref="S3.SS1.p2.7.m7.7.7.7">superscript</csymbol><ci id="S3.SS1.p2.7.m7.7.7.7.2.cmml" xref="S3.SS1.p2.7.m7.7.7.7.2">ℝ</ci><ci id="S3.SS1.p2.7.m7.7.7.7.3.cmml" xref="S3.SS1.p2.7.m7.7.7.7.3">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.7c">\boldsymbol{x}_{t}^{i}=\left(\boldsymbol{x}_{t}^{i,1},\ldots,\boldsymbol{x}_{t}^{i,F}\right)^{T}\in\mathbb{R}^{F}</annotation></semantics></math> denotes all metrics of entity <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">i</annotation></semantics></math> at timestamp <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">t</annotation></semantics></math> and <math id="S3.SS1.p2.10.m10.2" class="ltx_Math" alttext="\boldsymbol{x}_{t}^{i,j}\in\mathbb{R}" display="inline"><semantics id="S3.SS1.p2.10.m10.2a"><mrow id="S3.SS1.p2.10.m10.2.3" xref="S3.SS1.p2.10.m10.2.3.cmml"><msubsup id="S3.SS1.p2.10.m10.2.3.2" xref="S3.SS1.p2.10.m10.2.3.2.cmml"><mi id="S3.SS1.p2.10.m10.2.3.2.2.2" xref="S3.SS1.p2.10.m10.2.3.2.2.2.cmml">𝒙</mi><mi id="S3.SS1.p2.10.m10.2.3.2.2.3" xref="S3.SS1.p2.10.m10.2.3.2.2.3.cmml">t</mi><mrow id="S3.SS1.p2.10.m10.2.2.2.4" xref="S3.SS1.p2.10.m10.2.2.2.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.10.m10.2.2.2.4.1" xref="S3.SS1.p2.10.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.10.m10.2.2.2.2" xref="S3.SS1.p2.10.m10.2.2.2.2.cmml">j</mi></mrow></msubsup><mo id="S3.SS1.p2.10.m10.2.3.1" xref="S3.SS1.p2.10.m10.2.3.1.cmml">∈</mo><mi id="S3.SS1.p2.10.m10.2.3.3" xref="S3.SS1.p2.10.m10.2.3.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.2b"><apply id="S3.SS1.p2.10.m10.2.3.cmml" xref="S3.SS1.p2.10.m10.2.3"><in id="S3.SS1.p2.10.m10.2.3.1.cmml" xref="S3.SS1.p2.10.m10.2.3.1"></in><apply id="S3.SS1.p2.10.m10.2.3.2.cmml" xref="S3.SS1.p2.10.m10.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.2.3.2.1.cmml" xref="S3.SS1.p2.10.m10.2.3.2">superscript</csymbol><apply id="S3.SS1.p2.10.m10.2.3.2.2.cmml" xref="S3.SS1.p2.10.m10.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.2.3.2.2.1.cmml" xref="S3.SS1.p2.10.m10.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.10.m10.2.3.2.2.2.cmml" xref="S3.SS1.p2.10.m10.2.3.2.2.2">𝒙</ci><ci id="S3.SS1.p2.10.m10.2.3.2.2.3.cmml" xref="S3.SS1.p2.10.m10.2.3.2.2.3">𝑡</ci></apply><list id="S3.SS1.p2.10.m10.2.2.2.3.cmml" xref="S3.SS1.p2.10.m10.2.2.2.4"><ci id="S3.SS1.p2.10.m10.1.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1">𝑖</ci><ci id="S3.SS1.p2.10.m10.2.2.2.2.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2">𝑗</ci></list></apply><ci id="S3.SS1.p2.10.m10.2.3.3.cmml" xref="S3.SS1.p2.10.m10.2.3.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.2c">\boldsymbol{x}_{t}^{i,j}\in\mathbb{R}</annotation></semantics></math> denotes the value of the corresponding <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><mi id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">j</annotation></semantics></math>-th metric. Considering the commonly used formulation in anomaly detection tasks and the existence of high imbalance between normal and anomalous samples in the most realistic scenarios, the training data on the client is set to contain normal data only without any anomalies.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.7" class="ltx_p">In the detection stage, our target is to find anomalies in the testing data which is from the same entities with the same metrics but collected from a different period. Similar to the training data, the testing data is defined as <math id="S3.SS1.p3.1.m1.4" class="ltx_Math" alttext="{\boldsymbol{X}_{test}}=\left(\boldsymbol{X}_{1},\boldsymbol{X}_{2},\ldots,\boldsymbol{X}_{L^{\prime}}\right)^{T}\in\mathbb{R}^{N\times{L^{\prime}}\times F}" display="inline"><semantics id="S3.SS1.p3.1.m1.4a"><mrow id="S3.SS1.p3.1.m1.4.4" xref="S3.SS1.p3.1.m1.4.4.cmml"><msub id="S3.SS1.p3.1.m1.4.4.5" xref="S3.SS1.p3.1.m1.4.4.5.cmml"><mi id="S3.SS1.p3.1.m1.4.4.5.2" xref="S3.SS1.p3.1.m1.4.4.5.2.cmml">𝑿</mi><mrow id="S3.SS1.p3.1.m1.4.4.5.3" xref="S3.SS1.p3.1.m1.4.4.5.3.cmml"><mi id="S3.SS1.p3.1.m1.4.4.5.3.2" xref="S3.SS1.p3.1.m1.4.4.5.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.4.4.5.3.1" xref="S3.SS1.p3.1.m1.4.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.4.4.5.3.3" xref="S3.SS1.p3.1.m1.4.4.5.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.4.4.5.3.1a" xref="S3.SS1.p3.1.m1.4.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.4.4.5.3.4" xref="S3.SS1.p3.1.m1.4.4.5.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.4.4.5.3.1b" xref="S3.SS1.p3.1.m1.4.4.5.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.4.4.5.3.5" xref="S3.SS1.p3.1.m1.4.4.5.3.5.cmml">t</mi></mrow></msub><mo id="S3.SS1.p3.1.m1.4.4.6" xref="S3.SS1.p3.1.m1.4.4.6.cmml">=</mo><msup id="S3.SS1.p3.1.m1.4.4.3" xref="S3.SS1.p3.1.m1.4.4.3.cmml"><mrow id="S3.SS1.p3.1.m1.4.4.3.3.3" xref="S3.SS1.p3.1.m1.4.4.3.3.4.cmml"><mo id="S3.SS1.p3.1.m1.4.4.3.3.3.4" xref="S3.SS1.p3.1.m1.4.4.3.3.4.cmml">(</mo><msub id="S3.SS1.p3.1.m1.2.2.1.1.1.1" xref="S3.SS1.p3.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.2.2.1.1.1.1.2" xref="S3.SS1.p3.1.m1.2.2.1.1.1.1.2.cmml">𝑿</mi><mn id="S3.SS1.p3.1.m1.2.2.1.1.1.1.3" xref="S3.SS1.p3.1.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p3.1.m1.4.4.3.3.3.5" xref="S3.SS1.p3.1.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.SS1.p3.1.m1.3.3.2.2.2.2" xref="S3.SS1.p3.1.m1.3.3.2.2.2.2.cmml"><mi id="S3.SS1.p3.1.m1.3.3.2.2.2.2.2" xref="S3.SS1.p3.1.m1.3.3.2.2.2.2.2.cmml">𝑿</mi><mn id="S3.SS1.p3.1.m1.3.3.2.2.2.2.3" xref="S3.SS1.p3.1.m1.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p3.1.m1.4.4.3.3.3.6" xref="S3.SS1.p3.1.m1.4.4.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p3.1.m1.4.4.3.3.3.7" xref="S3.SS1.p3.1.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.SS1.p3.1.m1.4.4.3.3.3.3" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p3.1.m1.4.4.3.3.3.3.2" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.2.cmml">𝑿</mi><msup id="S3.SS1.p3.1.m1.4.4.3.3.3.3.3" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.cmml"><mi id="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.2" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.2.cmml">L</mi><mo id="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.3" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.3.cmml">′</mo></msup></msub><mo id="S3.SS1.p3.1.m1.4.4.3.3.3.8" xref="S3.SS1.p3.1.m1.4.4.3.3.4.cmml">)</mo></mrow><mi id="S3.SS1.p3.1.m1.4.4.3.5" xref="S3.SS1.p3.1.m1.4.4.3.5.cmml">T</mi></msup><mo id="S3.SS1.p3.1.m1.4.4.7" xref="S3.SS1.p3.1.m1.4.4.7.cmml">∈</mo><msup id="S3.SS1.p3.1.m1.4.4.8" xref="S3.SS1.p3.1.m1.4.4.8.cmml"><mi id="S3.SS1.p3.1.m1.4.4.8.2" xref="S3.SS1.p3.1.m1.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.1.m1.4.4.8.3" xref="S3.SS1.p3.1.m1.4.4.8.3.cmml"><mi id="S3.SS1.p3.1.m1.4.4.8.3.2" xref="S3.SS1.p3.1.m1.4.4.8.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.1.m1.4.4.8.3.1" xref="S3.SS1.p3.1.m1.4.4.8.3.1.cmml">×</mo><msup id="S3.SS1.p3.1.m1.4.4.8.3.3" xref="S3.SS1.p3.1.m1.4.4.8.3.3.cmml"><mi id="S3.SS1.p3.1.m1.4.4.8.3.3.2" xref="S3.SS1.p3.1.m1.4.4.8.3.3.2.cmml">L</mi><mo id="S3.SS1.p3.1.m1.4.4.8.3.3.3" xref="S3.SS1.p3.1.m1.4.4.8.3.3.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.1.m1.4.4.8.3.1a" xref="S3.SS1.p3.1.m1.4.4.8.3.1.cmml">×</mo><mi id="S3.SS1.p3.1.m1.4.4.8.3.4" xref="S3.SS1.p3.1.m1.4.4.8.3.4.cmml">F</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.4b"><apply id="S3.SS1.p3.1.m1.4.4.cmml" xref="S3.SS1.p3.1.m1.4.4"><and id="S3.SS1.p3.1.m1.4.4a.cmml" xref="S3.SS1.p3.1.m1.4.4"></and><apply id="S3.SS1.p3.1.m1.4.4b.cmml" xref="S3.SS1.p3.1.m1.4.4"><eq id="S3.SS1.p3.1.m1.4.4.6.cmml" xref="S3.SS1.p3.1.m1.4.4.6"></eq><apply id="S3.SS1.p3.1.m1.4.4.5.cmml" xref="S3.SS1.p3.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.4.4.5.1.cmml" xref="S3.SS1.p3.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS1.p3.1.m1.4.4.5.2.cmml" xref="S3.SS1.p3.1.m1.4.4.5.2">𝑿</ci><apply id="S3.SS1.p3.1.m1.4.4.5.3.cmml" xref="S3.SS1.p3.1.m1.4.4.5.3"><times id="S3.SS1.p3.1.m1.4.4.5.3.1.cmml" xref="S3.SS1.p3.1.m1.4.4.5.3.1"></times><ci id="S3.SS1.p3.1.m1.4.4.5.3.2.cmml" xref="S3.SS1.p3.1.m1.4.4.5.3.2">𝑡</ci><ci id="S3.SS1.p3.1.m1.4.4.5.3.3.cmml" xref="S3.SS1.p3.1.m1.4.4.5.3.3">𝑒</ci><ci id="S3.SS1.p3.1.m1.4.4.5.3.4.cmml" xref="S3.SS1.p3.1.m1.4.4.5.3.4">𝑠</ci><ci id="S3.SS1.p3.1.m1.4.4.5.3.5.cmml" xref="S3.SS1.p3.1.m1.4.4.5.3.5">𝑡</ci></apply></apply><apply id="S3.SS1.p3.1.m1.4.4.3.cmml" xref="S3.SS1.p3.1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.4.4.3.4.cmml" xref="S3.SS1.p3.1.m1.4.4.3">superscript</csymbol><vector id="S3.SS1.p3.1.m1.4.4.3.3.4.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3"><apply id="S3.SS1.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1.1.1.2">𝑿</ci><cn type="integer" id="S3.SS1.p3.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.3.3.2.2.2.2.2">𝑿</ci><cn type="integer" id="S3.SS1.p3.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">…</ci><apply id="S3.SS1.p3.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.2">𝑿</ci><apply id="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.3">superscript</csymbol><ci id="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.2.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.2">𝐿</ci><ci id="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.3.cmml" xref="S3.SS1.p3.1.m1.4.4.3.3.3.3.3.3">′</ci></apply></apply></vector><ci id="S3.SS1.p3.1.m1.4.4.3.5.cmml" xref="S3.SS1.p3.1.m1.4.4.3.5">𝑇</ci></apply></apply><apply id="S3.SS1.p3.1.m1.4.4c.cmml" xref="S3.SS1.p3.1.m1.4.4"><in id="S3.SS1.p3.1.m1.4.4.7.cmml" xref="S3.SS1.p3.1.m1.4.4.7"></in><share href="#S3.SS1.p3.1.m1.4.4.3.cmml" id="S3.SS1.p3.1.m1.4.4d.cmml" xref="S3.SS1.p3.1.m1.4.4"></share><apply id="S3.SS1.p3.1.m1.4.4.8.cmml" xref="S3.SS1.p3.1.m1.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.4.4.8.1.cmml" xref="S3.SS1.p3.1.m1.4.4.8">superscript</csymbol><ci id="S3.SS1.p3.1.m1.4.4.8.2.cmml" xref="S3.SS1.p3.1.m1.4.4.8.2">ℝ</ci><apply id="S3.SS1.p3.1.m1.4.4.8.3.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3"><times id="S3.SS1.p3.1.m1.4.4.8.3.1.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3.1"></times><ci id="S3.SS1.p3.1.m1.4.4.8.3.2.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3.2">𝑁</ci><apply id="S3.SS1.p3.1.m1.4.4.8.3.3.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.4.4.8.3.3.1.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3.3">superscript</csymbol><ci id="S3.SS1.p3.1.m1.4.4.8.3.3.2.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3.3.2">𝐿</ci><ci id="S3.SS1.p3.1.m1.4.4.8.3.3.3.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3.3.3">′</ci></apply><ci id="S3.SS1.p3.1.m1.4.4.8.3.4.cmml" xref="S3.SS1.p3.1.m1.4.4.8.3.4">𝐹</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.4c">{\boldsymbol{X}_{test}}=\left(\boldsymbol{X}_{1},\boldsymbol{X}_{2},\ldots,\boldsymbol{X}_{L^{\prime}}\right)^{T}\in\mathbb{R}^{N\times{L^{\prime}}\times F}</annotation></semantics></math>, where <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="L^{\prime}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msup id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">L</mi><mo id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐿</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">L^{\prime}</annotation></semantics></math> is the length of a testing sequence. The testing data is usually distributed on different entities in practice. For multivariate time series anomaly detection, at a timestamp <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="t^{\prime}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msup id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑡</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">t^{\prime}</annotation></semantics></math>, the preceding sequential observations <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="{\boldsymbol{X}_{t^{\prime}-L^{\prime}:t^{\prime}}}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">𝑿</mi><mrow id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><mrow id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2.cmml"><msup id="S3.SS1.p3.4.m4.1.1.3.2.2" xref="S3.SS1.p3.4.m4.1.1.3.2.2.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.2.2.2" xref="S3.SS1.p3.4.m4.1.1.3.2.2.2.cmml">t</mi><mo id="S3.SS1.p3.4.m4.1.1.3.2.2.3" xref="S3.SS1.p3.4.m4.1.1.3.2.2.3.cmml">′</mo></msup><mo id="S3.SS1.p3.4.m4.1.1.3.2.1" xref="S3.SS1.p3.4.m4.1.1.3.2.1.cmml">−</mo><msup id="S3.SS1.p3.4.m4.1.1.3.2.3" xref="S3.SS1.p3.4.m4.1.1.3.2.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.2.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2.3.2.cmml">L</mi><mo id="S3.SS1.p3.4.m4.1.1.3.2.3.3" xref="S3.SS1.p3.4.m4.1.1.3.2.3.3.cmml">′</mo></msup></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p3.4.m4.1.1.3.1" xref="S3.SS1.p3.4.m4.1.1.3.1.cmml">:</mo><msup id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.3.2" xref="S3.SS1.p3.4.m4.1.1.3.3.2.cmml">t</mi><mo id="S3.SS1.p3.4.m4.1.1.3.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑿</ci><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><ci id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.1">:</ci><apply id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2"><minus id="S3.SS1.p3.4.m4.1.1.3.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.1"></minus><apply id="S3.SS1.p3.4.m4.1.1.3.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.2.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.2">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.2.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.2.2">𝑡</ci><ci id="S3.SS1.p3.4.m4.1.1.3.2.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.2.3">′</ci></apply><apply id="S3.SS1.p3.4.m4.1.1.3.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.2.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.3">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.2.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.3.2">𝐿</ci><ci id="S3.SS1.p3.4.m4.1.1.3.2.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2.3.3">′</ci></apply></apply><apply id="S3.SS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.2">𝑡</ci><ci id="S3.SS1.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">{\boldsymbol{X}_{t^{\prime}-L^{\prime}:t^{\prime}}}</annotation></semantics></math> are used to determine whether an observation <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="{\boldsymbol{X}_{t^{\prime}}}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><msub id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">𝑿</mi><msup id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.2" xref="S3.SS1.p3.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p3.5.m5.1.1.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">𝑿</ci><apply id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">{\boldsymbol{X}_{t^{\prime}}}</annotation></semantics></math> is anomalous (<math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="y_{t^{\prime}}=1" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mrow id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><msub id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2.2" xref="S3.SS1.p3.6.m6.1.1.2.2.cmml">y</mi><msup id="S3.SS1.p3.6.m6.1.1.2.3" xref="S3.SS1.p3.6.m6.1.1.2.3.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2.3.2" xref="S3.SS1.p3.6.m6.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.6.m6.1.1.2.3.3" xref="S3.SS1.p3.6.m6.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="S3.SS1.p3.6.m6.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><eq id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1"></eq><apply id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.2.1.cmml" xref="S3.SS1.p3.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2.2">𝑦</ci><apply id="S3.SS1.p3.6.m6.1.1.2.3.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.2.3.1.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3">superscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.3.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.p3.6.m6.1.1.2.3.3.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3.3">′</ci></apply></apply><cn type="integer" id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">y_{t^{\prime}}=1</annotation></semantics></math>) or not (<math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="y_{t^{\prime}}=0" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><mrow id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><msub id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2.2" xref="S3.SS1.p3.7.m7.1.1.2.2.cmml">y</mi><msup id="S3.SS1.p3.7.m7.1.1.2.3" xref="S3.SS1.p3.7.m7.1.1.2.3.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2.3.2" xref="S3.SS1.p3.7.m7.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.7.m7.1.1.2.3.3" xref="S3.SS1.p3.7.m7.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="S3.SS1.p3.7.m7.1.1.1" xref="S3.SS1.p3.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><eq id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1.1"></eq><apply id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.2.1.cmml" xref="S3.SS1.p3.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2.2">𝑦</ci><apply id="S3.SS1.p3.7.m7.1.1.2.3.cmml" xref="S3.SS1.p3.7.m7.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.2.3.1.cmml" xref="S3.SS1.p3.7.m7.1.1.2.3">superscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.3.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.p3.7.m7.1.1.2.3.3.cmml" xref="S3.SS1.p3.7.m7.1.1.2.3.3">′</ci></apply></apply><cn type="integer" id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">y_{t^{\prime}}=0</annotation></semantics></math>).</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Overall Structure of FedAnomaly</span>
</h3>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2108.08404/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="214" height="121" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.2.1" class="ltx_text" style="font-size:90%;">The overall structure of FedAnomaly: For simplicity, we use a univariate time series to represent a multivariate input in the figure. The solid lines denote collaborative training and the dash lines show the pipeline of online detection.</span></figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">Fig. <a href="#S3.F2" title="Figure 2 ‣ III-B Overall Structure of FedAnomaly ‣ III Methodology ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the overall structure of FedAnomaly consisting of two parts: collaborative training and online detection. Note that the data preprocessing module, which transforms, standardizes and then segments data into sequences through a sliding window of a fixed length, is omitted in the figure. After preprocessing, multivariate time series are fed into local models to capture the patterns of training data. Model aggregator updates parameters of the global model by aggregating gradients from edges, and outputs a reconstruction error of an observation at the last timestamp in a sequence. A standard or validation data is stored on the cloud, and we continuously train the global model until the reconstruction error of the standard data converges. These reconstruction errors are utilized by the threshold selection module to choose an anomaly threshold for online detection. To be specific, we select the maximum reconstruction error in the standard data as the threshold. The online detection module on each edge receives the trained model and threshold from the cloud. Entities now can obtain the anomaly result of a new observation. If the reconstruction error of <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\boldsymbol{X}_{t^{\prime}}}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝑿</mi><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑿</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{\boldsymbol{X}_{t^{\prime}}}</annotation></semantics></math> is below the anomaly threshold, <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="{\boldsymbol{X}_{t^{\prime}}}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝑿</mi><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑿</ci><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">{\boldsymbol{X}_{t^{\prime}}}</annotation></semantics></math> will be declared as anomalous, otherwise, it is normal.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Convolutional Gated Recurrent Unit (ConvGRU)</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">For general sequence learning tasks, LSTM and GRU have shown the advantages in terms of stability and capability of modeling long-range temporal dependencies. Meanwhile, there are more and more variants that have been designed to model more complicated correlations for downstream tasks. Enlightened by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and their success on learning the representation of a spatial-temporal sequence for weather forecasting and video segmentation tasks, we also leverage the kernel-gated RNNs to capture the dependencies within multivariate time series as the representation learning is ongoing. To be specific, we apply a convolutional kernel in input-to-state and state-to-state transitions on the basic Gated Recurrent Unit, and implement a variant of this sequence learning model, Convolutional Gated Recurrent Unit (ConvGRU) so that the underlying feature-level dependencies can be captured along with temporal dependencies. As such, a better representation of multivariate time series can be generated under the encoder-decoder framework for the anomaly detection task.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.15" class="ltx_p">Different from a vanilla GRU cell, the original dot product operations are replaced with convolution operations at each gate. To get a clearer picture of ConvGRU, we present the implementation of a cell with information flow and operations in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-C Convolutional Gated Recurrent Unit (ConvGRU) ‣ III Methodology ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The detailed information flow of ConvGRU is shown in below equations:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="z_{t}=\sigma\left(W_{conv1,1}*[h_{t-1},x_{t}]\right)" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><msub id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml">z</mi><mi id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">t</mi></msub><mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml"><mi id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.3.3.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.4.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.4.2" xref="S3.E1.m1.3.3.1.1.1.1.4.2.cmml">W</mi><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.1.1a" xref="S3.E1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.1.4" xref="S3.E1.m1.2.2.2.2.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.1.1b" xref="S3.E1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.1.5" xref="S3.E1.m1.2.2.2.2.1.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.1.1c" xref="S3.E1.m1.2.2.2.2.1.1.cmml">​</mo><mn id="S3.E1.m1.2.2.2.2.1.6" xref="S3.E1.m1.2.2.2.2.1.6.cmml">1</mn></mrow><mo id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mn id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml">∗</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml">[</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.2.2.5" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></eq><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2">𝑧</ci><ci id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3">𝑡</ci></apply><apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1"><times id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.2"></times><ci id="S3.E1.m1.3.3.1.3.cmml" xref="S3.E1.m1.3.3.1.3">𝜎</ci><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"></times><apply id="S3.E1.m1.3.3.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4.2">𝑊</ci><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><apply id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1"><times id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1"></times><ci id="S3.E1.m1.2.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.2">𝑐</ci><ci id="S3.E1.m1.2.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.3">𝑜</ci><ci id="S3.E1.m1.2.2.2.2.1.4.cmml" xref="S3.E1.m1.2.2.2.2.1.4">𝑛</ci><ci id="S3.E1.m1.2.2.2.2.1.5.cmml" xref="S3.E1.m1.2.2.2.2.1.5">𝑣</ci><cn type="integer" id="S3.E1.m1.2.2.2.2.1.6.cmml" xref="S3.E1.m1.2.2.2.2.1.6">1</cn></apply><cn type="integer" id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">1</cn></list></apply><interval closure="closed" id="S3.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2">ℎ</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3"><minus id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">z_{t}=\sigma\left(W_{conv1,1}*[h_{t-1},x_{t}]\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="r_{t}=\sigma\left(W_{conv1,2}*[h_{t-1},x_{t}]\right)" display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><msub id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><mi id="S3.E2.m1.3.3.3.2" xref="S3.E2.m1.3.3.3.2.cmml">r</mi><mi id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml">t</mi></msub><mo id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml">=</mo><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.cmml"><mi id="S3.E2.m1.3.3.1.3" xref="S3.E2.m1.3.3.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><msub id="S3.E2.m1.3.3.1.1.1.1.4" xref="S3.E2.m1.3.3.1.1.1.1.4.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.4.2" xref="S3.E2.m1.3.3.1.1.1.1.4.2.cmml">W</mi><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml"><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1a" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.4" xref="S3.E2.m1.2.2.2.2.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1b" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.1.5" xref="S3.E2.m1.2.2.2.2.1.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1c" xref="S3.E2.m1.2.2.2.2.1.1.cmml">​</mo><mn id="S3.E2.m1.2.2.2.2.1.6" xref="S3.E2.m1.2.2.2.2.1.6.cmml">1</mn></mrow><mo id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mn id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">2</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.3.3.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.3.cmml">∗</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.3.cmml">[</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.3.3.1.1.1.1.2.2.4" xref="S3.E2.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.3.3.1.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S3.E2.m1.3.3.1.1.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.2.2.5" xref="S3.E2.m1.3.3.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><eq id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2"></eq><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.2">𝑟</ci><ci id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3">𝑡</ci></apply><apply id="S3.E2.m1.3.3.1.cmml" xref="S3.E2.m1.3.3.1"><times id="S3.E2.m1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.2"></times><ci id="S3.E2.m1.3.3.1.3.cmml" xref="S3.E2.m1.3.3.1.3">𝜎</ci><apply id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.3"></times><apply id="S3.E2.m1.3.3.1.1.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.4.2">𝑊</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2"><apply id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1"><times id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"></times><ci id="S3.E2.m1.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.3">𝑜</ci><ci id="S3.E2.m1.2.2.2.2.1.4.cmml" xref="S3.E2.m1.2.2.2.2.1.4">𝑛</ci><ci id="S3.E2.m1.2.2.2.2.1.5.cmml" xref="S3.E2.m1.2.2.2.2.1.5">𝑣</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.1.6.cmml" xref="S3.E2.m1.2.2.2.2.1.6">1</cn></apply><cn type="integer" id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">2</cn></list></apply><interval closure="closed" id="S3.E2.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2"><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2">ℎ</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3"><minus id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">r_{t}=\sigma\left(W_{conv1,2}*[h_{t-1},x_{t}]\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\hat{h}_{t}=tanh\left(W_{conv2}*[\left(r_{t}\odot h_{t-1}\right),x_{t}]\right)" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mover accent="true" id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">h</mi><mo id="S3.E3.m1.1.1.3.2.1" xref="S3.E3.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mi id="S3.E3.m1.1.1.1.4" xref="S3.E3.m1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2a" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mi id="S3.E3.m1.1.1.1.5" xref="S3.E3.m1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2b" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mi id="S3.E3.m1.1.1.1.6" xref="S3.E3.m1.1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2c" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.1.1.1.4.2.cmml">W</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.4.3" xref="S3.E3.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.4.3.2" xref="S3.E3.m1.1.1.1.1.1.1.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.4.3.1" xref="S3.E3.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.4.3.3" xref="S3.E3.m1.1.1.1.1.1.1.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.4.3.1a" xref="S3.E3.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.4.3.4" xref="S3.E3.m1.1.1.1.1.1.1.4.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.4.3.1b" xref="S3.E3.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.4.3.5" xref="S3.E3.m1.1.1.1.1.1.1.4.3.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.4.3.1c" xref="S3.E3.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mn id="S3.E3.m1.1.1.1.1.1.1.4.3.6" xref="S3.E3.m1.1.1.1.1.1.1.4.3.6.cmml">2</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml">∗</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.2.2.4" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E3.m1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.2.2.5" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"></eq><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3">subscript</csymbol><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><ci id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2.1">^</ci><ci id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">ℎ</ci></apply><ci id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝑡</ci><ci id="S3.E3.m1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.4">𝑎</ci><ci id="S3.E3.m1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.5">𝑛</ci><ci id="S3.E3.m1.1.1.1.6.cmml" xref="S3.E3.m1.1.1.1.6">ℎ</ci><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"></times><apply id="S3.E3.m1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2">𝑊</ci><apply id="S3.E3.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3"><times id="S3.E3.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.2">𝑐</ci><ci id="S3.E3.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.3">𝑜</ci><ci id="S3.E3.m1.1.1.1.1.1.1.4.3.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.4">𝑛</ci><ci id="S3.E3.m1.1.1.1.1.1.1.4.3.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.5">𝑣</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.4.3.6.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.6">2</cn></apply></apply><interval closure="closed" id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\hat{h}_{t}=tanh\left(W_{conv2}*[\left(r_{t}\odot h_{t-1}\right),x_{t}]\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="h_{t}=\left(1-z_{t}\right)\odot h_{t-1}+z\odot\hat{h}_{t}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msub id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">h</mi><mi id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo rspace="0.055em" id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">h</mi><mrow id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml">z</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.3.1.cmml">⊙</mo><msub id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml"><mover accent="true" id="S3.E4.m1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.3.3.2.cmml"><mi id="S3.E4.m1.1.1.1.3.3.2.2" xref="S3.E4.m1.1.1.1.3.3.2.2.cmml">h</mi><mo id="S3.E4.m1.1.1.1.3.3.2.1" xref="S3.E4.m1.1.1.1.3.3.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"></eq><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">ℎ</ci><ci id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><plus id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></plus><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">ℎ</ci><apply id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><minus id="S3.E4.m1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1"></minus><ci id="S3.E4.m1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3.1">direct-product</csymbol><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">𝑧</ci><apply id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.3.3">subscript</csymbol><apply id="S3.E4.m1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.3.3.2"><ci id="S3.E4.m1.1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.1.1.1.3.3.2.1">^</ci><ci id="S3.E4.m1.1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.1.1.1.3.3.2.2">ℎ</ci></apply><ci id="S3.E4.m1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">h_{t}=\left(1-z_{t}\right)\odot h_{t-1}+z\odot\hat{h}_{t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.14" class="ltx_p">where <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">x_{t}</annotation></semantics></math> denotes the input of current step, <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">h</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">ℎ</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">h_{t}</annotation></semantics></math> and <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="h_{t-1}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">h</mi><mrow id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p2.3.m3.1.1.3.1" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">ℎ</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><minus id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.1"></minus><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">h_{t-1}</annotation></semantics></math> denote the hidden state of current and previous step, respectively, <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="z_{t}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">z</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑧</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">z_{t}</annotation></semantics></math> denotes the update gate, <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="r_{t}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">r</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑟</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">r_{t}</annotation></semantics></math> denotes the reset gate, and <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="\hat{h}_{t}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mover accent="true" id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2.2" xref="S3.SS3.p2.6.m6.1.1.2.2.cmml">h</mi><mo id="S3.SS3.p2.6.m6.1.1.2.1" xref="S3.SS3.p2.6.m6.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2"><ci id="S3.SS3.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.p2.6.m6.1.1.2.1">^</ci><ci id="S3.SS3.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2.2">ℎ</ci></apply><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\hat{h}_{t}</annotation></semantics></math> denotes the candidate hidden state. Moreover, <math id="S3.SS3.p2.7.m7.2" class="ltx_Math" alttext="W_{conv1,1}" display="inline"><semantics id="S3.SS3.p2.7.m7.2a"><msub id="S3.SS3.p2.7.m7.2.3" xref="S3.SS3.p2.7.m7.2.3.cmml"><mi id="S3.SS3.p2.7.m7.2.3.2" xref="S3.SS3.p2.7.m7.2.3.2.cmml">W</mi><mrow id="S3.SS3.p2.7.m7.2.2.2.2" xref="S3.SS3.p2.7.m7.2.2.2.3.cmml"><mrow id="S3.SS3.p2.7.m7.2.2.2.2.1" xref="S3.SS3.p2.7.m7.2.2.2.2.1.cmml"><mi id="S3.SS3.p2.7.m7.2.2.2.2.1.2" xref="S3.SS3.p2.7.m7.2.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m7.2.2.2.2.1.1" xref="S3.SS3.p2.7.m7.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.7.m7.2.2.2.2.1.3" xref="S3.SS3.p2.7.m7.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m7.2.2.2.2.1.1a" xref="S3.SS3.p2.7.m7.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.7.m7.2.2.2.2.1.4" xref="S3.SS3.p2.7.m7.2.2.2.2.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m7.2.2.2.2.1.1b" xref="S3.SS3.p2.7.m7.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.7.m7.2.2.2.2.1.5" xref="S3.SS3.p2.7.m7.2.2.2.2.1.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m7.2.2.2.2.1.1c" xref="S3.SS3.p2.7.m7.2.2.2.2.1.1.cmml">​</mo><mn id="S3.SS3.p2.7.m7.2.2.2.2.1.6" xref="S3.SS3.p2.7.m7.2.2.2.2.1.6.cmml">1</mn></mrow><mo id="S3.SS3.p2.7.m7.2.2.2.2.2" xref="S3.SS3.p2.7.m7.2.2.2.3.cmml">,</mo><mn id="S3.SS3.p2.7.m7.1.1.1.1" xref="S3.SS3.p2.7.m7.1.1.1.1.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.2b"><apply id="S3.SS3.p2.7.m7.2.3.cmml" xref="S3.SS3.p2.7.m7.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.2.3.1.cmml" xref="S3.SS3.p2.7.m7.2.3">subscript</csymbol><ci id="S3.SS3.p2.7.m7.2.3.2.cmml" xref="S3.SS3.p2.7.m7.2.3.2">𝑊</ci><list id="S3.SS3.p2.7.m7.2.2.2.3.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2"><apply id="S3.SS3.p2.7.m7.2.2.2.2.1.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2.1"><times id="S3.SS3.p2.7.m7.2.2.2.2.1.1.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2.1.1"></times><ci id="S3.SS3.p2.7.m7.2.2.2.2.1.2.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2.1.2">𝑐</ci><ci id="S3.SS3.p2.7.m7.2.2.2.2.1.3.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2.1.3">𝑜</ci><ci id="S3.SS3.p2.7.m7.2.2.2.2.1.4.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2.1.4">𝑛</ci><ci id="S3.SS3.p2.7.m7.2.2.2.2.1.5.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2.1.5">𝑣</ci><cn type="integer" id="S3.SS3.p2.7.m7.2.2.2.2.1.6.cmml" xref="S3.SS3.p2.7.m7.2.2.2.2.1.6">1</cn></apply><cn type="integer" id="S3.SS3.p2.7.m7.1.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1.1.1">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.2c">W_{conv1,1}</annotation></semantics></math> and <math id="S3.SS3.p2.8.m8.2" class="ltx_Math" alttext="W_{conv1,2}" display="inline"><semantics id="S3.SS3.p2.8.m8.2a"><msub id="S3.SS3.p2.8.m8.2.3" xref="S3.SS3.p2.8.m8.2.3.cmml"><mi id="S3.SS3.p2.8.m8.2.3.2" xref="S3.SS3.p2.8.m8.2.3.2.cmml">W</mi><mrow id="S3.SS3.p2.8.m8.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.3.cmml"><mrow id="S3.SS3.p2.8.m8.2.2.2.2.1" xref="S3.SS3.p2.8.m8.2.2.2.2.1.cmml"><mi id="S3.SS3.p2.8.m8.2.2.2.2.1.2" xref="S3.SS3.p2.8.m8.2.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.2.2.2.2.1.1" xref="S3.SS3.p2.8.m8.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.8.m8.2.2.2.2.1.3" xref="S3.SS3.p2.8.m8.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.2.2.2.2.1.1a" xref="S3.SS3.p2.8.m8.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.8.m8.2.2.2.2.1.4" xref="S3.SS3.p2.8.m8.2.2.2.2.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.2.2.2.2.1.1b" xref="S3.SS3.p2.8.m8.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.8.m8.2.2.2.2.1.5" xref="S3.SS3.p2.8.m8.2.2.2.2.1.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.2.2.2.2.1.1c" xref="S3.SS3.p2.8.m8.2.2.2.2.1.1.cmml">​</mo><mn id="S3.SS3.p2.8.m8.2.2.2.2.1.6" xref="S3.SS3.p2.8.m8.2.2.2.2.1.6.cmml">1</mn></mrow><mo id="S3.SS3.p2.8.m8.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.3.cmml">,</mo><mn id="S3.SS3.p2.8.m8.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.2b"><apply id="S3.SS3.p2.8.m8.2.3.cmml" xref="S3.SS3.p2.8.m8.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.2.3.1.cmml" xref="S3.SS3.p2.8.m8.2.3">subscript</csymbol><ci id="S3.SS3.p2.8.m8.2.3.2.cmml" xref="S3.SS3.p2.8.m8.2.3.2">𝑊</ci><list id="S3.SS3.p2.8.m8.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2"><apply id="S3.SS3.p2.8.m8.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1"><times id="S3.SS3.p2.8.m8.2.2.2.2.1.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1.1"></times><ci id="S3.SS3.p2.8.m8.2.2.2.2.1.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1.2">𝑐</ci><ci id="S3.SS3.p2.8.m8.2.2.2.2.1.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1.3">𝑜</ci><ci id="S3.SS3.p2.8.m8.2.2.2.2.1.4.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1.4">𝑛</ci><ci id="S3.SS3.p2.8.m8.2.2.2.2.1.5.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1.5">𝑣</ci><cn type="integer" id="S3.SS3.p2.8.m8.2.2.2.2.1.6.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1.6">1</cn></apply><cn type="integer" id="S3.SS3.p2.8.m8.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.2c">W_{conv1,2}</annotation></semantics></math> denote the convolutional kernel for each gate, and <math id="S3.SS3.p2.9.m9.1" class="ltx_Math" alttext="W_{conv2}" display="inline"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">W</mi><mrow id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml"><mi id="S3.SS3.p2.9.m9.1.1.3.2" xref="S3.SS3.p2.9.m9.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m9.1.1.3.1" xref="S3.SS3.p2.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.9.m9.1.1.3.3" xref="S3.SS3.p2.9.m9.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m9.1.1.3.1a" xref="S3.SS3.p2.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.9.m9.1.1.3.4" xref="S3.SS3.p2.9.m9.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m9.1.1.3.1b" xref="S3.SS3.p2.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.9.m9.1.1.3.5" xref="S3.SS3.p2.9.m9.1.1.3.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m9.1.1.3.1c" xref="S3.SS3.p2.9.m9.1.1.3.1.cmml">​</mo><mn id="S3.SS3.p2.9.m9.1.1.3.6" xref="S3.SS3.p2.9.m9.1.1.3.6.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑊</ci><apply id="S3.SS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3"><times id="S3.SS3.p2.9.m9.1.1.3.1.cmml" xref="S3.SS3.p2.9.m9.1.1.3.1"></times><ci id="S3.SS3.p2.9.m9.1.1.3.2.cmml" xref="S3.SS3.p2.9.m9.1.1.3.2">𝑐</ci><ci id="S3.SS3.p2.9.m9.1.1.3.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3.3">𝑜</ci><ci id="S3.SS3.p2.9.m9.1.1.3.4.cmml" xref="S3.SS3.p2.9.m9.1.1.3.4">𝑛</ci><ci id="S3.SS3.p2.9.m9.1.1.3.5.cmml" xref="S3.SS3.p2.9.m9.1.1.3.5">𝑣</ci><cn type="integer" id="S3.SS3.p2.9.m9.1.1.3.6.cmml" xref="S3.SS3.p2.9.m9.1.1.3.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">W_{conv2}</annotation></semantics></math> denotes the convolutional kernel used in the computation of candidate hidden state. Besides, <math id="S3.SS3.p2.10.m10.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS3.p2.10.m10.1a"><mi id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><ci id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">\sigma</annotation></semantics></math> and <math id="S3.SS3.p2.11.m11.1" class="ltx_Math" alttext="tanh" display="inline"><semantics id="S3.SS3.p2.11.m11.1a"><mrow id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml"><mi id="S3.SS3.p2.11.m11.1.1.2" xref="S3.SS3.p2.11.m11.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.11.m11.1.1.1" xref="S3.SS3.p2.11.m11.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.11.m11.1.1.3" xref="S3.SS3.p2.11.m11.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.11.m11.1.1.1a" xref="S3.SS3.p2.11.m11.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.11.m11.1.1.4" xref="S3.SS3.p2.11.m11.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.11.m11.1.1.1b" xref="S3.SS3.p2.11.m11.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.11.m11.1.1.5" xref="S3.SS3.p2.11.m11.1.1.5.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><apply id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1"><times id="S3.SS3.p2.11.m11.1.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1.1"></times><ci id="S3.SS3.p2.11.m11.1.1.2.cmml" xref="S3.SS3.p2.11.m11.1.1.2">𝑡</ci><ci id="S3.SS3.p2.11.m11.1.1.3.cmml" xref="S3.SS3.p2.11.m11.1.1.3">𝑎</ci><ci id="S3.SS3.p2.11.m11.1.1.4.cmml" xref="S3.SS3.p2.11.m11.1.1.4">𝑛</ci><ci id="S3.SS3.p2.11.m11.1.1.5.cmml" xref="S3.SS3.p2.11.m11.1.1.5">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">tanh</annotation></semantics></math> denotes the sigmoid and hyperbolic tangent activation functions, <math id="S3.SS3.p2.12.m12.1" class="ltx_Math" alttext="*" display="inline"><semantics id="S3.SS3.p2.12.m12.1a"><mo id="S3.SS3.p2.12.m12.1.1" xref="S3.SS3.p2.12.m12.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m12.1b"><times id="S3.SS3.p2.12.m12.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m12.1c">*</annotation></semantics></math> is the convolution operation, <math id="S3.SS3.p2.13.m13.1" class="ltx_Math" alttext="[\cdot]" display="inline"><semantics id="S3.SS3.p2.13.m13.1a"><mrow id="S3.SS3.p2.13.m13.1.2.2" xref="S3.SS3.p2.13.m13.1.2.1.cmml"><mo stretchy="false" id="S3.SS3.p2.13.m13.1.2.2.1" xref="S3.SS3.p2.13.m13.1.2.1.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p2.13.m13.1.1" xref="S3.SS3.p2.13.m13.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p2.13.m13.1.2.2.2" xref="S3.SS3.p2.13.m13.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m13.1b"><apply id="S3.SS3.p2.13.m13.1.2.1.cmml" xref="S3.SS3.p2.13.m13.1.2.2"><csymbol cd="latexml" id="S3.SS3.p2.13.m13.1.2.1.1.cmml" xref="S3.SS3.p2.13.m13.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS3.p2.13.m13.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m13.1c">[\cdot]</annotation></semantics></math> is the concatenation operation, <math id="S3.SS3.p2.14.m14.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS3.p2.14.m14.1a"><mo id="S3.SS3.p2.14.m14.1.1" xref="S3.SS3.p2.14.m14.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m14.1b"><csymbol cd="latexml" id="S3.SS3.p2.14.m14.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m14.1c">\odot</annotation></semantics></math> is the hadamard product, or element-wise multiplication. It is noted that in the implementation of equations (1-2), the input and the hidden state of previous step are concatenated, convoluted with kernels, and then split into two parts as the reset gate and update gate.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2108.08404/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="192" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S3.F3.2.1" class="ltx_text" style="font-size:90%;">The ConvGRU cell mainly consists of a reset gate and an update gate, where Conv denotes a 1D-convolutional kernel to capture dependencies in the feature level. CAT and UCAT denote concatenation and splitting operations, respectively.</span></figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.4.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.5.2" class="ltx_text ltx_font_italic">Variational ConvGRU</span>
</h3>

<figure id="S3.F4" class="ltx_figure"><img src="/html/2108.08404/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="170" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S3.F4.2.1" class="ltx_text" style="font-size:90%;">The basic framework of ConvGRU-VAE.</span></figcaption>
</figure>
<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.12" class="ltx_p">VAE models the relationship between latent variable z and observed variable x. Specifically, the generative model is denoted as the joint distribution: <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="p_{\theta}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">p</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑝</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">p_{\theta}</annotation></semantics></math>(x,z) = <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="p_{\theta}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑝</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">p_{\theta}</annotation></semantics></math>(x<math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mo id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\mid</annotation></semantics></math>z)<math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="p_{\theta}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">p</mi><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝑝</ci><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">p_{\theta}</annotation></semantics></math>(z), where <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="p_{\theta}" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><msub id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">p</mi><mi id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2">𝑝</ci><ci id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">p_{\theta}</annotation></semantics></math>(x<math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mo id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">\mid</annotation></semantics></math>z) is the likelihood of the data x given the latent z, which is distributed normally with multivariate unit Gaussian <math id="S3.SS4.p1.7.m7.2" class="ltx_Math" alttext="\mathcal{N}(0,{\mathrm{I}})" display="inline"><semantics id="S3.SS4.p1.7.m7.2a"><mrow id="S3.SS4.p1.7.m7.2.3" xref="S3.SS4.p1.7.m7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.7.m7.2.3.2" xref="S3.SS4.p1.7.m7.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m7.2.3.1" xref="S3.SS4.p1.7.m7.2.3.1.cmml">​</mo><mrow id="S3.SS4.p1.7.m7.2.3.3.2" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p1.7.m7.2.3.3.2.1" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml">(</mo><mn id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">0</mn><mo id="S3.SS4.p1.7.m7.2.3.3.2.2" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.7.m7.2.2" xref="S3.SS4.p1.7.m7.2.2.cmml">I</mi><mo stretchy="false" id="S3.SS4.p1.7.m7.2.3.3.2.3" xref="S3.SS4.p1.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.2b"><apply id="S3.SS4.p1.7.m7.2.3.cmml" xref="S3.SS4.p1.7.m7.2.3"><times id="S3.SS4.p1.7.m7.2.3.1.cmml" xref="S3.SS4.p1.7.m7.2.3.1"></times><ci id="S3.SS4.p1.7.m7.2.3.2.cmml" xref="S3.SS4.p1.7.m7.2.3.2">𝒩</ci><interval closure="open" id="S3.SS4.p1.7.m7.2.3.3.1.cmml" xref="S3.SS4.p1.7.m7.2.3.3.2"><cn type="integer" id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">0</cn><ci id="S3.SS4.p1.7.m7.2.2.cmml" xref="S3.SS4.p1.7.m7.2.2">I</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.2c">\mathcal{N}(0,{\mathrm{I}})</annotation></semantics></math>. Since the intractable inference of the true posterior <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><mi id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">p</annotation></semantics></math>(z<math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><mo id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><ci id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">\mid</annotation></semantics></math>x), VAE uses the approximation posterior <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="q_{\phi}" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><msub id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml"><mi id="S3.SS4.p1.10.m10.1.1.2" xref="S3.SS4.p1.10.m10.1.1.2.cmml">q</mi><mi id="S3.SS4.p1.10.m10.1.1.3" xref="S3.SS4.p1.10.m10.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2">𝑞</ci><ci id="S3.SS4.p1.10.m10.1.1.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">q_{\phi}</annotation></semantics></math>(z<math id="S3.SS4.p1.11.m11.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S3.SS4.p1.11.m11.1a"><mo id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><ci id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">\mid</annotation></semantics></math>x) that can be assumed to be <math id="S3.SS4.p1.12.m12.2" class="ltx_Math" alttext="\mathcal{N}(\mu_{\phi},\sigma^{2}_{\phi})" display="inline"><semantics id="S3.SS4.p1.12.m12.2a"><mrow id="S3.SS4.p1.12.m12.2.2" xref="S3.SS4.p1.12.m12.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.12.m12.2.2.4" xref="S3.SS4.p1.12.m12.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.12.m12.2.2.3" xref="S3.SS4.p1.12.m12.2.2.3.cmml">​</mo><mrow id="S3.SS4.p1.12.m12.2.2.2.2" xref="S3.SS4.p1.12.m12.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.12.m12.2.2.2.2.3" xref="S3.SS4.p1.12.m12.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p1.12.m12.1.1.1.1.1" xref="S3.SS4.p1.12.m12.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.12.m12.1.1.1.1.1.2" xref="S3.SS4.p1.12.m12.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.SS4.p1.12.m12.1.1.1.1.1.3" xref="S3.SS4.p1.12.m12.1.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S3.SS4.p1.12.m12.2.2.2.2.4" xref="S3.SS4.p1.12.m12.2.2.2.3.cmml">,</mo><msubsup id="S3.SS4.p1.12.m12.2.2.2.2.2" xref="S3.SS4.p1.12.m12.2.2.2.2.2.cmml"><mi id="S3.SS4.p1.12.m12.2.2.2.2.2.2.2" xref="S3.SS4.p1.12.m12.2.2.2.2.2.2.2.cmml">σ</mi><mi id="S3.SS4.p1.12.m12.2.2.2.2.2.3" xref="S3.SS4.p1.12.m12.2.2.2.2.2.3.cmml">ϕ</mi><mn id="S3.SS4.p1.12.m12.2.2.2.2.2.2.3" xref="S3.SS4.p1.12.m12.2.2.2.2.2.2.3.cmml">2</mn></msubsup><mo stretchy="false" id="S3.SS4.p1.12.m12.2.2.2.2.5" xref="S3.SS4.p1.12.m12.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.2b"><apply id="S3.SS4.p1.12.m12.2.2.cmml" xref="S3.SS4.p1.12.m12.2.2"><times id="S3.SS4.p1.12.m12.2.2.3.cmml" xref="S3.SS4.p1.12.m12.2.2.3"></times><ci id="S3.SS4.p1.12.m12.2.2.4.cmml" xref="S3.SS4.p1.12.m12.2.2.4">𝒩</ci><interval closure="open" id="S3.SS4.p1.12.m12.2.2.2.3.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2"><apply id="S3.SS4.p1.12.m12.1.1.1.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.12.m12.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1.1.2">𝜇</ci><ci id="S3.SS4.p1.12.m12.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1.1.3">italic-ϕ</ci></apply><apply id="S3.SS4.p1.12.m12.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2">subscript</csymbol><apply id="S3.SS4.p1.12.m12.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2">superscript</csymbol><ci id="S3.SS4.p1.12.m12.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2.2.2">𝜎</ci><cn type="integer" id="S3.SS4.p1.12.m12.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS4.p1.12.m12.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2.3">italic-ϕ</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.2c">\mathcal{N}(\mu_{\phi},\sigma^{2}_{\phi})</annotation></semantics></math>. The objective function is the variational lower bound of the marginal likelihood of data:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.73" class="ltx_math_unparsed" alttext="\begin{split}\log p_{\theta}&amp;(\mathrm{x})\geq\log p_{\theta}(\mathrm{x})-{\rm KL}[q_{\phi}({\mathrm{z}}|{\mathrm{x}})\|p_{\theta}({\mathrm{z}}|{\mathrm{x}})]\\
&amp;=\mathcal{L}({\theta,\phi;\mathrm{x}})\\
&amp;=E_{z\sim q_{\phi}({\mathrm{z}}|\mathrm{x})}[\log p_{\theta}({\mathrm{x}}|\mathrm{z})]-{\rm KL}[q_{\phi}({\mathrm{z}}|{\mathrm{x}})\|p_{\theta}({\mathrm{z}})]\end{split}" display="block"><semantics id="S3.E5.m1.73a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E5.m1.73.73.2"><mtr id="S3.E5.m1.73.73.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.73.73.2b"><mrow id="S3.E5.m1.3.3.3.3.3"><mi id="S3.E5.m1.1.1.1.1.1.1">log</mi><mo lspace="0.167em" id="S3.E5.m1.3.3.3.3.3a">⁡</mo><msub id="S3.E5.m1.3.3.3.3.3.4"><mi id="S3.E5.m1.2.2.2.2.2.2">p</mi><mi id="S3.E5.m1.3.3.3.3.3.3.1">θ</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.73.73.2c"><mrow id="S3.E5.m1.32.32.32.32.29"><mrow id="S3.E5.m1.32.32.32.32.29.30"><mo stretchy="false" id="S3.E5.m1.4.4.4.4.1.1">(</mo><mi mathvariant="normal" id="S3.E5.m1.5.5.5.5.2.2">x</mi><mo stretchy="false" id="S3.E5.m1.6.6.6.6.3.3">)</mo></mrow><mo id="S3.E5.m1.7.7.7.7.4.4">≥</mo><mi id="S3.E5.m1.8.8.8.8.5.5">log</mi><msub id="S3.E5.m1.32.32.32.32.29.31"><mi id="S3.E5.m1.9.9.9.9.6.6">p</mi><mi id="S3.E5.m1.10.10.10.10.7.7.1">θ</mi></msub><mrow id="S3.E5.m1.32.32.32.32.29.32"><mo stretchy="false" id="S3.E5.m1.11.11.11.11.8.8">(</mo><mi mathvariant="normal" id="S3.E5.m1.12.12.12.12.9.9">x</mi><mo stretchy="false" id="S3.E5.m1.13.13.13.13.10.10">)</mo></mrow><mo id="S3.E5.m1.14.14.14.14.11.11">−</mo><mi id="S3.E5.m1.15.15.15.15.12.12">KL</mi><mrow id="S3.E5.m1.32.32.32.32.29.33"><mo stretchy="false" id="S3.E5.m1.16.16.16.16.13.13">[</mo><msub id="S3.E5.m1.32.32.32.32.29.33.1"><mi id="S3.E5.m1.17.17.17.17.14.14">q</mi><mi id="S3.E5.m1.18.18.18.18.15.15.1">ϕ</mi></msub><mrow id="S3.E5.m1.32.32.32.32.29.33.2"><mo stretchy="false" id="S3.E5.m1.19.19.19.19.16.16">(</mo><mi mathvariant="normal" id="S3.E5.m1.20.20.20.20.17.17">z</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.21.21.21.21.18.18">|</mo><mi mathvariant="normal" id="S3.E5.m1.22.22.22.22.19.19">x</mi><mo stretchy="false" id="S3.E5.m1.23.23.23.23.20.20">)</mo></mrow><mo lspace="0em" rspace="0.167em" id="S3.E5.m1.24.24.24.24.21.21">∥</mo><msub id="S3.E5.m1.32.32.32.32.29.33.3"><mi id="S3.E5.m1.25.25.25.25.22.22">p</mi><mi id="S3.E5.m1.26.26.26.26.23.23.1">θ</mi></msub><mrow id="S3.E5.m1.32.32.32.32.29.33.4"><mo stretchy="false" id="S3.E5.m1.27.27.27.27.24.24">(</mo><mi mathvariant="normal" id="S3.E5.m1.28.28.28.28.25.25">z</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.29.29.29.29.26.26">|</mo><mi mathvariant="normal" id="S3.E5.m1.30.30.30.30.27.27">x</mi><mo stretchy="false" id="S3.E5.m1.31.31.31.31.28.28">)</mo></mrow><mo stretchy="false" id="S3.E5.m1.32.32.32.32.29.29">]</mo></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.73.73.2d"><mtd id="S3.E5.m1.73.73.2e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.73.73.2f"><mrow id="S3.E5.m1.41.41.41.9.9"><mi id="S3.E5.m1.41.41.41.9.9.10"></mi><mo id="S3.E5.m1.33.33.33.1.1.1">=</mo><mrow id="S3.E5.m1.41.41.41.9.9.11"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.34.34.34.2.2.2">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.41.41.41.9.9.11.1">​</mo><mrow id="S3.E5.m1.41.41.41.9.9.11.2"><mo stretchy="false" id="S3.E5.m1.35.35.35.3.3.3">(</mo><mi id="S3.E5.m1.36.36.36.4.4.4">θ</mi><mo id="S3.E5.m1.37.37.37.5.5.5">,</mo><mi id="S3.E5.m1.38.38.38.6.6.6">ϕ</mi><mo id="S3.E5.m1.39.39.39.7.7.7">;</mo><mi mathvariant="normal" id="S3.E5.m1.40.40.40.8.8.8">x</mi><mo stretchy="false" id="S3.E5.m1.41.41.41.9.9.9">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.73.73.2g"><mtd id="S3.E5.m1.73.73.2h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.73.73.2i"><mrow id="S3.E5.m1.73.73.2.73.32.32"><mi id="S3.E5.m1.73.73.2.73.32.32.33"></mi><mo id="S3.E5.m1.42.42.42.1.1.1">=</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32"><mrow id="S3.E5.m1.72.72.1.72.31.31.31.1"><msub id="S3.E5.m1.72.72.1.72.31.31.31.1.3"><mi id="S3.E5.m1.43.43.43.2.2.2">E</mi><mrow id="S3.E5.m1.44.44.44.3.3.3.1"><mi id="S3.E5.m1.44.44.44.3.3.3.1.3">z</mi><mo id="S3.E5.m1.44.44.44.3.3.3.1.2">∼</mo><mrow id="S3.E5.m1.44.44.44.3.3.3.1.1"><msub id="S3.E5.m1.44.44.44.3.3.3.1.1.3"><mi id="S3.E5.m1.44.44.44.3.3.3.1.1.3.2">q</mi><mi id="S3.E5.m1.44.44.44.3.3.3.1.1.3.3">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.44.44.44.3.3.3.1.1.2">​</mo><mrow id="S3.E5.m1.44.44.44.3.3.3.1.1.1.1"><mo stretchy="false" id="S3.E5.m1.44.44.44.3.3.3.1.1.1.1.2">(</mo><mrow id="S3.E5.m1.44.44.44.3.3.3.1.1.1.1.1"><mi mathvariant="normal" id="S3.E5.m1.44.44.44.3.3.3.1.1.1.1.1.2">z</mi><mo fence="false" id="S3.E5.m1.44.44.44.3.3.3.1.1.1.1.1.1">|</mo><mi mathvariant="normal" id="S3.E5.m1.44.44.44.3.3.3.1.1.1.1.1.3">x</mi></mrow><mo stretchy="false" id="S3.E5.m1.44.44.44.3.3.3.1.1.1.1.3">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.72.72.1.72.31.31.31.1.2">​</mo><mrow id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1"><mo stretchy="false" id="S3.E5.m1.45.45.45.4.4.4">[</mo><mrow id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1.1"><mrow id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1.1.3"><mi id="S3.E5.m1.46.46.46.5.5.5">log</mi><mo lspace="0.167em" id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1.1.3a">⁡</mo><msub id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1.1.3.1"><mi id="S3.E5.m1.47.47.47.6.6.6">p</mi><mi id="S3.E5.m1.48.48.48.7.7.7.1">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1.1.2">​</mo><mrow id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1.1.1.1"><mo stretchy="false" id="S3.E5.m1.49.49.49.8.8.8">(</mo><mrow id="S3.E5.m1.72.72.1.72.31.31.31.1.1.1.1.1.1.1"><mi mathvariant="normal" id="S3.E5.m1.50.50.50.9.9.9">x</mi><mo fence="false" id="S3.E5.m1.51.51.51.10.10.10">|</mo><mi mathvariant="normal" id="S3.E5.m1.52.52.52.11.11.11">z</mi></mrow><mo stretchy="false" id="S3.E5.m1.53.53.53.12.12.12">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.54.54.54.13.13.13">]</mo></mrow></mrow><mo id="S3.E5.m1.55.55.55.14.14.14">−</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2"><mi id="S3.E5.m1.56.56.56.15.15.15">KL</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.73.73.2.73.32.32.32.2.2">​</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1"><mo stretchy="false" id="S3.E5.m1.57.57.57.16.16.16">[</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1"><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.1"><msub id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.1.3"><mi id="S3.E5.m1.58.58.58.17.17.17">q</mi><mi id="S3.E5.m1.59.59.59.18.18.18.1">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.1.2">​</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.1.1.1"><mo stretchy="false" id="S3.E5.m1.60.60.60.19.19.19">(</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.1.1.1.1"><mi mathvariant="normal" id="S3.E5.m1.61.61.61.20.20.20">z</mi><mo fence="false" id="S3.E5.m1.62.62.62.21.21.21">|</mo><mi mathvariant="normal" id="S3.E5.m1.63.63.63.22.22.22">x</mi></mrow><mo stretchy="false" id="S3.E5.m1.64.64.64.23.23.23">)</mo></mrow></mrow><mo id="S3.E5.m1.65.65.65.24.24.24">∥</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.2"><msub id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.2.2"><mi id="S3.E5.m1.66.66.66.25.25.25">p</mi><mi id="S3.E5.m1.67.67.67.26.26.26.1">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.2.1">​</mo><mrow id="S3.E5.m1.73.73.2.73.32.32.32.2.1.1.1.2.3"><mo stretchy="false" id="S3.E5.m1.68.68.68.27.27.27">(</mo><mi mathvariant="normal" id="S3.E5.m1.69.69.69.28.28.28">z</mi><mo stretchy="false" id="S3.E5.m1.70.70.70.29.29.29">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.71.71.71.30.30.30">]</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E5.m1.73b">\begin{split}\log p_{\theta}&amp;(\mathrm{x})\geq\log p_{\theta}(\mathrm{x})-{\rm KL}[q_{\phi}({\mathrm{z}}|{\mathrm{x}})\|p_{\theta}({\mathrm{z}}|{\mathrm{x}})]\\
&amp;=\mathcal{L}({\theta,\phi;\mathrm{x}})\\
&amp;=E_{z\sim q_{\phi}({\mathrm{z}}|\mathrm{x})}[\log p_{\theta}({\mathrm{x}}|\mathrm{z})]-{\rm KL}[q_{\phi}({\mathrm{z}}|{\mathrm{x}})\|p_{\theta}({\mathrm{z}})]\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.13" class="ltx_p">where <math id="S3.SS4.p1.13.m1.3" class="ltx_Math" alttext="\mathcal{L}({\theta,\phi;\mathrm{x}})" display="inline"><semantics id="S3.SS4.p1.13.m1.3a"><mrow id="S3.SS4.p1.13.m1.3.4" xref="S3.SS4.p1.13.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.13.m1.3.4.2" xref="S3.SS4.p1.13.m1.3.4.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.13.m1.3.4.1" xref="S3.SS4.p1.13.m1.3.4.1.cmml">​</mo><mrow id="S3.SS4.p1.13.m1.3.4.3.2" xref="S3.SS4.p1.13.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS4.p1.13.m1.3.4.3.2.1" xref="S3.SS4.p1.13.m1.3.4.3.1.cmml">(</mo><mi id="S3.SS4.p1.13.m1.1.1" xref="S3.SS4.p1.13.m1.1.1.cmml">θ</mi><mo id="S3.SS4.p1.13.m1.3.4.3.2.2" xref="S3.SS4.p1.13.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS4.p1.13.m1.2.2" xref="S3.SS4.p1.13.m1.2.2.cmml">ϕ</mi><mo id="S3.SS4.p1.13.m1.3.4.3.2.3" xref="S3.SS4.p1.13.m1.3.4.3.1.cmml">;</mo><mi mathvariant="normal" id="S3.SS4.p1.13.m1.3.3" xref="S3.SS4.p1.13.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.SS4.p1.13.m1.3.4.3.2.4" xref="S3.SS4.p1.13.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m1.3b"><apply id="S3.SS4.p1.13.m1.3.4.cmml" xref="S3.SS4.p1.13.m1.3.4"><times id="S3.SS4.p1.13.m1.3.4.1.cmml" xref="S3.SS4.p1.13.m1.3.4.1"></times><ci id="S3.SS4.p1.13.m1.3.4.2.cmml" xref="S3.SS4.p1.13.m1.3.4.2">ℒ</ci><vector id="S3.SS4.p1.13.m1.3.4.3.1.cmml" xref="S3.SS4.p1.13.m1.3.4.3.2"><ci id="S3.SS4.p1.13.m1.1.1.cmml" xref="S3.SS4.p1.13.m1.1.1">𝜃</ci><ci id="S3.SS4.p1.13.m1.2.2.cmml" xref="S3.SS4.p1.13.m1.2.2">italic-ϕ</ci><ci id="S3.SS4.p1.13.m1.3.3.cmml" xref="S3.SS4.p1.13.m1.3.3">x</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m1.3c">\mathcal{L}({\theta,\phi;\mathrm{x}})</annotation></semantics></math> is the evidence lower bound (ELBO). To obtain the best parameter estimation, we can maximize the ELBO by means of Monta Carlo integration:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="E_{z\sim q_{\phi}({\mathrm{z}}|\mathrm{x})}[\log p_{\theta}({\mathrm{x}}|\mathrm{z})]\approx\frac{1}{L}\sum_{l=1}^{L}\log p_{\theta}({\mathrm{x}}|\mathrm{z}_{l})" display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.cmml"><msub id="S3.E6.m1.2.2.1.3" xref="S3.E6.m1.2.2.1.3.cmml"><mi id="S3.E6.m1.2.2.1.3.2" xref="S3.E6.m1.2.2.1.3.2.cmml">E</mi><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml">z</mi><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">∼</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">q</mi><mi id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.E6.m1.2.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.3.1" xref="S3.E6.m1.2.2.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.2.2.1.1.1.1.3a" xref="S3.E6.m1.2.2.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E6.m1.2.2.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.3.2.2" xref="S3.E6.m1.2.2.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E6.m1.2.2.1.1.1.1.3.2.3" xref="S3.E6.m1.2.2.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml">≈</mo><mrow id="S3.E6.m1.3.3.2" xref="S3.E6.m1.3.3.2.cmml"><mfrac id="S3.E6.m1.3.3.2.3" xref="S3.E6.m1.3.3.2.3.cmml"><mn id="S3.E6.m1.3.3.2.3.2" xref="S3.E6.m1.3.3.2.3.2.cmml">1</mn><mi id="S3.E6.m1.3.3.2.3.3" xref="S3.E6.m1.3.3.2.3.3.cmml">L</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.2.2" xref="S3.E6.m1.3.3.2.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.2.1" xref="S3.E6.m1.3.3.2.1.cmml"><munderover id="S3.E6.m1.3.3.2.1.2" xref="S3.E6.m1.3.3.2.1.2.cmml"><mo movablelimits="false" id="S3.E6.m1.3.3.2.1.2.2.2" xref="S3.E6.m1.3.3.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.2.1.2.2.3" xref="S3.E6.m1.3.3.2.1.2.2.3.cmml"><mi id="S3.E6.m1.3.3.2.1.2.2.3.2" xref="S3.E6.m1.3.3.2.1.2.2.3.2.cmml">l</mi><mo id="S3.E6.m1.3.3.2.1.2.2.3.1" xref="S3.E6.m1.3.3.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.2.1.2.2.3.3" xref="S3.E6.m1.3.3.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.3.3.2.1.2.3" xref="S3.E6.m1.3.3.2.1.2.3.cmml">L</mi></munderover><mrow id="S3.E6.m1.3.3.2.1.1" xref="S3.E6.m1.3.3.2.1.1.cmml"><mrow id="S3.E6.m1.3.3.2.1.1.3" xref="S3.E6.m1.3.3.2.1.1.3.cmml"><mi id="S3.E6.m1.3.3.2.1.1.3.1" xref="S3.E6.m1.3.3.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.3.3.2.1.1.3a" xref="S3.E6.m1.3.3.2.1.1.3.cmml">⁡</mo><msub id="S3.E6.m1.3.3.2.1.1.3.2" xref="S3.E6.m1.3.3.2.1.1.3.2.cmml"><mi id="S3.E6.m1.3.3.2.1.1.3.2.2" xref="S3.E6.m1.3.3.2.1.1.3.2.2.cmml">p</mi><mi id="S3.E6.m1.3.3.2.1.1.3.2.3" xref="S3.E6.m1.3.3.2.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.2.1.1.2" xref="S3.E6.m1.3.3.2.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.2.1.1.1.1" xref="S3.E6.m1.3.3.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.2.1.1.1.1.2" xref="S3.E6.m1.3.3.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.2.1.1.1.1.1" xref="S3.E6.m1.3.3.2.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E6.m1.3.3.2.1.1.1.1.1.2" xref="S3.E6.m1.3.3.2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E6.m1.3.3.2.1.1.1.1.1.1" xref="S3.E6.m1.3.3.2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E6.m1.3.3.2.1.1.1.1.1.3" xref="S3.E6.m1.3.3.2.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E6.m1.3.3.2.1.1.1.1.1.3.2" xref="S3.E6.m1.3.3.2.1.1.1.1.1.3.2.cmml">z</mi><mi id="S3.E6.m1.3.3.2.1.1.1.1.1.3.3" xref="S3.E6.m1.3.3.2.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="S3.E6.m1.3.3.2.1.1.1.1.3" xref="S3.E6.m1.3.3.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><approx id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"></approx><apply id="S3.E6.m1.2.2.1.cmml" xref="S3.E6.m1.2.2.1"><times id="S3.E6.m1.2.2.1.2.cmml" xref="S3.E6.m1.2.2.1.2"></times><apply id="S3.E6.m1.2.2.1.3.cmml" xref="S3.E6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.3.1.cmml" xref="S3.E6.m1.2.2.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.3.2.cmml" xref="S3.E6.m1.2.2.1.3.2">𝐸</ci><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2">similar-to</csymbol><ci id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3">𝑧</ci><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝑞</ci><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2">z</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3">x</ci></apply></apply></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1"><times id="S3.E6.m1.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.2"></times><apply id="S3.E6.m1.2.2.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.3"><log id="S3.E6.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.3.1"></log><apply id="S3.E6.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E6.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.2">x</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.3">z</ci></apply></apply></apply></apply><apply id="S3.E6.m1.3.3.2.cmml" xref="S3.E6.m1.3.3.2"><times id="S3.E6.m1.3.3.2.2.cmml" xref="S3.E6.m1.3.3.2.2"></times><apply id="S3.E6.m1.3.3.2.3.cmml" xref="S3.E6.m1.3.3.2.3"><divide id="S3.E6.m1.3.3.2.3.1.cmml" xref="S3.E6.m1.3.3.2.3"></divide><cn type="integer" id="S3.E6.m1.3.3.2.3.2.cmml" xref="S3.E6.m1.3.3.2.3.2">1</cn><ci id="S3.E6.m1.3.3.2.3.3.cmml" xref="S3.E6.m1.3.3.2.3.3">𝐿</ci></apply><apply id="S3.E6.m1.3.3.2.1.cmml" xref="S3.E6.m1.3.3.2.1"><apply id="S3.E6.m1.3.3.2.1.2.cmml" xref="S3.E6.m1.3.3.2.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.1.2.1.cmml" xref="S3.E6.m1.3.3.2.1.2">superscript</csymbol><apply id="S3.E6.m1.3.3.2.1.2.2.cmml" xref="S3.E6.m1.3.3.2.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.1.2.2.1.cmml" xref="S3.E6.m1.3.3.2.1.2">subscript</csymbol><sum id="S3.E6.m1.3.3.2.1.2.2.2.cmml" xref="S3.E6.m1.3.3.2.1.2.2.2"></sum><apply id="S3.E6.m1.3.3.2.1.2.2.3.cmml" xref="S3.E6.m1.3.3.2.1.2.2.3"><eq id="S3.E6.m1.3.3.2.1.2.2.3.1.cmml" xref="S3.E6.m1.3.3.2.1.2.2.3.1"></eq><ci id="S3.E6.m1.3.3.2.1.2.2.3.2.cmml" xref="S3.E6.m1.3.3.2.1.2.2.3.2">𝑙</ci><cn type="integer" id="S3.E6.m1.3.3.2.1.2.2.3.3.cmml" xref="S3.E6.m1.3.3.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.3.3.2.1.2.3.cmml" xref="S3.E6.m1.3.3.2.1.2.3">𝐿</ci></apply><apply id="S3.E6.m1.3.3.2.1.1.cmml" xref="S3.E6.m1.3.3.2.1.1"><times id="S3.E6.m1.3.3.2.1.1.2.cmml" xref="S3.E6.m1.3.3.2.1.1.2"></times><apply id="S3.E6.m1.3.3.2.1.1.3.cmml" xref="S3.E6.m1.3.3.2.1.1.3"><log id="S3.E6.m1.3.3.2.1.1.3.1.cmml" xref="S3.E6.m1.3.3.2.1.1.3.1"></log><apply id="S3.E6.m1.3.3.2.1.1.3.2.cmml" xref="S3.E6.m1.3.3.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.2.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.3.3.2.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.2.1.1.3.2.2">𝑝</ci><ci id="S3.E6.m1.3.3.2.1.1.3.2.3.cmml" xref="S3.E6.m1.3.3.2.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.E6.m1.3.3.2.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.2.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.3.3.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.3.3.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.2.1.1.1.1.1.2">x</ci><apply id="S3.E6.m1.3.3.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.2.1.1.1.1.1.3.2">z</ci><ci id="S3.E6.m1.3.3.2.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.2.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">E_{z\sim q_{\phi}({\mathrm{z}}|\mathrm{x})}[\log p_{\theta}({\mathrm{x}}|\mathrm{z})]\approx\frac{1}{L}\sum_{l=1}^{L}\log p_{\theta}({\mathrm{x}}|\mathrm{z}_{l})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">As for the second term (KL divergence), it could be explicitly equal to <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\frac{1}{2}\sum_{j=1}^{J}(\mu_{j}^{2}+\sigma_{j}^{2}-log(\sigma_{j}^{2})-1)" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mfrac id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mn id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml">1</mn><mn id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml"><msubsup id="S3.SS4.p2.1.m1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.2.cmml"><mo rspace="0em" id="S3.SS4.p2.1.m1.1.1.1.2.2.2" xref="S3.SS4.p2.1.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.SS4.p2.1.m1.1.1.1.2.2.3" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.2.2.3.2" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.SS4.p2.1.m1.1.1.1.2.2.3.1" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.SS4.p2.1.m1.1.1.1.2.2.3.3" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS4.p2.1.m1.1.1.1.2.3" xref="S3.SS4.p2.1.m1.1.1.1.2.3.cmml">J</mi></msubsup><mrow id="S3.SS4.p2.1.m1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p2.1.m1.1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.cmml"><msubsup id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.2.cmml">μ</mi><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.3.cmml">j</mi><mn id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.3.cmml">2</mn></msubsup><mo id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.2.cmml">σ</mi><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.3.cmml">j</mi><mn id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow><mo id="S3.SS4.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.4" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2a" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.5" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2b" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">σ</mi><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mn id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.1.m1.1.1.1.1.1.1.2a" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.2.cmml">−</mo><mn id="S3.SS4.p2.1.m1.1.1.1.1.1.1.4" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.4.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><times id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2"></times><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><divide id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3"></divide><cn type="integer" id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">1</cn><cn type="integer" id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">2</cn></apply><apply id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"><apply id="S3.SS4.p2.1.m1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2">superscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.2.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2">subscript</csymbol><sum id="S3.SS4.p2.1.m1.1.1.1.2.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2.2.2"></sum><apply id="S3.SS4.p2.1.m1.1.1.1.2.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3"><eq id="S3.SS4.p2.1.m1.1.1.1.2.2.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3.1"></eq><ci id="S3.SS4.p2.1.m1.1.1.1.2.2.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.SS4.p2.1.m1.1.1.1.2.2.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p2.1.m1.1.1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2.3">𝐽</ci></apply><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1"><minus id="S3.SS4.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.2"></minus><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3"><plus id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.1"></plus><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.2">𝜇</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.2">𝜎</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1"><times id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.3">𝑙</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.4">𝑜</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.5">𝑔</ci><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝜎</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply><cn type="integer" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.4.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\frac{1}{2}\sum_{j=1}^{J}(\mu_{j}^{2}+\sigma_{j}^{2}-log(\sigma_{j}^{2})-1)</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.16" class="ltx_p">Conventional VAE is not a sequential model because it is merely composed of multilayer perceptrons. To deal with time sequences using VAE, we glue ConvGRU and VAE as illustrated in Fig. <a href="#S3.F4" title="Figure 4 ‣ III-D Variational ConvGRU ‣ III Methodology ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We denote the logvar layer and mean layer in the figure as <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="f_{\phi}^{\sigma}" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><msubsup id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2.2" xref="S3.SS4.p3.1.m1.1.1.2.2.cmml">f</mi><mi id="S3.SS4.p3.1.m1.1.1.2.3" xref="S3.SS4.p3.1.m1.1.1.2.3.cmml">ϕ</mi><mi id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">σ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2.2">𝑓</ci><ci id="S3.SS4.p3.1.m1.1.1.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.2.3">italic-ϕ</ci></apply><ci id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">f_{\phi}^{\sigma}</annotation></semantics></math> and <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="f_{\phi}^{\mu}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msubsup id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">f</mi><mi id="S3.SS4.p3.2.m2.1.1.2.3" xref="S3.SS4.p3.2.m2.1.1.2.3.cmml">ϕ</mi><mi id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml">μ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">superscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝑓</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3">italic-ϕ</ci></apply><ci id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">f_{\phi}^{\mu}</annotation></semantics></math>, respectively. In detail, at time <math id="S3.SS4.p3.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS4.p3.3.m3.1a"><mi id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><ci id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">t</annotation></semantics></math>, hidden features <math id="S3.SS4.p3.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{h}_{t}}" display="inline"><semantics id="S3.SS4.p3.4.m4.1a"><msub id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml"><mi id="S3.SS4.p3.4.m4.1.1.2" xref="S3.SS4.p3.4.m4.1.1.2.cmml">𝐡</mi><mi id="S3.SS4.p3.4.m4.1.1.3" xref="S3.SS4.p3.4.m4.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><apply id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p3.4.m4.1.1.2.cmml" xref="S3.SS4.p3.4.m4.1.1.2">𝐡</ci><ci id="S3.SS4.p3.4.m4.1.1.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">\boldsymbol{\mathrm{h}_{t}}</annotation></semantics></math> in spatio-tempoal domains are extracted from the last ConvGRU layer based on input observation <math id="S3.SS4.p3.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{x}_{t}}" display="inline"><semantics id="S3.SS4.p3.5.m5.1a"><msub id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml"><mi id="S3.SS4.p3.5.m5.1.1.2" xref="S3.SS4.p3.5.m5.1.1.2.cmml">𝐱</mi><mi id="S3.SS4.p3.5.m5.1.1.3" xref="S3.SS4.p3.5.m5.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><apply id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m5.1.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p3.5.m5.1.1.2.cmml" xref="S3.SS4.p3.5.m5.1.1.2">𝐱</ci><ci id="S3.SS4.p3.5.m5.1.1.3.cmml" xref="S3.SS4.p3.5.m5.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">\boldsymbol{\mathrm{x}_{t}}</annotation></semantics></math> and preceding hidden variable <math id="S3.SS4.p3.6.m6.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{h}_{t-1}}" display="inline"><semantics id="S3.SS4.p3.6.m6.1a"><msub id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml"><mi id="S3.SS4.p3.6.m6.1.1.2" xref="S3.SS4.p3.6.m6.1.1.2.cmml">𝐡</mi><mrow id="S3.SS4.p3.6.m6.1.1.3" xref="S3.SS4.p3.6.m6.1.1.3.cmml"><mi id="S3.SS4.p3.6.m6.1.1.3.2" xref="S3.SS4.p3.6.m6.1.1.3.2.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.SS4.p3.6.m6.1.1.3.1" xref="S3.SS4.p3.6.m6.1.1.3.1.cmml">−</mo><mn id="S3.SS4.p3.6.m6.1.1.3.3" xref="S3.SS4.p3.6.m6.1.1.3.3.cmml">𝟏</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><apply id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.6.m6.1.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p3.6.m6.1.1.2.cmml" xref="S3.SS4.p3.6.m6.1.1.2">𝐡</ci><apply id="S3.SS4.p3.6.m6.1.1.3.cmml" xref="S3.SS4.p3.6.m6.1.1.3"><minus id="S3.SS4.p3.6.m6.1.1.3.1.cmml" xref="S3.SS4.p3.6.m6.1.1.3.1"></minus><ci id="S3.SS4.p3.6.m6.1.1.3.2.cmml" xref="S3.SS4.p3.6.m6.1.1.3.2">𝒕</ci><cn type="integer" id="S3.SS4.p3.6.m6.1.1.3.3.cmml" xref="S3.SS4.p3.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">\boldsymbol{\mathrm{h}_{t-1}}</annotation></semantics></math>. Then, Gaussian parameters of <math id="S3.SS4.p3.7.m7.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{x}_{t}}" display="inline"><semantics id="S3.SS4.p3.7.m7.1a"><msub id="S3.SS4.p3.7.m7.1.1" xref="S3.SS4.p3.7.m7.1.1.cmml"><mi id="S3.SS4.p3.7.m7.1.1.2" xref="S3.SS4.p3.7.m7.1.1.2.cmml">𝐱</mi><mi id="S3.SS4.p3.7.m7.1.1.3" xref="S3.SS4.p3.7.m7.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m7.1b"><apply id="S3.SS4.p3.7.m7.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m7.1.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p3.7.m7.1.1.2.cmml" xref="S3.SS4.p3.7.m7.1.1.2">𝐱</ci><ci id="S3.SS4.p3.7.m7.1.1.3.cmml" xref="S3.SS4.p3.7.m7.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m7.1c">\boldsymbol{\mathrm{x}_{t}}</annotation></semantics></math> and <math id="S3.SS4.p3.8.m8.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{z}_{t}}" display="inline"><semantics id="S3.SS4.p3.8.m8.1a"><msub id="S3.SS4.p3.8.m8.1.1" xref="S3.SS4.p3.8.m8.1.1.cmml"><mi id="S3.SS4.p3.8.m8.1.1.2" xref="S3.SS4.p3.8.m8.1.1.2.cmml">𝐳</mi><mi id="S3.SS4.p3.8.m8.1.1.3" xref="S3.SS4.p3.8.m8.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.8.m8.1b"><apply id="S3.SS4.p3.8.m8.1.1.cmml" xref="S3.SS4.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m8.1.1.1.cmml" xref="S3.SS4.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p3.8.m8.1.1.2.cmml" xref="S3.SS4.p3.8.m8.1.1.2">𝐳</ci><ci id="S3.SS4.p3.8.m8.1.1.3.cmml" xref="S3.SS4.p3.8.m8.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.8.m8.1c">\boldsymbol{\mathrm{z}_{t}}</annotation></semantics></math> are derived from the hidden features. Concretely speaking, we can obtain the means <math id="S3.SS4.p3.9.m9.1" class="ltx_Math" alttext="\boldsymbol{\mu}_{\mathrm{x}_{t}}" display="inline"><semantics id="S3.SS4.p3.9.m9.1a"><msub id="S3.SS4.p3.9.m9.1.1" xref="S3.SS4.p3.9.m9.1.1.cmml"><mi id="S3.SS4.p3.9.m9.1.1.2" xref="S3.SS4.p3.9.m9.1.1.2.cmml">𝝁</mi><msub id="S3.SS4.p3.9.m9.1.1.3" xref="S3.SS4.p3.9.m9.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS4.p3.9.m9.1.1.3.2" xref="S3.SS4.p3.9.m9.1.1.3.2.cmml">x</mi><mi id="S3.SS4.p3.9.m9.1.1.3.3" xref="S3.SS4.p3.9.m9.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.9.m9.1b"><apply id="S3.SS4.p3.9.m9.1.1.cmml" xref="S3.SS4.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.9.m9.1.1.1.cmml" xref="S3.SS4.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p3.9.m9.1.1.2.cmml" xref="S3.SS4.p3.9.m9.1.1.2">𝝁</ci><apply id="S3.SS4.p3.9.m9.1.1.3.cmml" xref="S3.SS4.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.9.m9.1.1.3.1.cmml" xref="S3.SS4.p3.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.9.m9.1.1.3.2.cmml" xref="S3.SS4.p3.9.m9.1.1.3.2">x</ci><ci id="S3.SS4.p3.9.m9.1.1.3.3.cmml" xref="S3.SS4.p3.9.m9.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.9.m9.1c">\boldsymbol{\mu}_{\mathrm{x}_{t}}</annotation></semantics></math> from a linear layer <math id="S3.SS4.p3.10.m10.1" class="ltx_Math" alttext="f_{\phi}^{\mu}" display="inline"><semantics id="S3.SS4.p3.10.m10.1a"><msubsup id="S3.SS4.p3.10.m10.1.1" xref="S3.SS4.p3.10.m10.1.1.cmml"><mi id="S3.SS4.p3.10.m10.1.1.2.2" xref="S3.SS4.p3.10.m10.1.1.2.2.cmml">f</mi><mi id="S3.SS4.p3.10.m10.1.1.2.3" xref="S3.SS4.p3.10.m10.1.1.2.3.cmml">ϕ</mi><mi id="S3.SS4.p3.10.m10.1.1.3" xref="S3.SS4.p3.10.m10.1.1.3.cmml">μ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.10.m10.1b"><apply id="S3.SS4.p3.10.m10.1.1.cmml" xref="S3.SS4.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m10.1.1.1.cmml" xref="S3.SS4.p3.10.m10.1.1">superscript</csymbol><apply id="S3.SS4.p3.10.m10.1.1.2.cmml" xref="S3.SS4.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m10.1.1.2.1.cmml" xref="S3.SS4.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS4.p3.10.m10.1.1.2.2.cmml" xref="S3.SS4.p3.10.m10.1.1.2.2">𝑓</ci><ci id="S3.SS4.p3.10.m10.1.1.2.3.cmml" xref="S3.SS4.p3.10.m10.1.1.2.3">italic-ϕ</ci></apply><ci id="S3.SS4.p3.10.m10.1.1.3.cmml" xref="S3.SS4.p3.10.m10.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.10.m10.1c">f_{\phi}^{\mu}</annotation></semantics></math>. The reparameterization trick is adopted to generate a non-negative small number <math id="S3.SS4.p3.11.m11.1" class="ltx_Math" alttext="\boldsymbol{\epsilon_{\mathrm{x}_{t}}}" display="inline"><semantics id="S3.SS4.p3.11.m11.1a"><msub id="S3.SS4.p3.11.m11.1.1" xref="S3.SS4.p3.11.m11.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.SS4.p3.11.m11.1.1.2" xref="S3.SS4.p3.11.m11.1.1.2.cmml">ϵ</mi><msub id="S3.SS4.p3.11.m11.1.1.3" xref="S3.SS4.p3.11.m11.1.1.3.cmml"><mi id="S3.SS4.p3.11.m11.1.1.3.2" xref="S3.SS4.p3.11.m11.1.1.3.2.cmml">𝐱</mi><mi id="S3.SS4.p3.11.m11.1.1.3.3" xref="S3.SS4.p3.11.m11.1.1.3.3.cmml">𝒕</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.11.m11.1b"><apply id="S3.SS4.p3.11.m11.1.1.cmml" xref="S3.SS4.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.11.m11.1.1.1.cmml" xref="S3.SS4.p3.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p3.11.m11.1.1.2.cmml" xref="S3.SS4.p3.11.m11.1.1.2">bold-italic-ϵ</ci><apply id="S3.SS4.p3.11.m11.1.1.3.cmml" xref="S3.SS4.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.11.m11.1.1.3.1.cmml" xref="S3.SS4.p3.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.11.m11.1.1.3.2.cmml" xref="S3.SS4.p3.11.m11.1.1.3.2">𝐱</ci><ci id="S3.SS4.p3.11.m11.1.1.3.3.cmml" xref="S3.SS4.p3.11.m11.1.1.3.3">𝒕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.11.m11.1c">\boldsymbol{\epsilon_{\mathrm{x}_{t}}}</annotation></semantics></math>, and we can get the standard deviations afterwards: <math id="S3.SS4.p3.12.m12.1" class="ltx_Math" alttext="\boldsymbol{\sigma^{\prime}_{\mathrm{x}_{t}}}=\boldsymbol{\sigma_{\mathrm{x}_{t}}}+\boldsymbol{\epsilon_{\mathrm{x}_{t}}}" display="inline"><semantics id="S3.SS4.p3.12.m12.1a"><mrow id="S3.SS4.p3.12.m12.1.1" xref="S3.SS4.p3.12.m12.1.1.cmml"><msubsup id="S3.SS4.p3.12.m12.1.1.2" xref="S3.SS4.p3.12.m12.1.1.2.cmml"><mi id="S3.SS4.p3.12.m12.1.1.2.2.2" xref="S3.SS4.p3.12.m12.1.1.2.2.2.cmml">𝝈</mi><msub id="S3.SS4.p3.12.m12.1.1.2.3" xref="S3.SS4.p3.12.m12.1.1.2.3.cmml"><mi id="S3.SS4.p3.12.m12.1.1.2.3.2" xref="S3.SS4.p3.12.m12.1.1.2.3.2.cmml">𝐱</mi><mi id="S3.SS4.p3.12.m12.1.1.2.3.3" xref="S3.SS4.p3.12.m12.1.1.2.3.3.cmml">𝒕</mi></msub><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.SS4.p3.12.m12.1.1.2.2.3" xref="S3.SS4.p3.12.m12.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p3.12.m12.1.1.1" xref="S3.SS4.p3.12.m12.1.1.1.cmml">=</mo><mrow id="S3.SS4.p3.12.m12.1.1.3" xref="S3.SS4.p3.12.m12.1.1.3.cmml"><msub id="S3.SS4.p3.12.m12.1.1.3.2" xref="S3.SS4.p3.12.m12.1.1.3.2.cmml"><mi id="S3.SS4.p3.12.m12.1.1.3.2.2" xref="S3.SS4.p3.12.m12.1.1.3.2.2.cmml">𝝈</mi><msub id="S3.SS4.p3.12.m12.1.1.3.2.3" xref="S3.SS4.p3.12.m12.1.1.3.2.3.cmml"><mi id="S3.SS4.p3.12.m12.1.1.3.2.3.2" xref="S3.SS4.p3.12.m12.1.1.3.2.3.2.cmml">𝐱</mi><mi id="S3.SS4.p3.12.m12.1.1.3.2.3.3" xref="S3.SS4.p3.12.m12.1.1.3.2.3.3.cmml">𝒕</mi></msub></msub><mo id="S3.SS4.p3.12.m12.1.1.3.1" xref="S3.SS4.p3.12.m12.1.1.3.1.cmml">+</mo><msub id="S3.SS4.p3.12.m12.1.1.3.3" xref="S3.SS4.p3.12.m12.1.1.3.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.SS4.p3.12.m12.1.1.3.3.2" xref="S3.SS4.p3.12.m12.1.1.3.3.2.cmml">ϵ</mi><msub id="S3.SS4.p3.12.m12.1.1.3.3.3" xref="S3.SS4.p3.12.m12.1.1.3.3.3.cmml"><mi id="S3.SS4.p3.12.m12.1.1.3.3.3.2" xref="S3.SS4.p3.12.m12.1.1.3.3.3.2.cmml">𝐱</mi><mi id="S3.SS4.p3.12.m12.1.1.3.3.3.3" xref="S3.SS4.p3.12.m12.1.1.3.3.3.3.cmml">𝒕</mi></msub></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.12.m12.1b"><apply id="S3.SS4.p3.12.m12.1.1.cmml" xref="S3.SS4.p3.12.m12.1.1"><eq id="S3.SS4.p3.12.m12.1.1.1.cmml" xref="S3.SS4.p3.12.m12.1.1.1"></eq><apply id="S3.SS4.p3.12.m12.1.1.2.cmml" xref="S3.SS4.p3.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.12.m12.1.1.2.1.cmml" xref="S3.SS4.p3.12.m12.1.1.2">subscript</csymbol><apply id="S3.SS4.p3.12.m12.1.1.2.2.cmml" xref="S3.SS4.p3.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.12.m12.1.1.2.2.1.cmml" xref="S3.SS4.p3.12.m12.1.1.2">superscript</csymbol><ci id="S3.SS4.p3.12.m12.1.1.2.2.2.cmml" xref="S3.SS4.p3.12.m12.1.1.2.2.2">𝝈</ci><ci id="S3.SS4.p3.12.m12.1.1.2.2.3.cmml" xref="S3.SS4.p3.12.m12.1.1.2.2.3">bold-′</ci></apply><apply id="S3.SS4.p3.12.m12.1.1.2.3.cmml" xref="S3.SS4.p3.12.m12.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p3.12.m12.1.1.2.3.1.cmml" xref="S3.SS4.p3.12.m12.1.1.2.3">subscript</csymbol><ci id="S3.SS4.p3.12.m12.1.1.2.3.2.cmml" xref="S3.SS4.p3.12.m12.1.1.2.3.2">𝐱</ci><ci id="S3.SS4.p3.12.m12.1.1.2.3.3.cmml" xref="S3.SS4.p3.12.m12.1.1.2.3.3">𝒕</ci></apply></apply><apply id="S3.SS4.p3.12.m12.1.1.3.cmml" xref="S3.SS4.p3.12.m12.1.1.3"><plus id="S3.SS4.p3.12.m12.1.1.3.1.cmml" xref="S3.SS4.p3.12.m12.1.1.3.1"></plus><apply id="S3.SS4.p3.12.m12.1.1.3.2.cmml" xref="S3.SS4.p3.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS4.p3.12.m12.1.1.3.2.1.cmml" xref="S3.SS4.p3.12.m12.1.1.3.2">subscript</csymbol><ci id="S3.SS4.p3.12.m12.1.1.3.2.2.cmml" xref="S3.SS4.p3.12.m12.1.1.3.2.2">𝝈</ci><apply id="S3.SS4.p3.12.m12.1.1.3.2.3.cmml" xref="S3.SS4.p3.12.m12.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS4.p3.12.m12.1.1.3.2.3.1.cmml" xref="S3.SS4.p3.12.m12.1.1.3.2.3">subscript</csymbol><ci id="S3.SS4.p3.12.m12.1.1.3.2.3.2.cmml" xref="S3.SS4.p3.12.m12.1.1.3.2.3.2">𝐱</ci><ci id="S3.SS4.p3.12.m12.1.1.3.2.3.3.cmml" xref="S3.SS4.p3.12.m12.1.1.3.2.3.3">𝒕</ci></apply></apply><apply id="S3.SS4.p3.12.m12.1.1.3.3.cmml" xref="S3.SS4.p3.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.12.m12.1.1.3.3.1.cmml" xref="S3.SS4.p3.12.m12.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p3.12.m12.1.1.3.3.2.cmml" xref="S3.SS4.p3.12.m12.1.1.3.3.2">bold-italic-ϵ</ci><apply id="S3.SS4.p3.12.m12.1.1.3.3.3.cmml" xref="S3.SS4.p3.12.m12.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.12.m12.1.1.3.3.3.1.cmml" xref="S3.SS4.p3.12.m12.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p3.12.m12.1.1.3.3.3.2.cmml" xref="S3.SS4.p3.12.m12.1.1.3.3.3.2">𝐱</ci><ci id="S3.SS4.p3.12.m12.1.1.3.3.3.3.cmml" xref="S3.SS4.p3.12.m12.1.1.3.3.3.3">𝒕</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.12.m12.1c">\boldsymbol{\sigma^{\prime}_{\mathrm{x}_{t}}}=\boldsymbol{\sigma_{\mathrm{x}_{t}}}+\boldsymbol{\epsilon_{\mathrm{x}_{t}}}</annotation></semantics></math>, where <math id="S3.SS4.p3.13.m13.1" class="ltx_Math" alttext="\boldsymbol{\sigma_{\mathrm{x}_{t}}}=f_{\phi}^{\sigma}(\boldsymbol{\mathrm{x}}_{t})" display="inline"><semantics id="S3.SS4.p3.13.m13.1a"><mrow id="S3.SS4.p3.13.m13.1.1" xref="S3.SS4.p3.13.m13.1.1.cmml"><msub id="S3.SS4.p3.13.m13.1.1.3" xref="S3.SS4.p3.13.m13.1.1.3.cmml"><mi id="S3.SS4.p3.13.m13.1.1.3.2" xref="S3.SS4.p3.13.m13.1.1.3.2.cmml">𝝈</mi><msub id="S3.SS4.p3.13.m13.1.1.3.3" xref="S3.SS4.p3.13.m13.1.1.3.3.cmml"><mi id="S3.SS4.p3.13.m13.1.1.3.3.2" xref="S3.SS4.p3.13.m13.1.1.3.3.2.cmml">𝐱</mi><mi id="S3.SS4.p3.13.m13.1.1.3.3.3" xref="S3.SS4.p3.13.m13.1.1.3.3.3.cmml">𝒕</mi></msub></msub><mo id="S3.SS4.p3.13.m13.1.1.2" xref="S3.SS4.p3.13.m13.1.1.2.cmml">=</mo><mrow id="S3.SS4.p3.13.m13.1.1.1" xref="S3.SS4.p3.13.m13.1.1.1.cmml"><msubsup id="S3.SS4.p3.13.m13.1.1.1.3" xref="S3.SS4.p3.13.m13.1.1.1.3.cmml"><mi id="S3.SS4.p3.13.m13.1.1.1.3.2.2" xref="S3.SS4.p3.13.m13.1.1.1.3.2.2.cmml">f</mi><mi id="S3.SS4.p3.13.m13.1.1.1.3.2.3" xref="S3.SS4.p3.13.m13.1.1.1.3.2.3.cmml">ϕ</mi><mi id="S3.SS4.p3.13.m13.1.1.1.3.3" xref="S3.SS4.p3.13.m13.1.1.1.3.3.cmml">σ</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.p3.13.m13.1.1.1.2" xref="S3.SS4.p3.13.m13.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p3.13.m13.1.1.1.1.1" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p3.13.m13.1.1.1.1.1.2" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p3.13.m13.1.1.1.1.1.1" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.13.m13.1.1.1.1.1.1.2" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS4.p3.13.m13.1.1.1.1.1.1.3" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS4.p3.13.m13.1.1.1.1.1.3" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.13.m13.1b"><apply id="S3.SS4.p3.13.m13.1.1.cmml" xref="S3.SS4.p3.13.m13.1.1"><eq id="S3.SS4.p3.13.m13.1.1.2.cmml" xref="S3.SS4.p3.13.m13.1.1.2"></eq><apply id="S3.SS4.p3.13.m13.1.1.3.cmml" xref="S3.SS4.p3.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.13.m13.1.1.3.1.cmml" xref="S3.SS4.p3.13.m13.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.13.m13.1.1.3.2.cmml" xref="S3.SS4.p3.13.m13.1.1.3.2">𝝈</ci><apply id="S3.SS4.p3.13.m13.1.1.3.3.cmml" xref="S3.SS4.p3.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.13.m13.1.1.3.3.1.cmml" xref="S3.SS4.p3.13.m13.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p3.13.m13.1.1.3.3.2.cmml" xref="S3.SS4.p3.13.m13.1.1.3.3.2">𝐱</ci><ci id="S3.SS4.p3.13.m13.1.1.3.3.3.cmml" xref="S3.SS4.p3.13.m13.1.1.3.3.3">𝒕</ci></apply></apply><apply id="S3.SS4.p3.13.m13.1.1.1.cmml" xref="S3.SS4.p3.13.m13.1.1.1"><times id="S3.SS4.p3.13.m13.1.1.1.2.cmml" xref="S3.SS4.p3.13.m13.1.1.1.2"></times><apply id="S3.SS4.p3.13.m13.1.1.1.3.cmml" xref="S3.SS4.p3.13.m13.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.13.m13.1.1.1.3.1.cmml" xref="S3.SS4.p3.13.m13.1.1.1.3">superscript</csymbol><apply id="S3.SS4.p3.13.m13.1.1.1.3.2.cmml" xref="S3.SS4.p3.13.m13.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.13.m13.1.1.1.3.2.1.cmml" xref="S3.SS4.p3.13.m13.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.13.m13.1.1.1.3.2.2.cmml" xref="S3.SS4.p3.13.m13.1.1.1.3.2.2">𝑓</ci><ci id="S3.SS4.p3.13.m13.1.1.1.3.2.3.cmml" xref="S3.SS4.p3.13.m13.1.1.1.3.2.3">italic-ϕ</ci></apply><ci id="S3.SS4.p3.13.m13.1.1.1.3.3.cmml" xref="S3.SS4.p3.13.m13.1.1.1.3.3">𝜎</ci></apply><apply id="S3.SS4.p3.13.m13.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.13.m13.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.13.m13.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.13.m13.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.13.m13.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS4.p3.13.m13.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.13.m13.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.13.m13.1c">\boldsymbol{\sigma_{\mathrm{x}_{t}}}=f_{\phi}^{\sigma}(\boldsymbol{\mathrm{x}}_{t})</annotation></semantics></math>. Now we have the latent variable <math id="S3.SS4.p3.14.m14.4" class="ltx_Math" alttext="\boldsymbol{\mathrm{z}}_{t}\sim\mathcal{N}(\boldsymbol{\mu_{\mathrm{x}_{t}},\sigma_{\mathrm{x}_{t}}^{\prime 2}})" display="inline"><semantics id="S3.SS4.p3.14.m14.4a"><mrow id="S3.SS4.p3.14.m14.4.4" xref="S3.SS4.p3.14.m14.4.4.cmml"><msub id="S3.SS4.p3.14.m14.4.4.4" xref="S3.SS4.p3.14.m14.4.4.4.cmml"><mi id="S3.SS4.p3.14.m14.4.4.4.2" xref="S3.SS4.p3.14.m14.4.4.4.2.cmml">𝐳</mi><mi id="S3.SS4.p3.14.m14.4.4.4.3" xref="S3.SS4.p3.14.m14.4.4.4.3.cmml">t</mi></msub><mo id="S3.SS4.p3.14.m14.4.4.3" xref="S3.SS4.p3.14.m14.4.4.3.cmml">∼</mo><mrow id="S3.SS4.p3.14.m14.4.4.2" xref="S3.SS4.p3.14.m14.4.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.14.m14.4.4.2.4" xref="S3.SS4.p3.14.m14.4.4.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.14.m14.4.4.2.3" xref="S3.SS4.p3.14.m14.4.4.2.3.cmml">​</mo><mrow id="S3.SS4.p3.14.m14.4.4.2.2.2" xref="S3.SS4.p3.14.m14.4.4.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p3.14.m14.4.4.2.2.2.3" xref="S3.SS4.p3.14.m14.4.4.2.2.3.cmml">(</mo><msub id="S3.SS4.p3.14.m14.3.3.1.1.1.1" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.cmml"><mi id="S3.SS4.p3.14.m14.3.3.1.1.1.1.2" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.2.cmml">𝝁</mi><msub id="S3.SS4.p3.14.m14.3.3.1.1.1.1.3" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.cmml"><mi id="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.2" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.3" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.3.cmml">𝒕</mi></msub></msub><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.SS4.p3.14.m14.4.4.2.2.2.4" xref="S3.SS4.p3.14.m14.4.4.2.2.3.cmml">,</mo><msubsup id="S3.SS4.p3.14.m14.4.4.2.2.2.2" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.cmml"><mi id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.2" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.2.cmml">𝝈</mi><msub id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.cmml"><mi id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.2" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.2.cmml">𝐱</mi><mi id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.3" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.3.cmml">𝒕</mi></msub><mrow id="S3.SS4.p3.14.m14.2.2.2.2" xref="S3.SS4.p3.14.m14.2.2.2.3.cmml"><mo mathsize="142%" id="S3.SS4.p3.14.m14.2.2.2.2.1" xref="S3.SS4.p3.14.m14.2.2.2.2.1.cmml">′</mo><mo lspace="0em" id="S3.SS4.p3.14.m14.2.2.2.2.2" xref="S3.SS4.p3.14.m14.2.2.2.3.cmml">⁣</mo><mn id="S3.SS4.p3.14.m14.1.1.1.1" xref="S3.SS4.p3.14.m14.1.1.1.1.cmml">𝟐</mn></mrow></msubsup><mo stretchy="false" id="S3.SS4.p3.14.m14.4.4.2.2.2.5" xref="S3.SS4.p3.14.m14.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.14.m14.4b"><apply id="S3.SS4.p3.14.m14.4.4.cmml" xref="S3.SS4.p3.14.m14.4.4"><csymbol cd="latexml" id="S3.SS4.p3.14.m14.4.4.3.cmml" xref="S3.SS4.p3.14.m14.4.4.3">similar-to</csymbol><apply id="S3.SS4.p3.14.m14.4.4.4.cmml" xref="S3.SS4.p3.14.m14.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.p3.14.m14.4.4.4.1.cmml" xref="S3.SS4.p3.14.m14.4.4.4">subscript</csymbol><ci id="S3.SS4.p3.14.m14.4.4.4.2.cmml" xref="S3.SS4.p3.14.m14.4.4.4.2">𝐳</ci><ci id="S3.SS4.p3.14.m14.4.4.4.3.cmml" xref="S3.SS4.p3.14.m14.4.4.4.3">𝑡</ci></apply><apply id="S3.SS4.p3.14.m14.4.4.2.cmml" xref="S3.SS4.p3.14.m14.4.4.2"><times id="S3.SS4.p3.14.m14.4.4.2.3.cmml" xref="S3.SS4.p3.14.m14.4.4.2.3"></times><ci id="S3.SS4.p3.14.m14.4.4.2.4.cmml" xref="S3.SS4.p3.14.m14.4.4.2.4">𝒩</ci><interval closure="open" id="S3.SS4.p3.14.m14.4.4.2.2.3.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2"><apply id="S3.SS4.p3.14.m14.3.3.1.1.1.1.cmml" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.14.m14.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.14.m14.3.3.1.1.1.1.2.cmml" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.2">𝝁</ci><apply id="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.cmml" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.1.cmml" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.2.cmml" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.2">𝐱</ci><ci id="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.3.cmml" xref="S3.SS4.p3.14.m14.3.3.1.1.1.1.3.3">𝒕</ci></apply></apply><apply id="S3.SS4.p3.14.m14.4.4.2.2.2.2.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.14.m14.4.4.2.2.2.2.1.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2">superscript</csymbol><apply id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.1.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.2.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.2">𝝈</ci><apply id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.1.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.2.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.2">𝐱</ci><ci id="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.3.cmml" xref="S3.SS4.p3.14.m14.4.4.2.2.2.2.2.3.3">𝒕</ci></apply></apply><list id="S3.SS4.p3.14.m14.2.2.2.3.cmml" xref="S3.SS4.p3.14.m14.2.2.2.2"><ci id="S3.SS4.p3.14.m14.2.2.2.2.1.cmml" xref="S3.SS4.p3.14.m14.2.2.2.2.1">′</ci><cn type="integer" id="S3.SS4.p3.14.m14.1.1.1.1.cmml" xref="S3.SS4.p3.14.m14.1.1.1.1">2</cn></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.14.m14.4c">\boldsymbol{\mathrm{z}}_{t}\sim\mathcal{N}(\boldsymbol{\mu_{\mathrm{x}_{t}},\sigma_{\mathrm{x}_{t}}^{\prime 2}})</annotation></semantics></math>. The reconstructed sequence <math id="S3.SS4.p3.15.m15.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{x}_{t}^{\prime}}" display="inline"><semantics id="S3.SS4.p3.15.m15.1a"><msubsup id="S3.SS4.p3.15.m15.1.1" xref="S3.SS4.p3.15.m15.1.1.cmml"><mi id="S3.SS4.p3.15.m15.1.1.2.2" xref="S3.SS4.p3.15.m15.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS4.p3.15.m15.1.1.2.3" xref="S3.SS4.p3.15.m15.1.1.2.3.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.SS4.p3.15.m15.1.1.3" xref="S3.SS4.p3.15.m15.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.15.m15.1b"><apply id="S3.SS4.p3.15.m15.1.1.cmml" xref="S3.SS4.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.15.m15.1.1.1.cmml" xref="S3.SS4.p3.15.m15.1.1">superscript</csymbol><apply id="S3.SS4.p3.15.m15.1.1.2.cmml" xref="S3.SS4.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.15.m15.1.1.2.1.cmml" xref="S3.SS4.p3.15.m15.1.1">subscript</csymbol><ci id="S3.SS4.p3.15.m15.1.1.2.2.cmml" xref="S3.SS4.p3.15.m15.1.1.2.2">𝐱</ci><ci id="S3.SS4.p3.15.m15.1.1.2.3.cmml" xref="S3.SS4.p3.15.m15.1.1.2.3">𝒕</ci></apply><ci id="S3.SS4.p3.15.m15.1.1.3.cmml" xref="S3.SS4.p3.15.m15.1.1.3">bold-′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.15.m15.1c">\boldsymbol{\mathrm{x}_{t}^{\prime}}</annotation></semantics></math> is created on sampled <math id="S3.SS4.p3.16.m16.1" class="ltx_Math" alttext="\boldsymbol{z}_{t}" display="inline"><semantics id="S3.SS4.p3.16.m16.1a"><msub id="S3.SS4.p3.16.m16.1.1" xref="S3.SS4.p3.16.m16.1.1.cmml"><mi id="S3.SS4.p3.16.m16.1.1.2" xref="S3.SS4.p3.16.m16.1.1.2.cmml">𝒛</mi><mi id="S3.SS4.p3.16.m16.1.1.3" xref="S3.SS4.p3.16.m16.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.16.m16.1b"><apply id="S3.SS4.p3.16.m16.1.1.cmml" xref="S3.SS4.p3.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.16.m16.1.1.1.cmml" xref="S3.SS4.p3.16.m16.1.1">subscript</csymbol><ci id="S3.SS4.p3.16.m16.1.1.2.cmml" xref="S3.SS4.p3.16.m16.1.1.2">𝒛</ci><ci id="S3.SS4.p3.16.m16.1.1.3.cmml" xref="S3.SS4.p3.16.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.16.m16.1c">\boldsymbol{z}_{t}</annotation></semantics></math> by a linear layer. Note that the output sequence of the ConvGRU decoder is in reverse order compared with the input sequence, which makes the optimization easier because the model can get off the ground by looking at low range correlations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Furthermore, as described in the problem statement, we focus more on the anomaly detection in the last timestamp of the input sequence. Therefore, only the hidden state of the last ConvGRU cell is employed in the decoder.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we first present the implementation details, including data sources, model settings, and evaluation metrics. Then, we compare the performance between our models (non-federated and federated fashion) and baseline models. Furthermore, we conduct an extensive study on anomaly diagnosis under different setups.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">To verify the effectiveness of our model, we conduct experiments on three datasets, including SMAP (Soil Moisture Active Passive satellite), MSL (Mars Science Laboratory rover), and Secure Water Treatment (SWaT) datasets. SMAP and MSL datasets come from telemetry data records of sensors in an individual spacecraft, where a set of associated telemetry values are collected, analyzed, and labeled by the experts in NASA, to identify anomalies that correspond to actual spacecraft issues <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. SWaT dataset is collected from a real-world water treatment testbed at the Singapore University of Technology and Design, representing a scaled-down version of a realistic Cyber-Physical System whose behaviors can be learned and analyzed in order to assure safety and security in a network environment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. As such, the training data is collected during two weeks of normal operation, and the testing data is collected in the following two days with a number of anomalous scenarios at different intervals. The multivariate time series in this dataset are presented based on one second and labeled as normal or abnormal at each time step. It is also noted that we down-sample the SWaT dataset by sequentially taking median values of each 10 instances for the purpose of efficient model training and evaluation. The statistical summary of three datasets is shown in Table <a href="#S4.T3" title="Table III ‣ IV-E1 Exploration of window length ‣ IV-E Exploration of Model Parameters and Latency Analysis ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Statistics of Datasets</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.3.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Dataset</span></th>
<th id="S4.T1.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Train</span></th>
<th id="S4.T1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.1.1.3.1" class="ltx_text" style="font-size:90%;">Test</span></th>
<th id="S4.T1.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.1.1.4.1" class="ltx_text" style="font-size:90%;">Features</span></th>
<th id="S4.T1.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.1.1.5.1" class="ltx_text" style="font-size:90%;">Anomalies(%)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.3.2.1" class="ltx_tr">
<td id="S4.T1.3.2.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.2.1.1.1" class="ltx_text" style="font-size:90%;">SMAP</span></td>
<td id="S4.T1.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.2.1.2.1" class="ltx_text" style="font-size:90%;">135183</span></td>
<td id="S4.T1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.2.1.3.1" class="ltx_text" style="font-size:90%;">427617</span></td>
<td id="S4.T1.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.2.1.4.1" class="ltx_text" style="font-size:90%;">25</span></td>
<td id="S4.T1.3.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.2.1.5.1" class="ltx_text" style="font-size:90%;">13.13</span></td>
</tr>
<tr id="S4.T1.3.3.2" class="ltx_tr">
<td id="S4.T1.3.3.2.1" class="ltx_td ltx_align_left" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.3.2.1.1" class="ltx_text" style="font-size:90%;">MSL</span></td>
<td id="S4.T1.3.3.2.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.3.2.2.1" class="ltx_text" style="font-size:90%;">58317</span></td>
<td id="S4.T1.3.3.2.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.3.2.3.1" class="ltx_text" style="font-size:90%;">73729</span></td>
<td id="S4.T1.3.3.2.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.3.2.4.1" class="ltx_text" style="font-size:90%;">55</span></td>
<td id="S4.T1.3.3.2.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.3.2.5.1" class="ltx_text" style="font-size:90%;">10.72</span></td>
</tr>
<tr id="S4.T1.3.4.3" class="ltx_tr">
<td id="S4.T1.3.4.3.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.4.3.1.1" class="ltx_text" style="font-size:90%;">SWaT*</span></td>
<td id="S4.T1.3.4.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.4.3.2.1" class="ltx_text" style="font-size:90%;">49680</span></td>
<td id="S4.T1.3.4.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.4.3.3.1" class="ltx_text" style="font-size:90%;">44992</span></td>
<td id="S4.T1.3.4.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.4.3.4.1" class="ltx_text" style="font-size:90%;">51</span></td>
<td id="S4.T1.3.4.3.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.3.4.3.5.1" class="ltx_text" style="font-size:90%;">11.98</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul id="S4.I1" class="ltx_itemize ltx_centering ltx_figure_panel">
<li id="S4.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">*</span> 
<div id="S4.I1.ix1.p1" class="ltx_para">
<p id="S4.I1.ix1.p1.1" class="ltx_p"><span id="S4.I1.ix1.p1.1.1" class="ltx_text" style="font-size:80%;">denotes the down-sampled version of original dataset.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Experimental Setup</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In our experiments, we utilize a sequence-to-sequence learning method to capture the temporal representation at the training stage, while only the last step of the reconstructed sequence is used for performance evaluation and further studies at the testing stage. The pipeline for data preprocessing is presented as follows: Firstly, the original training data is split into 3:1 for the training set and validation set. Next, a min-max normalization is performed on the training set, validation set, and the given testing set, respectively. A single-step moving window with length of 10 steps as default, is then used to slice the training, validation, and testing sequences, after which they can be fed into the model. Because of the data heterogeneity presented in SMAP and MSL datasets (independent time windows, different window lengths, irregular intervals, various types of sensors), we apply an individual model to an individual channel as it is not possible to stack all channels’ data in each dataset for training and testing.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS1.4.1.1" class="ltx_text">IV-B</span>1 </span><span id="S4.SS2.SSS1.5.2" class="ltx_text ltx_font_bold">Non-Federated Settings</span>
</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">For model hyper-parameters, the kernel size of the convolutional gate in ConvGRU is 3. The hidden size of the ConvGRU cell is 128 as default. For training details, Averaged Stochastic Gradient Descent (ASGD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> is used as the optimizer with learning rate 0.0001; the loss function consists of a reconstruction loss based on Mean Squared Error (MSE) and a Kullback–Leibler divergence loss measuring the difference between the latent and target distribution.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS2.4.1.1" class="ltx_text">IV-B</span>2 </span><span id="S4.SS2.SSS2.5.2" class="ltx_text ltx_font_bold">Federated Settings</span>
</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.10" class="ltx_p">We use the default hyper-parameters as described above with optimizer SGD instead of ASGD. If not specified, the default local update epoch <math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mi id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><ci id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">E</annotation></semantics></math> is set as <math id="S4.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><mn id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><cn type="integer" id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">1</annotation></semantics></math>, and the number of clients <math id="S4.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><mi id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><ci id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">C</annotation></semantics></math> is <math id="S4.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS2.SSS2.p1.4.m4.1a"><mn id="S4.SS2.SSS2.p1.4.m4.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m4.1b"><cn type="integer" id="S4.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m4.1c">3</annotation></semantics></math>. Each client exclusively owns data sampled from the training set in a non-iid manner <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. For SMAP and MSL, we first split the entire sequence in each channel into sub-sequences with a pre-defined window length and concatenate them, then divide the data into <math id="S4.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="S=W\times C" display="inline"><semantics id="S4.SS2.SSS2.p1.5.m5.1a"><mrow id="S4.SS2.SSS2.p1.5.m5.1.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS2.p1.5.m5.1.1.2" xref="S4.SS2.SSS2.p1.5.m5.1.1.2.cmml">S</mi><mo id="S4.SS2.SSS2.p1.5.m5.1.1.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.5.m5.1.1.3" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.5.m5.1.1.3.2" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS2.p1.5.m5.1.1.3.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.1.cmml">×</mo><mi id="S4.SS2.SSS2.p1.5.m5.1.1.3.3" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.5.m5.1b"><apply id="S4.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1"><eq id="S4.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.1"></eq><ci id="S4.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.2">𝑆</ci><apply id="S4.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3"><times id="S4.SS2.SSS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.1"></times><ci id="S4.SS2.SSS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.2">𝑊</ci><ci id="S4.SS2.SSS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.5.m5.1c">S=W\times C</annotation></semantics></math> shards of size <math id="S4.SS2.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\lfloor\frac{N}{S}\rfloor" display="inline"><semantics id="S4.SS2.SSS2.p1.6.m6.1a"><mrow id="S4.SS2.SSS2.p1.6.m6.1.2.2" xref="S4.SS2.SSS2.p1.6.m6.1.2.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p1.6.m6.1.2.2.1" xref="S4.SS2.SSS2.p1.6.m6.1.2.1.1.cmml">⌊</mo><mfrac id="S4.SS2.SSS2.p1.6.m6.1.1" xref="S4.SS2.SSS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.SSS2.p1.6.m6.1.1.2" xref="S4.SS2.SSS2.p1.6.m6.1.1.2.cmml">N</mi><mi id="S4.SS2.SSS2.p1.6.m6.1.1.3" xref="S4.SS2.SSS2.p1.6.m6.1.1.3.cmml">S</mi></mfrac><mo stretchy="false" id="S4.SS2.SSS2.p1.6.m6.1.2.2.2" xref="S4.SS2.SSS2.p1.6.m6.1.2.1.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.6.m6.1b"><apply id="S4.SS2.SSS2.p1.6.m6.1.2.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.2.2"><floor id="S4.SS2.SSS2.p1.6.m6.1.2.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.2.2.1"></floor><apply id="S4.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1"><divide id="S4.SS2.SSS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1"></divide><ci id="S4.SS2.SSS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.2">𝑁</ci><ci id="S4.SS2.SSS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS2.p1.6.m6.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.6.m6.1c">\lfloor\frac{N}{S}\rfloor</annotation></semantics></math>, and assign each client <math id="S4.SS2.SSS2.p1.7.m7.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS2.SSS2.p1.7.m7.1a"><mi id="S4.SS2.SSS2.p1.7.m7.1.1" xref="S4.SS2.SSS2.p1.7.m7.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.7.m7.1b"><ci id="S4.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS2.p1.7.m7.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.7.m7.1c">W</annotation></semantics></math> shards. <math id="S4.SS2.SSS2.p1.8.m8.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS2.SSS2.p1.8.m8.1a"><mi id="S4.SS2.SSS2.p1.8.m8.1.1" xref="S4.SS2.SSS2.p1.8.m8.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.8.m8.1b"><ci id="S4.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S4.SS2.SSS2.p1.8.m8.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.8.m8.1c">W</annotation></semantics></math> is the hyperparameter that controls the size of data in each client and is equal to 2 by default, <math id="S4.SS2.SSS2.p1.9.m9.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.SSS2.p1.9.m9.1a"><mi id="S4.SS2.SSS2.p1.9.m9.1.1" xref="S4.SS2.SSS2.p1.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.9.m9.1b"><ci id="S4.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS2.p1.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.9.m9.1c">C</annotation></semantics></math> is the number of clients, and <math id="S4.SS2.SSS2.p1.10.m10.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.SSS2.p1.10.m10.1a"><mi id="S4.SS2.SSS2.p1.10.m10.1.1" xref="S4.SS2.SSS2.p1.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.10.m10.1b"><ci id="S4.SS2.SSS2.p1.10.m10.1.1.cmml" xref="S4.SS2.SSS2.p1.10.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.10.m10.1c">N</annotation></semantics></math> is the length of the entire data. Different from SMAP and MSL data, there is only one entity in the SWaT data that impedes conventional non-iid sampling based on skewed labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Therefore, we let each client owns data of different time periods during the training stage on SWaT.</p>
</div>
<figure id="S4.T2" class="ltx_table">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Performance comparison of different models</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<td id="S4.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_border_tt ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;" rowspan="2"><span id="S4.T2.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></td>
<td id="S4.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="3"><span id="S4.T2.3.1.1.2.1" class="ltx_text" style="font-size:90%;">SMAP</span></td>
<td id="S4.T2.3.1.1.3" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="3"><span id="S4.T2.3.1.1.3.1" class="ltx_text" style="font-size:90%;">MSL</span></td>
<td id="S4.T2.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;" colspan="3"><span id="S4.T2.3.1.1.4.1" class="ltx_text" style="font-size:90%;">SWaT</span></td>
</tr>
<tr id="S4.T2.3.2.2" class="ltx_tr">
<td id="S4.T2.3.2.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.1.1" class="ltx_text" style="font-size:90%;">Precision</span></td>
<td id="S4.T2.3.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.2.1" class="ltx_text" style="font-size:90%;">Recall</span></td>
<td id="S4.T2.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.3.1" class="ltx_text" style="font-size:90%;">F1</span></td>
<td id="S4.T2.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.4.1" class="ltx_text" style="font-size:90%;">Precision</span></td>
<td id="S4.T2.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.5.1" class="ltx_text" style="font-size:90%;">Recall</span></td>
<td id="S4.T2.3.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.6.1" class="ltx_text" style="font-size:90%;">F1</span></td>
<td id="S4.T2.3.2.2.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.7.1" class="ltx_text" style="font-size:90%;">Precision</span></td>
<td id="S4.T2.3.2.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.8.1" class="ltx_text" style="font-size:90%;">Recall</span></td>
<td id="S4.T2.3.2.2.9" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.2.2.9.1" class="ltx_text" style="font-size:90%;">F1</span></td>
</tr>
<tr id="S4.T2.3.3.3" class="ltx_tr">
<td id="S4.T2.3.3.3.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.1.1" class="ltx_text" style="font-size:90%;">IF</span></td>
<td id="S4.T2.3.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.2.1" class="ltx_text" style="font-size:90%;">0.4423</span></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.3.1" class="ltx_text" style="font-size:90%;">0.5105</span></td>
<td id="S4.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.4.1" class="ltx_text" style="font-size:90%;">0.4671</span></td>
<td id="S4.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.5.1" class="ltx_text" style="font-size:90%;">0.5681</span></td>
<td id="S4.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.6.1" class="ltx_text" style="font-size:90%;">0.6740</span></td>
<td id="S4.T2.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.7.1" class="ltx_text" style="font-size:90%;">0.5984</span></td>
<td id="S4.T2.3.3.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.8.1" class="ltx_text" style="font-size:90%;">0.9620</span></td>
<td id="S4.T2.3.3.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.9.1" class="ltx_text" style="font-size:90%;">0.7315</span></td>
<td id="S4.T2.3.3.3.10" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.3.3.10.1" class="ltx_text" style="font-size:90%;">0.8311</span></td>
</tr>
<tr id="S4.T2.3.4.4" class="ltx_tr">
<td id="S4.T2.3.4.4.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.1.1" class="ltx_text" style="font-size:90%;">AE</span></td>
<td id="S4.T2.3.4.4.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.2.1" class="ltx_text" style="font-size:90%;">0.7216</span></td>
<td id="S4.T2.3.4.4.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.3.1" class="ltx_text" style="font-size:90%;">0.9795</span></td>
<td id="S4.T2.3.4.4.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.4.1" class="ltx_text" style="font-size:90%;">0.7776</span></td>
<td id="S4.T2.3.4.4.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.5.1" class="ltx_text" style="font-size:90%;">0.8535</span></td>
<td id="S4.T2.3.4.4.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.6.1" class="ltx_text" style="font-size:90%;">0.9748</span></td>
<td id="S4.T2.3.4.4.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.7.1" class="ltx_text" style="font-size:90%;">0.8792</span></td>
<td id="S4.T2.3.4.4.8" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9913</span></td>
<td id="S4.T2.3.4.4.9" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.9.1" class="ltx_text" style="font-size:90%;">0.7040</span></td>
<td id="S4.T2.3.4.4.10" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.4.4.10.1" class="ltx_text" style="font-size:90%;">0.8233</span></td>
</tr>
<tr id="S4.T2.3.5.5" class="ltx_tr">
<td id="S4.T2.3.5.5.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.1.1" class="ltx_text" style="font-size:90%;">LSTM-VAE</span></td>
<td id="S4.T2.3.5.5.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.2.1" class="ltx_text" style="font-size:90%;">0.7164</span></td>
<td id="S4.T2.3.5.5.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.3.1" class="ltx_text" style="font-size:90%;">0.9875</span></td>
<td id="S4.T2.3.5.5.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.4.1" class="ltx_text" style="font-size:90%;">0.7555</span></td>
<td id="S4.T2.3.5.5.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.5.1" class="ltx_text" style="font-size:90%;">0.8599</span></td>
<td id="S4.T2.3.5.5.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.6.1" class="ltx_text" style="font-size:90%;">0.9756</span></td>
<td id="S4.T2.3.5.5.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.7.1" class="ltx_text" style="font-size:90%;">0.8537</span></td>
<td id="S4.T2.3.5.5.8" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.8.1" class="ltx_text" style="font-size:90%;">0.7123</span></td>
<td id="S4.T2.3.5.5.9" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.9.1" class="ltx_text" style="font-size:90%;">0.9258</span></td>
<td id="S4.T2.3.5.5.10" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.5.5.10.1" class="ltx_text" style="font-size:90%;">0.8051</span></td>
</tr>
<tr id="S4.T2.3.6.6" class="ltx_tr">
<td id="S4.T2.3.6.6.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.1.1" class="ltx_text" style="font-size:90%;">DAGMM</span></td>
<td id="S4.T2.3.6.6.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.2.1" class="ltx_text" style="font-size:90%;">0.6334</span></td>
<td id="S4.T2.3.6.6.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9984</span></td>
<td id="S4.T2.3.6.6.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.4.1" class="ltx_text" style="font-size:90%;">0.7124</span></td>
<td id="S4.T2.3.6.6.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.5.1" class="ltx_text" style="font-size:90%;">0.7562</span></td>
<td id="S4.T2.3.6.6.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9803</span></td>
<td id="S4.T2.3.6.6.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.7.1" class="ltx_text" style="font-size:90%;">0.8112</span></td>
<td id="S4.T2.3.6.6.8" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.8.1" class="ltx_text" style="font-size:90%;">0.8292</span></td>
<td id="S4.T2.3.6.6.9" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.9.1" class="ltx_text" style="font-size:90%;">0.7674</span></td>
<td id="S4.T2.3.6.6.10" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.6.6.10.1" class="ltx_text" style="font-size:90%;">0.7971</span></td>
</tr>
<tr id="S4.T2.3.7.7" class="ltx_tr">
<td id="S4.T2.3.7.7.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.1.1" class="ltx_text" style="font-size:90%;">MAD-GAN</span></td>
<td id="S4.T2.3.7.7.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.2.1" class="ltx_text" style="font-size:90%;">0.8049</span></td>
<td id="S4.T2.3.7.7.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.3.1" class="ltx_text" style="font-size:90%;">0.8214</span></td>
<td id="S4.T2.3.7.7.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.4.1" class="ltx_text" style="font-size:90%;">0.8131</span></td>
<td id="S4.T2.3.7.7.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.5.1" class="ltx_text" style="font-size:90%;">0.8517</span></td>
<td id="S4.T2.3.7.7.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.6.1" class="ltx_text" style="font-size:90%;">0.8991</span></td>
<td id="S4.T2.3.7.7.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.7.1" class="ltx_text" style="font-size:90%;">0.8747</span></td>
<td id="S4.T2.3.7.7.8" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.8.1" class="ltx_text" style="font-size:90%;">0.9897</span></td>
<td id="S4.T2.3.7.7.9" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.9.1" class="ltx_text" style="font-size:90%;">0.6374</span></td>
<td id="S4.T2.3.7.7.10" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.7.7.10.1" class="ltx_text" style="font-size:90%;">0.7700</span></td>
</tr>
<tr id="S4.T2.3.8.8" class="ltx_tr">
<td id="S4.T2.3.8.8.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.1.1" class="ltx_text" style="font-size:90%;">OmniAnomaly</span></td>
<td id="S4.T2.3.8.8.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.2.1" class="ltx_text" style="font-size:90%;">0.7416</span></td>
<td id="S4.T2.3.8.8.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.3.1" class="ltx_text" style="font-size:90%;">0.9776</span></td>
<td id="S4.T2.3.8.8.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.4.1" class="ltx_text" style="font-size:90%;">0.8434</span></td>
<td id="S4.T2.3.8.8.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.5.1" class="ltx_text" style="font-size:90%;">0.8867</span></td>
<td id="S4.T2.3.8.8.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.6.1" class="ltx_text" style="font-size:90%;">0.9117</span></td>
<td id="S4.T2.3.8.8.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.7.1" class="ltx_text" style="font-size:90%;">0.8989</span></td>
<td id="S4.T2.3.8.8.8" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.8.1" class="ltx_text" style="font-size:90%;">0.7223</span></td>
<td id="S4.T2.3.8.8.9" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9832</span></td>
<td id="S4.T2.3.8.8.10" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.8.8.10.1" class="ltx_text" style="font-size:90%;">0.8328</span></td>
</tr>
<tr id="S4.T2.3.9.9" class="ltx_tr">
<td id="S4.T2.3.9.9.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.1.1" class="ltx_text" style="font-size:90%;">USAD</span></td>
<td id="S4.T2.3.9.9.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.2.1" class="ltx_text" style="font-size:90%;">0.7697</span></td>
<td id="S4.T2.3.9.9.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.3.1" class="ltx_text" style="font-size:90%;">0.9831</span></td>
<td id="S4.T2.3.9.9.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.4.1" class="ltx_text" style="font-size:90%;">0.8186</span></td>
<td id="S4.T2.3.9.9.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.5.1" class="ltx_text" style="font-size:90%;">0.8810</span></td>
<td id="S4.T2.3.9.9.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.6.1" class="ltx_text" style="font-size:90%;">0.9786</span></td>
<td id="S4.T2.3.9.9.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.7.1" class="ltx_text" style="font-size:90%;">0.9109</span></td>
<td id="S4.T2.3.9.9.8" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.8.1" class="ltx_text" style="font-size:90%;">0.9870</span></td>
<td id="S4.T2.3.9.9.9" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.9.1" class="ltx_text" style="font-size:90%;">0.7402</span></td>
<td id="S4.T2.3.9.9.10" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.9.9.10.1" class="ltx_text" style="font-size:90%;">0.8460</span></td>
</tr>
<tr id="S4.T2.3.10.10" class="ltx_tr">
<td id="S4.T2.3.10.10.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ConvGRU-VAE</span></td>
<td id="S4.T2.3.10.10.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9013</span></td>
<td id="S4.T2.3.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.3.1" class="ltx_text" style="font-size:90%;">0.8320</span></td>
<td id="S4.T2.3.10.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8652</span></td>
<td id="S4.T2.3.10.10.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9211</span></td>
<td id="S4.T2.3.10.10.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.6.1" class="ltx_text" style="font-size:90%;">0.9049</span></td>
<td id="S4.T2.3.10.10.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9129</span></td>
<td id="S4.T2.3.10.10.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.8.1" class="ltx_text" style="font-size:90%;">0.9056</span></td>
<td id="S4.T2.3.10.10.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.9.1" class="ltx_text" style="font-size:90%;">0.8632</span></td>
<td id="S4.T2.3.10.10.10" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.10.10.10.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8839</span></td>
</tr>
<tr id="S4.T2.3.11.11" class="ltx_tr">
<td id="S4.T2.3.11.11.1" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ConvGRU-VAE*</span></td>
<td id="S4.T2.3.11.11.2" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.2.1" class="ltx_text" style="font-size:90%;">0.8906</span></td>
<td id="S4.T2.3.11.11.3" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.3.1" class="ltx_text" style="font-size:90%;">0.9623</span></td>
<td id="S4.T2.3.11.11.4" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.4.1" class="ltx_text" style="font-size:90%;">0.9251</span></td>
<td id="S4.T2.3.11.11.5" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.5.1" class="ltx_text" style="font-size:90%;">0.9531</span></td>
<td id="S4.T2.3.11.11.6" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.6.1" class="ltx_text" style="font-size:90%;">0.9815</span></td>
<td id="S4.T2.3.11.11.7" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.7.1" class="ltx_text" style="font-size:90%;">0.9671</span></td>
<td id="S4.T2.3.11.11.8" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.8.1" class="ltx_text" style="font-size:90%;">0.8995</span></td>
<td id="S4.T2.3.11.11.9" class="ltx_td ltx_align_center" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.9.1" class="ltx_text" style="font-size:90%;">0.8743</span></td>
<td id="S4.T2.3.11.11.10" class="ltx_td ltx_align_left" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.11.11.10.1" class="ltx_text" style="font-size:90%;">0.8867</span></td>
</tr>
<tr id="S4.T2.3.12.12" class="ltx_tr">
<td id="S4.T2.3.12.12.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">FedAnomaly</span></td>
<td id="S4.T2.3.12.12.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.2.1" class="ltx_text" style="font-size:90%;">0.6739</span></td>
<td id="S4.T2.3.12.12.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.3.1" class="ltx_text" style="font-size:90%;">0.4458</span></td>
<td id="S4.T2.3.12.12.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.4.1" class="ltx_text" style="font-size:90%;">0.5366</span></td>
<td id="S4.T2.3.12.12.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.5.1" class="ltx_text" style="font-size:90%;">0.5808</span></td>
<td id="S4.T2.3.12.12.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.6.1" class="ltx_text" style="font-size:90%;">0.5857</span></td>
<td id="S4.T2.3.12.12.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.7.1" class="ltx_text" style="font-size:90%;">0.5833</span></td>
<td id="S4.T2.3.12.12.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.8.1" class="ltx_text" style="font-size:90%;">0.9331</span></td>
<td id="S4.T2.3.12.12.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.9.1" class="ltx_text" style="font-size:90%;">0.8164</span></td>
<td id="S4.T2.3.12.12.10" class="ltx_td ltx_align_left ltx_border_bb ltx_border_b ltx_border_t" style="padding-left:7.0pt;padding-right:7.0pt;"><span id="S4.T2.3.12.12.10.1" class="ltx_text" style="font-size:90%;">0.8709</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul id="S4.I2" class="ltx_itemize ltx_centering ltx_figure_panel">
<li id="S4.I2.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">*</span> 
<div id="S4.I2.ix1.p1" class="ltx_para">
<p id="S4.I2.ix1.p1.1" class="ltx_p"><span id="S4.I2.ix1.p1.1.1" class="ltx_text" style="font-size:80%;">represents the model performance evaluated with a brute-force searched threshold based on the best F1 score.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Evaluation Metrics</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We use the common evaluation metrics in anomaly detection, which are Precision, Recall, and F1 score, to evaluate the performance of our models and baseline models over test data and ground truth labels:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.1" class="ltx_Math" alttext="\text{Precision}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FP}}" display="block"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mtext id="S4.E7.m1.1.1.2" xref="S4.E7.m1.1.1.2a.cmml">Precision</mtext><mo id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml">=</mo><mfrac id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.3.2" xref="S4.E7.m1.1.1.3.2.cmml">TP</mi><mrow id="S4.E7.m1.1.1.3.3" xref="S4.E7.m1.1.1.3.3.cmml"><mi id="S4.E7.m1.1.1.3.3.2" xref="S4.E7.m1.1.1.3.3.2.cmml">TP</mi><mo id="S4.E7.m1.1.1.3.3.1" xref="S4.E7.m1.1.1.3.3.1.cmml">+</mo><mi id="S4.E7.m1.1.1.3.3.3" xref="S4.E7.m1.1.1.3.3.3.cmml">FP</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><eq id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"></eq><ci id="S4.E7.m1.1.1.2a.cmml" xref="S4.E7.m1.1.1.2"><mtext id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1.2">Precision</mtext></ci><apply id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3"><divide id="S4.E7.m1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.3"></divide><ci id="S4.E7.m1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.3.2">TP</ci><apply id="S4.E7.m1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.3.3"><plus id="S4.E7.m1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.3.3.1"></plus><ci id="S4.E7.m1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.3.3.2">TP</ci><ci id="S4.E7.m1.1.1.3.3.3.cmml" xref="S4.E7.m1.1.1.3.3.3">FP</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">\text{Precision}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FP}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\text{Recall}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FN}}" display="block"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mtext id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2a.cmml">Recall</mtext><mo id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml">=</mo><mfrac id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.3.2" xref="S4.E8.m1.1.1.3.2.cmml">TP</mi><mrow id="S4.E8.m1.1.1.3.3" xref="S4.E8.m1.1.1.3.3.cmml"><mi id="S4.E8.m1.1.1.3.3.2" xref="S4.E8.m1.1.1.3.3.2.cmml">TP</mi><mo id="S4.E8.m1.1.1.3.3.1" xref="S4.E8.m1.1.1.3.3.1.cmml">+</mo><mi id="S4.E8.m1.1.1.3.3.3" xref="S4.E8.m1.1.1.3.3.3.cmml">FN</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"></eq><ci id="S4.E8.m1.1.1.2a.cmml" xref="S4.E8.m1.1.1.2"><mtext id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2">Recall</mtext></ci><apply id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"><divide id="S4.E8.m1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.3"></divide><ci id="S4.E8.m1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.3.2">TP</ci><apply id="S4.E8.m1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.3.3"><plus id="S4.E8.m1.1.1.3.3.1.cmml" xref="S4.E8.m1.1.1.3.3.1"></plus><ci id="S4.E8.m1.1.1.3.3.2.cmml" xref="S4.E8.m1.1.1.3.3.2">TP</ci><ci id="S4.E8.m1.1.1.3.3.3.cmml" xref="S4.E8.m1.1.1.3.3.3">FN</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\text{Recall}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FN}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\mathrm{F1}=2\times\frac{\text{ Precision }\times\text{ Recall }}{\text{ Precision }+\text{ Recall }}" display="block"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><mi id="S4.E9.m1.1.1.2" xref="S4.E9.m1.1.1.2.cmml">F1</mi><mo id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml"><mn id="S4.E9.m1.1.1.3.2" xref="S4.E9.m1.1.1.3.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.E9.m1.1.1.3.1" xref="S4.E9.m1.1.1.3.1.cmml">×</mo><mfrac id="S4.E9.m1.1.1.3.3" xref="S4.E9.m1.1.1.3.3.cmml"><mrow id="S4.E9.m1.1.1.3.3.2" xref="S4.E9.m1.1.1.3.3.2.cmml"><mtext id="S4.E9.m1.1.1.3.3.2.2" xref="S4.E9.m1.1.1.3.3.2.2a.cmml"> Precision </mtext><mo lspace="0.222em" rspace="0.222em" id="S4.E9.m1.1.1.3.3.2.1" xref="S4.E9.m1.1.1.3.3.2.1.cmml">×</mo><mtext id="S4.E9.m1.1.1.3.3.2.3" xref="S4.E9.m1.1.1.3.3.2.3a.cmml"> Recall </mtext></mrow><mrow id="S4.E9.m1.1.1.3.3.3" xref="S4.E9.m1.1.1.3.3.3.cmml"><mtext id="S4.E9.m1.1.1.3.3.3.2" xref="S4.E9.m1.1.1.3.3.3.2a.cmml"> Precision </mtext><mo id="S4.E9.m1.1.1.3.3.3.1" xref="S4.E9.m1.1.1.3.3.3.1.cmml">+</mo><mtext id="S4.E9.m1.1.1.3.3.3.3" xref="S4.E9.m1.1.1.3.3.3.3a.cmml"> Recall </mtext></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><eq id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"></eq><ci id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1.2">F1</ci><apply id="S4.E9.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.3"><times id="S4.E9.m1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.3.1"></times><cn type="integer" id="S4.E9.m1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.3.2">2</cn><apply id="S4.E9.m1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.3.3"><divide id="S4.E9.m1.1.1.3.3.1.cmml" xref="S4.E9.m1.1.1.3.3"></divide><apply id="S4.E9.m1.1.1.3.3.2.cmml" xref="S4.E9.m1.1.1.3.3.2"><times id="S4.E9.m1.1.1.3.3.2.1.cmml" xref="S4.E9.m1.1.1.3.3.2.1"></times><ci id="S4.E9.m1.1.1.3.3.2.2a.cmml" xref="S4.E9.m1.1.1.3.3.2.2"><mtext id="S4.E9.m1.1.1.3.3.2.2.cmml" xref="S4.E9.m1.1.1.3.3.2.2"> Precision </mtext></ci><ci id="S4.E9.m1.1.1.3.3.2.3a.cmml" xref="S4.E9.m1.1.1.3.3.2.3"><mtext id="S4.E9.m1.1.1.3.3.2.3.cmml" xref="S4.E9.m1.1.1.3.3.2.3"> Recall </mtext></ci></apply><apply id="S4.E9.m1.1.1.3.3.3.cmml" xref="S4.E9.m1.1.1.3.3.3"><plus id="S4.E9.m1.1.1.3.3.3.1.cmml" xref="S4.E9.m1.1.1.3.3.3.1"></plus><ci id="S4.E9.m1.1.1.3.3.3.2a.cmml" xref="S4.E9.m1.1.1.3.3.3.2"><mtext id="S4.E9.m1.1.1.3.3.3.2.cmml" xref="S4.E9.m1.1.1.3.3.3.2"> Precision </mtext></ci><ci id="S4.E9.m1.1.1.3.3.3.3a.cmml" xref="S4.E9.m1.1.1.3.3.3.3"><mtext id="S4.E9.m1.1.1.3.3.3.3.cmml" xref="S4.E9.m1.1.1.3.3.3.3"> Recall </mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\mathrm{F1}=2\times\frac{\text{ Precision }\times\text{ Recall }}{\text{ Precision }+\text{ Recall }}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.2" class="ltx_p">where TP (True Positive) denotes the the number of anomalies that are correctly detected, TN (True Negative) denotes the number of normal samples that are correctly classified, FP (False Positive) denotes the number of normal samples that are falsely detected as anomalies, and FN (False Negative) denotes the number of anomalies that are misclassified as normal samples. In real-world anomaly detection tasks, a higher precision often gives rise to more efficient operation, as fewer false alarms reduce the cost of examination for an entire system, which is expensive in many scenarios. On the other hand, a higher recall is also crucial as it indicates anomalies are more likely to be captured by the detector, including ones that might lead to system crashes. To have a more comprehensive evaluation toward anomaly detection, we give more consideration to the F1 score and try to avoid compromising too much of either precision or recall. Besides, we utilize the point-adjust method to evaluate the performance of models based on a contiguous-segment detecting strategy that is widely adopted in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.4.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.5.2" class="ltx_text ltx_font_italic">Comparison with Baseline Models</span>
</h3>

<section id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS4.SSS1.4.1.1" class="ltx_text">IV-D</span>1 </span><span id="S4.SS4.SSS1.5.2" class="ltx_text ltx_font_bold">Non-Federated Scenario</span>
</h4>

<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p id="S4.SS4.SSS1.p1.1" class="ltx_p">We compare our model with 6 baseline models used in multivariate time series anomaly detection tasks, including Isolation Forest (IF) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, the basic Autoencoder (AE) and state-of-the-art models: LSTM-VAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, DAGMM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, MAD-GAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, OmniAnomaly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and USAD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. We also present the evaluation results where the threshold is brute-force searched in terms of the best F1 score, in order to show the maximum capacity of our model.
The performance of the detection models in terms of precision, recall, and F1 score are shown in Table <a href="#S4.T2" title="Table II ‣ IV-B2 Federated Settings ‣ IV-B Experimental Setup ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. The results illustrate that our model generally outperforms the baseline models by achieving the highest precision score on the SMAP and MSL datasets, the third-highest recall score on SWaT dataset, and most importantly, the highest F1 score on the three datasets. It can also be observed that the false alarms and missing anomalies of our model are more comparable in comparison with those of other models, showing a better balance without compromising overall performance.</p>
</div>
<div id="S4.SS4.SSS1.p2" class="ltx_para">
<p id="S4.SS4.SSS1.p2.1" class="ltx_p">The baseline methods consist of the conventional learning model and deep unsupervised learning models including generative models. Isolation Forest as a non-parametric method, uses a hyper-plane based on random features to split data space, which is not suitable for high-dimensional multivariate data and not sensitive to local anomalies. AE utilizes an encoding-decoding framework to reconstruct time series, based on which USAD model leverages the reconstruction-prediction and adversarial training to generate better representation for the downstream task. However, these methods reconstruct time series in a point-wise manner without capturing temporal dependencies, which limits the model capability and detection performance. DAGMM as a generative model, performs dimension reduction and density estimation of latent space in a joint manner for better representation learning and achieves the highest recall scores on SMAP and MSL datasets, but still fails to address temporal correlations, which gives rise to inferior overall performance. The other generative models based on recurrent neural networks gain advantages in handling temporal information and leverages either variational learning (LSTM-VAE, OmniAnomaly) or Generative Adversarial Networks (MAD-GAN). Nevertheless, the limit of these methods lies in either not taking feature-level correlations into consideration or not addressing them in an explicit way. Differently, our model not only captures the temporal dependencies and feature-level dependencies in input-to-state and state-to-state transitions, but also handles them in a joint manner. This joint information manipulation appears to be effective in the dependency modeling of multivariate time series and reports generally satisfactory results in downstream anomaly detection tasks.</p>
</div>
<div id="S4.SS4.SSS1.p3" class="ltx_para">
<p id="S4.SS4.SSS1.p3.1" class="ltx_p">To investigate the maximum capability of our model, we use the same output of ConvGRU-VAE as the anomaly score, but with a threshold that is brute-force searched based on calculated performance that gives the best F1 score. The results illustrate that our model with searched threshold gives obviously better recall and F1 scores on SMAP and MSL data. It is also worth noting that our model with original threshold selection demonstrates certain optimality as it approaches the best model on SWaT dataset. Generally speaking, our detection framework shows the potential to have better performance with more sophisticated threshold selection rules.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2108.08404/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="93" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S4.F5.2.1" class="ltx_text" style="font-size:90%;">The overview of latency distributions and the comparison under different latency constraints.</span></figcaption>
</figure>
</section>
<section id="S4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS4.SSS2.4.1.1" class="ltx_text">IV-D</span>2 </span><span id="S4.SS4.SSS2.5.2" class="ltx_text ltx_font_bold">Federated Scenario</span>
</h4>

<div id="S4.SS4.SSS2.p1" class="ltx_para">
<p id="S4.SS4.SSS2.p1.1" class="ltx_p">We adapt ConvGRU-VAE to the federated setting because of its superior which is demonstrated aforementioned. The last line in Tab. <a href="#S4.T3" title="Table III ‣ IV-E1 Exploration of window length ‣ IV-E Exploration of Model Parameters and Latency Analysis ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> shows the best model performance (when C = 3) in federated scenarios. It is clear that FedAnomaly performs relatively worse on SMAP and MSL datasets than training on the entire data. Such an unsatisfactory result is caused by the extremely heterogeneous data distribution of the telemetry channels in the spacecraft <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. In contrast, FedAnomaly has achieved similar performance of non-federated scenarios on SWaT dataset and surpasses most of baseline models regarding either precision and recall.</p>
</div>
<div id="S4.SS4.SSS2.p2" class="ltx_para">
<p id="S4.SS4.SSS2.p2.1" class="ltx_p">Because of the clear description of labels and root-causes in the testing data of SWaT, we further explore the impact of different model parameters and federated settings in <a href="#S4.SS5" title="IV-E Exploration of Model Parameters and Latency Analysis ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">§</span> <span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-E</span></span></a> and <a href="#S4.SS6" title="IV-F Extensive Experiments on Federated Learning Mechanism ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">§</span> <span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-F</span></span></a>, respectively. We also conduct latency analysis as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, calculating the step difference between the first ground truth point and the first detected point in a true positive segment in the following text.</p>
</div>
</section>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.4.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.5.2" class="ltx_text ltx_font_italic">Exploration of Model Parameters and Latency Analysis</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">In this part, we further explore the effect of parameters in the single ConvGRU-VAE model and analyze the corresponding performance in terms of both detection results and detection latency. To be more specific, we perform a set of experiments on SWaT dataset where the anomalies are precisely labeled in a point-wise manner, based on different settings of window length and hidden size.</p>
</div>
<section id="S4.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS5.SSS1.4.1.1" class="ltx_text">IV-E</span>1 </span><span id="S4.SS5.SSS1.5.2" class="ltx_text ltx_font_bold">Exploration of window length</span>
</h4>

<div id="S4.SS5.SSS1.p1" class="ltx_para">
<p id="S4.SS5.SSS1.p1.1" class="ltx_p">Firstly, we study how our model responds to different settings of window length. Table <a href="#S4.T3" title="Table III ‣ IV-E1 Exploration of window length ‣ IV-E Exploration of Model Parameters and Latency Analysis ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> shows the detection performance based on different window lengths from <math id="S4.SS5.SSS1.p1.1.m1.5" class="ltx_Math" alttext="[5,10,20,50,100]" display="inline"><semantics id="S4.SS5.SSS1.p1.1.m1.5a"><mrow id="S4.SS5.SSS1.p1.1.m1.5.6.2" xref="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml"><mo stretchy="false" id="S4.SS5.SSS1.p1.1.m1.5.6.2.1" xref="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml">[</mo><mn id="S4.SS5.SSS1.p1.1.m1.1.1" xref="S4.SS5.SSS1.p1.1.m1.1.1.cmml">5</mn><mo id="S4.SS5.SSS1.p1.1.m1.5.6.2.2" xref="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS1.p1.1.m1.2.2" xref="S4.SS5.SSS1.p1.1.m1.2.2.cmml">10</mn><mo id="S4.SS5.SSS1.p1.1.m1.5.6.2.3" xref="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS1.p1.1.m1.3.3" xref="S4.SS5.SSS1.p1.1.m1.3.3.cmml">20</mn><mo id="S4.SS5.SSS1.p1.1.m1.5.6.2.4" xref="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS1.p1.1.m1.4.4" xref="S4.SS5.SSS1.p1.1.m1.4.4.cmml">50</mn><mo id="S4.SS5.SSS1.p1.1.m1.5.6.2.5" xref="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS1.p1.1.m1.5.5" xref="S4.SS5.SSS1.p1.1.m1.5.5.cmml">100</mn><mo stretchy="false" id="S4.SS5.SSS1.p1.1.m1.5.6.2.6" xref="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS1.p1.1.m1.5b"><list id="S4.SS5.SSS1.p1.1.m1.5.6.1.cmml" xref="S4.SS5.SSS1.p1.1.m1.5.6.2"><cn type="integer" id="S4.SS5.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS5.SSS1.p1.1.m1.1.1">5</cn><cn type="integer" id="S4.SS5.SSS1.p1.1.m1.2.2.cmml" xref="S4.SS5.SSS1.p1.1.m1.2.2">10</cn><cn type="integer" id="S4.SS5.SSS1.p1.1.m1.3.3.cmml" xref="S4.SS5.SSS1.p1.1.m1.3.3">20</cn><cn type="integer" id="S4.SS5.SSS1.p1.1.m1.4.4.cmml" xref="S4.SS5.SSS1.p1.1.m1.4.4">50</cn><cn type="integer" id="S4.SS5.SSS1.p1.1.m1.5.5.cmml" xref="S4.SS5.SSS1.p1.1.m1.5.5">100</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS1.p1.1.m1.5c">[5,10,20,50,100]</annotation></semantics></math>. It can be observed that our model adapts to different length of inputs and generally yields comparable results in terms of overall evaluation scores, where the best precision, best recall, and best F1 score is recorded at window length 5, 20 and 10 respectively. It can also be found that the precision and recall at window length 10 and 20, are relatively close without compromising overall F1 performance.</p>
</div>
<div id="S4.SS5.SSS1.p2" class="ltx_para">
<p id="S4.SS5.SSS1.p2.1" class="ltx_p">In real-world anomaly detection tasks, anomalies are more likely to occur in the form of contiguous segments than isolated points. Therefore, we also evaluate how our detection model triggers alerts under such consecutive scenarios. More specifically speaking, we involve the number of segments detected by our model and the corresponding detection latency in our discussion. The detection latency of each segment is calculated by the number of lagging steps between the first anomaly detected by our model and the first ground-truth anomaly in the segment. We can observe that our model detects relatively more segments with window length 10 and 20. Under each setting, we calculate the latency of all segments and present the box plots to demonstrate the overall latency distribution, as shown in the first subplot of figure <a href="#S4.F5" title="Figure 5 ‣ IV-D1 Non-Federated Scenario ‣ IV-D Comparison with Baseline Models ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. It is clear that our model performs better with a window length that is larger than 5, according to the median value and the distributed range of latency. This suggests that if the duration of the window is too short, each observation in the dataset could be less informative regarding quick detection of contiguous-segment anomalies. Considering all metrics discussed above, we conclude that our model performs better with window length 10 and 20 in terms of detection of overall anomalous patterns, detection of segments, and response speed.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Comparison of Window Length</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Window Length</span></th>
<td id="S4.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.1.1.2.1" class="ltx_text" style="font-size:90%;">5</span></td>
<td id="S4.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.1.1.3.1" class="ltx_text" style="font-size:90%;">10</span></td>
<td id="S4.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.1.1.4.1" class="ltx_text" style="font-size:90%;">20</span></td>
<td id="S4.T3.3.1.1.5" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.1.1.5.1" class="ltx_text" style="font-size:90%;">50</span></td>
<td id="S4.T3.3.1.1.6" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.1.1.6.1" class="ltx_text" style="font-size:90%;">100</span></td>
</tr>
<tr id="S4.T3.3.2.2" class="ltx_tr">
<th id="S4.T3.3.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.2.2.1.1" class="ltx_text" style="font-size:90%;">Precision</span></th>
<td id="S4.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.2.2.2.1" class="ltx_text" style="font-size:90%;">0.9342</span></td>
<td id="S4.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.2.2.3.1" class="ltx_text" style="font-size:90%;">0.9057</span></td>
<td id="S4.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.2.2.4.1" class="ltx_text" style="font-size:90%;">0.8822</span></td>
<td id="S4.T3.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.2.2.5.1" class="ltx_text" style="font-size:90%;">0.8555</span></td>
<td id="S4.T3.3.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.2.2.6.1" class="ltx_text" style="font-size:90%;">0.9012</span></td>
</tr>
<tr id="S4.T3.3.3.3" class="ltx_tr">
<th id="S4.T3.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.3.3.1.1" class="ltx_text" style="font-size:90%;">Recall</span></th>
<td id="S4.T3.3.3.3.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.3.3.2.1" class="ltx_text" style="font-size:90%;">0.8293</span></td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.3.3.3.1" class="ltx_text" style="font-size:90%;">0.8632</span></td>
<td id="S4.T3.3.3.3.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.3.3.4.1" class="ltx_text" style="font-size:90%;">0.8682</span></td>
<td id="S4.T3.3.3.3.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.3.3.5.1" class="ltx_text" style="font-size:90%;">0.8487</span></td>
<td id="S4.T3.3.3.3.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.3.3.6.1" class="ltx_text" style="font-size:90%;">0.8469</span></td>
</tr>
<tr id="S4.T3.3.4.4" class="ltx_tr">
<th id="S4.T3.3.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.4.4.1.1" class="ltx_text" style="font-size:90%;">F1</span></th>
<td id="S4.T3.3.4.4.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.4.4.2.1" class="ltx_text" style="font-size:90%;">0.8786</span></td>
<td id="S4.T3.3.4.4.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.4.4.3.1" class="ltx_text" style="font-size:90%;">0.8839</span></td>
<td id="S4.T3.3.4.4.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.4.4.4.1" class="ltx_text" style="font-size:90%;">0.8751</span></td>
<td id="S4.T3.3.4.4.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.4.4.5.1" class="ltx_text" style="font-size:90%;">0.8521</span></td>
<td id="S4.T3.3.4.4.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.4.4.6.1" class="ltx_text" style="font-size:90%;">0.8732</span></td>
</tr>
<tr id="S4.T3.3.5.5" class="ltx_tr">
<th id="S4.T3.3.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.5.5.1.1" class="ltx_text" style="font-size:90%;">Detected Segments</span></th>
<td id="S4.T3.3.5.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.5.5.2.1" class="ltx_text" style="font-size:90%;">13</span></td>
<td id="S4.T3.3.5.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.5.5.3.1" class="ltx_text" style="font-size:90%;">16</span></td>
<td id="S4.T3.3.5.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.5.5.4.1" class="ltx_text" style="font-size:90%;">18</span></td>
<td id="S4.T3.3.5.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.5.5.5.1" class="ltx_text" style="font-size:90%;">15</span></td>
<td id="S4.T3.3.5.5.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T3.3.5.5.6.1" class="ltx_text" style="font-size:90%;">13</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS5.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS5.SSS2.4.1.1" class="ltx_text">IV-E</span>2 </span><span id="S4.SS5.SSS2.5.2" class="ltx_text ltx_font_bold">Exploration of hidden size</span>
</h4>

<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Comparison of Hidden Size</figcaption>
<table id="S4.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.3.1.1" class="ltx_tr">
<th id="S4.T4.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Hidden Size</span></th>
<td id="S4.T4.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.1.1.2.1" class="ltx_text" style="font-size:90%;">80</span></td>
<td id="S4.T4.3.1.1.3" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.1.1.3.1" class="ltx_text" style="font-size:90%;">96</span></td>
<td id="S4.T4.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.1.1.4.1" class="ltx_text" style="font-size:90%;">112</span></td>
<td id="S4.T4.3.1.1.5" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.1.1.5.1" class="ltx_text" style="font-size:90%;">128</span></td>
<td id="S4.T4.3.1.1.6" class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.1.1.6.1" class="ltx_text" style="font-size:90%;">144</span></td>
</tr>
<tr id="S4.T4.3.2.2" class="ltx_tr">
<th id="S4.T4.3.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.2.2.1.1" class="ltx_text" style="font-size:90%;">Precision</span></th>
<td id="S4.T4.3.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.2.2.2.1" class="ltx_text" style="font-size:90%;">0.9801</span></td>
<td id="S4.T4.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.2.2.3.1" class="ltx_text" style="font-size:90%;">0.9829</span></td>
<td id="S4.T4.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.2.2.4.1" class="ltx_text" style="font-size:90%;">0.8867</span></td>
<td id="S4.T4.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.2.2.5.1" class="ltx_text" style="font-size:90%;">0.9057</span></td>
<td id="S4.T4.3.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.2.2.6.1" class="ltx_text" style="font-size:90%;">0.8226</span></td>
</tr>
<tr id="S4.T4.3.3.3" class="ltx_tr">
<th id="S4.T4.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.3.3.1.1" class="ltx_text" style="font-size:90%;">Recall</span></th>
<td id="S4.T4.3.3.3.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.3.3.2.1" class="ltx_text" style="font-size:90%;">0.6946</span></td>
<td id="S4.T4.3.3.3.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.3.3.3.1" class="ltx_text" style="font-size:90%;">0.7246</span></td>
<td id="S4.T4.3.3.3.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.3.3.4.1" class="ltx_text" style="font-size:90%;">0.8177</span></td>
<td id="S4.T4.3.3.3.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.3.3.5.1" class="ltx_text" style="font-size:90%;">0.8632</span></td>
<td id="S4.T4.3.3.3.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.3.3.6.1" class="ltx_text" style="font-size:90%;">0.8923</span></td>
</tr>
<tr id="S4.T4.3.4.4" class="ltx_tr">
<th id="S4.T4.3.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.4.4.1.1" class="ltx_text" style="font-size:90%;">F1</span></th>
<td id="S4.T4.3.4.4.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.4.4.2.1" class="ltx_text" style="font-size:90%;">0.8130</span></td>
<td id="S4.T4.3.4.4.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.4.4.3.1" class="ltx_text" style="font-size:90%;">0.8342</span></td>
<td id="S4.T4.3.4.4.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.4.4.4.1" class="ltx_text" style="font-size:90%;">0.8508</span></td>
<td id="S4.T4.3.4.4.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.4.4.5.1" class="ltx_text" style="font-size:90%;">0.8839</span></td>
<td id="S4.T4.3.4.4.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.4.4.6.1" class="ltx_text" style="font-size:90%;">0.8560</span></td>
</tr>
<tr id="S4.T4.3.5.5" class="ltx_tr">
<th id="S4.T4.3.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.5.5.1.1" class="ltx_text" style="font-size:90%;">Detected Segments</span></th>
<td id="S4.T4.3.5.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.5.5.2.1" class="ltx_text" style="font-size:90%;">4</span></td>
<td id="S4.T4.3.5.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.5.5.3.1" class="ltx_text" style="font-size:90%;">6</span></td>
<td id="S4.T4.3.5.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.5.5.4.1" class="ltx_text" style="font-size:90%;">13</span></td>
<td id="S4.T4.3.5.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.5.5.5.1" class="ltx_text" style="font-size:90%;">16</span></td>
<td id="S4.T4.3.5.5.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T4.3.5.5.6.1" class="ltx_text" style="font-size:90%;">20</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Performance comparison of different federated scenarios</figcaption>
<table id="S4.T5.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.3.1.1" class="ltx_tr">
<th id="S4.T5.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T5.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Local Epoch</span></th>
<th id="S4.T5.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S4.T5.3.1.1.2.1" class="ltx_text" style="font-size:90%;">L = 1</span></th>
<th id="S4.T5.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S4.T5.3.1.1.3.1" class="ltx_text" style="font-size:90%;">L = 2</span></th>
<th id="S4.T5.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S4.T5.3.1.1.4.1" class="ltx_text" style="font-size:90%;">L = 3</span></th>
<th id="S4.T5.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S4.T5.3.1.1.5.1" class="ltx_text" style="font-size:90%;">L = 5</span></th>
</tr>
<tr id="S4.T5.3.2.2" class="ltx_tr">
<th id="S4.T5.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.1.1" class="ltx_text" style="font-size:90%;">P</span></th>
<th id="S4.T5.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.2.1" class="ltx_text" style="font-size:90%;">R</span></th>
<th id="S4.T5.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.3.1" class="ltx_text" style="font-size:90%;">F</span></th>
<th id="S4.T5.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.4.1" class="ltx_text" style="font-size:90%;">P</span></th>
<th id="S4.T5.3.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.5.1" class="ltx_text" style="font-size:90%;">R</span></th>
<th id="S4.T5.3.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.6.1" class="ltx_text" style="font-size:90%;">F</span></th>
<th id="S4.T5.3.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.7.1" class="ltx_text" style="font-size:90%;">P</span></th>
<th id="S4.T5.3.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.8.1" class="ltx_text" style="font-size:90%;">R</span></th>
<th id="S4.T5.3.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.9.1" class="ltx_text" style="font-size:90%;">F</span></th>
<th id="S4.T5.3.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.10.1" class="ltx_text" style="font-size:90%;">P</span></th>
<th id="S4.T5.3.2.2.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.11.1" class="ltx_text" style="font-size:90%;">R</span></th>
<th id="S4.T5.3.2.2.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T5.3.2.2.12.1" class="ltx_text" style="font-size:90%;">F</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.3.3.1" class="ltx_tr">
<th id="S4.T5.3.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T5.3.3.1.1.1" class="ltx_text" style="font-size:90%;">C = 3</span></th>
<td id="S4.T5.3.3.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.2.1" class="ltx_text" style="font-size:90%;">0.8915</span></td>
<td id="S4.T5.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.3.1" class="ltx_text" style="font-size:90%;">0.8418</span></td>
<td id="S4.T5.3.3.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.4.1" class="ltx_text" style="font-size:90%;">0.8660</span></td>
<td id="S4.T5.3.3.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.5.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">0.9331</span></td>
<td id="S4.T5.3.3.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.6.1" class="ltx_text" style="font-size:90%;">0.8164</span></td>
<td id="S4.T5.3.3.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8709</span></td>
<td id="S4.T5.3.3.1.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.8.1" class="ltx_text" style="font-size:90%;">0.7310</span></td>
<td id="S4.T5.3.3.1.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.9.1" class="ltx_text ltx_ulem_uuline" style="font-size:90%;">0.9054</span></td>
<td id="S4.T5.3.3.1.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.10.1" class="ltx_text" style="font-size:90%;">0.8089</span></td>
<td id="S4.T5.3.3.1.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.11.1" class="ltx_text" style="font-size:90%;">0.7606</span></td>
<td id="S4.T5.3.3.1.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.12.1" class="ltx_text" style="font-size:90%;">0.8759</span></td>
<td id="S4.T5.3.3.1.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.3.3.1.13.1" class="ltx_text" style="font-size:90%;">0.8142</span></td>
</tr>
<tr id="S4.T5.3.4.2" class="ltx_tr">
<th id="S4.T5.3.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T5.3.4.2.1.1" class="ltx_text" style="font-size:90%;">C = 5</span></th>
<td id="S4.T5.3.4.2.2" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.2.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">0.9152</span></td>
<td id="S4.T5.3.4.2.3" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.3.1" class="ltx_text" style="font-size:90%;">0.8058</span></td>
<td id="S4.T5.3.4.2.4" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.4.1" class="ltx_text" style="font-size:90%;">0.8570</span></td>
<td id="S4.T5.3.4.2.5" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.5.1" class="ltx_text" style="font-size:90%;">0.9020</span></td>
<td id="S4.T5.3.4.2.6" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.6.1" class="ltx_text" style="font-size:90%;">0.8419</span></td>
<td id="S4.T5.3.4.2.7" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8709</span></td>
<td id="S4.T5.3.4.2.8" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.8.1" class="ltx_text" style="font-size:90%;">0.8057</span></td>
<td id="S4.T5.3.4.2.9" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.9.1" class="ltx_text" style="font-size:90%;">0.8927</span></td>
<td id="S4.T5.3.4.2.10" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.10.1" class="ltx_text" style="font-size:90%;">0.8469</span></td>
<td id="S4.T5.3.4.2.11" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.11.1" class="ltx_text" style="font-size:90%;">0.7566</span></td>
<td id="S4.T5.3.4.2.12" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.12.1" class="ltx_text ltx_ulem_uuline" style="font-size:90%;">0.9043</span></td>
<td id="S4.T5.3.4.2.13" class="ltx_td ltx_align_center"><span id="S4.T5.3.4.2.13.1" class="ltx_text" style="font-size:90%;">0.8239</span></td>
</tr>
<tr id="S4.T5.3.5.3" class="ltx_tr">
<th id="S4.T5.3.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T5.3.5.3.1.1" class="ltx_text" style="font-size:90%;">C = 8</span></th>
<td id="S4.T5.3.5.3.2" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.2.1" class="ltx_text" style="font-size:90%;">0.8773</span></td>
<td id="S4.T5.3.5.3.3" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.3.1" class="ltx_text" style="font-size:90%;">0.8275</span></td>
<td id="S4.T5.3.5.3.4" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.4.1" class="ltx_text" style="font-size:90%;">0.8517</span></td>
<td id="S4.T5.3.5.3.5" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.5.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">0.9300</span></td>
<td id="S4.T5.3.5.3.6" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.6.1" class="ltx_text" style="font-size:90%;">0.7970</span></td>
<td id="S4.T5.3.5.3.7" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.7.1" class="ltx_text" style="font-size:90%;">0.8584</span></td>
<td id="S4.T5.3.5.3.8" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.8.1" class="ltx_text" style="font-size:90%;">0.8475</span></td>
<td id="S4.T5.3.5.3.9" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.9.1" class="ltx_text ltx_ulem_uuline" style="font-size:90%;">0.9399</span></td>
<td id="S4.T5.3.5.3.10" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.10.1" class="ltx_text" style="font-size:90%;">0.8476</span></td>
<td id="S4.T5.3.5.3.11" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.11.1" class="ltx_text" style="font-size:90%;">0.9098</span></td>
<td id="S4.T5.3.5.3.12" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.12.1" class="ltx_text" style="font-size:90%;">0.8297</span></td>
<td id="S4.T5.3.5.3.13" class="ltx_td ltx_align_center"><span id="S4.T5.3.5.3.13.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8679</span></td>
</tr>
<tr id="S4.T5.3.6.4" class="ltx_tr">
<th id="S4.T5.3.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T5.3.6.4.1.1" class="ltx_text" style="font-size:90%;">C = 10</span></th>
<td id="S4.T5.3.6.4.2" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.2.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">0.9758</span></td>
<td id="S4.T5.3.6.4.3" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.3.1" class="ltx_text" style="font-size:90%;">0.7858</span></td>
<td id="S4.T5.3.6.4.4" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.4.1" class="ltx_text" style="font-size:90%;">0.8706</span></td>
<td id="S4.T5.3.6.4.5" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.5.1" class="ltx_text" style="font-size:90%;">0.8378</span></td>
<td id="S4.T5.3.6.4.6" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.6.1" class="ltx_text" style="font-size:90%;">0.8490</span></td>
<td id="S4.T5.3.6.4.7" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.7.1" class="ltx_text" style="font-size:90%;">0.8434</span></td>
<td id="S4.T5.3.6.4.8" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.8.1" class="ltx_text" style="font-size:90%;">0.7718</span></td>
<td id="S4.T5.3.6.4.9" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.9.1" class="ltx_text ltx_ulem_uuline" style="font-size:90%;">0.8897</span></td>
<td id="S4.T5.3.6.4.10" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.10.1" class="ltx_text" style="font-size:90%;">0.8266</span></td>
<td id="S4.T5.3.6.4.11" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.11.1" class="ltx_text" style="font-size:90%;">0.9111</span></td>
<td id="S4.T5.3.6.4.12" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.12.1" class="ltx_text" style="font-size:90%;">0.8527</span></td>
<td id="S4.T5.3.6.4.13" class="ltx_td ltx_align_center"><span id="S4.T5.3.6.4.13.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8809</span></td>
</tr>
<tr id="S4.T5.3.7.5" class="ltx_tr">
<th id="S4.T5.3.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S4.T5.3.7.5.1.1" class="ltx_text" style="font-size:90%;">C = 20</span></th>
<td id="S4.T5.3.7.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.2.1" class="ltx_text" style="font-size:90%;">0.7874</span></td>
<td id="S4.T5.3.7.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.3.1" class="ltx_text" style="font-size:90%;">0.8687</span></td>
<td id="S4.T5.3.7.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.4.1" class="ltx_text" style="font-size:90%;">0.8260</span></td>
<td id="S4.T5.3.7.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.5.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">0.9407</span></td>
<td id="S4.T5.3.7.5.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.6.1" class="ltx_text" style="font-size:90%;">0.8330</span></td>
<td id="S4.T5.3.7.5.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8836</span></td>
<td id="S4.T5.3.7.5.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.8.1" class="ltx_text" style="font-size:90%;">0.6989</span></td>
<td id="S4.T5.3.7.5.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.9.1" class="ltx_text ltx_ulem_uuline" style="font-size:90%;">0.9335</span></td>
<td id="S4.T5.3.7.5.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.10.1" class="ltx_text" style="font-size:90%;">0.7994</span></td>
<td id="S4.T5.3.7.5.11" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.11.1" class="ltx_text" style="font-size:90%;">0.8243</span></td>
<td id="S4.T5.3.7.5.12" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.12.1" class="ltx_text" style="font-size:90%;">0.8623</span></td>
<td id="S4.T5.3.7.5.13" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.3.7.5.13.1" class="ltx_text" style="font-size:90%;">0.8428</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS5.SSS2.p1" class="ltx_para">
<p id="S4.SS5.SSS2.p1.1" class="ltx_p">Besides window length, we also investigate the relationship between detection performance and model capacity measured by the hidden size. In general, a very small hidden dimension implies the insufficient model capacity to capture feature correlations and temporal dependencies, and often leads to inferior results. On the other hand, a very large hidden dimension introduces unnecessary redundancy which may impede effective representation learning and cause a degradation of model performance. To learn the impact of hidden size in our detection task, we perform the same set of evaluations as those in the above study. Table <a href="#S4.T4" title="Table IV ‣ IV-E2 Exploration of hidden size ‣ IV-E Exploration of Model Parameters and Latency Analysis ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> presents the detection performance based on different hidden size chosen from <math id="S4.SS5.SSS2.p1.1.m1.5" class="ltx_Math" alttext="[90,96,112,128,144]" display="inline"><semantics id="S4.SS5.SSS2.p1.1.m1.5a"><mrow id="S4.SS5.SSS2.p1.1.m1.5.6.2" xref="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml"><mo stretchy="false" id="S4.SS5.SSS2.p1.1.m1.5.6.2.1" xref="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml">[</mo><mn id="S4.SS5.SSS2.p1.1.m1.1.1" xref="S4.SS5.SSS2.p1.1.m1.1.1.cmml">90</mn><mo id="S4.SS5.SSS2.p1.1.m1.5.6.2.2" xref="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS2.p1.1.m1.2.2" xref="S4.SS5.SSS2.p1.1.m1.2.2.cmml">96</mn><mo id="S4.SS5.SSS2.p1.1.m1.5.6.2.3" xref="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS2.p1.1.m1.3.3" xref="S4.SS5.SSS2.p1.1.m1.3.3.cmml">112</mn><mo id="S4.SS5.SSS2.p1.1.m1.5.6.2.4" xref="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS2.p1.1.m1.4.4" xref="S4.SS5.SSS2.p1.1.m1.4.4.cmml">128</mn><mo id="S4.SS5.SSS2.p1.1.m1.5.6.2.5" xref="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS5.SSS2.p1.1.m1.5.5" xref="S4.SS5.SSS2.p1.1.m1.5.5.cmml">144</mn><mo stretchy="false" id="S4.SS5.SSS2.p1.1.m1.5.6.2.6" xref="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS2.p1.1.m1.5b"><list id="S4.SS5.SSS2.p1.1.m1.5.6.1.cmml" xref="S4.SS5.SSS2.p1.1.m1.5.6.2"><cn type="integer" id="S4.SS5.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS5.SSS2.p1.1.m1.1.1">90</cn><cn type="integer" id="S4.SS5.SSS2.p1.1.m1.2.2.cmml" xref="S4.SS5.SSS2.p1.1.m1.2.2">96</cn><cn type="integer" id="S4.SS5.SSS2.p1.1.m1.3.3.cmml" xref="S4.SS5.SSS2.p1.1.m1.3.3">112</cn><cn type="integer" id="S4.SS5.SSS2.p1.1.m1.4.4.cmml" xref="S4.SS5.SSS2.p1.1.m1.4.4">128</cn><cn type="integer" id="S4.SS5.SSS2.p1.1.m1.5.5.cmml" xref="S4.SS5.SSS2.p1.1.m1.5.5">144</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS2.p1.1.m1.5c">[90,96,112,128,144]</annotation></semantics></math>. The results show that the model performance varies a lot in terms of detection scores. There is a clear trend of precision decrease and recall increase as the hidden size grows larger, while the best F1 performance is achieved at hidden size 128 with an obvious margin. This supports the above discussion and illustrates that a proper model capacity gains better robustness toward the balance of false alarms and missing anomalies.</p>
</div>
<div id="S4.SS5.SSS2.p2" class="ltx_para">
<p id="S4.SS5.SSS2.p2.1" class="ltx_p">Nevertheless, a larger hidden size within a certain range still gains favors in the segment detection. It is obvious that our model with hidden size 80 and 90 appears to be insufficient and performs poorly regarding the number of detected segments, while the model detects the most segments with hidden size 144. As for detection latency illustrated in the second subplot of figure <a href="#S4.F5" title="Figure 5 ‣ IV-D1 Non-Federated Scenario ‣ IV-D Comparison with Baseline Models ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, the insufficiency of hidden size shows an undesired distribution with worse median value and larger variance. Meanwhile, the latency of a model with a sufficient capacity generally distributes in a lower range and a more stable trend. To analyze the latency in an explicit manner, we also present the relationship between latency and detection rate, namely the percentage of detected anomalies with the constraint of different latency, as shown in the third subplot of Fig. <a href="#S4.F5" title="Figure 5 ‣ IV-D1 Non-Federated Scenario ‣ IV-D Comparison with Baseline Models ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. By and large, the model with a larger hidden size detects more anomalies when the tolerance of latency is small. Moreover, a larger hidden size consistently gives a better detection rate as latency constraints get looser. Therefore, the latency patterns shown and discussed above suggest the advantage of large model capacity in a certain range, which lies in the enhancement of faster and more accurate detection toward contiguous anomaly segments.</p>
</div>
</section>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS6.4.1.1" class="ltx_text">IV-F</span> </span><span id="S4.SS6.5.2" class="ltx_text ltx_font_italic">Extensive Experiments on Federated Learning Mechanism</span>
</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.5" class="ltx_p">In this part, we fix the sequence length = 10, hidden size = 128, learning rate = 1e-5, ratio of clients <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="\gamma=1" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mrow id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><mi id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml">γ</mi><mo id="S4.SS6.p1.1.m1.1.1.1" xref="S4.SS6.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS6.p1.1.m1.1.1.3" xref="S4.SS6.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><eq id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1.1"></eq><ci id="S4.SS6.p1.1.m1.1.1.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2">𝛾</ci><cn type="integer" id="S4.SS6.p1.1.m1.1.1.3.cmml" xref="S4.SS6.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">\gamma=1</annotation></semantics></math> and experiment with various scenarios determined by the local epoch <span id="S4.SS6.p1.5.1" class="ltx_text ltx_markedasmath ltx_font_bold">L</span> and the number of clients <span id="S4.SS6.p1.5.2" class="ltx_text ltx_markedasmath ltx_font_bold">C</span> in the federated mechanism. In detail, we let <math id="S4.SS6.p1.4.m4.5" class="ltx_Math" alttext="\textbf{C}=\{3,5,8,10,20\}" display="inline"><semantics id="S4.SS6.p1.4.m4.5a"><mrow id="S4.SS6.p1.4.m4.5.6" xref="S4.SS6.p1.4.m4.5.6.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS6.p1.4.m4.5.6.2" xref="S4.SS6.p1.4.m4.5.6.2a.cmml">C</mtext><mo id="S4.SS6.p1.4.m4.5.6.1" xref="S4.SS6.p1.4.m4.5.6.1.cmml">=</mo><mrow id="S4.SS6.p1.4.m4.5.6.3.2" xref="S4.SS6.p1.4.m4.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS6.p1.4.m4.5.6.3.2.1" xref="S4.SS6.p1.4.m4.5.6.3.1.cmml">{</mo><mn id="S4.SS6.p1.4.m4.1.1" xref="S4.SS6.p1.4.m4.1.1.cmml">3</mn><mo id="S4.SS6.p1.4.m4.5.6.3.2.2" xref="S4.SS6.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS6.p1.4.m4.2.2" xref="S4.SS6.p1.4.m4.2.2.cmml">5</mn><mo id="S4.SS6.p1.4.m4.5.6.3.2.3" xref="S4.SS6.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS6.p1.4.m4.3.3" xref="S4.SS6.p1.4.m4.3.3.cmml">8</mn><mo id="S4.SS6.p1.4.m4.5.6.3.2.4" xref="S4.SS6.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS6.p1.4.m4.4.4" xref="S4.SS6.p1.4.m4.4.4.cmml">10</mn><mo id="S4.SS6.p1.4.m4.5.6.3.2.5" xref="S4.SS6.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS6.p1.4.m4.5.5" xref="S4.SS6.p1.4.m4.5.5.cmml">20</mn><mo stretchy="false" id="S4.SS6.p1.4.m4.5.6.3.2.6" xref="S4.SS6.p1.4.m4.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.4.m4.5b"><apply id="S4.SS6.p1.4.m4.5.6.cmml" xref="S4.SS6.p1.4.m4.5.6"><eq id="S4.SS6.p1.4.m4.5.6.1.cmml" xref="S4.SS6.p1.4.m4.5.6.1"></eq><ci id="S4.SS6.p1.4.m4.5.6.2a.cmml" xref="S4.SS6.p1.4.m4.5.6.2"><mtext class="ltx_mathvariant_bold" id="S4.SS6.p1.4.m4.5.6.2.cmml" xref="S4.SS6.p1.4.m4.5.6.2">C</mtext></ci><set id="S4.SS6.p1.4.m4.5.6.3.1.cmml" xref="S4.SS6.p1.4.m4.5.6.3.2"><cn type="integer" id="S4.SS6.p1.4.m4.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1">3</cn><cn type="integer" id="S4.SS6.p1.4.m4.2.2.cmml" xref="S4.SS6.p1.4.m4.2.2">5</cn><cn type="integer" id="S4.SS6.p1.4.m4.3.3.cmml" xref="S4.SS6.p1.4.m4.3.3">8</cn><cn type="integer" id="S4.SS6.p1.4.m4.4.4.cmml" xref="S4.SS6.p1.4.m4.4.4">10</cn><cn type="integer" id="S4.SS6.p1.4.m4.5.5.cmml" xref="S4.SS6.p1.4.m4.5.5">20</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.4.m4.5c">\textbf{C}=\{3,5,8,10,20\}</annotation></semantics></math> and <math id="S4.SS6.p1.5.m5.4" class="ltx_Math" alttext="\textbf{L}=\{1,2,3,5\}" display="inline"><semantics id="S4.SS6.p1.5.m5.4a"><mrow id="S4.SS6.p1.5.m5.4.5" xref="S4.SS6.p1.5.m5.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS6.p1.5.m5.4.5.2" xref="S4.SS6.p1.5.m5.4.5.2a.cmml">L</mtext><mo id="S4.SS6.p1.5.m5.4.5.1" xref="S4.SS6.p1.5.m5.4.5.1.cmml">=</mo><mrow id="S4.SS6.p1.5.m5.4.5.3.2" xref="S4.SS6.p1.5.m5.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS6.p1.5.m5.4.5.3.2.1" xref="S4.SS6.p1.5.m5.4.5.3.1.cmml">{</mo><mn id="S4.SS6.p1.5.m5.1.1" xref="S4.SS6.p1.5.m5.1.1.cmml">1</mn><mo id="S4.SS6.p1.5.m5.4.5.3.2.2" xref="S4.SS6.p1.5.m5.4.5.3.1.cmml">,</mo><mn id="S4.SS6.p1.5.m5.2.2" xref="S4.SS6.p1.5.m5.2.2.cmml">2</mn><mo id="S4.SS6.p1.5.m5.4.5.3.2.3" xref="S4.SS6.p1.5.m5.4.5.3.1.cmml">,</mo><mn id="S4.SS6.p1.5.m5.3.3" xref="S4.SS6.p1.5.m5.3.3.cmml">3</mn><mo id="S4.SS6.p1.5.m5.4.5.3.2.4" xref="S4.SS6.p1.5.m5.4.5.3.1.cmml">,</mo><mn id="S4.SS6.p1.5.m5.4.4" xref="S4.SS6.p1.5.m5.4.4.cmml">5</mn><mo stretchy="false" id="S4.SS6.p1.5.m5.4.5.3.2.5" xref="S4.SS6.p1.5.m5.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.5.m5.4b"><apply id="S4.SS6.p1.5.m5.4.5.cmml" xref="S4.SS6.p1.5.m5.4.5"><eq id="S4.SS6.p1.5.m5.4.5.1.cmml" xref="S4.SS6.p1.5.m5.4.5.1"></eq><ci id="S4.SS6.p1.5.m5.4.5.2a.cmml" xref="S4.SS6.p1.5.m5.4.5.2"><mtext class="ltx_mathvariant_bold" id="S4.SS6.p1.5.m5.4.5.2.cmml" xref="S4.SS6.p1.5.m5.4.5.2">L</mtext></ci><set id="S4.SS6.p1.5.m5.4.5.3.1.cmml" xref="S4.SS6.p1.5.m5.4.5.3.2"><cn type="integer" id="S4.SS6.p1.5.m5.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1">1</cn><cn type="integer" id="S4.SS6.p1.5.m5.2.2.cmml" xref="S4.SS6.p1.5.m5.2.2">2</cn><cn type="integer" id="S4.SS6.p1.5.m5.3.3.cmml" xref="S4.SS6.p1.5.m5.3.3">3</cn><cn type="integer" id="S4.SS6.p1.5.m5.4.4.cmml" xref="S4.SS6.p1.5.m5.4.4">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.5.m5.4c">\textbf{L}=\{1,2,3,5\}</annotation></semantics></math>.</p>
</div>
<section id="S4.SS6.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS6.SSS1.4.1.1" class="ltx_text">IV-F</span>1 </span><span id="S4.SS6.SSS1.5.2" class="ltx_text ltx_font_bold">Analysis of Performance</span>
</h4>

<div id="S4.SS6.SSS1.p1" class="ltx_para">
<p id="S4.SS6.SSS1.p1.1" class="ltx_p">Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:performance_fl</span> shows performance metrics under different federated scenarios. We use three types of highlights in the table: bold numbers, underlines, and double-underlines represent the best F1 scores, best precision, and best recall concerning each client setting, respectively. The best F1 scores and best precision scores are usually obtained together when L = 2 while the best recall scores are nearly attained when L = 3. Furthermore, the large local epoch often leads to better recall and worse precision no matter how many clients joining in collaborative training. For the scenarios with fewer clients (e.g. <span id="S4.SS6.SSS1.p1.1.1" class="ltx_text ltx_font_bold">C</span> <math id="S4.SS6.SSS1.p1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS6.SSS1.p1.1.m1.1a"><mo id="S4.SS6.SSS1.p1.1.m1.1.1" xref="S4.SS6.SSS1.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS6.SSS1.p1.1.m1.1b"><lt id="S4.SS6.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS6.SSS1.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.SSS1.p1.1.m1.1c">&lt;</annotation></semantics></math> 8), the precision declines gradually as the local epoch increases. However, no such intuitive pattern for the scenarios with much more clients. In other words, the performance can not be inferred given C and L, which may be caused by the distribution skew that then leads to weight divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. In all scenarios, FedAnomaly achieves F1 scores of more than 0.8 that illustrates its robustness for time-series anomaly detection.</p>
</div>
<div id="S4.SS6.SSS1.p2" class="ltx_para">
<p id="S4.SS6.SSS1.p2.1" class="ltx_p">Next, we present the detection latency results of FedAnomaly in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:latency_fl</span>. There are two-digit tuples in the table where the first term is the number of adjusted segments while the second term is the average latency. We highlight the most detected segments and the lowest average latency for <span id="S4.SS6.SSS1.p2.1.1" class="ltx_text ltx_font_bold">C</span>. Obviously, 3 is the best local epoch for most client settings. However, recall Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:performance_fl</span>, precision score is usually not good when L = 3 that would result in many more false alarms.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Latency analysis under different federated scenarios</figcaption>
<table id="S4.T6.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T6.3.1.1" class="ltx_tr">
<th id="S4.T6.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S4.T6.3.1.1.1.1" class="ltx_text" style="font-size:90%;">C</span></th>
<td id="S4.T6.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T6.3.1.1.2.1" class="ltx_text" style="font-size:90%;">3</span></td>
<td id="S4.T6.3.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T6.3.1.1.3.1" class="ltx_text" style="font-size:90%;">5</span></td>
<td id="S4.T6.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T6.3.1.1.4.1" class="ltx_text" style="font-size:90%;">8</span></td>
<td id="S4.T6.3.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T6.3.1.1.5.1" class="ltx_text" style="font-size:90%;">10</span></td>
<td id="S4.T6.3.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T6.3.1.1.6.1" class="ltx_text" style="font-size:90%;">20</span></td>
</tr>
<tr id="S4.T6.3.2.2" class="ltx_tr">
<th id="S4.T6.3.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T6.3.2.2.1.1" class="ltx_text" style="font-size:90%;">L=1</span></th>
<td id="S4.T6.3.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T6.3.2.2.2.1" class="ltx_text" style="font-size:90%;">14/28.49</span></td>
<td id="S4.T6.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T6.3.2.2.3.1" class="ltx_text" style="font-size:90%;">12/31.83</span></td>
<td id="S4.T6.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T6.3.2.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">13</span><span id="S4.T6.3.2.2.4.2" class="ltx_text" style="font-size:90%;">/31.30</span>
</td>
<td id="S4.T6.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T6.3.2.2.5.1" class="ltx_text" style="font-size:90%;">12/29.99</span></td>
<td id="S4.T6.3.2.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T6.3.2.2.6.1" class="ltx_text" style="font-size:90%;">18/13.22</span></td>
</tr>
<tr id="S4.T6.3.3.3" class="ltx_tr">
<th id="S4.T6.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T6.3.3.3.1.1" class="ltx_text" style="font-size:90%;">L=2</span></th>
<td id="S4.T6.3.3.3.2" class="ltx_td ltx_align_center"><span id="S4.T6.3.3.3.2.1" class="ltx_text" style="font-size:90%;">14/26.71</span></td>
<td id="S4.T6.3.3.3.3" class="ltx_td ltx_align_center"><span id="S4.T6.3.3.3.3.1" class="ltx_text" style="font-size:90%;">14/29.99</span></td>
<td id="S4.T6.3.3.3.4" class="ltx_td ltx_align_center">
<span id="S4.T6.3.3.3.4.1" class="ltx_text" style="font-size:90%;">12/</span><span id="S4.T6.3.3.3.4.2" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">15.49</span>
</td>
<td id="S4.T6.3.3.3.5" class="ltx_td ltx_align_center"><span id="S4.T6.3.3.3.5.1" class="ltx_text" style="font-size:90%;">14/19.92</span></td>
<td id="S4.T6.3.3.3.6" class="ltx_td ltx_align_center"><span id="S4.T6.3.3.3.6.1" class="ltx_text" style="font-size:90%;">12/28.58</span></td>
</tr>
<tr id="S4.T6.3.4.4" class="ltx_tr">
<th id="S4.T6.3.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T6.3.4.4.1.1" class="ltx_text" style="font-size:90%;">L=3</span></th>
<td id="S4.T6.3.4.4.2" class="ltx_td ltx_align_center">
<span id="S4.T6.3.4.4.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">22</span><span id="S4.T6.3.4.4.2.2" class="ltx_text" style="font-size:90%;">/</span><span id="S4.T6.3.4.4.2.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">12.86</span>
</td>
<td id="S4.T6.3.4.4.3" class="ltx_td ltx_align_center">
<span id="S4.T6.3.4.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">21</span><span id="S4.T6.3.4.4.3.2" class="ltx_text" style="font-size:90%;">/</span><span id="S4.T6.3.4.4.3.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">13.52</span>
</td>
<td id="S4.T6.3.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T6.3.4.4.4.1" class="ltx_text" style="font-size:90%;">8/37.99</span></td>
<td id="S4.T6.3.4.4.5" class="ltx_td ltx_align_center">
<span id="S4.T6.3.4.4.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">20</span><span id="S4.T6.3.4.4.5.2" class="ltx_text" style="font-size:90%;">/</span><span id="S4.T6.3.4.4.5.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">14.99</span>
</td>
<td id="S4.T6.3.4.4.6" class="ltx_td ltx_align_center">
<span id="S4.T6.3.4.4.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">25</span><span id="S4.T6.3.4.4.6.2" class="ltx_text" style="font-size:90%;">/</span><span id="S4.T6.3.4.4.6.3" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">10.76</span>
</td>
</tr>
<tr id="S4.T6.3.5.5" class="ltx_tr">
<th id="S4.T6.3.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S4.T6.3.5.5.1.1" class="ltx_text" style="font-size:90%;">L=5</span></th>
<td id="S4.T6.3.5.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T6.3.5.5.2.1" class="ltx_text" style="font-size:90%;">19/13.52</span></td>
<td id="S4.T6.3.5.5.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T6.3.5.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">21</span><span id="S4.T6.3.5.5.3.2" class="ltx_text" style="font-size:90%;">/15.09</span>
</td>
<td id="S4.T6.3.5.5.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T6.3.5.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">13</span><span id="S4.T6.3.5.5.4.2" class="ltx_text" style="font-size:90%;">/32.92</span>
</td>
<td id="S4.T6.3.5.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T6.3.5.5.5.1" class="ltx_text" style="font-size:90%;">15/28.93</span></td>
<td id="S4.T6.3.5.5.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T6.3.5.5.6.1" class="ltx_text" style="font-size:90%;">17/16.94</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2108.08404/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="180" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S4.F6.2.1" class="ltx_text" style="font-size:90%;">Valid loss vs. global epoch (communication round). </span></figcaption>
</figure>
</section>
<section id="S4.SS6.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS6.SSS2.4.1.1" class="ltx_text">IV-F</span>2 </span><span id="S4.SS6.SSS2.5.2" class="ltx_text ltx_font_bold">Analysis of Learning Curve</span>
</h4>

<div id="S4.SS6.SSS2.p1" class="ltx_para">
<p id="S4.SS6.SSS2.p1.1" class="ltx_p">We then explore the characteristics of the learning curve of FedAnomaly. We adopt the early stopping strategy in which FedAnomaly stops training if the reconstruction error (valid loss) on validation data on the cloud can not achieve the lowest value obtained in the previous communication rounds within the succeeding five rounds. Fig. <a href="#S4.F6" title="Figure 6 ‣ IV-F1 Analysis of Performance ‣ IV-F Extensive Experiments on Federated Learning Mechanism ‣ IV Experiments ‣ Federated Variational Learning for Anomaly Detection in Multivariate Time Series *These authors contributed equally to this work 978-1-6654-4331-9/21/$31.00 ©2021 IEEE" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the validation curve in the training process. It illustrates that FedAnomaly needs more communication rounds to reach the lowest valid loss with the increase of the number of clients. From the perspective of the local epoch, the large value speeds up the convergence of the model particularly in the scenarios with more clients. For example, there are 25 communication rounds for obtaining the best model parameters when C = 20, L = 1, but only 5 rounds are needed if L = 5. Such a method is good for improving communication efficiency when a large number of edges collaboratively train a global model for time series anomaly detection. It is worth noting that in all settings, our model gets the similar best valid loss, approximately 0.14, that reflects both high capacity and robustness of our framework.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusions and Future work</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">To address growing challenges within entity-level anomaly detection that stand to benefit significantly from unsupervised learning, we propose ConvGRU-VAE and its federated framework FedAnomaly, which work well for outlier detection tasks and outperform state-of-the-art approaches on three real-world multivariate time-series datasets. Through extensive experiments, we further explore the capacity of our detection framework and discuss the impact of different hyperparameter selection strategies. In the future, we plan to investigate solutions to tackle the data heterogeneity problem in the federated deep generative model for time series anomaly detection.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgment</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Effort sponsored by the Air Force under PIA FA8750-19-3-1000. The U.S. Government is authorized to reproduce and distribute copies for Governmental purposes notwithstanding any copyright or other restrictive legends. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the Air Force or the U.S. Government. This research was partially supported by the Center for Advanced Transportation Mobility (CATM), USDOT Grant No. 69A3551747125.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
H. Ren, B. Xu, Y. Wang, C. Yi, C. Huang, X. Kou, T. Xing, M. Yang, J. Tong, and
Q. Zhang, “Time-series anomaly detection service at microsoft,” in
<em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 25th ACM SIGKDD International Conference on
Knowledge Discovery &amp; Data Mining</em>, 2019, pp. 3009–3017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
S. Lin, R. Clark, R. Birke, S. Schönborn, N. Trigoni, and S. Roberts,
“Anomaly detection for time series using vae-lstm hybrid model,” in
<em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ICASSP 2020-2020 IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP)</em>.   IEEE,
2020, pp. 4322–4326.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Y. Su, Y. Zhao, C. Niu, R. Liu, W. Sun, and D. Pei, “Robust anomaly detection
for multivariate time series through stochastic recurrent neural network,”
in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 25th ACM SIGKDD International Conference on
Knowledge Discovery &amp; Data Mining</em>, 2019, pp. 2828–2837.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
D. P. Kingma and M. Welling, “Auto-encoding variational bayes,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:1312.6114</em>, 2013.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Q. Yang, Y. Liu, T. Chen, and Y. Tong, “Federated machine learning: Concept
and applications,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology (TIST)</em>, vol. 10, no. 2, pp. 1–19, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
J. Chung, K. Kastner, L. Dinh, K. Goel, A. C. Courville, and Y. Bengio, “A
recurrent latent variable model for sequential data,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in
Neural Information Processing Systems</em>, vol. 28, pp. 2980–2988, 2015.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Z. Chen, D. Chen, Z. Yuan, X. Cheng, and X. Zhang, “Learning graph structures
with transformer for multivariate time series anomaly detection in iot,”
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.03466</em>, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. Deng and B. Hooi, “Graph neural network-based anomaly detection in
multivariate time series,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on
Artificial Intelligence</em>, vol. 35, no. 5, 2021, pp. 4027–4035.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
K. Hundman, V. Constantinou, C. Laporte, I. Colwell, and T. Soderstrom,
“Detecting spacecraft anomalies using lstms and nonparametric dynamic
thresholding,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 24th ACM SIGKDD international
conference on knowledge discovery &amp; data mining</em>, 2018, pp. 387–395.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Hochreiter and J. Schmidhuber, “Long short-term memory,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Neural
computation</em>, vol. 9, no. 8, pp. 1735–1780, 1997.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Chung, C. Gulcehre, K. Cho, and Y. Bengio, “Empirical evaluation of gated
recurrent neural networks on sequence modeling,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">NIPS 2014 Workshop
on Deep Learning, December 2014</em>, 2014.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
B. Zong, Q. Song, M. R. Min, W. Cheng, C. Lumezanu, D. Cho, and H. Chen, “Deep
autoencoding gaussian mixture model for unsupervised anomaly detection,” in
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
H. Xu, W. Chen, N. Zhao, Z. Li, J. Bu, Z. Li, Y. Liu, Y. Zhao, D. Pei, Y. Feng
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Unsupervised anomaly detection via variational auto-encoder
for seasonal kpis in web applications,” in <em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic">Proceedings of the 2018
World Wide Web Conference</em>, 2018, pp. 187–196.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
D. Li, D. Chen, B. Jin, L. Shi, J. Goh, and S.-K. Ng, “Mad-gan: Multivariate
anomaly detection for time series data with generative adversarial
networks,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Neural
Networks</em>.   Springer, 2019, pp.
703–716.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
J. Audibert, P. Michiardi, F. Guyard, S. Marti, and M. A. Zuluaga, “Usad:
Unsupervised anomaly detection on multivariate time series,” in
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 26th ACM SIGKDD International Conference on
Knowledge Discovery &amp; Data Mining</em>, 2020, pp. 3395–3404.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
H. Zhao, Y. Wang, J. Duan, C. Huang, D. Cao, Y. Tong, B. Xu, J. Bai, J. Tong,
and Q. Zhang, “Multivariate time-series anomaly detection via graph
attention network,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">2020 IEEE International Conference on Data
Mining (ICDM)</em>.   IEEE, 2020, pp.
841–850.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X. Li, K. Huang, W. Yang, S. Wang, and Z. Zhang, “On the convergence of fedavg
on non-iid data,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
T. D. Nguyen, S. Marchal, M. Miettinen, H. Fereidooni, N. Asokan, and A.-R.
Sadeghi, “Dïot: A federated self-learning anomaly detection system for
iot,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">2019 IEEE 39th International Conference on Distributed
Computing Systems (ICDCS)</em>.   IEEE,
2019, pp. 756–767.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. B. McMahan <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Advances and open problems in federated
learning,” <em id="bib.bib20.2.2" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine
Learning</em>, vol. 14, no. 1, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Y. Liu, S. Garg, J. Nie, Y. Zhang, Z. Xiong, J. Kang, and M. S. Hossain, “Deep
anomaly detection for time-series data in industrial iot: A
communication-efficient on-device federated learning approach,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">IEEE
Internet of Things Journal</em>, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Y. Zhao, J. Chen, D. Wu, J. Teng, and S. Yu, “Multi-task network anomaly
detection using federated learning,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the tenth
international symposium on information and communication technology</em>, 2019,
pp. 273–279.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Chen, J. Zhang, and C. K. Yeo, “Network anomaly detection using federated
deep autoencoding gaussian mixture model,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">International Conference
on Machine Learning for Networking</em>.   Springer, 2019, pp. 1–14.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
X. Shi, Z. Chen, H. Wang, D.-Y. Yeung, W.-K. Wong, and W.-c. Woo,
“Convolutional lstm network: A machine learning approach for precipitation
nowcasting,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
vol. 28, 2015.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
M. Siam, S. Valipour, M. Jagersand, and N. Ray, “Convolutional gated recurrent
networks for video segmentation,” in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">2017 IEEE international
conference on image processing (ICIP)</em>.   IEEE, 2017, pp. 3090–3094.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
N. Srivastava, E. Mansimov, and R. Salakhudinov, “Unsupervised learning of
video representations using lstms,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">International conference on
machine learning</em>.   PMLR, 2015, pp.
843–852.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
J. Goh, S. Adepu, K. N. Junejo, and A. Mathur, “A dataset to support research
in the design of secure water treatment systems,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">International
conference on critical information infrastructures security</em>.   Springer, 2016, pp. 88–99.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
B. T. Polyak and A. B. Juditsky, “Acceleration of stochastic approximation by
averaging,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">SIAM journal on control and optimization</em>, vol. 30, no. 4,
pp. 838–855, 1992.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
F. T. Liu, K. M. Ting, and Z.-H. Zhou, “Isolation forest,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">2008
eighth ieee international conference on data mining</em>.   IEEE, 2008, pp. 413–422.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
D. Park, Y. Hoshi, and C. C. Kemp, “A multimodal anomaly detector for
robot-assisted feeding using an lstm-based variational autoencoder,”
<em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em>, vol. 3, no. 3, pp. 1544–1551,
2018.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2108.08402" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2108.08404" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2108.08404">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2108.08404" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2108.08405" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 04:04:09 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
