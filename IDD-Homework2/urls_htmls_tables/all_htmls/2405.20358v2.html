<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement</title>
<!--Generated on Tue Jul  9 03:11:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2405.20358v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S1" title="In Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S2" title="In Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S2.SS1" title="In 2 Related Works ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Medication Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S2.SS2" title="In 2 Related Works ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>3D Molecular Representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S2.SS3" title="In 2 Related Works ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Multi-Modal Molecules</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S3" title="In Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Problem Definition</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S3.SS1" title="In 3 Problem Definition ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Medical Entity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S3.SS2" title="In 3 Problem Definition ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Input and Output</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S3.SS3" title="In 3 Problem Definition ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>DDI Matrix</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S4" title="In Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S4.SS1" title="In 4 Methods ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Pre-training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S4.SS2" title="In 4 Methods ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Molecular Multi-Enhancement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S4.SS3" title="In 4 Methods ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Fusion of Medication Evolution Trajectories</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S4.SS4" title="In 4 Methods ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Model Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5" title="In Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS1" title="In 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Setup Protocol</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS1.SSS1" title="In 5.1 Setup Protocol ‣ 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Experimental Environment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS1.SSS2" title="In 5.1 Setup Protocol ‣ 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Configuration and Parameter</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS1.SSS3" title="In 5.1 Setup Protocol ‣ 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Sampling Approach</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS2" title="In 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS3" title="In 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS4" title="In 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.SS5" title="In 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Performance Comparison</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6" title="In Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Discussions</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.SS1" title="In 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Effectiveness Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.SS2" title="In 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Efficiency Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.SS3" title="In 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.SS4" title="In 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Parameter Sensitivity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.SS5" title="In 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Case Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S7" title="In Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\credit</span>
<p class="ltx_p" id="p1.2">Conceptualization, Methodology, Software, Validation, Formal analysis, Data Curation, Investigation, Writing – original draft, Writing - Review &amp; Editing, Visualization</p>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\credit</span>
<p class="ltx_p" id="p2.2">Supervision, Funding acquisition
<span class="ltx_ERROR undefined" id="p2.2.1">\cortext</span>[1]Corresponding author.</p>
</div>
<div class="ltx_para" id="p3">
<span class="ltx_ERROR undefined" id="p3.1">\credit</span>
<p class="ltx_p" id="p3.2">Supervision, Writing - Review &amp; Editing</p>
</div>
<div class="ltx_para" id="p4">
<p class="ltx_p" id="p4.1">1]
organization=School of Information Science and Engineering, Yanshan University,
city=QinHuangDao,
postcode=066004,
country=China</p>
</div>
<div class="ltx_para" id="p5">
<p class="ltx_p" id="p5.1">2]
organization=School of Information Science and Engineering, Xinjiang University Of Science &amp; Technology,
city=Korla,
postcode=841000,
country=China</p>
</div>
<div class="ltx_para" id="p6">
<p class="ltx_p" id="p6.1">3]
organization=School of Mechanical Engineering, Yanshan University,
city=QinHuangDao,
postcode=066004,
country=China</p>
</div>
<h1 class="ltx_title ltx_title_document">Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shi Mu
</span><span class="ltx_author_notes">mushi@stumail.ysu.edu.cn</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shunpan Liang
</span><span class="ltx_author_notes">liangshunpan@ysu.edu.cn</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiang Li
</span><span class="ltx_author_notes">leiyu0160@gmail.com
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">As the integration of artificial intelligence technology with the medical field deepens, medication recommendation, as an important subfield, demonstrates immense potential value. Medication recommendation combines patient medical history with biomedical knowledge<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib43" title="">43</a>]</cite> to assist doctors in determining medication combinations more accurately and safely. Existing works based on molecular knowledge neglect the 3D geometric structure of molecules and fail to learn the high-dimensional information of medications, leading to structural confusion. Additionally, it does not extract key substructures from a single patient visit, resulting in the failure to identify medication molecules suitable for the current patient visit. To address the above limitations, we propose a bimodal molecular recommendation framework named BiMoRec, which introduces 3D molecular structures to obtain atomic 3D coordinates and edge indices, overcoming the inherent lack of high-dimensional molecular information in 2D molecular structures. To retain the fast training and prediction efficiency of the recommendation system, we use bimodal graph contrastive pretraining to maximize the mutual information between the two molecular modalities, achieving the fusion of 2D and 3D molecular graphs and re-evaluating substructures at the visit level.
Specifically, we use deep learning networks to construct a pretraining method that acquires 2D and 3D molecular structure representations and substructure representations, and obtain mutual information through contrastive learning. We then generate fused molecular representations using the trained GNN module and re-determine the relevance of substructure representations in combination with the patient’s clinical history. Finally, we generate the final medication combination based on the extracted substructure sequences. Our implementation on the MIMIC-III and MIMIC-IV datasets demonstrates that our method achieves state-of-the-art performance. Compared to the second-best baseline, our model improves accuracy by 2.07%, with DDI at the same level as the baseline. Our source code is publicly available at: <a class="ltx_ref ltx_href" href="https://github.com/guangyunms/BiMoRec" title="">https://github.com/guangyunms/BiMoRec</a>.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Intelligent healthcare management<span class="ltx_ERROR undefined" id="id2.id1">\sep</span>Medication recommendation<span class="ltx_ERROR undefined" id="id3.id2">\sep</span>Recommender systems

</div>
<div class="ltx_para" id="p7">
<span class="ltx_ERROR undefined" id="p7.1">{highlights}</span>
</div>
<div class="ltx_para" id="p8">
<p class="ltx_p" id="p8.1">We introduce a medication recommendation framework based on bimolecular modalities and dynamic enhancement of patient-molecule interactions, named BiMoRec.</p>
</div>
<div class="ltx_para" id="p9">
<p class="ltx_p" id="p9.1">We introduce molecular bimodality into the field of medication recommendation for the first time, addressing the issue of structural confusion between molecules.</p>
</div>
<div class="ltx_para" id="p10">
<p class="ltx_p" id="p10.1">We propose a method for molecular enhancement and evaluation at the single-visit granularity, extracting key molecular substructures across multiple time points, and re-enhancing them based on the latest visit. This approach addresses the issue of substructure correlation bias.</p>
</div>
<div class="ltx_para" id="p11">
<p class="ltx_p" id="p11.1">BiMoRec maintains a balance between improvements in accuracy, safety, and time efficiency, surpassing state-of-the-art models in comprehensive evaluation.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Medication recommendation systems are an important research field in modern medical informatics, aiming to provide personalized medication suggestions to doctors and patients by analyzing patients’ personal health data (e.g., electronic health records (EHRs)) and medical literature. With the rapid advancements in big data, artificial intelligence, and machine learning technologies, smart healthcare has gradually become an important means of addressing future challenges in medical resource distribution. Unlike traditional medication recommendations, which primarily rely on doctors’ experience and guidelines, modern medication recommendation systems can utilize vast clinical datasets and literature databases, automatically extracting useful information and performing intelligent analysis, thereby improving the accuracy and efficiency of recommendations.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Unlike recommendations in other fields (such as e-commerce platforms), medication recommendation not only focuses on the accuracy of the recommendations but also emphasizes their safety. This is because different medications can interact with each other, potentially causing adverse effects and impacting the patient’s health. For instance, both aspirin and warfarin are anticoagulant medications, but their simultaneous use may increase the risk of bleeding. A study <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib2" title="">2</a>]</cite> shows that in the largest publicly available benchmark dataset, MIMIC-III, patients have an average of 20 different medications. Therefore, eliminating all potential drug-drug interaction (DDI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib6" title="">6</a>]</cite> remains a significant challenge.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Early medication recommendation work focuses on the patient’s latest visit <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib38" title="">38</a>]</cite>, considering the current state as a crucial factor for medication recommendation. Subsequent researchers incorporate the patient’s longitudinal visit records <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib45" title="">45</a>]</cite>, achieving better results. However, another important indicator for medication recommendation, safety, remains inadequately addressed. To balance accuracy and safety, recent research focuses on the impact of 2D molecular structures on medication recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib43" title="">43</a>]</cite>, making significant progress. Representing medications as finer-grained molecular substructures helps in modeling the pharmacological properties of medications and DDI, significantly improving model accuracy and safety, ushering medication recommendation models into a new stage. However, this research overlooks the geometric structure of atoms, causing molecules with similar 2D structures but different 3D structures to potentially have the same representation. This structural confusion reduces the accuracy of medication recommendation. The high-dimensional information contained in 3D structures (such as 3D atomic coordinates and their edges) can more clearly distinguish different molecular structures, optimizing the molecular representation space to address this issue.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="729" id="S1.F1.g1" src="x1.png" width="665"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">The mapping relationship between molecular conformation and drug efficacy</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this study, we identify two specific manifestations of structural confusion that lead to reduced accuracy. The first is that molecules with similar 2D structures but different 3D geometric structures are problematic because molecular reactions and bindings primarily occur in three-dimensional space. The limitations of 2D structures prevent us from accurately modeling the spatial relationships and interaction forces between molecules, thereby affecting the accuracy of medication recommendations. The second issue is that molecules segmented into smaller substructures do not represent the actual molecular states; they lose their original integrity and stability, and their 3D structures cannot be accurately reproduced in three-dimensional space. The molecular representations expressed by these substructures are also incomplete and inaccurate. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">1</span></a> shows the mapping relationships of molecular conformations, where even the same 2D molecular structures lead to different efficacies due to minor variations in 3D spatial configurations. We believe that by incorporating the 3D geometric configuration of molecules and completing the 3D information of substructures through comparative learning between bimolecular modalities, we can enhance the overall capability of medication recommendation.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Following this line, we design the BiMoRec model, which addresses the confusion of 2D molecular structures and the inability of substructures to represent true molecular states. Initially, we devise a bimodal graph comparative learning phase, where the bimodal data of molecules serve as input. The 2D modality, through the GIN network <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib40" title="">40</a>]</cite>, obtains low-dimensional structural embeddings of the molecules, while for the 3D modality, we first obtain the molecular SDF description files from the molecules’ SMILES strings, acquiring the corresponding 3D data for each molecule, and simultaneously complete the 3D description for the segmented substructures. Subsequently, through the 3D geometric vector machine (GVP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib25" title="">25</a>]</cite>, we obtain high-dimensional structural embeddings of the molecules. We then compare the mutual information between the two modal graphs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib5" title="">5</a>]</cite>, integrating the information of both modalities, allowing the 2D encoder to learn the high-dimensional structural representations of 3D. After the contrastive learning phase, we enhance the set of molecules used within a single visit by learning the correlation between the given patient’s health status and the bimodal molecular structures. We capture the highly correlated substructures for each visit using the patient’s multiple visits and further enhance the recommendation results using the latest visit. Through multi-granularity collaborative enhancement, we obtain more accurate and safe medication combinations.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Compared to the latest methods, our model introduces a 3D molecular modality that not only completes the structural representation of molecules but also uses a pre-training module with pre-learned parameters, ensuring that the model performance in subsequent stages is not affected. Our pre-training module conducts bimodal molecular contrastive learning before formal training, meeting the established objectives while maintaining the expected model efficiency. Moreover, this module is highly extensible and can be integrated with any medication recommendation framework that utilizes molecular knowledge.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Specifically, the main contributions of this paper can be summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p8">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce the high-dimensional 3D structure of molecules for the first time in medication recommendations and complete the 3D information of substructures. By using bimodal graph contrastive learning to integrate the knowledge of both modalities, it effectively corrects the structural confusion problem and optimizes the representation space of molecules.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">This paper enhances molecular embeddings based on the visit-level representations of patients and re-evaluates the set of substructures to obtain key substructure sequences for each visit. It further enhances the molecular embeddings based on the patient’s latest visit to emphasize molecular features that are more relevant to the current patient condition, improving model performance while ensuring a balance between accuracy and safety.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conduct extensive experiments on real datasets MIMIC-III and MIMIC-IV, demonstrating that our proposed method outperforms existing methods.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">Below, we provide an overview of the different sections of the paper:
(1) Introduction: Introduces the main innovations and the motivation behind this work.
(2) Related Work: Summarizes typical studies and current hotspots in medication recommendation fields.
(3) Problem Definition: Introduces the medical concepts, entities, inputs, and outputs used.
(4) Methods: Presents the core ideas of the model and the specific details of its implementation.
(5) Experiments: Describes the experimental background, baselines, testing methods, and specific experimental results.
(6) Discussion: Delves into an analysis of the experimental results and proposes a series of supportive experiments.
(7) Conclusion: Summarizes the research findings and offers perspectives on future research directions.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we will introduce the related work from three aspects: medication recommendation, 3D molecular representation, and multi-modal molecules.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Medication Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In recent years, the field of medication recommendation has undergone multiple development stages, aiming to provide personalized medication combinations for patients.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Early works in medication recommendation include instance-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib44" title="">44</a>]</cite>, which prescribe medications based on single-visit data and view medication combination recommendations as multi-instance and multi-label classification tasks. Subsequent works introduce sequential models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib7" title="">7</a>]</cite> to model longitudinal data.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Recent medication recommendation works are categorized into three types. The first type views medication recommendation as a package, sequence, and other mature recommendation tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib22" title="">22</a>]</cite>, utilizing advanced algorithmic models to improve recommendation quality. The second type combines the medication recommendation task with translation models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib39" title="">39</a>]</cite> and generative models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib47" title="">47</a>]</cite> to derive medication combinations based on the patient’s personal visit information. The last type utilizes relevant external knowledge to fill in missing information in the data, thereby improving model performance, as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib4" title="">4</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>3D Molecular Representation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">In recent years, researchers have begun to realize the importance of 3D geometric information for molecular representation learning. Initially, convolutional layers with continuous filters were used to simulate quantum interactions within molecules, providing valuable insights for subsequent research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib30" title="">30</a>]</cite>. Later, researchers began designing more complex network architectures, utilizing spherical harmonics to construct filters and creating rotation- and translation-equivariant neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib33" title="">33</a>]</cite>, which improved the accuracy and stability of molecular representation. Recently, researchers have started to explore the use of spherical coordinates to capture molecular geometric information or introduce equivariant networks into 3D molecular representation learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib35" title="">35</a>]</cite>, ensuring that molecular representations remain equivariant under continuous 3D rotations and translations, further enhancing their robustness and generalization ability. In addition to improving network architectures, researchers have also begun to incorporate physical quantities such as interatomic distances and bond angles into network design, providing a better understanding of the intrinsic structure and properties of molecules.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Multi-Modal Molecules</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In the field of multi-modal molecular learning, 2D graph structures and 3D geometric structures can be viewed as different perspectives of the same molecule. Inspired by contrastive pre-training methods in the vision domain, many research efforts have begun to explore how to use 2D and 3D information jointly for molecular pre-training. For example, using two encoders to separately encode 2D and 3D molecular information while maximizing the mutual information between their representations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib32" title="">32</a>]</cite>. Alternatively, pre-training 2D and 3D encoders through contrastive learning and reconstruction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib24" title="">24</a>]</cite>. Recent studies have unified the aforementioned 2D and 3D pre-training methods and proposed a 2D graph neural network model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib48" title="">48</a>]</cite> that can be enhanced by 3D geometric features.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Our research aims to integrate molecular multi-modality without compromising the efficiency and complexity of the recommendation system, in order to address the issue of structural confusion in medication recommendation and significantly improve existing models.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Definition</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Medical Entity</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">This article introduces the concept of medical entities, which represent relatively comprehensive medical concepts in medical data. In this study, medical entities primarily include three types: diseases, surgeries, and medications, denoted as <math alttext="\mathcal{D}=\{d_{1},d_{2},\ldots\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.3"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3.4" xref="S3.SS1.p1.1.m1.3.3.4.cmml">𝒟</mi><mo id="S3.SS1.p1.1.m1.3.3.3" xref="S3.SS1.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.3.3.2.2" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml"><mo id="S3.SS1.p1.1.m1.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">d</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.4" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">d</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.5" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><apply id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3"><eq id="S3.SS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.3"></eq><ci id="S3.SS1.p1.1.m1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.3.3.4">𝒟</ci><set id="S3.SS1.p1.1.m1.3.3.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑑</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝑑</ci><cn id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">\mathcal{D}=\{d_{1},d_{2},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.3d">caligraphic_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math>, <math alttext="\mathcal{P}=\{p_{1},p_{2},\ldots\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.3"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.3.3.4" xref="S3.SS1.p1.2.m2.3.3.4.cmml">𝒫</mi><mo id="S3.SS1.p1.2.m2.3.3.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml"><mo id="S3.SS1.p1.2.m2.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">p</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.2.4" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml">p</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.2.5" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><apply id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3"><eq id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.3"></eq><ci id="S3.SS1.p1.2.m2.3.3.4.cmml" xref="S3.SS1.p1.2.m2.3.3.4">𝒫</ci><set id="S3.SS1.p1.2.m2.3.3.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">𝑝</ci><cn id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">𝑝</ci><cn id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">\mathcal{P}=\{p_{1},p_{2},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.3d">caligraphic_P = { italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math>, and <math alttext="\mathcal{M}=\{m_{1},m_{2},\ldots\}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.3"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.3.3.4" xref="S3.SS1.p1.3.m3.3.3.4.cmml">ℳ</mi><mo id="S3.SS1.p1.3.m3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.3.3.2.2" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml"><mo id="S3.SS1.p1.3.m3.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">m</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.2.2.4" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">m</mi><mn id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.2.2.5" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p1.3.m3.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><apply id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3"><eq id="S3.SS1.p1.3.m3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3"></eq><ci id="S3.SS1.p1.3.m3.3.3.4.cmml" xref="S3.SS1.p1.3.m3.3.3.4">ℳ</ci><set id="S3.SS1.p1.3.m3.3.3.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2"><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2">𝑚</ci><cn id="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">𝑚</ci><cn id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">\mathcal{M}=\{m_{1},m_{2},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.3d">caligraphic_M = { italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math>. Additionally, molecular modal data is derived from external knowledge and thus does not belong to medical entities.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Input and Output</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.7">The model utilizes Electronic Health Record (EHR) as the data source, encompassing extensive records of patient visits and treatments. Each patient record is represented as <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">caligraphic_H</annotation></semantics></math>, containing multiple visit records <math alttext="\mathcal{H}=\{v_{1},v_{2},\ldots,v_{t}\}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.4"><semantics id="S3.SS2.p1.2.m2.4a"><mrow id="S3.SS2.p1.2.m2.4.4" xref="S3.SS2.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.4.4.5" xref="S3.SS2.p1.2.m2.4.4.5.cmml">ℋ</mi><mo id="S3.SS2.p1.2.m2.4.4.4" xref="S3.SS2.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.2.m2.4.4.3.3" xref="S3.SS2.p1.2.m2.4.4.3.4.cmml"><mo id="S3.SS2.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS2.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p1.2.m2.2.2.1.1.1" xref="S3.SS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.1.1.1.2" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS2.p1.2.m2.2.2.1.1.1.3" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.2.m2.4.4.3.3.5" xref="S3.SS2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.2.m2.3.3.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml">v</mi><mn id="S3.SS2.p1.2.m2.3.3.2.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.2.m2.4.4.3.3.6" xref="S3.SS2.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p1.2.m2.4.4.3.3.7" xref="S3.SS2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.2.m2.4.4.3.3.3" xref="S3.SS2.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.2.m2.4.4.3.3.3.2" xref="S3.SS2.p1.2.m2.4.4.3.3.3.2.cmml">v</mi><mi id="S3.SS2.p1.2.m2.4.4.3.3.3.3" xref="S3.SS2.p1.2.m2.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S3.SS2.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS2.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.4b"><apply id="S3.SS2.p1.2.m2.4.4.cmml" xref="S3.SS2.p1.2.m2.4.4"><eq id="S3.SS2.p1.2.m2.4.4.4.cmml" xref="S3.SS2.p1.2.m2.4.4.4"></eq><ci id="S3.SS2.p1.2.m2.4.4.5.cmml" xref="S3.SS2.p1.2.m2.4.4.5">ℋ</ci><set id="S3.SS2.p1.2.m2.4.4.3.4.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3"><apply id="S3.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2">𝑣</ci><cn id="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2">𝑣</ci><cn id="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">…</ci><apply id="S3.SS2.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3.3.2">𝑣</ci><ci id="S3.SS2.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.4c">\mathcal{H}=\{v_{1},v_{2},\ldots,v_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.4d">caligraphic_H = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="v_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">v_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the clinical information related to the <math alttext="t_{th}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">t</mi><mrow id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.4.m4.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑡</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><times id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">t_{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_t start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math> visit. Each visit includes three elements: <math alttext="\mathcal{D}_{t}\in\{0,1\}^{|\mathcal{D}|},\mathcal{P}_{t}\in\{0,1\}^{|\mathcal%
{P}|},\mathcal{D}_{t}\in\{0,1\}^{|\mathcal{M}|}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.11"><semantics id="S3.SS2.p1.5.m5.11a"><mrow id="S3.SS2.p1.5.m5.11.11.2" xref="S3.SS2.p1.5.m5.11.11.3.cmml"><mrow id="S3.SS2.p1.5.m5.10.10.1.1" xref="S3.SS2.p1.5.m5.10.10.1.1.cmml"><msub id="S3.SS2.p1.5.m5.10.10.1.1.2" xref="S3.SS2.p1.5.m5.10.10.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.10.10.1.1.2.2" xref="S3.SS2.p1.5.m5.10.10.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.5.m5.10.10.1.1.2.3" xref="S3.SS2.p1.5.m5.10.10.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.5.m5.10.10.1.1.1" xref="S3.SS2.p1.5.m5.10.10.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.5.m5.10.10.1.1.3" xref="S3.SS2.p1.5.m5.10.10.1.1.3.cmml"><mrow id="S3.SS2.p1.5.m5.10.10.1.1.3.2.2" xref="S3.SS2.p1.5.m5.10.10.1.1.3.2.1.cmml"><mo id="S3.SS2.p1.5.m5.10.10.1.1.3.2.2.1" stretchy="false" xref="S3.SS2.p1.5.m5.10.10.1.1.3.2.1.cmml">{</mo><mn id="S3.SS2.p1.5.m5.4.4" xref="S3.SS2.p1.5.m5.4.4.cmml">0</mn><mo id="S3.SS2.p1.5.m5.10.10.1.1.3.2.2.2" xref="S3.SS2.p1.5.m5.10.10.1.1.3.2.1.cmml">,</mo><mn id="S3.SS2.p1.5.m5.5.5" xref="S3.SS2.p1.5.m5.5.5.cmml">1</mn><mo id="S3.SS2.p1.5.m5.10.10.1.1.3.2.2.3" stretchy="false" xref="S3.SS2.p1.5.m5.10.10.1.1.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.p1.5.m5.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.2.cmml"><mo id="S3.SS2.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS2.p1.5.m5.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml">𝒟</mi><mo id="S3.SS2.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS2.p1.5.m5.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><mo id="S3.SS2.p1.5.m5.11.11.2.3" xref="S3.SS2.p1.5.m5.11.11.3a.cmml">,</mo><mrow id="S3.SS2.p1.5.m5.11.11.2.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.3.cmml"><mrow id="S3.SS2.p1.5.m5.11.11.2.2.1.1" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.cmml"><msub id="S3.SS2.p1.5.m5.11.11.2.2.1.1.2" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.3" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.5.m5.11.11.2.2.1.1.1" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.cmml"><mrow id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.1.cmml"><mo id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.2.1" stretchy="false" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.1.cmml">{</mo><mn id="S3.SS2.p1.5.m5.6.6" xref="S3.SS2.p1.5.m5.6.6.cmml">0</mn><mo id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.1.cmml">,</mo><mn id="S3.SS2.p1.5.m5.7.7" xref="S3.SS2.p1.5.m5.7.7.cmml">1</mn><mo id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.2.3" stretchy="false" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.p1.5.m5.2.2.1.3" xref="S3.SS2.p1.5.m5.2.2.1.2.cmml"><mo id="S3.SS2.p1.5.m5.2.2.1.3.1" stretchy="false" xref="S3.SS2.p1.5.m5.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.2.2.1.1" xref="S3.SS2.p1.5.m5.2.2.1.1.cmml">𝒫</mi><mo id="S3.SS2.p1.5.m5.2.2.1.3.2" stretchy="false" xref="S3.SS2.p1.5.m5.2.2.1.2.1.cmml">|</mo></mrow></msup></mrow><mo id="S3.SS2.p1.5.m5.11.11.2.2.2.3" xref="S3.SS2.p1.5.m5.11.11.2.2.3a.cmml">,</mo><mrow id="S3.SS2.p1.5.m5.11.11.2.2.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.cmml"><msub id="S3.SS2.p1.5.m5.11.11.2.2.2.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.3" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.5.m5.11.11.2.2.2.2.1" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.1.cmml">∈</mo><msup id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.cmml"><mrow id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.1.cmml"><mo id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.2.1" stretchy="false" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.1.cmml">{</mo><mn id="S3.SS2.p1.5.m5.8.8" xref="S3.SS2.p1.5.m5.8.8.cmml">0</mn><mo id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.2.2" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.1.cmml">,</mo><mn id="S3.SS2.p1.5.m5.9.9" xref="S3.SS2.p1.5.m5.9.9.cmml">1</mn><mo id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.2.3" stretchy="false" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.p1.5.m5.3.3.1.3" xref="S3.SS2.p1.5.m5.3.3.1.2.cmml"><mo id="S3.SS2.p1.5.m5.3.3.1.3.1" stretchy="false" xref="S3.SS2.p1.5.m5.3.3.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.3.3.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.cmml">ℳ</mi><mo id="S3.SS2.p1.5.m5.3.3.1.3.2" stretchy="false" xref="S3.SS2.p1.5.m5.3.3.1.2.1.cmml">|</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.11b"><apply id="S3.SS2.p1.5.m5.11.11.3.cmml" xref="S3.SS2.p1.5.m5.11.11.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.11.11.3a.cmml" xref="S3.SS2.p1.5.m5.11.11.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p1.5.m5.10.10.1.1.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1"><in id="S3.SS2.p1.5.m5.10.10.1.1.1.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.1"></in><apply id="S3.SS2.p1.5.m5.10.10.1.1.2.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.10.10.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.10.10.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.2.2">𝒟</ci><ci id="S3.SS2.p1.5.m5.10.10.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.5.m5.10.10.1.1.3.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.10.10.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.3">superscript</csymbol><set id="S3.SS2.p1.5.m5.10.10.1.1.3.2.1.cmml" xref="S3.SS2.p1.5.m5.10.10.1.1.3.2.2"><cn id="S3.SS2.p1.5.m5.4.4.cmml" type="integer" xref="S3.SS2.p1.5.m5.4.4">0</cn><cn id="S3.SS2.p1.5.m5.5.5.cmml" type="integer" xref="S3.SS2.p1.5.m5.5.5">1</cn></set><apply id="S3.SS2.p1.5.m5.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.3"><abs id="S3.SS2.p1.5.m5.1.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.3.1"></abs><ci id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">𝒟</ci></apply></apply></apply><apply id="S3.SS2.p1.5.m5.11.11.2.2.3.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.11.11.2.2.3a.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p1.5.m5.11.11.2.2.1.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1"><in id="S3.SS2.p1.5.m5.11.11.2.2.1.1.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.1"></in><apply id="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.2">𝒫</ci><ci id="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3">superscript</csymbol><set id="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.1.1.3.2.2"><cn id="S3.SS2.p1.5.m5.6.6.cmml" type="integer" xref="S3.SS2.p1.5.m5.6.6">0</cn><cn id="S3.SS2.p1.5.m5.7.7.cmml" type="integer" xref="S3.SS2.p1.5.m5.7.7">1</cn></set><apply id="S3.SS2.p1.5.m5.2.2.1.2.cmml" xref="S3.SS2.p1.5.m5.2.2.1.3"><abs id="S3.SS2.p1.5.m5.2.2.1.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.3.1"></abs><ci id="S3.SS2.p1.5.m5.2.2.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1">𝒫</ci></apply></apply></apply><apply id="S3.SS2.p1.5.m5.11.11.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2"><in id="S3.SS2.p1.5.m5.11.11.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.1"></in><apply id="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.2">𝒟</ci><ci id="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3">superscript</csymbol><set id="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.1.cmml" xref="S3.SS2.p1.5.m5.11.11.2.2.2.2.3.2.2"><cn id="S3.SS2.p1.5.m5.8.8.cmml" type="integer" xref="S3.SS2.p1.5.m5.8.8">0</cn><cn id="S3.SS2.p1.5.m5.9.9.cmml" type="integer" xref="S3.SS2.p1.5.m5.9.9">1</cn></set><apply id="S3.SS2.p1.5.m5.3.3.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3"><abs id="S3.SS2.p1.5.m5.3.3.1.2.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3.1"></abs><ci id="S3.SS2.p1.5.m5.3.3.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1">ℳ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.11c">\mathcal{D}_{t}\in\{0,1\}^{|\mathcal{D}|},\mathcal{P}_{t}\in\{0,1\}^{|\mathcal%
{P}|},\mathcal{D}_{t}\in\{0,1\}^{|\mathcal{M}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.11d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT | caligraphic_D | end_POSTSUPERSCRIPT , caligraphic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT | caligraphic_P | end_POSTSUPERSCRIPT , caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT</annotation></semantics></math>, all of which are represented using multi-hot encoding. The output of the model is denoted as <math alttext="\hat{\mathcal{M}}_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">ℳ</mi><mo id="S3.SS2.p1.6.m6.1.1.2.1" xref="S3.SS2.p1.6.m6.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"><ci id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.2.1">^</ci><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">ℳ</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\hat{\mathcal{M}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">over^ start_ARG caligraphic_M end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which is the predicted medication combination for the visit <math alttext="v_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">v</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝑣</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">v_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>DDI Matrix</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.4">Drug-Drug interactions are a focal point in the field of medication recommendation, as they indicate that certain medication combinations may pose validated safety risks to patients. By excluding medication combinations with safety risks, adverse events caused by such interactions can be reduced, thereby enhancing the safety of medication therapy. The real-world DDI rate is about 0.06. Our DDI information is extracted from the Adverse Event Reporting Systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib10" title="">10</a>]</cite>. We represent DDI information using a binary matrix <math alttext="{\mathbf{M}^{ddi}}\in\{0,1\}^{|\mathcal{M}|\times|\mathcal{M}|}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.4"><semantics id="S3.SS3.p1.1.m1.4a"><mrow id="S3.SS3.p1.1.m1.4.5" xref="S3.SS3.p1.1.m1.4.5.cmml"><msup id="S3.SS3.p1.1.m1.4.5.2" xref="S3.SS3.p1.1.m1.4.5.2.cmml"><mi id="S3.SS3.p1.1.m1.4.5.2.2" xref="S3.SS3.p1.1.m1.4.5.2.2.cmml">𝐌</mi><mrow id="S3.SS3.p1.1.m1.4.5.2.3" xref="S3.SS3.p1.1.m1.4.5.2.3.cmml"><mi id="S3.SS3.p1.1.m1.4.5.2.3.2" xref="S3.SS3.p1.1.m1.4.5.2.3.2.cmml">d</mi><mo id="S3.SS3.p1.1.m1.4.5.2.3.1" xref="S3.SS3.p1.1.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.1.m1.4.5.2.3.3" xref="S3.SS3.p1.1.m1.4.5.2.3.3.cmml">d</mi><mo id="S3.SS3.p1.1.m1.4.5.2.3.1a" xref="S3.SS3.p1.1.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.1.m1.4.5.2.3.4" xref="S3.SS3.p1.1.m1.4.5.2.3.4.cmml">i</mi></mrow></msup><mo id="S3.SS3.p1.1.m1.4.5.1" xref="S3.SS3.p1.1.m1.4.5.1.cmml">∈</mo><msup id="S3.SS3.p1.1.m1.4.5.3" xref="S3.SS3.p1.1.m1.4.5.3.cmml"><mrow id="S3.SS3.p1.1.m1.4.5.3.2.2" xref="S3.SS3.p1.1.m1.4.5.3.2.1.cmml"><mo id="S3.SS3.p1.1.m1.4.5.3.2.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.4.5.3.2.1.cmml">{</mo><mn id="S3.SS3.p1.1.m1.3.3" xref="S3.SS3.p1.1.m1.3.3.cmml">0</mn><mo id="S3.SS3.p1.1.m1.4.5.3.2.2.2" xref="S3.SS3.p1.1.m1.4.5.3.2.1.cmml">,</mo><mn id="S3.SS3.p1.1.m1.4.4" xref="S3.SS3.p1.1.m1.4.4.cmml">1</mn><mo id="S3.SS3.p1.1.m1.4.5.3.2.2.3" stretchy="false" xref="S3.SS3.p1.1.m1.4.5.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS3.p1.1.m1.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.cmml"><mrow id="S3.SS3.p1.1.m1.2.2.2.4.2" xref="S3.SS3.p1.1.m1.2.2.2.4.1.cmml"><mo id="S3.SS3.p1.1.m1.2.2.2.4.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">ℳ</mi><mo id="S3.SS3.p1.1.m1.2.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.2.4.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.1.m1.2.2.2.3" rspace="0.222em" xref="S3.SS3.p1.1.m1.2.2.2.3.cmml">×</mo><mrow id="S3.SS3.p1.1.m1.2.2.2.5.2" xref="S3.SS3.p1.1.m1.2.2.2.5.1.cmml"><mo id="S3.SS3.p1.1.m1.2.2.2.5.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.2.5.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.cmml">ℳ</mi><mo id="S3.SS3.p1.1.m1.2.2.2.5.2.2" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.2.5.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><apply id="S3.SS3.p1.1.m1.4.5.cmml" xref="S3.SS3.p1.1.m1.4.5"><in id="S3.SS3.p1.1.m1.4.5.1.cmml" xref="S3.SS3.p1.1.m1.4.5.1"></in><apply id="S3.SS3.p1.1.m1.4.5.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.5.2.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.4.5.2.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.2">𝐌</ci><apply id="S3.SS3.p1.1.m1.4.5.2.3.cmml" xref="S3.SS3.p1.1.m1.4.5.2.3"><times id="S3.SS3.p1.1.m1.4.5.2.3.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2.3.1"></times><ci id="S3.SS3.p1.1.m1.4.5.2.3.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.3.2">𝑑</ci><ci id="S3.SS3.p1.1.m1.4.5.2.3.3.cmml" xref="S3.SS3.p1.1.m1.4.5.2.3.3">𝑑</ci><ci id="S3.SS3.p1.1.m1.4.5.2.3.4.cmml" xref="S3.SS3.p1.1.m1.4.5.2.3.4">𝑖</ci></apply></apply><apply id="S3.SS3.p1.1.m1.4.5.3.cmml" xref="S3.SS3.p1.1.m1.4.5.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.5.3.1.cmml" xref="S3.SS3.p1.1.m1.4.5.3">superscript</csymbol><set id="S3.SS3.p1.1.m1.4.5.3.2.1.cmml" xref="S3.SS3.p1.1.m1.4.5.3.2.2"><cn id="S3.SS3.p1.1.m1.3.3.cmml" type="integer" xref="S3.SS3.p1.1.m1.3.3">0</cn><cn id="S3.SS3.p1.1.m1.4.4.cmml" type="integer" xref="S3.SS3.p1.1.m1.4.4">1</cn></set><apply id="S3.SS3.p1.1.m1.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2"><times id="S3.SS3.p1.1.m1.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.2.3"></times><apply id="S3.SS3.p1.1.m1.2.2.2.4.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.4.2"><abs id="S3.SS3.p1.1.m1.2.2.2.4.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.4.2.1"></abs><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">ℳ</ci></apply><apply id="S3.SS3.p1.1.m1.2.2.2.5.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.5.2"><abs id="S3.SS3.p1.1.m1.2.2.2.5.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.5.2.1"></abs><ci id="S3.SS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">{\mathbf{M}^{ddi}}\in\{0,1\}^{|\mathcal{M}|\times|\mathcal{M}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.4d">bold_M start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT | caligraphic_M | × | caligraphic_M | end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\mathbf{M}^{ddi}_{ij}=1" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><msubsup id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.2.cmml">𝐌</mi><mrow id="S3.SS3.p1.2.m2.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.3.2" xref="S3.SS3.p1.2.m2.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p1.2.m2.1.1.2.3.1" xref="S3.SS3.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.2.3.3" xref="S3.SS3.p1.2.m2.1.1.2.3.3.cmml">j</mi></mrow><mrow id="S3.SS3.p1.2.m2.1.1.2.2.3" xref="S3.SS3.p1.2.m2.1.1.2.2.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2.3.2" xref="S3.SS3.p1.2.m2.1.1.2.2.3.2.cmml">d</mi><mo id="S3.SS3.p1.2.m2.1.1.2.2.3.1" xref="S3.SS3.p1.2.m2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.2.2.3.3" xref="S3.SS3.p1.2.m2.1.1.2.2.3.3.cmml">d</mi><mo id="S3.SS3.p1.2.m2.1.1.2.2.3.1a" xref="S3.SS3.p1.2.m2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.2.2.3.4" xref="S3.SS3.p1.2.m2.1.1.2.2.3.4.cmml">i</mi></mrow></msubsup><mo id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><eq id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"></eq><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2">subscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.2">𝐌</ci><apply id="S3.SS3.p1.2.m2.1.1.2.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.3"><times id="S3.SS3.p1.2.m2.1.1.2.2.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.3.1"></times><ci id="S3.SS3.p1.2.m2.1.1.2.2.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.3.2">𝑑</ci><ci id="S3.SS3.p1.2.m2.1.1.2.2.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.3.3">𝑑</ci><ci id="S3.SS3.p1.2.m2.1.1.2.2.3.4.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.3.4">𝑖</ci></apply></apply><apply id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3"><times id="S3.SS3.p1.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3.1"></times><ci id="S3.SS3.p1.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p1.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3.3">𝑗</ci></apply></apply><cn id="S3.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathbf{M}^{ddi}_{ij}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">bold_M start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math> indicates the presence of an interaction between <math alttext="m_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">m</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑚</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">m_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="m_{j}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">m</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑚</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">m_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. A high frequency of DDI suggests potential safety issues in recommended results.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methods</h2>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="544" id="S4.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">The pre-training phase illustrated in the bottom left side of the figure demonstrates the pre-training fusion process of bimodal molecular structures, and its results are applied to the downstream tasks shown in the top left side. The molecular multi-enhancement phase in the top left side explains how molecular knowledge interacts with patient representations at the visit level, dynamically enhancing substructures at the granularity of a single visit. The trajectory fusion phase on the right side of the figure models the sequence relationships of the interaction results and maps them to recommendation probabilities, obtaining the final recommendation results.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S4.F2" title="Figure 2 ‣ 4 Methods ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates our model, which is comprised of four main components.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">(1) In the pre-training stage, by integrating the structural information of molecular bimodal, utilizing contrastive learning, we can obtain the molecular encoding module fused with bimodal structural knowledge, and the substructure encoding module. It can also be understood as learning from the 3D modal teacher model to inject knowledge into the 2D modal model.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">(2) In the molecular multiple enhancement phase, our goal is to obtain the patient’s single-visit representation from clinical records and encode the medication molecules and their substructures using the encoder obtained from the pre-training phase. By interacting molecular knowledge with the patient representation, we enhance and re-evaluate the representations of the molecules and their substructures. Finally, we further enhance the combinations of substructures at different time points based on the patient’s current visit status.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">(3) In the medication evolution trajectory fusion stage, our objective is to integrate the enhanced substructure representations from different time sequences to obtain the sequential relationships of multiple recommendation results. Subsequently, based on the results of the multi-sequence environment integration, we adjust the probability bias of each medication according to the patient’s current health condition, thereby recommending medications that exceed the preset threshold.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Pre-training</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In this phase, our aim is to integrate the bimodal structure of molecules, which involves the representation of 2D and 3D structures as well as mutual information learning.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">In terms of embedding representations, 2D modal data utilizes Graph Neural Networks (GNN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib40" title="">40</a>]</cite> to encode the molecular structure of drugs and obtain holistic-level representations. GNN iteratively updates node features by aggregating features of neighboring nodes, i.e., updating representations of atomic nodes through specific aggregation strategies. In general, we have:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx1">
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{a}^{(k)}(u)=\mathrm{AGG}^{(k)}\left(\left\{\mathbf{f}_{n}%
^{(k-1)}(v),\mathbf{f}_{e}(u,v)|v\in\mathcal{N}(u)\right\}\right)," class="ltx_Math" display="block" id="S4.E1.m1.9"><semantics id="S4.E1.m1.9a"><mrow id="S4.E1.m1.9.9.1" xref="S4.E1.m1.9.9.1.1.cmml"><mrow id="S4.E1.m1.9.9.1.1" xref="S4.E1.m1.9.9.1.1.cmml"><mrow id="S4.E1.m1.9.9.1.1.3" xref="S4.E1.m1.9.9.1.1.3.cmml"><msup id="S4.E1.m1.9.9.1.1.3.2" xref="S4.E1.m1.9.9.1.1.3.2.cmml"><mi id="S4.E1.m1.9.9.1.1.3.2.2" xref="S4.E1.m1.9.9.1.1.3.2.2.cmml">𝐚</mi><mrow id="S4.E1.m1.1.1.1.3" xref="S4.E1.m1.9.9.1.1.3.2.cmml"><mo id="S4.E1.m1.1.1.1.3.1" stretchy="false" xref="S4.E1.m1.9.9.1.1.3.2.cmml">(</mo><mi id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml">k</mi><mo id="S4.E1.m1.1.1.1.3.2" stretchy="false" xref="S4.E1.m1.9.9.1.1.3.2.cmml">)</mo></mrow></msup><mo id="S4.E1.m1.9.9.1.1.3.1" xref="S4.E1.m1.9.9.1.1.3.1.cmml">⁢</mo><mrow id="S4.E1.m1.9.9.1.1.3.3.2" xref="S4.E1.m1.9.9.1.1.3.cmml"><mo id="S4.E1.m1.9.9.1.1.3.3.2.1" stretchy="false" xref="S4.E1.m1.9.9.1.1.3.cmml">(</mo><mi id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml">u</mi><mo id="S4.E1.m1.9.9.1.1.3.3.2.2" stretchy="false" xref="S4.E1.m1.9.9.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.9.9.1.1.2" xref="S4.E1.m1.9.9.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.9.9.1.1.1" xref="S4.E1.m1.9.9.1.1.1.cmml"><msup id="S4.E1.m1.9.9.1.1.1.3" xref="S4.E1.m1.9.9.1.1.1.3.cmml"><mi id="S4.E1.m1.9.9.1.1.1.3.2" xref="S4.E1.m1.9.9.1.1.1.3.2.cmml">AGG</mi><mrow id="S4.E1.m1.2.2.1.3" xref="S4.E1.m1.9.9.1.1.1.3.cmml"><mo id="S4.E1.m1.2.2.1.3.1" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.3.cmml">(</mo><mi id="S4.E1.m1.2.2.1.1" xref="S4.E1.m1.2.2.1.1.cmml">k</mi><mo id="S4.E1.m1.2.2.1.3.2" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.3.cmml">)</mo></mrow></msup><mo id="S4.E1.m1.9.9.1.1.1.2" xref="S4.E1.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1" xref="S4.E1.m1.9.9.1.1.1.cmml"><mo id="S4.E1.m1.9.9.1.1.1.1.1.2" xref="S4.E1.m1.9.9.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.3.cmml"><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.2.3" xref="S4.E1.m1.9.9.1.1.1.1.1.1.3.1.cmml">{</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐟</mi><mi id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">n</mi><mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.1.cmml"><mo id="S4.E1.m1.3.3.1.1.2" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.3.3.1.1.1" xref="S4.E1.m1.3.3.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.2.cmml">k</mi><mo id="S4.E1.m1.3.3.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E1.m1.3.3.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E1.m1.3.3.1.1.3" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E1.m1.5.5" xref="S4.E1.m1.5.5.cmml">v</mi><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">,</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml"><msub id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐟</mi><mi id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3.cmml">e</mi></msub><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.1.cmml"><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.2.1" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.1.cmml">(</mo><mi id="S4.E1.m1.6.6" xref="S4.E1.m1.6.6.cmml">u</mi><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.2.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.1.cmml">,</mo><mi id="S4.E1.m1.7.7" xref="S4.E1.m1.7.7.cmml">v</mi><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.2.3" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.2.4" lspace="0em" rspace="0em" xref="S4.E1.m1.9.9.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.2.cmml">v</mi><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.1" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.1.cmml">∈</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.2.cmml">𝒩</mi><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.1" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mrow id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.3.2" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.3.2.1" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.cmml">(</mo><mi id="S4.E1.m1.8.8" xref="S4.E1.m1.8.8.cmml">u</mi><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.3.2.2" stretchy="false" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.9.9.1.1.1.1.1.1.2.5" xref="S4.E1.m1.9.9.1.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S4.E1.m1.9.9.1.1.1.1.1.3" xref="S4.E1.m1.9.9.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.9.9.1.2" xref="S4.E1.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.9b"><apply id="S4.E1.m1.9.9.1.1.cmml" xref="S4.E1.m1.9.9.1"><eq id="S4.E1.m1.9.9.1.1.2.cmml" xref="S4.E1.m1.9.9.1.1.2"></eq><apply id="S4.E1.m1.9.9.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.3"><times id="S4.E1.m1.9.9.1.1.3.1.cmml" xref="S4.E1.m1.9.9.1.1.3.1"></times><apply id="S4.E1.m1.9.9.1.1.3.2.cmml" xref="S4.E1.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.3.2.1.cmml" xref="S4.E1.m1.9.9.1.1.3.2">superscript</csymbol><ci id="S4.E1.m1.9.9.1.1.3.2.2.cmml" xref="S4.E1.m1.9.9.1.1.3.2.2">𝐚</ci><ci id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1">𝑘</ci></apply><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">𝑢</ci></apply><apply id="S4.E1.m1.9.9.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.1"><times id="S4.E1.m1.9.9.1.1.1.2.cmml" xref="S4.E1.m1.9.9.1.1.1.2"></times><apply id="S4.E1.m1.9.9.1.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.1.3.1.cmml" xref="S4.E1.m1.9.9.1.1.1.3">superscript</csymbol><ci id="S4.E1.m1.9.9.1.1.1.3.2.cmml" xref="S4.E1.m1.9.9.1.1.1.3.2">AGG</ci><ci id="S4.E1.m1.2.2.1.1.cmml" xref="S4.E1.m1.2.2.1.1">𝑘</ci></apply><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.E1.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.3">conditional-set</csymbol><list id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2"><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1"><times id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐟</ci><ci id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑛</ci></apply><apply id="S4.E1.m1.3.3.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1"><minus id="S4.E1.m1.3.3.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1"></minus><ci id="S4.E1.m1.3.3.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2">𝑘</ci><cn id="S4.E1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.E1.m1.3.3.1.1.1.3">1</cn></apply></apply><ci id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5">𝑣</ci></apply><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2"><times id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.1"></times><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.2">𝐟</ci><ci id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.2.3">𝑒</ci></apply><interval closure="open" id="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.1.1.2.2.3.2"><ci id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6">𝑢</ci><ci id="S4.E1.m1.7.7.cmml" xref="S4.E1.m1.7.7">𝑣</ci></interval></apply></list><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2"><in id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.1"></in><ci id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.2">𝑣</ci><apply id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3"><times id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.1"></times><ci id="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E1.m1.9.9.1.1.1.1.1.1.2.2.3.2">𝒩</ci><ci id="S4.E1.m1.8.8.cmml" xref="S4.E1.m1.8.8">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.9c">\displaystyle\mathbf{a}^{(k)}(u)=\mathrm{AGG}^{(k)}\left(\left\{\mathbf{f}_{n}%
^{(k-1)}(v),\mathbf{f}_{e}(u,v)|v\in\mathcal{N}(u)\right\}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.9d">bold_a start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( italic_u ) = roman_AGG start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( { bold_f start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k - 1 ) end_POSTSUPERSCRIPT ( italic_v ) , bold_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_u , italic_v ) | italic_v ∈ caligraphic_N ( italic_u ) } ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{f}_{n}^{(k)}(u)=\mathrm{COMBINE}^{(k)}\left(\mathbf{a}^{(%
k)}(u),\mathbf{f}_{n}^{(k-1)}(u)\right)," class="ltx_Math" display="block" id="S4.E2.m1.8"><semantics id="S4.E2.m1.8a"><mrow id="S4.E2.m1.8.8.1" xref="S4.E2.m1.8.8.1.1.cmml"><mrow id="S4.E2.m1.8.8.1.1" xref="S4.E2.m1.8.8.1.1.cmml"><mrow id="S4.E2.m1.8.8.1.1.4" xref="S4.E2.m1.8.8.1.1.4.cmml"><msubsup id="S4.E2.m1.8.8.1.1.4.2" xref="S4.E2.m1.8.8.1.1.4.2.cmml"><mi id="S4.E2.m1.8.8.1.1.4.2.2.2" xref="S4.E2.m1.8.8.1.1.4.2.2.2.cmml">𝐟</mi><mi id="S4.E2.m1.8.8.1.1.4.2.2.3" xref="S4.E2.m1.8.8.1.1.4.2.2.3.cmml">n</mi><mrow id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.8.8.1.1.4.2.cmml"><mo id="S4.E2.m1.1.1.1.3.1" stretchy="false" xref="S4.E2.m1.8.8.1.1.4.2.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">k</mi><mo id="S4.E2.m1.1.1.1.3.2" stretchy="false" xref="S4.E2.m1.8.8.1.1.4.2.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.8.8.1.1.4.1" xref="S4.E2.m1.8.8.1.1.4.1.cmml">⁢</mo><mrow id="S4.E2.m1.8.8.1.1.4.3.2" xref="S4.E2.m1.8.8.1.1.4.cmml"><mo id="S4.E2.m1.8.8.1.1.4.3.2.1" stretchy="false" xref="S4.E2.m1.8.8.1.1.4.cmml">(</mo><mi id="S4.E2.m1.5.5" xref="S4.E2.m1.5.5.cmml">u</mi><mo id="S4.E2.m1.8.8.1.1.4.3.2.2" stretchy="false" xref="S4.E2.m1.8.8.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.8.8.1.1.3" xref="S4.E2.m1.8.8.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.8.8.1.1.2" xref="S4.E2.m1.8.8.1.1.2.cmml"><msup id="S4.E2.m1.8.8.1.1.2.4" xref="S4.E2.m1.8.8.1.1.2.4.cmml"><mi id="S4.E2.m1.8.8.1.1.2.4.2" xref="S4.E2.m1.8.8.1.1.2.4.2.cmml">COMBINE</mi><mrow id="S4.E2.m1.2.2.1.3" xref="S4.E2.m1.8.8.1.1.2.4.cmml"><mo id="S4.E2.m1.2.2.1.3.1" stretchy="false" xref="S4.E2.m1.8.8.1.1.2.4.cmml">(</mo><mi id="S4.E2.m1.2.2.1.1" xref="S4.E2.m1.2.2.1.1.cmml">k</mi><mo id="S4.E2.m1.2.2.1.3.2" stretchy="false" xref="S4.E2.m1.8.8.1.1.2.4.cmml">)</mo></mrow></msup><mo id="S4.E2.m1.8.8.1.1.2.3" xref="S4.E2.m1.8.8.1.1.2.3.cmml">⁢</mo><mrow id="S4.E2.m1.8.8.1.1.2.2.2" xref="S4.E2.m1.8.8.1.1.2.2.3.cmml"><mo id="S4.E2.m1.8.8.1.1.2.2.2.3" xref="S4.E2.m1.8.8.1.1.2.2.3.cmml">(</mo><mrow id="S4.E2.m1.8.8.1.1.1.1.1.1" xref="S4.E2.m1.8.8.1.1.1.1.1.1.cmml"><msup id="S4.E2.m1.8.8.1.1.1.1.1.1.2" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.8.8.1.1.1.1.1.1.2.2" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2.2.cmml">𝐚</mi><mrow id="S4.E2.m1.3.3.1.3" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.3.3.1.3.1" stretchy="false" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml">k</mi><mo id="S4.E2.m1.3.3.1.3.2" stretchy="false" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S4.E2.m1.8.8.1.1.1.1.1.1.1" xref="S4.E2.m1.8.8.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E2.m1.8.8.1.1.1.1.1.1.3.2" xref="S4.E2.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.8.8.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E2.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E2.m1.6.6" xref="S4.E2.m1.6.6.cmml">u</mi><mo id="S4.E2.m1.8.8.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E2.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.8.8.1.1.2.2.2.4" xref="S4.E2.m1.8.8.1.1.2.2.3.cmml">,</mo><mrow id="S4.E2.m1.8.8.1.1.2.2.2.2" xref="S4.E2.m1.8.8.1.1.2.2.2.2.cmml"><msubsup id="S4.E2.m1.8.8.1.1.2.2.2.2.2" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2.cmml"><mi id="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.2" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.2.cmml">𝐟</mi><mi id="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.3" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.3.cmml">n</mi><mrow id="S4.E2.m1.4.4.1.1" xref="S4.E2.m1.4.4.1.1.1.cmml"><mo id="S4.E2.m1.4.4.1.1.2" stretchy="false" xref="S4.E2.m1.4.4.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.4.4.1.1.1" xref="S4.E2.m1.4.4.1.1.1.cmml"><mi id="S4.E2.m1.4.4.1.1.1.2" xref="S4.E2.m1.4.4.1.1.1.2.cmml">k</mi><mo id="S4.E2.m1.4.4.1.1.1.1" xref="S4.E2.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S4.E2.m1.4.4.1.1.1.3" xref="S4.E2.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E2.m1.4.4.1.1.3" stretchy="false" xref="S4.E2.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.8.8.1.1.2.2.2.2.1" xref="S4.E2.m1.8.8.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.E2.m1.8.8.1.1.2.2.2.2.3.2" xref="S4.E2.m1.8.8.1.1.2.2.2.2.cmml"><mo id="S4.E2.m1.8.8.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S4.E2.m1.8.8.1.1.2.2.2.2.cmml">(</mo><mi id="S4.E2.m1.7.7" xref="S4.E2.m1.7.7.cmml">u</mi><mo id="S4.E2.m1.8.8.1.1.2.2.2.2.3.2.2" stretchy="false" xref="S4.E2.m1.8.8.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.8.8.1.1.2.2.2.5" xref="S4.E2.m1.8.8.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.8.8.1.2" xref="S4.E2.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.8b"><apply id="S4.E2.m1.8.8.1.1.cmml" xref="S4.E2.m1.8.8.1"><eq id="S4.E2.m1.8.8.1.1.3.cmml" xref="S4.E2.m1.8.8.1.1.3"></eq><apply id="S4.E2.m1.8.8.1.1.4.cmml" xref="S4.E2.m1.8.8.1.1.4"><times id="S4.E2.m1.8.8.1.1.4.1.cmml" xref="S4.E2.m1.8.8.1.1.4.1"></times><apply id="S4.E2.m1.8.8.1.1.4.2.cmml" xref="S4.E2.m1.8.8.1.1.4.2"><csymbol cd="ambiguous" id="S4.E2.m1.8.8.1.1.4.2.1.cmml" xref="S4.E2.m1.8.8.1.1.4.2">superscript</csymbol><apply id="S4.E2.m1.8.8.1.1.4.2.2.cmml" xref="S4.E2.m1.8.8.1.1.4.2"><csymbol cd="ambiguous" id="S4.E2.m1.8.8.1.1.4.2.2.1.cmml" xref="S4.E2.m1.8.8.1.1.4.2">subscript</csymbol><ci id="S4.E2.m1.8.8.1.1.4.2.2.2.cmml" xref="S4.E2.m1.8.8.1.1.4.2.2.2">𝐟</ci><ci id="S4.E2.m1.8.8.1.1.4.2.2.3.cmml" xref="S4.E2.m1.8.8.1.1.4.2.2.3">𝑛</ci></apply><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑘</ci></apply><ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">𝑢</ci></apply><apply id="S4.E2.m1.8.8.1.1.2.cmml" xref="S4.E2.m1.8.8.1.1.2"><times id="S4.E2.m1.8.8.1.1.2.3.cmml" xref="S4.E2.m1.8.8.1.1.2.3"></times><apply id="S4.E2.m1.8.8.1.1.2.4.cmml" xref="S4.E2.m1.8.8.1.1.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.8.8.1.1.2.4.1.cmml" xref="S4.E2.m1.8.8.1.1.2.4">superscript</csymbol><ci id="S4.E2.m1.8.8.1.1.2.4.2.cmml" xref="S4.E2.m1.8.8.1.1.2.4.2">COMBINE</ci><ci id="S4.E2.m1.2.2.1.1.cmml" xref="S4.E2.m1.2.2.1.1">𝑘</ci></apply><interval closure="open" id="S4.E2.m1.8.8.1.1.2.2.3.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2"><apply id="S4.E2.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E2.m1.8.8.1.1.1.1.1.1"><times id="S4.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.8.8.1.1.1.1.1.1.1"></times><apply id="S4.E2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E2.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.8.8.1.1.1.1.1.1.2.2">𝐚</ci><ci id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">𝑘</ci></apply><ci id="S4.E2.m1.6.6.cmml" xref="S4.E2.m1.6.6">𝑢</ci></apply><apply id="S4.E2.m1.8.8.1.1.2.2.2.2.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2"><times id="S4.E2.m1.8.8.1.1.2.2.2.2.1.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2.1"></times><apply id="S4.E2.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.8.8.1.1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2">superscript</csymbol><apply id="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.2">𝐟</ci><ci id="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E2.m1.8.8.1.1.2.2.2.2.2.2.3">𝑛</ci></apply><apply id="S4.E2.m1.4.4.1.1.1.cmml" xref="S4.E2.m1.4.4.1.1"><minus id="S4.E2.m1.4.4.1.1.1.1.cmml" xref="S4.E2.m1.4.4.1.1.1.1"></minus><ci id="S4.E2.m1.4.4.1.1.1.2.cmml" xref="S4.E2.m1.4.4.1.1.1.2">𝑘</ci><cn id="S4.E2.m1.4.4.1.1.1.3.cmml" type="integer" xref="S4.E2.m1.4.4.1.1.1.3">1</cn></apply></apply><ci id="S4.E2.m1.7.7.cmml" xref="S4.E2.m1.7.7">𝑢</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.8c">\displaystyle\mathbf{f}_{n}^{(k)}(u)=\mathrm{COMBINE}^{(k)}\left(\mathbf{a}^{(%
k)}(u),\mathbf{f}_{n}^{(k-1)}(u)\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.8d">bold_f start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( italic_u ) = roman_COMBINE start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( bold_a start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( italic_u ) , bold_f start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k - 1 ) end_POSTSUPERSCRIPT ( italic_u ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.10">where <math alttext="\mathbf{f}_{n}^{(k)}(u)" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.2"><semantics id="S4.SS1.p3.1.m1.2a"><mrow id="S4.SS1.p3.1.m1.2.3" xref="S4.SS1.p3.1.m1.2.3.cmml"><msubsup id="S4.SS1.p3.1.m1.2.3.2" xref="S4.SS1.p3.1.m1.2.3.2.cmml"><mi id="S4.SS1.p3.1.m1.2.3.2.2.2" xref="S4.SS1.p3.1.m1.2.3.2.2.2.cmml">𝐟</mi><mi id="S4.SS1.p3.1.m1.2.3.2.2.3" xref="S4.SS1.p3.1.m1.2.3.2.2.3.cmml">n</mi><mrow id="S4.SS1.p3.1.m1.1.1.1.3" xref="S4.SS1.p3.1.m1.2.3.2.cmml"><mo id="S4.SS1.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS1.p3.1.m1.2.3.2.cmml">(</mo><mi id="S4.SS1.p3.1.m1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml">k</mi><mo id="S4.SS1.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS1.p3.1.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p3.1.m1.2.3.1" xref="S4.SS1.p3.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p3.1.m1.2.3.3.2" xref="S4.SS1.p3.1.m1.2.3.cmml"><mo id="S4.SS1.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS1.p3.1.m1.2.3.cmml">(</mo><mi id="S4.SS1.p3.1.m1.2.2" xref="S4.SS1.p3.1.m1.2.2.cmml">u</mi><mo id="S4.SS1.p3.1.m1.2.3.3.2.2" stretchy="false" xref="S4.SS1.p3.1.m1.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><apply id="S4.SS1.p3.1.m1.2.3.cmml" xref="S4.SS1.p3.1.m1.2.3"><times id="S4.SS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.1"></times><apply id="S4.SS1.p3.1.m1.2.3.2.cmml" xref="S4.SS1.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.2.3.2.1.cmml" xref="S4.SS1.p3.1.m1.2.3.2">superscript</csymbol><apply id="S4.SS1.p3.1.m1.2.3.2.2.cmml" xref="S4.SS1.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.2.3.2.2.1.cmml" xref="S4.SS1.p3.1.m1.2.3.2">subscript</csymbol><ci id="S4.SS1.p3.1.m1.2.3.2.2.2.cmml" xref="S4.SS1.p3.1.m1.2.3.2.2.2">𝐟</ci><ci id="S4.SS1.p3.1.m1.2.3.2.2.3.cmml" xref="S4.SS1.p3.1.m1.2.3.2.2.3">𝑛</ci></apply><ci id="S4.SS1.p3.1.m1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1">𝑘</ci></apply><ci id="S4.SS1.p3.1.m1.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">\mathbf{f}_{n}^{(k)}(u)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.2d">bold_f start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( italic_u )</annotation></semantics></math> is the node feature of node <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_u</annotation></semantics></math> in the <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_k</annotation></semantics></math>-th layer, <math alttext="\mathbf{f}_{n}^{(0)}(u)" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.2"><semantics id="S4.SS1.p3.4.m4.2a"><mrow id="S4.SS1.p3.4.m4.2.3" xref="S4.SS1.p3.4.m4.2.3.cmml"><msubsup id="S4.SS1.p3.4.m4.2.3.2" xref="S4.SS1.p3.4.m4.2.3.2.cmml"><mi id="S4.SS1.p3.4.m4.2.3.2.2.2" xref="S4.SS1.p3.4.m4.2.3.2.2.2.cmml">𝐟</mi><mi id="S4.SS1.p3.4.m4.2.3.2.2.3" xref="S4.SS1.p3.4.m4.2.3.2.2.3.cmml">n</mi><mrow id="S4.SS1.p3.4.m4.1.1.1.3" xref="S4.SS1.p3.4.m4.2.3.2.cmml"><mo id="S4.SS1.p3.4.m4.1.1.1.3.1" stretchy="false" xref="S4.SS1.p3.4.m4.2.3.2.cmml">(</mo><mn id="S4.SS1.p3.4.m4.1.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.1.cmml">0</mn><mo id="S4.SS1.p3.4.m4.1.1.1.3.2" stretchy="false" xref="S4.SS1.p3.4.m4.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p3.4.m4.2.3.1" xref="S4.SS1.p3.4.m4.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p3.4.m4.2.3.3.2" xref="S4.SS1.p3.4.m4.2.3.cmml"><mo id="S4.SS1.p3.4.m4.2.3.3.2.1" stretchy="false" xref="S4.SS1.p3.4.m4.2.3.cmml">(</mo><mi id="S4.SS1.p3.4.m4.2.2" xref="S4.SS1.p3.4.m4.2.2.cmml">u</mi><mo id="S4.SS1.p3.4.m4.2.3.3.2.2" stretchy="false" xref="S4.SS1.p3.4.m4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.2b"><apply id="S4.SS1.p3.4.m4.2.3.cmml" xref="S4.SS1.p3.4.m4.2.3"><times id="S4.SS1.p3.4.m4.2.3.1.cmml" xref="S4.SS1.p3.4.m4.2.3.1"></times><apply id="S4.SS1.p3.4.m4.2.3.2.cmml" xref="S4.SS1.p3.4.m4.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.3.2.1.cmml" xref="S4.SS1.p3.4.m4.2.3.2">superscript</csymbol><apply id="S4.SS1.p3.4.m4.2.3.2.2.cmml" xref="S4.SS1.p3.4.m4.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.3.2.2.1.cmml" xref="S4.SS1.p3.4.m4.2.3.2">subscript</csymbol><ci id="S4.SS1.p3.4.m4.2.3.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.3.2.2.2">𝐟</ci><ci id="S4.SS1.p3.4.m4.2.3.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.3.2.2.3">𝑛</ci></apply><cn id="S4.SS1.p3.4.m4.1.1.1.1.cmml" type="integer" xref="S4.SS1.p3.4.m4.1.1.1.1">0</cn></apply><ci id="S4.SS1.p3.4.m4.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.2c">\mathbf{f}_{n}^{(0)}(u)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.2d">bold_f start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT ( italic_u )</annotation></semantics></math> is the initial feature of node <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><mi id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><ci id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_u</annotation></semantics></math>, <math alttext="\mathbf{f}_{e}(u,v)" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.2"><semantics id="S4.SS1.p3.6.m6.2a"><mrow id="S4.SS1.p3.6.m6.2.3" xref="S4.SS1.p3.6.m6.2.3.cmml"><msub id="S4.SS1.p3.6.m6.2.3.2" xref="S4.SS1.p3.6.m6.2.3.2.cmml"><mi id="S4.SS1.p3.6.m6.2.3.2.2" xref="S4.SS1.p3.6.m6.2.3.2.2.cmml">𝐟</mi><mi id="S4.SS1.p3.6.m6.2.3.2.3" xref="S4.SS1.p3.6.m6.2.3.2.3.cmml">e</mi></msub><mo id="S4.SS1.p3.6.m6.2.3.1" xref="S4.SS1.p3.6.m6.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p3.6.m6.2.3.3.2" xref="S4.SS1.p3.6.m6.2.3.3.1.cmml"><mo id="S4.SS1.p3.6.m6.2.3.3.2.1" stretchy="false" xref="S4.SS1.p3.6.m6.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">u</mi><mo id="S4.SS1.p3.6.m6.2.3.3.2.2" xref="S4.SS1.p3.6.m6.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p3.6.m6.2.2" xref="S4.SS1.p3.6.m6.2.2.cmml">v</mi><mo id="S4.SS1.p3.6.m6.2.3.3.2.3" stretchy="false" xref="S4.SS1.p3.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.2b"><apply id="S4.SS1.p3.6.m6.2.3.cmml" xref="S4.SS1.p3.6.m6.2.3"><times id="S4.SS1.p3.6.m6.2.3.1.cmml" xref="S4.SS1.p3.6.m6.2.3.1"></times><apply id="S4.SS1.p3.6.m6.2.3.2.cmml" xref="S4.SS1.p3.6.m6.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.2.3.2.1.cmml" xref="S4.SS1.p3.6.m6.2.3.2">subscript</csymbol><ci id="S4.SS1.p3.6.m6.2.3.2.2.cmml" xref="S4.SS1.p3.6.m6.2.3.2.2">𝐟</ci><ci id="S4.SS1.p3.6.m6.2.3.2.3.cmml" xref="S4.SS1.p3.6.m6.2.3.2.3">𝑒</ci></apply><interval closure="open" id="S4.SS1.p3.6.m6.2.3.3.1.cmml" xref="S4.SS1.p3.6.m6.2.3.3.2"><ci id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">𝑢</ci><ci id="S4.SS1.p3.6.m6.2.2.cmml" xref="S4.SS1.p3.6.m6.2.2">𝑣</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.2c">\mathbf{f}_{e}(u,v)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.2d">bold_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_u , italic_v )</annotation></semantics></math> is the edge feature of edge <math alttext="(u,v)" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.2"><semantics id="S4.SS1.p3.7.m7.2a"><mrow id="S4.SS1.p3.7.m7.2.3.2" xref="S4.SS1.p3.7.m7.2.3.1.cmml"><mo id="S4.SS1.p3.7.m7.2.3.2.1" stretchy="false" xref="S4.SS1.p3.7.m7.2.3.1.cmml">(</mo><mi id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml">u</mi><mo id="S4.SS1.p3.7.m7.2.3.2.2" xref="S4.SS1.p3.7.m7.2.3.1.cmml">,</mo><mi id="S4.SS1.p3.7.m7.2.2" xref="S4.SS1.p3.7.m7.2.2.cmml">v</mi><mo id="S4.SS1.p3.7.m7.2.3.2.3" stretchy="false" xref="S4.SS1.p3.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.2b"><interval closure="open" id="S4.SS1.p3.7.m7.2.3.1.cmml" xref="S4.SS1.p3.7.m7.2.3.2"><ci id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">𝑢</ci><ci id="S4.SS1.p3.7.m7.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2">𝑣</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.2c">(u,v)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.2d">( italic_u , italic_v )</annotation></semantics></math>, and <math alttext="\mathcal{N}(u)" class="ltx_Math" display="inline" id="S4.SS1.p3.8.m8.1"><semantics id="S4.SS1.p3.8.m8.1a"><mrow id="S4.SS1.p3.8.m8.1.2" xref="S4.SS1.p3.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.8.m8.1.2.2" xref="S4.SS1.p3.8.m8.1.2.2.cmml">𝒩</mi><mo id="S4.SS1.p3.8.m8.1.2.1" xref="S4.SS1.p3.8.m8.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.8.m8.1.2.3.2" xref="S4.SS1.p3.8.m8.1.2.cmml"><mo id="S4.SS1.p3.8.m8.1.2.3.2.1" stretchy="false" xref="S4.SS1.p3.8.m8.1.2.cmml">(</mo><mi id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml">u</mi><mo id="S4.SS1.p3.8.m8.1.2.3.2.2" stretchy="false" xref="S4.SS1.p3.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><apply id="S4.SS1.p3.8.m8.1.2.cmml" xref="S4.SS1.p3.8.m8.1.2"><times id="S4.SS1.p3.8.m8.1.2.1.cmml" xref="S4.SS1.p3.8.m8.1.2.1"></times><ci id="S4.SS1.p3.8.m8.1.2.2.cmml" xref="S4.SS1.p3.8.m8.1.2.2">𝒩</ci><ci id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">\mathcal{N}(u)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.8.m8.1d">caligraphic_N ( italic_u )</annotation></semantics></math> denotes the neighbor of node <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p3.9.m9.1"><semantics id="S4.SS1.p3.9.m9.1a"><mi id="S4.SS1.p3.9.m9.1.1" xref="S4.SS1.p3.9.m9.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m9.1b"><ci id="S4.SS1.p3.9.m9.1.1.cmml" xref="S4.SS1.p3.9.m9.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m9.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.9.m9.1d">italic_u</annotation></semantics></math> on the graph. <math alttext="\mathrm{COMBINE}" class="ltx_Math" display="inline" id="S4.SS1.p3.10.m10.1"><semantics id="S4.SS1.p3.10.m10.1a"><mi id="S4.SS1.p3.10.m10.1.1" xref="S4.SS1.p3.10.m10.1.1.cmml">COMBINE</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m10.1b"><ci id="S4.SS1.p3.10.m10.1.1.cmml" xref="S4.SS1.p3.10.m10.1.1">COMBINE</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m10.1c">\mathrm{COMBINE}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.10.m10.1d">roman_COMBINE</annotation></semantics></math> is responsible for fusing the features of the neighborhood with the features of the central node, thereby updating the features of the central node.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.6">A medication molecule is composed of atoms and bonds, and can be represented as a graph <math alttext="G=(V,E)" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.2"><semantics id="S4.SS1.p4.1.m1.2a"><mrow id="S4.SS1.p4.1.m1.2.3" xref="S4.SS1.p4.1.m1.2.3.cmml"><mi id="S4.SS1.p4.1.m1.2.3.2" xref="S4.SS1.p4.1.m1.2.3.2.cmml">G</mi><mo id="S4.SS1.p4.1.m1.2.3.1" xref="S4.SS1.p4.1.m1.2.3.1.cmml">=</mo><mrow id="S4.SS1.p4.1.m1.2.3.3.2" xref="S4.SS1.p4.1.m1.2.3.3.1.cmml"><mo id="S4.SS1.p4.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS1.p4.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">V</mi><mo id="S4.SS1.p4.1.m1.2.3.3.2.2" xref="S4.SS1.p4.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p4.1.m1.2.2" xref="S4.SS1.p4.1.m1.2.2.cmml">E</mi><mo id="S4.SS1.p4.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS1.p4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.2b"><apply id="S4.SS1.p4.1.m1.2.3.cmml" xref="S4.SS1.p4.1.m1.2.3"><eq id="S4.SS1.p4.1.m1.2.3.1.cmml" xref="S4.SS1.p4.1.m1.2.3.1"></eq><ci id="S4.SS1.p4.1.m1.2.3.2.cmml" xref="S4.SS1.p4.1.m1.2.3.2">𝐺</ci><interval closure="open" id="S4.SS1.p4.1.m1.2.3.3.1.cmml" xref="S4.SS1.p4.1.m1.2.3.3.2"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝑉</ci><ci id="S4.SS1.p4.1.m1.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2">𝐸</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.2c">G=(V,E)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.2d">italic_G = ( italic_V , italic_E )</annotation></semantics></math>, where <math alttext="V" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">italic_V</annotation></semantics></math> is the set of atomic nodes in the molecular graph, and <math alttext="E" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">italic_E</annotation></semantics></math> is the set of chemical bond edges in the molecular graph. Given a molecule <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">italic_G</annotation></semantics></math>, the representation of the entire graph is generated by <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1"><semantics id="S4.SS1.p4.5.m5.1a"><mi id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><ci id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.1d">italic_L</annotation></semantics></math> layers of GNN, and then aggregated by a readout function to combine all node features in the <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p4.6.m6.1"><semantics id="S4.SS1.p4.6.m6.1a"><mi id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><ci id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.6.m6.1d">italic_L</annotation></semantics></math>th layer,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{f}_{g}(G)=\text{READOUT}\left(\left\{\mathbf{f}_{n}^{(L)}(u)|u\in V%
\right\}\right)." class="ltx_Math" display="block" id="S4.E3.m1.4"><semantics id="S4.E3.m1.4a"><mrow id="S4.E3.m1.4.4.1" xref="S4.E3.m1.4.4.1.1.cmml"><mrow id="S4.E3.m1.4.4.1.1" xref="S4.E3.m1.4.4.1.1.cmml"><mrow id="S4.E3.m1.4.4.1.1.3" xref="S4.E3.m1.4.4.1.1.3.cmml"><msub id="S4.E3.m1.4.4.1.1.3.2" xref="S4.E3.m1.4.4.1.1.3.2.cmml"><mi id="S4.E3.m1.4.4.1.1.3.2.2" xref="S4.E3.m1.4.4.1.1.3.2.2.cmml">𝐟</mi><mi id="S4.E3.m1.4.4.1.1.3.2.3" xref="S4.E3.m1.4.4.1.1.3.2.3.cmml">g</mi></msub><mo id="S4.E3.m1.4.4.1.1.3.1" xref="S4.E3.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S4.E3.m1.4.4.1.1.3.3.2" xref="S4.E3.m1.4.4.1.1.3.cmml"><mo id="S4.E3.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S4.E3.m1.4.4.1.1.3.cmml">(</mo><mi id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml">G</mi><mo id="S4.E3.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S4.E3.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.4.4.1.1.2" xref="S4.E3.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.4.4.1.1.1" xref="S4.E3.m1.4.4.1.1.1.cmml"><mtext id="S4.E3.m1.4.4.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.3a.cmml">READOUT</mtext><mo id="S4.E3.m1.4.4.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.4.4.1.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.cmml"><mo id="S4.E3.m1.4.4.1.1.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.4.4.1.1.1.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.3.cmml"><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.2.3" xref="S4.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml">{</mo><mrow id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐟</mi><mi id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml">n</mi><mrow id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E3.m1.1.1.1.3.1" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">L</mi><mo id="S4.E3.m1.1.1.1.3.2" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml">u</mi><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.2.4" lspace="0em" rspace="0em" xref="S4.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">u</mi><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.1" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.1.cmml">∈</mo><mi id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.3.cmml">V</mi></mrow><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.2.5" xref="S4.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S4.E3.m1.4.4.1.1.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.4.4.1.2" lspace="0em" xref="S4.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.4b"><apply id="S4.E3.m1.4.4.1.1.cmml" xref="S4.E3.m1.4.4.1"><eq id="S4.E3.m1.4.4.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.2"></eq><apply id="S4.E3.m1.4.4.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.3"><times id="S4.E3.m1.4.4.1.1.3.1.cmml" xref="S4.E3.m1.4.4.1.1.3.1"></times><apply id="S4.E3.m1.4.4.1.1.3.2.cmml" xref="S4.E3.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.1.1.3.2.1.cmml" xref="S4.E3.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S4.E3.m1.4.4.1.1.3.2.2.cmml" xref="S4.E3.m1.4.4.1.1.3.2.2">𝐟</ci><ci id="S4.E3.m1.4.4.1.1.3.2.3.cmml" xref="S4.E3.m1.4.4.1.1.3.2.3">𝑔</ci></apply><ci id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2">𝐺</ci></apply><apply id="S4.E3.m1.4.4.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1"><times id="S4.E3.m1.4.4.1.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.1.2"></times><ci id="S4.E3.m1.4.4.1.1.1.3a.cmml" xref="S4.E3.m1.4.4.1.1.1.3"><mtext id="S4.E3.m1.4.4.1.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.1.3">READOUT</mtext></ci><apply id="S4.E3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.E3.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1"><times id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">𝐟</ci><ci id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.3">𝑛</ci></apply><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝐿</ci></apply><ci id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3">𝑢</ci></apply><apply id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2"><in id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.1"></in><ci id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.2">𝑢</ci><ci id="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.2.2.3">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.4c">\mathbf{f}_{g}(G)=\text{READOUT}\left(\left\{\mathbf{f}_{n}^{(L)}(u)|u\in V%
\right\}\right).</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.4d">bold_f start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ( italic_G ) = READOUT ( { bold_f start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT ( italic_u ) | italic_u ∈ italic_V } ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1">In this paper, we use GIN as the encoder for drug molecular graphs, which is commonly used in recent work related to drug recommendation and molecular research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib37" title="">37</a>]</cite>. We utilize pre-trained encoders as the foundation for subsequent tasks, and the overall-level representations they output are employed for downstream tasks. All drug molecular representations constitute an embedding table <math alttext="\mathbf{E}_{m}\in R^{|\mathcal{M}|\times h}" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><mrow id="S4.SS1.p5.1.m1.1.2" xref="S4.SS1.p5.1.m1.1.2.cmml"><msub id="S4.SS1.p5.1.m1.1.2.2" xref="S4.SS1.p5.1.m1.1.2.2.cmml"><mi id="S4.SS1.p5.1.m1.1.2.2.2" xref="S4.SS1.p5.1.m1.1.2.2.2.cmml">𝐄</mi><mi id="S4.SS1.p5.1.m1.1.2.2.3" xref="S4.SS1.p5.1.m1.1.2.2.3.cmml">m</mi></msub><mo id="S4.SS1.p5.1.m1.1.2.1" xref="S4.SS1.p5.1.m1.1.2.1.cmml">∈</mo><msup id="S4.SS1.p5.1.m1.1.2.3" xref="S4.SS1.p5.1.m1.1.2.3.cmml"><mi id="S4.SS1.p5.1.m1.1.2.3.2" xref="S4.SS1.p5.1.m1.1.2.3.2.cmml">R</mi><mrow id="S4.SS1.p5.1.m1.1.1.1" xref="S4.SS1.p5.1.m1.1.1.1.cmml"><mrow id="S4.SS1.p5.1.m1.1.1.1.3.2" xref="S4.SS1.p5.1.m1.1.1.1.3.1.cmml"><mo id="S4.SS1.p5.1.m1.1.1.1.3.2.1" stretchy="false" xref="S4.SS1.p5.1.m1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p5.1.m1.1.1.1.1" xref="S4.SS1.p5.1.m1.1.1.1.1.cmml">ℳ</mi><mo id="S4.SS1.p5.1.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S4.SS1.p5.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS1.p5.1.m1.1.1.1.2" rspace="0.222em" xref="S4.SS1.p5.1.m1.1.1.1.2.cmml">×</mo><mi id="S4.SS1.p5.1.m1.1.1.1.4" xref="S4.SS1.p5.1.m1.1.1.1.4.cmml">h</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.2"><in id="S4.SS1.p5.1.m1.1.2.1.cmml" xref="S4.SS1.p5.1.m1.1.2.1"></in><apply id="S4.SS1.p5.1.m1.1.2.2.cmml" xref="S4.SS1.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.2.2.1.cmml" xref="S4.SS1.p5.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.2.2.2.cmml" xref="S4.SS1.p5.1.m1.1.2.2.2">𝐄</ci><ci id="S4.SS1.p5.1.m1.1.2.2.3.cmml" xref="S4.SS1.p5.1.m1.1.2.2.3">𝑚</ci></apply><apply id="S4.SS1.p5.1.m1.1.2.3.cmml" xref="S4.SS1.p5.1.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.2.3.1.cmml" xref="S4.SS1.p5.1.m1.1.2.3">superscript</csymbol><ci id="S4.SS1.p5.1.m1.1.2.3.2.cmml" xref="S4.SS1.p5.1.m1.1.2.3.2">𝑅</ci><apply id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1"><times id="S4.SS1.p5.1.m1.1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.1.2"></times><apply id="S4.SS1.p5.1.m1.1.1.1.3.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1.3.2"><abs id="S4.SS1.p5.1.m1.1.1.1.3.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1.3.2.1"></abs><ci id="S4.SS1.p5.1.m1.1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1.1">ℳ</ci></apply><ci id="S4.SS1.p5.1.m1.1.1.1.4.cmml" xref="S4.SS1.p5.1.m1.1.1.1.4">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\mathbf{E}_{m}\in R^{|\mathcal{M}|\times h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ italic_R start_POSTSUPERSCRIPT | caligraphic_M | × italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>, where each row represents a molecular’s representation.</p>
</div>
<div class="ltx_para" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.7">BiMoRec also integrates the 3D modal structure of molecules to enhance molecular representations. Similarly, given the 3D coordinates of an atom, we represent the molecular structure as a graph <math alttext="\mathcal{G}=(\mathcal{V},\mathcal{E})" class="ltx_Math" display="inline" id="S4.SS1.p6.1.m1.2"><semantics id="S4.SS1.p6.1.m1.2a"><mrow id="S4.SS1.p6.1.m1.2.3" xref="S4.SS1.p6.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p6.1.m1.2.3.2" xref="S4.SS1.p6.1.m1.2.3.2.cmml">𝒢</mi><mo id="S4.SS1.p6.1.m1.2.3.1" xref="S4.SS1.p6.1.m1.2.3.1.cmml">=</mo><mrow id="S4.SS1.p6.1.m1.2.3.3.2" xref="S4.SS1.p6.1.m1.2.3.3.1.cmml"><mo id="S4.SS1.p6.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS1.p6.1.m1.2.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml">𝒱</mi><mo id="S4.SS1.p6.1.m1.2.3.3.2.2" xref="S4.SS1.p6.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p6.1.m1.2.2" xref="S4.SS1.p6.1.m1.2.2.cmml">ℰ</mi><mo id="S4.SS1.p6.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS1.p6.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.2b"><apply id="S4.SS1.p6.1.m1.2.3.cmml" xref="S4.SS1.p6.1.m1.2.3"><eq id="S4.SS1.p6.1.m1.2.3.1.cmml" xref="S4.SS1.p6.1.m1.2.3.1"></eq><ci id="S4.SS1.p6.1.m1.2.3.2.cmml" xref="S4.SS1.p6.1.m1.2.3.2">𝒢</ci><interval closure="open" id="S4.SS1.p6.1.m1.2.3.3.1.cmml" xref="S4.SS1.p6.1.m1.2.3.3.2"><ci id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1">𝒱</ci><ci id="S4.SS1.p6.1.m1.2.2.cmml" xref="S4.SS1.p6.1.m1.2.2">ℰ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.2c">\mathcal{G}=(\mathcal{V},\mathcal{E})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.1.m1.2d">caligraphic_G = ( caligraphic_V , caligraphic_E )</annotation></semantics></math>, where the nodes <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S4.SS1.p6.2.m2.1"><semantics id="S4.SS1.p6.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.1b"><ci id="S4.SS1.p6.2.m2.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.2.m2.1d">caligraphic_V</annotation></semantics></math> constitute the set of atoms in the molecule, and we define an edge <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S4.SS1.p6.3.m3.1"><semantics id="S4.SS1.p6.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p6.3.m3.1.1" xref="S4.SS1.p6.3.m3.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m3.1b"><ci id="S4.SS1.p6.3.m3.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.3.m3.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.3.m3.1d">caligraphic_E</annotation></semantics></math> if the distance between atoms is less than 4.5 Å. We directly utilize the 3D coordinates of atoms or edges as node features and edge features. In graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.SS1.p6.4.m4.1"><semantics id="S4.SS1.p6.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p6.4.m4.1.1" xref="S4.SS1.p6.4.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.4.m4.1b"><ci id="S4.SS1.p6.4.m4.1.1.cmml" xref="S4.SS1.p6.4.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.4.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.4.m4.1d">caligraphic_G</annotation></semantics></math>, we associate each node and edge with geometric features such as 3D coordinates, as well as scalar features describing chemical properties. Thus, we employ dedicated Geometric Vector Perceptrons (GVPs) to construct the molecular structure. Its main advantage lies in its design specifically considering 3D data, enabling direct learning of structural representations from raw atomic coordinates without the need to construct features that are invariant to rotation and translation. The equivariance and invariance of GVP are reflected in that, if we have <math alttext="\text{GVP}(\mathbf{s},\mathbf{V})=(\mathbf{s^{\prime}},\mathbf{V^{\prime}})" class="ltx_Math" display="inline" id="S4.SS1.p6.5.m5.4"><semantics id="S4.SS1.p6.5.m5.4a"><mrow id="S4.SS1.p6.5.m5.4.4" xref="S4.SS1.p6.5.m5.4.4.cmml"><mrow id="S4.SS1.p6.5.m5.4.4.4" xref="S4.SS1.p6.5.m5.4.4.4.cmml"><mtext id="S4.SS1.p6.5.m5.4.4.4.2" xref="S4.SS1.p6.5.m5.4.4.4.2a.cmml">GVP</mtext><mo id="S4.SS1.p6.5.m5.4.4.4.1" xref="S4.SS1.p6.5.m5.4.4.4.1.cmml">⁢</mo><mrow id="S4.SS1.p6.5.m5.4.4.4.3.2" xref="S4.SS1.p6.5.m5.4.4.4.3.1.cmml"><mo id="S4.SS1.p6.5.m5.4.4.4.3.2.1" stretchy="false" xref="S4.SS1.p6.5.m5.4.4.4.3.1.cmml">(</mo><mi id="S4.SS1.p6.5.m5.1.1" xref="S4.SS1.p6.5.m5.1.1.cmml">𝐬</mi><mo id="S4.SS1.p6.5.m5.4.4.4.3.2.2" xref="S4.SS1.p6.5.m5.4.4.4.3.1.cmml">,</mo><mi id="S4.SS1.p6.5.m5.2.2" xref="S4.SS1.p6.5.m5.2.2.cmml">𝐕</mi><mo id="S4.SS1.p6.5.m5.4.4.4.3.2.3" stretchy="false" xref="S4.SS1.p6.5.m5.4.4.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p6.5.m5.4.4.3" xref="S4.SS1.p6.5.m5.4.4.3.cmml">=</mo><mrow id="S4.SS1.p6.5.m5.4.4.2.2" xref="S4.SS1.p6.5.m5.4.4.2.3.cmml"><mo id="S4.SS1.p6.5.m5.4.4.2.2.3" stretchy="false" xref="S4.SS1.p6.5.m5.4.4.2.3.cmml">(</mo><msup id="S4.SS1.p6.5.m5.3.3.1.1.1" xref="S4.SS1.p6.5.m5.3.3.1.1.1.cmml"><mi id="S4.SS1.p6.5.m5.3.3.1.1.1.2" xref="S4.SS1.p6.5.m5.3.3.1.1.1.2.cmml">𝐬</mi><mo id="S4.SS1.p6.5.m5.3.3.1.1.1.3" xref="S4.SS1.p6.5.m5.3.3.1.1.1.3.cmml">′</mo></msup><mo id="S4.SS1.p6.5.m5.4.4.2.2.4" xref="S4.SS1.p6.5.m5.4.4.2.3.cmml">,</mo><msup id="S4.SS1.p6.5.m5.4.4.2.2.2" xref="S4.SS1.p6.5.m5.4.4.2.2.2.cmml"><mi id="S4.SS1.p6.5.m5.4.4.2.2.2.2" xref="S4.SS1.p6.5.m5.4.4.2.2.2.2.cmml">𝐕</mi><mo id="S4.SS1.p6.5.m5.4.4.2.2.2.3" xref="S4.SS1.p6.5.m5.4.4.2.2.2.3.cmml">′</mo></msup><mo id="S4.SS1.p6.5.m5.4.4.2.2.5" stretchy="false" xref="S4.SS1.p6.5.m5.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.5.m5.4b"><apply id="S4.SS1.p6.5.m5.4.4.cmml" xref="S4.SS1.p6.5.m5.4.4"><eq id="S4.SS1.p6.5.m5.4.4.3.cmml" xref="S4.SS1.p6.5.m5.4.4.3"></eq><apply id="S4.SS1.p6.5.m5.4.4.4.cmml" xref="S4.SS1.p6.5.m5.4.4.4"><times id="S4.SS1.p6.5.m5.4.4.4.1.cmml" xref="S4.SS1.p6.5.m5.4.4.4.1"></times><ci id="S4.SS1.p6.5.m5.4.4.4.2a.cmml" xref="S4.SS1.p6.5.m5.4.4.4.2"><mtext id="S4.SS1.p6.5.m5.4.4.4.2.cmml" xref="S4.SS1.p6.5.m5.4.4.4.2">GVP</mtext></ci><interval closure="open" id="S4.SS1.p6.5.m5.4.4.4.3.1.cmml" xref="S4.SS1.p6.5.m5.4.4.4.3.2"><ci id="S4.SS1.p6.5.m5.1.1.cmml" xref="S4.SS1.p6.5.m5.1.1">𝐬</ci><ci id="S4.SS1.p6.5.m5.2.2.cmml" xref="S4.SS1.p6.5.m5.2.2">𝐕</ci></interval></apply><interval closure="open" id="S4.SS1.p6.5.m5.4.4.2.3.cmml" xref="S4.SS1.p6.5.m5.4.4.2.2"><apply id="S4.SS1.p6.5.m5.3.3.1.1.1.cmml" xref="S4.SS1.p6.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.5.m5.3.3.1.1.1.1.cmml" xref="S4.SS1.p6.5.m5.3.3.1.1.1">superscript</csymbol><ci id="S4.SS1.p6.5.m5.3.3.1.1.1.2.cmml" xref="S4.SS1.p6.5.m5.3.3.1.1.1.2">𝐬</ci><ci id="S4.SS1.p6.5.m5.3.3.1.1.1.3.cmml" xref="S4.SS1.p6.5.m5.3.3.1.1.1.3">′</ci></apply><apply id="S4.SS1.p6.5.m5.4.4.2.2.2.cmml" xref="S4.SS1.p6.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p6.5.m5.4.4.2.2.2.1.cmml" xref="S4.SS1.p6.5.m5.4.4.2.2.2">superscript</csymbol><ci id="S4.SS1.p6.5.m5.4.4.2.2.2.2.cmml" xref="S4.SS1.p6.5.m5.4.4.2.2.2.2">𝐕</ci><ci id="S4.SS1.p6.5.m5.4.4.2.2.2.3.cmml" xref="S4.SS1.p6.5.m5.4.4.2.2.2.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.5.m5.4c">\text{GVP}(\mathbf{s},\mathbf{V})=(\mathbf{s^{\prime}},\mathbf{V^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.5.m5.4d">GVP ( bold_s , bold_V ) = ( bold_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , bold_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, then for any combination of rotations and reflections <math alttext="R" class="ltx_Math" display="inline" id="S4.SS1.p6.6.m6.1"><semantics id="S4.SS1.p6.6.m6.1a"><mi id="S4.SS1.p6.6.m6.1.1" xref="S4.SS1.p6.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.6.m6.1b"><ci id="S4.SS1.p6.6.m6.1.1.cmml" xref="S4.SS1.p6.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.6.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.6.m6.1d">italic_R</annotation></semantics></math>, we have <math alttext="\text{GVP}(\mathbf{s},R(\mathbf{V}))=(\mathbf{s^{\prime}},R(\mathbf{V^{\prime}%
}))" class="ltx_Math" display="inline" id="S4.SS1.p6.7.m7.5"><semantics id="S4.SS1.p6.7.m7.5a"><mrow id="S4.SS1.p6.7.m7.5.5" xref="S4.SS1.p6.7.m7.5.5.cmml"><mrow id="S4.SS1.p6.7.m7.3.3.1" xref="S4.SS1.p6.7.m7.3.3.1.cmml"><mtext id="S4.SS1.p6.7.m7.3.3.1.3" xref="S4.SS1.p6.7.m7.3.3.1.3a.cmml">GVP</mtext><mo id="S4.SS1.p6.7.m7.3.3.1.2" xref="S4.SS1.p6.7.m7.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS1.p6.7.m7.3.3.1.1.1" xref="S4.SS1.p6.7.m7.3.3.1.1.2.cmml"><mo id="S4.SS1.p6.7.m7.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.p6.7.m7.3.3.1.1.2.cmml">(</mo><mi id="S4.SS1.p6.7.m7.2.2" xref="S4.SS1.p6.7.m7.2.2.cmml">𝐬</mi><mo id="S4.SS1.p6.7.m7.3.3.1.1.1.3" xref="S4.SS1.p6.7.m7.3.3.1.1.2.cmml">,</mo><mrow id="S4.SS1.p6.7.m7.3.3.1.1.1.1" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.cmml"><mi id="S4.SS1.p6.7.m7.3.3.1.1.1.1.2" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.2.cmml">R</mi><mo id="S4.SS1.p6.7.m7.3.3.1.1.1.1.1" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS1.p6.7.m7.3.3.1.1.1.1.3.2" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.cmml"><mo id="S4.SS1.p6.7.m7.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.cmml">(</mo><mi id="S4.SS1.p6.7.m7.1.1" xref="S4.SS1.p6.7.m7.1.1.cmml">𝐕</mi><mo id="S4.SS1.p6.7.m7.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p6.7.m7.3.3.1.1.1.4" stretchy="false" xref="S4.SS1.p6.7.m7.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p6.7.m7.5.5.4" xref="S4.SS1.p6.7.m7.5.5.4.cmml">=</mo><mrow id="S4.SS1.p6.7.m7.5.5.3.2" xref="S4.SS1.p6.7.m7.5.5.3.3.cmml"><mo id="S4.SS1.p6.7.m7.5.5.3.2.3" stretchy="false" xref="S4.SS1.p6.7.m7.5.5.3.3.cmml">(</mo><msup id="S4.SS1.p6.7.m7.4.4.2.1.1" xref="S4.SS1.p6.7.m7.4.4.2.1.1.cmml"><mi id="S4.SS1.p6.7.m7.4.4.2.1.1.2" xref="S4.SS1.p6.7.m7.4.4.2.1.1.2.cmml">𝐬</mi><mo id="S4.SS1.p6.7.m7.4.4.2.1.1.3" xref="S4.SS1.p6.7.m7.4.4.2.1.1.3.cmml">′</mo></msup><mo id="S4.SS1.p6.7.m7.5.5.3.2.4" xref="S4.SS1.p6.7.m7.5.5.3.3.cmml">,</mo><mrow id="S4.SS1.p6.7.m7.5.5.3.2.2" xref="S4.SS1.p6.7.m7.5.5.3.2.2.cmml"><mi id="S4.SS1.p6.7.m7.5.5.3.2.2.3" xref="S4.SS1.p6.7.m7.5.5.3.2.2.3.cmml">R</mi><mo id="S4.SS1.p6.7.m7.5.5.3.2.2.2" xref="S4.SS1.p6.7.m7.5.5.3.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.cmml"><mo id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.2" stretchy="false" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.cmml">(</mo><msup id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.cmml"><mi id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.2" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.2.cmml">𝐕</mi><mo id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.3" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.3.cmml">′</mo></msup><mo id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.3" stretchy="false" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p6.7.m7.5.5.3.2.5" stretchy="false" xref="S4.SS1.p6.7.m7.5.5.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.7.m7.5b"><apply id="S4.SS1.p6.7.m7.5.5.cmml" xref="S4.SS1.p6.7.m7.5.5"><eq id="S4.SS1.p6.7.m7.5.5.4.cmml" xref="S4.SS1.p6.7.m7.5.5.4"></eq><apply id="S4.SS1.p6.7.m7.3.3.1.cmml" xref="S4.SS1.p6.7.m7.3.3.1"><times id="S4.SS1.p6.7.m7.3.3.1.2.cmml" xref="S4.SS1.p6.7.m7.3.3.1.2"></times><ci id="S4.SS1.p6.7.m7.3.3.1.3a.cmml" xref="S4.SS1.p6.7.m7.3.3.1.3"><mtext id="S4.SS1.p6.7.m7.3.3.1.3.cmml" xref="S4.SS1.p6.7.m7.3.3.1.3">GVP</mtext></ci><interval closure="open" id="S4.SS1.p6.7.m7.3.3.1.1.2.cmml" xref="S4.SS1.p6.7.m7.3.3.1.1.1"><ci id="S4.SS1.p6.7.m7.2.2.cmml" xref="S4.SS1.p6.7.m7.2.2">𝐬</ci><apply id="S4.SS1.p6.7.m7.3.3.1.1.1.1.cmml" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1"><times id="S4.SS1.p6.7.m7.3.3.1.1.1.1.1.cmml" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.1"></times><ci id="S4.SS1.p6.7.m7.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p6.7.m7.3.3.1.1.1.1.2">𝑅</ci><ci id="S4.SS1.p6.7.m7.1.1.cmml" xref="S4.SS1.p6.7.m7.1.1">𝐕</ci></apply></interval></apply><interval closure="open" id="S4.SS1.p6.7.m7.5.5.3.3.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2"><apply id="S4.SS1.p6.7.m7.4.4.2.1.1.cmml" xref="S4.SS1.p6.7.m7.4.4.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.7.m7.4.4.2.1.1.1.cmml" xref="S4.SS1.p6.7.m7.4.4.2.1.1">superscript</csymbol><ci id="S4.SS1.p6.7.m7.4.4.2.1.1.2.cmml" xref="S4.SS1.p6.7.m7.4.4.2.1.1.2">𝐬</ci><ci id="S4.SS1.p6.7.m7.4.4.2.1.1.3.cmml" xref="S4.SS1.p6.7.m7.4.4.2.1.1.3">′</ci></apply><apply id="S4.SS1.p6.7.m7.5.5.3.2.2.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2.2"><times id="S4.SS1.p6.7.m7.5.5.3.2.2.2.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2.2.2"></times><ci id="S4.SS1.p6.7.m7.5.5.3.2.2.3.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2.2.3">𝑅</ci><apply id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.1.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1">superscript</csymbol><ci id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.2.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.2">𝐕</ci><ci id="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.3.cmml" xref="S4.SS1.p6.7.m7.5.5.3.2.2.1.1.1.3">′</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.7.m7.5c">\text{GVP}(\mathbf{s},R(\mathbf{V}))=(\mathbf{s^{\prime}},R(\mathbf{V^{\prime}%
}))</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.7.m7.5d">GVP ( bold_s , italic_R ( bold_V ) ) = ( bold_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_R ( bold_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p7">
<p class="ltx_p" id="S4.SS1.p7.6">For the feature learning process of 3D information in the GVP neural network layer, given <math alttext="\mathbf{f}=(\mathbf{s},\mathbf{V})" class="ltx_Math" display="inline" id="S4.SS1.p7.1.m1.2"><semantics id="S4.SS1.p7.1.m1.2a"><mrow id="S4.SS1.p7.1.m1.2.3" xref="S4.SS1.p7.1.m1.2.3.cmml"><mi id="S4.SS1.p7.1.m1.2.3.2" xref="S4.SS1.p7.1.m1.2.3.2.cmml">𝐟</mi><mo id="S4.SS1.p7.1.m1.2.3.1" xref="S4.SS1.p7.1.m1.2.3.1.cmml">=</mo><mrow id="S4.SS1.p7.1.m1.2.3.3.2" xref="S4.SS1.p7.1.m1.2.3.3.1.cmml"><mo id="S4.SS1.p7.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS1.p7.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p7.1.m1.1.1" xref="S4.SS1.p7.1.m1.1.1.cmml">𝐬</mi><mo id="S4.SS1.p7.1.m1.2.3.3.2.2" xref="S4.SS1.p7.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p7.1.m1.2.2" xref="S4.SS1.p7.1.m1.2.2.cmml">𝐕</mi><mo id="S4.SS1.p7.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS1.p7.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.1.m1.2b"><apply id="S4.SS1.p7.1.m1.2.3.cmml" xref="S4.SS1.p7.1.m1.2.3"><eq id="S4.SS1.p7.1.m1.2.3.1.cmml" xref="S4.SS1.p7.1.m1.2.3.1"></eq><ci id="S4.SS1.p7.1.m1.2.3.2.cmml" xref="S4.SS1.p7.1.m1.2.3.2">𝐟</ci><interval closure="open" id="S4.SS1.p7.1.m1.2.3.3.1.cmml" xref="S4.SS1.p7.1.m1.2.3.3.2"><ci id="S4.SS1.p7.1.m1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1">𝐬</ci><ci id="S4.SS1.p7.1.m1.2.2.cmml" xref="S4.SS1.p7.1.m1.2.2">𝐕</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.1.m1.2c">\mathbf{f}=(\mathbf{s},\mathbf{V})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.1.m1.2d">bold_f = ( bold_s , bold_V )</annotation></semantics></math>, where <math alttext="\mathbf{s}\in\mathbb{R}^{\nu}" class="ltx_Math" display="inline" id="S4.SS1.p7.2.m2.1"><semantics id="S4.SS1.p7.2.m2.1a"><mrow id="S4.SS1.p7.2.m2.1.1" xref="S4.SS1.p7.2.m2.1.1.cmml"><mi id="S4.SS1.p7.2.m2.1.1.2" xref="S4.SS1.p7.2.m2.1.1.2.cmml">𝐬</mi><mo id="S4.SS1.p7.2.m2.1.1.1" xref="S4.SS1.p7.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p7.2.m2.1.1.3" xref="S4.SS1.p7.2.m2.1.1.3.cmml"><mi id="S4.SS1.p7.2.m2.1.1.3.2" xref="S4.SS1.p7.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p7.2.m2.1.1.3.3" xref="S4.SS1.p7.2.m2.1.1.3.3.cmml">ν</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.2.m2.1b"><apply id="S4.SS1.p7.2.m2.1.1.cmml" xref="S4.SS1.p7.2.m2.1.1"><in id="S4.SS1.p7.2.m2.1.1.1.cmml" xref="S4.SS1.p7.2.m2.1.1.1"></in><ci id="S4.SS1.p7.2.m2.1.1.2.cmml" xref="S4.SS1.p7.2.m2.1.1.2">𝐬</ci><apply id="S4.SS1.p7.2.m2.1.1.3.cmml" xref="S4.SS1.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.1.1.3.1.cmml" xref="S4.SS1.p7.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p7.2.m2.1.1.3.2.cmml" xref="S4.SS1.p7.2.m2.1.1.3.2">ℝ</ci><ci id="S4.SS1.p7.2.m2.1.1.3.3.cmml" xref="S4.SS1.p7.2.m2.1.1.3.3">𝜈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.2.m2.1c">\mathbf{s}\in\mathbb{R}^{\nu}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.2.m2.1d">bold_s ∈ blackboard_R start_POSTSUPERSCRIPT italic_ν end_POSTSUPERSCRIPT</annotation></semantics></math> is a list of scalar features and <math alttext="\mathbf{V}\in\mathbb{R}^{\mu\times 3}" class="ltx_Math" display="inline" id="S4.SS1.p7.3.m3.1"><semantics id="S4.SS1.p7.3.m3.1a"><mrow id="S4.SS1.p7.3.m3.1.1" xref="S4.SS1.p7.3.m3.1.1.cmml"><mi id="S4.SS1.p7.3.m3.1.1.2" xref="S4.SS1.p7.3.m3.1.1.2.cmml">𝐕</mi><mo id="S4.SS1.p7.3.m3.1.1.1" xref="S4.SS1.p7.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p7.3.m3.1.1.3" xref="S4.SS1.p7.3.m3.1.1.3.cmml"><mi id="S4.SS1.p7.3.m3.1.1.3.2" xref="S4.SS1.p7.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p7.3.m3.1.1.3.3" xref="S4.SS1.p7.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p7.3.m3.1.1.3.3.2" xref="S4.SS1.p7.3.m3.1.1.3.3.2.cmml">μ</mi><mo id="S4.SS1.p7.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p7.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S4.SS1.p7.3.m3.1.1.3.3.3" xref="S4.SS1.p7.3.m3.1.1.3.3.3.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.3.m3.1b"><apply id="S4.SS1.p7.3.m3.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1"><in id="S4.SS1.p7.3.m3.1.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1.1"></in><ci id="S4.SS1.p7.3.m3.1.1.2.cmml" xref="S4.SS1.p7.3.m3.1.1.2">𝐕</ci><apply id="S4.SS1.p7.3.m3.1.1.3.cmml" xref="S4.SS1.p7.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.3.m3.1.1.3.1.cmml" xref="S4.SS1.p7.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p7.3.m3.1.1.3.2.cmml" xref="S4.SS1.p7.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p7.3.m3.1.1.3.3.cmml" xref="S4.SS1.p7.3.m3.1.1.3.3"><times id="S4.SS1.p7.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p7.3.m3.1.1.3.3.1"></times><ci id="S4.SS1.p7.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p7.3.m3.1.1.3.3.2">𝜇</ci><cn id="S4.SS1.p7.3.m3.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p7.3.m3.1.1.3.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.3.m3.1c">\mathbf{V}\in\mathbb{R}^{\mu\times 3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.3.m3.1d">bold_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_μ × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> is a list of vector features in <math alttext="\mathbb{R}^{3}" class="ltx_Math" display="inline" id="S4.SS1.p7.4.m4.1"><semantics id="S4.SS1.p7.4.m4.1a"><msup id="S4.SS1.p7.4.m4.1.1" xref="S4.SS1.p7.4.m4.1.1.cmml"><mi id="S4.SS1.p7.4.m4.1.1.2" xref="S4.SS1.p7.4.m4.1.1.2.cmml">ℝ</mi><mn id="S4.SS1.p7.4.m4.1.1.3" xref="S4.SS1.p7.4.m4.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.4.m4.1b"><apply id="S4.SS1.p7.4.m4.1.1.cmml" xref="S4.SS1.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.4.m4.1.1.1.cmml" xref="S4.SS1.p7.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.p7.4.m4.1.1.2.cmml" xref="S4.SS1.p7.4.m4.1.1.2">ℝ</ci><cn id="S4.SS1.p7.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p7.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.4.m4.1c">\mathbb{R}^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.4.m4.1d">blackboard_R start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> (<math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS1.p7.5.m5.1"><semantics id="S4.SS1.p7.5.m5.1a"><mi id="S4.SS1.p7.5.m5.1.1" xref="S4.SS1.p7.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.5.m5.1b"><ci id="S4.SS1.p7.5.m5.1.1.cmml" xref="S4.SS1.p7.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.5.m5.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.5.m5.1d">italic_μ</annotation></semantics></math> and <math alttext="\nu" class="ltx_Math" display="inline" id="S4.SS1.p7.6.m6.1"><semantics id="S4.SS1.p7.6.m6.1a"><mi id="S4.SS1.p7.6.m6.1.1" xref="S4.SS1.p7.6.m6.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.6.m6.1b"><ci id="S4.SS1.p7.6.m6.1.1.cmml" xref="S4.SS1.p7.6.m6.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.6.m6.1c">\nu</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.6.m6.1d">italic_ν</annotation></semantics></math> are the number of vector features and scalar features, respectively). The specific feature learning process is as follows:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx2">
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{s}_{hv}=\text{CONCAT}({||\mathbf{W}_{h}V||}_{2},\mathbf{s%
})," class="ltx_Math" display="block" id="S4.E4.m1.2"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.3" xref="S4.E4.m1.2.2.1.1.3.cmml"><mi id="S4.E4.m1.2.2.1.1.3.2" xref="S4.E4.m1.2.2.1.1.3.2.cmml">𝐬</mi><mrow id="S4.E4.m1.2.2.1.1.3.3" xref="S4.E4.m1.2.2.1.1.3.3.cmml"><mi id="S4.E4.m1.2.2.1.1.3.3.2" xref="S4.E4.m1.2.2.1.1.3.3.2.cmml">h</mi><mo id="S4.E4.m1.2.2.1.1.3.3.1" xref="S4.E4.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E4.m1.2.2.1.1.3.3.3" xref="S4.E4.m1.2.2.1.1.3.3.3.cmml">v</mi></mrow></msub><mo id="S4.E4.m1.2.2.1.1.2" xref="S4.E4.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.2.2.1.1.1" xref="S4.E4.m1.2.2.1.1.1.cmml"><mtext id="S4.E4.m1.2.2.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.3a.cmml">CONCAT</mtext><mo id="S4.E4.m1.2.2.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.2.cmml"><mo id="S4.E4.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E4.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S4.E4.m1.2.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">V</mi></mrow><mo id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E4.m1.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S4.E4.m1.2.2.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">𝐬</mi><mo id="S4.E4.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S4.E4.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.2.2.1.2" xref="S4.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1"><eq id="S4.E4.m1.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2"></eq><apply id="S4.E4.m1.2.2.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2">𝐬</ci><apply id="S4.E4.m1.2.2.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.3.3"><times id="S4.E4.m1.2.2.1.1.3.3.1.cmml" xref="S4.E4.m1.2.2.1.1.3.3.1"></times><ci id="S4.E4.m1.2.2.1.1.3.3.2.cmml" xref="S4.E4.m1.2.2.1.1.3.3.2">ℎ</ci><ci id="S4.E4.m1.2.2.1.1.3.3.3.cmml" xref="S4.E4.m1.2.2.1.1.3.3.3">𝑣</ci></apply></apply><apply id="S4.E4.m1.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1"><times id="S4.E4.m1.2.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.2"></times><ci id="S4.E4.m1.2.2.1.1.1.3a.cmml" xref="S4.E4.m1.2.2.1.1.1.3"><mtext id="S4.E4.m1.2.2.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.3">CONCAT</mtext></ci><interval closure="open" id="S4.E4.m1.2.2.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1"><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐖</ci><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑉</ci></apply></apply><cn id="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3">2</cn></apply><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝐬</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\displaystyle\mathbf{s}_{hv}=\text{CONCAT}({||\mathbf{W}_{h}V||}_{2},\mathbf{s%
}),</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.2d">bold_s start_POSTSUBSCRIPT italic_h italic_v end_POSTSUBSCRIPT = CONCAT ( | | bold_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_V | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , bold_s ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{s^{\prime}}=\sigma(\mathbf{W}_{v}\mathbf{s}_{hv}+b)," class="ltx_Math" display="block" id="S4.E5.m1.1"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><msup id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.cmml">𝐬</mi><mo id="S4.E5.m1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml">σ</mi><mo id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">v</mi></msub><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">𝐬</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">h</mi><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">v</mi></mrow></msub></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"></eq><apply id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3">superscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2">𝐬</ci><ci id="S4.E5.m1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3">′</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3">𝜎</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1"><plus id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.2">𝐖</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.2.3">𝑣</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.2">𝐬</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.1"></times><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.2">ℎ</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.3.3.3">𝑣</ci></apply></apply></apply><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\displaystyle\mathbf{s^{\prime}}=\sigma(\mathbf{W}_{v}\mathbf{s}_{hv}+b),</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.1d">bold_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_σ ( bold_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT bold_s start_POSTSUBSCRIPT italic_h italic_v end_POSTSUBSCRIPT + italic_b ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\boldsymbol{v}_{\mu}={||\mathbf{W}_{\mu}\mathbf{W}_{h}V||}_{2}," class="ltx_Math" display="block" id="S4.E6.m1.1"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.3.2.cmml">𝒗</mi><mi id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.cmml">μ</mi></msub><mo id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">=</mo><msub id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml">μ</mi></msub><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml">h</mi></msub><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1a" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.4" xref="S4.E6.m1.1.1.1.1.1.1.1.1.4.cmml">V</mi></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml">2</mn></msub></mrow><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><eq id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"></eq><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2">𝒗</ci><ci id="S4.E6.m1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3">𝜇</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.2">𝐖</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.3">𝜇</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2">𝐖</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3">ℎ</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.4">𝑉</ci></apply></apply><cn id="S4.E6.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle\boldsymbol{v}_{\mu}={||\mathbf{W}_{\mu}\mathbf{W}_{h}V||}_{2},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.1d">bold_italic_v start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT = | | bold_W start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT italic_V | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{V^{\prime}}=\sigma(\boldsymbol{v}_{\mu})\odot\boldsymbol{%
v}_{\mu}" class="ltx_Math" display="block" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><msup id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.3.2" xref="S4.E7.m1.1.1.3.2.cmml">𝐕</mi><mo id="S4.E7.m1.1.1.3.3" xref="S4.E7.m1.1.1.3.3.cmml">′</mo></msup><mo id="S4.E7.m1.1.1.2" xref="S4.E7.m1.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.3.cmml">σ</mi><mo id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.3.cmml">μ</mi></msub><mo id="S4.E7.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.1.1.1.2" rspace="0.222em" xref="S4.E7.m1.1.1.1.2.cmml">⊙</mo><msub id="S4.E7.m1.1.1.1.3" xref="S4.E7.m1.1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.3.2.cmml">𝒗</mi><mi id="S4.E7.m1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.3.3.cmml">μ</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><eq id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1.2"></eq><apply id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.3">superscript</csymbol><ci id="S4.E7.m1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.3.2">𝐕</ci><ci id="S4.E7.m1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.3.3">′</ci></apply><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.2">direct-product</csymbol><apply id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1"><times id="S4.E7.m1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.2"></times><ci id="S4.E7.m1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.3">𝜎</ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3">𝜇</ci></apply></apply><apply id="S4.E7.m1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.3.2">𝒗</ci><ci id="S4.E7.m1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.3.3">𝜇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">\displaystyle\mathbf{V^{\prime}}=\sigma(\boldsymbol{v}_{\mu})\odot\boldsymbol{%
v}_{\mu}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">bold_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_σ ( bold_italic_v start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT ) ⊙ bold_italic_v start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p7.11">where <math alttext="W_{h}" class="ltx_Math" display="inline" id="S4.SS1.p7.7.m1.1"><semantics id="S4.SS1.p7.7.m1.1a"><msub id="S4.SS1.p7.7.m1.1.1" xref="S4.SS1.p7.7.m1.1.1.cmml"><mi id="S4.SS1.p7.7.m1.1.1.2" xref="S4.SS1.p7.7.m1.1.1.2.cmml">W</mi><mi id="S4.SS1.p7.7.m1.1.1.3" xref="S4.SS1.p7.7.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.7.m1.1b"><apply id="S4.SS1.p7.7.m1.1.1.cmml" xref="S4.SS1.p7.7.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.7.m1.1.1.1.cmml" xref="S4.SS1.p7.7.m1.1.1">subscript</csymbol><ci id="S4.SS1.p7.7.m1.1.1.2.cmml" xref="S4.SS1.p7.7.m1.1.1.2">𝑊</ci><ci id="S4.SS1.p7.7.m1.1.1.3.cmml" xref="S4.SS1.p7.7.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.7.m1.1c">W_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.7.m1.1d">italic_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="W_{v}" class="ltx_Math" display="inline" id="S4.SS1.p7.8.m2.1"><semantics id="S4.SS1.p7.8.m2.1a"><msub id="S4.SS1.p7.8.m2.1.1" xref="S4.SS1.p7.8.m2.1.1.cmml"><mi id="S4.SS1.p7.8.m2.1.1.2" xref="S4.SS1.p7.8.m2.1.1.2.cmml">W</mi><mi id="S4.SS1.p7.8.m2.1.1.3" xref="S4.SS1.p7.8.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.8.m2.1b"><apply id="S4.SS1.p7.8.m2.1.1.cmml" xref="S4.SS1.p7.8.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.8.m2.1.1.1.cmml" xref="S4.SS1.p7.8.m2.1.1">subscript</csymbol><ci id="S4.SS1.p7.8.m2.1.1.2.cmml" xref="S4.SS1.p7.8.m2.1.1.2">𝑊</ci><ci id="S4.SS1.p7.8.m2.1.1.3.cmml" xref="S4.SS1.p7.8.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.8.m2.1c">W_{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.8.m2.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="W_{\mu}" class="ltx_Math" display="inline" id="S4.SS1.p7.9.m3.1"><semantics id="S4.SS1.p7.9.m3.1a"><msub id="S4.SS1.p7.9.m3.1.1" xref="S4.SS1.p7.9.m3.1.1.cmml"><mi id="S4.SS1.p7.9.m3.1.1.2" xref="S4.SS1.p7.9.m3.1.1.2.cmml">W</mi><mi id="S4.SS1.p7.9.m3.1.1.3" xref="S4.SS1.p7.9.m3.1.1.3.cmml">μ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.9.m3.1b"><apply id="S4.SS1.p7.9.m3.1.1.cmml" xref="S4.SS1.p7.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.9.m3.1.1.1.cmml" xref="S4.SS1.p7.9.m3.1.1">subscript</csymbol><ci id="S4.SS1.p7.9.m3.1.1.2.cmml" xref="S4.SS1.p7.9.m3.1.1.2">𝑊</ci><ci id="S4.SS1.p7.9.m3.1.1.3.cmml" xref="S4.SS1.p7.9.m3.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.9.m3.1c">W_{\mu}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.9.m3.1d">italic_W start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT</annotation></semantics></math> are three weight matrices for transformation, <math alttext="b" class="ltx_Math" display="inline" id="S4.SS1.p7.10.m4.1"><semantics id="S4.SS1.p7.10.m4.1a"><mi id="S4.SS1.p7.10.m4.1.1" xref="S4.SS1.p7.10.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.10.m4.1b"><ci id="S4.SS1.p7.10.m4.1.1.cmml" xref="S4.SS1.p7.10.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.10.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.10.m4.1d">italic_b</annotation></semantics></math> is a bias term, and <math alttext="\odot" class="ltx_Math" display="inline" id="S4.SS1.p7.11.m5.1"><semantics id="S4.SS1.p7.11.m5.1a"><mo id="S4.SS1.p7.11.m5.1.1" xref="S4.SS1.p7.11.m5.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.11.m5.1b"><csymbol cd="latexml" id="S4.SS1.p7.11.m5.1.1.cmml" xref="S4.SS1.p7.11.m5.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.11.m5.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.11.m5.1d">⊙</annotation></semantics></math> represents element-wise multiplication.</p>
</div>
<div class="ltx_para" id="S4.SS1.p8">
<p class="ltx_p" id="S4.SS1.p8.9">In model construction, we use the tuple <math alttext="\mathbf{f}_{i}=(\mathbf{s}_{i},\mathbf{V}_{i})" class="ltx_Math" display="inline" id="S4.SS1.p8.1.m1.2"><semantics id="S4.SS1.p8.1.m1.2a"><mrow id="S4.SS1.p8.1.m1.2.2" xref="S4.SS1.p8.1.m1.2.2.cmml"><msub id="S4.SS1.p8.1.m1.2.2.4" xref="S4.SS1.p8.1.m1.2.2.4.cmml"><mi id="S4.SS1.p8.1.m1.2.2.4.2" xref="S4.SS1.p8.1.m1.2.2.4.2.cmml">𝐟</mi><mi id="S4.SS1.p8.1.m1.2.2.4.3" xref="S4.SS1.p8.1.m1.2.2.4.3.cmml">i</mi></msub><mo id="S4.SS1.p8.1.m1.2.2.3" xref="S4.SS1.p8.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS1.p8.1.m1.2.2.2.2" xref="S4.SS1.p8.1.m1.2.2.2.3.cmml"><mo id="S4.SS1.p8.1.m1.2.2.2.2.3" stretchy="false" xref="S4.SS1.p8.1.m1.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p8.1.m1.1.1.1.1.1" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.p8.1.m1.1.1.1.1.1.2" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2.cmml">𝐬</mi><mi id="S4.SS1.p8.1.m1.1.1.1.1.1.3" xref="S4.SS1.p8.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p8.1.m1.2.2.2.2.4" xref="S4.SS1.p8.1.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p8.1.m1.2.2.2.2.2" xref="S4.SS1.p8.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.p8.1.m1.2.2.2.2.2.2" xref="S4.SS1.p8.1.m1.2.2.2.2.2.2.cmml">𝐕</mi><mi id="S4.SS1.p8.1.m1.2.2.2.2.2.3" xref="S4.SS1.p8.1.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p8.1.m1.2.2.2.2.5" stretchy="false" xref="S4.SS1.p8.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.1.m1.2b"><apply id="S4.SS1.p8.1.m1.2.2.cmml" xref="S4.SS1.p8.1.m1.2.2"><eq id="S4.SS1.p8.1.m1.2.2.3.cmml" xref="S4.SS1.p8.1.m1.2.2.3"></eq><apply id="S4.SS1.p8.1.m1.2.2.4.cmml" xref="S4.SS1.p8.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.2.2.4.1.cmml" xref="S4.SS1.p8.1.m1.2.2.4">subscript</csymbol><ci id="S4.SS1.p8.1.m1.2.2.4.2.cmml" xref="S4.SS1.p8.1.m1.2.2.4.2">𝐟</ci><ci id="S4.SS1.p8.1.m1.2.2.4.3.cmml" xref="S4.SS1.p8.1.m1.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S4.SS1.p8.1.m1.2.2.2.3.cmml" xref="S4.SS1.p8.1.m1.2.2.2.2"><apply id="S4.SS1.p8.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p8.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2">𝐬</ci><ci id="S4.SS1.p8.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p8.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.p8.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p8.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p8.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p8.1.m1.2.2.2.2.2.2">𝐕</ci><ci id="S4.SS1.p8.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p8.1.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.1.m1.2c">\mathbf{f}_{i}=(\mathbf{s}_{i},\mathbf{V}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.1.m1.2d">bold_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( bold_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> to represent the vector features and scalar features of atom <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p8.2.m2.1"><semantics id="S4.SS1.p8.2.m2.1a"><mi id="S4.SS1.p8.2.m2.1.1" xref="S4.SS1.p8.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.2.m2.1b"><ci id="S4.SS1.p8.2.m2.1.1.cmml" xref="S4.SS1.p8.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.2.m2.1d">italic_i</annotation></semantics></math> separately, where <math alttext="\mathbf{V}_{i}\in\mathbb{R}^{\mu\times 3}" class="ltx_Math" display="inline" id="S4.SS1.p8.3.m3.1"><semantics id="S4.SS1.p8.3.m3.1a"><mrow id="S4.SS1.p8.3.m3.1.1" xref="S4.SS1.p8.3.m3.1.1.cmml"><msub id="S4.SS1.p8.3.m3.1.1.2" xref="S4.SS1.p8.3.m3.1.1.2.cmml"><mi id="S4.SS1.p8.3.m3.1.1.2.2" xref="S4.SS1.p8.3.m3.1.1.2.2.cmml">𝐕</mi><mi id="S4.SS1.p8.3.m3.1.1.2.3" xref="S4.SS1.p8.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p8.3.m3.1.1.1" xref="S4.SS1.p8.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p8.3.m3.1.1.3" xref="S4.SS1.p8.3.m3.1.1.3.cmml"><mi id="S4.SS1.p8.3.m3.1.1.3.2" xref="S4.SS1.p8.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p8.3.m3.1.1.3.3" xref="S4.SS1.p8.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p8.3.m3.1.1.3.3.2" xref="S4.SS1.p8.3.m3.1.1.3.3.2.cmml">μ</mi><mo id="S4.SS1.p8.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p8.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S4.SS1.p8.3.m3.1.1.3.3.3" xref="S4.SS1.p8.3.m3.1.1.3.3.3.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.3.m3.1b"><apply id="S4.SS1.p8.3.m3.1.1.cmml" xref="S4.SS1.p8.3.m3.1.1"><in id="S4.SS1.p8.3.m3.1.1.1.cmml" xref="S4.SS1.p8.3.m3.1.1.1"></in><apply id="S4.SS1.p8.3.m3.1.1.2.cmml" xref="S4.SS1.p8.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p8.3.m3.1.1.2.1.cmml" xref="S4.SS1.p8.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p8.3.m3.1.1.2.2.cmml" xref="S4.SS1.p8.3.m3.1.1.2.2">𝐕</ci><ci id="S4.SS1.p8.3.m3.1.1.2.3.cmml" xref="S4.SS1.p8.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p8.3.m3.1.1.3.cmml" xref="S4.SS1.p8.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p8.3.m3.1.1.3.1.cmml" xref="S4.SS1.p8.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p8.3.m3.1.1.3.2.cmml" xref="S4.SS1.p8.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p8.3.m3.1.1.3.3.cmml" xref="S4.SS1.p8.3.m3.1.1.3.3"><times id="S4.SS1.p8.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p8.3.m3.1.1.3.3.1"></times><ci id="S4.SS1.p8.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p8.3.m3.1.1.3.3.2">𝜇</ci><cn id="S4.SS1.p8.3.m3.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p8.3.m3.1.1.3.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.3.m3.1c">\mathbf{V}_{i}\in\mathbb{R}^{\mu\times 3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.3.m3.1d">bold_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_μ × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> is a list of vector features in <math alttext="\mathbb{R}^{3}" class="ltx_Math" display="inline" id="S4.SS1.p8.4.m4.1"><semantics id="S4.SS1.p8.4.m4.1a"><msup id="S4.SS1.p8.4.m4.1.1" xref="S4.SS1.p8.4.m4.1.1.cmml"><mi id="S4.SS1.p8.4.m4.1.1.2" xref="S4.SS1.p8.4.m4.1.1.2.cmml">ℝ</mi><mn id="S4.SS1.p8.4.m4.1.1.3" xref="S4.SS1.p8.4.m4.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.4.m4.1b"><apply id="S4.SS1.p8.4.m4.1.1.cmml" xref="S4.SS1.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.4.m4.1.1.1.cmml" xref="S4.SS1.p8.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.p8.4.m4.1.1.2.cmml" xref="S4.SS1.p8.4.m4.1.1.2">ℝ</ci><cn id="S4.SS1.p8.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p8.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.4.m4.1c">\mathbb{R}^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.4.m4.1d">blackboard_R start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{s}_{i}\in\mathbb{R}^{\nu}" class="ltx_Math" display="inline" id="S4.SS1.p8.5.m5.1"><semantics id="S4.SS1.p8.5.m5.1a"><mrow id="S4.SS1.p8.5.m5.1.1" xref="S4.SS1.p8.5.m5.1.1.cmml"><msub id="S4.SS1.p8.5.m5.1.1.2" xref="S4.SS1.p8.5.m5.1.1.2.cmml"><mi id="S4.SS1.p8.5.m5.1.1.2.2" xref="S4.SS1.p8.5.m5.1.1.2.2.cmml">𝐬</mi><mi id="S4.SS1.p8.5.m5.1.1.2.3" xref="S4.SS1.p8.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p8.5.m5.1.1.1" xref="S4.SS1.p8.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.p8.5.m5.1.1.3" xref="S4.SS1.p8.5.m5.1.1.3.cmml"><mi id="S4.SS1.p8.5.m5.1.1.3.2" xref="S4.SS1.p8.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p8.5.m5.1.1.3.3" xref="S4.SS1.p8.5.m5.1.1.3.3.cmml">ν</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.5.m5.1b"><apply id="S4.SS1.p8.5.m5.1.1.cmml" xref="S4.SS1.p8.5.m5.1.1"><in id="S4.SS1.p8.5.m5.1.1.1.cmml" xref="S4.SS1.p8.5.m5.1.1.1"></in><apply id="S4.SS1.p8.5.m5.1.1.2.cmml" xref="S4.SS1.p8.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p8.5.m5.1.1.2.1.cmml" xref="S4.SS1.p8.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS1.p8.5.m5.1.1.2.2.cmml" xref="S4.SS1.p8.5.m5.1.1.2.2">𝐬</ci><ci id="S4.SS1.p8.5.m5.1.1.2.3.cmml" xref="S4.SS1.p8.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p8.5.m5.1.1.3.cmml" xref="S4.SS1.p8.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p8.5.m5.1.1.3.1.cmml" xref="S4.SS1.p8.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.p8.5.m5.1.1.3.2.cmml" xref="S4.SS1.p8.5.m5.1.1.3.2">ℝ</ci><ci id="S4.SS1.p8.5.m5.1.1.3.3.cmml" xref="S4.SS1.p8.5.m5.1.1.3.3">𝜈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.5.m5.1c">\mathbf{s}_{i}\in\mathbb{R}^{\nu}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.5.m5.1d">bold_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_ν end_POSTSUPERSCRIPT</annotation></semantics></math> is a list of scalar features. The edge feature <math alttext="\mathbf{e}_{ij}=(\mathbf{e}^{v}_{ij},\mathbf{e}^{s}_{ij})" class="ltx_Math" display="inline" id="S4.SS1.p8.6.m6.2"><semantics id="S4.SS1.p8.6.m6.2a"><mrow id="S4.SS1.p8.6.m6.2.2" xref="S4.SS1.p8.6.m6.2.2.cmml"><msub id="S4.SS1.p8.6.m6.2.2.4" xref="S4.SS1.p8.6.m6.2.2.4.cmml"><mi id="S4.SS1.p8.6.m6.2.2.4.2" xref="S4.SS1.p8.6.m6.2.2.4.2.cmml">𝐞</mi><mrow id="S4.SS1.p8.6.m6.2.2.4.3" xref="S4.SS1.p8.6.m6.2.2.4.3.cmml"><mi id="S4.SS1.p8.6.m6.2.2.4.3.2" xref="S4.SS1.p8.6.m6.2.2.4.3.2.cmml">i</mi><mo id="S4.SS1.p8.6.m6.2.2.4.3.1" xref="S4.SS1.p8.6.m6.2.2.4.3.1.cmml">⁢</mo><mi id="S4.SS1.p8.6.m6.2.2.4.3.3" xref="S4.SS1.p8.6.m6.2.2.4.3.3.cmml">j</mi></mrow></msub><mo id="S4.SS1.p8.6.m6.2.2.3" xref="S4.SS1.p8.6.m6.2.2.3.cmml">=</mo><mrow id="S4.SS1.p8.6.m6.2.2.2.2" xref="S4.SS1.p8.6.m6.2.2.2.3.cmml"><mo id="S4.SS1.p8.6.m6.2.2.2.2.3" stretchy="false" xref="S4.SS1.p8.6.m6.2.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p8.6.m6.1.1.1.1.1" xref="S4.SS1.p8.6.m6.1.1.1.1.1.cmml"><mi id="S4.SS1.p8.6.m6.1.1.1.1.1.2.2" xref="S4.SS1.p8.6.m6.1.1.1.1.1.2.2.cmml">𝐞</mi><mrow id="S4.SS1.p8.6.m6.1.1.1.1.1.3" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p8.6.m6.1.1.1.1.1.3.2" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p8.6.m6.1.1.1.1.1.3.1" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p8.6.m6.1.1.1.1.1.3.3" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3.3.cmml">j</mi></mrow><mi id="S4.SS1.p8.6.m6.1.1.1.1.1.2.3" xref="S4.SS1.p8.6.m6.1.1.1.1.1.2.3.cmml">v</mi></msubsup><mo id="S4.SS1.p8.6.m6.2.2.2.2.4" xref="S4.SS1.p8.6.m6.2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p8.6.m6.2.2.2.2.2" xref="S4.SS1.p8.6.m6.2.2.2.2.2.cmml"><mi id="S4.SS1.p8.6.m6.2.2.2.2.2.2.2" xref="S4.SS1.p8.6.m6.2.2.2.2.2.2.2.cmml">𝐞</mi><mrow id="S4.SS1.p8.6.m6.2.2.2.2.2.3" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p8.6.m6.2.2.2.2.2.3.2" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3.2.cmml">i</mi><mo id="S4.SS1.p8.6.m6.2.2.2.2.2.3.1" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p8.6.m6.2.2.2.2.2.3.3" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3.3.cmml">j</mi></mrow><mi id="S4.SS1.p8.6.m6.2.2.2.2.2.2.3" xref="S4.SS1.p8.6.m6.2.2.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S4.SS1.p8.6.m6.2.2.2.2.5" stretchy="false" xref="S4.SS1.p8.6.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.6.m6.2b"><apply id="S4.SS1.p8.6.m6.2.2.cmml" xref="S4.SS1.p8.6.m6.2.2"><eq id="S4.SS1.p8.6.m6.2.2.3.cmml" xref="S4.SS1.p8.6.m6.2.2.3"></eq><apply id="S4.SS1.p8.6.m6.2.2.4.cmml" xref="S4.SS1.p8.6.m6.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p8.6.m6.2.2.4.1.cmml" xref="S4.SS1.p8.6.m6.2.2.4">subscript</csymbol><ci id="S4.SS1.p8.6.m6.2.2.4.2.cmml" xref="S4.SS1.p8.6.m6.2.2.4.2">𝐞</ci><apply id="S4.SS1.p8.6.m6.2.2.4.3.cmml" xref="S4.SS1.p8.6.m6.2.2.4.3"><times id="S4.SS1.p8.6.m6.2.2.4.3.1.cmml" xref="S4.SS1.p8.6.m6.2.2.4.3.1"></times><ci id="S4.SS1.p8.6.m6.2.2.4.3.2.cmml" xref="S4.SS1.p8.6.m6.2.2.4.3.2">𝑖</ci><ci id="S4.SS1.p8.6.m6.2.2.4.3.3.cmml" xref="S4.SS1.p8.6.m6.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S4.SS1.p8.6.m6.2.2.2.3.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2"><apply id="S4.SS1.p8.6.m6.1.1.1.1.1.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p8.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.6.m6.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p8.6.m6.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1.2.2">𝐞</ci><ci id="S4.SS1.p8.6.m6.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1.2.3">𝑣</ci></apply><apply id="S4.SS1.p8.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3"><times id="S4.SS1.p8.6.m6.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3.1"></times><ci id="S4.SS1.p8.6.m6.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.SS1.p8.6.m6.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p8.6.m6.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S4.SS1.p8.6.m6.2.2.2.2.2.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p8.6.m6.2.2.2.2.2.1.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2">subscript</csymbol><apply id="S4.SS1.p8.6.m6.2.2.2.2.2.2.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p8.6.m6.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p8.6.m6.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2.2.2">𝐞</ci><ci id="S4.SS1.p8.6.m6.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2.2.3">𝑠</ci></apply><apply id="S4.SS1.p8.6.m6.2.2.2.2.2.3.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3"><times id="S4.SS1.p8.6.m6.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3.1"></times><ci id="S4.SS1.p8.6.m6.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3.2">𝑖</ci><ci id="S4.SS1.p8.6.m6.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p8.6.m6.2.2.2.2.2.3.3">𝑗</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.6.m6.2c">\mathbf{e}_{ij}=(\mathbf{e}^{v}_{ij},\mathbf{e}^{s}_{ij})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.6.m6.2d">bold_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = ( bold_e start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT , bold_e start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> of edge <math alttext="(i,j)" class="ltx_Math" display="inline" id="S4.SS1.p8.7.m7.2"><semantics id="S4.SS1.p8.7.m7.2a"><mrow id="S4.SS1.p8.7.m7.2.3.2" xref="S4.SS1.p8.7.m7.2.3.1.cmml"><mo id="S4.SS1.p8.7.m7.2.3.2.1" stretchy="false" xref="S4.SS1.p8.7.m7.2.3.1.cmml">(</mo><mi id="S4.SS1.p8.7.m7.1.1" xref="S4.SS1.p8.7.m7.1.1.cmml">i</mi><mo id="S4.SS1.p8.7.m7.2.3.2.2" xref="S4.SS1.p8.7.m7.2.3.1.cmml">,</mo><mi id="S4.SS1.p8.7.m7.2.2" xref="S4.SS1.p8.7.m7.2.2.cmml">j</mi><mo id="S4.SS1.p8.7.m7.2.3.2.3" stretchy="false" xref="S4.SS1.p8.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.7.m7.2b"><interval closure="open" id="S4.SS1.p8.7.m7.2.3.1.cmml" xref="S4.SS1.p8.7.m7.2.3.2"><ci id="S4.SS1.p8.7.m7.1.1.cmml" xref="S4.SS1.p8.7.m7.1.1">𝑖</ci><ci id="S4.SS1.p8.7.m7.2.2.cmml" xref="S4.SS1.p8.7.m7.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.7.m7.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.7.m7.2d">( italic_i , italic_j )</annotation></semantics></math> has a similar meaning. The molecular GVP transforms node and edge features through <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p8.8.m8.1"><semantics id="S4.SS1.p8.8.m8.1a"><mi id="S4.SS1.p8.8.m8.1.1" xref="S4.SS1.p8.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.8.m8.1b"><ci id="S4.SS1.p8.8.m8.1.1.cmml" xref="S4.SS1.p8.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.8.m8.1d">italic_L</annotation></semantics></math> graph convolution layers to obtain the representation of the input molecule. Specifically, in the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p8.9.m9.1"><semantics id="S4.SS1.p8.9.m9.1a"><mi id="S4.SS1.p8.9.m9.1.1" xref="S4.SS1.p8.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.9.m9.1b"><ci id="S4.SS1.p8.9.m9.1.1.cmml" xref="S4.SS1.p8.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.9.m9.1d">italic_i</annotation></semantics></math> layer, each node aggregates embeddings from neighboring nodes and edges, and then updates its own representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{h}_{i}^{(l)}=\mathbf{h}_{i}^{(l-1)}+g\Bigg{(}\mathbf{h}_{i}^{(l-1)}+%
\frac{1}{|\mathcal{N}(i)|}\sum_{j\in\mathcal{N}(i)}\mathbf{m}_{ji}^{(l)}\Bigg{%
)}," class="ltx_Math" display="block" id="S4.E8.m1.8"><semantics id="S4.E8.m1.8a"><mrow id="S4.E8.m1.8.8.1" xref="S4.E8.m1.8.8.1.1.cmml"><mrow id="S4.E8.m1.8.8.1.1" xref="S4.E8.m1.8.8.1.1.cmml"><msubsup id="S4.E8.m1.8.8.1.1.3" xref="S4.E8.m1.8.8.1.1.3.cmml"><mi id="S4.E8.m1.8.8.1.1.3.2.2" xref="S4.E8.m1.8.8.1.1.3.2.2.cmml">𝐡</mi><mi id="S4.E8.m1.8.8.1.1.3.2.3" xref="S4.E8.m1.8.8.1.1.3.2.3.cmml">i</mi><mrow id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.8.8.1.1.3.cmml"><mo id="S4.E8.m1.1.1.1.3.1" stretchy="false" xref="S4.E8.m1.8.8.1.1.3.cmml">(</mo><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">l</mi><mo id="S4.E8.m1.1.1.1.3.2" stretchy="false" xref="S4.E8.m1.8.8.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S4.E8.m1.8.8.1.1.2" xref="S4.E8.m1.8.8.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.8.8.1.1.1" xref="S4.E8.m1.8.8.1.1.1.cmml"><msubsup id="S4.E8.m1.8.8.1.1.1.3" xref="S4.E8.m1.8.8.1.1.1.3.cmml"><mi id="S4.E8.m1.8.8.1.1.1.3.2.2" xref="S4.E8.m1.8.8.1.1.1.3.2.2.cmml">𝐡</mi><mi id="S4.E8.m1.8.8.1.1.1.3.2.3" xref="S4.E8.m1.8.8.1.1.1.3.2.3.cmml">i</mi><mrow id="S4.E8.m1.2.2.1.1" xref="S4.E8.m1.2.2.1.1.1.cmml"><mo id="S4.E8.m1.2.2.1.1.2" stretchy="false" xref="S4.E8.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.2.2.1.1.1" xref="S4.E8.m1.2.2.1.1.1.cmml"><mi id="S4.E8.m1.2.2.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S4.E8.m1.2.2.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E8.m1.2.2.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E8.m1.2.2.1.1.3" stretchy="false" xref="S4.E8.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E8.m1.8.8.1.1.1.2" xref="S4.E8.m1.8.8.1.1.1.2.cmml">+</mo><mrow id="S4.E8.m1.8.8.1.1.1.1" xref="S4.E8.m1.8.8.1.1.1.1.cmml"><mi id="S4.E8.m1.8.8.1.1.1.1.3" xref="S4.E8.m1.8.8.1.1.1.1.3.cmml">g</mi><mo id="S4.E8.m1.8.8.1.1.1.1.2" xref="S4.E8.m1.8.8.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.8.8.1.1.1.1.1.1" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.8.8.1.1.1.1.1.1.2" maxsize="260%" minsize="260%" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.8.8.1.1.1.1.1.1.1" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml">𝐡</mi><mi id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.3" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.1.cmml"><mo id="S4.E8.m1.3.3.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.1" xref="S4.E8.m1.3.3.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S4.E8.m1.3.3.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E8.m1.3.3.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E8.m1.3.3.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E8.m1.8.8.1.1.1.1.1.1.1.1" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.cmml"><mfrac id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml"><mn id="S4.E8.m1.5.5.4" xref="S4.E8.m1.5.5.4.cmml">1</mn><mrow id="S4.E8.m1.5.5.2.2" xref="S4.E8.m1.5.5.2.3.cmml"><mo id="S4.E8.m1.5.5.2.2.2" stretchy="false" xref="S4.E8.m1.5.5.2.3.1.cmml">|</mo><mrow id="S4.E8.m1.5.5.2.2.1" xref="S4.E8.m1.5.5.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.2.2.1.2" xref="S4.E8.m1.5.5.2.2.1.2.cmml">𝒩</mi><mo id="S4.E8.m1.5.5.2.2.1.1" xref="S4.E8.m1.5.5.2.2.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.5.5.2.2.1.3.2" xref="S4.E8.m1.5.5.2.2.1.cmml"><mo id="S4.E8.m1.5.5.2.2.1.3.2.1" stretchy="false" xref="S4.E8.m1.5.5.2.2.1.cmml">(</mo><mi id="S4.E8.m1.4.4.1.1" xref="S4.E8.m1.4.4.1.1.cmml">i</mi><mo id="S4.E8.m1.5.5.2.2.1.3.2.2" stretchy="false" xref="S4.E8.m1.5.5.2.2.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.5.5.2.2.3" stretchy="false" xref="S4.E8.m1.5.5.2.3.1.cmml">|</mo></mrow></mfrac><mo id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.1" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.cmml"><munder id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1.cmml"><mo id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1.2" movablelimits="false" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1.2.cmml">∑</mo><mrow id="S4.E8.m1.6.6.1" xref="S4.E8.m1.6.6.1.cmml"><mi id="S4.E8.m1.6.6.1.3" xref="S4.E8.m1.6.6.1.3.cmml">j</mi><mo id="S4.E8.m1.6.6.1.2" xref="S4.E8.m1.6.6.1.2.cmml">∈</mo><mrow id="S4.E8.m1.6.6.1.4" xref="S4.E8.m1.6.6.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.6.6.1.4.2" xref="S4.E8.m1.6.6.1.4.2.cmml">𝒩</mi><mo id="S4.E8.m1.6.6.1.4.1" xref="S4.E8.m1.6.6.1.4.1.cmml">⁢</mo><mrow id="S4.E8.m1.6.6.1.4.3.2" xref="S4.E8.m1.6.6.1.4.cmml"><mo id="S4.E8.m1.6.6.1.4.3.2.1" stretchy="false" xref="S4.E8.m1.6.6.1.4.cmml">(</mo><mi id="S4.E8.m1.6.6.1.1" xref="S4.E8.m1.6.6.1.1.cmml">i</mi><mo id="S4.E8.m1.6.6.1.4.3.2.2" stretchy="false" xref="S4.E8.m1.6.6.1.4.cmml">)</mo></mrow></mrow></mrow></munder><msubsup id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.2" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.2.cmml">𝐦</mi><mrow id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.2" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.2.cmml">j</mi><mo id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.1" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.3" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.3.cmml">i</mi></mrow><mrow id="S4.E8.m1.7.7.1.3" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml"><mo id="S4.E8.m1.7.7.1.3.1" stretchy="false" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml">(</mo><mi id="S4.E8.m1.7.7.1.1" xref="S4.E8.m1.7.7.1.1.cmml">l</mi><mo id="S4.E8.m1.7.7.1.3.2" stretchy="false" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S4.E8.m1.8.8.1.1.1.1.1.1.3" maxsize="260%" minsize="260%" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.8.8.1.2" xref="S4.E8.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.8b"><apply id="S4.E8.m1.8.8.1.1.cmml" xref="S4.E8.m1.8.8.1"><eq id="S4.E8.m1.8.8.1.1.2.cmml" xref="S4.E8.m1.8.8.1.1.2"></eq><apply id="S4.E8.m1.8.8.1.1.3.cmml" xref="S4.E8.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.3.1.cmml" xref="S4.E8.m1.8.8.1.1.3">superscript</csymbol><apply id="S4.E8.m1.8.8.1.1.3.2.cmml" xref="S4.E8.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.3.2.1.cmml" xref="S4.E8.m1.8.8.1.1.3">subscript</csymbol><ci id="S4.E8.m1.8.8.1.1.3.2.2.cmml" xref="S4.E8.m1.8.8.1.1.3.2.2">𝐡</ci><ci id="S4.E8.m1.8.8.1.1.3.2.3.cmml" xref="S4.E8.m1.8.8.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E8.m1.8.8.1.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1"><plus id="S4.E8.m1.8.8.1.1.1.2.cmml" xref="S4.E8.m1.8.8.1.1.1.2"></plus><apply id="S4.E8.m1.8.8.1.1.1.3.cmml" xref="S4.E8.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.3.1.cmml" xref="S4.E8.m1.8.8.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.8.8.1.1.1.3.2.cmml" xref="S4.E8.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.3.2.1.cmml" xref="S4.E8.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.8.8.1.1.1.3.2.2.cmml" xref="S4.E8.m1.8.8.1.1.1.3.2.2">𝐡</ci><ci id="S4.E8.m1.8.8.1.1.1.3.2.3.cmml" xref="S4.E8.m1.8.8.1.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E8.m1.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1"><minus id="S4.E8.m1.2.2.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1"></minus><ci id="S4.E8.m1.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.2">𝑙</ci><cn id="S4.E8.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S4.E8.m1.8.8.1.1.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1"><times id="S4.E8.m1.8.8.1.1.1.1.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.2"></times><ci id="S4.E8.m1.8.8.1.1.1.1.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.3">𝑔</ci><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1"><plus id="S4.E8.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.1"></plus><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.2">𝐡</ci><ci id="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E8.m1.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1"><minus id="S4.E8.m1.3.3.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1"></minus><ci id="S4.E8.m1.3.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.2">𝑙</ci><cn id="S4.E8.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3"><times id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.1"></times><apply id="S4.E8.m1.5.5.cmml" xref="S4.E8.m1.5.5"><divide id="S4.E8.m1.5.5.3.cmml" xref="S4.E8.m1.5.5"></divide><cn id="S4.E8.m1.5.5.4.cmml" type="integer" xref="S4.E8.m1.5.5.4">1</cn><apply id="S4.E8.m1.5.5.2.3.cmml" xref="S4.E8.m1.5.5.2.2"><abs id="S4.E8.m1.5.5.2.3.1.cmml" xref="S4.E8.m1.5.5.2.2.2"></abs><apply id="S4.E8.m1.5.5.2.2.1.cmml" xref="S4.E8.m1.5.5.2.2.1"><times id="S4.E8.m1.5.5.2.2.1.1.cmml" xref="S4.E8.m1.5.5.2.2.1.1"></times><ci id="S4.E8.m1.5.5.2.2.1.2.cmml" xref="S4.E8.m1.5.5.2.2.1.2">𝒩</ci><ci id="S4.E8.m1.4.4.1.1.cmml" xref="S4.E8.m1.4.4.1.1">𝑖</ci></apply></apply></apply><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2"><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1">subscript</csymbol><sum id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.1.2"></sum><apply id="S4.E8.m1.6.6.1.cmml" xref="S4.E8.m1.6.6.1"><in id="S4.E8.m1.6.6.1.2.cmml" xref="S4.E8.m1.6.6.1.2"></in><ci id="S4.E8.m1.6.6.1.3.cmml" xref="S4.E8.m1.6.6.1.3">𝑗</ci><apply id="S4.E8.m1.6.6.1.4.cmml" xref="S4.E8.m1.6.6.1.4"><times id="S4.E8.m1.6.6.1.4.1.cmml" xref="S4.E8.m1.6.6.1.4.1"></times><ci id="S4.E8.m1.6.6.1.4.2.cmml" xref="S4.E8.m1.6.6.1.4.2">𝒩</ci><ci id="S4.E8.m1.6.6.1.1.cmml" xref="S4.E8.m1.6.6.1.1">𝑖</ci></apply></apply></apply><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2">superscript</csymbol><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.2">𝐦</ci><apply id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3"><times id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.1"></times><ci id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.2">𝑗</ci><ci id="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S4.E8.m1.8.8.1.1.1.1.1.1.1.3.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.E8.m1.7.7.1.1.cmml" xref="S4.E8.m1.7.7.1.1">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.8c">\mathbf{h}_{i}^{(l)}=\mathbf{h}_{i}^{(l-1)}+g\Bigg{(}\mathbf{h}_{i}^{(l-1)}+%
\frac{1}{|\mathcal{N}(i)|}\sum_{j\in\mathcal{N}(i)}\mathbf{m}_{ji}^{(l)}\Bigg{%
)},</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.8d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT + italic_g ( bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG | caligraphic_N ( italic_i ) | end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N ( italic_i ) end_POSTSUBSCRIPT bold_m start_POSTSUBSCRIPT italic_j italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p9">
<p class="ltx_p" id="S4.SS1.p9.13">In this context, <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S4.SS1.p9.1.m1.1"><semantics id="S4.SS1.p9.1.m1.1a"><mrow id="S4.SS1.p9.1.m1.1.2" xref="S4.SS1.p9.1.m1.1.2.cmml"><mi id="S4.SS1.p9.1.m1.1.2.2" xref="S4.SS1.p9.1.m1.1.2.2.cmml">g</mi><mo id="S4.SS1.p9.1.m1.1.2.1" xref="S4.SS1.p9.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p9.1.m1.1.2.3.2" xref="S4.SS1.p9.1.m1.1.2.cmml"><mo id="S4.SS1.p9.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS1.p9.1.m1.1.2.cmml">(</mo><mo id="S4.SS1.p9.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS1.p9.1.m1.1.1.cmml">⋅</mo><mo id="S4.SS1.p9.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS1.p9.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.1.m1.1b"><apply id="S4.SS1.p9.1.m1.1.2.cmml" xref="S4.SS1.p9.1.m1.1.2"><times id="S4.SS1.p9.1.m1.1.2.1.cmml" xref="S4.SS1.p9.1.m1.1.2.1"></times><ci id="S4.SS1.p9.1.m1.1.2.2.cmml" xref="S4.SS1.p9.1.m1.1.2.2">𝑔</ci><ci id="S4.SS1.p9.1.m1.1.1.cmml" xref="S4.SS1.p9.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.1.m1.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.1.m1.1d">italic_g ( ⋅ )</annotation></semantics></math> denotes a sequence of three GVP layers, and <math alttext="\mathcal{N}(i)" class="ltx_Math" display="inline" id="S4.SS1.p9.2.m2.1"><semantics id="S4.SS1.p9.2.m2.1a"><mrow id="S4.SS1.p9.2.m2.1.2" xref="S4.SS1.p9.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p9.2.m2.1.2.2" xref="S4.SS1.p9.2.m2.1.2.2.cmml">𝒩</mi><mo id="S4.SS1.p9.2.m2.1.2.1" xref="S4.SS1.p9.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p9.2.m2.1.2.3.2" xref="S4.SS1.p9.2.m2.1.2.cmml"><mo id="S4.SS1.p9.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.p9.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p9.2.m2.1.1" xref="S4.SS1.p9.2.m2.1.1.cmml">i</mi><mo id="S4.SS1.p9.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.p9.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.2.m2.1b"><apply id="S4.SS1.p9.2.m2.1.2.cmml" xref="S4.SS1.p9.2.m2.1.2"><times id="S4.SS1.p9.2.m2.1.2.1.cmml" xref="S4.SS1.p9.2.m2.1.2.1"></times><ci id="S4.SS1.p9.2.m2.1.2.2.cmml" xref="S4.SS1.p9.2.m2.1.2.2">𝒩</ci><ci id="S4.SS1.p9.2.m2.1.1.cmml" xref="S4.SS1.p9.2.m2.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.2.m2.1c">\mathcal{N}(i)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.2.m2.1d">caligraphic_N ( italic_i )</annotation></semantics></math> represents the set of neighboring nodes of node <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p9.3.m3.1"><semantics id="S4.SS1.p9.3.m3.1a"><mi id="S4.SS1.p9.3.m3.1.1" xref="S4.SS1.p9.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.3.m3.1b"><ci id="S4.SS1.p9.3.m3.1.1.cmml" xref="S4.SS1.p9.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.3.m3.1d">italic_i</annotation></semantics></math> in <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S4.SS1.p9.4.m4.1"><semantics id="S4.SS1.p9.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p9.4.m4.1.1" xref="S4.SS1.p9.4.m4.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.4.m4.1b"><ci id="S4.SS1.p9.4.m4.1.1.cmml" xref="S4.SS1.p9.4.m4.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.4.m4.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.4.m4.1d">caligraphic_G</annotation></semantics></math>. The embedding of node <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p9.5.m5.1"><semantics id="S4.SS1.p9.5.m5.1a"><mi id="S4.SS1.p9.5.m5.1.1" xref="S4.SS1.p9.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.5.m5.1b"><ci id="S4.SS1.p9.5.m5.1.1.cmml" xref="S4.SS1.p9.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.5.m5.1d">italic_i</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS1.p9.6.m6.1"><semantics id="S4.SS1.p9.6.m6.1a"><mi id="S4.SS1.p9.6.m6.1.1" xref="S4.SS1.p9.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.6.m6.1b"><ci id="S4.SS1.p9.6.m6.1.1.cmml" xref="S4.SS1.p9.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.6.m6.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.6.m6.1d">italic_l</annotation></semantics></math> is <math alttext="\mathbf{h}^{(l)}_{i}" class="ltx_Math" display="inline" id="S4.SS1.p9.7.m7.1"><semantics id="S4.SS1.p9.7.m7.1a"><msubsup id="S4.SS1.p9.7.m7.1.2" xref="S4.SS1.p9.7.m7.1.2.cmml"><mi id="S4.SS1.p9.7.m7.1.2.2.2" xref="S4.SS1.p9.7.m7.1.2.2.2.cmml">𝐡</mi><mi id="S4.SS1.p9.7.m7.1.2.3" xref="S4.SS1.p9.7.m7.1.2.3.cmml">i</mi><mrow id="S4.SS1.p9.7.m7.1.1.1.3" xref="S4.SS1.p9.7.m7.1.2.cmml"><mo id="S4.SS1.p9.7.m7.1.1.1.3.1" stretchy="false" xref="S4.SS1.p9.7.m7.1.2.cmml">(</mo><mi id="S4.SS1.p9.7.m7.1.1.1.1" xref="S4.SS1.p9.7.m7.1.1.1.1.cmml">l</mi><mo id="S4.SS1.p9.7.m7.1.1.1.3.2" stretchy="false" xref="S4.SS1.p9.7.m7.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.7.m7.1b"><apply id="S4.SS1.p9.7.m7.1.2.cmml" xref="S4.SS1.p9.7.m7.1.2"><csymbol cd="ambiguous" id="S4.SS1.p9.7.m7.1.2.1.cmml" xref="S4.SS1.p9.7.m7.1.2">subscript</csymbol><apply id="S4.SS1.p9.7.m7.1.2.2.cmml" xref="S4.SS1.p9.7.m7.1.2"><csymbol cd="ambiguous" id="S4.SS1.p9.7.m7.1.2.2.1.cmml" xref="S4.SS1.p9.7.m7.1.2">superscript</csymbol><ci id="S4.SS1.p9.7.m7.1.2.2.2.cmml" xref="S4.SS1.p9.7.m7.1.2.2.2">𝐡</ci><ci id="S4.SS1.p9.7.m7.1.1.1.1.cmml" xref="S4.SS1.p9.7.m7.1.1.1.1">𝑙</ci></apply><ci id="S4.SS1.p9.7.m7.1.2.3.cmml" xref="S4.SS1.p9.7.m7.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.7.m7.1c">\mathbf{h}^{(l)}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.7.m7.1d">bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> (specifically, at layer 0, <math alttext="\mathbf{h}^{(0)}_{i}=\mathbf{f}_{i}" class="ltx_Math" display="inline" id="S4.SS1.p9.8.m8.1"><semantics id="S4.SS1.p9.8.m8.1a"><mrow id="S4.SS1.p9.8.m8.1.2" xref="S4.SS1.p9.8.m8.1.2.cmml"><msubsup id="S4.SS1.p9.8.m8.1.2.2" xref="S4.SS1.p9.8.m8.1.2.2.cmml"><mi id="S4.SS1.p9.8.m8.1.2.2.2.2" xref="S4.SS1.p9.8.m8.1.2.2.2.2.cmml">𝐡</mi><mi id="S4.SS1.p9.8.m8.1.2.2.3" xref="S4.SS1.p9.8.m8.1.2.2.3.cmml">i</mi><mrow id="S4.SS1.p9.8.m8.1.1.1.3" xref="S4.SS1.p9.8.m8.1.2.2.cmml"><mo id="S4.SS1.p9.8.m8.1.1.1.3.1" stretchy="false" xref="S4.SS1.p9.8.m8.1.2.2.cmml">(</mo><mn id="S4.SS1.p9.8.m8.1.1.1.1" xref="S4.SS1.p9.8.m8.1.1.1.1.cmml">0</mn><mo id="S4.SS1.p9.8.m8.1.1.1.3.2" stretchy="false" xref="S4.SS1.p9.8.m8.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p9.8.m8.1.2.1" xref="S4.SS1.p9.8.m8.1.2.1.cmml">=</mo><msub id="S4.SS1.p9.8.m8.1.2.3" xref="S4.SS1.p9.8.m8.1.2.3.cmml"><mi id="S4.SS1.p9.8.m8.1.2.3.2" xref="S4.SS1.p9.8.m8.1.2.3.2.cmml">𝐟</mi><mi id="S4.SS1.p9.8.m8.1.2.3.3" xref="S4.SS1.p9.8.m8.1.2.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.8.m8.1b"><apply id="S4.SS1.p9.8.m8.1.2.cmml" xref="S4.SS1.p9.8.m8.1.2"><eq id="S4.SS1.p9.8.m8.1.2.1.cmml" xref="S4.SS1.p9.8.m8.1.2.1"></eq><apply id="S4.SS1.p9.8.m8.1.2.2.cmml" xref="S4.SS1.p9.8.m8.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p9.8.m8.1.2.2.1.cmml" xref="S4.SS1.p9.8.m8.1.2.2">subscript</csymbol><apply id="S4.SS1.p9.8.m8.1.2.2.2.cmml" xref="S4.SS1.p9.8.m8.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p9.8.m8.1.2.2.2.1.cmml" xref="S4.SS1.p9.8.m8.1.2.2">superscript</csymbol><ci id="S4.SS1.p9.8.m8.1.2.2.2.2.cmml" xref="S4.SS1.p9.8.m8.1.2.2.2.2">𝐡</ci><cn id="S4.SS1.p9.8.m8.1.1.1.1.cmml" type="integer" xref="S4.SS1.p9.8.m8.1.1.1.1">0</cn></apply><ci id="S4.SS1.p9.8.m8.1.2.2.3.cmml" xref="S4.SS1.p9.8.m8.1.2.2.3">𝑖</ci></apply><apply id="S4.SS1.p9.8.m8.1.2.3.cmml" xref="S4.SS1.p9.8.m8.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p9.8.m8.1.2.3.1.cmml" xref="S4.SS1.p9.8.m8.1.2.3">subscript</csymbol><ci id="S4.SS1.p9.8.m8.1.2.3.2.cmml" xref="S4.SS1.p9.8.m8.1.2.3.2">𝐟</ci><ci id="S4.SS1.p9.8.m8.1.2.3.3.cmml" xref="S4.SS1.p9.8.m8.1.2.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.8.m8.1c">\mathbf{h}^{(0)}_{i}=\mathbf{f}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.8.m8.1d">bold_h start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>). The message from node <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p9.9.m9.1"><semantics id="S4.SS1.p9.9.m9.1a"><mi id="S4.SS1.p9.9.m9.1.1" xref="S4.SS1.p9.9.m9.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.9.m9.1b"><ci id="S4.SS1.p9.9.m9.1.1.cmml" xref="S4.SS1.p9.9.m9.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.9.m9.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.9.m9.1d">italic_j</annotation></semantics></math> to node <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p9.10.m10.1"><semantics id="S4.SS1.p9.10.m10.1a"><mi id="S4.SS1.p9.10.m10.1.1" xref="S4.SS1.p9.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.10.m10.1b"><ci id="S4.SS1.p9.10.m10.1.1.cmml" xref="S4.SS1.p9.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.10.m10.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.10.m10.1d">italic_i</annotation></semantics></math> is <math alttext="\mathbf{m}^{(l)}_{ji}" class="ltx_Math" display="inline" id="S4.SS1.p9.11.m11.1"><semantics id="S4.SS1.p9.11.m11.1a"><msubsup id="S4.SS1.p9.11.m11.1.2" xref="S4.SS1.p9.11.m11.1.2.cmml"><mi id="S4.SS1.p9.11.m11.1.2.2.2" xref="S4.SS1.p9.11.m11.1.2.2.2.cmml">𝐦</mi><mrow id="S4.SS1.p9.11.m11.1.2.3" xref="S4.SS1.p9.11.m11.1.2.3.cmml"><mi id="S4.SS1.p9.11.m11.1.2.3.2" xref="S4.SS1.p9.11.m11.1.2.3.2.cmml">j</mi><mo id="S4.SS1.p9.11.m11.1.2.3.1" xref="S4.SS1.p9.11.m11.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p9.11.m11.1.2.3.3" xref="S4.SS1.p9.11.m11.1.2.3.3.cmml">i</mi></mrow><mrow id="S4.SS1.p9.11.m11.1.1.1.3" xref="S4.SS1.p9.11.m11.1.2.cmml"><mo id="S4.SS1.p9.11.m11.1.1.1.3.1" stretchy="false" xref="S4.SS1.p9.11.m11.1.2.cmml">(</mo><mi id="S4.SS1.p9.11.m11.1.1.1.1" xref="S4.SS1.p9.11.m11.1.1.1.1.cmml">l</mi><mo id="S4.SS1.p9.11.m11.1.1.1.3.2" stretchy="false" xref="S4.SS1.p9.11.m11.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.11.m11.1b"><apply id="S4.SS1.p9.11.m11.1.2.cmml" xref="S4.SS1.p9.11.m11.1.2"><csymbol cd="ambiguous" id="S4.SS1.p9.11.m11.1.2.1.cmml" xref="S4.SS1.p9.11.m11.1.2">subscript</csymbol><apply id="S4.SS1.p9.11.m11.1.2.2.cmml" xref="S4.SS1.p9.11.m11.1.2"><csymbol cd="ambiguous" id="S4.SS1.p9.11.m11.1.2.2.1.cmml" xref="S4.SS1.p9.11.m11.1.2">superscript</csymbol><ci id="S4.SS1.p9.11.m11.1.2.2.2.cmml" xref="S4.SS1.p9.11.m11.1.2.2.2">𝐦</ci><ci id="S4.SS1.p9.11.m11.1.1.1.1.cmml" xref="S4.SS1.p9.11.m11.1.1.1.1">𝑙</ci></apply><apply id="S4.SS1.p9.11.m11.1.2.3.cmml" xref="S4.SS1.p9.11.m11.1.2.3"><times id="S4.SS1.p9.11.m11.1.2.3.1.cmml" xref="S4.SS1.p9.11.m11.1.2.3.1"></times><ci id="S4.SS1.p9.11.m11.1.2.3.2.cmml" xref="S4.SS1.p9.11.m11.1.2.3.2">𝑗</ci><ci id="S4.SS1.p9.11.m11.1.2.3.3.cmml" xref="S4.SS1.p9.11.m11.1.2.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.11.m11.1c">\mathbf{m}^{(l)}_{ji}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.11.m11.1d">bold_m start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, computed using another sequence of GVP layers: <math alttext="\mathbf{m}^{(l)}_{ji}=g(\text{concat}(\mathbf{h}^{(l-1)}_{j},e_{ji}))" class="ltx_Math" display="inline" id="S4.SS1.p9.12.m12.3"><semantics id="S4.SS1.p9.12.m12.3a"><mrow id="S4.SS1.p9.12.m12.3.3" xref="S4.SS1.p9.12.m12.3.3.cmml"><msubsup id="S4.SS1.p9.12.m12.3.3.3" xref="S4.SS1.p9.12.m12.3.3.3.cmml"><mi id="S4.SS1.p9.12.m12.3.3.3.2.2" xref="S4.SS1.p9.12.m12.3.3.3.2.2.cmml">𝐦</mi><mrow id="S4.SS1.p9.12.m12.3.3.3.3" xref="S4.SS1.p9.12.m12.3.3.3.3.cmml"><mi id="S4.SS1.p9.12.m12.3.3.3.3.2" xref="S4.SS1.p9.12.m12.3.3.3.3.2.cmml">j</mi><mo id="S4.SS1.p9.12.m12.3.3.3.3.1" xref="S4.SS1.p9.12.m12.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p9.12.m12.3.3.3.3.3" xref="S4.SS1.p9.12.m12.3.3.3.3.3.cmml">i</mi></mrow><mrow id="S4.SS1.p9.12.m12.1.1.1.3" xref="S4.SS1.p9.12.m12.3.3.3.cmml"><mo id="S4.SS1.p9.12.m12.1.1.1.3.1" stretchy="false" xref="S4.SS1.p9.12.m12.3.3.3.cmml">(</mo><mi id="S4.SS1.p9.12.m12.1.1.1.1" xref="S4.SS1.p9.12.m12.1.1.1.1.cmml">l</mi><mo id="S4.SS1.p9.12.m12.1.1.1.3.2" stretchy="false" xref="S4.SS1.p9.12.m12.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p9.12.m12.3.3.2" xref="S4.SS1.p9.12.m12.3.3.2.cmml">=</mo><mrow id="S4.SS1.p9.12.m12.3.3.1" xref="S4.SS1.p9.12.m12.3.3.1.cmml"><mi id="S4.SS1.p9.12.m12.3.3.1.3" xref="S4.SS1.p9.12.m12.3.3.1.3.cmml">g</mi><mo id="S4.SS1.p9.12.m12.3.3.1.2" xref="S4.SS1.p9.12.m12.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS1.p9.12.m12.3.3.1.1.1" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.cmml"><mo id="S4.SS1.p9.12.m12.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p9.12.m12.3.3.1.1.1.1" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.cmml"><mtext id="S4.SS1.p9.12.m12.3.3.1.1.1.1.4" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.4a.cmml">concat</mtext><mo id="S4.SS1.p9.12.m12.3.3.1.1.1.1.3" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.3.cmml"><mo id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.3" stretchy="false" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.3.cmml">(</mo><msubsup id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.3" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.3.cmml">j</mi><mrow id="S4.SS1.p9.12.m12.2.2.1.1" xref="S4.SS1.p9.12.m12.2.2.1.1.1.cmml"><mo id="S4.SS1.p9.12.m12.2.2.1.1.2" stretchy="false" xref="S4.SS1.p9.12.m12.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.p9.12.m12.2.2.1.1.1" xref="S4.SS1.p9.12.m12.2.2.1.1.1.cmml"><mi id="S4.SS1.p9.12.m12.2.2.1.1.1.2" xref="S4.SS1.p9.12.m12.2.2.1.1.1.2.cmml">l</mi><mo id="S4.SS1.p9.12.m12.2.2.1.1.1.1" xref="S4.SS1.p9.12.m12.2.2.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p9.12.m12.2.2.1.1.1.3" xref="S4.SS1.p9.12.m12.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p9.12.m12.2.2.1.1.3" stretchy="false" xref="S4.SS1.p9.12.m12.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.4" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.cmml"><mi id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.2" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.2.cmml">e</mi><mrow id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.cmml"><mi id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.2" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.2.cmml">j</mi><mo id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.1" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.3" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.5" stretchy="false" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p9.12.m12.3.3.1.1.1.3" stretchy="false" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.12.m12.3b"><apply id="S4.SS1.p9.12.m12.3.3.cmml" xref="S4.SS1.p9.12.m12.3.3"><eq id="S4.SS1.p9.12.m12.3.3.2.cmml" xref="S4.SS1.p9.12.m12.3.3.2"></eq><apply id="S4.SS1.p9.12.m12.3.3.3.cmml" xref="S4.SS1.p9.12.m12.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p9.12.m12.3.3.3.1.cmml" xref="S4.SS1.p9.12.m12.3.3.3">subscript</csymbol><apply id="S4.SS1.p9.12.m12.3.3.3.2.cmml" xref="S4.SS1.p9.12.m12.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p9.12.m12.3.3.3.2.1.cmml" xref="S4.SS1.p9.12.m12.3.3.3">superscript</csymbol><ci id="S4.SS1.p9.12.m12.3.3.3.2.2.cmml" xref="S4.SS1.p9.12.m12.3.3.3.2.2">𝐦</ci><ci id="S4.SS1.p9.12.m12.1.1.1.1.cmml" xref="S4.SS1.p9.12.m12.1.1.1.1">𝑙</ci></apply><apply id="S4.SS1.p9.12.m12.3.3.3.3.cmml" xref="S4.SS1.p9.12.m12.3.3.3.3"><times id="S4.SS1.p9.12.m12.3.3.3.3.1.cmml" xref="S4.SS1.p9.12.m12.3.3.3.3.1"></times><ci id="S4.SS1.p9.12.m12.3.3.3.3.2.cmml" xref="S4.SS1.p9.12.m12.3.3.3.3.2">𝑗</ci><ci id="S4.SS1.p9.12.m12.3.3.3.3.3.cmml" xref="S4.SS1.p9.12.m12.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p9.12.m12.3.3.1.cmml" xref="S4.SS1.p9.12.m12.3.3.1"><times id="S4.SS1.p9.12.m12.3.3.1.2.cmml" xref="S4.SS1.p9.12.m12.3.3.1.2"></times><ci id="S4.SS1.p9.12.m12.3.3.1.3.cmml" xref="S4.SS1.p9.12.m12.3.3.1.3">𝑔</ci><apply id="S4.SS1.p9.12.m12.3.3.1.1.1.1.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1"><times id="S4.SS1.p9.12.m12.3.3.1.1.1.1.3.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.3"></times><ci id="S4.SS1.p9.12.m12.3.3.1.1.1.1.4a.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.4"><mtext id="S4.SS1.p9.12.m12.3.3.1.1.1.1.4.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.4">concat</mtext></ci><interval closure="open" id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.3.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2"><apply id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.2.2">𝐡</ci><apply id="S4.SS1.p9.12.m12.2.2.1.1.1.cmml" xref="S4.SS1.p9.12.m12.2.2.1.1"><minus id="S4.SS1.p9.12.m12.2.2.1.1.1.1.cmml" xref="S4.SS1.p9.12.m12.2.2.1.1.1.1"></minus><ci id="S4.SS1.p9.12.m12.2.2.1.1.1.2.cmml" xref="S4.SS1.p9.12.m12.2.2.1.1.1.2">𝑙</ci><cn id="S4.SS1.p9.12.m12.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p9.12.m12.2.2.1.1.1.3">1</cn></apply></apply><ci id="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.2">𝑒</ci><apply id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3"><times id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.1"></times><ci id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.2.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.2">𝑗</ci><ci id="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.3.cmml" xref="S4.SS1.p9.12.m12.3.3.1.1.1.1.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.12.m12.3c">\mathbf{m}^{(l)}_{ji}=g(\text{concat}(\mathbf{h}^{(l-1)}_{j},e_{ji}))</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.12.m12.3d">bold_m start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j italic_i end_POSTSUBSCRIPT = italic_g ( concat ( bold_h start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT italic_j italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math>, where <math alttext="\text{concat}(\cdot)" class="ltx_Math" display="inline" id="S4.SS1.p9.13.m13.1"><semantics id="S4.SS1.p9.13.m13.1a"><mrow id="S4.SS1.p9.13.m13.1.2" xref="S4.SS1.p9.13.m13.1.2.cmml"><mtext id="S4.SS1.p9.13.m13.1.2.2" xref="S4.SS1.p9.13.m13.1.2.2a.cmml">concat</mtext><mo id="S4.SS1.p9.13.m13.1.2.1" xref="S4.SS1.p9.13.m13.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p9.13.m13.1.2.3.2" xref="S4.SS1.p9.13.m13.1.2.cmml"><mo id="S4.SS1.p9.13.m13.1.2.3.2.1" stretchy="false" xref="S4.SS1.p9.13.m13.1.2.cmml">(</mo><mo id="S4.SS1.p9.13.m13.1.1" lspace="0em" rspace="0em" xref="S4.SS1.p9.13.m13.1.1.cmml">⋅</mo><mo id="S4.SS1.p9.13.m13.1.2.3.2.2" stretchy="false" xref="S4.SS1.p9.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p9.13.m13.1b"><apply id="S4.SS1.p9.13.m13.1.2.cmml" xref="S4.SS1.p9.13.m13.1.2"><times id="S4.SS1.p9.13.m13.1.2.1.cmml" xref="S4.SS1.p9.13.m13.1.2.1"></times><ci id="S4.SS1.p9.13.m13.1.2.2a.cmml" xref="S4.SS1.p9.13.m13.1.2.2"><mtext id="S4.SS1.p9.13.m13.1.2.2.cmml" xref="S4.SS1.p9.13.m13.1.2.2">concat</mtext></ci><ci id="S4.SS1.p9.13.m13.1.1.cmml" xref="S4.SS1.p9.13.m13.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p9.13.m13.1c">\text{concat}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p9.13.m13.1d">concat ( ⋅ )</annotation></semantics></math> denotes the concatenation operation of two embeddings.</p>
</div>
<div class="ltx_para" id="S4.SS1.p10">
<p class="ltx_p" id="S4.SS1.p10.2">After the final layer of molecular GVP, we also apply a global additive pooling operation to aggregate all node representations into the scalar representation <math alttext="\mathbf{h}_{d}\in\mathbb{R}^{128}" class="ltx_Math" display="inline" id="S4.SS1.p10.1.m1.1"><semantics id="S4.SS1.p10.1.m1.1a"><mrow id="S4.SS1.p10.1.m1.1.1" xref="S4.SS1.p10.1.m1.1.1.cmml"><msub id="S4.SS1.p10.1.m1.1.1.2" xref="S4.SS1.p10.1.m1.1.1.2.cmml"><mi id="S4.SS1.p10.1.m1.1.1.2.2" xref="S4.SS1.p10.1.m1.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS1.p10.1.m1.1.1.2.3" xref="S4.SS1.p10.1.m1.1.1.2.3.cmml">d</mi></msub><mo id="S4.SS1.p10.1.m1.1.1.1" xref="S4.SS1.p10.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p10.1.m1.1.1.3" xref="S4.SS1.p10.1.m1.1.1.3.cmml"><mi id="S4.SS1.p10.1.m1.1.1.3.2" xref="S4.SS1.p10.1.m1.1.1.3.2.cmml">ℝ</mi><mn id="S4.SS1.p10.1.m1.1.1.3.3" xref="S4.SS1.p10.1.m1.1.1.3.3.cmml">128</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p10.1.m1.1b"><apply id="S4.SS1.p10.1.m1.1.1.cmml" xref="S4.SS1.p10.1.m1.1.1"><in id="S4.SS1.p10.1.m1.1.1.1.cmml" xref="S4.SS1.p10.1.m1.1.1.1"></in><apply id="S4.SS1.p10.1.m1.1.1.2.cmml" xref="S4.SS1.p10.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p10.1.m1.1.1.2.1.cmml" xref="S4.SS1.p10.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p10.1.m1.1.1.2.2.cmml" xref="S4.SS1.p10.1.m1.1.1.2.2">𝐡</ci><ci id="S4.SS1.p10.1.m1.1.1.2.3.cmml" xref="S4.SS1.p10.1.m1.1.1.2.3">𝑑</ci></apply><apply id="S4.SS1.p10.1.m1.1.1.3.cmml" xref="S4.SS1.p10.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p10.1.m1.1.1.3.1.cmml" xref="S4.SS1.p10.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p10.1.m1.1.1.3.2.cmml" xref="S4.SS1.p10.1.m1.1.1.3.2">ℝ</ci><cn id="S4.SS1.p10.1.m1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p10.1.m1.1.1.3.3">128</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p10.1.m1.1c">\mathbf{h}_{d}\in\mathbb{R}^{128}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p10.1.m1.1d">bold_h start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 128 end_POSTSUPERSCRIPT</annotation></semantics></math> of the input drug, obtaining the 3D embedding matrix <math alttext="\mathbf{E}_{mt}" class="ltx_Math" display="inline" id="S4.SS1.p10.2.m2.1"><semantics id="S4.SS1.p10.2.m2.1a"><msub id="S4.SS1.p10.2.m2.1.1" xref="S4.SS1.p10.2.m2.1.1.cmml"><mi id="S4.SS1.p10.2.m2.1.1.2" xref="S4.SS1.p10.2.m2.1.1.2.cmml">𝐄</mi><mrow id="S4.SS1.p10.2.m2.1.1.3" xref="S4.SS1.p10.2.m2.1.1.3.cmml"><mi id="S4.SS1.p10.2.m2.1.1.3.2" xref="S4.SS1.p10.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS1.p10.2.m2.1.1.3.1" xref="S4.SS1.p10.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p10.2.m2.1.1.3.3" xref="S4.SS1.p10.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p10.2.m2.1b"><apply id="S4.SS1.p10.2.m2.1.1.cmml" xref="S4.SS1.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p10.2.m2.1.1.1.cmml" xref="S4.SS1.p10.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p10.2.m2.1.1.2.cmml" xref="S4.SS1.p10.2.m2.1.1.2">𝐄</ci><apply id="S4.SS1.p10.2.m2.1.1.3.cmml" xref="S4.SS1.p10.2.m2.1.1.3"><times id="S4.SS1.p10.2.m2.1.1.3.1.cmml" xref="S4.SS1.p10.2.m2.1.1.3.1"></times><ci id="S4.SS1.p10.2.m2.1.1.3.2.cmml" xref="S4.SS1.p10.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS1.p10.2.m2.1.1.3.3.cmml" xref="S4.SS1.p10.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p10.2.m2.1c">\mathbf{E}_{mt}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p10.2.m2.1d">bold_E start_POSTSUBSCRIPT italic_m italic_t end_POSTSUBSCRIPT</annotation></semantics></math> of the molecule, where each row represents a molecule’s representation.</p>
</div>
<div class="ltx_para" id="S4.SS1.p11">
<p class="ltx_p" id="S4.SS1.p11.6">Contrastive learning achieves two objectives. The first objective is to make molecules with the same index <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p11.1.m1.1"><semantics id="S4.SS1.p11.1.m1.1a"><mi id="S4.SS1.p11.1.m1.1.1" xref="S4.SS1.p11.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.1.m1.1b"><ci id="S4.SS1.p11.1.m1.1.1.cmml" xref="S4.SS1.p11.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p11.1.m1.1d">italic_i</annotation></semantics></math> increasingly similar. The second objective is to enforce differences between negative samples <math alttext="\mathbf{E}_{m_{i}}" class="ltx_Math" display="inline" id="S4.SS1.p11.2.m2.1"><semantics id="S4.SS1.p11.2.m2.1a"><msub id="S4.SS1.p11.2.m2.1.1" xref="S4.SS1.p11.2.m2.1.1.cmml"><mi id="S4.SS1.p11.2.m2.1.1.2" xref="S4.SS1.p11.2.m2.1.1.2.cmml">𝐄</mi><msub id="S4.SS1.p11.2.m2.1.1.3" xref="S4.SS1.p11.2.m2.1.1.3.cmml"><mi id="S4.SS1.p11.2.m2.1.1.3.2" xref="S4.SS1.p11.2.m2.1.1.3.2.cmml">m</mi><mi id="S4.SS1.p11.2.m2.1.1.3.3" xref="S4.SS1.p11.2.m2.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.2.m2.1b"><apply id="S4.SS1.p11.2.m2.1.1.cmml" xref="S4.SS1.p11.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p11.2.m2.1.1.1.cmml" xref="S4.SS1.p11.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p11.2.m2.1.1.2.cmml" xref="S4.SS1.p11.2.m2.1.1.2">𝐄</ci><apply id="S4.SS1.p11.2.m2.1.1.3.cmml" xref="S4.SS1.p11.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p11.2.m2.1.1.3.1.cmml" xref="S4.SS1.p11.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.p11.2.m2.1.1.3.2.cmml" xref="S4.SS1.p11.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS1.p11.2.m2.1.1.3.3.cmml" xref="S4.SS1.p11.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.2.m2.1c">\mathbf{E}_{m_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p11.2.m2.1d">bold_E start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{E}_{n_{k}}" class="ltx_Math" display="inline" id="S4.SS1.p11.3.m3.1"><semantics id="S4.SS1.p11.3.m3.1a"><msub id="S4.SS1.p11.3.m3.1.1" xref="S4.SS1.p11.3.m3.1.1.cmml"><mi id="S4.SS1.p11.3.m3.1.1.2" xref="S4.SS1.p11.3.m3.1.1.2.cmml">𝐄</mi><msub id="S4.SS1.p11.3.m3.1.1.3" xref="S4.SS1.p11.3.m3.1.1.3.cmml"><mi id="S4.SS1.p11.3.m3.1.1.3.2" xref="S4.SS1.p11.3.m3.1.1.3.2.cmml">n</mi><mi id="S4.SS1.p11.3.m3.1.1.3.3" xref="S4.SS1.p11.3.m3.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.3.m3.1b"><apply id="S4.SS1.p11.3.m3.1.1.cmml" xref="S4.SS1.p11.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p11.3.m3.1.1.1.cmml" xref="S4.SS1.p11.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p11.3.m3.1.1.2.cmml" xref="S4.SS1.p11.3.m3.1.1.2">𝐄</ci><apply id="S4.SS1.p11.3.m3.1.1.3.cmml" xref="S4.SS1.p11.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p11.3.m3.1.1.3.1.cmml" xref="S4.SS1.p11.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.p11.3.m3.1.1.3.2.cmml" xref="S4.SS1.p11.3.m3.1.1.3.2">𝑛</ci><ci id="S4.SS1.p11.3.m3.1.1.3.3.cmml" xref="S4.SS1.p11.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.3.m3.1c">\mathbf{E}_{n_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p11.3.m3.1d">bold_E start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="i\neq k" class="ltx_Math" display="inline" id="S4.SS1.p11.4.m4.1"><semantics id="S4.SS1.p11.4.m4.1a"><mrow id="S4.SS1.p11.4.m4.1.1" xref="S4.SS1.p11.4.m4.1.1.cmml"><mi id="S4.SS1.p11.4.m4.1.1.2" xref="S4.SS1.p11.4.m4.1.1.2.cmml">i</mi><mo id="S4.SS1.p11.4.m4.1.1.1" xref="S4.SS1.p11.4.m4.1.1.1.cmml">≠</mo><mi id="S4.SS1.p11.4.m4.1.1.3" xref="S4.SS1.p11.4.m4.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.4.m4.1b"><apply id="S4.SS1.p11.4.m4.1.1.cmml" xref="S4.SS1.p11.4.m4.1.1"><neq id="S4.SS1.p11.4.m4.1.1.1.cmml" xref="S4.SS1.p11.4.m4.1.1.1"></neq><ci id="S4.SS1.p11.4.m4.1.1.2.cmml" xref="S4.SS1.p11.4.m4.1.1.2">𝑖</ci><ci id="S4.SS1.p11.4.m4.1.1.3.cmml" xref="S4.SS1.p11.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.4.m4.1c">i\neq k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p11.4.m4.1d">italic_i ≠ italic_k</annotation></semantics></math>, i and k respectively represent the <math alttext="i_{th}" class="ltx_Math" display="inline" id="S4.SS1.p11.5.m5.1"><semantics id="S4.SS1.p11.5.m5.1a"><msub id="S4.SS1.p11.5.m5.1.1" xref="S4.SS1.p11.5.m5.1.1.cmml"><mi id="S4.SS1.p11.5.m5.1.1.2" xref="S4.SS1.p11.5.m5.1.1.2.cmml">i</mi><mrow id="S4.SS1.p11.5.m5.1.1.3" xref="S4.SS1.p11.5.m5.1.1.3.cmml"><mi id="S4.SS1.p11.5.m5.1.1.3.2" xref="S4.SS1.p11.5.m5.1.1.3.2.cmml">t</mi><mo id="S4.SS1.p11.5.m5.1.1.3.1" xref="S4.SS1.p11.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p11.5.m5.1.1.3.3" xref="S4.SS1.p11.5.m5.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.5.m5.1b"><apply id="S4.SS1.p11.5.m5.1.1.cmml" xref="S4.SS1.p11.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p11.5.m5.1.1.1.cmml" xref="S4.SS1.p11.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p11.5.m5.1.1.2.cmml" xref="S4.SS1.p11.5.m5.1.1.2">𝑖</ci><apply id="S4.SS1.p11.5.m5.1.1.3.cmml" xref="S4.SS1.p11.5.m5.1.1.3"><times id="S4.SS1.p11.5.m5.1.1.3.1.cmml" xref="S4.SS1.p11.5.m5.1.1.3.1"></times><ci id="S4.SS1.p11.5.m5.1.1.3.2.cmml" xref="S4.SS1.p11.5.m5.1.1.3.2">𝑡</ci><ci id="S4.SS1.p11.5.m5.1.1.3.3.cmml" xref="S4.SS1.p11.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.5.m5.1c">i_{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p11.5.m5.1d">italic_i start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math> embedding in the 2D embedding table and the <math alttext="k_{th}" class="ltx_Math" display="inline" id="S4.SS1.p11.6.m6.1"><semantics id="S4.SS1.p11.6.m6.1a"><msub id="S4.SS1.p11.6.m6.1.1" xref="S4.SS1.p11.6.m6.1.1.cmml"><mi id="S4.SS1.p11.6.m6.1.1.2" xref="S4.SS1.p11.6.m6.1.1.2.cmml">k</mi><mrow id="S4.SS1.p11.6.m6.1.1.3" xref="S4.SS1.p11.6.m6.1.1.3.cmml"><mi id="S4.SS1.p11.6.m6.1.1.3.2" xref="S4.SS1.p11.6.m6.1.1.3.2.cmml">t</mi><mo id="S4.SS1.p11.6.m6.1.1.3.1" xref="S4.SS1.p11.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p11.6.m6.1.1.3.3" xref="S4.SS1.p11.6.m6.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.6.m6.1b"><apply id="S4.SS1.p11.6.m6.1.1.cmml" xref="S4.SS1.p11.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p11.6.m6.1.1.1.cmml" xref="S4.SS1.p11.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p11.6.m6.1.1.2.cmml" xref="S4.SS1.p11.6.m6.1.1.2">𝑘</ci><apply id="S4.SS1.p11.6.m6.1.1.3.cmml" xref="S4.SS1.p11.6.m6.1.1.3"><times id="S4.SS1.p11.6.m6.1.1.3.1.cmml" xref="S4.SS1.p11.6.m6.1.1.3.1"></times><ci id="S4.SS1.p11.6.m6.1.1.3.2.cmml" xref="S4.SS1.p11.6.m6.1.1.3.2">𝑡</ci><ci id="S4.SS1.p11.6.m6.1.1.3.3.cmml" xref="S4.SS1.p11.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.6.m6.1c">k_{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p11.6.m6.1d">italic_k start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math> embedding in the 3D embedding table. If the 2D and 3D representations in a batch come from different molecules, their representations should differ. We use the currently popular NTXent loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib5" title="">5</a>]</cite> to jointly optimize our model:</p>
</div>
<div class="ltx_para" id="S4.SS1.p12">
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=-\frac{1}{N}\sum_{i=1}^{N}\left[\log\frac{e^{sim(\mathbf{E}_{m_{i}%
},\mathbf{E}_{n_{i}})/\tau}}{\sum_{k\neq i}^{N}e^{sim(\mathbf{E}_{m_{i}},%
\mathbf{E}_{n_{k}})/\tau}}\right]" class="ltx_Math" display="block" id="S4.E9.m1.5"><semantics id="S4.E9.m1.5a"><mrow id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.5.5.3" xref="S4.E9.m1.5.5.3.cmml">ℒ</mi><mo id="S4.E9.m1.5.5.2" xref="S4.E9.m1.5.5.2.cmml">=</mo><mrow id="S4.E9.m1.5.5.1" xref="S4.E9.m1.5.5.1.cmml"><mo id="S4.E9.m1.5.5.1a" xref="S4.E9.m1.5.5.1.cmml">−</mo><mrow id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1.cmml"><mfrac id="S4.E9.m1.5.5.1.1.3" xref="S4.E9.m1.5.5.1.1.3.cmml"><mn id="S4.E9.m1.5.5.1.1.3.2" xref="S4.E9.m1.5.5.1.1.3.2.cmml">1</mn><mi id="S4.E9.m1.5.5.1.1.3.3" xref="S4.E9.m1.5.5.1.1.3.3.cmml">N</mi></mfrac><mo id="S4.E9.m1.5.5.1.1.2" xref="S4.E9.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.5.5.1.1.1" xref="S4.E9.m1.5.5.1.1.1.cmml"><munderover id="S4.E9.m1.5.5.1.1.1.2" xref="S4.E9.m1.5.5.1.1.1.2.cmml"><mo id="S4.E9.m1.5.5.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E9.m1.5.5.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m1.5.5.1.1.1.2.2.3" xref="S4.E9.m1.5.5.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.5.5.1.1.1.2.2.3.2" xref="S4.E9.m1.5.5.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E9.m1.5.5.1.1.1.2.2.3.1" xref="S4.E9.m1.5.5.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.5.5.1.1.1.2.2.3.3" xref="S4.E9.m1.5.5.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.5.5.1.1.1.2.3" xref="S4.E9.m1.5.5.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S4.E9.m1.5.5.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.E9.m1.5.5.1.1.1.1.1.2" xref="S4.E9.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E9.m1.5.5.1.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.5.5.1.1.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.1.1.cmml">log</mi><mo id="S4.E9.m1.5.5.1.1.1.1.1.1a" lspace="0.167em" xref="S4.E9.m1.5.5.1.1.1.1.1.1.cmml">⁡</mo><mfrac id="S4.E9.m1.4.4" xref="S4.E9.m1.4.4.cmml"><msup id="S4.E9.m1.2.2.2" xref="S4.E9.m1.2.2.2.cmml"><mi id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.4.cmml">e</mi><mrow id="S4.E9.m1.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.cmml"><mrow id="S4.E9.m1.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.cmml"><mi id="S4.E9.m1.2.2.2.2.2.2.4" xref="S4.E9.m1.2.2.2.2.2.2.4.cmml">s</mi><mo id="S4.E9.m1.2.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.2.3.cmml">⁢</mo><mi id="S4.E9.m1.2.2.2.2.2.2.5" xref="S4.E9.m1.2.2.2.2.2.2.5.cmml">i</mi><mo id="S4.E9.m1.2.2.2.2.2.2.3a" xref="S4.E9.m1.2.2.2.2.2.2.3.cmml">⁢</mo><mi id="S4.E9.m1.2.2.2.2.2.2.6" xref="S4.E9.m1.2.2.2.2.2.2.6.cmml">m</mi><mo id="S4.E9.m1.2.2.2.2.2.2.3b" xref="S4.E9.m1.2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.2.2.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.2.3.cmml"><mo id="S4.E9.m1.2.2.2.2.2.2.2.2.3" stretchy="false" xref="S4.E9.m1.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐄</mi><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">m</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S4.E9.m1.2.2.2.2.2.2.2.2.4" xref="S4.E9.m1.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.2.2.2.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E9.m1.2.2.2.2.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.2.cmml">𝐄</mi><msub id="S4.E9.m1.2.2.2.2.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.2" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.2.cmml">n</mi><mi id="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.3" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.3.cmml">i</mi></msub></msub><mo id="S4.E9.m1.2.2.2.2.2.2.2.2.5" stretchy="false" xref="S4.E9.m1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.3.cmml">/</mo><mi id="S4.E9.m1.2.2.2.2.2.4" xref="S4.E9.m1.2.2.2.2.2.4.cmml">τ</mi></mrow></msup><mrow id="S4.E9.m1.4.4.4" xref="S4.E9.m1.4.4.4.cmml"><msubsup id="S4.E9.m1.4.4.4.3" xref="S4.E9.m1.4.4.4.3.cmml"><mo id="S4.E9.m1.4.4.4.3.2.2" xref="S4.E9.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S4.E9.m1.4.4.4.3.2.3" xref="S4.E9.m1.4.4.4.3.2.3.cmml"><mi id="S4.E9.m1.4.4.4.3.2.3.2" xref="S4.E9.m1.4.4.4.3.2.3.2.cmml">k</mi><mo id="S4.E9.m1.4.4.4.3.2.3.1" xref="S4.E9.m1.4.4.4.3.2.3.1.cmml">≠</mo><mi id="S4.E9.m1.4.4.4.3.2.3.3" xref="S4.E9.m1.4.4.4.3.2.3.3.cmml">i</mi></mrow><mi id="S4.E9.m1.4.4.4.3.3" xref="S4.E9.m1.4.4.4.3.3.cmml">N</mi></msubsup><msup id="S4.E9.m1.4.4.4.4" xref="S4.E9.m1.4.4.4.4.cmml"><mi id="S4.E9.m1.4.4.4.4.2" xref="S4.E9.m1.4.4.4.4.2.cmml">e</mi><mrow id="S4.E9.m1.4.4.4.2.2" xref="S4.E9.m1.4.4.4.2.2.cmml"><mrow id="S4.E9.m1.4.4.4.2.2.2" xref="S4.E9.m1.4.4.4.2.2.2.cmml"><mi id="S4.E9.m1.4.4.4.2.2.2.4" xref="S4.E9.m1.4.4.4.2.2.2.4.cmml">s</mi><mo id="S4.E9.m1.4.4.4.2.2.2.3" xref="S4.E9.m1.4.4.4.2.2.2.3.cmml">⁢</mo><mi id="S4.E9.m1.4.4.4.2.2.2.5" xref="S4.E9.m1.4.4.4.2.2.2.5.cmml">i</mi><mo id="S4.E9.m1.4.4.4.2.2.2.3a" xref="S4.E9.m1.4.4.4.2.2.2.3.cmml">⁢</mo><mi id="S4.E9.m1.4.4.4.2.2.2.6" xref="S4.E9.m1.4.4.4.2.2.2.6.cmml">m</mi><mo id="S4.E9.m1.4.4.4.2.2.2.3b" xref="S4.E9.m1.4.4.4.2.2.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.4.2.2.2.2.2" xref="S4.E9.m1.4.4.4.2.2.2.2.3.cmml"><mo id="S4.E9.m1.4.4.4.2.2.2.2.2.3" stretchy="false" xref="S4.E9.m1.4.4.4.2.2.2.2.3.cmml">(</mo><msub id="S4.E9.m1.3.3.3.1.1.1.1.1.1" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.3.3.3.1.1.1.1.1.1.2" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.2.cmml">𝐄</mi><msub id="S4.E9.m1.3.3.3.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.2" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.2.cmml">m</mi><mi id="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.3" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S4.E9.m1.4.4.4.2.2.2.2.2.4" xref="S4.E9.m1.4.4.4.2.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.4.4.4.2.2.2.2.2.2" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.cmml"><mi id="S4.E9.m1.4.4.4.2.2.2.2.2.2.2" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.2.cmml">𝐄</mi><msub id="S4.E9.m1.4.4.4.2.2.2.2.2.2.3" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.cmml"><mi id="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.2" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.2.cmml">n</mi><mi id="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.3" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.3.cmml">k</mi></msub></msub><mo id="S4.E9.m1.4.4.4.2.2.2.2.2.5" stretchy="false" xref="S4.E9.m1.4.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.4.4.4.2.2.3" xref="S4.E9.m1.4.4.4.2.2.3.cmml">/</mo><mi id="S4.E9.m1.4.4.4.2.2.4" xref="S4.E9.m1.4.4.4.2.2.4.cmml">τ</mi></mrow></msup></mrow></mfrac></mrow><mo id="S4.E9.m1.5.5.1.1.1.1.1.3" xref="S4.E9.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.5b"><apply id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5"><eq id="S4.E9.m1.5.5.2.cmml" xref="S4.E9.m1.5.5.2"></eq><ci id="S4.E9.m1.5.5.3.cmml" xref="S4.E9.m1.5.5.3">ℒ</ci><apply id="S4.E9.m1.5.5.1.cmml" xref="S4.E9.m1.5.5.1"><minus id="S4.E9.m1.5.5.1.2.cmml" xref="S4.E9.m1.5.5.1"></minus><apply id="S4.E9.m1.5.5.1.1.cmml" xref="S4.E9.m1.5.5.1.1"><times id="S4.E9.m1.5.5.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.2"></times><apply id="S4.E9.m1.5.5.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.3"><divide id="S4.E9.m1.5.5.1.1.3.1.cmml" xref="S4.E9.m1.5.5.1.1.3"></divide><cn id="S4.E9.m1.5.5.1.1.3.2.cmml" type="integer" xref="S4.E9.m1.5.5.1.1.3.2">1</cn><ci id="S4.E9.m1.5.5.1.1.3.3.cmml" xref="S4.E9.m1.5.5.1.1.3.3">𝑁</ci></apply><apply id="S4.E9.m1.5.5.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1"><apply id="S4.E9.m1.5.5.1.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.1.2.1.cmml" xref="S4.E9.m1.5.5.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.5.5.1.1.1.2.2.cmml" xref="S4.E9.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.1.2.2.1.cmml" xref="S4.E9.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.5.5.1.1.1.2.2.2.cmml" xref="S4.E9.m1.5.5.1.1.1.2.2.2"></sum><apply id="S4.E9.m1.5.5.1.1.1.2.2.3.cmml" xref="S4.E9.m1.5.5.1.1.1.2.2.3"><eq id="S4.E9.m1.5.5.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.5.5.1.1.1.2.2.3.1"></eq><ci id="S4.E9.m1.5.5.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.5.5.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E9.m1.5.5.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E9.m1.5.5.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.5.5.1.1.1.2.3.cmml" xref="S4.E9.m1.5.5.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E9.m1.5.5.1.1.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1"><log id="S4.E9.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1.1"></log><apply id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4"><divide id="S4.E9.m1.4.4.5.cmml" xref="S4.E9.m1.4.4"></divide><apply id="S4.E9.m1.2.2.2.cmml" xref="S4.E9.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2">superscript</csymbol><ci id="S4.E9.m1.2.2.2.4.cmml" xref="S4.E9.m1.2.2.2.4">𝑒</ci><apply id="S4.E9.m1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2"><divide id="S4.E9.m1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.3"></divide><apply id="S4.E9.m1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2"><times id="S4.E9.m1.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.3"></times><ci id="S4.E9.m1.2.2.2.2.2.2.4.cmml" xref="S4.E9.m1.2.2.2.2.2.2.4">𝑠</ci><ci id="S4.E9.m1.2.2.2.2.2.2.5.cmml" xref="S4.E9.m1.2.2.2.2.2.2.5">𝑖</ci><ci id="S4.E9.m1.2.2.2.2.2.2.6.cmml" xref="S4.E9.m1.2.2.2.2.2.2.6">𝑚</ci><interval closure="open" id="S4.E9.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2"><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2">𝐄</ci><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E9.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.2">𝐄</ci><apply id="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.2">𝑛</ci><ci id="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply><ci id="S4.E9.m1.2.2.2.2.2.4.cmml" xref="S4.E9.m1.2.2.2.2.2.4">𝜏</ci></apply></apply><apply id="S4.E9.m1.4.4.4.cmml" xref="S4.E9.m1.4.4.4"><apply id="S4.E9.m1.4.4.4.3.cmml" xref="S4.E9.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.3.1.cmml" xref="S4.E9.m1.4.4.4.3">superscript</csymbol><apply id="S4.E9.m1.4.4.4.3.2.cmml" xref="S4.E9.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.3.2.1.cmml" xref="S4.E9.m1.4.4.4.3">subscript</csymbol><sum id="S4.E9.m1.4.4.4.3.2.2.cmml" xref="S4.E9.m1.4.4.4.3.2.2"></sum><apply id="S4.E9.m1.4.4.4.3.2.3.cmml" xref="S4.E9.m1.4.4.4.3.2.3"><neq id="S4.E9.m1.4.4.4.3.2.3.1.cmml" xref="S4.E9.m1.4.4.4.3.2.3.1"></neq><ci id="S4.E9.m1.4.4.4.3.2.3.2.cmml" xref="S4.E9.m1.4.4.4.3.2.3.2">𝑘</ci><ci id="S4.E9.m1.4.4.4.3.2.3.3.cmml" xref="S4.E9.m1.4.4.4.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.E9.m1.4.4.4.3.3.cmml" xref="S4.E9.m1.4.4.4.3.3">𝑁</ci></apply><apply id="S4.E9.m1.4.4.4.4.cmml" xref="S4.E9.m1.4.4.4.4"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.1.cmml" xref="S4.E9.m1.4.4.4.4">superscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.cmml" xref="S4.E9.m1.4.4.4.4.2">𝑒</ci><apply id="S4.E9.m1.4.4.4.2.2.cmml" xref="S4.E9.m1.4.4.4.2.2"><divide id="S4.E9.m1.4.4.4.2.2.3.cmml" xref="S4.E9.m1.4.4.4.2.2.3"></divide><apply id="S4.E9.m1.4.4.4.2.2.2.cmml" xref="S4.E9.m1.4.4.4.2.2.2"><times id="S4.E9.m1.4.4.4.2.2.2.3.cmml" xref="S4.E9.m1.4.4.4.2.2.2.3"></times><ci id="S4.E9.m1.4.4.4.2.2.2.4.cmml" xref="S4.E9.m1.4.4.4.2.2.2.4">𝑠</ci><ci id="S4.E9.m1.4.4.4.2.2.2.5.cmml" xref="S4.E9.m1.4.4.4.2.2.2.5">𝑖</ci><ci id="S4.E9.m1.4.4.4.2.2.2.6.cmml" xref="S4.E9.m1.4.4.4.2.2.2.6">𝑚</ci><interval closure="open" id="S4.E9.m1.4.4.4.2.2.2.2.3.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2"><apply id="S4.E9.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.2">𝐄</ci><apply id="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.3.3.3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E9.m1.4.4.4.2.2.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.2.2.2.2.2.2.1.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.4.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.2">𝐄</ci><apply id="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.1.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.2.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.2">𝑛</ci><ci id="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.3.cmml" xref="S4.E9.m1.4.4.4.2.2.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply><ci id="S4.E9.m1.4.4.4.2.2.4.cmml" xref="S4.E9.m1.4.4.4.2.2.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.5c">\mathcal{L}=-\frac{1}{N}\sum_{i=1}^{N}\left[\log\frac{e^{sim(\mathbf{E}_{m_{i}%
},\mathbf{E}_{n_{i}})/\tau}}{\sum_{k\neq i}^{N}e^{sim(\mathbf{E}_{m_{i}},%
\mathbf{E}_{n_{k}})/\tau}}\right]</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.5d">caligraphic_L = - divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ roman_log divide start_ARG italic_e start_POSTSUPERSCRIPT italic_s italic_i italic_m ( bold_E start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k ≠ italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_s italic_i italic_m ( bold_E start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p12.2">where <math alttext="sim(\mathbf{E}_{m},\mathbf{E}_{n})=\mathbf{E}_{m}\cdot\mathbf{E}_{n}/(\|%
\mathbf{E}_{m}\|\|\mathbf{E}_{n}\|)" class="ltx_Math" display="inline" id="S4.SS1.p12.1.m1.3"><semantics id="S4.SS1.p12.1.m1.3a"><mrow id="S4.SS1.p12.1.m1.3.3" xref="S4.SS1.p12.1.m1.3.3.cmml"><mrow id="S4.SS1.p12.1.m1.2.2.2" xref="S4.SS1.p12.1.m1.2.2.2.cmml"><mi id="S4.SS1.p12.1.m1.2.2.2.4" xref="S4.SS1.p12.1.m1.2.2.2.4.cmml">s</mi><mo id="S4.SS1.p12.1.m1.2.2.2.3" xref="S4.SS1.p12.1.m1.2.2.2.3.cmml">⁢</mo><mi id="S4.SS1.p12.1.m1.2.2.2.5" xref="S4.SS1.p12.1.m1.2.2.2.5.cmml">i</mi><mo id="S4.SS1.p12.1.m1.2.2.2.3a" xref="S4.SS1.p12.1.m1.2.2.2.3.cmml">⁢</mo><mi id="S4.SS1.p12.1.m1.2.2.2.6" xref="S4.SS1.p12.1.m1.2.2.2.6.cmml">m</mi><mo id="S4.SS1.p12.1.m1.2.2.2.3b" xref="S4.SS1.p12.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.p12.1.m1.2.2.2.2.2" xref="S4.SS1.p12.1.m1.2.2.2.2.3.cmml"><mo id="S4.SS1.p12.1.m1.2.2.2.2.2.3" stretchy="false" xref="S4.SS1.p12.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p12.1.m1.1.1.1.1.1.1" xref="S4.SS1.p12.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p12.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.p12.1.m1.1.1.1.1.1.1.2.cmml">𝐄</mi><mi id="S4.SS1.p12.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.p12.1.m1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.SS1.p12.1.m1.2.2.2.2.2.4" xref="S4.SS1.p12.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p12.1.m1.2.2.2.2.2.2" xref="S4.SS1.p12.1.m1.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p12.1.m1.2.2.2.2.2.2.2" xref="S4.SS1.p12.1.m1.2.2.2.2.2.2.2.cmml">𝐄</mi><mi id="S4.SS1.p12.1.m1.2.2.2.2.2.2.3" xref="S4.SS1.p12.1.m1.2.2.2.2.2.2.3.cmml">n</mi></msub><mo id="S4.SS1.p12.1.m1.2.2.2.2.2.5" stretchy="false" xref="S4.SS1.p12.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p12.1.m1.3.3.4" xref="S4.SS1.p12.1.m1.3.3.4.cmml">=</mo><mrow id="S4.SS1.p12.1.m1.3.3.3" xref="S4.SS1.p12.1.m1.3.3.3.cmml"><mrow id="S4.SS1.p12.1.m1.3.3.3.3" xref="S4.SS1.p12.1.m1.3.3.3.3.cmml"><msub id="S4.SS1.p12.1.m1.3.3.3.3.2" xref="S4.SS1.p12.1.m1.3.3.3.3.2.cmml"><mi id="S4.SS1.p12.1.m1.3.3.3.3.2.2" xref="S4.SS1.p12.1.m1.3.3.3.3.2.2.cmml">𝐄</mi><mi id="S4.SS1.p12.1.m1.3.3.3.3.2.3" xref="S4.SS1.p12.1.m1.3.3.3.3.2.3.cmml">m</mi></msub><mo id="S4.SS1.p12.1.m1.3.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p12.1.m1.3.3.3.3.1.cmml">⋅</mo><msub id="S4.SS1.p12.1.m1.3.3.3.3.3" xref="S4.SS1.p12.1.m1.3.3.3.3.3.cmml"><mi id="S4.SS1.p12.1.m1.3.3.3.3.3.2" xref="S4.SS1.p12.1.m1.3.3.3.3.3.2.cmml">𝐄</mi><mi id="S4.SS1.p12.1.m1.3.3.3.3.3.3" xref="S4.SS1.p12.1.m1.3.3.3.3.3.3.cmml">n</mi></msub></mrow><mo id="S4.SS1.p12.1.m1.3.3.3.2" xref="S4.SS1.p12.1.m1.3.3.3.2.cmml">/</mo><mrow id="S4.SS1.p12.1.m1.3.3.3.1.1" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.cmml"><mo id="S4.SS1.p12.1.m1.3.3.3.1.1.2" stretchy="false" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS1.p12.1.m1.3.3.3.1.1.1" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.cmml"><mrow id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.2.cmml"><mo id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.2" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.2.cmml">𝐄</mi><mi id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.3" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S4.SS1.p12.1.m1.3.3.3.1.1.1.3" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.3.cmml">⁢</mo><mrow id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.2.cmml"><mo id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.2" stretchy="false" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.2.1.cmml">‖</mo><msub id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.cmml"><mi id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.2" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.2.cmml">𝐄</mi><mi id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.3" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.3.cmml">n</mi></msub><mo id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.3" stretchy="false" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.2.1.cmml">‖</mo></mrow></mrow><mo id="S4.SS1.p12.1.m1.3.3.3.1.1.3" stretchy="false" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p12.1.m1.3b"><apply id="S4.SS1.p12.1.m1.3.3.cmml" xref="S4.SS1.p12.1.m1.3.3"><eq id="S4.SS1.p12.1.m1.3.3.4.cmml" xref="S4.SS1.p12.1.m1.3.3.4"></eq><apply id="S4.SS1.p12.1.m1.2.2.2.cmml" xref="S4.SS1.p12.1.m1.2.2.2"><times id="S4.SS1.p12.1.m1.2.2.2.3.cmml" xref="S4.SS1.p12.1.m1.2.2.2.3"></times><ci id="S4.SS1.p12.1.m1.2.2.2.4.cmml" xref="S4.SS1.p12.1.m1.2.2.2.4">𝑠</ci><ci id="S4.SS1.p12.1.m1.2.2.2.5.cmml" xref="S4.SS1.p12.1.m1.2.2.2.5">𝑖</ci><ci id="S4.SS1.p12.1.m1.2.2.2.6.cmml" xref="S4.SS1.p12.1.m1.2.2.2.6">𝑚</ci><interval closure="open" id="S4.SS1.p12.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.p12.1.m1.2.2.2.2.2"><apply id="S4.SS1.p12.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p12.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p12.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p12.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p12.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p12.1.m1.1.1.1.1.1.1.2">𝐄</ci><ci id="S4.SS1.p12.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p12.1.m1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S4.SS1.p12.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p12.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p12.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p12.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p12.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p12.1.m1.2.2.2.2.2.2.2">𝐄</ci><ci id="S4.SS1.p12.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p12.1.m1.2.2.2.2.2.2.3">𝑛</ci></apply></interval></apply><apply id="S4.SS1.p12.1.m1.3.3.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3"><divide id="S4.SS1.p12.1.m1.3.3.3.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.2"></divide><apply id="S4.SS1.p12.1.m1.3.3.3.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3"><ci id="S4.SS1.p12.1.m1.3.3.3.3.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.1">⋅</ci><apply id="S4.SS1.p12.1.m1.3.3.3.3.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p12.1.m1.3.3.3.3.2.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.2">subscript</csymbol><ci id="S4.SS1.p12.1.m1.3.3.3.3.2.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.2.2">𝐄</ci><ci id="S4.SS1.p12.1.m1.3.3.3.3.2.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.2.3">𝑚</ci></apply><apply id="S4.SS1.p12.1.m1.3.3.3.3.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p12.1.m1.3.3.3.3.3.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p12.1.m1.3.3.3.3.3.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.3.2">𝐄</ci><ci id="S4.SS1.p12.1.m1.3.3.3.3.3.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3.3.3.3">𝑛</ci></apply></apply><apply id="S4.SS1.p12.1.m1.3.3.3.1.1.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1"><times id="S4.SS1.p12.1.m1.3.3.3.1.1.1.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.3"></times><apply id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.2.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.2">𝐄</ci><ci id="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.1.1.1.3">𝑚</ci></apply></apply><apply id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1"><csymbol cd="latexml" id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.2.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.2">norm</csymbol><apply id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.1.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1">subscript</csymbol><ci id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.2.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.2">𝐄</ci><ci id="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.3.cmml" xref="S4.SS1.p12.1.m1.3.3.3.1.1.1.2.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p12.1.m1.3c">sim(\mathbf{E}_{m},\mathbf{E}_{n})=\mathbf{E}_{m}\cdot\mathbf{E}_{n}/(\|%
\mathbf{E}_{m}\|\|\mathbf{E}_{n}\|)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p12.1.m1.3d">italic_s italic_i italic_m ( bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) = bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ⋅ bold_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT / ( ∥ bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∥ ∥ bold_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∥ )</annotation></semantics></math> is the cosine similarity and <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS1.p12.2.m2.1"><semantics id="S4.SS1.p12.2.m2.1a"><mi id="S4.SS1.p12.2.m2.1.1" xref="S4.SS1.p12.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p12.2.m2.1b"><ci id="S4.SS1.p12.2.m2.1.1.cmml" xref="S4.SS1.p12.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p12.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p12.2.m2.1d">italic_τ</annotation></semantics></math> is a temperature parameter which can be seen as weight for the most similar negative pair.</p>
</div>
<div class="ltx_para" id="S4.SS1.p13">
<p class="ltx_p" id="S4.SS1.p13.2">For molecular substructures, existing work demonstrates that the properties of drug molecules partially depend on specific substructures, and the treatment of a patient’s disease also relies on the functions of certain substructures. Our goal is to reconstruct the 3D structures of substructures to make them closer to the actual molecular structures. We first use the BRICS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib43" title="">43</a>]</cite> method to decompose drug molecules into substructures, and then complete the 3D information of the substructures using the API provided by RDKit <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib18" title="">18</a>]</cite>. We decompose all drug molecules to obtain a substructure set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S4.SS1.p13.1.m1.1"><semantics id="S4.SS1.p13.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p13.1.m1.1.1" xref="S4.SS1.p13.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.1.m1.1b"><ci id="S4.SS1.p13.1.m1.1.1.cmml" xref="S4.SS1.p13.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.1.m1.1d">caligraphic_S</annotation></semantics></math>, and finally obtain the embedding matrices of the two different modalities of the substructures <math alttext="\mathbf{E}_{s},\mathbf{E}_{st}\in\mathbb{R}^{|\mathcal{S}|\times h}" class="ltx_Math" display="inline" id="S4.SS1.p13.2.m2.3"><semantics id="S4.SS1.p13.2.m2.3a"><mrow id="S4.SS1.p13.2.m2.3.3" xref="S4.SS1.p13.2.m2.3.3.cmml"><mrow id="S4.SS1.p13.2.m2.3.3.2.2" xref="S4.SS1.p13.2.m2.3.3.2.3.cmml"><msub id="S4.SS1.p13.2.m2.2.2.1.1.1" xref="S4.SS1.p13.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p13.2.m2.2.2.1.1.1.2" xref="S4.SS1.p13.2.m2.2.2.1.1.1.2.cmml">𝐄</mi><mi id="S4.SS1.p13.2.m2.2.2.1.1.1.3" xref="S4.SS1.p13.2.m2.2.2.1.1.1.3.cmml">s</mi></msub><mo id="S4.SS1.p13.2.m2.3.3.2.2.3" xref="S4.SS1.p13.2.m2.3.3.2.3.cmml">,</mo><msub id="S4.SS1.p13.2.m2.3.3.2.2.2" xref="S4.SS1.p13.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.p13.2.m2.3.3.2.2.2.2" xref="S4.SS1.p13.2.m2.3.3.2.2.2.2.cmml">𝐄</mi><mrow id="S4.SS1.p13.2.m2.3.3.2.2.2.3" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3.cmml"><mi id="S4.SS1.p13.2.m2.3.3.2.2.2.3.2" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3.2.cmml">s</mi><mo id="S4.SS1.p13.2.m2.3.3.2.2.2.3.1" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p13.2.m2.3.3.2.2.2.3.3" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3.3.cmml">t</mi></mrow></msub></mrow><mo id="S4.SS1.p13.2.m2.3.3.3" xref="S4.SS1.p13.2.m2.3.3.3.cmml">∈</mo><msup id="S4.SS1.p13.2.m2.3.3.4" xref="S4.SS1.p13.2.m2.3.3.4.cmml"><mi id="S4.SS1.p13.2.m2.3.3.4.2" xref="S4.SS1.p13.2.m2.3.3.4.2.cmml">ℝ</mi><mrow id="S4.SS1.p13.2.m2.1.1.1" xref="S4.SS1.p13.2.m2.1.1.1.cmml"><mrow id="S4.SS1.p13.2.m2.1.1.1.3.2" xref="S4.SS1.p13.2.m2.1.1.1.3.1.cmml"><mo id="S4.SS1.p13.2.m2.1.1.1.3.2.1" stretchy="false" xref="S4.SS1.p13.2.m2.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p13.2.m2.1.1.1.1" xref="S4.SS1.p13.2.m2.1.1.1.1.cmml">𝒮</mi><mo id="S4.SS1.p13.2.m2.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S4.SS1.p13.2.m2.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS1.p13.2.m2.1.1.1.2" rspace="0.222em" xref="S4.SS1.p13.2.m2.1.1.1.2.cmml">×</mo><mi id="S4.SS1.p13.2.m2.1.1.1.4" xref="S4.SS1.p13.2.m2.1.1.1.4.cmml">h</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p13.2.m2.3b"><apply id="S4.SS1.p13.2.m2.3.3.cmml" xref="S4.SS1.p13.2.m2.3.3"><in id="S4.SS1.p13.2.m2.3.3.3.cmml" xref="S4.SS1.p13.2.m2.3.3.3"></in><list id="S4.SS1.p13.2.m2.3.3.2.3.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2"><apply id="S4.SS1.p13.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p13.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p13.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p13.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p13.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p13.2.m2.2.2.1.1.1.2">𝐄</ci><ci id="S4.SS1.p13.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.p13.2.m2.2.2.1.1.1.3">𝑠</ci></apply><apply id="S4.SS1.p13.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p13.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p13.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2.2.2">𝐄</ci><apply id="S4.SS1.p13.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3"><times id="S4.SS1.p13.2.m2.3.3.2.2.2.3.1.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3.1"></times><ci id="S4.SS1.p13.2.m2.3.3.2.2.2.3.2.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3.2">𝑠</ci><ci id="S4.SS1.p13.2.m2.3.3.2.2.2.3.3.cmml" xref="S4.SS1.p13.2.m2.3.3.2.2.2.3.3">𝑡</ci></apply></apply></list><apply id="S4.SS1.p13.2.m2.3.3.4.cmml" xref="S4.SS1.p13.2.m2.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p13.2.m2.3.3.4.1.cmml" xref="S4.SS1.p13.2.m2.3.3.4">superscript</csymbol><ci id="S4.SS1.p13.2.m2.3.3.4.2.cmml" xref="S4.SS1.p13.2.m2.3.3.4.2">ℝ</ci><apply id="S4.SS1.p13.2.m2.1.1.1.cmml" xref="S4.SS1.p13.2.m2.1.1.1"><times id="S4.SS1.p13.2.m2.1.1.1.2.cmml" xref="S4.SS1.p13.2.m2.1.1.1.2"></times><apply id="S4.SS1.p13.2.m2.1.1.1.3.1.cmml" xref="S4.SS1.p13.2.m2.1.1.1.3.2"><abs id="S4.SS1.p13.2.m2.1.1.1.3.1.1.cmml" xref="S4.SS1.p13.2.m2.1.1.1.3.2.1"></abs><ci id="S4.SS1.p13.2.m2.1.1.1.1.cmml" xref="S4.SS1.p13.2.m2.1.1.1.1">𝒮</ci></apply><ci id="S4.SS1.p13.2.m2.1.1.1.4.cmml" xref="S4.SS1.p13.2.m2.1.1.1.4">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p13.2.m2.3c">\mathbf{E}_{s},\mathbf{E}_{st}\in\mathbb{R}^{|\mathcal{S}|\times h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p13.2.m2.3d">bold_E start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT italic_s italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_S | × italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>, where each row represents the embedding of a specific substructure.</p>
</div>
<div class="ltx_para" id="S4.SS1.p14">
<p class="ltx_p" id="S4.SS1.p14.6">We apply this loss function to molecules and their substructures, inputting <math alttext="\mathbf{E}_{m}" class="ltx_Math" display="inline" id="S4.SS1.p14.1.m1.1"><semantics id="S4.SS1.p14.1.m1.1a"><msub id="S4.SS1.p14.1.m1.1.1" xref="S4.SS1.p14.1.m1.1.1.cmml"><mi id="S4.SS1.p14.1.m1.1.1.2" xref="S4.SS1.p14.1.m1.1.1.2.cmml">𝐄</mi><mi id="S4.SS1.p14.1.m1.1.1.3" xref="S4.SS1.p14.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p14.1.m1.1b"><apply id="S4.SS1.p14.1.m1.1.1.cmml" xref="S4.SS1.p14.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p14.1.m1.1.1.1.cmml" xref="S4.SS1.p14.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p14.1.m1.1.1.2.cmml" xref="S4.SS1.p14.1.m1.1.1.2">𝐄</ci><ci id="S4.SS1.p14.1.m1.1.1.3.cmml" xref="S4.SS1.p14.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p14.1.m1.1c">\mathbf{E}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p14.1.m1.1d">bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{E}_{mt}" class="ltx_Math" display="inline" id="S4.SS1.p14.2.m2.1"><semantics id="S4.SS1.p14.2.m2.1a"><msub id="S4.SS1.p14.2.m2.1.1" xref="S4.SS1.p14.2.m2.1.1.cmml"><mi id="S4.SS1.p14.2.m2.1.1.2" xref="S4.SS1.p14.2.m2.1.1.2.cmml">𝐄</mi><mrow id="S4.SS1.p14.2.m2.1.1.3" xref="S4.SS1.p14.2.m2.1.1.3.cmml"><mi id="S4.SS1.p14.2.m2.1.1.3.2" xref="S4.SS1.p14.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS1.p14.2.m2.1.1.3.1" xref="S4.SS1.p14.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.2.m2.1.1.3.3" xref="S4.SS1.p14.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p14.2.m2.1b"><apply id="S4.SS1.p14.2.m2.1.1.cmml" xref="S4.SS1.p14.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p14.2.m2.1.1.1.cmml" xref="S4.SS1.p14.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p14.2.m2.1.1.2.cmml" xref="S4.SS1.p14.2.m2.1.1.2">𝐄</ci><apply id="S4.SS1.p14.2.m2.1.1.3.cmml" xref="S4.SS1.p14.2.m2.1.1.3"><times id="S4.SS1.p14.2.m2.1.1.3.1.cmml" xref="S4.SS1.p14.2.m2.1.1.3.1"></times><ci id="S4.SS1.p14.2.m2.1.1.3.2.cmml" xref="S4.SS1.p14.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS1.p14.2.m2.1.1.3.3.cmml" xref="S4.SS1.p14.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p14.2.m2.1c">\mathbf{E}_{mt}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p14.2.m2.1d">bold_E start_POSTSUBSCRIPT italic_m italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into the above formula to obtain <math alttext="\mathcal{L}_{mol}" class="ltx_Math" display="inline" id="S4.SS1.p14.3.m3.1"><semantics id="S4.SS1.p14.3.m3.1a"><msub id="S4.SS1.p14.3.m3.1.1" xref="S4.SS1.p14.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p14.3.m3.1.1.2" xref="S4.SS1.p14.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p14.3.m3.1.1.3" xref="S4.SS1.p14.3.m3.1.1.3.cmml"><mi id="S4.SS1.p14.3.m3.1.1.3.2" xref="S4.SS1.p14.3.m3.1.1.3.2.cmml">m</mi><mo id="S4.SS1.p14.3.m3.1.1.3.1" xref="S4.SS1.p14.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.3.m3.1.1.3.3" xref="S4.SS1.p14.3.m3.1.1.3.3.cmml">o</mi><mo id="S4.SS1.p14.3.m3.1.1.3.1a" xref="S4.SS1.p14.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.3.m3.1.1.3.4" xref="S4.SS1.p14.3.m3.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p14.3.m3.1b"><apply id="S4.SS1.p14.3.m3.1.1.cmml" xref="S4.SS1.p14.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p14.3.m3.1.1.1.cmml" xref="S4.SS1.p14.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p14.3.m3.1.1.2.cmml" xref="S4.SS1.p14.3.m3.1.1.2">ℒ</ci><apply id="S4.SS1.p14.3.m3.1.1.3.cmml" xref="S4.SS1.p14.3.m3.1.1.3"><times id="S4.SS1.p14.3.m3.1.1.3.1.cmml" xref="S4.SS1.p14.3.m3.1.1.3.1"></times><ci id="S4.SS1.p14.3.m3.1.1.3.2.cmml" xref="S4.SS1.p14.3.m3.1.1.3.2">𝑚</ci><ci id="S4.SS1.p14.3.m3.1.1.3.3.cmml" xref="S4.SS1.p14.3.m3.1.1.3.3">𝑜</ci><ci id="S4.SS1.p14.3.m3.1.1.3.4.cmml" xref="S4.SS1.p14.3.m3.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p14.3.m3.1c">\mathcal{L}_{mol}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p14.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_m italic_o italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, and inputting <math alttext="\mathbf{E}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p14.4.m4.1"><semantics id="S4.SS1.p14.4.m4.1a"><msub id="S4.SS1.p14.4.m4.1.1" xref="S4.SS1.p14.4.m4.1.1.cmml"><mi id="S4.SS1.p14.4.m4.1.1.2" xref="S4.SS1.p14.4.m4.1.1.2.cmml">𝐄</mi><mi id="S4.SS1.p14.4.m4.1.1.3" xref="S4.SS1.p14.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p14.4.m4.1b"><apply id="S4.SS1.p14.4.m4.1.1.cmml" xref="S4.SS1.p14.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p14.4.m4.1.1.1.cmml" xref="S4.SS1.p14.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p14.4.m4.1.1.2.cmml" xref="S4.SS1.p14.4.m4.1.1.2">𝐄</ci><ci id="S4.SS1.p14.4.m4.1.1.3.cmml" xref="S4.SS1.p14.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p14.4.m4.1c">\mathbf{E}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p14.4.m4.1d">bold_E start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{E}_{st}" class="ltx_Math" display="inline" id="S4.SS1.p14.5.m5.1"><semantics id="S4.SS1.p14.5.m5.1a"><msub id="S4.SS1.p14.5.m5.1.1" xref="S4.SS1.p14.5.m5.1.1.cmml"><mi id="S4.SS1.p14.5.m5.1.1.2" xref="S4.SS1.p14.5.m5.1.1.2.cmml">𝐄</mi><mrow id="S4.SS1.p14.5.m5.1.1.3" xref="S4.SS1.p14.5.m5.1.1.3.cmml"><mi id="S4.SS1.p14.5.m5.1.1.3.2" xref="S4.SS1.p14.5.m5.1.1.3.2.cmml">s</mi><mo id="S4.SS1.p14.5.m5.1.1.3.1" xref="S4.SS1.p14.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.5.m5.1.1.3.3" xref="S4.SS1.p14.5.m5.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p14.5.m5.1b"><apply id="S4.SS1.p14.5.m5.1.1.cmml" xref="S4.SS1.p14.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p14.5.m5.1.1.1.cmml" xref="S4.SS1.p14.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p14.5.m5.1.1.2.cmml" xref="S4.SS1.p14.5.m5.1.1.2">𝐄</ci><apply id="S4.SS1.p14.5.m5.1.1.3.cmml" xref="S4.SS1.p14.5.m5.1.1.3"><times id="S4.SS1.p14.5.m5.1.1.3.1.cmml" xref="S4.SS1.p14.5.m5.1.1.3.1"></times><ci id="S4.SS1.p14.5.m5.1.1.3.2.cmml" xref="S4.SS1.p14.5.m5.1.1.3.2">𝑠</ci><ci id="S4.SS1.p14.5.m5.1.1.3.3.cmml" xref="S4.SS1.p14.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p14.5.m5.1c">\mathbf{E}_{st}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p14.5.m5.1d">bold_E start_POSTSUBSCRIPT italic_s italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into the above formula to obtain <math alttext="\mathcal{L}_{submol}" class="ltx_Math" display="inline" id="S4.SS1.p14.6.m6.1"><semantics id="S4.SS1.p14.6.m6.1a"><msub id="S4.SS1.p14.6.m6.1.1" xref="S4.SS1.p14.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p14.6.m6.1.1.2" xref="S4.SS1.p14.6.m6.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p14.6.m6.1.1.3" xref="S4.SS1.p14.6.m6.1.1.3.cmml"><mi id="S4.SS1.p14.6.m6.1.1.3.2" xref="S4.SS1.p14.6.m6.1.1.3.2.cmml">s</mi><mo id="S4.SS1.p14.6.m6.1.1.3.1" xref="S4.SS1.p14.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.6.m6.1.1.3.3" xref="S4.SS1.p14.6.m6.1.1.3.3.cmml">u</mi><mo id="S4.SS1.p14.6.m6.1.1.3.1a" xref="S4.SS1.p14.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.6.m6.1.1.3.4" xref="S4.SS1.p14.6.m6.1.1.3.4.cmml">b</mi><mo id="S4.SS1.p14.6.m6.1.1.3.1b" xref="S4.SS1.p14.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.6.m6.1.1.3.5" xref="S4.SS1.p14.6.m6.1.1.3.5.cmml">m</mi><mo id="S4.SS1.p14.6.m6.1.1.3.1c" xref="S4.SS1.p14.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.6.m6.1.1.3.6" xref="S4.SS1.p14.6.m6.1.1.3.6.cmml">o</mi><mo id="S4.SS1.p14.6.m6.1.1.3.1d" xref="S4.SS1.p14.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p14.6.m6.1.1.3.7" xref="S4.SS1.p14.6.m6.1.1.3.7.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p14.6.m6.1b"><apply id="S4.SS1.p14.6.m6.1.1.cmml" xref="S4.SS1.p14.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p14.6.m6.1.1.1.cmml" xref="S4.SS1.p14.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p14.6.m6.1.1.2.cmml" xref="S4.SS1.p14.6.m6.1.1.2">ℒ</ci><apply id="S4.SS1.p14.6.m6.1.1.3.cmml" xref="S4.SS1.p14.6.m6.1.1.3"><times id="S4.SS1.p14.6.m6.1.1.3.1.cmml" xref="S4.SS1.p14.6.m6.1.1.3.1"></times><ci id="S4.SS1.p14.6.m6.1.1.3.2.cmml" xref="S4.SS1.p14.6.m6.1.1.3.2">𝑠</ci><ci id="S4.SS1.p14.6.m6.1.1.3.3.cmml" xref="S4.SS1.p14.6.m6.1.1.3.3">𝑢</ci><ci id="S4.SS1.p14.6.m6.1.1.3.4.cmml" xref="S4.SS1.p14.6.m6.1.1.3.4">𝑏</ci><ci id="S4.SS1.p14.6.m6.1.1.3.5.cmml" xref="S4.SS1.p14.6.m6.1.1.3.5">𝑚</ci><ci id="S4.SS1.p14.6.m6.1.1.3.6.cmml" xref="S4.SS1.p14.6.m6.1.1.3.6">𝑜</ci><ci id="S4.SS1.p14.6.m6.1.1.3.7.cmml" xref="S4.SS1.p14.6.m6.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p14.6.m6.1c">\mathcal{L}_{submol}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p14.6.m6.1d">caligraphic_L start_POSTSUBSCRIPT italic_s italic_u italic_b italic_m italic_o italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Finally, we sum them to obtain the total loss function.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{total}=\mathcal{L}(\mathbf{E}_{m},\mathbf{E}_{mt})+\mathcal{L}(%
\mathbf{E}_{s},\mathbf{E}_{st})" class="ltx_Math" display="block" id="S4.E10.m1.4"><semantics id="S4.E10.m1.4a"><mrow id="S4.E10.m1.4.4" xref="S4.E10.m1.4.4.cmml"><msub id="S4.E10.m1.4.4.6" xref="S4.E10.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.4.4.6.2" xref="S4.E10.m1.4.4.6.2.cmml">ℒ</mi><mrow id="S4.E10.m1.4.4.6.3" xref="S4.E10.m1.4.4.6.3.cmml"><mi id="S4.E10.m1.4.4.6.3.2" xref="S4.E10.m1.4.4.6.3.2.cmml">t</mi><mo id="S4.E10.m1.4.4.6.3.1" xref="S4.E10.m1.4.4.6.3.1.cmml">⁢</mo><mi id="S4.E10.m1.4.4.6.3.3" xref="S4.E10.m1.4.4.6.3.3.cmml">o</mi><mo id="S4.E10.m1.4.4.6.3.1a" xref="S4.E10.m1.4.4.6.3.1.cmml">⁢</mo><mi id="S4.E10.m1.4.4.6.3.4" xref="S4.E10.m1.4.4.6.3.4.cmml">t</mi><mo id="S4.E10.m1.4.4.6.3.1b" xref="S4.E10.m1.4.4.6.3.1.cmml">⁢</mo><mi id="S4.E10.m1.4.4.6.3.5" xref="S4.E10.m1.4.4.6.3.5.cmml">a</mi><mo id="S4.E10.m1.4.4.6.3.1c" xref="S4.E10.m1.4.4.6.3.1.cmml">⁢</mo><mi id="S4.E10.m1.4.4.6.3.6" xref="S4.E10.m1.4.4.6.3.6.cmml">l</mi></mrow></msub><mo id="S4.E10.m1.4.4.5" xref="S4.E10.m1.4.4.5.cmml">=</mo><mrow id="S4.E10.m1.4.4.4" xref="S4.E10.m1.4.4.4.cmml"><mrow id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.2.2.2.4" xref="S4.E10.m1.2.2.2.2.4.cmml">ℒ</mi><mo id="S4.E10.m1.2.2.2.2.3" xref="S4.E10.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.E10.m1.2.2.2.2.2.2" xref="S4.E10.m1.2.2.2.2.2.3.cmml"><mo id="S4.E10.m1.2.2.2.2.2.2.3" stretchy="false" xref="S4.E10.m1.2.2.2.2.2.3.cmml">(</mo><msub id="S4.E10.m1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.2.cmml">𝐄</mi><mi id="S4.E10.m1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S4.E10.m1.2.2.2.2.2.2.4" xref="S4.E10.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E10.m1.2.2.2.2.2.2.2" xref="S4.E10.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E10.m1.2.2.2.2.2.2.2.2" xref="S4.E10.m1.2.2.2.2.2.2.2.2.cmml">𝐄</mi><mrow id="S4.E10.m1.2.2.2.2.2.2.2.3" xref="S4.E10.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E10.m1.2.2.2.2.2.2.2.3.2" xref="S4.E10.m1.2.2.2.2.2.2.2.3.2.cmml">m</mi><mo id="S4.E10.m1.2.2.2.2.2.2.2.3.1" xref="S4.E10.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E10.m1.2.2.2.2.2.2.2.3.3" xref="S4.E10.m1.2.2.2.2.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.E10.m1.2.2.2.2.2.2.5" stretchy="false" xref="S4.E10.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.4.4.4.5" xref="S4.E10.m1.4.4.4.5.cmml">+</mo><mrow id="S4.E10.m1.4.4.4.4" xref="S4.E10.m1.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.4.4.4.4.4" xref="S4.E10.m1.4.4.4.4.4.cmml">ℒ</mi><mo id="S4.E10.m1.4.4.4.4.3" xref="S4.E10.m1.4.4.4.4.3.cmml">⁢</mo><mrow id="S4.E10.m1.4.4.4.4.2.2" xref="S4.E10.m1.4.4.4.4.2.3.cmml"><mo id="S4.E10.m1.4.4.4.4.2.2.3" stretchy="false" xref="S4.E10.m1.4.4.4.4.2.3.cmml">(</mo><msub id="S4.E10.m1.3.3.3.3.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.1.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.1.2.cmml">𝐄</mi><mi id="S4.E10.m1.3.3.3.3.1.1.1.3" xref="S4.E10.m1.3.3.3.3.1.1.1.3.cmml">s</mi></msub><mo id="S4.E10.m1.4.4.4.4.2.2.4" xref="S4.E10.m1.4.4.4.4.2.3.cmml">,</mo><msub id="S4.E10.m1.4.4.4.4.2.2.2" xref="S4.E10.m1.4.4.4.4.2.2.2.cmml"><mi id="S4.E10.m1.4.4.4.4.2.2.2.2" xref="S4.E10.m1.4.4.4.4.2.2.2.2.cmml">𝐄</mi><mrow id="S4.E10.m1.4.4.4.4.2.2.2.3" xref="S4.E10.m1.4.4.4.4.2.2.2.3.cmml"><mi id="S4.E10.m1.4.4.4.4.2.2.2.3.2" xref="S4.E10.m1.4.4.4.4.2.2.2.3.2.cmml">s</mi><mo id="S4.E10.m1.4.4.4.4.2.2.2.3.1" xref="S4.E10.m1.4.4.4.4.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E10.m1.4.4.4.4.2.2.2.3.3" xref="S4.E10.m1.4.4.4.4.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.E10.m1.4.4.4.4.2.2.5" stretchy="false" xref="S4.E10.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.4b"><apply id="S4.E10.m1.4.4.cmml" xref="S4.E10.m1.4.4"><eq id="S4.E10.m1.4.4.5.cmml" xref="S4.E10.m1.4.4.5"></eq><apply id="S4.E10.m1.4.4.6.cmml" xref="S4.E10.m1.4.4.6"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.6.1.cmml" xref="S4.E10.m1.4.4.6">subscript</csymbol><ci id="S4.E10.m1.4.4.6.2.cmml" xref="S4.E10.m1.4.4.6.2">ℒ</ci><apply id="S4.E10.m1.4.4.6.3.cmml" xref="S4.E10.m1.4.4.6.3"><times id="S4.E10.m1.4.4.6.3.1.cmml" xref="S4.E10.m1.4.4.6.3.1"></times><ci id="S4.E10.m1.4.4.6.3.2.cmml" xref="S4.E10.m1.4.4.6.3.2">𝑡</ci><ci id="S4.E10.m1.4.4.6.3.3.cmml" xref="S4.E10.m1.4.4.6.3.3">𝑜</ci><ci id="S4.E10.m1.4.4.6.3.4.cmml" xref="S4.E10.m1.4.4.6.3.4">𝑡</ci><ci id="S4.E10.m1.4.4.6.3.5.cmml" xref="S4.E10.m1.4.4.6.3.5">𝑎</ci><ci id="S4.E10.m1.4.4.6.3.6.cmml" xref="S4.E10.m1.4.4.6.3.6">𝑙</ci></apply></apply><apply id="S4.E10.m1.4.4.4.cmml" xref="S4.E10.m1.4.4.4"><plus id="S4.E10.m1.4.4.4.5.cmml" xref="S4.E10.m1.4.4.4.5"></plus><apply id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2"><times id="S4.E10.m1.2.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.2.3"></times><ci id="S4.E10.m1.2.2.2.2.4.cmml" xref="S4.E10.m1.2.2.2.2.4">ℒ</ci><interval closure="open" id="S4.E10.m1.2.2.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.2.2.2"><apply id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2">𝐄</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S4.E10.m1.2.2.2.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E10.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E10.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2.2.2.2.2">𝐄</ci><apply id="S4.E10.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.2.2.2.2.3"><times id="S4.E10.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E10.m1.2.2.2.2.2.2.2.3.1"></times><ci id="S4.E10.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E10.m1.2.2.2.2.2.2.2.3.2">𝑚</ci><ci id="S4.E10.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E10.m1.2.2.2.2.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply><apply id="S4.E10.m1.4.4.4.4.cmml" xref="S4.E10.m1.4.4.4.4"><times id="S4.E10.m1.4.4.4.4.3.cmml" xref="S4.E10.m1.4.4.4.4.3"></times><ci id="S4.E10.m1.4.4.4.4.4.cmml" xref="S4.E10.m1.4.4.4.4.4">ℒ</ci><interval closure="open" id="S4.E10.m1.4.4.4.4.2.3.cmml" xref="S4.E10.m1.4.4.4.4.2.2"><apply id="S4.E10.m1.3.3.3.3.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.2">𝐄</ci><ci id="S4.E10.m1.3.3.3.3.1.1.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.3">𝑠</ci></apply><apply id="S4.E10.m1.4.4.4.4.2.2.2.cmml" xref="S4.E10.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.4.4.2.2.2.1.cmml" xref="S4.E10.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S4.E10.m1.4.4.4.4.2.2.2.2.cmml" xref="S4.E10.m1.4.4.4.4.2.2.2.2">𝐄</ci><apply id="S4.E10.m1.4.4.4.4.2.2.2.3.cmml" xref="S4.E10.m1.4.4.4.4.2.2.2.3"><times id="S4.E10.m1.4.4.4.4.2.2.2.3.1.cmml" xref="S4.E10.m1.4.4.4.4.2.2.2.3.1"></times><ci id="S4.E10.m1.4.4.4.4.2.2.2.3.2.cmml" xref="S4.E10.m1.4.4.4.4.2.2.2.3.2">𝑠</ci><ci id="S4.E10.m1.4.4.4.4.2.2.2.3.3.cmml" xref="S4.E10.m1.4.4.4.4.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.4c">\mathcal{L}_{total}=\mathcal{L}(\mathbf{E}_{m},\mathbf{E}_{mt})+\mathcal{L}(%
\mathbf{E}_{s},\mathbf{E}_{st})</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.4d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT = caligraphic_L ( bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT italic_m italic_t end_POSTSUBSCRIPT ) + caligraphic_L ( bold_E start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT italic_s italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Molecular Multi-Enhancement</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">At this stage, our goal is to achieve synergistic enhancement between deep molecular knowledge and shallow patient representations. Based on the most recently accessed patient status, we obtain the current patient’s weights for drug molecules and their structures under different temporal conditions, resulting in interaction outcomes in various temporal environments.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.16">We encode the current diagnoses, surgeries, and medications as the health environment of the patient at the current time sequence. We first extract the sets of procedures, diagnoses, and medications at each time point from the visit <math alttext="v(t-1)" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">v</mi><mo id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p2.1.m1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"></times><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝑣</ci><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1"><minus id="S4.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1"></minus><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2">𝑡</ci><cn id="S4.SS2.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">v(t-1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_v ( italic_t - 1 )</annotation></semantics></math>: <math alttext="d(t-1)=\{d_{i},d_{j},\ldots\}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.4"><semantics id="S4.SS2.p2.2.m2.4a"><mrow id="S4.SS2.p2.2.m2.4.4" xref="S4.SS2.p2.2.m2.4.4.cmml"><mrow id="S4.SS2.p2.2.m2.2.2.1" xref="S4.SS2.p2.2.m2.2.2.1.cmml"><mi id="S4.SS2.p2.2.m2.2.2.1.3" xref="S4.SS2.p2.2.m2.2.2.1.3.cmml">d</mi><mo id="S4.SS2.p2.2.m2.2.2.1.2" xref="S4.SS2.p2.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.2.m2.2.2.1.1.1" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.cmml"><mo id="S4.SS2.p2.2.m2.2.2.1.1.1.2" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.2.m2.2.2.1.1.1.1" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p2.2.m2.2.2.1.1.1.1.2" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.2.cmml">t</mi><mo id="S4.SS2.p2.2.m2.2.2.1.1.1.1.1" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p2.2.m2.2.2.1.1.1.1.3" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.2.m2.2.2.1.1.1.3" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.2.m2.4.4.4" xref="S4.SS2.p2.2.m2.4.4.4.cmml">=</mo><mrow id="S4.SS2.p2.2.m2.4.4.3.2" xref="S4.SS2.p2.2.m2.4.4.3.3.cmml"><mo id="S4.SS2.p2.2.m2.4.4.3.2.3" stretchy="false" xref="S4.SS2.p2.2.m2.4.4.3.3.cmml">{</mo><msub id="S4.SS2.p2.2.m2.3.3.2.1.1" xref="S4.SS2.p2.2.m2.3.3.2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.3.3.2.1.1.2" xref="S4.SS2.p2.2.m2.3.3.2.1.1.2.cmml">d</mi><mi id="S4.SS2.p2.2.m2.3.3.2.1.1.3" xref="S4.SS2.p2.2.m2.3.3.2.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p2.2.m2.4.4.3.2.4" xref="S4.SS2.p2.2.m2.4.4.3.3.cmml">,</mo><msub id="S4.SS2.p2.2.m2.4.4.3.2.2" xref="S4.SS2.p2.2.m2.4.4.3.2.2.cmml"><mi id="S4.SS2.p2.2.m2.4.4.3.2.2.2" xref="S4.SS2.p2.2.m2.4.4.3.2.2.2.cmml">d</mi><mi id="S4.SS2.p2.2.m2.4.4.3.2.2.3" xref="S4.SS2.p2.2.m2.4.4.3.2.2.3.cmml">j</mi></msub><mo id="S4.SS2.p2.2.m2.4.4.3.2.5" xref="S4.SS2.p2.2.m2.4.4.3.3.cmml">,</mo><mi id="S4.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S4.SS2.p2.2.m2.1.1.cmml">…</mi><mo id="S4.SS2.p2.2.m2.4.4.3.2.6" stretchy="false" xref="S4.SS2.p2.2.m2.4.4.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.4b"><apply id="S4.SS2.p2.2.m2.4.4.cmml" xref="S4.SS2.p2.2.m2.4.4"><eq id="S4.SS2.p2.2.m2.4.4.4.cmml" xref="S4.SS2.p2.2.m2.4.4.4"></eq><apply id="S4.SS2.p2.2.m2.2.2.1.cmml" xref="S4.SS2.p2.2.m2.2.2.1"><times id="S4.SS2.p2.2.m2.2.2.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.1.2"></times><ci id="S4.SS2.p2.2.m2.2.2.1.3.cmml" xref="S4.SS2.p2.2.m2.2.2.1.3">𝑑</ci><apply id="S4.SS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1"><minus id="S4.SS2.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.1"></minus><ci id="S4.SS2.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.2">𝑡</ci><cn id="S4.SS2.p2.2.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.3">1</cn></apply></apply><set id="S4.SS2.p2.2.m2.4.4.3.3.cmml" xref="S4.SS2.p2.2.m2.4.4.3.2"><apply id="S4.SS2.p2.2.m2.3.3.2.1.1.cmml" xref="S4.SS2.p2.2.m2.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.3.3.2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.3.3.2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.3.3.2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.3.3.2.1.1.2">𝑑</ci><ci id="S4.SS2.p2.2.m2.3.3.2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.3.3.2.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p2.2.m2.4.4.3.2.2.cmml" xref="S4.SS2.p2.2.m2.4.4.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.4.4.3.2.2.1.cmml" xref="S4.SS2.p2.2.m2.4.4.3.2.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.4.4.3.2.2.2.cmml" xref="S4.SS2.p2.2.m2.4.4.3.2.2.2">𝑑</ci><ci id="S4.SS2.p2.2.m2.4.4.3.2.2.3.cmml" xref="S4.SS2.p2.2.m2.4.4.3.2.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.4c">d(t-1)=\{d_{i},d_{j},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.4d">italic_d ( italic_t - 1 ) = { italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , … }</annotation></semantics></math>, <math alttext="p(t-1)=\{p_{i},p_{j},\ldots\}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.4"><semantics id="S4.SS2.p2.3.m3.4a"><mrow id="S4.SS2.p2.3.m3.4.4" xref="S4.SS2.p2.3.m3.4.4.cmml"><mrow id="S4.SS2.p2.3.m3.2.2.1" xref="S4.SS2.p2.3.m3.2.2.1.cmml"><mi id="S4.SS2.p2.3.m3.2.2.1.3" xref="S4.SS2.p2.3.m3.2.2.1.3.cmml">p</mi><mo id="S4.SS2.p2.3.m3.2.2.1.2" xref="S4.SS2.p2.3.m3.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.3.m3.2.2.1.1.1" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.cmml"><mo id="S4.SS2.p2.3.m3.2.2.1.1.1.2" stretchy="false" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.3.m3.2.2.1.1.1.1" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p2.3.m3.2.2.1.1.1.1.2" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.2.cmml">t</mi><mo id="S4.SS2.p2.3.m3.2.2.1.1.1.1.1" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p2.3.m3.2.2.1.1.1.1.3" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.3.m3.2.2.1.1.1.3" stretchy="false" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.3.m3.4.4.4" xref="S4.SS2.p2.3.m3.4.4.4.cmml">=</mo><mrow id="S4.SS2.p2.3.m3.4.4.3.2" xref="S4.SS2.p2.3.m3.4.4.3.3.cmml"><mo id="S4.SS2.p2.3.m3.4.4.3.2.3" stretchy="false" xref="S4.SS2.p2.3.m3.4.4.3.3.cmml">{</mo><msub id="S4.SS2.p2.3.m3.3.3.2.1.1" xref="S4.SS2.p2.3.m3.3.3.2.1.1.cmml"><mi id="S4.SS2.p2.3.m3.3.3.2.1.1.2" xref="S4.SS2.p2.3.m3.3.3.2.1.1.2.cmml">p</mi><mi id="S4.SS2.p2.3.m3.3.3.2.1.1.3" xref="S4.SS2.p2.3.m3.3.3.2.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p2.3.m3.4.4.3.2.4" xref="S4.SS2.p2.3.m3.4.4.3.3.cmml">,</mo><msub id="S4.SS2.p2.3.m3.4.4.3.2.2" xref="S4.SS2.p2.3.m3.4.4.3.2.2.cmml"><mi id="S4.SS2.p2.3.m3.4.4.3.2.2.2" xref="S4.SS2.p2.3.m3.4.4.3.2.2.2.cmml">p</mi><mi id="S4.SS2.p2.3.m3.4.4.3.2.2.3" xref="S4.SS2.p2.3.m3.4.4.3.2.2.3.cmml">j</mi></msub><mo id="S4.SS2.p2.3.m3.4.4.3.2.5" xref="S4.SS2.p2.3.m3.4.4.3.3.cmml">,</mo><mi id="S4.SS2.p2.3.m3.1.1" mathvariant="normal" xref="S4.SS2.p2.3.m3.1.1.cmml">…</mi><mo id="S4.SS2.p2.3.m3.4.4.3.2.6" stretchy="false" xref="S4.SS2.p2.3.m3.4.4.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.4b"><apply id="S4.SS2.p2.3.m3.4.4.cmml" xref="S4.SS2.p2.3.m3.4.4"><eq id="S4.SS2.p2.3.m3.4.4.4.cmml" xref="S4.SS2.p2.3.m3.4.4.4"></eq><apply id="S4.SS2.p2.3.m3.2.2.1.cmml" xref="S4.SS2.p2.3.m3.2.2.1"><times id="S4.SS2.p2.3.m3.2.2.1.2.cmml" xref="S4.SS2.p2.3.m3.2.2.1.2"></times><ci id="S4.SS2.p2.3.m3.2.2.1.3.cmml" xref="S4.SS2.p2.3.m3.2.2.1.3">𝑝</ci><apply id="S4.SS2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.2.2.1.1.1"><minus id="S4.SS2.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.1"></minus><ci id="S4.SS2.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.2">𝑡</ci><cn id="S4.SS2.p2.3.m3.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.3.m3.2.2.1.1.1.1.3">1</cn></apply></apply><set id="S4.SS2.p2.3.m3.4.4.3.3.cmml" xref="S4.SS2.p2.3.m3.4.4.3.2"><apply id="S4.SS2.p2.3.m3.3.3.2.1.1.cmml" xref="S4.SS2.p2.3.m3.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.3.3.2.1.1.1.cmml" xref="S4.SS2.p2.3.m3.3.3.2.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.3.3.2.1.1.2.cmml" xref="S4.SS2.p2.3.m3.3.3.2.1.1.2">𝑝</ci><ci id="S4.SS2.p2.3.m3.3.3.2.1.1.3.cmml" xref="S4.SS2.p2.3.m3.3.3.2.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p2.3.m3.4.4.3.2.2.cmml" xref="S4.SS2.p2.3.m3.4.4.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.4.4.3.2.2.1.cmml" xref="S4.SS2.p2.3.m3.4.4.3.2.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.4.4.3.2.2.2.cmml" xref="S4.SS2.p2.3.m3.4.4.3.2.2.2">𝑝</ci><ci id="S4.SS2.p2.3.m3.4.4.3.2.2.3.cmml" xref="S4.SS2.p2.3.m3.4.4.3.2.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.4c">p(t-1)=\{p_{i},p_{j},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.4d">italic_p ( italic_t - 1 ) = { italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , … }</annotation></semantics></math>, and <math alttext="m(t-1)=\{m_{i},m_{j},\ldots\}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.4"><semantics id="S4.SS2.p2.4.m4.4a"><mrow id="S4.SS2.p2.4.m4.4.4" xref="S4.SS2.p2.4.m4.4.4.cmml"><mrow id="S4.SS2.p2.4.m4.2.2.1" xref="S4.SS2.p2.4.m4.2.2.1.cmml"><mi id="S4.SS2.p2.4.m4.2.2.1.3" xref="S4.SS2.p2.4.m4.2.2.1.3.cmml">m</mi><mo id="S4.SS2.p2.4.m4.2.2.1.2" xref="S4.SS2.p2.4.m4.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.4.m4.2.2.1.1.1" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.cmml"><mo id="S4.SS2.p2.4.m4.2.2.1.1.1.2" stretchy="false" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.4.m4.2.2.1.1.1.1" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p2.4.m4.2.2.1.1.1.1.2" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.2.cmml">t</mi><mo id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p2.4.m4.2.2.1.1.1.1.3" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p2.4.m4.2.2.1.1.1.3" stretchy="false" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.4.m4.4.4.4" xref="S4.SS2.p2.4.m4.4.4.4.cmml">=</mo><mrow id="S4.SS2.p2.4.m4.4.4.3.2" xref="S4.SS2.p2.4.m4.4.4.3.3.cmml"><mo id="S4.SS2.p2.4.m4.4.4.3.2.3" stretchy="false" xref="S4.SS2.p2.4.m4.4.4.3.3.cmml">{</mo><msub id="S4.SS2.p2.4.m4.3.3.2.1.1" xref="S4.SS2.p2.4.m4.3.3.2.1.1.cmml"><mi id="S4.SS2.p2.4.m4.3.3.2.1.1.2" xref="S4.SS2.p2.4.m4.3.3.2.1.1.2.cmml">m</mi><mi id="S4.SS2.p2.4.m4.3.3.2.1.1.3" xref="S4.SS2.p2.4.m4.3.3.2.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p2.4.m4.4.4.3.2.4" xref="S4.SS2.p2.4.m4.4.4.3.3.cmml">,</mo><msub id="S4.SS2.p2.4.m4.4.4.3.2.2" xref="S4.SS2.p2.4.m4.4.4.3.2.2.cmml"><mi id="S4.SS2.p2.4.m4.4.4.3.2.2.2" xref="S4.SS2.p2.4.m4.4.4.3.2.2.2.cmml">m</mi><mi id="S4.SS2.p2.4.m4.4.4.3.2.2.3" xref="S4.SS2.p2.4.m4.4.4.3.2.2.3.cmml">j</mi></msub><mo id="S4.SS2.p2.4.m4.4.4.3.2.5" xref="S4.SS2.p2.4.m4.4.4.3.3.cmml">,</mo><mi id="S4.SS2.p2.4.m4.1.1" mathvariant="normal" xref="S4.SS2.p2.4.m4.1.1.cmml">…</mi><mo id="S4.SS2.p2.4.m4.4.4.3.2.6" stretchy="false" xref="S4.SS2.p2.4.m4.4.4.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.4b"><apply id="S4.SS2.p2.4.m4.4.4.cmml" xref="S4.SS2.p2.4.m4.4.4"><eq id="S4.SS2.p2.4.m4.4.4.4.cmml" xref="S4.SS2.p2.4.m4.4.4.4"></eq><apply id="S4.SS2.p2.4.m4.2.2.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1"><times id="S4.SS2.p2.4.m4.2.2.1.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.2"></times><ci id="S4.SS2.p2.4.m4.2.2.1.3.cmml" xref="S4.SS2.p2.4.m4.2.2.1.3">𝑚</ci><apply id="S4.SS2.p2.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1"><minus id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1"></minus><ci id="S4.SS2.p2.4.m4.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.2">𝑡</ci><cn id="S4.SS2.p2.4.m4.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.3">1</cn></apply></apply><set id="S4.SS2.p2.4.m4.4.4.3.3.cmml" xref="S4.SS2.p2.4.m4.4.4.3.2"><apply id="S4.SS2.p2.4.m4.3.3.2.1.1.cmml" xref="S4.SS2.p2.4.m4.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.3.3.2.1.1.1.cmml" xref="S4.SS2.p2.4.m4.3.3.2.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.3.3.2.1.1.2.cmml" xref="S4.SS2.p2.4.m4.3.3.2.1.1.2">𝑚</ci><ci id="S4.SS2.p2.4.m4.3.3.2.1.1.3.cmml" xref="S4.SS2.p2.4.m4.3.3.2.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p2.4.m4.4.4.3.2.2.cmml" xref="S4.SS2.p2.4.m4.4.4.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.4.4.3.2.2.1.cmml" xref="S4.SS2.p2.4.m4.4.4.3.2.2">subscript</csymbol><ci id="S4.SS2.p2.4.m4.4.4.3.2.2.2.cmml" xref="S4.SS2.p2.4.m4.4.4.3.2.2.2">𝑚</ci><ci id="S4.SS2.p2.4.m4.4.4.3.2.2.3.cmml" xref="S4.SS2.p2.4.m4.4.4.3.2.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.4c">m(t-1)=\{m_{i},m_{j},\ldots\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.4d">italic_m ( italic_t - 1 ) = { italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , … }</annotation></semantics></math>, all of which are multi-hot vectors mentioned in our problem definition. We define three learnable embedding matrices, <math alttext="\mathbf{E}_{d}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">𝐄</mi><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝐄</ci><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\mathbf{E}_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">bold_E start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{E}_{p}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><msub id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">𝐄</mi><mi id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝐄</ci><ci id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\mathbf{E}_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">bold_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{E}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><msub id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">𝐄</mi><mi id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝐄</ci><ci id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">\mathbf{E}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, corresponding to diagnoses, surgeries, and medications. We generate <math alttext="\mathbf{e}_{d_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p2.8.m8.1"><semantics id="S4.SS2.p2.8.m8.1a"><msub id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml"><mi id="S4.SS2.p2.8.m8.1.1.2" xref="S4.SS2.p2.8.m8.1.1.2.cmml">𝐞</mi><msub id="S4.SS2.p2.8.m8.1.1.3" xref="S4.SS2.p2.8.m8.1.1.3.cmml"><mi id="S4.SS2.p2.8.m8.1.1.3.2" xref="S4.SS2.p2.8.m8.1.1.3.2.cmml">d</mi><mi id="S4.SS2.p2.8.m8.1.1.3.3" xref="S4.SS2.p2.8.m8.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.1.1.2.cmml" xref="S4.SS2.p2.8.m8.1.1.2">𝐞</ci><apply id="S4.SS2.p2.8.m8.1.1.3.cmml" xref="S4.SS2.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.1.1.3.1.cmml" xref="S4.SS2.p2.8.m8.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.8.m8.1.1.3.2.cmml" xref="S4.SS2.p2.8.m8.1.1.3.2">𝑑</ci><ci id="S4.SS2.p2.8.m8.1.1.3.3.cmml" xref="S4.SS2.p2.8.m8.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">\mathbf{e}_{d_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.8.m8.1d">bold_e start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{e}_{p_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p2.9.m9.1"><semantics id="S4.SS2.p2.9.m9.1a"><msub id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml"><mi id="S4.SS2.p2.9.m9.1.1.2" xref="S4.SS2.p2.9.m9.1.1.2.cmml">𝐞</mi><msub id="S4.SS2.p2.9.m9.1.1.3" xref="S4.SS2.p2.9.m9.1.1.3.cmml"><mi id="S4.SS2.p2.9.m9.1.1.3.2" xref="S4.SS2.p2.9.m9.1.1.3.2.cmml">p</mi><mi id="S4.SS2.p2.9.m9.1.1.3.3" xref="S4.SS2.p2.9.m9.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><apply id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2">𝐞</ci><apply id="S4.SS2.p2.9.m9.1.1.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.3.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.3.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.2">𝑝</ci><ci id="S4.SS2.p2.9.m9.1.1.3.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">\mathbf{e}_{p_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.9.m9.1d">bold_e start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{e}_{m_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p2.10.m10.1"><semantics id="S4.SS2.p2.10.m10.1a"><msub id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml"><mi id="S4.SS2.p2.10.m10.1.1.2" xref="S4.SS2.p2.10.m10.1.1.2.cmml">𝐞</mi><msub id="S4.SS2.p2.10.m10.1.1.3" xref="S4.SS2.p2.10.m10.1.1.3.cmml"><mi id="S4.SS2.p2.10.m10.1.1.3.2" xref="S4.SS2.p2.10.m10.1.1.3.2.cmml">m</mi><mi id="S4.SS2.p2.10.m10.1.1.3.3" xref="S4.SS2.p2.10.m10.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><apply id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m10.1.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m10.1.1.2.cmml" xref="S4.SS2.p2.10.m10.1.1.2">𝐞</ci><apply id="S4.SS2.p2.10.m10.1.1.3.cmml" xref="S4.SS2.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m10.1.1.3.1.cmml" xref="S4.SS2.p2.10.m10.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.10.m10.1.1.3.2.cmml" xref="S4.SS2.p2.10.m10.1.1.3.2">𝑚</ci><ci id="S4.SS2.p2.10.m10.1.1.3.3.cmml" xref="S4.SS2.p2.10.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">\mathbf{e}_{m_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.10.m10.1d">bold_e start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> by mapping diagnoses <math alttext="d_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.11.m11.1"><semantics id="S4.SS2.p2.11.m11.1a"><msub id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml"><mi id="S4.SS2.p2.11.m11.1.1.2" xref="S4.SS2.p2.11.m11.1.1.2.cmml">d</mi><mi id="S4.SS2.p2.11.m11.1.1.3" xref="S4.SS2.p2.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.1b"><apply id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.p2.11.m11.1.1.2.cmml" xref="S4.SS2.p2.11.m11.1.1.2">𝑑</ci><ci id="S4.SS2.p2.11.m11.1.1.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.11.m11.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, surgeries <math alttext="p_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.12.m12.1"><semantics id="S4.SS2.p2.12.m12.1a"><msub id="S4.SS2.p2.12.m12.1.1" xref="S4.SS2.p2.12.m12.1.1.cmml"><mi id="S4.SS2.p2.12.m12.1.1.2" xref="S4.SS2.p2.12.m12.1.1.2.cmml">p</mi><mi id="S4.SS2.p2.12.m12.1.1.3" xref="S4.SS2.p2.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m12.1b"><apply id="S4.SS2.p2.12.m12.1.1.cmml" xref="S4.SS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m12.1.1.1.cmml" xref="S4.SS2.p2.12.m12.1.1">subscript</csymbol><ci id="S4.SS2.p2.12.m12.1.1.2.cmml" xref="S4.SS2.p2.12.m12.1.1.2">𝑝</ci><ci id="S4.SS2.p2.12.m12.1.1.3.cmml" xref="S4.SS2.p2.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m12.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.12.m12.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and medications <math alttext="m_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.13.m13.1"><semantics id="S4.SS2.p2.13.m13.1a"><msub id="S4.SS2.p2.13.m13.1.1" xref="S4.SS2.p2.13.m13.1.1.cmml"><mi id="S4.SS2.p2.13.m13.1.1.2" xref="S4.SS2.p2.13.m13.1.1.2.cmml">m</mi><mi id="S4.SS2.p2.13.m13.1.1.3" xref="S4.SS2.p2.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m13.1b"><apply id="S4.SS2.p2.13.m13.1.1.cmml" xref="S4.SS2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.13.m13.1.1.1.cmml" xref="S4.SS2.p2.13.m13.1.1">subscript</csymbol><ci id="S4.SS2.p2.13.m13.1.1.2.cmml" xref="S4.SS2.p2.13.m13.1.1.2">𝑚</ci><ci id="S4.SS2.p2.13.m13.1.1.3.cmml" xref="S4.SS2.p2.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m13.1c">m_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.13.m13.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to the embedding space, and use them as entity-level representations shared globally for downstream tasks. We obtain the set representations <math alttext="\mathbf{e}_{d}(t)" class="ltx_Math" display="inline" id="S4.SS2.p2.14.m14.1"><semantics id="S4.SS2.p2.14.m14.1a"><mrow id="S4.SS2.p2.14.m14.1.2" xref="S4.SS2.p2.14.m14.1.2.cmml"><msub id="S4.SS2.p2.14.m14.1.2.2" xref="S4.SS2.p2.14.m14.1.2.2.cmml"><mi id="S4.SS2.p2.14.m14.1.2.2.2" xref="S4.SS2.p2.14.m14.1.2.2.2.cmml">𝐞</mi><mi id="S4.SS2.p2.14.m14.1.2.2.3" xref="S4.SS2.p2.14.m14.1.2.2.3.cmml">d</mi></msub><mo id="S4.SS2.p2.14.m14.1.2.1" xref="S4.SS2.p2.14.m14.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.14.m14.1.2.3.2" xref="S4.SS2.p2.14.m14.1.2.cmml"><mo id="S4.SS2.p2.14.m14.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.14.m14.1.2.cmml">(</mo><mi id="S4.SS2.p2.14.m14.1.1" xref="S4.SS2.p2.14.m14.1.1.cmml">t</mi><mo id="S4.SS2.p2.14.m14.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.14.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m14.1b"><apply id="S4.SS2.p2.14.m14.1.2.cmml" xref="S4.SS2.p2.14.m14.1.2"><times id="S4.SS2.p2.14.m14.1.2.1.cmml" xref="S4.SS2.p2.14.m14.1.2.1"></times><apply id="S4.SS2.p2.14.m14.1.2.2.cmml" xref="S4.SS2.p2.14.m14.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.14.m14.1.2.2.1.cmml" xref="S4.SS2.p2.14.m14.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.14.m14.1.2.2.2.cmml" xref="S4.SS2.p2.14.m14.1.2.2.2">𝐞</ci><ci id="S4.SS2.p2.14.m14.1.2.2.3.cmml" xref="S4.SS2.p2.14.m14.1.2.2.3">𝑑</ci></apply><ci id="S4.SS2.p2.14.m14.1.1.cmml" xref="S4.SS2.p2.14.m14.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m14.1c">\mathbf{e}_{d}(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.14.m14.1d">bold_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math>, <math alttext="\mathbf{e}_{p}(t)" class="ltx_Math" display="inline" id="S4.SS2.p2.15.m15.1"><semantics id="S4.SS2.p2.15.m15.1a"><mrow id="S4.SS2.p2.15.m15.1.2" xref="S4.SS2.p2.15.m15.1.2.cmml"><msub id="S4.SS2.p2.15.m15.1.2.2" xref="S4.SS2.p2.15.m15.1.2.2.cmml"><mi id="S4.SS2.p2.15.m15.1.2.2.2" xref="S4.SS2.p2.15.m15.1.2.2.2.cmml">𝐞</mi><mi id="S4.SS2.p2.15.m15.1.2.2.3" xref="S4.SS2.p2.15.m15.1.2.2.3.cmml">p</mi></msub><mo id="S4.SS2.p2.15.m15.1.2.1" xref="S4.SS2.p2.15.m15.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.15.m15.1.2.3.2" xref="S4.SS2.p2.15.m15.1.2.cmml"><mo id="S4.SS2.p2.15.m15.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.15.m15.1.2.cmml">(</mo><mi id="S4.SS2.p2.15.m15.1.1" xref="S4.SS2.p2.15.m15.1.1.cmml">t</mi><mo id="S4.SS2.p2.15.m15.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.15.m15.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m15.1b"><apply id="S4.SS2.p2.15.m15.1.2.cmml" xref="S4.SS2.p2.15.m15.1.2"><times id="S4.SS2.p2.15.m15.1.2.1.cmml" xref="S4.SS2.p2.15.m15.1.2.1"></times><apply id="S4.SS2.p2.15.m15.1.2.2.cmml" xref="S4.SS2.p2.15.m15.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m15.1.2.2.1.cmml" xref="S4.SS2.p2.15.m15.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.15.m15.1.2.2.2.cmml" xref="S4.SS2.p2.15.m15.1.2.2.2">𝐞</ci><ci id="S4.SS2.p2.15.m15.1.2.2.3.cmml" xref="S4.SS2.p2.15.m15.1.2.2.3">𝑝</ci></apply><ci id="S4.SS2.p2.15.m15.1.1.cmml" xref="S4.SS2.p2.15.m15.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m15.1c">\mathbf{e}_{p}(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.15.m15.1d">bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math>, and <math alttext="\mathbf{e}_{m}(t)" class="ltx_Math" display="inline" id="S4.SS2.p2.16.m16.1"><semantics id="S4.SS2.p2.16.m16.1a"><mrow id="S4.SS2.p2.16.m16.1.2" xref="S4.SS2.p2.16.m16.1.2.cmml"><msub id="S4.SS2.p2.16.m16.1.2.2" xref="S4.SS2.p2.16.m16.1.2.2.cmml"><mi id="S4.SS2.p2.16.m16.1.2.2.2" xref="S4.SS2.p2.16.m16.1.2.2.2.cmml">𝐞</mi><mi id="S4.SS2.p2.16.m16.1.2.2.3" xref="S4.SS2.p2.16.m16.1.2.2.3.cmml">m</mi></msub><mo id="S4.SS2.p2.16.m16.1.2.1" xref="S4.SS2.p2.16.m16.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.16.m16.1.2.3.2" xref="S4.SS2.p2.16.m16.1.2.cmml"><mo id="S4.SS2.p2.16.m16.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.16.m16.1.2.cmml">(</mo><mi id="S4.SS2.p2.16.m16.1.1" xref="S4.SS2.p2.16.m16.1.1.cmml">t</mi><mo id="S4.SS2.p2.16.m16.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.16.m16.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m16.1b"><apply id="S4.SS2.p2.16.m16.1.2.cmml" xref="S4.SS2.p2.16.m16.1.2"><times id="S4.SS2.p2.16.m16.1.2.1.cmml" xref="S4.SS2.p2.16.m16.1.2.1"></times><apply id="S4.SS2.p2.16.m16.1.2.2.cmml" xref="S4.SS2.p2.16.m16.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.16.m16.1.2.2.1.cmml" xref="S4.SS2.p2.16.m16.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.16.m16.1.2.2.2.cmml" xref="S4.SS2.p2.16.m16.1.2.2.2">𝐞</ci><ci id="S4.SS2.p2.16.m16.1.2.2.3.cmml" xref="S4.SS2.p2.16.m16.1.2.2.3">𝑚</ci></apply><ci id="S4.SS2.p2.16.m16.1.1.cmml" xref="S4.SS2.p2.16.m16.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m16.1c">\mathbf{e}_{m}(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.16.m16.1d">bold_e start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> by mapping all diagnoses, surgeries, and medications through their corresponding embedding matrices.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx3">
<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{e}_{d}(t-1)=d(t-1)\mathbf{E}_{d}," class="ltx_Math" display="block" id="S4.E11.m1.1"><semantics id="S4.E11.m1.1a"><mrow id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><mrow id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml"><msub id="S4.E11.m1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.1.3.2.cmml">𝐞</mi><mi id="S4.E11.m1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.3.3.cmml">d</mi></msub><mo id="S4.E11.m1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E11.m1.1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E11.m1.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E11.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E11.m1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.2.3.cmml">d</mi><mo id="S4.E11.m1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E11.m1.1.1.1.1.2.1.1" xref="S4.E11.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E11.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E11.m1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.2.1.1.1" xref="S4.E11.m1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.2.1.1.1.2" xref="S4.E11.m1.1.1.1.1.2.1.1.1.2.cmml">t</mi><mo id="S4.E11.m1.1.1.1.1.2.1.1.1.1" xref="S4.E11.m1.1.1.1.1.2.1.1.1.1.cmml">−</mo><mn id="S4.E11.m1.1.1.1.1.2.1.1.1.3" xref="S4.E11.m1.1.1.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E11.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E11.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E11.m1.1.1.1.1.2.2a" xref="S4.E11.m1.1.1.1.1.2.2.cmml">⁢</mo><msub id="S4.E11.m1.1.1.1.1.2.4" xref="S4.E11.m1.1.1.1.1.2.4.cmml"><mi id="S4.E11.m1.1.1.1.1.2.4.2" xref="S4.E11.m1.1.1.1.1.2.4.2.cmml">𝐄</mi><mi id="S4.E11.m1.1.1.1.1.2.4.3" xref="S4.E11.m1.1.1.1.1.2.4.3.cmml">d</mi></msub></mrow></mrow><mo id="S4.E11.m1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><apply id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1"><eq id="S4.E11.m1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.3"></eq><apply id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><times id="S4.E11.m1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.2"></times><apply id="S4.E11.m1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.3.2">𝐞</ci><ci id="S4.E11.m1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1"><minus id="S4.E11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2">𝑡</ci><cn id="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.2"><times id="S4.E11.m1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.2.2"></times><ci id="S4.E11.m1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.2.3">𝑑</ci><apply id="S4.E11.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.2.1.1"><minus id="S4.E11.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.2.1.1.1.1"></minus><ci id="S4.E11.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.2.1.1.1.2">𝑡</ci><cn id="S4.E11.m1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S4.E11.m1.1.1.1.1.2.1.1.1.3">1</cn></apply><apply id="S4.E11.m1.1.1.1.1.2.4.cmml" xref="S4.E11.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.2.4.1.cmml" xref="S4.E11.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.2.4.2.cmml" xref="S4.E11.m1.1.1.1.1.2.4.2">𝐄</ci><ci id="S4.E11.m1.1.1.1.1.2.4.3.cmml" xref="S4.E11.m1.1.1.1.1.2.4.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">\displaystyle\mathbf{e}_{d}(t-1)=d(t-1)\mathbf{E}_{d},</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.1d">bold_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_t - 1 ) = italic_d ( italic_t - 1 ) bold_E start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{e}_{p}(t-1)=p(t-1)\mathbf{E}_{p}," class="ltx_Math" display="block" id="S4.E12.m1.1"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.cmml"><msub id="S4.E12.m1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.1.3.2.cmml">𝐞</mi><mi id="S4.E12.m1.1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.1.3.3.cmml">p</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E12.m1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E12.m1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.2.cmml"><mi id="S4.E12.m1.1.1.1.1.2.3" xref="S4.E12.m1.1.1.1.1.2.3.cmml">p</mi><mo id="S4.E12.m1.1.1.1.1.2.2" xref="S4.E12.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.2.1.1" xref="S4.E12.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E12.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.1.1.1.1.2.1.1.1" xref="S4.E12.m1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.2.1.1.1.2" xref="S4.E12.m1.1.1.1.1.2.1.1.1.2.cmml">t</mi><mo id="S4.E12.m1.1.1.1.1.2.1.1.1.1" xref="S4.E12.m1.1.1.1.1.2.1.1.1.1.cmml">−</mo><mn id="S4.E12.m1.1.1.1.1.2.1.1.1.3" xref="S4.E12.m1.1.1.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E12.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E12.m1.1.1.1.1.2.2a" xref="S4.E12.m1.1.1.1.1.2.2.cmml">⁢</mo><msub id="S4.E12.m1.1.1.1.1.2.4" xref="S4.E12.m1.1.1.1.1.2.4.cmml"><mi id="S4.E12.m1.1.1.1.1.2.4.2" xref="S4.E12.m1.1.1.1.1.2.4.2.cmml">𝐄</mi><mi id="S4.E12.m1.1.1.1.1.2.4.3" xref="S4.E12.m1.1.1.1.1.2.4.3.cmml">p</mi></msub></mrow></mrow><mo id="S4.E12.m1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><eq id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"></eq><apply id="S4.E12.m1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1"><times id="S4.E12.m1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.2"></times><apply id="S4.E12.m1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.3.2">𝐞</ci><ci id="S4.E12.m1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.3.3">𝑝</ci></apply><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1"><minus id="S4.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2">𝑡</ci><cn id="S4.E12.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E12.m1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2"><times id="S4.E12.m1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2"></times><ci id="S4.E12.m1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.2.3">𝑝</ci><apply id="S4.E12.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.2.1.1"><minus id="S4.E12.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.2.1.1.1.1"></minus><ci id="S4.E12.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2.1.1.1.2">𝑡</ci><cn id="S4.E12.m1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S4.E12.m1.1.1.1.1.2.1.1.1.3">1</cn></apply><apply id="S4.E12.m1.1.1.1.1.2.4.cmml" xref="S4.E12.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.4.1.cmml" xref="S4.E12.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.2.4.2.cmml" xref="S4.E12.m1.1.1.1.1.2.4.2">𝐄</ci><ci id="S4.E12.m1.1.1.1.1.2.4.3.cmml" xref="S4.E12.m1.1.1.1.1.2.4.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\displaystyle\mathbf{e}_{p}(t-1)=p(t-1)\mathbf{E}_{p},</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.1d">bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_t - 1 ) = italic_p ( italic_t - 1 ) bold_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{e}_{m}(t-1)=m(t-1)\mathbf{E}_{m}." class="ltx_Math" display="block" id="S4.E13.m1.1"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.cmml"><msub id="S4.E13.m1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.1.3.2.cmml">𝐞</mi><mi id="S4.E13.m1.1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.1.3.3.cmml">m</mi></msub><mo id="S4.E13.m1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E13.m1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.cmml"><mi id="S4.E13.m1.1.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.2.3.cmml">m</mi><mo id="S4.E13.m1.1.1.1.1.2.2" xref="S4.E13.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E13.m1.1.1.1.1.2.1.1" xref="S4.E13.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E13.m1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.2.1.1.1" xref="S4.E13.m1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.2.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.1.1.1.2.cmml">t</mi><mo id="S4.E13.m1.1.1.1.1.2.1.1.1.1" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1.cmml">−</mo><mn id="S4.E13.m1.1.1.1.1.2.1.1.1.3" xref="S4.E13.m1.1.1.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E13.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E13.m1.1.1.1.1.2.2a" xref="S4.E13.m1.1.1.1.1.2.2.cmml">⁢</mo><msub id="S4.E13.m1.1.1.1.1.2.4" xref="S4.E13.m1.1.1.1.1.2.4.cmml"><mi id="S4.E13.m1.1.1.1.1.2.4.2" xref="S4.E13.m1.1.1.1.1.2.4.2.cmml">𝐄</mi><mi id="S4.E13.m1.1.1.1.1.2.4.3" xref="S4.E13.m1.1.1.1.1.2.4.3.cmml">m</mi></msub></mrow></mrow><mo id="S4.E13.m1.1.1.1.2" lspace="0em" xref="S4.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.3"></eq><apply id="S4.E13.m1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><times id="S4.E13.m1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.2"></times><apply id="S4.E13.m1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.1.3.2">𝐞</ci><ci id="S4.E13.m1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><minus id="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2">𝑡</ci><cn id="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E13.m1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2"><times id="S4.E13.m1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2"></times><ci id="S4.E13.m1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.2.3">𝑚</ci><apply id="S4.E13.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.2.1.1"><minus id="S4.E13.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.2.1.1.1.1"></minus><ci id="S4.E13.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2.1.1.1.2">𝑡</ci><cn id="S4.E13.m1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.2.1.1.1.3">1</cn></apply><apply id="S4.E13.m1.1.1.1.1.2.4.cmml" xref="S4.E13.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.4.1.cmml" xref="S4.E13.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.2.4.2.cmml" xref="S4.E13.m1.1.1.1.1.2.4.2">𝐄</ci><ci id="S4.E13.m1.1.1.1.1.2.4.3.cmml" xref="S4.E13.m1.1.1.1.1.2.4.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">\displaystyle\mathbf{e}_{m}(t-1)=m(t-1)\mathbf{E}_{m}.</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.1d">bold_e start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( italic_t - 1 ) = italic_m ( italic_t - 1 ) bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.3">Finally, we concatenate the three vectors of equal length, resulting in a single vector with three times the original length, forming the visit-level representation at time <math alttext="t-1" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">t</mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">−</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><minus id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></minus><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝑡</ci><cn id="S4.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_t - 1</annotation></semantics></math>, <math alttext="\mathbf{e}_{v}^{\prime}(t)\in R^{1\times 3h}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.2" xref="S4.SS2.p3.2.m2.1.2.cmml"><mrow id="S4.SS2.p3.2.m2.1.2.2" xref="S4.SS2.p3.2.m2.1.2.2.cmml"><msubsup id="S4.SS2.p3.2.m2.1.2.2.2" xref="S4.SS2.p3.2.m2.1.2.2.2.cmml"><mi id="S4.SS2.p3.2.m2.1.2.2.2.2.2" xref="S4.SS2.p3.2.m2.1.2.2.2.2.2.cmml">𝐞</mi><mi id="S4.SS2.p3.2.m2.1.2.2.2.2.3" xref="S4.SS2.p3.2.m2.1.2.2.2.2.3.cmml">v</mi><mo id="S4.SS2.p3.2.m2.1.2.2.2.3" xref="S4.SS2.p3.2.m2.1.2.2.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.p3.2.m2.1.2.2.1" xref="S4.SS2.p3.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p3.2.m2.1.2.2.3.2" xref="S4.SS2.p3.2.m2.1.2.2.cmml"><mo id="S4.SS2.p3.2.m2.1.2.2.3.2.1" stretchy="false" xref="S4.SS2.p3.2.m2.1.2.2.cmml">(</mo><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">t</mi><mo id="S4.SS2.p3.2.m2.1.2.2.3.2.2" stretchy="false" xref="S4.SS2.p3.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p3.2.m2.1.2.1" xref="S4.SS2.p3.2.m2.1.2.1.cmml">∈</mo><msup id="S4.SS2.p3.2.m2.1.2.3" xref="S4.SS2.p3.2.m2.1.2.3.cmml"><mi id="S4.SS2.p3.2.m2.1.2.3.2" xref="S4.SS2.p3.2.m2.1.2.3.2.cmml">R</mi><mrow id="S4.SS2.p3.2.m2.1.2.3.3" xref="S4.SS2.p3.2.m2.1.2.3.3.cmml"><mrow id="S4.SS2.p3.2.m2.1.2.3.3.2" xref="S4.SS2.p3.2.m2.1.2.3.3.2.cmml"><mn id="S4.SS2.p3.2.m2.1.2.3.3.2.2" xref="S4.SS2.p3.2.m2.1.2.3.3.2.2.cmml">1</mn><mo id="S4.SS2.p3.2.m2.1.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p3.2.m2.1.2.3.3.2.1.cmml">×</mo><mn id="S4.SS2.p3.2.m2.1.2.3.3.2.3" xref="S4.SS2.p3.2.m2.1.2.3.3.2.3.cmml">3</mn></mrow><mo id="S4.SS2.p3.2.m2.1.2.3.3.1" xref="S4.SS2.p3.2.m2.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.2.3.3.3" xref="S4.SS2.p3.2.m2.1.2.3.3.3.cmml">h</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.2.cmml" xref="S4.SS2.p3.2.m2.1.2"><in id="S4.SS2.p3.2.m2.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.1"></in><apply id="S4.SS2.p3.2.m2.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2"><times id="S4.SS2.p3.2.m2.1.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.2.1"></times><apply id="S4.SS2.p3.2.m2.1.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.2.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2">superscript</csymbol><apply id="S4.SS2.p3.2.m2.1.2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.2.2.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.2.2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2.2.2">𝐞</ci><ci id="S4.SS2.p3.2.m2.1.2.2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2.2.3">𝑣</ci></apply><ci id="S4.SS2.p3.2.m2.1.2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2.3">′</ci></apply><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑡</ci></apply><apply id="S4.SS2.p3.2.m2.1.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.2.3.1.cmml" xref="S4.SS2.p3.2.m2.1.2.3">superscript</csymbol><ci id="S4.SS2.p3.2.m2.1.2.3.2.cmml" xref="S4.SS2.p3.2.m2.1.2.3.2">𝑅</ci><apply id="S4.SS2.p3.2.m2.1.2.3.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3.3"><times id="S4.SS2.p3.2.m2.1.2.3.3.1.cmml" xref="S4.SS2.p3.2.m2.1.2.3.3.1"></times><apply id="S4.SS2.p3.2.m2.1.2.3.3.2.cmml" xref="S4.SS2.p3.2.m2.1.2.3.3.2"><times id="S4.SS2.p3.2.m2.1.2.3.3.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.3.3.2.1"></times><cn id="S4.SS2.p3.2.m2.1.2.3.3.2.2.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.2.3.3.2.2">1</cn><cn id="S4.SS2.p3.2.m2.1.2.3.3.2.3.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.2.3.3.2.3">3</cn></apply><ci id="S4.SS2.p3.2.m2.1.2.3.3.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\mathbf{e}_{v}^{\prime}(t)\in R^{1\times 3h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t ) ∈ italic_R start_POSTSUPERSCRIPT 1 × 3 italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="h" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_h</annotation></semantics></math> is the embedding size.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{e}_{v}^{\prime}(t-1)=\mathrm{CONCAT}(\mathbf{e}_{d}(t-1),\mathbf{e}_{p%
}(t-1),\mathbf{e}_{m}(t-1))." class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml"><msubsup id="S4.E14.m1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.3.2.2" xref="S4.E14.m1.1.1.1.1.1.3.2.2.cmml">𝐞</mi><mi id="S4.E14.m1.1.1.1.1.1.3.2.3" xref="S4.E14.m1.1.1.1.1.1.3.2.3.cmml">v</mi><mo id="S4.E14.m1.1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.1.3.3.cmml">′</mo></msubsup><mo id="S4.E14.m1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E14.m1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E14.m1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E14.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.5" xref="S4.E14.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.4" xref="S4.E14.m1.1.1.1.1.4.cmml"><mi id="S4.E14.m1.1.1.1.1.4.5" xref="S4.E14.m1.1.1.1.1.4.5.cmml">CONCAT</mi><mo id="S4.E14.m1.1.1.1.1.4.4" xref="S4.E14.m1.1.1.1.1.4.4.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.4.3.3" xref="S4.E14.m1.1.1.1.1.4.3.4.cmml"><mo id="S4.E14.m1.1.1.1.1.4.3.3.4" stretchy="false" xref="S4.E14.m1.1.1.1.1.4.3.4.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.2.1.1.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.cmml"><msub id="S4.E14.m1.1.1.1.1.2.1.1.1.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.cmml">𝐞</mi><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.3.cmml">d</mi></msub><mo id="S4.E14.m1.1.1.1.1.2.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.4.3.3.5" xref="S4.E14.m1.1.1.1.1.4.3.4.cmml">,</mo><mrow id="S4.E14.m1.1.1.1.1.3.2.2.2" xref="S4.E14.m1.1.1.1.1.3.2.2.2.cmml"><msub id="S4.E14.m1.1.1.1.1.3.2.2.2.3" xref="S4.E14.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1.3.2.2.2.3.2" xref="S4.E14.m1.1.1.1.1.3.2.2.2.3.2.cmml">𝐞</mi><mi id="S4.E14.m1.1.1.1.1.3.2.2.2.3.3" xref="S4.E14.m1.1.1.1.1.3.2.2.2.3.3.cmml">p</mi></msub><mo id="S4.E14.m1.1.1.1.1.3.2.2.2.2" xref="S4.E14.m1.1.1.1.1.3.2.2.2.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.2" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.2.cmml">t</mi><mo id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.1" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.3" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.4.3.3.6" xref="S4.E14.m1.1.1.1.1.4.3.4.cmml">,</mo><mrow id="S4.E14.m1.1.1.1.1.4.3.3.3" xref="S4.E14.m1.1.1.1.1.4.3.3.3.cmml"><msub id="S4.E14.m1.1.1.1.1.4.3.3.3.3" xref="S4.E14.m1.1.1.1.1.4.3.3.3.3.cmml"><mi id="S4.E14.m1.1.1.1.1.4.3.3.3.3.2" xref="S4.E14.m1.1.1.1.1.4.3.3.3.3.2.cmml">𝐞</mi><mi id="S4.E14.m1.1.1.1.1.4.3.3.3.3.3" xref="S4.E14.m1.1.1.1.1.4.3.3.3.3.3.cmml">m</mi></msub><mo id="S4.E14.m1.1.1.1.1.4.3.3.3.2" xref="S4.E14.m1.1.1.1.1.4.3.3.3.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.2" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.2.cmml">t</mi><mo id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.1" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.3" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.4.3.3.7" stretchy="false" xref="S4.E14.m1.1.1.1.1.4.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.2" lspace="0em" xref="S4.E14.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.5.cmml" xref="S4.E14.m1.1.1.1.1.5"></eq><apply id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"><times id="S4.E14.m1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.2"></times><apply id="S4.E14.m1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.1.3.2.2">𝐞</ci><ci id="S4.E14.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.1.3.2.3">𝑣</ci></apply><ci id="S4.E14.m1.1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.1.3.3">′</ci></apply><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1"><minus id="S4.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2">𝑡</ci><cn id="S4.E14.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E14.m1.1.1.1.1.4.cmml" xref="S4.E14.m1.1.1.1.1.4"><times id="S4.E14.m1.1.1.1.1.4.4.cmml" xref="S4.E14.m1.1.1.1.1.4.4"></times><ci id="S4.E14.m1.1.1.1.1.4.5.cmml" xref="S4.E14.m1.1.1.1.1.4.5">CONCAT</ci><vector id="S4.E14.m1.1.1.1.1.4.3.4.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3"><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1"><times id="S4.E14.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2"></times><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.2">𝐞</ci><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.3">𝑑</ci></apply><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1"><minus id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.1"></minus><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.2">𝑡</ci><cn id="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E14.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2"><times id="S4.E14.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.2"></times><apply id="S4.E14.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.3.2">𝐞</ci><ci id="S4.E14.m1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.3.3">𝑝</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1"><minus id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.1"></minus><ci id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.2">𝑡</ci><cn id="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.3.2.2.2.1.1.1.3">1</cn></apply></apply><apply id="S4.E14.m1.1.1.1.1.4.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3"><times id="S4.E14.m1.1.1.1.1.4.3.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.2"></times><apply id="S4.E14.m1.1.1.1.1.4.3.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.4.3.3.3.3.1.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.4.3.3.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.3.2">𝐞</ci><ci id="S4.E14.m1.1.1.1.1.4.3.3.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.3.3">𝑚</ci></apply><apply id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1"><minus id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.1"></minus><ci id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.2">𝑡</ci><cn id="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.4.3.3.3.1.1.1.3">1</cn></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\mathbf{e}_{v}^{\prime}(t-1)=\mathrm{CONCAT}(\mathbf{e}_{d}(t-1),\mathbf{e}_{p%
}(t-1),\mathbf{e}_{m}(t-1)).</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t - 1 ) = roman_CONCAT ( bold_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_t - 1 ) , bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_t - 1 ) , bold_e start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( italic_t - 1 ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.2">Then, a multi-layer perceptron(MLP) converts the dimension of the vector <math alttext="\mathbf{e}_{v}^{\prime}(t-1)" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><msubsup id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS2.p4.1.m1.1.1.3.2.2" xref="S4.SS2.p4.1.m1.1.1.3.2.2.cmml">𝐞</mi><mi id="S4.SS2.p4.1.m1.1.1.3.2.3" xref="S4.SS2.p4.1.m1.1.1.3.2.3.cmml">v</mi><mo id="S4.SS2.p4.1.m1.1.1.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.cmml">′</mo></msubsup><mo id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p4.1.m1.1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.1.m1.1.1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.SS2.p4.1.m1.1.1.1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.p4.1.m1.1.1.1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><times id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2"></times><apply id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3">superscript</csymbol><apply id="S4.SS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2.2">𝐞</ci><ci id="S4.SS2.p4.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2.3">𝑣</ci></apply><ci id="S4.SS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">′</ci></apply><apply id="S4.SS2.p4.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1"><minus id="S4.SS2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1.1.1"></minus><ci id="S4.SS2.p4.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.1.1.1.2">𝑡</ci><cn id="S4.SS2.p4.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p4.1.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\mathbf{e}_{v}^{\prime}(t-1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t - 1 )</annotation></semantics></math> to <math alttext="|\mathcal{S}|" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.2.2" xref="S4.SS2.p4.2.m2.1.2.1.cmml"><mo id="S4.SS2.p4.2.m2.1.2.2.1" stretchy="false" xref="S4.SS2.p4.2.m2.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">𝒮</mi><mo id="S4.SS2.p4.2.m2.1.2.2.2" stretchy="false" xref="S4.SS2.p4.2.m2.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.2.1.cmml" xref="S4.SS2.p4.2.m2.1.2.2"><abs id="S4.SS2.p4.2.m2.1.2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.2.2.1"></abs><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">|\mathcal{S}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">| caligraphic_S |</annotation></semantics></math>, the total number of molecular substructures, and a sigmoid function determines the degree to which each substructure is relevant at the current time.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{e}_{s}^{\prime}=\mathrm{MLP}(\mathbf{e}_{v}^{\prime}(t-1))" class="ltx_Math" display="block" id="S4.E15.m1.1"><semantics id="S4.E15.m1.1a"><mrow id="S4.E15.m1.1.1" xref="S4.E15.m1.1.1.cmml"><msubsup id="S4.E15.m1.1.1.3" xref="S4.E15.m1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.3.2.2" xref="S4.E15.m1.1.1.3.2.2.cmml">𝐞</mi><mi id="S4.E15.m1.1.1.3.2.3" xref="S4.E15.m1.1.1.3.2.3.cmml">s</mi><mo id="S4.E15.m1.1.1.3.3" xref="S4.E15.m1.1.1.3.3.cmml">′</mo></msubsup><mo id="S4.E15.m1.1.1.2" xref="S4.E15.m1.1.1.2.cmml">=</mo><mrow id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.3" xref="S4.E15.m1.1.1.1.3.cmml">MLP</mi><mo id="S4.E15.m1.1.1.1.2" xref="S4.E15.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.3.2.2" xref="S4.E15.m1.1.1.1.1.1.1.3.2.2.cmml">𝐞</mi><mi id="S4.E15.m1.1.1.1.1.1.1.3.2.3" xref="S4.E15.m1.1.1.1.1.1.1.3.2.3.cmml">v</mi><mo id="S4.E15.m1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.1.1.3.3.cmml">′</mo></msubsup><mo id="S4.E15.m1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.cmml" xref="S4.E15.m1.1.1"><eq id="S4.E15.m1.1.1.2.cmml" xref="S4.E15.m1.1.1.2"></eq><apply id="S4.E15.m1.1.1.3.cmml" xref="S4.E15.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.3">superscript</csymbol><apply id="S4.E15.m1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.3.2.1.cmml" xref="S4.E15.m1.1.1.3">subscript</csymbol><ci id="S4.E15.m1.1.1.3.2.2.cmml" xref="S4.E15.m1.1.1.3.2.2">𝐞</ci><ci id="S4.E15.m1.1.1.3.2.3.cmml" xref="S4.E15.m1.1.1.3.2.3">𝑠</ci></apply><ci id="S4.E15.m1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.3.3">′</ci></apply><apply id="S4.E15.m1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"><times id="S4.E15.m1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.2"></times><ci id="S4.E15.m1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.3">MLP</ci><apply id="S4.E15.m1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"><times id="S4.E15.m1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2"></times><apply id="S4.E15.m1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E15.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.2.2">𝐞</ci><ci id="S4.E15.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.2.3">𝑣</ci></apply><ci id="S4.E15.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.3">′</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1"><minus id="S4.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2">𝑡</ci><cn id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">\mathbf{e}_{s}^{\prime}=\mathrm{MLP}(\mathbf{e}_{v}^{\prime}(t-1))</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.1d">bold_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = roman_MLP ( bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t - 1 ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">Relying solely on information from a single visit is unwise. For patients with a history of chronic illness, their medical history includes health statuses at different times and the historical progression of their condition, which are potential factors that must be considered. Previous work typically explicitly models the information contained in patient visit sequences when generating patient representations. Innovatively, we perform visit-level interactions between patient representations at each time point and the embedding matrix of the molecular structure encoder, thereby fully preserving the weight of each patient’s demand for drug molecules at each time point. We then correct biases based on the most recent patient representation at visit <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_t</annotation></semantics></math>, ultimately obtaining drug combinations linked to the latest patient visit across various time points.</p>
</div>
<div class="ltx_para" id="S4.SS2.p6">
<p class="ltx_p" id="S4.SS2.p6.4">We use the molecular structure encoder trained during the pretraining phase to encode molecular structures and their substructures, obtaining <math alttext="\mathbf{E}^{\prime}_{s}" class="ltx_Math" display="inline" id="S4.SS2.p6.1.m1.1"><semantics id="S4.SS2.p6.1.m1.1a"><msubsup id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mi id="S4.SS2.p6.1.m1.1.1.2.2" xref="S4.SS2.p6.1.m1.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml">s</mi><mo id="S4.SS2.p6.1.m1.1.1.2.3" xref="S4.SS2.p6.1.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.2.1.cmml" xref="S4.SS2.p6.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p6.1.m1.1.1.2.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2.2">𝐄</ci><ci id="S4.SS2.p6.1.m1.1.1.2.3.cmml" xref="S4.SS2.p6.1.m1.1.1.2.3">′</ci></apply><ci id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">\mathbf{E}^{\prime}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.1.m1.1d">bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{E}^{\prime}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p6.2.m2.1"><semantics id="S4.SS2.p6.2.m2.1a"><msubsup id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml"><mi id="S4.SS2.p6.2.m2.1.1.2.2" xref="S4.SS2.p6.2.m2.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p6.2.m2.1.1.3" xref="S4.SS2.p6.2.m2.1.1.3.cmml">m</mi><mo id="S4.SS2.p6.2.m2.1.1.2.3" xref="S4.SS2.p6.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><apply id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.2.m2.1.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">subscript</csymbol><apply id="S4.SS2.p6.2.m2.1.1.2.cmml" xref="S4.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.2.m2.1.1.2.1.cmml" xref="S4.SS2.p6.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p6.2.m2.1.1.2.2.cmml" xref="S4.SS2.p6.2.m2.1.1.2.2">𝐄</ci><ci id="S4.SS2.p6.2.m2.1.1.2.3.cmml" xref="S4.SS2.p6.2.m2.1.1.2.3">′</ci></apply><ci id="S4.SS2.p6.2.m2.1.1.3.cmml" xref="S4.SS2.p6.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">\mathbf{E}^{\prime}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.2.m2.1d">bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. For substructures, since the function of molecules is realized through a set of substructures, we need to model the interaction information of substructures. Therefore, we design a substructures self-attention(SSA) module <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib21" title="">21</a>]</cite> to achieve this goal. We use the embedding matrix <math alttext="\mathbf{E}^{\prime}_{s}" class="ltx_Math" display="inline" id="S4.SS2.p6.3.m3.1"><semantics id="S4.SS2.p6.3.m3.1a"><msubsup id="S4.SS2.p6.3.m3.1.1" xref="S4.SS2.p6.3.m3.1.1.cmml"><mi id="S4.SS2.p6.3.m3.1.1.2.2" xref="S4.SS2.p6.3.m3.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p6.3.m3.1.1.3" xref="S4.SS2.p6.3.m3.1.1.3.cmml">s</mi><mo id="S4.SS2.p6.3.m3.1.1.2.3" xref="S4.SS2.p6.3.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.3.m3.1b"><apply id="S4.SS2.p6.3.m3.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.3.m3.1.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1">subscript</csymbol><apply id="S4.SS2.p6.3.m3.1.1.2.cmml" xref="S4.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.3.m3.1.1.2.1.cmml" xref="S4.SS2.p6.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p6.3.m3.1.1.2.2.cmml" xref="S4.SS2.p6.3.m3.1.1.2.2">𝐄</ci><ci id="S4.SS2.p6.3.m3.1.1.2.3.cmml" xref="S4.SS2.p6.3.m3.1.1.2.3">′</ci></apply><ci id="S4.SS2.p6.3.m3.1.1.3.cmml" xref="S4.SS2.p6.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.3.m3.1c">\mathbf{E}^{\prime}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.3.m3.1d">bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> of all substructures as input to establish an attention mechanism between each substructure, and finally output an embedding matrix of equal size <math alttext="\mathbf{E}^{*}_{s}\in\mathbb{R}^{|\mathcal{S}|\times h}" class="ltx_Math" display="inline" id="S4.SS2.p6.4.m4.1"><semantics id="S4.SS2.p6.4.m4.1a"><mrow id="S4.SS2.p6.4.m4.1.2" xref="S4.SS2.p6.4.m4.1.2.cmml"><msubsup id="S4.SS2.p6.4.m4.1.2.2" xref="S4.SS2.p6.4.m4.1.2.2.cmml"><mi id="S4.SS2.p6.4.m4.1.2.2.2.2" xref="S4.SS2.p6.4.m4.1.2.2.2.2.cmml">𝐄</mi><mi id="S4.SS2.p6.4.m4.1.2.2.3" xref="S4.SS2.p6.4.m4.1.2.2.3.cmml">s</mi><mo id="S4.SS2.p6.4.m4.1.2.2.2.3" xref="S4.SS2.p6.4.m4.1.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.SS2.p6.4.m4.1.2.1" xref="S4.SS2.p6.4.m4.1.2.1.cmml">∈</mo><msup id="S4.SS2.p6.4.m4.1.2.3" xref="S4.SS2.p6.4.m4.1.2.3.cmml"><mi id="S4.SS2.p6.4.m4.1.2.3.2" xref="S4.SS2.p6.4.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p6.4.m4.1.1.1" xref="S4.SS2.p6.4.m4.1.1.1.cmml"><mrow id="S4.SS2.p6.4.m4.1.1.1.3.2" xref="S4.SS2.p6.4.m4.1.1.1.3.1.cmml"><mo id="S4.SS2.p6.4.m4.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.p6.4.m4.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p6.4.m4.1.1.1.1" xref="S4.SS2.p6.4.m4.1.1.1.1.cmml">𝒮</mi><mo id="S4.SS2.p6.4.m4.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S4.SS2.p6.4.m4.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS2.p6.4.m4.1.1.1.2" rspace="0.222em" xref="S4.SS2.p6.4.m4.1.1.1.2.cmml">×</mo><mi id="S4.SS2.p6.4.m4.1.1.1.4" xref="S4.SS2.p6.4.m4.1.1.1.4.cmml">h</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.4.m4.1b"><apply id="S4.SS2.p6.4.m4.1.2.cmml" xref="S4.SS2.p6.4.m4.1.2"><in id="S4.SS2.p6.4.m4.1.2.1.cmml" xref="S4.SS2.p6.4.m4.1.2.1"></in><apply id="S4.SS2.p6.4.m4.1.2.2.cmml" xref="S4.SS2.p6.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p6.4.m4.1.2.2.1.cmml" xref="S4.SS2.p6.4.m4.1.2.2">subscript</csymbol><apply id="S4.SS2.p6.4.m4.1.2.2.2.cmml" xref="S4.SS2.p6.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p6.4.m4.1.2.2.2.1.cmml" xref="S4.SS2.p6.4.m4.1.2.2">superscript</csymbol><ci id="S4.SS2.p6.4.m4.1.2.2.2.2.cmml" xref="S4.SS2.p6.4.m4.1.2.2.2.2">𝐄</ci><times id="S4.SS2.p6.4.m4.1.2.2.2.3.cmml" xref="S4.SS2.p6.4.m4.1.2.2.2.3"></times></apply><ci id="S4.SS2.p6.4.m4.1.2.2.3.cmml" xref="S4.SS2.p6.4.m4.1.2.2.3">𝑠</ci></apply><apply id="S4.SS2.p6.4.m4.1.2.3.cmml" xref="S4.SS2.p6.4.m4.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p6.4.m4.1.2.3.1.cmml" xref="S4.SS2.p6.4.m4.1.2.3">superscript</csymbol><ci id="S4.SS2.p6.4.m4.1.2.3.2.cmml" xref="S4.SS2.p6.4.m4.1.2.3.2">ℝ</ci><apply id="S4.SS2.p6.4.m4.1.1.1.cmml" xref="S4.SS2.p6.4.m4.1.1.1"><times id="S4.SS2.p6.4.m4.1.1.1.2.cmml" xref="S4.SS2.p6.4.m4.1.1.1.2"></times><apply id="S4.SS2.p6.4.m4.1.1.1.3.1.cmml" xref="S4.SS2.p6.4.m4.1.1.1.3.2"><abs id="S4.SS2.p6.4.m4.1.1.1.3.1.1.cmml" xref="S4.SS2.p6.4.m4.1.1.1.3.2.1"></abs><ci id="S4.SS2.p6.4.m4.1.1.1.1.cmml" xref="S4.SS2.p6.4.m4.1.1.1.1">𝒮</ci></apply><ci id="S4.SS2.p6.4.m4.1.1.1.4.cmml" xref="S4.SS2.p6.4.m4.1.1.1.4">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.4.m4.1c">\mathbf{E}^{*}_{s}\in\mathbb{R}^{|\mathcal{S}|\times h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.4.m4.1d">bold_E start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_S | × italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>. The self-attention layer is defined as follows:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx4">
<tbody id="S4.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathrm{H=LayerNorm(\mathbf{E}^{\prime}_{s}+\mathbf{A}_{self}(%
\mathbf{E}^{\prime}_{s})),}" class="ltx_Math" display="block" id="S4.E16.m1.1"><semantics id="S4.E16.m1.1a"><mrow id="S4.E16.m1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml"><mi id="S4.E16.m1.1.1.1.1.3" mathvariant="normal" xref="S4.E16.m1.1.1.1.1.3.cmml">H</mi><mo id="S4.E16.m1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E16.m1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.3.cmml">LayerNorm</mi><mo id="S4.E16.m1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E16.m1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E16.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E16.m1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E16.m1.1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐄</mi><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi><mo id="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S4.E16.m1.1.1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E16.m1.1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E16.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">self</mi></msub><mo id="S4.E16.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐄</mi><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi><mo id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E16.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E16.m1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.1b"><apply id="S4.E16.m1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1"><eq id="S4.E16.m1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2"></eq><ci id="S4.E16.m1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.3">H</ci><apply id="S4.E16.m1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1"><times id="S4.E16.m1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.2"></times><ci id="S4.E16.m1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.3">LayerNorm</ci><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1"><plus id="S4.E16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.2"></plus><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.2">𝐄</ci><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.3">s</ci></apply><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E16.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.2">𝐀</ci><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.3.3">self</ci></apply><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐄</ci><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">s</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.1c">\displaystyle\mathrm{H=LayerNorm(\mathbf{E}^{\prime}_{s}+\mathbf{A}_{self}(%
\mathbf{E}^{\prime}_{s})),}</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.1d">roman_H = roman_LayerNorm ( bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_s end_POSTSUBSCRIPT + bold_A start_POSTSUBSCRIPT roman_self end_POSTSUBSCRIPT ( bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_s end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="S4.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathrm{\mathbf{E}^{*}_{s}=SSA(\mathbf{E}^{\prime}_{s})=LayerNorm%
(H+MLP(H)),}" class="ltx_Math" display="block" id="S4.E17.m1.2"><semantics id="S4.E17.m1.2a"><mrow id="S4.E17.m1.2.2.1" xref="S4.E17.m1.2.2.1.1.cmml"><mrow id="S4.E17.m1.2.2.1.1" xref="S4.E17.m1.2.2.1.1.cmml"><msubsup id="S4.E17.m1.2.2.1.1.4" xref="S4.E17.m1.2.2.1.1.4.cmml"><mi id="S4.E17.m1.2.2.1.1.4.2.2" xref="S4.E17.m1.2.2.1.1.4.2.2.cmml">𝐄</mi><mi id="S4.E17.m1.2.2.1.1.4.3" mathvariant="normal" xref="S4.E17.m1.2.2.1.1.4.3.cmml">s</mi><mo id="S4.E17.m1.2.2.1.1.4.2.3" xref="S4.E17.m1.2.2.1.1.4.2.3.cmml">∗</mo></msubsup><mo id="S4.E17.m1.2.2.1.1.5" xref="S4.E17.m1.2.2.1.1.5.cmml">=</mo><mrow id="S4.E17.m1.2.2.1.1.1" xref="S4.E17.m1.2.2.1.1.1.cmml"><mi id="S4.E17.m1.2.2.1.1.1.3" xref="S4.E17.m1.2.2.1.1.1.3.cmml">SSA</mi><mo id="S4.E17.m1.2.2.1.1.1.2" xref="S4.E17.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E17.m1.2.2.1.1.1.1.1" xref="S4.E17.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E17.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E17.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E17.m1.2.2.1.1.1.1.1.1" xref="S4.E17.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.E17.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐄</mi><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.3" mathvariant="normal" xref="S4.E17.m1.2.2.1.1.1.1.1.1.3.cmml">s</mi><mo id="S4.E17.m1.2.2.1.1.1.1.1.1.2.3" xref="S4.E17.m1.2.2.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.E17.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E17.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E17.m1.2.2.1.1.6" xref="S4.E17.m1.2.2.1.1.6.cmml">=</mo><mrow id="S4.E17.m1.2.2.1.1.2" xref="S4.E17.m1.2.2.1.1.2.cmml"><mi id="S4.E17.m1.2.2.1.1.2.3" xref="S4.E17.m1.2.2.1.1.2.3.cmml">LayerNorm</mi><mo id="S4.E17.m1.2.2.1.1.2.2" xref="S4.E17.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S4.E17.m1.2.2.1.1.2.1.1" xref="S4.E17.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S4.E17.m1.2.2.1.1.2.1.1.2" stretchy="false" xref="S4.E17.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E17.m1.2.2.1.1.2.1.1.1" xref="S4.E17.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S4.E17.m1.2.2.1.1.2.1.1.1.2" mathvariant="normal" xref="S4.E17.m1.2.2.1.1.2.1.1.1.2.cmml">H</mi><mo id="S4.E17.m1.2.2.1.1.2.1.1.1.1" xref="S4.E17.m1.2.2.1.1.2.1.1.1.1.cmml">+</mo><mrow id="S4.E17.m1.2.2.1.1.2.1.1.1.3" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.cmml"><mi id="S4.E17.m1.2.2.1.1.2.1.1.1.3.2" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.2.cmml">MLP</mi><mo id="S4.E17.m1.2.2.1.1.2.1.1.1.3.1" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E17.m1.2.2.1.1.2.1.1.1.3.3.2" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.cmml"><mo id="S4.E17.m1.2.2.1.1.2.1.1.1.3.3.2.1" stretchy="false" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.cmml">(</mo><mi id="S4.E17.m1.1.1" mathvariant="normal" xref="S4.E17.m1.1.1.cmml">H</mi><mo id="S4.E17.m1.2.2.1.1.2.1.1.1.3.3.2.2" stretchy="false" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E17.m1.2.2.1.1.2.1.1.3" stretchy="false" xref="S4.E17.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E17.m1.2.2.1.2" xref="S4.E17.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.2b"><apply id="S4.E17.m1.2.2.1.1.cmml" xref="S4.E17.m1.2.2.1"><and id="S4.E17.m1.2.2.1.1a.cmml" xref="S4.E17.m1.2.2.1"></and><apply id="S4.E17.m1.2.2.1.1b.cmml" xref="S4.E17.m1.2.2.1"><eq id="S4.E17.m1.2.2.1.1.5.cmml" xref="S4.E17.m1.2.2.1.1.5"></eq><apply id="S4.E17.m1.2.2.1.1.4.cmml" xref="S4.E17.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S4.E17.m1.2.2.1.1.4.1.cmml" xref="S4.E17.m1.2.2.1.1.4">subscript</csymbol><apply id="S4.E17.m1.2.2.1.1.4.2.cmml" xref="S4.E17.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S4.E17.m1.2.2.1.1.4.2.1.cmml" xref="S4.E17.m1.2.2.1.1.4">superscript</csymbol><ci id="S4.E17.m1.2.2.1.1.4.2.2.cmml" xref="S4.E17.m1.2.2.1.1.4.2.2">𝐄</ci><times id="S4.E17.m1.2.2.1.1.4.2.3.cmml" xref="S4.E17.m1.2.2.1.1.4.2.3"></times></apply><ci id="S4.E17.m1.2.2.1.1.4.3.cmml" xref="S4.E17.m1.2.2.1.1.4.3">s</ci></apply><apply id="S4.E17.m1.2.2.1.1.1.cmml" xref="S4.E17.m1.2.2.1.1.1"><times id="S4.E17.m1.2.2.1.1.1.2.cmml" xref="S4.E17.m1.2.2.1.1.1.2"></times><ci id="S4.E17.m1.2.2.1.1.1.3.cmml" xref="S4.E17.m1.2.2.1.1.1.3">SSA</ci><apply id="S4.E17.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E17.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E17.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E17.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S4.E17.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E17.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E17.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E17.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.E17.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E17.m1.2.2.1.1.1.1.1.1.2.2">𝐄</ci><ci id="S4.E17.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E17.m1.2.2.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.E17.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E17.m1.2.2.1.1.1.1.1.1.3">s</ci></apply></apply></apply><apply id="S4.E17.m1.2.2.1.1c.cmml" xref="S4.E17.m1.2.2.1"><eq id="S4.E17.m1.2.2.1.1.6.cmml" xref="S4.E17.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2405.20358v2#S4.E17.m1.2.2.1.1.1.cmml" id="S4.E17.m1.2.2.1.1d.cmml" xref="S4.E17.m1.2.2.1"></share><apply id="S4.E17.m1.2.2.1.1.2.cmml" xref="S4.E17.m1.2.2.1.1.2"><times id="S4.E17.m1.2.2.1.1.2.2.cmml" xref="S4.E17.m1.2.2.1.1.2.2"></times><ci id="S4.E17.m1.2.2.1.1.2.3.cmml" xref="S4.E17.m1.2.2.1.1.2.3">LayerNorm</ci><apply id="S4.E17.m1.2.2.1.1.2.1.1.1.cmml" xref="S4.E17.m1.2.2.1.1.2.1.1"><plus id="S4.E17.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E17.m1.2.2.1.1.2.1.1.1.1"></plus><ci id="S4.E17.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S4.E17.m1.2.2.1.1.2.1.1.1.2">H</ci><apply id="S4.E17.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3"><times id="S4.E17.m1.2.2.1.1.2.1.1.1.3.1.cmml" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.1"></times><ci id="S4.E17.m1.2.2.1.1.2.1.1.1.3.2.cmml" xref="S4.E17.m1.2.2.1.1.2.1.1.1.3.2">MLP</ci><ci id="S4.E17.m1.1.1.cmml" xref="S4.E17.m1.1.1">H</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.2c">\displaystyle\mathrm{\mathbf{E}^{*}_{s}=SSA(\mathbf{E}^{\prime}_{s})=LayerNorm%
(H+MLP(H)),}</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.2d">bold_E start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_s end_POSTSUBSCRIPT = roman_SSA ( bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_s end_POSTSUBSCRIPT ) = roman_LayerNorm ( roman_H + roman_MLP ( roman_H ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p7">
<p class="ltx_p" id="S4.SS2.p7.1"><math alttext="\mathcal{Attn}_{self}" class="ltx_Math" display="inline" id="S4.SS2.p7.1.m1.1"><semantics id="S4.SS2.p7.1.m1.1a"><mrow id="S4.SS2.p7.1.m1.1.1" xref="S4.SS2.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p7.1.m1.1.1.2" xref="S4.SS2.p7.1.m1.1.1.2.cmml">𝒜</mi><mo id="S4.SS2.p7.1.m1.1.1.1" xref="S4.SS2.p7.1.m1.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p7.1.m1.1.1.3" xref="S4.SS2.p7.1.m1.1.1.3.cmml">𝓉</mi><mo id="S4.SS2.p7.1.m1.1.1.1a" xref="S4.SS2.p7.1.m1.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p7.1.m1.1.1.4" xref="S4.SS2.p7.1.m1.1.1.4.cmml">𝓉</mi><mo id="S4.SS2.p7.1.m1.1.1.1b" xref="S4.SS2.p7.1.m1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p7.1.m1.1.1.5" xref="S4.SS2.p7.1.m1.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p7.1.m1.1.1.5.2" xref="S4.SS2.p7.1.m1.1.1.5.2.cmml">𝓃</mi><mrow id="S4.SS2.p7.1.m1.1.1.5.3" xref="S4.SS2.p7.1.m1.1.1.5.3.cmml"><mi id="S4.SS2.p7.1.m1.1.1.5.3.2" xref="S4.SS2.p7.1.m1.1.1.5.3.2.cmml">s</mi><mo id="S4.SS2.p7.1.m1.1.1.5.3.1" xref="S4.SS2.p7.1.m1.1.1.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p7.1.m1.1.1.5.3.3" xref="S4.SS2.p7.1.m1.1.1.5.3.3.cmml">e</mi><mo id="S4.SS2.p7.1.m1.1.1.5.3.1a" xref="S4.SS2.p7.1.m1.1.1.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p7.1.m1.1.1.5.3.4" xref="S4.SS2.p7.1.m1.1.1.5.3.4.cmml">l</mi><mo id="S4.SS2.p7.1.m1.1.1.5.3.1b" xref="S4.SS2.p7.1.m1.1.1.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p7.1.m1.1.1.5.3.5" xref="S4.SS2.p7.1.m1.1.1.5.3.5.cmml">f</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.1.m1.1b"><apply id="S4.SS2.p7.1.m1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1"><times id="S4.SS2.p7.1.m1.1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1.1"></times><ci id="S4.SS2.p7.1.m1.1.1.2.cmml" xref="S4.SS2.p7.1.m1.1.1.2">𝒜</ci><ci id="S4.SS2.p7.1.m1.1.1.3.cmml" xref="S4.SS2.p7.1.m1.1.1.3">𝓉</ci><ci id="S4.SS2.p7.1.m1.1.1.4.cmml" xref="S4.SS2.p7.1.m1.1.1.4">𝓉</ci><apply id="S4.SS2.p7.1.m1.1.1.5.cmml" xref="S4.SS2.p7.1.m1.1.1.5"><csymbol cd="ambiguous" id="S4.SS2.p7.1.m1.1.1.5.1.cmml" xref="S4.SS2.p7.1.m1.1.1.5">subscript</csymbol><ci id="S4.SS2.p7.1.m1.1.1.5.2.cmml" xref="S4.SS2.p7.1.m1.1.1.5.2">𝓃</ci><apply id="S4.SS2.p7.1.m1.1.1.5.3.cmml" xref="S4.SS2.p7.1.m1.1.1.5.3"><times id="S4.SS2.p7.1.m1.1.1.5.3.1.cmml" xref="S4.SS2.p7.1.m1.1.1.5.3.1"></times><ci id="S4.SS2.p7.1.m1.1.1.5.3.2.cmml" xref="S4.SS2.p7.1.m1.1.1.5.3.2">𝑠</ci><ci id="S4.SS2.p7.1.m1.1.1.5.3.3.cmml" xref="S4.SS2.p7.1.m1.1.1.5.3.3">𝑒</ci><ci id="S4.SS2.p7.1.m1.1.1.5.3.4.cmml" xref="S4.SS2.p7.1.m1.1.1.5.3.4">𝑙</ci><ci id="S4.SS2.p7.1.m1.1.1.5.3.5.cmml" xref="S4.SS2.p7.1.m1.1.1.5.3.5">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.1.m1.1c">\mathcal{Attn}_{self}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.1.m1.1d">caligraphic_A caligraphic_t caligraphic_t caligraphic_n start_POSTSUBSCRIPT italic_s italic_e italic_l italic_f end_POSTSUBSCRIPT</annotation></semantics></math> denotes the self-attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib34" title="">34</a>]</cite> defined by the following formula:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{A}_{self}(\mathrm{X})=\mathrm{Softmax}\left(\frac{\mathbf{Q}\mathbf{K}%
^{\top}}{\sqrt{d}}\right)\mathbf{V}," class="ltx_Math" display="block" id="S4.E18.m1.3"><semantics id="S4.E18.m1.3a"><mrow id="S4.E18.m1.3.3.1" xref="S4.E18.m1.3.3.1.1.cmml"><mrow id="S4.E18.m1.3.3.1.1" xref="S4.E18.m1.3.3.1.1.cmml"><mrow id="S4.E18.m1.3.3.1.1.2" xref="S4.E18.m1.3.3.1.1.2.cmml"><msub id="S4.E18.m1.3.3.1.1.2.2" xref="S4.E18.m1.3.3.1.1.2.2.cmml"><mi id="S4.E18.m1.3.3.1.1.2.2.2" xref="S4.E18.m1.3.3.1.1.2.2.2.cmml">𝐀</mi><mrow id="S4.E18.m1.3.3.1.1.2.2.3" xref="S4.E18.m1.3.3.1.1.2.2.3.cmml"><mi id="S4.E18.m1.3.3.1.1.2.2.3.2" xref="S4.E18.m1.3.3.1.1.2.2.3.2.cmml">s</mi><mo id="S4.E18.m1.3.3.1.1.2.2.3.1" xref="S4.E18.m1.3.3.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.2.2.3.3" xref="S4.E18.m1.3.3.1.1.2.2.3.3.cmml">e</mi><mo id="S4.E18.m1.3.3.1.1.2.2.3.1a" xref="S4.E18.m1.3.3.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.2.2.3.4" xref="S4.E18.m1.3.3.1.1.2.2.3.4.cmml">l</mi><mo id="S4.E18.m1.3.3.1.1.2.2.3.1b" xref="S4.E18.m1.3.3.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.2.2.3.5" xref="S4.E18.m1.3.3.1.1.2.2.3.5.cmml">f</mi></mrow></msub><mo id="S4.E18.m1.3.3.1.1.2.1" xref="S4.E18.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S4.E18.m1.3.3.1.1.2.3.2" xref="S4.E18.m1.3.3.1.1.2.cmml"><mo id="S4.E18.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="S4.E18.m1.3.3.1.1.2.cmml">(</mo><mi id="S4.E18.m1.1.1" mathvariant="normal" xref="S4.E18.m1.1.1.cmml">X</mi><mo id="S4.E18.m1.3.3.1.1.2.3.2.2" stretchy="false" xref="S4.E18.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E18.m1.3.3.1.1.1" xref="S4.E18.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E18.m1.3.3.1.1.3" xref="S4.E18.m1.3.3.1.1.3.cmml"><mi id="S4.E18.m1.3.3.1.1.3.2" xref="S4.E18.m1.3.3.1.1.3.2.cmml">Softmax</mi><mo id="S4.E18.m1.3.3.1.1.3.1" xref="S4.E18.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S4.E18.m1.3.3.1.1.3.3.2" xref="S4.E18.m1.2.2.cmml"><mo id="S4.E18.m1.3.3.1.1.3.3.2.1" xref="S4.E18.m1.2.2.cmml">(</mo><mfrac id="S4.E18.m1.2.2" xref="S4.E18.m1.2.2.cmml"><msup id="S4.E18.m1.2.2.2" xref="S4.E18.m1.2.2.2.cmml"><mi id="S4.E18.m1.2.2.2.2" xref="S4.E18.m1.2.2.2.2.cmml">𝐐𝐊</mi><mo id="S4.E18.m1.2.2.2.3" xref="S4.E18.m1.2.2.2.3.cmml">⊤</mo></msup><msqrt id="S4.E18.m1.2.2.3" xref="S4.E18.m1.2.2.3.cmml"><mi id="S4.E18.m1.2.2.3.2" xref="S4.E18.m1.2.2.3.2.cmml">d</mi></msqrt></mfrac><mo id="S4.E18.m1.3.3.1.1.3.3.2.2" xref="S4.E18.m1.2.2.cmml">)</mo></mrow><mo id="S4.E18.m1.3.3.1.1.3.1a" xref="S4.E18.m1.3.3.1.1.3.1.cmml">⁢</mo><mi id="S4.E18.m1.3.3.1.1.3.4" xref="S4.E18.m1.3.3.1.1.3.4.cmml">𝐕</mi></mrow></mrow><mo id="S4.E18.m1.3.3.1.2" xref="S4.E18.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.3b"><apply id="S4.E18.m1.3.3.1.1.cmml" xref="S4.E18.m1.3.3.1"><eq id="S4.E18.m1.3.3.1.1.1.cmml" xref="S4.E18.m1.3.3.1.1.1"></eq><apply id="S4.E18.m1.3.3.1.1.2.cmml" xref="S4.E18.m1.3.3.1.1.2"><times id="S4.E18.m1.3.3.1.1.2.1.cmml" xref="S4.E18.m1.3.3.1.1.2.1"></times><apply id="S4.E18.m1.3.3.1.1.2.2.cmml" xref="S4.E18.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.1.1.2.2.1.cmml" xref="S4.E18.m1.3.3.1.1.2.2">subscript</csymbol><ci id="S4.E18.m1.3.3.1.1.2.2.2.cmml" xref="S4.E18.m1.3.3.1.1.2.2.2">𝐀</ci><apply id="S4.E18.m1.3.3.1.1.2.2.3.cmml" xref="S4.E18.m1.3.3.1.1.2.2.3"><times id="S4.E18.m1.3.3.1.1.2.2.3.1.cmml" xref="S4.E18.m1.3.3.1.1.2.2.3.1"></times><ci id="S4.E18.m1.3.3.1.1.2.2.3.2.cmml" xref="S4.E18.m1.3.3.1.1.2.2.3.2">𝑠</ci><ci id="S4.E18.m1.3.3.1.1.2.2.3.3.cmml" xref="S4.E18.m1.3.3.1.1.2.2.3.3">𝑒</ci><ci id="S4.E18.m1.3.3.1.1.2.2.3.4.cmml" xref="S4.E18.m1.3.3.1.1.2.2.3.4">𝑙</ci><ci id="S4.E18.m1.3.3.1.1.2.2.3.5.cmml" xref="S4.E18.m1.3.3.1.1.2.2.3.5">𝑓</ci></apply></apply><ci id="S4.E18.m1.1.1.cmml" xref="S4.E18.m1.1.1">X</ci></apply><apply id="S4.E18.m1.3.3.1.1.3.cmml" xref="S4.E18.m1.3.3.1.1.3"><times id="S4.E18.m1.3.3.1.1.3.1.cmml" xref="S4.E18.m1.3.3.1.1.3.1"></times><ci id="S4.E18.m1.3.3.1.1.3.2.cmml" xref="S4.E18.m1.3.3.1.1.3.2">Softmax</ci><apply id="S4.E18.m1.2.2.cmml" xref="S4.E18.m1.3.3.1.1.3.3.2"><divide id="S4.E18.m1.2.2.1.cmml" xref="S4.E18.m1.3.3.1.1.3.3.2"></divide><apply id="S4.E18.m1.2.2.2.cmml" xref="S4.E18.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E18.m1.2.2.2.1.cmml" xref="S4.E18.m1.2.2.2">superscript</csymbol><ci id="S4.E18.m1.2.2.2.2.cmml" xref="S4.E18.m1.2.2.2.2">𝐐𝐊</ci><csymbol cd="latexml" id="S4.E18.m1.2.2.2.3.cmml" xref="S4.E18.m1.2.2.2.3">top</csymbol></apply><apply id="S4.E18.m1.2.2.3.cmml" xref="S4.E18.m1.2.2.3"><root id="S4.E18.m1.2.2.3a.cmml" xref="S4.E18.m1.2.2.3"></root><ci id="S4.E18.m1.2.2.3.2.cmml" xref="S4.E18.m1.2.2.3.2">𝑑</ci></apply></apply><ci id="S4.E18.m1.3.3.1.1.3.4.cmml" xref="S4.E18.m1.3.3.1.1.3.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.3c">\mathbf{A}_{self}(\mathrm{X})=\mathrm{Softmax}\left(\frac{\mathbf{Q}\mathbf{K}%
^{\top}}{\sqrt{d}}\right)\mathbf{V},</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.3d">bold_A start_POSTSUBSCRIPT italic_s italic_e italic_l italic_f end_POSTSUBSCRIPT ( roman_X ) = roman_Softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) bold_V ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p7.6">where <math alttext="d" class="ltx_Math" display="inline" id="S4.SS2.p7.2.m1.1"><semantics id="S4.SS2.p7.2.m1.1a"><mi id="S4.SS2.p7.2.m1.1.1" xref="S4.SS2.p7.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.2.m1.1b"><ci id="S4.SS2.p7.2.m1.1.1.cmml" xref="S4.SS2.p7.2.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.2.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.2.m1.1d">italic_d</annotation></semantics></math> is the dimension of the key embeddings, and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.SS2.p7.3.m2.1"><semantics id="S4.SS2.p7.3.m2.1a"><mi id="S4.SS2.p7.3.m2.1.1" xref="S4.SS2.p7.3.m2.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.3.m2.1b"><ci id="S4.SS2.p7.3.m2.1.1.cmml" xref="S4.SS2.p7.3.m2.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.3.m2.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.3.m2.1d">bold_Q</annotation></semantics></math>, <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.SS2.p7.4.m3.1"><semantics id="S4.SS2.p7.4.m3.1a"><mi id="S4.SS2.p7.4.m3.1.1" xref="S4.SS2.p7.4.m3.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.4.m3.1b"><ci id="S4.SS2.p7.4.m3.1.1.cmml" xref="S4.SS2.p7.4.m3.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.4.m3.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.4.m3.1d">bold_K</annotation></semantics></math>, and <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.SS2.p7.5.m4.1"><semantics id="S4.SS2.p7.5.m4.1a"><mi id="S4.SS2.p7.5.m4.1.1" xref="S4.SS2.p7.5.m4.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.5.m4.1b"><ci id="S4.SS2.p7.5.m4.1.1.cmml" xref="S4.SS2.p7.5.m4.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.5.m4.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.5.m4.1d">bold_V</annotation></semantics></math> are the query, key, and value matrices of the input <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S4.SS2.p7.6.m5.1"><semantics id="S4.SS2.p7.6.m5.1a"><mi id="S4.SS2.p7.6.m5.1.1" xref="S4.SS2.p7.6.m5.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.6.m5.1b"><ci id="S4.SS2.p7.6.m5.1.1.cmml" xref="S4.SS2.p7.6.m5.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.6.m5.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.6.m5.1d">bold_X</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p8">
<p class="ltx_p" id="S4.SS2.p8.3">For molecular structures, we need to select from the embedding table <math alttext="\mathbf{E}^{\prime}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p8.1.m1.1"><semantics id="S4.SS2.p8.1.m1.1a"><msubsup id="S4.SS2.p8.1.m1.1.1" xref="S4.SS2.p8.1.m1.1.1.cmml"><mi id="S4.SS2.p8.1.m1.1.1.2.2" xref="S4.SS2.p8.1.m1.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p8.1.m1.1.1.3" xref="S4.SS2.p8.1.m1.1.1.3.cmml">m</mi><mo id="S4.SS2.p8.1.m1.1.1.2.3" xref="S4.SS2.p8.1.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.m1.1b"><apply id="S4.SS2.p8.1.m1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.1.m1.1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p8.1.m1.1.1.2.cmml" xref="S4.SS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.1.m1.1.1.2.1.cmml" xref="S4.SS2.p8.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p8.1.m1.1.1.2.2.cmml" xref="S4.SS2.p8.1.m1.1.1.2.2">𝐄</ci><ci id="S4.SS2.p8.1.m1.1.1.2.3.cmml" xref="S4.SS2.p8.1.m1.1.1.2.3">′</ci></apply><ci id="S4.SS2.p8.1.m1.1.1.3.cmml" xref="S4.SS2.p8.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.1.m1.1c">\mathbf{E}^{\prime}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.1.m1.1d">bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> based on the patient’s visit data and perform molecular enhancement. We input <math alttext="\mathbf{E}^{\prime}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p8.2.m2.1"><semantics id="S4.SS2.p8.2.m2.1a"><msubsup id="S4.SS2.p8.2.m2.1.1" xref="S4.SS2.p8.2.m2.1.1.cmml"><mi id="S4.SS2.p8.2.m2.1.1.2.2" xref="S4.SS2.p8.2.m2.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p8.2.m2.1.1.3" xref="S4.SS2.p8.2.m2.1.1.3.cmml">m</mi><mo id="S4.SS2.p8.2.m2.1.1.2.3" xref="S4.SS2.p8.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.2.m2.1b"><apply id="S4.SS2.p8.2.m2.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.2.m2.1.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1">subscript</csymbol><apply id="S4.SS2.p8.2.m2.1.1.2.cmml" xref="S4.SS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.2.m2.1.1.2.1.cmml" xref="S4.SS2.p8.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p8.2.m2.1.1.2.2.cmml" xref="S4.SS2.p8.2.m2.1.1.2.2">𝐄</ci><ci id="S4.SS2.p8.2.m2.1.1.2.3.cmml" xref="S4.SS2.p8.2.m2.1.1.2.3">′</ci></apply><ci id="S4.SS2.p8.2.m2.1.1.3.cmml" xref="S4.SS2.p8.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.2.m2.1c">\mathbf{E}^{\prime}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.2.m2.1d">bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> into the global selection enhancement module (GSE) to obtain the enhanced result <math alttext="\mathbf{E}^{*}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p8.3.m3.1"><semantics id="S4.SS2.p8.3.m3.1a"><msubsup id="S4.SS2.p8.3.m3.1.1" xref="S4.SS2.p8.3.m3.1.1.cmml"><mi id="S4.SS2.p8.3.m3.1.1.2.2" xref="S4.SS2.p8.3.m3.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p8.3.m3.1.1.3" xref="S4.SS2.p8.3.m3.1.1.3.cmml">m</mi><mo id="S4.SS2.p8.3.m3.1.1.2.3" xref="S4.SS2.p8.3.m3.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.3.m3.1b"><apply id="S4.SS2.p8.3.m3.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.3.m3.1.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1">subscript</csymbol><apply id="S4.SS2.p8.3.m3.1.1.2.cmml" xref="S4.SS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.3.m3.1.1.2.1.cmml" xref="S4.SS2.p8.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p8.3.m3.1.1.2.2.cmml" xref="S4.SS2.p8.3.m3.1.1.2.2">𝐄</ci><times id="S4.SS2.p8.3.m3.1.1.2.3.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3"></times></apply><ci id="S4.SS2.p8.3.m3.1.1.3.cmml" xref="S4.SS2.p8.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.3.m3.1c">\mathbf{E}^{*}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.3.m3.1d">bold_E start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}^{*}_{m}=\text{GSE}(\text{SSA}(\mathbf{E}^{\prime}_{m}[i]\mid i\in m%
(t-1)))" class="ltx_Math" display="block" id="S4.E19.m1.2"><semantics id="S4.E19.m1.2a"><mrow id="S4.E19.m1.2.2" xref="S4.E19.m1.2.2.cmml"><msubsup id="S4.E19.m1.2.2.3" xref="S4.E19.m1.2.2.3.cmml"><mi id="S4.E19.m1.2.2.3.2.2" xref="S4.E19.m1.2.2.3.2.2.cmml">𝐄</mi><mi id="S4.E19.m1.2.2.3.3" xref="S4.E19.m1.2.2.3.3.cmml">m</mi><mo id="S4.E19.m1.2.2.3.2.3" xref="S4.E19.m1.2.2.3.2.3.cmml">∗</mo></msubsup><mo id="S4.E19.m1.2.2.2" xref="S4.E19.m1.2.2.2.cmml">=</mo><mrow id="S4.E19.m1.2.2.1" xref="S4.E19.m1.2.2.1.cmml"><mtext id="S4.E19.m1.2.2.1.3" xref="S4.E19.m1.2.2.1.3a.cmml">GSE</mtext><mo id="S4.E19.m1.2.2.1.2" xref="S4.E19.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.2.2.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.cmml"><mo id="S4.E19.m1.2.2.1.1.1.2" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E19.m1.2.2.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.cmml"><mtext id="S4.E19.m1.2.2.1.1.1.1.3" xref="S4.E19.m1.2.2.1.1.1.1.3a.cmml">SSA</mtext><mo id="S4.E19.m1.2.2.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><msubsup id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.2.cmml">𝐄</mi><mi id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.3.cmml">m</mi><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.3.cmml">′</mo></msubsup><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.1.cmml"><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.2.1" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.1.1.cmml">[</mo><mi id="S4.E19.m1.1.1" xref="S4.E19.m1.1.1.cmml">i</mi><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.2.2" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.2.cmml">∈</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">m</mi><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E19.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E19.m1.2.2.1.1.1.3" stretchy="false" xref="S4.E19.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E19.m1.2b"><apply id="S4.E19.m1.2.2.cmml" xref="S4.E19.m1.2.2"><eq id="S4.E19.m1.2.2.2.cmml" xref="S4.E19.m1.2.2.2"></eq><apply id="S4.E19.m1.2.2.3.cmml" xref="S4.E19.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.3.1.cmml" xref="S4.E19.m1.2.2.3">subscript</csymbol><apply id="S4.E19.m1.2.2.3.2.cmml" xref="S4.E19.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.3.2.1.cmml" xref="S4.E19.m1.2.2.3">superscript</csymbol><ci id="S4.E19.m1.2.2.3.2.2.cmml" xref="S4.E19.m1.2.2.3.2.2">𝐄</ci><times id="S4.E19.m1.2.2.3.2.3.cmml" xref="S4.E19.m1.2.2.3.2.3"></times></apply><ci id="S4.E19.m1.2.2.3.3.cmml" xref="S4.E19.m1.2.2.3.3">𝑚</ci></apply><apply id="S4.E19.m1.2.2.1.cmml" xref="S4.E19.m1.2.2.1"><times id="S4.E19.m1.2.2.1.2.cmml" xref="S4.E19.m1.2.2.1.2"></times><ci id="S4.E19.m1.2.2.1.3a.cmml" xref="S4.E19.m1.2.2.1.3"><mtext id="S4.E19.m1.2.2.1.3.cmml" xref="S4.E19.m1.2.2.1.3">GSE</mtext></ci><apply id="S4.E19.m1.2.2.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1"><times id="S4.E19.m1.2.2.1.1.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.2"></times><ci id="S4.E19.m1.2.2.1.1.1.1.3a.cmml" xref="S4.E19.m1.2.2.1.1.1.1.3"><mtext id="S4.E19.m1.2.2.1.1.1.1.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.3">SSA</mtext></ci><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1"><in id="S4.E19.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.2"></in><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2"><times id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.1"></times><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.2">𝐄</ci><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.3">′</ci></apply><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.2.3">𝑚</ci></apply><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.2"><csymbol cd="latexml" id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.2.3.2.1">delimited-[]</csymbol><ci id="S4.E19.m1.1.1.cmml" xref="S4.E19.m1.1.1">𝑖</ci></apply></apply><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1"><times id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.3">𝑚</ci><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑡</ci><cn id="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E19.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m1.2c">\mathbf{E}^{*}_{m}=\text{GSE}(\text{SSA}(\mathbf{E}^{\prime}_{m}[i]\mid i\in m%
(t-1)))</annotation><annotation encoding="application/x-llamapun" id="S4.E19.m1.2d">bold_E start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = GSE ( SSA ( bold_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT [ italic_i ] ∣ italic_i ∈ italic_m ( italic_t - 1 ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p9">
<p class="ltx_p" id="S4.SS2.p9.2">We perform attention aggregation on the overall molecular representation <math alttext="\mathbf{E}^{*}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p9.1.m1.1"><semantics id="S4.SS2.p9.1.m1.1a"><msubsup id="S4.SS2.p9.1.m1.1.1" xref="S4.SS2.p9.1.m1.1.1.cmml"><mi id="S4.SS2.p9.1.m1.1.1.2.2" xref="S4.SS2.p9.1.m1.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p9.1.m1.1.1.3" xref="S4.SS2.p9.1.m1.1.1.3.cmml">m</mi><mo id="S4.SS2.p9.1.m1.1.1.2.3" xref="S4.SS2.p9.1.m1.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.1.m1.1b"><apply id="S4.SS2.p9.1.m1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.1.m1.1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p9.1.m1.1.1.2.cmml" xref="S4.SS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.1.m1.1.1.2.1.cmml" xref="S4.SS2.p9.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p9.1.m1.1.1.2.2.cmml" xref="S4.SS2.p9.1.m1.1.1.2.2">𝐄</ci><times id="S4.SS2.p9.1.m1.1.1.2.3.cmml" xref="S4.SS2.p9.1.m1.1.1.2.3"></times></apply><ci id="S4.SS2.p9.1.m1.1.1.3.cmml" xref="S4.SS2.p9.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.1.m1.1c">\mathbf{E}^{*}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.1.m1.1d">bold_E start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and the substructure interaction representation <math alttext="\mathbf{E}^{*}_{s}" class="ltx_Math" display="inline" id="S4.SS2.p9.2.m2.1"><semantics id="S4.SS2.p9.2.m2.1a"><msubsup id="S4.SS2.p9.2.m2.1.1" xref="S4.SS2.p9.2.m2.1.1.cmml"><mi id="S4.SS2.p9.2.m2.1.1.2.2" xref="S4.SS2.p9.2.m2.1.1.2.2.cmml">𝐄</mi><mi id="S4.SS2.p9.2.m2.1.1.3" xref="S4.SS2.p9.2.m2.1.1.3.cmml">s</mi><mo id="S4.SS2.p9.2.m2.1.1.2.3" xref="S4.SS2.p9.2.m2.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.2.m2.1b"><apply id="S4.SS2.p9.2.m2.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.2.m2.1.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1">subscript</csymbol><apply id="S4.SS2.p9.2.m2.1.1.2.cmml" xref="S4.SS2.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.2.m2.1.1.2.1.cmml" xref="S4.SS2.p9.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p9.2.m2.1.1.2.2.cmml" xref="S4.SS2.p9.2.m2.1.1.2.2">𝐄</ci><times id="S4.SS2.p9.2.m2.1.1.2.3.cmml" xref="S4.SS2.p9.2.m2.1.1.2.3"></times></apply><ci id="S4.SS2.p9.2.m2.1.1.3.cmml" xref="S4.SS2.p9.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.2.m2.1c">\mathbf{E}^{*}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.2.m2.1d">bold_E start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, using a mask matrix to rescale the attention matrix when calculating the attention coefficients.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx5">
<tbody id="S4.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{A}_{mol-sub}(\mathrm{X,Y})=\mathrm{Softmax}\left(\frac{%
\mathbf{Q}_{x}\mathbf{K}_{y}^{\top}}{\sqrt{d_{min}}}\right)," class="ltx_Math" display="block" id="S4.E20.m1.4"><semantics id="S4.E20.m1.4a"><mrow id="S4.E20.m1.4.4.1" xref="S4.E20.m1.4.4.1.1.cmml"><mrow id="S4.E20.m1.4.4.1.1" xref="S4.E20.m1.4.4.1.1.cmml"><mrow id="S4.E20.m1.4.4.1.1.2" xref="S4.E20.m1.4.4.1.1.2.cmml"><msub id="S4.E20.m1.4.4.1.1.2.2" xref="S4.E20.m1.4.4.1.1.2.2.cmml"><mi id="S4.E20.m1.4.4.1.1.2.2.2" xref="S4.E20.m1.4.4.1.1.2.2.2.cmml">𝐀</mi><mrow id="S4.E20.m1.4.4.1.1.2.2.3" xref="S4.E20.m1.4.4.1.1.2.2.3.cmml"><mrow id="S4.E20.m1.4.4.1.1.2.2.3.2" xref="S4.E20.m1.4.4.1.1.2.2.3.2.cmml"><mi id="S4.E20.m1.4.4.1.1.2.2.3.2.2" xref="S4.E20.m1.4.4.1.1.2.2.3.2.2.cmml">m</mi><mo id="S4.E20.m1.4.4.1.1.2.2.3.2.1" xref="S4.E20.m1.4.4.1.1.2.2.3.2.1.cmml">⁢</mo><mi id="S4.E20.m1.4.4.1.1.2.2.3.2.3" xref="S4.E20.m1.4.4.1.1.2.2.3.2.3.cmml">o</mi><mo id="S4.E20.m1.4.4.1.1.2.2.3.2.1a" xref="S4.E20.m1.4.4.1.1.2.2.3.2.1.cmml">⁢</mo><mi id="S4.E20.m1.4.4.1.1.2.2.3.2.4" xref="S4.E20.m1.4.4.1.1.2.2.3.2.4.cmml">l</mi></mrow><mo id="S4.E20.m1.4.4.1.1.2.2.3.1" xref="S4.E20.m1.4.4.1.1.2.2.3.1.cmml">−</mo><mrow id="S4.E20.m1.4.4.1.1.2.2.3.3" xref="S4.E20.m1.4.4.1.1.2.2.3.3.cmml"><mi id="S4.E20.m1.4.4.1.1.2.2.3.3.2" xref="S4.E20.m1.4.4.1.1.2.2.3.3.2.cmml">s</mi><mo id="S4.E20.m1.4.4.1.1.2.2.3.3.1" xref="S4.E20.m1.4.4.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E20.m1.4.4.1.1.2.2.3.3.3" xref="S4.E20.m1.4.4.1.1.2.2.3.3.3.cmml">u</mi><mo id="S4.E20.m1.4.4.1.1.2.2.3.3.1a" xref="S4.E20.m1.4.4.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E20.m1.4.4.1.1.2.2.3.3.4" xref="S4.E20.m1.4.4.1.1.2.2.3.3.4.cmml">b</mi></mrow></mrow></msub><mo id="S4.E20.m1.4.4.1.1.2.1" xref="S4.E20.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="S4.E20.m1.4.4.1.1.2.3.2" xref="S4.E20.m1.4.4.1.1.2.3.1.cmml"><mo id="S4.E20.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S4.E20.m1.4.4.1.1.2.3.1.cmml">(</mo><mi id="S4.E20.m1.1.1" mathvariant="normal" xref="S4.E20.m1.1.1.cmml">X</mi><mo id="S4.E20.m1.4.4.1.1.2.3.2.2" xref="S4.E20.m1.4.4.1.1.2.3.1.cmml">,</mo><mi id="S4.E20.m1.2.2" mathvariant="normal" xref="S4.E20.m1.2.2.cmml">Y</mi><mo id="S4.E20.m1.4.4.1.1.2.3.2.3" stretchy="false" xref="S4.E20.m1.4.4.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E20.m1.4.4.1.1.1" xref="S4.E20.m1.4.4.1.1.1.cmml">=</mo><mrow id="S4.E20.m1.4.4.1.1.3" xref="S4.E20.m1.4.4.1.1.3.cmml"><mi id="S4.E20.m1.4.4.1.1.3.2" xref="S4.E20.m1.4.4.1.1.3.2.cmml">Softmax</mi><mo id="S4.E20.m1.4.4.1.1.3.1" xref="S4.E20.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S4.E20.m1.4.4.1.1.3.3.2" xref="S4.E20.m1.3.3.cmml"><mo id="S4.E20.m1.4.4.1.1.3.3.2.1" xref="S4.E20.m1.3.3.cmml">(</mo><mfrac id="S4.E20.m1.3.3" xref="S4.E20.m1.3.3.cmml"><mrow id="S4.E20.m1.3.3.2" xref="S4.E20.m1.3.3.2.cmml"><msub id="S4.E20.m1.3.3.2.2" xref="S4.E20.m1.3.3.2.2.cmml"><mi id="S4.E20.m1.3.3.2.2.2" xref="S4.E20.m1.3.3.2.2.2.cmml">𝐐</mi><mi id="S4.E20.m1.3.3.2.2.3" xref="S4.E20.m1.3.3.2.2.3.cmml">x</mi></msub><mo id="S4.E20.m1.3.3.2.1" xref="S4.E20.m1.3.3.2.1.cmml">⁢</mo><msubsup id="S4.E20.m1.3.3.2.3" xref="S4.E20.m1.3.3.2.3.cmml"><mi id="S4.E20.m1.3.3.2.3.2.2" xref="S4.E20.m1.3.3.2.3.2.2.cmml">𝐊</mi><mi id="S4.E20.m1.3.3.2.3.2.3" xref="S4.E20.m1.3.3.2.3.2.3.cmml">y</mi><mo id="S4.E20.m1.3.3.2.3.3" xref="S4.E20.m1.3.3.2.3.3.cmml">⊤</mo></msubsup></mrow><msqrt id="S4.E20.m1.3.3.3" xref="S4.E20.m1.3.3.3.cmml"><msub id="S4.E20.m1.3.3.3.2" xref="S4.E20.m1.3.3.3.2.cmml"><mi id="S4.E20.m1.3.3.3.2.2" xref="S4.E20.m1.3.3.3.2.2.cmml">d</mi><mrow id="S4.E20.m1.3.3.3.2.3" xref="S4.E20.m1.3.3.3.2.3.cmml"><mi id="S4.E20.m1.3.3.3.2.3.2" xref="S4.E20.m1.3.3.3.2.3.2.cmml">m</mi><mo id="S4.E20.m1.3.3.3.2.3.1" xref="S4.E20.m1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E20.m1.3.3.3.2.3.3" xref="S4.E20.m1.3.3.3.2.3.3.cmml">i</mi><mo id="S4.E20.m1.3.3.3.2.3.1a" xref="S4.E20.m1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E20.m1.3.3.3.2.3.4" xref="S4.E20.m1.3.3.3.2.3.4.cmml">n</mi></mrow></msub></msqrt></mfrac><mo id="S4.E20.m1.4.4.1.1.3.3.2.2" xref="S4.E20.m1.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E20.m1.4.4.1.2" xref="S4.E20.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E20.m1.4b"><apply id="S4.E20.m1.4.4.1.1.cmml" xref="S4.E20.m1.4.4.1"><eq id="S4.E20.m1.4.4.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1"></eq><apply id="S4.E20.m1.4.4.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.2"><times id="S4.E20.m1.4.4.1.1.2.1.cmml" xref="S4.E20.m1.4.4.1.1.2.1"></times><apply id="S4.E20.m1.4.4.1.1.2.2.cmml" xref="S4.E20.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.2.2.1.cmml" xref="S4.E20.m1.4.4.1.1.2.2">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.2.2.2.cmml" xref="S4.E20.m1.4.4.1.1.2.2.2">𝐀</ci><apply id="S4.E20.m1.4.4.1.1.2.2.3.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3"><minus id="S4.E20.m1.4.4.1.1.2.2.3.1.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.1"></minus><apply id="S4.E20.m1.4.4.1.1.2.2.3.2.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.2"><times id="S4.E20.m1.4.4.1.1.2.2.3.2.1.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.2.1"></times><ci id="S4.E20.m1.4.4.1.1.2.2.3.2.2.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.2.2">𝑚</ci><ci id="S4.E20.m1.4.4.1.1.2.2.3.2.3.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.2.3">𝑜</ci><ci id="S4.E20.m1.4.4.1.1.2.2.3.2.4.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.2.4">𝑙</ci></apply><apply id="S4.E20.m1.4.4.1.1.2.2.3.3.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.3"><times id="S4.E20.m1.4.4.1.1.2.2.3.3.1.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.3.1"></times><ci id="S4.E20.m1.4.4.1.1.2.2.3.3.2.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.3.2">𝑠</ci><ci id="S4.E20.m1.4.4.1.1.2.2.3.3.3.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.3.3">𝑢</ci><ci id="S4.E20.m1.4.4.1.1.2.2.3.3.4.cmml" xref="S4.E20.m1.4.4.1.1.2.2.3.3.4">𝑏</ci></apply></apply></apply><interval closure="open" id="S4.E20.m1.4.4.1.1.2.3.1.cmml" xref="S4.E20.m1.4.4.1.1.2.3.2"><ci id="S4.E20.m1.1.1.cmml" xref="S4.E20.m1.1.1">X</ci><ci id="S4.E20.m1.2.2.cmml" xref="S4.E20.m1.2.2">Y</ci></interval></apply><apply id="S4.E20.m1.4.4.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.3"><times id="S4.E20.m1.4.4.1.1.3.1.cmml" xref="S4.E20.m1.4.4.1.1.3.1"></times><ci id="S4.E20.m1.4.4.1.1.3.2.cmml" xref="S4.E20.m1.4.4.1.1.3.2">Softmax</ci><apply id="S4.E20.m1.3.3.cmml" xref="S4.E20.m1.4.4.1.1.3.3.2"><divide id="S4.E20.m1.3.3.1.cmml" xref="S4.E20.m1.4.4.1.1.3.3.2"></divide><apply id="S4.E20.m1.3.3.2.cmml" xref="S4.E20.m1.3.3.2"><times id="S4.E20.m1.3.3.2.1.cmml" xref="S4.E20.m1.3.3.2.1"></times><apply id="S4.E20.m1.3.3.2.2.cmml" xref="S4.E20.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E20.m1.3.3.2.2.1.cmml" xref="S4.E20.m1.3.3.2.2">subscript</csymbol><ci id="S4.E20.m1.3.3.2.2.2.cmml" xref="S4.E20.m1.3.3.2.2.2">𝐐</ci><ci id="S4.E20.m1.3.3.2.2.3.cmml" xref="S4.E20.m1.3.3.2.2.3">𝑥</ci></apply><apply id="S4.E20.m1.3.3.2.3.cmml" xref="S4.E20.m1.3.3.2.3"><csymbol cd="ambiguous" id="S4.E20.m1.3.3.2.3.1.cmml" xref="S4.E20.m1.3.3.2.3">superscript</csymbol><apply id="S4.E20.m1.3.3.2.3.2.cmml" xref="S4.E20.m1.3.3.2.3"><csymbol cd="ambiguous" id="S4.E20.m1.3.3.2.3.2.1.cmml" xref="S4.E20.m1.3.3.2.3">subscript</csymbol><ci id="S4.E20.m1.3.3.2.3.2.2.cmml" xref="S4.E20.m1.3.3.2.3.2.2">𝐊</ci><ci id="S4.E20.m1.3.3.2.3.2.3.cmml" xref="S4.E20.m1.3.3.2.3.2.3">𝑦</ci></apply><csymbol cd="latexml" id="S4.E20.m1.3.3.2.3.3.cmml" xref="S4.E20.m1.3.3.2.3.3">top</csymbol></apply></apply><apply id="S4.E20.m1.3.3.3.cmml" xref="S4.E20.m1.3.3.3"><root id="S4.E20.m1.3.3.3a.cmml" xref="S4.E20.m1.3.3.3"></root><apply id="S4.E20.m1.3.3.3.2.cmml" xref="S4.E20.m1.3.3.3.2"><csymbol cd="ambiguous" id="S4.E20.m1.3.3.3.2.1.cmml" xref="S4.E20.m1.3.3.3.2">subscript</csymbol><ci id="S4.E20.m1.3.3.3.2.2.cmml" xref="S4.E20.m1.3.3.3.2.2">𝑑</ci><apply id="S4.E20.m1.3.3.3.2.3.cmml" xref="S4.E20.m1.3.3.3.2.3"><times id="S4.E20.m1.3.3.3.2.3.1.cmml" xref="S4.E20.m1.3.3.3.2.3.1"></times><ci id="S4.E20.m1.3.3.3.2.3.2.cmml" xref="S4.E20.m1.3.3.3.2.3.2">𝑚</ci><ci id="S4.E20.m1.3.3.3.2.3.3.cmml" xref="S4.E20.m1.3.3.3.2.3.3">𝑖</ci><ci id="S4.E20.m1.3.3.3.2.3.4.cmml" xref="S4.E20.m1.3.3.3.2.3.4">𝑛</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20.m1.4c">\displaystyle\mathbf{A}_{mol-sub}(\mathrm{X,Y})=\mathrm{Softmax}\left(\frac{%
\mathbf{Q}_{x}\mathbf{K}_{y}^{\top}}{\sqrt{d_{min}}}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E20.m1.4d">bold_A start_POSTSUBSCRIPT italic_m italic_o italic_l - italic_s italic_u italic_b end_POSTSUBSCRIPT ( roman_X , roman_Y ) = roman_Softmax ( divide start_ARG bold_Q start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT bold_K start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT end_ARG end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="S4.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{A}_{mol-sub}(\mathrm{X,Y})=\mathrm{mask}(\mathbf{A}_{mol-%
sub},-(1\ll 32))" class="ltx_Math" display="block" id="S4.E21.m1.4"><semantics id="S4.E21.m1.4a"><mrow id="S4.E21.m1.4.4" xref="S4.E21.m1.4.4.cmml"><mrow id="S4.E21.m1.4.4.4" xref="S4.E21.m1.4.4.4.cmml"><msub id="S4.E21.m1.4.4.4.2" xref="S4.E21.m1.4.4.4.2.cmml"><mi id="S4.E21.m1.4.4.4.2.2" xref="S4.E21.m1.4.4.4.2.2.cmml">𝐀</mi><mrow id="S4.E21.m1.4.4.4.2.3" xref="S4.E21.m1.4.4.4.2.3.cmml"><mrow id="S4.E21.m1.4.4.4.2.3.2" xref="S4.E21.m1.4.4.4.2.3.2.cmml"><mi id="S4.E21.m1.4.4.4.2.3.2.2" xref="S4.E21.m1.4.4.4.2.3.2.2.cmml">m</mi><mo id="S4.E21.m1.4.4.4.2.3.2.1" xref="S4.E21.m1.4.4.4.2.3.2.1.cmml">⁢</mo><mi id="S4.E21.m1.4.4.4.2.3.2.3" xref="S4.E21.m1.4.4.4.2.3.2.3.cmml">o</mi><mo id="S4.E21.m1.4.4.4.2.3.2.1a" xref="S4.E21.m1.4.4.4.2.3.2.1.cmml">⁢</mo><mi id="S4.E21.m1.4.4.4.2.3.2.4" xref="S4.E21.m1.4.4.4.2.3.2.4.cmml">l</mi></mrow><mo id="S4.E21.m1.4.4.4.2.3.1" xref="S4.E21.m1.4.4.4.2.3.1.cmml">−</mo><mrow id="S4.E21.m1.4.4.4.2.3.3" xref="S4.E21.m1.4.4.4.2.3.3.cmml"><mi id="S4.E21.m1.4.4.4.2.3.3.2" xref="S4.E21.m1.4.4.4.2.3.3.2.cmml">s</mi><mo id="S4.E21.m1.4.4.4.2.3.3.1" xref="S4.E21.m1.4.4.4.2.3.3.1.cmml">⁢</mo><mi id="S4.E21.m1.4.4.4.2.3.3.3" xref="S4.E21.m1.4.4.4.2.3.3.3.cmml">u</mi><mo id="S4.E21.m1.4.4.4.2.3.3.1a" xref="S4.E21.m1.4.4.4.2.3.3.1.cmml">⁢</mo><mi id="S4.E21.m1.4.4.4.2.3.3.4" xref="S4.E21.m1.4.4.4.2.3.3.4.cmml">b</mi></mrow></mrow></msub><mo id="S4.E21.m1.4.4.4.1" xref="S4.E21.m1.4.4.4.1.cmml">⁢</mo><mrow id="S4.E21.m1.4.4.4.3.2" xref="S4.E21.m1.4.4.4.3.1.cmml"><mo id="S4.E21.m1.4.4.4.3.2.1" stretchy="false" xref="S4.E21.m1.4.4.4.3.1.cmml">(</mo><mi id="S4.E21.m1.1.1" mathvariant="normal" xref="S4.E21.m1.1.1.cmml">X</mi><mo id="S4.E21.m1.4.4.4.3.2.2" xref="S4.E21.m1.4.4.4.3.1.cmml">,</mo><mi id="S4.E21.m1.2.2" mathvariant="normal" xref="S4.E21.m1.2.2.cmml">Y</mi><mo id="S4.E21.m1.4.4.4.3.2.3" stretchy="false" xref="S4.E21.m1.4.4.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E21.m1.4.4.3" xref="S4.E21.m1.4.4.3.cmml">=</mo><mrow id="S4.E21.m1.4.4.2" xref="S4.E21.m1.4.4.2.cmml"><mi id="S4.E21.m1.4.4.2.4" xref="S4.E21.m1.4.4.2.4.cmml">mask</mi><mo id="S4.E21.m1.4.4.2.3" xref="S4.E21.m1.4.4.2.3.cmml">⁢</mo><mrow id="S4.E21.m1.4.4.2.2.2" xref="S4.E21.m1.4.4.2.2.3.cmml"><mo id="S4.E21.m1.4.4.2.2.2.3" stretchy="false" xref="S4.E21.m1.4.4.2.2.3.cmml">(</mo><msub id="S4.E21.m1.3.3.1.1.1.1" xref="S4.E21.m1.3.3.1.1.1.1.cmml"><mi id="S4.E21.m1.3.3.1.1.1.1.2" xref="S4.E21.m1.3.3.1.1.1.1.2.cmml">𝐀</mi><mrow id="S4.E21.m1.3.3.1.1.1.1.3" xref="S4.E21.m1.3.3.1.1.1.1.3.cmml"><mrow id="S4.E21.m1.3.3.1.1.1.1.3.2" xref="S4.E21.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S4.E21.m1.3.3.1.1.1.1.3.2.2" xref="S4.E21.m1.3.3.1.1.1.1.3.2.2.cmml">m</mi><mo id="S4.E21.m1.3.3.1.1.1.1.3.2.1" xref="S4.E21.m1.3.3.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.E21.m1.3.3.1.1.1.1.3.2.3" xref="S4.E21.m1.3.3.1.1.1.1.3.2.3.cmml">o</mi><mo id="S4.E21.m1.3.3.1.1.1.1.3.2.1a" xref="S4.E21.m1.3.3.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.E21.m1.3.3.1.1.1.1.3.2.4" xref="S4.E21.m1.3.3.1.1.1.1.3.2.4.cmml">l</mi></mrow><mo id="S4.E21.m1.3.3.1.1.1.1.3.1" xref="S4.E21.m1.3.3.1.1.1.1.3.1.cmml">−</mo><mrow id="S4.E21.m1.3.3.1.1.1.1.3.3" xref="S4.E21.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S4.E21.m1.3.3.1.1.1.1.3.3.2" xref="S4.E21.m1.3.3.1.1.1.1.3.3.2.cmml">s</mi><mo id="S4.E21.m1.3.3.1.1.1.1.3.3.1" xref="S4.E21.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E21.m1.3.3.1.1.1.1.3.3.3" xref="S4.E21.m1.3.3.1.1.1.1.3.3.3.cmml">u</mi><mo id="S4.E21.m1.3.3.1.1.1.1.3.3.1a" xref="S4.E21.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E21.m1.3.3.1.1.1.1.3.3.4" xref="S4.E21.m1.3.3.1.1.1.1.3.3.4.cmml">b</mi></mrow></mrow></msub><mo id="S4.E21.m1.4.4.2.2.2.4" xref="S4.E21.m1.4.4.2.2.3.cmml">,</mo><mrow id="S4.E21.m1.4.4.2.2.2.2" xref="S4.E21.m1.4.4.2.2.2.2.cmml"><mo id="S4.E21.m1.4.4.2.2.2.2a" xref="S4.E21.m1.4.4.2.2.2.2.cmml">−</mo><mrow id="S4.E21.m1.4.4.2.2.2.2.1.1" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.cmml"><mo id="S4.E21.m1.4.4.2.2.2.2.1.1.2" stretchy="false" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.4.4.2.2.2.2.1.1.1" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.cmml"><mn id="S4.E21.m1.4.4.2.2.2.2.1.1.1.2" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E21.m1.4.4.2.2.2.2.1.1.1.1" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.1.cmml">≪</mo><mn id="S4.E21.m1.4.4.2.2.2.2.1.1.1.3" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.3.cmml">32</mn></mrow><mo id="S4.E21.m1.4.4.2.2.2.2.1.1.3" stretchy="false" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E21.m1.4.4.2.2.2.5" stretchy="false" xref="S4.E21.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E21.m1.4b"><apply id="S4.E21.m1.4.4.cmml" xref="S4.E21.m1.4.4"><eq id="S4.E21.m1.4.4.3.cmml" xref="S4.E21.m1.4.4.3"></eq><apply id="S4.E21.m1.4.4.4.cmml" xref="S4.E21.m1.4.4.4"><times id="S4.E21.m1.4.4.4.1.cmml" xref="S4.E21.m1.4.4.4.1"></times><apply id="S4.E21.m1.4.4.4.2.cmml" xref="S4.E21.m1.4.4.4.2"><csymbol cd="ambiguous" id="S4.E21.m1.4.4.4.2.1.cmml" xref="S4.E21.m1.4.4.4.2">subscript</csymbol><ci id="S4.E21.m1.4.4.4.2.2.cmml" xref="S4.E21.m1.4.4.4.2.2">𝐀</ci><apply id="S4.E21.m1.4.4.4.2.3.cmml" xref="S4.E21.m1.4.4.4.2.3"><minus id="S4.E21.m1.4.4.4.2.3.1.cmml" xref="S4.E21.m1.4.4.4.2.3.1"></minus><apply id="S4.E21.m1.4.4.4.2.3.2.cmml" xref="S4.E21.m1.4.4.4.2.3.2"><times id="S4.E21.m1.4.4.4.2.3.2.1.cmml" xref="S4.E21.m1.4.4.4.2.3.2.1"></times><ci id="S4.E21.m1.4.4.4.2.3.2.2.cmml" xref="S4.E21.m1.4.4.4.2.3.2.2">𝑚</ci><ci id="S4.E21.m1.4.4.4.2.3.2.3.cmml" xref="S4.E21.m1.4.4.4.2.3.2.3">𝑜</ci><ci id="S4.E21.m1.4.4.4.2.3.2.4.cmml" xref="S4.E21.m1.4.4.4.2.3.2.4">𝑙</ci></apply><apply id="S4.E21.m1.4.4.4.2.3.3.cmml" xref="S4.E21.m1.4.4.4.2.3.3"><times id="S4.E21.m1.4.4.4.2.3.3.1.cmml" xref="S4.E21.m1.4.4.4.2.3.3.1"></times><ci id="S4.E21.m1.4.4.4.2.3.3.2.cmml" xref="S4.E21.m1.4.4.4.2.3.3.2">𝑠</ci><ci id="S4.E21.m1.4.4.4.2.3.3.3.cmml" xref="S4.E21.m1.4.4.4.2.3.3.3">𝑢</ci><ci id="S4.E21.m1.4.4.4.2.3.3.4.cmml" xref="S4.E21.m1.4.4.4.2.3.3.4">𝑏</ci></apply></apply></apply><interval closure="open" id="S4.E21.m1.4.4.4.3.1.cmml" xref="S4.E21.m1.4.4.4.3.2"><ci id="S4.E21.m1.1.1.cmml" xref="S4.E21.m1.1.1">X</ci><ci id="S4.E21.m1.2.2.cmml" xref="S4.E21.m1.2.2">Y</ci></interval></apply><apply id="S4.E21.m1.4.4.2.cmml" xref="S4.E21.m1.4.4.2"><times id="S4.E21.m1.4.4.2.3.cmml" xref="S4.E21.m1.4.4.2.3"></times><ci id="S4.E21.m1.4.4.2.4.cmml" xref="S4.E21.m1.4.4.2.4">mask</ci><interval closure="open" id="S4.E21.m1.4.4.2.2.3.cmml" xref="S4.E21.m1.4.4.2.2.2"><apply id="S4.E21.m1.3.3.1.1.1.1.cmml" xref="S4.E21.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.3.3.1.1.1.1.1.cmml" xref="S4.E21.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.E21.m1.3.3.1.1.1.1.2.cmml" xref="S4.E21.m1.3.3.1.1.1.1.2">𝐀</ci><apply id="S4.E21.m1.3.3.1.1.1.1.3.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3"><minus id="S4.E21.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.1"></minus><apply id="S4.E21.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.2"><times id="S4.E21.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.2.1"></times><ci id="S4.E21.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.2.2">𝑚</ci><ci id="S4.E21.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.2.3">𝑜</ci><ci id="S4.E21.m1.3.3.1.1.1.1.3.2.4.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.2.4">𝑙</ci></apply><apply id="S4.E21.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.3"><times id="S4.E21.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.3.1"></times><ci id="S4.E21.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.3.2">𝑠</ci><ci id="S4.E21.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.3.3">𝑢</ci><ci id="S4.E21.m1.3.3.1.1.1.1.3.3.4.cmml" xref="S4.E21.m1.3.3.1.1.1.1.3.3.4">𝑏</ci></apply></apply></apply><apply id="S4.E21.m1.4.4.2.2.2.2.cmml" xref="S4.E21.m1.4.4.2.2.2.2"><minus id="S4.E21.m1.4.4.2.2.2.2.2.cmml" xref="S4.E21.m1.4.4.2.2.2.2"></minus><apply id="S4.E21.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S4.E21.m1.4.4.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.E21.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.1">much-less-than</csymbol><cn id="S4.E21.m1.4.4.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.2">1</cn><cn id="S4.E21.m1.4.4.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.E21.m1.4.4.2.2.2.2.1.1.1.3">32</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E21.m1.4c">\displaystyle\mathbf{A}_{mol-sub}(\mathrm{X,Y})=\mathrm{mask}(\mathbf{A}_{mol-%
sub},-(1\ll 32))</annotation><annotation encoding="application/x-llamapun" id="S4.E21.m1.4d">bold_A start_POSTSUBSCRIPT italic_m italic_o italic_l - italic_s italic_u italic_b end_POSTSUBSCRIPT ( roman_X , roman_Y ) = roman_mask ( bold_A start_POSTSUBSCRIPT italic_m italic_o italic_l - italic_s italic_u italic_b end_POSTSUBSCRIPT , - ( 1 ≪ 32 ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p9.7">where <math alttext="d_{\min}" class="ltx_Math" display="inline" id="S4.SS2.p9.3.m1.1"><semantics id="S4.SS2.p9.3.m1.1a"><msub id="S4.SS2.p9.3.m1.1.1" xref="S4.SS2.p9.3.m1.1.1.cmml"><mi id="S4.SS2.p9.3.m1.1.1.2" xref="S4.SS2.p9.3.m1.1.1.2.cmml">d</mi><mi id="S4.SS2.p9.3.m1.1.1.3" xref="S4.SS2.p9.3.m1.1.1.3.cmml">min</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.3.m1.1b"><apply id="S4.SS2.p9.3.m1.1.1.cmml" xref="S4.SS2.p9.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.3.m1.1.1.1.cmml" xref="S4.SS2.p9.3.m1.1.1">subscript</csymbol><ci id="S4.SS2.p9.3.m1.1.1.2.cmml" xref="S4.SS2.p9.3.m1.1.1.2">𝑑</ci><min id="S4.SS2.p9.3.m1.1.1.3.cmml" xref="S4.SS2.p9.3.m1.1.1.3"></min></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.3.m1.1c">d_{\min}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.3.m1.1d">italic_d start_POSTSUBSCRIPT roman_min end_POSTSUBSCRIPT</annotation></semantics></math> is the minimum embedding dimension of <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S4.SS2.p9.4.m2.1"><semantics id="S4.SS2.p9.4.m2.1a"><mi id="S4.SS2.p9.4.m2.1.1" xref="S4.SS2.p9.4.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.4.m2.1b"><ci id="S4.SS2.p9.4.m2.1.1.cmml" xref="S4.SS2.p9.4.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.4.m2.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.4.m2.1d">bold_X</annotation></semantics></math> and <math alttext="\mathbf{Y}" class="ltx_Math" display="inline" id="S4.SS2.p9.5.m3.1"><semantics id="S4.SS2.p9.5.m3.1a"><mi id="S4.SS2.p9.5.m3.1.1" xref="S4.SS2.p9.5.m3.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.5.m3.1b"><ci id="S4.SS2.p9.5.m3.1.1.cmml" xref="S4.SS2.p9.5.m3.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.5.m3.1c">\mathbf{Y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.5.m3.1d">bold_Y</annotation></semantics></math>, <math alttext="\mathbf{Q}_{x}" class="ltx_Math" display="inline" id="S4.SS2.p9.6.m4.1"><semantics id="S4.SS2.p9.6.m4.1a"><msub id="S4.SS2.p9.6.m4.1.1" xref="S4.SS2.p9.6.m4.1.1.cmml"><mi id="S4.SS2.p9.6.m4.1.1.2" xref="S4.SS2.p9.6.m4.1.1.2.cmml">𝐐</mi><mi id="S4.SS2.p9.6.m4.1.1.3" xref="S4.SS2.p9.6.m4.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.6.m4.1b"><apply id="S4.SS2.p9.6.m4.1.1.cmml" xref="S4.SS2.p9.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.6.m4.1.1.1.cmml" xref="S4.SS2.p9.6.m4.1.1">subscript</csymbol><ci id="S4.SS2.p9.6.m4.1.1.2.cmml" xref="S4.SS2.p9.6.m4.1.1.2">𝐐</ci><ci id="S4.SS2.p9.6.m4.1.1.3.cmml" xref="S4.SS2.p9.6.m4.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.6.m4.1c">\mathbf{Q}_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.6.m4.1d">bold_Q start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{K}_{y}" class="ltx_Math" display="inline" id="S4.SS2.p9.7.m5.1"><semantics id="S4.SS2.p9.7.m5.1a"><msub id="S4.SS2.p9.7.m5.1.1" xref="S4.SS2.p9.7.m5.1.1.cmml"><mi id="S4.SS2.p9.7.m5.1.1.2" xref="S4.SS2.p9.7.m5.1.1.2.cmml">𝐊</mi><mi id="S4.SS2.p9.7.m5.1.1.3" xref="S4.SS2.p9.7.m5.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.7.m5.1b"><apply id="S4.SS2.p9.7.m5.1.1.cmml" xref="S4.SS2.p9.7.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.7.m5.1.1.1.cmml" xref="S4.SS2.p9.7.m5.1.1">subscript</csymbol><ci id="S4.SS2.p9.7.m5.1.1.2.cmml" xref="S4.SS2.p9.7.m5.1.1.2">𝐊</ci><ci id="S4.SS2.p9.7.m5.1.1.3.cmml" xref="S4.SS2.p9.7.m5.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.7.m5.1c">\mathbf{K}_{y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.7.m5.1d">bold_K start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> are the query and key matrices of the input, and the mask function replaces the set of substructures without mapping relationships with the minimum value.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\forall s\in S,\tilde{\mathbf{y}}_{s}^{(i)}=\mathbf{e}_{s}^{\prime(i)}\mathbf{%
y}_{s}," class="ltx_Math" display="block" id="S4.E22.m1.5"><semantics id="S4.E22.m1.5a"><mrow id="S4.E22.m1.5.5.1"><mrow id="S4.E22.m1.5.5.1.1.2" xref="S4.E22.m1.5.5.1.1.3.cmml"><mrow id="S4.E22.m1.5.5.1.1.1.1" xref="S4.E22.m1.5.5.1.1.1.1.cmml"><mrow id="S4.E22.m1.5.5.1.1.1.1.2" xref="S4.E22.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.E22.m1.5.5.1.1.1.1.2.1" rspace="0.167em" xref="S4.E22.m1.5.5.1.1.1.1.2.1.cmml">∀</mo><mi id="S4.E22.m1.5.5.1.1.1.1.2.2" xref="S4.E22.m1.5.5.1.1.1.1.2.2.cmml">s</mi></mrow><mo id="S4.E22.m1.5.5.1.1.1.1.1" xref="S4.E22.m1.5.5.1.1.1.1.1.cmml">∈</mo><mi id="S4.E22.m1.5.5.1.1.1.1.3" xref="S4.E22.m1.5.5.1.1.1.1.3.cmml">S</mi></mrow><mo id="S4.E22.m1.5.5.1.1.2.3" xref="S4.E22.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S4.E22.m1.5.5.1.1.2.2" xref="S4.E22.m1.5.5.1.1.2.2.cmml"><msubsup id="S4.E22.m1.5.5.1.1.2.2.2" xref="S4.E22.m1.5.5.1.1.2.2.2.cmml"><mover accent="true" id="S4.E22.m1.5.5.1.1.2.2.2.2.2" xref="S4.E22.m1.5.5.1.1.2.2.2.2.2.cmml"><mi id="S4.E22.m1.5.5.1.1.2.2.2.2.2.2" xref="S4.E22.m1.5.5.1.1.2.2.2.2.2.2.cmml">𝐲</mi><mo id="S4.E22.m1.5.5.1.1.2.2.2.2.2.1" xref="S4.E22.m1.5.5.1.1.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.E22.m1.5.5.1.1.2.2.2.2.3" xref="S4.E22.m1.5.5.1.1.2.2.2.2.3.cmml">s</mi><mrow id="S4.E22.m1.1.1.1.3" xref="S4.E22.m1.5.5.1.1.2.2.2.cmml"><mo id="S4.E22.m1.1.1.1.3.1" stretchy="false" xref="S4.E22.m1.5.5.1.1.2.2.2.cmml">(</mo><mi id="S4.E22.m1.1.1.1.1" xref="S4.E22.m1.1.1.1.1.cmml">i</mi><mo id="S4.E22.m1.1.1.1.3.2" stretchy="false" xref="S4.E22.m1.5.5.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E22.m1.5.5.1.1.2.2.1" xref="S4.E22.m1.5.5.1.1.2.2.1.cmml">=</mo><mrow id="S4.E22.m1.5.5.1.1.2.2.3" xref="S4.E22.m1.5.5.1.1.2.2.3.cmml"><msubsup id="S4.E22.m1.5.5.1.1.2.2.3.2" xref="S4.E22.m1.5.5.1.1.2.2.3.2.cmml"><mi id="S4.E22.m1.5.5.1.1.2.2.3.2.2.2" xref="S4.E22.m1.5.5.1.1.2.2.3.2.2.2.cmml">𝐞</mi><mi id="S4.E22.m1.5.5.1.1.2.2.3.2.2.3" xref="S4.E22.m1.5.5.1.1.2.2.3.2.2.3.cmml">s</mi><mrow id="S4.E22.m1.4.4.3.3" xref="S4.E22.m1.4.4.3.4.cmml"><mo id="S4.E22.m1.3.3.2.2.1" mathsize="142%" xref="S4.E22.m1.3.3.2.2.1.cmml">′</mo><mo id="S4.E22.m1.4.4.3.3.3" lspace="0em" xref="S4.E22.m1.4.4.3.4.cmml">⁣</mo><mrow id="S4.E22.m1.4.4.3.3.2.2" xref="S4.E22.m1.4.4.3.4.cmml"><mo id="S4.E22.m1.4.4.3.3.2.2.1" stretchy="false" xref="S4.E22.m1.4.4.3.4.cmml">(</mo><mi id="S4.E22.m1.2.2.1.1" xref="S4.E22.m1.2.2.1.1.cmml">i</mi><mo id="S4.E22.m1.4.4.3.3.2.2.2" stretchy="false" xref="S4.E22.m1.4.4.3.4.cmml">)</mo></mrow></mrow></msubsup><mo id="S4.E22.m1.5.5.1.1.2.2.3.1" xref="S4.E22.m1.5.5.1.1.2.2.3.1.cmml">⁢</mo><msub id="S4.E22.m1.5.5.1.1.2.2.3.3" xref="S4.E22.m1.5.5.1.1.2.2.3.3.cmml"><mi id="S4.E22.m1.5.5.1.1.2.2.3.3.2" xref="S4.E22.m1.5.5.1.1.2.2.3.3.2.cmml">𝐲</mi><mi id="S4.E22.m1.5.5.1.1.2.2.3.3.3" xref="S4.E22.m1.5.5.1.1.2.2.3.3.3.cmml">s</mi></msub></mrow></mrow></mrow><mo id="S4.E22.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E22.m1.5b"><apply id="S4.E22.m1.5.5.1.1.3.cmml" xref="S4.E22.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E22.m1.5.5.1.1.3a.cmml" xref="S4.E22.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E22.m1.5.5.1.1.1.1.cmml" xref="S4.E22.m1.5.5.1.1.1.1"><in id="S4.E22.m1.5.5.1.1.1.1.1.cmml" xref="S4.E22.m1.5.5.1.1.1.1.1"></in><apply id="S4.E22.m1.5.5.1.1.1.1.2.cmml" xref="S4.E22.m1.5.5.1.1.1.1.2"><csymbol cd="latexml" id="S4.E22.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E22.m1.5.5.1.1.1.1.2.1">for-all</csymbol><ci id="S4.E22.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.E22.m1.5.5.1.1.1.1.2.2">𝑠</ci></apply><ci id="S4.E22.m1.5.5.1.1.1.1.3.cmml" xref="S4.E22.m1.5.5.1.1.1.1.3">𝑆</ci></apply><apply id="S4.E22.m1.5.5.1.1.2.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2"><eq id="S4.E22.m1.5.5.1.1.2.2.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.1"></eq><apply id="S4.E22.m1.5.5.1.1.2.2.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E22.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2">superscript</csymbol><apply id="S4.E22.m1.5.5.1.1.2.2.2.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E22.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2">subscript</csymbol><apply id="S4.E22.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2.2.2"><ci id="S4.E22.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2.2.2.1">~</ci><ci id="S4.E22.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2.2.2.2">𝐲</ci></apply><ci id="S4.E22.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S4.E22.m1.5.5.1.1.2.2.2.2.3">𝑠</ci></apply><ci id="S4.E22.m1.1.1.1.1.cmml" xref="S4.E22.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.E22.m1.5.5.1.1.2.2.3.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3"><times id="S4.E22.m1.5.5.1.1.2.2.3.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.1"></times><apply id="S4.E22.m1.5.5.1.1.2.2.3.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.E22.m1.5.5.1.1.2.2.3.2.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.2">superscript</csymbol><apply id="S4.E22.m1.5.5.1.1.2.2.3.2.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.E22.m1.5.5.1.1.2.2.3.2.2.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.2">subscript</csymbol><ci id="S4.E22.m1.5.5.1.1.2.2.3.2.2.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.2.2.2">𝐞</ci><ci id="S4.E22.m1.5.5.1.1.2.2.3.2.2.3.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.2.2.3">𝑠</ci></apply><list id="S4.E22.m1.4.4.3.4.cmml" xref="S4.E22.m1.4.4.3.3"><ci id="S4.E22.m1.3.3.2.2.1.cmml" xref="S4.E22.m1.3.3.2.2.1">′</ci><ci id="S4.E22.m1.2.2.1.1.cmml" xref="S4.E22.m1.2.2.1.1">𝑖</ci></list></apply><apply id="S4.E22.m1.5.5.1.1.2.2.3.3.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S4.E22.m1.5.5.1.1.2.2.3.3.1.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.3">subscript</csymbol><ci id="S4.E22.m1.5.5.1.1.2.2.3.3.2.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.3.2">𝐲</ci><ci id="S4.E22.m1.5.5.1.1.2.2.3.3.3.cmml" xref="S4.E22.m1.5.5.1.1.2.2.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E22.m1.5c">\forall s\in S,\tilde{\mathbf{y}}_{s}^{(i)}=\mathbf{e}_{s}^{\prime(i)}\mathbf{%
y}_{s},</annotation><annotation encoding="application/x-llamapun" id="S4.E22.m1.5d">∀ italic_s ∈ italic_S , over~ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = bold_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ ( italic_i ) end_POSTSUPERSCRIPT bold_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p9.10">where <math alttext="\mathbf{e}_{s}^{\prime(i)}" class="ltx_Math" display="inline" id="S4.SS2.p9.8.m1.3"><semantics id="S4.SS2.p9.8.m1.3a"><msubsup id="S4.SS2.p9.8.m1.3.4" xref="S4.SS2.p9.8.m1.3.4.cmml"><mi id="S4.SS2.p9.8.m1.3.4.2.2" xref="S4.SS2.p9.8.m1.3.4.2.2.cmml">𝐞</mi><mi id="S4.SS2.p9.8.m1.3.4.2.3" xref="S4.SS2.p9.8.m1.3.4.2.3.cmml">s</mi><mrow id="S4.SS2.p9.8.m1.3.3.3.3" xref="S4.SS2.p9.8.m1.3.3.3.4.cmml"><mo id="S4.SS2.p9.8.m1.2.2.2.2.1" mathsize="142%" xref="S4.SS2.p9.8.m1.2.2.2.2.1.cmml">′</mo><mo id="S4.SS2.p9.8.m1.3.3.3.3.3" lspace="0em" xref="S4.SS2.p9.8.m1.3.3.3.4.cmml">⁣</mo><mrow id="S4.SS2.p9.8.m1.3.3.3.3.2.2" xref="S4.SS2.p9.8.m1.3.3.3.4.cmml"><mo id="S4.SS2.p9.8.m1.3.3.3.3.2.2.1" stretchy="false" xref="S4.SS2.p9.8.m1.3.3.3.4.cmml">(</mo><mi id="S4.SS2.p9.8.m1.1.1.1.1" xref="S4.SS2.p9.8.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p9.8.m1.3.3.3.3.2.2.2" stretchy="false" xref="S4.SS2.p9.8.m1.3.3.3.4.cmml">)</mo></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.8.m1.3b"><apply id="S4.SS2.p9.8.m1.3.4.cmml" xref="S4.SS2.p9.8.m1.3.4"><csymbol cd="ambiguous" id="S4.SS2.p9.8.m1.3.4.1.cmml" xref="S4.SS2.p9.8.m1.3.4">superscript</csymbol><apply id="S4.SS2.p9.8.m1.3.4.2.cmml" xref="S4.SS2.p9.8.m1.3.4"><csymbol cd="ambiguous" id="S4.SS2.p9.8.m1.3.4.2.1.cmml" xref="S4.SS2.p9.8.m1.3.4">subscript</csymbol><ci id="S4.SS2.p9.8.m1.3.4.2.2.cmml" xref="S4.SS2.p9.8.m1.3.4.2.2">𝐞</ci><ci id="S4.SS2.p9.8.m1.3.4.2.3.cmml" xref="S4.SS2.p9.8.m1.3.4.2.3">𝑠</ci></apply><list id="S4.SS2.p9.8.m1.3.3.3.4.cmml" xref="S4.SS2.p9.8.m1.3.3.3.3"><ci id="S4.SS2.p9.8.m1.2.2.2.2.1.cmml" xref="S4.SS2.p9.8.m1.2.2.2.2.1">′</ci><ci id="S4.SS2.p9.8.m1.1.1.1.1.cmml" xref="S4.SS2.p9.8.m1.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.8.m1.3c">\mathbf{e}_{s}^{\prime(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.8.m1.3d">bold_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the element of <math alttext="\mathbf{e}_{s}^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.p9.9.m2.1"><semantics id="S4.SS2.p9.9.m2.1a"><msubsup id="S4.SS2.p9.9.m2.1.1" xref="S4.SS2.p9.9.m2.1.1.cmml"><mi id="S4.SS2.p9.9.m2.1.1.2.2" xref="S4.SS2.p9.9.m2.1.1.2.2.cmml">𝐞</mi><mi id="S4.SS2.p9.9.m2.1.1.2.3" xref="S4.SS2.p9.9.m2.1.1.2.3.cmml">s</mi><mo id="S4.SS2.p9.9.m2.1.1.3" xref="S4.SS2.p9.9.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.9.m2.1b"><apply id="S4.SS2.p9.9.m2.1.1.cmml" xref="S4.SS2.p9.9.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.9.m2.1.1.1.cmml" xref="S4.SS2.p9.9.m2.1.1">superscript</csymbol><apply id="S4.SS2.p9.9.m2.1.1.2.cmml" xref="S4.SS2.p9.9.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.9.m2.1.1.2.1.cmml" xref="S4.SS2.p9.9.m2.1.1">subscript</csymbol><ci id="S4.SS2.p9.9.m2.1.1.2.2.cmml" xref="S4.SS2.p9.9.m2.1.1.2.2">𝐞</ci><ci id="S4.SS2.p9.9.m2.1.1.2.3.cmml" xref="S4.SS2.p9.9.m2.1.1.2.3">𝑠</ci></apply><ci id="S4.SS2.p9.9.m2.1.1.3.cmml" xref="S4.SS2.p9.9.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.9.m2.1c">\mathbf{e}_{s}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.9.m2.1d">bold_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> corresponding to the substructure <math alttext="s" class="ltx_Math" display="inline" id="S4.SS2.p9.10.m3.1"><semantics id="S4.SS2.p9.10.m3.1a"><mi id="S4.SS2.p9.10.m3.1.1" xref="S4.SS2.p9.10.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.10.m3.1b"><ci id="S4.SS2.p9.10.m3.1.1.cmml" xref="S4.SS2.p9.10.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.10.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.10.m3.1d">italic_s</annotation></semantics></math>. We obtain the perception representation of the substructure at the current time sequence through the attention matrix.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{y}_{m}^{(i)}=\sum_{s\in S}\mathbf{A}_{mol-sub}\tilde{\mathbf{y}}_{s}^{%
(i)}." class="ltx_Math" display="block" id="S4.E23.m1.3"><semantics id="S4.E23.m1.3a"><mrow id="S4.E23.m1.3.3.1" xref="S4.E23.m1.3.3.1.1.cmml"><mrow id="S4.E23.m1.3.3.1.1" xref="S4.E23.m1.3.3.1.1.cmml"><msubsup id="S4.E23.m1.3.3.1.1.2" xref="S4.E23.m1.3.3.1.1.2.cmml"><mi id="S4.E23.m1.3.3.1.1.2.2.2" xref="S4.E23.m1.3.3.1.1.2.2.2.cmml">𝐲</mi><mi id="S4.E23.m1.3.3.1.1.2.2.3" xref="S4.E23.m1.3.3.1.1.2.2.3.cmml">m</mi><mrow id="S4.E23.m1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.2.cmml"><mo id="S4.E23.m1.1.1.1.3.1" stretchy="false" xref="S4.E23.m1.3.3.1.1.2.cmml">(</mo><mi id="S4.E23.m1.1.1.1.1" xref="S4.E23.m1.1.1.1.1.cmml">i</mi><mo id="S4.E23.m1.1.1.1.3.2" stretchy="false" xref="S4.E23.m1.3.3.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E23.m1.3.3.1.1.1" rspace="0.111em" xref="S4.E23.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E23.m1.3.3.1.1.3" xref="S4.E23.m1.3.3.1.1.3.cmml"><munder id="S4.E23.m1.3.3.1.1.3.1" xref="S4.E23.m1.3.3.1.1.3.1.cmml"><mo id="S4.E23.m1.3.3.1.1.3.1.2" movablelimits="false" xref="S4.E23.m1.3.3.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E23.m1.3.3.1.1.3.1.3" xref="S4.E23.m1.3.3.1.1.3.1.3.cmml"><mi id="S4.E23.m1.3.3.1.1.3.1.3.2" xref="S4.E23.m1.3.3.1.1.3.1.3.2.cmml">s</mi><mo id="S4.E23.m1.3.3.1.1.3.1.3.1" xref="S4.E23.m1.3.3.1.1.3.1.3.1.cmml">∈</mo><mi id="S4.E23.m1.3.3.1.1.3.1.3.3" xref="S4.E23.m1.3.3.1.1.3.1.3.3.cmml">S</mi></mrow></munder><mrow id="S4.E23.m1.3.3.1.1.3.2" xref="S4.E23.m1.3.3.1.1.3.2.cmml"><msub id="S4.E23.m1.3.3.1.1.3.2.2" xref="S4.E23.m1.3.3.1.1.3.2.2.cmml"><mi id="S4.E23.m1.3.3.1.1.3.2.2.2" xref="S4.E23.m1.3.3.1.1.3.2.2.2.cmml">𝐀</mi><mrow id="S4.E23.m1.3.3.1.1.3.2.2.3" xref="S4.E23.m1.3.3.1.1.3.2.2.3.cmml"><mrow id="S4.E23.m1.3.3.1.1.3.2.2.3.2" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.cmml"><mi id="S4.E23.m1.3.3.1.1.3.2.2.3.2.2" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.2.cmml">m</mi><mo id="S4.E23.m1.3.3.1.1.3.2.2.3.2.1" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.1.cmml">⁢</mo><mi id="S4.E23.m1.3.3.1.1.3.2.2.3.2.3" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.3.cmml">o</mi><mo id="S4.E23.m1.3.3.1.1.3.2.2.3.2.1a" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.1.cmml">⁢</mo><mi id="S4.E23.m1.3.3.1.1.3.2.2.3.2.4" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.4.cmml">l</mi></mrow><mo id="S4.E23.m1.3.3.1.1.3.2.2.3.1" xref="S4.E23.m1.3.3.1.1.3.2.2.3.1.cmml">−</mo><mrow id="S4.E23.m1.3.3.1.1.3.2.2.3.3" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.cmml"><mi id="S4.E23.m1.3.3.1.1.3.2.2.3.3.2" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.2.cmml">s</mi><mo id="S4.E23.m1.3.3.1.1.3.2.2.3.3.1" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E23.m1.3.3.1.1.3.2.2.3.3.3" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.3.cmml">u</mi><mo id="S4.E23.m1.3.3.1.1.3.2.2.3.3.1a" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E23.m1.3.3.1.1.3.2.2.3.3.4" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.4.cmml">b</mi></mrow></mrow></msub><mo id="S4.E23.m1.3.3.1.1.3.2.1" xref="S4.E23.m1.3.3.1.1.3.2.1.cmml">⁢</mo><msubsup id="S4.E23.m1.3.3.1.1.3.2.3" xref="S4.E23.m1.3.3.1.1.3.2.3.cmml"><mover accent="true" id="S4.E23.m1.3.3.1.1.3.2.3.2.2" xref="S4.E23.m1.3.3.1.1.3.2.3.2.2.cmml"><mi id="S4.E23.m1.3.3.1.1.3.2.3.2.2.2" xref="S4.E23.m1.3.3.1.1.3.2.3.2.2.2.cmml">𝐲</mi><mo id="S4.E23.m1.3.3.1.1.3.2.3.2.2.1" xref="S4.E23.m1.3.3.1.1.3.2.3.2.2.1.cmml">~</mo></mover><mi id="S4.E23.m1.3.3.1.1.3.2.3.2.3" xref="S4.E23.m1.3.3.1.1.3.2.3.2.3.cmml">s</mi><mrow id="S4.E23.m1.2.2.1.3" xref="S4.E23.m1.3.3.1.1.3.2.3.cmml"><mo id="S4.E23.m1.2.2.1.3.1" stretchy="false" xref="S4.E23.m1.3.3.1.1.3.2.3.cmml">(</mo><mi id="S4.E23.m1.2.2.1.1" xref="S4.E23.m1.2.2.1.1.cmml">i</mi><mo id="S4.E23.m1.2.2.1.3.2" stretchy="false" xref="S4.E23.m1.3.3.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S4.E23.m1.3.3.1.2" lspace="0em" xref="S4.E23.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E23.m1.3b"><apply id="S4.E23.m1.3.3.1.1.cmml" xref="S4.E23.m1.3.3.1"><eq id="S4.E23.m1.3.3.1.1.1.cmml" xref="S4.E23.m1.3.3.1.1.1"></eq><apply id="S4.E23.m1.3.3.1.1.2.cmml" xref="S4.E23.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.1.1.2.1.cmml" xref="S4.E23.m1.3.3.1.1.2">superscript</csymbol><apply id="S4.E23.m1.3.3.1.1.2.2.cmml" xref="S4.E23.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.1.1.2.2.1.cmml" xref="S4.E23.m1.3.3.1.1.2">subscript</csymbol><ci id="S4.E23.m1.3.3.1.1.2.2.2.cmml" xref="S4.E23.m1.3.3.1.1.2.2.2">𝐲</ci><ci id="S4.E23.m1.3.3.1.1.2.2.3.cmml" xref="S4.E23.m1.3.3.1.1.2.2.3">𝑚</ci></apply><ci id="S4.E23.m1.1.1.1.1.cmml" xref="S4.E23.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.E23.m1.3.3.1.1.3.cmml" xref="S4.E23.m1.3.3.1.1.3"><apply id="S4.E23.m1.3.3.1.1.3.1.cmml" xref="S4.E23.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.1.1.3.1.1.cmml" xref="S4.E23.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S4.E23.m1.3.3.1.1.3.1.2.cmml" xref="S4.E23.m1.3.3.1.1.3.1.2"></sum><apply id="S4.E23.m1.3.3.1.1.3.1.3.cmml" xref="S4.E23.m1.3.3.1.1.3.1.3"><in id="S4.E23.m1.3.3.1.1.3.1.3.1.cmml" xref="S4.E23.m1.3.3.1.1.3.1.3.1"></in><ci id="S4.E23.m1.3.3.1.1.3.1.3.2.cmml" xref="S4.E23.m1.3.3.1.1.3.1.3.2">𝑠</ci><ci id="S4.E23.m1.3.3.1.1.3.1.3.3.cmml" xref="S4.E23.m1.3.3.1.1.3.1.3.3">𝑆</ci></apply></apply><apply id="S4.E23.m1.3.3.1.1.3.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2"><times id="S4.E23.m1.3.3.1.1.3.2.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.1"></times><apply id="S4.E23.m1.3.3.1.1.3.2.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S4.E23.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.2">𝐀</ci><apply id="S4.E23.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3"><minus id="S4.E23.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.1"></minus><apply id="S4.E23.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2"><times id="S4.E23.m1.3.3.1.1.3.2.2.3.2.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.1"></times><ci id="S4.E23.m1.3.3.1.1.3.2.2.3.2.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.2">𝑚</ci><ci id="S4.E23.m1.3.3.1.1.3.2.2.3.2.3.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.3">𝑜</ci><ci id="S4.E23.m1.3.3.1.1.3.2.2.3.2.4.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.2.4">𝑙</ci></apply><apply id="S4.E23.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3"><times id="S4.E23.m1.3.3.1.1.3.2.2.3.3.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.1"></times><ci id="S4.E23.m1.3.3.1.1.3.2.2.3.3.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.2">𝑠</ci><ci id="S4.E23.m1.3.3.1.1.3.2.2.3.3.3.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.3">𝑢</ci><ci id="S4.E23.m1.3.3.1.1.3.2.2.3.3.4.cmml" xref="S4.E23.m1.3.3.1.1.3.2.2.3.3.4">𝑏</ci></apply></apply></apply><apply id="S4.E23.m1.3.3.1.1.3.2.3.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.1.1.3.2.3.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S4.E23.m1.3.3.1.1.3.2.3.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3">subscript</csymbol><apply id="S4.E23.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3.2.2"><ci id="S4.E23.m1.3.3.1.1.3.2.3.2.2.1.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3.2.2.1">~</ci><ci id="S4.E23.m1.3.3.1.1.3.2.3.2.2.2.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3.2.2.2">𝐲</ci></apply><ci id="S4.E23.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S4.E23.m1.3.3.1.1.3.2.3.2.3">𝑠</ci></apply><ci id="S4.E23.m1.2.2.1.1.cmml" xref="S4.E23.m1.2.2.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E23.m1.3c">\mathbf{y}_{m}^{(i)}=\sum_{s\in S}\mathbf{A}_{mol-sub}\tilde{\mathbf{y}}_{s}^{%
(i)}.</annotation><annotation encoding="application/x-llamapun" id="S4.E23.m1.3d">bold_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_s ∈ italic_S end_POSTSUBSCRIPT bold_A start_POSTSUBSCRIPT italic_m italic_o italic_l - italic_s italic_u italic_b end_POSTSUBSCRIPT over~ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p10">
<p class="ltx_p" id="S4.SS2.p10.1">Finally, we obtain all the aggregated substructure embedding representations <math alttext="\mathbf{Y}_{m}^{(i)}" class="ltx_Math" display="inline" id="S4.SS2.p10.1.m1.1"><semantics id="S4.SS2.p10.1.m1.1a"><msubsup id="S4.SS2.p10.1.m1.1.2" xref="S4.SS2.p10.1.m1.1.2.cmml"><mi id="S4.SS2.p10.1.m1.1.2.2.2" xref="S4.SS2.p10.1.m1.1.2.2.2.cmml">𝐘</mi><mi id="S4.SS2.p10.1.m1.1.2.2.3" xref="S4.SS2.p10.1.m1.1.2.2.3.cmml">m</mi><mrow id="S4.SS2.p10.1.m1.1.1.1.3" xref="S4.SS2.p10.1.m1.1.2.cmml"><mo id="S4.SS2.p10.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS2.p10.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p10.1.m1.1.1.1.1" xref="S4.SS2.p10.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p10.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS2.p10.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.1.m1.1b"><apply id="S4.SS2.p10.1.m1.1.2.cmml" xref="S4.SS2.p10.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p10.1.m1.1.2.1.cmml" xref="S4.SS2.p10.1.m1.1.2">superscript</csymbol><apply id="S4.SS2.p10.1.m1.1.2.2.cmml" xref="S4.SS2.p10.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p10.1.m1.1.2.2.1.cmml" xref="S4.SS2.p10.1.m1.1.2">subscript</csymbol><ci id="S4.SS2.p10.1.m1.1.2.2.2.cmml" xref="S4.SS2.p10.1.m1.1.2.2.2">𝐘</ci><ci id="S4.SS2.p10.1.m1.1.2.2.3.cmml" xref="S4.SS2.p10.1.m1.1.2.2.3">𝑚</ci></apply><ci id="S4.SS2.p10.1.m1.1.1.1.1.cmml" xref="S4.SS2.p10.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.1.m1.1c">\mathbf{Y}_{m}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p10.1.m1.1d">bold_Y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p11">
<p class="ltx_p" id="S4.SS2.p11.1">To relate the aggregated substructure embeddings to the patient’s latest health status, we use the most recent patient visit as the basis for bias correction. Through an MLP layer, we obtain the weights of the latest patient representation for the elements of the substructure set, thereby calibrating the substructure embeddings.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx6">
<tbody id="S4.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{e}_{d}(t)=d(t)\mathbf{E}_{d},\mathbf{e}_{p}(t)=p(t)%
\mathbf{E}_{p}," class="ltx_Math" display="block" id="S4.E24.m1.5"><semantics id="S4.E24.m1.5a"><mrow id="S4.E24.m1.5.5.1"><mrow id="S4.E24.m1.5.5.1.1.2" xref="S4.E24.m1.5.5.1.1.3.cmml"><mrow id="S4.E24.m1.5.5.1.1.1.1" xref="S4.E24.m1.5.5.1.1.1.1.cmml"><mrow id="S4.E24.m1.5.5.1.1.1.1.2" xref="S4.E24.m1.5.5.1.1.1.1.2.cmml"><msub id="S4.E24.m1.5.5.1.1.1.1.2.2" xref="S4.E24.m1.5.5.1.1.1.1.2.2.cmml"><mi id="S4.E24.m1.5.5.1.1.1.1.2.2.2" xref="S4.E24.m1.5.5.1.1.1.1.2.2.2.cmml">𝐞</mi><mi id="S4.E24.m1.5.5.1.1.1.1.2.2.3" xref="S4.E24.m1.5.5.1.1.1.1.2.2.3.cmml">d</mi></msub><mo id="S4.E24.m1.5.5.1.1.1.1.2.1" xref="S4.E24.m1.5.5.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E24.m1.5.5.1.1.1.1.2.3.2" xref="S4.E24.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.E24.m1.5.5.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.E24.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S4.E24.m1.1.1" xref="S4.E24.m1.1.1.cmml">t</mi><mo id="S4.E24.m1.5.5.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.E24.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E24.m1.5.5.1.1.1.1.1" xref="S4.E24.m1.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S4.E24.m1.5.5.1.1.1.1.3" xref="S4.E24.m1.5.5.1.1.1.1.3.cmml"><mi id="S4.E24.m1.5.5.1.1.1.1.3.2" xref="S4.E24.m1.5.5.1.1.1.1.3.2.cmml">d</mi><mo id="S4.E24.m1.5.5.1.1.1.1.3.1" xref="S4.E24.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E24.m1.5.5.1.1.1.1.3.3.2" xref="S4.E24.m1.5.5.1.1.1.1.3.cmml"><mo id="S4.E24.m1.5.5.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.E24.m1.5.5.1.1.1.1.3.cmml">(</mo><mi id="S4.E24.m1.2.2" xref="S4.E24.m1.2.2.cmml">t</mi><mo id="S4.E24.m1.5.5.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.E24.m1.5.5.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.E24.m1.5.5.1.1.1.1.3.1a" xref="S4.E24.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E24.m1.5.5.1.1.1.1.3.4" xref="S4.E24.m1.5.5.1.1.1.1.3.4.cmml"><mi id="S4.E24.m1.5.5.1.1.1.1.3.4.2" xref="S4.E24.m1.5.5.1.1.1.1.3.4.2.cmml">𝐄</mi><mi id="S4.E24.m1.5.5.1.1.1.1.3.4.3" xref="S4.E24.m1.5.5.1.1.1.1.3.4.3.cmml">d</mi></msub></mrow></mrow><mo id="S4.E24.m1.5.5.1.1.2.3" xref="S4.E24.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S4.E24.m1.5.5.1.1.2.2" xref="S4.E24.m1.5.5.1.1.2.2.cmml"><mrow id="S4.E24.m1.5.5.1.1.2.2.2" xref="S4.E24.m1.5.5.1.1.2.2.2.cmml"><msub id="S4.E24.m1.5.5.1.1.2.2.2.2" xref="S4.E24.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S4.E24.m1.5.5.1.1.2.2.2.2.2" xref="S4.E24.m1.5.5.1.1.2.2.2.2.2.cmml">𝐞</mi><mi id="S4.E24.m1.5.5.1.1.2.2.2.2.3" xref="S4.E24.m1.5.5.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E24.m1.5.5.1.1.2.2.2.1" xref="S4.E24.m1.5.5.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S4.E24.m1.5.5.1.1.2.2.2.3.2" xref="S4.E24.m1.5.5.1.1.2.2.2.cmml"><mo id="S4.E24.m1.5.5.1.1.2.2.2.3.2.1" stretchy="false" xref="S4.E24.m1.5.5.1.1.2.2.2.cmml">(</mo><mi id="S4.E24.m1.3.3" xref="S4.E24.m1.3.3.cmml">t</mi><mo id="S4.E24.m1.5.5.1.1.2.2.2.3.2.2" stretchy="false" xref="S4.E24.m1.5.5.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E24.m1.5.5.1.1.2.2.1" xref="S4.E24.m1.5.5.1.1.2.2.1.cmml">=</mo><mrow id="S4.E24.m1.5.5.1.1.2.2.3" xref="S4.E24.m1.5.5.1.1.2.2.3.cmml"><mi id="S4.E24.m1.5.5.1.1.2.2.3.2" xref="S4.E24.m1.5.5.1.1.2.2.3.2.cmml">p</mi><mo id="S4.E24.m1.5.5.1.1.2.2.3.1" xref="S4.E24.m1.5.5.1.1.2.2.3.1.cmml">⁢</mo><mrow id="S4.E24.m1.5.5.1.1.2.2.3.3.2" xref="S4.E24.m1.5.5.1.1.2.2.3.cmml"><mo id="S4.E24.m1.5.5.1.1.2.2.3.3.2.1" stretchy="false" xref="S4.E24.m1.5.5.1.1.2.2.3.cmml">(</mo><mi id="S4.E24.m1.4.4" xref="S4.E24.m1.4.4.cmml">t</mi><mo id="S4.E24.m1.5.5.1.1.2.2.3.3.2.2" stretchy="false" xref="S4.E24.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow><mo id="S4.E24.m1.5.5.1.1.2.2.3.1a" xref="S4.E24.m1.5.5.1.1.2.2.3.1.cmml">⁢</mo><msub id="S4.E24.m1.5.5.1.1.2.2.3.4" xref="S4.E24.m1.5.5.1.1.2.2.3.4.cmml"><mi id="S4.E24.m1.5.5.1.1.2.2.3.4.2" xref="S4.E24.m1.5.5.1.1.2.2.3.4.2.cmml">𝐄</mi><mi id="S4.E24.m1.5.5.1.1.2.2.3.4.3" xref="S4.E24.m1.5.5.1.1.2.2.3.4.3.cmml">p</mi></msub></mrow></mrow></mrow><mo id="S4.E24.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E24.m1.5b"><apply id="S4.E24.m1.5.5.1.1.3.cmml" xref="S4.E24.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E24.m1.5.5.1.1.3a.cmml" xref="S4.E24.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E24.m1.5.5.1.1.1.1.cmml" xref="S4.E24.m1.5.5.1.1.1.1"><eq id="S4.E24.m1.5.5.1.1.1.1.1.cmml" xref="S4.E24.m1.5.5.1.1.1.1.1"></eq><apply id="S4.E24.m1.5.5.1.1.1.1.2.cmml" xref="S4.E24.m1.5.5.1.1.1.1.2"><times id="S4.E24.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E24.m1.5.5.1.1.1.1.2.1"></times><apply id="S4.E24.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.E24.m1.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E24.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S4.E24.m1.5.5.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E24.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S4.E24.m1.5.5.1.1.1.1.2.2.2">𝐞</ci><ci id="S4.E24.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S4.E24.m1.5.5.1.1.1.1.2.2.3">𝑑</ci></apply><ci id="S4.E24.m1.1.1.cmml" xref="S4.E24.m1.1.1">𝑡</ci></apply><apply id="S4.E24.m1.5.5.1.1.1.1.3.cmml" xref="S4.E24.m1.5.5.1.1.1.1.3"><times id="S4.E24.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E24.m1.5.5.1.1.1.1.3.1"></times><ci id="S4.E24.m1.5.5.1.1.1.1.3.2.cmml" xref="S4.E24.m1.5.5.1.1.1.1.3.2">𝑑</ci><ci id="S4.E24.m1.2.2.cmml" xref="S4.E24.m1.2.2">𝑡</ci><apply id="S4.E24.m1.5.5.1.1.1.1.3.4.cmml" xref="S4.E24.m1.5.5.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E24.m1.5.5.1.1.1.1.3.4.1.cmml" xref="S4.E24.m1.5.5.1.1.1.1.3.4">subscript</csymbol><ci id="S4.E24.m1.5.5.1.1.1.1.3.4.2.cmml" xref="S4.E24.m1.5.5.1.1.1.1.3.4.2">𝐄</ci><ci id="S4.E24.m1.5.5.1.1.1.1.3.4.3.cmml" xref="S4.E24.m1.5.5.1.1.1.1.3.4.3">𝑑</ci></apply></apply></apply><apply id="S4.E24.m1.5.5.1.1.2.2.cmml" xref="S4.E24.m1.5.5.1.1.2.2"><eq id="S4.E24.m1.5.5.1.1.2.2.1.cmml" xref="S4.E24.m1.5.5.1.1.2.2.1"></eq><apply id="S4.E24.m1.5.5.1.1.2.2.2.cmml" xref="S4.E24.m1.5.5.1.1.2.2.2"><times id="S4.E24.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E24.m1.5.5.1.1.2.2.2.1"></times><apply id="S4.E24.m1.5.5.1.1.2.2.2.2.cmml" xref="S4.E24.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E24.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S4.E24.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E24.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S4.E24.m1.5.5.1.1.2.2.2.2.2">𝐞</ci><ci id="S4.E24.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S4.E24.m1.5.5.1.1.2.2.2.2.3">𝑝</ci></apply><ci id="S4.E24.m1.3.3.cmml" xref="S4.E24.m1.3.3">𝑡</ci></apply><apply id="S4.E24.m1.5.5.1.1.2.2.3.cmml" xref="S4.E24.m1.5.5.1.1.2.2.3"><times id="S4.E24.m1.5.5.1.1.2.2.3.1.cmml" xref="S4.E24.m1.5.5.1.1.2.2.3.1"></times><ci id="S4.E24.m1.5.5.1.1.2.2.3.2.cmml" xref="S4.E24.m1.5.5.1.1.2.2.3.2">𝑝</ci><ci id="S4.E24.m1.4.4.cmml" xref="S4.E24.m1.4.4">𝑡</ci><apply id="S4.E24.m1.5.5.1.1.2.2.3.4.cmml" xref="S4.E24.m1.5.5.1.1.2.2.3.4"><csymbol cd="ambiguous" id="S4.E24.m1.5.5.1.1.2.2.3.4.1.cmml" xref="S4.E24.m1.5.5.1.1.2.2.3.4">subscript</csymbol><ci id="S4.E24.m1.5.5.1.1.2.2.3.4.2.cmml" xref="S4.E24.m1.5.5.1.1.2.2.3.4.2">𝐄</ci><ci id="S4.E24.m1.5.5.1.1.2.2.3.4.3.cmml" xref="S4.E24.m1.5.5.1.1.2.2.3.4.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E24.m1.5c">\displaystyle\mathbf{e}_{d}(t)=d(t)\mathbf{E}_{d},\mathbf{e}_{p}(t)=p(t)%
\mathbf{E}_{p},</annotation><annotation encoding="application/x-llamapun" id="S4.E24.m1.5d">bold_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_t ) = italic_d ( italic_t ) bold_E start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_t ) = italic_p ( italic_t ) bold_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
<tbody id="S4.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{e}_{v}^{\prime}(t)=\mathrm{CONCAT}(\mathbf{e}_{d}(t),%
\mathbf{e}_{p}(t))," class="ltx_Math" display="block" id="S4.E25.m1.4"><semantics id="S4.E25.m1.4a"><mrow id="S4.E25.m1.4.4.1" xref="S4.E25.m1.4.4.1.1.cmml"><mrow id="S4.E25.m1.4.4.1.1" xref="S4.E25.m1.4.4.1.1.cmml"><mrow id="S4.E25.m1.4.4.1.1.4" xref="S4.E25.m1.4.4.1.1.4.cmml"><msubsup id="S4.E25.m1.4.4.1.1.4.2" xref="S4.E25.m1.4.4.1.1.4.2.cmml"><mi id="S4.E25.m1.4.4.1.1.4.2.2.2" xref="S4.E25.m1.4.4.1.1.4.2.2.2.cmml">𝐞</mi><mi id="S4.E25.m1.4.4.1.1.4.2.2.3" xref="S4.E25.m1.4.4.1.1.4.2.2.3.cmml">v</mi><mo id="S4.E25.m1.4.4.1.1.4.2.3" xref="S4.E25.m1.4.4.1.1.4.2.3.cmml">′</mo></msubsup><mo id="S4.E25.m1.4.4.1.1.4.1" xref="S4.E25.m1.4.4.1.1.4.1.cmml">⁢</mo><mrow id="S4.E25.m1.4.4.1.1.4.3.2" xref="S4.E25.m1.4.4.1.1.4.cmml"><mo id="S4.E25.m1.4.4.1.1.4.3.2.1" stretchy="false" xref="S4.E25.m1.4.4.1.1.4.cmml">(</mo><mi id="S4.E25.m1.1.1" xref="S4.E25.m1.1.1.cmml">t</mi><mo id="S4.E25.m1.4.4.1.1.4.3.2.2" stretchy="false" xref="S4.E25.m1.4.4.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E25.m1.4.4.1.1.3" xref="S4.E25.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E25.m1.4.4.1.1.2" xref="S4.E25.m1.4.4.1.1.2.cmml"><mi id="S4.E25.m1.4.4.1.1.2.4" xref="S4.E25.m1.4.4.1.1.2.4.cmml">CONCAT</mi><mo id="S4.E25.m1.4.4.1.1.2.3" xref="S4.E25.m1.4.4.1.1.2.3.cmml">⁢</mo><mrow id="S4.E25.m1.4.4.1.1.2.2.2" xref="S4.E25.m1.4.4.1.1.2.2.3.cmml"><mo id="S4.E25.m1.4.4.1.1.2.2.2.3" stretchy="false" xref="S4.E25.m1.4.4.1.1.2.2.3.cmml">(</mo><mrow id="S4.E25.m1.4.4.1.1.1.1.1.1" xref="S4.E25.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S4.E25.m1.4.4.1.1.1.1.1.1.2" xref="S4.E25.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S4.E25.m1.4.4.1.1.1.1.1.1.2.2" xref="S4.E25.m1.4.4.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S4.E25.m1.4.4.1.1.1.1.1.1.2.3" xref="S4.E25.m1.4.4.1.1.1.1.1.1.2.3.cmml">d</mi></msub><mo id="S4.E25.m1.4.4.1.1.1.1.1.1.1" xref="S4.E25.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E25.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E25.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S4.E25.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E25.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E25.m1.2.2" xref="S4.E25.m1.2.2.cmml">t</mi><mo id="S4.E25.m1.4.4.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E25.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E25.m1.4.4.1.1.2.2.2.4" xref="S4.E25.m1.4.4.1.1.2.2.3.cmml">,</mo><mrow id="S4.E25.m1.4.4.1.1.2.2.2.2" xref="S4.E25.m1.4.4.1.1.2.2.2.2.cmml"><msub id="S4.E25.m1.4.4.1.1.2.2.2.2.2" xref="S4.E25.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S4.E25.m1.4.4.1.1.2.2.2.2.2.2" xref="S4.E25.m1.4.4.1.1.2.2.2.2.2.2.cmml">𝐞</mi><mi id="S4.E25.m1.4.4.1.1.2.2.2.2.2.3" xref="S4.E25.m1.4.4.1.1.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E25.m1.4.4.1.1.2.2.2.2.1" xref="S4.E25.m1.4.4.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.E25.m1.4.4.1.1.2.2.2.2.3.2" xref="S4.E25.m1.4.4.1.1.2.2.2.2.cmml"><mo id="S4.E25.m1.4.4.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S4.E25.m1.4.4.1.1.2.2.2.2.cmml">(</mo><mi id="S4.E25.m1.3.3" xref="S4.E25.m1.3.3.cmml">t</mi><mo id="S4.E25.m1.4.4.1.1.2.2.2.2.3.2.2" stretchy="false" xref="S4.E25.m1.4.4.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E25.m1.4.4.1.1.2.2.2.5" stretchy="false" xref="S4.E25.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E25.m1.4.4.1.2" xref="S4.E25.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E25.m1.4b"><apply id="S4.E25.m1.4.4.1.1.cmml" xref="S4.E25.m1.4.4.1"><eq id="S4.E25.m1.4.4.1.1.3.cmml" xref="S4.E25.m1.4.4.1.1.3"></eq><apply id="S4.E25.m1.4.4.1.1.4.cmml" xref="S4.E25.m1.4.4.1.1.4"><times id="S4.E25.m1.4.4.1.1.4.1.cmml" xref="S4.E25.m1.4.4.1.1.4.1"></times><apply id="S4.E25.m1.4.4.1.1.4.2.cmml" xref="S4.E25.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S4.E25.m1.4.4.1.1.4.2.1.cmml" xref="S4.E25.m1.4.4.1.1.4.2">superscript</csymbol><apply id="S4.E25.m1.4.4.1.1.4.2.2.cmml" xref="S4.E25.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S4.E25.m1.4.4.1.1.4.2.2.1.cmml" xref="S4.E25.m1.4.4.1.1.4.2">subscript</csymbol><ci id="S4.E25.m1.4.4.1.1.4.2.2.2.cmml" xref="S4.E25.m1.4.4.1.1.4.2.2.2">𝐞</ci><ci id="S4.E25.m1.4.4.1.1.4.2.2.3.cmml" xref="S4.E25.m1.4.4.1.1.4.2.2.3">𝑣</ci></apply><ci id="S4.E25.m1.4.4.1.1.4.2.3.cmml" xref="S4.E25.m1.4.4.1.1.4.2.3">′</ci></apply><ci id="S4.E25.m1.1.1.cmml" xref="S4.E25.m1.1.1">𝑡</ci></apply><apply id="S4.E25.m1.4.4.1.1.2.cmml" xref="S4.E25.m1.4.4.1.1.2"><times id="S4.E25.m1.4.4.1.1.2.3.cmml" xref="S4.E25.m1.4.4.1.1.2.3"></times><ci id="S4.E25.m1.4.4.1.1.2.4.cmml" xref="S4.E25.m1.4.4.1.1.2.4">CONCAT</ci><interval closure="open" id="S4.E25.m1.4.4.1.1.2.2.3.cmml" xref="S4.E25.m1.4.4.1.1.2.2.2"><apply id="S4.E25.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E25.m1.4.4.1.1.1.1.1.1"><times id="S4.E25.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E25.m1.4.4.1.1.1.1.1.1.1"></times><apply id="S4.E25.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.E25.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E25.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.E25.m1.4.4.1.1.1.1.1.1.2.2">𝐞</ci><ci id="S4.E25.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.E25.m1.4.4.1.1.1.1.1.1.2.3">𝑑</ci></apply><ci id="S4.E25.m1.2.2.cmml" xref="S4.E25.m1.2.2">𝑡</ci></apply><apply id="S4.E25.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E25.m1.4.4.1.1.2.2.2.2"><times id="S4.E25.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S4.E25.m1.4.4.1.1.2.2.2.2.1"></times><apply id="S4.E25.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E25.m1.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E25.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S4.E25.m1.4.4.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E25.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S4.E25.m1.4.4.1.1.2.2.2.2.2.2">𝐞</ci><ci id="S4.E25.m1.4.4.1.1.2.2.2.2.2.3.cmml" xref="S4.E25.m1.4.4.1.1.2.2.2.2.2.3">𝑝</ci></apply><ci id="S4.E25.m1.3.3.cmml" xref="S4.E25.m1.3.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E25.m1.4c">\displaystyle\mathbf{e}_{v}^{\prime}(t)=\mathrm{CONCAT}(\mathbf{e}_{d}(t),%
\mathbf{e}_{p}(t)),</annotation><annotation encoding="application/x-llamapun" id="S4.E25.m1.4d">bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t ) = roman_CONCAT ( bold_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_t ) , bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_t ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
<tbody id="S4.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{W}_{m}=\sigma(\mathrm{MLP}(\mathbf{e}_{v}^{\prime}(t)))." class="ltx_Math" display="block" id="S4.E26.m1.2"><semantics id="S4.E26.m1.2a"><mrow id="S4.E26.m1.2.2.1" xref="S4.E26.m1.2.2.1.1.cmml"><mrow id="S4.E26.m1.2.2.1.1" xref="S4.E26.m1.2.2.1.1.cmml"><msub id="S4.E26.m1.2.2.1.1.3" xref="S4.E26.m1.2.2.1.1.3.cmml"><mi id="S4.E26.m1.2.2.1.1.3.2" xref="S4.E26.m1.2.2.1.1.3.2.cmml">𝐖</mi><mi id="S4.E26.m1.2.2.1.1.3.3" xref="S4.E26.m1.2.2.1.1.3.3.cmml">m</mi></msub><mo id="S4.E26.m1.2.2.1.1.2" xref="S4.E26.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E26.m1.2.2.1.1.1" xref="S4.E26.m1.2.2.1.1.1.cmml"><mi id="S4.E26.m1.2.2.1.1.1.3" xref="S4.E26.m1.2.2.1.1.1.3.cmml">σ</mi><mo id="S4.E26.m1.2.2.1.1.1.2" xref="S4.E26.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E26.m1.2.2.1.1.1.1.1" xref="S4.E26.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E26.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E26.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E26.m1.2.2.1.1.1.1.1.1" xref="S4.E26.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E26.m1.2.2.1.1.1.1.1.1.3" xref="S4.E26.m1.2.2.1.1.1.1.1.1.3.cmml">MLP</mi><mo id="S4.E26.m1.2.2.1.1.1.1.1.1.2" xref="S4.E26.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐞</mi><mi id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">v</mi><mo id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E26.m1.1.1" xref="S4.E26.m1.1.1.cmml">t</mi><mo id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E26.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E26.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E26.m1.2.2.1.2" lspace="0em" xref="S4.E26.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E26.m1.2b"><apply id="S4.E26.m1.2.2.1.1.cmml" xref="S4.E26.m1.2.2.1"><eq id="S4.E26.m1.2.2.1.1.2.cmml" xref="S4.E26.m1.2.2.1.1.2"></eq><apply id="S4.E26.m1.2.2.1.1.3.cmml" xref="S4.E26.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E26.m1.2.2.1.1.3.1.cmml" xref="S4.E26.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E26.m1.2.2.1.1.3.2.cmml" xref="S4.E26.m1.2.2.1.1.3.2">𝐖</ci><ci id="S4.E26.m1.2.2.1.1.3.3.cmml" xref="S4.E26.m1.2.2.1.1.3.3">𝑚</ci></apply><apply id="S4.E26.m1.2.2.1.1.1.cmml" xref="S4.E26.m1.2.2.1.1.1"><times id="S4.E26.m1.2.2.1.1.1.2.cmml" xref="S4.E26.m1.2.2.1.1.1.2"></times><ci id="S4.E26.m1.2.2.1.1.1.3.cmml" xref="S4.E26.m1.2.2.1.1.1.3">𝜎</ci><apply id="S4.E26.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1"><times id="S4.E26.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S4.E26.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.3">MLP</ci><apply id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1"><times id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝐞</ci><ci id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3">𝑣</ci></apply><ci id="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E26.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.E26.m1.1.1.cmml" xref="S4.E26.m1.1.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E26.m1.2c">\displaystyle\mathbf{W}_{m}=\sigma(\mathrm{MLP}(\mathbf{e}_{v}^{\prime}(t))).</annotation><annotation encoding="application/x-llamapun" id="S4.E26.m1.2d">bold_W start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = italic_σ ( roman_MLP ( bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t ) ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p12">
<p class="ltx_p" id="S4.SS2.p12.4"><math alttext="\mathbf{e}_{d}(t)" class="ltx_Math" display="inline" id="S4.SS2.p12.1.m1.1"><semantics id="S4.SS2.p12.1.m1.1a"><mrow id="S4.SS2.p12.1.m1.1.2" xref="S4.SS2.p12.1.m1.1.2.cmml"><msub id="S4.SS2.p12.1.m1.1.2.2" xref="S4.SS2.p12.1.m1.1.2.2.cmml"><mi id="S4.SS2.p12.1.m1.1.2.2.2" xref="S4.SS2.p12.1.m1.1.2.2.2.cmml">𝐞</mi><mi id="S4.SS2.p12.1.m1.1.2.2.3" xref="S4.SS2.p12.1.m1.1.2.2.3.cmml">d</mi></msub><mo id="S4.SS2.p12.1.m1.1.2.1" xref="S4.SS2.p12.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p12.1.m1.1.2.3.2" xref="S4.SS2.p12.1.m1.1.2.cmml"><mo id="S4.SS2.p12.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p12.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p12.1.m1.1.1" xref="S4.SS2.p12.1.m1.1.1.cmml">t</mi><mo id="S4.SS2.p12.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.p12.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p12.1.m1.1b"><apply id="S4.SS2.p12.1.m1.1.2.cmml" xref="S4.SS2.p12.1.m1.1.2"><times id="S4.SS2.p12.1.m1.1.2.1.cmml" xref="S4.SS2.p12.1.m1.1.2.1"></times><apply id="S4.SS2.p12.1.m1.1.2.2.cmml" xref="S4.SS2.p12.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p12.1.m1.1.2.2.1.cmml" xref="S4.SS2.p12.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.p12.1.m1.1.2.2.2.cmml" xref="S4.SS2.p12.1.m1.1.2.2.2">𝐞</ci><ci id="S4.SS2.p12.1.m1.1.2.2.3.cmml" xref="S4.SS2.p12.1.m1.1.2.2.3">𝑑</ci></apply><ci id="S4.SS2.p12.1.m1.1.1.cmml" xref="S4.SS2.p12.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p12.1.m1.1c">\mathbf{e}_{d}(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.1.m1.1d">bold_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> and <math alttext="\mathbf{e}_{p}(t)" class="ltx_Math" display="inline" id="S4.SS2.p12.2.m2.1"><semantics id="S4.SS2.p12.2.m2.1a"><mrow id="S4.SS2.p12.2.m2.1.2" xref="S4.SS2.p12.2.m2.1.2.cmml"><msub id="S4.SS2.p12.2.m2.1.2.2" xref="S4.SS2.p12.2.m2.1.2.2.cmml"><mi id="S4.SS2.p12.2.m2.1.2.2.2" xref="S4.SS2.p12.2.m2.1.2.2.2.cmml">𝐞</mi><mi id="S4.SS2.p12.2.m2.1.2.2.3" xref="S4.SS2.p12.2.m2.1.2.2.3.cmml">p</mi></msub><mo id="S4.SS2.p12.2.m2.1.2.1" xref="S4.SS2.p12.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p12.2.m2.1.2.3.2" xref="S4.SS2.p12.2.m2.1.2.cmml"><mo id="S4.SS2.p12.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS2.p12.2.m2.1.2.cmml">(</mo><mi id="S4.SS2.p12.2.m2.1.1" xref="S4.SS2.p12.2.m2.1.1.cmml">t</mi><mo id="S4.SS2.p12.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS2.p12.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p12.2.m2.1b"><apply id="S4.SS2.p12.2.m2.1.2.cmml" xref="S4.SS2.p12.2.m2.1.2"><times id="S4.SS2.p12.2.m2.1.2.1.cmml" xref="S4.SS2.p12.2.m2.1.2.1"></times><apply id="S4.SS2.p12.2.m2.1.2.2.cmml" xref="S4.SS2.p12.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p12.2.m2.1.2.2.1.cmml" xref="S4.SS2.p12.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.p12.2.m2.1.2.2.2.cmml" xref="S4.SS2.p12.2.m2.1.2.2.2">𝐞</ci><ci id="S4.SS2.p12.2.m2.1.2.2.3.cmml" xref="S4.SS2.p12.2.m2.1.2.2.3">𝑝</ci></apply><ci id="S4.SS2.p12.2.m2.1.1.cmml" xref="S4.SS2.p12.2.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p12.2.m2.1c">\mathbf{e}_{p}(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.2.m2.1d">bold_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> are the diagnostic and surgical embedding representations of the patient’s most recent visit. By concatenating these embeddings and passing them through an MLP layer, we obtain the desired weight vector <math alttext="\mathbf{W}_{m}" class="ltx_Math" display="inline" id="S4.SS2.p12.3.m3.1"><semantics id="S4.SS2.p12.3.m3.1a"><msub id="S4.SS2.p12.3.m3.1.1" xref="S4.SS2.p12.3.m3.1.1.cmml"><mi id="S4.SS2.p12.3.m3.1.1.2" xref="S4.SS2.p12.3.m3.1.1.2.cmml">𝐖</mi><mi id="S4.SS2.p12.3.m3.1.1.3" xref="S4.SS2.p12.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p12.3.m3.1b"><apply id="S4.SS2.p12.3.m3.1.1.cmml" xref="S4.SS2.p12.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p12.3.m3.1.1.1.cmml" xref="S4.SS2.p12.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p12.3.m3.1.1.2.cmml" xref="S4.SS2.p12.3.m3.1.1.2">𝐖</ci><ci id="S4.SS2.p12.3.m3.1.1.3.cmml" xref="S4.SS2.p12.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p12.3.m3.1c">\mathbf{W}_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.3.m3.1d">bold_W start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. Finally, we correct the substructure embedding matrix by multiplying it with a diagonal matrix, and then scale the dimensions through an MLP network to obtain the representation <math alttext="\hat{\mathbf{m}}^{(i)}" class="ltx_Math" display="inline" id="S4.SS2.p12.4.m4.1"><semantics id="S4.SS2.p12.4.m4.1a"><msup id="S4.SS2.p12.4.m4.1.2" xref="S4.SS2.p12.4.m4.1.2.cmml"><mover accent="true" id="S4.SS2.p12.4.m4.1.2.2" xref="S4.SS2.p12.4.m4.1.2.2.cmml"><mi id="S4.SS2.p12.4.m4.1.2.2.2" xref="S4.SS2.p12.4.m4.1.2.2.2.cmml">𝐦</mi><mo id="S4.SS2.p12.4.m4.1.2.2.1" xref="S4.SS2.p12.4.m4.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS2.p12.4.m4.1.1.1.3" xref="S4.SS2.p12.4.m4.1.2.cmml"><mo id="S4.SS2.p12.4.m4.1.1.1.3.1" stretchy="false" xref="S4.SS2.p12.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p12.4.m4.1.1.1.1" xref="S4.SS2.p12.4.m4.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p12.4.m4.1.1.1.3.2" stretchy="false" xref="S4.SS2.p12.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p12.4.m4.1b"><apply id="S4.SS2.p12.4.m4.1.2.cmml" xref="S4.SS2.p12.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p12.4.m4.1.2.1.cmml" xref="S4.SS2.p12.4.m4.1.2">superscript</csymbol><apply id="S4.SS2.p12.4.m4.1.2.2.cmml" xref="S4.SS2.p12.4.m4.1.2.2"><ci id="S4.SS2.p12.4.m4.1.2.2.1.cmml" xref="S4.SS2.p12.4.m4.1.2.2.1">^</ci><ci id="S4.SS2.p12.4.m4.1.2.2.2.cmml" xref="S4.SS2.p12.4.m4.1.2.2.2">𝐦</ci></apply><ci id="S4.SS2.p12.4.m4.1.1.1.1.cmml" xref="S4.SS2.p12.4.m4.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p12.4.m4.1c">\hat{\mathbf{m}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.4.m4.1d">over^ start_ARG bold_m end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> for each drug.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E27">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{m}}^{(i)}=\mathrm{MLP}(\mathbf{W}_{m}\mathrm{Y}_{m}^{(i)})." class="ltx_Math" display="block" id="S4.E27.m1.3"><semantics id="S4.E27.m1.3a"><mrow id="S4.E27.m1.3.3.1" xref="S4.E27.m1.3.3.1.1.cmml"><mrow id="S4.E27.m1.3.3.1.1" xref="S4.E27.m1.3.3.1.1.cmml"><msup id="S4.E27.m1.3.3.1.1.3" xref="S4.E27.m1.3.3.1.1.3.cmml"><mover accent="true" id="S4.E27.m1.3.3.1.1.3.2" xref="S4.E27.m1.3.3.1.1.3.2.cmml"><mi id="S4.E27.m1.3.3.1.1.3.2.2" xref="S4.E27.m1.3.3.1.1.3.2.2.cmml">𝐦</mi><mo id="S4.E27.m1.3.3.1.1.3.2.1" xref="S4.E27.m1.3.3.1.1.3.2.1.cmml">^</mo></mover><mrow id="S4.E27.m1.1.1.1.3" xref="S4.E27.m1.3.3.1.1.3.cmml"><mo id="S4.E27.m1.1.1.1.3.1" stretchy="false" xref="S4.E27.m1.3.3.1.1.3.cmml">(</mo><mi id="S4.E27.m1.1.1.1.1" xref="S4.E27.m1.1.1.1.1.cmml">i</mi><mo id="S4.E27.m1.1.1.1.3.2" stretchy="false" xref="S4.E27.m1.3.3.1.1.3.cmml">)</mo></mrow></msup><mo id="S4.E27.m1.3.3.1.1.2" xref="S4.E27.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E27.m1.3.3.1.1.1" xref="S4.E27.m1.3.3.1.1.1.cmml"><mi id="S4.E27.m1.3.3.1.1.1.3" xref="S4.E27.m1.3.3.1.1.1.3.cmml">MLP</mi><mo id="S4.E27.m1.3.3.1.1.1.2" xref="S4.E27.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E27.m1.3.3.1.1.1.1.1" xref="S4.E27.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E27.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E27.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E27.m1.3.3.1.1.1.1.1.1" xref="S4.E27.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S4.E27.m1.3.3.1.1.1.1.1.1.2" xref="S4.E27.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E27.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E27.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mi id="S4.E27.m1.3.3.1.1.1.1.1.1.2.3" xref="S4.E27.m1.3.3.1.1.1.1.1.1.2.3.cmml">m</mi></msub><mo id="S4.E27.m1.3.3.1.1.1.1.1.1.1" xref="S4.E27.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S4.E27.m1.3.3.1.1.1.1.1.1.3" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.2" mathvariant="normal" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">Y</mi><mi id="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">m</mi><mrow id="S4.E27.m1.2.2.1.3" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.cmml"><mo id="S4.E27.m1.2.2.1.3.1" stretchy="false" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E27.m1.2.2.1.1" xref="S4.E27.m1.2.2.1.1.cmml">i</mi><mo id="S4.E27.m1.2.2.1.3.2" stretchy="false" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E27.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E27.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E27.m1.3.3.1.2" lspace="0em" xref="S4.E27.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E27.m1.3b"><apply id="S4.E27.m1.3.3.1.1.cmml" xref="S4.E27.m1.3.3.1"><eq id="S4.E27.m1.3.3.1.1.2.cmml" xref="S4.E27.m1.3.3.1.1.2"></eq><apply id="S4.E27.m1.3.3.1.1.3.cmml" xref="S4.E27.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E27.m1.3.3.1.1.3.1.cmml" xref="S4.E27.m1.3.3.1.1.3">superscript</csymbol><apply id="S4.E27.m1.3.3.1.1.3.2.cmml" xref="S4.E27.m1.3.3.1.1.3.2"><ci id="S4.E27.m1.3.3.1.1.3.2.1.cmml" xref="S4.E27.m1.3.3.1.1.3.2.1">^</ci><ci id="S4.E27.m1.3.3.1.1.3.2.2.cmml" xref="S4.E27.m1.3.3.1.1.3.2.2">𝐦</ci></apply><ci id="S4.E27.m1.1.1.1.1.cmml" xref="S4.E27.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.E27.m1.3.3.1.1.1.cmml" xref="S4.E27.m1.3.3.1.1.1"><times id="S4.E27.m1.3.3.1.1.1.2.cmml" xref="S4.E27.m1.3.3.1.1.1.2"></times><ci id="S4.E27.m1.3.3.1.1.1.3.cmml" xref="S4.E27.m1.3.3.1.1.1.3">MLP</ci><apply id="S4.E27.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1"><times id="S4.E27.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.1"></times><apply id="S4.E27.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E27.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E27.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.2.2">𝐖</ci><ci id="S4.E27.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S4.E27.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E27.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.2">Y</ci><ci id="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E27.m1.3.3.1.1.1.1.1.1.3.2.3">𝑚</ci></apply><ci id="S4.E27.m1.2.2.1.1.cmml" xref="S4.E27.m1.2.2.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E27.m1.3c">\hat{\mathbf{m}}^{(i)}=\mathrm{MLP}(\mathbf{W}_{m}\mathrm{Y}_{m}^{(i)}).</annotation><annotation encoding="application/x-llamapun" id="S4.E27.m1.3d">over^ start_ARG bold_m end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = roman_MLP ( bold_W start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT roman_Y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p13">
<p class="ltx_p" id="S4.SS2.p13.1">This stage’s results prepare for the next phase of the task.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Fusion of Medication Evolution Trajectories</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">The purpose of this stage is to integrate the medication representations obtained for the patient at each time point. This representation results from multiple dynamic enhancements of substructures, ultimately yielding the recommendation probabilities for all medications.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.4">By embedding the multiple medication representations generated in the previous stage <math alttext="\{\hat{\mathbf{m}}_{v_{1}},\hat{\mathbf{m}}_{v_{2}},\ldots,\hat{\mathbf{m}}_{v%
_{t-1}}\}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.4"><semantics id="S4.SS3.p2.1.m1.4a"><mrow id="S4.SS3.p2.1.m1.4.4.3" xref="S4.SS3.p2.1.m1.4.4.4.cmml"><mo id="S4.SS3.p2.1.m1.4.4.3.4" stretchy="false" xref="S4.SS3.p2.1.m1.4.4.4.cmml">{</mo><msub id="S4.SS3.p2.1.m1.2.2.1.1" xref="S4.SS3.p2.1.m1.2.2.1.1.cmml"><mover accent="true" id="S4.SS3.p2.1.m1.2.2.1.1.2" xref="S4.SS3.p2.1.m1.2.2.1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.2.2.1.1.2.2" xref="S4.SS3.p2.1.m1.2.2.1.1.2.2.cmml">𝐦</mi><mo id="S4.SS3.p2.1.m1.2.2.1.1.2.1" xref="S4.SS3.p2.1.m1.2.2.1.1.2.1.cmml">^</mo></mover><msub id="S4.SS3.p2.1.m1.2.2.1.1.3" xref="S4.SS3.p2.1.m1.2.2.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.2.2.1.1.3.2" xref="S4.SS3.p2.1.m1.2.2.1.1.3.2.cmml">v</mi><mn id="S4.SS3.p2.1.m1.2.2.1.1.3.3" xref="S4.SS3.p2.1.m1.2.2.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.SS3.p2.1.m1.4.4.3.5" xref="S4.SS3.p2.1.m1.4.4.4.cmml">,</mo><msub id="S4.SS3.p2.1.m1.3.3.2.2" xref="S4.SS3.p2.1.m1.3.3.2.2.cmml"><mover accent="true" id="S4.SS3.p2.1.m1.3.3.2.2.2" xref="S4.SS3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS3.p2.1.m1.3.3.2.2.2.2" xref="S4.SS3.p2.1.m1.3.3.2.2.2.2.cmml">𝐦</mi><mo id="S4.SS3.p2.1.m1.3.3.2.2.2.1" xref="S4.SS3.p2.1.m1.3.3.2.2.2.1.cmml">^</mo></mover><msub id="S4.SS3.p2.1.m1.3.3.2.2.3" xref="S4.SS3.p2.1.m1.3.3.2.2.3.cmml"><mi id="S4.SS3.p2.1.m1.3.3.2.2.3.2" xref="S4.SS3.p2.1.m1.3.3.2.2.3.2.cmml">v</mi><mn id="S4.SS3.p2.1.m1.3.3.2.2.3.3" xref="S4.SS3.p2.1.m1.3.3.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.SS3.p2.1.m1.4.4.3.6" xref="S4.SS3.p2.1.m1.4.4.4.cmml">,</mo><mi id="S4.SS3.p2.1.m1.1.1" mathvariant="normal" xref="S4.SS3.p2.1.m1.1.1.cmml">…</mi><mo id="S4.SS3.p2.1.m1.4.4.3.7" xref="S4.SS3.p2.1.m1.4.4.4.cmml">,</mo><msub id="S4.SS3.p2.1.m1.4.4.3.3" xref="S4.SS3.p2.1.m1.4.4.3.3.cmml"><mover accent="true" id="S4.SS3.p2.1.m1.4.4.3.3.2" xref="S4.SS3.p2.1.m1.4.4.3.3.2.cmml"><mi id="S4.SS3.p2.1.m1.4.4.3.3.2.2" xref="S4.SS3.p2.1.m1.4.4.3.3.2.2.cmml">𝐦</mi><mo id="S4.SS3.p2.1.m1.4.4.3.3.2.1" xref="S4.SS3.p2.1.m1.4.4.3.3.2.1.cmml">^</mo></mover><msub id="S4.SS3.p2.1.m1.4.4.3.3.3" xref="S4.SS3.p2.1.m1.4.4.3.3.3.cmml"><mi id="S4.SS3.p2.1.m1.4.4.3.3.3.2" xref="S4.SS3.p2.1.m1.4.4.3.3.3.2.cmml">v</mi><mrow id="S4.SS3.p2.1.m1.4.4.3.3.3.3" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3.cmml"><mi id="S4.SS3.p2.1.m1.4.4.3.3.3.3.2" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3.2.cmml">t</mi><mo id="S4.SS3.p2.1.m1.4.4.3.3.3.3.1" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3.1.cmml">−</mo><mn id="S4.SS3.p2.1.m1.4.4.3.3.3.3.3" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="S4.SS3.p2.1.m1.4.4.3.8" stretchy="false" xref="S4.SS3.p2.1.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.4b"><set id="S4.SS3.p2.1.m1.4.4.4.cmml" xref="S4.SS3.p2.1.m1.4.4.3"><apply id="S4.SS3.p2.1.m1.2.2.1.1.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1">subscript</csymbol><apply id="S4.SS3.p2.1.m1.2.2.1.1.2.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1.2"><ci id="S4.SS3.p2.1.m1.2.2.1.1.2.1.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1.2.1">^</ci><ci id="S4.SS3.p2.1.m1.2.2.1.1.2.2.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1.2.2">𝐦</ci></apply><apply id="S4.SS3.p2.1.m1.2.2.1.1.3.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.2.2.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.1.m1.2.2.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.2.2.1.1.3.2">𝑣</ci><cn id="S4.SS3.p2.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS3.p2.1.m1.2.2.1.1.3.3">1</cn></apply></apply><apply id="S4.SS3.p2.1.m1.3.3.2.2.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.3.3.2.2.1.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2">subscript</csymbol><apply id="S4.SS3.p2.1.m1.3.3.2.2.2.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2.2"><ci id="S4.SS3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2.2.1">^</ci><ci id="S4.SS3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2.2.2">𝐦</ci></apply><apply id="S4.SS3.p2.1.m1.3.3.2.2.3.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.3.3.2.2.3.1.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2.3">subscript</csymbol><ci id="S4.SS3.p2.1.m1.3.3.2.2.3.2.cmml" xref="S4.SS3.p2.1.m1.3.3.2.2.3.2">𝑣</ci><cn id="S4.SS3.p2.1.m1.3.3.2.2.3.3.cmml" type="integer" xref="S4.SS3.p2.1.m1.3.3.2.2.3.3">2</cn></apply></apply><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">…</ci><apply id="S4.SS3.p2.1.m1.4.4.3.3.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.4.4.3.3.1.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3">subscript</csymbol><apply id="S4.SS3.p2.1.m1.4.4.3.3.2.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.2"><ci id="S4.SS3.p2.1.m1.4.4.3.3.2.1.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.2.1">^</ci><ci id="S4.SS3.p2.1.m1.4.4.3.3.2.2.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.2.2">𝐦</ci></apply><apply id="S4.SS3.p2.1.m1.4.4.3.3.3.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.4.4.3.3.3.1.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.SS3.p2.1.m1.4.4.3.3.3.2.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.3.2">𝑣</ci><apply id="S4.SS3.p2.1.m1.4.4.3.3.3.3.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3"><minus id="S4.SS3.p2.1.m1.4.4.3.3.3.3.1.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3.1"></minus><ci id="S4.SS3.p2.1.m1.4.4.3.3.3.3.2.cmml" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3.2">𝑡</ci><cn id="S4.SS3.p2.1.m1.4.4.3.3.3.3.3.cmml" type="integer" xref="S4.SS3.p2.1.m1.4.4.3.3.3.3.3">1</cn></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.4c">\{\hat{\mathbf{m}}_{v_{1}},\hat{\mathbf{m}}_{v_{2}},\ldots,\hat{\mathbf{m}}_{v%
_{t-1}}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.4d">{ over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , over^ start_ARG bold_m end_ARG start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math> and inputting them into a gated recurrent unit <math alttext="\text{GRU}(\cdot)\in\mathbb{R}^{|\mathcal{M}|}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.2"><semantics id="S4.SS3.p2.2.m2.2a"><mrow id="S4.SS3.p2.2.m2.2.3" xref="S4.SS3.p2.2.m2.2.3.cmml"><mrow id="S4.SS3.p2.2.m2.2.3.2" xref="S4.SS3.p2.2.m2.2.3.2.cmml"><mtext id="S4.SS3.p2.2.m2.2.3.2.2" xref="S4.SS3.p2.2.m2.2.3.2.2a.cmml">GRU</mtext><mo id="S4.SS3.p2.2.m2.2.3.2.1" xref="S4.SS3.p2.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS3.p2.2.m2.2.3.2.3.2" xref="S4.SS3.p2.2.m2.2.3.2.cmml"><mo id="S4.SS3.p2.2.m2.2.3.2.3.2.1" stretchy="false" xref="S4.SS3.p2.2.m2.2.3.2.cmml">(</mo><mo id="S4.SS3.p2.2.m2.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p2.2.m2.2.2.cmml">⋅</mo><mo id="S4.SS3.p2.2.m2.2.3.2.3.2.2" stretchy="false" xref="S4.SS3.p2.2.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p2.2.m2.2.3.1" xref="S4.SS3.p2.2.m2.2.3.1.cmml">∈</mo><msup id="S4.SS3.p2.2.m2.2.3.3" xref="S4.SS3.p2.2.m2.2.3.3.cmml"><mi id="S4.SS3.p2.2.m2.2.3.3.2" xref="S4.SS3.p2.2.m2.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p2.2.m2.1.1.1.3" xref="S4.SS3.p2.2.m2.1.1.1.2.cmml"><mo id="S4.SS3.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S4.SS3.p2.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.2.m2.1.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.1.cmml">ℳ</mi><mo id="S4.SS3.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S4.SS3.p2.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.2b"><apply id="S4.SS3.p2.2.m2.2.3.cmml" xref="S4.SS3.p2.2.m2.2.3"><in id="S4.SS3.p2.2.m2.2.3.1.cmml" xref="S4.SS3.p2.2.m2.2.3.1"></in><apply id="S4.SS3.p2.2.m2.2.3.2.cmml" xref="S4.SS3.p2.2.m2.2.3.2"><times id="S4.SS3.p2.2.m2.2.3.2.1.cmml" xref="S4.SS3.p2.2.m2.2.3.2.1"></times><ci id="S4.SS3.p2.2.m2.2.3.2.2a.cmml" xref="S4.SS3.p2.2.m2.2.3.2.2"><mtext id="S4.SS3.p2.2.m2.2.3.2.2.cmml" xref="S4.SS3.p2.2.m2.2.3.2.2">GRU</mtext></ci><ci id="S4.SS3.p2.2.m2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2">⋅</ci></apply><apply id="S4.SS3.p2.2.m2.2.3.3.cmml" xref="S4.SS3.p2.2.m2.2.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.2.3.3.1.cmml" xref="S4.SS3.p2.2.m2.2.3.3">superscript</csymbol><ci id="S4.SS3.p2.2.m2.2.3.3.2.cmml" xref="S4.SS3.p2.2.m2.2.3.3.2">ℝ</ci><apply id="S4.SS3.p2.2.m2.1.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.1.3"><abs id="S4.SS3.p2.2.m2.1.1.1.2.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.3.1"></abs><ci id="S4.SS3.p2.2.m2.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1">ℳ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.2c">\text{GRU}(\cdot)\in\mathbb{R}^{|\mathcal{M}|}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.2d">GRU ( ⋅ ) ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT</annotation></semantics></math> to model the sequential relationships, <math alttext="\{v_{1},v_{2},\ldots,v_{t-1}\}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.4"><semantics id="S4.SS3.p2.3.m3.4a"><mrow id="S4.SS3.p2.3.m3.4.4.3" xref="S4.SS3.p2.3.m3.4.4.4.cmml"><mo id="S4.SS3.p2.3.m3.4.4.3.4" stretchy="false" xref="S4.SS3.p2.3.m3.4.4.4.cmml">{</mo><msub id="S4.SS3.p2.3.m3.2.2.1.1" xref="S4.SS3.p2.3.m3.2.2.1.1.cmml"><mi id="S4.SS3.p2.3.m3.2.2.1.1.2" xref="S4.SS3.p2.3.m3.2.2.1.1.2.cmml">v</mi><mn id="S4.SS3.p2.3.m3.2.2.1.1.3" xref="S4.SS3.p2.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p2.3.m3.4.4.3.5" xref="S4.SS3.p2.3.m3.4.4.4.cmml">,</mo><msub id="S4.SS3.p2.3.m3.3.3.2.2" xref="S4.SS3.p2.3.m3.3.3.2.2.cmml"><mi id="S4.SS3.p2.3.m3.3.3.2.2.2" xref="S4.SS3.p2.3.m3.3.3.2.2.2.cmml">v</mi><mn id="S4.SS3.p2.3.m3.3.3.2.2.3" xref="S4.SS3.p2.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS3.p2.3.m3.4.4.3.6" xref="S4.SS3.p2.3.m3.4.4.4.cmml">,</mo><mi id="S4.SS3.p2.3.m3.1.1" mathvariant="normal" xref="S4.SS3.p2.3.m3.1.1.cmml">…</mi><mo id="S4.SS3.p2.3.m3.4.4.3.7" xref="S4.SS3.p2.3.m3.4.4.4.cmml">,</mo><msub id="S4.SS3.p2.3.m3.4.4.3.3" xref="S4.SS3.p2.3.m3.4.4.3.3.cmml"><mi id="S4.SS3.p2.3.m3.4.4.3.3.2" xref="S4.SS3.p2.3.m3.4.4.3.3.2.cmml">v</mi><mrow id="S4.SS3.p2.3.m3.4.4.3.3.3" xref="S4.SS3.p2.3.m3.4.4.3.3.3.cmml"><mi id="S4.SS3.p2.3.m3.4.4.3.3.3.2" xref="S4.SS3.p2.3.m3.4.4.3.3.3.2.cmml">t</mi><mo id="S4.SS3.p2.3.m3.4.4.3.3.3.1" xref="S4.SS3.p2.3.m3.4.4.3.3.3.1.cmml">−</mo><mn id="S4.SS3.p2.3.m3.4.4.3.3.3.3" xref="S4.SS3.p2.3.m3.4.4.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p2.3.m3.4.4.3.8" stretchy="false" xref="S4.SS3.p2.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.4b"><set id="S4.SS3.p2.3.m3.4.4.4.cmml" xref="S4.SS3.p2.3.m3.4.4.3"><apply id="S4.SS3.p2.3.m3.2.2.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.2.1.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.2.1.1.2.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.2">𝑣</ci><cn id="S4.SS3.p2.3.m3.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p2.3.m3.2.2.1.1.3">1</cn></apply><apply id="S4.SS3.p2.3.m3.3.3.2.2.cmml" xref="S4.SS3.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.3.3.2.2.1.cmml" xref="S4.SS3.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p2.3.m3.3.3.2.2.2.cmml" xref="S4.SS3.p2.3.m3.3.3.2.2.2">𝑣</ci><cn id="S4.SS3.p2.3.m3.3.3.2.2.3.cmml" type="integer" xref="S4.SS3.p2.3.m3.3.3.2.2.3">2</cn></apply><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">…</ci><apply id="S4.SS3.p2.3.m3.4.4.3.3.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.4.4.3.3.1.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3">subscript</csymbol><ci id="S4.SS3.p2.3.m3.4.4.3.3.2.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3.2">𝑣</ci><apply id="S4.SS3.p2.3.m3.4.4.3.3.3.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3.3"><minus id="S4.SS3.p2.3.m3.4.4.3.3.3.1.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3.3.1"></minus><ci id="S4.SS3.p2.3.m3.4.4.3.3.3.2.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3.3.2">𝑡</ci><cn id="S4.SS3.p2.3.m3.4.4.3.3.3.3.cmml" type="integer" xref="S4.SS3.p2.3.m3.4.4.3.3.3.3">1</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.4c">\{v_{1},v_{2},\ldots,v_{t-1}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.4d">{ italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT }</annotation></semantics></math> are the first <math alttext="t-1" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">t</mi><mo id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml">−</mo><mn id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><minus id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"></minus><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝑡</ci><cn id="S4.SS3.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS3.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_t - 1</annotation></semantics></math> patient visits, we then process the outputs through a multilayer perceptron</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MLP}(\cdot)\colon\mathbb{R}^{|\mathcal{M}|\times 2}\to\mathbb{R}^{|%
\mathcal{M}|}." class="ltx_Math" display="block" id="S4.Ex1.m1.4"><semantics id="S4.Ex1.m1.4a"><mrow id="S4.Ex1.m1.4.4.1" xref="S4.Ex1.m1.4.4.1.1.cmml"><mrow id="S4.Ex1.m1.4.4.1.1" xref="S4.Ex1.m1.4.4.1.1.cmml"><mrow id="S4.Ex1.m1.4.4.1.1.2" xref="S4.Ex1.m1.4.4.1.1.2.cmml"><mtext id="S4.Ex1.m1.4.4.1.1.2.2" xref="S4.Ex1.m1.4.4.1.1.2.2a.cmml">MLP</mtext><mo id="S4.Ex1.m1.4.4.1.1.2.1" xref="S4.Ex1.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="S4.Ex1.m1.4.4.1.1.2.3.2" xref="S4.Ex1.m1.4.4.1.1.2.cmml"><mo id="S4.Ex1.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.2.cmml">(</mo><mo id="S4.Ex1.m1.3.3" lspace="0em" rspace="0em" xref="S4.Ex1.m1.3.3.cmml">⋅</mo><mo id="S4.Ex1.m1.4.4.1.1.2.3.2.2" rspace="0.278em" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.4.4.1.1.1" rspace="0.278em" xref="S4.Ex1.m1.4.4.1.1.1.cmml">:</mo><mrow id="S4.Ex1.m1.4.4.1.1.3" xref="S4.Ex1.m1.4.4.1.1.3.cmml"><msup id="S4.Ex1.m1.4.4.1.1.3.2" xref="S4.Ex1.m1.4.4.1.1.3.2.cmml"><mi id="S4.Ex1.m1.4.4.1.1.3.2.2" xref="S4.Ex1.m1.4.4.1.1.3.2.2.cmml">ℝ</mi><mrow id="S4.Ex1.m1.1.1.1" xref="S4.Ex1.m1.1.1.1.cmml"><mrow id="S4.Ex1.m1.1.1.1.3.2" xref="S4.Ex1.m1.1.1.1.3.1.cmml"><mo id="S4.Ex1.m1.1.1.1.3.2.1" stretchy="false" xref="S4.Ex1.m1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">ℳ</mi><mo id="S4.Ex1.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S4.Ex1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.Ex1.m1.1.1.1.2" rspace="0.222em" xref="S4.Ex1.m1.1.1.1.2.cmml">×</mo><mn id="S4.Ex1.m1.1.1.1.4" xref="S4.Ex1.m1.1.1.1.4.cmml">2</mn></mrow></msup><mo id="S4.Ex1.m1.4.4.1.1.3.1" stretchy="false" xref="S4.Ex1.m1.4.4.1.1.3.1.cmml">→</mo><msup id="S4.Ex1.m1.4.4.1.1.3.3" xref="S4.Ex1.m1.4.4.1.1.3.3.cmml"><mi id="S4.Ex1.m1.4.4.1.1.3.3.2" xref="S4.Ex1.m1.4.4.1.1.3.3.2.cmml">ℝ</mi><mrow id="S4.Ex1.m1.2.2.1.3" xref="S4.Ex1.m1.2.2.1.2.cmml"><mo id="S4.Ex1.m1.2.2.1.3.1" stretchy="false" xref="S4.Ex1.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.2.2.1.1" xref="S4.Ex1.m1.2.2.1.1.cmml">ℳ</mi><mo id="S4.Ex1.m1.2.2.1.3.2" stretchy="false" xref="S4.Ex1.m1.2.2.1.2.1.cmml">|</mo></mrow></msup></mrow></mrow><mo id="S4.Ex1.m1.4.4.1.2" lspace="0em" xref="S4.Ex1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.4b"><apply id="S4.Ex1.m1.4.4.1.1.cmml" xref="S4.Ex1.m1.4.4.1"><ci id="S4.Ex1.m1.4.4.1.1.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1">:</ci><apply id="S4.Ex1.m1.4.4.1.1.2.cmml" xref="S4.Ex1.m1.4.4.1.1.2"><times id="S4.Ex1.m1.4.4.1.1.2.1.cmml" xref="S4.Ex1.m1.4.4.1.1.2.1"></times><ci id="S4.Ex1.m1.4.4.1.1.2.2a.cmml" xref="S4.Ex1.m1.4.4.1.1.2.2"><mtext id="S4.Ex1.m1.4.4.1.1.2.2.cmml" xref="S4.Ex1.m1.4.4.1.1.2.2">MLP</mtext></ci><ci id="S4.Ex1.m1.3.3.cmml" xref="S4.Ex1.m1.3.3">⋅</ci></apply><apply id="S4.Ex1.m1.4.4.1.1.3.cmml" xref="S4.Ex1.m1.4.4.1.1.3"><ci id="S4.Ex1.m1.4.4.1.1.3.1.cmml" xref="S4.Ex1.m1.4.4.1.1.3.1">→</ci><apply id="S4.Ex1.m1.4.4.1.1.3.2.cmml" xref="S4.Ex1.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.3.2.1.cmml" xref="S4.Ex1.m1.4.4.1.1.3.2">superscript</csymbol><ci id="S4.Ex1.m1.4.4.1.1.3.2.2.cmml" xref="S4.Ex1.m1.4.4.1.1.3.2.2">ℝ</ci><apply id="S4.Ex1.m1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1"><times id="S4.Ex1.m1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.2"></times><apply id="S4.Ex1.m1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.1.1.1.3.2"><abs id="S4.Ex1.m1.1.1.1.3.1.1.cmml" xref="S4.Ex1.m1.1.1.1.3.2.1"></abs><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">ℳ</ci></apply><cn id="S4.Ex1.m1.1.1.1.4.cmml" type="integer" xref="S4.Ex1.m1.1.1.1.4">2</cn></apply></apply><apply id="S4.Ex1.m1.4.4.1.1.3.3.cmml" xref="S4.Ex1.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.3.3.1.cmml" xref="S4.Ex1.m1.4.4.1.1.3.3">superscript</csymbol><ci id="S4.Ex1.m1.4.4.1.1.3.3.2.cmml" xref="S4.Ex1.m1.4.4.1.1.3.3.2">ℝ</ci><apply id="S4.Ex1.m1.2.2.1.2.cmml" xref="S4.Ex1.m1.2.2.1.3"><abs id="S4.Ex1.m1.2.2.1.2.1.cmml" xref="S4.Ex1.m1.2.2.1.3.1"></abs><ci id="S4.Ex1.m1.2.2.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.4c">\text{MLP}(\cdot)\colon\mathbb{R}^{|\mathcal{M}|\times 2}\to\mathbb{R}^{|%
\mathcal{M}|}.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.4d">MLP ( ⋅ ) : blackboard_R start_POSTSUPERSCRIPT | caligraphic_M | × 2 end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.13">Finally, we concatenate the results with the patient’s most recent representation to generate the final drug probabilities.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx7">
<tbody id="S4.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{o}_{v_{t-1}}=\text{GRU}(\mathbf{o}_{v_{t-2}},\mathbf{h}_{%
v_{t-1}})," class="ltx_Math" display="block" id="S4.E28.m1.1"><semantics id="S4.E28.m1.1a"><mrow id="S4.E28.m1.1.1.1" xref="S4.E28.m1.1.1.1.1.cmml"><mrow id="S4.E28.m1.1.1.1.1" xref="S4.E28.m1.1.1.1.1.cmml"><msub id="S4.E28.m1.1.1.1.1.4" xref="S4.E28.m1.1.1.1.1.4.cmml"><mi id="S4.E28.m1.1.1.1.1.4.2" xref="S4.E28.m1.1.1.1.1.4.2.cmml">𝐨</mi><msub id="S4.E28.m1.1.1.1.1.4.3" xref="S4.E28.m1.1.1.1.1.4.3.cmml"><mi id="S4.E28.m1.1.1.1.1.4.3.2" xref="S4.E28.m1.1.1.1.1.4.3.2.cmml">v</mi><mrow id="S4.E28.m1.1.1.1.1.4.3.3" xref="S4.E28.m1.1.1.1.1.4.3.3.cmml"><mi id="S4.E28.m1.1.1.1.1.4.3.3.2" xref="S4.E28.m1.1.1.1.1.4.3.3.2.cmml">t</mi><mo id="S4.E28.m1.1.1.1.1.4.3.3.1" xref="S4.E28.m1.1.1.1.1.4.3.3.1.cmml">−</mo><mn id="S4.E28.m1.1.1.1.1.4.3.3.3" xref="S4.E28.m1.1.1.1.1.4.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="S4.E28.m1.1.1.1.1.3" xref="S4.E28.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E28.m1.1.1.1.1.2" xref="S4.E28.m1.1.1.1.1.2.cmml"><mtext id="S4.E28.m1.1.1.1.1.2.4" xref="S4.E28.m1.1.1.1.1.2.4a.cmml">GRU</mtext><mo id="S4.E28.m1.1.1.1.1.2.3" xref="S4.E28.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E28.m1.1.1.1.1.2.2.2" xref="S4.E28.m1.1.1.1.1.2.2.3.cmml"><mo id="S4.E28.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E28.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E28.m1.1.1.1.1.1.1.1.1" xref="S4.E28.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E28.m1.1.1.1.1.1.1.1.1.2" xref="S4.E28.m1.1.1.1.1.1.1.1.1.2.cmml">𝐨</mi><msub id="S4.E28.m1.1.1.1.1.1.1.1.1.3" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E28.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mrow id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></mrow></msub></msub><mo id="S4.E28.m1.1.1.1.1.2.2.2.4" xref="S4.E28.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E28.m1.1.1.1.1.2.2.2.2" xref="S4.E28.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E28.m1.1.1.1.1.2.2.2.2.2" xref="S4.E28.m1.1.1.1.1.2.2.2.2.2.cmml">𝐡</mi><msub id="S4.E28.m1.1.1.1.1.2.2.2.2.3" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E28.m1.1.1.1.1.2.2.2.2.3.2" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.2.cmml">v</mi><mrow id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">t</mi><mo id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.1" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.1.cmml">−</mo><mn id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="S4.E28.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E28.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E28.m1.1.1.1.2" xref="S4.E28.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E28.m1.1b"><apply id="S4.E28.m1.1.1.1.1.cmml" xref="S4.E28.m1.1.1.1"><eq id="S4.E28.m1.1.1.1.1.3.cmml" xref="S4.E28.m1.1.1.1.1.3"></eq><apply id="S4.E28.m1.1.1.1.1.4.cmml" xref="S4.E28.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E28.m1.1.1.1.1.4.1.cmml" xref="S4.E28.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.E28.m1.1.1.1.1.4.2.cmml" xref="S4.E28.m1.1.1.1.1.4.2">𝐨</ci><apply id="S4.E28.m1.1.1.1.1.4.3.cmml" xref="S4.E28.m1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S4.E28.m1.1.1.1.1.4.3.1.cmml" xref="S4.E28.m1.1.1.1.1.4.3">subscript</csymbol><ci id="S4.E28.m1.1.1.1.1.4.3.2.cmml" xref="S4.E28.m1.1.1.1.1.4.3.2">𝑣</ci><apply id="S4.E28.m1.1.1.1.1.4.3.3.cmml" xref="S4.E28.m1.1.1.1.1.4.3.3"><minus id="S4.E28.m1.1.1.1.1.4.3.3.1.cmml" xref="S4.E28.m1.1.1.1.1.4.3.3.1"></minus><ci id="S4.E28.m1.1.1.1.1.4.3.3.2.cmml" xref="S4.E28.m1.1.1.1.1.4.3.3.2">𝑡</ci><cn id="S4.E28.m1.1.1.1.1.4.3.3.3.cmml" type="integer" xref="S4.E28.m1.1.1.1.1.4.3.3.3">1</cn></apply></apply></apply><apply id="S4.E28.m1.1.1.1.1.2.cmml" xref="S4.E28.m1.1.1.1.1.2"><times id="S4.E28.m1.1.1.1.1.2.3.cmml" xref="S4.E28.m1.1.1.1.1.2.3"></times><ci id="S4.E28.m1.1.1.1.1.2.4a.cmml" xref="S4.E28.m1.1.1.1.1.2.4"><mtext id="S4.E28.m1.1.1.1.1.2.4.cmml" xref="S4.E28.m1.1.1.1.1.2.4">GRU</mtext></ci><interval closure="open" id="S4.E28.m1.1.1.1.1.2.2.3.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2"><apply id="S4.E28.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E28.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E28.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1.2">𝐨</ci><apply id="S4.E28.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E28.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E28.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><apply id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3"><minus id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E28.m1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S4.E28.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E28.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E28.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2.2">𝐡</ci><apply id="S4.E28.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E28.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S4.E28.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.2">𝑣</ci><apply id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3"><minus id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.1"></minus><ci id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.2">𝑡</ci><cn id="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.E28.m1.1.1.1.1.2.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E28.m1.1c">\displaystyle\mathbf{o}_{v_{t-1}}=\text{GRU}(\mathbf{o}_{v_{t-2}},\mathbf{h}_{%
v_{t-1}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m1.1d">bold_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = GRU ( bold_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_h start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
<tbody id="S4.E29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle P(\mathcal{M})=\sigma(\text{MLP}(o_{v_{t-1}}+e_{v}^{\prime}(t)))" class="ltx_Math" display="block" id="S4.E29.m1.3"><semantics id="S4.E29.m1.3a"><mrow id="S4.E29.m1.3.3" xref="S4.E29.m1.3.3.cmml"><mrow id="S4.E29.m1.3.3.3" xref="S4.E29.m1.3.3.3.cmml"><mi id="S4.E29.m1.3.3.3.2" xref="S4.E29.m1.3.3.3.2.cmml">P</mi><mo id="S4.E29.m1.3.3.3.1" xref="S4.E29.m1.3.3.3.1.cmml">⁢</mo><mrow id="S4.E29.m1.3.3.3.3.2" xref="S4.E29.m1.3.3.3.cmml"><mo id="S4.E29.m1.3.3.3.3.2.1" stretchy="false" xref="S4.E29.m1.3.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E29.m1.1.1" xref="S4.E29.m1.1.1.cmml">ℳ</mi><mo id="S4.E29.m1.3.3.3.3.2.2" stretchy="false" xref="S4.E29.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S4.E29.m1.3.3.2" xref="S4.E29.m1.3.3.2.cmml">=</mo><mrow id="S4.E29.m1.3.3.1" xref="S4.E29.m1.3.3.1.cmml"><mi id="S4.E29.m1.3.3.1.3" xref="S4.E29.m1.3.3.1.3.cmml">σ</mi><mo id="S4.E29.m1.3.3.1.2" xref="S4.E29.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.E29.m1.3.3.1.1.1" xref="S4.E29.m1.3.3.1.1.1.1.cmml"><mo id="S4.E29.m1.3.3.1.1.1.2" stretchy="false" xref="S4.E29.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E29.m1.3.3.1.1.1.1" xref="S4.E29.m1.3.3.1.1.1.1.cmml"><mtext id="S4.E29.m1.3.3.1.1.1.1.3" xref="S4.E29.m1.3.3.1.1.1.1.3a.cmml">MLP</mtext><mo id="S4.E29.m1.3.3.1.1.1.1.2" xref="S4.E29.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E29.m1.3.3.1.1.1.1.1.1" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E29.m1.3.3.1.1.1.1.1.1.1" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">o</mi><msub id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">v</mi><mrow id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.2" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.2.cmml">t</mi><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.1" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.3" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.cmml"><msubsup id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.2" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.2.cmml">e</mi><mi id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.3" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.3.cmml">v</mi><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E29.m1.2.2" xref="S4.E29.m1.2.2.cmml">t</mi><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E29.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E29.m1.3.3.1.1.1.3" stretchy="false" xref="S4.E29.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E29.m1.3b"><apply id="S4.E29.m1.3.3.cmml" xref="S4.E29.m1.3.3"><eq id="S4.E29.m1.3.3.2.cmml" xref="S4.E29.m1.3.3.2"></eq><apply id="S4.E29.m1.3.3.3.cmml" xref="S4.E29.m1.3.3.3"><times id="S4.E29.m1.3.3.3.1.cmml" xref="S4.E29.m1.3.3.3.1"></times><ci id="S4.E29.m1.3.3.3.2.cmml" xref="S4.E29.m1.3.3.3.2">𝑃</ci><ci id="S4.E29.m1.1.1.cmml" xref="S4.E29.m1.1.1">ℳ</ci></apply><apply id="S4.E29.m1.3.3.1.cmml" xref="S4.E29.m1.3.3.1"><times id="S4.E29.m1.3.3.1.2.cmml" xref="S4.E29.m1.3.3.1.2"></times><ci id="S4.E29.m1.3.3.1.3.cmml" xref="S4.E29.m1.3.3.1.3">𝜎</ci><apply id="S4.E29.m1.3.3.1.1.1.1.cmml" xref="S4.E29.m1.3.3.1.1.1"><times id="S4.E29.m1.3.3.1.1.1.1.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.2"></times><ci id="S4.E29.m1.3.3.1.1.1.1.3a.cmml" xref="S4.E29.m1.3.3.1.1.1.1.3"><mtext id="S4.E29.m1.3.3.1.1.1.1.3.cmml" xref="S4.E29.m1.3.3.1.1.1.1.3">MLP</mtext></ci><apply id="S4.E29.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1"><plus id="S4.E29.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.1"></plus><apply id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.2">𝑜</ci><apply id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.2">𝑣</ci><apply id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3"><minus id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.1"></minus><ci id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.2">𝑡</ci><cn id="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3"><times id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.1"></times><apply id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.2">𝑒</ci><ci id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.2.3">𝑣</ci></apply><ci id="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E29.m1.3.3.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S4.E29.m1.2.2.cmml" xref="S4.E29.m1.2.2">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E29.m1.3c">\displaystyle P(\mathcal{M})=\sigma(\text{MLP}(o_{v_{t-1}}+e_{v}^{\prime}(t)))</annotation><annotation encoding="application/x-llamapun" id="S4.E29.m1.3d">italic_P ( caligraphic_M ) = italic_σ ( MLP ( italic_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT + italic_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.12">where <math alttext="\mathbf{o}_{v_{t-2}}" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m1.1"><semantics id="S4.SS3.p2.5.m1.1a"><msub id="S4.SS3.p2.5.m1.1.1" xref="S4.SS3.p2.5.m1.1.1.cmml"><mi id="S4.SS3.p2.5.m1.1.1.2" xref="S4.SS3.p2.5.m1.1.1.2.cmml">𝐨</mi><msub id="S4.SS3.p2.5.m1.1.1.3" xref="S4.SS3.p2.5.m1.1.1.3.cmml"><mi id="S4.SS3.p2.5.m1.1.1.3.2" xref="S4.SS3.p2.5.m1.1.1.3.2.cmml">v</mi><mrow id="S4.SS3.p2.5.m1.1.1.3.3" xref="S4.SS3.p2.5.m1.1.1.3.3.cmml"><mi id="S4.SS3.p2.5.m1.1.1.3.3.2" xref="S4.SS3.p2.5.m1.1.1.3.3.2.cmml">t</mi><mo id="S4.SS3.p2.5.m1.1.1.3.3.1" xref="S4.SS3.p2.5.m1.1.1.3.3.1.cmml">−</mo><mn id="S4.SS3.p2.5.m1.1.1.3.3.3" xref="S4.SS3.p2.5.m1.1.1.3.3.3.cmml">2</mn></mrow></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m1.1b"><apply id="S4.SS3.p2.5.m1.1.1.cmml" xref="S4.SS3.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m1.1.1.1.cmml" xref="S4.SS3.p2.5.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.5.m1.1.1.2.cmml" xref="S4.SS3.p2.5.m1.1.1.2">𝐨</ci><apply id="S4.SS3.p2.5.m1.1.1.3.cmml" xref="S4.SS3.p2.5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m1.1.1.3.1.cmml" xref="S4.SS3.p2.5.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.5.m1.1.1.3.2.cmml" xref="S4.SS3.p2.5.m1.1.1.3.2">𝑣</ci><apply id="S4.SS3.p2.5.m1.1.1.3.3.cmml" xref="S4.SS3.p2.5.m1.1.1.3.3"><minus id="S4.SS3.p2.5.m1.1.1.3.3.1.cmml" xref="S4.SS3.p2.5.m1.1.1.3.3.1"></minus><ci id="S4.SS3.p2.5.m1.1.1.3.3.2.cmml" xref="S4.SS3.p2.5.m1.1.1.3.3.2">𝑡</ci><cn id="S4.SS3.p2.5.m1.1.1.3.3.3.cmml" type="integer" xref="S4.SS3.p2.5.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m1.1c">\mathbf{o}_{v_{t-2}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m1.1d">bold_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t - 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is the intermediate variable generated by <math alttext="GRU(\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m2.1"><semantics id="S4.SS3.p2.6.m2.1a"><mrow id="S4.SS3.p2.6.m2.1.2" xref="S4.SS3.p2.6.m2.1.2.cmml"><mi id="S4.SS3.p2.6.m2.1.2.2" xref="S4.SS3.p2.6.m2.1.2.2.cmml">G</mi><mo id="S4.SS3.p2.6.m2.1.2.1" xref="S4.SS3.p2.6.m2.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.6.m2.1.2.3" xref="S4.SS3.p2.6.m2.1.2.3.cmml">R</mi><mo id="S4.SS3.p2.6.m2.1.2.1a" xref="S4.SS3.p2.6.m2.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.6.m2.1.2.4" xref="S4.SS3.p2.6.m2.1.2.4.cmml">U</mi><mo id="S4.SS3.p2.6.m2.1.2.1b" xref="S4.SS3.p2.6.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.p2.6.m2.1.2.5.2" xref="S4.SS3.p2.6.m2.1.2.cmml"><mo id="S4.SS3.p2.6.m2.1.2.5.2.1" stretchy="false" xref="S4.SS3.p2.6.m2.1.2.cmml">(</mo><mo id="S4.SS3.p2.6.m2.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p2.6.m2.1.1.cmml">⋅</mo><mo id="S4.SS3.p2.6.m2.1.2.5.2.2" stretchy="false" xref="S4.SS3.p2.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m2.1b"><apply id="S4.SS3.p2.6.m2.1.2.cmml" xref="S4.SS3.p2.6.m2.1.2"><times id="S4.SS3.p2.6.m2.1.2.1.cmml" xref="S4.SS3.p2.6.m2.1.2.1"></times><ci id="S4.SS3.p2.6.m2.1.2.2.cmml" xref="S4.SS3.p2.6.m2.1.2.2">𝐺</ci><ci id="S4.SS3.p2.6.m2.1.2.3.cmml" xref="S4.SS3.p2.6.m2.1.2.3">𝑅</ci><ci id="S4.SS3.p2.6.m2.1.2.4.cmml" xref="S4.SS3.p2.6.m2.1.2.4">𝑈</ci><ci id="S4.SS3.p2.6.m2.1.1.cmml" xref="S4.SS3.p2.6.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m2.1c">GRU(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m2.1d">italic_G italic_R italic_U ( ⋅ )</annotation></semantics></math>, and we represent <math alttext="\mathbf{o}_{v_{0}}" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m3.1"><semantics id="S4.SS3.p2.7.m3.1a"><msub id="S4.SS3.p2.7.m3.1.1" xref="S4.SS3.p2.7.m3.1.1.cmml"><mi id="S4.SS3.p2.7.m3.1.1.2" xref="S4.SS3.p2.7.m3.1.1.2.cmml">𝐨</mi><msub id="S4.SS3.p2.7.m3.1.1.3" xref="S4.SS3.p2.7.m3.1.1.3.cmml"><mi id="S4.SS3.p2.7.m3.1.1.3.2" xref="S4.SS3.p2.7.m3.1.1.3.2.cmml">v</mi><mn id="S4.SS3.p2.7.m3.1.1.3.3" xref="S4.SS3.p2.7.m3.1.1.3.3.cmml">0</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m3.1b"><apply id="S4.SS3.p2.7.m3.1.1.cmml" xref="S4.SS3.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m3.1.1.1.cmml" xref="S4.SS3.p2.7.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m3.1.1.2.cmml" xref="S4.SS3.p2.7.m3.1.1.2">𝐨</ci><apply id="S4.SS3.p2.7.m3.1.1.3.cmml" xref="S4.SS3.p2.7.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m3.1.1.3.1.cmml" xref="S4.SS3.p2.7.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.7.m3.1.1.3.2.cmml" xref="S4.SS3.p2.7.m3.1.1.3.2">𝑣</ci><cn id="S4.SS3.p2.7.m3.1.1.3.3.cmml" type="integer" xref="S4.SS3.p2.7.m3.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m3.1c">\mathbf{o}_{v_{0}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m3.1d">bold_o start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> as a zero vector. Finally, we use a nonlinear activation function <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m4.1"><semantics id="S4.SS3.p2.8.m4.1a"><mi id="S4.SS3.p2.8.m4.1.1" xref="S4.SS3.p2.8.m4.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m4.1b"><ci id="S4.SS3.p2.8.m4.1.1.cmml" xref="S4.SS3.p2.8.m4.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m4.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m4.1d">italic_σ</annotation></semantics></math> to convert the input representation into the predicted probability <math alttext="P(\mathcal{M})" class="ltx_Math" display="inline" id="S4.SS3.p2.9.m5.1"><semantics id="S4.SS3.p2.9.m5.1a"><mrow id="S4.SS3.p2.9.m5.1.2" xref="S4.SS3.p2.9.m5.1.2.cmml"><mi id="S4.SS3.p2.9.m5.1.2.2" xref="S4.SS3.p2.9.m5.1.2.2.cmml">P</mi><mo id="S4.SS3.p2.9.m5.1.2.1" xref="S4.SS3.p2.9.m5.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.p2.9.m5.1.2.3.2" xref="S4.SS3.p2.9.m5.1.2.cmml"><mo id="S4.SS3.p2.9.m5.1.2.3.2.1" stretchy="false" xref="S4.SS3.p2.9.m5.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.9.m5.1.1" xref="S4.SS3.p2.9.m5.1.1.cmml">ℳ</mi><mo id="S4.SS3.p2.9.m5.1.2.3.2.2" stretchy="false" xref="S4.SS3.p2.9.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m5.1b"><apply id="S4.SS3.p2.9.m5.1.2.cmml" xref="S4.SS3.p2.9.m5.1.2"><times id="S4.SS3.p2.9.m5.1.2.1.cmml" xref="S4.SS3.p2.9.m5.1.2.1"></times><ci id="S4.SS3.p2.9.m5.1.2.2.cmml" xref="S4.SS3.p2.9.m5.1.2.2">𝑃</ci><ci id="S4.SS3.p2.9.m5.1.1.cmml" xref="S4.SS3.p2.9.m5.1.1">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m5.1c">P(\mathcal{M})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.9.m5.1d">italic_P ( caligraphic_M )</annotation></semantics></math> for each drug <math alttext="M_{i}" class="ltx_Math" display="inline" id="S4.SS3.p2.10.m6.1"><semantics id="S4.SS3.p2.10.m6.1a"><msub id="S4.SS3.p2.10.m6.1.1" xref="S4.SS3.p2.10.m6.1.1.cmml"><mi id="S4.SS3.p2.10.m6.1.1.2" xref="S4.SS3.p2.10.m6.1.1.2.cmml">M</mi><mi id="S4.SS3.p2.10.m6.1.1.3" xref="S4.SS3.p2.10.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m6.1b"><apply id="S4.SS3.p2.10.m6.1.1.cmml" xref="S4.SS3.p2.10.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m6.1.1.1.cmml" xref="S4.SS3.p2.10.m6.1.1">subscript</csymbol><ci id="S4.SS3.p2.10.m6.1.1.2.cmml" xref="S4.SS3.p2.10.m6.1.1.2">𝑀</ci><ci id="S4.SS3.p2.10.m6.1.1.3.cmml" xref="S4.SS3.p2.10.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m6.1c">M_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.10.m6.1d">italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.If the probability exceeds a certain threshold <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS3.p2.11.m7.1"><semantics id="S4.SS3.p2.11.m7.1a"><mi id="S4.SS3.p2.11.m7.1.1" xref="S4.SS3.p2.11.m7.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m7.1b"><ci id="S4.SS3.p2.11.m7.1.1.cmml" xref="S4.SS3.p2.11.m7.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m7.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.11.m7.1d">italic_δ</annotation></semantics></math>, the drug recommendation is accepted; otherwise, it is not. Finally, we obtain the prediction results <math alttext="\hat{m}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p2.12.m8.1"><semantics id="S4.SS3.p2.12.m8.1a"><msub id="S4.SS3.p2.12.m8.1.1" xref="S4.SS3.p2.12.m8.1.1.cmml"><mover accent="true" id="S4.SS3.p2.12.m8.1.1.2" xref="S4.SS3.p2.12.m8.1.1.2.cmml"><mi id="S4.SS3.p2.12.m8.1.1.2.2" xref="S4.SS3.p2.12.m8.1.1.2.2.cmml">m</mi><mo id="S4.SS3.p2.12.m8.1.1.2.1" xref="S4.SS3.p2.12.m8.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p2.12.m8.1.1.3" xref="S4.SS3.p2.12.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m8.1b"><apply id="S4.SS3.p2.12.m8.1.1.cmml" xref="S4.SS3.p2.12.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m8.1.1.1.cmml" xref="S4.SS3.p2.12.m8.1.1">subscript</csymbol><apply id="S4.SS3.p2.12.m8.1.1.2.cmml" xref="S4.SS3.p2.12.m8.1.1.2"><ci id="S4.SS3.p2.12.m8.1.1.2.1.cmml" xref="S4.SS3.p2.12.m8.1.1.2.1">^</ci><ci id="S4.SS3.p2.12.m8.1.1.2.2.cmml" xref="S4.SS3.p2.12.m8.1.1.2.2">𝑚</ci></apply><ci id="S4.SS3.p2.12.m8.1.1.3.cmml" xref="S4.SS3.p2.12.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m8.1c">\hat{m}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.12.m8.1d">over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for each medication.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Model Training</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.3">Medication recommendation is essentially a multi-label binary classification task. Therefore, we use the binary cross-entropy loss function <math alttext="L_{bce}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">L</mi><mrow id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.3.2" xref="S4.SS4.p1.1.m1.1.1.3.2.cmml">b</mi><mo id="S4.SS4.p1.1.m1.1.1.3.1" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.1.m1.1.1.3.3" xref="S4.SS4.p1.1.m1.1.1.3.3.cmml">c</mi><mo id="S4.SS4.p1.1.m1.1.1.3.1a" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.1.m1.1.1.3.4" xref="S4.SS4.p1.1.m1.1.1.3.4.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝐿</ci><apply id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><times id="S4.SS4.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.p1.1.m1.1.1.3.1"></times><ci id="S4.SS4.p1.1.m1.1.1.3.2.cmml" xref="S4.SS4.p1.1.m1.1.1.3.2">𝑏</ci><ci id="S4.SS4.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3">𝑐</ci><ci id="S4.SS4.p1.1.m1.1.1.3.4.cmml" xref="S4.SS4.p1.1.m1.1.1.3.4">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">L_{bce}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_b italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and the multi-label margin loss function <math alttext="L_{multi}" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><msub id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">L</mi><mrow id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.p1.2.m2.1.1.3.2" xref="S4.SS4.p1.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS4.p1.2.m2.1.1.3.1" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.2.m2.1.1.3.3" xref="S4.SS4.p1.2.m2.1.1.3.3.cmml">u</mi><mo id="S4.SS4.p1.2.m2.1.1.3.1a" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.2.m2.1.1.3.4" xref="S4.SS4.p1.2.m2.1.1.3.4.cmml">l</mi><mo id="S4.SS4.p1.2.m2.1.1.3.1b" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.2.m2.1.1.3.5" xref="S4.SS4.p1.2.m2.1.1.3.5.cmml">t</mi><mo id="S4.SS4.p1.2.m2.1.1.3.1c" xref="S4.SS4.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.2.m2.1.1.3.6" xref="S4.SS4.p1.2.m2.1.1.3.6.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝐿</ci><apply id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3"><times id="S4.SS4.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.p1.2.m2.1.1.3.1"></times><ci id="S4.SS4.p1.2.m2.1.1.3.2.cmml" xref="S4.SS4.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS4.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3.3">𝑢</ci><ci id="S4.SS4.p1.2.m2.1.1.3.4.cmml" xref="S4.SS4.p1.2.m2.1.1.3.4">𝑙</ci><ci id="S4.SS4.p1.2.m2.1.1.3.5.cmml" xref="S4.SS4.p1.2.m2.1.1.3.5">𝑡</ci><ci id="S4.SS4.p1.2.m2.1.1.3.6.cmml" xref="S4.SS4.p1.2.m2.1.1.3.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">L_{multi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Additionally, due to the specific nature of medication recommendation, we use the medication DDI loss function <math alttext="L_{ddi}" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><msub id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">L</mi><mrow id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.p1.3.m3.1.1.3.2" xref="S4.SS4.p1.3.m3.1.1.3.2.cmml">d</mi><mo id="S4.SS4.p1.3.m3.1.1.3.1" xref="S4.SS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.3.m3.1.1.3.3" xref="S4.SS4.p1.3.m3.1.1.3.3.cmml">d</mi><mo id="S4.SS4.p1.3.m3.1.1.3.1a" xref="S4.SS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.3.m3.1.1.3.4" xref="S4.SS4.p1.3.m3.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝐿</ci><apply id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3"><times id="S4.SS4.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.3.1"></times><ci id="S4.SS4.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.3.2">𝑑</ci><ci id="S4.SS4.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3">𝑑</ci><ci id="S4.SS4.p1.3.m3.1.1.3.4.cmml" xref="S4.SS4.p1.3.m3.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">L_{ddi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_L start_POSTSUBSCRIPT italic_d italic_d italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib43" title="">43</a>]</cite>, which calculates the probability of DDI occurrence by identifying medication pairs with potential DDI risk in the medication combination. The definitions of the three loss functions are as follows:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx8">
<tbody id="S4.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}_{bce}=-\sum_{i=1}^{|\mathcal{M}|}{m_{i}}\log({\hat{m}%
_{i}})+(1-{m_{i}})\log(1-{\hat{m}_{i}})," class="ltx_Math" display="block" id="S4.E30.m1.4"><semantics id="S4.E30.m1.4a"><mrow id="S4.E30.m1.4.4.1" xref="S4.E30.m1.4.4.1.1.cmml"><mrow id="S4.E30.m1.4.4.1.1" xref="S4.E30.m1.4.4.1.1.cmml"><msub id="S4.E30.m1.4.4.1.1.5" xref="S4.E30.m1.4.4.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E30.m1.4.4.1.1.5.2" xref="S4.E30.m1.4.4.1.1.5.2.cmml">ℒ</mi><mrow id="S4.E30.m1.4.4.1.1.5.3" xref="S4.E30.m1.4.4.1.1.5.3.cmml"><mi id="S4.E30.m1.4.4.1.1.5.3.2" xref="S4.E30.m1.4.4.1.1.5.3.2.cmml">b</mi><mo id="S4.E30.m1.4.4.1.1.5.3.1" xref="S4.E30.m1.4.4.1.1.5.3.1.cmml">⁢</mo><mi id="S4.E30.m1.4.4.1.1.5.3.3" xref="S4.E30.m1.4.4.1.1.5.3.3.cmml">c</mi><mo id="S4.E30.m1.4.4.1.1.5.3.1a" xref="S4.E30.m1.4.4.1.1.5.3.1.cmml">⁢</mo><mi id="S4.E30.m1.4.4.1.1.5.3.4" xref="S4.E30.m1.4.4.1.1.5.3.4.cmml">e</mi></mrow></msub><mo id="S4.E30.m1.4.4.1.1.4" xref="S4.E30.m1.4.4.1.1.4.cmml">=</mo><mrow id="S4.E30.m1.4.4.1.1.3" xref="S4.E30.m1.4.4.1.1.3.cmml"><mrow id="S4.E30.m1.4.4.1.1.1.1" xref="S4.E30.m1.4.4.1.1.1.1.cmml"><mo id="S4.E30.m1.4.4.1.1.1.1a" xref="S4.E30.m1.4.4.1.1.1.1.cmml">−</mo><mrow id="S4.E30.m1.4.4.1.1.1.1.1" xref="S4.E30.m1.4.4.1.1.1.1.1.cmml"><munderover id="S4.E30.m1.4.4.1.1.1.1.1.2" xref="S4.E30.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S4.E30.m1.4.4.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.2" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.1" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.3" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E30.m1.1.1.1.3" xref="S4.E30.m1.1.1.1.2.cmml"><mo id="S4.E30.m1.1.1.1.3.1" stretchy="false" xref="S4.E30.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E30.m1.1.1.1.1" xref="S4.E30.m1.1.1.1.1.cmml">ℳ</mi><mo id="S4.E30.m1.1.1.1.3.2" stretchy="false" xref="S4.E30.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E30.m1.4.4.1.1.1.1.1.1" xref="S4.E30.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S4.E30.m1.4.4.1.1.1.1.1.1.3" xref="S4.E30.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S4.E30.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E30.m1.4.4.1.1.1.1.1.1.3.2.cmml">m</mi><mi id="S4.E30.m1.4.4.1.1.1.1.1.1.3.3" xref="S4.E30.m1.4.4.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.E30.m1.4.4.1.1.1.1.1.1.2" lspace="0.167em" xref="S4.E30.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E30.m1.2.2" xref="S4.E30.m1.2.2.cmml">log</mi><mo id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1a" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><mo id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E30.m1.4.4.1.1.3.4" xref="S4.E30.m1.4.4.1.1.3.4.cmml">+</mo><mrow id="S4.E30.m1.4.4.1.1.3.3" xref="S4.E30.m1.4.4.1.1.3.3.cmml"><mrow id="S4.E30.m1.4.4.1.1.2.2.1.1" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.cmml"><mo id="S4.E30.m1.4.4.1.1.2.2.1.1.2" stretchy="false" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E30.m1.4.4.1.1.2.2.1.1.1" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.cmml"><mn id="S4.E30.m1.4.4.1.1.2.2.1.1.1.2" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E30.m1.4.4.1.1.2.2.1.1.1.1" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="S4.E30.m1.4.4.1.1.2.2.1.1.1.3" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.cmml"><mi id="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.2" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.2.cmml">m</mi><mi id="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.3" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E30.m1.4.4.1.1.2.2.1.1.3" stretchy="false" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E30.m1.4.4.1.1.3.3.3" lspace="0.167em" xref="S4.E30.m1.4.4.1.1.3.3.3.cmml">⁢</mo><mrow id="S4.E30.m1.4.4.1.1.3.3.2.1" xref="S4.E30.m1.4.4.1.1.3.3.2.2.cmml"><mi id="S4.E30.m1.3.3" xref="S4.E30.m1.3.3.cmml">log</mi><mo id="S4.E30.m1.4.4.1.1.3.3.2.1a" xref="S4.E30.m1.4.4.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S4.E30.m1.4.4.1.1.3.3.2.1.1" xref="S4.E30.m1.4.4.1.1.3.3.2.2.cmml"><mo id="S4.E30.m1.4.4.1.1.3.3.2.1.1.2" stretchy="false" xref="S4.E30.m1.4.4.1.1.3.3.2.2.cmml">(</mo><mrow id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.cmml"><mn id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.2" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.2.cmml">1</mn><mo id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.1" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.1.cmml">−</mo><msub id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.cmml"><mover accent="true" id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.cmml"><mi id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.2" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.2.cmml">m</mi><mo id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.1" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.3" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E30.m1.4.4.1.1.3.3.2.1.1.3" stretchy="false" xref="S4.E30.m1.4.4.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E30.m1.4.4.1.2" xref="S4.E30.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E30.m1.4b"><apply id="S4.E30.m1.4.4.1.1.cmml" xref="S4.E30.m1.4.4.1"><eq id="S4.E30.m1.4.4.1.1.4.cmml" xref="S4.E30.m1.4.4.1.1.4"></eq><apply id="S4.E30.m1.4.4.1.1.5.cmml" xref="S4.E30.m1.4.4.1.1.5"><csymbol cd="ambiguous" id="S4.E30.m1.4.4.1.1.5.1.cmml" xref="S4.E30.m1.4.4.1.1.5">subscript</csymbol><ci id="S4.E30.m1.4.4.1.1.5.2.cmml" xref="S4.E30.m1.4.4.1.1.5.2">ℒ</ci><apply id="S4.E30.m1.4.4.1.1.5.3.cmml" xref="S4.E30.m1.4.4.1.1.5.3"><times id="S4.E30.m1.4.4.1.1.5.3.1.cmml" xref="S4.E30.m1.4.4.1.1.5.3.1"></times><ci id="S4.E30.m1.4.4.1.1.5.3.2.cmml" xref="S4.E30.m1.4.4.1.1.5.3.2">𝑏</ci><ci id="S4.E30.m1.4.4.1.1.5.3.3.cmml" xref="S4.E30.m1.4.4.1.1.5.3.3">𝑐</ci><ci id="S4.E30.m1.4.4.1.1.5.3.4.cmml" xref="S4.E30.m1.4.4.1.1.5.3.4">𝑒</ci></apply></apply><apply id="S4.E30.m1.4.4.1.1.3.cmml" xref="S4.E30.m1.4.4.1.1.3"><plus id="S4.E30.m1.4.4.1.1.3.4.cmml" xref="S4.E30.m1.4.4.1.1.3.4"></plus><apply id="S4.E30.m1.4.4.1.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1"><minus id="S4.E30.m1.4.4.1.1.1.1.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1"></minus><apply id="S4.E30.m1.4.4.1.1.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1"><apply id="S4.E30.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E30.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E30.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E30.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E30.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.2"></sum><apply id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3"><eq id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E30.m1.4.4.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E30.m1.1.1.1.2.cmml" xref="S4.E30.m1.1.1.1.3"><abs id="S4.E30.m1.1.1.1.2.1.cmml" xref="S4.E30.m1.1.1.1.3.1"></abs><ci id="S4.E30.m1.1.1.1.1.cmml" xref="S4.E30.m1.1.1.1.1">ℳ</ci></apply></apply><apply id="S4.E30.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1"><times id="S4.E30.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.2"></times><apply id="S4.E30.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E30.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E30.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.E30.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E30.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1"><log id="S4.E30.m1.2.2.cmml" xref="S4.E30.m1.2.2"></log><apply id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><ci id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2">𝑚</ci></apply><ci id="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E30.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E30.m1.4.4.1.1.3.3.cmml" xref="S4.E30.m1.4.4.1.1.3.3"><times id="S4.E30.m1.4.4.1.1.3.3.3.cmml" xref="S4.E30.m1.4.4.1.1.3.3.3"></times><apply id="S4.E30.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.2.2.1.1"><minus id="S4.E30.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.1"></minus><cn id="S4.E30.m1.4.4.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.2">1</cn><apply id="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.2">𝑚</ci><ci id="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E30.m1.4.4.1.1.2.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E30.m1.4.4.1.1.3.3.2.2.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1"><log id="S4.E30.m1.3.3.cmml" xref="S4.E30.m1.3.3"></log><apply id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1"><minus id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.1.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.1"></minus><cn id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.2.cmml" type="integer" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.2">1</cn><apply id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.1.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3">subscript</csymbol><apply id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2"><ci id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.1.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.1">^</ci><ci id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.2.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.2.2">𝑚</ci></apply><ci id="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.3.cmml" xref="S4.E30.m1.4.4.1.1.3.3.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E30.m1.4c">\displaystyle\mathcal{L}_{bce}=-\sum_{i=1}^{|\mathcal{M}|}{m_{i}}\log({\hat{m}%
_{i}})+(1-{m_{i}})\log(1-{\hat{m}_{i}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E30.m1.4d">caligraphic_L start_POSTSUBSCRIPT italic_b italic_c italic_e end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
<tbody id="S4.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}_{multi}=\sum_{i,j:{m_{i}}=1,{m_{j}}=0}\frac{\max(0,1-%
({\hat{m}_{i}}-{\hat{m}_{j}}))}{|\mathcal{M}|}," class="ltx_Math" display="block" id="S4.E31.m1.9"><semantics id="S4.E31.m1.9a"><mrow id="S4.E31.m1.9.9.1" xref="S4.E31.m1.9.9.1.1.cmml"><mrow id="S4.E31.m1.9.9.1.1" xref="S4.E31.m1.9.9.1.1.cmml"><msub id="S4.E31.m1.9.9.1.1.2" xref="S4.E31.m1.9.9.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E31.m1.9.9.1.1.2.2" xref="S4.E31.m1.9.9.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E31.m1.9.9.1.1.2.3" xref="S4.E31.m1.9.9.1.1.2.3.cmml"><mi id="S4.E31.m1.9.9.1.1.2.3.2" xref="S4.E31.m1.9.9.1.1.2.3.2.cmml">m</mi><mo id="S4.E31.m1.9.9.1.1.2.3.1" xref="S4.E31.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E31.m1.9.9.1.1.2.3.3" xref="S4.E31.m1.9.9.1.1.2.3.3.cmml">u</mi><mo id="S4.E31.m1.9.9.1.1.2.3.1a" xref="S4.E31.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E31.m1.9.9.1.1.2.3.4" xref="S4.E31.m1.9.9.1.1.2.3.4.cmml">l</mi><mo id="S4.E31.m1.9.9.1.1.2.3.1b" xref="S4.E31.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E31.m1.9.9.1.1.2.3.5" xref="S4.E31.m1.9.9.1.1.2.3.5.cmml">t</mi><mo id="S4.E31.m1.9.9.1.1.2.3.1c" xref="S4.E31.m1.9.9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E31.m1.9.9.1.1.2.3.6" xref="S4.E31.m1.9.9.1.1.2.3.6.cmml">i</mi></mrow></msub><mo id="S4.E31.m1.9.9.1.1.1" rspace="0.111em" xref="S4.E31.m1.9.9.1.1.1.cmml">=</mo><mrow id="S4.E31.m1.9.9.1.1.3" xref="S4.E31.m1.9.9.1.1.3.cmml"><munder id="S4.E31.m1.9.9.1.1.3.1" xref="S4.E31.m1.9.9.1.1.3.1.cmml"><mo id="S4.E31.m1.9.9.1.1.3.1.2" movablelimits="false" xref="S4.E31.m1.9.9.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E31.m1.4.4.4" xref="S4.E31.m1.4.4.4.cmml"><mrow id="S4.E31.m1.4.4.4.6.2" xref="S4.E31.m1.4.4.4.6.1.cmml"><mi id="S4.E31.m1.1.1.1.1" xref="S4.E31.m1.1.1.1.1.cmml">i</mi><mo id="S4.E31.m1.4.4.4.6.2.1" xref="S4.E31.m1.4.4.4.6.1.cmml">,</mo><mi id="S4.E31.m1.2.2.2.2" xref="S4.E31.m1.2.2.2.2.cmml">j</mi></mrow><mo id="S4.E31.m1.4.4.4.5" lspace="0.278em" rspace="0.278em" xref="S4.E31.m1.4.4.4.5.cmml">:</mo><mrow id="S4.E31.m1.4.4.4.4.2" xref="S4.E31.m1.4.4.4.4.3.cmml"><mrow id="S4.E31.m1.3.3.3.3.1.1" xref="S4.E31.m1.3.3.3.3.1.1.cmml"><msub id="S4.E31.m1.3.3.3.3.1.1.2" xref="S4.E31.m1.3.3.3.3.1.1.2.cmml"><mi id="S4.E31.m1.3.3.3.3.1.1.2.2" xref="S4.E31.m1.3.3.3.3.1.1.2.2.cmml">m</mi><mi id="S4.E31.m1.3.3.3.3.1.1.2.3" xref="S4.E31.m1.3.3.3.3.1.1.2.3.cmml">i</mi></msub><mo id="S4.E31.m1.3.3.3.3.1.1.1" xref="S4.E31.m1.3.3.3.3.1.1.1.cmml">=</mo><mn id="S4.E31.m1.3.3.3.3.1.1.3" xref="S4.E31.m1.3.3.3.3.1.1.3.cmml">1</mn></mrow><mo id="S4.E31.m1.4.4.4.4.2.3" xref="S4.E31.m1.4.4.4.4.3a.cmml">,</mo><mrow id="S4.E31.m1.4.4.4.4.2.2" xref="S4.E31.m1.4.4.4.4.2.2.cmml"><msub id="S4.E31.m1.4.4.4.4.2.2.2" xref="S4.E31.m1.4.4.4.4.2.2.2.cmml"><mi id="S4.E31.m1.4.4.4.4.2.2.2.2" xref="S4.E31.m1.4.4.4.4.2.2.2.2.cmml">m</mi><mi id="S4.E31.m1.4.4.4.4.2.2.2.3" xref="S4.E31.m1.4.4.4.4.2.2.2.3.cmml">j</mi></msub><mo id="S4.E31.m1.4.4.4.4.2.2.1" xref="S4.E31.m1.4.4.4.4.2.2.1.cmml">=</mo><mn id="S4.E31.m1.4.4.4.4.2.2.3" xref="S4.E31.m1.4.4.4.4.2.2.3.cmml">0</mn></mrow></mrow></mrow></munder><mfrac id="S4.E31.m1.8.8" xref="S4.E31.m1.8.8.cmml"><mrow id="S4.E31.m1.7.7.3.3" xref="S4.E31.m1.7.7.3.4.cmml"><mi id="S4.E31.m1.5.5.1.1" xref="S4.E31.m1.5.5.1.1.cmml">max</mi><mo id="S4.E31.m1.7.7.3.3a" xref="S4.E31.m1.7.7.3.4.cmml">⁡</mo><mrow id="S4.E31.m1.7.7.3.3.1" xref="S4.E31.m1.7.7.3.4.cmml"><mo id="S4.E31.m1.7.7.3.3.1.2" stretchy="false" xref="S4.E31.m1.7.7.3.4.cmml">(</mo><mn id="S4.E31.m1.6.6.2.2" xref="S4.E31.m1.6.6.2.2.cmml">0</mn><mo id="S4.E31.m1.7.7.3.3.1.3" xref="S4.E31.m1.7.7.3.4.cmml">,</mo><mrow id="S4.E31.m1.7.7.3.3.1.1" xref="S4.E31.m1.7.7.3.3.1.1.cmml"><mn id="S4.E31.m1.7.7.3.3.1.1.3" xref="S4.E31.m1.7.7.3.3.1.1.3.cmml">1</mn><mo id="S4.E31.m1.7.7.3.3.1.1.2" xref="S4.E31.m1.7.7.3.3.1.1.2.cmml">−</mo><mrow id="S4.E31.m1.7.7.3.3.1.1.1.1" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.cmml"><mo id="S4.E31.m1.7.7.3.3.1.1.1.1.2" stretchy="false" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E31.m1.7.7.3.3.1.1.1.1.1" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.cmml"><msub id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.cmml"><mi id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.2" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.2.cmml">m</mi><mo id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.1" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.3" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E31.m1.7.7.3.3.1.1.1.1.1.1" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.cmml"><mi id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.2" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.2.cmml">m</mi><mo id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.1" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.3" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S4.E31.m1.7.7.3.3.1.1.1.1.3" stretchy="false" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E31.m1.7.7.3.3.1.4" stretchy="false" xref="S4.E31.m1.7.7.3.4.cmml">)</mo></mrow></mrow><mrow id="S4.E31.m1.8.8.4.3" xref="S4.E31.m1.8.8.4.2.cmml"><mo id="S4.E31.m1.8.8.4.3.1" stretchy="false" xref="S4.E31.m1.8.8.4.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E31.m1.8.8.4.1" xref="S4.E31.m1.8.8.4.1.cmml">ℳ</mi><mo id="S4.E31.m1.8.8.4.3.2" stretchy="false" xref="S4.E31.m1.8.8.4.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><mo id="S4.E31.m1.9.9.1.2" xref="S4.E31.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E31.m1.9b"><apply id="S4.E31.m1.9.9.1.1.cmml" xref="S4.E31.m1.9.9.1"><eq id="S4.E31.m1.9.9.1.1.1.cmml" xref="S4.E31.m1.9.9.1.1.1"></eq><apply id="S4.E31.m1.9.9.1.1.2.cmml" xref="S4.E31.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E31.m1.9.9.1.1.2.1.cmml" xref="S4.E31.m1.9.9.1.1.2">subscript</csymbol><ci id="S4.E31.m1.9.9.1.1.2.2.cmml" xref="S4.E31.m1.9.9.1.1.2.2">ℒ</ci><apply id="S4.E31.m1.9.9.1.1.2.3.cmml" xref="S4.E31.m1.9.9.1.1.2.3"><times id="S4.E31.m1.9.9.1.1.2.3.1.cmml" xref="S4.E31.m1.9.9.1.1.2.3.1"></times><ci id="S4.E31.m1.9.9.1.1.2.3.2.cmml" xref="S4.E31.m1.9.9.1.1.2.3.2">𝑚</ci><ci id="S4.E31.m1.9.9.1.1.2.3.3.cmml" xref="S4.E31.m1.9.9.1.1.2.3.3">𝑢</ci><ci id="S4.E31.m1.9.9.1.1.2.3.4.cmml" xref="S4.E31.m1.9.9.1.1.2.3.4">𝑙</ci><ci id="S4.E31.m1.9.9.1.1.2.3.5.cmml" xref="S4.E31.m1.9.9.1.1.2.3.5">𝑡</ci><ci id="S4.E31.m1.9.9.1.1.2.3.6.cmml" xref="S4.E31.m1.9.9.1.1.2.3.6">𝑖</ci></apply></apply><apply id="S4.E31.m1.9.9.1.1.3.cmml" xref="S4.E31.m1.9.9.1.1.3"><apply id="S4.E31.m1.9.9.1.1.3.1.cmml" xref="S4.E31.m1.9.9.1.1.3.1"><csymbol cd="ambiguous" id="S4.E31.m1.9.9.1.1.3.1.1.cmml" xref="S4.E31.m1.9.9.1.1.3.1">subscript</csymbol><sum id="S4.E31.m1.9.9.1.1.3.1.2.cmml" xref="S4.E31.m1.9.9.1.1.3.1.2"></sum><apply id="S4.E31.m1.4.4.4.cmml" xref="S4.E31.m1.4.4.4"><ci id="S4.E31.m1.4.4.4.5.cmml" xref="S4.E31.m1.4.4.4.5">:</ci><list id="S4.E31.m1.4.4.4.6.1.cmml" xref="S4.E31.m1.4.4.4.6.2"><ci id="S4.E31.m1.1.1.1.1.cmml" xref="S4.E31.m1.1.1.1.1">𝑖</ci><ci id="S4.E31.m1.2.2.2.2.cmml" xref="S4.E31.m1.2.2.2.2">𝑗</ci></list><apply id="S4.E31.m1.4.4.4.4.3.cmml" xref="S4.E31.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S4.E31.m1.4.4.4.4.3a.cmml" xref="S4.E31.m1.4.4.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E31.m1.3.3.3.3.1.1.cmml" xref="S4.E31.m1.3.3.3.3.1.1"><eq id="S4.E31.m1.3.3.3.3.1.1.1.cmml" xref="S4.E31.m1.3.3.3.3.1.1.1"></eq><apply id="S4.E31.m1.3.3.3.3.1.1.2.cmml" xref="S4.E31.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E31.m1.3.3.3.3.1.1.2.1.cmml" xref="S4.E31.m1.3.3.3.3.1.1.2">subscript</csymbol><ci id="S4.E31.m1.3.3.3.3.1.1.2.2.cmml" xref="S4.E31.m1.3.3.3.3.1.1.2.2">𝑚</ci><ci id="S4.E31.m1.3.3.3.3.1.1.2.3.cmml" xref="S4.E31.m1.3.3.3.3.1.1.2.3">𝑖</ci></apply><cn id="S4.E31.m1.3.3.3.3.1.1.3.cmml" type="integer" xref="S4.E31.m1.3.3.3.3.1.1.3">1</cn></apply><apply id="S4.E31.m1.4.4.4.4.2.2.cmml" xref="S4.E31.m1.4.4.4.4.2.2"><eq id="S4.E31.m1.4.4.4.4.2.2.1.cmml" xref="S4.E31.m1.4.4.4.4.2.2.1"></eq><apply id="S4.E31.m1.4.4.4.4.2.2.2.cmml" xref="S4.E31.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E31.m1.4.4.4.4.2.2.2.1.cmml" xref="S4.E31.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S4.E31.m1.4.4.4.4.2.2.2.2.cmml" xref="S4.E31.m1.4.4.4.4.2.2.2.2">𝑚</ci><ci id="S4.E31.m1.4.4.4.4.2.2.2.3.cmml" xref="S4.E31.m1.4.4.4.4.2.2.2.3">𝑗</ci></apply><cn id="S4.E31.m1.4.4.4.4.2.2.3.cmml" type="integer" xref="S4.E31.m1.4.4.4.4.2.2.3">0</cn></apply></apply></apply></apply><apply id="S4.E31.m1.8.8.cmml" xref="S4.E31.m1.8.8"><divide id="S4.E31.m1.8.8.5.cmml" xref="S4.E31.m1.8.8"></divide><apply id="S4.E31.m1.7.7.3.4.cmml" xref="S4.E31.m1.7.7.3.3"><max id="S4.E31.m1.5.5.1.1.cmml" xref="S4.E31.m1.5.5.1.1"></max><cn id="S4.E31.m1.6.6.2.2.cmml" type="integer" xref="S4.E31.m1.6.6.2.2">0</cn><apply id="S4.E31.m1.7.7.3.3.1.1.cmml" xref="S4.E31.m1.7.7.3.3.1.1"><minus id="S4.E31.m1.7.7.3.3.1.1.2.cmml" xref="S4.E31.m1.7.7.3.3.1.1.2"></minus><cn id="S4.E31.m1.7.7.3.3.1.1.3.cmml" type="integer" xref="S4.E31.m1.7.7.3.3.1.1.3">1</cn><apply id="S4.E31.m1.7.7.3.3.1.1.1.1.1.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1"><minus id="S4.E31.m1.7.7.3.3.1.1.1.1.1.1.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.1"></minus><apply id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2"><ci id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.1.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.1">^</ci><ci id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.2.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.2.2">𝑚</ci></apply><ci id="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2"><ci id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.1.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.1">^</ci><ci id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.2.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.2.2">𝑚</ci></apply><ci id="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.3.cmml" xref="S4.E31.m1.7.7.3.3.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E31.m1.8.8.4.2.cmml" xref="S4.E31.m1.8.8.4.3"><abs id="S4.E31.m1.8.8.4.2.1.cmml" xref="S4.E31.m1.8.8.4.3.1"></abs><ci id="S4.E31.m1.8.8.4.1.cmml" xref="S4.E31.m1.8.8.4.1">ℳ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E31.m1.9c">\displaystyle\mathcal{L}_{multi}=\sum_{i,j:{m_{i}}=1,{m_{j}}=0}\frac{\max(0,1-%
({\hat{m}_{i}}-{\hat{m}_{j}}))}{|\mathcal{M}|},</annotation><annotation encoding="application/x-llamapun" id="S4.E31.m1.9d">caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i , italic_j : italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 , italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT divide start_ARG roman_max ( 0 , 1 - ( over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) end_ARG start_ARG | caligraphic_M | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
<tbody id="S4.E32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}_{ddi}=\sum_{i=1}^{|\mathcal{M}|}\sum_{j=1}^{|\mathcal%
{M}|}\mathbf{M}^{ddi}_{ij}\cdot{\hat{m}_{i}}\cdot{\hat{m}_{j}}," class="ltx_Math" display="block" id="S4.E32.m1.3"><semantics id="S4.E32.m1.3a"><mrow id="S4.E32.m1.3.3.1" xref="S4.E32.m1.3.3.1.1.cmml"><mrow id="S4.E32.m1.3.3.1.1" xref="S4.E32.m1.3.3.1.1.cmml"><msub id="S4.E32.m1.3.3.1.1.2" xref="S4.E32.m1.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E32.m1.3.3.1.1.2.2" xref="S4.E32.m1.3.3.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E32.m1.3.3.1.1.2.3" xref="S4.E32.m1.3.3.1.1.2.3.cmml"><mi id="S4.E32.m1.3.3.1.1.2.3.2" xref="S4.E32.m1.3.3.1.1.2.3.2.cmml">d</mi><mo id="S4.E32.m1.3.3.1.1.2.3.1" xref="S4.E32.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E32.m1.3.3.1.1.2.3.3" xref="S4.E32.m1.3.3.1.1.2.3.3.cmml">d</mi><mo id="S4.E32.m1.3.3.1.1.2.3.1a" xref="S4.E32.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E32.m1.3.3.1.1.2.3.4" xref="S4.E32.m1.3.3.1.1.2.3.4.cmml">i</mi></mrow></msub><mo id="S4.E32.m1.3.3.1.1.1" rspace="0.111em" xref="S4.E32.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E32.m1.3.3.1.1.3" xref="S4.E32.m1.3.3.1.1.3.cmml"><munderover id="S4.E32.m1.3.3.1.1.3.1" xref="S4.E32.m1.3.3.1.1.3.1.cmml"><mo id="S4.E32.m1.3.3.1.1.3.1.2.2" movablelimits="false" rspace="0em" xref="S4.E32.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E32.m1.3.3.1.1.3.1.2.3" xref="S4.E32.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S4.E32.m1.3.3.1.1.3.1.2.3.2" xref="S4.E32.m1.3.3.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E32.m1.3.3.1.1.3.1.2.3.1" xref="S4.E32.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E32.m1.3.3.1.1.3.1.2.3.3" xref="S4.E32.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E32.m1.1.1.1.3" xref="S4.E32.m1.1.1.1.2.cmml"><mo id="S4.E32.m1.1.1.1.3.1" stretchy="false" xref="S4.E32.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E32.m1.1.1.1.1" xref="S4.E32.m1.1.1.1.1.cmml">ℳ</mi><mo id="S4.E32.m1.1.1.1.3.2" stretchy="false" xref="S4.E32.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E32.m1.3.3.1.1.3.2" xref="S4.E32.m1.3.3.1.1.3.2.cmml"><munderover id="S4.E32.m1.3.3.1.1.3.2.1" xref="S4.E32.m1.3.3.1.1.3.2.1.cmml"><mo id="S4.E32.m1.3.3.1.1.3.2.1.2.2" movablelimits="false" xref="S4.E32.m1.3.3.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E32.m1.3.3.1.1.3.2.1.2.3" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3.cmml"><mi id="S4.E32.m1.3.3.1.1.3.2.1.2.3.2" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="S4.E32.m1.3.3.1.1.3.2.1.2.3.1" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E32.m1.3.3.1.1.3.2.1.2.3.3" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E32.m1.2.2.1.3" xref="S4.E32.m1.2.2.1.2.cmml"><mo id="S4.E32.m1.2.2.1.3.1" stretchy="false" xref="S4.E32.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E32.m1.2.2.1.1" xref="S4.E32.m1.2.2.1.1.cmml">ℳ</mi><mo id="S4.E32.m1.2.2.1.3.2" stretchy="false" xref="S4.E32.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E32.m1.3.3.1.1.3.2.2" xref="S4.E32.m1.3.3.1.1.3.2.2.cmml"><msubsup id="S4.E32.m1.3.3.1.1.3.2.2.2" xref="S4.E32.m1.3.3.1.1.3.2.2.2.cmml"><mi id="S4.E32.m1.3.3.1.1.3.2.2.2.2.2" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.2.cmml">𝐌</mi><mrow id="S4.E32.m1.3.3.1.1.3.2.2.2.3" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3.cmml"><mi id="S4.E32.m1.3.3.1.1.3.2.2.2.3.2" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3.2.cmml">i</mi><mo id="S4.E32.m1.3.3.1.1.3.2.2.2.3.1" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E32.m1.3.3.1.1.3.2.2.2.3.3" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3.3.cmml">j</mi></mrow><mrow id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.cmml"><mi id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.2" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.2.cmml">d</mi><mo id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.1" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.3" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.3.cmml">d</mi><mo id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.1a" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.4" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.4.cmml">i</mi></mrow></msubsup><mo id="S4.E32.m1.3.3.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E32.m1.3.3.1.1.3.2.2.1.cmml">⋅</mo><msub id="S4.E32.m1.3.3.1.1.3.2.2.3" xref="S4.E32.m1.3.3.1.1.3.2.2.3.cmml"><mover accent="true" id="S4.E32.m1.3.3.1.1.3.2.2.3.2" xref="S4.E32.m1.3.3.1.1.3.2.2.3.2.cmml"><mi id="S4.E32.m1.3.3.1.1.3.2.2.3.2.2" xref="S4.E32.m1.3.3.1.1.3.2.2.3.2.2.cmml">m</mi><mo id="S4.E32.m1.3.3.1.1.3.2.2.3.2.1" xref="S4.E32.m1.3.3.1.1.3.2.2.3.2.1.cmml">^</mo></mover><mi id="S4.E32.m1.3.3.1.1.3.2.2.3.3" xref="S4.E32.m1.3.3.1.1.3.2.2.3.3.cmml">i</mi></msub><mo id="S4.E32.m1.3.3.1.1.3.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.E32.m1.3.3.1.1.3.2.2.1.cmml">⋅</mo><msub id="S4.E32.m1.3.3.1.1.3.2.2.4" xref="S4.E32.m1.3.3.1.1.3.2.2.4.cmml"><mover accent="true" id="S4.E32.m1.3.3.1.1.3.2.2.4.2" xref="S4.E32.m1.3.3.1.1.3.2.2.4.2.cmml"><mi id="S4.E32.m1.3.3.1.1.3.2.2.4.2.2" xref="S4.E32.m1.3.3.1.1.3.2.2.4.2.2.cmml">m</mi><mo id="S4.E32.m1.3.3.1.1.3.2.2.4.2.1" xref="S4.E32.m1.3.3.1.1.3.2.2.4.2.1.cmml">^</mo></mover><mi id="S4.E32.m1.3.3.1.1.3.2.2.4.3" xref="S4.E32.m1.3.3.1.1.3.2.2.4.3.cmml">j</mi></msub></mrow></mrow></mrow></mrow><mo id="S4.E32.m1.3.3.1.2" xref="S4.E32.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E32.m1.3b"><apply id="S4.E32.m1.3.3.1.1.cmml" xref="S4.E32.m1.3.3.1"><eq id="S4.E32.m1.3.3.1.1.1.cmml" xref="S4.E32.m1.3.3.1.1.1"></eq><apply id="S4.E32.m1.3.3.1.1.2.cmml" xref="S4.E32.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.2.1.cmml" xref="S4.E32.m1.3.3.1.1.2">subscript</csymbol><ci id="S4.E32.m1.3.3.1.1.2.2.cmml" xref="S4.E32.m1.3.3.1.1.2.2">ℒ</ci><apply id="S4.E32.m1.3.3.1.1.2.3.cmml" xref="S4.E32.m1.3.3.1.1.2.3"><times id="S4.E32.m1.3.3.1.1.2.3.1.cmml" xref="S4.E32.m1.3.3.1.1.2.3.1"></times><ci id="S4.E32.m1.3.3.1.1.2.3.2.cmml" xref="S4.E32.m1.3.3.1.1.2.3.2">𝑑</ci><ci id="S4.E32.m1.3.3.1.1.2.3.3.cmml" xref="S4.E32.m1.3.3.1.1.2.3.3">𝑑</ci><ci id="S4.E32.m1.3.3.1.1.2.3.4.cmml" xref="S4.E32.m1.3.3.1.1.2.3.4">𝑖</ci></apply></apply><apply id="S4.E32.m1.3.3.1.1.3.cmml" xref="S4.E32.m1.3.3.1.1.3"><apply id="S4.E32.m1.3.3.1.1.3.1.cmml" xref="S4.E32.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.1.1.cmml" xref="S4.E32.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S4.E32.m1.3.3.1.1.3.1.2.cmml" xref="S4.E32.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.1.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S4.E32.m1.3.3.1.1.3.1.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.1.2.2"></sum><apply id="S4.E32.m1.3.3.1.1.3.1.2.3.cmml" xref="S4.E32.m1.3.3.1.1.3.1.2.3"><eq id="S4.E32.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S4.E32.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S4.E32.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S4.E32.m1.3.3.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.E32.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E32.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S4.E32.m1.1.1.1.2.cmml" xref="S4.E32.m1.1.1.1.3"><abs id="S4.E32.m1.1.1.1.2.1.cmml" xref="S4.E32.m1.1.1.1.3.1"></abs><ci id="S4.E32.m1.1.1.1.1.cmml" xref="S4.E32.m1.1.1.1.1">ℳ</ci></apply></apply><apply id="S4.E32.m1.3.3.1.1.3.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2"><apply id="S4.E32.m1.3.3.1.1.3.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.2.1.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1">superscript</csymbol><apply id="S4.E32.m1.3.3.1.1.3.2.1.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.2.1.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1">subscript</csymbol><sum id="S4.E32.m1.3.3.1.1.3.2.1.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1.2.2"></sum><apply id="S4.E32.m1.3.3.1.1.3.2.1.2.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3"><eq id="S4.E32.m1.3.3.1.1.3.2.1.2.3.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3.1"></eq><ci id="S4.E32.m1.3.3.1.1.3.2.1.2.3.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3.2">𝑗</ci><cn id="S4.E32.m1.3.3.1.1.3.2.1.2.3.3.cmml" type="integer" xref="S4.E32.m1.3.3.1.1.3.2.1.2.3.3">1</cn></apply></apply><apply id="S4.E32.m1.2.2.1.2.cmml" xref="S4.E32.m1.2.2.1.3"><abs id="S4.E32.m1.2.2.1.2.1.cmml" xref="S4.E32.m1.2.2.1.3.1"></abs><ci id="S4.E32.m1.2.2.1.1.cmml" xref="S4.E32.m1.2.2.1.1">ℳ</ci></apply></apply><apply id="S4.E32.m1.3.3.1.1.3.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2"><ci id="S4.E32.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.1">⋅</ci><apply id="S4.E32.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2">subscript</csymbol><apply id="S4.E32.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.2.2.2.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2">superscript</csymbol><ci id="S4.E32.m1.3.3.1.1.3.2.2.2.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.2">𝐌</ci><apply id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3"><times id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.1"></times><ci id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.2">𝑑</ci><ci id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.3">𝑑</ci><ci id="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.4.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.2.3.4">𝑖</ci></apply></apply><apply id="S4.E32.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3"><times id="S4.E32.m1.3.3.1.1.3.2.2.2.3.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3.1"></times><ci id="S4.E32.m1.3.3.1.1.3.2.2.2.3.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3.2">𝑖</ci><ci id="S4.E32.m1.3.3.1.1.3.2.2.2.3.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.2.3.3">𝑗</ci></apply></apply><apply id="S4.E32.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.3">subscript</csymbol><apply id="S4.E32.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.3.2"><ci id="S4.E32.m1.3.3.1.1.3.2.2.3.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.3.2.1">^</ci><ci id="S4.E32.m1.3.3.1.1.3.2.2.3.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.3.2.2">𝑚</ci></apply><ci id="S4.E32.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.3.3">𝑖</ci></apply><apply id="S4.E32.m1.3.3.1.1.3.2.2.4.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.4"><csymbol cd="ambiguous" id="S4.E32.m1.3.3.1.1.3.2.2.4.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.4">subscript</csymbol><apply id="S4.E32.m1.3.3.1.1.3.2.2.4.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.4.2"><ci id="S4.E32.m1.3.3.1.1.3.2.2.4.2.1.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.4.2.1">^</ci><ci id="S4.E32.m1.3.3.1.1.3.2.2.4.2.2.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.4.2.2">𝑚</ci></apply><ci id="S4.E32.m1.3.3.1.1.3.2.2.4.3.cmml" xref="S4.E32.m1.3.3.1.1.3.2.2.4.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E32.m1.3c">\displaystyle\mathcal{L}_{ddi}=\sum_{i=1}^{|\mathcal{M}|}\sum_{j=1}^{|\mathcal%
{M}|}\mathbf{M}^{ddi}_{ij}\cdot{\hat{m}_{i}}\cdot{\hat{m}_{j}},</annotation><annotation encoding="application/x-llamapun" id="S4.E32.m1.3d">caligraphic_L start_POSTSUBSCRIPT italic_d italic_d italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_M | end_POSTSUPERSCRIPT bold_M start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ⋅ over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p1.7">where <math alttext="m_{i}" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m1.1"><semantics id="S4.SS4.p1.4.m1.1a"><msub id="S4.SS4.p1.4.m1.1.1" xref="S4.SS4.p1.4.m1.1.1.cmml"><mi id="S4.SS4.p1.4.m1.1.1.2" xref="S4.SS4.p1.4.m1.1.1.2.cmml">m</mi><mi id="S4.SS4.p1.4.m1.1.1.3" xref="S4.SS4.p1.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m1.1b"><apply id="S4.SS4.p1.4.m1.1.1.cmml" xref="S4.SS4.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m1.1.1.1.cmml" xref="S4.SS4.p1.4.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m1.1.1.2.cmml" xref="S4.SS4.p1.4.m1.1.1.2">𝑚</ci><ci id="S4.SS4.p1.4.m1.1.1.3.cmml" xref="S4.SS4.p1.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m1.1c">m_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m1.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the true value of the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m2.1"><semantics id="S4.SS4.p1.5.m2.1a"><mi id="S4.SS4.p1.5.m2.1.1" xref="S4.SS4.p1.5.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m2.1b"><ci id="S4.SS4.p1.5.m2.1.1.cmml" xref="S4.SS4.p1.5.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m2.1d">italic_i</annotation></semantics></math>th medication during the current visit, while <math alttext="\hat{m}_{i}" class="ltx_Math" display="inline" id="S4.SS4.p1.6.m3.1"><semantics id="S4.SS4.p1.6.m3.1a"><msub id="S4.SS4.p1.6.m3.1.1" xref="S4.SS4.p1.6.m3.1.1.cmml"><mover accent="true" id="S4.SS4.p1.6.m3.1.1.2" xref="S4.SS4.p1.6.m3.1.1.2.cmml"><mi id="S4.SS4.p1.6.m3.1.1.2.2" xref="S4.SS4.p1.6.m3.1.1.2.2.cmml">m</mi><mo id="S4.SS4.p1.6.m3.1.1.2.1" xref="S4.SS4.p1.6.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS4.p1.6.m3.1.1.3" xref="S4.SS4.p1.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m3.1b"><apply id="S4.SS4.p1.6.m3.1.1.cmml" xref="S4.SS4.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m3.1.1.1.cmml" xref="S4.SS4.p1.6.m3.1.1">subscript</csymbol><apply id="S4.SS4.p1.6.m3.1.1.2.cmml" xref="S4.SS4.p1.6.m3.1.1.2"><ci id="S4.SS4.p1.6.m3.1.1.2.1.cmml" xref="S4.SS4.p1.6.m3.1.1.2.1">^</ci><ci id="S4.SS4.p1.6.m3.1.1.2.2.cmml" xref="S4.SS4.p1.6.m3.1.1.2.2">𝑚</ci></apply><ci id="S4.SS4.p1.6.m3.1.1.3.cmml" xref="S4.SS4.p1.6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m3.1c">\hat{m}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.6.m3.1d">over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the model’s predicted value for the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.p1.7.m4.1"><semantics id="S4.SS4.p1.7.m4.1a"><mi id="S4.SS4.p1.7.m4.1.1" xref="S4.SS4.p1.7.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m4.1b"><ci id="S4.SS4.p1.7.m4.1.1.cmml" xref="S4.SS4.p1.7.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.7.m4.1d">italic_i</annotation></semantics></math>th medication, both of which are binary variables.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.6">Although DDI indicates the potential risk of drug combinations, considering medical practice, certain adverse reactions are acceptable. Pursuing the lowest DDI rate without considering efficacy does not lead to the best drug combination. Therefore, we must set a threshold for DDI; if this threshold is exceeded, the weight of DDI increases. When using the composite loss function, we adopt the same research methodology as before <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib9" title="">9</a>]</cite> to balance the accuracy and safety of the medication combinations.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx9">
<tbody id="S4.E33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathcal{L}=\alpha(\beta\mathcal{L}_{bce}+(1-\beta)\mathcal{L}_{%
multi})+(1-\alpha)\mathcal{L}_{ddi}," class="ltx_Math" display="block" id="S4.E33.m1.1"><semantics id="S4.E33.m1.1a"><mrow id="S4.E33.m1.1.1.1" xref="S4.E33.m1.1.1.1.1.cmml"><mrow id="S4.E33.m1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E33.m1.1.1.1.1.4" xref="S4.E33.m1.1.1.1.1.4.cmml">ℒ</mi><mo id="S4.E33.m1.1.1.1.1.3" xref="S4.E33.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E33.m1.1.1.1.1.2" xref="S4.E33.m1.1.1.1.1.2.cmml"><mrow id="S4.E33.m1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.cmml"><mi id="S4.E33.m1.1.1.1.1.1.1.3" xref="S4.E33.m1.1.1.1.1.1.1.3.cmml">α</mi><mo id="S4.E33.m1.1.1.1.1.1.1.2" xref="S4.E33.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">b</mi><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">c</mi><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.1a" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.4" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.4.cmml">e</mi></mrow></msub></mrow><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">u</mi><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1b" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml">t</mi><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1c" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.6" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.6.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S4.E33.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E33.m1.1.1.1.1.2.3" xref="S4.E33.m1.1.1.1.1.2.3.cmml">+</mo><mrow id="S4.E33.m1.1.1.1.1.2.2" xref="S4.E33.m1.1.1.1.1.2.2.cmml"><mrow id="S4.E33.m1.1.1.1.1.2.2.1.1" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S4.E33.m1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E33.m1.1.1.1.1.2.2.1.1.1" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.cmml"><mn id="S4.E33.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E33.m1.1.1.1.1.2.2.1.1.1.1" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><mi id="S4.E33.m1.1.1.1.1.2.2.1.1.1.3" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.3.cmml">α</mi></mrow><mo id="S4.E33.m1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E33.m1.1.1.1.1.2.2.2" xref="S4.E33.m1.1.1.1.1.2.2.2.cmml">⁢</mo><msub id="S4.E33.m1.1.1.1.1.2.2.3" xref="S4.E33.m1.1.1.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E33.m1.1.1.1.1.2.2.3.2" xref="S4.E33.m1.1.1.1.1.2.2.3.2.cmml">ℒ</mi><mrow id="S4.E33.m1.1.1.1.1.2.2.3.3" xref="S4.E33.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S4.E33.m1.1.1.1.1.2.2.3.3.2" xref="S4.E33.m1.1.1.1.1.2.2.3.3.2.cmml">d</mi><mo id="S4.E33.m1.1.1.1.1.2.2.3.3.1" xref="S4.E33.m1.1.1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.2.2.3.3.3" xref="S4.E33.m1.1.1.1.1.2.2.3.3.3.cmml">d</mi><mo id="S4.E33.m1.1.1.1.1.2.2.3.3.1a" xref="S4.E33.m1.1.1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E33.m1.1.1.1.1.2.2.3.3.4" xref="S4.E33.m1.1.1.1.1.2.2.3.3.4.cmml">i</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E33.m1.1.1.1.2" xref="S4.E33.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E33.m1.1b"><apply id="S4.E33.m1.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1"><eq id="S4.E33.m1.1.1.1.1.3.cmml" xref="S4.E33.m1.1.1.1.1.3"></eq><ci id="S4.E33.m1.1.1.1.1.4.cmml" xref="S4.E33.m1.1.1.1.1.4">ℒ</ci><apply id="S4.E33.m1.1.1.1.1.2.cmml" xref="S4.E33.m1.1.1.1.1.2"><plus id="S4.E33.m1.1.1.1.1.2.3.cmml" xref="S4.E33.m1.1.1.1.1.2.3"></plus><apply id="S4.E33.m1.1.1.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1"><times id="S4.E33.m1.1.1.1.1.1.1.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.2"></times><ci id="S4.E33.m1.1.1.1.1.1.1.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.3">𝛼</ci><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1"><plus id="S4.E33.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.2"></plus><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.2">ℒ</ci><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3"><times id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑏</ci><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑐</ci><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.4.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.3.3.3.4">𝑒</ci></apply></apply></apply><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑢</ci><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.5">𝑡</ci><ci id="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.6.cmml" xref="S4.E33.m1.1.1.1.1.1.1.1.1.1.1.3.3.6">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E33.m1.1.1.1.1.2.2.cmml" xref="S4.E33.m1.1.1.1.1.2.2"><times id="S4.E33.m1.1.1.1.1.2.2.2.cmml" xref="S4.E33.m1.1.1.1.1.2.2.2"></times><apply id="S4.E33.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.2.2.1.1"><minus id="S4.E33.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.1"></minus><cn id="S4.E33.m1.1.1.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.2">1</cn><ci id="S4.E33.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E33.m1.1.1.1.1.2.2.1.1.1.3">𝛼</ci></apply><apply id="S4.E33.m1.1.1.1.1.2.2.3.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E33.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E33.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3.2">ℒ</ci><apply id="S4.E33.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3.3"><times id="S4.E33.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3.3.1"></times><ci id="S4.E33.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3.3.2">𝑑</ci><ci id="S4.E33.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3.3.3">𝑑</ci><ci id="S4.E33.m1.1.1.1.1.2.2.3.3.4.cmml" xref="S4.E33.m1.1.1.1.1.2.2.3.3.4">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E33.m1.1c">\displaystyle\mathcal{L}=\alpha(\beta\mathcal{L}_{bce}+(1-\beta)\mathcal{L}_{%
multi})+(1-\alpha)\mathcal{L}_{ddi},</annotation><annotation encoding="application/x-llamapun" id="S4.E33.m1.1d">caligraphic_L = italic_α ( italic_β caligraphic_L start_POSTSUBSCRIPT italic_b italic_c italic_e end_POSTSUBSCRIPT + ( 1 - italic_β ) caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_α ) caligraphic_L start_POSTSUBSCRIPT italic_d italic_d italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td>
</tr></tbody>
<tbody id="S4.E34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\alpha=\begin{cases}1&amp;\rho&lt;\phi\\
\min\{1,\exp(\tau(1-\frac{\rho}{\phi}))\}&amp;\rho\geq\phi\end{cases}," class="ltx_Math" display="block" id="S4.E34.m1.5"><semantics id="S4.E34.m1.5a"><mrow id="S4.E34.m1.5.5.1" xref="S4.E34.m1.5.5.1.1.cmml"><mrow id="S4.E34.m1.5.5.1.1" xref="S4.E34.m1.5.5.1.1.cmml"><mi id="S4.E34.m1.5.5.1.1.2" xref="S4.E34.m1.5.5.1.1.2.cmml">α</mi><mo id="S4.E34.m1.5.5.1.1.1" xref="S4.E34.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E34.m1.4.4" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mo id="S4.E34.m1.4.4.5" xref="S4.E34.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E34.m1.4.4.4" rowspacing="0pt" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mtr id="S4.E34.m1.4.4.4a" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E34.m1.4.4.4b" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mn id="S4.E34.m1.1.1.1.1.1.1" xref="S4.E34.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E34.m1.4.4.4c" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E34.m1.2.2.2.2.2.1" xref="S4.E34.m1.2.2.2.2.2.1.cmml"><mi id="S4.E34.m1.2.2.2.2.2.1.2" xref="S4.E34.m1.2.2.2.2.2.1.2.cmml">ρ</mi><mo id="S4.E34.m1.2.2.2.2.2.1.1" xref="S4.E34.m1.2.2.2.2.2.1.1.cmml">&lt;</mo><mi id="S4.E34.m1.2.2.2.2.2.1.3" xref="S4.E34.m1.2.2.2.2.2.1.3.cmml">ϕ</mi></mrow></mtd></mtr><mtr id="S4.E34.m1.4.4.4d" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E34.m1.4.4.4e" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E34.m1.3.3.3.3.1.1.4" xref="S4.E34.m1.3.3.3.3.1.1.5.cmml"><mi id="S4.E34.m1.3.3.3.3.1.1.2" xref="S4.E34.m1.3.3.3.3.1.1.2.cmml">min</mi><mo id="S4.E34.m1.3.3.3.3.1.1.4a" xref="S4.E34.m1.3.3.3.3.1.1.5.cmml">⁡</mo><mrow id="S4.E34.m1.3.3.3.3.1.1.4.1" xref="S4.E34.m1.3.3.3.3.1.1.5.cmml"><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.2" stretchy="false" xref="S4.E34.m1.3.3.3.3.1.1.5.cmml">{</mo><mn id="S4.E34.m1.3.3.3.3.1.1.3" xref="S4.E34.m1.3.3.3.3.1.1.3.cmml">1</mn><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.3" xref="S4.E34.m1.3.3.3.3.1.1.5.cmml">,</mo><mrow id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.2.cmml"><mi id="S4.E34.m1.3.3.3.3.1.1.1" xref="S4.E34.m1.3.3.3.3.1.1.1.cmml">exp</mi><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1a" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.2.cmml">⁡</mo><mrow id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.2.cmml"><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.2" stretchy="false" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.2.cmml">(</mo><mrow id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.cmml"><mi id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.3" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.3.cmml">τ</mi><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.2" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.2" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.1" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="false" id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3a" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.2" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.2.cmml">ρ</mi><mi id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.3" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></mfrac></mstyle></mrow><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.3" stretchy="false" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E34.m1.3.3.3.3.1.1.4.1.4" stretchy="false" xref="S4.E34.m1.3.3.3.3.1.1.5.cmml">}</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E34.m1.4.4.4f" xref="S4.E34.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E34.m1.4.4.4.4.2.1" xref="S4.E34.m1.4.4.4.4.2.1.cmml"><mi id="S4.E34.m1.4.4.4.4.2.1.2" xref="S4.E34.m1.4.4.4.4.2.1.2.cmml">ρ</mi><mo id="S4.E34.m1.4.4.4.4.2.1.1" xref="S4.E34.m1.4.4.4.4.2.1.1.cmml">≥</mo><mi id="S4.E34.m1.4.4.4.4.2.1.3" xref="S4.E34.m1.4.4.4.4.2.1.3.cmml">ϕ</mi></mrow></mtd></mtr></mtable></mrow></mrow><mo id="S4.E34.m1.5.5.1.2" xref="S4.E34.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E34.m1.5b"><apply id="S4.E34.m1.5.5.1.1.cmml" xref="S4.E34.m1.5.5.1"><eq id="S4.E34.m1.5.5.1.1.1.cmml" xref="S4.E34.m1.5.5.1.1.1"></eq><ci id="S4.E34.m1.5.5.1.1.2.cmml" xref="S4.E34.m1.5.5.1.1.2">𝛼</ci><apply id="S4.E34.m1.5.5.1.1.3.1.cmml" xref="S4.E34.m1.4.4"><csymbol cd="latexml" id="S4.E34.m1.5.5.1.1.3.1.1.cmml" xref="S4.E34.m1.4.4.5">cases</csymbol><cn id="S4.E34.m1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E34.m1.1.1.1.1.1.1">1</cn><apply id="S4.E34.m1.2.2.2.2.2.1.cmml" xref="S4.E34.m1.2.2.2.2.2.1"><lt id="S4.E34.m1.2.2.2.2.2.1.1.cmml" xref="S4.E34.m1.2.2.2.2.2.1.1"></lt><ci id="S4.E34.m1.2.2.2.2.2.1.2.cmml" xref="S4.E34.m1.2.2.2.2.2.1.2">𝜌</ci><ci id="S4.E34.m1.2.2.2.2.2.1.3.cmml" xref="S4.E34.m1.2.2.2.2.2.1.3">italic-ϕ</ci></apply><apply id="S4.E34.m1.3.3.3.3.1.1.5.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4"><min id="S4.E34.m1.3.3.3.3.1.1.2.cmml" xref="S4.E34.m1.3.3.3.3.1.1.2"></min><cn id="S4.E34.m1.3.3.3.3.1.1.3.cmml" type="integer" xref="S4.E34.m1.3.3.3.3.1.1.3">1</cn><apply id="S4.E34.m1.3.3.3.3.1.1.4.1.1.2.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1"><exp id="S4.E34.m1.3.3.3.3.1.1.1.cmml" xref="S4.E34.m1.3.3.3.3.1.1.1"></exp><apply id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1"><times id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.2.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.2"></times><ci id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.3.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.3">𝜏</ci><apply id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1"><minus id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.1"></minus><cn id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3"><divide id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3"></divide><ci id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.2">𝜌</ci><ci id="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E34.m1.3.3.3.3.1.1.4.1.1.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply></apply></apply></apply></apply><apply id="S4.E34.m1.4.4.4.4.2.1.cmml" xref="S4.E34.m1.4.4.4.4.2.1"><geq id="S4.E34.m1.4.4.4.4.2.1.1.cmml" xref="S4.E34.m1.4.4.4.4.2.1.1"></geq><ci id="S4.E34.m1.4.4.4.4.2.1.2.cmml" xref="S4.E34.m1.4.4.4.4.2.1.2">𝜌</ci><ci id="S4.E34.m1.4.4.4.4.2.1.3.cmml" xref="S4.E34.m1.4.4.4.4.2.1.3">italic-ϕ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E34.m1.5c">\displaystyle\alpha=\begin{cases}1&amp;\rho&lt;\phi\\
\min\{1,\exp(\tau(1-\frac{\rho}{\phi}))\}&amp;\rho\geq\phi\end{cases},</annotation><annotation encoding="application/x-llamapun" id="S4.E34.m1.5d">italic_α = { start_ROW start_CELL 1 end_CELL start_CELL italic_ρ &lt; italic_ϕ end_CELL end_ROW start_ROW start_CELL roman_min { 1 , roman_exp ( italic_τ ( 1 - divide start_ARG italic_ρ end_ARG start_ARG italic_ϕ end_ARG ) ) } end_CELL start_CELL italic_ρ ≥ italic_ϕ end_CELL end_ROW ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p2.5">where <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_β</annotation></semantics></math> is hyperparameters, and the controllable factor <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_α</annotation></semantics></math> is relative to DDI rate, <math alttext="\phi\in(0,1)" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.2"><semantics id="S4.SS4.p2.3.m3.2a"><mrow id="S4.SS4.p2.3.m3.2.3" xref="S4.SS4.p2.3.m3.2.3.cmml"><mi id="S4.SS4.p2.3.m3.2.3.2" xref="S4.SS4.p2.3.m3.2.3.2.cmml">ϕ</mi><mo id="S4.SS4.p2.3.m3.2.3.1" xref="S4.SS4.p2.3.m3.2.3.1.cmml">∈</mo><mrow id="S4.SS4.p2.3.m3.2.3.3.2" xref="S4.SS4.p2.3.m3.2.3.3.1.cmml"><mo id="S4.SS4.p2.3.m3.2.3.3.2.1" stretchy="false" xref="S4.SS4.p2.3.m3.2.3.3.1.cmml">(</mo><mn id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">0</mn><mo id="S4.SS4.p2.3.m3.2.3.3.2.2" xref="S4.SS4.p2.3.m3.2.3.3.1.cmml">,</mo><mn id="S4.SS4.p2.3.m3.2.2" xref="S4.SS4.p2.3.m3.2.2.cmml">1</mn><mo id="S4.SS4.p2.3.m3.2.3.3.2.3" stretchy="false" xref="S4.SS4.p2.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.2b"><apply id="S4.SS4.p2.3.m3.2.3.cmml" xref="S4.SS4.p2.3.m3.2.3"><in id="S4.SS4.p2.3.m3.2.3.1.cmml" xref="S4.SS4.p2.3.m3.2.3.1"></in><ci id="S4.SS4.p2.3.m3.2.3.2.cmml" xref="S4.SS4.p2.3.m3.2.3.2">italic-ϕ</ci><interval closure="open" id="S4.SS4.p2.3.m3.2.3.3.1.cmml" xref="S4.SS4.p2.3.m3.2.3.3.2"><cn id="S4.SS4.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS4.p2.3.m3.1.1">0</cn><cn id="S4.SS4.p2.3.m3.2.2.cmml" type="integer" xref="S4.SS4.p2.3.m3.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.2c">\phi\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.2d">italic_ϕ ∈ ( 0 , 1 )</annotation></semantics></math> is a DDI acceptance rate, <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m4.1"><semantics id="S4.SS4.p2.4.m4.1a"><mi id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><ci id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m4.1d">italic_ρ</annotation></semantics></math> is the current DDI rate and <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS4.p2.5.m5.1"><semantics id="S4.SS4.p2.5.m5.1a"><mi id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><ci id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.5.m5.1d">italic_τ</annotation></semantics></math> is a hyper-parameter.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This section primarily introduces the experimental setup, including model configurations and parameter selections, as well as evaluation metrics. Additionally, it presents a series of comparison results between the baseline models and our model.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Setup Protocol</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">First, we provide a detailed description of the experimental setup, including the environmental configuration, parameter selection, basic model configuration, and sampling methods used during the testing phase.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Experimental Environment</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">The experiments are carried out on an Ubuntu 22.04 system equipped with 30GB of memory, 12 CPUs, and a 24GB NVIDIA RTX3090 GPU, utilizing PyTorch 2.0.0 and CUDA 11.7.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Configuration and Parameter</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.8">For the embedding matrices of entities <math alttext="E_{d}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><msub id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS2.p1.1.m1.1.1.2" xref="S5.SS1.SSS2.p1.1.m1.1.1.2.cmml">E</mi><mi id="S5.SS1.SSS2.p1.1.m1.1.1.3" xref="S5.SS1.SSS2.p1.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><apply id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1.2">𝐸</ci><ci id="S5.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">E_{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.1.m1.1d">italic_E start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="E_{p}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.p1.2.m2.1a"><msub id="S5.SS1.SSS2.p1.2.m2.1.1" xref="S5.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS2.p1.2.m2.1.1.2" xref="S5.SS1.SSS2.p1.2.m2.1.1.2.cmml">E</mi><mi id="S5.SS1.SSS2.p1.2.m2.1.1.3" xref="S5.SS1.SSS2.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.2.m2.1b"><apply id="S5.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1.2">𝐸</ci><ci id="S5.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.2.m2.1c">E_{p}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.2.m2.1d">italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="E_{m}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.3.m3.1"><semantics id="S5.SS1.SSS2.p1.3.m3.1a"><msub id="S5.SS1.SSS2.p1.3.m3.1.1" xref="S5.SS1.SSS2.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS2.p1.3.m3.1.1.2" xref="S5.SS1.SSS2.p1.3.m3.1.1.2.cmml">E</mi><mi id="S5.SS1.SSS2.p1.3.m3.1.1.3" xref="S5.SS1.SSS2.p1.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.3.m3.1b"><apply id="S5.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.SSS2.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1.2">𝐸</ci><ci id="S5.SS1.SSS2.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS2.p1.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.3.m3.1c">E_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, we use <math alttext="\text{dim}=128" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.4.m4.1"><semantics id="S5.SS1.SSS2.p1.4.m4.1a"><mrow id="S5.SS1.SSS2.p1.4.m4.1.1" xref="S5.SS1.SSS2.p1.4.m4.1.1.cmml"><mtext id="S5.SS1.SSS2.p1.4.m4.1.1.2" xref="S5.SS1.SSS2.p1.4.m4.1.1.2a.cmml">dim</mtext><mo id="S5.SS1.SSS2.p1.4.m4.1.1.1" xref="S5.SS1.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.p1.4.m4.1.1.3" xref="S5.SS1.SSS2.p1.4.m4.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.4.m4.1b"><apply id="S5.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS2.p1.4.m4.1.1"><eq id="S5.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS2.p1.4.m4.1.1.1"></eq><ci id="S5.SS1.SSS2.p1.4.m4.1.1.2a.cmml" xref="S5.SS1.SSS2.p1.4.m4.1.1.2"><mtext id="S5.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS2.p1.4.m4.1.1.2">dim</mtext></ci><cn id="S5.SS1.SSS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S5.SS1.SSS2.p1.4.m4.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.4.m4.1c">\text{dim}=128</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.4.m4.1d">dim = 128</annotation></semantics></math> as the embedding size, initialized between -0.1 and 0.1. For the molecular GNN, we use a 4-layer GIN with a hidden size of 128. For each molecular graph, the initial 9-dimensional node features include atom count, chirality, and other additional atomic features. The 3-dimensional edge features include bond type, bond stereochemistry, and conjugated bonds. The molecular 3D features include molecular conformations, 3D coordinates, RBF distances, and normalized interatomic vectors. We also use a 3-layer GVP, where the hidden dimensions for node feature scalars and vectors are 128 and 64, respectively, and the hidden dimensions for edge feature scalars and vectors are 32 and 1, respectively. For the GRU, we use the same number of hidden units as the number of drugs. For the loss functions, we set the thresholds <math alttext="\delta=0.5" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.5.m5.1"><semantics id="S5.SS1.SSS2.p1.5.m5.1a"><mrow id="S5.SS1.SSS2.p1.5.m5.1.1" xref="S5.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S5.SS1.SSS2.p1.5.m5.1.1.2" xref="S5.SS1.SSS2.p1.5.m5.1.1.2.cmml">δ</mi><mo id="S5.SS1.SSS2.p1.5.m5.1.1.1" xref="S5.SS1.SSS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.p1.5.m5.1.1.3" xref="S5.SS1.SSS2.p1.5.m5.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.5.m5.1b"><apply id="S5.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS2.p1.5.m5.1.1"><eq id="S5.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S5.SS1.SSS2.p1.5.m5.1.1.1"></eq><ci id="S5.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S5.SS1.SSS2.p1.5.m5.1.1.2">𝛿</ci><cn id="S5.SS1.SSS2.p1.5.m5.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.p1.5.m5.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.5.m5.1c">\delta=0.5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.5.m5.1d">italic_δ = 0.5</annotation></semantics></math>, <math alttext="\tau=2.5" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.6.m6.1"><semantics id="S5.SS1.SSS2.p1.6.m6.1a"><mrow id="S5.SS1.SSS2.p1.6.m6.1.1" xref="S5.SS1.SSS2.p1.6.m6.1.1.cmml"><mi id="S5.SS1.SSS2.p1.6.m6.1.1.2" xref="S5.SS1.SSS2.p1.6.m6.1.1.2.cmml">τ</mi><mo id="S5.SS1.SSS2.p1.6.m6.1.1.1" xref="S5.SS1.SSS2.p1.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.p1.6.m6.1.1.3" xref="S5.SS1.SSS2.p1.6.m6.1.1.3.cmml">2.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.6.m6.1b"><apply id="S5.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S5.SS1.SSS2.p1.6.m6.1.1"><eq id="S5.SS1.SSS2.p1.6.m6.1.1.1.cmml" xref="S5.SS1.SSS2.p1.6.m6.1.1.1"></eq><ci id="S5.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="S5.SS1.SSS2.p1.6.m6.1.1.2">𝜏</ci><cn id="S5.SS1.SSS2.p1.6.m6.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.p1.6.m6.1.1.3">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.6.m6.1c">\tau=2.5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.6.m6.1d">italic_τ = 2.5</annotation></semantics></math>, <math alttext="\beta=0.95" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.7.m7.1"><semantics id="S5.SS1.SSS2.p1.7.m7.1a"><mrow id="S5.SS1.SSS2.p1.7.m7.1.1" xref="S5.SS1.SSS2.p1.7.m7.1.1.cmml"><mi id="S5.SS1.SSS2.p1.7.m7.1.1.2" xref="S5.SS1.SSS2.p1.7.m7.1.1.2.cmml">β</mi><mo id="S5.SS1.SSS2.p1.7.m7.1.1.1" xref="S5.SS1.SSS2.p1.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.p1.7.m7.1.1.3" xref="S5.SS1.SSS2.p1.7.m7.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.7.m7.1b"><apply id="S5.SS1.SSS2.p1.7.m7.1.1.cmml" xref="S5.SS1.SSS2.p1.7.m7.1.1"><eq id="S5.SS1.SSS2.p1.7.m7.1.1.1.cmml" xref="S5.SS1.SSS2.p1.7.m7.1.1.1"></eq><ci id="S5.SS1.SSS2.p1.7.m7.1.1.2.cmml" xref="S5.SS1.SSS2.p1.7.m7.1.1.2">𝛽</ci><cn id="S5.SS1.SSS2.p1.7.m7.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.p1.7.m7.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.7.m7.1c">\beta=0.95</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.7.m7.1d">italic_β = 0.95</annotation></semantics></math>, and <math alttext="\phi=0.06" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.8.m8.1"><semantics id="S5.SS1.SSS2.p1.8.m8.1a"><mrow id="S5.SS1.SSS2.p1.8.m8.1.1" xref="S5.SS1.SSS2.p1.8.m8.1.1.cmml"><mi id="S5.SS1.SSS2.p1.8.m8.1.1.2" xref="S5.SS1.SSS2.p1.8.m8.1.1.2.cmml">ϕ</mi><mo id="S5.SS1.SSS2.p1.8.m8.1.1.1" xref="S5.SS1.SSS2.p1.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.p1.8.m8.1.1.3" xref="S5.SS1.SSS2.p1.8.m8.1.1.3.cmml">0.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.8.m8.1b"><apply id="S5.SS1.SSS2.p1.8.m8.1.1.cmml" xref="S5.SS1.SSS2.p1.8.m8.1.1"><eq id="S5.SS1.SSS2.p1.8.m8.1.1.1.cmml" xref="S5.SS1.SSS2.p1.8.m8.1.1.1"></eq><ci id="S5.SS1.SSS2.p1.8.m8.1.1.2.cmml" xref="S5.SS1.SSS2.p1.8.m8.1.1.2">italic-ϕ</ci><cn id="S5.SS1.SSS2.p1.8.m8.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.p1.8.m8.1.1.3">0.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.8.m8.1c">\phi=0.06</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.8.m8.1d">italic_ϕ = 0.06</annotation></semantics></math>. We train for 300 epochs during the pretraining stage and 20 epochs during the training stage.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Sampling Approach</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">Given the limited availability of publicly accessible EHR data, we employ bootstrapping sampling during this phase, following the methodology suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib42" title="">42</a>]</cite>. As discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib28" title="">28</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib8" title="">8</a>]</cite>, this technique proves particularly effective in scenarios with small sample sizes.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Datasets</h3>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.T1.3.2" style="font-size:90%;">Statistics of the datasets.</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S5.T1.4">
<tr class="ltx_tr" id="S5.T1.4.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" id="S5.T1.4.1.1">Item</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T1.4.1.2">MIMIC-III</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T1.4.1.3">MIMIC-IV</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.4.2.1"># patients</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.4.2.2">6,350</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.4.2.3">60,125</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T1.4.3.1"># clinical events</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.3.2">15,032</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.3.3">156,810</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T1.4.4.1"># diseases</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.4.2">1,958</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.4.3">2,000</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T1.4.5.1"># procedures</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.5.2">1,430</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.5.3">1,500</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.6">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T1.4.6.1"># medications</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.6.2">131</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.6.3">131</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T1.4.7.1">avg. # of visits</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.7.2">2.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.4.7.3">2.61</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.8">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_r" id="S5.T1.4.8.1">avg. # of medications</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T1.4.8.2">11.44</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T1.4.8.3">6.66</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We use the MIMIC-III <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib15" title="">15</a>]</cite> and MIMIC-IV <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib14" title="">14</a>]</cite> datasets, which are derived from clinical data in the intensive care unit (ICU). These datasets include clinical records, physiological measurements, laboratory monitoring data, and medication records of ICU patients. We adopt the same data processing methods as previous studies. The detailed statistics of the processed datasets are shown in the table <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.T1" title="Table 1 ‣ 5.2 Datasets ‣ 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">We obtain the molecular SDF files from the PubChem database <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib17" title="">17</a>]</cite>, and the 3D data for substructures is completed using functions from the RDKit library.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We use four primary metrics, Jaccard, DDI rate, F1, and PRAUC, to evaluate the performance of our method. The specific application of each metric in our study is explained below.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.7"><span class="ltx_text ltx_font_bold" id="S5.SS3.p2.7.1">Jaccard</span> (Jaccard similarity score) measures the similarity between two sets by dividing the size of their intersection by the size of their union. In medication recommendation, a higher Jaccard score indicates greater consistency between the predicted drug combination and the actual medication, reflecting higher accuracy.
</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx10">
<tbody id="S5.E35"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle Jaccard(t)=\frac{|\{i:\hat{m}_{i}(t)=1\}|\cap|\{i:{m}_{i}(t)=1\}%
|}{|\{i:\hat{m}_{i}(t)=1\}|\cup|\{i:{m}_{i}(t)=1\}|}," class="ltx_Math" display="block" id="S5.E35.m1.14"><semantics id="S5.E35.m1.14a"><mrow id="S5.E35.m1.14.14.1" xref="S5.E35.m1.14.14.1.1.cmml"><mrow id="S5.E35.m1.14.14.1.1" xref="S5.E35.m1.14.14.1.1.cmml"><mrow id="S5.E35.m1.14.14.1.1.2" xref="S5.E35.m1.14.14.1.1.2.cmml"><mi id="S5.E35.m1.14.14.1.1.2.2" xref="S5.E35.m1.14.14.1.1.2.2.cmml">J</mi><mo id="S5.E35.m1.14.14.1.1.2.1" xref="S5.E35.m1.14.14.1.1.2.1.cmml">⁢</mo><mi id="S5.E35.m1.14.14.1.1.2.3" xref="S5.E35.m1.14.14.1.1.2.3.cmml">a</mi><mo id="S5.E35.m1.14.14.1.1.2.1a" xref="S5.E35.m1.14.14.1.1.2.1.cmml">⁢</mo><mi id="S5.E35.m1.14.14.1.1.2.4" xref="S5.E35.m1.14.14.1.1.2.4.cmml">c</mi><mo id="S5.E35.m1.14.14.1.1.2.1b" xref="S5.E35.m1.14.14.1.1.2.1.cmml">⁢</mo><mi id="S5.E35.m1.14.14.1.1.2.5" xref="S5.E35.m1.14.14.1.1.2.5.cmml">c</mi><mo id="S5.E35.m1.14.14.1.1.2.1c" xref="S5.E35.m1.14.14.1.1.2.1.cmml">⁢</mo><mi id="S5.E35.m1.14.14.1.1.2.6" xref="S5.E35.m1.14.14.1.1.2.6.cmml">a</mi><mo id="S5.E35.m1.14.14.1.1.2.1d" xref="S5.E35.m1.14.14.1.1.2.1.cmml">⁢</mo><mi id="S5.E35.m1.14.14.1.1.2.7" xref="S5.E35.m1.14.14.1.1.2.7.cmml">r</mi><mo id="S5.E35.m1.14.14.1.1.2.1e" xref="S5.E35.m1.14.14.1.1.2.1.cmml">⁢</mo><mi id="S5.E35.m1.14.14.1.1.2.8" xref="S5.E35.m1.14.14.1.1.2.8.cmml">d</mi><mo id="S5.E35.m1.14.14.1.1.2.1f" xref="S5.E35.m1.14.14.1.1.2.1.cmml">⁢</mo><mrow id="S5.E35.m1.14.14.1.1.2.9.2" xref="S5.E35.m1.14.14.1.1.2.cmml"><mo id="S5.E35.m1.14.14.1.1.2.9.2.1" stretchy="false" xref="S5.E35.m1.14.14.1.1.2.cmml">(</mo><mi id="S5.E35.m1.13.13" xref="S5.E35.m1.13.13.cmml">t</mi><mo id="S5.E35.m1.14.14.1.1.2.9.2.2" stretchy="false" xref="S5.E35.m1.14.14.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E35.m1.14.14.1.1.1" xref="S5.E35.m1.14.14.1.1.1.cmml">=</mo><mfrac id="S5.E35.m1.12.12" xref="S5.E35.m1.12.12.cmml"><mrow id="S5.E35.m1.6.6.6" xref="S5.E35.m1.6.6.6.cmml"><mrow id="S5.E35.m1.5.5.5.5.1" xref="S5.E35.m1.5.5.5.5.2.cmml"><mo id="S5.E35.m1.5.5.5.5.1.2" stretchy="false" xref="S5.E35.m1.5.5.5.5.2.1.cmml">|</mo><mrow id="S5.E35.m1.5.5.5.5.1.1.1" xref="S5.E35.m1.5.5.5.5.1.1.2.cmml"><mo id="S5.E35.m1.5.5.5.5.1.1.1.2" stretchy="false" xref="S5.E35.m1.5.5.5.5.1.1.2.1.cmml">{</mo><mi id="S5.E35.m1.2.2.2.2" xref="S5.E35.m1.2.2.2.2.cmml">i</mi><mo id="S5.E35.m1.5.5.5.5.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E35.m1.5.5.5.5.1.1.2.1.cmml">:</mo><mrow id="S5.E35.m1.5.5.5.5.1.1.1.1" xref="S5.E35.m1.5.5.5.5.1.1.1.1.cmml"><mrow id="S5.E35.m1.5.5.5.5.1.1.1.1.2" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.cmml"><msub id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.cmml"><mover accent="true" id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.cmml"><mi id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.2" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.2.cmml">m</mi><mo id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.1" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.3" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S5.E35.m1.5.5.5.5.1.1.1.1.2.1" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S5.E35.m1.5.5.5.5.1.1.1.1.2.3.2" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.cmml"><mo id="S5.E35.m1.5.5.5.5.1.1.1.1.2.3.2.1" stretchy="false" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.cmml">(</mo><mi id="S5.E35.m1.1.1.1.1" xref="S5.E35.m1.1.1.1.1.cmml">t</mi><mo id="S5.E35.m1.5.5.5.5.1.1.1.1.2.3.2.2" stretchy="false" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E35.m1.5.5.5.5.1.1.1.1.1" xref="S5.E35.m1.5.5.5.5.1.1.1.1.1.cmml">=</mo><mn id="S5.E35.m1.5.5.5.5.1.1.1.1.3" xref="S5.E35.m1.5.5.5.5.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E35.m1.5.5.5.5.1.1.1.4" stretchy="false" xref="S5.E35.m1.5.5.5.5.1.1.2.1.cmml">}</mo></mrow><mo id="S5.E35.m1.5.5.5.5.1.3" stretchy="false" xref="S5.E35.m1.5.5.5.5.2.1.cmml">|</mo></mrow><mo id="S5.E35.m1.6.6.6.7" xref="S5.E35.m1.6.6.6.7.cmml">∩</mo><mrow id="S5.E35.m1.6.6.6.6.1" xref="S5.E35.m1.6.6.6.6.2.cmml"><mo id="S5.E35.m1.6.6.6.6.1.2" stretchy="false" xref="S5.E35.m1.6.6.6.6.2.1.cmml">|</mo><mrow id="S5.E35.m1.6.6.6.6.1.1.1" xref="S5.E35.m1.6.6.6.6.1.1.2.cmml"><mo id="S5.E35.m1.6.6.6.6.1.1.1.2" stretchy="false" xref="S5.E35.m1.6.6.6.6.1.1.2.1.cmml">{</mo><mi id="S5.E35.m1.4.4.4.4" xref="S5.E35.m1.4.4.4.4.cmml">i</mi><mo id="S5.E35.m1.6.6.6.6.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E35.m1.6.6.6.6.1.1.2.1.cmml">:</mo><mrow id="S5.E35.m1.6.6.6.6.1.1.1.1" xref="S5.E35.m1.6.6.6.6.1.1.1.1.cmml"><mrow id="S5.E35.m1.6.6.6.6.1.1.1.1.2" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.cmml"><msub id="S5.E35.m1.6.6.6.6.1.1.1.1.2.2" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.cmml"><mi id="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.2" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.2.cmml">m</mi><mi id="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.3" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S5.E35.m1.6.6.6.6.1.1.1.1.2.1" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S5.E35.m1.6.6.6.6.1.1.1.1.2.3.2" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.cmml"><mo id="S5.E35.m1.6.6.6.6.1.1.1.1.2.3.2.1" stretchy="false" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.cmml">(</mo><mi id="S5.E35.m1.3.3.3.3" xref="S5.E35.m1.3.3.3.3.cmml">t</mi><mo id="S5.E35.m1.6.6.6.6.1.1.1.1.2.3.2.2" stretchy="false" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E35.m1.6.6.6.6.1.1.1.1.1" xref="S5.E35.m1.6.6.6.6.1.1.1.1.1.cmml">=</mo><mn id="S5.E35.m1.6.6.6.6.1.1.1.1.3" xref="S5.E35.m1.6.6.6.6.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E35.m1.6.6.6.6.1.1.1.4" stretchy="false" xref="S5.E35.m1.6.6.6.6.1.1.2.1.cmml">}</mo></mrow><mo id="S5.E35.m1.6.6.6.6.1.3" stretchy="false" xref="S5.E35.m1.6.6.6.6.2.1.cmml">|</mo></mrow></mrow><mrow id="S5.E35.m1.12.12.12" xref="S5.E35.m1.12.12.12.cmml"><mrow id="S5.E35.m1.11.11.11.5.1" xref="S5.E35.m1.11.11.11.5.2.cmml"><mo id="S5.E35.m1.11.11.11.5.1.2" stretchy="false" xref="S5.E35.m1.11.11.11.5.2.1.cmml">|</mo><mrow id="S5.E35.m1.11.11.11.5.1.1.1" xref="S5.E35.m1.11.11.11.5.1.1.2.cmml"><mo id="S5.E35.m1.11.11.11.5.1.1.1.2" stretchy="false" xref="S5.E35.m1.11.11.11.5.1.1.2.1.cmml">{</mo><mi id="S5.E35.m1.8.8.8.2" xref="S5.E35.m1.8.8.8.2.cmml">i</mi><mo id="S5.E35.m1.11.11.11.5.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E35.m1.11.11.11.5.1.1.2.1.cmml">:</mo><mrow id="S5.E35.m1.11.11.11.5.1.1.1.1" xref="S5.E35.m1.11.11.11.5.1.1.1.1.cmml"><mrow id="S5.E35.m1.11.11.11.5.1.1.1.1.2" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.cmml"><msub id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.cmml"><mover accent="true" id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.cmml"><mi id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.2" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.2.cmml">m</mi><mo id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.1" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.3" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S5.E35.m1.11.11.11.5.1.1.1.1.2.1" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S5.E35.m1.11.11.11.5.1.1.1.1.2.3.2" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.cmml"><mo id="S5.E35.m1.11.11.11.5.1.1.1.1.2.3.2.1" stretchy="false" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.cmml">(</mo><mi id="S5.E35.m1.7.7.7.1" xref="S5.E35.m1.7.7.7.1.cmml">t</mi><mo id="S5.E35.m1.11.11.11.5.1.1.1.1.2.3.2.2" stretchy="false" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E35.m1.11.11.11.5.1.1.1.1.1" xref="S5.E35.m1.11.11.11.5.1.1.1.1.1.cmml">=</mo><mn id="S5.E35.m1.11.11.11.5.1.1.1.1.3" xref="S5.E35.m1.11.11.11.5.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E35.m1.11.11.11.5.1.1.1.4" stretchy="false" xref="S5.E35.m1.11.11.11.5.1.1.2.1.cmml">}</mo></mrow><mo id="S5.E35.m1.11.11.11.5.1.3" stretchy="false" xref="S5.E35.m1.11.11.11.5.2.1.cmml">|</mo></mrow><mo id="S5.E35.m1.12.12.12.7" xref="S5.E35.m1.12.12.12.7.cmml">∪</mo><mrow id="S5.E35.m1.12.12.12.6.1" xref="S5.E35.m1.12.12.12.6.2.cmml"><mo id="S5.E35.m1.12.12.12.6.1.2" stretchy="false" xref="S5.E35.m1.12.12.12.6.2.1.cmml">|</mo><mrow id="S5.E35.m1.12.12.12.6.1.1.1" xref="S5.E35.m1.12.12.12.6.1.1.2.cmml"><mo id="S5.E35.m1.12.12.12.6.1.1.1.2" stretchy="false" xref="S5.E35.m1.12.12.12.6.1.1.2.1.cmml">{</mo><mi id="S5.E35.m1.10.10.10.4" xref="S5.E35.m1.10.10.10.4.cmml">i</mi><mo id="S5.E35.m1.12.12.12.6.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E35.m1.12.12.12.6.1.1.2.1.cmml">:</mo><mrow id="S5.E35.m1.12.12.12.6.1.1.1.1" xref="S5.E35.m1.12.12.12.6.1.1.1.1.cmml"><mrow id="S5.E35.m1.12.12.12.6.1.1.1.1.2" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.cmml"><msub id="S5.E35.m1.12.12.12.6.1.1.1.1.2.2" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.cmml"><mi id="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.2" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.2.cmml">m</mi><mi id="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.3" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S5.E35.m1.12.12.12.6.1.1.1.1.2.1" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S5.E35.m1.12.12.12.6.1.1.1.1.2.3.2" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.cmml"><mo id="S5.E35.m1.12.12.12.6.1.1.1.1.2.3.2.1" stretchy="false" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.cmml">(</mo><mi id="S5.E35.m1.9.9.9.3" xref="S5.E35.m1.9.9.9.3.cmml">t</mi><mo id="S5.E35.m1.12.12.12.6.1.1.1.1.2.3.2.2" stretchy="false" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E35.m1.12.12.12.6.1.1.1.1.1" xref="S5.E35.m1.12.12.12.6.1.1.1.1.1.cmml">=</mo><mn id="S5.E35.m1.12.12.12.6.1.1.1.1.3" xref="S5.E35.m1.12.12.12.6.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E35.m1.12.12.12.6.1.1.1.4" stretchy="false" xref="S5.E35.m1.12.12.12.6.1.1.2.1.cmml">}</mo></mrow><mo id="S5.E35.m1.12.12.12.6.1.3" stretchy="false" xref="S5.E35.m1.12.12.12.6.2.1.cmml">|</mo></mrow></mrow></mfrac></mrow><mo id="S5.E35.m1.14.14.1.2" xref="S5.E35.m1.14.14.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E35.m1.14b"><apply id="S5.E35.m1.14.14.1.1.cmml" xref="S5.E35.m1.14.14.1"><eq id="S5.E35.m1.14.14.1.1.1.cmml" xref="S5.E35.m1.14.14.1.1.1"></eq><apply id="S5.E35.m1.14.14.1.1.2.cmml" xref="S5.E35.m1.14.14.1.1.2"><times id="S5.E35.m1.14.14.1.1.2.1.cmml" xref="S5.E35.m1.14.14.1.1.2.1"></times><ci id="S5.E35.m1.14.14.1.1.2.2.cmml" xref="S5.E35.m1.14.14.1.1.2.2">𝐽</ci><ci id="S5.E35.m1.14.14.1.1.2.3.cmml" xref="S5.E35.m1.14.14.1.1.2.3">𝑎</ci><ci id="S5.E35.m1.14.14.1.1.2.4.cmml" xref="S5.E35.m1.14.14.1.1.2.4">𝑐</ci><ci id="S5.E35.m1.14.14.1.1.2.5.cmml" xref="S5.E35.m1.14.14.1.1.2.5">𝑐</ci><ci id="S5.E35.m1.14.14.1.1.2.6.cmml" xref="S5.E35.m1.14.14.1.1.2.6">𝑎</ci><ci id="S5.E35.m1.14.14.1.1.2.7.cmml" xref="S5.E35.m1.14.14.1.1.2.7">𝑟</ci><ci id="S5.E35.m1.14.14.1.1.2.8.cmml" xref="S5.E35.m1.14.14.1.1.2.8">𝑑</ci><ci id="S5.E35.m1.13.13.cmml" xref="S5.E35.m1.13.13">𝑡</ci></apply><apply id="S5.E35.m1.12.12.cmml" xref="S5.E35.m1.12.12"><divide id="S5.E35.m1.12.12.13.cmml" xref="S5.E35.m1.12.12"></divide><apply id="S5.E35.m1.6.6.6.cmml" xref="S5.E35.m1.6.6.6"><intersect id="S5.E35.m1.6.6.6.7.cmml" xref="S5.E35.m1.6.6.6.7"></intersect><apply id="S5.E35.m1.5.5.5.5.2.cmml" xref="S5.E35.m1.5.5.5.5.1"><abs id="S5.E35.m1.5.5.5.5.2.1.cmml" xref="S5.E35.m1.5.5.5.5.1.2"></abs><apply id="S5.E35.m1.5.5.5.5.1.1.2.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1"><csymbol cd="latexml" id="S5.E35.m1.5.5.5.5.1.1.2.1.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.2">conditional-set</csymbol><ci id="S5.E35.m1.2.2.2.2.cmml" xref="S5.E35.m1.2.2.2.2">𝑖</ci><apply id="S5.E35.m1.5.5.5.5.1.1.1.1.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1"><eq id="S5.E35.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.1"></eq><apply id="S5.E35.m1.5.5.5.5.1.1.1.1.2.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2"><times id="S5.E35.m1.5.5.5.5.1.1.1.1.2.1.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.1"></times><apply id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.1.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2">subscript</csymbol><apply id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2"><ci id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.1.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.1">^</ci><ci id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.2.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.2.2">𝑚</ci></apply><ci id="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.3.cmml" xref="S5.E35.m1.5.5.5.5.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S5.E35.m1.1.1.1.1.cmml" xref="S5.E35.m1.1.1.1.1">𝑡</ci></apply><cn id="S5.E35.m1.5.5.5.5.1.1.1.1.3.cmml" type="integer" xref="S5.E35.m1.5.5.5.5.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S5.E35.m1.6.6.6.6.2.cmml" xref="S5.E35.m1.6.6.6.6.1"><abs id="S5.E35.m1.6.6.6.6.2.1.cmml" xref="S5.E35.m1.6.6.6.6.1.2"></abs><apply id="S5.E35.m1.6.6.6.6.1.1.2.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1"><csymbol cd="latexml" id="S5.E35.m1.6.6.6.6.1.1.2.1.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.2">conditional-set</csymbol><ci id="S5.E35.m1.4.4.4.4.cmml" xref="S5.E35.m1.4.4.4.4">𝑖</ci><apply id="S5.E35.m1.6.6.6.6.1.1.1.1.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1"><eq id="S5.E35.m1.6.6.6.6.1.1.1.1.1.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1.1"></eq><apply id="S5.E35.m1.6.6.6.6.1.1.1.1.2.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2"><times id="S5.E35.m1.6.6.6.6.1.1.1.1.2.1.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.1"></times><apply id="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.1.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.2">subscript</csymbol><ci id="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.2.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.2">𝑚</ci><ci id="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.3.cmml" xref="S5.E35.m1.6.6.6.6.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S5.E35.m1.3.3.3.3.cmml" xref="S5.E35.m1.3.3.3.3">𝑡</ci></apply><cn id="S5.E35.m1.6.6.6.6.1.1.1.1.3.cmml" type="integer" xref="S5.E35.m1.6.6.6.6.1.1.1.1.3">1</cn></apply></apply></apply></apply><apply id="S5.E35.m1.12.12.12.cmml" xref="S5.E35.m1.12.12.12"><union id="S5.E35.m1.12.12.12.7.cmml" xref="S5.E35.m1.12.12.12.7"></union><apply id="S5.E35.m1.11.11.11.5.2.cmml" xref="S5.E35.m1.11.11.11.5.1"><abs id="S5.E35.m1.11.11.11.5.2.1.cmml" xref="S5.E35.m1.11.11.11.5.1.2"></abs><apply id="S5.E35.m1.11.11.11.5.1.1.2.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1"><csymbol cd="latexml" id="S5.E35.m1.11.11.11.5.1.1.2.1.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.2">conditional-set</csymbol><ci id="S5.E35.m1.8.8.8.2.cmml" xref="S5.E35.m1.8.8.8.2">𝑖</ci><apply id="S5.E35.m1.11.11.11.5.1.1.1.1.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1"><eq id="S5.E35.m1.11.11.11.5.1.1.1.1.1.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.1"></eq><apply id="S5.E35.m1.11.11.11.5.1.1.1.1.2.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2"><times id="S5.E35.m1.11.11.11.5.1.1.1.1.2.1.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.1"></times><apply id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.1.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2">subscript</csymbol><apply id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2"><ci id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.1.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.1">^</ci><ci id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.2.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.2.2">𝑚</ci></apply><ci id="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.3.cmml" xref="S5.E35.m1.11.11.11.5.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S5.E35.m1.7.7.7.1.cmml" xref="S5.E35.m1.7.7.7.1">𝑡</ci></apply><cn id="S5.E35.m1.11.11.11.5.1.1.1.1.3.cmml" type="integer" xref="S5.E35.m1.11.11.11.5.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S5.E35.m1.12.12.12.6.2.cmml" xref="S5.E35.m1.12.12.12.6.1"><abs id="S5.E35.m1.12.12.12.6.2.1.cmml" xref="S5.E35.m1.12.12.12.6.1.2"></abs><apply id="S5.E35.m1.12.12.12.6.1.1.2.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1"><csymbol cd="latexml" id="S5.E35.m1.12.12.12.6.1.1.2.1.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.2">conditional-set</csymbol><ci id="S5.E35.m1.10.10.10.4.cmml" xref="S5.E35.m1.10.10.10.4">𝑖</ci><apply id="S5.E35.m1.12.12.12.6.1.1.1.1.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1"><eq id="S5.E35.m1.12.12.12.6.1.1.1.1.1.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1.1"></eq><apply id="S5.E35.m1.12.12.12.6.1.1.1.1.2.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2"><times id="S5.E35.m1.12.12.12.6.1.1.1.1.2.1.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.1"></times><apply id="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.1.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.2">subscript</csymbol><ci id="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.2.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.2">𝑚</ci><ci id="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.3.cmml" xref="S5.E35.m1.12.12.12.6.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S5.E35.m1.9.9.9.3.cmml" xref="S5.E35.m1.9.9.9.3">𝑡</ci></apply><cn id="S5.E35.m1.12.12.12.6.1.1.1.1.3.cmml" type="integer" xref="S5.E35.m1.12.12.12.6.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E35.m1.14c">\displaystyle Jaccard(t)=\frac{|\{i:\hat{m}_{i}(t)=1\}|\cap|\{i:{m}_{i}(t)=1\}%
|}{|\{i:\hat{m}_{i}(t)=1\}|\cup|\{i:{m}_{i}(t)=1\}|},</annotation><annotation encoding="application/x-llamapun" id="S5.E35.m1.14d">italic_J italic_a italic_c italic_c italic_a italic_r italic_d ( italic_t ) = divide start_ARG | { italic_i : over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t ) = 1 } | ∩ | { italic_i : italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t ) = 1 } | end_ARG start_ARG | { italic_i : over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t ) = 1 } | ∪ | { italic_i : italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t ) = 1 } | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(35)</span></td>
</tr></tbody>
<tbody id="S5.E36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle Jaccard=\frac{1}{N_{h}}\sum_{t=1}^{N_{h}}Jaccard(t)," class="ltx_Math" display="block" id="S5.E36.m1.2"><semantics id="S5.E36.m1.2a"><mrow id="S5.E36.m1.2.2.1" xref="S5.E36.m1.2.2.1.1.cmml"><mrow id="S5.E36.m1.2.2.1.1" xref="S5.E36.m1.2.2.1.1.cmml"><mrow id="S5.E36.m1.2.2.1.1.2" xref="S5.E36.m1.2.2.1.1.2.cmml"><mi id="S5.E36.m1.2.2.1.1.2.2" xref="S5.E36.m1.2.2.1.1.2.2.cmml">J</mi><mo id="S5.E36.m1.2.2.1.1.2.1" xref="S5.E36.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.2.3" xref="S5.E36.m1.2.2.1.1.2.3.cmml">a</mi><mo id="S5.E36.m1.2.2.1.1.2.1a" xref="S5.E36.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.2.4" xref="S5.E36.m1.2.2.1.1.2.4.cmml">c</mi><mo id="S5.E36.m1.2.2.1.1.2.1b" xref="S5.E36.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.2.5" xref="S5.E36.m1.2.2.1.1.2.5.cmml">c</mi><mo id="S5.E36.m1.2.2.1.1.2.1c" xref="S5.E36.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.2.6" xref="S5.E36.m1.2.2.1.1.2.6.cmml">a</mi><mo id="S5.E36.m1.2.2.1.1.2.1d" xref="S5.E36.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.2.7" xref="S5.E36.m1.2.2.1.1.2.7.cmml">r</mi><mo id="S5.E36.m1.2.2.1.1.2.1e" xref="S5.E36.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.2.8" xref="S5.E36.m1.2.2.1.1.2.8.cmml">d</mi></mrow><mo id="S5.E36.m1.2.2.1.1.1" xref="S5.E36.m1.2.2.1.1.1.cmml">=</mo><mrow id="S5.E36.m1.2.2.1.1.3" xref="S5.E36.m1.2.2.1.1.3.cmml"><mfrac id="S5.E36.m1.2.2.1.1.3.2" xref="S5.E36.m1.2.2.1.1.3.2.cmml"><mn id="S5.E36.m1.2.2.1.1.3.2.2" xref="S5.E36.m1.2.2.1.1.3.2.2.cmml">1</mn><msub id="S5.E36.m1.2.2.1.1.3.2.3" xref="S5.E36.m1.2.2.1.1.3.2.3.cmml"><mi id="S5.E36.m1.2.2.1.1.3.2.3.2" xref="S5.E36.m1.2.2.1.1.3.2.3.2.cmml">N</mi><mi id="S5.E36.m1.2.2.1.1.3.2.3.3" xref="S5.E36.m1.2.2.1.1.3.2.3.3.cmml">h</mi></msub></mfrac><mo id="S5.E36.m1.2.2.1.1.3.1" xref="S5.E36.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S5.E36.m1.2.2.1.1.3.3" xref="S5.E36.m1.2.2.1.1.3.3.cmml"><munderover id="S5.E36.m1.2.2.1.1.3.3.1" xref="S5.E36.m1.2.2.1.1.3.3.1.cmml"><mo id="S5.E36.m1.2.2.1.1.3.3.1.2.2" movablelimits="false" xref="S5.E36.m1.2.2.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S5.E36.m1.2.2.1.1.3.3.1.2.3" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3.cmml"><mi id="S5.E36.m1.2.2.1.1.3.3.1.2.3.2" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="S5.E36.m1.2.2.1.1.3.3.1.2.3.1" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S5.E36.m1.2.2.1.1.3.3.1.2.3.3" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S5.E36.m1.2.2.1.1.3.3.1.3" xref="S5.E36.m1.2.2.1.1.3.3.1.3.cmml"><mi id="S5.E36.m1.2.2.1.1.3.3.1.3.2" xref="S5.E36.m1.2.2.1.1.3.3.1.3.2.cmml">N</mi><mi id="S5.E36.m1.2.2.1.1.3.3.1.3.3" xref="S5.E36.m1.2.2.1.1.3.3.1.3.3.cmml">h</mi></msub></munderover><mrow id="S5.E36.m1.2.2.1.1.3.3.2" xref="S5.E36.m1.2.2.1.1.3.3.2.cmml"><mi id="S5.E36.m1.2.2.1.1.3.3.2.2" xref="S5.E36.m1.2.2.1.1.3.3.2.2.cmml">J</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.1" xref="S5.E36.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.3.3.2.3" xref="S5.E36.m1.2.2.1.1.3.3.2.3.cmml">a</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.1a" xref="S5.E36.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.3.3.2.4" xref="S5.E36.m1.2.2.1.1.3.3.2.4.cmml">c</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.1b" xref="S5.E36.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.3.3.2.5" xref="S5.E36.m1.2.2.1.1.3.3.2.5.cmml">c</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.1c" xref="S5.E36.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.3.3.2.6" xref="S5.E36.m1.2.2.1.1.3.3.2.6.cmml">a</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.1d" xref="S5.E36.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.3.3.2.7" xref="S5.E36.m1.2.2.1.1.3.3.2.7.cmml">r</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.1e" xref="S5.E36.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E36.m1.2.2.1.1.3.3.2.8" xref="S5.E36.m1.2.2.1.1.3.3.2.8.cmml">d</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.1f" xref="S5.E36.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mrow id="S5.E36.m1.2.2.1.1.3.3.2.9.2" xref="S5.E36.m1.2.2.1.1.3.3.2.cmml"><mo id="S5.E36.m1.2.2.1.1.3.3.2.9.2.1" stretchy="false" xref="S5.E36.m1.2.2.1.1.3.3.2.cmml">(</mo><mi id="S5.E36.m1.1.1" xref="S5.E36.m1.1.1.cmml">t</mi><mo id="S5.E36.m1.2.2.1.1.3.3.2.9.2.2" stretchy="false" xref="S5.E36.m1.2.2.1.1.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S5.E36.m1.2.2.1.2" xref="S5.E36.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E36.m1.2b"><apply id="S5.E36.m1.2.2.1.1.cmml" xref="S5.E36.m1.2.2.1"><eq id="S5.E36.m1.2.2.1.1.1.cmml" xref="S5.E36.m1.2.2.1.1.1"></eq><apply id="S5.E36.m1.2.2.1.1.2.cmml" xref="S5.E36.m1.2.2.1.1.2"><times id="S5.E36.m1.2.2.1.1.2.1.cmml" xref="S5.E36.m1.2.2.1.1.2.1"></times><ci id="S5.E36.m1.2.2.1.1.2.2.cmml" xref="S5.E36.m1.2.2.1.1.2.2">𝐽</ci><ci id="S5.E36.m1.2.2.1.1.2.3.cmml" xref="S5.E36.m1.2.2.1.1.2.3">𝑎</ci><ci id="S5.E36.m1.2.2.1.1.2.4.cmml" xref="S5.E36.m1.2.2.1.1.2.4">𝑐</ci><ci id="S5.E36.m1.2.2.1.1.2.5.cmml" xref="S5.E36.m1.2.2.1.1.2.5">𝑐</ci><ci id="S5.E36.m1.2.2.1.1.2.6.cmml" xref="S5.E36.m1.2.2.1.1.2.6">𝑎</ci><ci id="S5.E36.m1.2.2.1.1.2.7.cmml" xref="S5.E36.m1.2.2.1.1.2.7">𝑟</ci><ci id="S5.E36.m1.2.2.1.1.2.8.cmml" xref="S5.E36.m1.2.2.1.1.2.8">𝑑</ci></apply><apply id="S5.E36.m1.2.2.1.1.3.cmml" xref="S5.E36.m1.2.2.1.1.3"><times id="S5.E36.m1.2.2.1.1.3.1.cmml" xref="S5.E36.m1.2.2.1.1.3.1"></times><apply id="S5.E36.m1.2.2.1.1.3.2.cmml" xref="S5.E36.m1.2.2.1.1.3.2"><divide id="S5.E36.m1.2.2.1.1.3.2.1.cmml" xref="S5.E36.m1.2.2.1.1.3.2"></divide><cn id="S5.E36.m1.2.2.1.1.3.2.2.cmml" type="integer" xref="S5.E36.m1.2.2.1.1.3.2.2">1</cn><apply id="S5.E36.m1.2.2.1.1.3.2.3.cmml" xref="S5.E36.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E36.m1.2.2.1.1.3.2.3.1.cmml" xref="S5.E36.m1.2.2.1.1.3.2.3">subscript</csymbol><ci id="S5.E36.m1.2.2.1.1.3.2.3.2.cmml" xref="S5.E36.m1.2.2.1.1.3.2.3.2">𝑁</ci><ci id="S5.E36.m1.2.2.1.1.3.2.3.3.cmml" xref="S5.E36.m1.2.2.1.1.3.2.3.3">ℎ</ci></apply></apply><apply id="S5.E36.m1.2.2.1.1.3.3.cmml" xref="S5.E36.m1.2.2.1.1.3.3"><apply id="S5.E36.m1.2.2.1.1.3.3.1.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E36.m1.2.2.1.1.3.3.1.1.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1">superscript</csymbol><apply id="S5.E36.m1.2.2.1.1.3.3.1.2.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E36.m1.2.2.1.1.3.3.1.2.1.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1">subscript</csymbol><sum id="S5.E36.m1.2.2.1.1.3.3.1.2.2.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.2.2"></sum><apply id="S5.E36.m1.2.2.1.1.3.3.1.2.3.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3"><eq id="S5.E36.m1.2.2.1.1.3.3.1.2.3.1.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3.1"></eq><ci id="S5.E36.m1.2.2.1.1.3.3.1.2.3.2.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3.2">𝑡</ci><cn id="S5.E36.m1.2.2.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S5.E36.m1.2.2.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S5.E36.m1.2.2.1.1.3.3.1.3.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S5.E36.m1.2.2.1.1.3.3.1.3.1.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.3">subscript</csymbol><ci id="S5.E36.m1.2.2.1.1.3.3.1.3.2.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.3.2">𝑁</ci><ci id="S5.E36.m1.2.2.1.1.3.3.1.3.3.cmml" xref="S5.E36.m1.2.2.1.1.3.3.1.3.3">ℎ</ci></apply></apply><apply id="S5.E36.m1.2.2.1.1.3.3.2.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2"><times id="S5.E36.m1.2.2.1.1.3.3.2.1.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.1"></times><ci id="S5.E36.m1.2.2.1.1.3.3.2.2.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.2">𝐽</ci><ci id="S5.E36.m1.2.2.1.1.3.3.2.3.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.3">𝑎</ci><ci id="S5.E36.m1.2.2.1.1.3.3.2.4.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.4">𝑐</ci><ci id="S5.E36.m1.2.2.1.1.3.3.2.5.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.5">𝑐</ci><ci id="S5.E36.m1.2.2.1.1.3.3.2.6.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.6">𝑎</ci><ci id="S5.E36.m1.2.2.1.1.3.3.2.7.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.7">𝑟</ci><ci id="S5.E36.m1.2.2.1.1.3.3.2.8.cmml" xref="S5.E36.m1.2.2.1.1.3.3.2.8">𝑑</ci><ci id="S5.E36.m1.1.1.cmml" xref="S5.E36.m1.1.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E36.m1.2c">\displaystyle Jaccard=\frac{1}{N_{h}}\sum_{t=1}^{N_{h}}Jaccard(t),</annotation><annotation encoding="application/x-llamapun" id="S5.E36.m1.2d">italic_J italic_a italic_c italic_c italic_a italic_r italic_d = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_J italic_a italic_c italic_c italic_a italic_r italic_d ( italic_t ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(36)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.p2.6">where <math alttext="\hat{m}_{i}(t)" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.2" xref="S5.SS3.p2.1.m1.1.2.cmml"><msub id="S5.SS3.p2.1.m1.1.2.2" xref="S5.SS3.p2.1.m1.1.2.2.cmml"><mover accent="true" id="S5.SS3.p2.1.m1.1.2.2.2" xref="S5.SS3.p2.1.m1.1.2.2.2.cmml"><mi id="S5.SS3.p2.1.m1.1.2.2.2.2" xref="S5.SS3.p2.1.m1.1.2.2.2.2.cmml">m</mi><mo id="S5.SS3.p2.1.m1.1.2.2.2.1" xref="S5.SS3.p2.1.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="S5.SS3.p2.1.m1.1.2.2.3" xref="S5.SS3.p2.1.m1.1.2.2.3.cmml">i</mi></msub><mo id="S5.SS3.p2.1.m1.1.2.1" xref="S5.SS3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p2.1.m1.1.2.3.2" xref="S5.SS3.p2.1.m1.1.2.cmml"><mo id="S5.SS3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S5.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">t</mi><mo id="S5.SS3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S5.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.2"><times id="S5.SS3.p2.1.m1.1.2.1.cmml" xref="S5.SS3.p2.1.m1.1.2.1"></times><apply id="S5.SS3.p2.1.m1.1.2.2.cmml" xref="S5.SS3.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.2.2.1.cmml" xref="S5.SS3.p2.1.m1.1.2.2">subscript</csymbol><apply id="S5.SS3.p2.1.m1.1.2.2.2.cmml" xref="S5.SS3.p2.1.m1.1.2.2.2"><ci id="S5.SS3.p2.1.m1.1.2.2.2.1.cmml" xref="S5.SS3.p2.1.m1.1.2.2.2.1">^</ci><ci id="S5.SS3.p2.1.m1.1.2.2.2.2.cmml" xref="S5.SS3.p2.1.m1.1.2.2.2.2">𝑚</ci></apply><ci id="S5.SS3.p2.1.m1.1.2.2.3.cmml" xref="S5.SS3.p2.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\hat{m}_{i}(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> represents the multi-hot vector of the predicted outcome, <math alttext="m_{i}" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><msub id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">m</mi><mi id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">𝑚</ci><ci id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">m_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the real label, <math alttext="Jaccard(t)" class="ltx_Math" display="inline" id="S5.SS3.p2.3.m3.1"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.2" xref="S5.SS3.p2.3.m3.1.2.cmml"><mi id="S5.SS3.p2.3.m3.1.2.2" xref="S5.SS3.p2.3.m3.1.2.2.cmml">J</mi><mo id="S5.SS3.p2.3.m3.1.2.1" xref="S5.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p2.3.m3.1.2.3" xref="S5.SS3.p2.3.m3.1.2.3.cmml">a</mi><mo id="S5.SS3.p2.3.m3.1.2.1a" xref="S5.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p2.3.m3.1.2.4" xref="S5.SS3.p2.3.m3.1.2.4.cmml">c</mi><mo id="S5.SS3.p2.3.m3.1.2.1b" xref="S5.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p2.3.m3.1.2.5" xref="S5.SS3.p2.3.m3.1.2.5.cmml">c</mi><mo id="S5.SS3.p2.3.m3.1.2.1c" xref="S5.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p2.3.m3.1.2.6" xref="S5.SS3.p2.3.m3.1.2.6.cmml">a</mi><mo id="S5.SS3.p2.3.m3.1.2.1d" xref="S5.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p2.3.m3.1.2.7" xref="S5.SS3.p2.3.m3.1.2.7.cmml">r</mi><mo id="S5.SS3.p2.3.m3.1.2.1e" xref="S5.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p2.3.m3.1.2.8" xref="S5.SS3.p2.3.m3.1.2.8.cmml">d</mi><mo id="S5.SS3.p2.3.m3.1.2.1f" xref="S5.SS3.p2.3.m3.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p2.3.m3.1.2.9.2" xref="S5.SS3.p2.3.m3.1.2.cmml"><mo id="S5.SS3.p2.3.m3.1.2.9.2.1" stretchy="false" xref="S5.SS3.p2.3.m3.1.2.cmml">(</mo><mi id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml">t</mi><mo id="S5.SS3.p2.3.m3.1.2.9.2.2" stretchy="false" xref="S5.SS3.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.2.cmml" xref="S5.SS3.p2.3.m3.1.2"><times id="S5.SS3.p2.3.m3.1.2.1.cmml" xref="S5.SS3.p2.3.m3.1.2.1"></times><ci id="S5.SS3.p2.3.m3.1.2.2.cmml" xref="S5.SS3.p2.3.m3.1.2.2">𝐽</ci><ci id="S5.SS3.p2.3.m3.1.2.3.cmml" xref="S5.SS3.p2.3.m3.1.2.3">𝑎</ci><ci id="S5.SS3.p2.3.m3.1.2.4.cmml" xref="S5.SS3.p2.3.m3.1.2.4">𝑐</ci><ci id="S5.SS3.p2.3.m3.1.2.5.cmml" xref="S5.SS3.p2.3.m3.1.2.5">𝑐</ci><ci id="S5.SS3.p2.3.m3.1.2.6.cmml" xref="S5.SS3.p2.3.m3.1.2.6">𝑎</ci><ci id="S5.SS3.p2.3.m3.1.2.7.cmml" xref="S5.SS3.p2.3.m3.1.2.7">𝑟</ci><ci id="S5.SS3.p2.3.m3.1.2.8.cmml" xref="S5.SS3.p2.3.m3.1.2.8">𝑑</ci><ci id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">Jaccard(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.3.m3.1d">italic_J italic_a italic_c italic_c italic_a italic_r italic_d ( italic_t )</annotation></semantics></math> represents the evaluation result at visit <math alttext="t" class="ltx_Math" display="inline" id="S5.SS3.p2.4.m4.1"><semantics id="S5.SS3.p2.4.m4.1a"><mi id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><ci id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.4.m4.1d">italic_t</annotation></semantics></math>, and <math alttext="N_{h}" class="ltx_Math" display="inline" id="S5.SS3.p2.5.m5.1"><semantics id="S5.SS3.p2.5.m5.1a"><msub id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml"><mi id="S5.SS3.p2.5.m5.1.1.2" xref="S5.SS3.p2.5.m5.1.1.2.cmml">N</mi><mi id="S5.SS3.p2.5.m5.1.1.3" xref="S5.SS3.p2.5.m5.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><apply id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS3.p2.5.m5.1.1.2.cmml" xref="S5.SS3.p2.5.m5.1.1.2">𝑁</ci><ci id="S5.SS3.p2.5.m5.1.1.3.cmml" xref="S5.SS3.p2.5.m5.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">N_{h}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> represents the total number of visits for patient <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p2.6.m6.1"><semantics id="S5.SS3.p2.6.m6.1a"><mi id="S5.SS3.p2.6.m6.1.1" xref="S5.SS3.p2.6.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.6.m6.1b"><ci id="S5.SS3.p2.6.m6.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.6.m6.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.6.m6.1d">italic_h</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.12"><span class="ltx_text ltx_font_bold" id="S5.SS3.p3.12.1">DDI</span> (Drug-Drug Interaction rate) measures the incidence of adverse reactions in the recommended combinations. A lower rate indicates higher safety of the drug combinations.</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E37">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="DDI=\frac{\sum_{i=1}^{N_{h}}\sum_{k,l\in\{j:\hat{m}_{j}(t)=1\}}1\{a^{ddi}_{kl}%
=1\}}{\sum_{i=1}^{N_{h}}\sum_{k,l\in\{j:m_{j}(t)=1\}}1}," class="ltx_Math" display="block" id="S5.E37.m1.12"><semantics id="S5.E37.m1.12a"><mrow id="S5.E37.m1.12.12.1" xref="S5.E37.m1.12.12.1.1.cmml"><mrow id="S5.E37.m1.12.12.1.1" xref="S5.E37.m1.12.12.1.1.cmml"><mrow id="S5.E37.m1.12.12.1.1.2" xref="S5.E37.m1.12.12.1.1.2.cmml"><mi id="S5.E37.m1.12.12.1.1.2.2" xref="S5.E37.m1.12.12.1.1.2.2.cmml">D</mi><mo id="S5.E37.m1.12.12.1.1.2.1" xref="S5.E37.m1.12.12.1.1.2.1.cmml">⁢</mo><mi id="S5.E37.m1.12.12.1.1.2.3" xref="S5.E37.m1.12.12.1.1.2.3.cmml">D</mi><mo id="S5.E37.m1.12.12.1.1.2.1a" xref="S5.E37.m1.12.12.1.1.2.1.cmml">⁢</mo><mi id="S5.E37.m1.12.12.1.1.2.4" xref="S5.E37.m1.12.12.1.1.2.4.cmml">I</mi></mrow><mo id="S5.E37.m1.12.12.1.1.1" xref="S5.E37.m1.12.12.1.1.1.cmml">=</mo><mfrac id="S5.E37.m1.11.11" xref="S5.E37.m1.11.11.cmml"><mrow id="S5.E37.m1.6.6.6" xref="S5.E37.m1.6.6.6.cmml"><msubsup id="S5.E37.m1.6.6.6.7" xref="S5.E37.m1.6.6.6.7.cmml"><mo id="S5.E37.m1.6.6.6.7.2.2" xref="S5.E37.m1.6.6.6.7.2.2.cmml">∑</mo><mrow id="S5.E37.m1.6.6.6.7.2.3" xref="S5.E37.m1.6.6.6.7.2.3.cmml"><mi id="S5.E37.m1.6.6.6.7.2.3.2" xref="S5.E37.m1.6.6.6.7.2.3.2.cmml">i</mi><mo id="S5.E37.m1.6.6.6.7.2.3.1" xref="S5.E37.m1.6.6.6.7.2.3.1.cmml">=</mo><mn id="S5.E37.m1.6.6.6.7.2.3.3" xref="S5.E37.m1.6.6.6.7.2.3.3.cmml">1</mn></mrow><msub id="S5.E37.m1.6.6.6.7.3" xref="S5.E37.m1.6.6.6.7.3.cmml"><mi id="S5.E37.m1.6.6.6.7.3.2" xref="S5.E37.m1.6.6.6.7.3.2.cmml">N</mi><mi id="S5.E37.m1.6.6.6.7.3.3" xref="S5.E37.m1.6.6.6.7.3.3.cmml">h</mi></msub></msubsup><mrow id="S5.E37.m1.6.6.6.6" xref="S5.E37.m1.6.6.6.6.cmml"><msub id="S5.E37.m1.6.6.6.6.2" xref="S5.E37.m1.6.6.6.6.2.cmml"><mo id="S5.E37.m1.6.6.6.6.2.2" lspace="0.167em" xref="S5.E37.m1.6.6.6.6.2.2.cmml">∑</mo><mrow id="S5.E37.m1.5.5.5.5.5" xref="S5.E37.m1.5.5.5.5.5.cmml"><mrow id="S5.E37.m1.5.5.5.5.5.7.2" xref="S5.E37.m1.5.5.5.5.5.7.1.cmml"><mi id="S5.E37.m1.3.3.3.3.3.3" xref="S5.E37.m1.3.3.3.3.3.3.cmml">k</mi><mo id="S5.E37.m1.5.5.5.5.5.7.2.1" xref="S5.E37.m1.5.5.5.5.5.7.1.cmml">,</mo><mi id="S5.E37.m1.4.4.4.4.4.4" xref="S5.E37.m1.4.4.4.4.4.4.cmml">l</mi></mrow><mo id="S5.E37.m1.5.5.5.5.5.6" xref="S5.E37.m1.5.5.5.5.5.6.cmml">∈</mo><mrow id="S5.E37.m1.5.5.5.5.5.5.1" xref="S5.E37.m1.5.5.5.5.5.5.2.cmml"><mo id="S5.E37.m1.5.5.5.5.5.5.1.2" stretchy="false" xref="S5.E37.m1.5.5.5.5.5.5.2.1.cmml">{</mo><mi id="S5.E37.m1.2.2.2.2.2.2" xref="S5.E37.m1.2.2.2.2.2.2.cmml">j</mi><mo id="S5.E37.m1.5.5.5.5.5.5.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E37.m1.5.5.5.5.5.5.2.1.cmml">:</mo><mrow id="S5.E37.m1.5.5.5.5.5.5.1.1" xref="S5.E37.m1.5.5.5.5.5.5.1.1.cmml"><mrow id="S5.E37.m1.5.5.5.5.5.5.1.1.2" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.cmml"><msub id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.cmml"><mover accent="true" id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.cmml"><mi id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.2" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.2.cmml">m</mi><mo id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.1" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.3" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.3.cmml">j</mi></msub><mo id="S5.E37.m1.5.5.5.5.5.5.1.1.2.1" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S5.E37.m1.5.5.5.5.5.5.1.1.2.3.2" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.cmml"><mo id="S5.E37.m1.5.5.5.5.5.5.1.1.2.3.2.1" stretchy="false" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.cmml">(</mo><mi id="S5.E37.m1.1.1.1.1.1.1" xref="S5.E37.m1.1.1.1.1.1.1.cmml">t</mi><mo id="S5.E37.m1.5.5.5.5.5.5.1.1.2.3.2.2" stretchy="false" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E37.m1.5.5.5.5.5.5.1.1.1" xref="S5.E37.m1.5.5.5.5.5.5.1.1.1.cmml">=</mo><mn id="S5.E37.m1.5.5.5.5.5.5.1.1.3" xref="S5.E37.m1.5.5.5.5.5.5.1.1.3.cmml">1</mn></mrow><mo id="S5.E37.m1.5.5.5.5.5.5.1.4" stretchy="false" xref="S5.E37.m1.5.5.5.5.5.5.2.1.cmml">}</mo></mrow></mrow></msub><mrow id="S5.E37.m1.6.6.6.6.1" xref="S5.E37.m1.6.6.6.6.1.cmml"><mn id="S5.E37.m1.6.6.6.6.1.3" xref="S5.E37.m1.6.6.6.6.1.3.cmml">1</mn><mo id="S5.E37.m1.6.6.6.6.1.2" xref="S5.E37.m1.6.6.6.6.1.2.cmml">⁢</mo><mrow id="S5.E37.m1.6.6.6.6.1.1.1" xref="S5.E37.m1.6.6.6.6.1.1.2.cmml"><mo id="S5.E37.m1.6.6.6.6.1.1.1.2" stretchy="false" xref="S5.E37.m1.6.6.6.6.1.1.2.cmml">{</mo><mrow id="S5.E37.m1.6.6.6.6.1.1.1.1" xref="S5.E37.m1.6.6.6.6.1.1.1.1.cmml"><msubsup id="S5.E37.m1.6.6.6.6.1.1.1.1.2" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.cmml"><mi id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.2" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.2.cmml">a</mi><mrow id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.cmml"><mi id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.2" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.2.cmml">k</mi><mo id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.1" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.3" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.3.cmml">l</mi></mrow><mrow id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.cmml"><mi id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.2" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.2.cmml">d</mi><mo id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.1" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.3" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.3.cmml">d</mi><mo id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.1a" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.4" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.4.cmml">i</mi></mrow></msubsup><mo id="S5.E37.m1.6.6.6.6.1.1.1.1.1" xref="S5.E37.m1.6.6.6.6.1.1.1.1.1.cmml">=</mo><mn id="S5.E37.m1.6.6.6.6.1.1.1.1.3" xref="S5.E37.m1.6.6.6.6.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E37.m1.6.6.6.6.1.1.1.3" stretchy="false" xref="S5.E37.m1.6.6.6.6.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><mrow id="S5.E37.m1.11.11.11" xref="S5.E37.m1.11.11.11.cmml"><msubsup id="S5.E37.m1.11.11.11.6" xref="S5.E37.m1.11.11.11.6.cmml"><mo id="S5.E37.m1.11.11.11.6.2.2" xref="S5.E37.m1.11.11.11.6.2.2.cmml">∑</mo><mrow id="S5.E37.m1.11.11.11.6.2.3" xref="S5.E37.m1.11.11.11.6.2.3.cmml"><mi id="S5.E37.m1.11.11.11.6.2.3.2" xref="S5.E37.m1.11.11.11.6.2.3.2.cmml">i</mi><mo id="S5.E37.m1.11.11.11.6.2.3.1" xref="S5.E37.m1.11.11.11.6.2.3.1.cmml">=</mo><mn id="S5.E37.m1.11.11.11.6.2.3.3" xref="S5.E37.m1.11.11.11.6.2.3.3.cmml">1</mn></mrow><msub id="S5.E37.m1.11.11.11.6.3" xref="S5.E37.m1.11.11.11.6.3.cmml"><mi id="S5.E37.m1.11.11.11.6.3.2" xref="S5.E37.m1.11.11.11.6.3.2.cmml">N</mi><mi id="S5.E37.m1.11.11.11.6.3.3" xref="S5.E37.m1.11.11.11.6.3.3.cmml">h</mi></msub></msubsup><mrow id="S5.E37.m1.11.11.11.7" xref="S5.E37.m1.11.11.11.7.cmml"><msub id="S5.E37.m1.11.11.11.7.1" xref="S5.E37.m1.11.11.11.7.1.cmml"><mo id="S5.E37.m1.11.11.11.7.1.2" lspace="0.167em" xref="S5.E37.m1.11.11.11.7.1.2.cmml">∑</mo><mrow id="S5.E37.m1.11.11.11.5.5" xref="S5.E37.m1.11.11.11.5.5.cmml"><mrow id="S5.E37.m1.11.11.11.5.5.7.2" xref="S5.E37.m1.11.11.11.5.5.7.1.cmml"><mi id="S5.E37.m1.9.9.9.3.3.3" xref="S5.E37.m1.9.9.9.3.3.3.cmml">k</mi><mo id="S5.E37.m1.11.11.11.5.5.7.2.1" xref="S5.E37.m1.11.11.11.5.5.7.1.cmml">,</mo><mi id="S5.E37.m1.10.10.10.4.4.4" xref="S5.E37.m1.10.10.10.4.4.4.cmml">l</mi></mrow><mo id="S5.E37.m1.11.11.11.5.5.6" xref="S5.E37.m1.11.11.11.5.5.6.cmml">∈</mo><mrow id="S5.E37.m1.11.11.11.5.5.5.1" xref="S5.E37.m1.11.11.11.5.5.5.2.cmml"><mo id="S5.E37.m1.11.11.11.5.5.5.1.2" stretchy="false" xref="S5.E37.m1.11.11.11.5.5.5.2.1.cmml">{</mo><mi id="S5.E37.m1.8.8.8.2.2.2" xref="S5.E37.m1.8.8.8.2.2.2.cmml">j</mi><mo id="S5.E37.m1.11.11.11.5.5.5.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E37.m1.11.11.11.5.5.5.2.1.cmml">:</mo><mrow id="S5.E37.m1.11.11.11.5.5.5.1.1" xref="S5.E37.m1.11.11.11.5.5.5.1.1.cmml"><mrow id="S5.E37.m1.11.11.11.5.5.5.1.1.2" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.cmml"><msub id="S5.E37.m1.11.11.11.5.5.5.1.1.2.2" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.cmml"><mi id="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.2" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.2.cmml">m</mi><mi id="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.3" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.3.cmml">j</mi></msub><mo id="S5.E37.m1.11.11.11.5.5.5.1.1.2.1" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S5.E37.m1.11.11.11.5.5.5.1.1.2.3.2" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.cmml"><mo id="S5.E37.m1.11.11.11.5.5.5.1.1.2.3.2.1" stretchy="false" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.cmml">(</mo><mi id="S5.E37.m1.7.7.7.1.1.1" xref="S5.E37.m1.7.7.7.1.1.1.cmml">t</mi><mo id="S5.E37.m1.11.11.11.5.5.5.1.1.2.3.2.2" stretchy="false" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E37.m1.11.11.11.5.5.5.1.1.1" xref="S5.E37.m1.11.11.11.5.5.5.1.1.1.cmml">=</mo><mn id="S5.E37.m1.11.11.11.5.5.5.1.1.3" xref="S5.E37.m1.11.11.11.5.5.5.1.1.3.cmml">1</mn></mrow><mo id="S5.E37.m1.11.11.11.5.5.5.1.4" stretchy="false" xref="S5.E37.m1.11.11.11.5.5.5.2.1.cmml">}</mo></mrow></mrow></msub><mn id="S5.E37.m1.11.11.11.7.2" xref="S5.E37.m1.11.11.11.7.2.cmml">1</mn></mrow></mrow></mfrac></mrow><mo id="S5.E37.m1.12.12.1.2" xref="S5.E37.m1.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E37.m1.12b"><apply id="S5.E37.m1.12.12.1.1.cmml" xref="S5.E37.m1.12.12.1"><eq id="S5.E37.m1.12.12.1.1.1.cmml" xref="S5.E37.m1.12.12.1.1.1"></eq><apply id="S5.E37.m1.12.12.1.1.2.cmml" xref="S5.E37.m1.12.12.1.1.2"><times id="S5.E37.m1.12.12.1.1.2.1.cmml" xref="S5.E37.m1.12.12.1.1.2.1"></times><ci id="S5.E37.m1.12.12.1.1.2.2.cmml" xref="S5.E37.m1.12.12.1.1.2.2">𝐷</ci><ci id="S5.E37.m1.12.12.1.1.2.3.cmml" xref="S5.E37.m1.12.12.1.1.2.3">𝐷</ci><ci id="S5.E37.m1.12.12.1.1.2.4.cmml" xref="S5.E37.m1.12.12.1.1.2.4">𝐼</ci></apply><apply id="S5.E37.m1.11.11.cmml" xref="S5.E37.m1.11.11"><divide id="S5.E37.m1.11.11.12.cmml" xref="S5.E37.m1.11.11"></divide><apply id="S5.E37.m1.6.6.6.cmml" xref="S5.E37.m1.6.6.6"><apply id="S5.E37.m1.6.6.6.7.cmml" xref="S5.E37.m1.6.6.6.7"><csymbol cd="ambiguous" id="S5.E37.m1.6.6.6.7.1.cmml" xref="S5.E37.m1.6.6.6.7">superscript</csymbol><apply id="S5.E37.m1.6.6.6.7.2.cmml" xref="S5.E37.m1.6.6.6.7"><csymbol cd="ambiguous" id="S5.E37.m1.6.6.6.7.2.1.cmml" xref="S5.E37.m1.6.6.6.7">subscript</csymbol><sum id="S5.E37.m1.6.6.6.7.2.2.cmml" xref="S5.E37.m1.6.6.6.7.2.2"></sum><apply id="S5.E37.m1.6.6.6.7.2.3.cmml" xref="S5.E37.m1.6.6.6.7.2.3"><eq id="S5.E37.m1.6.6.6.7.2.3.1.cmml" xref="S5.E37.m1.6.6.6.7.2.3.1"></eq><ci id="S5.E37.m1.6.6.6.7.2.3.2.cmml" xref="S5.E37.m1.6.6.6.7.2.3.2">𝑖</ci><cn id="S5.E37.m1.6.6.6.7.2.3.3.cmml" type="integer" xref="S5.E37.m1.6.6.6.7.2.3.3">1</cn></apply></apply><apply id="S5.E37.m1.6.6.6.7.3.cmml" xref="S5.E37.m1.6.6.6.7.3"><csymbol cd="ambiguous" id="S5.E37.m1.6.6.6.7.3.1.cmml" xref="S5.E37.m1.6.6.6.7.3">subscript</csymbol><ci id="S5.E37.m1.6.6.6.7.3.2.cmml" xref="S5.E37.m1.6.6.6.7.3.2">𝑁</ci><ci id="S5.E37.m1.6.6.6.7.3.3.cmml" xref="S5.E37.m1.6.6.6.7.3.3">ℎ</ci></apply></apply><apply id="S5.E37.m1.6.6.6.6.cmml" xref="S5.E37.m1.6.6.6.6"><apply id="S5.E37.m1.6.6.6.6.2.cmml" xref="S5.E37.m1.6.6.6.6.2"><csymbol cd="ambiguous" id="S5.E37.m1.6.6.6.6.2.1.cmml" xref="S5.E37.m1.6.6.6.6.2">subscript</csymbol><sum id="S5.E37.m1.6.6.6.6.2.2.cmml" xref="S5.E37.m1.6.6.6.6.2.2"></sum><apply id="S5.E37.m1.5.5.5.5.5.cmml" xref="S5.E37.m1.5.5.5.5.5"><in id="S5.E37.m1.5.5.5.5.5.6.cmml" xref="S5.E37.m1.5.5.5.5.5.6"></in><list id="S5.E37.m1.5.5.5.5.5.7.1.cmml" xref="S5.E37.m1.5.5.5.5.5.7.2"><ci id="S5.E37.m1.3.3.3.3.3.3.cmml" xref="S5.E37.m1.3.3.3.3.3.3">𝑘</ci><ci id="S5.E37.m1.4.4.4.4.4.4.cmml" xref="S5.E37.m1.4.4.4.4.4.4">𝑙</ci></list><apply id="S5.E37.m1.5.5.5.5.5.5.2.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1"><csymbol cd="latexml" id="S5.E37.m1.5.5.5.5.5.5.2.1.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.2">conditional-set</csymbol><ci id="S5.E37.m1.2.2.2.2.2.2.cmml" xref="S5.E37.m1.2.2.2.2.2.2">𝑗</ci><apply id="S5.E37.m1.5.5.5.5.5.5.1.1.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1"><eq id="S5.E37.m1.5.5.5.5.5.5.1.1.1.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.1"></eq><apply id="S5.E37.m1.5.5.5.5.5.5.1.1.2.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2"><times id="S5.E37.m1.5.5.5.5.5.5.1.1.2.1.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.1"></times><apply id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.1.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2">subscript</csymbol><apply id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2"><ci id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.1.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.1">^</ci><ci id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.2.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.2.2">𝑚</ci></apply><ci id="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.3.cmml" xref="S5.E37.m1.5.5.5.5.5.5.1.1.2.2.3">𝑗</ci></apply><ci id="S5.E37.m1.1.1.1.1.1.1.cmml" xref="S5.E37.m1.1.1.1.1.1.1">𝑡</ci></apply><cn id="S5.E37.m1.5.5.5.5.5.5.1.1.3.cmml" type="integer" xref="S5.E37.m1.5.5.5.5.5.5.1.1.3">1</cn></apply></apply></apply></apply><apply id="S5.E37.m1.6.6.6.6.1.cmml" xref="S5.E37.m1.6.6.6.6.1"><times id="S5.E37.m1.6.6.6.6.1.2.cmml" xref="S5.E37.m1.6.6.6.6.1.2"></times><cn id="S5.E37.m1.6.6.6.6.1.3.cmml" type="integer" xref="S5.E37.m1.6.6.6.6.1.3">1</cn><set id="S5.E37.m1.6.6.6.6.1.1.2.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1"><apply id="S5.E37.m1.6.6.6.6.1.1.1.1.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1"><eq id="S5.E37.m1.6.6.6.6.1.1.1.1.1.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.1"></eq><apply id="S5.E37.m1.6.6.6.6.1.1.1.1.2.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E37.m1.6.6.6.6.1.1.1.1.2.1.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2">subscript</csymbol><apply id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.1.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2">superscript</csymbol><ci id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.2.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.2">𝑎</ci><apply id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3"><times id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.1.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.1"></times><ci id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.2.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.2">𝑑</ci><ci id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.3.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.3">𝑑</ci><ci id="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.4.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.2.3.4">𝑖</ci></apply></apply><apply id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3"><times id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.1.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.1"></times><ci id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.2.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.2">𝑘</ci><ci id="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.3.cmml" xref="S5.E37.m1.6.6.6.6.1.1.1.1.2.3.3">𝑙</ci></apply></apply><cn id="S5.E37.m1.6.6.6.6.1.1.1.1.3.cmml" type="integer" xref="S5.E37.m1.6.6.6.6.1.1.1.1.3">1</cn></apply></set></apply></apply></apply><apply id="S5.E37.m1.11.11.11.cmml" xref="S5.E37.m1.11.11.11"><apply id="S5.E37.m1.11.11.11.6.cmml" xref="S5.E37.m1.11.11.11.6"><csymbol cd="ambiguous" id="S5.E37.m1.11.11.11.6.1.cmml" xref="S5.E37.m1.11.11.11.6">superscript</csymbol><apply id="S5.E37.m1.11.11.11.6.2.cmml" xref="S5.E37.m1.11.11.11.6"><csymbol cd="ambiguous" id="S5.E37.m1.11.11.11.6.2.1.cmml" xref="S5.E37.m1.11.11.11.6">subscript</csymbol><sum id="S5.E37.m1.11.11.11.6.2.2.cmml" xref="S5.E37.m1.11.11.11.6.2.2"></sum><apply id="S5.E37.m1.11.11.11.6.2.3.cmml" xref="S5.E37.m1.11.11.11.6.2.3"><eq id="S5.E37.m1.11.11.11.6.2.3.1.cmml" xref="S5.E37.m1.11.11.11.6.2.3.1"></eq><ci id="S5.E37.m1.11.11.11.6.2.3.2.cmml" xref="S5.E37.m1.11.11.11.6.2.3.2">𝑖</ci><cn id="S5.E37.m1.11.11.11.6.2.3.3.cmml" type="integer" xref="S5.E37.m1.11.11.11.6.2.3.3">1</cn></apply></apply><apply id="S5.E37.m1.11.11.11.6.3.cmml" xref="S5.E37.m1.11.11.11.6.3"><csymbol cd="ambiguous" id="S5.E37.m1.11.11.11.6.3.1.cmml" xref="S5.E37.m1.11.11.11.6.3">subscript</csymbol><ci id="S5.E37.m1.11.11.11.6.3.2.cmml" xref="S5.E37.m1.11.11.11.6.3.2">𝑁</ci><ci id="S5.E37.m1.11.11.11.6.3.3.cmml" xref="S5.E37.m1.11.11.11.6.3.3">ℎ</ci></apply></apply><apply id="S5.E37.m1.11.11.11.7.cmml" xref="S5.E37.m1.11.11.11.7"><apply id="S5.E37.m1.11.11.11.7.1.cmml" xref="S5.E37.m1.11.11.11.7.1"><csymbol cd="ambiguous" id="S5.E37.m1.11.11.11.7.1.1.cmml" xref="S5.E37.m1.11.11.11.7.1">subscript</csymbol><sum id="S5.E37.m1.11.11.11.7.1.2.cmml" xref="S5.E37.m1.11.11.11.7.1.2"></sum><apply id="S5.E37.m1.11.11.11.5.5.cmml" xref="S5.E37.m1.11.11.11.5.5"><in id="S5.E37.m1.11.11.11.5.5.6.cmml" xref="S5.E37.m1.11.11.11.5.5.6"></in><list id="S5.E37.m1.11.11.11.5.5.7.1.cmml" xref="S5.E37.m1.11.11.11.5.5.7.2"><ci id="S5.E37.m1.9.9.9.3.3.3.cmml" xref="S5.E37.m1.9.9.9.3.3.3">𝑘</ci><ci id="S5.E37.m1.10.10.10.4.4.4.cmml" xref="S5.E37.m1.10.10.10.4.4.4">𝑙</ci></list><apply id="S5.E37.m1.11.11.11.5.5.5.2.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1"><csymbol cd="latexml" id="S5.E37.m1.11.11.11.5.5.5.2.1.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.2">conditional-set</csymbol><ci id="S5.E37.m1.8.8.8.2.2.2.cmml" xref="S5.E37.m1.8.8.8.2.2.2">𝑗</ci><apply id="S5.E37.m1.11.11.11.5.5.5.1.1.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1"><eq id="S5.E37.m1.11.11.11.5.5.5.1.1.1.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1.1"></eq><apply id="S5.E37.m1.11.11.11.5.5.5.1.1.2.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2"><times id="S5.E37.m1.11.11.11.5.5.5.1.1.2.1.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.1"></times><apply id="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.1.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.2">subscript</csymbol><ci id="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.2.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.2">𝑚</ci><ci id="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.3.cmml" xref="S5.E37.m1.11.11.11.5.5.5.1.1.2.2.3">𝑗</ci></apply><ci id="S5.E37.m1.7.7.7.1.1.1.cmml" xref="S5.E37.m1.7.7.7.1.1.1">𝑡</ci></apply><cn id="S5.E37.m1.11.11.11.5.5.5.1.1.3.cmml" type="integer" xref="S5.E37.m1.11.11.11.5.5.5.1.1.3">1</cn></apply></apply></apply></apply><cn id="S5.E37.m1.11.11.11.7.2.cmml" type="integer" xref="S5.E37.m1.11.11.11.7.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E37.m1.12c">DDI=\frac{\sum_{i=1}^{N_{h}}\sum_{k,l\in\{j:\hat{m}_{j}(t)=1\}}1\{a^{ddi}_{kl}%
=1\}}{\sum_{i=1}^{N_{h}}\sum_{k,l\in\{j:m_{j}(t)=1\}}1},</annotation><annotation encoding="application/x-llamapun" id="S5.E37.m1.12d">italic_D italic_D italic_I = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_k , italic_l ∈ { italic_j : over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_t ) = 1 } end_POSTSUBSCRIPT 1 { italic_a start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k italic_l end_POSTSUBSCRIPT = 1 } end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_k , italic_l ∈ { italic_j : italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_t ) = 1 } end_POSTSUBSCRIPT 1 end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(37)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.p3.11">where <math alttext="N_{h}" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><msub id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml"><mi id="S5.SS3.p3.1.m1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.2.cmml">N</mi><mi id="S5.SS3.p3.1.m1.1.1.3" xref="S5.SS3.p3.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.1.m1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p3.1.m1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2">𝑁</ci><ci id="S5.SS3.p3.1.m1.1.1.3.cmml" xref="S5.SS3.p3.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">N_{h}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> denotes the total number of visits for patient <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p3.2.m2.1"><semantics id="S5.SS3.p3.2.m2.1a"><mi id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><ci id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.2.m2.1d">italic_h</annotation></semantics></math>, <math alttext="m_{j}(t)" class="ltx_Math" display="inline" id="S5.SS3.p3.3.m3.1"><semantics id="S5.SS3.p3.3.m3.1a"><mrow id="S5.SS3.p3.3.m3.1.2" xref="S5.SS3.p3.3.m3.1.2.cmml"><msub id="S5.SS3.p3.3.m3.1.2.2" xref="S5.SS3.p3.3.m3.1.2.2.cmml"><mi id="S5.SS3.p3.3.m3.1.2.2.2" xref="S5.SS3.p3.3.m3.1.2.2.2.cmml">m</mi><mi id="S5.SS3.p3.3.m3.1.2.2.3" xref="S5.SS3.p3.3.m3.1.2.2.3.cmml">j</mi></msub><mo id="S5.SS3.p3.3.m3.1.2.1" xref="S5.SS3.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.3.m3.1.2.3.2" xref="S5.SS3.p3.3.m3.1.2.cmml"><mo id="S5.SS3.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.3.m3.1.2.cmml">(</mo><mi id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">t</mi><mo id="S5.SS3.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><apply id="S5.SS3.p3.3.m3.1.2.cmml" xref="S5.SS3.p3.3.m3.1.2"><times id="S5.SS3.p3.3.m3.1.2.1.cmml" xref="S5.SS3.p3.3.m3.1.2.1"></times><apply id="S5.SS3.p3.3.m3.1.2.2.cmml" xref="S5.SS3.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S5.SS3.p3.3.m3.1.2.2.1.cmml" xref="S5.SS3.p3.3.m3.1.2.2">subscript</csymbol><ci id="S5.SS3.p3.3.m3.1.2.2.2.cmml" xref="S5.SS3.p3.3.m3.1.2.2.2">𝑚</ci><ci id="S5.SS3.p3.3.m3.1.2.2.3.cmml" xref="S5.SS3.p3.3.m3.1.2.2.3">𝑗</ci></apply><ci id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">m_{j}(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.3.m3.1d">italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> denotes the <math alttext="j^{th}" class="ltx_Math" display="inline" id="S5.SS3.p3.4.m4.1"><semantics id="S5.SS3.p3.4.m4.1a"><msup id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml"><mi id="S5.SS3.p3.4.m4.1.1.2" xref="S5.SS3.p3.4.m4.1.1.2.cmml">j</mi><mrow id="S5.SS3.p3.4.m4.1.1.3" xref="S5.SS3.p3.4.m4.1.1.3.cmml"><mi id="S5.SS3.p3.4.m4.1.1.3.2" xref="S5.SS3.p3.4.m4.1.1.3.2.cmml">t</mi><mo id="S5.SS3.p3.4.m4.1.1.3.1" xref="S5.SS3.p3.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p3.4.m4.1.1.3.3" xref="S5.SS3.p3.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><apply id="S5.SS3.p3.4.m4.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.4.m4.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1">superscript</csymbol><ci id="S5.SS3.p3.4.m4.1.1.2.cmml" xref="S5.SS3.p3.4.m4.1.1.2">𝑗</ci><apply id="S5.SS3.p3.4.m4.1.1.3.cmml" xref="S5.SS3.p3.4.m4.1.1.3"><times id="S5.SS3.p3.4.m4.1.1.3.1.cmml" xref="S5.SS3.p3.4.m4.1.1.3.1"></times><ci id="S5.SS3.p3.4.m4.1.1.3.2.cmml" xref="S5.SS3.p3.4.m4.1.1.3.2">𝑡</ci><ci id="S5.SS3.p3.4.m4.1.1.3.3.cmml" xref="S5.SS3.p3.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">j^{th}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.4.m4.1d">italic_j start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> entry of <math alttext="m(t)" class="ltx_Math" display="inline" id="S5.SS3.p3.5.m5.1"><semantics id="S5.SS3.p3.5.m5.1a"><mrow id="S5.SS3.p3.5.m5.1.2" xref="S5.SS3.p3.5.m5.1.2.cmml"><mi id="S5.SS3.p3.5.m5.1.2.2" xref="S5.SS3.p3.5.m5.1.2.2.cmml">m</mi><mo id="S5.SS3.p3.5.m5.1.2.1" xref="S5.SS3.p3.5.m5.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.5.m5.1.2.3.2" xref="S5.SS3.p3.5.m5.1.2.cmml"><mo id="S5.SS3.p3.5.m5.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.5.m5.1.2.cmml">(</mo><mi id="S5.SS3.p3.5.m5.1.1" xref="S5.SS3.p3.5.m5.1.1.cmml">t</mi><mo id="S5.SS3.p3.5.m5.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.5.m5.1b"><apply id="S5.SS3.p3.5.m5.1.2.cmml" xref="S5.SS3.p3.5.m5.1.2"><times id="S5.SS3.p3.5.m5.1.2.1.cmml" xref="S5.SS3.p3.5.m5.1.2.1"></times><ci id="S5.SS3.p3.5.m5.1.2.2.cmml" xref="S5.SS3.p3.5.m5.1.2.2">𝑚</ci><ci id="S5.SS3.p3.5.m5.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.5.m5.1c">m(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.5.m5.1d">italic_m ( italic_t )</annotation></semantics></math>, <math alttext="m(t)" class="ltx_Math" display="inline" id="S5.SS3.p3.6.m6.1"><semantics id="S5.SS3.p3.6.m6.1a"><mrow id="S5.SS3.p3.6.m6.1.2" xref="S5.SS3.p3.6.m6.1.2.cmml"><mi id="S5.SS3.p3.6.m6.1.2.2" xref="S5.SS3.p3.6.m6.1.2.2.cmml">m</mi><mo id="S5.SS3.p3.6.m6.1.2.1" xref="S5.SS3.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.6.m6.1.2.3.2" xref="S5.SS3.p3.6.m6.1.2.cmml"><mo id="S5.SS3.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.6.m6.1.2.cmml">(</mo><mi id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml">t</mi><mo id="S5.SS3.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><apply id="S5.SS3.p3.6.m6.1.2.cmml" xref="S5.SS3.p3.6.m6.1.2"><times id="S5.SS3.p3.6.m6.1.2.1.cmml" xref="S5.SS3.p3.6.m6.1.2.1"></times><ci id="S5.SS3.p3.6.m6.1.2.2.cmml" xref="S5.SS3.p3.6.m6.1.2.2">𝑚</ci><ci id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">m(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.6.m6.1d">italic_m ( italic_t )</annotation></semantics></math> and <math alttext="\hat{m}(t)" class="ltx_Math" display="inline" id="S5.SS3.p3.7.m7.1"><semantics id="S5.SS3.p3.7.m7.1a"><mrow id="S5.SS3.p3.7.m7.1.2" xref="S5.SS3.p3.7.m7.1.2.cmml"><mover accent="true" id="S5.SS3.p3.7.m7.1.2.2" xref="S5.SS3.p3.7.m7.1.2.2.cmml"><mi id="S5.SS3.p3.7.m7.1.2.2.2" xref="S5.SS3.p3.7.m7.1.2.2.2.cmml">m</mi><mo id="S5.SS3.p3.7.m7.1.2.2.1" xref="S5.SS3.p3.7.m7.1.2.2.1.cmml">^</mo></mover><mo id="S5.SS3.p3.7.m7.1.2.1" xref="S5.SS3.p3.7.m7.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.7.m7.1.2.3.2" xref="S5.SS3.p3.7.m7.1.2.cmml"><mo id="S5.SS3.p3.7.m7.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.7.m7.1.2.cmml">(</mo><mi id="S5.SS3.p3.7.m7.1.1" xref="S5.SS3.p3.7.m7.1.1.cmml">t</mi><mo id="S5.SS3.p3.7.m7.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.7.m7.1b"><apply id="S5.SS3.p3.7.m7.1.2.cmml" xref="S5.SS3.p3.7.m7.1.2"><times id="S5.SS3.p3.7.m7.1.2.1.cmml" xref="S5.SS3.p3.7.m7.1.2.1"></times><apply id="S5.SS3.p3.7.m7.1.2.2.cmml" xref="S5.SS3.p3.7.m7.1.2.2"><ci id="S5.SS3.p3.7.m7.1.2.2.1.cmml" xref="S5.SS3.p3.7.m7.1.2.2.1">^</ci><ci id="S5.SS3.p3.7.m7.1.2.2.2.cmml" xref="S5.SS3.p3.7.m7.1.2.2.2">𝑚</ci></apply><ci id="S5.SS3.p3.7.m7.1.1.cmml" xref="S5.SS3.p3.7.m7.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.7.m7.1c">\hat{m}(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.7.m7.1d">over^ start_ARG italic_m end_ARG ( italic_t )</annotation></semantics></math> denote the real and predicted multi-labels at visit <math alttext="t" class="ltx_Math" display="inline" id="S5.SS3.p3.8.m8.1"><semantics id="S5.SS3.p3.8.m8.1a"><mi id="S5.SS3.p3.8.m8.1.1" xref="S5.SS3.p3.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.8.m8.1b"><ci id="S5.SS3.p3.8.m8.1.1.cmml" xref="S5.SS3.p3.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.8.m8.1d">italic_t</annotation></semantics></math>, <math alttext="a^{ddi}" class="ltx_Math" display="inline" id="S5.SS3.p3.9.m9.1"><semantics id="S5.SS3.p3.9.m9.1a"><msup id="S5.SS3.p3.9.m9.1.1" xref="S5.SS3.p3.9.m9.1.1.cmml"><mi id="S5.SS3.p3.9.m9.1.1.2" xref="S5.SS3.p3.9.m9.1.1.2.cmml">a</mi><mrow id="S5.SS3.p3.9.m9.1.1.3" xref="S5.SS3.p3.9.m9.1.1.3.cmml"><mi id="S5.SS3.p3.9.m9.1.1.3.2" xref="S5.SS3.p3.9.m9.1.1.3.2.cmml">d</mi><mo id="S5.SS3.p3.9.m9.1.1.3.1" xref="S5.SS3.p3.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p3.9.m9.1.1.3.3" xref="S5.SS3.p3.9.m9.1.1.3.3.cmml">d</mi><mo id="S5.SS3.p3.9.m9.1.1.3.1a" xref="S5.SS3.p3.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p3.9.m9.1.1.3.4" xref="S5.SS3.p3.9.m9.1.1.3.4.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.9.m9.1b"><apply id="S5.SS3.p3.9.m9.1.1.cmml" xref="S5.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.9.m9.1.1.1.cmml" xref="S5.SS3.p3.9.m9.1.1">superscript</csymbol><ci id="S5.SS3.p3.9.m9.1.1.2.cmml" xref="S5.SS3.p3.9.m9.1.1.2">𝑎</ci><apply id="S5.SS3.p3.9.m9.1.1.3.cmml" xref="S5.SS3.p3.9.m9.1.1.3"><times id="S5.SS3.p3.9.m9.1.1.3.1.cmml" xref="S5.SS3.p3.9.m9.1.1.3.1"></times><ci id="S5.SS3.p3.9.m9.1.1.3.2.cmml" xref="S5.SS3.p3.9.m9.1.1.3.2">𝑑</ci><ci id="S5.SS3.p3.9.m9.1.1.3.3.cmml" xref="S5.SS3.p3.9.m9.1.1.3.3">𝑑</ci><ci id="S5.SS3.p3.9.m9.1.1.3.4.cmml" xref="S5.SS3.p3.9.m9.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.9.m9.1c">a^{ddi}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.9.m9.1d">italic_a start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the prior DDI relation matrix, and <math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.p3.10.m10.1"><semantics id="S5.SS3.p3.10.m10.1a"><mn id="S5.SS3.p3.10.m10.1.1" xref="S5.SS3.p3.10.m10.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.10.m10.1b"><cn id="S5.SS3.p3.10.m10.1.1.cmml" type="integer" xref="S5.SS3.p3.10.m10.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.10.m10.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.10.m10.1d">1</annotation></semantics></math> is an indicator function that returns 1 when <math alttext="a^{ddi}=1" class="ltx_Math" display="inline" id="S5.SS3.p3.11.m11.1"><semantics id="S5.SS3.p3.11.m11.1a"><mrow id="S5.SS3.p3.11.m11.1.1" xref="S5.SS3.p3.11.m11.1.1.cmml"><msup id="S5.SS3.p3.11.m11.1.1.2" xref="S5.SS3.p3.11.m11.1.1.2.cmml"><mi id="S5.SS3.p3.11.m11.1.1.2.2" xref="S5.SS3.p3.11.m11.1.1.2.2.cmml">a</mi><mrow id="S5.SS3.p3.11.m11.1.1.2.3" xref="S5.SS3.p3.11.m11.1.1.2.3.cmml"><mi id="S5.SS3.p3.11.m11.1.1.2.3.2" xref="S5.SS3.p3.11.m11.1.1.2.3.2.cmml">d</mi><mo id="S5.SS3.p3.11.m11.1.1.2.3.1" xref="S5.SS3.p3.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS3.p3.11.m11.1.1.2.3.3" xref="S5.SS3.p3.11.m11.1.1.2.3.3.cmml">d</mi><mo id="S5.SS3.p3.11.m11.1.1.2.3.1a" xref="S5.SS3.p3.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS3.p3.11.m11.1.1.2.3.4" xref="S5.SS3.p3.11.m11.1.1.2.3.4.cmml">i</mi></mrow></msup><mo id="S5.SS3.p3.11.m11.1.1.1" xref="S5.SS3.p3.11.m11.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.11.m11.1.1.3" xref="S5.SS3.p3.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.11.m11.1b"><apply id="S5.SS3.p3.11.m11.1.1.cmml" xref="S5.SS3.p3.11.m11.1.1"><eq id="S5.SS3.p3.11.m11.1.1.1.cmml" xref="S5.SS3.p3.11.m11.1.1.1"></eq><apply id="S5.SS3.p3.11.m11.1.1.2.cmml" xref="S5.SS3.p3.11.m11.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p3.11.m11.1.1.2.1.cmml" xref="S5.SS3.p3.11.m11.1.1.2">superscript</csymbol><ci id="S5.SS3.p3.11.m11.1.1.2.2.cmml" xref="S5.SS3.p3.11.m11.1.1.2.2">𝑎</ci><apply id="S5.SS3.p3.11.m11.1.1.2.3.cmml" xref="S5.SS3.p3.11.m11.1.1.2.3"><times id="S5.SS3.p3.11.m11.1.1.2.3.1.cmml" xref="S5.SS3.p3.11.m11.1.1.2.3.1"></times><ci id="S5.SS3.p3.11.m11.1.1.2.3.2.cmml" xref="S5.SS3.p3.11.m11.1.1.2.3.2">𝑑</ci><ci id="S5.SS3.p3.11.m11.1.1.2.3.3.cmml" xref="S5.SS3.p3.11.m11.1.1.2.3.3">𝑑</ci><ci id="S5.SS3.p3.11.m11.1.1.2.3.4.cmml" xref="S5.SS3.p3.11.m11.1.1.2.3.4">𝑖</ci></apply></apply><cn id="S5.SS3.p3.11.m11.1.1.3.cmml" type="integer" xref="S5.SS3.p3.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.11.m11.1c">a^{ddi}=1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.11.m11.1d">italic_a start_POSTSUPERSCRIPT italic_d italic_d italic_i end_POSTSUPERSCRIPT = 1</annotation></semantics></math>, otherwise 0.</p>
</div>
<div class="ltx_para" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.3"><span class="ltx_text ltx_font_bold" id="S5.SS3.p4.3.1">F1</span> (F1-score) combines precision and recall, reflecting the model’s ability to accurately identify correct medications while ensuring comprehensive coverage.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx11">
<tbody id="S5.E38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle Precision(t)=\frac{|\{i:\hat{m}_{i}=1\}\cap\{i:m_{i}=1\}|}{|\{i:%
\hat{m}_{i}=1\}|}," class="ltx_Math" display="block" id="S5.E38.m1.7"><semantics id="S5.E38.m1.7a"><mrow id="S5.E38.m1.7.7.1" xref="S5.E38.m1.7.7.1.1.cmml"><mrow id="S5.E38.m1.7.7.1.1" xref="S5.E38.m1.7.7.1.1.cmml"><mrow id="S5.E38.m1.7.7.1.1.2" xref="S5.E38.m1.7.7.1.1.2.cmml"><mi id="S5.E38.m1.7.7.1.1.2.2" xref="S5.E38.m1.7.7.1.1.2.2.cmml">P</mi><mo id="S5.E38.m1.7.7.1.1.2.1" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.3" xref="S5.E38.m1.7.7.1.1.2.3.cmml">r</mi><mo id="S5.E38.m1.7.7.1.1.2.1a" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.4" xref="S5.E38.m1.7.7.1.1.2.4.cmml">e</mi><mo id="S5.E38.m1.7.7.1.1.2.1b" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.5" xref="S5.E38.m1.7.7.1.1.2.5.cmml">c</mi><mo id="S5.E38.m1.7.7.1.1.2.1c" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.6" xref="S5.E38.m1.7.7.1.1.2.6.cmml">i</mi><mo id="S5.E38.m1.7.7.1.1.2.1d" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.7" xref="S5.E38.m1.7.7.1.1.2.7.cmml">s</mi><mo id="S5.E38.m1.7.7.1.1.2.1e" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.8" xref="S5.E38.m1.7.7.1.1.2.8.cmml">i</mi><mo id="S5.E38.m1.7.7.1.1.2.1f" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.9" xref="S5.E38.m1.7.7.1.1.2.9.cmml">o</mi><mo id="S5.E38.m1.7.7.1.1.2.1g" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E38.m1.7.7.1.1.2.10" xref="S5.E38.m1.7.7.1.1.2.10.cmml">n</mi><mo id="S5.E38.m1.7.7.1.1.2.1h" xref="S5.E38.m1.7.7.1.1.2.1.cmml">⁢</mo><mrow id="S5.E38.m1.7.7.1.1.2.11.2" xref="S5.E38.m1.7.7.1.1.2.cmml"><mo id="S5.E38.m1.7.7.1.1.2.11.2.1" stretchy="false" xref="S5.E38.m1.7.7.1.1.2.cmml">(</mo><mi id="S5.E38.m1.6.6" xref="S5.E38.m1.6.6.cmml">t</mi><mo id="S5.E38.m1.7.7.1.1.2.11.2.2" stretchy="false" xref="S5.E38.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E38.m1.7.7.1.1.1" xref="S5.E38.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S5.E38.m1.5.5" xref="S5.E38.m1.5.5.cmml"><mrow id="S5.E38.m1.3.3.3.3" xref="S5.E38.m1.3.3.3.4.cmml"><mo id="S5.E38.m1.3.3.3.3.2" stretchy="false" xref="S5.E38.m1.3.3.3.4.1.cmml">|</mo><mrow id="S5.E38.m1.3.3.3.3.1" xref="S5.E38.m1.3.3.3.3.1.cmml"><mrow id="S5.E38.m1.3.3.3.3.1.1.1" xref="S5.E38.m1.3.3.3.3.1.1.2.cmml"><mo id="S5.E38.m1.3.3.3.3.1.1.1.2" stretchy="false" xref="S5.E38.m1.3.3.3.3.1.1.2.1.cmml">{</mo><mi id="S5.E38.m1.1.1.1.1" xref="S5.E38.m1.1.1.1.1.cmml">i</mi><mo id="S5.E38.m1.3.3.3.3.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E38.m1.3.3.3.3.1.1.2.1.cmml">:</mo><mrow id="S5.E38.m1.3.3.3.3.1.1.1.1" xref="S5.E38.m1.3.3.3.3.1.1.1.1.cmml"><msub id="S5.E38.m1.3.3.3.3.1.1.1.1.2" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.cmml"><mover accent="true" id="S5.E38.m1.3.3.3.3.1.1.1.1.2.2" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.cmml"><mi id="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.2" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.2.cmml">m</mi><mo id="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.1" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.E38.m1.3.3.3.3.1.1.1.1.2.3" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.E38.m1.3.3.3.3.1.1.1.1.1" xref="S5.E38.m1.3.3.3.3.1.1.1.1.1.cmml">=</mo><mn id="S5.E38.m1.3.3.3.3.1.1.1.1.3" xref="S5.E38.m1.3.3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E38.m1.3.3.3.3.1.1.1.4" stretchy="false" xref="S5.E38.m1.3.3.3.3.1.1.2.1.cmml">}</mo></mrow><mo id="S5.E38.m1.3.3.3.3.1.3" xref="S5.E38.m1.3.3.3.3.1.3.cmml">∩</mo><mrow id="S5.E38.m1.3.3.3.3.1.2.1" xref="S5.E38.m1.3.3.3.3.1.2.2.cmml"><mo id="S5.E38.m1.3.3.3.3.1.2.1.2" stretchy="false" xref="S5.E38.m1.3.3.3.3.1.2.2.1.cmml">{</mo><mi id="S5.E38.m1.2.2.2.2" xref="S5.E38.m1.2.2.2.2.cmml">i</mi><mo id="S5.E38.m1.3.3.3.3.1.2.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E38.m1.3.3.3.3.1.2.2.1.cmml">:</mo><mrow id="S5.E38.m1.3.3.3.3.1.2.1.1" xref="S5.E38.m1.3.3.3.3.1.2.1.1.cmml"><msub id="S5.E38.m1.3.3.3.3.1.2.1.1.2" xref="S5.E38.m1.3.3.3.3.1.2.1.1.2.cmml"><mi id="S5.E38.m1.3.3.3.3.1.2.1.1.2.2" xref="S5.E38.m1.3.3.3.3.1.2.1.1.2.2.cmml">m</mi><mi id="S5.E38.m1.3.3.3.3.1.2.1.1.2.3" xref="S5.E38.m1.3.3.3.3.1.2.1.1.2.3.cmml">i</mi></msub><mo id="S5.E38.m1.3.3.3.3.1.2.1.1.1" xref="S5.E38.m1.3.3.3.3.1.2.1.1.1.cmml">=</mo><mn id="S5.E38.m1.3.3.3.3.1.2.1.1.3" xref="S5.E38.m1.3.3.3.3.1.2.1.1.3.cmml">1</mn></mrow><mo id="S5.E38.m1.3.3.3.3.1.2.1.4" stretchy="false" xref="S5.E38.m1.3.3.3.3.1.2.2.1.cmml">}</mo></mrow></mrow><mo id="S5.E38.m1.3.3.3.3.3" stretchy="false" xref="S5.E38.m1.3.3.3.4.1.cmml">|</mo></mrow><mrow id="S5.E38.m1.5.5.5.2" xref="S5.E38.m1.5.5.5.3.cmml"><mo id="S5.E38.m1.5.5.5.2.2" stretchy="false" xref="S5.E38.m1.5.5.5.3.1.cmml">|</mo><mrow id="S5.E38.m1.5.5.5.2.1.1" xref="S5.E38.m1.5.5.5.2.1.2.cmml"><mo id="S5.E38.m1.5.5.5.2.1.1.2" stretchy="false" xref="S5.E38.m1.5.5.5.2.1.2.1.cmml">{</mo><mi id="S5.E38.m1.4.4.4.1" xref="S5.E38.m1.4.4.4.1.cmml">i</mi><mo id="S5.E38.m1.5.5.5.2.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E38.m1.5.5.5.2.1.2.1.cmml">:</mo><mrow id="S5.E38.m1.5.5.5.2.1.1.1" xref="S5.E38.m1.5.5.5.2.1.1.1.cmml"><msub id="S5.E38.m1.5.5.5.2.1.1.1.2" xref="S5.E38.m1.5.5.5.2.1.1.1.2.cmml"><mover accent="true" id="S5.E38.m1.5.5.5.2.1.1.1.2.2" xref="S5.E38.m1.5.5.5.2.1.1.1.2.2.cmml"><mi id="S5.E38.m1.5.5.5.2.1.1.1.2.2.2" xref="S5.E38.m1.5.5.5.2.1.1.1.2.2.2.cmml">m</mi><mo id="S5.E38.m1.5.5.5.2.1.1.1.2.2.1" xref="S5.E38.m1.5.5.5.2.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.E38.m1.5.5.5.2.1.1.1.2.3" xref="S5.E38.m1.5.5.5.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.E38.m1.5.5.5.2.1.1.1.1" xref="S5.E38.m1.5.5.5.2.1.1.1.1.cmml">=</mo><mn id="S5.E38.m1.5.5.5.2.1.1.1.3" xref="S5.E38.m1.5.5.5.2.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E38.m1.5.5.5.2.1.1.4" stretchy="false" xref="S5.E38.m1.5.5.5.2.1.2.1.cmml">}</mo></mrow><mo id="S5.E38.m1.5.5.5.2.3" stretchy="false" xref="S5.E38.m1.5.5.5.3.1.cmml">|</mo></mrow></mfrac></mrow><mo id="S5.E38.m1.7.7.1.2" xref="S5.E38.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E38.m1.7b"><apply id="S5.E38.m1.7.7.1.1.cmml" xref="S5.E38.m1.7.7.1"><eq id="S5.E38.m1.7.7.1.1.1.cmml" xref="S5.E38.m1.7.7.1.1.1"></eq><apply id="S5.E38.m1.7.7.1.1.2.cmml" xref="S5.E38.m1.7.7.1.1.2"><times id="S5.E38.m1.7.7.1.1.2.1.cmml" xref="S5.E38.m1.7.7.1.1.2.1"></times><ci id="S5.E38.m1.7.7.1.1.2.2.cmml" xref="S5.E38.m1.7.7.1.1.2.2">𝑃</ci><ci id="S5.E38.m1.7.7.1.1.2.3.cmml" xref="S5.E38.m1.7.7.1.1.2.3">𝑟</ci><ci id="S5.E38.m1.7.7.1.1.2.4.cmml" xref="S5.E38.m1.7.7.1.1.2.4">𝑒</ci><ci id="S5.E38.m1.7.7.1.1.2.5.cmml" xref="S5.E38.m1.7.7.1.1.2.5">𝑐</ci><ci id="S5.E38.m1.7.7.1.1.2.6.cmml" xref="S5.E38.m1.7.7.1.1.2.6">𝑖</ci><ci id="S5.E38.m1.7.7.1.1.2.7.cmml" xref="S5.E38.m1.7.7.1.1.2.7">𝑠</ci><ci id="S5.E38.m1.7.7.1.1.2.8.cmml" xref="S5.E38.m1.7.7.1.1.2.8">𝑖</ci><ci id="S5.E38.m1.7.7.1.1.2.9.cmml" xref="S5.E38.m1.7.7.1.1.2.9">𝑜</ci><ci id="S5.E38.m1.7.7.1.1.2.10.cmml" xref="S5.E38.m1.7.7.1.1.2.10">𝑛</ci><ci id="S5.E38.m1.6.6.cmml" xref="S5.E38.m1.6.6">𝑡</ci></apply><apply id="S5.E38.m1.5.5.cmml" xref="S5.E38.m1.5.5"><divide id="S5.E38.m1.5.5.6.cmml" xref="S5.E38.m1.5.5"></divide><apply id="S5.E38.m1.3.3.3.4.cmml" xref="S5.E38.m1.3.3.3.3"><abs id="S5.E38.m1.3.3.3.4.1.cmml" xref="S5.E38.m1.3.3.3.3.2"></abs><apply id="S5.E38.m1.3.3.3.3.1.cmml" xref="S5.E38.m1.3.3.3.3.1"><intersect id="S5.E38.m1.3.3.3.3.1.3.cmml" xref="S5.E38.m1.3.3.3.3.1.3"></intersect><apply id="S5.E38.m1.3.3.3.3.1.1.2.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1"><csymbol cd="latexml" id="S5.E38.m1.3.3.3.3.1.1.2.1.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.2">conditional-set</csymbol><ci id="S5.E38.m1.1.1.1.1.cmml" xref="S5.E38.m1.1.1.1.1">𝑖</ci><apply id="S5.E38.m1.3.3.3.3.1.1.1.1.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1"><eq id="S5.E38.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1.1"></eq><apply id="S5.E38.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E38.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2">subscript</csymbol><apply id="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.2"><ci id="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.1.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.1">^</ci><ci id="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.2.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.2.2">𝑚</ci></apply><ci id="S5.E38.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S5.E38.m1.3.3.3.3.1.1.1.1.2.3">𝑖</ci></apply><cn id="S5.E38.m1.3.3.3.3.1.1.1.1.3.cmml" type="integer" xref="S5.E38.m1.3.3.3.3.1.1.1.1.3">1</cn></apply></apply><apply id="S5.E38.m1.3.3.3.3.1.2.2.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1"><csymbol cd="latexml" id="S5.E38.m1.3.3.3.3.1.2.2.1.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1.2">conditional-set</csymbol><ci id="S5.E38.m1.2.2.2.2.cmml" xref="S5.E38.m1.2.2.2.2">𝑖</ci><apply id="S5.E38.m1.3.3.3.3.1.2.1.1.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1.1"><eq id="S5.E38.m1.3.3.3.3.1.2.1.1.1.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1.1.1"></eq><apply id="S5.E38.m1.3.3.3.3.1.2.1.1.2.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1.1.2"><csymbol cd="ambiguous" id="S5.E38.m1.3.3.3.3.1.2.1.1.2.1.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1.1.2">subscript</csymbol><ci id="S5.E38.m1.3.3.3.3.1.2.1.1.2.2.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1.1.2.2">𝑚</ci><ci id="S5.E38.m1.3.3.3.3.1.2.1.1.2.3.cmml" xref="S5.E38.m1.3.3.3.3.1.2.1.1.2.3">𝑖</ci></apply><cn id="S5.E38.m1.3.3.3.3.1.2.1.1.3.cmml" type="integer" xref="S5.E38.m1.3.3.3.3.1.2.1.1.3">1</cn></apply></apply></apply></apply><apply id="S5.E38.m1.5.5.5.3.cmml" xref="S5.E38.m1.5.5.5.2"><abs id="S5.E38.m1.5.5.5.3.1.cmml" xref="S5.E38.m1.5.5.5.2.2"></abs><apply id="S5.E38.m1.5.5.5.2.1.2.cmml" xref="S5.E38.m1.5.5.5.2.1.1"><csymbol cd="latexml" id="S5.E38.m1.5.5.5.2.1.2.1.cmml" xref="S5.E38.m1.5.5.5.2.1.1.2">conditional-set</csymbol><ci id="S5.E38.m1.4.4.4.1.cmml" xref="S5.E38.m1.4.4.4.1">𝑖</ci><apply id="S5.E38.m1.5.5.5.2.1.1.1.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1"><eq id="S5.E38.m1.5.5.5.2.1.1.1.1.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1.1"></eq><apply id="S5.E38.m1.5.5.5.2.1.1.1.2.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="S5.E38.m1.5.5.5.2.1.1.1.2.1.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1.2">subscript</csymbol><apply id="S5.E38.m1.5.5.5.2.1.1.1.2.2.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1.2.2"><ci id="S5.E38.m1.5.5.5.2.1.1.1.2.2.1.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1.2.2.1">^</ci><ci id="S5.E38.m1.5.5.5.2.1.1.1.2.2.2.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1.2.2.2">𝑚</ci></apply><ci id="S5.E38.m1.5.5.5.2.1.1.1.2.3.cmml" xref="S5.E38.m1.5.5.5.2.1.1.1.2.3">𝑖</ci></apply><cn id="S5.E38.m1.5.5.5.2.1.1.1.3.cmml" type="integer" xref="S5.E38.m1.5.5.5.2.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E38.m1.7c">\displaystyle Precision(t)=\frac{|\{i:\hat{m}_{i}=1\}\cap\{i:m_{i}=1\}|}{|\{i:%
\hat{m}_{i}=1\}|},</annotation><annotation encoding="application/x-llamapun" id="S5.E38.m1.7d">italic_P italic_r italic_e italic_c italic_i italic_s italic_i italic_o italic_n ( italic_t ) = divide start_ARG | { italic_i : over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 } ∩ { italic_i : italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 } | end_ARG start_ARG | { italic_i : over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 } | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(38)</span></td>
</tr></tbody>
<tbody id="S5.E39"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle Recall(t)=\frac{|\{i:\hat{m}_{i}=1\}\cap\{i:m_{i}=1\}|}{|\{i:m_{%
i}=1\}|}," class="ltx_Math" display="block" id="S5.E39.m1.7"><semantics id="S5.E39.m1.7a"><mrow id="S5.E39.m1.7.7.1" xref="S5.E39.m1.7.7.1.1.cmml"><mrow id="S5.E39.m1.7.7.1.1" xref="S5.E39.m1.7.7.1.1.cmml"><mrow id="S5.E39.m1.7.7.1.1.2" xref="S5.E39.m1.7.7.1.1.2.cmml"><mi id="S5.E39.m1.7.7.1.1.2.2" xref="S5.E39.m1.7.7.1.1.2.2.cmml">R</mi><mo id="S5.E39.m1.7.7.1.1.2.1" xref="S5.E39.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E39.m1.7.7.1.1.2.3" xref="S5.E39.m1.7.7.1.1.2.3.cmml">e</mi><mo id="S5.E39.m1.7.7.1.1.2.1a" xref="S5.E39.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E39.m1.7.7.1.1.2.4" xref="S5.E39.m1.7.7.1.1.2.4.cmml">c</mi><mo id="S5.E39.m1.7.7.1.1.2.1b" xref="S5.E39.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E39.m1.7.7.1.1.2.5" xref="S5.E39.m1.7.7.1.1.2.5.cmml">a</mi><mo id="S5.E39.m1.7.7.1.1.2.1c" xref="S5.E39.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E39.m1.7.7.1.1.2.6" xref="S5.E39.m1.7.7.1.1.2.6.cmml">l</mi><mo id="S5.E39.m1.7.7.1.1.2.1d" xref="S5.E39.m1.7.7.1.1.2.1.cmml">⁢</mo><mi id="S5.E39.m1.7.7.1.1.2.7" xref="S5.E39.m1.7.7.1.1.2.7.cmml">l</mi><mo id="S5.E39.m1.7.7.1.1.2.1e" xref="S5.E39.m1.7.7.1.1.2.1.cmml">⁢</mo><mrow id="S5.E39.m1.7.7.1.1.2.8.2" xref="S5.E39.m1.7.7.1.1.2.cmml"><mo id="S5.E39.m1.7.7.1.1.2.8.2.1" stretchy="false" xref="S5.E39.m1.7.7.1.1.2.cmml">(</mo><mi id="S5.E39.m1.6.6" xref="S5.E39.m1.6.6.cmml">t</mi><mo id="S5.E39.m1.7.7.1.1.2.8.2.2" stretchy="false" xref="S5.E39.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E39.m1.7.7.1.1.1" xref="S5.E39.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S5.E39.m1.5.5" xref="S5.E39.m1.5.5.cmml"><mrow id="S5.E39.m1.3.3.3.3" xref="S5.E39.m1.3.3.3.4.cmml"><mo id="S5.E39.m1.3.3.3.3.2" stretchy="false" xref="S5.E39.m1.3.3.3.4.1.cmml">|</mo><mrow id="S5.E39.m1.3.3.3.3.1" xref="S5.E39.m1.3.3.3.3.1.cmml"><mrow id="S5.E39.m1.3.3.3.3.1.1.1" xref="S5.E39.m1.3.3.3.3.1.1.2.cmml"><mo id="S5.E39.m1.3.3.3.3.1.1.1.2" stretchy="false" xref="S5.E39.m1.3.3.3.3.1.1.2.1.cmml">{</mo><mi id="S5.E39.m1.1.1.1.1" xref="S5.E39.m1.1.1.1.1.cmml">i</mi><mo id="S5.E39.m1.3.3.3.3.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E39.m1.3.3.3.3.1.1.2.1.cmml">:</mo><mrow id="S5.E39.m1.3.3.3.3.1.1.1.1" xref="S5.E39.m1.3.3.3.3.1.1.1.1.cmml"><msub id="S5.E39.m1.3.3.3.3.1.1.1.1.2" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.cmml"><mover accent="true" id="S5.E39.m1.3.3.3.3.1.1.1.1.2.2" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.cmml"><mi id="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.2" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.2.cmml">m</mi><mo id="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.1" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.E39.m1.3.3.3.3.1.1.1.1.2.3" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.E39.m1.3.3.3.3.1.1.1.1.1" xref="S5.E39.m1.3.3.3.3.1.1.1.1.1.cmml">=</mo><mn id="S5.E39.m1.3.3.3.3.1.1.1.1.3" xref="S5.E39.m1.3.3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E39.m1.3.3.3.3.1.1.1.4" stretchy="false" xref="S5.E39.m1.3.3.3.3.1.1.2.1.cmml">}</mo></mrow><mo id="S5.E39.m1.3.3.3.3.1.3" xref="S5.E39.m1.3.3.3.3.1.3.cmml">∩</mo><mrow id="S5.E39.m1.3.3.3.3.1.2.1" xref="S5.E39.m1.3.3.3.3.1.2.2.cmml"><mo id="S5.E39.m1.3.3.3.3.1.2.1.2" stretchy="false" xref="S5.E39.m1.3.3.3.3.1.2.2.1.cmml">{</mo><mi id="S5.E39.m1.2.2.2.2" xref="S5.E39.m1.2.2.2.2.cmml">i</mi><mo id="S5.E39.m1.3.3.3.3.1.2.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E39.m1.3.3.3.3.1.2.2.1.cmml">:</mo><mrow id="S5.E39.m1.3.3.3.3.1.2.1.1" xref="S5.E39.m1.3.3.3.3.1.2.1.1.cmml"><msub id="S5.E39.m1.3.3.3.3.1.2.1.1.2" xref="S5.E39.m1.3.3.3.3.1.2.1.1.2.cmml"><mi id="S5.E39.m1.3.3.3.3.1.2.1.1.2.2" xref="S5.E39.m1.3.3.3.3.1.2.1.1.2.2.cmml">m</mi><mi id="S5.E39.m1.3.3.3.3.1.2.1.1.2.3" xref="S5.E39.m1.3.3.3.3.1.2.1.1.2.3.cmml">i</mi></msub><mo id="S5.E39.m1.3.3.3.3.1.2.1.1.1" xref="S5.E39.m1.3.3.3.3.1.2.1.1.1.cmml">=</mo><mn id="S5.E39.m1.3.3.3.3.1.2.1.1.3" xref="S5.E39.m1.3.3.3.3.1.2.1.1.3.cmml">1</mn></mrow><mo id="S5.E39.m1.3.3.3.3.1.2.1.4" stretchy="false" xref="S5.E39.m1.3.3.3.3.1.2.2.1.cmml">}</mo></mrow></mrow><mo id="S5.E39.m1.3.3.3.3.3" stretchy="false" xref="S5.E39.m1.3.3.3.4.1.cmml">|</mo></mrow><mrow id="S5.E39.m1.5.5.5.2" xref="S5.E39.m1.5.5.5.3.cmml"><mo id="S5.E39.m1.5.5.5.2.2" stretchy="false" xref="S5.E39.m1.5.5.5.3.1.cmml">|</mo><mrow id="S5.E39.m1.5.5.5.2.1.1" xref="S5.E39.m1.5.5.5.2.1.2.cmml"><mo id="S5.E39.m1.5.5.5.2.1.1.2" stretchy="false" xref="S5.E39.m1.5.5.5.2.1.2.1.cmml">{</mo><mi id="S5.E39.m1.4.4.4.1" xref="S5.E39.m1.4.4.4.1.cmml">i</mi><mo id="S5.E39.m1.5.5.5.2.1.1.3" lspace="0.278em" rspace="0.278em" xref="S5.E39.m1.5.5.5.2.1.2.1.cmml">:</mo><mrow id="S5.E39.m1.5.5.5.2.1.1.1" xref="S5.E39.m1.5.5.5.2.1.1.1.cmml"><msub id="S5.E39.m1.5.5.5.2.1.1.1.2" xref="S5.E39.m1.5.5.5.2.1.1.1.2.cmml"><mi id="S5.E39.m1.5.5.5.2.1.1.1.2.2" xref="S5.E39.m1.5.5.5.2.1.1.1.2.2.cmml">m</mi><mi id="S5.E39.m1.5.5.5.2.1.1.1.2.3" xref="S5.E39.m1.5.5.5.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.E39.m1.5.5.5.2.1.1.1.1" xref="S5.E39.m1.5.5.5.2.1.1.1.1.cmml">=</mo><mn id="S5.E39.m1.5.5.5.2.1.1.1.3" xref="S5.E39.m1.5.5.5.2.1.1.1.3.cmml">1</mn></mrow><mo id="S5.E39.m1.5.5.5.2.1.1.4" stretchy="false" xref="S5.E39.m1.5.5.5.2.1.2.1.cmml">}</mo></mrow><mo id="S5.E39.m1.5.5.5.2.3" stretchy="false" xref="S5.E39.m1.5.5.5.3.1.cmml">|</mo></mrow></mfrac></mrow><mo id="S5.E39.m1.7.7.1.2" xref="S5.E39.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E39.m1.7b"><apply id="S5.E39.m1.7.7.1.1.cmml" xref="S5.E39.m1.7.7.1"><eq id="S5.E39.m1.7.7.1.1.1.cmml" xref="S5.E39.m1.7.7.1.1.1"></eq><apply id="S5.E39.m1.7.7.1.1.2.cmml" xref="S5.E39.m1.7.7.1.1.2"><times id="S5.E39.m1.7.7.1.1.2.1.cmml" xref="S5.E39.m1.7.7.1.1.2.1"></times><ci id="S5.E39.m1.7.7.1.1.2.2.cmml" xref="S5.E39.m1.7.7.1.1.2.2">𝑅</ci><ci id="S5.E39.m1.7.7.1.1.2.3.cmml" xref="S5.E39.m1.7.7.1.1.2.3">𝑒</ci><ci id="S5.E39.m1.7.7.1.1.2.4.cmml" xref="S5.E39.m1.7.7.1.1.2.4">𝑐</ci><ci id="S5.E39.m1.7.7.1.1.2.5.cmml" xref="S5.E39.m1.7.7.1.1.2.5">𝑎</ci><ci id="S5.E39.m1.7.7.1.1.2.6.cmml" xref="S5.E39.m1.7.7.1.1.2.6">𝑙</ci><ci id="S5.E39.m1.7.7.1.1.2.7.cmml" xref="S5.E39.m1.7.7.1.1.2.7">𝑙</ci><ci id="S5.E39.m1.6.6.cmml" xref="S5.E39.m1.6.6">𝑡</ci></apply><apply id="S5.E39.m1.5.5.cmml" xref="S5.E39.m1.5.5"><divide id="S5.E39.m1.5.5.6.cmml" xref="S5.E39.m1.5.5"></divide><apply id="S5.E39.m1.3.3.3.4.cmml" xref="S5.E39.m1.3.3.3.3"><abs id="S5.E39.m1.3.3.3.4.1.cmml" xref="S5.E39.m1.3.3.3.3.2"></abs><apply id="S5.E39.m1.3.3.3.3.1.cmml" xref="S5.E39.m1.3.3.3.3.1"><intersect id="S5.E39.m1.3.3.3.3.1.3.cmml" xref="S5.E39.m1.3.3.3.3.1.3"></intersect><apply id="S5.E39.m1.3.3.3.3.1.1.2.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1"><csymbol cd="latexml" id="S5.E39.m1.3.3.3.3.1.1.2.1.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.2">conditional-set</csymbol><ci id="S5.E39.m1.1.1.1.1.cmml" xref="S5.E39.m1.1.1.1.1">𝑖</ci><apply id="S5.E39.m1.3.3.3.3.1.1.1.1.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1"><eq id="S5.E39.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1.1"></eq><apply id="S5.E39.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E39.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2">subscript</csymbol><apply id="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.2"><ci id="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.1.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.1">^</ci><ci id="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.2.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.2.2">𝑚</ci></apply><ci id="S5.E39.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S5.E39.m1.3.3.3.3.1.1.1.1.2.3">𝑖</ci></apply><cn id="S5.E39.m1.3.3.3.3.1.1.1.1.3.cmml" type="integer" xref="S5.E39.m1.3.3.3.3.1.1.1.1.3">1</cn></apply></apply><apply id="S5.E39.m1.3.3.3.3.1.2.2.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1"><csymbol cd="latexml" id="S5.E39.m1.3.3.3.3.1.2.2.1.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1.2">conditional-set</csymbol><ci id="S5.E39.m1.2.2.2.2.cmml" xref="S5.E39.m1.2.2.2.2">𝑖</ci><apply id="S5.E39.m1.3.3.3.3.1.2.1.1.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1.1"><eq id="S5.E39.m1.3.3.3.3.1.2.1.1.1.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1.1.1"></eq><apply id="S5.E39.m1.3.3.3.3.1.2.1.1.2.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1.1.2"><csymbol cd="ambiguous" id="S5.E39.m1.3.3.3.3.1.2.1.1.2.1.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1.1.2">subscript</csymbol><ci id="S5.E39.m1.3.3.3.3.1.2.1.1.2.2.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1.1.2.2">𝑚</ci><ci id="S5.E39.m1.3.3.3.3.1.2.1.1.2.3.cmml" xref="S5.E39.m1.3.3.3.3.1.2.1.1.2.3">𝑖</ci></apply><cn id="S5.E39.m1.3.3.3.3.1.2.1.1.3.cmml" type="integer" xref="S5.E39.m1.3.3.3.3.1.2.1.1.3">1</cn></apply></apply></apply></apply><apply id="S5.E39.m1.5.5.5.3.cmml" xref="S5.E39.m1.5.5.5.2"><abs id="S5.E39.m1.5.5.5.3.1.cmml" xref="S5.E39.m1.5.5.5.2.2"></abs><apply id="S5.E39.m1.5.5.5.2.1.2.cmml" xref="S5.E39.m1.5.5.5.2.1.1"><csymbol cd="latexml" id="S5.E39.m1.5.5.5.2.1.2.1.cmml" xref="S5.E39.m1.5.5.5.2.1.1.2">conditional-set</csymbol><ci id="S5.E39.m1.4.4.4.1.cmml" xref="S5.E39.m1.4.4.4.1">𝑖</ci><apply id="S5.E39.m1.5.5.5.2.1.1.1.cmml" xref="S5.E39.m1.5.5.5.2.1.1.1"><eq id="S5.E39.m1.5.5.5.2.1.1.1.1.cmml" xref="S5.E39.m1.5.5.5.2.1.1.1.1"></eq><apply id="S5.E39.m1.5.5.5.2.1.1.1.2.cmml" xref="S5.E39.m1.5.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="S5.E39.m1.5.5.5.2.1.1.1.2.1.cmml" xref="S5.E39.m1.5.5.5.2.1.1.1.2">subscript</csymbol><ci id="S5.E39.m1.5.5.5.2.1.1.1.2.2.cmml" xref="S5.E39.m1.5.5.5.2.1.1.1.2.2">𝑚</ci><ci id="S5.E39.m1.5.5.5.2.1.1.1.2.3.cmml" xref="S5.E39.m1.5.5.5.2.1.1.1.2.3">𝑖</ci></apply><cn id="S5.E39.m1.5.5.5.2.1.1.1.3.cmml" type="integer" xref="S5.E39.m1.5.5.5.2.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E39.m1.7c">\displaystyle Recall(t)=\frac{|\{i:\hat{m}_{i}=1\}\cap\{i:m_{i}=1\}|}{|\{i:m_{%
i}=1\}|},</annotation><annotation encoding="application/x-llamapun" id="S5.E39.m1.7d">italic_R italic_e italic_c italic_a italic_l italic_l ( italic_t ) = divide start_ARG | { italic_i : over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 } ∩ { italic_i : italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 } | end_ARG start_ARG | { italic_i : italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 } | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(39)</span></td>
</tr></tbody>
<tbody id="S5.E40"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle F1(t)=\frac{2}{\frac{1}{Precision(t)}+\frac{1}{Recall(t)}}," class="ltx_Math" display="block" id="S5.E40.m1.4"><semantics id="S5.E40.m1.4a"><mrow id="S5.E40.m1.4.4.1" xref="S5.E40.m1.4.4.1.1.cmml"><mrow id="S5.E40.m1.4.4.1.1" xref="S5.E40.m1.4.4.1.1.cmml"><mrow id="S5.E40.m1.4.4.1.1.2" xref="S5.E40.m1.4.4.1.1.2.cmml"><mi id="S5.E40.m1.4.4.1.1.2.2" xref="S5.E40.m1.4.4.1.1.2.2.cmml">F</mi><mo id="S5.E40.m1.4.4.1.1.2.1" xref="S5.E40.m1.4.4.1.1.2.1.cmml">⁢</mo><mn id="S5.E40.m1.4.4.1.1.2.3" xref="S5.E40.m1.4.4.1.1.2.3.cmml">1</mn><mo id="S5.E40.m1.4.4.1.1.2.1a" xref="S5.E40.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="S5.E40.m1.4.4.1.1.2.4.2" xref="S5.E40.m1.4.4.1.1.2.cmml"><mo id="S5.E40.m1.4.4.1.1.2.4.2.1" stretchy="false" xref="S5.E40.m1.4.4.1.1.2.cmml">(</mo><mi id="S5.E40.m1.3.3" xref="S5.E40.m1.3.3.cmml">t</mi><mo id="S5.E40.m1.4.4.1.1.2.4.2.2" stretchy="false" xref="S5.E40.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E40.m1.4.4.1.1.1" xref="S5.E40.m1.4.4.1.1.1.cmml">=</mo><mfrac id="S5.E40.m1.2.2" xref="S5.E40.m1.2.2.cmml"><mn id="S5.E40.m1.2.2.4" xref="S5.E40.m1.2.2.4.cmml">2</mn><mrow id="S5.E40.m1.2.2.2" xref="S5.E40.m1.2.2.2.cmml"><mfrac id="S5.E40.m1.1.1.1.1" xref="S5.E40.m1.1.1.1.1.cmml"><mn id="S5.E40.m1.1.1.1.1.3" xref="S5.E40.m1.1.1.1.1.3.cmml">1</mn><mrow id="S5.E40.m1.1.1.1.1.1" xref="S5.E40.m1.1.1.1.1.1.cmml"><mi id="S5.E40.m1.1.1.1.1.1.3" xref="S5.E40.m1.1.1.1.1.1.3.cmml">P</mi><mo id="S5.E40.m1.1.1.1.1.1.2" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.4" xref="S5.E40.m1.1.1.1.1.1.4.cmml">r</mi><mo id="S5.E40.m1.1.1.1.1.1.2a" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.5" xref="S5.E40.m1.1.1.1.1.1.5.cmml">e</mi><mo id="S5.E40.m1.1.1.1.1.1.2b" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.6" xref="S5.E40.m1.1.1.1.1.1.6.cmml">c</mi><mo id="S5.E40.m1.1.1.1.1.1.2c" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.7" xref="S5.E40.m1.1.1.1.1.1.7.cmml">i</mi><mo id="S5.E40.m1.1.1.1.1.1.2d" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.8" xref="S5.E40.m1.1.1.1.1.1.8.cmml">s</mi><mo id="S5.E40.m1.1.1.1.1.1.2e" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.9" xref="S5.E40.m1.1.1.1.1.1.9.cmml">i</mi><mo id="S5.E40.m1.1.1.1.1.1.2f" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.10" xref="S5.E40.m1.1.1.1.1.1.10.cmml">o</mi><mo id="S5.E40.m1.1.1.1.1.1.2g" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S5.E40.m1.1.1.1.1.1.11" xref="S5.E40.m1.1.1.1.1.1.11.cmml">n</mi><mo id="S5.E40.m1.1.1.1.1.1.2h" xref="S5.E40.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E40.m1.1.1.1.1.1.12.2" xref="S5.E40.m1.1.1.1.1.1.cmml"><mo id="S5.E40.m1.1.1.1.1.1.12.2.1" stretchy="false" xref="S5.E40.m1.1.1.1.1.1.cmml">(</mo><mi id="S5.E40.m1.1.1.1.1.1.1" xref="S5.E40.m1.1.1.1.1.1.1.cmml">t</mi><mo id="S5.E40.m1.1.1.1.1.1.12.2.2" stretchy="false" xref="S5.E40.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.E40.m1.2.2.2.3" xref="S5.E40.m1.2.2.2.3.cmml">+</mo><mfrac id="S5.E40.m1.2.2.2.2" xref="S5.E40.m1.2.2.2.2.cmml"><mn id="S5.E40.m1.2.2.2.2.3" xref="S5.E40.m1.2.2.2.2.3.cmml">1</mn><mrow id="S5.E40.m1.2.2.2.2.1" xref="S5.E40.m1.2.2.2.2.1.cmml"><mi id="S5.E40.m1.2.2.2.2.1.3" xref="S5.E40.m1.2.2.2.2.1.3.cmml">R</mi><mo id="S5.E40.m1.2.2.2.2.1.2" xref="S5.E40.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S5.E40.m1.2.2.2.2.1.4" xref="S5.E40.m1.2.2.2.2.1.4.cmml">e</mi><mo id="S5.E40.m1.2.2.2.2.1.2a" xref="S5.E40.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S5.E40.m1.2.2.2.2.1.5" xref="S5.E40.m1.2.2.2.2.1.5.cmml">c</mi><mo id="S5.E40.m1.2.2.2.2.1.2b" xref="S5.E40.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S5.E40.m1.2.2.2.2.1.6" xref="S5.E40.m1.2.2.2.2.1.6.cmml">a</mi><mo id="S5.E40.m1.2.2.2.2.1.2c" xref="S5.E40.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S5.E40.m1.2.2.2.2.1.7" xref="S5.E40.m1.2.2.2.2.1.7.cmml">l</mi><mo id="S5.E40.m1.2.2.2.2.1.2d" xref="S5.E40.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S5.E40.m1.2.2.2.2.1.8" xref="S5.E40.m1.2.2.2.2.1.8.cmml">l</mi><mo id="S5.E40.m1.2.2.2.2.1.2e" xref="S5.E40.m1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S5.E40.m1.2.2.2.2.1.9.2" xref="S5.E40.m1.2.2.2.2.1.cmml"><mo id="S5.E40.m1.2.2.2.2.1.9.2.1" stretchy="false" xref="S5.E40.m1.2.2.2.2.1.cmml">(</mo><mi id="S5.E40.m1.2.2.2.2.1.1" xref="S5.E40.m1.2.2.2.2.1.1.cmml">t</mi><mo id="S5.E40.m1.2.2.2.2.1.9.2.2" stretchy="false" xref="S5.E40.m1.2.2.2.2.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac></mrow><mo id="S5.E40.m1.4.4.1.2" xref="S5.E40.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E40.m1.4b"><apply id="S5.E40.m1.4.4.1.1.cmml" xref="S5.E40.m1.4.4.1"><eq id="S5.E40.m1.4.4.1.1.1.cmml" xref="S5.E40.m1.4.4.1.1.1"></eq><apply id="S5.E40.m1.4.4.1.1.2.cmml" xref="S5.E40.m1.4.4.1.1.2"><times id="S5.E40.m1.4.4.1.1.2.1.cmml" xref="S5.E40.m1.4.4.1.1.2.1"></times><ci id="S5.E40.m1.4.4.1.1.2.2.cmml" xref="S5.E40.m1.4.4.1.1.2.2">𝐹</ci><cn id="S5.E40.m1.4.4.1.1.2.3.cmml" type="integer" xref="S5.E40.m1.4.4.1.1.2.3">1</cn><ci id="S5.E40.m1.3.3.cmml" xref="S5.E40.m1.3.3">𝑡</ci></apply><apply id="S5.E40.m1.2.2.cmml" xref="S5.E40.m1.2.2"><divide id="S5.E40.m1.2.2.3.cmml" xref="S5.E40.m1.2.2"></divide><cn id="S5.E40.m1.2.2.4.cmml" type="integer" xref="S5.E40.m1.2.2.4">2</cn><apply id="S5.E40.m1.2.2.2.cmml" xref="S5.E40.m1.2.2.2"><plus id="S5.E40.m1.2.2.2.3.cmml" xref="S5.E40.m1.2.2.2.3"></plus><apply id="S5.E40.m1.1.1.1.1.cmml" xref="S5.E40.m1.1.1.1.1"><divide id="S5.E40.m1.1.1.1.1.2.cmml" xref="S5.E40.m1.1.1.1.1"></divide><cn id="S5.E40.m1.1.1.1.1.3.cmml" type="integer" xref="S5.E40.m1.1.1.1.1.3">1</cn><apply id="S5.E40.m1.1.1.1.1.1.cmml" xref="S5.E40.m1.1.1.1.1.1"><times id="S5.E40.m1.1.1.1.1.1.2.cmml" xref="S5.E40.m1.1.1.1.1.1.2"></times><ci id="S5.E40.m1.1.1.1.1.1.3.cmml" xref="S5.E40.m1.1.1.1.1.1.3">𝑃</ci><ci id="S5.E40.m1.1.1.1.1.1.4.cmml" xref="S5.E40.m1.1.1.1.1.1.4">𝑟</ci><ci id="S5.E40.m1.1.1.1.1.1.5.cmml" xref="S5.E40.m1.1.1.1.1.1.5">𝑒</ci><ci id="S5.E40.m1.1.1.1.1.1.6.cmml" xref="S5.E40.m1.1.1.1.1.1.6">𝑐</ci><ci id="S5.E40.m1.1.1.1.1.1.7.cmml" xref="S5.E40.m1.1.1.1.1.1.7">𝑖</ci><ci id="S5.E40.m1.1.1.1.1.1.8.cmml" xref="S5.E40.m1.1.1.1.1.1.8">𝑠</ci><ci id="S5.E40.m1.1.1.1.1.1.9.cmml" xref="S5.E40.m1.1.1.1.1.1.9">𝑖</ci><ci id="S5.E40.m1.1.1.1.1.1.10.cmml" xref="S5.E40.m1.1.1.1.1.1.10">𝑜</ci><ci id="S5.E40.m1.1.1.1.1.1.11.cmml" xref="S5.E40.m1.1.1.1.1.1.11">𝑛</ci><ci id="S5.E40.m1.1.1.1.1.1.1.cmml" xref="S5.E40.m1.1.1.1.1.1.1">𝑡</ci></apply></apply><apply id="S5.E40.m1.2.2.2.2.cmml" xref="S5.E40.m1.2.2.2.2"><divide id="S5.E40.m1.2.2.2.2.2.cmml" xref="S5.E40.m1.2.2.2.2"></divide><cn id="S5.E40.m1.2.2.2.2.3.cmml" type="integer" xref="S5.E40.m1.2.2.2.2.3">1</cn><apply id="S5.E40.m1.2.2.2.2.1.cmml" xref="S5.E40.m1.2.2.2.2.1"><times id="S5.E40.m1.2.2.2.2.1.2.cmml" xref="S5.E40.m1.2.2.2.2.1.2"></times><ci id="S5.E40.m1.2.2.2.2.1.3.cmml" xref="S5.E40.m1.2.2.2.2.1.3">𝑅</ci><ci id="S5.E40.m1.2.2.2.2.1.4.cmml" xref="S5.E40.m1.2.2.2.2.1.4">𝑒</ci><ci id="S5.E40.m1.2.2.2.2.1.5.cmml" xref="S5.E40.m1.2.2.2.2.1.5">𝑐</ci><ci id="S5.E40.m1.2.2.2.2.1.6.cmml" xref="S5.E40.m1.2.2.2.2.1.6">𝑎</ci><ci id="S5.E40.m1.2.2.2.2.1.7.cmml" xref="S5.E40.m1.2.2.2.2.1.7">𝑙</ci><ci id="S5.E40.m1.2.2.2.2.1.8.cmml" xref="S5.E40.m1.2.2.2.2.1.8">𝑙</ci><ci id="S5.E40.m1.2.2.2.2.1.1.cmml" xref="S5.E40.m1.2.2.2.2.1.1">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E40.m1.4c">\displaystyle F1(t)=\frac{2}{\frac{1}{Precision(t)}+\frac{1}{Recall(t)}},</annotation><annotation encoding="application/x-llamapun" id="S5.E40.m1.4d">italic_F 1 ( italic_t ) = divide start_ARG 2 end_ARG start_ARG divide start_ARG 1 end_ARG start_ARG italic_P italic_r italic_e italic_c italic_i italic_s italic_i italic_o italic_n ( italic_t ) end_ARG + divide start_ARG 1 end_ARG start_ARG italic_R italic_e italic_c italic_a italic_l italic_l ( italic_t ) end_ARG end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(40)</span></td>
</tr></tbody>
<tbody id="S5.E41"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle F1=\frac{1}{N_{h}}\sum_{i=1}^{N_{h}}F1(i)," class="ltx_Math" display="block" id="S5.E41.m1.2"><semantics id="S5.E41.m1.2a"><mrow id="S5.E41.m1.2.2.1" xref="S5.E41.m1.2.2.1.1.cmml"><mrow id="S5.E41.m1.2.2.1.1" xref="S5.E41.m1.2.2.1.1.cmml"><mrow id="S5.E41.m1.2.2.1.1.2" xref="S5.E41.m1.2.2.1.1.2.cmml"><mi id="S5.E41.m1.2.2.1.1.2.2" xref="S5.E41.m1.2.2.1.1.2.2.cmml">F</mi><mo id="S5.E41.m1.2.2.1.1.2.1" xref="S5.E41.m1.2.2.1.1.2.1.cmml">⁢</mo><mn id="S5.E41.m1.2.2.1.1.2.3" xref="S5.E41.m1.2.2.1.1.2.3.cmml">1</mn></mrow><mo id="S5.E41.m1.2.2.1.1.1" xref="S5.E41.m1.2.2.1.1.1.cmml">=</mo><mrow id="S5.E41.m1.2.2.1.1.3" xref="S5.E41.m1.2.2.1.1.3.cmml"><mfrac id="S5.E41.m1.2.2.1.1.3.2" xref="S5.E41.m1.2.2.1.1.3.2.cmml"><mn id="S5.E41.m1.2.2.1.1.3.2.2" xref="S5.E41.m1.2.2.1.1.3.2.2.cmml">1</mn><msub id="S5.E41.m1.2.2.1.1.3.2.3" xref="S5.E41.m1.2.2.1.1.3.2.3.cmml"><mi id="S5.E41.m1.2.2.1.1.3.2.3.2" xref="S5.E41.m1.2.2.1.1.3.2.3.2.cmml">N</mi><mi id="S5.E41.m1.2.2.1.1.3.2.3.3" xref="S5.E41.m1.2.2.1.1.3.2.3.3.cmml">h</mi></msub></mfrac><mo id="S5.E41.m1.2.2.1.1.3.1" xref="S5.E41.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S5.E41.m1.2.2.1.1.3.3" xref="S5.E41.m1.2.2.1.1.3.3.cmml"><munderover id="S5.E41.m1.2.2.1.1.3.3.1" xref="S5.E41.m1.2.2.1.1.3.3.1.cmml"><mo id="S5.E41.m1.2.2.1.1.3.3.1.2.2" movablelimits="false" xref="S5.E41.m1.2.2.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S5.E41.m1.2.2.1.1.3.3.1.2.3" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3.cmml"><mi id="S5.E41.m1.2.2.1.1.3.3.1.2.3.2" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S5.E41.m1.2.2.1.1.3.3.1.2.3.1" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S5.E41.m1.2.2.1.1.3.3.1.2.3.3" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S5.E41.m1.2.2.1.1.3.3.1.3" xref="S5.E41.m1.2.2.1.1.3.3.1.3.cmml"><mi id="S5.E41.m1.2.2.1.1.3.3.1.3.2" xref="S5.E41.m1.2.2.1.1.3.3.1.3.2.cmml">N</mi><mi id="S5.E41.m1.2.2.1.1.3.3.1.3.3" xref="S5.E41.m1.2.2.1.1.3.3.1.3.3.cmml">h</mi></msub></munderover><mrow id="S5.E41.m1.2.2.1.1.3.3.2" xref="S5.E41.m1.2.2.1.1.3.3.2.cmml"><mi id="S5.E41.m1.2.2.1.1.3.3.2.2" xref="S5.E41.m1.2.2.1.1.3.3.2.2.cmml">F</mi><mo id="S5.E41.m1.2.2.1.1.3.3.2.1" xref="S5.E41.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mn id="S5.E41.m1.2.2.1.1.3.3.2.3" xref="S5.E41.m1.2.2.1.1.3.3.2.3.cmml">1</mn><mo id="S5.E41.m1.2.2.1.1.3.3.2.1a" xref="S5.E41.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mrow id="S5.E41.m1.2.2.1.1.3.3.2.4.2" xref="S5.E41.m1.2.2.1.1.3.3.2.cmml"><mo id="S5.E41.m1.2.2.1.1.3.3.2.4.2.1" stretchy="false" xref="S5.E41.m1.2.2.1.1.3.3.2.cmml">(</mo><mi id="S5.E41.m1.1.1" xref="S5.E41.m1.1.1.cmml">i</mi><mo id="S5.E41.m1.2.2.1.1.3.3.2.4.2.2" stretchy="false" xref="S5.E41.m1.2.2.1.1.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S5.E41.m1.2.2.1.2" xref="S5.E41.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E41.m1.2b"><apply id="S5.E41.m1.2.2.1.1.cmml" xref="S5.E41.m1.2.2.1"><eq id="S5.E41.m1.2.2.1.1.1.cmml" xref="S5.E41.m1.2.2.1.1.1"></eq><apply id="S5.E41.m1.2.2.1.1.2.cmml" xref="S5.E41.m1.2.2.1.1.2"><times id="S5.E41.m1.2.2.1.1.2.1.cmml" xref="S5.E41.m1.2.2.1.1.2.1"></times><ci id="S5.E41.m1.2.2.1.1.2.2.cmml" xref="S5.E41.m1.2.2.1.1.2.2">𝐹</ci><cn id="S5.E41.m1.2.2.1.1.2.3.cmml" type="integer" xref="S5.E41.m1.2.2.1.1.2.3">1</cn></apply><apply id="S5.E41.m1.2.2.1.1.3.cmml" xref="S5.E41.m1.2.2.1.1.3"><times id="S5.E41.m1.2.2.1.1.3.1.cmml" xref="S5.E41.m1.2.2.1.1.3.1"></times><apply id="S5.E41.m1.2.2.1.1.3.2.cmml" xref="S5.E41.m1.2.2.1.1.3.2"><divide id="S5.E41.m1.2.2.1.1.3.2.1.cmml" xref="S5.E41.m1.2.2.1.1.3.2"></divide><cn id="S5.E41.m1.2.2.1.1.3.2.2.cmml" type="integer" xref="S5.E41.m1.2.2.1.1.3.2.2">1</cn><apply id="S5.E41.m1.2.2.1.1.3.2.3.cmml" xref="S5.E41.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E41.m1.2.2.1.1.3.2.3.1.cmml" xref="S5.E41.m1.2.2.1.1.3.2.3">subscript</csymbol><ci id="S5.E41.m1.2.2.1.1.3.2.3.2.cmml" xref="S5.E41.m1.2.2.1.1.3.2.3.2">𝑁</ci><ci id="S5.E41.m1.2.2.1.1.3.2.3.3.cmml" xref="S5.E41.m1.2.2.1.1.3.2.3.3">ℎ</ci></apply></apply><apply id="S5.E41.m1.2.2.1.1.3.3.cmml" xref="S5.E41.m1.2.2.1.1.3.3"><apply id="S5.E41.m1.2.2.1.1.3.3.1.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E41.m1.2.2.1.1.3.3.1.1.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1">superscript</csymbol><apply id="S5.E41.m1.2.2.1.1.3.3.1.2.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E41.m1.2.2.1.1.3.3.1.2.1.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1">subscript</csymbol><sum id="S5.E41.m1.2.2.1.1.3.3.1.2.2.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.2.2"></sum><apply id="S5.E41.m1.2.2.1.1.3.3.1.2.3.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3"><eq id="S5.E41.m1.2.2.1.1.3.3.1.2.3.1.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3.1"></eq><ci id="S5.E41.m1.2.2.1.1.3.3.1.2.3.2.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S5.E41.m1.2.2.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S5.E41.m1.2.2.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S5.E41.m1.2.2.1.1.3.3.1.3.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S5.E41.m1.2.2.1.1.3.3.1.3.1.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.3">subscript</csymbol><ci id="S5.E41.m1.2.2.1.1.3.3.1.3.2.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.3.2">𝑁</ci><ci id="S5.E41.m1.2.2.1.1.3.3.1.3.3.cmml" xref="S5.E41.m1.2.2.1.1.3.3.1.3.3">ℎ</ci></apply></apply><apply id="S5.E41.m1.2.2.1.1.3.3.2.cmml" xref="S5.E41.m1.2.2.1.1.3.3.2"><times id="S5.E41.m1.2.2.1.1.3.3.2.1.cmml" xref="S5.E41.m1.2.2.1.1.3.3.2.1"></times><ci id="S5.E41.m1.2.2.1.1.3.3.2.2.cmml" xref="S5.E41.m1.2.2.1.1.3.3.2.2">𝐹</ci><cn id="S5.E41.m1.2.2.1.1.3.3.2.3.cmml" type="integer" xref="S5.E41.m1.2.2.1.1.3.3.2.3">1</cn><ci id="S5.E41.m1.1.1.cmml" xref="S5.E41.m1.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E41.m1.2c">\displaystyle F1=\frac{1}{N_{h}}\sum_{i=1}^{N_{h}}F1(i),</annotation><annotation encoding="application/x-llamapun" id="S5.E41.m1.2d">italic_F 1 = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_F 1 ( italic_i ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(41)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.p4.2">where <math alttext="N_{h}" class="ltx_Math" display="inline" id="S5.SS3.p4.1.m1.1"><semantics id="S5.SS3.p4.1.m1.1a"><msub id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml"><mi id="S5.SS3.p4.1.m1.1.1.2" xref="S5.SS3.p4.1.m1.1.1.2.cmml">N</mi><mi id="S5.SS3.p4.1.m1.1.1.3" xref="S5.SS3.p4.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><apply id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.1.m1.1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p4.1.m1.1.1.2.cmml" xref="S5.SS3.p4.1.m1.1.1.2">𝑁</ci><ci id="S5.SS3.p4.1.m1.1.1.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">N_{h}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> represents the total number of visits for patient <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p4.2.m2.1"><semantics id="S5.SS3.p4.2.m2.1a"><mi id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><ci id="S5.SS3.p4.2.m2.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.2.m2.1d">italic_h</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p5">
<p class="ltx_p" id="S5.SS3.p5.10"><span class="ltx_text ltx_font_bold" id="S5.SS3.p5.10.1">PRAUC</span> (Precision-Recall Area Under Curve) assesses model performance across different recall levels, indicating the ability to maintain model precision with increasing recall.</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="Sx2.EGx12">
<tbody id="S5.E42"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle PRAUC(t)=\sum_{k=1}^{|M|}Precision_{k}(t)\triangle Recall_{k}(t)," class="ltx_Math" display="block" id="S5.E42.m1.5"><semantics id="S5.E42.m1.5a"><mrow id="S5.E42.m1.5.5.1" xref="S5.E42.m1.5.5.1.1.cmml"><mrow id="S5.E42.m1.5.5.1.1" xref="S5.E42.m1.5.5.1.1.cmml"><mrow id="S5.E42.m1.5.5.1.1.2" xref="S5.E42.m1.5.5.1.1.2.cmml"><mi id="S5.E42.m1.5.5.1.1.2.2" xref="S5.E42.m1.5.5.1.1.2.2.cmml">P</mi><mo id="S5.E42.m1.5.5.1.1.2.1" xref="S5.E42.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.2.3" xref="S5.E42.m1.5.5.1.1.2.3.cmml">R</mi><mo id="S5.E42.m1.5.5.1.1.2.1a" xref="S5.E42.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.2.4" xref="S5.E42.m1.5.5.1.1.2.4.cmml">A</mi><mo id="S5.E42.m1.5.5.1.1.2.1b" xref="S5.E42.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.2.5" xref="S5.E42.m1.5.5.1.1.2.5.cmml">U</mi><mo id="S5.E42.m1.5.5.1.1.2.1c" xref="S5.E42.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.2.6" xref="S5.E42.m1.5.5.1.1.2.6.cmml">C</mi><mo id="S5.E42.m1.5.5.1.1.2.1d" xref="S5.E42.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S5.E42.m1.5.5.1.1.2.7.2" xref="S5.E42.m1.5.5.1.1.2.cmml"><mo id="S5.E42.m1.5.5.1.1.2.7.2.1" stretchy="false" xref="S5.E42.m1.5.5.1.1.2.cmml">(</mo><mi id="S5.E42.m1.2.2" xref="S5.E42.m1.2.2.cmml">t</mi><mo id="S5.E42.m1.5.5.1.1.2.7.2.2" stretchy="false" xref="S5.E42.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E42.m1.5.5.1.1.1" rspace="0.111em" xref="S5.E42.m1.5.5.1.1.1.cmml">=</mo><mrow id="S5.E42.m1.5.5.1.1.3" xref="S5.E42.m1.5.5.1.1.3.cmml"><munderover id="S5.E42.m1.5.5.1.1.3.1" xref="S5.E42.m1.5.5.1.1.3.1.cmml"><mo id="S5.E42.m1.5.5.1.1.3.1.2.2" movablelimits="false" xref="S5.E42.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S5.E42.m1.5.5.1.1.3.1.2.3" xref="S5.E42.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S5.E42.m1.5.5.1.1.3.1.2.3.2" xref="S5.E42.m1.5.5.1.1.3.1.2.3.2.cmml">k</mi><mo id="S5.E42.m1.5.5.1.1.3.1.2.3.1" xref="S5.E42.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S5.E42.m1.5.5.1.1.3.1.2.3.3" xref="S5.E42.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S5.E42.m1.1.1.1.3" xref="S5.E42.m1.1.1.1.2.cmml"><mo id="S5.E42.m1.1.1.1.3.1" stretchy="false" xref="S5.E42.m1.1.1.1.2.1.cmml">|</mo><mi id="S5.E42.m1.1.1.1.1" xref="S5.E42.m1.1.1.1.1.cmml">M</mi><mo id="S5.E42.m1.1.1.1.3.2" stretchy="false" xref="S5.E42.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S5.E42.m1.5.5.1.1.3.2" xref="S5.E42.m1.5.5.1.1.3.2.cmml"><mi id="S5.E42.m1.5.5.1.1.3.2.2" xref="S5.E42.m1.5.5.1.1.3.2.2.cmml">P</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.3" xref="S5.E42.m1.5.5.1.1.3.2.3.cmml">r</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1a" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.4" xref="S5.E42.m1.5.5.1.1.3.2.4.cmml">e</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1b" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.5" xref="S5.E42.m1.5.5.1.1.3.2.5.cmml">c</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1c" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.6" xref="S5.E42.m1.5.5.1.1.3.2.6.cmml">i</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1d" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.7" xref="S5.E42.m1.5.5.1.1.3.2.7.cmml">s</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1e" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.8" xref="S5.E42.m1.5.5.1.1.3.2.8.cmml">i</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1f" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.9" xref="S5.E42.m1.5.5.1.1.3.2.9.cmml">o</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1g" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><msub id="S5.E42.m1.5.5.1.1.3.2.10" xref="S5.E42.m1.5.5.1.1.3.2.10.cmml"><mi id="S5.E42.m1.5.5.1.1.3.2.10.2" xref="S5.E42.m1.5.5.1.1.3.2.10.2.cmml">n</mi><mi id="S5.E42.m1.5.5.1.1.3.2.10.3" xref="S5.E42.m1.5.5.1.1.3.2.10.3.cmml">k</mi></msub><mo id="S5.E42.m1.5.5.1.1.3.2.1h" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S5.E42.m1.5.5.1.1.3.2.11.2" xref="S5.E42.m1.5.5.1.1.3.2.cmml"><mo id="S5.E42.m1.5.5.1.1.3.2.11.2.1" stretchy="false" xref="S5.E42.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S5.E42.m1.3.3" xref="S5.E42.m1.3.3.cmml">t</mi><mo id="S5.E42.m1.5.5.1.1.3.2.11.2.2" stretchy="false" xref="S5.E42.m1.5.5.1.1.3.2.cmml">)</mo></mrow><mo id="S5.E42.m1.5.5.1.1.3.2.1i" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.12" mathvariant="normal" xref="S5.E42.m1.5.5.1.1.3.2.12.cmml">△</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1j" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.13" xref="S5.E42.m1.5.5.1.1.3.2.13.cmml">R</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1k" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.14" xref="S5.E42.m1.5.5.1.1.3.2.14.cmml">e</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1l" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.15" xref="S5.E42.m1.5.5.1.1.3.2.15.cmml">c</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1m" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.16" xref="S5.E42.m1.5.5.1.1.3.2.16.cmml">a</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1n" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E42.m1.5.5.1.1.3.2.17" xref="S5.E42.m1.5.5.1.1.3.2.17.cmml">l</mi><mo id="S5.E42.m1.5.5.1.1.3.2.1o" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><msub id="S5.E42.m1.5.5.1.1.3.2.18" xref="S5.E42.m1.5.5.1.1.3.2.18.cmml"><mi id="S5.E42.m1.5.5.1.1.3.2.18.2" xref="S5.E42.m1.5.5.1.1.3.2.18.2.cmml">l</mi><mi id="S5.E42.m1.5.5.1.1.3.2.18.3" xref="S5.E42.m1.5.5.1.1.3.2.18.3.cmml">k</mi></msub><mo id="S5.E42.m1.5.5.1.1.3.2.1p" xref="S5.E42.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S5.E42.m1.5.5.1.1.3.2.19.2" xref="S5.E42.m1.5.5.1.1.3.2.cmml"><mo id="S5.E42.m1.5.5.1.1.3.2.19.2.1" stretchy="false" xref="S5.E42.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S5.E42.m1.4.4" xref="S5.E42.m1.4.4.cmml">t</mi><mo id="S5.E42.m1.5.5.1.1.3.2.19.2.2" stretchy="false" xref="S5.E42.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E42.m1.5.5.1.2" xref="S5.E42.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E42.m1.5b"><apply id="S5.E42.m1.5.5.1.1.cmml" xref="S5.E42.m1.5.5.1"><eq id="S5.E42.m1.5.5.1.1.1.cmml" xref="S5.E42.m1.5.5.1.1.1"></eq><apply id="S5.E42.m1.5.5.1.1.2.cmml" xref="S5.E42.m1.5.5.1.1.2"><times id="S5.E42.m1.5.5.1.1.2.1.cmml" xref="S5.E42.m1.5.5.1.1.2.1"></times><ci id="S5.E42.m1.5.5.1.1.2.2.cmml" xref="S5.E42.m1.5.5.1.1.2.2">𝑃</ci><ci id="S5.E42.m1.5.5.1.1.2.3.cmml" xref="S5.E42.m1.5.5.1.1.2.3">𝑅</ci><ci id="S5.E42.m1.5.5.1.1.2.4.cmml" xref="S5.E42.m1.5.5.1.1.2.4">𝐴</ci><ci id="S5.E42.m1.5.5.1.1.2.5.cmml" xref="S5.E42.m1.5.5.1.1.2.5">𝑈</ci><ci id="S5.E42.m1.5.5.1.1.2.6.cmml" xref="S5.E42.m1.5.5.1.1.2.6">𝐶</ci><ci id="S5.E42.m1.2.2.cmml" xref="S5.E42.m1.2.2">𝑡</ci></apply><apply id="S5.E42.m1.5.5.1.1.3.cmml" xref="S5.E42.m1.5.5.1.1.3"><apply id="S5.E42.m1.5.5.1.1.3.1.cmml" xref="S5.E42.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S5.E42.m1.5.5.1.1.3.1.1.cmml" xref="S5.E42.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S5.E42.m1.5.5.1.1.3.1.2.cmml" xref="S5.E42.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S5.E42.m1.5.5.1.1.3.1.2.1.cmml" xref="S5.E42.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S5.E42.m1.5.5.1.1.3.1.2.2.cmml" xref="S5.E42.m1.5.5.1.1.3.1.2.2"></sum><apply id="S5.E42.m1.5.5.1.1.3.1.2.3.cmml" xref="S5.E42.m1.5.5.1.1.3.1.2.3"><eq id="S5.E42.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S5.E42.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S5.E42.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S5.E42.m1.5.5.1.1.3.1.2.3.2">𝑘</ci><cn id="S5.E42.m1.5.5.1.1.3.1.2.3.3.cmml" type="integer" xref="S5.E42.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S5.E42.m1.1.1.1.2.cmml" xref="S5.E42.m1.1.1.1.3"><abs id="S5.E42.m1.1.1.1.2.1.cmml" xref="S5.E42.m1.1.1.1.3.1"></abs><ci id="S5.E42.m1.1.1.1.1.cmml" xref="S5.E42.m1.1.1.1.1">𝑀</ci></apply></apply><apply id="S5.E42.m1.5.5.1.1.3.2.cmml" xref="S5.E42.m1.5.5.1.1.3.2"><times id="S5.E42.m1.5.5.1.1.3.2.1.cmml" xref="S5.E42.m1.5.5.1.1.3.2.1"></times><ci id="S5.E42.m1.5.5.1.1.3.2.2.cmml" xref="S5.E42.m1.5.5.1.1.3.2.2">𝑃</ci><ci id="S5.E42.m1.5.5.1.1.3.2.3.cmml" xref="S5.E42.m1.5.5.1.1.3.2.3">𝑟</ci><ci id="S5.E42.m1.5.5.1.1.3.2.4.cmml" xref="S5.E42.m1.5.5.1.1.3.2.4">𝑒</ci><ci id="S5.E42.m1.5.5.1.1.3.2.5.cmml" xref="S5.E42.m1.5.5.1.1.3.2.5">𝑐</ci><ci id="S5.E42.m1.5.5.1.1.3.2.6.cmml" xref="S5.E42.m1.5.5.1.1.3.2.6">𝑖</ci><ci id="S5.E42.m1.5.5.1.1.3.2.7.cmml" xref="S5.E42.m1.5.5.1.1.3.2.7">𝑠</ci><ci id="S5.E42.m1.5.5.1.1.3.2.8.cmml" xref="S5.E42.m1.5.5.1.1.3.2.8">𝑖</ci><ci id="S5.E42.m1.5.5.1.1.3.2.9.cmml" xref="S5.E42.m1.5.5.1.1.3.2.9">𝑜</ci><apply id="S5.E42.m1.5.5.1.1.3.2.10.cmml" xref="S5.E42.m1.5.5.1.1.3.2.10"><csymbol cd="ambiguous" id="S5.E42.m1.5.5.1.1.3.2.10.1.cmml" xref="S5.E42.m1.5.5.1.1.3.2.10">subscript</csymbol><ci id="S5.E42.m1.5.5.1.1.3.2.10.2.cmml" xref="S5.E42.m1.5.5.1.1.3.2.10.2">𝑛</ci><ci id="S5.E42.m1.5.5.1.1.3.2.10.3.cmml" xref="S5.E42.m1.5.5.1.1.3.2.10.3">𝑘</ci></apply><ci id="S5.E42.m1.3.3.cmml" xref="S5.E42.m1.3.3">𝑡</ci><ci id="S5.E42.m1.5.5.1.1.3.2.12.cmml" xref="S5.E42.m1.5.5.1.1.3.2.12">△</ci><ci id="S5.E42.m1.5.5.1.1.3.2.13.cmml" xref="S5.E42.m1.5.5.1.1.3.2.13">𝑅</ci><ci id="S5.E42.m1.5.5.1.1.3.2.14.cmml" xref="S5.E42.m1.5.5.1.1.3.2.14">𝑒</ci><ci id="S5.E42.m1.5.5.1.1.3.2.15.cmml" xref="S5.E42.m1.5.5.1.1.3.2.15">𝑐</ci><ci id="S5.E42.m1.5.5.1.1.3.2.16.cmml" xref="S5.E42.m1.5.5.1.1.3.2.16">𝑎</ci><ci id="S5.E42.m1.5.5.1.1.3.2.17.cmml" xref="S5.E42.m1.5.5.1.1.3.2.17">𝑙</ci><apply id="S5.E42.m1.5.5.1.1.3.2.18.cmml" xref="S5.E42.m1.5.5.1.1.3.2.18"><csymbol cd="ambiguous" id="S5.E42.m1.5.5.1.1.3.2.18.1.cmml" xref="S5.E42.m1.5.5.1.1.3.2.18">subscript</csymbol><ci id="S5.E42.m1.5.5.1.1.3.2.18.2.cmml" xref="S5.E42.m1.5.5.1.1.3.2.18.2">𝑙</ci><ci id="S5.E42.m1.5.5.1.1.3.2.18.3.cmml" xref="S5.E42.m1.5.5.1.1.3.2.18.3">𝑘</ci></apply><ci id="S5.E42.m1.4.4.cmml" xref="S5.E42.m1.4.4">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E42.m1.5c">\displaystyle PRAUC(t)=\sum_{k=1}^{|M|}Precision_{k}(t)\triangle Recall_{k}(t),</annotation><annotation encoding="application/x-llamapun" id="S5.E42.m1.5d">italic_P italic_R italic_A italic_U italic_C ( italic_t ) = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_M | end_POSTSUPERSCRIPT italic_P italic_r italic_e italic_c italic_i italic_s italic_i italic_o italic_n start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_t ) △ italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_t ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(42)</span></td>
</tr></tbody>
<tbody id="S5.E43"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\triangle Recall_{k}(t)=Recall_{k}(t)-Recall_{k-1}(t)," class="ltx_Math" display="block" id="S5.E43.m1.4"><semantics id="S5.E43.m1.4a"><mrow id="S5.E43.m1.4.4.1" xref="S5.E43.m1.4.4.1.1.cmml"><mrow id="S5.E43.m1.4.4.1.1" xref="S5.E43.m1.4.4.1.1.cmml"><mrow id="S5.E43.m1.4.4.1.1.2" xref="S5.E43.m1.4.4.1.1.2.cmml"><mi id="S5.E43.m1.4.4.1.1.2.2" mathvariant="normal" xref="S5.E43.m1.4.4.1.1.2.2.cmml">△</mi><mo id="S5.E43.m1.4.4.1.1.2.1" xref="S5.E43.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.2.3" xref="S5.E43.m1.4.4.1.1.2.3.cmml">R</mi><mo id="S5.E43.m1.4.4.1.1.2.1a" xref="S5.E43.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.2.4" xref="S5.E43.m1.4.4.1.1.2.4.cmml">e</mi><mo id="S5.E43.m1.4.4.1.1.2.1b" xref="S5.E43.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.2.5" xref="S5.E43.m1.4.4.1.1.2.5.cmml">c</mi><mo id="S5.E43.m1.4.4.1.1.2.1c" xref="S5.E43.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.2.6" xref="S5.E43.m1.4.4.1.1.2.6.cmml">a</mi><mo id="S5.E43.m1.4.4.1.1.2.1d" xref="S5.E43.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.2.7" xref="S5.E43.m1.4.4.1.1.2.7.cmml">l</mi><mo id="S5.E43.m1.4.4.1.1.2.1e" xref="S5.E43.m1.4.4.1.1.2.1.cmml">⁢</mo><msub id="S5.E43.m1.4.4.1.1.2.8" xref="S5.E43.m1.4.4.1.1.2.8.cmml"><mi id="S5.E43.m1.4.4.1.1.2.8.2" xref="S5.E43.m1.4.4.1.1.2.8.2.cmml">l</mi><mi id="S5.E43.m1.4.4.1.1.2.8.3" xref="S5.E43.m1.4.4.1.1.2.8.3.cmml">k</mi></msub><mo id="S5.E43.m1.4.4.1.1.2.1f" xref="S5.E43.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="S5.E43.m1.4.4.1.1.2.9.2" xref="S5.E43.m1.4.4.1.1.2.cmml"><mo id="S5.E43.m1.4.4.1.1.2.9.2.1" stretchy="false" xref="S5.E43.m1.4.4.1.1.2.cmml">(</mo><mi id="S5.E43.m1.1.1" xref="S5.E43.m1.1.1.cmml">t</mi><mo id="S5.E43.m1.4.4.1.1.2.9.2.2" stretchy="false" xref="S5.E43.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E43.m1.4.4.1.1.1" xref="S5.E43.m1.4.4.1.1.1.cmml">=</mo><mrow id="S5.E43.m1.4.4.1.1.3" xref="S5.E43.m1.4.4.1.1.3.cmml"><mrow id="S5.E43.m1.4.4.1.1.3.2" xref="S5.E43.m1.4.4.1.1.3.2.cmml"><mi id="S5.E43.m1.4.4.1.1.3.2.2" xref="S5.E43.m1.4.4.1.1.3.2.2.cmml">R</mi><mo id="S5.E43.m1.4.4.1.1.3.2.1" xref="S5.E43.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.2.3" xref="S5.E43.m1.4.4.1.1.3.2.3.cmml">e</mi><mo id="S5.E43.m1.4.4.1.1.3.2.1a" xref="S5.E43.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.2.4" xref="S5.E43.m1.4.4.1.1.3.2.4.cmml">c</mi><mo id="S5.E43.m1.4.4.1.1.3.2.1b" xref="S5.E43.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.2.5" xref="S5.E43.m1.4.4.1.1.3.2.5.cmml">a</mi><mo id="S5.E43.m1.4.4.1.1.3.2.1c" xref="S5.E43.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.2.6" xref="S5.E43.m1.4.4.1.1.3.2.6.cmml">l</mi><mo id="S5.E43.m1.4.4.1.1.3.2.1d" xref="S5.E43.m1.4.4.1.1.3.2.1.cmml">⁢</mo><msub id="S5.E43.m1.4.4.1.1.3.2.7" xref="S5.E43.m1.4.4.1.1.3.2.7.cmml"><mi id="S5.E43.m1.4.4.1.1.3.2.7.2" xref="S5.E43.m1.4.4.1.1.3.2.7.2.cmml">l</mi><mi id="S5.E43.m1.4.4.1.1.3.2.7.3" xref="S5.E43.m1.4.4.1.1.3.2.7.3.cmml">k</mi></msub><mo id="S5.E43.m1.4.4.1.1.3.2.1e" xref="S5.E43.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mrow id="S5.E43.m1.4.4.1.1.3.2.8.2" xref="S5.E43.m1.4.4.1.1.3.2.cmml"><mo id="S5.E43.m1.4.4.1.1.3.2.8.2.1" stretchy="false" xref="S5.E43.m1.4.4.1.1.3.2.cmml">(</mo><mi id="S5.E43.m1.2.2" xref="S5.E43.m1.2.2.cmml">t</mi><mo id="S5.E43.m1.4.4.1.1.3.2.8.2.2" stretchy="false" xref="S5.E43.m1.4.4.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S5.E43.m1.4.4.1.1.3.1" xref="S5.E43.m1.4.4.1.1.3.1.cmml">−</mo><mrow id="S5.E43.m1.4.4.1.1.3.3" xref="S5.E43.m1.4.4.1.1.3.3.cmml"><mi id="S5.E43.m1.4.4.1.1.3.3.2" xref="S5.E43.m1.4.4.1.1.3.3.2.cmml">R</mi><mo id="S5.E43.m1.4.4.1.1.3.3.1" xref="S5.E43.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.3.3" xref="S5.E43.m1.4.4.1.1.3.3.3.cmml">e</mi><mo id="S5.E43.m1.4.4.1.1.3.3.1a" xref="S5.E43.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.3.4" xref="S5.E43.m1.4.4.1.1.3.3.4.cmml">c</mi><mo id="S5.E43.m1.4.4.1.1.3.3.1b" xref="S5.E43.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.3.5" xref="S5.E43.m1.4.4.1.1.3.3.5.cmml">a</mi><mo id="S5.E43.m1.4.4.1.1.3.3.1c" xref="S5.E43.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mi id="S5.E43.m1.4.4.1.1.3.3.6" xref="S5.E43.m1.4.4.1.1.3.3.6.cmml">l</mi><mo id="S5.E43.m1.4.4.1.1.3.3.1d" xref="S5.E43.m1.4.4.1.1.3.3.1.cmml">⁢</mo><msub id="S5.E43.m1.4.4.1.1.3.3.7" xref="S5.E43.m1.4.4.1.1.3.3.7.cmml"><mi id="S5.E43.m1.4.4.1.1.3.3.7.2" xref="S5.E43.m1.4.4.1.1.3.3.7.2.cmml">l</mi><mrow id="S5.E43.m1.4.4.1.1.3.3.7.3" xref="S5.E43.m1.4.4.1.1.3.3.7.3.cmml"><mi id="S5.E43.m1.4.4.1.1.3.3.7.3.2" xref="S5.E43.m1.4.4.1.1.3.3.7.3.2.cmml">k</mi><mo id="S5.E43.m1.4.4.1.1.3.3.7.3.1" xref="S5.E43.m1.4.4.1.1.3.3.7.3.1.cmml">−</mo><mn id="S5.E43.m1.4.4.1.1.3.3.7.3.3" xref="S5.E43.m1.4.4.1.1.3.3.7.3.3.cmml">1</mn></mrow></msub><mo id="S5.E43.m1.4.4.1.1.3.3.1e" xref="S5.E43.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mrow id="S5.E43.m1.4.4.1.1.3.3.8.2" xref="S5.E43.m1.4.4.1.1.3.3.cmml"><mo id="S5.E43.m1.4.4.1.1.3.3.8.2.1" stretchy="false" xref="S5.E43.m1.4.4.1.1.3.3.cmml">(</mo><mi id="S5.E43.m1.3.3" xref="S5.E43.m1.3.3.cmml">t</mi><mo id="S5.E43.m1.4.4.1.1.3.3.8.2.2" stretchy="false" xref="S5.E43.m1.4.4.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E43.m1.4.4.1.2" xref="S5.E43.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E43.m1.4b"><apply id="S5.E43.m1.4.4.1.1.cmml" xref="S5.E43.m1.4.4.1"><eq id="S5.E43.m1.4.4.1.1.1.cmml" xref="S5.E43.m1.4.4.1.1.1"></eq><apply id="S5.E43.m1.4.4.1.1.2.cmml" xref="S5.E43.m1.4.4.1.1.2"><times id="S5.E43.m1.4.4.1.1.2.1.cmml" xref="S5.E43.m1.4.4.1.1.2.1"></times><ci id="S5.E43.m1.4.4.1.1.2.2.cmml" xref="S5.E43.m1.4.4.1.1.2.2">△</ci><ci id="S5.E43.m1.4.4.1.1.2.3.cmml" xref="S5.E43.m1.4.4.1.1.2.3">𝑅</ci><ci id="S5.E43.m1.4.4.1.1.2.4.cmml" xref="S5.E43.m1.4.4.1.1.2.4">𝑒</ci><ci id="S5.E43.m1.4.4.1.1.2.5.cmml" xref="S5.E43.m1.4.4.1.1.2.5">𝑐</ci><ci id="S5.E43.m1.4.4.1.1.2.6.cmml" xref="S5.E43.m1.4.4.1.1.2.6">𝑎</ci><ci id="S5.E43.m1.4.4.1.1.2.7.cmml" xref="S5.E43.m1.4.4.1.1.2.7">𝑙</ci><apply id="S5.E43.m1.4.4.1.1.2.8.cmml" xref="S5.E43.m1.4.4.1.1.2.8"><csymbol cd="ambiguous" id="S5.E43.m1.4.4.1.1.2.8.1.cmml" xref="S5.E43.m1.4.4.1.1.2.8">subscript</csymbol><ci id="S5.E43.m1.4.4.1.1.2.8.2.cmml" xref="S5.E43.m1.4.4.1.1.2.8.2">𝑙</ci><ci id="S5.E43.m1.4.4.1.1.2.8.3.cmml" xref="S5.E43.m1.4.4.1.1.2.8.3">𝑘</ci></apply><ci id="S5.E43.m1.1.1.cmml" xref="S5.E43.m1.1.1">𝑡</ci></apply><apply id="S5.E43.m1.4.4.1.1.3.cmml" xref="S5.E43.m1.4.4.1.1.3"><minus id="S5.E43.m1.4.4.1.1.3.1.cmml" xref="S5.E43.m1.4.4.1.1.3.1"></minus><apply id="S5.E43.m1.4.4.1.1.3.2.cmml" xref="S5.E43.m1.4.4.1.1.3.2"><times id="S5.E43.m1.4.4.1.1.3.2.1.cmml" xref="S5.E43.m1.4.4.1.1.3.2.1"></times><ci id="S5.E43.m1.4.4.1.1.3.2.2.cmml" xref="S5.E43.m1.4.4.1.1.3.2.2">𝑅</ci><ci id="S5.E43.m1.4.4.1.1.3.2.3.cmml" xref="S5.E43.m1.4.4.1.1.3.2.3">𝑒</ci><ci id="S5.E43.m1.4.4.1.1.3.2.4.cmml" xref="S5.E43.m1.4.4.1.1.3.2.4">𝑐</ci><ci id="S5.E43.m1.4.4.1.1.3.2.5.cmml" xref="S5.E43.m1.4.4.1.1.3.2.5">𝑎</ci><ci id="S5.E43.m1.4.4.1.1.3.2.6.cmml" xref="S5.E43.m1.4.4.1.1.3.2.6">𝑙</ci><apply id="S5.E43.m1.4.4.1.1.3.2.7.cmml" xref="S5.E43.m1.4.4.1.1.3.2.7"><csymbol cd="ambiguous" id="S5.E43.m1.4.4.1.1.3.2.7.1.cmml" xref="S5.E43.m1.4.4.1.1.3.2.7">subscript</csymbol><ci id="S5.E43.m1.4.4.1.1.3.2.7.2.cmml" xref="S5.E43.m1.4.4.1.1.3.2.7.2">𝑙</ci><ci id="S5.E43.m1.4.4.1.1.3.2.7.3.cmml" xref="S5.E43.m1.4.4.1.1.3.2.7.3">𝑘</ci></apply><ci id="S5.E43.m1.2.2.cmml" xref="S5.E43.m1.2.2">𝑡</ci></apply><apply id="S5.E43.m1.4.4.1.1.3.3.cmml" xref="S5.E43.m1.4.4.1.1.3.3"><times id="S5.E43.m1.4.4.1.1.3.3.1.cmml" xref="S5.E43.m1.4.4.1.1.3.3.1"></times><ci id="S5.E43.m1.4.4.1.1.3.3.2.cmml" xref="S5.E43.m1.4.4.1.1.3.3.2">𝑅</ci><ci id="S5.E43.m1.4.4.1.1.3.3.3.cmml" xref="S5.E43.m1.4.4.1.1.3.3.3">𝑒</ci><ci id="S5.E43.m1.4.4.1.1.3.3.4.cmml" xref="S5.E43.m1.4.4.1.1.3.3.4">𝑐</ci><ci id="S5.E43.m1.4.4.1.1.3.3.5.cmml" xref="S5.E43.m1.4.4.1.1.3.3.5">𝑎</ci><ci id="S5.E43.m1.4.4.1.1.3.3.6.cmml" xref="S5.E43.m1.4.4.1.1.3.3.6">𝑙</ci><apply id="S5.E43.m1.4.4.1.1.3.3.7.cmml" xref="S5.E43.m1.4.4.1.1.3.3.7"><csymbol cd="ambiguous" id="S5.E43.m1.4.4.1.1.3.3.7.1.cmml" xref="S5.E43.m1.4.4.1.1.3.3.7">subscript</csymbol><ci id="S5.E43.m1.4.4.1.1.3.3.7.2.cmml" xref="S5.E43.m1.4.4.1.1.3.3.7.2">𝑙</ci><apply id="S5.E43.m1.4.4.1.1.3.3.7.3.cmml" xref="S5.E43.m1.4.4.1.1.3.3.7.3"><minus id="S5.E43.m1.4.4.1.1.3.3.7.3.1.cmml" xref="S5.E43.m1.4.4.1.1.3.3.7.3.1"></minus><ci id="S5.E43.m1.4.4.1.1.3.3.7.3.2.cmml" xref="S5.E43.m1.4.4.1.1.3.3.7.3.2">𝑘</ci><cn id="S5.E43.m1.4.4.1.1.3.3.7.3.3.cmml" type="integer" xref="S5.E43.m1.4.4.1.1.3.3.7.3.3">1</cn></apply></apply><ci id="S5.E43.m1.3.3.cmml" xref="S5.E43.m1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E43.m1.4c">\displaystyle\triangle Recall_{k}(t)=Recall_{k}(t)-Recall_{k-1}(t),</annotation><annotation encoding="application/x-llamapun" id="S5.E43.m1.4d">△ italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_t ) = italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_t ) - italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT ( italic_t ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(43)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.p5.7">where <math alttext="|M|" class="ltx_Math" display="inline" id="S5.SS3.p5.1.m1.1"><semantics id="S5.SS3.p5.1.m1.1a"><mrow id="S5.SS3.p5.1.m1.1.2.2" xref="S5.SS3.p5.1.m1.1.2.1.cmml"><mo id="S5.SS3.p5.1.m1.1.2.2.1" stretchy="false" xref="S5.SS3.p5.1.m1.1.2.1.1.cmml">|</mo><mi id="S5.SS3.p5.1.m1.1.1" xref="S5.SS3.p5.1.m1.1.1.cmml">M</mi><mo id="S5.SS3.p5.1.m1.1.2.2.2" stretchy="false" xref="S5.SS3.p5.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.1.m1.1b"><apply id="S5.SS3.p5.1.m1.1.2.1.cmml" xref="S5.SS3.p5.1.m1.1.2.2"><abs id="S5.SS3.p5.1.m1.1.2.1.1.cmml" xref="S5.SS3.p5.1.m1.1.2.2.1"></abs><ci id="S5.SS3.p5.1.m1.1.1.cmml" xref="S5.SS3.p5.1.m1.1.1">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.1.m1.1c">|M|</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.1.m1.1d">| italic_M |</annotation></semantics></math> denotes the number of medications, <math alttext="k" class="ltx_Math" display="inline" id="S5.SS3.p5.2.m2.1"><semantics id="S5.SS3.p5.2.m2.1a"><mi id="S5.SS3.p5.2.m2.1.1" xref="S5.SS3.p5.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.2.m2.1b"><ci id="S5.SS3.p5.2.m2.1.1.cmml" xref="S5.SS3.p5.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.2.m2.1d">italic_k</annotation></semantics></math> is the rank in the sequence of the retrieved medications, and <math alttext="Precision_{k}(t)" class="ltx_Math" display="inline" id="S5.SS3.p5.3.m3.1"><semantics id="S5.SS3.p5.3.m3.1a"><mrow id="S5.SS3.p5.3.m3.1.2" xref="S5.SS3.p5.3.m3.1.2.cmml"><mi id="S5.SS3.p5.3.m3.1.2.2" xref="S5.SS3.p5.3.m3.1.2.2.cmml">P</mi><mo id="S5.SS3.p5.3.m3.1.2.1" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.3.m3.1.2.3" xref="S5.SS3.p5.3.m3.1.2.3.cmml">r</mi><mo id="S5.SS3.p5.3.m3.1.2.1a" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.3.m3.1.2.4" xref="S5.SS3.p5.3.m3.1.2.4.cmml">e</mi><mo id="S5.SS3.p5.3.m3.1.2.1b" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.3.m3.1.2.5" xref="S5.SS3.p5.3.m3.1.2.5.cmml">c</mi><mo id="S5.SS3.p5.3.m3.1.2.1c" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.3.m3.1.2.6" xref="S5.SS3.p5.3.m3.1.2.6.cmml">i</mi><mo id="S5.SS3.p5.3.m3.1.2.1d" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.3.m3.1.2.7" xref="S5.SS3.p5.3.m3.1.2.7.cmml">s</mi><mo id="S5.SS3.p5.3.m3.1.2.1e" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.3.m3.1.2.8" xref="S5.SS3.p5.3.m3.1.2.8.cmml">i</mi><mo id="S5.SS3.p5.3.m3.1.2.1f" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.3.m3.1.2.9" xref="S5.SS3.p5.3.m3.1.2.9.cmml">o</mi><mo id="S5.SS3.p5.3.m3.1.2.1g" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><msub id="S5.SS3.p5.3.m3.1.2.10" xref="S5.SS3.p5.3.m3.1.2.10.cmml"><mi id="S5.SS3.p5.3.m3.1.2.10.2" xref="S5.SS3.p5.3.m3.1.2.10.2.cmml">n</mi><mi id="S5.SS3.p5.3.m3.1.2.10.3" xref="S5.SS3.p5.3.m3.1.2.10.3.cmml">k</mi></msub><mo id="S5.SS3.p5.3.m3.1.2.1h" xref="S5.SS3.p5.3.m3.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p5.3.m3.1.2.11.2" xref="S5.SS3.p5.3.m3.1.2.cmml"><mo id="S5.SS3.p5.3.m3.1.2.11.2.1" stretchy="false" xref="S5.SS3.p5.3.m3.1.2.cmml">(</mo><mi id="S5.SS3.p5.3.m3.1.1" xref="S5.SS3.p5.3.m3.1.1.cmml">t</mi><mo id="S5.SS3.p5.3.m3.1.2.11.2.2" stretchy="false" xref="S5.SS3.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.3.m3.1b"><apply id="S5.SS3.p5.3.m3.1.2.cmml" xref="S5.SS3.p5.3.m3.1.2"><times id="S5.SS3.p5.3.m3.1.2.1.cmml" xref="S5.SS3.p5.3.m3.1.2.1"></times><ci id="S5.SS3.p5.3.m3.1.2.2.cmml" xref="S5.SS3.p5.3.m3.1.2.2">𝑃</ci><ci id="S5.SS3.p5.3.m3.1.2.3.cmml" xref="S5.SS3.p5.3.m3.1.2.3">𝑟</ci><ci id="S5.SS3.p5.3.m3.1.2.4.cmml" xref="S5.SS3.p5.3.m3.1.2.4">𝑒</ci><ci id="S5.SS3.p5.3.m3.1.2.5.cmml" xref="S5.SS3.p5.3.m3.1.2.5">𝑐</ci><ci id="S5.SS3.p5.3.m3.1.2.6.cmml" xref="S5.SS3.p5.3.m3.1.2.6">𝑖</ci><ci id="S5.SS3.p5.3.m3.1.2.7.cmml" xref="S5.SS3.p5.3.m3.1.2.7">𝑠</ci><ci id="S5.SS3.p5.3.m3.1.2.8.cmml" xref="S5.SS3.p5.3.m3.1.2.8">𝑖</ci><ci id="S5.SS3.p5.3.m3.1.2.9.cmml" xref="S5.SS3.p5.3.m3.1.2.9">𝑜</ci><apply id="S5.SS3.p5.3.m3.1.2.10.cmml" xref="S5.SS3.p5.3.m3.1.2.10"><csymbol cd="ambiguous" id="S5.SS3.p5.3.m3.1.2.10.1.cmml" xref="S5.SS3.p5.3.m3.1.2.10">subscript</csymbol><ci id="S5.SS3.p5.3.m3.1.2.10.2.cmml" xref="S5.SS3.p5.3.m3.1.2.10.2">𝑛</ci><ci id="S5.SS3.p5.3.m3.1.2.10.3.cmml" xref="S5.SS3.p5.3.m3.1.2.10.3">𝑘</ci></apply><ci id="S5.SS3.p5.3.m3.1.1.cmml" xref="S5.SS3.p5.3.m3.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.3.m3.1c">Precision_{k}(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.3.m3.1d">italic_P italic_r italic_e italic_c italic_i italic_s italic_i italic_o italic_n start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> represents the precision at cut-of <math alttext="k" class="ltx_Math" display="inline" id="S5.SS3.p5.4.m4.1"><semantics id="S5.SS3.p5.4.m4.1a"><mi id="S5.SS3.p5.4.m4.1.1" xref="S5.SS3.p5.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.4.m4.1b"><ci id="S5.SS3.p5.4.m4.1.1.cmml" xref="S5.SS3.p5.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.4.m4.1d">italic_k</annotation></semantics></math> in the ordered retrieval list and <math alttext="\triangle Recall_{k}(t)" class="ltx_Math" display="inline" id="S5.SS3.p5.5.m5.1"><semantics id="S5.SS3.p5.5.m5.1a"><mrow id="S5.SS3.p5.5.m5.1.2" xref="S5.SS3.p5.5.m5.1.2.cmml"><mi id="S5.SS3.p5.5.m5.1.2.2" mathvariant="normal" xref="S5.SS3.p5.5.m5.1.2.2.cmml">△</mi><mo id="S5.SS3.p5.5.m5.1.2.1" xref="S5.SS3.p5.5.m5.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.5.m5.1.2.3" xref="S5.SS3.p5.5.m5.1.2.3.cmml">R</mi><mo id="S5.SS3.p5.5.m5.1.2.1a" xref="S5.SS3.p5.5.m5.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.5.m5.1.2.4" xref="S5.SS3.p5.5.m5.1.2.4.cmml">e</mi><mo id="S5.SS3.p5.5.m5.1.2.1b" xref="S5.SS3.p5.5.m5.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.5.m5.1.2.5" xref="S5.SS3.p5.5.m5.1.2.5.cmml">c</mi><mo id="S5.SS3.p5.5.m5.1.2.1c" xref="S5.SS3.p5.5.m5.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.5.m5.1.2.6" xref="S5.SS3.p5.5.m5.1.2.6.cmml">a</mi><mo id="S5.SS3.p5.5.m5.1.2.1d" xref="S5.SS3.p5.5.m5.1.2.1.cmml">⁢</mo><mi id="S5.SS3.p5.5.m5.1.2.7" xref="S5.SS3.p5.5.m5.1.2.7.cmml">l</mi><mo id="S5.SS3.p5.5.m5.1.2.1e" xref="S5.SS3.p5.5.m5.1.2.1.cmml">⁢</mo><msub id="S5.SS3.p5.5.m5.1.2.8" xref="S5.SS3.p5.5.m5.1.2.8.cmml"><mi id="S5.SS3.p5.5.m5.1.2.8.2" xref="S5.SS3.p5.5.m5.1.2.8.2.cmml">l</mi><mi id="S5.SS3.p5.5.m5.1.2.8.3" xref="S5.SS3.p5.5.m5.1.2.8.3.cmml">k</mi></msub><mo id="S5.SS3.p5.5.m5.1.2.1f" xref="S5.SS3.p5.5.m5.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p5.5.m5.1.2.9.2" xref="S5.SS3.p5.5.m5.1.2.cmml"><mo id="S5.SS3.p5.5.m5.1.2.9.2.1" stretchy="false" xref="S5.SS3.p5.5.m5.1.2.cmml">(</mo><mi id="S5.SS3.p5.5.m5.1.1" xref="S5.SS3.p5.5.m5.1.1.cmml">t</mi><mo id="S5.SS3.p5.5.m5.1.2.9.2.2" stretchy="false" xref="S5.SS3.p5.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.5.m5.1b"><apply id="S5.SS3.p5.5.m5.1.2.cmml" xref="S5.SS3.p5.5.m5.1.2"><times id="S5.SS3.p5.5.m5.1.2.1.cmml" xref="S5.SS3.p5.5.m5.1.2.1"></times><ci id="S5.SS3.p5.5.m5.1.2.2.cmml" xref="S5.SS3.p5.5.m5.1.2.2">△</ci><ci id="S5.SS3.p5.5.m5.1.2.3.cmml" xref="S5.SS3.p5.5.m5.1.2.3">𝑅</ci><ci id="S5.SS3.p5.5.m5.1.2.4.cmml" xref="S5.SS3.p5.5.m5.1.2.4">𝑒</ci><ci id="S5.SS3.p5.5.m5.1.2.5.cmml" xref="S5.SS3.p5.5.m5.1.2.5">𝑐</ci><ci id="S5.SS3.p5.5.m5.1.2.6.cmml" xref="S5.SS3.p5.5.m5.1.2.6">𝑎</ci><ci id="S5.SS3.p5.5.m5.1.2.7.cmml" xref="S5.SS3.p5.5.m5.1.2.7">𝑙</ci><apply id="S5.SS3.p5.5.m5.1.2.8.cmml" xref="S5.SS3.p5.5.m5.1.2.8"><csymbol cd="ambiguous" id="S5.SS3.p5.5.m5.1.2.8.1.cmml" xref="S5.SS3.p5.5.m5.1.2.8">subscript</csymbol><ci id="S5.SS3.p5.5.m5.1.2.8.2.cmml" xref="S5.SS3.p5.5.m5.1.2.8.2">𝑙</ci><ci id="S5.SS3.p5.5.m5.1.2.8.3.cmml" xref="S5.SS3.p5.5.m5.1.2.8.3">𝑘</ci></apply><ci id="S5.SS3.p5.5.m5.1.1.cmml" xref="S5.SS3.p5.5.m5.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.5.m5.1c">\triangle Recall_{k}(t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.5.m5.1d">△ italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> denotes the change of recall from medication <math alttext="k-1" class="ltx_Math" display="inline" id="S5.SS3.p5.6.m6.1"><semantics id="S5.SS3.p5.6.m6.1a"><mrow id="S5.SS3.p5.6.m6.1.1" xref="S5.SS3.p5.6.m6.1.1.cmml"><mi id="S5.SS3.p5.6.m6.1.1.2" xref="S5.SS3.p5.6.m6.1.1.2.cmml">k</mi><mo id="S5.SS3.p5.6.m6.1.1.1" xref="S5.SS3.p5.6.m6.1.1.1.cmml">−</mo><mn id="S5.SS3.p5.6.m6.1.1.3" xref="S5.SS3.p5.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.6.m6.1b"><apply id="S5.SS3.p5.6.m6.1.1.cmml" xref="S5.SS3.p5.6.m6.1.1"><minus id="S5.SS3.p5.6.m6.1.1.1.cmml" xref="S5.SS3.p5.6.m6.1.1.1"></minus><ci id="S5.SS3.p5.6.m6.1.1.2.cmml" xref="S5.SS3.p5.6.m6.1.1.2">𝑘</ci><cn id="S5.SS3.p5.6.m6.1.1.3.cmml" type="integer" xref="S5.SS3.p5.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.6.m6.1c">k-1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.6.m6.1d">italic_k - 1</annotation></semantics></math> to <math alttext="k" class="ltx_Math" display="inline" id="S5.SS3.p5.7.m7.1"><semantics id="S5.SS3.p5.7.m7.1a"><mi id="S5.SS3.p5.7.m7.1.1" xref="S5.SS3.p5.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.7.m7.1b"><ci id="S5.SS3.p5.7.m7.1.1.cmml" xref="S5.SS3.p5.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.7.m7.1d">italic_k</annotation></semantics></math>. We averaged the PRAUC across all of the patient’s visits to obtain the final result,</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E44">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="PRAUC=\frac{1}{N_{h}}\sum_{i=1}^{N_{h}}PRAUC(t)," class="ltx_Math" display="block" id="S5.E44.m1.2"><semantics id="S5.E44.m1.2a"><mrow id="S5.E44.m1.2.2.1" xref="S5.E44.m1.2.2.1.1.cmml"><mrow id="S5.E44.m1.2.2.1.1" xref="S5.E44.m1.2.2.1.1.cmml"><mrow id="S5.E44.m1.2.2.1.1.2" xref="S5.E44.m1.2.2.1.1.2.cmml"><mi id="S5.E44.m1.2.2.1.1.2.2" xref="S5.E44.m1.2.2.1.1.2.2.cmml">P</mi><mo id="S5.E44.m1.2.2.1.1.2.1" xref="S5.E44.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.2.3" xref="S5.E44.m1.2.2.1.1.2.3.cmml">R</mi><mo id="S5.E44.m1.2.2.1.1.2.1a" xref="S5.E44.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.2.4" xref="S5.E44.m1.2.2.1.1.2.4.cmml">A</mi><mo id="S5.E44.m1.2.2.1.1.2.1b" xref="S5.E44.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.2.5" xref="S5.E44.m1.2.2.1.1.2.5.cmml">U</mi><mo id="S5.E44.m1.2.2.1.1.2.1c" xref="S5.E44.m1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.2.6" xref="S5.E44.m1.2.2.1.1.2.6.cmml">C</mi></mrow><mo id="S5.E44.m1.2.2.1.1.1" xref="S5.E44.m1.2.2.1.1.1.cmml">=</mo><mrow id="S5.E44.m1.2.2.1.1.3" xref="S5.E44.m1.2.2.1.1.3.cmml"><mfrac id="S5.E44.m1.2.2.1.1.3.2" xref="S5.E44.m1.2.2.1.1.3.2.cmml"><mn id="S5.E44.m1.2.2.1.1.3.2.2" xref="S5.E44.m1.2.2.1.1.3.2.2.cmml">1</mn><msub id="S5.E44.m1.2.2.1.1.3.2.3" xref="S5.E44.m1.2.2.1.1.3.2.3.cmml"><mi id="S5.E44.m1.2.2.1.1.3.2.3.2" xref="S5.E44.m1.2.2.1.1.3.2.3.2.cmml">N</mi><mi id="S5.E44.m1.2.2.1.1.3.2.3.3" xref="S5.E44.m1.2.2.1.1.3.2.3.3.cmml">h</mi></msub></mfrac><mo id="S5.E44.m1.2.2.1.1.3.1" xref="S5.E44.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S5.E44.m1.2.2.1.1.3.3" xref="S5.E44.m1.2.2.1.1.3.3.cmml"><munderover id="S5.E44.m1.2.2.1.1.3.3.1" xref="S5.E44.m1.2.2.1.1.3.3.1.cmml"><mo id="S5.E44.m1.2.2.1.1.3.3.1.2.2" movablelimits="false" xref="S5.E44.m1.2.2.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S5.E44.m1.2.2.1.1.3.3.1.2.3" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3.cmml"><mi id="S5.E44.m1.2.2.1.1.3.3.1.2.3.2" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S5.E44.m1.2.2.1.1.3.3.1.2.3.1" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S5.E44.m1.2.2.1.1.3.3.1.2.3.3" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S5.E44.m1.2.2.1.1.3.3.1.3" xref="S5.E44.m1.2.2.1.1.3.3.1.3.cmml"><mi id="S5.E44.m1.2.2.1.1.3.3.1.3.2" xref="S5.E44.m1.2.2.1.1.3.3.1.3.2.cmml">N</mi><mi id="S5.E44.m1.2.2.1.1.3.3.1.3.3" xref="S5.E44.m1.2.2.1.1.3.3.1.3.3.cmml">h</mi></msub></munderover><mrow id="S5.E44.m1.2.2.1.1.3.3.2" xref="S5.E44.m1.2.2.1.1.3.3.2.cmml"><mi id="S5.E44.m1.2.2.1.1.3.3.2.2" xref="S5.E44.m1.2.2.1.1.3.3.2.2.cmml">P</mi><mo id="S5.E44.m1.2.2.1.1.3.3.2.1" xref="S5.E44.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.3.3.2.3" xref="S5.E44.m1.2.2.1.1.3.3.2.3.cmml">R</mi><mo id="S5.E44.m1.2.2.1.1.3.3.2.1a" xref="S5.E44.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.3.3.2.4" xref="S5.E44.m1.2.2.1.1.3.3.2.4.cmml">A</mi><mo id="S5.E44.m1.2.2.1.1.3.3.2.1b" xref="S5.E44.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.3.3.2.5" xref="S5.E44.m1.2.2.1.1.3.3.2.5.cmml">U</mi><mo id="S5.E44.m1.2.2.1.1.3.3.2.1c" xref="S5.E44.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S5.E44.m1.2.2.1.1.3.3.2.6" xref="S5.E44.m1.2.2.1.1.3.3.2.6.cmml">C</mi><mo id="S5.E44.m1.2.2.1.1.3.3.2.1d" xref="S5.E44.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mrow id="S5.E44.m1.2.2.1.1.3.3.2.7.2" xref="S5.E44.m1.2.2.1.1.3.3.2.cmml"><mo id="S5.E44.m1.2.2.1.1.3.3.2.7.2.1" stretchy="false" xref="S5.E44.m1.2.2.1.1.3.3.2.cmml">(</mo><mi id="S5.E44.m1.1.1" xref="S5.E44.m1.1.1.cmml">t</mi><mo id="S5.E44.m1.2.2.1.1.3.3.2.7.2.2" stretchy="false" xref="S5.E44.m1.2.2.1.1.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S5.E44.m1.2.2.1.2" xref="S5.E44.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E44.m1.2b"><apply id="S5.E44.m1.2.2.1.1.cmml" xref="S5.E44.m1.2.2.1"><eq id="S5.E44.m1.2.2.1.1.1.cmml" xref="S5.E44.m1.2.2.1.1.1"></eq><apply id="S5.E44.m1.2.2.1.1.2.cmml" xref="S5.E44.m1.2.2.1.1.2"><times id="S5.E44.m1.2.2.1.1.2.1.cmml" xref="S5.E44.m1.2.2.1.1.2.1"></times><ci id="S5.E44.m1.2.2.1.1.2.2.cmml" xref="S5.E44.m1.2.2.1.1.2.2">𝑃</ci><ci id="S5.E44.m1.2.2.1.1.2.3.cmml" xref="S5.E44.m1.2.2.1.1.2.3">𝑅</ci><ci id="S5.E44.m1.2.2.1.1.2.4.cmml" xref="S5.E44.m1.2.2.1.1.2.4">𝐴</ci><ci id="S5.E44.m1.2.2.1.1.2.5.cmml" xref="S5.E44.m1.2.2.1.1.2.5">𝑈</ci><ci id="S5.E44.m1.2.2.1.1.2.6.cmml" xref="S5.E44.m1.2.2.1.1.2.6">𝐶</ci></apply><apply id="S5.E44.m1.2.2.1.1.3.cmml" xref="S5.E44.m1.2.2.1.1.3"><times id="S5.E44.m1.2.2.1.1.3.1.cmml" xref="S5.E44.m1.2.2.1.1.3.1"></times><apply id="S5.E44.m1.2.2.1.1.3.2.cmml" xref="S5.E44.m1.2.2.1.1.3.2"><divide id="S5.E44.m1.2.2.1.1.3.2.1.cmml" xref="S5.E44.m1.2.2.1.1.3.2"></divide><cn id="S5.E44.m1.2.2.1.1.3.2.2.cmml" type="integer" xref="S5.E44.m1.2.2.1.1.3.2.2">1</cn><apply id="S5.E44.m1.2.2.1.1.3.2.3.cmml" xref="S5.E44.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E44.m1.2.2.1.1.3.2.3.1.cmml" xref="S5.E44.m1.2.2.1.1.3.2.3">subscript</csymbol><ci id="S5.E44.m1.2.2.1.1.3.2.3.2.cmml" xref="S5.E44.m1.2.2.1.1.3.2.3.2">𝑁</ci><ci id="S5.E44.m1.2.2.1.1.3.2.3.3.cmml" xref="S5.E44.m1.2.2.1.1.3.2.3.3">ℎ</ci></apply></apply><apply id="S5.E44.m1.2.2.1.1.3.3.cmml" xref="S5.E44.m1.2.2.1.1.3.3"><apply id="S5.E44.m1.2.2.1.1.3.3.1.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E44.m1.2.2.1.1.3.3.1.1.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1">superscript</csymbol><apply id="S5.E44.m1.2.2.1.1.3.3.1.2.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E44.m1.2.2.1.1.3.3.1.2.1.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1">subscript</csymbol><sum id="S5.E44.m1.2.2.1.1.3.3.1.2.2.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.2.2"></sum><apply id="S5.E44.m1.2.2.1.1.3.3.1.2.3.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3"><eq id="S5.E44.m1.2.2.1.1.3.3.1.2.3.1.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3.1"></eq><ci id="S5.E44.m1.2.2.1.1.3.3.1.2.3.2.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S5.E44.m1.2.2.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S5.E44.m1.2.2.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S5.E44.m1.2.2.1.1.3.3.1.3.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S5.E44.m1.2.2.1.1.3.3.1.3.1.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.3">subscript</csymbol><ci id="S5.E44.m1.2.2.1.1.3.3.1.3.2.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.3.2">𝑁</ci><ci id="S5.E44.m1.2.2.1.1.3.3.1.3.3.cmml" xref="S5.E44.m1.2.2.1.1.3.3.1.3.3">ℎ</ci></apply></apply><apply id="S5.E44.m1.2.2.1.1.3.3.2.cmml" xref="S5.E44.m1.2.2.1.1.3.3.2"><times id="S5.E44.m1.2.2.1.1.3.3.2.1.cmml" xref="S5.E44.m1.2.2.1.1.3.3.2.1"></times><ci id="S5.E44.m1.2.2.1.1.3.3.2.2.cmml" xref="S5.E44.m1.2.2.1.1.3.3.2.2">𝑃</ci><ci id="S5.E44.m1.2.2.1.1.3.3.2.3.cmml" xref="S5.E44.m1.2.2.1.1.3.3.2.3">𝑅</ci><ci id="S5.E44.m1.2.2.1.1.3.3.2.4.cmml" xref="S5.E44.m1.2.2.1.1.3.3.2.4">𝐴</ci><ci id="S5.E44.m1.2.2.1.1.3.3.2.5.cmml" xref="S5.E44.m1.2.2.1.1.3.3.2.5">𝑈</ci><ci id="S5.E44.m1.2.2.1.1.3.3.2.6.cmml" xref="S5.E44.m1.2.2.1.1.3.3.2.6">𝐶</ci><ci id="S5.E44.m1.1.1.cmml" xref="S5.E44.m1.1.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E44.m1.2c">PRAUC=\frac{1}{N_{h}}\sum_{i=1}^{N_{h}}PRAUC(t),</annotation><annotation encoding="application/x-llamapun" id="S5.E44.m1.2d">italic_P italic_R italic_A italic_U italic_C = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_P italic_R italic_A italic_U italic_C ( italic_t ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(44)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.p5.9">where <math alttext="N_{h}" class="ltx_Math" display="inline" id="S5.SS3.p5.8.m1.1"><semantics id="S5.SS3.p5.8.m1.1a"><msub id="S5.SS3.p5.8.m1.1.1" xref="S5.SS3.p5.8.m1.1.1.cmml"><mi id="S5.SS3.p5.8.m1.1.1.2" xref="S5.SS3.p5.8.m1.1.1.2.cmml">N</mi><mi id="S5.SS3.p5.8.m1.1.1.3" xref="S5.SS3.p5.8.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.8.m1.1b"><apply id="S5.SS3.p5.8.m1.1.1.cmml" xref="S5.SS3.p5.8.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.8.m1.1.1.1.cmml" xref="S5.SS3.p5.8.m1.1.1">subscript</csymbol><ci id="S5.SS3.p5.8.m1.1.1.2.cmml" xref="S5.SS3.p5.8.m1.1.1.2">𝑁</ci><ci id="S5.SS3.p5.8.m1.1.1.3.cmml" xref="S5.SS3.p5.8.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.8.m1.1c">N_{h}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.8.m1.1d">italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> represents the total number of visits for patient <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p5.9.m2.1"><semantics id="S5.SS3.p5.9.m2.1a"><mi id="S5.SS3.p5.9.m2.1.1" xref="S5.SS3.p5.9.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.9.m2.1b"><ci id="S5.SS3.p5.9.m2.1.1.cmml" xref="S5.SS3.p5.9.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.9.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.9.m2.1d">italic_h</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p6">
<p class="ltx_p" id="S5.SS3.p6.6"><span class="ltx_text ltx_font_bold" id="S5.SS3.p6.6.1">Avg. # of Drugs</span> (Average number of drugs) measures the mean number of medications in each recommendation result. A higher value indicates that each recommendation includes more medications, potentially increasing the complexity of clinical treatment and the risk of adverse reactions. Conversely, a lower value suggests that the medication combinations may be safer and help minimize unnecessary medication use. It is important to note that this metric serves as a reference only, and the size of the combination should not be used as a strict evaluation standard.</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E45">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Avg.\#ofDrugs=\frac{1}{N_{h}}\sum_{i=1}^{N_{h}}|\hat{M}(i)|," class="ltx_Math" display="block" id="S5.E45.m1.2"><semantics id="S5.E45.m1.2a"><mrow id="S5.E45.m1.2.2.1"><mrow id="S5.E45.m1.2.2.1.1.2" xref="S5.E45.m1.2.2.1.1.3.cmml"><mrow id="S5.E45.m1.2.2.1.1.1.1" xref="S5.E45.m1.2.2.1.1.1.1.cmml"><mi id="S5.E45.m1.2.2.1.1.1.1.2" xref="S5.E45.m1.2.2.1.1.1.1.2.cmml">A</mi><mo id="S5.E45.m1.2.2.1.1.1.1.1" xref="S5.E45.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.1.1.3" xref="S5.E45.m1.2.2.1.1.1.1.3.cmml">v</mi><mo id="S5.E45.m1.2.2.1.1.1.1.1a" xref="S5.E45.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.1.1.4" xref="S5.E45.m1.2.2.1.1.1.1.4.cmml">g</mi></mrow><mo id="S5.E45.m1.2.2.1.1.2.3" lspace="0em" rspace="0.167em" xref="S5.E45.m1.2.2.1.1.3a.cmml">.</mo><mrow id="S5.E45.m1.2.2.1.1.2.2" xref="S5.E45.m1.2.2.1.1.2.2.cmml"><mrow id="S5.E45.m1.2.2.1.1.2.2.3" xref="S5.E45.m1.2.2.1.1.2.2.3.cmml"><mi id="S5.E45.m1.2.2.1.1.2.2.3.2" mathvariant="normal" xref="S5.E45.m1.2.2.1.1.2.2.3.2.cmml">#</mi><mo id="S5.E45.m1.2.2.1.1.2.2.3.1" xref="S5.E45.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.2.2.3.3" xref="S5.E45.m1.2.2.1.1.2.2.3.3.cmml">o</mi><mo id="S5.E45.m1.2.2.1.1.2.2.3.1a" xref="S5.E45.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.2.2.3.4" xref="S5.E45.m1.2.2.1.1.2.2.3.4.cmml">f</mi><mo id="S5.E45.m1.2.2.1.1.2.2.3.1b" xref="S5.E45.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.2.2.3.5" xref="S5.E45.m1.2.2.1.1.2.2.3.5.cmml">D</mi><mo id="S5.E45.m1.2.2.1.1.2.2.3.1c" xref="S5.E45.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.2.2.3.6" xref="S5.E45.m1.2.2.1.1.2.2.3.6.cmml">r</mi><mo id="S5.E45.m1.2.2.1.1.2.2.3.1d" xref="S5.E45.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.2.2.3.7" xref="S5.E45.m1.2.2.1.1.2.2.3.7.cmml">u</mi><mo id="S5.E45.m1.2.2.1.1.2.2.3.1e" xref="S5.E45.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.2.2.3.8" xref="S5.E45.m1.2.2.1.1.2.2.3.8.cmml">g</mi><mo id="S5.E45.m1.2.2.1.1.2.2.3.1f" xref="S5.E45.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S5.E45.m1.2.2.1.1.2.2.3.9" xref="S5.E45.m1.2.2.1.1.2.2.3.9.cmml">s</mi></mrow><mo id="S5.E45.m1.2.2.1.1.2.2.2" xref="S5.E45.m1.2.2.1.1.2.2.2.cmml">=</mo><mrow id="S5.E45.m1.2.2.1.1.2.2.1" xref="S5.E45.m1.2.2.1.1.2.2.1.cmml"><mfrac id="S5.E45.m1.2.2.1.1.2.2.1.3" xref="S5.E45.m1.2.2.1.1.2.2.1.3.cmml"><mn id="S5.E45.m1.2.2.1.1.2.2.1.3.2" xref="S5.E45.m1.2.2.1.1.2.2.1.3.2.cmml">1</mn><msub id="S5.E45.m1.2.2.1.1.2.2.1.3.3" xref="S5.E45.m1.2.2.1.1.2.2.1.3.3.cmml"><mi id="S5.E45.m1.2.2.1.1.2.2.1.3.3.2" xref="S5.E45.m1.2.2.1.1.2.2.1.3.3.2.cmml">N</mi><mi id="S5.E45.m1.2.2.1.1.2.2.1.3.3.3" xref="S5.E45.m1.2.2.1.1.2.2.1.3.3.3.cmml">h</mi></msub></mfrac><mo id="S5.E45.m1.2.2.1.1.2.2.1.2" xref="S5.E45.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S5.E45.m1.2.2.1.1.2.2.1.1" xref="S5.E45.m1.2.2.1.1.2.2.1.1.cmml"><munderover id="S5.E45.m1.2.2.1.1.2.2.1.1.2" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.cmml"><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.cmml"><mi id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.2" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.1" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.3" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S5.E45.m1.2.2.1.1.2.2.1.1.2.3" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.cmml"><mi id="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.2" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.2.cmml">N</mi><mi id="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.3" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.3.cmml">h</mi></msub></munderover><mrow id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.2.cmml"><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.2" stretchy="false" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.2.1.cmml">|</mo><mrow id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mover accent="true" id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml"><mi id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.2" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.2.cmml">M</mi><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.1" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.1" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.3.2" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.3.2.1" stretchy="false" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml">(</mo><mi id="S5.E45.m1.1.1" xref="S5.E45.m1.1.1.cmml">i</mi><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.3.2.2" stretchy="false" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.3" stretchy="false" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow><mo id="S5.E45.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E45.m1.2b"><apply id="S5.E45.m1.2.2.1.1.3.cmml" xref="S5.E45.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E45.m1.2.2.1.1.3a.cmml" xref="S5.E45.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S5.E45.m1.2.2.1.1.1.1.cmml" xref="S5.E45.m1.2.2.1.1.1.1"><times id="S5.E45.m1.2.2.1.1.1.1.1.cmml" xref="S5.E45.m1.2.2.1.1.1.1.1"></times><ci id="S5.E45.m1.2.2.1.1.1.1.2.cmml" xref="S5.E45.m1.2.2.1.1.1.1.2">𝐴</ci><ci id="S5.E45.m1.2.2.1.1.1.1.3.cmml" xref="S5.E45.m1.2.2.1.1.1.1.3">𝑣</ci><ci id="S5.E45.m1.2.2.1.1.1.1.4.cmml" xref="S5.E45.m1.2.2.1.1.1.1.4">𝑔</ci></apply><apply id="S5.E45.m1.2.2.1.1.2.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2"><eq id="S5.E45.m1.2.2.1.1.2.2.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.2"></eq><apply id="S5.E45.m1.2.2.1.1.2.2.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3"><times id="S5.E45.m1.2.2.1.1.2.2.3.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.1"></times><ci id="S5.E45.m1.2.2.1.1.2.2.3.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.2">#</ci><ci id="S5.E45.m1.2.2.1.1.2.2.3.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.3">𝑜</ci><ci id="S5.E45.m1.2.2.1.1.2.2.3.4.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.4">𝑓</ci><ci id="S5.E45.m1.2.2.1.1.2.2.3.5.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.5">𝐷</ci><ci id="S5.E45.m1.2.2.1.1.2.2.3.6.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.6">𝑟</ci><ci id="S5.E45.m1.2.2.1.1.2.2.3.7.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.7">𝑢</ci><ci id="S5.E45.m1.2.2.1.1.2.2.3.8.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.8">𝑔</ci><ci id="S5.E45.m1.2.2.1.1.2.2.3.9.cmml" xref="S5.E45.m1.2.2.1.1.2.2.3.9">𝑠</ci></apply><apply id="S5.E45.m1.2.2.1.1.2.2.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1"><times id="S5.E45.m1.2.2.1.1.2.2.1.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.2"></times><apply id="S5.E45.m1.2.2.1.1.2.2.1.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.3"><divide id="S5.E45.m1.2.2.1.1.2.2.1.3.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.3"></divide><cn id="S5.E45.m1.2.2.1.1.2.2.1.3.2.cmml" type="integer" xref="S5.E45.m1.2.2.1.1.2.2.1.3.2">1</cn><apply id="S5.E45.m1.2.2.1.1.2.2.1.3.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.3.3"><csymbol cd="ambiguous" id="S5.E45.m1.2.2.1.1.2.2.1.3.3.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.3.3">subscript</csymbol><ci id="S5.E45.m1.2.2.1.1.2.2.1.3.3.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.3.3.2">𝑁</ci><ci id="S5.E45.m1.2.2.1.1.2.2.1.3.3.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.3.3.3">ℎ</ci></apply></apply><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1"><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E45.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2">superscript</csymbol><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2">subscript</csymbol><sum id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.2"></sum><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3"><eq id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.1"></eq><ci id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.2">𝑖</ci><cn id="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.2.3.3">1</cn></apply></apply><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.3">subscript</csymbol><ci id="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.2">𝑁</ci><ci id="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.3.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.2.3.3">ℎ</ci></apply></apply><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1"><abs id="S5.E45.m1.2.2.1.1.2.2.1.1.1.2.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.2"></abs><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1"><times id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.1"></times><apply id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2"><ci id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.1.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.1">^</ci><ci id="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.2.cmml" xref="S5.E45.m1.2.2.1.1.2.2.1.1.1.1.1.2.2">𝑀</ci></apply><ci id="S5.E45.m1.1.1.cmml" xref="S5.E45.m1.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E45.m1.2c">Avg.\#ofDrugs=\frac{1}{N_{h}}\sum_{i=1}^{N_{h}}|\hat{M}(i)|,</annotation><annotation encoding="application/x-llamapun" id="S5.E45.m1.2d">italic_A italic_v italic_g . # italic_o italic_f italic_D italic_r italic_u italic_g italic_s = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT | over^ start_ARG italic_M end_ARG ( italic_i ) | ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(45)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS3.p6.5">where <math alttext="N_{h}" class="ltx_Math" display="inline" id="S5.SS3.p6.1.m1.1"><semantics id="S5.SS3.p6.1.m1.1a"><msub id="S5.SS3.p6.1.m1.1.1" xref="S5.SS3.p6.1.m1.1.1.cmml"><mi id="S5.SS3.p6.1.m1.1.1.2" xref="S5.SS3.p6.1.m1.1.1.2.cmml">N</mi><mi id="S5.SS3.p6.1.m1.1.1.3" xref="S5.SS3.p6.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.1.m1.1b"><apply id="S5.SS3.p6.1.m1.1.1.cmml" xref="S5.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p6.1.m1.1.1.1.cmml" xref="S5.SS3.p6.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p6.1.m1.1.1.2.cmml" xref="S5.SS3.p6.1.m1.1.1.2">𝑁</ci><ci id="S5.SS3.p6.1.m1.1.1.3.cmml" xref="S5.SS3.p6.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.1.m1.1c">N_{h}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> represents the total number of visits for patient <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p6.2.m2.1"><semantics id="S5.SS3.p6.2.m2.1a"><mi id="S5.SS3.p6.2.m2.1.1" xref="S5.SS3.p6.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.2.m2.1b"><ci id="S5.SS3.p6.2.m2.1.1.cmml" xref="S5.SS3.p6.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.2.m2.1d">italic_h</annotation></semantics></math> and <math alttext="|\hat{M}(i)|" class="ltx_Math" display="inline" id="S5.SS3.p6.3.m3.2"><semantics id="S5.SS3.p6.3.m3.2a"><mrow id="S5.SS3.p6.3.m3.2.2.1" xref="S5.SS3.p6.3.m3.2.2.2.cmml"><mo id="S5.SS3.p6.3.m3.2.2.1.2" stretchy="false" xref="S5.SS3.p6.3.m3.2.2.2.1.cmml">|</mo><mrow id="S5.SS3.p6.3.m3.2.2.1.1" xref="S5.SS3.p6.3.m3.2.2.1.1.cmml"><mover accent="true" id="S5.SS3.p6.3.m3.2.2.1.1.2" xref="S5.SS3.p6.3.m3.2.2.1.1.2.cmml"><mi id="S5.SS3.p6.3.m3.2.2.1.1.2.2" xref="S5.SS3.p6.3.m3.2.2.1.1.2.2.cmml">M</mi><mo id="S5.SS3.p6.3.m3.2.2.1.1.2.1" xref="S5.SS3.p6.3.m3.2.2.1.1.2.1.cmml">^</mo></mover><mo id="S5.SS3.p6.3.m3.2.2.1.1.1" xref="S5.SS3.p6.3.m3.2.2.1.1.1.cmml">⁢</mo><mrow id="S5.SS3.p6.3.m3.2.2.1.1.3.2" xref="S5.SS3.p6.3.m3.2.2.1.1.cmml"><mo id="S5.SS3.p6.3.m3.2.2.1.1.3.2.1" stretchy="false" xref="S5.SS3.p6.3.m3.2.2.1.1.cmml">(</mo><mi id="S5.SS3.p6.3.m3.1.1" xref="S5.SS3.p6.3.m3.1.1.cmml">i</mi><mo id="S5.SS3.p6.3.m3.2.2.1.1.3.2.2" stretchy="false" xref="S5.SS3.p6.3.m3.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS3.p6.3.m3.2.2.1.3" stretchy="false" xref="S5.SS3.p6.3.m3.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.3.m3.2b"><apply id="S5.SS3.p6.3.m3.2.2.2.cmml" xref="S5.SS3.p6.3.m3.2.2.1"><abs id="S5.SS3.p6.3.m3.2.2.2.1.cmml" xref="S5.SS3.p6.3.m3.2.2.1.2"></abs><apply id="S5.SS3.p6.3.m3.2.2.1.1.cmml" xref="S5.SS3.p6.3.m3.2.2.1.1"><times id="S5.SS3.p6.3.m3.2.2.1.1.1.cmml" xref="S5.SS3.p6.3.m3.2.2.1.1.1"></times><apply id="S5.SS3.p6.3.m3.2.2.1.1.2.cmml" xref="S5.SS3.p6.3.m3.2.2.1.1.2"><ci id="S5.SS3.p6.3.m3.2.2.1.1.2.1.cmml" xref="S5.SS3.p6.3.m3.2.2.1.1.2.1">^</ci><ci id="S5.SS3.p6.3.m3.2.2.1.1.2.2.cmml" xref="S5.SS3.p6.3.m3.2.2.1.1.2.2">𝑀</ci></apply><ci id="S5.SS3.p6.3.m3.1.1.cmml" xref="S5.SS3.p6.3.m3.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.3.m3.2c">|\hat{M}(i)|</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.3.m3.2d">| over^ start_ARG italic_M end_ARG ( italic_i ) |</annotation></semantics></math> denotes the number of predicted medications in visit <math alttext="i" class="ltx_Math" display="inline" id="S5.SS3.p6.4.m4.1"><semantics id="S5.SS3.p6.4.m4.1a"><mi id="S5.SS3.p6.4.m4.1.1" xref="S5.SS3.p6.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.4.m4.1b"><ci id="S5.SS3.p6.4.m4.1.1.cmml" xref="S5.SS3.p6.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.4.m4.1d">italic_i</annotation></semantics></math> of patient <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p6.5.m5.1"><semantics id="S5.SS3.p6.5.m5.1a"><mi id="S5.SS3.p6.5.m5.1.1" xref="S5.SS3.p6.5.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.5.m5.1b"><ci id="S5.SS3.p6.5.m5.1.1.cmml" xref="S5.SS3.p6.5.m5.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.5.m5.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.5.m5.1d">italic_h</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Baselines</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">To verify the performance of our model, we chose the following high-performance methods as the baseline model for comparison.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p2.1.1">LR</span> (Logistic Regression) is a widely used linear classification algorithm that calculates the probability of an instance belonging to a specific category based on a linear combination of input features. It is commonly used for probability prediction and binary or multi-class classification tasks.</p>
</div>
<div class="ltx_para" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p3.1.1">ECC</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib29" title="">29</a>]</cite> (Ensemble of Classifier Chains) uses a series of interconnected classifiers to improve prediction accuracy, where the output of one classifier serves as the input for the next. This method is suitable for multi-label classification tasks and can effectively enhance the overall performance of the model.</p>
</div>
<div class="ltx_para" id="S5.SS4.p4">
<p class="ltx_p" id="S5.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p4.1.1">RETAIN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib7" title="">7</a>]</cite> is an attention-based model that analyzes patient time series to achieve accurate disease prediction and management. It provides medication recommendations by dynamically capturing key clinical events in a patient’s medical history.</p>
</div>
<div class="ltx_para" id="S5.SS4.p5">
<p class="ltx_p" id="S5.SS4.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p5.1.1">LEAP</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib44" title="">44</a>]</cite> enhances the effectiveness of medications by modeling label dependencies through decomposing the treatment process into a sequential procedure.</p>
</div>
<div class="ltx_para" id="S5.SS4.p6">
<p class="ltx_p" id="S5.SS4.p6.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p6.1.1">GAMENet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib31" title="">31</a>]</cite> is a medication recommendation that integrates the strengths of graph neural networks with memory networks and effectively discerns patterns and temporal sequences within medical data, thereby enhancing the precision of its predictions.</p>
</div>
<div class="ltx_para" id="S5.SS4.p7">
<p class="ltx_p" id="S5.SS4.p7.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p7.1.1">SafeDrug</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib42" title="">42</a>]</cite> leverages the combination of patients’ health conditions and medication-related molecular knowledge. This approach, by reducing the impact of DDIs, can recommend safer medication combinations.</p>
</div>
<div class="ltx_para" id="S5.SS4.p8">
<p class="ltx_p" id="S5.SS4.p8.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p8.1.1">MICRON</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib41" title="">41</a>]</cite> recommends medications based on the dynamic changes in a patient’s health condition. It focuses on updating medication combinations according to the patient’s new symptoms to enhance treatment efficacy while reducing potential side effects.</p>
</div>
<div class="ltx_para" id="S5.SS4.p9">
<p class="ltx_p" id="S5.SS4.p9.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p9.1.1">COGNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib39" title="">39</a>]</cite> employs the Transformer architecture for drug recommendations, using a translation approach to infer medications from illnesses. It also features a copy mechanism to integrate beneficial drugs from past prescriptions into new recommendations.</p>
</div>
<div class="ltx_para" id="S5.SS4.p10">
<p class="ltx_p" id="S5.SS4.p10.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p10.1.1">MoleRec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib43" title="">43</a>]</cite> delves into the importance of specific molecular substructures in medications. This approach enhances the precision of medication recommendations by leveraging finer molecular representations.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Performance Comparison</h3>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.10.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.11.2" style="font-size:90%;">The performance of each model on the test set regarding accuracy and safety. The best and the runner-up results are highlighted in bold and underlined respectively under t-tests, at the level of 95% confidence level.</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S5.T2.8">
<tr class="ltx_tr" id="S5.T2.8.9">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_tt" id="S5.T2.8.9.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.9.1.1">
<span class="ltx_p" id="S5.T2.8.9.1.1.1" style="width:39.8pt;"><span class="ltx_text" id="S5.T2.8.9.1.1.1.1">Model</span></span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_align_top ltx_border_r ltx_border_tt" colspan="5" id="S5.T2.8.9.2">MIMIC-III</td>
<td class="ltx_td ltx_align_center ltx_align_top ltx_border_r ltx_border_tt" colspan="5" id="S5.T2.8.9.3">MIMIC-IV</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.8">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.8.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.8.9.1">
<span class="ltx_p" id="S5.T2.8.8.9.1.1" style="width:39.8pt;"></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.1.1.1">
<span class="ltx_p" id="S5.T2.1.1.1.1.1" style="width:31.3pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T2.1.1.1.1.1.m1.1"><semantics id="S5.T2.1.1.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T2.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.2.2.2.1">
<span class="ltx_p" id="S5.T2.2.2.2.1.1" style="width:31.3pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S5.T2.2.2.2.1.1.m1.1"><semantics id="S5.T2.2.2.2.1.1.m1.1a"><mo id="S5.T2.2.2.2.1.1.m1.1.1" stretchy="false" xref="S5.T2.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.1.1.m1.1b"><ci id="S5.T2.2.2.2.1.1.m1.1.1.cmml" xref="S5.T2.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.3.3.3.1">
<span class="ltx_p" id="S5.T2.3.3.3.1.1" style="width:31.3pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T2.3.3.3.1.1.m1.1"><semantics id="S5.T2.3.3.3.1.1.m1.1a"><mo id="S5.T2.3.3.3.1.1.m1.1.1" stretchy="false" xref="S5.T2.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.1.1.m1.1b"><ci id="S5.T2.3.3.3.1.1.m1.1.1.cmml" xref="S5.T2.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.3.3.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.4.4.4.1">
<span class="ltx_p" id="S5.T2.4.4.4.1.1" style="width:31.3pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T2.4.4.4.1.1.m1.1"><semantics id="S5.T2.4.4.4.1.1.m1.1a"><mo id="S5.T2.4.4.4.1.1.m1.1.1" stretchy="false" xref="S5.T2.4.4.4.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.1.1.m1.1b"><ci id="S5.T2.4.4.4.1.1.m1.1.1.cmml" xref="S5.T2.4.4.4.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.4.4.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T2.8.8.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.8.10.1">
<span class="ltx_p" id="S5.T2.8.8.10.1.1" style="width:35.6pt;">Avg.#Med</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.5.5.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.5.5.5.1">
<span class="ltx_p" id="S5.T2.5.5.5.1.1" style="width:31.3pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T2.5.5.5.1.1.m1.1"><semantics id="S5.T2.5.5.5.1.1.m1.1a"><mo id="S5.T2.5.5.5.1.1.m1.1.1" stretchy="false" xref="S5.T2.5.5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.1.1.m1.1b"><ci id="S5.T2.5.5.5.1.1.m1.1.1.cmml" xref="S5.T2.5.5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.5.5.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.6.6.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.6.6.6.1">
<span class="ltx_p" id="S5.T2.6.6.6.1.1" style="width:31.3pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S5.T2.6.6.6.1.1.m1.1"><semantics id="S5.T2.6.6.6.1.1.m1.1a"><mo id="S5.T2.6.6.6.1.1.m1.1.1" stretchy="false" xref="S5.T2.6.6.6.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.1.1.m1.1b"><ci id="S5.T2.6.6.6.1.1.m1.1.1.cmml" xref="S5.T2.6.6.6.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.6.6.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.7.7.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.7.7.7.1">
<span class="ltx_p" id="S5.T2.7.7.7.1.1" style="width:31.3pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T2.7.7.7.1.1.m1.1"><semantics id="S5.T2.7.7.7.1.1.m1.1a"><mo id="S5.T2.7.7.7.1.1.m1.1.1" stretchy="false" xref="S5.T2.7.7.7.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.1.1.m1.1b"><ci id="S5.T2.7.7.7.1.1.m1.1.1.cmml" xref="S5.T2.7.7.7.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.7.7.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.8.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.8.8.1">
<span class="ltx_p" id="S5.T2.8.8.8.1.1" style="width:31.3pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S5.T2.8.8.8.1.1.m1.1"><semantics id="S5.T2.8.8.8.1.1.m1.1a"><mo id="S5.T2.8.8.8.1.1.m1.1.1" stretchy="false" xref="S5.T2.8.8.8.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.1.1.m1.1b"><ci id="S5.T2.8.8.8.1.1.m1.1.1.cmml" xref="S5.T2.8.8.8.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.8.8.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T2.8.8.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.8.11.1">
<span class="ltx_p" id="S5.T2.8.8.11.1.1" style="width:35.6pt;">Avg.#Med</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.10">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.8.10.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.1.1">
<span class="ltx_p" id="S5.T2.8.10.1.1.1" style="width:39.8pt;">LR</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.2.1">
<span class="ltx_p" id="S5.T2.8.10.2.1.1" style="width:31.3pt;">0.4924</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.3.1">
<span class="ltx_p" id="S5.T2.8.10.3.1.1" style="width:31.3pt;">0.0830</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.4.1">
<span class="ltx_p" id="S5.T2.8.10.4.1.1" style="width:31.3pt;">0.6490</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.5.1">
<span class="ltx_p" id="S5.T2.8.10.5.1.1" style="width:31.3pt;">0.7548</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T2.8.10.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.6.1">
<span class="ltx_p" id="S5.T2.8.10.6.1.1" style="width:35.6pt;">16.0489</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.7.1">
<span class="ltx_p" id="S5.T2.8.10.7.1.1" style="width:31.3pt;">0.4569</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.8.1">
<span class="ltx_p" id="S5.T2.8.10.8.1.1" style="width:31.3pt;">0.0783</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.9.1">
<span class="ltx_p" id="S5.T2.8.10.9.1.1" style="width:31.3pt;">0.6064</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T2.8.10.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.10.1">
<span class="ltx_p" id="S5.T2.8.10.10.1.1" style="width:31.3pt;">0.6613</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T2.8.10.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.10.11.1">
<span class="ltx_p" id="S5.T2.8.10.11.1.1" style="width:35.6pt;">8.5746</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.11">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.11.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.1.1">
<span class="ltx_p" id="S5.T2.8.11.1.1.1" style="width:39.8pt;">ECC</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.2.1">
<span class="ltx_p" id="S5.T2.8.11.2.1.1" style="width:31.3pt;">0.4856</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.3.1">
<span class="ltx_p" id="S5.T2.8.11.3.1.1" style="width:31.3pt;">0.0817</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.4.1">
<span class="ltx_p" id="S5.T2.8.11.4.1.1" style="width:31.3pt;">0.6438</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.5.1">
<span class="ltx_p" id="S5.T2.8.11.5.1.1" style="width:31.3pt;">0.7590</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.11.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.6.1">
<span class="ltx_p" id="S5.T2.8.11.6.1.1" style="width:35.6pt;">16.2578</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.7.1">
<span class="ltx_p" id="S5.T2.8.11.7.1.1" style="width:31.3pt;">0.4327</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.8.1">
<span class="ltx_p" id="S5.T2.8.11.8.1.1" style="width:31.3pt;">0.0764</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.9.1">
<span class="ltx_p" id="S5.T2.8.11.9.1.1" style="width:31.3pt;">0.6129</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.11.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.10.1">
<span class="ltx_p" id="S5.T2.8.11.10.1.1" style="width:31.3pt;">0.6530</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.11.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.11.11.1">
<span class="ltx_p" id="S5.T2.8.11.11.1.1" style="width:35.6pt;">8.7934</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.12">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.12.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.1.1">
<span class="ltx_p" id="S5.T2.8.12.1.1.1" style="width:39.8pt;">RETAIN</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.2.1">
<span class="ltx_p" id="S5.T2.8.12.2.1.1" style="width:31.3pt;">0.4871</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.3.1">
<span class="ltx_p" id="S5.T2.8.12.3.1.1" style="width:31.3pt;">0.0879</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.4.1">
<span class="ltx_p" id="S5.T2.8.12.4.1.1" style="width:31.3pt;">0.6473</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.5.1">
<span class="ltx_p" id="S5.T2.8.12.5.1.1" style="width:31.3pt;">0.7600</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.12.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.6.1">
<span class="ltx_p" id="S5.T2.8.12.6.1.1" style="width:35.6pt;">19.4222</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.7.1">
<span class="ltx_p" id="S5.T2.8.12.7.1.1" style="width:31.3pt;">0.4234</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.8.1">
<span class="ltx_p" id="S5.T2.8.12.8.1.1" style="width:31.3pt;">0.0936</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.9.1">
<span class="ltx_p" id="S5.T2.8.12.9.1.1" style="width:31.3pt;">0.5785</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.12.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.10.1">
<span class="ltx_p" id="S5.T2.8.12.10.1.1" style="width:31.3pt;">0.6801</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.12.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.12.11.1">
<span class="ltx_p" id="S5.T2.8.12.11.1.1" style="width:35.6pt;">10.9576</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.13">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.13.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.1.1">
<span class="ltx_p" id="S5.T2.8.13.1.1.1" style="width:39.8pt;">LEAP</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.2.1">
<span class="ltx_p" id="S5.T2.8.13.2.1.1" style="width:31.3pt;">0.4526</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.3.1">
<span class="ltx_p" id="S5.T2.8.13.3.1.1" style="width:31.3pt;">0.0762</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.4.1">
<span class="ltx_p" id="S5.T2.8.13.4.1.1" style="width:31.3pt;">0.6147</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.5.1">
<span class="ltx_p" id="S5.T2.8.13.5.1.1" style="width:31.3pt;">0.6555</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.13.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.6.1">
<span class="ltx_p" id="S5.T2.8.13.6.1.1" style="width:35.6pt;">18.6240</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.7.1">
<span class="ltx_p" id="S5.T2.8.13.7.1.1" style="width:31.3pt;">0.4254</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.8.1">
<span class="ltx_p" id="S5.T2.8.13.8.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.13.8.1.1.1">0.0688</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.9.1">
<span class="ltx_p" id="S5.T2.8.13.9.1.1" style="width:31.3pt;">0.5794</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.13.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.10.1">
<span class="ltx_p" id="S5.T2.8.13.10.1.1" style="width:31.3pt;">0.6059</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.13.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.13.11.1">
<span class="ltx_p" id="S5.T2.8.13.11.1.1" style="width:35.6pt;">11.3606</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.14">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.14.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.1.1">
<span class="ltx_p" id="S5.T2.8.14.1.1.1" style="width:39.8pt;">GAMENet</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.2.1">
<span class="ltx_p" id="S5.T2.8.14.2.1.1" style="width:31.3pt;">0.4994</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.3.1">
<span class="ltx_p" id="S5.T2.8.14.3.1.1" style="width:31.3pt;">0.0890</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.4.1">
<span class="ltx_p" id="S5.T2.8.14.4.1.1" style="width:31.3pt;">0.6560</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.5.1">
<span class="ltx_p" id="S5.T2.8.14.5.1.1" style="width:31.3pt;">0.7656</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.14.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.6.1">
<span class="ltx_p" id="S5.T2.8.14.6.1.1" style="width:35.6pt;">27.7703</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.7.1">
<span class="ltx_p" id="S5.T2.8.14.7.1.1" style="width:31.3pt;">0.4565</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.8.1">
<span class="ltx_p" id="S5.T2.8.14.8.1.1" style="width:31.3pt;">0.0898</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.9.1">
<span class="ltx_p" id="S5.T2.8.14.9.1.1" style="width:31.3pt;">0.6103</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.14.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.10.1">
<span class="ltx_p" id="S5.T2.8.14.10.1.1" style="width:31.3pt;">0.6829</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.14.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.14.11.1">
<span class="ltx_p" id="S5.T2.8.14.11.1.1" style="width:35.6pt;">18.5895</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.15">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.15.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.1.1">
<span class="ltx_p" id="S5.T2.8.15.1.1.1" style="width:39.8pt;">SafeDrug</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.2.1">
<span class="ltx_p" id="S5.T2.8.15.2.1.1" style="width:31.3pt;">0.5154</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.3.1">
<span class="ltx_p" id="S5.T2.8.15.3.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.15.3.1.1.1">0.0655</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.4.1">
<span class="ltx_p" id="S5.T2.8.15.4.1.1" style="width:31.3pt;">0.6722</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.5.1">
<span class="ltx_p" id="S5.T2.8.15.5.1.1" style="width:31.3pt;">0.7627</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.15.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.6.1">
<span class="ltx_p" id="S5.T2.8.15.6.1.1" style="width:35.6pt;">19.4111</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.7.1">
<span class="ltx_p" id="S5.T2.8.15.7.1.1" style="width:31.3pt;">0.4487</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.8.1">
<span class="ltx_p" id="S5.T2.8.15.8.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.15.8.1.1.1">0.0604</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.9.1">
<span class="ltx_p" id="S5.T2.8.15.9.1.1" style="width:31.3pt;">0.6014</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.15.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.10.1">
<span class="ltx_p" id="S5.T2.8.15.10.1.1" style="width:31.3pt;">0.6948</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.15.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.15.11.1">
<span class="ltx_p" id="S5.T2.8.15.11.1.1" style="width:35.6pt;">13.6943</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.16">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.16.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.1.1">
<span class="ltx_p" id="S5.T2.8.16.1.1.1" style="width:39.8pt;">MICRON</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.2.1">
<span class="ltx_p" id="S5.T2.8.16.2.1.1" style="width:31.3pt;">0.5219</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.3.1">
<span class="ltx_p" id="S5.T2.8.16.3.1.1" style="width:31.3pt;">0.0727</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.4.1">
<span class="ltx_p" id="S5.T2.8.16.4.1.1" style="width:31.3pt;">0.6761</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.5.1">
<span class="ltx_p" id="S5.T2.8.16.5.1.1" style="width:31.3pt;">0.7489</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.16.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.6.1">
<span class="ltx_p" id="S5.T2.8.16.6.1.1" style="width:35.6pt;">19.2505</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.7.1">
<span class="ltx_p" id="S5.T2.8.16.7.1.1" style="width:31.3pt;">0.4640</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.8.1">
<span class="ltx_p" id="S5.T2.8.16.8.1.1" style="width:31.3pt;">0.0691</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.9.1">
<span class="ltx_p" id="S5.T2.8.16.9.1.1" style="width:31.3pt;">0.6167</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.16.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.10.1">
<span class="ltx_p" id="S5.T2.8.16.10.1.1" style="width:31.3pt;">0.6919</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.16.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.16.11.1">
<span class="ltx_p" id="S5.T2.8.16.11.1.1" style="width:35.6pt;">12.7701</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.17">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.17.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.1.1">
<span class="ltx_p" id="S5.T2.8.17.1.1.1" style="width:39.8pt;">COGNet</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.2.1">
<span class="ltx_p" id="S5.T2.8.17.2.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.17.2.1.1.1">0.5312</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.3.1">
<span class="ltx_p" id="S5.T2.8.17.3.1.1" style="width:31.3pt;">0.0839</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.4.1">
<span class="ltx_p" id="S5.T2.8.17.4.1.1" style="width:31.3pt;">0.6744</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.5.1">
<span class="ltx_p" id="S5.T2.8.17.5.1.1" style="width:31.3pt;">0.7708</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.17.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.6.1">
<span class="ltx_p" id="S5.T2.8.17.6.1.1" style="width:35.6pt;">27.6335</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.7.1">
<span class="ltx_p" id="S5.T2.8.17.7.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.17.7.1.1.1">0.4775</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.8.1">
<span class="ltx_p" id="S5.T2.8.17.8.1.1" style="width:31.3pt;">0.0911</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.9.1">
<span class="ltx_p" id="S5.T2.8.17.9.1.1" style="width:31.3pt;">0.6233</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.17.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.10.1">
<span class="ltx_p" id="S5.T2.8.17.10.1.1" style="width:31.3pt;">0.6524</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.17.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.17.11.1">
<span class="ltx_p" id="S5.T2.8.17.11.1.1" style="width:35.6pt;">18.7235</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.18">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S5.T2.8.18.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.1.1">
<span class="ltx_p" id="S5.T2.8.18.1.1.1" style="width:39.8pt;">MoleRec</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.2.1">
<span class="ltx_p" id="S5.T2.8.18.2.1.1" style="width:31.3pt;">0.5293</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.3.1">
<span class="ltx_p" id="S5.T2.8.18.3.1.1" style="width:31.3pt;">0.0726</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.4.1">
<span class="ltx_p" id="S5.T2.8.18.4.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.18.4.1.1.1">0.6834</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.5.1">
<span class="ltx_p" id="S5.T2.8.18.5.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.18.5.1.1.1">0.7746</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.18.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.6.1">
<span class="ltx_p" id="S5.T2.8.18.6.1.1" style="width:35.6pt;">22.0125</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.7.1">
<span class="ltx_p" id="S5.T2.8.18.7.1.1" style="width:31.3pt;">0.4744</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.8.1">
<span class="ltx_p" id="S5.T2.8.18.8.1.1" style="width:31.3pt;">0.0722</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.9.1">
<span class="ltx_p" id="S5.T2.8.18.9.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.18.9.1.1.1">0.6262</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T2.8.18.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.10.1">
<span class="ltx_p" id="S5.T2.8.18.10.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.18.10.1.1.1">0.7124</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S5.T2.8.18.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.18.11.1">
<span class="ltx_p" id="S5.T2.8.18.11.1.1" style="width:35.6pt;">13.4806</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.19">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.8.19.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.1.1">
<span class="ltx_p" id="S5.T2.8.19.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.19.1.1.1.1">BiMoMed</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.2.1">
<span class="ltx_p" id="S5.T2.8.19.2.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.19.2.1.1.1">0.5422</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.3.1">
<span class="ltx_p" id="S5.T2.8.19.3.1.1" style="width:31.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.8.19.3.1.1.1">0.0707</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.4">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.4.1">
<span class="ltx_p" id="S5.T2.8.19.4.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.19.4.1.1.1">0.6944</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.5">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.5.1">
<span class="ltx_p" id="S5.T2.8.19.5.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.19.5.1.1.1">0.7858</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.8.19.6">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.6.1">
<span class="ltx_p" id="S5.T2.8.19.6.1.1" style="width:35.6pt;">20.3989</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.7">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.7.1">
<span class="ltx_p" id="S5.T2.8.19.7.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.19.7.1.1.1">0.4851</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.8">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.8.1">
<span class="ltx_p" id="S5.T2.8.19.8.1.1" style="width:31.3pt;">0.0704</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.9">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.9.1">
<span class="ltx_p" id="S5.T2.8.19.9.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.19.9.1.1.1">0.6367</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T2.8.19.10">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.10.1">
<span class="ltx_p" id="S5.T2.8.19.10.1.1" style="width:31.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.8.19.10.1.1.1">0.7300</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.8.19.11">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.8.19.11.1">
<span class="ltx_p" id="S5.T2.8.19.11.1.1" style="width:35.6pt;">13.6222</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">In this section, we compare our model with baseline models, evaluating the accuracy and safety of the models through fundamental metrics. For baseline methods with a provided test model, we directly use the provided baseline model. For baseline methods without a provided test model, we regenerate the model files through retraining and conduct tests. We use the optimal parameter settings described in their respective papers to obtain results for each baseline method. Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.T2" title="Table 2 ‣ 5.5 Performance Comparison ‣ 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">2</span></a> details the comparison results.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">Among the various baseline methods, LR and ECC use traditional recommendation methods and perform poorly in terms of accuracy. LEAP decomposes treatment recommendations into a sequential decision process, utilizing sequence relationships to improve effectiveness, but it does not surpass traditional methods. RETAIN also introduces a sequence model but results in an excessively high DDI rate.</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="427" id="S5.F3.g1" src="extracted/5697228/comparsion_baseline_3.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S5.F3.3.2" style="font-size:90%;">Comparison with recent outstanding works across all metrics in MIMIC-III.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">For a more intuitive comparison between the baselines and our model, we integrate all evaluation metrics into a single chart. Jaccard, F1, and PRAUC are used to measure model accuracy, while DDI and Avg.#Med are used to measure safety. We normalize the metrics to the 30%-90% range and display them in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.F3" title="Figure 3 ‣ 5.5 Performance Comparison ‣ 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">3</span></a>. It is important to note that the chart does not include the efficiency metrics of the models.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.2.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.3.2" style="font-size:90%;">The performance of recent excellent models in training and inference efficiency.</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S5.T3.4">
<tr class="ltx_tr" id="S5.T3.4.1">
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S5.T3.4.1.1">method</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.2">
<span class="ltx_text" id="S5.T3.4.1.2.1"></span> <span class="ltx_text" id="S5.T3.4.1.2.2">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.4.1.2.2.1">
<span class="ltx_tr" id="S5.T3.4.1.2.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.2.2.1.1.1">Convergence</span></span>
<span class="ltx_tr" id="S5.T3.4.1.2.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.2.2.1.2.1">Epoch</span></span>
</span></span><span class="ltx_text" id="S5.T3.4.1.2.3"></span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.3">
<span class="ltx_text" id="S5.T3.4.1.3.1"></span> <span class="ltx_text" id="S5.T3.4.1.3.2">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.4.1.3.2.1">
<span class="ltx_tr" id="S5.T3.4.1.3.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.3.2.1.1.1">Training Time</span></span>
<span class="ltx_tr" id="S5.T3.4.1.3.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.3.2.1.2.1">/Epoch(s)</span></span>
</span></span><span class="ltx_text" id="S5.T3.4.1.3.3"></span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.4">
<span class="ltx_text" id="S5.T3.4.1.4.1"></span> <span class="ltx_text" id="S5.T3.4.1.4.2">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.4.1.4.2.1">
<span class="ltx_tr" id="S5.T3.4.1.4.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.4.2.1.1.1">Total Training</span></span>
<span class="ltx_tr" id="S5.T3.4.1.4.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.4.2.1.2.1">Time(s)</span></span>
</span></span><span class="ltx_text" id="S5.T3.4.1.4.3"></span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.5">
<span class="ltx_text" id="S5.T3.4.1.5.1"></span> <span class="ltx_text" id="S5.T3.4.1.5.2">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.4.1.5.2.1">
<span class="ltx_tr" id="S5.T3.4.1.5.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.5.2.1.1.1">Inference</span></span>
<span class="ltx_tr" id="S5.T3.4.1.5.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.1.5.2.1.2.1">Time(s)</span></span>
</span></span><span class="ltx_text" id="S5.T3.4.1.5.3"></span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.2">
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T3.4.2.1">GAMENet</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.2.2">39</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.2.3">45.31</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.2.4">1767.09</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.2.5">19.27</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.3">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.3.1">SafeDrug</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.3.2">54</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.3.3">38.32</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.3.4">2069.28</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.3.5">20.15</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.4">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.4.1">MICRON</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.4.2">40</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.4.3">17.48</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.4.4">699.20</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.4.5">14.48</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.5">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.5.1">COGNet</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.5.2">103</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.5.3">38.85</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.5.4">4001.55</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.5.5">142.91</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.6">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.6.1">MoleRec</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.6.2">25</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.6.3">249.32</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.6.4">6233.00</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.6.5">32.10</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.7">
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="S5.T3.4.7.1">BiMoRec</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.7.2">15</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.7.3">416.61</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.7.4">6249.15</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.4.7.5">15.16</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S5.SS5.p4">
<p class="ltx_p" id="S5.SS5.p4.1">Additionally, we compare the operational efficiency of different models, including the training time per epoch, total training time, and inference time for each model, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S5.T3" title="Table 3 ‣ 5.5 Performance Comparison ‣ 5 Experiments ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS5.p5">
<p class="ltx_p" id="S5.SS5.p5.1">GAMENet significantly improves model accuracy compared to previous models by integrating patients’ visit history into the model framework without significantly increasing model complexity. However, its DDI rate is too high.
SafeDrug significantly reduces the DDI rate by explicitly modeling relationships between medication molecules, but it does not capture relationships between medications and diseases, leaving room for improvement in accuracy.
MICRON adjusts recommended medication combinations by capturing changes in patients’ physical conditions between two visits, thereby improving accuracy and training efficiency after certain data filtering.
COGNet designs a replication mechanism that significantly improves the Jaccard metric but increases the number of iterations, affecting its time efficiency and failing to ensure the safety of certain medication combinations.
MoleRec introduces external knowledge of molecules, constructs relationships between medication molecules and their substructures, and links them with patients’ diseases and surgeries, improving accuracy without severely impacting safety. However, due to the introduction of deep graph networks and message-passing mechanisms, it significantly reduces training speed.</p>
</div>
<div class="ltx_para" id="S5.SS5.p6">
<p class="ltx_p" id="S5.SS5.p6.1">Our model introduces the 3D modality of molecules, recalibrating the representations of molecules and their substructures, thus increasing the dimensionality of molecular representations and addressing the existing issue of structural confusion. We design a visit-level substructure enhancement mechanism, adjusting the interaction mechanism between molecular knowledge and the patient’s health condition, enhancing the model’s rationality and accuracy. This approach only slightly increases the DDI rate, ensuring a balance between accuracy and safety.</p>
</div>
<div class="ltx_para" id="S5.SS5.p7">
<p class="ltx_p" id="S5.SS5.p7.1">Comparing the operational efficiency of the models, although the training time per epoch for our model is relatively long, the number of epochs required for convergence is significantly shortened during actual training, often requiring only 15 epochs for convergence. Therefore, the total training time is not significantly increased compared to MoleRec.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussions</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this section, we delve into a detailed analysis of the experimental outcomes previously discussed. Additionally, we carry out a series of supplementary experiments to affirm the comprehensiveness and logic behind our approach, ensuring its robustness and the validity of its advancements in the field.</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Effectiveness Analysis</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">The above comparative experiments demonstrate the superior performance of our model in terms of accuracy and safety. We will conduct a comprehensive analysis of the experimental results here.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">Previous medication recommendation works typically base medication recommendations on the patient’s physical condition. With the introduction of external molecular knowledge, accuracy and safety further improve. However, the introduced molecular structures are merely 2D projections of the actual molecular structures, leading to structural confusion issues. Additionally, molecular substructures do not interact independently with the patient’s single visit state, resulting in a lack of crucial substructure combinations needed for each visit’s medication.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">To address the identified issues, we introduce the 3D modality of molecules, filling in the missing three-dimensional information in molecular representation and effectively resolving the structural confusion problem. Simultaneously, we directly interact molecular knowledge with the patient’s single visit representation, obtaining the necessary molecular substructures for each visit. We use the patient’s latest representation as a standard to adjust the weights of the substructures, correcting biases to better utilize the introduced molecular knowledge. Our proposed method addresses issues not discovered by other models, significantly enhancing the rationality and overall performance of the medication recommendation system.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Efficiency Analysis</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.8">To more accurately represent the efficiency of our model, we analyze the time complexity of the model step by step. In the pre-training module, we use GIN and GVP networks to obtain two molecular modalities’ representations, along with two fully connected layers and an NTXent layer. The time complexity of the GNN layer is <math alttext="O(4\cdot(N+E)^{4})" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><mrow id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml"><mi id="S6.SS2.p1.1.m1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.1.m1.1.1.2" xref="S6.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.1.m1.1.1.1.1" xref="S6.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.1.m1.1.1.1.1.1" xref="S6.SS2.p1.1.m1.1.1.1.1.1.cmml"><mn id="S6.SS2.p1.1.m1.1.1.1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.1.1.1.3.cmml">4</mn><mo id="S6.SS2.p1.1.m1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.1.m1.1.1.1.1.1.2.cmml">⋅</mo><msup id="S6.SS2.p1.1.m1.1.1.1.1.1.1" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">N</mi><mo id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">E</mi></mrow><mo id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S6.SS2.p1.1.m1.1.1.1.1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml">4</mn></msup></mrow><mo id="S6.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><apply id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1"><times id="S6.SS2.p1.1.m1.1.1.2.cmml" xref="S6.SS2.p1.1.m1.1.1.2"></times><ci id="S6.SS2.p1.1.m1.1.1.3.cmml" xref="S6.SS2.p1.1.m1.1.1.3">𝑂</ci><apply id="S6.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1"><ci id="S6.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1.1.2">⋅</ci><cn id="S6.SS2.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS2.p1.1.m1.1.1.1.1.1.3">4</cn><apply id="S6.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1"><plus id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑁</ci><ci id="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝐸</ci></apply><cn id="S6.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS2.p1.1.m1.1.1.1.1.1.1.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">O(4\cdot(N+E)^{4})</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">italic_O ( 4 ⋅ ( italic_N + italic_E ) start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="N" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><mi id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><ci id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">italic_N</annotation></semantics></math> is the number of nodes and <math alttext="E" class="ltx_Math" display="inline" id="S6.SS2.p1.3.m3.1"><semantics id="S6.SS2.p1.3.m3.1a"><mi id="S6.SS2.p1.3.m3.1.1" xref="S6.SS2.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.3.m3.1b"><ci id="S6.SS2.p1.3.m3.1.1.cmml" xref="S6.SS2.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.3.m3.1d">italic_E</annotation></semantics></math> is the number of edges. The fully connected layer’s time complexity is <math alttext="O(4\cdot n_{i}\cdot n_{o})" class="ltx_Math" display="inline" id="S6.SS2.p1.4.m4.1"><semantics id="S6.SS2.p1.4.m4.1a"><mrow id="S6.SS2.p1.4.m4.1.1" xref="S6.SS2.p1.4.m4.1.1.cmml"><mi id="S6.SS2.p1.4.m4.1.1.3" xref="S6.SS2.p1.4.m4.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.4.m4.1.1.2" xref="S6.SS2.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.4.m4.1.1.1.1" xref="S6.SS2.p1.4.m4.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.4.m4.1.1.1.1.1" xref="S6.SS2.p1.4.m4.1.1.1.1.1.cmml"><mn id="S6.SS2.p1.4.m4.1.1.1.1.1.2" xref="S6.SS2.p1.4.m4.1.1.1.1.1.2.cmml">4</mn><mo id="S6.SS2.p1.4.m4.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.4.m4.1.1.1.1.1.1.cmml">⋅</mo><msub id="S6.SS2.p1.4.m4.1.1.1.1.1.3" xref="S6.SS2.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S6.SS2.p1.4.m4.1.1.1.1.1.3.2" xref="S6.SS2.p1.4.m4.1.1.1.1.1.3.2.cmml">n</mi><mi id="S6.SS2.p1.4.m4.1.1.1.1.1.3.3" xref="S6.SS2.p1.4.m4.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S6.SS2.p1.4.m4.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.4.m4.1.1.1.1.1.1.cmml">⋅</mo><msub id="S6.SS2.p1.4.m4.1.1.1.1.1.4" xref="S6.SS2.p1.4.m4.1.1.1.1.1.4.cmml"><mi id="S6.SS2.p1.4.m4.1.1.1.1.1.4.2" xref="S6.SS2.p1.4.m4.1.1.1.1.1.4.2.cmml">n</mi><mi id="S6.SS2.p1.4.m4.1.1.1.1.1.4.3" xref="S6.SS2.p1.4.m4.1.1.1.1.1.4.3.cmml">o</mi></msub></mrow><mo id="S6.SS2.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.4.m4.1b"><apply id="S6.SS2.p1.4.m4.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1"><times id="S6.SS2.p1.4.m4.1.1.2.cmml" xref="S6.SS2.p1.4.m4.1.1.2"></times><ci id="S6.SS2.p1.4.m4.1.1.3.cmml" xref="S6.SS2.p1.4.m4.1.1.3">𝑂</ci><apply id="S6.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1"><ci id="S6.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.1">⋅</ci><cn id="S6.SS2.p1.4.m4.1.1.1.1.1.2.cmml" type="integer" xref="S6.SS2.p1.4.m4.1.1.1.1.1.2">4</cn><apply id="S6.SS2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S6.SS2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.3.2">𝑛</ci><ci id="S6.SS2.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S6.SS2.p1.4.m4.1.1.1.1.1.4.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.SS2.p1.4.m4.1.1.1.1.1.4.1.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.4">subscript</csymbol><ci id="S6.SS2.p1.4.m4.1.1.1.1.1.4.2.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.4.2">𝑛</ci><ci id="S6.SS2.p1.4.m4.1.1.1.1.1.4.3.cmml" xref="S6.SS2.p1.4.m4.1.1.1.1.1.4.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.4.m4.1c">O(4\cdot n_{i}\cdot n_{o})</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.4.m4.1d">italic_O ( 4 ⋅ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_n start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="n_{i}" class="ltx_Math" display="inline" id="S6.SS2.p1.5.m5.1"><semantics id="S6.SS2.p1.5.m5.1a"><msub id="S6.SS2.p1.5.m5.1.1" xref="S6.SS2.p1.5.m5.1.1.cmml"><mi id="S6.SS2.p1.5.m5.1.1.2" xref="S6.SS2.p1.5.m5.1.1.2.cmml">n</mi><mi id="S6.SS2.p1.5.m5.1.1.3" xref="S6.SS2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.5.m5.1b"><apply id="S6.SS2.p1.5.m5.1.1.cmml" xref="S6.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.5.m5.1.1.1.cmml" xref="S6.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S6.SS2.p1.5.m5.1.1.2.cmml" xref="S6.SS2.p1.5.m5.1.1.2">𝑛</ci><ci id="S6.SS2.p1.5.m5.1.1.3.cmml" xref="S6.SS2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.5.m5.1c">n_{i}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the number of input nodes and <math alttext="n_{o}" class="ltx_Math" display="inline" id="S6.SS2.p1.6.m6.1"><semantics id="S6.SS2.p1.6.m6.1a"><msub id="S6.SS2.p1.6.m6.1.1" xref="S6.SS2.p1.6.m6.1.1.cmml"><mi id="S6.SS2.p1.6.m6.1.1.2" xref="S6.SS2.p1.6.m6.1.1.2.cmml">n</mi><mi id="S6.SS2.p1.6.m6.1.1.3" xref="S6.SS2.p1.6.m6.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.6.m6.1b"><apply id="S6.SS2.p1.6.m6.1.1.cmml" xref="S6.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.6.m6.1.1.1.cmml" xref="S6.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S6.SS2.p1.6.m6.1.1.2.cmml" xref="S6.SS2.p1.6.m6.1.1.2">𝑛</ci><ci id="S6.SS2.p1.6.m6.1.1.3.cmml" xref="S6.SS2.p1.6.m6.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.6.m6.1c">n_{o}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.6.m6.1d">italic_n start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> is the number of output nodes. The NTXent layer’s time complexity is <math alttext="O(n_{i}^{2})" class="ltx_Math" display="inline" id="S6.SS2.p1.7.m7.1"><semantics id="S6.SS2.p1.7.m7.1a"><mrow id="S6.SS2.p1.7.m7.1.1" xref="S6.SS2.p1.7.m7.1.1.cmml"><mi id="S6.SS2.p1.7.m7.1.1.3" xref="S6.SS2.p1.7.m7.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.7.m7.1.1.2" xref="S6.SS2.p1.7.m7.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.7.m7.1.1.1.1" xref="S6.SS2.p1.7.m7.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.7.m7.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.7.m7.1.1.1.1.1.cmml">(</mo><msubsup id="S6.SS2.p1.7.m7.1.1.1.1.1" xref="S6.SS2.p1.7.m7.1.1.1.1.1.cmml"><mi id="S6.SS2.p1.7.m7.1.1.1.1.1.2.2" xref="S6.SS2.p1.7.m7.1.1.1.1.1.2.2.cmml">n</mi><mi id="S6.SS2.p1.7.m7.1.1.1.1.1.2.3" xref="S6.SS2.p1.7.m7.1.1.1.1.1.2.3.cmml">i</mi><mn id="S6.SS2.p1.7.m7.1.1.1.1.1.3" xref="S6.SS2.p1.7.m7.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S6.SS2.p1.7.m7.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.7.m7.1b"><apply id="S6.SS2.p1.7.m7.1.1.cmml" xref="S6.SS2.p1.7.m7.1.1"><times id="S6.SS2.p1.7.m7.1.1.2.cmml" xref="S6.SS2.p1.7.m7.1.1.2"></times><ci id="S6.SS2.p1.7.m7.1.1.3.cmml" xref="S6.SS2.p1.7.m7.1.1.3">𝑂</ci><apply id="S6.SS2.p1.7.m7.1.1.1.1.1.cmml" xref="S6.SS2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.7.m7.1.1.1.1">superscript</csymbol><apply id="S6.SS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.7.m7.1.1.1.1.1.2.1.cmml" xref="S6.SS2.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S6.SS2.p1.7.m7.1.1.1.1.1.2.2.cmml" xref="S6.SS2.p1.7.m7.1.1.1.1.1.2.2">𝑛</ci><ci id="S6.SS2.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="S6.SS2.p1.7.m7.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S6.SS2.p1.7.m7.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS2.p1.7.m7.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.7.m7.1c">O(n_{i}^{2})</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.7.m7.1d">italic_O ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, and in this model, the NTXent layer runs twice, so the total time complexity is <math alttext="O(2\cdot n_{i}^{2})" class="ltx_Math" display="inline" id="S6.SS2.p1.8.m8.1"><semantics id="S6.SS2.p1.8.m8.1a"><mrow id="S6.SS2.p1.8.m8.1.1" xref="S6.SS2.p1.8.m8.1.1.cmml"><mi id="S6.SS2.p1.8.m8.1.1.3" xref="S6.SS2.p1.8.m8.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.8.m8.1.1.2" xref="S6.SS2.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.8.m8.1.1.1.1" xref="S6.SS2.p1.8.m8.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.8.m8.1.1.1.1.1" xref="S6.SS2.p1.8.m8.1.1.1.1.1.cmml"><mn id="S6.SS2.p1.8.m8.1.1.1.1.1.2" xref="S6.SS2.p1.8.m8.1.1.1.1.1.2.cmml">2</mn><mo id="S6.SS2.p1.8.m8.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.8.m8.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="S6.SS2.p1.8.m8.1.1.1.1.1.3" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3.cmml"><mi id="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.2" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.2.cmml">n</mi><mi id="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.3" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.3.cmml">i</mi><mn id="S6.SS2.p1.8.m8.1.1.1.1.1.3.3" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3.3.cmml">2</mn></msubsup></mrow><mo id="S6.SS2.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.8.m8.1b"><apply id="S6.SS2.p1.8.m8.1.1.cmml" xref="S6.SS2.p1.8.m8.1.1"><times id="S6.SS2.p1.8.m8.1.1.2.cmml" xref="S6.SS2.p1.8.m8.1.1.2"></times><ci id="S6.SS2.p1.8.m8.1.1.3.cmml" xref="S6.SS2.p1.8.m8.1.1.3">𝑂</ci><apply id="S6.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1"><ci id="S6.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1.1.1">⋅</ci><cn id="S6.SS2.p1.8.m8.1.1.1.1.1.2.cmml" type="integer" xref="S6.SS2.p1.8.m8.1.1.1.1.1.2">2</cn><apply id="S6.SS2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS2.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3">superscript</csymbol><apply id="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.1.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3">subscript</csymbol><ci id="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.2.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.2">𝑛</ci><ci id="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.3.cmml" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3.2.3">𝑖</ci></apply><cn id="S6.SS2.p1.8.m8.1.1.1.1.1.3.3.cmml" type="integer" xref="S6.SS2.p1.8.m8.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.8.m8.1c">O(2\cdot n_{i}^{2})</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.8.m8.1d">italic_O ( 2 ⋅ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. Summarizing the above, the total time complexity of the pre-training is approximately</p>
<table class="ltx_equation ltx_eqn_table" id="S6.E46">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="O(4\cdot(N+E)^{4}+4\cdot n_{i}\cdot n_{o}+2\cdot n_{i}^{2})" class="ltx_Math" display="block" id="S6.E46.m1.1"><semantics id="S6.E46.m1.1a"><mrow id="S6.E46.m1.1.1" xref="S6.E46.m1.1.1.cmml"><mi id="S6.E46.m1.1.1.3" xref="S6.E46.m1.1.1.3.cmml">O</mi><mo id="S6.E46.m1.1.1.2" xref="S6.E46.m1.1.1.2.cmml">⁢</mo><mrow id="S6.E46.m1.1.1.1.1" xref="S6.E46.m1.1.1.1.1.1.cmml"><mo id="S6.E46.m1.1.1.1.1.2" stretchy="false" xref="S6.E46.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E46.m1.1.1.1.1.1" xref="S6.E46.m1.1.1.1.1.1.cmml"><mrow id="S6.E46.m1.1.1.1.1.1.1" xref="S6.E46.m1.1.1.1.1.1.1.cmml"><mn id="S6.E46.m1.1.1.1.1.1.1.3" xref="S6.E46.m1.1.1.1.1.1.1.3.cmml">4</mn><mo id="S6.E46.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S6.E46.m1.1.1.1.1.1.1.2.cmml">⋅</mo><msup id="S6.E46.m1.1.1.1.1.1.1.1" xref="S6.E46.m1.1.1.1.1.1.1.1.cmml"><mrow id="S6.E46.m1.1.1.1.1.1.1.1.1.1" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E46.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">N</mi><mo id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">E</mi></mrow><mo id="S6.E46.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S6.E46.m1.1.1.1.1.1.1.1.3" xref="S6.E46.m1.1.1.1.1.1.1.1.3.cmml">4</mn></msup></mrow><mo id="S6.E46.m1.1.1.1.1.1.2" xref="S6.E46.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S6.E46.m1.1.1.1.1.1.3" xref="S6.E46.m1.1.1.1.1.1.3.cmml"><mn id="S6.E46.m1.1.1.1.1.1.3.2" xref="S6.E46.m1.1.1.1.1.1.3.2.cmml">4</mn><mo id="S6.E46.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.E46.m1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S6.E46.m1.1.1.1.1.1.3.3" xref="S6.E46.m1.1.1.1.1.1.3.3.cmml"><mi id="S6.E46.m1.1.1.1.1.1.3.3.2" xref="S6.E46.m1.1.1.1.1.1.3.3.2.cmml">n</mi><mi id="S6.E46.m1.1.1.1.1.1.3.3.3" xref="S6.E46.m1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S6.E46.m1.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S6.E46.m1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S6.E46.m1.1.1.1.1.1.3.4" xref="S6.E46.m1.1.1.1.1.1.3.4.cmml"><mi id="S6.E46.m1.1.1.1.1.1.3.4.2" xref="S6.E46.m1.1.1.1.1.1.3.4.2.cmml">n</mi><mi id="S6.E46.m1.1.1.1.1.1.3.4.3" xref="S6.E46.m1.1.1.1.1.1.3.4.3.cmml">o</mi></msub></mrow><mo id="S6.E46.m1.1.1.1.1.1.2a" xref="S6.E46.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S6.E46.m1.1.1.1.1.1.4" xref="S6.E46.m1.1.1.1.1.1.4.cmml"><mn id="S6.E46.m1.1.1.1.1.1.4.2" xref="S6.E46.m1.1.1.1.1.1.4.2.cmml">2</mn><mo id="S6.E46.m1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="S6.E46.m1.1.1.1.1.1.4.1.cmml">⋅</mo><msubsup id="S6.E46.m1.1.1.1.1.1.4.3" xref="S6.E46.m1.1.1.1.1.1.4.3.cmml"><mi id="S6.E46.m1.1.1.1.1.1.4.3.2.2" xref="S6.E46.m1.1.1.1.1.1.4.3.2.2.cmml">n</mi><mi id="S6.E46.m1.1.1.1.1.1.4.3.2.3" xref="S6.E46.m1.1.1.1.1.1.4.3.2.3.cmml">i</mi><mn id="S6.E46.m1.1.1.1.1.1.4.3.3" xref="S6.E46.m1.1.1.1.1.1.4.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S6.E46.m1.1.1.1.1.3" stretchy="false" xref="S6.E46.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E46.m1.1b"><apply id="S6.E46.m1.1.1.cmml" xref="S6.E46.m1.1.1"><times id="S6.E46.m1.1.1.2.cmml" xref="S6.E46.m1.1.1.2"></times><ci id="S6.E46.m1.1.1.3.cmml" xref="S6.E46.m1.1.1.3">𝑂</ci><apply id="S6.E46.m1.1.1.1.1.1.cmml" xref="S6.E46.m1.1.1.1.1"><plus id="S6.E46.m1.1.1.1.1.1.2.cmml" xref="S6.E46.m1.1.1.1.1.1.2"></plus><apply id="S6.E46.m1.1.1.1.1.1.1.cmml" xref="S6.E46.m1.1.1.1.1.1.1"><ci id="S6.E46.m1.1.1.1.1.1.1.2.cmml" xref="S6.E46.m1.1.1.1.1.1.1.2">⋅</ci><cn id="S6.E46.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.E46.m1.1.1.1.1.1.1.3">4</cn><apply id="S6.E46.m1.1.1.1.1.1.1.1.cmml" xref="S6.E46.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E46.m1.1.1.1.1.1.1.1.2.cmml" xref="S6.E46.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1"><plus id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.2">𝑁</ci><ci id="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E46.m1.1.1.1.1.1.1.1.1.1.1.3">𝐸</ci></apply><cn id="S6.E46.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.E46.m1.1.1.1.1.1.1.1.3">4</cn></apply></apply><apply id="S6.E46.m1.1.1.1.1.1.3.cmml" xref="S6.E46.m1.1.1.1.1.1.3"><ci id="S6.E46.m1.1.1.1.1.1.3.1.cmml" xref="S6.E46.m1.1.1.1.1.1.3.1">⋅</ci><cn id="S6.E46.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S6.E46.m1.1.1.1.1.1.3.2">4</cn><apply id="S6.E46.m1.1.1.1.1.1.3.3.cmml" xref="S6.E46.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S6.E46.m1.1.1.1.1.1.3.3.1.cmml" xref="S6.E46.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S6.E46.m1.1.1.1.1.1.3.3.2.cmml" xref="S6.E46.m1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="S6.E46.m1.1.1.1.1.1.3.3.3.cmml" xref="S6.E46.m1.1.1.1.1.1.3.3.3">𝑖</ci></apply><apply id="S6.E46.m1.1.1.1.1.1.3.4.cmml" xref="S6.E46.m1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S6.E46.m1.1.1.1.1.1.3.4.1.cmml" xref="S6.E46.m1.1.1.1.1.1.3.4">subscript</csymbol><ci id="S6.E46.m1.1.1.1.1.1.3.4.2.cmml" xref="S6.E46.m1.1.1.1.1.1.3.4.2">𝑛</ci><ci id="S6.E46.m1.1.1.1.1.1.3.4.3.cmml" xref="S6.E46.m1.1.1.1.1.1.3.4.3">𝑜</ci></apply></apply><apply id="S6.E46.m1.1.1.1.1.1.4.cmml" xref="S6.E46.m1.1.1.1.1.1.4"><ci id="S6.E46.m1.1.1.1.1.1.4.1.cmml" xref="S6.E46.m1.1.1.1.1.1.4.1">⋅</ci><cn id="S6.E46.m1.1.1.1.1.1.4.2.cmml" type="integer" xref="S6.E46.m1.1.1.1.1.1.4.2">2</cn><apply id="S6.E46.m1.1.1.1.1.1.4.3.cmml" xref="S6.E46.m1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S6.E46.m1.1.1.1.1.1.4.3.1.cmml" xref="S6.E46.m1.1.1.1.1.1.4.3">superscript</csymbol><apply id="S6.E46.m1.1.1.1.1.1.4.3.2.cmml" xref="S6.E46.m1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S6.E46.m1.1.1.1.1.1.4.3.2.1.cmml" xref="S6.E46.m1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S6.E46.m1.1.1.1.1.1.4.3.2.2.cmml" xref="S6.E46.m1.1.1.1.1.1.4.3.2.2">𝑛</ci><ci id="S6.E46.m1.1.1.1.1.1.4.3.2.3.cmml" xref="S6.E46.m1.1.1.1.1.1.4.3.2.3">𝑖</ci></apply><cn id="S6.E46.m1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S6.E46.m1.1.1.1.1.1.4.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E46.m1.1c">O(4\cdot(N+E)^{4}+4\cdot n_{i}\cdot n_{o}+2\cdot n_{i}^{2})</annotation><annotation encoding="application/x-llamapun" id="S6.E46.m1.1d">italic_O ( 4 ⋅ ( italic_N + italic_E ) start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT + 4 ⋅ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_n start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT + 2 ⋅ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(46)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS2.p1.23">In the subsequent substructure multi-enhancement stage, we use three embedding layers, a GRU layer, a molecular structure and its substructure graph neural network along with the corresponding attention mechanism, and multiple fully connected layers. The time complexity of the embedding layers is <math alttext="O(3\cdot n\cdot d)" class="ltx_Math" display="inline" id="S6.SS2.p1.9.m1.1"><semantics id="S6.SS2.p1.9.m1.1a"><mrow id="S6.SS2.p1.9.m1.1.1" xref="S6.SS2.p1.9.m1.1.1.cmml"><mi id="S6.SS2.p1.9.m1.1.1.3" xref="S6.SS2.p1.9.m1.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.9.m1.1.1.2" xref="S6.SS2.p1.9.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.9.m1.1.1.1.1" xref="S6.SS2.p1.9.m1.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.9.m1.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.9.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.9.m1.1.1.1.1.1" xref="S6.SS2.p1.9.m1.1.1.1.1.1.cmml"><mn id="S6.SS2.p1.9.m1.1.1.1.1.1.2" xref="S6.SS2.p1.9.m1.1.1.1.1.1.2.cmml">3</mn><mo id="S6.SS2.p1.9.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.9.m1.1.1.1.1.1.1.cmml">⋅</mo><mi id="S6.SS2.p1.9.m1.1.1.1.1.1.3" xref="S6.SS2.p1.9.m1.1.1.1.1.1.3.cmml">n</mi><mo id="S6.SS2.p1.9.m1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.9.m1.1.1.1.1.1.1.cmml">⋅</mo><mi id="S6.SS2.p1.9.m1.1.1.1.1.1.4" xref="S6.SS2.p1.9.m1.1.1.1.1.1.4.cmml">d</mi></mrow><mo id="S6.SS2.p1.9.m1.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.9.m1.1b"><apply id="S6.SS2.p1.9.m1.1.1.cmml" xref="S6.SS2.p1.9.m1.1.1"><times id="S6.SS2.p1.9.m1.1.1.2.cmml" xref="S6.SS2.p1.9.m1.1.1.2"></times><ci id="S6.SS2.p1.9.m1.1.1.3.cmml" xref="S6.SS2.p1.9.m1.1.1.3">𝑂</ci><apply id="S6.SS2.p1.9.m1.1.1.1.1.1.cmml" xref="S6.SS2.p1.9.m1.1.1.1.1"><ci id="S6.SS2.p1.9.m1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.9.m1.1.1.1.1.1.1">⋅</ci><cn id="S6.SS2.p1.9.m1.1.1.1.1.1.2.cmml" type="integer" xref="S6.SS2.p1.9.m1.1.1.1.1.1.2">3</cn><ci id="S6.SS2.p1.9.m1.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.9.m1.1.1.1.1.1.3">𝑛</ci><ci id="S6.SS2.p1.9.m1.1.1.1.1.1.4.cmml" xref="S6.SS2.p1.9.m1.1.1.1.1.1.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.9.m1.1c">O(3\cdot n\cdot d)</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.9.m1.1d">italic_O ( 3 ⋅ italic_n ⋅ italic_d )</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S6.SS2.p1.10.m2.1"><semantics id="S6.SS2.p1.10.m2.1a"><mi id="S6.SS2.p1.10.m2.1.1" xref="S6.SS2.p1.10.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.10.m2.1b"><ci id="S6.SS2.p1.10.m2.1.1.cmml" xref="S6.SS2.p1.10.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.10.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.10.m2.1d">italic_n</annotation></semantics></math> is the length of the input sequence and <math alttext="d" class="ltx_Math" display="inline" id="S6.SS2.p1.11.m3.1"><semantics id="S6.SS2.p1.11.m3.1a"><mi id="S6.SS2.p1.11.m3.1.1" xref="S6.SS2.p1.11.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.11.m3.1b"><ci id="S6.SS2.p1.11.m3.1.1.cmml" xref="S6.SS2.p1.11.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.11.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.11.m3.1d">italic_d</annotation></semantics></math> is the size of the embedding dimension. The time complexity of the GRU layer is <math alttext="O(t\cdot h^{2})" class="ltx_Math" display="inline" id="S6.SS2.p1.12.m4.1"><semantics id="S6.SS2.p1.12.m4.1a"><mrow id="S6.SS2.p1.12.m4.1.1" xref="S6.SS2.p1.12.m4.1.1.cmml"><mi id="S6.SS2.p1.12.m4.1.1.3" xref="S6.SS2.p1.12.m4.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.12.m4.1.1.2" xref="S6.SS2.p1.12.m4.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.12.m4.1.1.1.1" xref="S6.SS2.p1.12.m4.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.12.m4.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.12.m4.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.12.m4.1.1.1.1.1" xref="S6.SS2.p1.12.m4.1.1.1.1.1.cmml"><mi id="S6.SS2.p1.12.m4.1.1.1.1.1.2" xref="S6.SS2.p1.12.m4.1.1.1.1.1.2.cmml">t</mi><mo id="S6.SS2.p1.12.m4.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.12.m4.1.1.1.1.1.1.cmml">⋅</mo><msup id="S6.SS2.p1.12.m4.1.1.1.1.1.3" xref="S6.SS2.p1.12.m4.1.1.1.1.1.3.cmml"><mi id="S6.SS2.p1.12.m4.1.1.1.1.1.3.2" xref="S6.SS2.p1.12.m4.1.1.1.1.1.3.2.cmml">h</mi><mn id="S6.SS2.p1.12.m4.1.1.1.1.1.3.3" xref="S6.SS2.p1.12.m4.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S6.SS2.p1.12.m4.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.12.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.12.m4.1b"><apply id="S6.SS2.p1.12.m4.1.1.cmml" xref="S6.SS2.p1.12.m4.1.1"><times id="S6.SS2.p1.12.m4.1.1.2.cmml" xref="S6.SS2.p1.12.m4.1.1.2"></times><ci id="S6.SS2.p1.12.m4.1.1.3.cmml" xref="S6.SS2.p1.12.m4.1.1.3">𝑂</ci><apply id="S6.SS2.p1.12.m4.1.1.1.1.1.cmml" xref="S6.SS2.p1.12.m4.1.1.1.1"><ci id="S6.SS2.p1.12.m4.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.12.m4.1.1.1.1.1.1">⋅</ci><ci id="S6.SS2.p1.12.m4.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.12.m4.1.1.1.1.1.2">𝑡</ci><apply id="S6.SS2.p1.12.m4.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.12.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS2.p1.12.m4.1.1.1.1.1.3.1.cmml" xref="S6.SS2.p1.12.m4.1.1.1.1.1.3">superscript</csymbol><ci id="S6.SS2.p1.12.m4.1.1.1.1.1.3.2.cmml" xref="S6.SS2.p1.12.m4.1.1.1.1.1.3.2">ℎ</ci><cn id="S6.SS2.p1.12.m4.1.1.1.1.1.3.3.cmml" type="integer" xref="S6.SS2.p1.12.m4.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.12.m4.1c">O(t\cdot h^{2})</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.12.m4.1d">italic_O ( italic_t ⋅ italic_h start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="t" class="ltx_Math" display="inline" id="S6.SS2.p1.13.m5.1"><semantics id="S6.SS2.p1.13.m5.1a"><mi id="S6.SS2.p1.13.m5.1.1" xref="S6.SS2.p1.13.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.13.m5.1b"><ci id="S6.SS2.p1.13.m5.1.1.cmml" xref="S6.SS2.p1.13.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.13.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.13.m5.1d">italic_t</annotation></semantics></math> is the sequence length and <math alttext="h" class="ltx_Math" display="inline" id="S6.SS2.p1.14.m6.1"><semantics id="S6.SS2.p1.14.m6.1a"><mi id="S6.SS2.p1.14.m6.1.1" xref="S6.SS2.p1.14.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.14.m6.1b"><ci id="S6.SS2.p1.14.m6.1.1.cmml" xref="S6.SS2.p1.14.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.14.m6.1c">h</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.14.m6.1d">italic_h</annotation></semantics></math> is the size of the hidden layer. The time complexity of the GNN layer is <math alttext="O(2\cdot(N+E)^{4})" class="ltx_Math" display="inline" id="S6.SS2.p1.15.m7.1"><semantics id="S6.SS2.p1.15.m7.1a"><mrow id="S6.SS2.p1.15.m7.1.1" xref="S6.SS2.p1.15.m7.1.1.cmml"><mi id="S6.SS2.p1.15.m7.1.1.3" xref="S6.SS2.p1.15.m7.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.15.m7.1.1.2" xref="S6.SS2.p1.15.m7.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.15.m7.1.1.1.1" xref="S6.SS2.p1.15.m7.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.15.m7.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.15.m7.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.15.m7.1.1.1.1.1" xref="S6.SS2.p1.15.m7.1.1.1.1.1.cmml"><mn id="S6.SS2.p1.15.m7.1.1.1.1.1.3" xref="S6.SS2.p1.15.m7.1.1.1.1.1.3.cmml">2</mn><mo id="S6.SS2.p1.15.m7.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.15.m7.1.1.1.1.1.2.cmml">⋅</mo><msup id="S6.SS2.p1.15.m7.1.1.1.1.1.1" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.cmml"><mrow id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.2" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.2.cmml">N</mi><mo id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.1" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.3" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.3.cmml">E</mi></mrow><mo id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S6.SS2.p1.15.m7.1.1.1.1.1.1.3" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.3.cmml">4</mn></msup></mrow><mo id="S6.SS2.p1.15.m7.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.15.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.15.m7.1b"><apply id="S6.SS2.p1.15.m7.1.1.cmml" xref="S6.SS2.p1.15.m7.1.1"><times id="S6.SS2.p1.15.m7.1.1.2.cmml" xref="S6.SS2.p1.15.m7.1.1.2"></times><ci id="S6.SS2.p1.15.m7.1.1.3.cmml" xref="S6.SS2.p1.15.m7.1.1.3">𝑂</ci><apply id="S6.SS2.p1.15.m7.1.1.1.1.1.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1"><ci id="S6.SS2.p1.15.m7.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1.1.2">⋅</ci><cn id="S6.SS2.p1.15.m7.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS2.p1.15.m7.1.1.1.1.1.3">2</cn><apply id="S6.SS2.p1.15.m7.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.15.m7.1.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1">superscript</csymbol><apply id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1"><plus id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.2">𝑁</ci><ci id="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.1.1.1.3">𝐸</ci></apply><cn id="S6.SS2.p1.15.m7.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS2.p1.15.m7.1.1.1.1.1.1.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.15.m7.1c">O(2\cdot(N+E)^{4})</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.15.m7.1d">italic_O ( 2 ⋅ ( italic_N + italic_E ) start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="N" class="ltx_Math" display="inline" id="S6.SS2.p1.16.m8.1"><semantics id="S6.SS2.p1.16.m8.1a"><mi id="S6.SS2.p1.16.m8.1.1" xref="S6.SS2.p1.16.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.16.m8.1b"><ci id="S6.SS2.p1.16.m8.1.1.cmml" xref="S6.SS2.p1.16.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.16.m8.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.16.m8.1d">italic_N</annotation></semantics></math> is the number of nodes and <math alttext="E" class="ltx_Math" display="inline" id="S6.SS2.p1.17.m9.1"><semantics id="S6.SS2.p1.17.m9.1a"><mi id="S6.SS2.p1.17.m9.1.1" xref="S6.SS2.p1.17.m9.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.17.m9.1b"><ci id="S6.SS2.p1.17.m9.1.1.cmml" xref="S6.SS2.p1.17.m9.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.17.m9.1c">E</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.17.m9.1d">italic_E</annotation></semantics></math> is the number of edges. The time complexity of the attention mechanism is <math alttext="O(2\cdot L^{2}\cdot D)" class="ltx_Math" display="inline" id="S6.SS2.p1.18.m10.1"><semantics id="S6.SS2.p1.18.m10.1a"><mrow id="S6.SS2.p1.18.m10.1.1" xref="S6.SS2.p1.18.m10.1.1.cmml"><mi id="S6.SS2.p1.18.m10.1.1.3" xref="S6.SS2.p1.18.m10.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.18.m10.1.1.2" xref="S6.SS2.p1.18.m10.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.18.m10.1.1.1.1" xref="S6.SS2.p1.18.m10.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.18.m10.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.18.m10.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.18.m10.1.1.1.1.1" xref="S6.SS2.p1.18.m10.1.1.1.1.1.cmml"><mn id="S6.SS2.p1.18.m10.1.1.1.1.1.2" xref="S6.SS2.p1.18.m10.1.1.1.1.1.2.cmml">2</mn><mo id="S6.SS2.p1.18.m10.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.18.m10.1.1.1.1.1.1.cmml">⋅</mo><msup id="S6.SS2.p1.18.m10.1.1.1.1.1.3" xref="S6.SS2.p1.18.m10.1.1.1.1.1.3.cmml"><mi id="S6.SS2.p1.18.m10.1.1.1.1.1.3.2" xref="S6.SS2.p1.18.m10.1.1.1.1.1.3.2.cmml">L</mi><mn id="S6.SS2.p1.18.m10.1.1.1.1.1.3.3" xref="S6.SS2.p1.18.m10.1.1.1.1.1.3.3.cmml">2</mn></msup><mo id="S6.SS2.p1.18.m10.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.18.m10.1.1.1.1.1.1.cmml">⋅</mo><mi id="S6.SS2.p1.18.m10.1.1.1.1.1.4" xref="S6.SS2.p1.18.m10.1.1.1.1.1.4.cmml">D</mi></mrow><mo id="S6.SS2.p1.18.m10.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.18.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.18.m10.1b"><apply id="S6.SS2.p1.18.m10.1.1.cmml" xref="S6.SS2.p1.18.m10.1.1"><times id="S6.SS2.p1.18.m10.1.1.2.cmml" xref="S6.SS2.p1.18.m10.1.1.2"></times><ci id="S6.SS2.p1.18.m10.1.1.3.cmml" xref="S6.SS2.p1.18.m10.1.1.3">𝑂</ci><apply id="S6.SS2.p1.18.m10.1.1.1.1.1.cmml" xref="S6.SS2.p1.18.m10.1.1.1.1"><ci id="S6.SS2.p1.18.m10.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.18.m10.1.1.1.1.1.1">⋅</ci><cn id="S6.SS2.p1.18.m10.1.1.1.1.1.2.cmml" type="integer" xref="S6.SS2.p1.18.m10.1.1.1.1.1.2">2</cn><apply id="S6.SS2.p1.18.m10.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.18.m10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS2.p1.18.m10.1.1.1.1.1.3.1.cmml" xref="S6.SS2.p1.18.m10.1.1.1.1.1.3">superscript</csymbol><ci id="S6.SS2.p1.18.m10.1.1.1.1.1.3.2.cmml" xref="S6.SS2.p1.18.m10.1.1.1.1.1.3.2">𝐿</ci><cn id="S6.SS2.p1.18.m10.1.1.1.1.1.3.3.cmml" type="integer" xref="S6.SS2.p1.18.m10.1.1.1.1.1.3.3">2</cn></apply><ci id="S6.SS2.p1.18.m10.1.1.1.1.1.4.cmml" xref="S6.SS2.p1.18.m10.1.1.1.1.1.4">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.18.m10.1c">O(2\cdot L^{2}\cdot D)</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.18.m10.1d">italic_O ( 2 ⋅ italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_D )</annotation></semantics></math>, where <math alttext="L" class="ltx_Math" display="inline" id="S6.SS2.p1.19.m11.1"><semantics id="S6.SS2.p1.19.m11.1a"><mi id="S6.SS2.p1.19.m11.1.1" xref="S6.SS2.p1.19.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.19.m11.1b"><ci id="S6.SS2.p1.19.m11.1.1.cmml" xref="S6.SS2.p1.19.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.19.m11.1c">L</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.19.m11.1d">italic_L</annotation></semantics></math> is the length of the input sequence and <math alttext="D" class="ltx_Math" display="inline" id="S6.SS2.p1.20.m12.1"><semantics id="S6.SS2.p1.20.m12.1a"><mi id="S6.SS2.p1.20.m12.1.1" xref="S6.SS2.p1.20.m12.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.20.m12.1b"><ci id="S6.SS2.p1.20.m12.1.1.cmml" xref="S6.SS2.p1.20.m12.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.20.m12.1c">D</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.20.m12.1d">italic_D</annotation></semantics></math> is the corresponding dimension. The time complexity of multiple fully connected layers is denoted as <math alttext="O(\Sigma(n_{i}\cdot n_{o}))" class="ltx_Math" display="inline" id="S6.SS2.p1.21.m13.1"><semantics id="S6.SS2.p1.21.m13.1a"><mrow id="S6.SS2.p1.21.m13.1.1" xref="S6.SS2.p1.21.m13.1.1.cmml"><mi id="S6.SS2.p1.21.m13.1.1.3" xref="S6.SS2.p1.21.m13.1.1.3.cmml">O</mi><mo id="S6.SS2.p1.21.m13.1.1.2" xref="S6.SS2.p1.21.m13.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.21.m13.1.1.1.1" xref="S6.SS2.p1.21.m13.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.21.m13.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.21.m13.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.21.m13.1.1.1.1.1" xref="S6.SS2.p1.21.m13.1.1.1.1.1.cmml"><mi id="S6.SS2.p1.21.m13.1.1.1.1.1.3" mathvariant="normal" xref="S6.SS2.p1.21.m13.1.1.1.1.1.3.cmml">Σ</mi><mo id="S6.SS2.p1.21.m13.1.1.1.1.1.2" xref="S6.SS2.p1.21.m13.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.cmml"><mo id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.cmml"><msub id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.cmml"><mi id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.2" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.3" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.cmml"><mi id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.2" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.2.cmml">n</mi><mi id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.3" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.SS2.p1.21.m13.1.1.1.1.3" stretchy="false" xref="S6.SS2.p1.21.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.21.m13.1b"><apply id="S6.SS2.p1.21.m13.1.1.cmml" xref="S6.SS2.p1.21.m13.1.1"><times id="S6.SS2.p1.21.m13.1.1.2.cmml" xref="S6.SS2.p1.21.m13.1.1.2"></times><ci id="S6.SS2.p1.21.m13.1.1.3.cmml" xref="S6.SS2.p1.21.m13.1.1.3">𝑂</ci><apply id="S6.SS2.p1.21.m13.1.1.1.1.1.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1"><times id="S6.SS2.p1.21.m13.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.2"></times><ci id="S6.SS2.p1.21.m13.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.3">Σ</ci><apply id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1"><ci id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.1">⋅</ci><apply id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.1.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.2.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.2">𝑛</ci><ci id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.3.cmml" xref="S6.SS2.p1.21.m13.1.1.1.1.1.1.1.1.3.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.21.m13.1c">O(\Sigma(n_{i}\cdot n_{o}))</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.21.m13.1d">italic_O ( roman_Σ ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_n start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) )</annotation></semantics></math>, where <math alttext="n_{i}" class="ltx_Math" display="inline" id="S6.SS2.p1.22.m14.1"><semantics id="S6.SS2.p1.22.m14.1a"><msub id="S6.SS2.p1.22.m14.1.1" xref="S6.SS2.p1.22.m14.1.1.cmml"><mi id="S6.SS2.p1.22.m14.1.1.2" xref="S6.SS2.p1.22.m14.1.1.2.cmml">n</mi><mi id="S6.SS2.p1.22.m14.1.1.3" xref="S6.SS2.p1.22.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.22.m14.1b"><apply id="S6.SS2.p1.22.m14.1.1.cmml" xref="S6.SS2.p1.22.m14.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.22.m14.1.1.1.cmml" xref="S6.SS2.p1.22.m14.1.1">subscript</csymbol><ci id="S6.SS2.p1.22.m14.1.1.2.cmml" xref="S6.SS2.p1.22.m14.1.1.2">𝑛</ci><ci id="S6.SS2.p1.22.m14.1.1.3.cmml" xref="S6.SS2.p1.22.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.22.m14.1c">n_{i}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.22.m14.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the number of input nodes and <math alttext="n_{o}" class="ltx_Math" display="inline" id="S6.SS2.p1.23.m15.1"><semantics id="S6.SS2.p1.23.m15.1a"><msub id="S6.SS2.p1.23.m15.1.1" xref="S6.SS2.p1.23.m15.1.1.cmml"><mi id="S6.SS2.p1.23.m15.1.1.2" xref="S6.SS2.p1.23.m15.1.1.2.cmml">n</mi><mi id="S6.SS2.p1.23.m15.1.1.3" xref="S6.SS2.p1.23.m15.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.23.m15.1b"><apply id="S6.SS2.p1.23.m15.1.1.cmml" xref="S6.SS2.p1.23.m15.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.23.m15.1.1.1.cmml" xref="S6.SS2.p1.23.m15.1.1">subscript</csymbol><ci id="S6.SS2.p1.23.m15.1.1.2.cmml" xref="S6.SS2.p1.23.m15.1.1.2">𝑛</ci><ci id="S6.SS2.p1.23.m15.1.1.3.cmml" xref="S6.SS2.p1.23.m15.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.23.m15.1c">n_{o}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.23.m15.1d">italic_n start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> is the number of output nodes. Finally, the overall time complexity is:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.E47">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="O(3\cdot n\cdot d+t\cdot h^{2}+2\cdot(N+E)^{4}+2\cdot L^{2}\cdot D+\Sigma(n_{i%
}\cdot n_{o}))" class="ltx_Math" display="block" id="S6.E47.m1.1"><semantics id="S6.E47.m1.1a"><mrow id="S6.E47.m1.1.1" xref="S6.E47.m1.1.1.cmml"><mi id="S6.E47.m1.1.1.3" xref="S6.E47.m1.1.1.3.cmml">O</mi><mo id="S6.E47.m1.1.1.2" xref="S6.E47.m1.1.1.2.cmml">⁢</mo><mrow id="S6.E47.m1.1.1.1.1" xref="S6.E47.m1.1.1.1.1.1.cmml"><mo id="S6.E47.m1.1.1.1.1.2" stretchy="false" xref="S6.E47.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E47.m1.1.1.1.1.1" xref="S6.E47.m1.1.1.1.1.1.cmml"><mrow id="S6.E47.m1.1.1.1.1.1.4" xref="S6.E47.m1.1.1.1.1.1.4.cmml"><mn id="S6.E47.m1.1.1.1.1.1.4.2" xref="S6.E47.m1.1.1.1.1.1.4.2.cmml">3</mn><mo id="S6.E47.m1.1.1.1.1.1.4.1" lspace="0.222em" rspace="0.222em" xref="S6.E47.m1.1.1.1.1.1.4.1.cmml">⋅</mo><mi id="S6.E47.m1.1.1.1.1.1.4.3" xref="S6.E47.m1.1.1.1.1.1.4.3.cmml">n</mi><mo id="S6.E47.m1.1.1.1.1.1.4.1a" lspace="0.222em" rspace="0.222em" xref="S6.E47.m1.1.1.1.1.1.4.1.cmml">⋅</mo><mi id="S6.E47.m1.1.1.1.1.1.4.4" xref="S6.E47.m1.1.1.1.1.1.4.4.cmml">d</mi></mrow><mo id="S6.E47.m1.1.1.1.1.1.3" xref="S6.E47.m1.1.1.1.1.1.3.cmml">+</mo><mrow id="S6.E47.m1.1.1.1.1.1.5" xref="S6.E47.m1.1.1.1.1.1.5.cmml"><mi id="S6.E47.m1.1.1.1.1.1.5.2" xref="S6.E47.m1.1.1.1.1.1.5.2.cmml">t</mi><mo id="S6.E47.m1.1.1.1.1.1.5.1" lspace="0.222em" rspace="0.222em" xref="S6.E47.m1.1.1.1.1.1.5.1.cmml">⋅</mo><msup id="S6.E47.m1.1.1.1.1.1.5.3" xref="S6.E47.m1.1.1.1.1.1.5.3.cmml"><mi id="S6.E47.m1.1.1.1.1.1.5.3.2" xref="S6.E47.m1.1.1.1.1.1.5.3.2.cmml">h</mi><mn id="S6.E47.m1.1.1.1.1.1.5.3.3" xref="S6.E47.m1.1.1.1.1.1.5.3.3.cmml">2</mn></msup></mrow><mo id="S6.E47.m1.1.1.1.1.1.3a" xref="S6.E47.m1.1.1.1.1.1.3.cmml">+</mo><mrow id="S6.E47.m1.1.1.1.1.1.1" xref="S6.E47.m1.1.1.1.1.1.1.cmml"><mn id="S6.E47.m1.1.1.1.1.1.1.3" xref="S6.E47.m1.1.1.1.1.1.1.3.cmml">2</mn><mo id="S6.E47.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S6.E47.m1.1.1.1.1.1.1.2.cmml">⋅</mo><msup id="S6.E47.m1.1.1.1.1.1.1.1" xref="S6.E47.m1.1.1.1.1.1.1.1.cmml"><mrow id="S6.E47.m1.1.1.1.1.1.1.1.1.1" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E47.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">N</mi><mo id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">E</mi></mrow><mo id="S6.E47.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S6.E47.m1.1.1.1.1.1.1.1.3" xref="S6.E47.m1.1.1.1.1.1.1.1.3.cmml">4</mn></msup></mrow><mo id="S6.E47.m1.1.1.1.1.1.3b" xref="S6.E47.m1.1.1.1.1.1.3.cmml">+</mo><mrow id="S6.E47.m1.1.1.1.1.1.6" xref="S6.E47.m1.1.1.1.1.1.6.cmml"><mn id="S6.E47.m1.1.1.1.1.1.6.2" xref="S6.E47.m1.1.1.1.1.1.6.2.cmml">2</mn><mo id="S6.E47.m1.1.1.1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="S6.E47.m1.1.1.1.1.1.6.1.cmml">⋅</mo><msup id="S6.E47.m1.1.1.1.1.1.6.3" xref="S6.E47.m1.1.1.1.1.1.6.3.cmml"><mi id="S6.E47.m1.1.1.1.1.1.6.3.2" xref="S6.E47.m1.1.1.1.1.1.6.3.2.cmml">L</mi><mn id="S6.E47.m1.1.1.1.1.1.6.3.3" xref="S6.E47.m1.1.1.1.1.1.6.3.3.cmml">2</mn></msup><mo id="S6.E47.m1.1.1.1.1.1.6.1a" lspace="0.222em" rspace="0.222em" xref="S6.E47.m1.1.1.1.1.1.6.1.cmml">⋅</mo><mi id="S6.E47.m1.1.1.1.1.1.6.4" xref="S6.E47.m1.1.1.1.1.1.6.4.cmml">D</mi></mrow><mo id="S6.E47.m1.1.1.1.1.1.3c" xref="S6.E47.m1.1.1.1.1.1.3.cmml">+</mo><mrow id="S6.E47.m1.1.1.1.1.1.2" xref="S6.E47.m1.1.1.1.1.1.2.cmml"><mi id="S6.E47.m1.1.1.1.1.1.2.3" mathvariant="normal" xref="S6.E47.m1.1.1.1.1.1.2.3.cmml">Σ</mi><mo id="S6.E47.m1.1.1.1.1.1.2.2" xref="S6.E47.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S6.E47.m1.1.1.1.1.1.2.1.1" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S6.E47.m1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S6.E47.m1.1.1.1.1.1.2.1.1.1" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.cmml"><msub id="S6.E47.m1.1.1.1.1.1.2.1.1.1.2" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.2" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.2.cmml">n</mi><mi id="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.3" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S6.E47.m1.1.1.1.1.1.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.1.cmml">⋅</mo><msub id="S6.E47.m1.1.1.1.1.1.2.1.1.1.3" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.2" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.2.cmml">n</mi><mi id="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.3" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S6.E47.m1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.E47.m1.1.1.1.1.3" stretchy="false" xref="S6.E47.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E47.m1.1b"><apply id="S6.E47.m1.1.1.cmml" xref="S6.E47.m1.1.1"><times id="S6.E47.m1.1.1.2.cmml" xref="S6.E47.m1.1.1.2"></times><ci id="S6.E47.m1.1.1.3.cmml" xref="S6.E47.m1.1.1.3">𝑂</ci><apply id="S6.E47.m1.1.1.1.1.1.cmml" xref="S6.E47.m1.1.1.1.1"><plus id="S6.E47.m1.1.1.1.1.1.3.cmml" xref="S6.E47.m1.1.1.1.1.1.3"></plus><apply id="S6.E47.m1.1.1.1.1.1.4.cmml" xref="S6.E47.m1.1.1.1.1.1.4"><ci id="S6.E47.m1.1.1.1.1.1.4.1.cmml" xref="S6.E47.m1.1.1.1.1.1.4.1">⋅</ci><cn id="S6.E47.m1.1.1.1.1.1.4.2.cmml" type="integer" xref="S6.E47.m1.1.1.1.1.1.4.2">3</cn><ci id="S6.E47.m1.1.1.1.1.1.4.3.cmml" xref="S6.E47.m1.1.1.1.1.1.4.3">𝑛</ci><ci id="S6.E47.m1.1.1.1.1.1.4.4.cmml" xref="S6.E47.m1.1.1.1.1.1.4.4">𝑑</ci></apply><apply id="S6.E47.m1.1.1.1.1.1.5.cmml" xref="S6.E47.m1.1.1.1.1.1.5"><ci id="S6.E47.m1.1.1.1.1.1.5.1.cmml" xref="S6.E47.m1.1.1.1.1.1.5.1">⋅</ci><ci id="S6.E47.m1.1.1.1.1.1.5.2.cmml" xref="S6.E47.m1.1.1.1.1.1.5.2">𝑡</ci><apply id="S6.E47.m1.1.1.1.1.1.5.3.cmml" xref="S6.E47.m1.1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S6.E47.m1.1.1.1.1.1.5.3.1.cmml" xref="S6.E47.m1.1.1.1.1.1.5.3">superscript</csymbol><ci id="S6.E47.m1.1.1.1.1.1.5.3.2.cmml" xref="S6.E47.m1.1.1.1.1.1.5.3.2">ℎ</ci><cn id="S6.E47.m1.1.1.1.1.1.5.3.3.cmml" type="integer" xref="S6.E47.m1.1.1.1.1.1.5.3.3">2</cn></apply></apply><apply id="S6.E47.m1.1.1.1.1.1.1.cmml" xref="S6.E47.m1.1.1.1.1.1.1"><ci id="S6.E47.m1.1.1.1.1.1.1.2.cmml" xref="S6.E47.m1.1.1.1.1.1.1.2">⋅</ci><cn id="S6.E47.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.E47.m1.1.1.1.1.1.1.3">2</cn><apply id="S6.E47.m1.1.1.1.1.1.1.1.cmml" xref="S6.E47.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E47.m1.1.1.1.1.1.1.1.2.cmml" xref="S6.E47.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1"><plus id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.2">𝑁</ci><ci id="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E47.m1.1.1.1.1.1.1.1.1.1.1.3">𝐸</ci></apply><cn id="S6.E47.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.E47.m1.1.1.1.1.1.1.1.3">4</cn></apply></apply><apply id="S6.E47.m1.1.1.1.1.1.6.cmml" xref="S6.E47.m1.1.1.1.1.1.6"><ci id="S6.E47.m1.1.1.1.1.1.6.1.cmml" xref="S6.E47.m1.1.1.1.1.1.6.1">⋅</ci><cn id="S6.E47.m1.1.1.1.1.1.6.2.cmml" type="integer" xref="S6.E47.m1.1.1.1.1.1.6.2">2</cn><apply id="S6.E47.m1.1.1.1.1.1.6.3.cmml" xref="S6.E47.m1.1.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S6.E47.m1.1.1.1.1.1.6.3.1.cmml" xref="S6.E47.m1.1.1.1.1.1.6.3">superscript</csymbol><ci id="S6.E47.m1.1.1.1.1.1.6.3.2.cmml" xref="S6.E47.m1.1.1.1.1.1.6.3.2">𝐿</ci><cn id="S6.E47.m1.1.1.1.1.1.6.3.3.cmml" type="integer" xref="S6.E47.m1.1.1.1.1.1.6.3.3">2</cn></apply><ci id="S6.E47.m1.1.1.1.1.1.6.4.cmml" xref="S6.E47.m1.1.1.1.1.1.6.4">𝐷</ci></apply><apply id="S6.E47.m1.1.1.1.1.1.2.cmml" xref="S6.E47.m1.1.1.1.1.1.2"><times id="S6.E47.m1.1.1.1.1.1.2.2.cmml" xref="S6.E47.m1.1.1.1.1.1.2.2"></times><ci id="S6.E47.m1.1.1.1.1.1.2.3.cmml" xref="S6.E47.m1.1.1.1.1.1.2.3">Σ</ci><apply id="S6.E47.m1.1.1.1.1.1.2.1.1.1.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1"><ci id="S6.E47.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.1">⋅</ci><apply id="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.2">𝑛</ci><ci id="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.2.3">𝑖</ci></apply><apply id="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.2">𝑛</ci><ci id="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S6.E47.m1.1.1.1.1.1.2.1.1.1.3.3">𝑜</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E47.m1.1c">O(3\cdot n\cdot d+t\cdot h^{2}+2\cdot(N+E)^{4}+2\cdot L^{2}\cdot D+\Sigma(n_{i%
}\cdot n_{o}))</annotation><annotation encoding="application/x-llamapun" id="S6.E47.m1.1d">italic_O ( 3 ⋅ italic_n ⋅ italic_d + italic_t ⋅ italic_h start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 ⋅ ( italic_N + italic_E ) start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT + 2 ⋅ italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_D + roman_Σ ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_n start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(47)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS2.p1.24">Through the above calculations, we observe that the number of layers in the GNN network is an important model setting. Although a 4-layer network structure increases the overall runtime of the model, it enables the model to converge quickly. Therefore, the final time efficiency does not decrease as a result.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Ablation Study</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">To evaluate the contribution of our innovations to the overall performance of the model and eliminate interference from other factors, we delete key modules and perform logical adjustments to set up several variant experiments.</p>
</div>
<figure class="ltx_table" id="S6.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T4.13.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S6.T4.14.2" style="font-size:90%;">The performance of each ablation model on the test set regarding accuracy and safety. The best and the runner-up results are highlighted in bold and underlined respectively under t-tests, at the level of 95% confidence level.</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S6.T4.11">
<tr class="ltx_tr" id="S6.T4.11.12">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_tt" id="S6.T4.11.12.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.12.1.1">
<span class="ltx_p" id="S6.T4.11.12.1.1.1" style="width:76.8pt;"><span class="ltx_text" id="S6.T4.11.12.1.1.1.1">Model</span></span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_align_top ltx_border_r ltx_border_tt" colspan="5" id="S6.T4.11.12.2">MIMIC-III</td>
<td class="ltx_td ltx_align_center ltx_align_top ltx_border_r ltx_border_tt" colspan="5" id="S6.T4.11.12.3">MIMIC-IV</td>
</tr>
<tr class="ltx_tr" id="S6.T4.8.8">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S6.T4.8.8.9">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.8.8.9.1">
<span class="ltx_p" id="S6.T4.8.8.9.1.1" style="width:76.8pt;"></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.1.1.1.1">
<span class="ltx_p" id="S6.T4.1.1.1.1.1" style="width:27.0pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S6.T4.1.1.1.1.1.m1.1"><semantics id="S6.T4.1.1.1.1.1.m1.1a"><mo id="S6.T4.1.1.1.1.1.m1.1.1" stretchy="false" xref="S6.T4.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T4.1.1.1.1.1.m1.1b"><ci id="S6.T4.1.1.1.1.1.m1.1.1.cmml" xref="S6.T4.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.2.2.2.1">
<span class="ltx_p" id="S6.T4.2.2.2.1.1" style="width:27.0pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S6.T4.2.2.2.1.1.m1.1"><semantics id="S6.T4.2.2.2.1.1.m1.1a"><mo id="S6.T4.2.2.2.1.1.m1.1.1" stretchy="false" xref="S6.T4.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T4.2.2.2.1.1.m1.1b"><ci id="S6.T4.2.2.2.1.1.m1.1.1.cmml" xref="S6.T4.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.2.2.2.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.2.2.2.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.3.3.3.1">
<span class="ltx_p" id="S6.T4.3.3.3.1.1" style="width:27.0pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S6.T4.3.3.3.1.1.m1.1"><semantics id="S6.T4.3.3.3.1.1.m1.1a"><mo id="S6.T4.3.3.3.1.1.m1.1.1" stretchy="false" xref="S6.T4.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T4.3.3.3.1.1.m1.1b"><ci id="S6.T4.3.3.3.1.1.m1.1.1.cmml" xref="S6.T4.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.3.3.3.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.3.3.3.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.4.4.4.1">
<span class="ltx_p" id="S6.T4.4.4.4.1.1" style="width:27.0pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S6.T4.4.4.4.1.1.m1.1"><semantics id="S6.T4.4.4.4.1.1.m1.1a"><mo id="S6.T4.4.4.4.1.1.m1.1.1" stretchy="false" xref="S6.T4.4.4.4.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T4.4.4.4.1.1.m1.1b"><ci id="S6.T4.4.4.4.1.1.m1.1.1.cmml" xref="S6.T4.4.4.4.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.4.4.4.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.4.4.4.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T4.8.8.10">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.8.8.10.1">
<span class="ltx_p" id="S6.T4.8.8.10.1.1" style="width:32.7pt;">Avg.#Med</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.5.5.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.5.5.5.1">
<span class="ltx_p" id="S6.T4.5.5.5.1.1" style="width:27.0pt;">Jaccard<math alttext="\uparrow" class="ltx_centering" display="inline" id="S6.T4.5.5.5.1.1.m1.1"><semantics id="S6.T4.5.5.5.1.1.m1.1a"><mo id="S6.T4.5.5.5.1.1.m1.1.1" stretchy="false" xref="S6.T4.5.5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T4.5.5.5.1.1.m1.1b"><ci id="S6.T4.5.5.5.1.1.m1.1.1.cmml" xref="S6.T4.5.5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.5.5.5.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.5.5.5.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.6.6.6">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.6.6.6.1">
<span class="ltx_p" id="S6.T4.6.6.6.1.1" style="width:27.0pt;">DDI<math alttext="\downarrow" class="ltx_centering" display="inline" id="S6.T4.6.6.6.1.1.m1.1"><semantics id="S6.T4.6.6.6.1.1.m1.1a"><mo id="S6.T4.6.6.6.1.1.m1.1.1" stretchy="false" xref="S6.T4.6.6.6.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T4.6.6.6.1.1.m1.1b"><ci id="S6.T4.6.6.6.1.1.m1.1.1.cmml" xref="S6.T4.6.6.6.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.6.6.6.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.6.6.6.1.1.m1.1d">↓</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.7.7.7">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.7.7.7.1">
<span class="ltx_p" id="S6.T4.7.7.7.1.1" style="width:27.0pt;">F1<math alttext="\uparrow" class="ltx_centering" display="inline" id="S6.T4.7.7.7.1.1.m1.1"><semantics id="S6.T4.7.7.7.1.1.m1.1a"><mo id="S6.T4.7.7.7.1.1.m1.1.1" stretchy="false" xref="S6.T4.7.7.7.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T4.7.7.7.1.1.m1.1b"><ci id="S6.T4.7.7.7.1.1.m1.1.1.cmml" xref="S6.T4.7.7.7.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.7.7.7.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.7.7.7.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.8.8.8">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.8.8.8.1">
<span class="ltx_p" id="S6.T4.8.8.8.1.1" style="width:27.0pt;">PRAUC<math alttext="\uparrow" class="ltx_centering" display="inline" id="S6.T4.8.8.8.1.1.m1.1"><semantics id="S6.T4.8.8.8.1.1.m1.1a"><mo id="S6.T4.8.8.8.1.1.m1.1.1" stretchy="false" xref="S6.T4.8.8.8.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T4.8.8.8.1.1.m1.1b"><ci id="S6.T4.8.8.8.1.1.m1.1.1.cmml" xref="S6.T4.8.8.8.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.8.8.8.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T4.8.8.8.1.1.m1.1d">↑</annotation></semantics></math></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T4.8.8.11">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.8.8.11.1">
<span class="ltx_p" id="S6.T4.8.8.11.1.1" style="width:32.7pt;">Avg.#Med</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T4.9.9">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.9.9.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.1.1">
<span class="ltx_p" id="S6.T4.9.9.1.1.1" style="width:76.8pt;">BiMoRec <math alttext="w/o" class="ltx_centering" display="inline" id="S6.T4.9.9.1.1.1.m1.1"><semantics id="S6.T4.9.9.1.1.1.m1.1a"><mrow id="S6.T4.9.9.1.1.1.m1.1.1" xref="S6.T4.9.9.1.1.1.m1.1.1.cmml"><mi id="S6.T4.9.9.1.1.1.m1.1.1.2" xref="S6.T4.9.9.1.1.1.m1.1.1.2.cmml">w</mi><mo id="S6.T4.9.9.1.1.1.m1.1.1.1" xref="S6.T4.9.9.1.1.1.m1.1.1.1.cmml">/</mo><mi id="S6.T4.9.9.1.1.1.m1.1.1.3" xref="S6.T4.9.9.1.1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.9.9.1.1.1.m1.1b"><apply id="S6.T4.9.9.1.1.1.m1.1.1.cmml" xref="S6.T4.9.9.1.1.1.m1.1.1"><divide id="S6.T4.9.9.1.1.1.m1.1.1.1.cmml" xref="S6.T4.9.9.1.1.1.m1.1.1.1"></divide><ci id="S6.T4.9.9.1.1.1.m1.1.1.2.cmml" xref="S6.T4.9.9.1.1.1.m1.1.1.2">𝑤</ci><ci id="S6.T4.9.9.1.1.1.m1.1.1.3.cmml" xref="S6.T4.9.9.1.1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.9.9.1.1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.T4.9.9.1.1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> A</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.2.1">
<span class="ltx_p" id="S6.T4.9.9.2.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.9.9.2.1.1.1">0.5356</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.3.1">
<span class="ltx_p" id="S6.T4.9.9.3.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.9.9.3.1.1.1">0.0697</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.4.1">
<span class="ltx_p" id="S6.T4.9.9.4.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.9.9.4.1.1.1">0.6887</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.5.1">
<span class="ltx_p" id="S6.T4.9.9.5.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.9.9.5.1.1.1">0.7823</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T4.9.9.6">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.6.1">
<span class="ltx_p" id="S6.T4.9.9.6.1.1" style="width:32.7pt;">20.4086</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.7">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.7.1">
<span class="ltx_p" id="S6.T4.9.9.7.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.9.9.7.1.1.1">0.4832</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.8">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.8.1">
<span class="ltx_p" id="S6.T4.9.9.8.1.1" style="width:27.0pt;">0.0704</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.9">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.9.1">
<span class="ltx_p" id="S6.T4.9.9.9.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.9.9.9.1.1.1">0.6348</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T4.9.9.10">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.10.1">
<span class="ltx_p" id="S6.T4.9.9.10.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.9.9.10.1.1.1">0.7268</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T4.9.9.11">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.9.9.11.1">
<span class="ltx_p" id="S6.T4.9.9.11.1.1" style="width:32.7pt;">13.5401</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T4.10.10">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S6.T4.10.10.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.1.1">
<span class="ltx_p" id="S6.T4.10.10.1.1.1" style="width:76.8pt;">BiMoRec <math alttext="w/o" class="ltx_centering" display="inline" id="S6.T4.10.10.1.1.1.m1.1"><semantics id="S6.T4.10.10.1.1.1.m1.1a"><mrow id="S6.T4.10.10.1.1.1.m1.1.1" xref="S6.T4.10.10.1.1.1.m1.1.1.cmml"><mi id="S6.T4.10.10.1.1.1.m1.1.1.2" xref="S6.T4.10.10.1.1.1.m1.1.1.2.cmml">w</mi><mo id="S6.T4.10.10.1.1.1.m1.1.1.1" xref="S6.T4.10.10.1.1.1.m1.1.1.1.cmml">/</mo><mi id="S6.T4.10.10.1.1.1.m1.1.1.3" xref="S6.T4.10.10.1.1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.10.10.1.1.1.m1.1b"><apply id="S6.T4.10.10.1.1.1.m1.1.1.cmml" xref="S6.T4.10.10.1.1.1.m1.1.1"><divide id="S6.T4.10.10.1.1.1.m1.1.1.1.cmml" xref="S6.T4.10.10.1.1.1.m1.1.1.1"></divide><ci id="S6.T4.10.10.1.1.1.m1.1.1.2.cmml" xref="S6.T4.10.10.1.1.1.m1.1.1.2">𝑤</ci><ci id="S6.T4.10.10.1.1.1.m1.1.1.3.cmml" xref="S6.T4.10.10.1.1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.10.10.1.1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.T4.10.10.1.1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.2.1">
<span class="ltx_p" id="S6.T4.10.10.2.1.1" style="width:27.0pt;">0.5347</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.3.1">
<span class="ltx_p" id="S6.T4.10.10.3.1.1" style="width:27.0pt;">0.0735</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.4.1">
<span class="ltx_p" id="S6.T4.10.10.4.1.1" style="width:27.0pt;">0.6882</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.5.1">
<span class="ltx_p" id="S6.T4.10.10.5.1.1" style="width:27.0pt;">0.7752</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T4.10.10.6">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.6.1">
<span class="ltx_p" id="S6.T4.10.10.6.1.1" style="width:32.7pt;">21.8691</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.7">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.7.1">
<span class="ltx_p" id="S6.T4.10.10.7.1.1" style="width:27.0pt;">0.4800</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.8">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.8.1">
<span class="ltx_p" id="S6.T4.10.10.8.1.1" style="width:27.0pt;">0.0698</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.9">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.9.1">
<span class="ltx_p" id="S6.T4.10.10.9.1.1" style="width:27.0pt;">0.6320</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.10.10.10">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.10.1">
<span class="ltx_p" id="S6.T4.10.10.10.1.1" style="width:27.0pt;">0.7231</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T4.10.10.11">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.10.10.11.1">
<span class="ltx_p" id="S6.T4.10.10.11.1.1" style="width:32.7pt;">15.5599</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T4.11.11">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" id="S6.T4.11.11.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.1.1">
<span class="ltx_p" id="S6.T4.11.11.1.1.1" style="width:76.8pt;">BiMoRec <math alttext="w/o" class="ltx_centering" display="inline" id="S6.T4.11.11.1.1.1.m1.1"><semantics id="S6.T4.11.11.1.1.1.m1.1a"><mrow id="S6.T4.11.11.1.1.1.m1.1.1" xref="S6.T4.11.11.1.1.1.m1.1.1.cmml"><mi id="S6.T4.11.11.1.1.1.m1.1.1.2" xref="S6.T4.11.11.1.1.1.m1.1.1.2.cmml">w</mi><mo id="S6.T4.11.11.1.1.1.m1.1.1.1" xref="S6.T4.11.11.1.1.1.m1.1.1.1.cmml">/</mo><mi id="S6.T4.11.11.1.1.1.m1.1.1.3" xref="S6.T4.11.11.1.1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.11.11.1.1.1.m1.1b"><apply id="S6.T4.11.11.1.1.1.m1.1.1.cmml" xref="S6.T4.11.11.1.1.1.m1.1.1"><divide id="S6.T4.11.11.1.1.1.m1.1.1.1.cmml" xref="S6.T4.11.11.1.1.1.m1.1.1.1"></divide><ci id="S6.T4.11.11.1.1.1.m1.1.1.2.cmml" xref="S6.T4.11.11.1.1.1.m1.1.1.2">𝑤</ci><ci id="S6.T4.11.11.1.1.1.m1.1.1.3.cmml" xref="S6.T4.11.11.1.1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.11.11.1.1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.T4.11.11.1.1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> A+B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.2.1">
<span class="ltx_p" id="S6.T4.11.11.2.1.1" style="width:27.0pt;">0.5335</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.3.1">
<span class="ltx_p" id="S6.T4.11.11.3.1.1" style="width:27.0pt;">0.0747</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.4.1">
<span class="ltx_p" id="S6.T4.11.11.4.1.1" style="width:27.0pt;">0.6873</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.5.1">
<span class="ltx_p" id="S6.T4.11.11.5.1.1" style="width:27.0pt;">0.7782</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T4.11.11.6">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.6.1">
<span class="ltx_p" id="S6.T4.11.11.6.1.1" style="width:32.7pt;">22.7640</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.7">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.7.1">
<span class="ltx_p" id="S6.T4.11.11.7.1.1" style="width:27.0pt;">0.4778</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.8">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.8.1">
<span class="ltx_p" id="S6.T4.11.11.8.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.11.8.1.1.1">0.0696</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.9">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.9.1">
<span class="ltx_p" id="S6.T4.11.11.9.1.1" style="width:27.0pt;">0.6301</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T4.11.11.10">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.10.1">
<span class="ltx_p" id="S6.T4.11.11.10.1.1" style="width:27.0pt;">0.7212</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T4.11.11.11">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.11.11.1">
<span class="ltx_p" id="S6.T4.11.11.11.1.1" style="width:32.7pt;">15.9020</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T4.11.13">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.11.13.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.1.1">
<span class="ltx_p" id="S6.T4.11.13.1.1.1" style="width:76.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.13.1.1.1.1">BiMoRec</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.2.1">
<span class="ltx_p" id="S6.T4.11.13.2.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.13.2.1.1.1">0.5422</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.3.1">
<span class="ltx_p" id="S6.T4.11.13.3.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.11.13.3.1.1.1">0.0707</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.4.1">
<span class="ltx_p" id="S6.T4.11.13.4.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.13.4.1.1.1">0.6944</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.5.1">
<span class="ltx_p" id="S6.T4.11.13.5.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.13.5.1.1.1">0.7858</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S6.T4.11.13.6">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.6.1">
<span class="ltx_p" id="S6.T4.11.13.6.1.1" style="width:32.7pt;">20.3989</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.7">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.7.1">
<span class="ltx_p" id="S6.T4.11.13.7.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.13.7.1.1.1">0.4855</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.8">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.8.1">
<span class="ltx_p" id="S6.T4.11.13.8.1.1" style="width:27.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T4.11.13.8.1.1.1">0.0696</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.9">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.9.1">
<span class="ltx_p" id="S6.T4.11.13.9.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.13.9.1.1.1">0.6369</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S6.T4.11.13.10">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.10.1">
<span class="ltx_p" id="S6.T4.11.13.10.1.1" style="width:27.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.11.13.10.1.1.1">0.7315</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S6.T4.11.13.11">
<span class="ltx_inline-block ltx_align_top" id="S6.T4.11.13.11.1">
<span class="ltx_p" id="S6.T4.11.13.11.1.1" style="width:32.7pt;">13.7313</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p2.1.1">BiMoRec <math alttext="w/o" class="ltx_Math" display="inline" id="S6.SS3.p2.1.1.m1.1"><semantics id="S6.SS3.p2.1.1.m1.1a"><mrow id="S6.SS3.p2.1.1.m1.1.1" xref="S6.SS3.p2.1.1.m1.1.1.cmml"><mi id="S6.SS3.p2.1.1.m1.1.1.2" xref="S6.SS3.p2.1.1.m1.1.1.2.cmml">w</mi><mo id="S6.SS3.p2.1.1.m1.1.1.1" xref="S6.SS3.p2.1.1.m1.1.1.1.cmml">/</mo><mi id="S6.SS3.p2.1.1.m1.1.1.3" xref="S6.SS3.p2.1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.1.m1.1b"><apply id="S6.SS3.p2.1.1.m1.1.1.cmml" xref="S6.SS3.p2.1.1.m1.1.1"><divide id="S6.SS3.p2.1.1.m1.1.1.1.cmml" xref="S6.SS3.p2.1.1.m1.1.1.1"></divide><ci id="S6.SS3.p2.1.1.m1.1.1.2.cmml" xref="S6.SS3.p2.1.1.m1.1.1.2">𝑤</ci><ci id="S6.SS3.p2.1.1.m1.1.1.3.cmml" xref="S6.SS3.p2.1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> A</span>: In this variant, we delete the pre-training module, which means not using the model’s 3D modality data. Like previous work, we use the molecular SMILES strings as the input to the graph neural network to construct the molecular structure and its substructure embeddings.</p>
</div>
<div class="ltx_para" id="S6.SS3.p3">
<p class="ltx_p" id="S6.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p3.1.1">BiMoRec <math alttext="w/o" class="ltx_Math" display="inline" id="S6.SS3.p3.1.1.m1.1"><semantics id="S6.SS3.p3.1.1.m1.1a"><mrow id="S6.SS3.p3.1.1.m1.1.1" xref="S6.SS3.p3.1.1.m1.1.1.cmml"><mi id="S6.SS3.p3.1.1.m1.1.1.2" xref="S6.SS3.p3.1.1.m1.1.1.2.cmml">w</mi><mo id="S6.SS3.p3.1.1.m1.1.1.1" xref="S6.SS3.p3.1.1.m1.1.1.1.cmml">/</mo><mi id="S6.SS3.p3.1.1.m1.1.1.3" xref="S6.SS3.p3.1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p3.1.1.m1.1b"><apply id="S6.SS3.p3.1.1.m1.1.1.cmml" xref="S6.SS3.p3.1.1.m1.1.1"><divide id="S6.SS3.p3.1.1.m1.1.1.1.cmml" xref="S6.SS3.p3.1.1.m1.1.1.1"></divide><ci id="S6.SS3.p3.1.1.m1.1.1.2.cmml" xref="S6.SS3.p3.1.1.m1.1.1.2">𝑤</ci><ci id="S6.SS3.p3.1.1.m1.1.1.3.cmml" xref="S6.SS3.p3.1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p3.1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p3.1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> B</span>: We eliminate the molecular multi-enhancement module in this variant, removing the interaction between substructures and a single patient visit. Instead, we rely solely on the patient’s latest physical condition to interact with the single visit representation, and finally obtain the weights of the medication substructures.</p>
</div>
<div class="ltx_para" id="S6.SS3.p4">
<p class="ltx_p" id="S6.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p4.1.1">BiMoRec <math alttext="w/o" class="ltx_Math" display="inline" id="S6.SS3.p4.1.1.m1.1"><semantics id="S6.SS3.p4.1.1.m1.1a"><mrow id="S6.SS3.p4.1.1.m1.1.1" xref="S6.SS3.p4.1.1.m1.1.1.cmml"><mi id="S6.SS3.p4.1.1.m1.1.1.2" xref="S6.SS3.p4.1.1.m1.1.1.2.cmml">w</mi><mo id="S6.SS3.p4.1.1.m1.1.1.1" xref="S6.SS3.p4.1.1.m1.1.1.1.cmml">/</mo><mi id="S6.SS3.p4.1.1.m1.1.1.3" xref="S6.SS3.p4.1.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p4.1.1.m1.1b"><apply id="S6.SS3.p4.1.1.m1.1.1.cmml" xref="S6.SS3.p4.1.1.m1.1.1"><divide id="S6.SS3.p4.1.1.m1.1.1.1.cmml" xref="S6.SS3.p4.1.1.m1.1.1.1"></divide><ci id="S6.SS3.p4.1.1.m1.1.1.2.cmml" xref="S6.SS3.p4.1.1.m1.1.1.2">𝑤</ci><ci id="S6.SS3.p4.1.1.m1.1.1.3.cmml" xref="S6.SS3.p4.1.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p4.1.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p4.1.1.m1.1d">italic_w / italic_o</annotation></semantics></math> A+B</span>: We simultaneously remove both the pre-training module and the molecular multi-enhancement module. This variant neither integrates the dual modalities of molecular representation nor interacts with the patient’s single representation, relying entirely on the relationships between medications, diseases, and surgeries in patient visits to make recommendations.</p>
</div>
<div class="ltx_para" id="S6.SS3.p5">
<p class="ltx_p" id="S6.SS3.p5.3">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.T4" title="Table 4 ‣ 6.3 Ablation Study ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">4</span></a>, the ablation experiment results confirm our expectations.
BiMoRec <math alttext="w/o" class="ltx_Math" display="inline" id="S6.SS3.p5.1.m1.1"><semantics id="S6.SS3.p5.1.m1.1a"><mrow id="S6.SS3.p5.1.m1.1.1" xref="S6.SS3.p5.1.m1.1.1.cmml"><mi id="S6.SS3.p5.1.m1.1.1.2" xref="S6.SS3.p5.1.m1.1.1.2.cmml">w</mi><mo id="S6.SS3.p5.1.m1.1.1.1" xref="S6.SS3.p5.1.m1.1.1.1.cmml">/</mo><mi id="S6.SS3.p5.1.m1.1.1.3" xref="S6.SS3.p5.1.m1.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p5.1.m1.1b"><apply id="S6.SS3.p5.1.m1.1.1.cmml" xref="S6.SS3.p5.1.m1.1.1"><divide id="S6.SS3.p5.1.m1.1.1.1.cmml" xref="S6.SS3.p5.1.m1.1.1.1"></divide><ci id="S6.SS3.p5.1.m1.1.1.2.cmml" xref="S6.SS3.p5.1.m1.1.1.2">𝑤</ci><ci id="S6.SS3.p5.1.m1.1.1.3.cmml" xref="S6.SS3.p5.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p5.1.m1.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p5.1.m1.1d">italic_w / italic_o</annotation></semantics></math> A demonstrates that by introducing the 3D molecular modality, we improve the model’s recommendation accuracy, supplementing the molecular spatial information and resolving the structural confusion issue. We will provide more detailed evidence in subsequent case analyses.
BiMoRec <math alttext="w/o" class="ltx_Math" display="inline" id="S6.SS3.p5.2.m2.1"><semantics id="S6.SS3.p5.2.m2.1a"><mrow id="S6.SS3.p5.2.m2.1.1" xref="S6.SS3.p5.2.m2.1.1.cmml"><mi id="S6.SS3.p5.2.m2.1.1.2" xref="S6.SS3.p5.2.m2.1.1.2.cmml">w</mi><mo id="S6.SS3.p5.2.m2.1.1.1" xref="S6.SS3.p5.2.m2.1.1.1.cmml">/</mo><mi id="S6.SS3.p5.2.m2.1.1.3" xref="S6.SS3.p5.2.m2.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p5.2.m2.1b"><apply id="S6.SS3.p5.2.m2.1.1.cmml" xref="S6.SS3.p5.2.m2.1.1"><divide id="S6.SS3.p5.2.m2.1.1.1.cmml" xref="S6.SS3.p5.2.m2.1.1.1"></divide><ci id="S6.SS3.p5.2.m2.1.1.2.cmml" xref="S6.SS3.p5.2.m2.1.1.2">𝑤</ci><ci id="S6.SS3.p5.2.m2.1.1.3.cmml" xref="S6.SS3.p5.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p5.2.m2.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p5.2.m2.1d">italic_w / italic_o</annotation></semantics></math> B indicates that our Substructure-Patient Interaction Distillation module effectively captures useful medication substructures in each visit, learning the relationships between patient representations and substructures at the visit granularity level.
BiMoRec <math alttext="w/o" class="ltx_Math" display="inline" id="S6.SS3.p5.3.m3.1"><semantics id="S6.SS3.p5.3.m3.1a"><mrow id="S6.SS3.p5.3.m3.1.1" xref="S6.SS3.p5.3.m3.1.1.cmml"><mi id="S6.SS3.p5.3.m3.1.1.2" xref="S6.SS3.p5.3.m3.1.1.2.cmml">w</mi><mo id="S6.SS3.p5.3.m3.1.1.1" xref="S6.SS3.p5.3.m3.1.1.1.cmml">/</mo><mi id="S6.SS3.p5.3.m3.1.1.3" xref="S6.SS3.p5.3.m3.1.1.3.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p5.3.m3.1b"><apply id="S6.SS3.p5.3.m3.1.1.cmml" xref="S6.SS3.p5.3.m3.1.1"><divide id="S6.SS3.p5.3.m3.1.1.1.cmml" xref="S6.SS3.p5.3.m3.1.1.1"></divide><ci id="S6.SS3.p5.3.m3.1.1.2.cmml" xref="S6.SS3.p5.3.m3.1.1.2">𝑤</ci><ci id="S6.SS3.p5.3.m3.1.1.3.cmml" xref="S6.SS3.p5.3.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p5.3.m3.1c">w/o</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p5.3.m3.1d">italic_w / italic_o</annotation></semantics></math> A+B shows a slight improvement in safety but a significant reduction in accuracy. This phenomenon is common in the medication recommendation field, as safety and accuracy often need to balance and constrain each other. The optimal model performance usually results from balancing both. Additionally, the experiment indicates that the dual molecular modalities and the interaction between visit-level molecular and patient representations have a synergistic effect, improving model performance more effectively when used together.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Parameter Sensitivity</h3>
<figure class="ltx_figure" id="S6.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F4.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf1.g1" src="extracted/5697228/params-png/param-dim-jaccard_6.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf1.g2" src="extracted/5697228/params-png/param-dim-ddi_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf1.g3" src="extracted/5697228/params-png/param-dim-f1_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf1.g4" src="extracted/5697228/params-png/param-dim-prauc_4.png" width="144"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S6.F4.sf1.3.2" style="font-size:90%;">The impact of embedded dimensions on results.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F4.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf2.g1" src="extracted/5697228/params-png/param-layers-jaccard_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf2.g2" src="extracted/5697228/params-png/param-layers-ddi_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf2.g3" src="extracted/5697228/params-png/param-layers-f1_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf2.g4" src="extracted/5697228/params-png/param-layers-prauc_4.png" width="144"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S6.F4.sf2.3.2" style="font-size:90%;">The impact of GNN layers’ number on results.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F4.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf3.g1" src="extracted/5697228/params-png/param-epoch_pretrain-jaccard_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf3.g2" src="extracted/5697228/params-png/param-epoch_pretrain-ddi_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf3.g3" src="extracted/5697228/params-png/param-epoch_pretrain-f1_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf3.g4" src="extracted/5697228/params-png/param-epoch_pretrain-prauc_4.png" width="144"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S6.F4.sf3.3.2" style="font-size:90%;">The impact of pre-training epochs on results.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F4.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf4.g1" src="extracted/5697228/params-png/param-lr_pretrain-jaccard_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf4.g2" src="extracted/5697228/params-png/param-lr_pretrain-ddi_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf4.g3" src="extracted/5697228/params-png/param-lr_pretrain-f1_4.png" width="144"/></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="114" id="S6.F4.sf4.g4" src="extracted/5697228/params-png/param-lr_pretrain-prauc_4.png" width="144"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="S6.F4.sf4.3.2" style="font-size:90%;">The impact of pre-training learning rate on results.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S6.F4.3.2" style="font-size:90%;">Experiments on parameter sensitivity on MIMIC-III dataset.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">To explore the impact of specific parameters on the model, we conduct a series of parameter sensitivity experiments on the MIMIC-III dataset, focusing on four key parameters of the model. These experiments aim to study the effects of different parameter combinations on model performance and analyze the reasons for these changes in detail. The results are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.F4" title="Figure 4 ‣ 6.4 Parameter Sensitivity ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">4</span></a>, where the X-axis represents different values of a parameter, and the Y-axis indicates the performance differences caused by varying parameter values.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">First, we investigate the impact of different embedding dimensions on experimental performance. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.F4.sf1" title="In Figure 4 ‣ 6.4 Parameter Sensitivity ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">4(a)</span></a> shows the performance at embedding dimensions of 32, 64, 128, and 256. When the embedding size is 128, the model’s accuracy significantly exceeds that of other parameter settings, while safety remains at the same level. Therefore, considering accuracy, safety, and time cost, we select 128 as the optimal embedding dimension for this experiment.</p>
</div>
<div class="ltx_para" id="S6.SS4.p3">
<p class="ltx_p" id="S6.SS4.p3.1">Next, since both molecular modalities use GNN networks as the basic encoder, we consider the number of GNN layers. The specific impact is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.F4.sf2" title="In Figure 4 ‣ 6.4 Parameter Sensitivity ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">4(b)</span></a>. It is clear that a 4-layer network achieves better accuracy. Too many layers increase the model’s complexity and make it more prone to overfitting, leading to a larger gap between training and testing results. Too few layers slow down the model’s convergence speed, and the model’s performance fails to reach the desired effect. Thus, we choose 4 layers for the model.</p>
</div>
<div class="ltx_para" id="S6.SS4.p4">
<p class="ltx_p" id="S6.SS4.p4.1">Regarding the number of epochs and learning rate of the pre-training model, these are crucial for the performance of the pre-trained model. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.F4.sf3" title="In Figure 4 ‣ 6.4 Parameter Sensitivity ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">4(c)</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.F4.sf4" title="In Figure 4 ‣ 6.4 Parameter Sensitivity ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">4(d)</span></a>, too few epochs fail to adequately conduct contrastive learning for the dual molecular modalities, while too many epochs are meaningless and can even decrease performance. The pre-training learning rate also requires fine-tuning, and using an optimizer strategy to adjust the learning step size is recommended.</p>
</div>
<div class="ltx_para" id="S6.SS4.p5">
<p class="ltx_p" id="S6.SS4.p5.1">In practical model experiments, adjustments can be made based on the experimental environment and actual results. Different experimental environments may lead to slight variations.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5 </span>Case Study</h3>
<figure class="ltx_figure" id="S6.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="147" id="S6.F5.g1" src="extracted/5697228/mol_pca_3.png" width="293"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="147" id="S6.F5.g2" src="extracted/5697228/submol_pca_3.png" width="293"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="196" id="S6.F5.g3" src="extracted/5697228/mol_tsne_3.png" width="293"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="196" id="S6.F5.g4" src="extracted/5697228/submol_tsne_3.png" width="293"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S6.F5.3.2" style="font-size:90%;">Low dimensional data distribution represented by molecular and substructure embeddings</span></figcaption>
</figure>
<figure class="ltx_figure" id="S6.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="226" id="S6.F6.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S6.F6.3.2" style="font-size:90%;">Detailed case studies on molecular 3D modes and multi enhancement in MIMIC-III</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">To further elucidate the rationale behind our innovations, we conduct a case study using a sample from MIMIC-III. This specific instance demonstrates the existence of structural confusion issues and how they interfere with molecular representation and medication recommendation. It also highlights the importance of the interaction between molecular knowledge and individual patient visit representations in identifying key substructures for each visit.</p>
</div>
<div class="ltx_para" id="S6.SS5.p2">
<p class="ltx_p" id="S6.SS5.p2.1">For example, the molecular structures of Atropine and Ipratropium are very similar, yet they have significant functional differences. Atropine is primarily used to treat conditions such as blurred vision and arrhythmia caused by various factors, while Ipratropium is mainly used to treat COPD (chronic obstructive pulmonary disease) and other respiratory diseases, administered via nebulization. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.F6" title="Figure 6 ‣ 6.5 Case Study ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">6</span></a>, by incorporating the 3D modality, we successfully distinguish between medications such as R01A and A03B, N07A, and recommend the correct medication to the user. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#S6.F5" title="Figure 5 ‣ 6.5 Case Study ‣ 6 Discussions ‣ Medication Recommendation via Dual Molecular Modalities and Multi-Substructure Enhancement"><span class="ltx_text ltx_ref_tag">5</span></a>, we observe the low-dimensional representation of molecular embeddings generated by the original molecular encoder and the introduced bimodal encoder. The more uniform distribution in the PCA (Principal Component Analysis) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib16" title="">16</a>]</cite> plot indicates that significant variability is captured, making it easier to distinguish different molecules. Similarly, the cluster distribution in the t-SNE (t-distributed Stochastic Neighbor Embedding) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20358v2#bib.bib26" title="">26</a>]</cite> plot also supports this observation.</p>
</div>
<div class="ltx_para" id="S6.SS5.p3">
<p class="ltx_p" id="S6.SS5.p3.1">Our model introduces 3D modality data, distinguishing molecules with very similar 2D structures and enhancing the differentiation between different molecules. This increases the information dimension of molecular representations, allowing similar molecular and substructural representations to better meet recommendation needs. After obtaining substructure representations, we use each patient’s visit representation to identify medication substructures strongly associated with the current patient’s condition. By using the patient’s latest representation as a calibration reference, we identify medication substructures relevant to the latest visit, thereby improving model accuracy and safety.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">This paper introduces our developed medication recommendation model, BiMoRec. By integrating dual-modality molecular representations, the model addresses the structural confusion problem and significantly enhances the distinction between molecules, achieving notable improvements in molecular recognition. Furthermore, through single interactions between molecular knowledge and patient representations, and by enhancing substructures at both the visit level and the overall level using the patient’s latest visit representation, the model identifies truly useful substructures, thereby significantly improving accuracy and safety. We conduct a series of rigorous experiments on publicly available clinical datasets to demonstrate the validity of our approach.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">Despite the significant advancements in the field of medication recommendation made by our research, certain limitations remain, potentially offering directions for future research. Currently, medication recommendation systems in our country hold substantial theoretical and scientific research value, as well as practical significance, with the potential to address major societal issues effectively. In actual medical systems, clinicians need AI-based diagnostic support and medication review systems. Therefore, we plan to continue our in-depth research in the fields of medication recommendation and medical large models, leveraging large models to enhance our ability to tackle complex problems and real-world scenarios based on the current model.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Declaration of Competing Interest</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<span class="ltx_ERROR undefined" id="Sx1.p2.1">\printcredits</span>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<section class="ltx_subsection" id="Sx2.SSx1">
<h3 class="ltx_title ltx_title_subsection">Funding</h3>
<div class="ltx_para" id="Sx2.SSx1.p1">
<p class="ltx_p" id="Sx2.SSx1.p1.1">This work was supported by the Innovation Capability Improvement Plan Project of Hebei Province (No. 22567637H), the S&amp;T Program of Hebei(No. 236Z0302G), and HeBei Natural Science Foundation under Grant (No.G2021203010 &amp; No.F2021203038).</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">An et al. [2021]</span>
<span class="ltx_bibblock">
An, Y., Zhang, L., You, M., Tian, X., Jin, B., Wei, X., 2021.

</span>
<span class="ltx_bibblock">Mesin: Multilevel selective and interactive network for medication recommendation.

</span>
<span class="ltx_bibblock">Knowledge-Based Systems 233, 107534.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhoi et al. [2021]</span>
<span class="ltx_bibblock">
Bhoi, S., Lee, M.L., Hsu, W., Fang, H.S.A., Tan, N.C., 2021.

</span>
<span class="ltx_bibblock">Personalizing medication recommendation with a graph-based approach.

</span>
<span class="ltx_bibblock">ACM Transactions on Information Systems (TOIS) 40, 1–23.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bougiatiotis et al. [2020]</span>
<span class="ltx_bibblock">
Bougiatiotis, K., Aisopos, F., Nentidis, A., Krithara, A., Paliouras, G., 2020.

</span>
<span class="ltx_bibblock">Drug-drug interaction prediction on a biomedical literature knowledge graph, in: Artificial Intelligence in Medicine: 18th International Conference on Artificial Intelligence in Medicine, AIME 2020, Minneapolis, MN, USA, August 25–28, 2020, Proceedings 18, Springer. pp. 122–132.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2023]</span>
<span class="ltx_bibblock">
Chen, Q., Li, X., Geng, K., Wang, M., 2023.

</span>
<span class="ltx_bibblock">Context-aware safe medication recommendations with molecular graph and ddi graph embedding, in: Proceedings of the AAAI Conference on Artificial Intelligence, pp. 7053–7060.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2020]</span>
<span class="ltx_bibblock">
Chen, T., Kornblith, S., Norouzi, M., Hinton, G., 2020.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of visual representations.

</span>
<span class="ltx_bibblock">Cornell University - arXiv,Cornell University - arXiv .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chiang et al. [2020]</span>
<span class="ltx_bibblock">
Chiang, W.H., Shen, L., Li, L., Ning, X., 2020.

</span>
<span class="ltx_bibblock">Drug-drug interaction prediction based on co-medication patterns and graph matching.

</span>
<span class="ltx_bibblock">International Journal of Computational Biology and Drug Design 13, 36–57.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. [2016]</span>
<span class="ltx_bibblock">
Choi, E., Bahadori, M.T., Sun, J., Kulas, J., Schuetz, A., Stewart, W., 2016.

</span>
<span class="ltx_bibblock">Retain: An interpretable predictive model for healthcare using reverse time attention mechanism.

</span>
<span class="ltx_bibblock">Advances in Neural Information Processing Systems 29.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dauji and Bhargava [2016]</span>
<span class="ltx_bibblock">
Dauji, S., Bhargava, K., 2016.

</span>
<span class="ltx_bibblock">Estimation of concrete characteristic strength from limited data by bootstrap.

</span>
<span class="ltx_bibblock">Journal of Asian Concrete Federation 2, 81–94.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy and Djolonga [2020]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Djolonga, J., 2020.

</span>
<span class="ltx_bibblock">You only train once: Loss-conditional training of deep networks, in: International Conference on Learning Representations.

</span>
<span class="ltx_bibblock">URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=HyxY6JHKwr" title="">https://openreview.net/forum?id=HyxY6JHKwr</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffman et al. [2014]</span>
<span class="ltx_bibblock">
Hoffman, K.B., Dimbil, M., Erdman, C.B., Tatonetti, N.P., Overstreet, B.M., 2014.

</span>
<span class="ltx_bibblock">The weber effect and the united states food and drug administration’s adverse event reporting system (faers): analysis of sixty-two drugs approved from 2006 to 2010.

</span>
<span class="ltx_bibblock">Drug safety 37, 283–294.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. [2021]</span>
<span class="ltx_bibblock">
Jiang, S., Feng, F., Chen, W., Li, X., He, X., 2021.

</span>
<span class="ltx_bibblock">Structure-enhanced meta-learning for few-shot graph classification.

</span>
<span class="ltx_bibblock">AI Open , 160–167URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1016/j.aiopen.2021.08.001" title="">http://dx.doi.org/10.1016/j.aiopen.2021.08.001</a>, doi:<a class="ltx_ref" href="https:/doi.org/10.1016/j.aiopen.2021.08.001" title="">10.1016/j.aiopen.2021.08.001</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. [2018]</span>
<span class="ltx_bibblock">
Jin, B., Yang, H., Sun, L., Liu, C., Qu, Y., Tong, J., 2018.

</span>
<span class="ltx_bibblock">A treatment engine by predicting next-period prescriptions, in: Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, pp. 1608–1616.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jing et al. [2020]</span>
<span class="ltx_bibblock">
Jing, B., Eismann, S., Suriana, P., Townshend, R., Dror, R., 2020.

</span>
<span class="ltx_bibblock">Learning from protein structure with geometric vector perceptrons.

</span>
<span class="ltx_bibblock">Learning,Learning .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. [2023]</span>
<span class="ltx_bibblock">
Johnson, A.E., Bulgarelli, L., Shen, L., Gayles, A., Shammout, A., Horng, S., Pollard, T.J., Hao, S., Moody, B., Gow, B., et al., 2023.

</span>
<span class="ltx_bibblock">Mimic-iv, a freely accessible electronic health record dataset.

</span>
<span class="ltx_bibblock">Scientific data 10, 1.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. [2016]</span>
<span class="ltx_bibblock">
Johnson, A.E., Pollard, T.J., Shen, L., Lehman, L.w.H., Feng, M., Ghassemi, M., Moody, B., Szolovits, P., Anthony Celi, L., Mark, R.G., 2016.

</span>
<span class="ltx_bibblock">Mimic-iii, a freely accessible critical care database.

</span>
<span class="ltx_bibblock">Scientific data 3, 1–9.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jolliffe [2002]</span>
<span class="ltx_bibblock">
Jolliffe, I.T., 2002.

</span>
<span class="ltx_bibblock">Principal component analysis for special types of data.

</span>
<span class="ltx_bibblock">Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. [2021]</span>
<span class="ltx_bibblock">
Kim, S., Chen, J., Cheng, T., Gindulyte, A., He, J., He, S., Li, Q., Shoemaker, B.A., Thiessen, P.A., Yu, B., et al., 2021.

</span>
<span class="ltx_bibblock">Pubchem in 2021: new data content and improved web interfaces.

</span>
<span class="ltx_bibblock">Nucleic acids research 49, D1388–D1395.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Landrum [2013]</span>
<span class="ltx_bibblock">
Landrum, G., 2013.

</span>
<span class="ltx_bibblock">Rdkit documentation.

</span>
<span class="ltx_bibblock">Release 1, 4.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le et al. [2018a]</span>
<span class="ltx_bibblock">
Le, H., Tran, T., Venkatesh, S., 2018a.

</span>
<span class="ltx_bibblock">Dual memory neural computer for asynchronous two-view sequential learning, in: Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, pp. 1637–1645.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le et al. [2018b]</span>
<span class="ltx_bibblock">
Le, H., Tran, T., Venkatesh, S., 2018b.

</span>
<span class="ltx_bibblock">Dual memory neural computer for asynchronous two-view sequential learning, in: Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, pp. 1637–1645.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2019]</span>
<span class="ltx_bibblock">
Lee, J., Lee, Y., Kim, J., Kosiorek, A., Choi, S., Teh, Y., 2019.

</span>
<span class="ltx_bibblock">Set transformer: A framework for attention-based permutation-invariant neural networks.

</span>
<span class="ltx_bibblock">International Conference on Machine Learning,International Conference on Machine Learning .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023]</span>
<span class="ltx_bibblock">
Li, X., Liang, S., Hou, Y., Ma, T., 2023.

</span>
<span class="ltx_bibblock">Stratmed: Relevance stratification between biomedical entities for sparsity on medication recommendation.

</span>
<span class="ltx_bibblock">Knowledge-Based Systems , 111239.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2020]</span>
<span class="ltx_bibblock">
Lin, X., Quan, Z., Wang, Z.J., Ma, T., Zeng, X., 2020.

</span>
<span class="ltx_bibblock">Kgnn: Knowledge graph neural network for drug-drug interaction prediction., in: IJCAI, pp. 2739–2745.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021]</span>
<span class="ltx_bibblock">
Liu, S., Wang, H., Liu, W., Lasenby, J., Guo, H., Tang, J., 2021.

</span>
<span class="ltx_bibblock">Pre-training molecular graph representation with 3d geometry.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2110.07728 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2023]</span>
<span class="ltx_bibblock">
Luo, Y., Liu, Y., Peng, J., 2023.

</span>
<span class="ltx_bibblock">Calibrated geometric deep learning improves kinase–drug binding predictions.

</span>
<span class="ltx_bibblock">Nature Machine Intelligence 5, 1390–1401.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van der Maaten and Hinton [2008]</span>
<span class="ltx_bibblock">
Van der Maaten, L., Hinton, G., 2008.

</span>
<span class="ltx_bibblock">Visualizing data using t-sne.

</span>
<span class="ltx_bibblock">Journal of machine learning research 9.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miao et al. [2022]</span>
<span class="ltx_bibblock">
Miao, S., Liu, M., Li, P., 2022.

</span>
<span class="ltx_bibblock">Interpretable and generalizable graph learning via stochastic attention mechanism, in: International Conference on Machine Learning, PMLR. pp. 15524–15543.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Picheny et al. [2010]</span>
<span class="ltx_bibblock">
Picheny, V., Kim, N.H., Haftka, R.T., 2010.

</span>
<span class="ltx_bibblock">Application of bootstrap method in conservative estimation of reliability with limited samples.

</span>
<span class="ltx_bibblock">Structural and Multidisciplinary Optimization 41, 205–217.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Read et al. [2011]</span>
<span class="ltx_bibblock">
Read, J., Pfahringer, B., Holmes, G., Frank, E., 2011.

</span>
<span class="ltx_bibblock">Classifier chains for multi-label classification.

</span>
<span class="ltx_bibblock">Machine learning 85, 333–359.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schütt et al. [2017]</span>
<span class="ltx_bibblock">
Schütt, K., Kindermans, P.J., Sauceda, H., Chmiela, S., Tkatchenko, A., Müller, K.R., 2017.

</span>
<span class="ltx_bibblock">Schnet: A continuous-filter convolutional neural network for modeling quantum interactions.

</span>
<span class="ltx_bibblock">Neural Information Processing Systems,Neural Information Processing Systems .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang et al. [2019]</span>
<span class="ltx_bibblock">
Shang, J., Xiao, C., Ma, T., Li, H., Sun, J., 2019.

</span>
<span class="ltx_bibblock">Gamenet: Graph augmented memory networks for recommending medication combination, in: Proceedings of the AAAI Conference on Artificial Intelligence, pp. 1126–1133.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stark et al. [2021]</span>
<span class="ltx_bibblock">
Stark, H., Beaini, D., Corso, G., Tossou, P., Dallago, C., Günnemann, S., Liò, P., 2021.

</span>
<span class="ltx_bibblock">3d infomax improves gnns for molecular property prediction.

</span>
<span class="ltx_bibblock">arXiv: Learning,arXiv: Learning .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thomas et al. [2018]</span>
<span class="ltx_bibblock">
Thomas, N., Smidt, T., Kearnes, S., Yang, L., Li, L., Kohlhoff, K., Riley, P., 2018.

</span>
<span class="ltx_bibblock">Tensor field networks: Rotation- and translation-equivariant neural networks for 3d point clouds.

</span>
<span class="ltx_bibblock">arXiv: Learning,arXiv: Learning .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A., Kaiser, L., Polosukhin, I., 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">Neural Information Processing Systems,Neural Information Processing Systems .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2022a]</span>
<span class="ltx_bibblock">
Wang, L., Liu, Y., Lin, Y., Liu, H., Ji, S., 2022a.

</span>
<span class="ltx_bibblock">Comenet: Towards complete and efficient message passing for 3d molecular graphs.

</span>
<span class="ltx_bibblock">Advances in Neural Information Processing Systems 35, 650–664.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2017]</span>
<span class="ltx_bibblock">
Wang, M., Liu, M., Liu, J., Wang, S., Long, G., Qian, B., 2017.

</span>
<span class="ltx_bibblock">Safe medicine recommendation via medical knowledge graph embedding. arxiv.

</span>
<span class="ltx_bibblock">Information Retrieval .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2021]</span>
<span class="ltx_bibblock">
Wang, Y., Zhang, J., Guo, S., Yin, H., Li, C., Chen, H., 2021.

</span>
<span class="ltx_bibblock">Decoupling representation learning and classification for gnn-based anomaly detection, in: Proceedings of the 44th international ACM SIGIR conference on research and development in information retrieval, pp. 1239–1248.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2022b]</span>
<span class="ltx_bibblock">
Wang, Z., Liang, Y., Liu, Z., 2022b.

</span>
<span class="ltx_bibblock">Ffbdnet: Feature fusion and bipartite decision networks for recommending medication combination, in: Joint European Conference on Machine Learning and Knowledge Discovery in Databases, Springer. pp. 419–436.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2022]</span>
<span class="ltx_bibblock">
Wu, R., Qiu, Z., Jiang, J., Qi, G., Wu, X., 2022.

</span>
<span class="ltx_bibblock">Conditional generation net for medication recommendation, in: Proceedings of the ACM Web Conference 2022, pp. 935–945.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2018]</span>
<span class="ltx_bibblock">
Xu, K., Hu, W., Leskovec, J., Jegelka, S., 2018.

</span>
<span class="ltx_bibblock">How powerful are graph neural networks?

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1810.00826 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2021a]</span>
<span class="ltx_bibblock">
Yang, C., Xiao, C., Glass, L., Sun, J., 2021a.

</span>
<span class="ltx_bibblock">Change matters: Medication change prediction with recurrent residual networks, in: Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence 2021, pp. 3728–3734.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2021b]</span>
<span class="ltx_bibblock">
Yang, C., Xiao, C., Ma, F., Glass, L., Sun, J., 2021b.

</span>
<span class="ltx_bibblock">Safedrug: Dual molecular graph encoders for safe drug recommendations, in: Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence, IJCAI 2021, pp. 3735–3741.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2023]</span>
<span class="ltx_bibblock">
Yang, N., Zeng, K., Wu, Q., Yan, J., 2023.

</span>
<span class="ltx_bibblock">Molerec: Combinatorial drug recommendation with substructure-aware molecular representation learning, in: Proceedings of the ACM Web Conference 2023, pp. 4075–4085.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2017]</span>
<span class="ltx_bibblock">
Zhang, Y., Chen, R., Tang, J., Stewart, W.F., Sun, J., 2017.

</span>
<span class="ltx_bibblock">Leap: learning to prescribe effective and safe treatment combinations for multimorbidity, in: Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. 1315–1324.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2021a]</span>
<span class="ltx_bibblock">
Zheng, Z., Wang, C., Xu, T., Shen, D., Qin, P., Huai, B., Liu, T., Chen, E., 2021a.

</span>
<span class="ltx_bibblock">Drug package recommendation via interaction-aware graph induction, in: Proceedings of the Web Conference 2021, pp. 1284–1295.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2021b]</span>
<span class="ltx_bibblock">
Zheng, Z., Wang, C., Xu, T., Shen, D., Qin, P., Huai, B., Liu, T., Chen, E., 2021b.

</span>
<span class="ltx_bibblock">Drug package recommendation via interaction-aware graph induction, in: Proceedings of the Web Conference 2021, pp. 1284–1295.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2023]</span>
<span class="ltx_bibblock">
Zheng, Z., Wang, C., Xu, T., Shen, D., Qin, P., Zhao, X., Huai, B., Wu, X., Chen, E., 2023.

</span>
<span class="ltx_bibblock">Interaction-aware drug package recommendation via policy gradient.

</span>
<span class="ltx_bibblock">ACM Transactions on Information Systems 41, 1–32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. [2022]</span>
<span class="ltx_bibblock">
Zhu, J., Xia, Y., Wu, L., Xie, S., Qin, T., Zhou, W., Li, H., Liu, T.Y., 2022.

</span>
<span class="ltx_bibblock">Unified 2d and 3d pre-training of molecular representations, in: Proceedings of the 28th ACM SIGKDD conference on knowledge discovery and data mining, pp. 2626–2636.

</span>
</li>
</ul>
</section>
<div class="ltx_para" id="p12">
<span class="ltx_ERROR undefined" id="p12.1">\bio</span><span class="ltx_ERROR undefined" id="p12.2">\endbio</span>
</div>
<div class="ltx_para" id="p13">
<span class="ltx_ERROR undefined" id="p13.1">\bio</span><span class="ltx_ERROR undefined" id="p13.2">\endbio</span>
</div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Jul  9 03:11:12 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
