<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Human Hair Reconstruction with Strand-Aligned 3D Gaussians</title>
<!--Generated on Mon Sep 23 07:46:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="3D Reconstruction Digital Humans Hair Modeling" lang="en" name="keywords"/>
<base href="/html/2409.14778v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S1" title="In Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S2" title="In Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S2.SS1" title="In 2 Related Work ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>3D Gaussian Splatting for Head Avatars</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S2.SS2" title="In 2 Related Work ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Strand-based Hair Modeling</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3" title="In Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.SS1" title="In 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>3D Line Lifting with Unstructured Gaussians</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.SS2" title="In 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>3D Hair Strands Reconstruction</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.SS2.SSS0.Px1" title="In 3.2 3D Hair Strands Reconstruction ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Photometric losses.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.SS2.SSS0.Px2" title="In 3.2 3D Hair Strands Reconstruction ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Diffusion-based regularization.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.SS2.SSS0.Px3" title="In 3.2 3D Hair Strands Reconstruction ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">The final objective</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4" title="In Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS1" title="In 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS2" title="In 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Real-world Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS2.SSS0.Px1" title="In 4.2 Real-world Evaluation ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Baseline.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS2.SSS0.Px2" title="In 4.2 Real-world Evaluation ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Comparison.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS2.SSS0.Px3" title="In 4.2 Real-world Evaluation ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Applications.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS3" title="In 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS3.SSS0.Px1" title="In 4.3 Ablation Study ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Orientation maps lifting.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.SS3.SSS0.Px2" title="In 4.3 Ablation Study ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Coarse-to-fine strands fitting.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S5" title="In Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A1" title="In Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A1.SS1" title="In Appendix 0.A Implementation Details ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A.1 </span>Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A1.SS2" title="In Appendix 0.A Implementation Details ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A.2 </span>Guiding Strands Upsampling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A1.SS3" title="In Appendix 0.A Implementation Details ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A.3 </span>Diffusion-Based Prior</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A1.SS4" title="In Appendix 0.A Implementation Details ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A.4 </span>Postprocessing</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2" title="In Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.B </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.SS0.SSS0.Px1" title="In Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Real-world evaluation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.SS0.SSS0.Px2" title="In Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_title">Limitations.</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">(eccv)                Package eccv Warning: Package ‘hyperref’ is loaded with option ‘pagebackref’, which is *not* recommended for camera-ready version</p>
</div>
<span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>ETH Zürich, Switzerland </span></span></span><span class="ltx_note ltx_role_institutetext" id="id2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Max Planck Institute for Intelligent Systems, Tübingen, Germany </span></span></span><span class="ltx_note ltx_role_institutetext" id="id3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">institutetext: </span>Meta, Pittsburgh, USA </span></span></span><span class="ltx_note ltx_role_institutetext" id="id4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">institutetext: </span>Technical University of Darmstadt, Germany</span></span></span>
<h1 class="ltx_title ltx_title_document">Human Hair Reconstruction 
<br class="ltx_break"/>with Strand-Aligned 3D Gaussians</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Egor Zakharov<span class="ltx_ERROR undefined" id="id1.1.id1">\orcidlink</span>0000-0002-9880-9531
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Vanessa Sklyarova<span class="ltx_ERROR undefined" id="id2.1.id1">\orcidlink</span>0000-0002-8883-9972
</span><span class="ltx_author_notes">1122</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Michael Black<span class="ltx_ERROR undefined" id="id3.1.id1">\orcidlink</span>0000-0001-6077-4540
</span><span class="ltx_author_notes">22</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Giljoo Nam<span class="ltx_ERROR undefined" id="id4.1.id1">\orcidlink</span>0000-0002-1822-1501
</span><span class="ltx_author_notes">33</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break"/>Justus Thies<span class="ltx_ERROR undefined" id="id5.1.id1">\orcidlink</span>0000-0002-0056-9825
</span><span class="ltx_author_notes">2244</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Otmar Hilliges<span class="ltx_ERROR undefined" id="id6.1.id1">\orcidlink</span>0000-0002-5068-3474
</span><span class="ltx_author_notes">11</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id7.id1">We introduce a new hair modeling method that uses a dual representation of classical hair strands and 3D Gaussians to produce accurate and realistic strand-based reconstructions from multi-view data.
In contrast to recent approaches that leverage unstructured Gaussians to model human avatars, our method reconstructs the hair using 3D polylines, or <em class="ltx_emph ltx_font_italic" id="id7.id1.1">strands</em>.
This fundamental difference allows the use of the resulting hairstyles out-of-the-box in modern computer graphics engines for editing, rendering, and simulation.
Our 3D lifting method relies on unstructured Gaussians to generate multi-view ground truth data to supervise the fitting of hair strands.
The hairstyle itself is represented in the form of the so-called <em class="ltx_emph ltx_font_italic" id="id7.id1.2">strand-aligned</em> 3D Gaussians.
This representation allows us to combine strand-based hair priors, which are essential for realistic modeling of the inner structure of hairstyles, with the differentiable rendering capabilities of 3D Gaussian Splatting.
Our method, named <em class="ltx_emph ltx_font_italic" id="id7.id1.3">Gaussian Haircut</em>, is evaluated on synthetic and real scenes and demonstrates state-of-the-art performance in the task of strand-based hair reconstruction.
For more results, please refer to our project page: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://eth-ait.github.io/GaussianHaircut" title="">https://eth-ait.github.io/GaussianHaircut</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>3D Reconstruction Digital Humans Hair Modeling
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="251" id="S1.F1.1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.6.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.7.2" style="font-size:90%;">
<span class="ltx_text ltx_font_italic" id="S1.F1.7.2.1">Gaussian Haircut</span> works with multi-view images and uses strand-aligned 3D Gaussians to reconstruct a hairstyle.
In the first stage, <em class="ltx_emph ltx_font_italic" id="S1.F1.7.2.2">3D lifting</em>, we reconstruct the scene using unstructured primitives in the form of Gaussians.
These unstructured primitives are then used in the second stage, <em class="ltx_emph ltx_font_italic" id="S1.F1.7.2.3">strands fitting</em>, to supervise our dual hair strand representation consisting of 3D Gaussians that are attached to hair strands.
As a result, we produce a realistic strand-based hairstyle that can be rendered, edited, and animated using classical computer graphics techniques.
</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, human avatars have attained unprecedented levels of photorealism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib43" title="">43</a>]</cite>.
This advancement has been largely driven by neural modeling and rendering methods that are incompatible with existing graphics pipelines.
However, many downstream applications require the resulting avatars to be deployable in physically simulated environments.
In particular, the de facto “gold standard” representation of human hair for simulation and rendering is based on strands, i.e., 3D curves.
Yet, strand-based reconstruction of hairstyles from real-world data, such as multi-view images, remains a challenging and heavily underconstrained problem, as a substantial part of hair geometry remains occluded in the image-based captures.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To address this, we leverage latent strand and hairstyle priors introduced by Rosu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib33" title="">33</a>]</cite> and Sklyarova et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> to produce strand-based reconstructions of hairstyles that have a realistic internal geometrical structure.
Following previous approaches, we first obtain a line-based reconstruction of the visible part of the hairstyle, where the 3D line segments are used to approximate the hair strands locally.
We then use this reconstruction to fit the strands with the aid of the pre-trained priors.
The classical approach for 3D hair modeling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib27" title="">27</a>]</cite> uses oriented gradient-based filters, the so-called orientation maps, to approximate projected line directions of the hair strands from the RGB images.
However, these maps are inherently noisy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> and hard to use directly for strand fitting.
Thus, we use 3D Gaussians to perform an initial 3D lifting and de-noising of these orientation maps and use the former to supervise the reconstruction of hair strands.
To introduce extra details and fidelity into the reconstructions, we model a hairstyle using a dual representation of classical hair strands and 3D Gaussian primitives. The resulting method, called <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">Gaussian Haircut</span>, takes multi-view images as input and produces realistic 3D strands as output.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Our approach is inspired by recent work on 3D Gaussian Splatting (3DGS) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib16" title="">16</a>]</cite>, which is capable of reproducing high-fidelity details in novel-view renders of static scenes and objects.
Here, we utilize the 3D Gaussians in a novel way to enable realistic <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">and</em> animatable hairstyle reconstruction.
We emphasize that our goal differs significantly from the original task of 3DGS, which reconstructs an <span class="ltx_text ltx_font_italic" id="S1.p3.1.2">unstructured set</span> of 3D Gaussian primitives incompatible with physics-based hair simulation.
These primitives cover only the visible hair surface, while we aim to reconstruct a hairstyle that includes the inner structure required to perform the simulation.
Both 3DGS and follow-up work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib34" title="">34</a>]</cite> show that the learned Gaussian primitives are often well-aligned with thin structures in a scene, such as hair strands, without extra supervision.
We leverage this observation to compute a 3D orientation field of hair strands from the multi-view input images, which we refer to as 3D line lifting.
To achieve that, we render the directions of the highest variance of the Gaussian covariance matrices to obtain 2D orientation maps and compare them with ground-truth maps produced using Gabor filters.
Moreover, we introduce a camera refinement procedure into our Gaussian lifting approach designed to recover a more accurate 3D hair shape.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Having obtained accurate outer hair 3D orientations, we optimize a corresponding strand-based hairstyle using a strand-based hairstyle prior.
We employ a dual representation to represent a hairstyle during our coarse-to-fine optimization consisting of classical 3D hair strand polylines and 3D Gaussians.
The coarse fitting relies on using a latent space to optimize the hair strands, while during fine fitting, we directly optimize the parameters of the decoded 3D polylines.
During the coarse-to-fine optimization, we employ differentiable rasterization of the hair strands to achieve a high accuracy in the reconstructed hairstyle.
Specifically, we use 3D Gaussians attached to the line segments of the strand polylines and propagate the gradients from their rasterization directly into the latter.
We supervise the reconstructions using both photometric and geometric constraints.
To supervise the geometry, we employ the 2D projections of the 3D orientation field obtained during the line lifting stage.
To help the reconstruction process, we also develop a hair upsampling technique that facilitates the effective use of the photometric constraints during the coarse optimization stage and a method for prior-based optimization of the strands in the domain of 3D polylines.
Our method is illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We evaluate our approach on both real and synthetic scenes and achieve improvements in both reconstruction speed and quality compared to the state-of-the-art.
Our contributions can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">we propose a new <span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">3D line lifting scheme</span> that uses a modified 3DGS reconstruction technique to lift 2D orientation maps into a 3D field while also providing refinement of the camera parameters;</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">we introduce a <span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">dual representation of hair strand polylines and 3D Gaussians</span> to achieve differentiable rasterization of hair strands and leverage photometric constraints for strand-based hair reconstruction;</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">based on these components, we propose a <span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">coarse-to-fine optimization method for prior-guided hair reconstruction</span> that leverages both latent and explicit representations of the hairstyle.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>3D Gaussian Splatting for Head Avatars</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">3D meshes are the most widely used representation for head avatars <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib1" title="">1</a>]</cite>.
While a 3D mesh efficiently depicts surface-like areas such as faces, it struggles to represent complex geometries like hair accurately.
To overcome this limitation, volumetric representations like a mixture of volumetric primitives or neural radiance fields have been combined with 3D meshes to better portray hair and beards <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib55" title="">55</a>]</cite>.
However, volume rendering typically demands substantial computational resources.
Recently, there has been a shift towards using 3D Gaussian Splatting (3DGS) as a base representation for avatars <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib31" title="">31</a>]</cite>.
This approach achieves both photo-realistic appearance and real-time performance.
Despite these advancements, most studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib32" title="">32</a>]</cite> typically use 3D morphable face models such as FLAME <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib18" title="">18</a>]</cite> and do not model hair as a separate layer.
Instead, hair was treated as a mere component of the head, without any special consideration.
This restricts the potential applications of head avatars, particularly in hair motion and stylization.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Strand-based Hair Modeling</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Strands are the standard representation for high fidelity 3D hair modeling in academia <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib36" title="">36</a>]</cite> and industry <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib10" title="">10</a>]</cite>.
Strands have several advantages over volumes or meshes, being particularly effective for physics-based simulations of hair <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib13" title="">13</a>]</cite>.
Strands also enable intuitive geometric editing by directly manipulating the length and curvature of strands <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib54" title="">54</a>]</cite>.
However, due to the geometric complexity of human hair and the large number of strands required, realistic hair modeling is labor-intensive even for skilled 3D artists.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">To overcome this issue, image-based hair modeling methods have been developed to automate the 3D hair modeling process from captured photographs.
A common approach for image-based hair modeling involves the use of 2D orientation maps <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib27" title="">27</a>]</cite>.
Strand-based hair models are optimized to align with these 2D orientation maps when projected onto screen space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib26" title="">26</a>]</cite>.
A notable limitation of image-based hair modeling is the lack of information about the interior parts of the hair, which are invariably occluded in images.
To overcome this challenge, Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> employs a pretrained diffusion-based hairstyle prior to infer the interior geometry.
Despite these efforts, previous work represents hair as 3D polylines, which do not account for thickness in the geometry or appearance modeling.
These approaches typically have a separate stage to learn the appearance of 3D polylines from images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
In contrast, our proposed dual hair strand representation utilizes a sequence of anisotropic 3D Gaussians attached to a hair strand polyline, thereby offering enhanced expressiveness for both geometry and appearance modeling.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">In the concurrent work of Luo et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib22" title="">22</a>]</cite>, 3D Gaussians are also used to reconstruct human hair strands from multi-view images.
In contrast to this approach, which uses studio captures with uniform lighting, our method works with an unconstrained capture setup.
To enable this, we introduce a new camera optimization approach for 3D Gaussians.
Moreover, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib22" title="">22</a>]</cite> uses 3D constraints to optimize the hair strands, similar to Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>, while our method fully relies on our new differentiable rendering scheme.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="255" id="S3.F2.1.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.3.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.4.2" style="font-size:90%;">
(a) In our work, we utilize both structured and unstructured sets of Gaussians. The former are attached to the strands and thus cover an entire hair volume, while the latter concentrate only on the visible part of the hair surface. (b) During coarse strand-based fitting, we decode only a set of guiding strands from the latent hair map at each training step, as generating a full hairstyle is computationally- and memory-expensive. We then convert these strands into a dense hair map suitable for rendering by conducting interpolation in the space of their 3D coordinates. (c) Finally, we conduct a fine strand-based optimization step. We decode a dense hairstyle from a latent map and directly optimize their coordinates instead of latent representations.
</span></figcaption>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Our method reconstructs 3D strand-based hairstyles from multi-view images.
We pre-process the data by calculating initial estimates for the cameras, segmentation masks, and image gradients, or the so-called <em class="ltx_emph ltx_font_italic" id="S3.p1.1.1">orientation maps</em>.
The reconstruction is then performed in two stages, see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">For the first <em class="ltx_emph ltx_font_italic" id="S3.p2.1.1">3D line lifting</em> stage, we use a combination of 3D Gaussian Splatting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib16" title="">16</a>]</cite> and BARF <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib19" title="">19</a>]</cite> to optimize the parameters of the training cameras and perform 3D lifting of the scene, including orientation maps.
The latter are directly embedded into the geometry of the resulting Gaussians.
Our main idea is to use a covariance matrix to represent the 3D orientation field of hair strands.
In our approach, the direction of maximum variance of each Gaussian corresponds to the direction of the hair strand, and the variance of the orthogonal directions gives us the natural measure of its uncertainty, which we account for during the rendering process.
As a result, we obtain a scene representation that produces highly realistic renders for both color and orientation maps, as the resulting Gaussians are aligned with the hair strands.
However, these primitives are <em class="ltx_emph ltx_font_italic" id="S3.p2.1.2">unstructured</em>, as they only lie on the outer hair surface, see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">2</span></a> (a).
We thus use them to generate the multi-view renders and reconstruct the geometry of the hair strands during the second stage using <em class="ltx_emph ltx_font_italic" id="S3.p2.1.3">structured</em> primitives.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">In the <em class="ltx_emph ltx_font_italic" id="S3.p3.1.1">hair strands fitting</em> stage, we optimize the strand-based hairstyle in a coarse-to-fine manner.
For the coarse optimization step, we parameterize hair as a latent texture map <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib33" title="">33</a>]</cite>.
We use the Gaussians obtained during the first stage to create ground truth for photometric and geometric losses.
After the coarse optimization, we decode the strands into an explicit hair map and optimize it directly in a fine-grained fitting step.
During both of these steps, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> and regularize the hairstyle using a pre-trained hairstyle diffusion model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib15" title="">15</a>]</cite> to increase the realism of its internal structure.
We also utilize the 3D Gaussian Splatting framework to incorporate differentiable rendering of the hair strands.
We attach a Gaussian to each line segment on the strand to achieve that.
The scale of these primitives has only one degree of freedom, which is proportional to the length of the line segment, while the other two are fixed to a small pre-defined value.
This allows us to introduce fine-grained details into the visible part of the hair reconstruction.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>3D Line Lifting with Unstructured Gaussians</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We rely on the 3D Gaussian Splatting approach to perform an initial scene reconstruction.
We modify it to incorporate camera optimization, as off-the-shelf SfM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib35" title="">35</a>]</cite> methods do not achieve high accuracy when localizing the cameras in the scenes centered around the hair <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
Therefore, we employ a learnable 6-DoF camera parameterization from BARF <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib19" title="">19</a>]</cite> as a residual to the initial estimation produced by SfM and train it alongside the 3D Gaussians using gradient-based optimization.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.16">Following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib16" title="">16</a>]</cite>, each reconstructed primitive is parameterized by a learnable mean <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_μ</annotation></semantics></math>, scaling coefficients <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_s</annotation></semantics></math>, rotation quaternion <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_q</annotation></semantics></math>, and opacity <math alttext="o" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">o</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_o</annotation></semantics></math>. Their covariance matrix can then be expressed as <math alttext="\Sigma=RSS^{T}R^{T}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" mathvariant="normal" xref="S3.SS1.p2.5.m5.1.1.2.cmml">Σ</mi><mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">R</mi><mo id="S3.SS1.p2.5.m5.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">S</mi><mo id="S3.SS1.p2.5.m5.1.1.3.1a" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><msup id="S3.SS1.p2.5.m5.1.1.3.4" xref="S3.SS1.p2.5.m5.1.1.3.4.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.4.2" xref="S3.SS1.p2.5.m5.1.1.3.4.2.cmml">S</mi><mi id="S3.SS1.p2.5.m5.1.1.3.4.3" xref="S3.SS1.p2.5.m5.1.1.3.4.3.cmml">T</mi></msup><mo id="S3.SS1.p2.5.m5.1.1.3.1b" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><msup id="S3.SS1.p2.5.m5.1.1.3.5" xref="S3.SS1.p2.5.m5.1.1.3.5.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.5.2" xref="S3.SS1.p2.5.m5.1.1.3.5.2.cmml">R</mi><mi id="S3.SS1.p2.5.m5.1.1.3.5.3" xref="S3.SS1.p2.5.m5.1.1.3.5.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><eq id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"></eq><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">Σ</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><times id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1"></times><ci id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">𝑅</ci><ci id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3">𝑆</ci><apply id="S3.SS1.p2.5.m5.1.1.3.4.cmml" xref="S3.SS1.p2.5.m5.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.4.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.4">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.4.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.4.2">𝑆</ci><ci id="S3.SS1.p2.5.m5.1.1.3.4.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.4.3">𝑇</ci></apply><apply id="S3.SS1.p2.5.m5.1.1.3.5.cmml" xref="S3.SS1.p2.5.m5.1.1.3.5"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.5.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.5">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.5.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.5.2">𝑅</ci><ci id="S3.SS1.p2.5.m5.1.1.3.5.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.5.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\Sigma=RSS^{T}R^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">roman_Σ = italic_R italic_S italic_S start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_R start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_R</annotation></semantics></math> is a matrix form of the quaternion <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_q</annotation></semantics></math>, and <math alttext="S=\text{diag}(s)" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.2" xref="S3.SS1.p2.8.m8.1.2.cmml"><mi id="S3.SS1.p2.8.m8.1.2.2" xref="S3.SS1.p2.8.m8.1.2.2.cmml">S</mi><mo id="S3.SS1.p2.8.m8.1.2.1" xref="S3.SS1.p2.8.m8.1.2.1.cmml">=</mo><mrow id="S3.SS1.p2.8.m8.1.2.3" xref="S3.SS1.p2.8.m8.1.2.3.cmml"><mtext id="S3.SS1.p2.8.m8.1.2.3.2" xref="S3.SS1.p2.8.m8.1.2.3.2a.cmml">diag</mtext><mo id="S3.SS1.p2.8.m8.1.2.3.1" xref="S3.SS1.p2.8.m8.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.8.m8.1.2.3.3.2" xref="S3.SS1.p2.8.m8.1.2.3.cmml"><mo id="S3.SS1.p2.8.m8.1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.8.m8.1.2.3.cmml">(</mo><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">s</mi><mo id="S3.SS1.p2.8.m8.1.2.3.3.2.2" stretchy="false" xref="S3.SS1.p2.8.m8.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.2.cmml" xref="S3.SS1.p2.8.m8.1.2"><eq id="S3.SS1.p2.8.m8.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.2.1"></eq><ci id="S3.SS1.p2.8.m8.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.2.2">𝑆</ci><apply id="S3.SS1.p2.8.m8.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.2.3"><times id="S3.SS1.p2.8.m8.1.2.3.1.cmml" xref="S3.SS1.p2.8.m8.1.2.3.1"></times><ci id="S3.SS1.p2.8.m8.1.2.3.2a.cmml" xref="S3.SS1.p2.8.m8.1.2.3.2"><mtext id="S3.SS1.p2.8.m8.1.2.3.2.cmml" xref="S3.SS1.p2.8.m8.1.2.3.2">diag</mtext></ci><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">S=\text{diag}(s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">italic_S = diag ( italic_s )</annotation></semantics></math>.
Each Gaussian also has a set of learnable features, which include the spherical harmonic coefficients <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">italic_f</annotation></semantics></math> for the view-dependent color, a hair segmentation label <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><mi id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">italic_l</annotation></semantics></math>, and confidence value <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><mi id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">italic_τ</annotation></semantics></math> for the 3D orientation of the Gaussian.
The rendering proceeds by first projecting each Gaussian into the screen space, resulting in a mean <math alttext="\mu^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m12.1"><semantics id="S3.SS1.p2.12.m12.1a"><msup id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml">μ</mi><mo id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2">𝜇</ci><ci id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\mu^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m12.1d">italic_μ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and a covariance matrix <math alttext="\Sigma^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m13.1"><semantics id="S3.SS1.p2.13.m13.1a"><msup id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml"><mi id="S3.SS1.p2.13.m13.1.1.2" mathvariant="normal" xref="S3.SS1.p2.13.m13.1.1.2.cmml">Σ</mi><mo id="S3.SS1.p2.13.m13.1.1.3" xref="S3.SS1.p2.13.m13.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">superscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.2">Σ</ci><ci id="S3.SS1.p2.13.m13.1.1.3.cmml" xref="S3.SS1.p2.13.m13.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">\Sigma^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m13.1d">roman_Σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.
The Gaussians are then sorted according to their depth, and for each pixel <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.p2.14.m14.1"><semantics id="S3.SS1.p2.14.m14.1a"><mi id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.1b"><ci id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m14.1d">italic_p</annotation></semantics></math>, their features <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.15.m15.1"><semantics id="S3.SS1.p2.15.m15.1a"><msub id="S3.SS1.p2.15.m15.1.1" xref="S3.SS1.p2.15.m15.1.1.cmml"><mi id="S3.SS1.p2.15.m15.1.1.2" xref="S3.SS1.p2.15.m15.1.1.2.cmml">c</mi><mi id="S3.SS1.p2.15.m15.1.1.3" xref="S3.SS1.p2.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m15.1b"><apply id="S3.SS1.p2.15.m15.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m15.1.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p2.15.m15.1.1.2.cmml" xref="S3.SS1.p2.15.m15.1.1.2">𝑐</ci><ci id="S3.SS1.p2.15.m15.1.1.3.cmml" xref="S3.SS1.p2.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m15.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.15.m15.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are rendered using <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS1.p2.16.m16.1"><semantics id="S3.SS1.p2.16.m16.1a"><mi id="S3.SS1.p2.16.m16.1.1" xref="S3.SS1.p2.16.m16.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m16.1b"><ci id="S3.SS1.p2.16.m16.1.1.cmml" xref="S3.SS1.p2.16.m16.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m16.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.16.m16.1d">italic_α</annotation></semantics></math>-blending:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="C_{p}=\sum_{i=1}^{N}T^{i}_{p}\alpha^{i}_{p}c_{i},\quad T^{i}_{p}=\prod_{j=1}^{%
i-1}(1-\alpha^{j}_{p}),\quad T_{p}^{1}=1," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1"><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.cmml">C</mi><mi id="S3.E1.m1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1" rspace="0.111em" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.3.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml"><msubsup id="S3.E1.m1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.2.cmml">T</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.3.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.2.cmml">α</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.3.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.1.1.3.2.1a" xref="S3.E1.m1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.1.1.3.2.4" xref="S3.E1.m1.1.1.1.1.1.1.3.2.4.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.4.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.4.2.cmml">c</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.4.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.2.3" rspace="1.167em" xref="S3.E1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.cmml"><msubsup id="S3.E1.m1.1.1.1.1.2.2.1.1.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.2.cmml">T</mi><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.2" rspace="0.111em" xref="S3.E1.m1.1.1.1.1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mn id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml">α</mi><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml">j</mi></msubsup></mrow><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.2.2.2.3" rspace="1.167em" xref="S3.E1.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.cmml"><msubsup id="S3.E1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">T</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">p</mi><mn id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">1</mn></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3a.cmml" xref="S3.E1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"></eq><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2">𝐶</ci><ci id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3">𝑝</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><apply id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2"><times id="S3.E1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.2">𝑇</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.3">𝑝</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.2">𝛼</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.3">𝑝</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.4.2">𝑐</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.4.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.4.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1"><eq id="S3.E1.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.2">𝑇</ci><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3">𝑝</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1"><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.2">product</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3"><minus id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.1"></minus><cn id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.2">1</cn><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2"><eq id="S3.E1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1"></eq><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2">𝑇</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3">𝑝</ci></apply><cn id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3">1</cn></apply><cn id="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">C_{p}=\sum_{i=1}^{N}T^{i}_{p}\alpha^{i}_{p}c_{i},\quad T^{i}_{p}=\prod_{j=1}^{%
i-1}(1-\alpha^{j}_{p}),\quad T_{p}^{1}=1,</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_C start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = ∏ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT ( 1 - italic_α start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) , italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT = 1 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha^{i}_{p}=o_{i}\exp\Big{(}-\frac{1}{2}(p-\mu^{\prime}_{i})^{T}\Sigma^{%
\prime}_{i}(p-\mu^{\prime}_{i})\Big{)}." class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.cmml">α</mi><mi id="S3.E2.m1.2.2.1.1.3.3" xref="S3.E2.m1.2.2.1.1.3.3.cmml">p</mi><mi id="S3.E2.m1.2.2.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.3.2.3.cmml">i</mi></msubsup><mo id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.3.2.cmml">o</mi><mi id="S3.E2.m1.2.2.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E2.m1.2.2.1.1.1.2" lspace="0.167em" xref="S3.E2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">exp</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1a" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1a" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mfrac id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.cmml"><mn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.2.cmml">1</mn><mn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.3.cmml">2</mn></mfrac><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msup id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">μ</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3a" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.2" mathvariant="normal" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.2.cmml">Σ</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.3.cmml">i</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.3.cmml">′</mo></msubsup><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3b" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.2.cmml">p</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.cmml">−</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.2.cmml">μ</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml">i</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" lspace="0em" xref="S3.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"></eq><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2">𝛼</ci><ci id="S3.E2.m1.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3">𝑝</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2">𝑜</ci><ci id="S3.E2.m1.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><exp id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"></exp><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1"><minus id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.3"></times><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4"><divide id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4"></divide><cn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.2.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.2">1</cn><cn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.4.3">2</cn></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝜇</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.2">Σ</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.2.3">′</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.5.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1"><minus id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1"></minus><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.2">𝑝</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.2">𝜇</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.2.3">′</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\alpha^{i}_{p}=o_{i}\exp\Big{(}-\frac{1}{2}(p-\mu^{\prime}_{i})^{T}\Sigma^{%
\prime}_{i}(p-\mu^{\prime}_{i})\Big{)}.</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">italic_α start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( - divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_p - italic_μ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_Σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_p - italic_μ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.19">As a result, we obtain rendered color, which is produced via the original Gaussian splatting approach, hair segmentation label <math alttext="l_{p}" class="ltx_Math" display="inline" id="S3.SS1.p2.17.m1.1"><semantics id="S3.SS1.p2.17.m1.1a"><msub id="S3.SS1.p2.17.m1.1.1" xref="S3.SS1.p2.17.m1.1.1.cmml"><mi id="S3.SS1.p2.17.m1.1.1.2" xref="S3.SS1.p2.17.m1.1.1.2.cmml">l</mi><mi id="S3.SS1.p2.17.m1.1.1.3" xref="S3.SS1.p2.17.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m1.1b"><apply id="S3.SS1.p2.17.m1.1.1.cmml" xref="S3.SS1.p2.17.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m1.1.1.1.cmml" xref="S3.SS1.p2.17.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.17.m1.1.1.2.cmml" xref="S3.SS1.p2.17.m1.1.1.2">𝑙</ci><ci id="S3.SS1.p2.17.m1.1.1.3.cmml" xref="S3.SS1.p2.17.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m1.1c">l_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.17.m1.1d">italic_l start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, orientation confidence value <math alttext="\tau_{p}" class="ltx_Math" display="inline" id="S3.SS1.p2.18.m2.1"><semantics id="S3.SS1.p2.18.m2.1a"><msub id="S3.SS1.p2.18.m2.1.1" xref="S3.SS1.p2.18.m2.1.1.cmml"><mi id="S3.SS1.p2.18.m2.1.1.2" xref="S3.SS1.p2.18.m2.1.1.2.cmml">τ</mi><mi id="S3.SS1.p2.18.m2.1.1.3" xref="S3.SS1.p2.18.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m2.1b"><apply id="S3.SS1.p2.18.m2.1.1.cmml" xref="S3.SS1.p2.18.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m2.1.1.1.cmml" xref="S3.SS1.p2.18.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.18.m2.1.1.2.cmml" xref="S3.SS1.p2.18.m2.1.1.2">𝜏</ci><ci id="S3.SS1.p2.18.m2.1.1.3.cmml" xref="S3.SS1.p2.18.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m2.1c">\tau_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.18.m2.1d">italic_τ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, and a rendered silhouette of the Gaussians denoted as <math alttext="s_{p}" class="ltx_Math" display="inline" id="S3.SS1.p2.19.m3.1"><semantics id="S3.SS1.p2.19.m3.1a"><msub id="S3.SS1.p2.19.m3.1.1" xref="S3.SS1.p2.19.m3.1.1.cmml"><mi id="S3.SS1.p2.19.m3.1.1.2" xref="S3.SS1.p2.19.m3.1.1.2.cmml">s</mi><mi id="S3.SS1.p2.19.m3.1.1.3" xref="S3.SS1.p2.19.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m3.1b"><apply id="S3.SS1.p2.19.m3.1.1.cmml" xref="S3.SS1.p2.19.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m3.1.1.1.cmml" xref="S3.SS1.p2.19.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.19.m3.1.1.2.cmml" xref="S3.SS1.p2.19.m3.1.1.2">𝑠</ci><ci id="S3.SS1.p2.19.m3.1.1.3.cmml" xref="S3.SS1.p2.19.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m3.1c">s_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.19.m3.1d">italic_s start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l_{p}=\sum_{i=1}^{N}T_{p}^{i}\alpha_{p}^{i}l_{i},\quad\tau_{p}=\sum_{i=1}^{N}T%
_{p}^{i}\alpha_{p}^{i}\tau_{i},\quad s_{p}=\sum_{i=1}^{N}T_{p}^{i}\alpha_{p}^{%
i}." class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1"><mrow id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml">l</mi><mi id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1" rspace="0.111em" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><munderover id="S3.E3.m1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.1.1.3.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml"><msubsup id="S3.E3.m1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2.cmml">T</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.1.1.3.2.1" xref="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.2.cmml">α</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.3.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.1.1.3.2.1a" xref="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E3.m1.1.1.1.1.1.1.3.2.4" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.4.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4.2.cmml">l</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.4.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.2.3" rspace="1.167em" xref="S3.E3.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.2.2.1.1" xref="S3.E3.m1.1.1.1.1.2.2.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.2.2.1.1.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.2.2.cmml">τ</mi><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.2.3.cmml">p</mi></msub><mo id="S3.E3.m1.1.1.1.1.2.2.1.1.1" rspace="0.111em" xref="S3.E3.m1.1.1.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.1.1.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.cmml"><munderover id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.cmml"><mo id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.2" movablelimits="false" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.cmml"><msubsup id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.2.cmml">T</mi><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.3.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.1" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.2.cmml">α</mi><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.3.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.1a" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.2" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.2.cmml">τ</mi><mi id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.3" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.2.2.2.3" rspace="1.167em" xref="S3.E3.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.cmml"><msub id="S3.E3.m1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.2.cmml">s</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.E3.m1.1.1.1.1.2.2.2.2.1" rspace="0.111em" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.cmml"><munderover id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.cmml"><mo id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.2" movablelimits="false" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.3.cmml">N</mi></munderover><mrow id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.cmml"><msubsup id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.2.cmml">T</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.3.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.1" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.1.cmml">⁢</mo><msubsup id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.2.cmml">α</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.3.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.3.cmml">i</mi></msubsup></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"></eq><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">𝑙</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">𝑝</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><apply id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2"><times id="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.1"></times><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2">𝑇</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3">𝑝</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.2">𝛼</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.3">𝑝</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4.2">𝑙</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1"><eq id="S3.E3.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.1"></eq><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.2.2">𝜏</ci><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.2.3">𝑝</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3"><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2"><times id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.1"></times><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.2">𝑇</ci><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.2.3">𝑝</ci></apply><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.2">𝛼</ci><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.2.3">𝑝</ci></apply><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.3.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.2">𝜏</ci><ci id="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.1.3.2.4.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2"><eq id="S3.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.1"></eq><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.2">𝑠</ci><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.3">𝑝</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3"><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.2">𝑖</ci><cn id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.1.3">𝑁</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2"><times id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.1"></times><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.2">𝑇</ci><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.2.3">𝑝</ci></apply><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.2">𝛼</ci><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.2.3">𝑝</ci></apply><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">l_{p}=\sum_{i=1}^{N}T_{p}^{i}\alpha_{p}^{i}l_{i},\quad\tau_{p}=\sum_{i=1}^{N}T%
_{p}^{i}\alpha_{p}^{i}\tau_{i},\quad s_{p}=\sum_{i=1}^{N}T_{p}^{i}\alpha_{p}^{%
i}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_l start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_τ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2">In our approach, we use the covariance matrices to describe the local geometry of the hair strands in the 3D volume. To do that, we align the Gaussians with the hair strands via 3D lifting of the orientation maps.
We represent the primary 3D orientation as the direction of the highest variance and use the variance of the orthogonal directions as a measure of uncertainty.
Specifically, we obtain a rendered strand direction in pixel <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_p</annotation></semantics></math>, denoted as <math alttext="\beta_{p}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">β</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝛽</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\beta_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_β start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\beta_{p}=\sum_{i=1}^{N}T_{p}^{i}\alpha_{p}^{i}\beta_{i}," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml">β</mi><mi id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.E4.m1.1.1.1.1.1" rspace="0.111em" xref="S3.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><munderover id="S3.E4.m1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.3.1.cmml"><mo id="S3.E4.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E4.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.3.1.2.3" xref="S3.E4.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.2.3.2" xref="S3.E4.m1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.1.1.3.1.2.3.1" xref="S3.E4.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.3.1.2.3.3" xref="S3.E4.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.3.1.3" xref="S3.E4.m1.1.1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml"><msubsup id="S3.E4.m1.1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2.2.2.2" xref="S3.E4.m1.1.1.1.1.3.2.2.2.2.cmml">T</mi><mi id="S3.E4.m1.1.1.1.1.3.2.2.2.3" xref="S3.E4.m1.1.1.1.1.3.2.2.2.3.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.3.2.2.3" xref="S3.E4.m1.1.1.1.1.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.3.2.1" xref="S3.E4.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E4.m1.1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2.3.2.2" xref="S3.E4.m1.1.1.1.1.3.2.3.2.2.cmml">α</mi><mi id="S3.E4.m1.1.1.1.1.3.2.3.2.3" xref="S3.E4.m1.1.1.1.1.3.2.3.2.3.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.3.2.3.3" xref="S3.E4.m1.1.1.1.1.3.2.3.3.cmml">i</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.3.2.1a" xref="S3.E4.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E4.m1.1.1.1.1.3.2.4" xref="S3.E4.m1.1.1.1.1.3.2.4.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2.4.2" xref="S3.E4.m1.1.1.1.1.3.2.4.2.cmml">β</mi><mi id="S3.E4.m1.1.1.1.1.3.2.4.3" xref="S3.E4.m1.1.1.1.1.3.2.4.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"></eq><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2">𝛽</ci><ci id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3">𝑝</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><apply id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.1.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.3.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.3.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.3"><eq id="S3.E4.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.E4.m1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.3.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2"><times id="S3.E4.m1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.1"></times><apply id="S3.E4.m1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2.2.2">𝑇</ci><ci id="S3.E4.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2.2.3">𝑝</ci></apply><ci id="S3.E4.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3.2.2">𝛼</ci><ci id="S3.E4.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3.2.3">𝑝</ci></apply><ci id="S3.E4.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.2.4.cmml" xref="S3.E4.m1.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.4.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.4">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.4.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.4.2">𝛽</ci><ci id="S3.E4.m1.1.1.1.1.3.2.4.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.4.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\beta_{p}=\sum_{i=1}^{N}T_{p}^{i}\alpha_{p}^{i}\beta_{i},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_β start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_β start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.5">where <math alttext="\alpha_{p}^{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m1.1"><semantics id="S3.SS1.p3.3.m1.1a"><msubsup id="S3.SS1.p3.3.m1.1.1" xref="S3.SS1.p3.3.m1.1.1.cmml"><mi id="S3.SS1.p3.3.m1.1.1.2.2" xref="S3.SS1.p3.3.m1.1.1.2.2.cmml">α</mi><mi id="S3.SS1.p3.3.m1.1.1.2.3" xref="S3.SS1.p3.3.m1.1.1.2.3.cmml">p</mi><mi id="S3.SS1.p3.3.m1.1.1.3" xref="S3.SS1.p3.3.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m1.1b"><apply id="S3.SS1.p3.3.m1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m1.1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1">superscript</csymbol><apply id="S3.SS1.p3.3.m1.1.1.2.cmml" xref="S3.SS1.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m1.1.1.2.1.cmml" xref="S3.SS1.p3.3.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m1.1.1.2.2.cmml" xref="S3.SS1.p3.3.m1.1.1.2.2">𝛼</ci><ci id="S3.SS1.p3.3.m1.1.1.2.3.cmml" xref="S3.SS1.p3.3.m1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS1.p3.3.m1.1.1.3.cmml" xref="S3.SS1.p3.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m1.1c">\alpha_{p}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m1.1d">italic_α start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="T_{p}^{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m2.1"><semantics id="S3.SS1.p3.4.m2.1a"><msubsup id="S3.SS1.p3.4.m2.1.1" xref="S3.SS1.p3.4.m2.1.1.cmml"><mi id="S3.SS1.p3.4.m2.1.1.2.2" xref="S3.SS1.p3.4.m2.1.1.2.2.cmml">T</mi><mi id="S3.SS1.p3.4.m2.1.1.2.3" xref="S3.SS1.p3.4.m2.1.1.2.3.cmml">p</mi><mi id="S3.SS1.p3.4.m2.1.1.3" xref="S3.SS1.p3.4.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m2.1b"><apply id="S3.SS1.p3.4.m2.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m2.1.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1">superscript</csymbol><apply id="S3.SS1.p3.4.m2.1.1.2.cmml" xref="S3.SS1.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m2.1.1.2.1.cmml" xref="S3.SS1.p3.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m2.1.1.2.2.cmml" xref="S3.SS1.p3.4.m2.1.1.2.2">𝑇</ci><ci id="S3.SS1.p3.4.m2.1.1.2.3.cmml" xref="S3.SS1.p3.4.m2.1.1.2.3">𝑝</ci></apply><ci id="S3.SS1.p3.4.m2.1.1.3.cmml" xref="S3.SS1.p3.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m2.1c">T_{p}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m2.1d">italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> depend on the full covariance matrix, as per Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.E1" title="Equation 1 ‣ 3.1 3D Line Lifting with Unstructured Gaussians ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">1</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.E2" title="Equation 2 ‣ 3.1 3D Line Lifting with Unstructured Gaussians ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">2</span></a>, and <math alttext="\beta_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m3.1"><semantics id="S3.SS1.p3.5.m3.1a"><msub id="S3.SS1.p3.5.m3.1.1" xref="S3.SS1.p3.5.m3.1.1.cmml"><mi id="S3.SS1.p3.5.m3.1.1.2" xref="S3.SS1.p3.5.m3.1.1.2.cmml">β</mi><mi id="S3.SS1.p3.5.m3.1.1.3" xref="S3.SS1.p3.5.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m3.1b"><apply id="S3.SS1.p3.5.m3.1.1.cmml" xref="S3.SS1.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m3.1.1.1.cmml" xref="S3.SS1.p3.5.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.5.m3.1.1.2.cmml" xref="S3.SS1.p3.5.m3.1.1.2">𝛽</ci><ci id="S3.SS1.p3.5.m3.1.1.3.cmml" xref="S3.SS1.p3.5.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m3.1c">\beta_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m3.1d">italic_β start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes a direction of the highest variance of the Gaussian.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.6">The Gaussians are trained using a gradient-based optimization procedure from the original work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib16" title="">16</a>]</cite>. Our photometric constraints include <math alttext="\mathcal{L}_{\text{rgb}}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3a.cmml">rgb</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.p4.1.m1.1.1.3a.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><mtext id="S3.SS1.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p4.1.m1.1.1.3">rgb</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathcal{L}_{\text{rgb}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT rgb end_POSTSUBSCRIPT</annotation></semantics></math>, which consists of L1 and SSIM losses, <math alttext="\mathcal{L}_{\text{seg}}" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><msub id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3a.cmml">seg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">ℒ</ci><ci id="S3.SS1.p4.2.m2.1.1.3a.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><mtext id="S3.SS1.p4.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p4.2.m2.1.1.3">seg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\mathcal{L}_{\text{seg}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT</annotation></semantics></math> that consists of an L1 loss that matches the rendered silhouette <math alttext="s_{p}" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><msub id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml"><mi id="S3.SS1.p4.3.m3.1.1.2" xref="S3.SS1.p4.3.m3.1.1.2.cmml">s</mi><mi id="S3.SS1.p4.3.m3.1.1.3" xref="S3.SS1.p4.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p4.3.m3.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1.2">𝑠</ci><ci id="S3.SS1.p4.3.m3.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">s_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and hair segmentation <math alttext="l_{p}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.1"><semantics id="S3.SS1.p4.4.m4.1a"><msub id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><mi id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">l</mi><mi id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2">𝑙</ci><ci id="S3.SS1.p4.4.m4.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">l_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.1d">italic_l start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> to ground truth masks, and <math alttext="\mathcal{L}_{\text{dir}}" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m5.1"><semantics id="S3.SS1.p4.5.m5.1a"><msub id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.5.m5.1.1.2" xref="S3.SS1.p4.5.m5.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p4.5.m5.1.1.3" xref="S3.SS1.p4.5.m5.1.1.3a.cmml">dir</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><apply id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2">ℒ</ci><ci id="S3.SS1.p4.5.m5.1.1.3a.cmml" xref="S3.SS1.p4.5.m5.1.1.3"><mtext id="S3.SS1.p4.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p4.5.m5.1.1.3">dir</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">\mathcal{L}_{\text{dir}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT</annotation></semantics></math> that supervises hair orientations. For the latter, we build upon an original formulation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib27" title="">27</a>]</cite> and introduce a rendered confidence factor <math alttext="\tau_{p}" class="ltx_Math" display="inline" id="S3.SS1.p4.6.m6.1"><semantics id="S3.SS1.p4.6.m6.1a"><msub id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml"><mi id="S3.SS1.p4.6.m6.1.1.2" xref="S3.SS1.p4.6.m6.1.1.2.cmml">τ</mi><mi id="S3.SS1.p4.6.m6.1.1.3" xref="S3.SS1.p4.6.m6.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><apply id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.6.m6.1.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p4.6.m6.1.1.2.cmml" xref="S3.SS1.p4.6.m6.1.1.2">𝜏</ci><ci id="S3.SS1.p4.6.m6.1.1.3.cmml" xref="S3.SS1.p4.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">\tau_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.m6.1d">italic_τ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> into the objective:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{dir}}=\sum_{p}\tau_{p}\min\{\text{d}(\beta_{p},\hat{\beta}_%
{p}),\text{d}(\beta_{p},\hat{\beta}_{p})\pm\pi\}-\log\tau_{p}," class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.4" xref="S3.E5.m1.2.2.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.4.2" xref="S3.E5.m1.2.2.1.1.4.2.cmml">ℒ</mi><mtext id="S3.E5.m1.2.2.1.1.4.3" xref="S3.E5.m1.2.2.1.1.4.3a.cmml">dir</mtext></msub><mo id="S3.E5.m1.2.2.1.1.3" rspace="0.111em" xref="S3.E5.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml"><mrow id="S3.E5.m1.2.2.1.1.2.2" xref="S3.E5.m1.2.2.1.1.2.2.cmml"><munder id="S3.E5.m1.2.2.1.1.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E5.m1.2.2.1.1.2.2.3.2" movablelimits="false" xref="S3.E5.m1.2.2.1.1.2.2.3.2.cmml">∑</mo><mi id="S3.E5.m1.2.2.1.1.2.2.3.3" xref="S3.E5.m1.2.2.1.1.2.2.3.3.cmml">p</mi></munder><mrow id="S3.E5.m1.2.2.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.cmml"><msub id="S3.E5.m1.2.2.1.1.2.2.2.4" xref="S3.E5.m1.2.2.1.1.2.2.2.4.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.2.4.2" xref="S3.E5.m1.2.2.1.1.2.2.2.4.2.cmml">τ</mi><mi id="S3.E5.m1.2.2.1.1.2.2.2.4.3" xref="S3.E5.m1.2.2.1.1.2.2.2.4.3.cmml">p</mi></msub><mo id="S3.E5.m1.2.2.1.1.2.2.2.3" lspace="0.167em" xref="S3.E5.m1.2.2.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">min</mi><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2a" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml">⁡</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml"><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml">{</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4a.cmml">d</mtext><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">β</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">β</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">p</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.cmml"><mrow id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml"><mtext id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.4a.cmml">d</mtext><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml"><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.2.cmml">β</mi><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.3.cmml">p</mi></msub><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml">β</mi><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">±</mo><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.4.cmml">π</mi></mrow><mo id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml">}</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.2.3" xref="S3.E5.m1.2.2.1.1.2.3.cmml">−</mo><mrow id="S3.E5.m1.2.2.1.1.2.4" xref="S3.E5.m1.2.2.1.1.2.4.cmml"><mi id="S3.E5.m1.2.2.1.1.2.4.1" xref="S3.E5.m1.2.2.1.1.2.4.1.cmml">log</mi><mo id="S3.E5.m1.2.2.1.1.2.4a" lspace="0.167em" xref="S3.E5.m1.2.2.1.1.2.4.cmml">⁡</mo><msub id="S3.E5.m1.2.2.1.1.2.4.2" xref="S3.E5.m1.2.2.1.1.2.4.2.cmml"><mi id="S3.E5.m1.2.2.1.1.2.4.2.2" xref="S3.E5.m1.2.2.1.1.2.4.2.2.cmml">τ</mi><mi id="S3.E5.m1.2.2.1.1.2.4.2.3" xref="S3.E5.m1.2.2.1.1.2.4.2.3.cmml">p</mi></msub></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"></eq><apply id="S3.E5.m1.2.2.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.4.2">ℒ</ci><ci id="S3.E5.m1.2.2.1.1.4.3a.cmml" xref="S3.E5.m1.2.2.1.1.4.3"><mtext id="S3.E5.m1.2.2.1.1.4.3.cmml" mathsize="70%" xref="S3.E5.m1.2.2.1.1.4.3">dir</mtext></ci></apply><apply id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"><minus id="S3.E5.m1.2.2.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.3"></minus><apply id="S3.E5.m1.2.2.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2"><apply id="S3.E5.m1.2.2.1.1.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3">subscript</csymbol><sum id="S3.E5.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3.2"></sum><ci id="S3.E5.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3.3">𝑝</ci></apply><apply id="S3.E5.m1.2.2.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2"><times id="S3.E5.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.3"></times><apply id="S3.E5.m1.2.2.1.1.2.2.2.4.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.2.4.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.4">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.2.2.2.4.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.4.2">𝜏</ci><ci id="S3.E5.m1.2.2.1.1.2.2.2.4.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.4.3">𝑝</ci></apply><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2"><min id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"></min><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4a.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4"><mtext id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.4">d</mtext></ci><interval closure="open" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝛽</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2"><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝛽</ci></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑝</ci></apply></interval></apply><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.3">plus-or-minus</csymbol><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2"><times id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.3"></times><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.4a.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.4"><mtext id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.4.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.4">d</mtext></ci><interval closure="open" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2"><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.2">𝛽</ci><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.1.1.1.1.3">𝑝</ci></apply><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2"><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1">^</ci><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2">𝛽</ci></apply><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.2.3">𝑝</ci></apply></interval></apply><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.4.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.4">𝜋</ci></apply></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.2.4.cmml" xref="S3.E5.m1.2.2.1.1.2.4"><log id="S3.E5.m1.2.2.1.1.2.4.1.cmml" xref="S3.E5.m1.2.2.1.1.2.4.1"></log><apply id="S3.E5.m1.2.2.1.1.2.4.2.cmml" xref="S3.E5.m1.2.2.1.1.2.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.4.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.4.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.2.4.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.4.2.2">𝜏</ci><ci id="S3.E5.m1.2.2.1.1.2.4.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.4.2.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\mathcal{L}_{\text{dir}}=\sum_{p}\tau_{p}\min\{\text{d}(\beta_{p},\hat{\beta}_%
{p}),\text{d}(\beta_{p},\hat{\beta}_{p})\pm\pi\}-\log\tau_{p},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_τ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT roman_min { d ( italic_β start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , over^ start_ARG italic_β end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) , d ( italic_β start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , over^ start_ARG italic_β end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) ± italic_π } - roman_log italic_τ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p4.9">where <span class="ltx_text ltx_markedasmath" id="S3.SS1.p4.9.1">d</span> denotes the absolute angular difference between the directions, and <math alttext="\hat{\beta}_{p}" class="ltx_Math" display="inline" id="S3.SS1.p4.8.m2.1"><semantics id="S3.SS1.p4.8.m2.1a"><msub id="S3.SS1.p4.8.m2.1.1" xref="S3.SS1.p4.8.m2.1.1.cmml"><mover accent="true" id="S3.SS1.p4.8.m2.1.1.2" xref="S3.SS1.p4.8.m2.1.1.2.cmml"><mi id="S3.SS1.p4.8.m2.1.1.2.2" xref="S3.SS1.p4.8.m2.1.1.2.2.cmml">β</mi><mo id="S3.SS1.p4.8.m2.1.1.2.1" xref="S3.SS1.p4.8.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p4.8.m2.1.1.3" xref="S3.SS1.p4.8.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m2.1b"><apply id="S3.SS1.p4.8.m2.1.1.cmml" xref="S3.SS1.p4.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m2.1.1.1.cmml" xref="S3.SS1.p4.8.m2.1.1">subscript</csymbol><apply id="S3.SS1.p4.8.m2.1.1.2.cmml" xref="S3.SS1.p4.8.m2.1.1.2"><ci id="S3.SS1.p4.8.m2.1.1.2.1.cmml" xref="S3.SS1.p4.8.m2.1.1.2.1">^</ci><ci id="S3.SS1.p4.8.m2.1.1.2.2.cmml" xref="S3.SS1.p4.8.m2.1.1.2.2">𝛽</ci></apply><ci id="S3.SS1.p4.8.m2.1.1.3.cmml" xref="S3.SS1.p4.8.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m2.1c">\hat{\beta}_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.8.m2.1d">over^ start_ARG italic_β end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> denotes a ground-truth direction in the pixel <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.p4.9.m3.1"><semantics id="S3.SS1.p4.9.m3.1a"><mi id="S3.SS1.p4.9.m3.1.1" xref="S3.SS1.p4.9.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m3.1b"><ci id="S3.SS1.p4.9.m3.1.1.cmml" xref="S3.SS1.p4.9.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.9.m3.1d">italic_p</annotation></semantics></math>.
Our resulting training objective for the Gaussian-based hair reconstruction stage can be written as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{gaussian}}=\mathcal{L}_{\text{rgb}}+\lambda_{\text{seg}}%
\mathcal{L}_{\text{seg}}+\lambda_{\text{dir}}\mathcal{L}_{\text{dir}}." class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3a.cmml">gaussian</mtext></msub><mo id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><msub id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.3.2.3a.cmml">rgb</mtext></msub><mo id="S3.E6.m1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml"><msub id="S3.E6.m1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mtext id="S3.E6.m1.1.1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.1.1.3.3.2.3a.cmml">seg</mtext></msub><mo id="S3.E6.m1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.3.3.3.2" xref="S3.E6.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.3a.cmml">seg</mtext></msub></mrow><mo id="S3.E6.m1.1.1.1.1.3.1a" xref="S3.E6.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1.3.4" xref="S3.E6.m1.1.1.1.1.3.4.cmml"><msub id="S3.E6.m1.1.1.1.1.3.4.2" xref="S3.E6.m1.1.1.1.1.3.4.2.cmml"><mi id="S3.E6.m1.1.1.1.1.3.4.2.2" xref="S3.E6.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mtext id="S3.E6.m1.1.1.1.1.3.4.2.3" xref="S3.E6.m1.1.1.1.1.3.4.2.3a.cmml">dir</mtext></msub><mo id="S3.E6.m1.1.1.1.1.3.4.1" xref="S3.E6.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.1.1.3.4.3" xref="S3.E6.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.3.4.3.2" xref="S3.E6.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.1.1.3.4.3.3" xref="S3.E6.m1.1.1.1.1.3.4.3.3a.cmml">dir</mtext></msub></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" lspace="0em" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"></eq><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.2.3"><mtext id="S3.E6.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.2.3">gaussian</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><plus id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1"></plus><apply id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.2.3"><mtext id="S3.E6.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.2.3">rgb</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><times id="S3.E6.m1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.1"></times><apply id="S3.E6.m1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E6.m1.1.1.1.1.3.3.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2.3"><mtext id="S3.E6.m1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.3.2.3">seg</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.3.3.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3.3"><mtext id="S3.E6.m1.1.1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.3.3.3">seg</mtext></ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.1.1.3.4"><times id="S3.E6.m1.1.1.1.1.3.4.1.cmml" xref="S3.E6.m1.1.1.1.1.3.4.1"></times><apply id="S3.E6.m1.1.1.1.1.3.4.2.cmml" xref="S3.E6.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.4.2.2">𝜆</ci><ci id="S3.E6.m1.1.1.1.1.3.4.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.4.2.3"><mtext id="S3.E6.m1.1.1.1.1.3.4.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.4.2.3">dir</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.3.4.3.cmml" xref="S3.E6.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.3.4.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.4.3.3"><mtext id="S3.E6.m1.1.1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.4.3.3">dir</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathcal{L}_{\text{gaussian}}=\mathcal{L}_{\text{rgb}}+\lambda_{\text{seg}}%
\mathcal{L}_{\text{seg}}+\lambda_{\text{dir}}\mathcal{L}_{\text{dir}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">caligraphic_L start_POSTSUBSCRIPT gaussian end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT rgb end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>3D Hair Strands Reconstruction</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">After the first stage, we obtain Gaussians matching the hairstyle’s visible structure, including the geometry and strand orientations, and the optimized camera parameters.
This information is used for the 3D hair strands reconstruction.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6">The strand-based hairstyle is represented as a hair map <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_H</annotation></semantics></math> corresponding to a scalp region of the 3D head model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib18" title="">18</a>]</cite>.
This head model is fitted into the scene using a multiview optimization approach based on facial keypoints <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
Each texel of this map stores a 3D hair strand as a polyline: <math alttext="S^{k}=\{p_{l}^{k}\}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><msup id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">S</mi><mi id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml">k</mi></msup><mo id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.2.cmml"><mo id="S3.SS2.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.2.cmml">{</mo><msubsup id="S3.SS2.p2.2.m2.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.3.cmml">l</mi><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.SS2.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><eq id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"></eq><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">𝑆</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">𝑘</ci></apply><set id="S3.SS2.p2.2.m2.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1"><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">S^{k}=\{p_{l}^{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_S start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT = { italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT }</annotation></semantics></math>.
Since hair maps have an increasingly high number of degrees of freedom, we regularize the optimization process <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib33" title="">33</a>]</cite> and introduce a latent hair map <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_Z</annotation></semantics></math>, which can be converted to and from <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_H</annotation></semantics></math> using pre-trained strand decoder <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">caligraphic_G</annotation></semantics></math> and encoder <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">caligraphic_E</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H=\mathcal{G}(Z),\quad Z=\mathcal{E}(H)." class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1"><mrow id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.3.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">H</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.2.cmml">𝒢</mi><mo id="S3.E7.m1.3.3.1.1.1.1.3.1" xref="S3.E7.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.3.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml"><mo id="S3.E7.m1.3.3.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">Z</mi><mo id="S3.E7.m1.3.3.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.2.3" rspace="1.167em" xref="S3.E7.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E7.m1.3.3.1.1.2.2" xref="S3.E7.m1.3.3.1.1.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.2.cmml">Z</mi><mo id="S3.E7.m1.3.3.1.1.2.2.1" xref="S3.E7.m1.3.3.1.1.2.2.1.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.2.2.3.2" xref="S3.E7.m1.3.3.1.1.2.2.3.2.cmml">ℰ</mi><mo id="S3.E7.m1.3.3.1.1.2.2.3.1" xref="S3.E7.m1.3.3.1.1.2.2.3.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.2.2.3.3.2" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml"><mo id="S3.E7.m1.3.3.1.1.2.2.3.3.2.1" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">(</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">H</mi><mo id="S3.E7.m1.3.3.1.1.2.2.3.3.2.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3a.cmml" xref="S3.E7.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><eq id="S3.E7.m1.3.3.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1"></eq><ci id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2">𝐻</ci><apply id="S3.E7.m1.3.3.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3"><times id="S3.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.1"></times><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2">𝒢</ci><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝑍</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2"><eq id="S3.E7.m1.3.3.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.1"></eq><ci id="S3.E7.m1.3.3.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2">𝑍</ci><apply id="S3.E7.m1.3.3.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.3"><times id="S3.E7.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.3.1"></times><ci id="S3.E7.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.3.2">ℰ</ci><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">H=\mathcal{G}(Z),\quad Z=\mathcal{E}(H).</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">italic_H = caligraphic_G ( italic_Z ) , italic_Z = caligraphic_E ( italic_H ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.8">During the coarse fitting step, we optimize the hair strands as a latent map <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m1.1"><semantics id="S3.SS2.p2.7.m1.1a"><mi id="S3.SS2.p2.7.m1.1.1" xref="S3.SS2.p2.7.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m1.1b"><ci id="S3.SS2.p2.7.m1.1.1.cmml" xref="S3.SS2.p2.7.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m1.1d">italic_Z</annotation></semantics></math>, while for the fine step, we optimize an explicit hair map <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m2.1"><semantics id="S3.SS2.p2.8.m2.1a"><mi id="S3.SS2.p2.8.m2.1.1" xref="S3.SS2.p2.8.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m2.1b"><ci id="S3.SS2.p2.8.m2.1.1.cmml" xref="S3.SS2.p2.8.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m2.1d">italic_H</annotation></semantics></math>, see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">2</span></a> (c).</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.2">Since latent hair map decoding operation is computationally expensive, in the coarse optimization step, this mapping can only be performed for a set of <em class="ltx_emph ltx_font_italic" id="S3.SS2.p3.2.1">guiding</em> strands per training batch, which we will denote as <math alttext="H^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">H</mi><mo id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝐻</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">H^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">2</span></a> (b).
Note, however, that the latent map <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_Z</annotation></semantics></math> can be decoded into an arbitrarily large number of hair strands for the fine-fitting step.
The hair strands are optimized using two constraints: photometric losses, for which we differentiably rasterize the hair strands and latent diffusion-based regularization that follows <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> and ensures the realism of the internal part of the hairstyle.
Importantly, we use the ground truth generated using the Gaussian-based reconstruction from the previous stage, substantially reducing the noise in this objective, especially for the orientation maps.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Photometric losses.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.15">During differentiable rasterization, we assign Gaussians to each line segment <math alttext="\{p_{l}^{k},p_{l+1}^{k}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.2"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.2a"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.3.cmml"><mo id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.3.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.4" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml">p</mi><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.2.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.2b"><set id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.2">𝑝</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.2">𝑝</ci><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3"><plus id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.1"></plus><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.2">𝑙</ci><cn id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.2.2.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.2c">\{p_{l}^{k},p_{l+1}^{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.2d">{ italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT italic_l + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT }</annotation></semantics></math> of the strand.
The generated primitive has the first element of its scaling vector <math alttext="s_{l}^{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><msubsup id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">s</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.2">𝑠</ci><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">s_{l}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> proportional to the length of the strand, and the other two fixed to a small value, i.e. <math alttext="s_{l}^{k}=\{1/2\,\cdot\,\|p_{l+1}^{k}-p_{l}^{k}\|_{2}\,,\,\epsilon\,,\,\epsilon\}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.3"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.3a"><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.2.cmml">s</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.2.cmml">{</mo><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.cmml"><mn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1.cmml">/</mo><mn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.cmml">2</mn></mrow><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2" lspace="0.392em" rspace="0.392em" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.cmml">⋅</mo><msub id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.3.cmml">2</mn></msub></mrow><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3" rspace="0.337em" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.2.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">ϵ</mi><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.4" lspace="0.170em" rspace="0.337em" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.2.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.3.m3.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.2.cmml">ϵ</mi><mo id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.3b"><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3"><eq id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.2"></eq><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.2">𝑠</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.3.3">𝑘</ci></apply><set id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1"><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2">⋅</ci><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3"><divide id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1"></divide><cn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2">1</cn><cn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3">2</cn></apply><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1"><minus id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.1"></minus><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.2">𝑝</ci><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3"><plus id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.1"></plus><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.2">𝑙</ci><cn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn id="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.3">2</cn></apply></apply><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">italic-ϵ</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.2">italic-ϵ</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.3c">s_{l}^{k}=\{1/2\,\cdot\,\|p_{l+1}^{k}-p_{l}^{k}\|_{2}\,,\,\epsilon\,,\,\epsilon\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.3d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT = { 1 / 2 ⋅ ∥ italic_p start_POSTSUBSCRIPT italic_l + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_ϵ , italic_ϵ }</annotation></semantics></math>.
Additionally, its rotation quaternion is set to align the <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.1d">italic_x</annotation></semantics></math>-axis with the segment direction of the hair strand.
We make all these Gaussians opaque, meaning <math alttext="o_{l}^{k}=1" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.2.cmml">o</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1"><eq id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.2">𝑜</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3">𝑘</ci></apply><cn id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.1c">o_{l}^{k}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.1d">italic_o start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT = 1</annotation></semantics></math>, have unit orientation confidence <math alttext="\tau_{l}^{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p1.6.m6.1a"><msubsup id="S3.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.2.cmml">τ</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.2">𝜏</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m6.1c">\tau_{l}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.6.m6.1d">italic_τ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, and assign each one a trainable set of spherical harmonic coefficients <math alttext="f_{l}^{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p1.7.m7.1a"><msubsup id="S3.SS2.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.3" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m7.1b"><apply id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.7.m7.1c">f_{l}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.7.m7.1d">italic_f start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> responsible for rendering the color.
During the coarse fitting, these coefficients are predicted from the latent hair map using an appearance decoder <math alttext="\mathcal{G}_{\text{a}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.8.m8.1"><semantics id="S3.SS2.SSS0.Px1.p1.8.m8.1a"><msub id="S3.SS2.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.8.m8.1.1.2" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1.2.cmml">𝒢</mi><mtext id="S3.SS2.SSS0.Px1.p1.8.m8.1.1.3" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1.3a.cmml">a</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.8.m8.1b"><apply id="S3.SS2.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1.2">𝒢</ci><ci id="S3.SS2.SSS0.Px1.p1.8.m8.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p1.8.m8.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p1.8.m8.1.1.3">a</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.8.m8.1c">\mathcal{G}_{\text{a}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.8.m8.1d">caligraphic_G start_POSTSUBSCRIPT a end_POSTSUBSCRIPT</annotation></semantics></math>, which copies the architecture of a strand decoder <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.9.m9.1"><semantics id="S3.SS2.SSS0.Px1.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.9.m9.1.1" xref="S3.SS2.SSS0.Px1.p1.9.m9.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.9.m9.1b"><ci id="S3.SS2.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.9.m9.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.9.m9.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.9.m9.1d">caligraphic_G</annotation></semantics></math>.
However, while the strand decoder <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.10.m10.1"><semantics id="S3.SS2.SSS0.Px1.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.10.m10.1.1" xref="S3.SS2.SSS0.Px1.p1.10.m10.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.10.m10.1b"><ci id="S3.SS2.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.10.m10.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.10.m10.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.10.m10.1d">caligraphic_G</annotation></semantics></math> is pre-trained using a collection of synthetic hair strands and is frozen during the reconstruction process, following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib33" title="">33</a>]</cite>, the appearance decoder <math alttext="\mathcal{G}_{\text{a}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.11.m11.1"><semantics id="S3.SS2.SSS0.Px1.p1.11.m11.1a"><msub id="S3.SS2.SSS0.Px1.p1.11.m11.1.1" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.11.m11.1.1.2" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1.2.cmml">𝒢</mi><mtext id="S3.SS2.SSS0.Px1.p1.11.m11.1.1.3" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1.3a.cmml">a</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.11.m11.1b"><apply id="S3.SS2.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1.2">𝒢</ci><ci id="S3.SS2.SSS0.Px1.p1.11.m11.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p1.11.m11.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p1.11.m11.1.1.3">a</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.11.m11.1c">\mathcal{G}_{\text{a}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.11.m11.1d">caligraphic_G start_POSTSUBSCRIPT a end_POSTSUBSCRIPT</annotation></semantics></math> is optimized from scratch for each scene.
Thus, the trainable parameters during the coarse optimization step include <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.12.m12.1"><semantics id="S3.SS2.SSS0.Px1.p1.12.m12.1a"><mi id="S3.SS2.SSS0.Px1.p1.12.m12.1.1" xref="S3.SS2.SSS0.Px1.p1.12.m12.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.12.m12.1b"><ci id="S3.SS2.SSS0.Px1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.12.m12.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.12.m12.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.12.m12.1d">italic_Z</annotation></semantics></math> and <math alttext="\mathcal{G}_{\text{a}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.13.m13.1"><semantics id="S3.SS2.SSS0.Px1.p1.13.m13.1a"><msub id="S3.SS2.SSS0.Px1.p1.13.m13.1.1" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.13.m13.1.1.2" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1.2.cmml">𝒢</mi><mtext id="S3.SS2.SSS0.Px1.p1.13.m13.1.1.3" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1.3a.cmml">a</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.13.m13.1b"><apply id="S3.SS2.SSS0.Px1.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.13.m13.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.13.m13.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1.2">𝒢</ci><ci id="S3.SS2.SSS0.Px1.p1.13.m13.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p1.13.m13.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p1.13.m13.1.1.3">a</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.13.m13.1c">\mathcal{G}_{\text{a}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.13.m13.1d">caligraphic_G start_POSTSUBSCRIPT a end_POSTSUBSCRIPT</annotation></semantics></math>, while for the fine step, we directly optimize <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.14.m14.1"><semantics id="S3.SS2.SSS0.Px1.p1.14.m14.1a"><mi id="S3.SS2.SSS0.Px1.p1.14.m14.1.1" xref="S3.SS2.SSS0.Px1.p1.14.m14.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.14.m14.1b"><ci id="S3.SS2.SSS0.Px1.p1.14.m14.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.14.m14.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.14.m14.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.14.m14.1d">italic_H</annotation></semantics></math> with associated coefficients <math alttext="f_{l}^{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.15.m15.1"><semantics id="S3.SS2.SSS0.Px1.p1.15.m15.1a"><msubsup id="S3.SS2.SSS0.Px1.p1.15.m15.1.1" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.3" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.15.m15.1b"><apply id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.15.m15.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.15.m15.1c">f_{l}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.15.m15.1d">italic_f start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.9">The rendering loss follows the Gaussians training objective <math alttext="\mathcal{L}_{\text{gaussian}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.1a"><msub id="S3.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3a.cmml">gaussian</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3">gaussian</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.1c">\mathcal{L}_{\text{gaussian}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT gaussian end_POSTSUBSCRIPT</annotation></semantics></math> from the first stage (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S3.E6" title="Equation 6 ‣ 3.1 3D Line Lifting with Unstructured Gaussians ‣ 3 Method ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">6</span></a>) and includes a color loss <math alttext="\mathcal{L}_{\text{rgb}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><msub id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3a.cmml">rgb</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2">ℒ</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3">rgb</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">\mathcal{L}_{\text{rgb}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT rgb end_POSTSUBSCRIPT</annotation></semantics></math>, a segmentation loss <math alttext="\mathcal{L}_{\text{seg}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p2.3.m3.1a"><msub id="S3.SS2.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3a.cmml">seg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.2">ℒ</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.3">seg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.3.m3.1c">\mathcal{L}_{\text{seg}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT</annotation></semantics></math>, and an orientations loss <math alttext="\mathcal{L}_{\text{dir}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p2.4.m4.1a"><msub id="S3.SS2.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3a.cmml">dir</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.2">ℒ</ci><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3a.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3"><mtext id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.3">dir</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.4.m4.1c">\mathcal{L}_{\text{dir}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT</annotation></semantics></math>.
Instead of using the covariance matrices to extract the orientations <math alttext="\beta_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p2.5.m5.1a"><msub id="S3.SS2.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml">β</mi><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.2">𝛽</ci><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.5.m5.1c">\beta_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.5.m5.1d">italic_β start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we use the direction vectors <math alttext="v_{l}^{k}=p_{l+1}^{k}-p_{l}^{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p2.6.m6.1a"><mrow id="S3.SS2.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml"><msubsup id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.2.cmml">v</mi><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.cmml"><msubsup id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.2.cmml">p</mi><mrow id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.2.cmml">l</mi><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.1.cmml">−</mo><msubsup id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.2.cmml">p</mi><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.3.cmml">l</mi><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1"><eq id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.2">𝑣</ci><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3"><minus id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.1"></minus><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.2">𝑝</ci><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3"><plus id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.1"></plus><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.2">𝑙</ci><cn id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.2">𝑝</ci><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.6.m6.1c">v_{l}^{k}=p_{l+1}^{k}-p_{l}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT = italic_p start_POSTSUBSCRIPT italic_l + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>.
We can do that since, at this stage, we have access to the exact strand growth <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS0.Px1.p2.9.1">directions</em> instead of undirected lines.
However, during the coarse fitting stage, we can only decode a small set of guiding hair strands <math alttext="H^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p2.7.m7.1a"><msup id="S3.SS2.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2.cmml">H</mi><mo id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2">𝐻</ci><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.7.m7.1c">H^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.7.m7.1d">italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> per training batch from the latent map <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.8.m8.1"><semantics id="S3.SS2.SSS0.Px1.p2.8.m8.1a"><mi id="S3.SS2.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS2.SSS0.Px1.p2.8.m8.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.8.m8.1b"><ci id="S3.SS2.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.8.m8.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.8.m8.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.8.m8.1d">italic_Z</annotation></semantics></math> because of memory constraints.
Thus, the rendered geometry may have holes, making photometric training losses ineffective.
To address this problem, we interpolate the guiding strands to produce a dense hair map <math alttext="\hat{H}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.9.m9.1"><semantics id="S3.SS2.SSS0.Px1.p2.9.m9.1a"><mover accent="true" id="S3.SS2.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.cmml">H</mi><mo id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.9.m9.1b"><apply id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1"><ci id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.1">^</ci><ci id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.9.m9.1c">\hat{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.9.m9.1d">over^ start_ARG italic_H end_ARG</annotation></semantics></math>, which we then use for rasterization.
The strand interpolation procedure follows <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib39" title="">39</a>]</cite> but is carried out in the domain of 3D coordinates instead of latent hair maps.
Note that we do not need such interpolation during the fine optimization stage, as at each training step we have direct access to the dense hairstyle.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Diffusion-based regularization.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.5">We follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> and employ a diffusion-based score distillation sampling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib30" title="">30</a>]</cite> loss <math alttext="\mathcal{L}_{\text{sds}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3a.cmml">sds</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2">ℒ</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3"><mtext id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3">sds</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">\mathcal{L}_{\text{sds}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT sds end_POSTSUBSCRIPT</annotation></semantics></math> to regularize the hair geometry.
It is applied in the domain of the latent hair maps and uses a pre-trained latent diffusion for guide strand generation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
While it can be incorporated seamlessly into our coarse optimization step by simply applying it to a subsampled version <math alttext="Z^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><msup id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">Z</mi><mo id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2">𝑍</ci><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">Z^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> of the latent hair map <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.1d">italic_Z</annotation></semantics></math>, we also want to keep this regularization during the fine-grained strands optimization.
To achieve that, at each step, we encode a random subset of the hair strands into their latent representations using a pre-trained encoder <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m4.1d">caligraphic_E</annotation></semantics></math> and interpolate them into texels with the same resolution as <math alttext="Z^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.1a"><msup id="S3.SS2.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml">Z</mi><mo id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2">𝑍</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.1c">Z^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.5.m5.1d">italic_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.
We then apply a diffusion-based penalty to this low-resolution latent hair map, similar to the coarse stage.
For more details, please refer to the supplementary materials.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">The final objective</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.1">for the hair strands fitting can be written as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{strand}}=\mathcal{L}_{\text{rgb}}+\lambda_{\text{seg}}%
\mathcal{L}_{\text{seg}}+\lambda_{\text{dir}}\mathcal{L}_{\text{dir}}+\lambda_%
{\text{sds}}\mathcal{L}_{\text{sds}}." class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3a.cmml">strand</mtext></msub><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3a.cmml">rgb</mtext></msub><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><msub id="S3.E8.m1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mtext id="S3.E8.m1.1.1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.1.1.3.3.2.3a.cmml">seg</mtext></msub><mo id="S3.E8.m1.1.1.1.1.3.3.1" xref="S3.E8.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.3.3.3.2" xref="S3.E8.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S3.E8.m1.1.1.1.1.3.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.3a.cmml">seg</mtext></msub></mrow><mo id="S3.E8.m1.1.1.1.1.3.1a" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E8.m1.1.1.1.1.3.4" xref="S3.E8.m1.1.1.1.1.3.4.cmml"><msub id="S3.E8.m1.1.1.1.1.3.4.2" xref="S3.E8.m1.1.1.1.1.3.4.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.4.2.2" xref="S3.E8.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mtext id="S3.E8.m1.1.1.1.1.3.4.2.3" xref="S3.E8.m1.1.1.1.1.3.4.2.3a.cmml">dir</mtext></msub><mo id="S3.E8.m1.1.1.1.1.3.4.1" xref="S3.E8.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E8.m1.1.1.1.1.3.4.3" xref="S3.E8.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.3.4.3.2" xref="S3.E8.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mtext id="S3.E8.m1.1.1.1.1.3.4.3.3" xref="S3.E8.m1.1.1.1.1.3.4.3.3a.cmml">dir</mtext></msub></mrow><mo id="S3.E8.m1.1.1.1.1.3.1b" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E8.m1.1.1.1.1.3.5" xref="S3.E8.m1.1.1.1.1.3.5.cmml"><msub id="S3.E8.m1.1.1.1.1.3.5.2" xref="S3.E8.m1.1.1.1.1.3.5.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.5.2.2" xref="S3.E8.m1.1.1.1.1.3.5.2.2.cmml">λ</mi><mtext id="S3.E8.m1.1.1.1.1.3.5.2.3" xref="S3.E8.m1.1.1.1.1.3.5.2.3a.cmml">sds</mtext></msub><mo id="S3.E8.m1.1.1.1.1.3.5.1" xref="S3.E8.m1.1.1.1.1.3.5.1.cmml">⁢</mo><msub id="S3.E8.m1.1.1.1.1.3.5.3" xref="S3.E8.m1.1.1.1.1.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.3.5.3.2" xref="S3.E8.m1.1.1.1.1.3.5.3.2.cmml">ℒ</mi><mtext id="S3.E8.m1.1.1.1.1.3.5.3.3" xref="S3.E8.m1.1.1.1.1.3.5.3.3a.cmml">sds</mtext></msub></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" lspace="0em" xref="S3.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.3"><mtext id="S3.E8.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.2.3">strand</mtext></ci></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><plus id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3"><mtext id="S3.E8.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.3.2.3">rgb</mtext></ci></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><times id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.1"></times><apply id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E8.m1.1.1.1.1.3.3.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3"><mtext id="S3.E8.m1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.3.3.2.3">seg</mtext></ci></apply><apply id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.3"><mtext id="S3.E8.m1.1.1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.3.3.3.3">seg</mtext></ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.4"><times id="S3.E8.m1.1.1.1.1.3.4.1.cmml" xref="S3.E8.m1.1.1.1.1.3.4.1"></times><apply id="S3.E8.m1.1.1.1.1.3.4.2.cmml" xref="S3.E8.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.4.2.2">𝜆</ci><ci id="S3.E8.m1.1.1.1.1.3.4.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.4.2.3"><mtext id="S3.E8.m1.1.1.1.1.3.4.2.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.3.4.2.3">dir</mtext></ci></apply><apply id="S3.E8.m1.1.1.1.1.3.4.3.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.3.4.3.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.4.3.3"><mtext id="S3.E8.m1.1.1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.3.4.3.3">dir</mtext></ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.5.cmml" xref="S3.E8.m1.1.1.1.1.3.5"><times id="S3.E8.m1.1.1.1.1.3.5.1.cmml" xref="S3.E8.m1.1.1.1.1.3.5.1"></times><apply id="S3.E8.m1.1.1.1.1.3.5.2.cmml" xref="S3.E8.m1.1.1.1.1.3.5.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.5.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.5.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.5.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.5.2.2">𝜆</ci><ci id="S3.E8.m1.1.1.1.1.3.5.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.5.2.3"><mtext id="S3.E8.m1.1.1.1.1.3.5.2.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.3.5.2.3">sds</mtext></ci></apply><apply id="S3.E8.m1.1.1.1.1.3.5.3.cmml" xref="S3.E8.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.5.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.5.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.5.3.2">ℒ</ci><ci id="S3.E8.m1.1.1.1.1.3.5.3.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.5.3.3"><mtext id="S3.E8.m1.1.1.1.1.3.5.3.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.3.5.3.3">sds</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mathcal{L}_{\text{strand}}=\mathcal{L}_{\text{rgb}}+\lambda_{\text{seg}}%
\mathcal{L}_{\text{seg}}+\lambda_{\text{dir}}\mathcal{L}_{\text{dir}}+\lambda_%
{\text{sds}}\mathcal{L}_{\text{sds}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">caligraphic_L start_POSTSUBSCRIPT strand end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT rgb end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT sds end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT sds end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.2">As a result, we obtain a strand-based hair map that can be rendered statically using optimized spherical harmonics coefficients or dynamically via classical computer graphics engines <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib6" title="">6</a>]</cite>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Implementation Details</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We preprocess real-world data using COLMAP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib35" title="">35</a>]</cite> to produce the initial point cloud and camera estimates.
We use the default optimization hyperparameters from the base 3DGS approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib16" title="">16</a>]</cite> to train the Gaussians, which results in 30,000 optimization steps during the 3D lifting stage.
The camera parameters are optimized for the first 15,000 steps and are frozen afterward.
Their learning rate schedule follows the learning rates of Gaussian rotations and means.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.4">During the strand fitting stage, we use pre-trained strand and hairstyle priors from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
We use 1,000 guiding strands in the hair map <math alttext="H^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><msup id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">H</mi><mo id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝐻</ci><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">H^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> during coarse optimization, which are interpolated to 10,000 at each training step before rasterization.
For the fine fitting of the hairstyle, we decode a hair map <math alttext="H" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_H</annotation></semantics></math> containing 30,000 strands.
To generate a guiding latent hair map <math alttext="Z^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><msup id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">Z</mi><mo id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝑍</ci><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">Z^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> that is used for regularization, we randomly select 1,000 strands at each training step.
We encode them into the latent vectors and interpolate them into a latent map before calculating a score distillation sampling loss.
We use 20,000 and 10,000 optimization steps for the coarse and fine fitting, respectively.
The weights of the losses during both stages are set to <math alttext="\lambda_{\text{seg}}=\lambda_{\text{dir}}=10^{-1},\lambda_{\text{sds}}=10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.2"><semantics id="S4.SS1.p2.4.m4.2a"><mrow id="S4.SS1.p2.4.m4.2.2.2" xref="S4.SS1.p2.4.m4.2.2.3.cmml"><mrow id="S4.SS1.p2.4.m4.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml"><msub id="S4.SS1.p2.4.m4.1.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.2.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2.cmml">λ</mi><mtext id="S4.SS1.p2.4.m4.1.1.1.1.2.3" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3a.cmml">seg</mtext></msub><mo id="S4.SS1.p2.4.m4.1.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.cmml">=</mo><msub id="S4.SS1.p2.4.m4.1.1.1.1.4" xref="S4.SS1.p2.4.m4.1.1.1.1.4.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.4.2" xref="S4.SS1.p2.4.m4.1.1.1.1.4.2.cmml">λ</mi><mtext id="S4.SS1.p2.4.m4.1.1.1.1.4.3" xref="S4.SS1.p2.4.m4.1.1.1.1.4.3a.cmml">dir</mtext></msub><mo id="S4.SS1.p2.4.m4.1.1.1.1.5" xref="S4.SS1.p2.4.m4.1.1.1.1.5.cmml">=</mo><msup id="S4.SS1.p2.4.m4.1.1.1.1.6" xref="S4.SS1.p2.4.m4.1.1.1.1.6.cmml"><mn id="S4.SS1.p2.4.m4.1.1.1.1.6.2" xref="S4.SS1.p2.4.m4.1.1.1.1.6.2.cmml">10</mn><mrow id="S4.SS1.p2.4.m4.1.1.1.1.6.3" xref="S4.SS1.p2.4.m4.1.1.1.1.6.3.cmml"><mo id="S4.SS1.p2.4.m4.1.1.1.1.6.3a" xref="S4.SS1.p2.4.m4.1.1.1.1.6.3.cmml">−</mo><mn id="S4.SS1.p2.4.m4.1.1.1.1.6.3.2" xref="S4.SS1.p2.4.m4.1.1.1.1.6.3.2.cmml">1</mn></mrow></msup></mrow><mo id="S4.SS1.p2.4.m4.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.3a.cmml">,</mo><mrow id="S4.SS1.p2.4.m4.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.cmml"><msub id="S4.SS1.p2.4.m4.2.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.2.2.cmml">λ</mi><mtext id="S4.SS1.p2.4.m4.2.2.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.2.2.2.3a.cmml">sds</mtext></msub><mo id="S4.SS1.p2.4.m4.2.2.2.2.1" xref="S4.SS1.p2.4.m4.2.2.2.2.1.cmml">=</mo><msup id="S4.SS1.p2.4.m4.2.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.cmml"><mn id="S4.SS1.p2.4.m4.2.2.2.2.3.2" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2.cmml">10</mn><mrow id="S4.SS1.p2.4.m4.2.2.2.2.3.3" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.cmml"><mo id="S4.SS1.p2.4.m4.2.2.2.2.3.3a" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.cmml">−</mo><mn id="S4.SS1.p2.4.m4.2.2.2.2.3.3.2" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.2.cmml">2</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.2b"><apply id="S4.SS1.p2.4.m4.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.3a.cmml" xref="S4.SS1.p2.4.m4.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p2.4.m4.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1"><and id="S4.SS1.p2.4.m4.1.1.1.1a.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1"></and><apply id="S4.SS1.p2.4.m4.1.1.1.1b.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1"><eq id="S4.SS1.p2.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.3"></eq><apply id="S4.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.2">𝜆</ci><ci id="S4.SS1.p2.4.m4.1.1.1.1.2.3a.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3"><mtext id="S4.SS1.p2.4.m4.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.SS1.p2.4.m4.1.1.1.1.2.3">seg</mtext></ci></apply><apply id="S4.SS1.p2.4.m4.1.1.1.1.4.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.4.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.4">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.4.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.4.2">𝜆</ci><ci id="S4.SS1.p2.4.m4.1.1.1.1.4.3a.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.4.3"><mtext id="S4.SS1.p2.4.m4.1.1.1.1.4.3.cmml" mathsize="70%" xref="S4.SS1.p2.4.m4.1.1.1.1.4.3">dir</mtext></ci></apply></apply><apply id="S4.SS1.p2.4.m4.1.1.1.1c.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1"><eq id="S4.SS1.p2.4.m4.1.1.1.1.5.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2409.14778v1#S4.SS1.p2.4.m4.1.1.1.1.4.cmml" id="S4.SS1.p2.4.m4.1.1.1.1d.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1"></share><apply id="S4.SS1.p2.4.m4.1.1.1.1.6.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.6.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.6">superscript</csymbol><cn id="S4.SS1.p2.4.m4.1.1.1.1.6.2.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.1.6.2">10</cn><apply id="S4.SS1.p2.4.m4.1.1.1.1.6.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.6.3"><minus id="S4.SS1.p2.4.m4.1.1.1.1.6.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.6.3"></minus><cn id="S4.SS1.p2.4.m4.1.1.1.1.6.3.2.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.1.6.3.2">1</cn></apply></apply></apply></apply><apply id="S4.SS1.p2.4.m4.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2"><eq id="S4.SS1.p2.4.m4.2.2.2.2.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.1"></eq><apply id="S4.SS1.p2.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2.2">𝜆</ci><ci id="S4.SS1.p2.4.m4.2.2.2.2.2.3a.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2.3"><mtext id="S4.SS1.p2.4.m4.2.2.2.2.2.3.cmml" mathsize="70%" xref="S4.SS1.p2.4.m4.2.2.2.2.2.3">sds</mtext></ci></apply><apply id="S4.SS1.p2.4.m4.2.2.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3">superscript</csymbol><cn id="S4.SS1.p2.4.m4.2.2.2.2.3.2.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.2.2.3.2">10</cn><apply id="S4.SS1.p2.4.m4.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3"><minus id="S4.SS1.p2.4.m4.2.2.2.2.3.3.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3"></minus><cn id="S4.SS1.p2.4.m4.2.2.2.2.3.3.2.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.2.2.3.3.2">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.2c">\lambda_{\text{seg}}=\lambda_{\text{dir}}=10^{-1},\lambda_{\text{sds}}=10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.2d">italic_λ start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT = 10 start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , italic_λ start_POSTSUBSCRIPT sds end_POSTSUBSCRIPT = 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.
Reconstructing a hairstyle using our method takes up to six hours on a single RTX 4090.
For more details on implementation and training, please refer to the supplementary materials.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Real-world Evaluation</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We evaluate our approach using monocular video sequences captured under unconstrained lighting conditions.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Baseline.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">The main baseline we compare against is Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
This method reconstructs strand-based hair geometry in the same scenario as ours, i.e. using real-world multi-view image/monocular video data.
It consists of two stages.
During the first stage, it reconstructs coarse hair geometry using a layered neural signed distance function <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib41" title="">41</a>]</cite>, where the layers correspond to the hair and bust geometries.
The hair surface geometry also incorporates a 3D-lifted orientation field.
During the second stage, the strands are parameterized as latent hair maps and optimized using the Chamfer distance between the strands and the visible part of the hair surface.
The authors also propose a differentiable hair rendering pipeline that relies on mesh-based rasterization to propagate photometric information into geometry.
However, this loss does not propagate high-frequency details and only slightly improves strand geometry.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1251" id="S4.F3.g1" src="x3.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">A qualitative comparison of the reconstructed strand-based geometry against Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>. Our method has higher accuracy of the reconstructed hairstyles while achieving more than ten times improvement in the optimization speed.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Comparison.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">In contrast to this method, we primarily rely on differentiable rendering of the hair strands to learn their geometry.
Toward this end, we use a two-stage training approach that first does bundle adjustment and 3D lifting of orientation maps using unstructured Gaussians and then utilizes structured Gaussians to learn the hairstyle’s shape via differentiable rasterization.
Our approach achieves considerable quality improvements in the resulting hairstyles, as seen in the qualitative evaluation, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.F3" title="Figure 3 ‣ Baseline. ‣ 4.2 Real-world Evaluation ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">3</span></a>.
Another advantage of our method is the faster reconstruction timings.
We achieve more than ten times speed-up compared to the base approach with improved reconstruction quality.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="779" id="S4.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.3.2" style="font-size:90%;">Our method can achieve photorealistic renders of strand-based geometry using structured Gaussians. We showcase the rendering results produced by our Gaussian-based strand rasterization method from test views. Since these images were not included in the training set and thus were not part of the bundle adjustment, there is a slight misalignment between the predicted images and the ground truth.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="137" id="S4.F5.g1" src="x5.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.3.2" style="font-size:90%;">Hairstyles produced by our method can be easily imported into a computer graphics engine for editing, rendering, and simulation. Here, we show the simulation results of the reconstructed hairstyle in Unreal Engine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib9" title="">9</a>]</cite>.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Applications.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px3.p1.1">The learned structured Gaussians can be used out-of-the-box for fast and photorealistic rendering of the reconstructed hairstyles.
We showcase the rendering results in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.F4" title="Figure 4 ‣ Comparison. ‣ 4.2 Real-world Evaluation ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">4</span></a>.
These images can be generated in seconds, on par with the rendering time required to achieve similar visual quality with the classical rendering approaches, for example, using <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib9" title="">9</a>]</cite>.
They also have the upside of matching the lighting and the subject’s hair color without requiring manual adjustment.
Also, due to the dual nature of our reconstructions, we can leverage the explicit geometry of the reconstructed strands to conduct a generalizable physics simulation driven by the motion of the head.
We showcase the simulation results in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.F5" title="Figure 5 ‣ Comparison. ‣ 4.2 Real-world Evaluation ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">5</span></a> and the supplementary materials.
Note that achieving such high plausibility of simulated dynamics is only possible because our reconstructions are structured into strands, are connected to the parametric head mesh, and have realistic internal structures due to the use of hairstyle priors.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="799" id="S4.F6.g1" src="x6.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.4.2.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S4.F6.2.1" style="font-size:90%;">Ablation of the strands fitting stage. We show reconstructions obtained with only coarse stage fitting: w/o fine optimization. Then, we ablate the use of the orientation maps renders generated with unstructured Gaussians for geometry supervision: w/o synthetic renders; using upsampling of guiding strands during coarse strands fitting: w/o strands upsampling; not using orientation loss: w/o <math alttext="\mathcal{L}_{\text{dir}}" class="ltx_Math" display="inline" id="S4.F6.2.1.m1.1"><semantics id="S4.F6.2.1.m1.1b"><msub id="S4.F6.2.1.m1.1.1" xref="S4.F6.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F6.2.1.m1.1.1.2" xref="S4.F6.2.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.F6.2.1.m1.1.1.3" xref="S4.F6.2.1.m1.1.1.3a.cmml">dir</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.F6.2.1.m1.1c"><apply id="S4.F6.2.1.m1.1.1.cmml" xref="S4.F6.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F6.2.1.m1.1.1.1.cmml" xref="S4.F6.2.1.m1.1.1">subscript</csymbol><ci id="S4.F6.2.1.m1.1.1.2.cmml" xref="S4.F6.2.1.m1.1.1.2">ℒ</ci><ci id="S4.F6.2.1.m1.1.1.3a.cmml" xref="S4.F6.2.1.m1.1.1.3"><mtext id="S4.F6.2.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.F6.2.1.m1.1.1.3">dir</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.2.1.m1.1d">\mathcal{L}_{\text{dir}}</annotation><annotation encoding="application/x-llamapun" id="S4.F6.2.1.m1.1e">caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT</annotation></semantics></math>. We observe that all our proposed components contribute to the final quality of the results.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We ablate the importance of our method’s components on real and synthetic scenes.
Following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>, for synthetic evaluation, we use two hair models of straight and curly hairstyles <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib49" title="">49</a>]</cite> that are widely used in the literature as benchmarks.</p>
</div>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Orientation maps lifting.</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.2">First, we evaluate the efficiency of our 3D line lifting approach in producing the denoised orientation maps.
A standard hair orientation map calculation approach relies on Gabor filter banks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib27" title="">27</a>]</cite>.
Thus, we can utilize a rendering engine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib6" title="">6</a>]</cite> to produce realistic renders of synthetic hairstyles, which can be used to run orientation map extraction via these filters.
For quantitative evaluation, we also generate the ground-truth orientation maps directly from the underlying geometry using classical line rendering algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib44" title="">44</a>]</cite>.
Our method achieves the lowest average angular error of re-projections of <math alttext="7^{\circ}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><msup id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">7</mn><mo id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><cn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2">7</cn><compose id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">7^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.1.m1.1d">7 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math>, followed by the error of <math alttext="8^{\circ}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><msup id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">8</mn><mo id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><cn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2">8</cn><compose id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">8^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.2.m2.1d">8 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math> achieved by Gabor filters. These metrics are the average of 70 test views for two synthetic hairstyles.
Thus, our 3D line lifting gives better estimates for hair orientation maps than Gabor filters.
Moreover, we evaluate the effect of these synthesized orientation maps on the reconstructed hair geometry in real-world examples.
The results are in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.F6" title="Figure 6 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">6</span></a>, third column.
Note that with synthesized orientation maps, our method can model the geometry more accurately in regions with poor illumination and highly entangled hair strands, such as the one shown in the first row.
Please refer to the supplementary materials for more examples.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Coarse-to-fine strands fitting.</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">Next, we evaluate the effectiveness of our strand-fitting approach.
First, we showcase the results without the fine fitting step, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.F6" title="Figure 6 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">6</span></a>, second column, and without synthetic renders of orientation maps, third column.
We observe that our method fails to achieve high levels of accuracy in the resulting hairstyles with only the coarse optimization step or without using our proposed 3D orientation maps lifting methods, especially in the areas with a high density of strands and poor illumination: see the first row.
Then, we evaluate our proposed upsampling technique for hair rasterization, column fourth.
We observe that without using strand upsampling during the coarse stage, the fine fitting cannot converge to an accurate hairstyle; see the first, third, and fourth rows.
Finally, we evaluate the effectiveness of using orientation loss <math alttext="\mathcal{L}_{\text{dir}}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><msub id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3a.cmml">dir</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2">ℒ</ci><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3">dir</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">\mathcal{L}_{\text{dir}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT</annotation></semantics></math>, see column fifth.
The extended version of the ablation study with additional experiments is available in the supplementary materials.
There, we also validate the diffusion-based prior’s efficiency.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We have presented a method for accurate strand-based hair reconstruction.
To achieve that, we propose a new hair modeling method that consists of Gaussian-based 3D line lifting and a strand optimization approach that relies on our new dual representation called strand-aligned Gaussians.
We also introduce a coarse-to-fine optimization method for hair strands that achieves state-of-the-art performance in multi-view hair reconstruction using 360<sup class="ltx_sup" id="S5.p1.1.1">∘</sup> head capture with unconstrained lighting conditions.
Our findings are validated via an extensive evaluation using real-world and synthetic data.
The limitations of our method are in many aspects similar to the base Neural Haircut approach.
For example, the strand-based hair prior struggles to model curly hairstyles, as seen in one of the examples in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#S4.F3" title="Figure 3 ‣ Baseline. ‣ 4.2 Real-world Evaluation ‣ 4 Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">3</span></a>.
Also, our method is unsuited for reconstructing hairstyles with complicated internal structures, such as braids.
Thus, introducing support for more sophisticated hair geometries remains future work.
Our method also achieves a substantial speed-up compared to the baseline approaches, outperforming the optimization speed of the previous state-of-the-art by more than ten times.
We also showcase how the hairstyles produced by our method can be directly imported into computer graphics engines, such as Unreal Engine, for use in physically rendered and simulated environments.
We believe that fast and accurate reconstruction of hairstyles from real-world data can open the way to exciting applications in telepresence, special effects, and gaming industries.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We sincerely thank Joachim Tesch for his help with realistic hair simulations.
The data presented in the work was provided by the MPI-IS Capture Team and the Samsung AI Center.
We thank the MPI-IS Capture Team, especially Asuka Bertler, Tsvetelina Alexiadis, and Claudia Gallatz, for their help and assistance in capturing data.
Egor Zakharov was funded by the “AI-PERCEIVE” 2021 ERC Consolidator Grant.
Vanessa Sklyarova was supported by the Max Planck ETH Center for Learning Systems.
Michael Black conflict of interest disclosure: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://files.is.tue.mpg.de/black/CoI_ECCV_2024.txt" title="">https://files.is.tue.mpg.de/black/CoI_ECCV_2024.txt</a>.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Cao, C., Weng, Y., Zhou, S., Tong, Y., Zhou, K.: Facewarehouse: A 3d facial expression database for visual computing. IEEE Transactions on Visualization and Computer Graphics <span class="ltx_text ltx_font_bold" id="bib.bib1.1.1">20</span>(3), 413–425 (2013)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Chai, M., Luo, L., Sunkavalli, K., Carr, N., Hadap, S., Zhou, K.: High-quality hair modeling from a single portrait photo. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib2.1.1">34</span>(6), 1–10 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Chai, M., Shao, T., Wu, H., Weng, Y., Zhou, K.: Autohair: fully automatic hair modeling from a single image. ACM Trans. Graph. <span class="ltx_text ltx_font_bold" id="bib.bib3.1.1">35</span>, 116:1–116:12 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Chen, Y., Wang, L., Li, Q., Xiao, H., Zhang, S., Yao, H., Liu, Y.: Monogaussianavatar: Monocular gaussian point-based head avatar. arXiv preprint arXiv:2312.04558 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Chiang, M.J.Y., Bitterli, B., Tappan, C., Burley, B.: A practical and controllable hair and fur model for production path tracing. In: Computer Graphics Forum. vol. 35, pp. 275–283. Wiley Online Library (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Community, B.O.: Blender - a 3D modelling and rendering package. Blender Foundation, Stichting Blender Foundation, Amsterdam (2023), <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.blender.org" title="">http://www.blender.org</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Daviet, G.: Interactive hair simulation on the gpu using admm. In: ACM SIGGRAPH 2023 Conference Proceedings. pp. 1–11 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Dhamo, H., Nie, Y., Moreau, A., Song, J., Shaw, R., Zhou, Y., Pérez-Pellitero, E.: Headgas: Real-time animatable head avatars via 3d gaussian splatting. arXiv preprint arXiv:2312.02902 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Epic Games: Unreal engine, <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.unrealengine.com" title="">https://www.unrealengine.com</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Fascione, L., Hanika, J., Pieké, R., Villemin, R., Hery, C., Gamito, M., Emrose, L., Mazzone, A.: Path tracing in production. In: ACM SIGGRAPH 2018 Courses, pp. 1–79 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Fei, Y., Maia, H.T., Batty, C., Zheng, C., Grinspun, E.: A multi-scale model for simulating liquid-hair interactions. ACM Transactions on Graphics (TOG) <span class="ltx_text ltx_font_bold" id="bib.bib11.1.1">36</span>(4), 1–17 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Garbin, S.J., Kowalski, M., Estellers, V., Szymanowicz, S., Rezaeifar, S., Shen, J., Johnson, M., Valentin, J.: Voltemorph: Realtime, controllable and generalisable animation of volumetric representations. arXiv preprint arXiv:2208.00949 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Hsu, J., Wang, T., Pan, Z., Gao, X., Yuksel, C., Wu, K.: Sag-free initialization for strand-based hybrid hair simulation. ACM Transactions on Graphics (Proceedings of SIGGRAPH 2023) <span class="ltx_text ltx_font_bold" id="bib.bib13.1.1">42</span>(4) (07 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Jiang, Y., Shen, Z., Wang, P., Su, Z., Hong, Y., Zhang, Y., Yu, J., Xu, L.: Hifi4g: High-fidelity human performance rendering via compact gaussian splatting. ArXiv <span class="ltx_text ltx_font_bold" id="bib.bib14.1.1">abs/2312.03461</span> (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Karras, T., Aittala, M., Aila, T., Laine, S.: Elucidating the design space of diffusion-based generative models. In: Advances in Neural Information Processing Systems (NeurIPS) (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Kerbl, B., Kopanas, G., Leimkühler, T., Drettakis, G.: 3d gaussian splatting for real-time radiance field rendering. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib16.1.1">42</span>(4) (July 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Kirschstein, T., Qian, S., Giebenhain, S., Walter, T., Nießner, M.: Nersemble: Multi-view radiance field reconstruction of human heads. ACM Trans. Graph. <span class="ltx_text ltx_font_bold" id="bib.bib17.1.1">42</span>(4) (jul 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Li, T., Bolkart, T., Black, M.J., Li, H., Romero, J.: Learning a model of facial shape and expression from 4D scans. ACM Transactions on Graphics, (Proc. SIGGRAPH Asia) <span class="ltx_text ltx_font_bold" id="bib.bib18.1.1">36</span>(6), 194:1–194:17 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Lin, C.H., Ma, W.C., Torralba, A., Lucey, S.: Barf: Bundle-adjusting neural radiance fields. 2021 IEEE/CVF International Conference on Computer Vision (ICCV) pp. 5721–5731 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Lombardi, S., Simon, T., Schwartz, G., Zollhoefer, M., Sheikh, Y., Saragih, J.: Mixture of volumetric primitives for efficient neural rendering. ACM Transactions on Graphics (ToG) <span class="ltx_text ltx_font_bold" id="bib.bib20.1.1">40</span>(4), 1–13 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Lombardi, S., Simon, T., Schwartz, G., Zollhoefer, M., Sheikh, Y., Saragih, J.M.: Mixture of volumetric primitives for efficient neural rendering. ACM Transactions on Graphics (TOG) <span class="ltx_text ltx_font_bold" id="bib.bib21.1.1">40</span>, 1 – 13 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Luo, H., Min, O., Zhao, Z., Jiang, S., Zhang, L., Zhang, Q., Yang, W., Xu, L., Yu, J.: Gaussianhair: Hair modeling and rendering with light-aware gaussians. vol. abs/2402.10483 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Luo, L., Li, H., Paris, S., Weise, T., Pauly, M., Rusinkiewicz, S.: Multi-view hair capture using orientation fields. In: 2012 IEEE Conference on Computer Vision and Pattern Recognition. pp. 1490–1497. IEEE (2012)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Luo, L., Li, H., Rusinkiewicz, S.: Structure-aware hair capture. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib24.1.1">32</span>(4), 1–12 (2013)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Luo, L., Zhang, C., Zhang, Z., Rusinkiewicz, S.: Wide-baseline hair capture using strand-based refinement. In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition. pp. 265–272 (2013)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Nam, G., Wu, C., Kim, M.H., Sheikh, Y.: Strand-accurate multi-view hair capture. 2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) pp. 155–164 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Paris, S., Briceño, H.M., Sillion, F.X.: Capture of hair geometry from multiple images. ACM SIGGRAPH 2004 Papers (2004)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Paris, S., Chang, W., Kozhushnyan, O.I., Jarosz, W., Matusik, W., Zwicker, M., Durand, F.: Hair photobooth: geometric and photometric acquisition of real hairstyles. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib28.1.1">27</span>(3),  30 (2008)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Piuze, E., Kry, P.G., Siddiqi, K.: Generalized helicoids for modeling hair geometry. In: Computer Graphics Forum. vol. 30, pp. 247–256. Wiley Online Library (2011)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Poole, B., Jain, A., Barron, J.T., Mildenhall, B.: Dreamfusion: Text-to-3d using 2d diffusion. ICLR <span class="ltx_text ltx_font_bold" id="bib.bib30.1.1">abs/2209.14988</span> (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Qian, S., Kirschstein, T., Schoneveld, L., Davoli, D., Giebenhain, S., Nießner, M.: Gaussianavatars: Photorealistic head avatars with rigged 3d gaussians. arXiv preprint arXiv:2312.02069 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Rivero, A., Athar, S., Shu, Z., Samaras, D.: Rig3dgs: Creating controllable portraits from casual monocular videos. arXiv preprint arXiv:2402.03723 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Rosu, R.A., Saito, S., Wang, Z., Wu, C., Behnke, S., Nam, G.: Neural strands: Learning hair geometry and appearance from multi-view images. In: European Conference on Computer Vision (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Saito, S., Schwartz, G., Simon, T., Li, J., Nam, G.: Relightable gaussian codec avatars. ArXiv <span class="ltx_text ltx_font_bold" id="bib.bib34.1.1">abs/2312.03704</span> (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Schönberger, J.L., Frahm, J.M.: Structure-from-motion revisited. In: Conference on Computer Vision and Pattern Recognition (CVPR) (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Shen, Y., Saito, S., Wang, Z., Maury, O., Wu, C., Hodgins, J., Zheng, Y., Nam, G.: Ct2hair: High-fidelity 3d hair modeling using computed tomography. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib36.1.1">42</span>(4), 1–13 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Shen, Y., Zhang, C., Fu, H., Zhou, K., Zheng, Y.: Deepsketchhair: Deep sketch-based 3d hair modeling. IEEE transactions on visualization and computer graphics <span class="ltx_text ltx_font_bold" id="bib.bib37.1.1">27</span>(7), 3250–3263 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Sklyarova, V., Chelishev, J., Dogaru, A., Medvedev, I., Lempitsky, V., Zakharov, E.: Neural haircut: Prior-guided strand-based hair reconstruction. In: Proceedings of IEEE International Conference on Computer Vision (ICCV) (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Sklyarova, V., Zakharov, E., Hilliges, O., Black, M.J., Thies, J.: Haar: Text-conditioned generative model of 3d strand-based human hairstyles. ArXiv (Dec 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Su, S., Yan, Q., Zhu, Y., Zhang, C., Ge, X., Sun, J., Zhang, Y.: Blindly assess image quality in the wild guided by a self-adaptive hyper network. 2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) pp. 3664–3673 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Wang, P., Liu, L., Liu, Y., Theobalt, C., Komura, T., Wang, W.: Neus: Learning neural implicit surfaces by volume rendering for multi-view reconstruction. In: Advances in Neural Information Processing Systems (NeurIPS) (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Wang, Z., Nam, G., Stuyck, T., Lombardi, S., Cao, C., Saragih, J.M., Zollhoefer, M., Hodgins, J.K., Lassner, C.: Neuwigs: A neural dynamic model for volumetric hair capture and animation. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR). pp. 8641–8651 (June 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Wang, Z., Nam, G., Stuyck, T., Lombardi, S., Zollhoefer, M., Hodgins, J.K., Lassner, C.: Hvh: Learning a hybrid neural volumetric representation for dynamic hair performance capture. 2022 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) pp. 6133–6144 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Woo, M., Neider, J., Davis, T., Shreiner, D.: OpenGL programming guide: the official guide to learning OpenGL, version 1.2. Addison-Wesley Longman Publishing Co., Inc. (1999)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Xiang, J., Gao, X., Guo, Y., Zhang, J.: Flashavatar: High-fidelity digital avatar rendering at 300fps (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Xing, J., Nagano, K., Chen, W., Xu, H., Wei, L.y., Zhao, Y., Lu, J., Kim, B., Li, H.: Hairbrush for immersive data-driven hair modeling. In: Proceedings of the 32Nd Annual ACM Symposium on User Interface Software and Technology. pp. 263–279 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Xu, Y., Chen, B., Li, Z., Zhang, H., Wang, L., Zheng, Z., Liu, Y.: Gaussian head avatar: Ultra high-fidelity head avatar via dynamic gaussians (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Yao, J., Wang, X., Ye, L., Liu, W.: Matte anything: Interactive natural image matting with segment anything models. arXiv preprint arXiv:2306.04121 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Yuksel, C., Schaefer, S., Keyser, J.: Hair meshes. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib49.1.1">28</span>(5),  1–7 (2009)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Zhang, M., Chai, M., Wu, H., Yang, H., Zhou, K.: A data-driven approach to four-view image-based hair modeling. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib50.1.1">36</span>(4), 156–1 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Zhang, M., Wu, P., Wu, H., Weng, Y., Zheng, Y., Zhou, K.: Modeling hair from an rgb-d camera. ACM Transactions on Graphics <span class="ltx_text ltx_font_bold" id="bib.bib51.1.1">37</span>(6), 1–10 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Zhao, Z., Bao, Z., Li, Q., Qiu, G., Liu, K.: Psavatar: A point-based morphable shape model for real-time head avatar creation with 3d gaussian splatting. arXiv preprint arXiv:2401.12900 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Zheng, Y., Jin, Z., Li, M., Huang, H., Ma, C., Cui, S., Han, X.: Hairstep: Transfer synthetic to real using strand and depth maps for single-view 3d hair modeling. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 12726–12735 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Zhou, Y., Chai, M., Pepe, A., Gross, M., Beeler, T.: Groomgen: A high-quality generative hair model using hierarchical latent representations. ACM Transactions on Graphics (TOG) <span class="ltx_text ltx_font_bold" id="bib.bib54.1.1">42</span>(6), 1–16 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Zielonka, W., Bolkart, T., Thies, J.: Instant volumetric head avatars. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 4574–4584 (2023)

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="Pt0.A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.A </span>Implementation Details</h2>
<div class="ltx_para" id="Pt0.A1.p1">
<p class="ltx_p" id="Pt0.A1.p1.1">Below we describe each processing step of our proposed method in more detail.</p>
</div>
<section class="ltx_subsection" id="Pt0.A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.1 </span>Preprocessing</h3>
<div class="ltx_para" id="Pt0.A1.SS1.p1">
<p class="ltx_p" id="Pt0.A1.SS1.p1.4">We experiment with video-based captures but can employ a similar pipeline to process image-based captures.
First, we extract the frames from the video with the framerate of 3 FPS.
To reduce the motion blur, among the frames spanning each <math alttext="1/3" class="ltx_Math" display="inline" id="Pt0.A1.SS1.p1.1.m1.1"><semantics id="Pt0.A1.SS1.p1.1.m1.1a"><mrow id="Pt0.A1.SS1.p1.1.m1.1.1" xref="Pt0.A1.SS1.p1.1.m1.1.1.cmml"><mn id="Pt0.A1.SS1.p1.1.m1.1.1.2" xref="Pt0.A1.SS1.p1.1.m1.1.1.2.cmml">1</mn><mo id="Pt0.A1.SS1.p1.1.m1.1.1.1" xref="Pt0.A1.SS1.p1.1.m1.1.1.1.cmml">/</mo><mn id="Pt0.A1.SS1.p1.1.m1.1.1.3" xref="Pt0.A1.SS1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.1.m1.1b"><apply id="Pt0.A1.SS1.p1.1.m1.1.1.cmml" xref="Pt0.A1.SS1.p1.1.m1.1.1"><divide id="Pt0.A1.SS1.p1.1.m1.1.1.1.cmml" xref="Pt0.A1.SS1.p1.1.m1.1.1.1"></divide><cn id="Pt0.A1.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="Pt0.A1.SS1.p1.1.m1.1.1.2">1</cn><cn id="Pt0.A1.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="Pt0.A1.SS1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.1.m1.1c">1/3</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS1.p1.1.m1.1d">1 / 3</annotation></semantics></math> of a second, we pick the one with the highest image quality score calculated via a HyperIQA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib40" title="">40</a>]</cite> network.
We run COLMAP SfM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib35" title="">35</a>]</cite> algorithm for the extracted frames to estimate the initial point cloud and the camera parameters.
To obtain the segmentation masks, we rely on Matte-Anything <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib48" title="">48</a>]</cite> prompt-based image matting system.
To produce the corresponding segmentation masks, we use the following prompts: “hair”, “face”, and “human”.
We then filter the cases where segmentation masking fails.
For that, we have designed a heuristic in which we calculate the intersection between the hair and face and prune the frame if it is higher than <math alttext="10\%" class="ltx_Math" display="inline" id="Pt0.A1.SS1.p1.2.m2.1"><semantics id="Pt0.A1.SS1.p1.2.m2.1a"><mrow id="Pt0.A1.SS1.p1.2.m2.1.1" xref="Pt0.A1.SS1.p1.2.m2.1.1.cmml"><mn id="Pt0.A1.SS1.p1.2.m2.1.1.2" xref="Pt0.A1.SS1.p1.2.m2.1.1.2.cmml">10</mn><mo id="Pt0.A1.SS1.p1.2.m2.1.1.1" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.2.m2.1b"><apply id="Pt0.A1.SS1.p1.2.m2.1.1.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="Pt0.A1.SS1.p1.2.m2.1.1.1.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1.1">percent</csymbol><cn id="Pt0.A1.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="Pt0.A1.SS1.p1.2.m2.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.2.m2.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS1.p1.2.m2.1d">10 %</annotation></semantics></math> of the body mask area.
Lastly, we calculate image quality scores again for the masked hair crops.
We split the filtered images into consecutive <math alttext="128" class="ltx_Math" display="inline" id="Pt0.A1.SS1.p1.3.m3.1"><semantics id="Pt0.A1.SS1.p1.3.m3.1a"><mn id="Pt0.A1.SS1.p1.3.m3.1.1" xref="Pt0.A1.SS1.p1.3.m3.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.3.m3.1b"><cn id="Pt0.A1.SS1.p1.3.m3.1.1.cmml" type="integer" xref="Pt0.A1.SS1.p1.3.m3.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.3.m3.1c">128</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS1.p1.3.m3.1d">128</annotation></semantics></math> bins and picked the image with the highest score from each bin for training, resulting in <math alttext="128" class="ltx_Math" display="inline" id="Pt0.A1.SS1.p1.4.m4.1"><semantics id="Pt0.A1.SS1.p1.4.m4.1a"><mn id="Pt0.A1.SS1.p1.4.m4.1.1" xref="Pt0.A1.SS1.p1.4.m4.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.4.m4.1b"><cn id="Pt0.A1.SS1.p1.4.m4.1.1.cmml" type="integer" xref="Pt0.A1.SS1.p1.4.m4.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.4.m4.1c">128</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS1.p1.4.m4.1d">128</annotation></semantics></math> training views.
These pre-processing steps closely follow the ones used in Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
We rely on the pipeline proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib27" title="">27</a>]</cite> for orientation map calculation and use the code of Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="Pt0.A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.2 </span>Guiding Strands Upsampling</h3>
<div class="ltx_para" id="Pt0.A1.SS2.p1">
<p class="ltx_p" id="Pt0.A1.SS2.p1.1">We follow HAAR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib39" title="">39</a>]</cite> in the procedure that we use for the interpolation of the hair strands.
In this work, they perform upsampling using a regular grid of latent maps and blend the strands produced using nearest and bilinear interpolation methods.
In our case, we use irregular grids and thus use K nearest neighbors for both, replacing bilinear interpolation with the one that blends four nearest neighbors.
The KNN-based interpolation weights are inversely proportional to the distance between the interpolated strands’ origins and the query origin in the space of texture coordinates.
Another change compared to HAAR is that we conduct the interpolation in the space of hair maps instead of latent maps.
Thus, we directly interpolate the 3D coordinates of the strands, each being defined within its own TBN (tangent-bitangent-normal) basis, which is defined using the scalp face where the strand originates <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib33" title="">33</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="Pt0.A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.3 </span>Diffusion-Based Prior</h3>
<div class="ltx_para" id="Pt0.A1.SS3.p1">
<p class="ltx_p" id="Pt0.A1.SS3.p1.6">Our diffusion-based prior follows Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>.
We rely on Score Distillation Sampling (SDS) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib30" title="">30</a>]</cite> to enforce this prior at the level of latent hair maps.
Thus, during the coarse strand fitting stage, we directly follow Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> in applying it.
To utilize diffusion-based prior at the level of strand-based hair maps <math alttext="H" class="ltx_Math" display="inline" id="Pt0.A1.SS3.p1.1.m1.1"><semantics id="Pt0.A1.SS3.p1.1.m1.1a"><mi id="Pt0.A1.SS3.p1.1.m1.1.1" xref="Pt0.A1.SS3.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.1.m1.1b"><ci id="Pt0.A1.SS3.p1.1.m1.1.1.cmml" xref="Pt0.A1.SS3.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS3.p1.1.m1.1d">italic_H</annotation></semantics></math>, we use a pre-trained encoder <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="Pt0.A1.SS3.p1.2.m2.1"><semantics id="Pt0.A1.SS3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS3.p1.2.m2.1.1" xref="Pt0.A1.SS3.p1.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.2.m2.1b"><ci id="Pt0.A1.SS3.p1.2.m2.1.1.cmml" xref="Pt0.A1.SS3.p1.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.2.m2.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS3.p1.2.m2.1d">caligraphic_E</annotation></semantics></math> that maps a hair map <math alttext="H" class="ltx_Math" display="inline" id="Pt0.A1.SS3.p1.3.m3.1"><semantics id="Pt0.A1.SS3.p1.3.m3.1a"><mi id="Pt0.A1.SS3.p1.3.m3.1.1" xref="Pt0.A1.SS3.p1.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.3.m3.1b"><ci id="Pt0.A1.SS3.p1.3.m3.1.1.cmml" xref="Pt0.A1.SS3.p1.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.3.m3.1c">H</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS3.p1.3.m3.1d">italic_H</annotation></semantics></math> into its latent version <math alttext="Z" class="ltx_Math" display="inline" id="Pt0.A1.SS3.p1.4.m4.1"><semantics id="Pt0.A1.SS3.p1.4.m4.1a"><mi id="Pt0.A1.SS3.p1.4.m4.1.1" xref="Pt0.A1.SS3.p1.4.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.4.m4.1b"><ci id="Pt0.A1.SS3.p1.4.m4.1.1.cmml" xref="Pt0.A1.SS3.p1.4.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.4.m4.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS3.p1.4.m4.1d">italic_Z</annotation></semantics></math>.
Specifically, we randomly sample a set of 1,000 guiding strands and map them into a regular grid of origins using an interpolation method described above.
As a result, we produce a guiding hair map <math alttext="H^{\prime}" class="ltx_Math" display="inline" id="Pt0.A1.SS3.p1.5.m5.1"><semantics id="Pt0.A1.SS3.p1.5.m5.1a"><msup id="Pt0.A1.SS3.p1.5.m5.1.1" xref="Pt0.A1.SS3.p1.5.m5.1.1.cmml"><mi id="Pt0.A1.SS3.p1.5.m5.1.1.2" xref="Pt0.A1.SS3.p1.5.m5.1.1.2.cmml">H</mi><mo id="Pt0.A1.SS3.p1.5.m5.1.1.3" xref="Pt0.A1.SS3.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.5.m5.1b"><apply id="Pt0.A1.SS3.p1.5.m5.1.1.cmml" xref="Pt0.A1.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Pt0.A1.SS3.p1.5.m5.1.1.1.cmml" xref="Pt0.A1.SS3.p1.5.m5.1.1">superscript</csymbol><ci id="Pt0.A1.SS3.p1.5.m5.1.1.2.cmml" xref="Pt0.A1.SS3.p1.5.m5.1.1.2">𝐻</ci><ci id="Pt0.A1.SS3.p1.5.m5.1.1.3.cmml" xref="Pt0.A1.SS3.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.5.m5.1c">H^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS3.p1.5.m5.1d">italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, which we can encode into a guiding latent hair map <math alttext="Z^{\prime}" class="ltx_Math" display="inline" id="Pt0.A1.SS3.p1.6.m6.1"><semantics id="Pt0.A1.SS3.p1.6.m6.1a"><msup id="Pt0.A1.SS3.p1.6.m6.1.1" xref="Pt0.A1.SS3.p1.6.m6.1.1.cmml"><mi id="Pt0.A1.SS3.p1.6.m6.1.1.2" xref="Pt0.A1.SS3.p1.6.m6.1.1.2.cmml">Z</mi><mo id="Pt0.A1.SS3.p1.6.m6.1.1.3" xref="Pt0.A1.SS3.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.6.m6.1b"><apply id="Pt0.A1.SS3.p1.6.m6.1.1.cmml" xref="Pt0.A1.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Pt0.A1.SS3.p1.6.m6.1.1.1.cmml" xref="Pt0.A1.SS3.p1.6.m6.1.1">superscript</csymbol><ci id="Pt0.A1.SS3.p1.6.m6.1.1.2.cmml" xref="Pt0.A1.SS3.p1.6.m6.1.1.2">𝑍</ci><ci id="Pt0.A1.SS3.p1.6.m6.1.1.3.cmml" xref="Pt0.A1.SS3.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.6.m6.1c">Z^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.SS3.p1.6.m6.1d">italic_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.
This map is then directly fed into a diffusion-based prior in order to calculate an SDS loss.</p>
</div>
</section>
<section class="ltx_subsection" id="Pt0.A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.4 </span>Postprocessing</h3>
<div class="ltx_para" id="Pt0.A1.SS4.p1">
<p class="ltx_p" id="Pt0.A1.SS4.p1.1">After training, to achieve simulatable hairstyles, we post-process the resulting strands to ensure they have no intersections with the FLAME mesh.
To achieve that, we calculate a signed distance for all the points on the strands towards the head mesh.
Then, for the strands that intersect the mesh, we prune the intersection regions and then connect the beginning of each of the consecutive strand segment to the nearest vertex on the scalp.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="Pt0.A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.B </span>Experiments</h2>
<figure class="ltx_figure" id="Pt0.A2.F7"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1251" id="Pt0.A2.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.2.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="Pt0.A2.F7.3.2" style="font-size:90%;">Additional qualitative comparison of the reconstructed strand-based geometry against Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite>. Slight misalignment appears due to test-view cameras interpolation.</span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1170" id="Pt0.A2.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F8.2.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="Pt0.A2.F8.3.2" style="font-size:90%;">Qualitative results of our method on additional scenes. Slight misalignment appears due to test-view cameras interpolation.</span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="579" id="Pt0.A2.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F9.2.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="Pt0.A2.F9.3.2" style="font-size:90%;">Qualitative results of our method on additional scenes. Slight misalignment appears due to test-view cameras interpolation.</span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A2.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="239" id="Pt0.A2.F10.1.g1" src="x10.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F10.3.1.1" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text" id="Pt0.A2.F10.4.2" style="font-size:90%;">
Qualitative results of our method on additional scenes. Slight misalignment appears due to test-view cameras interpolation.
</span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A2.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="520" id="Pt0.A2.F11.1.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F11.3.1.1" style="font-size:90%;">Figure 11</span>: </span><span class="ltx_text" id="Pt0.A2.F11.4.2" style="font-size:90%;">
Comparison with the HairStep one-shot hair reconstruction method. We use a frontal image to infer the HairStep result.
</span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A2.F12"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="295" id="Pt0.A2.F12.g1" src="x12.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F12.2.1.1" style="font-size:90%;">Figure 12</span>: </span><span class="ltx_text" id="Pt0.A2.F12.3.2" style="font-size:90%;">The limitations of our method include the problem of curly hairstyles modeling.</span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A2.F13"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1307" id="Pt0.A2.F13.g1" src="x13.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F13.2.1.1" style="font-size:90%;">Figure 13</span>: </span><span class="ltx_text" id="Pt0.A2.F13.3.2" style="font-size:90%;">Extended ablation study of the strands fitting stage (Part 1). </span></figcaption>
</figure>
<figure class="ltx_figure" id="Pt0.A2.F14"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1282" id="Pt0.A2.F14.g1" src="x14.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F14.2.1.1" style="font-size:90%;">Figure 14</span>: </span><span class="ltx_text" id="Pt0.A2.F14.3.2" style="font-size:90%;">Extended ablation study of the strands fitting stage (Part 2). </span></figcaption>
</figure>
<section class="ltx_paragraph" id="Pt0.A2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Real-world evaluation.</h4>
<div class="ltx_para" id="Pt0.A2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="Pt0.A2.SS0.SSS0.Px1.p1.3">We extend the comparison with Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.F7" title="Figure 7 ‣ Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">7</span></a>.
We also provide the reconstruction results for additional scenes in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.F8" title="Figure 8 ‣ Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">8</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.F10" title="Figure 10 ‣ Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">10</span></a>.
An extra comparison with the one-shot hair reconstruction method named HairStep <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib53" title="">53</a>]</cite> is provided in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.F11" title="Figure 11 ‣ Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">11</span></a>.
We also expand the ablation study of the strands fitting in Figs <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.F13" title="Figure 13 ‣ Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">13</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.F14" title="Figure 14 ‣ Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">14</span></a>.
Besides the experiments presented in the main paper, we provide the close-ups and three more experiments: we remove color rendering loss <math alttext="\mathcal{L}_{\text{rgb}}" class="ltx_Math" display="inline" id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.3a.cmml">rgb</mtext></msub><annotation-xml encoding="MathML-Content" id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.2">ℒ</ci><ci id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.3a.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.3"><mtext id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1.1.3">rgb</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1c">\mathcal{L}_{\text{rgb}}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.SS0.SSS0.Px1.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT rgb end_POSTSUBSCRIPT</annotation></semantics></math>, orientation rendering loss <math alttext="\mathcal{L}_{\text{dir}}" class="ltx_Math" display="inline" id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1a"><msub id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.3a.cmml">dir</mtext></msub><annotation-xml encoding="MathML-Content" id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.2">ℒ</ci><ci id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.3a.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.3"><mtext id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1.1.3">dir</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1c">\mathcal{L}_{\text{dir}}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.SS0.SSS0.Px1.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT dir end_POSTSUBSCRIPT</annotation></semantics></math> and diffusion-based loss <math alttext="\mathcal{L}_{\text{sds}}" class="ltx_Math" display="inline" id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1a"><msub id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml">ℒ</mi><mtext id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.3a.cmml">sds</mtext></msub><annotation-xml encoding="MathML-Content" id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.2">ℒ</ci><ci id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.3a.cmml" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.3"><mtext id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1.1.3">sds</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1c">\mathcal{L}_{\text{sds}}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.SS0.SSS0.Px1.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT sds end_POSTSUBSCRIPT</annotation></semantics></math>.
We observe that each of the components of our method meaningfully contribute to the final performance, as illustrated on the close-up images.</p>
</div>
</section>
<section class="ltx_paragraph" id="Pt0.A2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Limitations.</h4>
<div class="ltx_para" id="Pt0.A2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="Pt0.A2.SS0.SSS0.Px2.p1.1">The main limitation of our method follows Neural Haircut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#bib.bib38" title="">38</a>]</cite> and is related to the modeling of curly hairstyles, see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.14778v1#Pt0.A2.F12" title="Figure 12 ‣ Appendix 0.B Experiments ‣ Human Hair Reconstruction with Strand-Aligned 3D Gaussians"><span class="ltx_text ltx_ref_tag">12</span></a>.
We attribute this behavior to the root-to-tip design of the strand-based prior.
In our work, we use the same variant of the prior as the one proposed in Neural Haircut.
Improving the performance for the curly hairstyles thus remains future work.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 23 07:46:13 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
