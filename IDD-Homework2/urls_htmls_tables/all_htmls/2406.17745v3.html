<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search</title>
<!--Generated on Thu Jul  4 17:51:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="sponsored search,  click-through rate prediction,  graph neural network,  behavior sequence" lang="en" name="keywords"/>
<base href="/html/2406.17745v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S1" title="In Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S2" title="In Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S2.SS1" title="In 2. Related Work ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>CTR Prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S2.SS2" title="In 2. Related Work ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Graph Neural Networks for Search and Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3" title="In Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>The Proposed Approach</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.SS1" title="In 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Query-item Heterogeneous Graph</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.SS2" title="In 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Light-weight Subgraph Sampling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.SS3" title="In 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Multi-interest Network for CTR Prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.SS4" title="In 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>End-to-End Joint Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4" title="In Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS1" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS2" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Compared Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS3" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Results on Public Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS4" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Results on Industrial Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS5" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS6" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Graph Input Data Management</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS6.SSS1" title="In 4.6. Graph Input Data Management ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6.1 </span>Subsampling of Frequent Entites</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS6.SSS2" title="In 4.6. Graph Input Data Management ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6.2 </span>Combination of Categorically Restricted Data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS7" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Analysis of EGIN Embedding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.SS8" title="In 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span>Online A/B Test</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S5" title="In Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pipi Peng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ppskingdom@gmail.com">ppskingdom@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_city" id="id1.1.id1">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yunqing Jia
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:jiayunqing01@hotmail.com">jiayunqing01@hotmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_city" id="id3.1.id1">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id4.2.id2">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ziqiang Zhou
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ziqiang0711@gmail.com">ziqiang0711@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_city" id="id5.1.id1">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id6.2.id2">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">murmurhash
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:murmurhash@outlook.com">murmurhash@outlook.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_city" id="id7.1.id1">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zichong Xiao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:zichong.xiao@gmail.com">zichong.xiao@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_city" id="id9.1.id1">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id10.2.id2">China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id11.id1">Click-through-rate (CTR) prediction has an essential impact on improving user experience and revenue in e-commerce search. The ambiguous and incomplete nature of search queries makes it important for CTR models to mine users’ search intentions from rich historical behavior data. With the development of deep learning, a series of works has been proposed to model user interests, bringing significant improvement in model performance. Attention-based methods focus on summarizing user behaviors into a comprehensive interest representation depending on their relationship with the target. Graph-based methods are well exploited to utilize graph structure extracted from user behaviors and other information to help embedding learning. However, most of the previous graph-based methods face the challenges of deployment and performance in large-scale e-commerce search systems. First, these methods usually require a separate graph engine for graph storage and sampling, which makes it hard to jointly train graph embedding with CTR prediction, while requiring more implementation effort. Second, they mainly focus on recommendation scenarios, and therefore their graph structures highly depend on item’s sequential information from user behaviors, ignoring query’s sequential signal and query-item correlation. In both practice and our experiments, this extra information brings notable improvement because of the query-dependent nature of e-commerce search.</p>
<p class="ltx_p" id="id12.id2">In this paper, we propose a new approach named Light-weight End-to-End Graph Interest Network (EGIN) to effectively mine users’ search interests and tackle previous challenges. (i) EGIN utilizes query and item’s correlation and sequential information from the search system to build a heterogeneous graph for better CTR prediction in e-commerce search. (ii) EGIN’s graph embedding learning shares the same training input and is jointly trained with CTR prediction, making the end-to-end framework effortless to deploy in large-scale search systems. The proposed EGIN is composed of three parts: query-item heterogeneous graph, light-weight graph sampling, and multi-interest network. The query-item heterogeneous graph captures correlation and sequential information of query and item efficiently by the proposed light-weight graph sampling. The multi-interest network is well designed to utilize graph embedding to capture various similarity relationships between query and item to enhance the final CTR prediction. We conduct extensive experiments on both public and industrial datasets to demonstrate the effectiveness of the proposed EGIN. At the same time, the training cost of graph learning is relatively low compared with the main CTR prediction task, ensuring efficiency in practical applications. Our code will be publicly available.</p>
</div>
<div class="ltx_keywords">sponsored search, click-through rate prediction, graph neural network, behavior sequence
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2023</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>The 46th International ACM SIGIR Conference on Research and Development in Information Retrieval; July 23-27, 2023; Taipei, Taiwan</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Sponsored search advertising</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Mathematics of computing Graph algorithms</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In sponsored search, click-through rate (CTR) prediction is vital for improving user experience and total revenue. The accuracy of CTR prediction depends on the system’s ability to understand users’ current search intentions and historical interests. The ambiguity of search queries and the consistency of user interests encourage search systems to exploit user behavior in a more and more elaborate way.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">With the development of search and recommender systems, user behavior sequence is inspected in different ways to mine user interest. Recently, a series of works focusing on modeling latent user interest from historical behaviors use various deep neural network architectures including CNN <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib19" title="">2018</a>; Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib23" title="">2019</a>)</cite>, RNN <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib6" title="">2019</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib25" title="">2018</a>)</cite>, Transformer <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib2" title="">2019</a>; Min et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib15" title="">2022</a>)</cite>, Capsule <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib9" title="">2019b</a>)</cite>, etc. Besides, Graph Neural Network <cite class="ltx_cite ltx_citemacro_citep">(Perozzi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib16" title="">2014</a>; Defferrard et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib4" title="">2016</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib20" title="">2018</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib10" title="">2019a</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib22" title="">2019</a>)</cite> has become a popular method for embedding learning to aid CTR prediction in search and recommendation systems and achieved great success. The learned graph embedding is usually consumed by the CTR prediction network to combine the graph learning and the final CTR objective.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">These graph-based methods, although following either a two-stage or end-to-end approach, still require first constructing a graph and then sampling using a graph engine. We summarize them as <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">Construct&amp;Sample</span> paradigm. When applying these methods in a large-scale e-commerce system with billions of items and samples, updating and retrieving the graph within a short delay can be challenging, thus becoming the bottleneck of end-to-end joint training of graph embedding with CTR prediction task.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In addition, these graph-based methods mentioned above mainly focus on items’ sequential and attributive information during graph construction, ignoring queries’ sequential information and query-item correlation, which help improve search ctr prediction quality in our industrial practice.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We propose a new approach called <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Light-weight End-to-End Graph Interest Network (EGIN)</span> to solve these problems. Firstly, the resource consumption and time delay of the Construct&amp;Sample paradigm is alleviated by introducing a light-weight graph sampling method based on data manipulation of CTR task input instead of building a graph engine. Secondly, the EGIN utilizes the query-item heterogeneous graph for search CTR prediction.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The main contributions of this paper are as follows.</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce our light-weight graph sampling that shares the same training input with the CTR prediction task without physically storing the graph structure. End-to-end joint training of graph embedding and CTR prediction is implemented without reorganizing complicated graph data or depending on the graph engine. Our method can be effortlessly integrated into other CTR prediction networks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose the query-item heterogeneous graph to model query-item correlation in graph structure, which improves CTR prediction performance in search scenarios compared with the item-only version. We also design the multi-interest network to exploit query-item correlation provided by graph learning toward a better understanding of user interest.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conduct extensive experiments on public and industrial datasets to demonstrate the effectiveness of the proposed EGIN framework. The online A/B test is conducted to verify the productive performance of the proposed approach. We also discuss the influence of different training techniques and data management.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>CTR Prediction</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">CTR prediction has gained attention from researchers for many years because of its vital role in search and recommendation systems and its ability to improve the revenue of online applications largely. Considering the high sparsity of the input features, a series of works have been proposed to capture feature interactions. Factorization Machines (FM) <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib18" title="">2010</a>)</cite> uses a low-dimensional vector for feature representation and learns the second-order crossover of features by the inner product. Wide&amp;Deep <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib3" title="">2016</a>)</cite> jointly trains the wide linear unit for and the deep MLP layer to enhance both memorization and generalization. DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib7" title="">2017</a>)</cite> integrated factorization machines and deep neural networks to learn the low-order feature interactions. xDeepFM <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib11" title="">2018</a>)</cite> proposes a novel Compressed Interaction Network (CIN) to model high-order feature interactions in an explicit fashion and adopts the traditional DNN simultaneously. Deep &amp; Cross network (DCN) <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib21" title="">2017</a>)</cite> adopts interaction with representation in each layer with original feature embedding to learn higher-order feature representations. Deep learning-based methods have also achieved great success in user interest mining to aid CTR prediction. Deep Interest Network (DIN) <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib25" title="">2018</a>)</cite> developed an attention-based method to assign different weights to historical commodities according to their relationship with the target commodity. Depp Interest Evolution Network (DIEN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib24" title="">2019</a>)</cite> further utilizes RNN to model the evolution of user interest by taking sequential information into account. Deep Session Interest Network (DSIN) <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib6" title="">2019</a>)</cite> leverages Bi-LSTM with self-attention layers to capture users’ inter-session and intro-session interests. MIMN <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib17" title="">2019</a>)</cite> tackles the challenge of long sequential user behavior modeling by decoupling the user interest model from the entire framework and designing the User Interest Center (UIC) to record new behaviors incrementally. Behavior Sequence Transformer (BST) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib2" title="">2019</a>)</cite> uses Transformer to capture underlying sequential signals from user behavior for a better recommendation.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Graph Neural Networks for Search and Recommendation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">A group of graph embedding methods is introduced into the CTR prediction task with their strong potential for modeling graph information in search and recommendation. EGES <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib20" title="">2018</a>)</cite> adopts DeepWalk <cite class="ltx_cite ltx_citemacro_citep">(Perozzi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib16" title="">2014</a>)</cite> to construct graphs based on click sequence, and the Skip-Gram model is used for graph embedding learning. Then the learned node representation is consumed in the CTR prediction network. Graph Intention Network (GIN) <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib10" title="">2019a</a>)</cite> utilizes user behavior sequence to build a co-occurrence commodity network and applies graph diffusion and aggregation to enrich node representation of historical clicks to overcome behavior sparsity and weak generalization problems. KGAT <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib22" title="">2019</a>)</cite> combines user-item graph with knowledge graph for collaborative knowledge and then applies graph convolution to get the graph representation. Heterogeneous graph Attention Network (HGAT) <cite class="ltx_cite ltx_citemacro_citep">(Linmei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib12" title="">2019</a>)</cite> utilizes a semantic-level and a node-level attention network to discriminate the importance of neighbor nodes and node types. DG-ENN <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib8" title="">2021</a>)</cite> uses attribute graph and collaborative graph to refine the embedding with strategies, and alleviates the feature and behavior sparsity problems. However, when applying this method directly in CTR prediction in an end-to-end manner, a separate graph engine is needed to restore and sample the graph for embedding learning. Otherwise, the two-stage approach which first conducts graph embedding learning and then consumes in CTR prediction brings the problem that the graph representation is not optimized for the final objective. Also, these methods focus more on recommendations and ignore the potential of capturing interactions between items and queries to build heterogeneous graphs. To face these challenges, we propose a novel approach to conduct high-efficient end-to-end graph learning in e-commerce search scenarios.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>The Proposed Approach</h2>
<figure class="ltx_figure" id="S3.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="477" id="S3.F1.g1" src="x1.png" width="713"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The framework of the proposed EGIN model. We use the unified input for both graph learning and CTR prediction network. Our query-item heterogeneous graph is constructed based on user behavior sequence and conducts embedding learning based on edges. We build i2i edges for every neighbor within the distance of 2 in click sequence and build q2i/q2q pairs by time and category constraints. The same behavior sequence is provided to the CTR prediction network, where multiple similarity relationships are calculated based on graph embedding.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F1.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F1.2">The framework of EGIN. Left-side shows how the graph is structured as pairs, right-side shows how features are fed into the CTR prediction model.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we introduce our Light-weight End-to-End Graph Interest Network (EGIN) in detail. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.F1" title="Figure 1 ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">1</span></a>, EGIN is composed of two parts, on the left side is the query-item heterogeneous graph, and on the right side is the multi-interest network. Notice that the two parts are jointly optimized in an end-to-end manner and share the same input extracted from search impression logs. Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.E1" title="In 3.4. End-to-End Joint Training ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">1</span></a> presents our joint training objective.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Query-item Heterogeneous Graph</h3>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="595" id="S3.F2.g1" src="x2.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Query-item heterogeneous graph structure. User behavior sequence containing query and click sequence ordered in time. First, neighboring items are connected by a window size of 2. Then queries are segmented into sessions based on their semantic similarity and happening time. Queries within the same session are all connected. Finally, every query and its nearby items within the time window that satisfy categorical constraints with the query is connected to capture item-query correlation.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F2.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F2.2">Graph structure.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In previous graph-based CTR prediction work, users’ historical behaviors are well explored to represent personal interest. In e-commerce search scenarios, queries explicitly describe interest evolution and current search intention. However, previous work mainly focuses on semantic knowledge conducted by the query, ignoring its sequential information and correlation with items.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">To jointly model signals of click sequence and query sequence extracted from user behavior, we introduce our query-item heterogeneous graph as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.F2" title="Figure 2 ‣ 3.1. Query-item Heterogeneous Graph ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">2</span></a>. With query and item as nodes, our graph architecture contains three kinds of edges: <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">item2item</span>, <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.2">query2query</span> and <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.3">query2item</span>:</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">item2item</span>. Following previous work, we utilize user click sequence to capture item2item relationship based on co-occurrence following Skip-Gram <cite class="ltx_cite ltx_citemacro_citep">(Mikolov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib13" title="">2013a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib14" title="">b</a>)</cite>. For example, in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.F2" title="Figure 2 ‣ 3.1. Query-item Heterogeneous Graph ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">2</span></a>, items are connected according to the window size. Notice that instead of splitting the click sequence into sessions by time frame or user interest, we adopt the original click sequence to learn the item2item relationship.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">User’s click sequence usually forms a list of several clusters, where items within the cluster are often similar to each other. In contrast, cross-cluster items are quite different in the category, representing the user’s interest transfer. Considering these two properties, user’s click sequence can provide information about both intro-cluster similarity and cross-cluster transfer probability.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p5.1.1">query2query</span>. We adopt users’ historical query sequences to build the query2query relationship. Query sequence is segmented into multiple sessions similar to <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib6" title="">2019</a>)</cite> based on semantic similarity and time constraint to prevent edge construction across dissimilar queries. Queries within the same session are treated as similar and are connected with each other. As in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.F2" title="Figure 2 ‣ 3.1. Query-item Heterogeneous Graph ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">2</span></a>, all queries form three sessions, and each session constructs a complete graph.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p6.1.1">query2item</span>. After capturing sequential information of item and query separately, the relationship between query and item is preserved in our graph to jointly learn their embeddings, which plays an important role in modern search systems. For each query in a user’s behavior sequence, the clicked items within a time window before or after this query are filtered by category constraints to become the relevant items. Then we connect edges between every query and its relevant items. As in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.F2" title="Figure 2 ‣ 3.1. Query-item Heterogeneous Graph ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">2</span></a>, queries and their relevant items are painted the same colors, but only relevant items are connected with corresponding queries.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Light-weight Subgraph Sampling</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">When adopting graph-based methods in CTR prediction, previous work usually constructs graphs based on global or historical information, and the whole graph is stored physically. During embedding learning, the subgraph is sampled from the whole graph to fit in the memory. We summarize them as <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.1">Construct&amp;Sample</span> paradigm. When applying these methods in industrial scenarios with billions of items and samples, updating and retrieving graphs with a short delay can be challenging, thus becoming the bottleneck of end-to-end joint training of graph embedding and CTR prediction task.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Towards a light-weight subgraph sampling method, we first consider an underlying graph representing current global user interest as <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">implicit graph</span>. Statistically, every user’s mini-graph is merged together to form the implicit graph. Previous graph construction methods based on accumulative data are gradual approximations of the implicit graph. In this article, we consider user behavior sequence or its slightly manipulated version to be a subgraph sampling of the implicit graph, thus avoiding storing and sampling the graph physically.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">The pseudo-code of the light-weight graph sampling and learning method is listed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#alg1" title="Algorithm 1 ‣ 3.2. Light-weight Subgraph Sampling ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">1</span></a>. Given users’ click sequences and query sequences from impression log data, we first build edges between items with co-occurrence according to the window size. Then query2query and query2item edges are connected using the BuildGraph method described in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#alg2" title="Algorithm 2 ‣ 3.2. Light-weight Subgraph Sampling ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">2</span></a>, explaining how two entities are related according to time and category constraints. Finally, our training objective over graph embedding is computed based on all the edges. With billions of items and queries in our dataset, we adopt Negative Sampling and softmax loss to approximately optimize the graph embedding.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{G}=-\mathrm{log}\frac{\mathrm{exp}(e_{a}\cdot e_{p})}{\mathrm{exp}(e_{a}%
\cdot e_{p})+\sum_{e_{n}\in N}\mathrm{exp}(e_{a}\cdot e_{n})}" class="ltx_Math" display="block" id="S3.Ex1.m1.3"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.4" xref="S3.Ex1.m1.3.4.cmml"><msub id="S3.Ex1.m1.3.4.2" xref="S3.Ex1.m1.3.4.2.cmml"><mi id="S3.Ex1.m1.3.4.2.2" xref="S3.Ex1.m1.3.4.2.2.cmml">L</mi><mi id="S3.Ex1.m1.3.4.2.3" xref="S3.Ex1.m1.3.4.2.3.cmml">G</mi></msub><mo id="S3.Ex1.m1.3.4.1" xref="S3.Ex1.m1.3.4.1.cmml">=</mo><mrow id="S3.Ex1.m1.3.4.3" xref="S3.Ex1.m1.3.4.3.cmml"><mo id="S3.Ex1.m1.3.4.3a" xref="S3.Ex1.m1.3.4.3.cmml">−</mo><mrow id="S3.Ex1.m1.3.4.3.2" xref="S3.Ex1.m1.3.4.3.2.cmml"><mi id="S3.Ex1.m1.3.4.3.2.2" xref="S3.Ex1.m1.3.4.3.2.2.cmml">log</mi><mo id="S3.Ex1.m1.3.4.3.2.1" xref="S3.Ex1.m1.3.4.3.2.1.cmml">⁢</mo><mfrac id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml">exp</mi><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml">e</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml">a</mi></msub><mo id="S3.Ex1.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml">e</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex1.m1.3.3.3" xref="S3.Ex1.m1.3.3.3.cmml"><mrow id="S3.Ex1.m1.2.2.2.1" xref="S3.Ex1.m1.2.2.2.1.cmml"><mi id="S3.Ex1.m1.2.2.2.1.3" xref="S3.Ex1.m1.2.2.2.1.3.cmml">exp</mi><mo id="S3.Ex1.m1.2.2.2.1.2" xref="S3.Ex1.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.2.2.2.1.1.1" xref="S3.Ex1.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.Ex1.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.2.2.2.1.1.1.1" xref="S3.Ex1.m1.2.2.2.1.1.1.1.cmml"><msub id="S3.Ex1.m1.2.2.2.1.1.1.1.2" xref="S3.Ex1.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.2.2.2.1.1.1.1.2.2" xref="S3.Ex1.m1.2.2.2.1.1.1.1.2.2.cmml">e</mi><mi id="S3.Ex1.m1.2.2.2.1.1.1.1.2.3" xref="S3.Ex1.m1.2.2.2.1.1.1.1.2.3.cmml">a</mi></msub><mo id="S3.Ex1.m1.2.2.2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.2.2.2.1.1.1.1.1.cmml">⋅</mo><msub id="S3.Ex1.m1.2.2.2.1.1.1.1.3" xref="S3.Ex1.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.2.1.1.1.1.3.2" xref="S3.Ex1.m1.2.2.2.1.1.1.1.3.2.cmml">e</mi><mi id="S3.Ex1.m1.2.2.2.1.1.1.1.3.3" xref="S3.Ex1.m1.2.2.2.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.Ex1.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.3.3.3.3" rspace="0.055em" xref="S3.Ex1.m1.3.3.3.3.cmml">+</mo><mrow id="S3.Ex1.m1.3.3.3.2" xref="S3.Ex1.m1.3.3.3.2.cmml"><msub id="S3.Ex1.m1.3.3.3.2.2" xref="S3.Ex1.m1.3.3.3.2.2.cmml"><mo id="S3.Ex1.m1.3.3.3.2.2.2" xref="S3.Ex1.m1.3.3.3.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.3.3.3.2.2.3" xref="S3.Ex1.m1.3.3.3.2.2.3.cmml"><msub id="S3.Ex1.m1.3.3.3.2.2.3.2" xref="S3.Ex1.m1.3.3.3.2.2.3.2.cmml"><mi id="S3.Ex1.m1.3.3.3.2.2.3.2.2" xref="S3.Ex1.m1.3.3.3.2.2.3.2.2.cmml">e</mi><mi id="S3.Ex1.m1.3.3.3.2.2.3.2.3" xref="S3.Ex1.m1.3.3.3.2.2.3.2.3.cmml">n</mi></msub><mo id="S3.Ex1.m1.3.3.3.2.2.3.1" xref="S3.Ex1.m1.3.3.3.2.2.3.1.cmml">∈</mo><mi id="S3.Ex1.m1.3.3.3.2.2.3.3" xref="S3.Ex1.m1.3.3.3.2.2.3.3.cmml">N</mi></mrow></msub><mrow id="S3.Ex1.m1.3.3.3.2.1" xref="S3.Ex1.m1.3.3.3.2.1.cmml"><mi id="S3.Ex1.m1.3.3.3.2.1.3" xref="S3.Ex1.m1.3.3.3.2.1.3.cmml">exp</mi><mo id="S3.Ex1.m1.3.3.3.2.1.2" xref="S3.Ex1.m1.3.3.3.2.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.3.3.3.2.1.1.1" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.cmml"><mo id="S3.Ex1.m1.3.3.3.2.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.3.3.3.2.1.1.1.1" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.cmml"><msub id="S3.Ex1.m1.3.3.3.2.1.1.1.1.2" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.2" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.2.cmml">e</mi><mi id="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.3" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.3.cmml">a</mi></msub><mo id="S3.Ex1.m1.3.3.3.2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.1.cmml">⋅</mo><msub id="S3.Ex1.m1.3.3.3.2.1.1.1.1.3" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.2" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.2.cmml">e</mi><mi id="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.3" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.3.cmml">n</mi></msub></mrow><mo id="S3.Ex1.m1.3.3.3.2.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.4.cmml" xref="S3.Ex1.m1.3.4"><eq id="S3.Ex1.m1.3.4.1.cmml" xref="S3.Ex1.m1.3.4.1"></eq><apply id="S3.Ex1.m1.3.4.2.cmml" xref="S3.Ex1.m1.3.4.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.4.2.1.cmml" xref="S3.Ex1.m1.3.4.2">subscript</csymbol><ci id="S3.Ex1.m1.3.4.2.2.cmml" xref="S3.Ex1.m1.3.4.2.2">𝐿</ci><ci id="S3.Ex1.m1.3.4.2.3.cmml" xref="S3.Ex1.m1.3.4.2.3">𝐺</ci></apply><apply id="S3.Ex1.m1.3.4.3.cmml" xref="S3.Ex1.m1.3.4.3"><minus id="S3.Ex1.m1.3.4.3.1.cmml" xref="S3.Ex1.m1.3.4.3"></minus><apply id="S3.Ex1.m1.3.4.3.2.cmml" xref="S3.Ex1.m1.3.4.3.2"><times id="S3.Ex1.m1.3.4.3.2.1.cmml" xref="S3.Ex1.m1.3.4.3.2.1"></times><ci id="S3.Ex1.m1.3.4.3.2.2.cmml" xref="S3.Ex1.m1.3.4.3.2.2">log</ci><apply id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3"><divide id="S3.Ex1.m1.3.3.4.cmml" xref="S3.Ex1.m1.3.3"></divide><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><times id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3">exp</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">⋅</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2">𝑒</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply><apply id="S3.Ex1.m1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3"><plus id="S3.Ex1.m1.3.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3"></plus><apply id="S3.Ex1.m1.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.1"><times id="S3.Ex1.m1.2.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.2.1.2"></times><ci id="S3.Ex1.m1.2.2.2.1.3.cmml" xref="S3.Ex1.m1.2.2.2.1.3">exp</ci><apply id="S3.Ex1.m1.2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1"><ci id="S3.Ex1.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.1">⋅</ci><apply id="S3.Ex1.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.2.2">𝑒</ci><ci id="S3.Ex1.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.Ex1.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.3.2">𝑒</ci><ci id="S3.Ex1.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.2.2.2.1.1.1.1.3.3">𝑝</ci></apply></apply></apply><apply id="S3.Ex1.m1.3.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2"><apply id="S3.Ex1.m1.3.3.3.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2">subscript</csymbol><sum id="S3.Ex1.m1.3.3.3.2.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.2"></sum><apply id="S3.Ex1.m1.3.3.3.2.2.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3"><in id="S3.Ex1.m1.3.3.3.2.2.3.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3.1"></in><apply id="S3.Ex1.m1.3.3.3.2.2.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.2.3.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.2.2.3.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3.2.2">𝑒</ci><ci id="S3.Ex1.m1.3.3.3.2.2.3.2.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3.2.3">𝑛</ci></apply><ci id="S3.Ex1.m1.3.3.3.2.2.3.3.cmml" xref="S3.Ex1.m1.3.3.3.2.2.3.3">𝑁</ci></apply></apply><apply id="S3.Ex1.m1.3.3.3.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2.1"><times id="S3.Ex1.m1.3.3.3.2.1.2.cmml" xref="S3.Ex1.m1.3.3.3.2.1.2"></times><ci id="S3.Ex1.m1.3.3.3.2.1.3.cmml" xref="S3.Ex1.m1.3.3.3.2.1.3">exp</ci><apply id="S3.Ex1.m1.3.3.3.2.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1"><ci id="S3.Ex1.m1.3.3.3.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.1">⋅</ci><apply id="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.2">𝑒</ci><ci id="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.2">𝑒</ci><ci id="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.3.3.3.2.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">L_{G}=-\mathrm{log}\frac{\mathrm{exp}(e_{a}\cdot e_{p})}{\mathrm{exp}(e_{a}%
\cdot e_{p})+\sum_{e_{n}\in N}\mathrm{exp}(e_{a}\cdot e_{n})}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">italic_L start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( italic_e start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ⋅ italic_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) end_ARG start_ARG roman_exp ( italic_e start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ⋅ italic_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ italic_N end_POSTSUBSCRIPT roman_exp ( italic_e start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ⋅ italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Pseudo-code of graph embedding learning</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0.1.1.1" style="font-size:80%;">0:</span></span>  User click sequence <math alttext="C" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_C</annotation></semantics></math>User query sequence <math alttext="Q" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">italic_Q</annotation></semantics></math>Window size <math alttext="w" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">w</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_w</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l0a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0a.1.1.1" style="font-size:80%;">0:</span></span>  Loss over the graph embedding

</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  Initialization: Empty edge set <math alttext="E" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_E</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.2">for</span> <math alttext="c_{j}\in C" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">c</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">∈</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><in id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></in><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝑐</ci><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝑗</ci></apply><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">c_{j}\in C</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_C</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l3.2">for</span> <math alttext="c_{k}\in C[j-w:j+w]" class="ltx_math_unparsed" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1b"><msub id="alg1.l3.m1.1.1"><mi id="alg1.l3.m1.1.1.2">c</mi><mi id="alg1.l3.m1.1.1.3">k</mi></msub><mo id="alg1.l3.m1.1.2">∈</mo><mi id="alg1.l3.m1.1.3">C</mi><mrow id="alg1.l3.m1.1.4"><mo id="alg1.l3.m1.1.4.1" stretchy="false">[</mo><mi id="alg1.l3.m1.1.4.2">j</mi><mo id="alg1.l3.m1.1.4.3">−</mo><mi id="alg1.l3.m1.1.4.4">w</mi><mo id="alg1.l3.m1.1.4.5" lspace="0.278em" rspace="0.278em">:</mo><mi id="alg1.l3.m1.1.4.6">j</mi><mo id="alg1.l3.m1.1.4.7">+</mo><mi id="alg1.l3.m1.1.4.8">w</mi><mo id="alg1.l3.m1.1.4.9" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">c_{k}\in C[j-w:j+w]</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ italic_C [ italic_j - italic_w : italic_j + italic_w ]</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>        <math alttext="E=E\cup\{(c_{j},c_{k}),(c_{k},c_{j})\}" class="ltx_Math" display="inline" id="alg1.l4.m1.2"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml"><mi id="alg1.l4.m1.2.2.4" xref="alg1.l4.m1.2.2.4.cmml">E</mi><mo id="alg1.l4.m1.2.2.3" xref="alg1.l4.m1.2.2.3.cmml">=</mo><mrow id="alg1.l4.m1.2.2.2" xref="alg1.l4.m1.2.2.2.cmml"><mi id="alg1.l4.m1.2.2.2.4" xref="alg1.l4.m1.2.2.2.4.cmml">E</mi><mo id="alg1.l4.m1.2.2.2.3" xref="alg1.l4.m1.2.2.2.3.cmml">∪</mo><mrow id="alg1.l4.m1.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.3.cmml"><mo id="alg1.l4.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l4.m1.2.2.2.2.3.cmml">{</mo><mrow id="alg1.l4.m1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l4.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l4.m1.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l4.m1.1.1.1.1.1.1.2.4" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l4.m1.1.1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l4.m1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msub><mo id="alg1.l4.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l4.m1.2.2.2.2.2.4" xref="alg1.l4.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg1.l4.m1.2.2.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.2.3.cmml"><mo id="alg1.l4.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="alg1.l4.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="alg1.l4.m1.2.2.2.2.2.2.1.1" xref="alg1.l4.m1.2.2.2.2.2.2.1.1.cmml"><mi id="alg1.l4.m1.2.2.2.2.2.2.1.1.2" xref="alg1.l4.m1.2.2.2.2.2.2.1.1.2.cmml">c</mi><mi id="alg1.l4.m1.2.2.2.2.2.2.1.1.3" xref="alg1.l4.m1.2.2.2.2.2.2.1.1.3.cmml">k</mi></msub><mo id="alg1.l4.m1.2.2.2.2.2.2.2.4" xref="alg1.l4.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.l4.m1.2.2.2.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.2.2.2.cmml"><mi id="alg1.l4.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.2.2.2.2.cmml">c</mi><mi id="alg1.l4.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l4.m1.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="alg1.l4.m1.2.2.2.2.2.2.2.5" stretchy="false" xref="alg1.l4.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow><mo id="alg1.l4.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l4.m1.2.2.2.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2"><eq id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.3"></eq><ci id="alg1.l4.m1.2.2.4.cmml" xref="alg1.l4.m1.2.2.4">𝐸</ci><apply id="alg1.l4.m1.2.2.2.cmml" xref="alg1.l4.m1.2.2.2"><union id="alg1.l4.m1.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.3"></union><ci id="alg1.l4.m1.2.2.2.4.cmml" xref="alg1.l4.m1.2.2.2.4">𝐸</ci><set id="alg1.l4.m1.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.2"><interval closure="open" id="alg1.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2"><apply id="alg1.l4.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l4.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval><interval closure="open" id="alg1.l4.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.2"><apply id="alg1.l4.m1.2.2.2.2.2.2.1.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.2.2.2.2.1.1.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="alg1.l4.m1.2.2.2.2.2.2.1.1.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.1.1.2">𝑐</ci><ci id="alg1.l4.m1.2.2.2.2.2.2.1.1.3.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.1.1.3">𝑘</ci></apply><apply id="alg1.l4.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.2.2.2">𝑐</ci><ci id="alg1.l4.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">E=E\cup\{(c_{j},c_{k}),(c_{k},c_{j})\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.2d">italic_E = italic_E ∪ { ( italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) , ( italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l5.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l5.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l6.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l6.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>  <math alttext="E=E\cup\mathrm{BuildEdge}(Q,Q)\cup\mathrm{BuildEdge}(Q,C)" class="ltx_Math" display="inline" id="alg1.l7.m1.4"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4.5" xref="alg1.l7.m1.4.5.cmml"><mi id="alg1.l7.m1.4.5.2" xref="alg1.l7.m1.4.5.2.cmml">E</mi><mo id="alg1.l7.m1.4.5.1" xref="alg1.l7.m1.4.5.1.cmml">=</mo><mrow id="alg1.l7.m1.4.5.3" xref="alg1.l7.m1.4.5.3.cmml"><mi id="alg1.l7.m1.4.5.3.2" xref="alg1.l7.m1.4.5.3.2.cmml">E</mi><mo id="alg1.l7.m1.4.5.3.1" xref="alg1.l7.m1.4.5.3.1.cmml">∪</mo><mrow id="alg1.l7.m1.4.5.3.3" xref="alg1.l7.m1.4.5.3.3.cmml"><mi id="alg1.l7.m1.4.5.3.3.2" xref="alg1.l7.m1.4.5.3.3.2.cmml">BuildEdge</mi><mo id="alg1.l7.m1.4.5.3.3.1" xref="alg1.l7.m1.4.5.3.3.1.cmml">⁢</mo><mrow id="alg1.l7.m1.4.5.3.3.3.2" xref="alg1.l7.m1.4.5.3.3.3.1.cmml"><mo id="alg1.l7.m1.4.5.3.3.3.2.1" stretchy="false" xref="alg1.l7.m1.4.5.3.3.3.1.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">Q</mi><mo id="alg1.l7.m1.4.5.3.3.3.2.2" xref="alg1.l7.m1.4.5.3.3.3.1.cmml">,</mo><mi id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">Q</mi><mo id="alg1.l7.m1.4.5.3.3.3.2.3" stretchy="false" xref="alg1.l7.m1.4.5.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.4.5.3.1a" xref="alg1.l7.m1.4.5.3.1.cmml">∪</mo><mrow id="alg1.l7.m1.4.5.3.4" xref="alg1.l7.m1.4.5.3.4.cmml"><mi id="alg1.l7.m1.4.5.3.4.2" xref="alg1.l7.m1.4.5.3.4.2.cmml">BuildEdge</mi><mo id="alg1.l7.m1.4.5.3.4.1" xref="alg1.l7.m1.4.5.3.4.1.cmml">⁢</mo><mrow id="alg1.l7.m1.4.5.3.4.3.2" xref="alg1.l7.m1.4.5.3.4.3.1.cmml"><mo id="alg1.l7.m1.4.5.3.4.3.2.1" stretchy="false" xref="alg1.l7.m1.4.5.3.4.3.1.cmml">(</mo><mi id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">Q</mi><mo id="alg1.l7.m1.4.5.3.4.3.2.2" xref="alg1.l7.m1.4.5.3.4.3.1.cmml">,</mo><mi id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml">C</mi><mo id="alg1.l7.m1.4.5.3.4.3.2.3" stretchy="false" xref="alg1.l7.m1.4.5.3.4.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.4b"><apply id="alg1.l7.m1.4.5.cmml" xref="alg1.l7.m1.4.5"><eq id="alg1.l7.m1.4.5.1.cmml" xref="alg1.l7.m1.4.5.1"></eq><ci id="alg1.l7.m1.4.5.2.cmml" xref="alg1.l7.m1.4.5.2">𝐸</ci><apply id="alg1.l7.m1.4.5.3.cmml" xref="alg1.l7.m1.4.5.3"><union id="alg1.l7.m1.4.5.3.1.cmml" xref="alg1.l7.m1.4.5.3.1"></union><ci id="alg1.l7.m1.4.5.3.2.cmml" xref="alg1.l7.m1.4.5.3.2">𝐸</ci><apply id="alg1.l7.m1.4.5.3.3.cmml" xref="alg1.l7.m1.4.5.3.3"><times id="alg1.l7.m1.4.5.3.3.1.cmml" xref="alg1.l7.m1.4.5.3.3.1"></times><ci id="alg1.l7.m1.4.5.3.3.2.cmml" xref="alg1.l7.m1.4.5.3.3.2">BuildEdge</ci><interval closure="open" id="alg1.l7.m1.4.5.3.3.3.1.cmml" xref="alg1.l7.m1.4.5.3.3.3.2"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑄</ci><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">𝑄</ci></interval></apply><apply id="alg1.l7.m1.4.5.3.4.cmml" xref="alg1.l7.m1.4.5.3.4"><times id="alg1.l7.m1.4.5.3.4.1.cmml" xref="alg1.l7.m1.4.5.3.4.1"></times><ci id="alg1.l7.m1.4.5.3.4.2.cmml" xref="alg1.l7.m1.4.5.3.4.2">BuildEdge</ci><interval closure="open" id="alg1.l7.m1.4.5.3.4.3.1.cmml" xref="alg1.l7.m1.4.5.3.4.3.2"><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">𝑄</ci><ci id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4">𝐶</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">E=E\cup\mathrm{BuildEdge}(Q,Q)\cup\mathrm{BuildEdge}(Q,C)</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.4d">italic_E = italic_E ∪ roman_BuildEdge ( italic_Q , italic_Q ) ∪ roman_BuildEdge ( italic_Q , italic_C )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l8.2">for</span> <math alttext="edge" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">e</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">d</mi><mo id="alg1.l8.m1.1.1.1a" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.4" xref="alg1.l8.m1.1.1.4.cmml">g</mi><mo id="alg1.l8.m1.1.1.1b" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.5" xref="alg1.l8.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><times id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></times><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑒</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑑</ci><ci id="alg1.l8.m1.1.1.4.cmml" xref="alg1.l8.m1.1.1.4">𝑔</ci><ci id="alg1.l8.m1.1.1.5.cmml" xref="alg1.l8.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">edge</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_e italic_d italic_g italic_e</annotation></semantics></math> in <math alttext="E" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_E</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>     <math alttext="(p_{1},p_{2})" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.3.cmml"><mo id="alg1.l9.m1.2.2.2.3" stretchy="false" xref="alg1.l9.m1.2.2.3.cmml">(</mo><msub id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.2.cmml">p</mi><mn id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.3.cmml">,</mo><msub id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.cmml">p</mi><mn id="alg1.l9.m1.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.3.cmml">2</mn></msub><mo id="alg1.l9.m1.2.2.2.5" stretchy="false" xref="alg1.l9.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><interval closure="open" id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.2">𝑝</ci><cn id="alg1.l9.m1.1.1.1.1.3.cmml" type="integer" xref="alg1.l9.m1.1.1.1.1.3">1</cn></apply><apply id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2">𝑝</ci><cn id="alg1.l9.m1.2.2.2.2.3.cmml" type="integer" xref="alg1.l9.m1.2.2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">(p_{1},p_{2})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">( italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> = <math alttext="edge" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">e</mi><mo id="alg1.l9.m2.1.1.1" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">d</mi><mo id="alg1.l9.m2.1.1.1a" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.4" xref="alg1.l9.m2.1.1.4.cmml">g</mi><mo id="alg1.l9.m2.1.1.1b" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.5" xref="alg1.l9.m2.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><times id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1.1"></times><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑒</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑑</ci><ci id="alg1.l9.m2.1.1.4.cmml" xref="alg1.l9.m2.1.1.4">𝑔</ci><ci id="alg1.l9.m2.1.1.5.cmml" xref="alg1.l9.m2.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">edge</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_e italic_d italic_g italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>     <math alttext="N=\mathrm{NegSample}(\mathrm{typeof}(p_{2}))" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">N</mi><mo id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">=</mo><mrow id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.3" xref="alg1.l10.m1.1.1.1.3.cmml">NegSample</mi><mo id="alg1.l10.m1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l10.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">typeof</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l10.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mn id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="alg1.l10.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l10.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"></eq><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑁</ci><apply id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"><times id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.2"></times><ci id="alg1.l10.m1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.3">NegSample</ci><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><times id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2"></times><ci id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3">typeof</ci><apply id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><cn id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">N=\mathrm{NegSample}(\mathrm{typeof}(p_{2}))</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_N = roman_NegSample ( roman_typeof ( italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>     <math alttext="L_{G}=\mathrm{SoftmaxLoss}(p_{1},p_{2},N)" class="ltx_Math" display="inline" id="alg1.l11.m1.3"><semantics id="alg1.l11.m1.3a"><mrow id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml"><msub id="alg1.l11.m1.3.3.4" xref="alg1.l11.m1.3.3.4.cmml"><mi id="alg1.l11.m1.3.3.4.2" xref="alg1.l11.m1.3.3.4.2.cmml">L</mi><mi id="alg1.l11.m1.3.3.4.3" xref="alg1.l11.m1.3.3.4.3.cmml">G</mi></msub><mo id="alg1.l11.m1.3.3.3" xref="alg1.l11.m1.3.3.3.cmml">=</mo><mrow id="alg1.l11.m1.3.3.2" xref="alg1.l11.m1.3.3.2.cmml"><mi id="alg1.l11.m1.3.3.2.4" xref="alg1.l11.m1.3.3.2.4.cmml">SoftmaxLoss</mi><mo id="alg1.l11.m1.3.3.2.3" xref="alg1.l11.m1.3.3.2.3.cmml">⁢</mo><mrow id="alg1.l11.m1.3.3.2.2.2" xref="alg1.l11.m1.3.3.2.2.3.cmml"><mo id="alg1.l11.m1.3.3.2.2.2.3" stretchy="false" xref="alg1.l11.m1.3.3.2.2.3.cmml">(</mo><msub id="alg1.l11.m1.2.2.1.1.1.1" xref="alg1.l11.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l11.m1.2.2.1.1.1.1.2" xref="alg1.l11.m1.2.2.1.1.1.1.2.cmml">p</mi><mn id="alg1.l11.m1.2.2.1.1.1.1.3" xref="alg1.l11.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l11.m1.3.3.2.2.2.4" xref="alg1.l11.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l11.m1.3.3.2.2.2.2" xref="alg1.l11.m1.3.3.2.2.2.2.cmml"><mi id="alg1.l11.m1.3.3.2.2.2.2.2" xref="alg1.l11.m1.3.3.2.2.2.2.2.cmml">p</mi><mn id="alg1.l11.m1.3.3.2.2.2.2.3" xref="alg1.l11.m1.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="alg1.l11.m1.3.3.2.2.2.5" xref="alg1.l11.m1.3.3.2.2.3.cmml">,</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">N</mi><mo id="alg1.l11.m1.3.3.2.2.2.6" stretchy="false" xref="alg1.l11.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.3b"><apply id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3"><eq id="alg1.l11.m1.3.3.3.cmml" xref="alg1.l11.m1.3.3.3"></eq><apply id="alg1.l11.m1.3.3.4.cmml" xref="alg1.l11.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.4.1.cmml" xref="alg1.l11.m1.3.3.4">subscript</csymbol><ci id="alg1.l11.m1.3.3.4.2.cmml" xref="alg1.l11.m1.3.3.4.2">𝐿</ci><ci id="alg1.l11.m1.3.3.4.3.cmml" xref="alg1.l11.m1.3.3.4.3">𝐺</ci></apply><apply id="alg1.l11.m1.3.3.2.cmml" xref="alg1.l11.m1.3.3.2"><times id="alg1.l11.m1.3.3.2.3.cmml" xref="alg1.l11.m1.3.3.2.3"></times><ci id="alg1.l11.m1.3.3.2.4.cmml" xref="alg1.l11.m1.3.3.2.4">SoftmaxLoss</ci><vector id="alg1.l11.m1.3.3.2.2.3.cmml" xref="alg1.l11.m1.3.3.2.2.2"><apply id="alg1.l11.m1.2.2.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l11.m1.2.2.1.1.1.1.2">𝑝</ci><cn id="alg1.l11.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l11.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="alg1.l11.m1.3.3.2.2.2.2.cmml" xref="alg1.l11.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l11.m1.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l11.m1.3.3.2.2.2.2.2">𝑝</ci><cn id="alg1.l11.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="alg1.l11.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑁</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.3c">L_{G}=\mathrm{SoftmaxLoss}(p_{1},p_{2},N)</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.3d">italic_L start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT = roman_SoftmaxLoss ( italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_N )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l12.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.3">for</span>
</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Pseudo-code of BuildEdge</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l0.1.1.1" style="font-size:80%;">0:</span></span>  User click/query sequence <math alttext="S_{1}" class="ltx_Math" display="inline" id="alg2.l0.m1.1"><semantics id="alg2.l0.m1.1a"><msub id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml"><mi id="alg2.l0.m1.1.1.2" xref="alg2.l0.m1.1.1.2.cmml">S</mi><mn id="alg2.l0.m1.1.1.3" xref="alg2.l0.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><apply id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1"><csymbol cd="ambiguous" id="alg2.l0.m1.1.1.1.cmml" xref="alg2.l0.m1.1.1">subscript</csymbol><ci id="alg2.l0.m1.1.1.2.cmml" xref="alg2.l0.m1.1.1.2">𝑆</ci><cn id="alg2.l0.m1.1.1.3.cmml" type="integer" xref="alg2.l0.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">S_{1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m1.1d">italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="S_{2}" class="ltx_Math" display="inline" id="alg2.l0.m2.1"><semantics id="alg2.l0.m2.1a"><msub id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml"><mi id="alg2.l0.m2.1.1.2" xref="alg2.l0.m2.1.1.2.cmml">S</mi><mn id="alg2.l0.m2.1.1.3" xref="alg2.l0.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><apply id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1"><csymbol cd="ambiguous" id="alg2.l0.m2.1.1.1.cmml" xref="alg2.l0.m2.1.1">subscript</csymbol><ci id="alg2.l0.m2.1.1.2.cmml" xref="alg2.l0.m2.1.1.2">𝑆</ci><cn id="alg2.l0.m2.1.1.3.cmml" type="integer" xref="alg2.l0.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">S_{2}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m2.1d">italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>Time mapping <math alttext="\mathrm{TIME}()" class="ltx_Math" display="inline" id="alg2.l0.m3.1"><semantics id="alg2.l0.m3.1a"><mrow id="alg2.l0.m3.1.1" xref="alg2.l0.m3.1.1.cmml"><mi id="alg2.l0.m3.1.1.2" xref="alg2.l0.m3.1.1.2.cmml">TIME</mi><mo id="alg2.l0.m3.1.1.1" xref="alg2.l0.m3.1.1.1.cmml">⁢</mo><mrow id="alg2.l0.m3.1.1.3.2" xref="alg2.l0.m3.1.1.cmml"><mo id="alg2.l0.m3.1.1.3.2.1" stretchy="false" xref="alg2.l0.m3.1.1.3.1.cmml">(</mo><mo id="alg2.l0.m3.1.1.3.2.2" stretchy="false" xref="alg2.l0.m3.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.1b"><apply id="alg2.l0.m3.1.1.cmml" xref="alg2.l0.m3.1.1"><times id="alg2.l0.m3.1.1.1.cmml" xref="alg2.l0.m3.1.1.1"></times><ci id="alg2.l0.m3.1.1.2.cmml" xref="alg2.l0.m3.1.1.2">TIME</ci><list id="alg2.l0.m3.1.1.3.1.cmml" xref="alg2.l0.m3.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.1c">\mathrm{TIME}()</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m3.1d">roman_TIME ( )</annotation></semantics></math>Category mapping <math alttext="\mathrm{CAT}()" class="ltx_Math" display="inline" id="alg2.l0.m4.1"><semantics id="alg2.l0.m4.1a"><mrow id="alg2.l0.m4.1.1" xref="alg2.l0.m4.1.1.cmml"><mi id="alg2.l0.m4.1.1.2" xref="alg2.l0.m4.1.1.2.cmml">CAT</mi><mo id="alg2.l0.m4.1.1.1" xref="alg2.l0.m4.1.1.1.cmml">⁢</mo><mrow id="alg2.l0.m4.1.1.3.2" xref="alg2.l0.m4.1.1.cmml"><mo id="alg2.l0.m4.1.1.3.2.1" stretchy="false" xref="alg2.l0.m4.1.1.3.1.cmml">(</mo><mo id="alg2.l0.m4.1.1.3.2.2" stretchy="false" xref="alg2.l0.m4.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m4.1b"><apply id="alg2.l0.m4.1.1.cmml" xref="alg2.l0.m4.1.1"><times id="alg2.l0.m4.1.1.1.cmml" xref="alg2.l0.m4.1.1.1"></times><ci id="alg2.l0.m4.1.1.2.cmml" xref="alg2.l0.m4.1.1.2">CAT</ci><list id="alg2.l0.m4.1.1.3.1.cmml" xref="alg2.l0.m4.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m4.1c">\mathrm{CAT}()</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m4.1d">roman_CAT ( )</annotation></semantics></math>timespan <math alttext="T" class="ltx_Math" display="inline" id="alg2.l0.m5.1"><semantics id="alg2.l0.m5.1a"><mi id="alg2.l0.m5.1.1" xref="alg2.l0.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m5.1b"><ci id="alg2.l0.m5.1.1.cmml" xref="alg2.l0.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m5.1d">italic_T</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l0a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l0a.1.1.1" style="font-size:80%;">0:</span></span>  Built Edges <math alttext="E" class="ltx_Math" display="inline" id="alg2.l0a.m1.1"><semantics id="alg2.l0a.m1.1a"><mi id="alg2.l0a.m1.1.1" xref="alg2.l0a.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l0a.m1.1b"><ci id="alg2.l0a.m1.1.1.cmml" xref="alg2.l0a.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0a.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg2.l0a.m1.1d">italic_E</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span>  Initialization: Empty edge set <math alttext="E" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_E</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l2.2">for</span> <math alttext="i_{1}\in S_{1}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><msub id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml"><mi id="alg2.l2.m1.1.1.2.2" xref="alg2.l2.m1.1.1.2.2.cmml">i</mi><mn id="alg2.l2.m1.1.1.2.3" xref="alg2.l2.m1.1.1.2.3.cmml">1</mn></msub><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">∈</mo><msub id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">S</mi><mn id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><in id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></in><apply id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.2.1.cmml" xref="alg2.l2.m1.1.1.2">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.2.cmml" xref="alg2.l2.m1.1.1.2.2">𝑖</ci><cn id="alg2.l2.m1.1.1.2.3.cmml" type="integer" xref="alg2.l2.m1.1.1.2.3">1</cn></apply><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3">subscript</csymbol><ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">𝑆</ci><cn id="alg2.l2.m1.1.1.3.3.cmml" type="integer" xref="alg2.l2.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">i_{1}\in S_{1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l2.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l3.2">for</span> <math alttext="i_{2}\in S_{2}" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><msub id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">i</mi><mn id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">2</mn></msub><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">∈</mo><msub id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml">S</mi><mn id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><in id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></in><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝑖</ci><cn id="alg2.l3.m1.1.1.2.3.cmml" type="integer" xref="alg2.l3.m1.1.1.2.3">2</cn></apply><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3">subscript</csymbol><ci id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.2">𝑆</ci><cn id="alg2.l3.m1.1.1.3.3.cmml" type="integer" xref="alg2.l3.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">i_{2}\in S_{2}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l3.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span>        <span class="ltx_text ltx_font_bold" id="alg2.l4.2">if</span>  <math alttext="0&lt;\mathrm{TIME}(i_{2})-\mathrm{TIME}(i_{1})&lt;T" class="ltx_Math" display="inline" id="alg2.l4.m1.2"><semantics id="alg2.l4.m1.2a"><mrow id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml"><mn id="alg2.l4.m1.2.2.4" xref="alg2.l4.m1.2.2.4.cmml">0</mn><mo id="alg2.l4.m1.2.2.5" xref="alg2.l4.m1.2.2.5.cmml">&lt;</mo><mrow id="alg2.l4.m1.2.2.2" xref="alg2.l4.m1.2.2.2.cmml"><mrow id="alg2.l4.m1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.3.cmml">TIME</mi><mo id="alg2.l4.m1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l4.m1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l4.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l4.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l4.m1.1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mn id="alg2.l4.m1.1.1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="alg2.l4.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l4.m1.2.2.2.3" xref="alg2.l4.m1.2.2.2.3.cmml">−</mo><mrow id="alg2.l4.m1.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.cmml"><mi id="alg2.l4.m1.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.3.cmml">TIME</mi><mo id="alg2.l4.m1.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="alg2.l4.m1.2.2.2.2.1.1" xref="alg2.l4.m1.2.2.2.2.1.1.1.cmml"><mo id="alg2.l4.m1.2.2.2.2.1.1.2" stretchy="false" xref="alg2.l4.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="alg2.l4.m1.2.2.2.2.1.1.1" xref="alg2.l4.m1.2.2.2.2.1.1.1.cmml"><mi id="alg2.l4.m1.2.2.2.2.1.1.1.2" xref="alg2.l4.m1.2.2.2.2.1.1.1.2.cmml">i</mi><mn id="alg2.l4.m1.2.2.2.2.1.1.1.3" xref="alg2.l4.m1.2.2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l4.m1.2.2.2.2.1.1.3" stretchy="false" xref="alg2.l4.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l4.m1.2.2.6" xref="alg2.l4.m1.2.2.6.cmml">&lt;</mo><mi id="alg2.l4.m1.2.2.7" xref="alg2.l4.m1.2.2.7.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.2b"><apply id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2"><and id="alg2.l4.m1.2.2a.cmml" xref="alg2.l4.m1.2.2"></and><apply id="alg2.l4.m1.2.2b.cmml" xref="alg2.l4.m1.2.2"><lt id="alg2.l4.m1.2.2.5.cmml" xref="alg2.l4.m1.2.2.5"></lt><cn id="alg2.l4.m1.2.2.4.cmml" type="integer" xref="alg2.l4.m1.2.2.4">0</cn><apply id="alg2.l4.m1.2.2.2.cmml" xref="alg2.l4.m1.2.2.2"><minus id="alg2.l4.m1.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.3"></minus><apply id="alg2.l4.m1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1"><times id="alg2.l4.m1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.2"></times><ci id="alg2.l4.m1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.3">TIME</ci><apply id="alg2.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.1.2">𝑖</ci><cn id="alg2.l4.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l4.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply><apply id="alg2.l4.m1.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2"><times id="alg2.l4.m1.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2"></times><ci id="alg2.l4.m1.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.3">TIME</ci><apply id="alg2.l4.m1.2.2.2.2.1.1.1.cmml" xref="alg2.l4.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.2.2.1.1.1.1.cmml" xref="alg2.l4.m1.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l4.m1.2.2.2.2.1.1.1.2.cmml" xref="alg2.l4.m1.2.2.2.2.1.1.1.2">𝑖</ci><cn id="alg2.l4.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="alg2.l4.m1.2.2.2.2.1.1.1.3">1</cn></apply></apply></apply></apply><apply id="alg2.l4.m1.2.2c.cmml" xref="alg2.l4.m1.2.2"><lt id="alg2.l4.m1.2.2.6.cmml" xref="alg2.l4.m1.2.2.6"></lt><share href="https://arxiv.org/html/2406.17745v3#alg2.l4.m1.2.2.2.cmml" id="alg2.l4.m1.2.2d.cmml" xref="alg2.l4.m1.2.2"></share><ci id="alg2.l4.m1.2.2.7.cmml" xref="alg2.l4.m1.2.2.7">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.2c">0&lt;\mathrm{TIME}(i_{2})-\mathrm{TIME}(i_{1})&lt;T</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.2d">0 &lt; roman_TIME ( italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) - roman_TIME ( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) &lt; italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l4.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span>           <span class="ltx_text ltx_font_bold" id="alg2.l5.2">if</span> <math alttext="\mathrm{CAT}(i_{1})\cap\mathrm{CAT}(i_{1})\neq\phi" class="ltx_Math" display="inline" id="alg2.l5.m1.2"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml"><mrow id="alg2.l5.m1.2.2.2" xref="alg2.l5.m1.2.2.2.cmml"><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.3.cmml">CAT</mi><mo id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l5.m1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l5.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l5.m1.1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mn id="alg2.l5.m1.1.1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l5.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l5.m1.2.2.2.3" xref="alg2.l5.m1.2.2.2.3.cmml">∩</mo><mrow id="alg2.l5.m1.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.cmml"><mi id="alg2.l5.m1.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.3.cmml">CAT</mi><mo id="alg2.l5.m1.2.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="alg2.l5.m1.2.2.2.2.1.1" xref="alg2.l5.m1.2.2.2.2.1.1.1.cmml"><mo id="alg2.l5.m1.2.2.2.2.1.1.2" stretchy="false" xref="alg2.l5.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="alg2.l5.m1.2.2.2.2.1.1.1" xref="alg2.l5.m1.2.2.2.2.1.1.1.cmml"><mi id="alg2.l5.m1.2.2.2.2.1.1.1.2" xref="alg2.l5.m1.2.2.2.2.1.1.1.2.cmml">i</mi><mn id="alg2.l5.m1.2.2.2.2.1.1.1.3" xref="alg2.l5.m1.2.2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l5.m1.2.2.2.2.1.1.3" stretchy="false" xref="alg2.l5.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l5.m1.2.2.3" xref="alg2.l5.m1.2.2.3.cmml">≠</mo><mi id="alg2.l5.m1.2.2.4" xref="alg2.l5.m1.2.2.4.cmml">ϕ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2"><neq id="alg2.l5.m1.2.2.3.cmml" xref="alg2.l5.m1.2.2.3"></neq><apply id="alg2.l5.m1.2.2.2.cmml" xref="alg2.l5.m1.2.2.2"><intersect id="alg2.l5.m1.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.3"></intersect><apply id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1"><times id="alg2.l5.m1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.2"></times><ci id="alg2.l5.m1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.3">CAT</ci><apply id="alg2.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2">𝑖</ci><cn id="alg2.l5.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l5.m1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg2.l5.m1.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2"><times id="alg2.l5.m1.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2"></times><ci id="alg2.l5.m1.2.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.3">CAT</ci><apply id="alg2.l5.m1.2.2.2.2.1.1.1.cmml" xref="alg2.l5.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.2.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l5.m1.2.2.2.2.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.2.2.1.1.1.2">𝑖</ci><cn id="alg2.l5.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="alg2.l5.m1.2.2.2.2.1.1.1.3">1</cn></apply></apply></apply><ci id="alg2.l5.m1.2.2.4.cmml" xref="alg2.l5.m1.2.2.4">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">\mathrm{CAT}(i_{1})\cap\mathrm{CAT}(i_{1})\neq\phi</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.2d">roman_CAT ( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ∩ roman_CAT ( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ≠ italic_ϕ</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l5.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>              <math alttext="E=E\cup\{(i_{1},i_{2}),(i_{2},i_{1})\}" class="ltx_Math" display="inline" id="alg2.l6.m1.2"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml"><mi id="alg2.l6.m1.2.2.4" xref="alg2.l6.m1.2.2.4.cmml">E</mi><mo id="alg2.l6.m1.2.2.3" xref="alg2.l6.m1.2.2.3.cmml">=</mo><mrow id="alg2.l6.m1.2.2.2" xref="alg2.l6.m1.2.2.2.cmml"><mi id="alg2.l6.m1.2.2.2.4" xref="alg2.l6.m1.2.2.2.4.cmml">E</mi><mo id="alg2.l6.m1.2.2.2.3" xref="alg2.l6.m1.2.2.2.3.cmml">∪</mo><mrow id="alg2.l6.m1.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.3.cmml"><mo id="alg2.l6.m1.2.2.2.2.2.3" stretchy="false" xref="alg2.l6.m1.2.2.2.2.3.cmml">{</mo><mrow id="alg2.l6.m1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.3.cmml"><mo id="alg2.l6.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="alg2.l6.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg2.l6.m1.1.1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mn id="alg2.l6.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l6.m1.1.1.1.1.1.1.2.4" xref="alg2.l6.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg2.l6.m1.1.1.1.1.1.1.2.2" xref="alg2.l6.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.2.2.2" xref="alg2.l6.m1.1.1.1.1.1.1.2.2.2.cmml">i</mi><mn id="alg2.l6.m1.1.1.1.1.1.1.2.2.3" xref="alg2.l6.m1.1.1.1.1.1.1.2.2.3.cmml">2</mn></msub><mo id="alg2.l6.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="alg2.l6.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg2.l6.m1.2.2.2.2.2.4" xref="alg2.l6.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg2.l6.m1.2.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.3.cmml"><mo id="alg2.l6.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="alg2.l6.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="alg2.l6.m1.2.2.2.2.2.2.1.1" xref="alg2.l6.m1.2.2.2.2.2.2.1.1.cmml"><mi id="alg2.l6.m1.2.2.2.2.2.2.1.1.2" xref="alg2.l6.m1.2.2.2.2.2.2.1.1.2.cmml">i</mi><mn id="alg2.l6.m1.2.2.2.2.2.2.1.1.3" xref="alg2.l6.m1.2.2.2.2.2.2.1.1.3.cmml">2</mn></msub><mo id="alg2.l6.m1.2.2.2.2.2.2.2.4" xref="alg2.l6.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="alg2.l6.m1.2.2.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.2.2.cmml"><mi id="alg2.l6.m1.2.2.2.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.2.2.2.cmml">i</mi><mn id="alg2.l6.m1.2.2.2.2.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.2.2.2.2.3.cmml">1</mn></msub><mo id="alg2.l6.m1.2.2.2.2.2.2.2.5" stretchy="false" xref="alg2.l6.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow><mo id="alg2.l6.m1.2.2.2.2.2.5" stretchy="false" xref="alg2.l6.m1.2.2.2.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><apply id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2"><eq id="alg2.l6.m1.2.2.3.cmml" xref="alg2.l6.m1.2.2.3"></eq><ci id="alg2.l6.m1.2.2.4.cmml" xref="alg2.l6.m1.2.2.4">𝐸</ci><apply id="alg2.l6.m1.2.2.2.cmml" xref="alg2.l6.m1.2.2.2"><union id="alg2.l6.m1.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.3"></union><ci id="alg2.l6.m1.2.2.2.4.cmml" xref="alg2.l6.m1.2.2.2.4">𝐸</ci><set id="alg2.l6.m1.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2"><interval closure="open" id="alg2.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2"><apply id="alg2.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn id="alg2.l6.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg2.l6.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2.2.2">𝑖</ci><cn id="alg2.l6.m1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="alg2.l6.m1.1.1.1.1.1.1.2.2.3">2</cn></apply></interval><interval closure="open" id="alg2.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.2"><apply id="alg2.l6.m1.2.2.2.2.2.2.1.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.2.2.2.1.1.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l6.m1.2.2.2.2.2.2.1.1.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.1.1.2">𝑖</ci><cn id="alg2.l6.m1.2.2.2.2.2.2.1.1.3.cmml" type="integer" xref="alg2.l6.m1.2.2.2.2.2.2.1.1.3">2</cn></apply><apply id="alg2.l6.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l6.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.2.2.2">𝑖</ci><cn id="alg2.l6.m1.2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="alg2.l6.m1.2.2.2.2.2.2.2.2.3">1</cn></apply></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">E=E\cup\{(i_{1},i_{2}),(i_{2},i_{1})\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.2d">italic_E = italic_E ∪ { ( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , ( italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>           <span class="ltx_text ltx_font_bold" id="alg2.l7.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l7.3">if</span>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span>        <span class="ltx_text ltx_font_bold" id="alg2.l8.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l8.3">if</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l9.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l9.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l10.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l10.3">for</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.7">Here <math alttext="e_{a}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">e</mi><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝑒</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">e_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> means anchor, <math alttext="e_{p}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">e</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑒</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">e_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> means positive sample, and <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_N</annotation></semantics></math> represents negative samples. Graph learning loss <math alttext="L_{G}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">L</mi><mi id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝐿</ci><ci id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">L_{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">italic_L start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> can be split into <math alttext="L_{i2i}" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><msub id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">L</mi><mrow id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml"><mi id="S3.SS2.p4.5.m5.1.1.3.2" xref="S3.SS2.p4.5.m5.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p4.5.m5.1.1.3.1" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">⁢</mo><mn id="S3.SS2.p4.5.m5.1.1.3.3" xref="S3.SS2.p4.5.m5.1.1.3.3.cmml">2</mn><mo id="S3.SS2.p4.5.m5.1.1.3.1a" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.5.m5.1.1.3.4" xref="S3.SS2.p4.5.m5.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2">𝐿</ci><apply id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3"><times id="S3.SS2.p4.5.m5.1.1.3.1.cmml" xref="S3.SS2.p4.5.m5.1.1.3.1"></times><ci id="S3.SS2.p4.5.m5.1.1.3.2.cmml" xref="S3.SS2.p4.5.m5.1.1.3.2">𝑖</ci><cn id="S3.SS2.p4.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS2.p4.5.m5.1.1.3.3">2</cn><ci id="S3.SS2.p4.5.m5.1.1.3.4.cmml" xref="S3.SS2.p4.5.m5.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">L_{i2i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_L start_POSTSUBSCRIPT italic_i 2 italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="L_{q2q}" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><msub id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">L</mi><mrow id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml"><mi id="S3.SS2.p4.6.m6.1.1.3.2" xref="S3.SS2.p4.6.m6.1.1.3.2.cmml">q</mi><mo id="S3.SS2.p4.6.m6.1.1.3.1" xref="S3.SS2.p4.6.m6.1.1.3.1.cmml">⁢</mo><mn id="S3.SS2.p4.6.m6.1.1.3.3" xref="S3.SS2.p4.6.m6.1.1.3.3.cmml">2</mn><mo id="S3.SS2.p4.6.m6.1.1.3.1a" xref="S3.SS2.p4.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.6.m6.1.1.3.4" xref="S3.SS2.p4.6.m6.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝐿</ci><apply id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3"><times id="S3.SS2.p4.6.m6.1.1.3.1.cmml" xref="S3.SS2.p4.6.m6.1.1.3.1"></times><ci id="S3.SS2.p4.6.m6.1.1.3.2.cmml" xref="S3.SS2.p4.6.m6.1.1.3.2">𝑞</ci><cn id="S3.SS2.p4.6.m6.1.1.3.3.cmml" type="integer" xref="S3.SS2.p4.6.m6.1.1.3.3">2</cn><ci id="S3.SS2.p4.6.m6.1.1.3.4.cmml" xref="S3.SS2.p4.6.m6.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">L_{q2q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">italic_L start_POSTSUBSCRIPT italic_q 2 italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="L_{q2i}" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1"><semantics id="S3.SS2.p4.7.m7.1a"><msub id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml"><mi id="S3.SS2.p4.7.m7.1.1.2" xref="S3.SS2.p4.7.m7.1.1.2.cmml">L</mi><mrow id="S3.SS2.p4.7.m7.1.1.3" xref="S3.SS2.p4.7.m7.1.1.3.cmml"><mi id="S3.SS2.p4.7.m7.1.1.3.2" xref="S3.SS2.p4.7.m7.1.1.3.2.cmml">q</mi><mo id="S3.SS2.p4.7.m7.1.1.3.1" xref="S3.SS2.p4.7.m7.1.1.3.1.cmml">⁢</mo><mn id="S3.SS2.p4.7.m7.1.1.3.3" xref="S3.SS2.p4.7.m7.1.1.3.3.cmml">2</mn><mo id="S3.SS2.p4.7.m7.1.1.3.1a" xref="S3.SS2.p4.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.7.m7.1.1.3.4" xref="S3.SS2.p4.7.m7.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><apply id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2">𝐿</ci><apply id="S3.SS2.p4.7.m7.1.1.3.cmml" xref="S3.SS2.p4.7.m7.1.1.3"><times id="S3.SS2.p4.7.m7.1.1.3.1.cmml" xref="S3.SS2.p4.7.m7.1.1.3.1"></times><ci id="S3.SS2.p4.7.m7.1.1.3.2.cmml" xref="S3.SS2.p4.7.m7.1.1.3.2">𝑞</ci><cn id="S3.SS2.p4.7.m7.1.1.3.3.cmml" type="integer" xref="S3.SS2.p4.7.m7.1.1.3.3">2</cn><ci id="S3.SS2.p4.7.m7.1.1.3.4.cmml" xref="S3.SS2.p4.7.m7.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">L_{q2i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m7.1d">italic_L start_POSTSUBSCRIPT italic_q 2 italic_i end_POSTSUBSCRIPT</annotation></semantics></math> depending on the kind of edge from which the positive pair is extracted.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1">With the growth of the negative sample size, model performance also increase. In practice, we choose the negative sample number of 100 as a compromise of performance and efficiency. To support sampling for both query and item on our stream machine learning platform, we dynamically maintain a query queue and an item queue of size 1 million to conduct cross-batch negative sampling.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Multi-interest Network for CTR Prediction</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Powered by the query-item heterogeneous graph, which jointly learns query and item embedding, we design a CTR prediction network named multi-interest network that utilizes various kinds of user interest measurements based on i2i, q2q, and q2i relationships. The network is composed of the item interest unit, query interest unit, query-item compatibility unit, and CTR prediction layer.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.2"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.2.1">Item interest unit.</span>
Based on graph embedding, we first compute the cosine similarity between target item <math alttext="i_{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">i</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑖</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and historical items <math alttext="I=i_{j}(j=1,2,\cdots,n)" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.5"><semantics id="S3.SS3.p2.2.m2.5a"><mrow id="S3.SS3.p2.2.m2.5.5" xref="S3.SS3.p2.2.m2.5.5.cmml"><mi id="S3.SS3.p2.2.m2.5.5.3" xref="S3.SS3.p2.2.m2.5.5.3.cmml">I</mi><mo id="S3.SS3.p2.2.m2.5.5.2" xref="S3.SS3.p2.2.m2.5.5.2.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.5.5.1" xref="S3.SS3.p2.2.m2.5.5.1.cmml"><msub id="S3.SS3.p2.2.m2.5.5.1.3" xref="S3.SS3.p2.2.m2.5.5.1.3.cmml"><mi id="S3.SS3.p2.2.m2.5.5.1.3.2" xref="S3.SS3.p2.2.m2.5.5.1.3.2.cmml">i</mi><mi id="S3.SS3.p2.2.m2.5.5.1.3.3" xref="S3.SS3.p2.2.m2.5.5.1.3.3.cmml">j</mi></msub><mo id="S3.SS3.p2.2.m2.5.5.1.2" xref="S3.SS3.p2.2.m2.5.5.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.2.m2.5.5.1.1.1" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.cmml"><mo id="S3.SS3.p2.2.m2.5.5.1.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.2.m2.5.5.1.1.1.1" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.5.5.1.1.1.1.2" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.2.cmml">j</mi><mo id="S3.SS3.p2.2.m2.5.5.1.1.1.1.1" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.2" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.1.cmml"><mn id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">1</mn><mo id="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.2.1" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.1.cmml">,</mo><mn id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml">2</mn><mo id="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.2.2" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p2.2.m2.3.3" mathvariant="normal" xref="S3.SS3.p2.2.m2.3.3.cmml">⋯</mi><mo id="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.2.3" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p2.2.m2.4.4" xref="S3.SS3.p2.2.m2.4.4.cmml">n</mi></mrow></mrow><mo id="S3.SS3.p2.2.m2.5.5.1.1.1.3" stretchy="false" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.5b"><apply id="S3.SS3.p2.2.m2.5.5.cmml" xref="S3.SS3.p2.2.m2.5.5"><eq id="S3.SS3.p2.2.m2.5.5.2.cmml" xref="S3.SS3.p2.2.m2.5.5.2"></eq><ci id="S3.SS3.p2.2.m2.5.5.3.cmml" xref="S3.SS3.p2.2.m2.5.5.3">𝐼</ci><apply id="S3.SS3.p2.2.m2.5.5.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1"><times id="S3.SS3.p2.2.m2.5.5.1.2.cmml" xref="S3.SS3.p2.2.m2.5.5.1.2"></times><apply id="S3.SS3.p2.2.m2.5.5.1.3.cmml" xref="S3.SS3.p2.2.m2.5.5.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.5.5.1.3.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.5.5.1.3.2.cmml" xref="S3.SS3.p2.2.m2.5.5.1.3.2">𝑖</ci><ci id="S3.SS3.p2.2.m2.5.5.1.3.3.cmml" xref="S3.SS3.p2.2.m2.5.5.1.3.3">𝑗</ci></apply><apply id="S3.SS3.p2.2.m2.5.5.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.1"><eq id="S3.SS3.p2.2.m2.5.5.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.1"></eq><ci id="S3.SS3.p2.2.m2.5.5.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.2">𝑗</ci><list id="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.1.1.3.2"><cn id="S3.SS3.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS3.p2.2.m2.1.1">1</cn><cn id="S3.SS3.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS3.p2.2.m2.2.2">2</cn><ci id="S3.SS3.p2.2.m2.3.3.cmml" xref="S3.SS3.p2.2.m2.3.3">⋯</ci><ci id="S3.SS3.p2.2.m2.4.4.cmml" xref="S3.SS3.p2.2.m2.4.4">𝑛</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.5c">I=i_{j}(j=1,2,\cdots,n)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.5d">italic_I = italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_j = 1 , 2 , ⋯ , italic_n )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="sim(i_{t},i_{j})=\frac{e_{i_{t}}^{T}e_{i_{j}}}{||e_{i_{t}}||\cdot||e_{i_{j}}||}" class="ltx_Math" display="block" id="S3.Ex2.m1.4"><semantics id="S3.Ex2.m1.4a"><mrow id="S3.Ex2.m1.4.4" xref="S3.Ex2.m1.4.4.cmml"><mrow id="S3.Ex2.m1.4.4.2" xref="S3.Ex2.m1.4.4.2.cmml"><mi id="S3.Ex2.m1.4.4.2.4" xref="S3.Ex2.m1.4.4.2.4.cmml">s</mi><mo id="S3.Ex2.m1.4.4.2.3" xref="S3.Ex2.m1.4.4.2.3.cmml">⁢</mo><mi id="S3.Ex2.m1.4.4.2.5" xref="S3.Ex2.m1.4.4.2.5.cmml">i</mi><mo id="S3.Ex2.m1.4.4.2.3a" xref="S3.Ex2.m1.4.4.2.3.cmml">⁢</mo><mi id="S3.Ex2.m1.4.4.2.6" xref="S3.Ex2.m1.4.4.2.6.cmml">m</mi><mo id="S3.Ex2.m1.4.4.2.3b" xref="S3.Ex2.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.Ex2.m1.4.4.2.2.2" xref="S3.Ex2.m1.4.4.2.2.3.cmml"><mo id="S3.Ex2.m1.4.4.2.2.2.3" stretchy="false" xref="S3.Ex2.m1.4.4.2.2.3.cmml">(</mo><msub id="S3.Ex2.m1.3.3.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.cmml"><mi id="S3.Ex2.m1.3.3.1.1.1.1.2" xref="S3.Ex2.m1.3.3.1.1.1.1.2.cmml">i</mi><mi id="S3.Ex2.m1.3.3.1.1.1.1.3" xref="S3.Ex2.m1.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex2.m1.4.4.2.2.2.4" xref="S3.Ex2.m1.4.4.2.2.3.cmml">,</mo><msub id="S3.Ex2.m1.4.4.2.2.2.2" xref="S3.Ex2.m1.4.4.2.2.2.2.cmml"><mi id="S3.Ex2.m1.4.4.2.2.2.2.2" xref="S3.Ex2.m1.4.4.2.2.2.2.2.cmml">i</mi><mi id="S3.Ex2.m1.4.4.2.2.2.2.3" xref="S3.Ex2.m1.4.4.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.Ex2.m1.4.4.2.2.2.5" stretchy="false" xref="S3.Ex2.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.4.4.3" xref="S3.Ex2.m1.4.4.3.cmml">=</mo><mfrac id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml"><mrow id="S3.Ex2.m1.2.2.4" xref="S3.Ex2.m1.2.2.4.cmml"><msubsup id="S3.Ex2.m1.2.2.4.2" xref="S3.Ex2.m1.2.2.4.2.cmml"><mi id="S3.Ex2.m1.2.2.4.2.2.2" xref="S3.Ex2.m1.2.2.4.2.2.2.cmml">e</mi><msub id="S3.Ex2.m1.2.2.4.2.2.3" xref="S3.Ex2.m1.2.2.4.2.2.3.cmml"><mi id="S3.Ex2.m1.2.2.4.2.2.3.2" xref="S3.Ex2.m1.2.2.4.2.2.3.2.cmml">i</mi><mi id="S3.Ex2.m1.2.2.4.2.2.3.3" xref="S3.Ex2.m1.2.2.4.2.2.3.3.cmml">t</mi></msub><mi id="S3.Ex2.m1.2.2.4.2.3" xref="S3.Ex2.m1.2.2.4.2.3.cmml">T</mi></msubsup><mo id="S3.Ex2.m1.2.2.4.1" xref="S3.Ex2.m1.2.2.4.1.cmml">⁢</mo><msub id="S3.Ex2.m1.2.2.4.3" xref="S3.Ex2.m1.2.2.4.3.cmml"><mi id="S3.Ex2.m1.2.2.4.3.2" xref="S3.Ex2.m1.2.2.4.3.2.cmml">e</mi><msub id="S3.Ex2.m1.2.2.4.3.3" xref="S3.Ex2.m1.2.2.4.3.3.cmml"><mi id="S3.Ex2.m1.2.2.4.3.3.2" xref="S3.Ex2.m1.2.2.4.3.3.2.cmml">i</mi><mi id="S3.Ex2.m1.2.2.4.3.3.3" xref="S3.Ex2.m1.2.2.4.3.3.3.cmml">j</mi></msub></msub></mrow><mrow id="S3.Ex2.m1.2.2.2" xref="S3.Ex2.m1.2.2.2.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.2.cmml"><mo id="S3.Ex2.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.1.2.cmml">e</mi><msub id="S3.Ex2.m1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.2" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.3.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></msub><mo id="S3.Ex2.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.Ex2.m1.2.2.2.3" rspace="0.222em" xref="S3.Ex2.m1.2.2.2.3.cmml">⋅</mo><mrow id="S3.Ex2.m1.2.2.2.2.1" xref="S3.Ex2.m1.2.2.2.2.2.cmml"><mo id="S3.Ex2.m1.2.2.2.2.1.2" stretchy="false" xref="S3.Ex2.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.Ex2.m1.2.2.2.2.1.1" xref="S3.Ex2.m1.2.2.2.2.1.1.cmml"><mi id="S3.Ex2.m1.2.2.2.2.1.1.2" xref="S3.Ex2.m1.2.2.2.2.1.1.2.cmml">e</mi><msub id="S3.Ex2.m1.2.2.2.2.1.1.3" xref="S3.Ex2.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.Ex2.m1.2.2.2.2.1.1.3.2" xref="S3.Ex2.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mi id="S3.Ex2.m1.2.2.2.2.1.1.3.3" xref="S3.Ex2.m1.2.2.2.2.1.1.3.3.cmml">j</mi></msub></msub><mo id="S3.Ex2.m1.2.2.2.2.1.3" stretchy="false" xref="S3.Ex2.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.4b"><apply id="S3.Ex2.m1.4.4.cmml" xref="S3.Ex2.m1.4.4"><eq id="S3.Ex2.m1.4.4.3.cmml" xref="S3.Ex2.m1.4.4.3"></eq><apply id="S3.Ex2.m1.4.4.2.cmml" xref="S3.Ex2.m1.4.4.2"><times id="S3.Ex2.m1.4.4.2.3.cmml" xref="S3.Ex2.m1.4.4.2.3"></times><ci id="S3.Ex2.m1.4.4.2.4.cmml" xref="S3.Ex2.m1.4.4.2.4">𝑠</ci><ci id="S3.Ex2.m1.4.4.2.5.cmml" xref="S3.Ex2.m1.4.4.2.5">𝑖</ci><ci id="S3.Ex2.m1.4.4.2.6.cmml" xref="S3.Ex2.m1.4.4.2.6">𝑚</ci><interval closure="open" id="S3.Ex2.m1.4.4.2.2.3.cmml" xref="S3.Ex2.m1.4.4.2.2.2"><apply id="S3.Ex2.m1.3.3.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.2">𝑖</ci><ci id="S3.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.3">𝑡</ci></apply><apply id="S3.Ex2.m1.4.4.2.2.2.2.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.2.2.2.2.1.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S3.Ex2.m1.4.4.2.2.2.2.2.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.2">𝑖</ci><ci id="S3.Ex2.m1.4.4.2.2.2.2.3.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2"><divide id="S3.Ex2.m1.2.2.3.cmml" xref="S3.Ex2.m1.2.2"></divide><apply id="S3.Ex2.m1.2.2.4.cmml" xref="S3.Ex2.m1.2.2.4"><times id="S3.Ex2.m1.2.2.4.1.cmml" xref="S3.Ex2.m1.2.2.4.1"></times><apply id="S3.Ex2.m1.2.2.4.2.cmml" xref="S3.Ex2.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.4.2.1.cmml" xref="S3.Ex2.m1.2.2.4.2">superscript</csymbol><apply id="S3.Ex2.m1.2.2.4.2.2.cmml" xref="S3.Ex2.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.4.2.2.1.cmml" xref="S3.Ex2.m1.2.2.4.2">subscript</csymbol><ci id="S3.Ex2.m1.2.2.4.2.2.2.cmml" xref="S3.Ex2.m1.2.2.4.2.2.2">𝑒</ci><apply id="S3.Ex2.m1.2.2.4.2.2.3.cmml" xref="S3.Ex2.m1.2.2.4.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.4.2.2.3.1.cmml" xref="S3.Ex2.m1.2.2.4.2.2.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.4.2.2.3.2.cmml" xref="S3.Ex2.m1.2.2.4.2.2.3.2">𝑖</ci><ci id="S3.Ex2.m1.2.2.4.2.2.3.3.cmml" xref="S3.Ex2.m1.2.2.4.2.2.3.3">𝑡</ci></apply></apply><ci id="S3.Ex2.m1.2.2.4.2.3.cmml" xref="S3.Ex2.m1.2.2.4.2.3">𝑇</ci></apply><apply id="S3.Ex2.m1.2.2.4.3.cmml" xref="S3.Ex2.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.4.3.1.cmml" xref="S3.Ex2.m1.2.2.4.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.4.3.2.cmml" xref="S3.Ex2.m1.2.2.4.3.2">𝑒</ci><apply id="S3.Ex2.m1.2.2.4.3.3.cmml" xref="S3.Ex2.m1.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.4.3.3.1.cmml" xref="S3.Ex2.m1.2.2.4.3.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.4.3.3.2.cmml" xref="S3.Ex2.m1.2.2.4.3.3.2">𝑖</ci><ci id="S3.Ex2.m1.2.2.4.3.3.3.cmml" xref="S3.Ex2.m1.2.2.4.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.Ex2.m1.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2"><ci id="S3.Ex2.m1.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.3">⋅</ci><apply id="S3.Ex2.m1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2">𝑒</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.Ex2.m1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex2.m1.2.2.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.Ex2.m1.2.2.2.2.1.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.2.1.1.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.2">𝑒</ci><apply id="S3.Ex2.m1.2.2.2.2.1.1.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.3.2">𝑖</ci><ci id="S3.Ex2.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.4c">sim(i_{t},i_{j})=\frac{e_{i_{t}}^{T}e_{i_{j}}}{||e_{i_{t}}||\cdot||e_{i_{j}}||}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.4d">italic_s italic_i italic_m ( italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = divide start_ARG italic_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG | | italic_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT | | ⋅ | | italic_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT | | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.7">Then, we use top-k retrieval to get k historical items with the largest similarity score:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="i^{\prime}_{1},i^{\prime}_{2},\cdots,i^{\prime}_{k}=topk(sim(i_{t},I))" class="ltx_Math" display="block" id="S3.Ex3.m1.6"><semantics id="S3.Ex3.m1.6a"><mrow id="S3.Ex3.m1.6.6" xref="S3.Ex3.m1.6.6.cmml"><mrow id="S3.Ex3.m1.5.5.3.3" xref="S3.Ex3.m1.5.5.3.4.cmml"><msubsup id="S3.Ex3.m1.3.3.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.2.2" xref="S3.Ex3.m1.3.3.1.1.1.2.2.cmml">i</mi><mn id="S3.Ex3.m1.3.3.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.3.cmml">1</mn><mo id="S3.Ex3.m1.3.3.1.1.1.2.3" xref="S3.Ex3.m1.3.3.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.Ex3.m1.5.5.3.3.4" xref="S3.Ex3.m1.5.5.3.4.cmml">,</mo><msubsup id="S3.Ex3.m1.4.4.2.2.2" xref="S3.Ex3.m1.4.4.2.2.2.cmml"><mi id="S3.Ex3.m1.4.4.2.2.2.2.2" xref="S3.Ex3.m1.4.4.2.2.2.2.2.cmml">i</mi><mn id="S3.Ex3.m1.4.4.2.2.2.3" xref="S3.Ex3.m1.4.4.2.2.2.3.cmml">2</mn><mo id="S3.Ex3.m1.4.4.2.2.2.2.3" xref="S3.Ex3.m1.4.4.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.Ex3.m1.5.5.3.3.5" xref="S3.Ex3.m1.5.5.3.4.cmml">,</mo><mi id="S3.Ex3.m1.2.2" mathvariant="normal" xref="S3.Ex3.m1.2.2.cmml">⋯</mi><mo id="S3.Ex3.m1.5.5.3.3.6" xref="S3.Ex3.m1.5.5.3.4.cmml">,</mo><msubsup id="S3.Ex3.m1.5.5.3.3.3" xref="S3.Ex3.m1.5.5.3.3.3.cmml"><mi id="S3.Ex3.m1.5.5.3.3.3.2.2" xref="S3.Ex3.m1.5.5.3.3.3.2.2.cmml">i</mi><mi id="S3.Ex3.m1.5.5.3.3.3.3" xref="S3.Ex3.m1.5.5.3.3.3.3.cmml">k</mi><mo id="S3.Ex3.m1.5.5.3.3.3.2.3" xref="S3.Ex3.m1.5.5.3.3.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.Ex3.m1.6.6.5" xref="S3.Ex3.m1.6.6.5.cmml">=</mo><mrow id="S3.Ex3.m1.6.6.4" xref="S3.Ex3.m1.6.6.4.cmml"><mi id="S3.Ex3.m1.6.6.4.3" xref="S3.Ex3.m1.6.6.4.3.cmml">t</mi><mo id="S3.Ex3.m1.6.6.4.2" xref="S3.Ex3.m1.6.6.4.2.cmml">⁢</mo><mi id="S3.Ex3.m1.6.6.4.4" xref="S3.Ex3.m1.6.6.4.4.cmml">o</mi><mo id="S3.Ex3.m1.6.6.4.2a" xref="S3.Ex3.m1.6.6.4.2.cmml">⁢</mo><mi id="S3.Ex3.m1.6.6.4.5" xref="S3.Ex3.m1.6.6.4.5.cmml">p</mi><mo id="S3.Ex3.m1.6.6.4.2b" xref="S3.Ex3.m1.6.6.4.2.cmml">⁢</mo><mi id="S3.Ex3.m1.6.6.4.6" xref="S3.Ex3.m1.6.6.4.6.cmml">k</mi><mo id="S3.Ex3.m1.6.6.4.2c" xref="S3.Ex3.m1.6.6.4.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.6.6.4.1.1" xref="S3.Ex3.m1.6.6.4.1.1.1.cmml"><mo id="S3.Ex3.m1.6.6.4.1.1.2" stretchy="false" xref="S3.Ex3.m1.6.6.4.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.6.6.4.1.1.1" xref="S3.Ex3.m1.6.6.4.1.1.1.cmml"><mi id="S3.Ex3.m1.6.6.4.1.1.1.3" xref="S3.Ex3.m1.6.6.4.1.1.1.3.cmml">s</mi><mo id="S3.Ex3.m1.6.6.4.1.1.1.2" xref="S3.Ex3.m1.6.6.4.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.6.6.4.1.1.1.4" xref="S3.Ex3.m1.6.6.4.1.1.1.4.cmml">i</mi><mo id="S3.Ex3.m1.6.6.4.1.1.1.2a" xref="S3.Ex3.m1.6.6.4.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.6.6.4.1.1.1.5" xref="S3.Ex3.m1.6.6.4.1.1.1.5.cmml">m</mi><mo id="S3.Ex3.m1.6.6.4.1.1.1.2b" xref="S3.Ex3.m1.6.6.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.6.6.4.1.1.1.1.1" xref="S3.Ex3.m1.6.6.4.1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.6.6.4.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.6.6.4.1.1.1.1.2.cmml">(</mo><msub id="S3.Ex3.m1.6.6.4.1.1.1.1.1.1" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.2" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.2.cmml">i</mi><mi id="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.3" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex3.m1.6.6.4.1.1.1.1.1.3" xref="S3.Ex3.m1.6.6.4.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml">I</mi><mo id="S3.Ex3.m1.6.6.4.1.1.1.1.1.4" stretchy="false" xref="S3.Ex3.m1.6.6.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.6.6.4.1.1.3" stretchy="false" xref="S3.Ex3.m1.6.6.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.6b"><apply id="S3.Ex3.m1.6.6.cmml" xref="S3.Ex3.m1.6.6"><eq id="S3.Ex3.m1.6.6.5.cmml" xref="S3.Ex3.m1.6.6.5"></eq><list id="S3.Ex3.m1.5.5.3.4.cmml" xref="S3.Ex3.m1.5.5.3.3"><apply id="S3.Ex3.m1.3.3.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1">subscript</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.2.2">𝑖</ci><ci id="S3.Ex3.m1.3.3.1.1.1.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.2.3">′</ci></apply><cn id="S3.Ex3.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.Ex3.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.Ex3.m1.4.4.2.2.2.cmml" xref="S3.Ex3.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.2.2.2.1.cmml" xref="S3.Ex3.m1.4.4.2.2.2">subscript</csymbol><apply id="S3.Ex3.m1.4.4.2.2.2.2.cmml" xref="S3.Ex3.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.2.2.2.2.1.cmml" xref="S3.Ex3.m1.4.4.2.2.2">superscript</csymbol><ci id="S3.Ex3.m1.4.4.2.2.2.2.2.cmml" xref="S3.Ex3.m1.4.4.2.2.2.2.2">𝑖</ci><ci id="S3.Ex3.m1.4.4.2.2.2.2.3.cmml" xref="S3.Ex3.m1.4.4.2.2.2.2.3">′</ci></apply><cn id="S3.Ex3.m1.4.4.2.2.2.3.cmml" type="integer" xref="S3.Ex3.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.Ex3.m1.2.2.cmml" xref="S3.Ex3.m1.2.2">⋯</ci><apply id="S3.Ex3.m1.5.5.3.3.3.cmml" xref="S3.Ex3.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.5.5.3.3.3.1.cmml" xref="S3.Ex3.m1.5.5.3.3.3">subscript</csymbol><apply id="S3.Ex3.m1.5.5.3.3.3.2.cmml" xref="S3.Ex3.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.5.5.3.3.3.2.1.cmml" xref="S3.Ex3.m1.5.5.3.3.3">superscript</csymbol><ci id="S3.Ex3.m1.5.5.3.3.3.2.2.cmml" xref="S3.Ex3.m1.5.5.3.3.3.2.2">𝑖</ci><ci id="S3.Ex3.m1.5.5.3.3.3.2.3.cmml" xref="S3.Ex3.m1.5.5.3.3.3.2.3">′</ci></apply><ci id="S3.Ex3.m1.5.5.3.3.3.3.cmml" xref="S3.Ex3.m1.5.5.3.3.3.3">𝑘</ci></apply></list><apply id="S3.Ex3.m1.6.6.4.cmml" xref="S3.Ex3.m1.6.6.4"><times id="S3.Ex3.m1.6.6.4.2.cmml" xref="S3.Ex3.m1.6.6.4.2"></times><ci id="S3.Ex3.m1.6.6.4.3.cmml" xref="S3.Ex3.m1.6.6.4.3">𝑡</ci><ci id="S3.Ex3.m1.6.6.4.4.cmml" xref="S3.Ex3.m1.6.6.4.4">𝑜</ci><ci id="S3.Ex3.m1.6.6.4.5.cmml" xref="S3.Ex3.m1.6.6.4.5">𝑝</ci><ci id="S3.Ex3.m1.6.6.4.6.cmml" xref="S3.Ex3.m1.6.6.4.6">𝑘</ci><apply id="S3.Ex3.m1.6.6.4.1.1.1.cmml" xref="S3.Ex3.m1.6.6.4.1.1"><times id="S3.Ex3.m1.6.6.4.1.1.1.2.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.2"></times><ci id="S3.Ex3.m1.6.6.4.1.1.1.3.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.3">𝑠</ci><ci id="S3.Ex3.m1.6.6.4.1.1.1.4.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.4">𝑖</ci><ci id="S3.Ex3.m1.6.6.4.1.1.1.5.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.5">𝑚</ci><interval closure="open" id="S3.Ex3.m1.6.6.4.1.1.1.1.2.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1"><apply id="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.2">𝑖</ci><ci id="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.6.6.4.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1">𝐼</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.6c">i^{\prime}_{1},i^{\prime}_{2},\cdots,i^{\prime}_{k}=topk(sim(i_{t},I))</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.6d">italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_t italic_o italic_p italic_k ( italic_s italic_i italic_m ( italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.3">We adopt the equal width interval binning method <cite class="ltx_cite ltx_citemacro_citep">(Dougherty et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib5" title="">1995</a>)</cite> to transformer <math alttext="sim(i_{t},i^{\prime}_{k})" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m1.2"><semantics id="S3.SS3.p2.3.m1.2a"><mrow id="S3.SS3.p2.3.m1.2.2" xref="S3.SS3.p2.3.m1.2.2.cmml"><mi id="S3.SS3.p2.3.m1.2.2.4" xref="S3.SS3.p2.3.m1.2.2.4.cmml">s</mi><mo id="S3.SS3.p2.3.m1.2.2.3" xref="S3.SS3.p2.3.m1.2.2.3.cmml">⁢</mo><mi id="S3.SS3.p2.3.m1.2.2.5" xref="S3.SS3.p2.3.m1.2.2.5.cmml">i</mi><mo id="S3.SS3.p2.3.m1.2.2.3a" xref="S3.SS3.p2.3.m1.2.2.3.cmml">⁢</mo><mi id="S3.SS3.p2.3.m1.2.2.6" xref="S3.SS3.p2.3.m1.2.2.6.cmml">m</mi><mo id="S3.SS3.p2.3.m1.2.2.3b" xref="S3.SS3.p2.3.m1.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m1.2.2.2.2" xref="S3.SS3.p2.3.m1.2.2.2.3.cmml"><mo id="S3.SS3.p2.3.m1.2.2.2.2.3" stretchy="false" xref="S3.SS3.p2.3.m1.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p2.3.m1.1.1.1.1.1" xref="S3.SS3.p2.3.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.3.m1.1.1.1.1.1.2" xref="S3.SS3.p2.3.m1.1.1.1.1.1.2.cmml">i</mi><mi id="S3.SS3.p2.3.m1.1.1.1.1.1.3" xref="S3.SS3.p2.3.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p2.3.m1.2.2.2.2.4" xref="S3.SS3.p2.3.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.SS3.p2.3.m1.2.2.2.2.2" xref="S3.SS3.p2.3.m1.2.2.2.2.2.cmml"><mi id="S3.SS3.p2.3.m1.2.2.2.2.2.2.2" xref="S3.SS3.p2.3.m1.2.2.2.2.2.2.2.cmml">i</mi><mi id="S3.SS3.p2.3.m1.2.2.2.2.2.3" xref="S3.SS3.p2.3.m1.2.2.2.2.2.3.cmml">k</mi><mo id="S3.SS3.p2.3.m1.2.2.2.2.2.2.3" xref="S3.SS3.p2.3.m1.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.p2.3.m1.2.2.2.2.5" stretchy="false" xref="S3.SS3.p2.3.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m1.2b"><apply id="S3.SS3.p2.3.m1.2.2.cmml" xref="S3.SS3.p2.3.m1.2.2"><times id="S3.SS3.p2.3.m1.2.2.3.cmml" xref="S3.SS3.p2.3.m1.2.2.3"></times><ci id="S3.SS3.p2.3.m1.2.2.4.cmml" xref="S3.SS3.p2.3.m1.2.2.4">𝑠</ci><ci id="S3.SS3.p2.3.m1.2.2.5.cmml" xref="S3.SS3.p2.3.m1.2.2.5">𝑖</ci><ci id="S3.SS3.p2.3.m1.2.2.6.cmml" xref="S3.SS3.p2.3.m1.2.2.6">𝑚</ci><interval closure="open" id="S3.SS3.p2.3.m1.2.2.2.3.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2"><apply id="S3.SS3.p2.3.m1.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.3.m1.1.1.1.1.1.2">𝑖</ci><ci id="S3.SS3.p2.3.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.3.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.p2.3.m1.2.2.2.2.2.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.SS3.p2.3.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p2.3.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2.2.2.2">𝑖</ci><ci id="S3.SS3.p2.3.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2.2.2.3">′</ci></apply><ci id="S3.SS3.p2.3.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.3.m1.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m1.2c">sim(i_{t},i^{\prime}_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m1.2d">italic_s italic_i italic_m ( italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> into the categorical feature and get the embedding. To capture the order information of top-k items, we add positional embedding depending on the original index of top-k items to binning embedding to get item representations:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="e_{i^{\prime}_{k}}=binning(sim(i_{t},i^{\prime}_{k}))+positional(i^{\prime}_{k})" class="ltx_Math" display="block" id="S3.Ex4.m1.2"><semantics id="S3.Ex4.m1.2a"><mrow id="S3.Ex4.m1.2.2" xref="S3.Ex4.m1.2.2.cmml"><msub id="S3.Ex4.m1.2.2.4" xref="S3.Ex4.m1.2.2.4.cmml"><mi id="S3.Ex4.m1.2.2.4.2" xref="S3.Ex4.m1.2.2.4.2.cmml">e</mi><msubsup id="S3.Ex4.m1.2.2.4.3" xref="S3.Ex4.m1.2.2.4.3.cmml"><mi id="S3.Ex4.m1.2.2.4.3.2.2" xref="S3.Ex4.m1.2.2.4.3.2.2.cmml">i</mi><mi id="S3.Ex4.m1.2.2.4.3.3" xref="S3.Ex4.m1.2.2.4.3.3.cmml">k</mi><mo id="S3.Ex4.m1.2.2.4.3.2.3" xref="S3.Ex4.m1.2.2.4.3.2.3.cmml">′</mo></msubsup></msub><mo id="S3.Ex4.m1.2.2.3" xref="S3.Ex4.m1.2.2.3.cmml">=</mo><mrow id="S3.Ex4.m1.2.2.2" xref="S3.Ex4.m1.2.2.2.cmml"><mrow id="S3.Ex4.m1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.3.cmml">b</mi><mo id="S3.Ex4.m1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.4" xref="S3.Ex4.m1.1.1.1.1.4.cmml">i</mi><mo id="S3.Ex4.m1.1.1.1.1.2a" xref="S3.Ex4.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.5" xref="S3.Ex4.m1.1.1.1.1.5.cmml">n</mi><mo id="S3.Ex4.m1.1.1.1.1.2b" xref="S3.Ex4.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.6" xref="S3.Ex4.m1.1.1.1.1.6.cmml">n</mi><mo id="S3.Ex4.m1.1.1.1.1.2c" xref="S3.Ex4.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.7" xref="S3.Ex4.m1.1.1.1.1.7.cmml">i</mi><mo id="S3.Ex4.m1.1.1.1.1.2d" xref="S3.Ex4.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.8" xref="S3.Ex4.m1.1.1.1.1.8.cmml">n</mi><mo id="S3.Ex4.m1.1.1.1.1.2e" xref="S3.Ex4.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.9" xref="S3.Ex4.m1.1.1.1.1.9.cmml">g</mi><mo id="S3.Ex4.m1.1.1.1.1.2f" xref="S3.Ex4.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.4" xref="S3.Ex4.m1.1.1.1.1.1.1.1.4.cmml">s</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.5" xref="S3.Ex4.m1.1.1.1.1.1.1.1.5.cmml">i</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.3a" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.6" xref="S3.Ex4.m1.1.1.1.1.1.1.1.6.cmml">m</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.3b" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.4" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">i</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.2.2.2.3" xref="S3.Ex4.m1.2.2.2.3.cmml">+</mo><mrow id="S3.Ex4.m1.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.cmml"><mi id="S3.Ex4.m1.2.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.3.cmml">p</mi><mo id="S3.Ex4.m1.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.4" xref="S3.Ex4.m1.2.2.2.2.4.cmml">o</mi><mo id="S3.Ex4.m1.2.2.2.2.2a" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.5" xref="S3.Ex4.m1.2.2.2.2.5.cmml">s</mi><mo id="S3.Ex4.m1.2.2.2.2.2b" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.6" xref="S3.Ex4.m1.2.2.2.2.6.cmml">i</mi><mo id="S3.Ex4.m1.2.2.2.2.2c" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.7" xref="S3.Ex4.m1.2.2.2.2.7.cmml">t</mi><mo id="S3.Ex4.m1.2.2.2.2.2d" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.8" xref="S3.Ex4.m1.2.2.2.2.8.cmml">i</mi><mo id="S3.Ex4.m1.2.2.2.2.2e" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.9" xref="S3.Ex4.m1.2.2.2.2.9.cmml">o</mi><mo id="S3.Ex4.m1.2.2.2.2.2f" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.10" xref="S3.Ex4.m1.2.2.2.2.10.cmml">n</mi><mo id="S3.Ex4.m1.2.2.2.2.2g" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.11" xref="S3.Ex4.m1.2.2.2.2.11.cmml">a</mi><mo id="S3.Ex4.m1.2.2.2.2.2h" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.Ex4.m1.2.2.2.2.12" xref="S3.Ex4.m1.2.2.2.2.12.cmml">l</mi><mo id="S3.Ex4.m1.2.2.2.2.2i" xref="S3.Ex4.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.2.2.2.2.1.1" xref="S3.Ex4.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.Ex4.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.Ex4.m1.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S3.Ex4.m1.2.2.2.2.1.1.1" xref="S3.Ex4.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.Ex4.m1.2.2.2.2.1.1.1.2.2" xref="S3.Ex4.m1.2.2.2.2.1.1.1.2.2.cmml">i</mi><mi id="S3.Ex4.m1.2.2.2.2.1.1.1.3" xref="S3.Ex4.m1.2.2.2.2.1.1.1.3.cmml">k</mi><mo id="S3.Ex4.m1.2.2.2.2.1.1.1.2.3" xref="S3.Ex4.m1.2.2.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.Ex4.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.Ex4.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.2b"><apply id="S3.Ex4.m1.2.2.cmml" xref="S3.Ex4.m1.2.2"><eq id="S3.Ex4.m1.2.2.3.cmml" xref="S3.Ex4.m1.2.2.3"></eq><apply id="S3.Ex4.m1.2.2.4.cmml" xref="S3.Ex4.m1.2.2.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.4.1.cmml" xref="S3.Ex4.m1.2.2.4">subscript</csymbol><ci id="S3.Ex4.m1.2.2.4.2.cmml" xref="S3.Ex4.m1.2.2.4.2">𝑒</ci><apply id="S3.Ex4.m1.2.2.4.3.cmml" xref="S3.Ex4.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.4.3.1.cmml" xref="S3.Ex4.m1.2.2.4.3">subscript</csymbol><apply id="S3.Ex4.m1.2.2.4.3.2.cmml" xref="S3.Ex4.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.4.3.2.1.cmml" xref="S3.Ex4.m1.2.2.4.3">superscript</csymbol><ci id="S3.Ex4.m1.2.2.4.3.2.2.cmml" xref="S3.Ex4.m1.2.2.4.3.2.2">𝑖</ci><ci id="S3.Ex4.m1.2.2.4.3.2.3.cmml" xref="S3.Ex4.m1.2.2.4.3.2.3">′</ci></apply><ci id="S3.Ex4.m1.2.2.4.3.3.cmml" xref="S3.Ex4.m1.2.2.4.3.3">𝑘</ci></apply></apply><apply id="S3.Ex4.m1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2"><plus id="S3.Ex4.m1.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.3"></plus><apply id="S3.Ex4.m1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.2"></times><ci id="S3.Ex4.m1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3">𝑏</ci><ci id="S3.Ex4.m1.1.1.1.1.4.cmml" xref="S3.Ex4.m1.1.1.1.1.4">𝑖</ci><ci id="S3.Ex4.m1.1.1.1.1.5.cmml" xref="S3.Ex4.m1.1.1.1.1.5">𝑛</ci><ci id="S3.Ex4.m1.1.1.1.1.6.cmml" xref="S3.Ex4.m1.1.1.1.1.6">𝑛</ci><ci id="S3.Ex4.m1.1.1.1.1.7.cmml" xref="S3.Ex4.m1.1.1.1.1.7">𝑖</ci><ci id="S3.Ex4.m1.1.1.1.1.8.cmml" xref="S3.Ex4.m1.1.1.1.1.8">𝑛</ci><ci id="S3.Ex4.m1.1.1.1.1.9.cmml" xref="S3.Ex4.m1.1.1.1.1.9">𝑔</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3"></times><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.4">𝑠</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.5">𝑖</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.6.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.6">𝑚</ci><interval closure="open" id="S3.Ex4.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2"><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.2">𝑖</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.2.3">′</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2"><times id="S3.Ex4.m1.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2"></times><ci id="S3.Ex4.m1.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.3">𝑝</ci><ci id="S3.Ex4.m1.2.2.2.2.4.cmml" xref="S3.Ex4.m1.2.2.2.2.4">𝑜</ci><ci id="S3.Ex4.m1.2.2.2.2.5.cmml" xref="S3.Ex4.m1.2.2.2.2.5">𝑠</ci><ci id="S3.Ex4.m1.2.2.2.2.6.cmml" xref="S3.Ex4.m1.2.2.2.2.6">𝑖</ci><ci id="S3.Ex4.m1.2.2.2.2.7.cmml" xref="S3.Ex4.m1.2.2.2.2.7">𝑡</ci><ci id="S3.Ex4.m1.2.2.2.2.8.cmml" xref="S3.Ex4.m1.2.2.2.2.8">𝑖</ci><ci id="S3.Ex4.m1.2.2.2.2.9.cmml" xref="S3.Ex4.m1.2.2.2.2.9">𝑜</ci><ci id="S3.Ex4.m1.2.2.2.2.10.cmml" xref="S3.Ex4.m1.2.2.2.2.10">𝑛</ci><ci id="S3.Ex4.m1.2.2.2.2.11.cmml" xref="S3.Ex4.m1.2.2.2.2.11">𝑎</ci><ci id="S3.Ex4.m1.2.2.2.2.12.cmml" xref="S3.Ex4.m1.2.2.2.2.12">𝑙</ci><apply id="S3.Ex4.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex4.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex4.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.Ex4.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.Ex4.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.Ex4.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.1.1.1.2.2">𝑖</ci><ci id="S3.Ex4.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.1.1.1.2.3">′</ci></apply><ci id="S3.Ex4.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex4.m1.2.2.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.2c">e_{i^{\prime}_{k}}=binning(sim(i_{t},i^{\prime}_{k}))+positional(i^{\prime}_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.2d">italic_e start_POSTSUBSCRIPT italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT = italic_b italic_i italic_n italic_n italic_i italic_n italic_g ( italic_s italic_i italic_m ( italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) + italic_p italic_o italic_s italic_i italic_t italic_i italic_o italic_n italic_a italic_l ( italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.8">Finally, we concatenate k item representations to form the i2i feature, which is then fed into the CTR prediction network.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{i2i}=\mathrm{concate}(e_{i^{\prime}_{1}},e_{i^{\prime}_{2}},\cdots,e_{i^{%
\prime}_{k}})" class="ltx_Math" display="block" id="S3.Ex5.m1.4"><semantics id="S3.Ex5.m1.4a"><mrow id="S3.Ex5.m1.4.4" xref="S3.Ex5.m1.4.4.cmml"><msub id="S3.Ex5.m1.4.4.5" xref="S3.Ex5.m1.4.4.5.cmml"><mi id="S3.Ex5.m1.4.4.5.2" xref="S3.Ex5.m1.4.4.5.2.cmml">f</mi><mrow id="S3.Ex5.m1.4.4.5.3" xref="S3.Ex5.m1.4.4.5.3.cmml"><mi id="S3.Ex5.m1.4.4.5.3.2" xref="S3.Ex5.m1.4.4.5.3.2.cmml">i</mi><mo id="S3.Ex5.m1.4.4.5.3.1" xref="S3.Ex5.m1.4.4.5.3.1.cmml">⁢</mo><mn id="S3.Ex5.m1.4.4.5.3.3" xref="S3.Ex5.m1.4.4.5.3.3.cmml">2</mn><mo id="S3.Ex5.m1.4.4.5.3.1a" xref="S3.Ex5.m1.4.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex5.m1.4.4.5.3.4" xref="S3.Ex5.m1.4.4.5.3.4.cmml">i</mi></mrow></msub><mo id="S3.Ex5.m1.4.4.4" xref="S3.Ex5.m1.4.4.4.cmml">=</mo><mrow id="S3.Ex5.m1.4.4.3" xref="S3.Ex5.m1.4.4.3.cmml"><mi id="S3.Ex5.m1.4.4.3.5" xref="S3.Ex5.m1.4.4.3.5.cmml">concate</mi><mo id="S3.Ex5.m1.4.4.3.4" xref="S3.Ex5.m1.4.4.3.4.cmml">⁢</mo><mrow id="S3.Ex5.m1.4.4.3.3.3" xref="S3.Ex5.m1.4.4.3.3.4.cmml"><mo id="S3.Ex5.m1.4.4.3.3.3.4" stretchy="false" xref="S3.Ex5.m1.4.4.3.3.4.cmml">(</mo><msub id="S3.Ex5.m1.2.2.1.1.1.1" xref="S3.Ex5.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex5.m1.2.2.1.1.1.1.2" xref="S3.Ex5.m1.2.2.1.1.1.1.2.cmml">e</mi><msubsup id="S3.Ex5.m1.2.2.1.1.1.1.3" xref="S3.Ex5.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex5.m1.2.2.1.1.1.1.3.2.2" xref="S3.Ex5.m1.2.2.1.1.1.1.3.2.2.cmml">i</mi><mn id="S3.Ex5.m1.2.2.1.1.1.1.3.3" xref="S3.Ex5.m1.2.2.1.1.1.1.3.3.cmml">1</mn><mo id="S3.Ex5.m1.2.2.1.1.1.1.3.2.3" xref="S3.Ex5.m1.2.2.1.1.1.1.3.2.3.cmml">′</mo></msubsup></msub><mo id="S3.Ex5.m1.4.4.3.3.3.5" xref="S3.Ex5.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.Ex5.m1.3.3.2.2.2.2" xref="S3.Ex5.m1.3.3.2.2.2.2.cmml"><mi id="S3.Ex5.m1.3.3.2.2.2.2.2" xref="S3.Ex5.m1.3.3.2.2.2.2.2.cmml">e</mi><msubsup id="S3.Ex5.m1.3.3.2.2.2.2.3" xref="S3.Ex5.m1.3.3.2.2.2.2.3.cmml"><mi id="S3.Ex5.m1.3.3.2.2.2.2.3.2.2" xref="S3.Ex5.m1.3.3.2.2.2.2.3.2.2.cmml">i</mi><mn id="S3.Ex5.m1.3.3.2.2.2.2.3.3" xref="S3.Ex5.m1.3.3.2.2.2.2.3.3.cmml">2</mn><mo id="S3.Ex5.m1.3.3.2.2.2.2.3.2.3" xref="S3.Ex5.m1.3.3.2.2.2.2.3.2.3.cmml">′</mo></msubsup></msub><mo id="S3.Ex5.m1.4.4.3.3.3.6" xref="S3.Ex5.m1.4.4.3.3.4.cmml">,</mo><mi id="S3.Ex5.m1.1.1" mathvariant="normal" xref="S3.Ex5.m1.1.1.cmml">⋯</mi><mo id="S3.Ex5.m1.4.4.3.3.3.7" xref="S3.Ex5.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.Ex5.m1.4.4.3.3.3.3" xref="S3.Ex5.m1.4.4.3.3.3.3.cmml"><mi id="S3.Ex5.m1.4.4.3.3.3.3.2" xref="S3.Ex5.m1.4.4.3.3.3.3.2.cmml">e</mi><msubsup id="S3.Ex5.m1.4.4.3.3.3.3.3" xref="S3.Ex5.m1.4.4.3.3.3.3.3.cmml"><mi id="S3.Ex5.m1.4.4.3.3.3.3.3.2.2" xref="S3.Ex5.m1.4.4.3.3.3.3.3.2.2.cmml">i</mi><mi id="S3.Ex5.m1.4.4.3.3.3.3.3.3" xref="S3.Ex5.m1.4.4.3.3.3.3.3.3.cmml">k</mi><mo id="S3.Ex5.m1.4.4.3.3.3.3.3.2.3" xref="S3.Ex5.m1.4.4.3.3.3.3.3.2.3.cmml">′</mo></msubsup></msub><mo id="S3.Ex5.m1.4.4.3.3.3.8" stretchy="false" xref="S3.Ex5.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.4b"><apply id="S3.Ex5.m1.4.4.cmml" xref="S3.Ex5.m1.4.4"><eq id="S3.Ex5.m1.4.4.4.cmml" xref="S3.Ex5.m1.4.4.4"></eq><apply id="S3.Ex5.m1.4.4.5.cmml" xref="S3.Ex5.m1.4.4.5"><csymbol cd="ambiguous" id="S3.Ex5.m1.4.4.5.1.cmml" xref="S3.Ex5.m1.4.4.5">subscript</csymbol><ci id="S3.Ex5.m1.4.4.5.2.cmml" xref="S3.Ex5.m1.4.4.5.2">𝑓</ci><apply id="S3.Ex5.m1.4.4.5.3.cmml" xref="S3.Ex5.m1.4.4.5.3"><times id="S3.Ex5.m1.4.4.5.3.1.cmml" xref="S3.Ex5.m1.4.4.5.3.1"></times><ci id="S3.Ex5.m1.4.4.5.3.2.cmml" xref="S3.Ex5.m1.4.4.5.3.2">𝑖</ci><cn id="S3.Ex5.m1.4.4.5.3.3.cmml" type="integer" xref="S3.Ex5.m1.4.4.5.3.3">2</cn><ci id="S3.Ex5.m1.4.4.5.3.4.cmml" xref="S3.Ex5.m1.4.4.5.3.4">𝑖</ci></apply></apply><apply id="S3.Ex5.m1.4.4.3.cmml" xref="S3.Ex5.m1.4.4.3"><times id="S3.Ex5.m1.4.4.3.4.cmml" xref="S3.Ex5.m1.4.4.3.4"></times><ci id="S3.Ex5.m1.4.4.3.5.cmml" xref="S3.Ex5.m1.4.4.3.5">concate</ci><vector id="S3.Ex5.m1.4.4.3.3.4.cmml" xref="S3.Ex5.m1.4.4.3.3.3"><apply id="S3.Ex5.m1.2.2.1.1.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.2">𝑒</ci><apply id="S3.Ex5.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex5.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex5.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.3.2.2">𝑖</ci><ci id="S3.Ex5.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.3.2.3">′</ci></apply><cn id="S3.Ex5.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S3.Ex5.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.Ex5.m1.3.3.2.2.2.2.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.3.3.2.2.2.2.1.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.Ex5.m1.3.3.2.2.2.2.2.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2.2">𝑒</ci><apply id="S3.Ex5.m1.3.3.2.2.2.2.3.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.3.3.2.2.2.2.3.1.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2.3">subscript</csymbol><apply id="S3.Ex5.m1.3.3.2.2.2.2.3.2.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.3.3.2.2.2.2.3.2.1.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2.3">superscript</csymbol><ci id="S3.Ex5.m1.3.3.2.2.2.2.3.2.2.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2.3.2.2">𝑖</ci><ci id="S3.Ex5.m1.3.3.2.2.2.2.3.2.3.cmml" xref="S3.Ex5.m1.3.3.2.2.2.2.3.2.3">′</ci></apply><cn id="S3.Ex5.m1.3.3.2.2.2.2.3.3.cmml" type="integer" xref="S3.Ex5.m1.3.3.2.2.2.2.3.3">2</cn></apply></apply><ci id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1">⋯</ci><apply id="S3.Ex5.m1.4.4.3.3.3.3.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.4.4.3.3.3.3.1.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.Ex5.m1.4.4.3.3.3.3.2.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.2">𝑒</ci><apply id="S3.Ex5.m1.4.4.3.3.3.3.3.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.4.4.3.3.3.3.3.1.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.3">subscript</csymbol><apply id="S3.Ex5.m1.4.4.3.3.3.3.3.2.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.4.4.3.3.3.3.3.2.1.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.3">superscript</csymbol><ci id="S3.Ex5.m1.4.4.3.3.3.3.3.2.2.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.3.2.2">𝑖</ci><ci id="S3.Ex5.m1.4.4.3.3.3.3.3.2.3.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.3.2.3">′</ci></apply><ci id="S3.Ex5.m1.4.4.3.3.3.3.3.3.cmml" xref="S3.Ex5.m1.4.4.3.3.3.3.3.3">𝑘</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.4c">f_{i2i}=\mathrm{concate}(e_{i^{\prime}_{1}},e_{i^{\prime}_{2}},\cdots,e_{i^{%
\prime}_{k}})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.4d">italic_f start_POSTSUBSCRIPT italic_i 2 italic_i end_POSTSUBSCRIPT = roman_concate ( italic_e start_POSTSUBSCRIPT italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ⋯ , italic_e start_POSTSUBSCRIPT italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.6">We summarize the process described in this unit as the function <math alttext="\mathrm{SimExtract}(target,sequence)" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m1.2"><semantics id="S3.SS3.p2.4.m1.2a"><mrow id="S3.SS3.p2.4.m1.2.2" xref="S3.SS3.p2.4.m1.2.2.cmml"><mi id="S3.SS3.p2.4.m1.2.2.4" xref="S3.SS3.p2.4.m1.2.2.4.cmml">SimExtract</mi><mo id="S3.SS3.p2.4.m1.2.2.3" xref="S3.SS3.p2.4.m1.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m1.2.2.2.2" xref="S3.SS3.p2.4.m1.2.2.2.3.cmml"><mo id="S3.SS3.p2.4.m1.2.2.2.2.3" stretchy="false" xref="S3.SS3.p2.4.m1.2.2.2.3.cmml">(</mo><mrow id="S3.SS3.p2.4.m1.1.1.1.1.1" xref="S3.SS3.p2.4.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.4.m1.1.1.1.1.1.2" xref="S3.SS3.p2.4.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS3.p2.4.m1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.1.1.1.1.1.3" xref="S3.SS3.p2.4.m1.1.1.1.1.1.3.cmml">a</mi><mo id="S3.SS3.p2.4.m1.1.1.1.1.1.1a" xref="S3.SS3.p2.4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.1.1.1.1.1.4" xref="S3.SS3.p2.4.m1.1.1.1.1.1.4.cmml">r</mi><mo id="S3.SS3.p2.4.m1.1.1.1.1.1.1b" xref="S3.SS3.p2.4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.1.1.1.1.1.5" xref="S3.SS3.p2.4.m1.1.1.1.1.1.5.cmml">g</mi><mo id="S3.SS3.p2.4.m1.1.1.1.1.1.1c" xref="S3.SS3.p2.4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.1.1.1.1.1.6" xref="S3.SS3.p2.4.m1.1.1.1.1.1.6.cmml">e</mi><mo id="S3.SS3.p2.4.m1.1.1.1.1.1.1d" xref="S3.SS3.p2.4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.1.1.1.1.1.7" xref="S3.SS3.p2.4.m1.1.1.1.1.1.7.cmml">t</mi></mrow><mo id="S3.SS3.p2.4.m1.2.2.2.2.4" xref="S3.SS3.p2.4.m1.2.2.2.3.cmml">,</mo><mrow id="S3.SS3.p2.4.m1.2.2.2.2.2" xref="S3.SS3.p2.4.m1.2.2.2.2.2.cmml"><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.2" xref="S3.SS3.p2.4.m1.2.2.2.2.2.2.cmml">s</mi><mo id="S3.SS3.p2.4.m1.2.2.2.2.2.1" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.3" xref="S3.SS3.p2.4.m1.2.2.2.2.2.3.cmml">e</mi><mo id="S3.SS3.p2.4.m1.2.2.2.2.2.1a" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.4" xref="S3.SS3.p2.4.m1.2.2.2.2.2.4.cmml">q</mi><mo id="S3.SS3.p2.4.m1.2.2.2.2.2.1b" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.5" xref="S3.SS3.p2.4.m1.2.2.2.2.2.5.cmml">u</mi><mo id="S3.SS3.p2.4.m1.2.2.2.2.2.1c" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.6" xref="S3.SS3.p2.4.m1.2.2.2.2.2.6.cmml">e</mi><mo id="S3.SS3.p2.4.m1.2.2.2.2.2.1d" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.7" xref="S3.SS3.p2.4.m1.2.2.2.2.2.7.cmml">n</mi><mo id="S3.SS3.p2.4.m1.2.2.2.2.2.1e" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.8" xref="S3.SS3.p2.4.m1.2.2.2.2.2.8.cmml">c</mi><mo id="S3.SS3.p2.4.m1.2.2.2.2.2.1f" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2.2.9" xref="S3.SS3.p2.4.m1.2.2.2.2.2.9.cmml">e</mi></mrow><mo id="S3.SS3.p2.4.m1.2.2.2.2.5" stretchy="false" xref="S3.SS3.p2.4.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.2b"><apply id="S3.SS3.p2.4.m1.2.2.cmml" xref="S3.SS3.p2.4.m1.2.2"><times id="S3.SS3.p2.4.m1.2.2.3.cmml" xref="S3.SS3.p2.4.m1.2.2.3"></times><ci id="S3.SS3.p2.4.m1.2.2.4.cmml" xref="S3.SS3.p2.4.m1.2.2.4">SimExtract</ci><interval closure="open" id="S3.SS3.p2.4.m1.2.2.2.3.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2"><apply id="S3.SS3.p2.4.m1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1"><times id="S3.SS3.p2.4.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1.1"></times><ci id="S3.SS3.p2.4.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1.2">𝑡</ci><ci id="S3.SS3.p2.4.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1.3">𝑎</ci><ci id="S3.SS3.p2.4.m1.1.1.1.1.1.4.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1.4">𝑟</ci><ci id="S3.SS3.p2.4.m1.1.1.1.1.1.5.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1.5">𝑔</ci><ci id="S3.SS3.p2.4.m1.1.1.1.1.1.6.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1.6">𝑒</ci><ci id="S3.SS3.p2.4.m1.1.1.1.1.1.7.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1.1.7">𝑡</ci></apply><apply id="S3.SS3.p2.4.m1.2.2.2.2.2.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2"><times id="S3.SS3.p2.4.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.1"></times><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.2">𝑠</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.3">𝑒</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.4.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.4">𝑞</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.5.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.5">𝑢</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.6.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.6">𝑒</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.7.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.7">𝑛</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.8.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.8">𝑐</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.2.9.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2.2.9">𝑒</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.2c">\mathrm{SimExtract}(target,sequence)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m1.2d">roman_SimExtract ( italic_t italic_a italic_r italic_g italic_e italic_t , italic_s italic_e italic_q italic_u italic_e italic_n italic_c italic_e )</annotation></semantics></math>, which gives a comprehensive representation of similarity between <math alttext="target" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m2.1"><semantics id="S3.SS3.p2.5.m2.1a"><mrow id="S3.SS3.p2.5.m2.1.1" xref="S3.SS3.p2.5.m2.1.1.cmml"><mi id="S3.SS3.p2.5.m2.1.1.2" xref="S3.SS3.p2.5.m2.1.1.2.cmml">t</mi><mo id="S3.SS3.p2.5.m2.1.1.1" xref="S3.SS3.p2.5.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m2.1.1.3" xref="S3.SS3.p2.5.m2.1.1.3.cmml">a</mi><mo id="S3.SS3.p2.5.m2.1.1.1a" xref="S3.SS3.p2.5.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m2.1.1.4" xref="S3.SS3.p2.5.m2.1.1.4.cmml">r</mi><mo id="S3.SS3.p2.5.m2.1.1.1b" xref="S3.SS3.p2.5.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m2.1.1.5" xref="S3.SS3.p2.5.m2.1.1.5.cmml">g</mi><mo id="S3.SS3.p2.5.m2.1.1.1c" xref="S3.SS3.p2.5.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m2.1.1.6" xref="S3.SS3.p2.5.m2.1.1.6.cmml">e</mi><mo id="S3.SS3.p2.5.m2.1.1.1d" xref="S3.SS3.p2.5.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m2.1.1.7" xref="S3.SS3.p2.5.m2.1.1.7.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.1b"><apply id="S3.SS3.p2.5.m2.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1"><times id="S3.SS3.p2.5.m2.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1.1"></times><ci id="S3.SS3.p2.5.m2.1.1.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2">𝑡</ci><ci id="S3.SS3.p2.5.m2.1.1.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3">𝑎</ci><ci id="S3.SS3.p2.5.m2.1.1.4.cmml" xref="S3.SS3.p2.5.m2.1.1.4">𝑟</ci><ci id="S3.SS3.p2.5.m2.1.1.5.cmml" xref="S3.SS3.p2.5.m2.1.1.5">𝑔</ci><ci id="S3.SS3.p2.5.m2.1.1.6.cmml" xref="S3.SS3.p2.5.m2.1.1.6">𝑒</ci><ci id="S3.SS3.p2.5.m2.1.1.7.cmml" xref="S3.SS3.p2.5.m2.1.1.7">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.1c">target</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m2.1d">italic_t italic_a italic_r italic_g italic_e italic_t</annotation></semantics></math> and <math alttext="sequence" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m3.1"><semantics id="S3.SS3.p2.6.m3.1a"><mrow id="S3.SS3.p2.6.m3.1.1" xref="S3.SS3.p2.6.m3.1.1.cmml"><mi id="S3.SS3.p2.6.m3.1.1.2" xref="S3.SS3.p2.6.m3.1.1.2.cmml">s</mi><mo id="S3.SS3.p2.6.m3.1.1.1" xref="S3.SS3.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m3.1.1.3" xref="S3.SS3.p2.6.m3.1.1.3.cmml">e</mi><mo id="S3.SS3.p2.6.m3.1.1.1a" xref="S3.SS3.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m3.1.1.4" xref="S3.SS3.p2.6.m3.1.1.4.cmml">q</mi><mo id="S3.SS3.p2.6.m3.1.1.1b" xref="S3.SS3.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m3.1.1.5" xref="S3.SS3.p2.6.m3.1.1.5.cmml">u</mi><mo id="S3.SS3.p2.6.m3.1.1.1c" xref="S3.SS3.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m3.1.1.6" xref="S3.SS3.p2.6.m3.1.1.6.cmml">e</mi><mo id="S3.SS3.p2.6.m3.1.1.1d" xref="S3.SS3.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m3.1.1.7" xref="S3.SS3.p2.6.m3.1.1.7.cmml">n</mi><mo id="S3.SS3.p2.6.m3.1.1.1e" xref="S3.SS3.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m3.1.1.8" xref="S3.SS3.p2.6.m3.1.1.8.cmml">c</mi><mo id="S3.SS3.p2.6.m3.1.1.1f" xref="S3.SS3.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m3.1.1.9" xref="S3.SS3.p2.6.m3.1.1.9.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m3.1b"><apply id="S3.SS3.p2.6.m3.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1"><times id="S3.SS3.p2.6.m3.1.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1.1"></times><ci id="S3.SS3.p2.6.m3.1.1.2.cmml" xref="S3.SS3.p2.6.m3.1.1.2">𝑠</ci><ci id="S3.SS3.p2.6.m3.1.1.3.cmml" xref="S3.SS3.p2.6.m3.1.1.3">𝑒</ci><ci id="S3.SS3.p2.6.m3.1.1.4.cmml" xref="S3.SS3.p2.6.m3.1.1.4">𝑞</ci><ci id="S3.SS3.p2.6.m3.1.1.5.cmml" xref="S3.SS3.p2.6.m3.1.1.5">𝑢</ci><ci id="S3.SS3.p2.6.m3.1.1.6.cmml" xref="S3.SS3.p2.6.m3.1.1.6">𝑒</ci><ci id="S3.SS3.p2.6.m3.1.1.7.cmml" xref="S3.SS3.p2.6.m3.1.1.7">𝑛</ci><ci id="S3.SS3.p2.6.m3.1.1.8.cmml" xref="S3.SS3.p2.6.m3.1.1.8">𝑐</ci><ci id="S3.SS3.p2.6.m3.1.1.9.cmml" xref="S3.SS3.p2.6.m3.1.1.9">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m3.1c">sequence</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m3.1d">italic_s italic_e italic_q italic_u italic_e italic_n italic_c italic_e</annotation></semantics></math>. Therefore i2i feature can also be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{i2i}=\mathrm{SimExtract}(i_{t},I)" class="ltx_Math" display="block" id="S3.Ex6.m1.2"><semantics id="S3.Ex6.m1.2a"><mrow id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml"><msub id="S3.Ex6.m1.2.2.3" xref="S3.Ex6.m1.2.2.3.cmml"><mi id="S3.Ex6.m1.2.2.3.2" xref="S3.Ex6.m1.2.2.3.2.cmml">f</mi><mrow id="S3.Ex6.m1.2.2.3.3" xref="S3.Ex6.m1.2.2.3.3.cmml"><mi id="S3.Ex6.m1.2.2.3.3.2" xref="S3.Ex6.m1.2.2.3.3.2.cmml">i</mi><mo id="S3.Ex6.m1.2.2.3.3.1" xref="S3.Ex6.m1.2.2.3.3.1.cmml">⁢</mo><mn id="S3.Ex6.m1.2.2.3.3.3" xref="S3.Ex6.m1.2.2.3.3.3.cmml">2</mn><mo id="S3.Ex6.m1.2.2.3.3.1a" xref="S3.Ex6.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.2.2.3.3.4" xref="S3.Ex6.m1.2.2.3.3.4.cmml">i</mi></mrow></msub><mo id="S3.Ex6.m1.2.2.2" xref="S3.Ex6.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex6.m1.2.2.1" xref="S3.Ex6.m1.2.2.1.cmml"><mi id="S3.Ex6.m1.2.2.1.3" xref="S3.Ex6.m1.2.2.1.3.cmml">SimExtract</mi><mo id="S3.Ex6.m1.2.2.1.2" xref="S3.Ex6.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.2.2.1.1.1" xref="S3.Ex6.m1.2.2.1.1.2.cmml"><mo id="S3.Ex6.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex6.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.Ex6.m1.2.2.1.1.1.1" xref="S3.Ex6.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex6.m1.2.2.1.1.1.1.2" xref="S3.Ex6.m1.2.2.1.1.1.1.2.cmml">i</mi><mi id="S3.Ex6.m1.2.2.1.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex6.m1.2.2.1.1.1.3" xref="S3.Ex6.m1.2.2.1.1.2.cmml">,</mo><mi id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml">I</mi><mo id="S3.Ex6.m1.2.2.1.1.1.4" stretchy="false" xref="S3.Ex6.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.2b"><apply id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2"><eq id="S3.Ex6.m1.2.2.2.cmml" xref="S3.Ex6.m1.2.2.2"></eq><apply id="S3.Ex6.m1.2.2.3.cmml" xref="S3.Ex6.m1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.3.1.cmml" xref="S3.Ex6.m1.2.2.3">subscript</csymbol><ci id="S3.Ex6.m1.2.2.3.2.cmml" xref="S3.Ex6.m1.2.2.3.2">𝑓</ci><apply id="S3.Ex6.m1.2.2.3.3.cmml" xref="S3.Ex6.m1.2.2.3.3"><times id="S3.Ex6.m1.2.2.3.3.1.cmml" xref="S3.Ex6.m1.2.2.3.3.1"></times><ci id="S3.Ex6.m1.2.2.3.3.2.cmml" xref="S3.Ex6.m1.2.2.3.3.2">𝑖</ci><cn id="S3.Ex6.m1.2.2.3.3.3.cmml" type="integer" xref="S3.Ex6.m1.2.2.3.3.3">2</cn><ci id="S3.Ex6.m1.2.2.3.3.4.cmml" xref="S3.Ex6.m1.2.2.3.3.4">𝑖</ci></apply></apply><apply id="S3.Ex6.m1.2.2.1.cmml" xref="S3.Ex6.m1.2.2.1"><times id="S3.Ex6.m1.2.2.1.2.cmml" xref="S3.Ex6.m1.2.2.1.2"></times><ci id="S3.Ex6.m1.2.2.1.3.cmml" xref="S3.Ex6.m1.2.2.1.3">SimExtract</ci><interval closure="open" id="S3.Ex6.m1.2.2.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1"><apply id="S3.Ex6.m1.2.2.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.Ex6.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.2">𝑖</ci><ci id="S3.Ex6.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex6.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">𝐼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.2c">f_{i2i}=\mathrm{SimExtract}(i_{t},I)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.2d">italic_f start_POSTSUBSCRIPT italic_i 2 italic_i end_POSTSUBSCRIPT = roman_SimExtract ( italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.1.1">Query interest unit.</span>
In addition to the item2item relationship that demonstrates whether the target item is similar to the historical items, we want to apply the same logic to query sequence to describe the relationship between queries which reveal users’ explicit search interests.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.2">Following item interest layer, given current query <math alttext="q_{t}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">q</mi><mi id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝑞</ci><ci id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">q_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and query sequence <math alttext="Q=q_{k}(k=1,2,\cdots,m)" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.5"><semantics id="S3.SS3.p4.2.m2.5a"><mrow id="S3.SS3.p4.2.m2.5.5" xref="S3.SS3.p4.2.m2.5.5.cmml"><mi id="S3.SS3.p4.2.m2.5.5.3" xref="S3.SS3.p4.2.m2.5.5.3.cmml">Q</mi><mo id="S3.SS3.p4.2.m2.5.5.2" xref="S3.SS3.p4.2.m2.5.5.2.cmml">=</mo><mrow id="S3.SS3.p4.2.m2.5.5.1" xref="S3.SS3.p4.2.m2.5.5.1.cmml"><msub id="S3.SS3.p4.2.m2.5.5.1.3" xref="S3.SS3.p4.2.m2.5.5.1.3.cmml"><mi id="S3.SS3.p4.2.m2.5.5.1.3.2" xref="S3.SS3.p4.2.m2.5.5.1.3.2.cmml">q</mi><mi id="S3.SS3.p4.2.m2.5.5.1.3.3" xref="S3.SS3.p4.2.m2.5.5.1.3.3.cmml">k</mi></msub><mo id="S3.SS3.p4.2.m2.5.5.1.2" xref="S3.SS3.p4.2.m2.5.5.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.2.m2.5.5.1.1.1" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.cmml"><mo id="S3.SS3.p4.2.m2.5.5.1.1.1.2" stretchy="false" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p4.2.m2.5.5.1.1.1.1" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.cmml"><mi id="S3.SS3.p4.2.m2.5.5.1.1.1.1.2" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.2.cmml">k</mi><mo id="S3.SS3.p4.2.m2.5.5.1.1.1.1.1" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.2" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.1.cmml"><mn id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">1</mn><mo id="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.2.1" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.1.cmml">,</mo><mn id="S3.SS3.p4.2.m2.2.2" xref="S3.SS3.p4.2.m2.2.2.cmml">2</mn><mo id="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.2.2" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p4.2.m2.3.3" mathvariant="normal" xref="S3.SS3.p4.2.m2.3.3.cmml">⋯</mi><mo id="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.2.3" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p4.2.m2.4.4" xref="S3.SS3.p4.2.m2.4.4.cmml">m</mi></mrow></mrow><mo id="S3.SS3.p4.2.m2.5.5.1.1.1.3" stretchy="false" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.5b"><apply id="S3.SS3.p4.2.m2.5.5.cmml" xref="S3.SS3.p4.2.m2.5.5"><eq id="S3.SS3.p4.2.m2.5.5.2.cmml" xref="S3.SS3.p4.2.m2.5.5.2"></eq><ci id="S3.SS3.p4.2.m2.5.5.3.cmml" xref="S3.SS3.p4.2.m2.5.5.3">𝑄</ci><apply id="S3.SS3.p4.2.m2.5.5.1.cmml" xref="S3.SS3.p4.2.m2.5.5.1"><times id="S3.SS3.p4.2.m2.5.5.1.2.cmml" xref="S3.SS3.p4.2.m2.5.5.1.2"></times><apply id="S3.SS3.p4.2.m2.5.5.1.3.cmml" xref="S3.SS3.p4.2.m2.5.5.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.5.5.1.3.1.cmml" xref="S3.SS3.p4.2.m2.5.5.1.3">subscript</csymbol><ci id="S3.SS3.p4.2.m2.5.5.1.3.2.cmml" xref="S3.SS3.p4.2.m2.5.5.1.3.2">𝑞</ci><ci id="S3.SS3.p4.2.m2.5.5.1.3.3.cmml" xref="S3.SS3.p4.2.m2.5.5.1.3.3">𝑘</ci></apply><apply id="S3.SS3.p4.2.m2.5.5.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.5.5.1.1.1"><eq id="S3.SS3.p4.2.m2.5.5.1.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.1"></eq><ci id="S3.SS3.p4.2.m2.5.5.1.1.1.1.2.cmml" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.2">𝑘</ci><list id="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.5.5.1.1.1.1.3.2"><cn id="S3.SS3.p4.2.m2.1.1.cmml" type="integer" xref="S3.SS3.p4.2.m2.1.1">1</cn><cn id="S3.SS3.p4.2.m2.2.2.cmml" type="integer" xref="S3.SS3.p4.2.m2.2.2">2</cn><ci id="S3.SS3.p4.2.m2.3.3.cmml" xref="S3.SS3.p4.2.m2.3.3">⋯</ci><ci id="S3.SS3.p4.2.m2.4.4.cmml" xref="S3.SS3.p4.2.m2.4.4">𝑚</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.5c">Q=q_{k}(k=1,2,\cdots,m)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.5d">italic_Q = italic_q start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_k = 1 , 2 , ⋯ , italic_m )</annotation></semantics></math>, we get q2q feature by top-k retrieval, binning and positional embedding:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{q2q}=\mathrm{SimExtract}(q_{t},Q)" class="ltx_Math" display="block" id="S3.Ex7.m1.2"><semantics id="S3.Ex7.m1.2a"><mrow id="S3.Ex7.m1.2.2" xref="S3.Ex7.m1.2.2.cmml"><msub id="S3.Ex7.m1.2.2.3" xref="S3.Ex7.m1.2.2.3.cmml"><mi id="S3.Ex7.m1.2.2.3.2" xref="S3.Ex7.m1.2.2.3.2.cmml">f</mi><mrow id="S3.Ex7.m1.2.2.3.3" xref="S3.Ex7.m1.2.2.3.3.cmml"><mi id="S3.Ex7.m1.2.2.3.3.2" xref="S3.Ex7.m1.2.2.3.3.2.cmml">q</mi><mo id="S3.Ex7.m1.2.2.3.3.1" xref="S3.Ex7.m1.2.2.3.3.1.cmml">⁢</mo><mn id="S3.Ex7.m1.2.2.3.3.3" xref="S3.Ex7.m1.2.2.3.3.3.cmml">2</mn><mo id="S3.Ex7.m1.2.2.3.3.1a" xref="S3.Ex7.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.Ex7.m1.2.2.3.3.4" xref="S3.Ex7.m1.2.2.3.3.4.cmml">q</mi></mrow></msub><mo id="S3.Ex7.m1.2.2.2" xref="S3.Ex7.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex7.m1.2.2.1" xref="S3.Ex7.m1.2.2.1.cmml"><mi id="S3.Ex7.m1.2.2.1.3" xref="S3.Ex7.m1.2.2.1.3.cmml">SimExtract</mi><mo id="S3.Ex7.m1.2.2.1.2" xref="S3.Ex7.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.2.2.1.1.1" xref="S3.Ex7.m1.2.2.1.1.2.cmml"><mo id="S3.Ex7.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex7.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.Ex7.m1.2.2.1.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex7.m1.2.2.1.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.1.2.cmml">q</mi><mi id="S3.Ex7.m1.2.2.1.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex7.m1.2.2.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.2.cmml">,</mo><mi id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml">Q</mi><mo id="S3.Ex7.m1.2.2.1.1.1.4" stretchy="false" xref="S3.Ex7.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.2b"><apply id="S3.Ex7.m1.2.2.cmml" xref="S3.Ex7.m1.2.2"><eq id="S3.Ex7.m1.2.2.2.cmml" xref="S3.Ex7.m1.2.2.2"></eq><apply id="S3.Ex7.m1.2.2.3.cmml" xref="S3.Ex7.m1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.3.1.cmml" xref="S3.Ex7.m1.2.2.3">subscript</csymbol><ci id="S3.Ex7.m1.2.2.3.2.cmml" xref="S3.Ex7.m1.2.2.3.2">𝑓</ci><apply id="S3.Ex7.m1.2.2.3.3.cmml" xref="S3.Ex7.m1.2.2.3.3"><times id="S3.Ex7.m1.2.2.3.3.1.cmml" xref="S3.Ex7.m1.2.2.3.3.1"></times><ci id="S3.Ex7.m1.2.2.3.3.2.cmml" xref="S3.Ex7.m1.2.2.3.3.2">𝑞</ci><cn id="S3.Ex7.m1.2.2.3.3.3.cmml" type="integer" xref="S3.Ex7.m1.2.2.3.3.3">2</cn><ci id="S3.Ex7.m1.2.2.3.3.4.cmml" xref="S3.Ex7.m1.2.2.3.3.4">𝑞</ci></apply></apply><apply id="S3.Ex7.m1.2.2.1.cmml" xref="S3.Ex7.m1.2.2.1"><times id="S3.Ex7.m1.2.2.1.2.cmml" xref="S3.Ex7.m1.2.2.1.2"></times><ci id="S3.Ex7.m1.2.2.1.3.cmml" xref="S3.Ex7.m1.2.2.1.3">SimExtract</ci><interval closure="open" id="S3.Ex7.m1.2.2.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1"><apply id="S3.Ex7.m1.2.2.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.Ex7.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.2">𝑞</ci><ci id="S3.Ex7.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1">𝑄</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.2c">f_{q2q}=\mathrm{SimExtract}(q_{t},Q)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.2d">italic_f start_POSTSUBSCRIPT italic_q 2 italic_q end_POSTSUBSCRIPT = roman_SimExtract ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_Q )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p5.1.1">Query-item compatibility unit.</span>
Relationships between current query and historical items supplement the pure item-based or query-based interest representation and further utilize the correlation between query and items corresponding to the heterogeneous graph structure. We call this relationship query-item compatibility because it describes how well the current query is compatible with the user’s interested items.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.2">Here we also adopt the same methods to produce the compatibility information given the current query <math alttext="q_{t}" class="ltx_Math" display="inline" id="S3.SS3.p6.1.m1.1"><semantics id="S3.SS3.p6.1.m1.1a"><msub id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml"><mi id="S3.SS3.p6.1.m1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.2.cmml">q</mi><mi id="S3.SS3.p6.1.m1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p6.1.m1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2">𝑞</ci><ci id="S3.SS3.p6.1.m1.1.1.3.cmml" xref="S3.SS3.p6.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">q_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and historical click sequence <math alttext="I" class="ltx_Math" display="inline" id="S3.SS3.p6.2.m2.1"><semantics id="S3.SS3.p6.2.m2.1a"><mi id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><ci id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.2.m2.1d">italic_I</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{q2i}=\mathrm{SimExtract}(q_{t},I)" class="ltx_Math" display="block" id="S3.Ex8.m1.2"><semantics id="S3.Ex8.m1.2a"><mrow id="S3.Ex8.m1.2.2" xref="S3.Ex8.m1.2.2.cmml"><msub id="S3.Ex8.m1.2.2.3" xref="S3.Ex8.m1.2.2.3.cmml"><mi id="S3.Ex8.m1.2.2.3.2" xref="S3.Ex8.m1.2.2.3.2.cmml">f</mi><mrow id="S3.Ex8.m1.2.2.3.3" xref="S3.Ex8.m1.2.2.3.3.cmml"><mi id="S3.Ex8.m1.2.2.3.3.2" xref="S3.Ex8.m1.2.2.3.3.2.cmml">q</mi><mo id="S3.Ex8.m1.2.2.3.3.1" xref="S3.Ex8.m1.2.2.3.3.1.cmml">⁢</mo><mn id="S3.Ex8.m1.2.2.3.3.3" xref="S3.Ex8.m1.2.2.3.3.3.cmml">2</mn><mo id="S3.Ex8.m1.2.2.3.3.1a" xref="S3.Ex8.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.Ex8.m1.2.2.3.3.4" xref="S3.Ex8.m1.2.2.3.3.4.cmml">i</mi></mrow></msub><mo id="S3.Ex8.m1.2.2.2" xref="S3.Ex8.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex8.m1.2.2.1" xref="S3.Ex8.m1.2.2.1.cmml"><mi id="S3.Ex8.m1.2.2.1.3" xref="S3.Ex8.m1.2.2.1.3.cmml">SimExtract</mi><mo id="S3.Ex8.m1.2.2.1.2" xref="S3.Ex8.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex8.m1.2.2.1.1.1" xref="S3.Ex8.m1.2.2.1.1.2.cmml"><mo id="S3.Ex8.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex8.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.Ex8.m1.2.2.1.1.1.1" xref="S3.Ex8.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex8.m1.2.2.1.1.1.1.2" xref="S3.Ex8.m1.2.2.1.1.1.1.2.cmml">q</mi><mi id="S3.Ex8.m1.2.2.1.1.1.1.3" xref="S3.Ex8.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex8.m1.2.2.1.1.1.3" xref="S3.Ex8.m1.2.2.1.1.2.cmml">,</mo><mi id="S3.Ex8.m1.1.1" xref="S3.Ex8.m1.1.1.cmml">I</mi><mo id="S3.Ex8.m1.2.2.1.1.1.4" stretchy="false" xref="S3.Ex8.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8.m1.2b"><apply id="S3.Ex8.m1.2.2.cmml" xref="S3.Ex8.m1.2.2"><eq id="S3.Ex8.m1.2.2.2.cmml" xref="S3.Ex8.m1.2.2.2"></eq><apply id="S3.Ex8.m1.2.2.3.cmml" xref="S3.Ex8.m1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.2.3.1.cmml" xref="S3.Ex8.m1.2.2.3">subscript</csymbol><ci id="S3.Ex8.m1.2.2.3.2.cmml" xref="S3.Ex8.m1.2.2.3.2">𝑓</ci><apply id="S3.Ex8.m1.2.2.3.3.cmml" xref="S3.Ex8.m1.2.2.3.3"><times id="S3.Ex8.m1.2.2.3.3.1.cmml" xref="S3.Ex8.m1.2.2.3.3.1"></times><ci id="S3.Ex8.m1.2.2.3.3.2.cmml" xref="S3.Ex8.m1.2.2.3.3.2">𝑞</ci><cn id="S3.Ex8.m1.2.2.3.3.3.cmml" type="integer" xref="S3.Ex8.m1.2.2.3.3.3">2</cn><ci id="S3.Ex8.m1.2.2.3.3.4.cmml" xref="S3.Ex8.m1.2.2.3.3.4">𝑖</ci></apply></apply><apply id="S3.Ex8.m1.2.2.1.cmml" xref="S3.Ex8.m1.2.2.1"><times id="S3.Ex8.m1.2.2.1.2.cmml" xref="S3.Ex8.m1.2.2.1.2"></times><ci id="S3.Ex8.m1.2.2.1.3.cmml" xref="S3.Ex8.m1.2.2.1.3">SimExtract</ci><interval closure="open" id="S3.Ex8.m1.2.2.1.1.2.cmml" xref="S3.Ex8.m1.2.2.1.1.1"><apply id="S3.Ex8.m1.2.2.1.1.1.1.cmml" xref="S3.Ex8.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex8.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex8.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.Ex8.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex8.m1.2.2.1.1.1.1.2">𝑞</ci><ci id="S3.Ex8.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex8.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex8.m1.1.1.cmml" xref="S3.Ex8.m1.1.1">𝐼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8.m1.2c">f_{q2i}=\mathrm{SimExtract}(q_{t},I)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8.m1.2d">italic_f start_POSTSUBSCRIPT italic_q 2 italic_i end_POSTSUBSCRIPT = roman_SimExtract ( italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.4"><span class="ltx_text ltx_font_bold" id="S3.SS3.p7.4.1">CTR prediction layer.</span>
We concatenate the aforementioned features <math alttext="f_{i2i}" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.1"><semantics id="S3.SS3.p7.1.m1.1a"><msub id="S3.SS3.p7.1.m1.1.1" xref="S3.SS3.p7.1.m1.1.1.cmml"><mi id="S3.SS3.p7.1.m1.1.1.2" xref="S3.SS3.p7.1.m1.1.1.2.cmml">f</mi><mrow id="S3.SS3.p7.1.m1.1.1.3" xref="S3.SS3.p7.1.m1.1.1.3.cmml"><mi id="S3.SS3.p7.1.m1.1.1.3.2" xref="S3.SS3.p7.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p7.1.m1.1.1.3.1" xref="S3.SS3.p7.1.m1.1.1.3.1.cmml">⁢</mo><mn id="S3.SS3.p7.1.m1.1.1.3.3" xref="S3.SS3.p7.1.m1.1.1.3.3.cmml">2</mn><mo id="S3.SS3.p7.1.m1.1.1.3.1a" xref="S3.SS3.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p7.1.m1.1.1.3.4" xref="S3.SS3.p7.1.m1.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.1b"><apply id="S3.SS3.p7.1.m1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p7.1.m1.1.1.2.cmml" xref="S3.SS3.p7.1.m1.1.1.2">𝑓</ci><apply id="S3.SS3.p7.1.m1.1.1.3.cmml" xref="S3.SS3.p7.1.m1.1.1.3"><times id="S3.SS3.p7.1.m1.1.1.3.1.cmml" xref="S3.SS3.p7.1.m1.1.1.3.1"></times><ci id="S3.SS3.p7.1.m1.1.1.3.2.cmml" xref="S3.SS3.p7.1.m1.1.1.3.2">𝑖</ci><cn id="S3.SS3.p7.1.m1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p7.1.m1.1.1.3.3">2</cn><ci id="S3.SS3.p7.1.m1.1.1.3.4.cmml" xref="S3.SS3.p7.1.m1.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.1c">f_{i2i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_i 2 italic_i end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="f_{q2q}" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.1"><semantics id="S3.SS3.p7.2.m2.1a"><msub id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml"><mi id="S3.SS3.p7.2.m2.1.1.2" xref="S3.SS3.p7.2.m2.1.1.2.cmml">f</mi><mrow id="S3.SS3.p7.2.m2.1.1.3" xref="S3.SS3.p7.2.m2.1.1.3.cmml"><mi id="S3.SS3.p7.2.m2.1.1.3.2" xref="S3.SS3.p7.2.m2.1.1.3.2.cmml">q</mi><mo id="S3.SS3.p7.2.m2.1.1.3.1" xref="S3.SS3.p7.2.m2.1.1.3.1.cmml">⁢</mo><mn id="S3.SS3.p7.2.m2.1.1.3.3" xref="S3.SS3.p7.2.m2.1.1.3.3.cmml">2</mn><mo id="S3.SS3.p7.2.m2.1.1.3.1a" xref="S3.SS3.p7.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p7.2.m2.1.1.3.4" xref="S3.SS3.p7.2.m2.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.1b"><apply id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p7.2.m2.1.1.2.cmml" xref="S3.SS3.p7.2.m2.1.1.2">𝑓</ci><apply id="S3.SS3.p7.2.m2.1.1.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3"><times id="S3.SS3.p7.2.m2.1.1.3.1.cmml" xref="S3.SS3.p7.2.m2.1.1.3.1"></times><ci id="S3.SS3.p7.2.m2.1.1.3.2.cmml" xref="S3.SS3.p7.2.m2.1.1.3.2">𝑞</ci><cn id="S3.SS3.p7.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p7.2.m2.1.1.3.3">2</cn><ci id="S3.SS3.p7.2.m2.1.1.3.4.cmml" xref="S3.SS3.p7.2.m2.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.1c">f_{q2q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_q 2 italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="f_{q2i}" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.1"><semantics id="S3.SS3.p7.3.m3.1a"><msub id="S3.SS3.p7.3.m3.1.1" xref="S3.SS3.p7.3.m3.1.1.cmml"><mi id="S3.SS3.p7.3.m3.1.1.2" xref="S3.SS3.p7.3.m3.1.1.2.cmml">f</mi><mrow id="S3.SS3.p7.3.m3.1.1.3" xref="S3.SS3.p7.3.m3.1.1.3.cmml"><mi id="S3.SS3.p7.3.m3.1.1.3.2" xref="S3.SS3.p7.3.m3.1.1.3.2.cmml">q</mi><mo id="S3.SS3.p7.3.m3.1.1.3.1" xref="S3.SS3.p7.3.m3.1.1.3.1.cmml">⁢</mo><mn id="S3.SS3.p7.3.m3.1.1.3.3" xref="S3.SS3.p7.3.m3.1.1.3.3.cmml">2</mn><mo id="S3.SS3.p7.3.m3.1.1.3.1a" xref="S3.SS3.p7.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p7.3.m3.1.1.3.4" xref="S3.SS3.p7.3.m3.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.1b"><apply id="S3.SS3.p7.3.m3.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.1.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p7.3.m3.1.1.2.cmml" xref="S3.SS3.p7.3.m3.1.1.2">𝑓</ci><apply id="S3.SS3.p7.3.m3.1.1.3.cmml" xref="S3.SS3.p7.3.m3.1.1.3"><times id="S3.SS3.p7.3.m3.1.1.3.1.cmml" xref="S3.SS3.p7.3.m3.1.1.3.1"></times><ci id="S3.SS3.p7.3.m3.1.1.3.2.cmml" xref="S3.SS3.p7.3.m3.1.1.3.2">𝑞</ci><cn id="S3.SS3.p7.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS3.p7.3.m3.1.1.3.3">2</cn><ci id="S3.SS3.p7.3.m3.1.1.3.4.cmml" xref="S3.SS3.p7.3.m3.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.1c">f_{q2i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_q 2 italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and other features <math alttext="f_{o}" class="ltx_Math" display="inline" id="S3.SS3.p7.4.m4.1"><semantics id="S3.SS3.p7.4.m4.1a"><msub id="S3.SS3.p7.4.m4.1.1" xref="S3.SS3.p7.4.m4.1.1.cmml"><mi id="S3.SS3.p7.4.m4.1.1.2" xref="S3.SS3.p7.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS3.p7.4.m4.1.1.3" xref="S3.SS3.p7.4.m4.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.4.m4.1b"><apply id="S3.SS3.p7.4.m4.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.4.m4.1.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p7.4.m4.1.1.2.cmml" xref="S3.SS3.p7.4.m4.1.1.2">𝑓</ci><ci id="S3.SS3.p7.4.m4.1.1.3.cmml" xref="S3.SS3.p7.4.m4.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.4.m4.1c">f_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>, then feed them into an MLP layer for final CTR prediction:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{pctr}=\mathrm{sigmoid}(\mathrm{MLP}(\mathrm{concate}(f_{i2i},f_{q2q},f%
_{q2i},f_{o})))" class="ltx_Math" display="block" id="S3.Ex9.m1.1"><semantics id="S3.Ex9.m1.1a"><mrow id="S3.Ex9.m1.1.1" xref="S3.Ex9.m1.1.1.cmml"><mi id="S3.Ex9.m1.1.1.3" xref="S3.Ex9.m1.1.1.3.cmml">pctr</mi><mo id="S3.Ex9.m1.1.1.2" xref="S3.Ex9.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex9.m1.1.1.1" xref="S3.Ex9.m1.1.1.1.cmml"><mi id="S3.Ex9.m1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.3.cmml">sigmoid</mi><mo id="S3.Ex9.m1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex9.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.1.3.cmml">MLP</mi><mo id="S3.Ex9.m1.1.1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.6" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.6.cmml">concate</mi><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.5" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.5.cmml">⁢</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.5.cmml"><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.5" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.5.cmml">(</mo><msub id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mn id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">i</mi></mrow></msub><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.6" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">f</mi><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">q</mi><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mn id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">2</mn><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1a" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.4" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.4.cmml">q</mi></mrow></msub><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.7" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">f</mi><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">q</mi><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mn id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">2</mn><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.1a" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4.cmml">i</mi></mrow></msub><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.8" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml">f</mi><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.3.cmml">o</mi></msub><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.9" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.5.cmml">)</mo></mrow></mrow><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex9.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m1.1b"><apply id="S3.Ex9.m1.1.1.cmml" xref="S3.Ex9.m1.1.1"><eq id="S3.Ex9.m1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.2"></eq><ci id="S3.Ex9.m1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.3">pctr</ci><apply id="S3.Ex9.m1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1"><times id="S3.Ex9.m1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.2"></times><ci id="S3.Ex9.m1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.3">sigmoid</ci><apply id="S3.Ex9.m1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1"><times id="S3.Ex9.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.2"></times><ci id="S3.Ex9.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.3">MLP</ci><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1"><times id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.5"></times><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.6">concate</ci><vector id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.5.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4"><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑓</ci><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">2</cn><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4">𝑖</ci></apply></apply><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑓</ci><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3"><times id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2">𝑞</ci><cn id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3">2</cn><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.4.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.4">𝑞</ci></apply></apply><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑓</ci><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3"><times id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.2">𝑞</ci><cn id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.3">2</cn><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.4">𝑖</ci></apply></apply><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.2">𝑓</ci><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.4.4.4.3">𝑜</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m1.1c">\mathrm{pctr}=\mathrm{sigmoid}(\mathrm{MLP}(\mathrm{concate}(f_{i2i},f_{q2q},f%
_{q2i},f_{o})))</annotation><annotation encoding="application/x-llamapun" id="S3.Ex9.m1.1d">roman_pctr = roman_sigmoid ( roman_MLP ( roman_concate ( italic_f start_POSTSUBSCRIPT italic_i 2 italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_q 2 italic_q end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_q 2 italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p7.10">The objective function of the multi-interest network is the cross entropy loss function as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{CTR}=-\frac{1}{N}\sum_{i=0}^{N}y_{i}{\mathrm{log}(\mathrm{pctr}_{i})}+(1-y_%
{i}){\mathrm{log}(1-\mathrm{pctr}_{i})}" class="ltx_Math" display="block" id="S3.Ex10.m1.3"><semantics id="S3.Ex10.m1.3a"><mrow id="S3.Ex10.m1.3.3" xref="S3.Ex10.m1.3.3.cmml"><msub id="S3.Ex10.m1.3.3.5" xref="S3.Ex10.m1.3.3.5.cmml"><mi id="S3.Ex10.m1.3.3.5.2" xref="S3.Ex10.m1.3.3.5.2.cmml">L</mi><mrow id="S3.Ex10.m1.3.3.5.3" xref="S3.Ex10.m1.3.3.5.3.cmml"><mi id="S3.Ex10.m1.3.3.5.3.2" xref="S3.Ex10.m1.3.3.5.3.2.cmml">C</mi><mo id="S3.Ex10.m1.3.3.5.3.1" xref="S3.Ex10.m1.3.3.5.3.1.cmml">⁢</mo><mi id="S3.Ex10.m1.3.3.5.3.3" xref="S3.Ex10.m1.3.3.5.3.3.cmml">T</mi><mo id="S3.Ex10.m1.3.3.5.3.1a" xref="S3.Ex10.m1.3.3.5.3.1.cmml">⁢</mo><mi id="S3.Ex10.m1.3.3.5.3.4" xref="S3.Ex10.m1.3.3.5.3.4.cmml">R</mi></mrow></msub><mo id="S3.Ex10.m1.3.3.4" xref="S3.Ex10.m1.3.3.4.cmml">=</mo><mrow id="S3.Ex10.m1.3.3.3" xref="S3.Ex10.m1.3.3.3.cmml"><mrow id="S3.Ex10.m1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.cmml"><mo id="S3.Ex10.m1.1.1.1.1a" xref="S3.Ex10.m1.1.1.1.1.cmml">−</mo><mrow id="S3.Ex10.m1.1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.1.cmml"><mfrac id="S3.Ex10.m1.1.1.1.1.1.3" xref="S3.Ex10.m1.1.1.1.1.1.3.cmml"><mn id="S3.Ex10.m1.1.1.1.1.1.3.2" xref="S3.Ex10.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.Ex10.m1.1.1.1.1.1.3.3" xref="S3.Ex10.m1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.Ex10.m1.1.1.1.1.1.2" xref="S3.Ex10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex10.m1.1.1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex10.m1.1.1.1.1.1.1.2" xref="S3.Ex10.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex10.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mi id="S3.Ex10.m1.1.1.1.1.1.1.2.3" xref="S3.Ex10.m1.1.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.Ex10.m1.1.1.1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex10.m1.1.1.1.1.1.1.1.3" xref="S3.Ex10.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex10.m1.1.1.1.1.1.1.1.3.2" xref="S3.Ex10.m1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.Ex10.m1.1.1.1.1.1.1.1.3.3" xref="S3.Ex10.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex10.m1.1.1.1.1.1.1.1.2" xref="S3.Ex10.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex10.m1.1.1.1.1.1.1.1.4" xref="S3.Ex10.m1.1.1.1.1.1.1.1.4.cmml">log</mi><mo id="S3.Ex10.m1.1.1.1.1.1.1.1.2a" xref="S3.Ex10.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">pctr</mi><mi id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex10.m1.3.3.3.4" xref="S3.Ex10.m1.3.3.3.4.cmml">+</mo><mrow id="S3.Ex10.m1.3.3.3.3" xref="S3.Ex10.m1.3.3.3.3.cmml"><mrow id="S3.Ex10.m1.2.2.2.2.1.1" xref="S3.Ex10.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.Ex10.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.Ex10.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex10.m1.2.2.2.2.1.1.1" xref="S3.Ex10.m1.2.2.2.2.1.1.1.cmml"><mn id="S3.Ex10.m1.2.2.2.2.1.1.1.2" xref="S3.Ex10.m1.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="S3.Ex10.m1.2.2.2.2.1.1.1.1" xref="S3.Ex10.m1.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="S3.Ex10.m1.2.2.2.2.1.1.1.3" xref="S3.Ex10.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.Ex10.m1.2.2.2.2.1.1.1.3.2" xref="S3.Ex10.m1.2.2.2.2.1.1.1.3.2.cmml">y</mi><mi id="S3.Ex10.m1.2.2.2.2.1.1.1.3.3" xref="S3.Ex10.m1.2.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.Ex10.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.Ex10.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex10.m1.3.3.3.3.3" xref="S3.Ex10.m1.3.3.3.3.3.cmml">⁢</mo><mi id="S3.Ex10.m1.3.3.3.3.4" xref="S3.Ex10.m1.3.3.3.3.4.cmml">log</mi><mo id="S3.Ex10.m1.3.3.3.3.3a" xref="S3.Ex10.m1.3.3.3.3.3.cmml">⁢</mo><mrow id="S3.Ex10.m1.3.3.3.3.2.1" xref="S3.Ex10.m1.3.3.3.3.2.1.1.cmml"><mo id="S3.Ex10.m1.3.3.3.3.2.1.2" stretchy="false" xref="S3.Ex10.m1.3.3.3.3.2.1.1.cmml">(</mo><mrow id="S3.Ex10.m1.3.3.3.3.2.1.1" xref="S3.Ex10.m1.3.3.3.3.2.1.1.cmml"><mn id="S3.Ex10.m1.3.3.3.3.2.1.1.2" xref="S3.Ex10.m1.3.3.3.3.2.1.1.2.cmml">1</mn><mo id="S3.Ex10.m1.3.3.3.3.2.1.1.1" xref="S3.Ex10.m1.3.3.3.3.2.1.1.1.cmml">−</mo><msub id="S3.Ex10.m1.3.3.3.3.2.1.1.3" xref="S3.Ex10.m1.3.3.3.3.2.1.1.3.cmml"><mi id="S3.Ex10.m1.3.3.3.3.2.1.1.3.2" xref="S3.Ex10.m1.3.3.3.3.2.1.1.3.2.cmml">pctr</mi><mi id="S3.Ex10.m1.3.3.3.3.2.1.1.3.3" xref="S3.Ex10.m1.3.3.3.3.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.Ex10.m1.3.3.3.3.2.1.3" stretchy="false" xref="S3.Ex10.m1.3.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex10.m1.3b"><apply id="S3.Ex10.m1.3.3.cmml" xref="S3.Ex10.m1.3.3"><eq id="S3.Ex10.m1.3.3.4.cmml" xref="S3.Ex10.m1.3.3.4"></eq><apply id="S3.Ex10.m1.3.3.5.cmml" xref="S3.Ex10.m1.3.3.5"><csymbol cd="ambiguous" id="S3.Ex10.m1.3.3.5.1.cmml" xref="S3.Ex10.m1.3.3.5">subscript</csymbol><ci id="S3.Ex10.m1.3.3.5.2.cmml" xref="S3.Ex10.m1.3.3.5.2">𝐿</ci><apply id="S3.Ex10.m1.3.3.5.3.cmml" xref="S3.Ex10.m1.3.3.5.3"><times id="S3.Ex10.m1.3.3.5.3.1.cmml" xref="S3.Ex10.m1.3.3.5.3.1"></times><ci id="S3.Ex10.m1.3.3.5.3.2.cmml" xref="S3.Ex10.m1.3.3.5.3.2">𝐶</ci><ci id="S3.Ex10.m1.3.3.5.3.3.cmml" xref="S3.Ex10.m1.3.3.5.3.3">𝑇</ci><ci id="S3.Ex10.m1.3.3.5.3.4.cmml" xref="S3.Ex10.m1.3.3.5.3.4">𝑅</ci></apply></apply><apply id="S3.Ex10.m1.3.3.3.cmml" xref="S3.Ex10.m1.3.3.3"><plus id="S3.Ex10.m1.3.3.3.4.cmml" xref="S3.Ex10.m1.3.3.3.4"></plus><apply id="S3.Ex10.m1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1"><minus id="S3.Ex10.m1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.1.1.1.1"></minus><apply id="S3.Ex10.m1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1"><times id="S3.Ex10.m1.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.2"></times><apply id="S3.Ex10.m1.1.1.1.1.1.3.cmml" xref="S3.Ex10.m1.1.1.1.1.1.3"><divide id="S3.Ex10.m1.1.1.1.1.1.3.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.3"></divide><cn id="S3.Ex10.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.Ex10.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.Ex10.m1.1.1.1.1.1.3.3.cmml" xref="S3.Ex10.m1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.Ex10.m1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1"><apply id="S3.Ex10.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex10.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex10.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex10.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.Ex10.m1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><ci id="S3.Ex10.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.Ex10.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1"><times id="S3.Ex10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex10.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.Ex10.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="S3.Ex10.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.4">log</ci><apply id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.2">pctr</ci><ci id="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex10.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.Ex10.m1.3.3.3.3.cmml" xref="S3.Ex10.m1.3.3.3.3"><times id="S3.Ex10.m1.3.3.3.3.3.cmml" xref="S3.Ex10.m1.3.3.3.3.3"></times><apply id="S3.Ex10.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex10.m1.2.2.2.2.1.1"><minus id="S3.Ex10.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex10.m1.2.2.2.2.1.1.1.1"></minus><cn id="S3.Ex10.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S3.Ex10.m1.2.2.2.2.1.1.1.2">1</cn><apply id="S3.Ex10.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex10.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.Ex10.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex10.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.Ex10.m1.2.2.2.2.1.1.1.3.2">𝑦</ci><ci id="S3.Ex10.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.Ex10.m1.2.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.Ex10.m1.3.3.3.3.4.cmml" xref="S3.Ex10.m1.3.3.3.3.4">log</ci><apply id="S3.Ex10.m1.3.3.3.3.2.1.1.cmml" xref="S3.Ex10.m1.3.3.3.3.2.1"><minus id="S3.Ex10.m1.3.3.3.3.2.1.1.1.cmml" xref="S3.Ex10.m1.3.3.3.3.2.1.1.1"></minus><cn id="S3.Ex10.m1.3.3.3.3.2.1.1.2.cmml" type="integer" xref="S3.Ex10.m1.3.3.3.3.2.1.1.2">1</cn><apply id="S3.Ex10.m1.3.3.3.3.2.1.1.3.cmml" xref="S3.Ex10.m1.3.3.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex10.m1.3.3.3.3.2.1.1.3.1.cmml" xref="S3.Ex10.m1.3.3.3.3.2.1.1.3">subscript</csymbol><ci id="S3.Ex10.m1.3.3.3.3.2.1.1.3.2.cmml" xref="S3.Ex10.m1.3.3.3.3.2.1.1.3.2">pctr</ci><ci id="S3.Ex10.m1.3.3.3.3.2.1.1.3.3.cmml" xref="S3.Ex10.m1.3.3.3.3.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex10.m1.3c">L_{CTR}=-\frac{1}{N}\sum_{i=0}^{N}y_{i}{\mathrm{log}(\mathrm{pctr}_{i})}+(1-y_%
{i}){\mathrm{log}(1-\mathrm{pctr}_{i})}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex10.m1.3d">italic_L start_POSTSUBSCRIPT italic_C italic_T italic_R end_POSTSUBSCRIPT = - divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( roman_pctr start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log ( 1 - roman_pctr start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p7.9">Where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.p7.5.m1.1"><semantics id="S3.SS3.p7.5.m1.1a"><mi id="S3.SS3.p7.5.m1.1.1" xref="S3.SS3.p7.5.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.5.m1.1b"><ci id="S3.SS3.p7.5.m1.1.1.cmml" xref="S3.SS3.p7.5.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.5.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.5.m1.1d">italic_N</annotation></semantics></math> is the total number of samples, <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.p7.6.m2.1"><semantics id="S3.SS3.p7.6.m2.1a"><msub id="S3.SS3.p7.6.m2.1.1" xref="S3.SS3.p7.6.m2.1.1.cmml"><mi id="S3.SS3.p7.6.m2.1.1.2" xref="S3.SS3.p7.6.m2.1.1.2.cmml">y</mi><mi id="S3.SS3.p7.6.m2.1.1.3" xref="S3.SS3.p7.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.6.m2.1b"><apply id="S3.SS3.p7.6.m2.1.1.cmml" xref="S3.SS3.p7.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.6.m2.1.1.1.cmml" xref="S3.SS3.p7.6.m2.1.1">subscript</csymbol><ci id="S3.SS3.p7.6.m2.1.1.2.cmml" xref="S3.SS3.p7.6.m2.1.1.2">𝑦</ci><ci id="S3.SS3.p7.6.m2.1.1.3.cmml" xref="S3.SS3.p7.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.6.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.6.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the ground truth label of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p7.7.m3.1"><semantics id="S3.SS3.p7.7.m3.1a"><mi id="S3.SS3.p7.7.m3.1.1" xref="S3.SS3.p7.7.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.7.m3.1b"><ci id="S3.SS3.p7.7.m3.1.1.cmml" xref="S3.SS3.p7.7.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.7.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.7.m3.1d">italic_i</annotation></semantics></math>th sample, and <math alttext="\mathrm{pctr}_{i}" class="ltx_Math" display="inline" id="S3.SS3.p7.8.m4.1"><semantics id="S3.SS3.p7.8.m4.1a"><msub id="S3.SS3.p7.8.m4.1.1" xref="S3.SS3.p7.8.m4.1.1.cmml"><mi id="S3.SS3.p7.8.m4.1.1.2" xref="S3.SS3.p7.8.m4.1.1.2.cmml">pctr</mi><mi id="S3.SS3.p7.8.m4.1.1.3" xref="S3.SS3.p7.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.8.m4.1b"><apply id="S3.SS3.p7.8.m4.1.1.cmml" xref="S3.SS3.p7.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.8.m4.1.1.1.cmml" xref="S3.SS3.p7.8.m4.1.1">subscript</csymbol><ci id="S3.SS3.p7.8.m4.1.1.2.cmml" xref="S3.SS3.p7.8.m4.1.1.2">pctr</ci><ci id="S3.SS3.p7.8.m4.1.1.3.cmml" xref="S3.SS3.p7.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.8.m4.1c">\mathrm{pctr}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.8.m4.1d">roman_pctr start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the CTR prediction from EGIN of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p7.9.m5.1"><semantics id="S3.SS3.p7.9.m5.1a"><mi id="S3.SS3.p7.9.m5.1.1" xref="S3.SS3.p7.9.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.9.m5.1b"><ci id="S3.SS3.p7.9.m5.1.1.cmml" xref="S3.SS3.p7.9.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.9.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.9.m5.1d">italic_i</annotation></semantics></math>th sample.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>End-to-End Joint Training</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In most previous works, graph embedding learning takes a different form of input compared with the CTR prediction task. Also, they usually rely on graph engines to restore and sample graphs. These problems bring difficulties to end-to-end joint training of the two tasks. In previous sections, we introduce two key features of our proposed EGIN method: (i) light-weight graph sampling, (ii) unified input for graph and CTR prediction. Benefiting from the nature of EGIN, steam-style end-to-end training is effortless to implement in both offline and online scenarios.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S3.F1" title="Figure 1 ‣ 3. The Proposed Approach ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">1</span></a>, both tasks receive the same raw input sampled from search impression logs, and the training objectives of different parts of EGIN are jointly considered for model optimization:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L=L_{CTR}+\alpha L_{i2i}+\beta L_{q2q}+\gamma L_{q2i}" class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">L</mi><mo id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><msub id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.3.2.2" xref="S3.E1.m1.1.1.3.2.2.cmml">L</mi><mrow id="S3.E1.m1.1.1.3.2.3" xref="S3.E1.m1.1.1.3.2.3.cmml"><mi id="S3.E1.m1.1.1.3.2.3.2" xref="S3.E1.m1.1.1.3.2.3.2.cmml">C</mi><mo id="S3.E1.m1.1.1.3.2.3.1" xref="S3.E1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.3.2.3.3" xref="S3.E1.m1.1.1.3.2.3.3.cmml">T</mi><mo id="S3.E1.m1.1.1.3.2.3.1a" xref="S3.E1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.3.2.3.4" xref="S3.E1.m1.1.1.3.2.3.4.cmml">R</mi></mrow></msub><mo id="S3.E1.m1.1.1.3.1" xref="S3.E1.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.3.3.2" xref="S3.E1.m1.1.1.3.3.2.cmml">α</mi><mo id="S3.E1.m1.1.1.3.3.1" xref="S3.E1.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.3.3.3" xref="S3.E1.m1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.1.1.3.3.3.2" xref="S3.E1.m1.1.1.3.3.3.2.cmml">L</mi><mrow id="S3.E1.m1.1.1.3.3.3.3" xref="S3.E1.m1.1.1.3.3.3.3.cmml"><mi id="S3.E1.m1.1.1.3.3.3.3.2" xref="S3.E1.m1.1.1.3.3.3.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.3.3.3.3.1" xref="S3.E1.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mn id="S3.E1.m1.1.1.3.3.3.3.3" xref="S3.E1.m1.1.1.3.3.3.3.3.cmml">2</mn><mo id="S3.E1.m1.1.1.3.3.3.3.1a" xref="S3.E1.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.3.3.3.3.4" xref="S3.E1.m1.1.1.3.3.3.3.4.cmml">i</mi></mrow></msub></mrow><mo id="S3.E1.m1.1.1.3.1a" xref="S3.E1.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E1.m1.1.1.3.4" xref="S3.E1.m1.1.1.3.4.cmml"><mi id="S3.E1.m1.1.1.3.4.2" xref="S3.E1.m1.1.1.3.4.2.cmml">β</mi><mo id="S3.E1.m1.1.1.3.4.1" xref="S3.E1.m1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.3.4.3" xref="S3.E1.m1.1.1.3.4.3.cmml"><mi id="S3.E1.m1.1.1.3.4.3.2" xref="S3.E1.m1.1.1.3.4.3.2.cmml">L</mi><mrow id="S3.E1.m1.1.1.3.4.3.3" xref="S3.E1.m1.1.1.3.4.3.3.cmml"><mi id="S3.E1.m1.1.1.3.4.3.3.2" xref="S3.E1.m1.1.1.3.4.3.3.2.cmml">q</mi><mo id="S3.E1.m1.1.1.3.4.3.3.1" xref="S3.E1.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mn id="S3.E1.m1.1.1.3.4.3.3.3" xref="S3.E1.m1.1.1.3.4.3.3.3.cmml">2</mn><mo id="S3.E1.m1.1.1.3.4.3.3.1a" xref="S3.E1.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.3.4.3.3.4" xref="S3.E1.m1.1.1.3.4.3.3.4.cmml">q</mi></mrow></msub></mrow><mo id="S3.E1.m1.1.1.3.1b" xref="S3.E1.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E1.m1.1.1.3.5" xref="S3.E1.m1.1.1.3.5.cmml"><mi id="S3.E1.m1.1.1.3.5.2" xref="S3.E1.m1.1.1.3.5.2.cmml">γ</mi><mo id="S3.E1.m1.1.1.3.5.1" xref="S3.E1.m1.1.1.3.5.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.3.5.3" xref="S3.E1.m1.1.1.3.5.3.cmml"><mi id="S3.E1.m1.1.1.3.5.3.2" xref="S3.E1.m1.1.1.3.5.3.2.cmml">L</mi><mrow id="S3.E1.m1.1.1.3.5.3.3" xref="S3.E1.m1.1.1.3.5.3.3.cmml"><mi id="S3.E1.m1.1.1.3.5.3.3.2" xref="S3.E1.m1.1.1.3.5.3.3.2.cmml">q</mi><mo id="S3.E1.m1.1.1.3.5.3.3.1" xref="S3.E1.m1.1.1.3.5.3.3.1.cmml">⁢</mo><mn id="S3.E1.m1.1.1.3.5.3.3.3" xref="S3.E1.m1.1.1.3.5.3.3.3.cmml">2</mn><mo id="S3.E1.m1.1.1.3.5.3.3.1a" xref="S3.E1.m1.1.1.3.5.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.3.5.3.3.4" xref="S3.E1.m1.1.1.3.5.3.3.4.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"></eq><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">𝐿</ci><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><plus id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3.1"></plus><apply id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2">𝐿</ci><apply id="S3.E1.m1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.3.2.3"><times id="S3.E1.m1.1.1.3.2.3.1.cmml" xref="S3.E1.m1.1.1.3.2.3.1"></times><ci id="S3.E1.m1.1.1.3.2.3.2.cmml" xref="S3.E1.m1.1.1.3.2.3.2">𝐶</ci><ci id="S3.E1.m1.1.1.3.2.3.3.cmml" xref="S3.E1.m1.1.1.3.2.3.3">𝑇</ci><ci id="S3.E1.m1.1.1.3.2.3.4.cmml" xref="S3.E1.m1.1.1.3.2.3.4">𝑅</ci></apply></apply><apply id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3"><times id="S3.E1.m1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.3.3.1"></times><ci id="S3.E1.m1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.3.3.2">𝛼</ci><apply id="S3.E1.m1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.1.1.3.3.3.2">𝐿</ci><apply id="S3.E1.m1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.1.1.3.3.3.3"><times id="S3.E1.m1.1.1.3.3.3.3.1.cmml" xref="S3.E1.m1.1.1.3.3.3.3.1"></times><ci id="S3.E1.m1.1.1.3.3.3.3.2.cmml" xref="S3.E1.m1.1.1.3.3.3.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.3.3.3.3.3">2</cn><ci id="S3.E1.m1.1.1.3.3.3.3.4.cmml" xref="S3.E1.m1.1.1.3.3.3.3.4">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.3.4"><times id="S3.E1.m1.1.1.3.4.1.cmml" xref="S3.E1.m1.1.1.3.4.1"></times><ci id="S3.E1.m1.1.1.3.4.2.cmml" xref="S3.E1.m1.1.1.3.4.2">𝛽</ci><apply id="S3.E1.m1.1.1.3.4.3.cmml" xref="S3.E1.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.4.3.1.cmml" xref="S3.E1.m1.1.1.3.4.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.4.3.2.cmml" xref="S3.E1.m1.1.1.3.4.3.2">𝐿</ci><apply id="S3.E1.m1.1.1.3.4.3.3.cmml" xref="S3.E1.m1.1.1.3.4.3.3"><times id="S3.E1.m1.1.1.3.4.3.3.1.cmml" xref="S3.E1.m1.1.1.3.4.3.3.1"></times><ci id="S3.E1.m1.1.1.3.4.3.3.2.cmml" xref="S3.E1.m1.1.1.3.4.3.3.2">𝑞</ci><cn id="S3.E1.m1.1.1.3.4.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.3.4.3.3.3">2</cn><ci id="S3.E1.m1.1.1.3.4.3.3.4.cmml" xref="S3.E1.m1.1.1.3.4.3.3.4">𝑞</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.3.5.cmml" xref="S3.E1.m1.1.1.3.5"><times id="S3.E1.m1.1.1.3.5.1.cmml" xref="S3.E1.m1.1.1.3.5.1"></times><ci id="S3.E1.m1.1.1.3.5.2.cmml" xref="S3.E1.m1.1.1.3.5.2">𝛾</ci><apply id="S3.E1.m1.1.1.3.5.3.cmml" xref="S3.E1.m1.1.1.3.5.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.5.3.1.cmml" xref="S3.E1.m1.1.1.3.5.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.5.3.2.cmml" xref="S3.E1.m1.1.1.3.5.3.2">𝐿</ci><apply id="S3.E1.m1.1.1.3.5.3.3.cmml" xref="S3.E1.m1.1.1.3.5.3.3"><times id="S3.E1.m1.1.1.3.5.3.3.1.cmml" xref="S3.E1.m1.1.1.3.5.3.3.1"></times><ci id="S3.E1.m1.1.1.3.5.3.3.2.cmml" xref="S3.E1.m1.1.1.3.5.3.3.2">𝑞</ci><cn id="S3.E1.m1.1.1.3.5.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.3.5.3.3.3">2</cn><ci id="S3.E1.m1.1.1.3.5.3.3.4.cmml" xref="S3.E1.m1.1.1.3.5.3.3.4">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">L=L_{CTR}+\alpha L_{i2i}+\beta L_{q2q}+\gamma L_{q2i}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_L = italic_L start_POSTSUBSCRIPT italic_C italic_T italic_R end_POSTSUBSCRIPT + italic_α italic_L start_POSTSUBSCRIPT italic_i 2 italic_i end_POSTSUBSCRIPT + italic_β italic_L start_POSTSUBSCRIPT italic_q 2 italic_q end_POSTSUBSCRIPT + italic_γ italic_L start_POSTSUBSCRIPT italic_q 2 italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.1">Compared with two-stage methods that first train graph embedding and then exploit it in CTR prediction, the end-to-end framework comes with many advantages. It can avoid saving and loading graph embedding frequently, and therefore consistency between the two tasks is better guaranteed. With the gradient backpropagated from
both tasks, the graph embedding is jointly trained to fill the gap between graph learning and final CTR prediction.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we conduct extensive experiments to demonstrate the effectiveness of our proposed methods. First, we evaluate the performance of different methods on public and industrial datasets. Second, we discuss our training detail and the corresponding influence. Third, we analyze the graph embedding result by visualization and statistics. Finally, we introduce our online A/B test result.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Datasets</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Model comparisons are conducted on a commonly used public Taobao dataset <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib26" title="">2018</a>)</cite> and an industrial dataset collected from our e-commerce system. Table <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.T1" title="Table 1 ‣ 4.1. Datasets ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">1</span></a> shows the statistics of two datasets.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.3.1">Taobao Dataset</span> <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://tianchi.aliyun.com/dataset/649" title="">https://tianchi.aliyun.com/dataset/649</a></span></span></span> is a collection of user behaviors from Taobao’s recommender system. The dataset contains four types of user behaviors, including click, purchase, adding to cart, and adding to wishlist. We take the click behaviors for each user and sort them according to time to construct the behavior sequence. Assuming there are <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_T</annotation></semantics></math> behaviors of a user, we use the former <math alttext="T-1" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">T</mi><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">−</mo><mn id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><minus id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></minus><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑇</ci><cn id="S4.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">T-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_T - 1</annotation></semantics></math> clicked items as features to predict whether the user will click the <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_T</annotation></semantics></math>-th item. The behavior sequence is truncated at length 200.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Industrial Dataset</span> is collected from our online search system, one of the world’s largest e-commerce platforms. Samples are constructed from impression logs data of search results page. Each instance contains the user’s historical click sequence and search query sequence with timestamps, as well as other user-side or item-side features, with ”click” or ”not” as the label. With the rich features contained, the collected industrial dataset allows us to build the item-query heterogeneous graph. The dataset is composed of training samples from the past 25 days and test samples from the following day, a classic setting for industrial modeling. The click and query sequences are truncated at length 100.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of datasets used in paper</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2">Sample</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.3">Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.4">Queries</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.2.1.1">Taobao</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.2">100 million</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.3">4.16 million</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.4">None</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.3.2.1">Industrial</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.3.2.2">11.2 billion</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.3.2.3">473 million</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.3.2.4">228 million</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Compared Methods</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We compare EGIN with some mainstream CTR prediction methods, including three types: pooling-based, attention-based, and graph-based methods. The AUC is adopted as the performance metric, representing the ranking ability of the model. The same train and test data are used in all methods.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">EGIN adopts the following settings in experiments. The window size is set to 2 during the graph construction, and top-10 retrieval is used in the multi-interest network. The scale of the negative sampling queue is maintained at 1 million, and the negative sample number is set to 100. All embeddings in both graph and CTR prediction network share a dimension of 10.</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">DNN</span>. Sum-pooling is adopted on user behavior sequence to summarize the historical interest of users, which is concatenated with target item features, user features, and query features. Finally, they are fed into an MLP and get the CTR prediction.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">DNN-cross</span>. Compared with DNN, the cartesian product between historical and target items is adopted to represent the i2i relationships. Then this 2-order feature is fed into the sum-pooling layer to generate user interest representation. We called this ”DNN-cross”, and by default, the following model comparisons are based on this method.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">DIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib25" title="">2018</a>)</cite>. DIN introduces an attention mechanism to assign different weights to historical items based on their relationships with the target item to learn the representation of user interests adaptively.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">BST</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib2" title="">2019</a>)</cite>. BST utilizes Transformer to capture underlying sequential signals from user behavior sequences for a better recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i5.p1.1.1">EGES</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#bib.bib20" title="">2018</a>)</cite>. EGES constructs an item graph depending on user behaviors and then adopts DeepWalk to learn the representation of items. In order to alleviate the sparsity and cold start problems, side information is incorporated into the graph to enhance the embedding procedure. We consume the graph embedding produced by EGES in our CTR prediction network to evaluate its performance.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Results on Public Dataset</h3>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Result on Taobao dataset</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.10">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.10.11.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T2.10.11.1.1">Method</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T2.10.11.1.2">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.10.11.1.3">RelaImpr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.2.2.3">DNN</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.1"><math alttext="0.8709" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mn id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">0.8709</mn><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><cn id="S4.T2.1.1.1.m1.1.1.cmml" type="float" xref="S4.T2.1.1.1.m1.1.1">0.8709</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">0.8709</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">0.8709</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.2"><math alttext="-0.16\%" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.m1.1a"><mrow id="S4.T2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.m1.1.1.cmml"><mo id="S4.T2.2.2.2.m1.1.1a" xref="S4.T2.2.2.2.m1.1.1.cmml">−</mo><mrow id="S4.T2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.m1.1.1.2.cmml"><mn id="S4.T2.2.2.2.m1.1.1.2.2" xref="S4.T2.2.2.2.m1.1.1.2.2.cmml">0.16</mn><mo id="S4.T2.2.2.2.m1.1.1.2.1" xref="S4.T2.2.2.2.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1"><minus id="S4.T2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1"></minus><apply id="S4.T2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T2.2.2.2.m1.1.1.2.1">percent</csymbol><cn id="S4.T2.2.2.2.m1.1.1.2.2.cmml" type="float" xref="S4.T2.2.2.2.m1.1.1.2.2">0.16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">-0.16\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.m1.1d">- 0.16 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4">
<td class="ltx_td ltx_align_left" id="S4.T2.4.4.3">DNN-cross</td>
<td class="ltx_td ltx_align_left" id="S4.T2.3.3.1"><math alttext="0.8715" class="ltx_Math" display="inline" id="S4.T2.3.3.1.m1.1"><semantics id="S4.T2.3.3.1.m1.1a"><mn id="S4.T2.3.3.1.m1.1.1" xref="S4.T2.3.3.1.m1.1.1.cmml">0.8715</mn><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><cn id="S4.T2.3.3.1.m1.1.1.cmml" type="float" xref="S4.T2.3.3.1.m1.1.1">0.8715</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">0.8715</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.1.m1.1d">0.8715</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2"><math alttext="0.00\%" class="ltx_Math" display="inline" id="S4.T2.4.4.2.m1.1"><semantics id="S4.T2.4.4.2.m1.1a"><mrow id="S4.T2.4.4.2.m1.1.1" xref="S4.T2.4.4.2.m1.1.1.cmml"><mn id="S4.T2.4.4.2.m1.1.1.2" xref="S4.T2.4.4.2.m1.1.1.2.cmml">0.00</mn><mo id="S4.T2.4.4.2.m1.1.1.1" xref="S4.T2.4.4.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.2.m1.1b"><apply id="S4.T2.4.4.2.m1.1.1.cmml" xref="S4.T2.4.4.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.4.4.2.m1.1.1.1.cmml" xref="S4.T2.4.4.2.m1.1.1.1">percent</csymbol><cn id="S4.T2.4.4.2.m1.1.1.2.cmml" type="float" xref="S4.T2.4.4.2.m1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.2.m1.1c">0.00\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.2.m1.1d">0.00 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.3">DIN</td>
<td class="ltx_td ltx_align_left" id="S4.T2.5.5.1"><math alttext="0.8833" class="ltx_Math" display="inline" id="S4.T2.5.5.1.m1.1"><semantics id="S4.T2.5.5.1.m1.1a"><mn id="S4.T2.5.5.1.m1.1.1" xref="S4.T2.5.5.1.m1.1.1.cmml">0.8833</mn><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.1.m1.1b"><cn id="S4.T2.5.5.1.m1.1.1.cmml" type="float" xref="S4.T2.5.5.1.m1.1.1">0.8833</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.1.m1.1c">0.8833</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.1.m1.1d">0.8833</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.2"><math alttext="3.18\%" class="ltx_Math" display="inline" id="S4.T2.6.6.2.m1.1"><semantics id="S4.T2.6.6.2.m1.1a"><mrow id="S4.T2.6.6.2.m1.1.1" xref="S4.T2.6.6.2.m1.1.1.cmml"><mn id="S4.T2.6.6.2.m1.1.1.2" xref="S4.T2.6.6.2.m1.1.1.2.cmml">3.18</mn><mo id="S4.T2.6.6.2.m1.1.1.1" xref="S4.T2.6.6.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.2.m1.1b"><apply id="S4.T2.6.6.2.m1.1.1.cmml" xref="S4.T2.6.6.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.6.6.2.m1.1.1.1.cmml" xref="S4.T2.6.6.2.m1.1.1.1">percent</csymbol><cn id="S4.T2.6.6.2.m1.1.1.2.cmml" type="float" xref="S4.T2.6.6.2.m1.1.1.2">3.18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.2.m1.1c">3.18\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.2.m1.1d">3.18 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8">
<td class="ltx_td ltx_align_left" id="S4.T2.8.8.3">BST</td>
<td class="ltx_td ltx_align_left" id="S4.T2.7.7.1"><math alttext="0.9040" class="ltx_Math" display="inline" id="S4.T2.7.7.1.m1.1"><semantics id="S4.T2.7.7.1.m1.1a"><mn id="S4.T2.7.7.1.m1.1.1" xref="S4.T2.7.7.1.m1.1.1.cmml">0.9040</mn><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.1.m1.1b"><cn id="S4.T2.7.7.1.m1.1.1.cmml" type="float" xref="S4.T2.7.7.1.m1.1.1">0.9040</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.1.m1.1c">0.9040</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.1.m1.1d">0.9040</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.8.2"><math alttext="8.75\%" class="ltx_Math" display="inline" id="S4.T2.8.8.2.m1.1"><semantics id="S4.T2.8.8.2.m1.1a"><mrow id="S4.T2.8.8.2.m1.1.1" xref="S4.T2.8.8.2.m1.1.1.cmml"><mn id="S4.T2.8.8.2.m1.1.1.2" xref="S4.T2.8.8.2.m1.1.1.2.cmml">8.75</mn><mo id="S4.T2.8.8.2.m1.1.1.1" xref="S4.T2.8.8.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.2.m1.1b"><apply id="S4.T2.8.8.2.m1.1.1.cmml" xref="S4.T2.8.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.8.8.2.m1.1.1.1.cmml" xref="S4.T2.8.8.2.m1.1.1.1">percent</csymbol><cn id="S4.T2.8.8.2.m1.1.1.2.cmml" type="float" xref="S4.T2.8.8.2.m1.1.1.2">8.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.2.m1.1c">8.75\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.2.m1.1d">8.75 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.10.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.10.10.3">EGIN(ours)</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.9.9.1"><math alttext="\mathbf{0.9184}" class="ltx_Math" display="inline" id="S4.T2.9.9.1.m1.1"><semantics id="S4.T2.9.9.1.m1.1a"><mn class="ltx_mathvariant_bold" id="S4.T2.9.9.1.m1.1.1" mathvariant="bold" xref="S4.T2.9.9.1.m1.1.1.cmml">0.9184</mn><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.1.m1.1b"><cn id="S4.T2.9.9.1.m1.1.1.cmml" type="float" xref="S4.T2.9.9.1.m1.1.1">0.9184</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.1.m1.1c">\mathbf{0.9184}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.9.1.m1.1d">bold_0.9184</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.10.10.2"><math alttext="\mathbf{12.62\%}" class="ltx_Math" display="inline" id="S4.T2.10.10.2.m1.1"><semantics id="S4.T2.10.10.2.m1.1a"><mrow id="S4.T2.10.10.2.m1.1.1" xref="S4.T2.10.10.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S4.T2.10.10.2.m1.1.1.2" mathvariant="bold" xref="S4.T2.10.10.2.m1.1.1.2.cmml">12.62</mn><mo id="S4.T2.10.10.2.m1.1.1.1" xref="S4.T2.10.10.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.2.m1.1b"><apply id="S4.T2.10.10.2.m1.1.1.cmml" xref="S4.T2.10.10.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.10.10.2.m1.1.1.1.cmml" xref="S4.T2.10.10.2.m1.1.1.1">percent</csymbol><cn id="S4.T2.10.10.2.m1.1.1.2.cmml" type="float" xref="S4.T2.10.10.2.m1.1.1.2">12.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.2.m1.1c">\mathbf{12.62\%}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.10.2.m1.1d">bold_12.62 %</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Considering the absence of query in the recommendation scenario of Taobao Dataset, we adjust our framework by preserving only nodes and edges of items in our query-item heterogeneous graph and eliminating features related to query in the multi-interest network.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.T2" title="Table 2 ‣ 4.3. Results on Public Dataset ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">2</span></a> indicates that the proposed framework outperforms competitors on this commonly used CTR prediction benchmark. Our approach significantly achieves a better result than pooling-based and attention-based baselines. The result also reveals that our approach is a generalized CTR prediction framework that can be fit in recommendation scenarios.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Results on Industrial Dataset</h3>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Result on industrial dataset</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.10">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.10.11.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.10.11.1.1">Category</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.10.11.1.2">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.10.11.1.3">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.10.11.1.4">RelaImpr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.2.2.3" rowspan="2"><span class="ltx_text" id="S4.T3.2.2.3.1">Pooling-based</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.2.2.4">DNN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1">
<math alttext="0.701" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.m1.1a"><mn id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml">0.701</mn><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><cn id="S4.T3.1.1.1.m1.1.1.cmml" type="float" xref="S4.T3.1.1.1.m1.1.1">0.701</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">0.701</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.m1.1d">0.701</annotation></semantics></math>1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2"><math alttext="-0.30\%" class="ltx_Math" display="inline" id="S4.T3.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.m1.1a"><mrow id="S4.T3.2.2.2.m1.1.1" xref="S4.T3.2.2.2.m1.1.1.cmml"><mo id="S4.T3.2.2.2.m1.1.1a" xref="S4.T3.2.2.2.m1.1.1.cmml">−</mo><mrow id="S4.T3.2.2.2.m1.1.1.2" xref="S4.T3.2.2.2.m1.1.1.2.cmml"><mn id="S4.T3.2.2.2.m1.1.1.2.2" xref="S4.T3.2.2.2.m1.1.1.2.2.cmml">0.30</mn><mo id="S4.T3.2.2.2.m1.1.1.2.1" xref="S4.T3.2.2.2.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.m1.1b"><apply id="S4.T3.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1"><minus id="S4.T3.2.2.2.m1.1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1"></minus><apply id="S4.T3.2.2.2.m1.1.1.2.cmml" xref="S4.T3.2.2.2.m1.1.1.2"><csymbol cd="latexml" id="S4.T3.2.2.2.m1.1.1.2.1.cmml" xref="S4.T3.2.2.2.m1.1.1.2.1">percent</csymbol><cn id="S4.T3.2.2.2.m1.1.1.2.2.cmml" type="float" xref="S4.T3.2.2.2.m1.1.1.2.2">0.30</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.m1.1c">-0.30\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.m1.1d">- 0.30 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.3.3.2">DNN-cross</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.3">0.7017</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.1"><math alttext="0.00\%" class="ltx_Math" display="inline" id="S4.T3.3.3.1.m1.1"><semantics id="S4.T3.3.3.1.m1.1a"><mrow id="S4.T3.3.3.1.m1.1.1" xref="S4.T3.3.3.1.m1.1.1.cmml"><mn id="S4.T3.3.3.1.m1.1.1.2" xref="S4.T3.3.3.1.m1.1.1.2.cmml">0.00</mn><mo id="S4.T3.3.3.1.m1.1.1.1" xref="S4.T3.3.3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.1.m1.1b"><apply id="S4.T3.3.3.1.m1.1.1.cmml" xref="S4.T3.3.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.3.3.1.m1.1.1.1.cmml" xref="S4.T3.3.3.1.m1.1.1.1">percent</csymbol><cn id="S4.T3.3.3.1.m1.1.1.2.cmml" type="float" xref="S4.T3.3.3.1.m1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.1.m1.1c">0.00\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.1.m1.1d">0.00 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.5.5.3" rowspan="2"><span class="ltx_text" id="S4.T3.5.5.3.1">Attention-based</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.5.5.4">DIN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.4.1"><math alttext="0.7022" class="ltx_Math" display="inline" id="S4.T3.4.4.1.m1.1"><semantics id="S4.T3.4.4.1.m1.1a"><mn id="S4.T3.4.4.1.m1.1.1" xref="S4.T3.4.4.1.m1.1.1.cmml">0.7022</mn><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.1.m1.1b"><cn id="S4.T3.4.4.1.m1.1.1.cmml" type="float" xref="S4.T3.4.4.1.m1.1.1">0.7022</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.1.m1.1c">0.7022</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.1.m1.1d">0.7022</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.2"><math alttext="0.25\%" class="ltx_Math" display="inline" id="S4.T3.5.5.2.m1.1"><semantics id="S4.T3.5.5.2.m1.1a"><mrow id="S4.T3.5.5.2.m1.1.1" xref="S4.T3.5.5.2.m1.1.1.cmml"><mn id="S4.T3.5.5.2.m1.1.1.2" xref="S4.T3.5.5.2.m1.1.1.2.cmml">0.25</mn><mo id="S4.T3.5.5.2.m1.1.1.1" xref="S4.T3.5.5.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.2.m1.1b"><apply id="S4.T3.5.5.2.m1.1.1.cmml" xref="S4.T3.5.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.5.5.2.m1.1.1.1.cmml" xref="S4.T3.5.5.2.m1.1.1.1">percent</csymbol><cn id="S4.T3.5.5.2.m1.1.1.2.cmml" type="float" xref="S4.T3.5.5.2.m1.1.1.2">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.2.m1.1c">0.25\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.2.m1.1d">0.25 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.6.6.2">BST</th>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.3">0.7042</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.1"><math alttext="1.24\%" class="ltx_Math" display="inline" id="S4.T3.6.6.1.m1.1"><semantics id="S4.T3.6.6.1.m1.1a"><mrow id="S4.T3.6.6.1.m1.1.1" xref="S4.T3.6.6.1.m1.1.1.cmml"><mn id="S4.T3.6.6.1.m1.1.1.2" xref="S4.T3.6.6.1.m1.1.1.2.cmml">1.24</mn><mo id="S4.T3.6.6.1.m1.1.1.1" xref="S4.T3.6.6.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.1.m1.1b"><apply id="S4.T3.6.6.1.m1.1.1.cmml" xref="S4.T3.6.6.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.6.6.1.m1.1.1.1.cmml" xref="S4.T3.6.6.1.m1.1.1.1">percent</csymbol><cn id="S4.T3.6.6.1.m1.1.1.2.cmml" type="float" xref="S4.T3.6.6.1.m1.1.1.2">1.24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.1.m1.1c">1.24\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.1.m1.1d">1.24 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T3.8.8.3" rowspan="2"><span class="ltx_text" id="S4.T3.8.8.3.1">Graph-based</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.8.8.4">EGES</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.7.1"><math alttext="0.7079" class="ltx_Math" display="inline" id="S4.T3.7.7.1.m1.1"><semantics id="S4.T3.7.7.1.m1.1a"><mn id="S4.T3.7.7.1.m1.1.1" xref="S4.T3.7.7.1.m1.1.1.cmml">0.7079</mn><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.1.m1.1b"><cn id="S4.T3.7.7.1.m1.1.1.cmml" type="float" xref="S4.T3.7.7.1.m1.1.1">0.7079</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.1.m1.1c">0.7079</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.7.1.m1.1d">0.7079</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.2"><math alttext="3.07\%" class="ltx_Math" display="inline" id="S4.T3.8.8.2.m1.1"><semantics id="S4.T3.8.8.2.m1.1a"><mrow id="S4.T3.8.8.2.m1.1.1" xref="S4.T3.8.8.2.m1.1.1.cmml"><mn id="S4.T3.8.8.2.m1.1.1.2" xref="S4.T3.8.8.2.m1.1.1.2.cmml">3.07</mn><mo id="S4.T3.8.8.2.m1.1.1.1" xref="S4.T3.8.8.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.2.m1.1b"><apply id="S4.T3.8.8.2.m1.1.1.cmml" xref="S4.T3.8.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.8.8.2.m1.1.1.1.cmml" xref="S4.T3.8.8.2.m1.1.1.1">percent</csymbol><cn id="S4.T3.8.8.2.m1.1.1.2.cmml" type="float" xref="S4.T3.8.8.2.m1.1.1.2">3.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.2.m1.1c">3.07\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.8.2.m1.1d">3.07 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T3.10.10.3">EGIN(ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.9.9.1"><math alttext="\mathbf{0.7108}" class="ltx_Math" display="inline" id="S4.T3.9.9.1.m1.1"><semantics id="S4.T3.9.9.1.m1.1a"><mn class="ltx_mathvariant_bold" id="S4.T3.9.9.1.m1.1.1" mathvariant="bold" xref="S4.T3.9.9.1.m1.1.1.cmml">0.7108</mn><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.1.m1.1b"><cn id="S4.T3.9.9.1.m1.1.1.cmml" type="float" xref="S4.T3.9.9.1.m1.1.1">0.7108</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.1.m1.1c">\mathbf{0.7108}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.9.1.m1.1d">bold_0.7108</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.10.10.2"><math alttext="\mathbf{4.51\%}" class="ltx_Math" display="inline" id="S4.T3.10.10.2.m1.1"><semantics id="S4.T3.10.10.2.m1.1a"><mrow id="S4.T3.10.10.2.m1.1.1" xref="S4.T3.10.10.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S4.T3.10.10.2.m1.1.1.2" mathvariant="bold" xref="S4.T3.10.10.2.m1.1.1.2.cmml">4.51</mn><mo id="S4.T3.10.10.2.m1.1.1.1" xref="S4.T3.10.10.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.10.10.2.m1.1b"><apply id="S4.T3.10.10.2.m1.1.1.cmml" xref="S4.T3.10.10.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.10.10.2.m1.1.1.1.cmml" xref="S4.T3.10.10.2.m1.1.1.1">percent</csymbol><cn id="S4.T3.10.10.2.m1.1.1.2.cmml" type="float" xref="S4.T3.10.10.2.m1.1.1.2">4.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.10.2.m1.1c">\mathbf{4.51\%}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.10.2.m1.1d">bold_4.51 %</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.T3" title="Table 3 ‣ 4.4. Results on Industrial Dataset ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results on our industrial dataset. The proposed approach achieves significant performance gain compared with DNN-based methods. Compared with the attention-based DIN and BST, we can see that incorporating graph learning can provide extra information to the CTR prediction model and improve model performance. In comparison with another graph-based method EGES, which utilizes co-occurrence and side information of commodity, our end-to-end framework shows a better result that proves the effectiveness of our query-item heterogeneous graph. Notice that our graph learning method brings low computation cost in addition to the main CTR prediction task.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Ablation Study</h3>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>Ablation study</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.1.1.2">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.3">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1">Diff <math alttext="\%" class="ltx_Math" display="inline" id="S4.T4.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.m1.1d">%</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.4.5.1.1">EGIN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.5.1.2">0.7108</td>
<td class="ltx_td ltx_border_t" id="S4.T4.4.5.1.3"></td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.2.2.2">EGIN w/o graph</th>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.3">0.7032</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.1">-0.76<math alttext="\%" class="ltx_Math" display="inline" id="S4.T4.2.2.1.m1.1"><semantics id="S4.T4.2.2.1.m1.1a"><mo id="S4.T4.2.2.1.m1.1.1" xref="S4.T4.2.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T4.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.1.m1.1d">%</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.3.3.2">EGIN w/o query</th>
<td class="ltx_td ltx_align_center" id="S4.T4.3.3.3">0.7081</td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.3.1">-0.27<math alttext="\%" class="ltx_Math" display="inline" id="S4.T4.3.3.1.m1.1"><semantics id="S4.T4.3.3.1.m1.1a"><mo id="S4.T4.3.3.1.m1.1.1" xref="S4.T4.3.3.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T4.3.3.1.m1.1.1.cmml" xref="S4.T4.3.3.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.1.m1.1d">%</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T4.4.4.2">EGIN w/o pos_emb</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.3">0.7087</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.1">-0.21<math alttext="\%" class="ltx_Math" display="inline" id="S4.T4.4.4.1.m1.1"><semantics id="S4.T4.4.4.1.m1.1a"><mo id="S4.T4.4.4.1.m1.1.1" xref="S4.T4.4.4.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.1.m1.1d">%</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">The result of the ablation study on the industrial dataset is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.T4" title="Table 4 ‣ 4.5. Ablation Study ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">4</span></a>. EGIN w/o graph removes the graph model and uses embedding produced by the CTR prediction network instead of jointly learned graph embedding. The significant performance decay indicates that the graph model provides plenty of extra information to the CTR network. EGIN w/o query means graph structure is limited to historical click sequence, causing a significant AUC drop. The result implies that query-item heterogeneous graph enhances CTR prediction performance by exploiting the information provided by queries. EGIN w/o pos_emb eliminates the positional embedding in the multi-interest network, which brings the problem of order information loss during top-k retrieval. The AUC diff of <math alttext="0.21\%" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mrow id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml"><mn id="S4.SS5.p1.1.m1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.2.cmml">0.21</mn><mo id="S4.SS5.p1.1.m1.1.1.1" xref="S4.SS5.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS5.p1.1.m1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1.1">percent</csymbol><cn id="S4.SS5.p1.1.m1.1.1.2.cmml" type="float" xref="S4.SS5.p1.1.m1.1.1.2">0.21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">0.21\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">0.21 %</annotation></semantics></math> conveys the necessity of this component in the network.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Graph Input Data Management</h3>
<section class="ltx_subsubsection" id="S4.SS6.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.6.1. </span>Subsampling of Frequent Entites</h4>
<div class="ltx_para" id="S4.SS6.SSS1.p1">
<p class="ltx_p" id="S4.SS6.SSS1.p1.2">As our graph model shares the same input form with the CTR prediction network, it brings the problem of frequent items and queries. In our industrial dataset, the frequency of different items can vary from the range of <math alttext="{10}^{4}" class="ltx_Math" display="inline" id="S4.SS6.SSS1.p1.1.m1.1"><semantics id="S4.SS6.SSS1.p1.1.m1.1a"><msup id="S4.SS6.SSS1.p1.1.m1.1.1" xref="S4.SS6.SSS1.p1.1.m1.1.1.cmml"><mn id="S4.SS6.SSS1.p1.1.m1.1.1.2" xref="S4.SS6.SSS1.p1.1.m1.1.1.2.cmml">10</mn><mn id="S4.SS6.SSS1.p1.1.m1.1.1.3" xref="S4.SS6.SSS1.p1.1.m1.1.1.3.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS6.SSS1.p1.1.m1.1b"><apply id="S4.SS6.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS6.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS6.SSS1.p1.1.m1.1.1">superscript</csymbol><cn id="S4.SS6.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS6.SSS1.p1.1.m1.1.1.2">10</cn><cn id="S4.SS6.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS6.SSS1.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.SSS1.p1.1.m1.1c">{10}^{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.SSS1.p1.1.m1.1d">10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. In our general practice, subsampling of frequent entities helps improve performance in different search-related tasks. In order to verify the influence of this technique, we conduct a series of experiments on our industrial dataset by adopting different subsampling functions and subsampling targets (e.g., original behavior sequence or negative sample pool). In experiments, the subsampling method results in a CTR AUC of 0.7109 compared with 0.7108 for the unsampled version. The performance gap between different settings is limited to <math alttext="10^{-4}" class="ltx_Math" display="inline" id="S4.SS6.SSS1.p1.2.m2.1"><semantics id="S4.SS6.SSS1.p1.2.m2.1a"><msup id="S4.SS6.SSS1.p1.2.m2.1.1" xref="S4.SS6.SSS1.p1.2.m2.1.1.cmml"><mn id="S4.SS6.SSS1.p1.2.m2.1.1.2" xref="S4.SS6.SSS1.p1.2.m2.1.1.2.cmml">10</mn><mrow id="S4.SS6.SSS1.p1.2.m2.1.1.3" xref="S4.SS6.SSS1.p1.2.m2.1.1.3.cmml"><mo id="S4.SS6.SSS1.p1.2.m2.1.1.3a" xref="S4.SS6.SSS1.p1.2.m2.1.1.3.cmml">−</mo><mn id="S4.SS6.SSS1.p1.2.m2.1.1.3.2" xref="S4.SS6.SSS1.p1.2.m2.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS6.SSS1.p1.2.m2.1b"><apply id="S4.SS6.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS6.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS6.SSS1.p1.2.m2.1.1">superscript</csymbol><cn id="S4.SS6.SSS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS6.SSS1.p1.2.m2.1.1.2">10</cn><apply id="S4.SS6.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS6.SSS1.p1.2.m2.1.1.3"><minus id="S4.SS6.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS6.SSS1.p1.2.m2.1.1.3"></minus><cn id="S4.SS6.SSS1.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS6.SSS1.p1.2.m2.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.SSS1.p1.2.m2.1c">10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.SSS1.p1.2.m2.1d">10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, which is negligible.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS6.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.6.2. </span>Combination of Categorically Restricted Data</h4>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="474" id="S4.F3.g1" src="x3.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>CTR prediction performance on industrial dataset of different mixtures of user click sequence and seeds sequence as input to graph learning. While the click sequence contains more inter-category transitions, the seeds sequence concentrates more on items corresponding to the search intention. <math alttext="\mathbf{80\%}" class="ltx_Math" display="inline" id="S4.F3.3.m1.1"><semantics id="S4.F3.3.m1.1b"><mrow id="S4.F3.3.m1.1.1" xref="S4.F3.3.m1.1.1.cmml"><mn id="S4.F3.3.m1.1.1.2" xref="S4.F3.3.m1.1.1.2.cmml">𝟖𝟎</mn><mo id="S4.F3.3.m1.1.1.1" xref="S4.F3.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.3.m1.1c"><apply id="S4.F3.3.m1.1.1.cmml" xref="S4.F3.3.m1.1.1"><csymbol cd="latexml" id="S4.F3.3.m1.1.1.1.cmml" xref="S4.F3.3.m1.1.1.1">percent</csymbol><cn id="S4.F3.3.m1.1.1.2.cmml" type="integer" xref="S4.F3.3.m1.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.3.m1.1d">\mathbf{80\%}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.3.m1.1e">bold_80 %</annotation></semantics></math> of click sequence and <math alttext="\mathbf{20\%}" class="ltx_Math" display="inline" id="S4.F3.4.m2.1"><semantics id="S4.F3.4.m2.1b"><mrow id="S4.F3.4.m2.1.1" xref="S4.F3.4.m2.1.1.cmml"><mn id="S4.F3.4.m2.1.1.2" xref="S4.F3.4.m2.1.1.2.cmml">𝟐𝟎</mn><mo id="S4.F3.4.m2.1.1.1" xref="S4.F3.4.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.4.m2.1c"><apply id="S4.F3.4.m2.1.1.cmml" xref="S4.F3.4.m2.1.1"><csymbol cd="latexml" id="S4.F3.4.m2.1.1.1.cmml" xref="S4.F3.4.m2.1.1.1">percent</csymbol><cn id="S4.F3.4.m2.1.1.2.cmml" type="integer" xref="S4.F3.4.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.m2.1d">\mathbf{20\%}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.4.m2.1e">bold_20 %</annotation></semantics></math> of seeds sequence achieves best result in our experiment.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F3.5">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F3.6">Similarity matrix.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS6.SSS2.p1">
<p class="ltx_p" id="S4.SS6.SSS2.p1.2">In our search systems, a variant of user click sequence is available, and we call it seeds sequence. The seeds sequence is obtained by filtering out the items in user behavior sequence that belongs to different categories compared with the predicted intention of the current query. While click sequence offers more inter-category transfer information of user interest, seeds sequence concentrates more on intra-category similarity. In our query-item heterogeneous graph, the item2item relationship is expected to capture both types of information. Therefore, we adopt different mixture rates of click sequence and seeds sequence when building item2item relationship to test their performance. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.F3" title="Figure 3 ‣ 4.6.2. Combination of Categorically Restricted Data ‣ 4.6. Graph Input Data Management ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">3</span></a>, <math alttext="80\%" class="ltx_Math" display="inline" id="S4.SS6.SSS2.p1.1.m1.1"><semantics id="S4.SS6.SSS2.p1.1.m1.1a"><mrow id="S4.SS6.SSS2.p1.1.m1.1.1" xref="S4.SS6.SSS2.p1.1.m1.1.1.cmml"><mn id="S4.SS6.SSS2.p1.1.m1.1.1.2" xref="S4.SS6.SSS2.p1.1.m1.1.1.2.cmml">80</mn><mo id="S4.SS6.SSS2.p1.1.m1.1.1.1" xref="S4.SS6.SSS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.SSS2.p1.1.m1.1b"><apply id="S4.SS6.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS6.SSS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS6.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS6.SSS2.p1.1.m1.1.1.1">percent</csymbol><cn id="S4.SS6.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS6.SSS2.p1.1.m1.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.SSS2.p1.1.m1.1c">80\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.SSS2.p1.1.m1.1d">80 %</annotation></semantics></math> of click sequence and <math alttext="20\%" class="ltx_Math" display="inline" id="S4.SS6.SSS2.p1.2.m2.1"><semantics id="S4.SS6.SSS2.p1.2.m2.1a"><mrow id="S4.SS6.SSS2.p1.2.m2.1.1" xref="S4.SS6.SSS2.p1.2.m2.1.1.cmml"><mn id="S4.SS6.SSS2.p1.2.m2.1.1.2" xref="S4.SS6.SSS2.p1.2.m2.1.1.2.cmml">20</mn><mo id="S4.SS6.SSS2.p1.2.m2.1.1.1" xref="S4.SS6.SSS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.SSS2.p1.2.m2.1b"><apply id="S4.SS6.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS6.SSS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS6.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS6.SSS2.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS6.SSS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS6.SSS2.p1.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.SSS2.p1.2.m2.1c">20\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.SSS2.p1.2.m2.1d">20 %</annotation></semantics></math> of seeds sequence are combined to achieve the best CTR AUC on the industrial datasets. Our approach adopts this proportion during other experiments for the best performance.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7. </span>Analysis of EGIN Embedding</h3>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="530" id="S4.F4.g1" src="x4.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Graph embedding similarity matrix of several randomly selected item pairs from our industrial dataset.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F4.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F4.2">Similarity matrix.</p>
</div>
</div>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Average similarity of EGIN and DNN embedding</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T5.1.1.1.1">Average similarity</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.2">EGIN emb</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.3">EGES emb</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.4">DNN emb</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.2.1.1">Intra-category</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.2">0.6392</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.3">0.2973</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.4">0.0121</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T5.1.3.2.1">Inter-category</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.3.2.2">0.0061</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.3.2.3">0.0121</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.3.2.4">0.0076</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.1">To analyze the embedding learned by our EGIN model, we randomly choose four pairs of items from the industrial dataset to demonstrate their similarity. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.F4" title="Figure 4 ‣ 4.7. Analysis of EGIN Embedding ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">4</span></a>, similarity within the pair is significantly higher. Belonging to different sub-categories, (female t-shirt, female pants) and (spicy fish, pickles) present similarities of 0.214 and 0.440, demonstrating that the embedding learned by EGIN is able to model various similarity information.</p>
</div>
<div class="ltx_para" id="S4.SS7.p2">
<p class="ltx_p" id="S4.SS7.p2.1">Besides, we randomly choose 1 million intra-category and inter-category item pairs from our industrial dataset and test their average cosine similarities of embeddings produced by different methods. Table <a class="ltx_ref" href="https://arxiv.org/html/2406.17745v3#S4.T5" title="Table 5 ‣ 4.7. Analysis of EGIN Embedding ‣ 4. Experiments ‣ Light-weight End-to-End Graph Interest Network for CTR Prediction in E-commerce Search"><span class="ltx_text ltx_ref_tag">5</span></a> shows us that the intra-category similarity of EGIN is much higher than the inter-category, whereas the difference from DNN embedding is relatively indistinctive. At the same time, our graph embedding appears to be more capable of capturing relationships between similar items than EGES and DNN.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8. </span>Online A/B Test</h3>
<div class="ltx_para" id="S4.SS8.p1">
<p class="ltx_p" id="S4.SS8.p1.1">We conduct online experiments in an A/B testing framework to further evaluate the performance of EGIN. The experimental goal is Click-Through-Rate (CTR) on the search result page of our e-commerce platform. The experiment lasts for 14 days and EGIN achieves a 2.76% CTR gain compared to the product model, showing the great application value of the proposed approach.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we propose a novel approach named EGIN for CTR prediction in e-commerce search scenarios. End-to-end joint training of graph embedding and CTR prediction is implemented in a light-weight framework without reorganization of graph data or dependency on graph engines. Our query-item heterogeneous graph well exploits impression log data of search systems to take query-item correlation and their sequential information into account to improve CTR prediction performance. Multi-interest network for CTR prediction is designed to comprehensively consume various information provided by item and query embeddings provided by the graph neural network. Offline experiments on public and industrial datasets demonstrate that the proposed EGIN outperforms attention-based and graph-based competitors. Online A/B test result reveals the great application value of the proposed approach.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Our work is an initial step towards a highly efficient heterogeneous graph learning method capturing various similarity information for CTR prediction in e-commerce search. The proposed framework has low computation cost and no dependency on the graph engine, which results in an effortless implementation in large-scale systems. At the same time, our method can be generalized to different search and recommendation systems and becomes a helpful plug-in for CTR prediction by providing high-quality embedding. In the future, we will integrate other types of nodes into the heterogeneous graph to complete the structure and improve the performance. We will also explore a better way to integrate graph embedding information in the CTR prediction network.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Qiwei Chen, Huan Zhao, Wei Li, Pipei Huang, and Wenwu Ou. 2019.

</span>
<span class="ltx_bibblock">Behavior sequence transformer for e-commerce recommendation in alibaba. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proceedings of the 1st International Workshop on Deep Learning Practice for High-Dimensional Sparse Data</em>. 1–4.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra, Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, Rohan Anil, Zakaria Haque, Lichan Hong, Vihan Jain, Xiaobing Liu, and Hemal Shah. 2016.

</span>
<span class="ltx_bibblock">Wide &amp; Deep Learning for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 1st Workshop on Deep Learning for Recommender Systems</em> (Boston, MA, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib3.4.2">(DLRS 2016)</em>. Association for Computing Machinery, New York, NY, USA, 7–10.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2988450.2988454" title="">https://doi.org/10.1145/2988450.2988454</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Defferrard et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Michaël Defferrard, Xavier Bresson, and Pierre Vandergheynst. 2016.

</span>
<span class="ltx_bibblock">Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 30th International Conference on Neural Information Processing Systems</em> (Barcelona, Spain) <em class="ltx_emph ltx_font_italic" id="bib.bib4.4.2">(NIPS’16)</em>. Curran Associates Inc., Red Hook, NY, USA, 3844–3852.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dougherty et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (1995)</span>
<span class="ltx_bibblock">
James Dougherty, Ron Kohavi, and Mehran Sahami. 1995.

</span>
<span class="ltx_bibblock">Supervised and unsupervised discretization of continuous features.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Machine learning proceedings 1995</em>. Elsevier, 194–202.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Yufei Feng, Fuyu Lv, Weichen Shen, Menghan Wang, Fei Sun, Yu Zhu, and Keping Yang. 2019.

</span>
<span class="ltx_bibblock">Deep Session Interest Network for Click-Through Rate Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">CoRR</em> abs/1905.06482 (2019).

</span>
<span class="ltx_bibblock">arXiv:1905.06482

<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1905.06482" title="">http://arxiv.org/abs/1905.06482</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">CoRR</em> abs/1703.04247 (2017).

</span>
<span class="ltx_bibblock">arXiv:1703.04247

<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1703.04247" title="">http://arxiv.org/abs/1703.04247</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wei Guo, Rong Su, Renhao Tan, Huifeng Guo, Yingxue Zhang, Zhirong Liu, Ruiming Tang, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">Dual Graph Enhanced Embedding Neural Network for CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em> (Virtual Event, Singapore) <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.2">(KDD ’21)</em>. Association for Computing Machinery, New York, NY, USA, 496–504.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3447548.3467384" title="">https://doi.org/10.1145/3447548.3467384</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Chao Li, Zhiyuan Liu, Mengmeng Wu, Yuchi Xu, Huan Zhao, Pipei Huang, Guoliang Kang, Qiwei Chen, Wei Li, and Dik Lun Lee. 2019b.

</span>
<span class="ltx_bibblock">Multi-Interest Network with Dynamic Routing for Recommendation at Tmall. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</em> (Beijing, China) <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.2">(CIKM ’19)</em>. Association for Computing Machinery, New York, NY, USA, 2615–2623.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3357384.3357814" title="">https://doi.org/10.1145/3357384.3357814</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Feng Li, Zhenrui Chen, Pengjie Wang, Yi Ren, Di Zhang, and Xiaoyu Zhu. 2019a.

</span>
<span class="ltx_bibblock">Graph intention network for click-through rate prediction in sponsored search. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 42nd international ACM SIGIR conference on research and development in information retrieval</em>. 961–964.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jianxun Lian, Xiaohuan Zhou, Fuzheng Zhang, Zhongxia Chen, Xing Xie, and Guangzhong Sun. 2018.

</span>
<span class="ltx_bibblock">XDeepFM: Combining Explicit and Implicit Feature Interactions for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> (London, United Kingdom) <em class="ltx_emph ltx_font_italic" id="bib.bib11.4.2">(KDD ’18)</em>. Association for Computing Machinery, New York, NY, USA, 1754–1763.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3219819.3220023" title="">https://doi.org/10.1145/3219819.3220023</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Linmei et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Hu Linmei, Tianchi Yang, Chuan Shi, Houye Ji, and Xiaoli Li. 2019.

</span>
<span class="ltx_bibblock">Heterogeneous Graph Attention Networks for Semi-supervised Short Text Classification. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>. Association for Computational Linguistics, Hong Kong, China, 4821–4830.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/D19-1488" title="">https://doi.org/10.18653/v1/D19-1488</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2013a)</span>
<span class="ltx_bibblock">
Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean. 2013a.

</span>
<span class="ltx_bibblock">Efficient estimation of word representations in vector space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv preprint arXiv:1301.3781</em> (2013).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2013b)</span>
<span class="ltx_bibblock">
Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S Corrado, and Jeff Dean. 2013b.

</span>
<span class="ltx_bibblock">Distributed representations of words and phrases and their compositionality.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Advances in neural information processing systems</em> 26 (2013).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Erxue Min, Yu Rong, Tingyang Xu, Yatao Bian, Da Luo, Kangyi Lin, Junzhou Huang, Sophia Ananiadou, and Peilin Zhao. 2022.

</span>
<span class="ltx_bibblock">Neighbour Interaction Based Click-Through Rate Prediction via Graph-Masked Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (Madrid, Spain) <em class="ltx_emph ltx_font_italic" id="bib.bib15.4.2">(SIGIR ’22)</em>. Association for Computing Machinery, New York, NY, USA, 353–362.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3477495.3532031" title="">https://doi.org/10.1145/3477495.3532031</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perozzi et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Bryan Perozzi, Rami Al-Rfou, and Steven Skiena. 2014.

</span>
<span class="ltx_bibblock">Deepwalk: Online learning of social representations. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 20th ACM SIGKDD international conference on Knowledge discovery and data mining</em>. 701–710.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pi et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Qi Pi, Weijie Bian, Guorui Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Practice on Long Sequential User Behavior Modeling for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2010.

</span>
<span class="ltx_bibblock">Factorization Machines. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">2010 IEEE International Conference on Data Mining</em>. 995–1000.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICDM.2010.127" title="">https://doi.org/10.1109/ICDM.2010.127</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized Top-N Sequential Recommendation via Convolutional Sequence Embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the Eleventh ACM International Conference on Web Search and Data Mining</em> (Marina Del Rey, CA, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib19.2.2">(WSDM ’18)</em>. Association for Computing Machinery, New York, NY, USA, 565–573.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3159652.3159656" title="">https://doi.org/10.1145/3159652.3159656</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jizhe Wang, Pipei Huang, Huan Zhao, Zhibo Zhang, Binqiang Zhao, and Dik Lun Lee. 2018.

</span>
<span class="ltx_bibblock">Billion-scale commodity embedding for e-commerce recommendation in alibaba. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 839–848.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Bin Fu, Gang Fu, and Mingliang Wang. 2017.

</span>
<span class="ltx_bibblock">Deep &amp; Cross Network for Ad Click Predictions. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the ADKDD’17</em> (Halifax, NS, Canada) <em class="ltx_emph ltx_font_italic" id="bib.bib21.4.2">(ADKDD’17)</em>. Association for Computing Machinery, New York, NY, USA, Article 12, 7 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3124749.3124754" title="">https://doi.org/10.1145/3124749.3124754</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Yixin Cao, Meng Liu, and Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">KGAT: Knowledge Graph Attention Network for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> (Anchorage, AK, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib22.4.2">(KDD ’19)</em>. Association for Computing Machinery, New York, NY, USA, 950–958.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3292500.3330989" title="">https://doi.org/10.1145/3292500.3330989</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fajie Yuan, Alexandros Karatzoglou, Ioannis Arapakis, Joemon M. Jose, and Xiangnan He. 2019.

</span>
<span class="ltx_bibblock">A Simple Convolutional Generative Network for Next Item Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining</em> (Melbourne VIC, Australia) <em class="ltx_emph ltx_font_italic" id="bib.bib23.4.2">(WSDM ’19)</em>. Association for Computing Machinery, New York, NY, USA, 582–590.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3289600.3290975" title="">https://doi.org/10.1145/3289600.3290975</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Guorui Zhou, Na Mou, Ying Fan, Qi Pi, Weijie Bian, Chang Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Deep interest evolution network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the AAAI conference on artificial intelligence</em>, Vol. 33. 5941–5948.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1059–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Han Zhu, Xiang Li, Pengye Zhang, Guozheng Li, Jie He, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Learning Tree-based Deep Model for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. ACM.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jul  4 17:51:13 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
