<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook</title>
<!--Generated on Mon Sep  9 23:07:55 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.06105v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx1" title="In SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2" title="In SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx1" title="In Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx1.SSS0.Px1" title="In Preliminary ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">VQ-VAE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx1.SSS0.Px2" title="In Preliminary ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Online Clustering</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx2" title="In Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Semantic Online Clustering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx3" title="In Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Consistent Semantic Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx4" title="In Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Multi-level Feature Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx5" title="In Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Modeling Prior Distribution</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx5.SSS0.Px1" title="In Modeling Prior Distribution ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Image Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.SSx5.SSS0.Px2" title="In Modeling Prior Distribution ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Video Prediction</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3" title="In SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx1" title="In Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Experimental Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx2" title="In Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Degree of Semantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx3" title="In Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Unconditional Image Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx3.SSS0.Px1" title="In Unconditional Image Generation ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Network structures and implementation details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx3.SSS0.Px2" title="In Unconditional Image Generation ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">High Resolution Image Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx4" title="In Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Video Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx4.SSS0.Px1" title="In Video Generation ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Network structures and implementation details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx5" title="In Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Image Reconstruction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.SSx6" title="In Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Ablation Experiments</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx4" title="In SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_title">Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">SGC-VQGAN: Towards Complex Scene
Representation via Semantic Guided Clustering
Codebook</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chenjing Ding <sup class="ltx_sup" id="id1.1.id1">1</sup>, Chiyu Wang<sup class="ltx_sup" id="id2.2.id2">1</sup>, Boshi Liu<sup class="ltx_sup" id="id3.3.id3">1</sup>, Xi Guo<sup class="ltx_sup" id="id4.4.id4">1</sup>, Weixuan Tang<sup class="ltx_sup" id="id5.5.id5">1</sup>, Wei Wu<sup class="ltx_sup" id="id6.6.id6">1,2</sup>
</span><span class="ltx_author_notes">Corresponding author.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id7.id1">Vector quantization (<span class="ltx_text ltx_font_bold" id="id7.id1.1">VQ</span>) is a method for deterministically learning features through discrete codebook representations. Recent works have utilized visual tokenizers to discretize visual regions for self-supervised representation learning. However, a notable limitation of these tokenizers is lack of semantics, as they are derived solely from the pretext task of reconstructing raw image pixels in an auto-encoder paradigm. Additionally, issues like imbalanced codebook distribution and codebook collapse can adversely impact performance due to inefficient codebook utilization.
To address these challenges, We introduce SGC-VQGAN through Semantic Online Clustering method to enhance token semantics through Consistent Semantic Learning. Utilizing inference results from segmentation model , our approach constructs a temporospatially consistent semantic codebook, addressing issues of codebook collapse and imbalanced token semantics. Our proposed Pyramid Feature Learning pipeline integrates multi-level features to capture both image details and semantics simultaneously. As a result, SGC-VQGAN achieves SOTA performance in both reconstruction quality and various downstream tasks. Its simplicity, requiring no additional parameter learning, enables its direct application in downstream tasks, presenting significant potential.</p>
</div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Introduction</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Vector quantization (VQ) is a technique used to learn features with discrete codebook representations, often implemented with a variational autoencoding model called VQ-VAE<cite class="ltx_cite ltx_citemacro_citep">(Aaron van den Oord <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib1" title="">2017</a>)</cite>. It is commonly employed alongside deep generative modeling for tasks such as denoising diffusion probabilistic models and autoregressive models<cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>; Hu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib9" title="">2023</a>; Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib26" title="">2024</a>; Tian et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib23" title="">2024</a>)</cite>. These methods involve a two-step process: first, learning a compressed discrete representation for each image, and then learning the prior distribution in the discrete latent space. This compression of redundant information greatly aids in training deep generative models on large-scale data. It’s important to note that regardless of the performance of the prior model, the compression performance of VQ ultimately limits the overall generation performance.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.2">Despite the achievements of VQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Aaron van den Oord <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib1" title="">2017</a>)</cite> and VQGAN <cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>, they face limitations when employed for complex scene generation tasks that demand high resolution, emphasize real-world dynamic scenarios, incorporate abundant contextual semantics, and take into account temporal aspects. <span class="ltx_text ltx_font_bold" id="Sx1.p2.2.1">Firstly</span>, one prominent drawback is their lack of semantic understanding, stemming from their reliance solely on the auto-encoder approach for reconstructing raw image pixels. GAIA-1<cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib9" title="">2023</a>)</cite> suggests that enhancing the world model’s performance hinges on directing the compression process towards meaningful representations, such as semantics, rather than solely prioritizing high-frequency signals. To address this, they employ the DINOv2<cite class="ltx_cite ltx_citemacro_citep">(Oquab et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib18" title="">2024</a>)</cite> model to guide compression. However, the semantic features in DINOv2 lack consistency across both time and space, as depicted in pipeline. Consequently, this method fails to consistently improve the semantic aspect of the codebook. <span class="ltx_text ltx_font_bold" id="Sx1.p2.2.2">Secondly</span>, imbalanced codebook distribution and codebook collaspe can adversely impact performance due to inefficient codebook utilization; Codebook collapse refers to the situation where most tokens become inactive and are not used during the generation stage. <cite class="ltx_cite ltx_citemacro_citep">(Williams et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib27" title="">2020</a>)</cite> aims to reset infrequently used or unused entries by leveraging frequently accessed ones, while CVQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite> proposes an online clustering algorithm that updates codebook entries using associated encoded features during the training stage. However, none of these approaches adequately address the imbalance in codebook utilization concerning semantics, so that the codebook are not fully utilized. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx1.F1" title="Figure 1 ‣ Introduction ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">1</span></a>, we present a visualization of the semantic distribution of the codebook in VQGAN<cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite> and its improved versions<cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite> on the Nuscenes dataset. VQGAN<cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite> and CVQ-VAE<cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite> exhibits an alarming <math alttext="0.7\%" class="ltx_Math" display="inline" id="Sx1.p2.1.m1.1"><semantics id="Sx1.p2.1.m1.1a"><mrow id="Sx1.p2.1.m1.1.1" xref="Sx1.p2.1.m1.1.1.cmml"><mn id="Sx1.p2.1.m1.1.1.2" xref="Sx1.p2.1.m1.1.1.2.cmml">0.7</mn><mo id="Sx1.p2.1.m1.1.1.1" xref="Sx1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p2.1.m1.1b"><apply id="Sx1.p2.1.m1.1.1.cmml" xref="Sx1.p2.1.m1.1.1"><csymbol cd="latexml" id="Sx1.p2.1.m1.1.1.1.cmml" xref="Sx1.p2.1.m1.1.1.1">percent</csymbol><cn id="Sx1.p2.1.m1.1.1.2.cmml" type="float" xref="Sx1.p2.1.m1.1.1.2">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p2.1.m1.1c">0.7\%</annotation><annotation encoding="application/x-llamapun" id="Sx1.p2.1.m1.1d">0.7 %</annotation></semantics></math> and <math alttext="23.5\%" class="ltx_Math" display="inline" id="Sx1.p2.2.m2.1"><semantics id="Sx1.p2.2.m2.1a"><mrow id="Sx1.p2.2.m2.1.1" xref="Sx1.p2.2.m2.1.1.cmml"><mn id="Sx1.p2.2.m2.1.1.2" xref="Sx1.p2.2.m2.1.1.2.cmml">23.5</mn><mo id="Sx1.p2.2.m2.1.1.1" xref="Sx1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p2.2.m2.1b"><apply id="Sx1.p2.2.m2.1.1.cmml" xref="Sx1.p2.2.m2.1.1"><csymbol cd="latexml" id="Sx1.p2.2.m2.1.1.1.cmml" xref="Sx1.p2.2.m2.1.1.1">percent</csymbol><cn id="Sx1.p2.2.m2.1.1.2.cmml" type="float" xref="Sx1.p2.2.m2.1.1.2">23.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p2.2.m2.1c">23.5\%</annotation><annotation encoding="application/x-llamapun" id="Sx1.p2.2.m2.1d">23.5 %</annotation></semantics></math> in terms of semantic uniqueness respectively, indicating a lack of specific semantics for the majority of these tokens. For more details about semantic performance, please refer to Appendix and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T1" title="Table 1 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="Sx1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="658" id="Sx1.F1.g1" src="extracted/5842524/img/vis_dist.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Semantic Performance Comparison; (a) tsne visualize for SGC-VQGAN(ours); Our method successfully enhanced codebook semantic; (b) codebook usage of SGC-VQGAN(ours); Our method achieve balanced and efficient utilization of codebook with <math alttext="100\%" class="ltx_Math" display="inline" id="Sx1.F1.3.m1.1"><semantics id="Sx1.F1.3.m1.1b"><mrow id="Sx1.F1.3.m1.1.1" xref="Sx1.F1.3.m1.1.1.cmml"><mn id="Sx1.F1.3.m1.1.1.2" xref="Sx1.F1.3.m1.1.1.2.cmml">100</mn><mo id="Sx1.F1.3.m1.1.1.1" xref="Sx1.F1.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx1.F1.3.m1.1c"><apply id="Sx1.F1.3.m1.1.1.cmml" xref="Sx1.F1.3.m1.1.1"><csymbol cd="latexml" id="Sx1.F1.3.m1.1.1.1.cmml" xref="Sx1.F1.3.m1.1.1.1">percent</csymbol><cn id="Sx1.F1.3.m1.1.1.2.cmml" type="integer" xref="Sx1.F1.3.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F1.3.m1.1d">100\%</annotation><annotation encoding="application/x-llamapun" id="Sx1.F1.3.m1.1e">100 %</annotation></semantics></math> active tokens; (c) tsne visualize for VQGAN<cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>; Most tokens are not used and the other tokens are with poor clustering; (d) codebook usage of VQGAN; few tokens are active (<math alttext="&lt;10\%" class="ltx_Math" display="inline" id="Sx1.F1.4.m2.1"><semantics id="Sx1.F1.4.m2.1b"><mrow id="Sx1.F1.4.m2.1.1" xref="Sx1.F1.4.m2.1.1.cmml"><mi id="Sx1.F1.4.m2.1.1.2" xref="Sx1.F1.4.m2.1.1.2.cmml"></mi><mo id="Sx1.F1.4.m2.1.1.1" xref="Sx1.F1.4.m2.1.1.1.cmml">&lt;</mo><mrow id="Sx1.F1.4.m2.1.1.3" xref="Sx1.F1.4.m2.1.1.3.cmml"><mn id="Sx1.F1.4.m2.1.1.3.2" xref="Sx1.F1.4.m2.1.1.3.2.cmml">10</mn><mo id="Sx1.F1.4.m2.1.1.3.1" xref="Sx1.F1.4.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.F1.4.m2.1c"><apply id="Sx1.F1.4.m2.1.1.cmml" xref="Sx1.F1.4.m2.1.1"><lt id="Sx1.F1.4.m2.1.1.1.cmml" xref="Sx1.F1.4.m2.1.1.1"></lt><csymbol cd="latexml" id="Sx1.F1.4.m2.1.1.2.cmml" xref="Sx1.F1.4.m2.1.1.2">absent</csymbol><apply id="Sx1.F1.4.m2.1.1.3.cmml" xref="Sx1.F1.4.m2.1.1.3"><csymbol cd="latexml" id="Sx1.F1.4.m2.1.1.3.1.cmml" xref="Sx1.F1.4.m2.1.1.3.1">percent</csymbol><cn id="Sx1.F1.4.m2.1.1.3.2.cmml" type="integer" xref="Sx1.F1.4.m2.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F1.4.m2.1d">&lt;10\%</annotation><annotation encoding="application/x-llamapun" id="Sx1.F1.4.m2.1e">&lt; 10 %</annotation></semantics></math>); (e) tsne visualize for CVQ-VAE<cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite>; Most tokens are used, however these tokens are lack semantic significance; (f) semantic performance; Other methods lack specific semantic tokens, such as those representing human and vehicles, which are crucial for generating real-world scenarios. Our method successfully cover these classes. </figcaption>
</figure>
<div class="ltx_para" id="Sx1.p3">
<p class="ltx_p" id="Sx1.p3.1">To address these challenges, we propose the <span class="ltx_text ltx_font_bold" id="Sx1.p3.1.1">Consistent Semantic Learning</span> approach, which leverages contrastive learning to guide compression while incorporating semantics. By leveraging the inference results from the segmentation model<cite class="ltx_cite ltx_citemacro_citep">(Xie et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib28" title="">2021</a>)</cite>, our approach achieves temporospatially consistent semantic learning, as the semantic IDs remain consistent across both time and space. We formulate the compression task as a <span class="ltx_text ltx_font_bold" id="Sx1.p3.1.2">Semantic Online Clustering</span> problem. This involves integrating high-level features into the codebook and computing multilevel distances between tokens and encoded features. These distances are then aggregated through a weighted sum to determine the clustering criteria for the codebook and encoded features. As the encoded features within the deep network undergo updates during training rather than remaining fixed, we apply a dynamic updating strategy to update multi-level features in the codebook. Additionally, our <span class="ltx_text ltx_font_bold" id="Sx1.p3.1.3">Multi-level Feature Learning</span> pipeline combines low-level and high-level features to enhance both reconstruction performance and semantic understanding. Given that the decoder of VQGAN<cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite> is often not utilized in the second stage in complex scene generation applications<cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib9" title="">2023</a>; Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib26" title="">2024</a>)</cite>, our pyramid feature learning approach focuses on simplicity without requiring additional parameter learning. This enables direct utilization of our method in downstream tasks, thereby maximizing its potential. The detailed process is demonstrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.F2" title="Figure 2 ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="Sx1.p4">
<p class="ltx_p" id="Sx1.p4.1">In summary, our main contributions are as follows:</p>
<ol class="ltx_enumerate" id="Sx1.I1">
<li class="ltx_item" id="Sx1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="Sx1.I1.i1.p1">
<p class="ltx_p" id="Sx1.I1.i1.p1.1">We introduce a <span class="ltx_text ltx_font_bold" id="Sx1.I1.i1.p1.1.1">Semantic Online Clustering</span> method to enhance token semantics through <span class="ltx_text ltx_font_bold" id="Sx1.I1.i1.p1.1.2">Consistent Semantic Learning</span> without requiring highly accurate annotations. By utilizing segmentation model inference results, our approach creates a temporospatially consistent semantic codebook, addressing codebook collapse and imbalanced token semantics which improves performance in various tasks leveraging VQ as a prior model.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="Sx1.I1.i2.p1">
<p class="ltx_p" id="Sx1.I1.i2.p1.1">The proposed <span class="ltx_text ltx_font_bold" id="Sx1.I1.i2.p1.1.1">Pyramid Feature Learning</span> pipeline integrates multi-level features to simultaneously capture image details and semantics. Its simplicity, without requiring additional parameter learning, allows direct application in downstream tasks, offering significant potential.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="Sx1.I1.i3.p1">
<p class="ltx_p" id="Sx1.I1.i3.p1.1">Our method undergoes extensive validation across diverse datasets and tasks to ascertain its performance.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Method</h2>
<figure class="ltx_figure" id="Sx2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="Sx2.F2.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>We introduce a Semantic Online Clustering method to enhance token semantics through Consistent Semantic Learning; Utilizing segmentation model inference results, our approach constructs a temporospatially consistent semantic codebook, addressing issues of codebook collapse and imbalanced token semantics;We use Pyramid Feature Learning pipeline integrates multi-level features to capture both image details and semantics simultaneously. Its simplicity allows for direct application in downstream tasks, offering significant potential.</figcaption>
</figure>
<section class="ltx_subsection" id="Sx2.SSx1">
<h3 class="ltx_title ltx_title_subsection">Preliminary</h3>
<section class="ltx_paragraph" id="Sx2.SSx1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">VQ-VAE</h4>
<div class="ltx_para" id="Sx2.SSx1.SSS0.Px1.p1">
<p class="ltx_p" id="Sx2.SSx1.SSS0.Px1.p1.11">VQ-VAE embeds a high-dimensional image (<math alttext="x\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1a"><mrow id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.2.cmml">x</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mn id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.4" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1"><in id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.1"></in><ci id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.2">𝑥</ci><apply id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3"><times id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.1"></times><ci id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.3">𝑊</ci><cn id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.4.cmml" type="integer" xref="Sx2.SSx1.SSS0.Px1.p1.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1c">x\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.1.m1.1d">italic_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>) with low-dimensional code vectors (<math alttext="c_{q}\in\mathbb{R}^{h\times w\times n_{q}}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1a"><mrow id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.2" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">c</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.3" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.3.cmml">q</mi></msub><mo id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml">h</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml">w</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.2" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.2.cmml">n</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.3" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.3.cmml">q</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1"><in id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.1"></in><apply id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.2">𝑐</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.2.3">𝑞</ci></apply><apply id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3">superscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3"><times id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.1"></times><ci id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.2">ℎ</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.3">𝑤</ci><apply id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.2">𝑛</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.2.m2.1.1.3.3.4.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1c">c_{q}\in\mathbb{R}^{h\times w\times n_{q}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_w × italic_n start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>), where <math alttext="n_{q}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1a"><msub id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.2.cmml">n</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.2">𝑛</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1c">n_{q}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.3.m3.1d">italic_n start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the dimensionality of the codebook vectors. The feature tensor is compactly represented as <math alttext="h\times w" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1a"><mrow id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.2.cmml">h</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.1.cmml">×</mo><mi id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1"><times id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.1"></times><ci id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.2">ℎ</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.4.m4.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1c">h\times w</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.4.m4.1d">italic_h × italic_w</annotation></semantics></math> indices. This compact representation is achieved via training a reconstruction task <math alttext="\hat{x}=G_{\theta}(c_{q})=G_{\theta}(q(\hat{z}))=G_{\theta}(q(E_{\phi}(x)))" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5"><semantics id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5a"><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.cmml"><mover accent="true" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.2.cmml">x</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.1.cmml">^</mo></mover><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.6" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.6.cmml">=</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.cmml"><msub id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.2.cmml">G</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.3.cmml">θ</mi></msub><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.2.cmml">⁢</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.cmml"><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.2" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.cmml">(</mo><msub id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.2.cmml">c</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.3.cmml">q</mi></msub><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.3" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.7" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.7.cmml">=</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.cmml"><msub id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.2.cmml">G</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.3.cmml">θ</mi></msub><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.2.cmml">⁢</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.cmml"><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.2" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.cmml">(</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.2.cmml">q</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.1.cmml">⁢</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.cmml"><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.3.2.1" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.cmml">(</mo><mover accent="true" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.2.cmml">z</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.1.cmml">^</mo></mover><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.3.2.2" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.3" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.8" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.8.cmml">=</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.cmml"><msub id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.2.cmml">G</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.3.cmml">θ</mi></msub><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.2.cmml">⁢</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.cmml"><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.2" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.cmml">(</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.3.cmml">q</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml"><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.2" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml"><msub id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.3" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.3.cmml">ϕ</mi></msub><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.3.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml"><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml">(</mo><mi id="Sx2.SSx1.SSS0.Px1.p1.5.m5.2.2" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.2.2.cmml">x</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.3" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.3" stretchy="false" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5b"><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5"><and id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5a.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5"></and><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5b.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5"><eq id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.6.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.6"></eq><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5"><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.1">^</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.5.2">𝑥</ci></apply><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1"><times id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.2"></times><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.2">𝐺</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.3.3">𝜃</ci></apply><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.2">𝑐</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.1.1.1.3">𝑞</ci></apply></apply></apply><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5c.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5"><eq id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.7.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.7"></eq><share href="https://arxiv.org/html/2409.06105v1#Sx2.SSx1.SSS0.Px1.p1.5.m5.3.3.1.cmml" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5d.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5"></share><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2"><times id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.2"></times><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.2">𝐺</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.3.3">𝜃</ci></apply><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1"><times id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.1"></times><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.2">𝑞</ci><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.1.1.1.3.2"><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.1">^</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.1.1.2">𝑧</ci></apply></apply></apply></apply><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5e.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5"><eq id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.8.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.8"></eq><share href="https://arxiv.org/html/2409.06105v1#Sx2.SSx1.SSS0.Px1.p1.5.m5.4.4.2.cmml" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5f.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5"></share><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3"><times id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.2"></times><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.2">𝐺</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.3.3">𝜃</ci></apply><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1"><times id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.2"></times><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.3">𝑞</ci><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1"><times id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.1"></times><apply id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.2">𝐸</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.5.5.3.1.1.1.1.1.1.2.3">italic-ϕ</ci></apply><ci id="Sx2.SSx1.SSS0.Px1.p1.5.m5.2.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.5.m5.2.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5c">\hat{x}=G_{\theta}(c_{q})=G_{\theta}(q(\hat{z}))=G_{\theta}(q(E_{\phi}(x)))</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.5.m5.5d">over^ start_ARG italic_x end_ARG = italic_G start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_c start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) = italic_G start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_q ( over^ start_ARG italic_z end_ARG ) ) = italic_G start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_q ( italic_E start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x ) ) )</annotation></semantics></math>, where <math alttext="E_{\phi}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1a"><msub id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.2.cmml">E</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.2">𝐸</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.6.m6.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1c">E_{\phi}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.6.m6.1d">italic_E start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="G_{\theta}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1a"><msub id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.2.cmml">G</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.2">𝐺</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1c">G_{\theta}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.7.m7.1d">italic_G start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> are the encoder and decoder, <math alttext="q" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.8.m8.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.8.m8.1a"><mi id="Sx2.SSx1.SSS0.Px1.p1.8.m8.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.8.m8.1b"><ci id="Sx2.SSx1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.8.m8.1c">q</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.8.m8.1d">italic_q</annotation></semantics></math> and <math alttext="\hat{z}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1a"><mover accent="true" id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.2.cmml">z</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1"><ci id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.1">^</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.9.m9.1.1.2">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1c">\hat{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.9.m9.1d">over^ start_ARG italic_z end_ARG</annotation></semantics></math> denotes quantization and encoded features. During training, the encoder <math alttext="E_{\phi}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1a"><msub id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.2.cmml">E</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.2">𝐸</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.10.m10.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1c">E_{\phi}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.10.m10.1d">italic_E start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, decoder <math alttext="G_{\theta}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1a"><msub id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.2.cmml">G</mi><mi id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.2">𝐺</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.11.m11.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1c">G_{\theta}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.11.m11.1d">italic_G start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, and codebook are jointly optimized by minimizing the following objective:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="loss=\|x-\hat{x}\|_{2}+\|sg[E_{\phi}(x)]-c_{q}\|_{2}+\gamma*\|E_{\phi}(x)-sg[c%
_{q}]\|_{2}" class="ltx_Math" display="block" id="Sx2.E1.m1.5"><semantics id="Sx2.E1.m1.5a"><mrow id="Sx2.E1.m1.5.5" xref="Sx2.E1.m1.5.5.cmml"><mrow id="Sx2.E1.m1.5.5.5" xref="Sx2.E1.m1.5.5.5.cmml"><mi id="Sx2.E1.m1.5.5.5.2" xref="Sx2.E1.m1.5.5.5.2.cmml">l</mi><mo id="Sx2.E1.m1.5.5.5.1" xref="Sx2.E1.m1.5.5.5.1.cmml">⁢</mo><mi id="Sx2.E1.m1.5.5.5.3" xref="Sx2.E1.m1.5.5.5.3.cmml">o</mi><mo id="Sx2.E1.m1.5.5.5.1a" xref="Sx2.E1.m1.5.5.5.1.cmml">⁢</mo><mi id="Sx2.E1.m1.5.5.5.4" xref="Sx2.E1.m1.5.5.5.4.cmml">s</mi><mo id="Sx2.E1.m1.5.5.5.1b" xref="Sx2.E1.m1.5.5.5.1.cmml">⁢</mo><mi id="Sx2.E1.m1.5.5.5.5" xref="Sx2.E1.m1.5.5.5.5.cmml">s</mi></mrow><mo id="Sx2.E1.m1.5.5.4" xref="Sx2.E1.m1.5.5.4.cmml">=</mo><mrow id="Sx2.E1.m1.5.5.3" xref="Sx2.E1.m1.5.5.3.cmml"><msub id="Sx2.E1.m1.3.3.1.1" xref="Sx2.E1.m1.3.3.1.1.cmml"><mrow id="Sx2.E1.m1.3.3.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.2.cmml"><mo id="Sx2.E1.m1.3.3.1.1.1.1.2" stretchy="false" xref="Sx2.E1.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="Sx2.E1.m1.3.3.1.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.1.1.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.2.cmml">x</mi><mo id="Sx2.E1.m1.3.3.1.1.1.1.1.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="Sx2.E1.m1.3.3.1.1.1.1.1.3" xref="Sx2.E1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="Sx2.E1.m1.3.3.1.1.1.1.1.3.2" xref="Sx2.E1.m1.3.3.1.1.1.1.1.3.2.cmml">x</mi><mo id="Sx2.E1.m1.3.3.1.1.1.1.1.3.1" xref="Sx2.E1.m1.3.3.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="Sx2.E1.m1.3.3.1.1.1.1.3" stretchy="false" xref="Sx2.E1.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx2.E1.m1.3.3.1.1.3" xref="Sx2.E1.m1.3.3.1.1.3.cmml">2</mn></msub><mo id="Sx2.E1.m1.5.5.3.4" xref="Sx2.E1.m1.5.5.3.4.cmml">+</mo><msub id="Sx2.E1.m1.4.4.2.2" xref="Sx2.E1.m1.4.4.2.2.cmml"><mrow id="Sx2.E1.m1.4.4.2.2.1.1" xref="Sx2.E1.m1.4.4.2.2.1.2.cmml"><mo id="Sx2.E1.m1.4.4.2.2.1.1.2" stretchy="false" xref="Sx2.E1.m1.4.4.2.2.1.2.1.cmml">‖</mo><mrow id="Sx2.E1.m1.4.4.2.2.1.1.1" xref="Sx2.E1.m1.4.4.2.2.1.1.1.cmml"><mrow id="Sx2.E1.m1.4.4.2.2.1.1.1.1" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.cmml"><mi id="Sx2.E1.m1.4.4.2.2.1.1.1.1.3" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.3.cmml">s</mi><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.1.2" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E1.m1.4.4.2.2.1.1.1.1.4" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.4.cmml">g</mi><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.1.2a" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.2.cmml"><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.cmml"><msub id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.2" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.3" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.3.cmml">ϕ</mi></msub><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.3.2" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="Sx2.E1.m1.1.1" xref="Sx2.E1.m1.1.1.cmml">x</mi><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="Sx2.E1.m1.4.4.2.2.1.1.1.2" xref="Sx2.E1.m1.4.4.2.2.1.1.1.2.cmml">−</mo><msub id="Sx2.E1.m1.4.4.2.2.1.1.1.3" xref="Sx2.E1.m1.4.4.2.2.1.1.1.3.cmml"><mi id="Sx2.E1.m1.4.4.2.2.1.1.1.3.2" xref="Sx2.E1.m1.4.4.2.2.1.1.1.3.2.cmml">c</mi><mi id="Sx2.E1.m1.4.4.2.2.1.1.1.3.3" xref="Sx2.E1.m1.4.4.2.2.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="Sx2.E1.m1.4.4.2.2.1.1.3" stretchy="false" xref="Sx2.E1.m1.4.4.2.2.1.2.1.cmml">‖</mo></mrow><mn id="Sx2.E1.m1.4.4.2.2.3" xref="Sx2.E1.m1.4.4.2.2.3.cmml">2</mn></msub><mo id="Sx2.E1.m1.5.5.3.4a" xref="Sx2.E1.m1.5.5.3.4.cmml">+</mo><mrow id="Sx2.E1.m1.5.5.3.3" xref="Sx2.E1.m1.5.5.3.3.cmml"><mi id="Sx2.E1.m1.5.5.3.3.3" xref="Sx2.E1.m1.5.5.3.3.3.cmml">γ</mi><mo id="Sx2.E1.m1.5.5.3.3.2" lspace="0.222em" rspace="0.222em" xref="Sx2.E1.m1.5.5.3.3.2.cmml">∗</mo><msub id="Sx2.E1.m1.5.5.3.3.1" xref="Sx2.E1.m1.5.5.3.3.1.cmml"><mrow id="Sx2.E1.m1.5.5.3.3.1.1.1" xref="Sx2.E1.m1.5.5.3.3.1.1.2.cmml"><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.2" stretchy="false" xref="Sx2.E1.m1.5.5.3.3.1.1.2.1.cmml">‖</mo><mrow id="Sx2.E1.m1.5.5.3.3.1.1.1.1" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.cmml"><mrow id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.cmml"><msub id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.cmml"><mi id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.2" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.2.cmml">E</mi><mi id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.3" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.3.cmml">ϕ</mi></msub><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.1" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.1.cmml">⁢</mo><mrow id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.3.2" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.cmml"><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.3.2.1" stretchy="false" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.cmml">(</mo><mi id="Sx2.E1.m1.2.2" xref="Sx2.E1.m1.2.2.cmml">x</mi><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.3.2.2" stretchy="false" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.2" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.2.cmml">−</mo><mrow id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.cmml"><mi id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.3" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.3.cmml">s</mi><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.2" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.4" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.4.cmml">g</mi><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.2a" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.2.cmml"><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.2" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.3" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="Sx2.E1.m1.5.5.3.3.1.1.1.3" stretchy="false" xref="Sx2.E1.m1.5.5.3.3.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx2.E1.m1.5.5.3.3.1.3" xref="Sx2.E1.m1.5.5.3.3.1.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E1.m1.5b"><apply id="Sx2.E1.m1.5.5.cmml" xref="Sx2.E1.m1.5.5"><eq id="Sx2.E1.m1.5.5.4.cmml" xref="Sx2.E1.m1.5.5.4"></eq><apply id="Sx2.E1.m1.5.5.5.cmml" xref="Sx2.E1.m1.5.5.5"><times id="Sx2.E1.m1.5.5.5.1.cmml" xref="Sx2.E1.m1.5.5.5.1"></times><ci id="Sx2.E1.m1.5.5.5.2.cmml" xref="Sx2.E1.m1.5.5.5.2">𝑙</ci><ci id="Sx2.E1.m1.5.5.5.3.cmml" xref="Sx2.E1.m1.5.5.5.3">𝑜</ci><ci id="Sx2.E1.m1.5.5.5.4.cmml" xref="Sx2.E1.m1.5.5.5.4">𝑠</ci><ci id="Sx2.E1.m1.5.5.5.5.cmml" xref="Sx2.E1.m1.5.5.5.5">𝑠</ci></apply><apply id="Sx2.E1.m1.5.5.3.cmml" xref="Sx2.E1.m1.5.5.3"><plus id="Sx2.E1.m1.5.5.3.4.cmml" xref="Sx2.E1.m1.5.5.3.4"></plus><apply id="Sx2.E1.m1.3.3.1.1.cmml" xref="Sx2.E1.m1.3.3.1.1"><csymbol cd="ambiguous" id="Sx2.E1.m1.3.3.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1">subscript</csymbol><apply id="Sx2.E1.m1.3.3.1.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.3.3.1.1.1.2.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="Sx2.E1.m1.3.3.1.1.1.1.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1"><minus id="Sx2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.1"></minus><ci id="Sx2.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.2">𝑥</ci><apply id="Sx2.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.3"><ci id="Sx2.E1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.3.1">^</ci><ci id="Sx2.E1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="Sx2.E1.m1.3.3.1.1.1.1.1.3.2">𝑥</ci></apply></apply></apply><cn id="Sx2.E1.m1.3.3.1.1.3.cmml" type="integer" xref="Sx2.E1.m1.3.3.1.1.3">2</cn></apply><apply id="Sx2.E1.m1.4.4.2.2.cmml" xref="Sx2.E1.m1.4.4.2.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.4.4.2.2.2.cmml" xref="Sx2.E1.m1.4.4.2.2">subscript</csymbol><apply id="Sx2.E1.m1.4.4.2.2.1.2.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.4.4.2.2.1.2.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.2">norm</csymbol><apply id="Sx2.E1.m1.4.4.2.2.1.1.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1"><minus id="Sx2.E1.m1.4.4.2.2.1.1.1.2.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.2"></minus><apply id="Sx2.E1.m1.4.4.2.2.1.1.1.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1"><times id="Sx2.E1.m1.4.4.2.2.1.1.1.1.2.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.2"></times><ci id="Sx2.E1.m1.4.4.2.2.1.1.1.1.3.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.3">𝑠</ci><ci id="Sx2.E1.m1.4.4.2.2.1.1.1.1.4.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.4">𝑔</ci><apply id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1"><times id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.1"></times><apply id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.2.3">italic-ϕ</ci></apply><ci id="Sx2.E1.m1.1.1.cmml" xref="Sx2.E1.m1.1.1">𝑥</ci></apply></apply></apply><apply id="Sx2.E1.m1.4.4.2.2.1.1.1.3.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.4.4.2.2.1.1.1.3.1.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.3">subscript</csymbol><ci id="Sx2.E1.m1.4.4.2.2.1.1.1.3.2.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.3.2">𝑐</ci><ci id="Sx2.E1.m1.4.4.2.2.1.1.1.3.3.cmml" xref="Sx2.E1.m1.4.4.2.2.1.1.1.3.3">𝑞</ci></apply></apply></apply><cn id="Sx2.E1.m1.4.4.2.2.3.cmml" type="integer" xref="Sx2.E1.m1.4.4.2.2.3">2</cn></apply><apply id="Sx2.E1.m1.5.5.3.3.cmml" xref="Sx2.E1.m1.5.5.3.3"><times id="Sx2.E1.m1.5.5.3.3.2.cmml" xref="Sx2.E1.m1.5.5.3.3.2"></times><ci id="Sx2.E1.m1.5.5.3.3.3.cmml" xref="Sx2.E1.m1.5.5.3.3.3">𝛾</ci><apply id="Sx2.E1.m1.5.5.3.3.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1"><csymbol cd="ambiguous" id="Sx2.E1.m1.5.5.3.3.1.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1">subscript</csymbol><apply id="Sx2.E1.m1.5.5.3.3.1.1.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.5.5.3.3.1.1.2.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.2">norm</csymbol><apply id="Sx2.E1.m1.5.5.3.3.1.1.1.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1"><minus id="Sx2.E1.m1.5.5.3.3.1.1.1.1.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.2"></minus><apply id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3"><times id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.1"></times><apply id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.2">𝐸</ci><ci id="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.3.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.3.2.3">italic-ϕ</ci></apply><ci id="Sx2.E1.m1.2.2.cmml" xref="Sx2.E1.m1.2.2">𝑥</ci></apply><apply id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1"><times id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.2"></times><ci id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.3">𝑠</ci><ci id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.4.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.4">𝑔</ci><apply id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply></apply></apply></apply><cn id="Sx2.E1.m1.5.5.3.3.1.3.cmml" type="integer" xref="Sx2.E1.m1.5.5.3.3.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E1.m1.5c">loss=\|x-\hat{x}\|_{2}+\|sg[E_{\phi}(x)]-c_{q}\|_{2}+\gamma*\|E_{\phi}(x)-sg[c%
_{q}]\|_{2}</annotation><annotation encoding="application/x-llamapun" id="Sx2.E1.m1.5d">italic_l italic_o italic_s italic_s = ∥ italic_x - over^ start_ARG italic_x end_ARG ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + ∥ italic_s italic_g [ italic_E start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x ) ] - italic_c start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_γ ∗ ∥ italic_E start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x ) - italic_s italic_g [ italic_c start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx1.SSS0.Px1.p1.13">where <math alttext="sg" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1a"><mrow id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.2" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.2.cmml">s</mi><mo id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.1.cmml">⁢</mo><mi id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.3" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.3.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1b"><apply id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1"><times id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.1"></times><ci id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.2">𝑠</ci><ci id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.12.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1c">sg</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.12.m1.1d">italic_s italic_g</annotation></semantics></math> denotes a stop-gradient operator, and <math alttext="\gamma" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px1.p1.13.m2.1"><semantics id="Sx2.SSx1.SSS0.Px1.p1.13.m2.1a"><mi id="Sx2.SSx1.SSS0.Px1.p1.13.m2.1.1" xref="Sx2.SSx1.SSS0.Px1.p1.13.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px1.p1.13.m2.1b"><ci id="Sx2.SSx1.SSS0.Px1.p1.13.m2.1.1.cmml" xref="Sx2.SSx1.SSS0.Px1.p1.13.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px1.p1.13.m2.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px1.p1.13.m2.1d">italic_γ</annotation></semantics></math> is the weight of the last term commitment loss.</p>
</div>
</section>
<section class="ltx_paragraph" id="Sx2.SSx1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Online Clustering</h4>
<div class="ltx_para" id="Sx2.SSx1.SSS0.Px2.p1">
<p class="ltx_p" id="Sx2.SSx1.SSS0.Px2.p1.5">VQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Aaron van den Oord <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib1" title="">2017</a>)</cite> suffers from codebook collapse, where only a few codevectors receive useful gradients, leaving most unused. CVQGAN <cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite> addresses this by using an online clustering approach to update unused codevectors. It calculates the average usage of codevectors in each training mini-batch and updates their counts accordingly as Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E2" title="Equation 2 ‣ Online Clustering ‣ Preliminary ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">2</span></a>. Anchors are selected from encoded features to modify less-used or unused codevectors more significantly. Decay values are computed based on average usage as Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E3" title="Equation 3 ‣ Online Clustering ‣ Preliminary ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">3</span></a>, and codebook features are updated by combining previous values with sampled anchors, weighted by the decay values as Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E5" title="Equation 5 ‣ Online Clustering ‣ Preliminary ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N^{t}_{k}=N^{t-1}_{k}*\gamma+\frac{n^{t}_{k}}{Bhw}*(1-\gamma)," class="ltx_Math" display="block" id="Sx2.E2.m1.1"><semantics id="Sx2.E2.m1.1a"><mrow id="Sx2.E2.m1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.cmml"><mrow id="Sx2.E2.m1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.cmml"><msubsup id="Sx2.E2.m1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.3.2.2" xref="Sx2.E2.m1.1.1.1.1.3.2.2.cmml">N</mi><mi id="Sx2.E2.m1.1.1.1.1.3.3" xref="Sx2.E2.m1.1.1.1.1.3.3.cmml">k</mi><mi id="Sx2.E2.m1.1.1.1.1.3.2.3" xref="Sx2.E2.m1.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="Sx2.E2.m1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx2.E2.m1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.cmml"><mrow id="Sx2.E2.m1.1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.1.3.cmml"><msubsup id="Sx2.E2.m1.1.1.1.1.1.3.2" xref="Sx2.E2.m1.1.1.1.1.1.3.2.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.3.2.2.2" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.2.cmml">N</mi><mi id="Sx2.E2.m1.1.1.1.1.1.3.2.3" xref="Sx2.E2.m1.1.1.1.1.1.3.2.3.cmml">k</mi><mrow id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.2" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.2.cmml">t</mi><mo id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.1" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.1.cmml">−</mo><mn id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.3" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="Sx2.E2.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E2.m1.1.1.1.1.1.3.1.cmml">∗</mo><mi id="Sx2.E2.m1.1.1.1.1.1.3.3" xref="Sx2.E2.m1.1.1.1.1.1.3.3.cmml">γ</mi></mrow><mo id="Sx2.E2.m1.1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="Sx2.E2.m1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.cmml"><mfrac id="Sx2.E2.m1.1.1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.1.1.3.cmml"><msubsup id="Sx2.E2.m1.1.1.1.1.1.1.3.2" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.2" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.2.cmml">n</mi><mi id="Sx2.E2.m1.1.1.1.1.1.1.3.2.3" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.3" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.3.cmml">t</mi></msubsup><mrow id="Sx2.E2.m1.1.1.1.1.1.1.3.3" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.3.3.2" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.2.cmml">B</mi><mo id="Sx2.E2.m1.1.1.1.1.1.1.3.3.1" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="Sx2.E2.m1.1.1.1.1.1.1.3.3.3" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.3.cmml">h</mi><mo id="Sx2.E2.m1.1.1.1.1.1.1.3.3.1a" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="Sx2.E2.m1.1.1.1.1.1.1.3.3.4" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.4.cmml">w</mi></mrow></mfrac><mo id="Sx2.E2.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="Sx2.E2.m1.1.1.1.1.1.1.2.cmml">∗</mo><mrow id="Sx2.E2.m1.1.1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="Sx2.E2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E2.m1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E2.m1.1b"><apply id="Sx2.E2.m1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1"><eq id="Sx2.E2.m1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.2"></eq><apply id="Sx2.E2.m1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.3">subscript</csymbol><apply id="Sx2.E2.m1.1.1.1.1.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.3.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.3">superscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.3.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.3.2.2">𝑁</ci><ci id="Sx2.E2.m1.1.1.1.1.3.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="Sx2.E2.m1.1.1.1.1.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.3.3">𝑘</ci></apply><apply id="Sx2.E2.m1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1"><plus id="Sx2.E2.m1.1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.2"></plus><apply id="Sx2.E2.m1.1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3"><times id="Sx2.E2.m1.1.1.1.1.1.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.1"></times><apply id="Sx2.E2.m1.1.1.1.1.1.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2">subscript</csymbol><apply id="Sx2.E2.m1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2">superscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.2">𝑁</ci><apply id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3"><minus id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.1"></minus><ci id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.2">𝑡</ci><cn id="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.3.cmml" type="integer" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="Sx2.E2.m1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="Sx2.E2.m1.1.1.1.1.1.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3">𝛾</ci></apply><apply id="Sx2.E2.m1.1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1"><times id="Sx2.E2.m1.1.1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2"></times><apply id="Sx2.E2.m1.1.1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3"><divide id="Sx2.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3"></divide><apply id="Sx2.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.2">𝑛</ci><ci id="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2.2.3">𝑡</ci></apply><ci id="Sx2.E2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="Sx2.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3"><times id="Sx2.E2.m1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.1"></times><ci id="Sx2.E2.m1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.2">𝐵</ci><ci id="Sx2.E2.m1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.3">ℎ</ci><ci id="Sx2.E2.m1.1.1.1.1.1.1.3.3.4.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.3.3.4">𝑤</ci></apply></apply><apply id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1"><minus id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.3">𝛾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E2.m1.1c">N^{t}_{k}=N^{t-1}_{k}*\gamma+\frac{n^{t}_{k}}{Bhw}*(1-\gamma),</annotation><annotation encoding="application/x-llamapun" id="Sx2.E2.m1.1d">italic_N start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_N start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∗ italic_γ + divide start_ARG italic_n start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG italic_B italic_h italic_w end_ARG ∗ ( 1 - italic_γ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="a^{t}_{k}=exp^{-N^{t}_{k}*K*\frac{10}{1-\gamma}-\epsilon}," class="ltx_Math" display="block" id="Sx2.E3.m1.1"><semantics id="Sx2.E3.m1.1a"><mrow id="Sx2.E3.m1.1.1.1" xref="Sx2.E3.m1.1.1.1.1.cmml"><mrow id="Sx2.E3.m1.1.1.1.1" xref="Sx2.E3.m1.1.1.1.1.cmml"><msubsup id="Sx2.E3.m1.1.1.1.1.2" xref="Sx2.E3.m1.1.1.1.1.2.cmml"><mi id="Sx2.E3.m1.1.1.1.1.2.2.2" xref="Sx2.E3.m1.1.1.1.1.2.2.2.cmml">a</mi><mi id="Sx2.E3.m1.1.1.1.1.2.3" xref="Sx2.E3.m1.1.1.1.1.2.3.cmml">k</mi><mi id="Sx2.E3.m1.1.1.1.1.2.2.3" xref="Sx2.E3.m1.1.1.1.1.2.2.3.cmml">t</mi></msubsup><mo id="Sx2.E3.m1.1.1.1.1.1" xref="Sx2.E3.m1.1.1.1.1.1.cmml">=</mo><mrow id="Sx2.E3.m1.1.1.1.1.3" xref="Sx2.E3.m1.1.1.1.1.3.cmml"><mi id="Sx2.E3.m1.1.1.1.1.3.2" xref="Sx2.E3.m1.1.1.1.1.3.2.cmml">e</mi><mo id="Sx2.E3.m1.1.1.1.1.3.1" xref="Sx2.E3.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="Sx2.E3.m1.1.1.1.1.3.3" xref="Sx2.E3.m1.1.1.1.1.3.3.cmml">x</mi><mo id="Sx2.E3.m1.1.1.1.1.3.1a" xref="Sx2.E3.m1.1.1.1.1.3.1.cmml">⁢</mo><msup id="Sx2.E3.m1.1.1.1.1.3.4" xref="Sx2.E3.m1.1.1.1.1.3.4.cmml"><mi id="Sx2.E3.m1.1.1.1.1.3.4.2" xref="Sx2.E3.m1.1.1.1.1.3.4.2.cmml">p</mi><mrow id="Sx2.E3.m1.1.1.1.1.3.4.3" xref="Sx2.E3.m1.1.1.1.1.3.4.3.cmml"><mrow id="Sx2.E3.m1.1.1.1.1.3.4.3.2" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.cmml"><mo id="Sx2.E3.m1.1.1.1.1.3.4.3.2a" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.cmml">−</mo><mrow id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.cmml"><msubsup id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.cmml"><mi id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.2" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.2.cmml">N</mi><mi id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.3" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.3.cmml">k</mi><mi id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.3" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.3.cmml">t</mi></msubsup><mo id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.1.cmml">∗</mo><mi id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.3" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.3.cmml">K</mi><mo id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.1a" lspace="0.222em" rspace="0.222em" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.1.cmml">∗</mo><mfrac id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.cmml"><mn id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.2" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.2.cmml">10</mn><mrow id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.cmml"><mn id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.2" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.2.cmml">1</mn><mo id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.1" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.1.cmml">−</mo><mi id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.3" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.3.cmml">γ</mi></mrow></mfrac></mrow></mrow><mo id="Sx2.E3.m1.1.1.1.1.3.4.3.1" xref="Sx2.E3.m1.1.1.1.1.3.4.3.1.cmml">−</mo><mi id="Sx2.E3.m1.1.1.1.1.3.4.3.3" xref="Sx2.E3.m1.1.1.1.1.3.4.3.3.cmml">ϵ</mi></mrow></msup></mrow></mrow><mo id="Sx2.E3.m1.1.1.1.2" xref="Sx2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E3.m1.1b"><apply id="Sx2.E3.m1.1.1.1.1.cmml" xref="Sx2.E3.m1.1.1.1"><eq id="Sx2.E3.m1.1.1.1.1.1.cmml" xref="Sx2.E3.m1.1.1.1.1.1"></eq><apply id="Sx2.E3.m1.1.1.1.1.2.cmml" xref="Sx2.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.1.1.1.1.2.1.cmml" xref="Sx2.E3.m1.1.1.1.1.2">subscript</csymbol><apply id="Sx2.E3.m1.1.1.1.1.2.2.cmml" xref="Sx2.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.1.1.1.1.2.2.1.cmml" xref="Sx2.E3.m1.1.1.1.1.2">superscript</csymbol><ci id="Sx2.E3.m1.1.1.1.1.2.2.2.cmml" xref="Sx2.E3.m1.1.1.1.1.2.2.2">𝑎</ci><ci id="Sx2.E3.m1.1.1.1.1.2.2.3.cmml" xref="Sx2.E3.m1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.E3.m1.1.1.1.1.2.3.cmml" xref="Sx2.E3.m1.1.1.1.1.2.3">𝑘</ci></apply><apply id="Sx2.E3.m1.1.1.1.1.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3"><times id="Sx2.E3.m1.1.1.1.1.3.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.1"></times><ci id="Sx2.E3.m1.1.1.1.1.3.2.cmml" xref="Sx2.E3.m1.1.1.1.1.3.2">𝑒</ci><ci id="Sx2.E3.m1.1.1.1.1.3.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.3">𝑥</ci><apply id="Sx2.E3.m1.1.1.1.1.3.4.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="Sx2.E3.m1.1.1.1.1.3.4.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4">superscript</csymbol><ci id="Sx2.E3.m1.1.1.1.1.3.4.2.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.2">𝑝</ci><apply id="Sx2.E3.m1.1.1.1.1.3.4.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3"><minus id="Sx2.E3.m1.1.1.1.1.3.4.3.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.1"></minus><apply id="Sx2.E3.m1.1.1.1.1.3.4.3.2.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2"><minus id="Sx2.E3.m1.1.1.1.1.3.4.3.2.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2"></minus><apply id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2"><times id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.1"></times><apply id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2">subscript</csymbol><apply id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2">superscript</csymbol><ci id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.2.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.2">𝑁</ci><ci id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.2.3">𝑡</ci></apply><ci id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.2.3">𝑘</ci></apply><ci id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.3">𝐾</ci><apply id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4"><divide id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4"></divide><cn id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.2.cmml" type="integer" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.2">10</cn><apply id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3"><minus id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.1.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.1"></minus><cn id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.2.cmml" type="integer" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.2">1</cn><ci id="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.2.2.4.3.3">𝛾</ci></apply></apply></apply></apply><ci id="Sx2.E3.m1.1.1.1.1.3.4.3.3.cmml" xref="Sx2.E3.m1.1.1.1.1.3.4.3.3">italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E3.m1.1c">a^{t}_{k}=exp^{-N^{t}_{k}*K*\frac{10}{1-\gamma}-\epsilon},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E3.m1.1d">italic_a start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_e italic_x italic_p start_POSTSUPERSCRIPT - italic_N start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∗ italic_K ∗ divide start_ARG 10 end_ARG start_ARG 1 - italic_γ end_ARG - italic_ϵ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{e}_{k}^{t}=min_{i}(\|{e_{i}^{t}-c_{k}^{t}}\|_{2})," class="ltx_Math" display="block" id="Sx2.E4.m1.1"><semantics id="Sx2.E4.m1.1a"><mrow id="Sx2.E4.m1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.cmml"><mrow id="Sx2.E4.m1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.cmml"><msubsup id="Sx2.E4.m1.1.1.1.1.3" xref="Sx2.E4.m1.1.1.1.1.3.cmml"><mover accent="true" id="Sx2.E4.m1.1.1.1.1.3.2.2" xref="Sx2.E4.m1.1.1.1.1.3.2.2.cmml"><mi id="Sx2.E4.m1.1.1.1.1.3.2.2.2" xref="Sx2.E4.m1.1.1.1.1.3.2.2.2.cmml">e</mi><mo id="Sx2.E4.m1.1.1.1.1.3.2.2.1" xref="Sx2.E4.m1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="Sx2.E4.m1.1.1.1.1.3.2.3" xref="Sx2.E4.m1.1.1.1.1.3.2.3.cmml">k</mi><mi id="Sx2.E4.m1.1.1.1.1.3.3" xref="Sx2.E4.m1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo id="Sx2.E4.m1.1.1.1.1.2" xref="Sx2.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx2.E4.m1.1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.1.cmml"><mi id="Sx2.E4.m1.1.1.1.1.1.3" xref="Sx2.E4.m1.1.1.1.1.1.3.cmml">m</mi><mo id="Sx2.E4.m1.1.1.1.1.1.2" xref="Sx2.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E4.m1.1.1.1.1.1.4" xref="Sx2.E4.m1.1.1.1.1.1.4.cmml">i</mi><mo id="Sx2.E4.m1.1.1.1.1.1.2a" xref="Sx2.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><msub id="Sx2.E4.m1.1.1.1.1.1.5" xref="Sx2.E4.m1.1.1.1.1.1.5.cmml"><mi id="Sx2.E4.m1.1.1.1.1.1.5.2" xref="Sx2.E4.m1.1.1.1.1.1.5.2.cmml">n</mi><mi id="Sx2.E4.m1.1.1.1.1.1.5.3" xref="Sx2.E4.m1.1.1.1.1.1.5.3.cmml">i</mi></msub><mo id="Sx2.E4.m1.1.1.1.1.1.2b" xref="Sx2.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E4.m1.1.1.1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx2.E4.m1.1.1.1.1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">e</mi><mi id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">c</mi><mi id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx2.E4.m1.1.1.1.1.1.1.1.1.3" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="Sx2.E4.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E4.m1.1.1.1.2" xref="Sx2.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E4.m1.1b"><apply id="Sx2.E4.m1.1.1.1.1.cmml" xref="Sx2.E4.m1.1.1.1"><eq id="Sx2.E4.m1.1.1.1.1.2.cmml" xref="Sx2.E4.m1.1.1.1.1.2"></eq><apply id="Sx2.E4.m1.1.1.1.1.3.cmml" xref="Sx2.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.3.1.cmml" xref="Sx2.E4.m1.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E4.m1.1.1.1.1.3.2.cmml" xref="Sx2.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.3.2.1.cmml" xref="Sx2.E4.m1.1.1.1.1.3">subscript</csymbol><apply id="Sx2.E4.m1.1.1.1.1.3.2.2.cmml" xref="Sx2.E4.m1.1.1.1.1.3.2.2"><ci id="Sx2.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E4.m1.1.1.1.1.3.2.2.1">^</ci><ci id="Sx2.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E4.m1.1.1.1.1.3.2.2.2">𝑒</ci></apply><ci id="Sx2.E4.m1.1.1.1.1.3.2.3.cmml" xref="Sx2.E4.m1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="Sx2.E4.m1.1.1.1.1.3.3.cmml" xref="Sx2.E4.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="Sx2.E4.m1.1.1.1.1.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1"><times id="Sx2.E4.m1.1.1.1.1.1.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.2"></times><ci id="Sx2.E4.m1.1.1.1.1.1.3.cmml" xref="Sx2.E4.m1.1.1.1.1.1.3">𝑚</ci><ci id="Sx2.E4.m1.1.1.1.1.1.4.cmml" xref="Sx2.E4.m1.1.1.1.1.1.4">𝑖</ci><apply id="Sx2.E4.m1.1.1.1.1.1.5.cmml" xref="Sx2.E4.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.1.5.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.5">subscript</csymbol><ci id="Sx2.E4.m1.1.1.1.1.1.5.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.5.2">𝑛</ci><ci id="Sx2.E4.m1.1.1.1.1.1.5.3.cmml" xref="Sx2.E4.m1.1.1.1.1.1.5.3">𝑖</ci></apply><apply id="Sx2.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑒</ci><ci id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑐</ci><ci id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="Sx2.E4.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Sx2.E4.m1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E4.m1.1c">\hat{e}_{k}^{t}=min_{i}(\|{e_{i}^{t}-c_{k}^{t}}\|_{2}),</annotation><annotation encoding="application/x-llamapun" id="Sx2.E4.m1.1d">over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_m italic_i italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( ∥ italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT - italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="c_{k}^{t}=c_{k}^{t-1}*(1-a^{t}_{k})+\hat{e}_{k}^{t}*a^{t}_{k}," class="ltx_Math" display="block" id="Sx2.E5.m1.1"><semantics id="Sx2.E5.m1.1a"><mrow id="Sx2.E5.m1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.cmml"><mrow id="Sx2.E5.m1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.cmml"><msubsup id="Sx2.E5.m1.1.1.1.1.3" xref="Sx2.E5.m1.1.1.1.1.3.cmml"><mi id="Sx2.E5.m1.1.1.1.1.3.2.2" xref="Sx2.E5.m1.1.1.1.1.3.2.2.cmml">c</mi><mi id="Sx2.E5.m1.1.1.1.1.3.2.3" xref="Sx2.E5.m1.1.1.1.1.3.2.3.cmml">k</mi><mi id="Sx2.E5.m1.1.1.1.1.3.3" xref="Sx2.E5.m1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo id="Sx2.E5.m1.1.1.1.1.2" xref="Sx2.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx2.E5.m1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.cmml"><mrow id="Sx2.E5.m1.1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.1.cmml"><msubsup id="Sx2.E5.m1.1.1.1.1.1.1.3" xref="Sx2.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E5.m1.1.1.1.1.1.1.3.2.2" xref="Sx2.E5.m1.1.1.1.1.1.1.3.2.2.cmml">c</mi><mi id="Sx2.E5.m1.1.1.1.1.1.1.3.2.3" xref="Sx2.E5.m1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mrow id="Sx2.E5.m1.1.1.1.1.1.1.3.3" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.E5.m1.1.1.1.1.1.1.3.3.2" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.E5.m1.1.1.1.1.1.1.3.3.1" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.E5.m1.1.1.1.1.1.1.3.3.3" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup><mo id="Sx2.E5.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="Sx2.E5.m1.1.1.1.1.1.1.2.cmml">∗</mo><mrow id="Sx2.E5.m1.1.1.1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E5.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">a</mi><mi id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi><mi id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo id="Sx2.E5.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E5.m1.1.1.1.1.1.2" xref="Sx2.E5.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="Sx2.E5.m1.1.1.1.1.1.3" xref="Sx2.E5.m1.1.1.1.1.1.3.cmml"><msubsup id="Sx2.E5.m1.1.1.1.1.1.3.2" xref="Sx2.E5.m1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="Sx2.E5.m1.1.1.1.1.1.3.2.2.2" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.cmml"><mi id="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.2" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.2.cmml">e</mi><mo id="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.1" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.1.cmml">^</mo></mover><mi id="Sx2.E5.m1.1.1.1.1.1.3.2.2.3" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.3.cmml">k</mi><mi id="Sx2.E5.m1.1.1.1.1.1.3.2.3" xref="Sx2.E5.m1.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="Sx2.E5.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E5.m1.1.1.1.1.1.3.1.cmml">∗</mo><msubsup id="Sx2.E5.m1.1.1.1.1.1.3.3" xref="Sx2.E5.m1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.E5.m1.1.1.1.1.1.3.3.2.2" xref="Sx2.E5.m1.1.1.1.1.1.3.3.2.2.cmml">a</mi><mi id="Sx2.E5.m1.1.1.1.1.1.3.3.3" xref="Sx2.E5.m1.1.1.1.1.1.3.3.3.cmml">k</mi><mi id="Sx2.E5.m1.1.1.1.1.1.3.3.2.3" xref="Sx2.E5.m1.1.1.1.1.1.3.3.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo id="Sx2.E5.m1.1.1.1.2" xref="Sx2.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E5.m1.1b"><apply id="Sx2.E5.m1.1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1"><eq id="Sx2.E5.m1.1.1.1.1.2.cmml" xref="Sx2.E5.m1.1.1.1.1.2"></eq><apply id="Sx2.E5.m1.1.1.1.1.3.cmml" xref="Sx2.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.3.1.cmml" xref="Sx2.E5.m1.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E5.m1.1.1.1.1.3.2.cmml" xref="Sx2.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.3.2.1.cmml" xref="Sx2.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E5.m1.1.1.1.1.3.2.2.cmml" xref="Sx2.E5.m1.1.1.1.1.3.2.2">𝑐</ci><ci id="Sx2.E5.m1.1.1.1.1.3.2.3.cmml" xref="Sx2.E5.m1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="Sx2.E5.m1.1.1.1.1.3.3.cmml" xref="Sx2.E5.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="Sx2.E5.m1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1"><plus id="Sx2.E5.m1.1.1.1.1.1.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.2"></plus><apply id="Sx2.E5.m1.1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1"><times id="Sx2.E5.m1.1.1.1.1.1.1.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.2"></times><apply id="Sx2.E5.m1.1.1.1.1.1.1.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E5.m1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3.2.2">𝑐</ci><ci id="Sx2.E5.m1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="Sx2.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3"><minus id="Sx2.E5.m1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="Sx2.E5.m1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.E5.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.E5.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1"><minus id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑎</ci><ci id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><apply id="Sx2.E5.m1.1.1.1.1.1.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3"><times id="Sx2.E5.m1.1.1.1.1.1.3.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.1"></times><apply id="Sx2.E5.m1.1.1.1.1.1.3.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2">superscript</csymbol><apply id="Sx2.E5.m1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2">subscript</csymbol><apply id="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.2"><ci id="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.1">^</ci><ci id="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.2.2">𝑒</ci></apply><ci id="Sx2.E5.m1.1.1.1.1.1.3.2.2.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2.2.3">𝑘</ci></apply><ci id="Sx2.E5.m1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="Sx2.E5.m1.1.1.1.1.1.3.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.3">subscript</csymbol><apply id="Sx2.E5.m1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.1.1.1.1.1.3.3.2.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="Sx2.E5.m1.1.1.1.1.1.3.3.2.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.3.2.2">𝑎</ci><ci id="Sx2.E5.m1.1.1.1.1.1.3.3.2.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="Sx2.E5.m1.1.1.1.1.1.3.3.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E5.m1.1c">c_{k}^{t}=c_{k}^{t-1}*(1-a^{t}_{k})+\hat{e}_{k}^{t}*a^{t}_{k},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E5.m1.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT ∗ ( 1 - italic_a start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) + over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∗ italic_a start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx1.SSS0.Px2.p1.4">where <math alttext="N^{t}_{k}" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1"><semantics id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1a"><msubsup id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.2" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">N</mi><mi id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.3" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.3.cmml">k</mi><mi id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.3" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1b"><apply id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><apply id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><ci id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.2">𝑁</ci><ci id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1c">N^{t}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px2.p1.1.m1.1d">italic_N start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the number of encoded features in a mini-batch, <math alttext="Bhw" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1"><semantics id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1a"><mrow id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.2" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.2.cmml">B</mi><mo id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.1" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.3" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.3.cmml">h</mi><mo id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.1a" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.4" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.4.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1b"><apply id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1"><times id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.1"></times><ci id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.2">𝐵</ci><ci id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.3">ℎ</ci><ci id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.4.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.2.m2.1.1.4">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1c">Bhw</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px2.p1.2.m2.1d">italic_B italic_h italic_w</annotation></semantics></math> denotes the number of features on Batch, height and width. <math alttext="\gamma" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px2.p1.3.m3.1"><semantics id="Sx2.SSx1.SSS0.Px2.p1.3.m3.1a"><mi id="Sx2.SSx1.SSS0.Px2.p1.3.m3.1.1" xref="Sx2.SSx1.SSS0.Px2.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px2.p1.3.m3.1b"><ci id="Sx2.SSx1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px2.p1.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px2.p1.3.m3.1d">italic_γ</annotation></semantics></math> is a decay hyperparameter, <math alttext="\epsilon" class="ltx_Math" display="inline" id="Sx2.SSx1.SSS0.Px2.p1.4.m4.1"><semantics id="Sx2.SSx1.SSS0.Px2.p1.4.m4.1a"><mi id="Sx2.SSx1.SSS0.Px2.p1.4.m4.1.1" xref="Sx2.SSx1.SSS0.Px2.p1.4.m4.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.SSS0.Px2.p1.4.m4.1b"><ci id="Sx2.SSx1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="Sx2.SSx1.SSS0.Px2.p1.4.m4.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.SSS0.Px2.p1.4.m4.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.SSS0.Px2.p1.4.m4.1d">italic_ϵ</annotation></semantics></math> is a small constant.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="Sx2.SSx2">
<h3 class="ltx_title ltx_title_subsection">Semantic Online Clustering</h3>
<div class="ltx_para" id="Sx2.SSx2.p1">
<p class="ltx_p" id="Sx2.SSx2.p1.1">CVQ-VAE<cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite> proposes an online clustering algorithm that updates codebook entries using associated encoded features during training. However, it relies only on pixel-level elements and lacks high-level semantic features. To address this, we incorporate semantic embedding and semantic distance into the online clustering process.</p>
</div>
<div class="ltx_para" id="Sx2.SSx2.p2">
<p class="ltx_p" id="Sx2.SSx2.p2.6"><span class="ltx_text ltx_font_bold" id="Sx2.SSx2.p2.6.1">Firstly</span>, we use a segmentation model <cite class="ltx_cite ltx_citemacro_citep">(Gao et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib6" title="">2022</a>; Xie et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib28" title="">2021</a>)</cite> to get semantic ids of each image. Suppose there are <math alttext="N" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.1.m1.1"><semantics id="Sx2.SSx2.p2.1.m1.1a"><mi id="Sx2.SSx2.p2.1.m1.1.1" xref="Sx2.SSx2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.1.m1.1b"><ci id="Sx2.SSx2.p2.1.m1.1.1.cmml" xref="Sx2.SSx2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.1.m1.1d">italic_N</annotation></semantics></math> classes in total, we will learn <math alttext="N" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.2.m2.1"><semantics id="Sx2.SSx2.p2.2.m2.1a"><mi id="Sx2.SSx2.p2.2.m2.1.1" xref="Sx2.SSx2.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.2.m2.1b"><ci id="Sx2.SSx2.p2.2.m2.1.1.cmml" xref="Sx2.SSx2.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.2.m2.1d">italic_N</annotation></semantics></math> semantic embedding <math alttext="W_{i}" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.3.m3.1"><semantics id="Sx2.SSx2.p2.3.m3.1a"><msub id="Sx2.SSx2.p2.3.m3.1.1" xref="Sx2.SSx2.p2.3.m3.1.1.cmml"><mi id="Sx2.SSx2.p2.3.m3.1.1.2" xref="Sx2.SSx2.p2.3.m3.1.1.2.cmml">W</mi><mi id="Sx2.SSx2.p2.3.m3.1.1.3" xref="Sx2.SSx2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.3.m3.1b"><apply id="Sx2.SSx2.p2.3.m3.1.1.cmml" xref="Sx2.SSx2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p2.3.m3.1.1.1.cmml" xref="Sx2.SSx2.p2.3.m3.1.1">subscript</csymbol><ci id="Sx2.SSx2.p2.3.m3.1.1.2.cmml" xref="Sx2.SSx2.p2.3.m3.1.1.2">𝑊</ci><ci id="Sx2.SSx2.p2.3.m3.1.1.3.cmml" xref="Sx2.SSx2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.3.m3.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="i\in[0,N-1]" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.4.m4.2"><semantics id="Sx2.SSx2.p2.4.m4.2a"><mrow id="Sx2.SSx2.p2.4.m4.2.2" xref="Sx2.SSx2.p2.4.m4.2.2.cmml"><mi id="Sx2.SSx2.p2.4.m4.2.2.3" xref="Sx2.SSx2.p2.4.m4.2.2.3.cmml">i</mi><mo id="Sx2.SSx2.p2.4.m4.2.2.2" xref="Sx2.SSx2.p2.4.m4.2.2.2.cmml">∈</mo><mrow id="Sx2.SSx2.p2.4.m4.2.2.1.1" xref="Sx2.SSx2.p2.4.m4.2.2.1.2.cmml"><mo id="Sx2.SSx2.p2.4.m4.2.2.1.1.2" stretchy="false" xref="Sx2.SSx2.p2.4.m4.2.2.1.2.cmml">[</mo><mn id="Sx2.SSx2.p2.4.m4.1.1" xref="Sx2.SSx2.p2.4.m4.1.1.cmml">0</mn><mo id="Sx2.SSx2.p2.4.m4.2.2.1.1.3" xref="Sx2.SSx2.p2.4.m4.2.2.1.2.cmml">,</mo><mrow id="Sx2.SSx2.p2.4.m4.2.2.1.1.1" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1.cmml"><mi id="Sx2.SSx2.p2.4.m4.2.2.1.1.1.2" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1.2.cmml">N</mi><mo id="Sx2.SSx2.p2.4.m4.2.2.1.1.1.1" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1.1.cmml">−</mo><mn id="Sx2.SSx2.p2.4.m4.2.2.1.1.1.3" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="Sx2.SSx2.p2.4.m4.2.2.1.1.4" stretchy="false" xref="Sx2.SSx2.p2.4.m4.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.4.m4.2b"><apply id="Sx2.SSx2.p2.4.m4.2.2.cmml" xref="Sx2.SSx2.p2.4.m4.2.2"><in id="Sx2.SSx2.p2.4.m4.2.2.2.cmml" xref="Sx2.SSx2.p2.4.m4.2.2.2"></in><ci id="Sx2.SSx2.p2.4.m4.2.2.3.cmml" xref="Sx2.SSx2.p2.4.m4.2.2.3">𝑖</ci><interval closure="closed" id="Sx2.SSx2.p2.4.m4.2.2.1.2.cmml" xref="Sx2.SSx2.p2.4.m4.2.2.1.1"><cn id="Sx2.SSx2.p2.4.m4.1.1.cmml" type="integer" xref="Sx2.SSx2.p2.4.m4.1.1">0</cn><apply id="Sx2.SSx2.p2.4.m4.2.2.1.1.1.cmml" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1"><minus id="Sx2.SSx2.p2.4.m4.2.2.1.1.1.1.cmml" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1.1"></minus><ci id="Sx2.SSx2.p2.4.m4.2.2.1.1.1.2.cmml" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1.2">𝑁</ci><cn id="Sx2.SSx2.p2.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="Sx2.SSx2.p2.4.m4.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.4.m4.2c">i\in[0,N-1]</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.4.m4.2d">italic_i ∈ [ 0 , italic_N - 1 ]</annotation></semantics></math>; <span class="ltx_text ltx_font_bold" id="Sx2.SSx2.p2.6.2">Then</span>, we incorporate high-level features to codebook and compute multilevel distances of encoded feature separately, using these distances to cluster the codebook and encoded features as Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E6" title="Equation 6 ‣ Semantic Online Clustering ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">6</span></a>; <span class="ltx_text ltx_font_bold" id="Sx2.SSx2.p2.6.3">Finally</span>, since the data points, the encoded features in the deep network, are also updated during training instead of being fixed, a dynamic updating strategy must account for these changing feature representations. Therefore, we use exponential moving average(EMA) approach with <math alttext="W_{i}" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.5.m5.1"><semantics id="Sx2.SSx2.p2.5.m5.1a"><msub id="Sx2.SSx2.p2.5.m5.1.1" xref="Sx2.SSx2.p2.5.m5.1.1.cmml"><mi id="Sx2.SSx2.p2.5.m5.1.1.2" xref="Sx2.SSx2.p2.5.m5.1.1.2.cmml">W</mi><mi id="Sx2.SSx2.p2.5.m5.1.1.3" xref="Sx2.SSx2.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.5.m5.1b"><apply id="Sx2.SSx2.p2.5.m5.1.1.cmml" xref="Sx2.SSx2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p2.5.m5.1.1.1.cmml" xref="Sx2.SSx2.p2.5.m5.1.1">subscript</csymbol><ci id="Sx2.SSx2.p2.5.m5.1.1.2.cmml" xref="Sx2.SSx2.p2.5.m5.1.1.2">𝑊</ci><ci id="Sx2.SSx2.p2.5.m5.1.1.3.cmml" xref="Sx2.SSx2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.5.m5.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and encoded feature to update the codebook together as Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E7" title="Equation 7 ‣ Semantic Online Clustering ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">7</span></a> and Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E9" title="Equation 9 ‣ Consistent Semantic Learning ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">9</span></a>. As a result, along with the training stage moves on and the hit frequency of codebook entries gets larger, <math alttext="W_{i}" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.6.m6.1"><semantics id="Sx2.SSx2.p2.6.m6.1a"><msub id="Sx2.SSx2.p2.6.m6.1.1" xref="Sx2.SSx2.p2.6.m6.1.1.cmml"><mi id="Sx2.SSx2.p2.6.m6.1.1.2" xref="Sx2.SSx2.p2.6.m6.1.1.2.cmml">W</mi><mi id="Sx2.SSx2.p2.6.m6.1.1.3" xref="Sx2.SSx2.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.6.m6.1b"><apply id="Sx2.SSx2.p2.6.m6.1.1.cmml" xref="Sx2.SSx2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p2.6.m6.1.1.1.cmml" xref="Sx2.SSx2.p2.6.m6.1.1">subscript</csymbol><ci id="Sx2.SSx2.p2.6.m6.1.1.2.cmml" xref="Sx2.SSx2.p2.6.m6.1.1.2">𝑊</ci><ci id="Sx2.SSx2.p2.6.m6.1.1.3.cmml" xref="Sx2.SSx2.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.6.m6.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.6.m6.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> will dominate the updating of high-level features of the codebook than encoded features resulting in more coherent and unified high-level features. Leveraging semantic embedding, the codebook entries become highly discriminative, each aligning with a specific semantic class. This approach minimizes semantic ambiguity, prevents the reuse of identical codebook entries across different classes, and ensures efficient utilization across all classes.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{e}_{k}^{t}=min_{i}(\|{\tilde{e}_{i}^{t}-\tilde{c}_{k}^{t}}\|_{2}+\beta*\|%
{\widehat{e}_{i}^{t}-\widehat{c}_{k}^{t}}\|_{2})," class="ltx_Math" display="block" id="Sx2.E6.m1.1"><semantics id="Sx2.E6.m1.1a"><mrow id="Sx2.E6.m1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.cmml"><mrow id="Sx2.E6.m1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.cmml"><msubsup id="Sx2.E6.m1.1.1.1.1.3" xref="Sx2.E6.m1.1.1.1.1.3.cmml"><mover accent="true" id="Sx2.E6.m1.1.1.1.1.3.2.2" xref="Sx2.E6.m1.1.1.1.1.3.2.2.cmml"><mi id="Sx2.E6.m1.1.1.1.1.3.2.2.2" xref="Sx2.E6.m1.1.1.1.1.3.2.2.2.cmml">e</mi><mo id="Sx2.E6.m1.1.1.1.1.3.2.2.1" xref="Sx2.E6.m1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="Sx2.E6.m1.1.1.1.1.3.2.3" xref="Sx2.E6.m1.1.1.1.1.3.2.3.cmml">k</mi><mi id="Sx2.E6.m1.1.1.1.1.3.3" xref="Sx2.E6.m1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo id="Sx2.E6.m1.1.1.1.1.2" xref="Sx2.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx2.E6.m1.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.cmml"><mi id="Sx2.E6.m1.1.1.1.1.1.3" xref="Sx2.E6.m1.1.1.1.1.1.3.cmml">m</mi><mo id="Sx2.E6.m1.1.1.1.1.1.2" xref="Sx2.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E6.m1.1.1.1.1.1.4" xref="Sx2.E6.m1.1.1.1.1.1.4.cmml">i</mi><mo id="Sx2.E6.m1.1.1.1.1.1.2a" xref="Sx2.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><msub id="Sx2.E6.m1.1.1.1.1.1.5" xref="Sx2.E6.m1.1.1.1.1.1.5.cmml"><mi id="Sx2.E6.m1.1.1.1.1.1.5.2" xref="Sx2.E6.m1.1.1.1.1.1.5.2.cmml">n</mi><mi id="Sx2.E6.m1.1.1.1.1.1.5.3" xref="Sx2.E6.m1.1.1.1.1.1.5.3.cmml">i</mi></msub><mo id="Sx2.E6.m1.1.1.1.1.1.2b" xref="Sx2.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E6.m1.1.1.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E6.m1.1.1.1.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">e</mi><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">~</mo></mover><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">c</mi><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml">β</mi><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.2" lspace="0.222em" rspace="0.222em" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">∗</mo><msub id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml"><mrow id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.2.cmml"><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo><mrow id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><msubsup id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml"><mover accent="true" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml">e</mi><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.3.cmml">i</mi><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml">−</mo><msubsup id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml"><mover accent="true" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.cmml"><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.2" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.2.cmml">c</mi><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.1" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.3.cmml">k</mi><mi id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.3" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.3.cmml">2</mn></msub></mrow></mrow><mo id="Sx2.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E6.m1.1.1.1.2" xref="Sx2.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E6.m1.1b"><apply id="Sx2.E6.m1.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1"><eq id="Sx2.E6.m1.1.1.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.2"></eq><apply id="Sx2.E6.m1.1.1.1.1.3.cmml" xref="Sx2.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.3.1.cmml" xref="Sx2.E6.m1.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.3.2.cmml" xref="Sx2.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.3.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.3">subscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.3.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.3.2.2"><ci id="Sx2.E6.m1.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.3.2.2.1">^</ci><ci id="Sx2.E6.m1.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.3.2.2.2">𝑒</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.3.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.3.3.cmml" xref="Sx2.E6.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="Sx2.E6.m1.1.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1"><times id="Sx2.E6.m1.1.1.1.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.2"></times><ci id="Sx2.E6.m1.1.1.1.1.1.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.3">𝑚</ci><ci id="Sx2.E6.m1.1.1.1.1.1.4.cmml" xref="Sx2.E6.m1.1.1.1.1.1.4">𝑖</ci><apply id="Sx2.E6.m1.1.1.1.1.1.5.cmml" xref="Sx2.E6.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.5.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.5">subscript</csymbol><ci id="Sx2.E6.m1.1.1.1.1.1.5.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.5.2">𝑛</ci><ci id="Sx2.E6.m1.1.1.1.1.1.5.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.5.3">𝑖</ci></apply><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1"><plus id="Sx2.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.3"></plus><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1">~</ci><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑒</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑐</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2"><times id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.2"></times><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.3">𝛽</ci><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.2">norm</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1"><minus id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"></minus><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2">subscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2"><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.1">^</ci><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.2.2">𝑒</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><apply id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2"><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.1">^</ci><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.2.2">𝑐</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.3.cmml" type="integer" xref="Sx2.E6.m1.1.1.1.1.1.1.1.1.2.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E6.m1.1c">\hat{e}_{k}^{t}=min_{i}(\|{\tilde{e}_{i}^{t}-\tilde{c}_{k}^{t}}\|_{2}+\beta*\|%
{\widehat{e}_{i}^{t}-\widehat{c}_{k}^{t}}\|_{2}),</annotation><annotation encoding="application/x-llamapun" id="Sx2.E6.m1.1d">over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_m italic_i italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( ∥ over~ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT - over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_β ∗ ∥ over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT - over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{c}_{k}^{t}=\widehat{c}_{k}^{t-1}*(1-a_{k}^{t})+(\hat{e}_{k}^{t}{}_{%
high}*a_{k}^{t}+(W_{i})*(1-a_{k}^{t}))*a_{k}^{t}," class="ltx_math_unparsed" display="block" id="Sx2.E7.m1.1"><semantics id="Sx2.E7.m1.1a"><mrow id="Sx2.E7.m1.1b"><msubsup id="Sx2.E7.m1.1.1"><mover accent="true" id="Sx2.E7.m1.1.1.2.2"><mi id="Sx2.E7.m1.1.1.2.2.2">c</mi><mo id="Sx2.E7.m1.1.1.2.2.1">^</mo></mover><mi id="Sx2.E7.m1.1.1.2.3">k</mi><mi id="Sx2.E7.m1.1.1.3">t</mi></msubsup><mo id="Sx2.E7.m1.1.2">=</mo><msubsup id="Sx2.E7.m1.1.3"><mover accent="true" id="Sx2.E7.m1.1.3.2.2"><mi id="Sx2.E7.m1.1.3.2.2.2">c</mi><mo id="Sx2.E7.m1.1.3.2.2.1">^</mo></mover><mi id="Sx2.E7.m1.1.3.2.3">k</mi><mrow id="Sx2.E7.m1.1.3.3"><mi id="Sx2.E7.m1.1.3.3.2">t</mi><mo id="Sx2.E7.m1.1.3.3.1">−</mo><mn id="Sx2.E7.m1.1.3.3.3">1</mn></mrow></msubsup><mo id="Sx2.E7.m1.1.4" lspace="0.222em" rspace="0.222em">∗</mo><mrow id="Sx2.E7.m1.1.5"><mo id="Sx2.E7.m1.1.5.1" stretchy="false">(</mo><mn id="Sx2.E7.m1.1.5.2">1</mn><mo id="Sx2.E7.m1.1.5.3">−</mo><msubsup id="Sx2.E7.m1.1.5.4"><mi id="Sx2.E7.m1.1.5.4.2.2">a</mi><mi id="Sx2.E7.m1.1.5.4.2.3">k</mi><mi id="Sx2.E7.m1.1.5.4.3">t</mi></msubsup><mo id="Sx2.E7.m1.1.5.5" stretchy="false">)</mo></mrow><mo id="Sx2.E7.m1.1.6">+</mo><mrow id="Sx2.E7.m1.1.7"><mo id="Sx2.E7.m1.1.7.1" stretchy="false">(</mo><msubsup id="Sx2.E7.m1.1.7.2"><mover accent="true" id="Sx2.E7.m1.1.7.2.2.2"><mi id="Sx2.E7.m1.1.7.2.2.2.2">e</mi><mo id="Sx2.E7.m1.1.7.2.2.2.1">^</mo></mover><mi id="Sx2.E7.m1.1.7.2.2.3">k</mi><mi id="Sx2.E7.m1.1.7.2.3">t</mi></msubsup><mmultiscripts id="Sx2.E7.m1.1.7.3"><mo id="Sx2.E7.m1.1.7.3.2" lspace="0.222em" rspace="0.222em">∗</mo><mprescripts id="Sx2.E7.m1.1.7.3a"></mprescripts><mrow id="Sx2.E7.m1.1.7.3.3"><mi id="Sx2.E7.m1.1.7.3.3.2">h</mi><mo id="Sx2.E7.m1.1.7.3.3.1">⁢</mo><mi id="Sx2.E7.m1.1.7.3.3.3">i</mi><mo id="Sx2.E7.m1.1.7.3.3.1a">⁢</mo><mi id="Sx2.E7.m1.1.7.3.3.4">g</mi><mo id="Sx2.E7.m1.1.7.3.3.1b">⁢</mo><mi id="Sx2.E7.m1.1.7.3.3.5">h</mi></mrow><mrow id="Sx2.E7.m1.1.7.3b"></mrow></mmultiscripts><msubsup id="Sx2.E7.m1.1.7.4"><mi id="Sx2.E7.m1.1.7.4.2.2">a</mi><mi id="Sx2.E7.m1.1.7.4.2.3">k</mi><mi id="Sx2.E7.m1.1.7.4.3">t</mi></msubsup><mo id="Sx2.E7.m1.1.7.5">+</mo><mrow id="Sx2.E7.m1.1.7.6"><mo id="Sx2.E7.m1.1.7.6.1" stretchy="false">(</mo><msub id="Sx2.E7.m1.1.7.6.2"><mi id="Sx2.E7.m1.1.7.6.2.2">W</mi><mi id="Sx2.E7.m1.1.7.6.2.3">i</mi></msub><mo id="Sx2.E7.m1.1.7.6.3" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="Sx2.E7.m1.1.7.7" rspace="0.222em">∗</mo><mrow id="Sx2.E7.m1.1.7.8"><mo id="Sx2.E7.m1.1.7.8.1" stretchy="false">(</mo><mn id="Sx2.E7.m1.1.7.8.2">1</mn><mo id="Sx2.E7.m1.1.7.8.3">−</mo><msubsup id="Sx2.E7.m1.1.7.8.4"><mi id="Sx2.E7.m1.1.7.8.4.2.2">a</mi><mi id="Sx2.E7.m1.1.7.8.4.2.3">k</mi><mi id="Sx2.E7.m1.1.7.8.4.3">t</mi></msubsup><mo id="Sx2.E7.m1.1.7.8.5" stretchy="false">)</mo></mrow><mo id="Sx2.E7.m1.1.7.9" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="Sx2.E7.m1.1.8" rspace="0.222em">∗</mo><msubsup id="Sx2.E7.m1.1.9"><mi id="Sx2.E7.m1.1.9.2.2">a</mi><mi id="Sx2.E7.m1.1.9.2.3">k</mi><mi id="Sx2.E7.m1.1.9.3">t</mi></msubsup><mo id="Sx2.E7.m1.1.10">,</mo></mrow><annotation encoding="application/x-tex" id="Sx2.E7.m1.1c">\widehat{c}_{k}^{t}=\widehat{c}_{k}^{t-1}*(1-a_{k}^{t})+(\hat{e}_{k}^{t}{}_{%
high}*a_{k}^{t}+(W_{i})*(1-a_{k}^{t}))*a_{k}^{t},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E7.m1.1d">over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT ∗ ( 1 - italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) + ( over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_FLOATSUBSCRIPT italic_h italic_i italic_g italic_h end_FLOATSUBSCRIPT ∗ italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT + ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∗ ( 1 - italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) ) ∗ italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{c}_{k}^{t}=\tilde{c}_{k}^{t-1}*(1-a_{k}^{t})+\hat{e}_{k}^{t}{}_{low}*a_%
{k}^{t}," class="ltx_math_unparsed" display="block" id="Sx2.E8.m1.1"><semantics id="Sx2.E8.m1.1a"><mrow id="Sx2.E8.m1.1b"><msubsup id="Sx2.E8.m1.1.1"><mover accent="true" id="Sx2.E8.m1.1.1.2.2"><mi id="Sx2.E8.m1.1.1.2.2.2">c</mi><mo id="Sx2.E8.m1.1.1.2.2.1">~</mo></mover><mi id="Sx2.E8.m1.1.1.2.3">k</mi><mi id="Sx2.E8.m1.1.1.3">t</mi></msubsup><mo id="Sx2.E8.m1.1.2">=</mo><msubsup id="Sx2.E8.m1.1.3"><mover accent="true" id="Sx2.E8.m1.1.3.2.2"><mi id="Sx2.E8.m1.1.3.2.2.2">c</mi><mo id="Sx2.E8.m1.1.3.2.2.1">~</mo></mover><mi id="Sx2.E8.m1.1.3.2.3">k</mi><mrow id="Sx2.E8.m1.1.3.3"><mi id="Sx2.E8.m1.1.3.3.2">t</mi><mo id="Sx2.E8.m1.1.3.3.1">−</mo><mn id="Sx2.E8.m1.1.3.3.3">1</mn></mrow></msubsup><mo id="Sx2.E8.m1.1.4" lspace="0.222em" rspace="0.222em">∗</mo><mrow id="Sx2.E8.m1.1.5"><mo id="Sx2.E8.m1.1.5.1" stretchy="false">(</mo><mn id="Sx2.E8.m1.1.5.2">1</mn><mo id="Sx2.E8.m1.1.5.3">−</mo><msubsup id="Sx2.E8.m1.1.5.4"><mi id="Sx2.E8.m1.1.5.4.2.2">a</mi><mi id="Sx2.E8.m1.1.5.4.2.3">k</mi><mi id="Sx2.E8.m1.1.5.4.3">t</mi></msubsup><mo id="Sx2.E8.m1.1.5.5" stretchy="false">)</mo></mrow><mo id="Sx2.E8.m1.1.6">+</mo><msubsup id="Sx2.E8.m1.1.7"><mover accent="true" id="Sx2.E8.m1.1.7.2.2"><mi id="Sx2.E8.m1.1.7.2.2.2">e</mi><mo id="Sx2.E8.m1.1.7.2.2.1">^</mo></mover><mi id="Sx2.E8.m1.1.7.2.3">k</mi><mi id="Sx2.E8.m1.1.7.3">t</mi></msubsup><mmultiscripts id="Sx2.E8.m1.1.8"><mo id="Sx2.E8.m1.1.8.2" lspace="0.222em" rspace="0.222em">∗</mo><mprescripts id="Sx2.E8.m1.1.8a"></mprescripts><mrow id="Sx2.E8.m1.1.8.3"><mi id="Sx2.E8.m1.1.8.3.2">l</mi><mo id="Sx2.E8.m1.1.8.3.1">⁢</mo><mi id="Sx2.E8.m1.1.8.3.3">o</mi><mo id="Sx2.E8.m1.1.8.3.1a">⁢</mo><mi id="Sx2.E8.m1.1.8.3.4">w</mi></mrow><mrow id="Sx2.E8.m1.1.8b"></mrow></mmultiscripts><msubsup id="Sx2.E8.m1.1.9"><mi id="Sx2.E8.m1.1.9.2.2">a</mi><mi id="Sx2.E8.m1.1.9.2.3">k</mi><mi id="Sx2.E8.m1.1.9.3">t</mi></msubsup><mo id="Sx2.E8.m1.1.10">,</mo></mrow><annotation encoding="application/x-tex" id="Sx2.E8.m1.1c">\tilde{c}_{k}^{t}=\tilde{c}_{k}^{t-1}*(1-a_{k}^{t})+\hat{e}_{k}^{t}{}_{low}*a_%
{k}^{t},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E8.m1.1d">over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT ∗ ( 1 - italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) + over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_FLOATSUBSCRIPT italic_l italic_o italic_w end_FLOATSUBSCRIPT ∗ italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="Sx2.SSx2.p3">
<p class="ltx_p" id="Sx2.SSx2.p3.4"><math alttext="\tilde{e}" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.1.m1.1"><semantics id="Sx2.SSx2.p3.1.m1.1a"><mover accent="true" id="Sx2.SSx2.p3.1.m1.1.1" xref="Sx2.SSx2.p3.1.m1.1.1.cmml"><mi id="Sx2.SSx2.p3.1.m1.1.1.2" xref="Sx2.SSx2.p3.1.m1.1.1.2.cmml">e</mi><mo id="Sx2.SSx2.p3.1.m1.1.1.1" xref="Sx2.SSx2.p3.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.1.m1.1b"><apply id="Sx2.SSx2.p3.1.m1.1.1.cmml" xref="Sx2.SSx2.p3.1.m1.1.1"><ci id="Sx2.SSx2.p3.1.m1.1.1.1.cmml" xref="Sx2.SSx2.p3.1.m1.1.1.1">~</ci><ci id="Sx2.SSx2.p3.1.m1.1.1.2.cmml" xref="Sx2.SSx2.p3.1.m1.1.1.2">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.1.m1.1c">\tilde{e}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.1.m1.1d">over~ start_ARG italic_e end_ARG</annotation></semantics></math> and <math alttext="\tilde{c}" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.2.m2.1"><semantics id="Sx2.SSx2.p3.2.m2.1a"><mover accent="true" id="Sx2.SSx2.p3.2.m2.1.1" xref="Sx2.SSx2.p3.2.m2.1.1.cmml"><mi id="Sx2.SSx2.p3.2.m2.1.1.2" xref="Sx2.SSx2.p3.2.m2.1.1.2.cmml">c</mi><mo id="Sx2.SSx2.p3.2.m2.1.1.1" xref="Sx2.SSx2.p3.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.2.m2.1b"><apply id="Sx2.SSx2.p3.2.m2.1.1.cmml" xref="Sx2.SSx2.p3.2.m2.1.1"><ci id="Sx2.SSx2.p3.2.m2.1.1.1.cmml" xref="Sx2.SSx2.p3.2.m2.1.1.1">~</ci><ci id="Sx2.SSx2.p3.2.m2.1.1.2.cmml" xref="Sx2.SSx2.p3.2.m2.1.1.2">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.2.m2.1c">\tilde{c}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.2.m2.1d">over~ start_ARG italic_c end_ARG</annotation></semantics></math> denote low level features of encoded features and codebook, while <math alttext="\widehat{e}" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.3.m3.1"><semantics id="Sx2.SSx2.p3.3.m3.1a"><mover accent="true" id="Sx2.SSx2.p3.3.m3.1.1" xref="Sx2.SSx2.p3.3.m3.1.1.cmml"><mi id="Sx2.SSx2.p3.3.m3.1.1.2" xref="Sx2.SSx2.p3.3.m3.1.1.2.cmml">e</mi><mo id="Sx2.SSx2.p3.3.m3.1.1.1" xref="Sx2.SSx2.p3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.3.m3.1b"><apply id="Sx2.SSx2.p3.3.m3.1.1.cmml" xref="Sx2.SSx2.p3.3.m3.1.1"><ci id="Sx2.SSx2.p3.3.m3.1.1.1.cmml" xref="Sx2.SSx2.p3.3.m3.1.1.1">^</ci><ci id="Sx2.SSx2.p3.3.m3.1.1.2.cmml" xref="Sx2.SSx2.p3.3.m3.1.1.2">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.3.m3.1c">\widehat{e}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.3.m3.1d">over^ start_ARG italic_e end_ARG</annotation></semantics></math> and <math alttext="\widehat{c}" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.4.m4.1"><semantics id="Sx2.SSx2.p3.4.m4.1a"><mover accent="true" id="Sx2.SSx2.p3.4.m4.1.1" xref="Sx2.SSx2.p3.4.m4.1.1.cmml"><mi id="Sx2.SSx2.p3.4.m4.1.1.2" xref="Sx2.SSx2.p3.4.m4.1.1.2.cmml">c</mi><mo id="Sx2.SSx2.p3.4.m4.1.1.1" xref="Sx2.SSx2.p3.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.4.m4.1b"><apply id="Sx2.SSx2.p3.4.m4.1.1.cmml" xref="Sx2.SSx2.p3.4.m4.1.1"><ci id="Sx2.SSx2.p3.4.m4.1.1.1.cmml" xref="Sx2.SSx2.p3.4.m4.1.1.1">^</ci><ci id="Sx2.SSx2.p3.4.m4.1.1.2.cmml" xref="Sx2.SSx2.p3.4.m4.1.1.2">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.4.m4.1c">\widehat{c}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.4.m4.1d">over^ start_ARG italic_c end_ARG</annotation></semantics></math> denote high level features.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx2.SSx3">
<h3 class="ltx_title ltx_title_subsection">Consistent Semantic Learning</h3>
<div class="ltx_para" id="Sx2.SSx3.p1">
<p class="ltx_p" id="Sx2.SSx3.p1.1">GAIA-1<cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib9" title="">2023</a>)</cite> utilizes DINOv2<cite class="ltx_cite ltx_citemacro_citep">(Oquab et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib18" title="">2024</a>)</cite> to integrate high-level semantic features. However, the semantic features in DINOv2<cite class="ltx_cite ltx_citemacro_citep">(Oquab et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib18" title="">2024</a>)</cite> lack consistency across time and space. In contrast, we employ the semantic class that maintains temporal and spatial consistency to guide the learning process. Our method does not require extremely accurate semantic annotations. By leveraging the inference results of the segmentation model<cite class="ltx_cite ltx_citemacro_citep">(Gao et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib6" title="">2022</a>; Xie et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib28" title="">2021</a>)</cite>, our approach achieves temporospatially consistent semantic learning.</p>
</div>
<div class="ltx_para" id="Sx2.SSx3.p2">
<p class="ltx_p" id="Sx2.SSx3.p2.1"><span class="ltx_text ltx_font_bold" id="Sx2.SSx3.p2.1.1">Initially</span>, we get each token entry <math alttext="c_{q}" class="ltx_Math" display="inline" id="Sx2.SSx3.p2.1.m1.1"><semantics id="Sx2.SSx3.p2.1.m1.1a"><msub id="Sx2.SSx3.p2.1.m1.1.1" xref="Sx2.SSx3.p2.1.m1.1.1.cmml"><mi id="Sx2.SSx3.p2.1.m1.1.1.2" xref="Sx2.SSx3.p2.1.m1.1.1.2.cmml">c</mi><mi id="Sx2.SSx3.p2.1.m1.1.1.3" xref="Sx2.SSx3.p2.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p2.1.m1.1b"><apply id="Sx2.SSx3.p2.1.m1.1.1.cmml" xref="Sx2.SSx3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx3.p2.1.m1.1.1.1.cmml" xref="Sx2.SSx3.p2.1.m1.1.1">subscript</csymbol><ci id="Sx2.SSx3.p2.1.m1.1.1.2.cmml" xref="Sx2.SSx3.p2.1.m1.1.1.2">𝑐</ci><ci id="Sx2.SSx3.p2.1.m1.1.1.3.cmml" xref="Sx2.SSx3.p2.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p2.1.m1.1c">c_{q}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p2.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> with its class according to its index from the inference results of the segmentation model; <span class="ltx_text ltx_font_bold" id="Sx2.SSx3.p2.1.2">Next</span>, we classify tokens with the same class as positive samples and with different classes as negative samples. <span class="ltx_text ltx_font_bold" id="Sx2.SSx3.p2.1.3">Subsequently</span>, similar to <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib25" title="">2018</a>)</cite>, we minimize the objective as Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E9" title="Equation 9 ‣ Consistent Semantic Learning ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">9</span></a> by fixing the magnitude of x to eliminate radial variations, the model learns separable features in the angular space.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="loss=-\frac{1}{N}\sum_{i}log\frac{e^{s*(cos(\theta_{y_{i},i})-m)}}{e^{s*(cos(%
\theta_{y_{i},i})-m)}+\sum_{j\neq y_{i}}e^{s*cos(\theta_{j,i})}}," class="ltx_Math" display="block" id="Sx2.E9.m1.10"><semantics id="Sx2.E9.m1.10a"><mrow id="Sx2.E9.m1.10.10.1" xref="Sx2.E9.m1.10.10.1.1.cmml"><mrow id="Sx2.E9.m1.10.10.1.1" xref="Sx2.E9.m1.10.10.1.1.cmml"><mrow id="Sx2.E9.m1.10.10.1.1.2" xref="Sx2.E9.m1.10.10.1.1.2.cmml"><mi id="Sx2.E9.m1.10.10.1.1.2.2" xref="Sx2.E9.m1.10.10.1.1.2.2.cmml">l</mi><mo id="Sx2.E9.m1.10.10.1.1.2.1" xref="Sx2.E9.m1.10.10.1.1.2.1.cmml">⁢</mo><mi id="Sx2.E9.m1.10.10.1.1.2.3" xref="Sx2.E9.m1.10.10.1.1.2.3.cmml">o</mi><mo id="Sx2.E9.m1.10.10.1.1.2.1a" xref="Sx2.E9.m1.10.10.1.1.2.1.cmml">⁢</mo><mi id="Sx2.E9.m1.10.10.1.1.2.4" xref="Sx2.E9.m1.10.10.1.1.2.4.cmml">s</mi><mo id="Sx2.E9.m1.10.10.1.1.2.1b" xref="Sx2.E9.m1.10.10.1.1.2.1.cmml">⁢</mo><mi id="Sx2.E9.m1.10.10.1.1.2.5" xref="Sx2.E9.m1.10.10.1.1.2.5.cmml">s</mi></mrow><mo id="Sx2.E9.m1.10.10.1.1.1" xref="Sx2.E9.m1.10.10.1.1.1.cmml">=</mo><mrow id="Sx2.E9.m1.10.10.1.1.3" xref="Sx2.E9.m1.10.10.1.1.3.cmml"><mo id="Sx2.E9.m1.10.10.1.1.3a" xref="Sx2.E9.m1.10.10.1.1.3.cmml">−</mo><mrow id="Sx2.E9.m1.10.10.1.1.3.2" xref="Sx2.E9.m1.10.10.1.1.3.2.cmml"><mfrac id="Sx2.E9.m1.10.10.1.1.3.2.2" xref="Sx2.E9.m1.10.10.1.1.3.2.2.cmml"><mn id="Sx2.E9.m1.10.10.1.1.3.2.2.2" xref="Sx2.E9.m1.10.10.1.1.3.2.2.2.cmml">1</mn><mi id="Sx2.E9.m1.10.10.1.1.3.2.2.3" xref="Sx2.E9.m1.10.10.1.1.3.2.2.3.cmml">N</mi></mfrac><mo id="Sx2.E9.m1.10.10.1.1.3.2.1" xref="Sx2.E9.m1.10.10.1.1.3.2.1.cmml">⁢</mo><mrow id="Sx2.E9.m1.10.10.1.1.3.2.3" xref="Sx2.E9.m1.10.10.1.1.3.2.3.cmml"><munder id="Sx2.E9.m1.10.10.1.1.3.2.3.1" xref="Sx2.E9.m1.10.10.1.1.3.2.3.1.cmml"><mo id="Sx2.E9.m1.10.10.1.1.3.2.3.1.2" movablelimits="false" xref="Sx2.E9.m1.10.10.1.1.3.2.3.1.2.cmml">∑</mo><mi id="Sx2.E9.m1.10.10.1.1.3.2.3.1.3" xref="Sx2.E9.m1.10.10.1.1.3.2.3.1.3.cmml">i</mi></munder><mrow id="Sx2.E9.m1.10.10.1.1.3.2.3.2" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.cmml"><mi id="Sx2.E9.m1.10.10.1.1.3.2.3.2.2" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.2.cmml">l</mi><mo id="Sx2.E9.m1.10.10.1.1.3.2.3.2.1" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.1.cmml">⁢</mo><mi id="Sx2.E9.m1.10.10.1.1.3.2.3.2.3" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.3.cmml">o</mi><mo id="Sx2.E9.m1.10.10.1.1.3.2.3.2.1a" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.1.cmml">⁢</mo><mi id="Sx2.E9.m1.10.10.1.1.3.2.3.2.4" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.4.cmml">g</mi><mo id="Sx2.E9.m1.10.10.1.1.3.2.3.2.1b" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.1.cmml">⁢</mo><mfrac id="Sx2.E9.m1.9.9" xref="Sx2.E9.m1.9.9.cmml"><msup id="Sx2.E9.m1.3.3.3" xref="Sx2.E9.m1.3.3.3.cmml"><mi id="Sx2.E9.m1.3.3.3.5" xref="Sx2.E9.m1.3.3.3.5.cmml">e</mi><mrow id="Sx2.E9.m1.3.3.3.3.3" xref="Sx2.E9.m1.3.3.3.3.3.cmml"><mi id="Sx2.E9.m1.3.3.3.3.3.5" xref="Sx2.E9.m1.3.3.3.3.3.5.cmml">s</mi><mo id="Sx2.E9.m1.3.3.3.3.3.4" lspace="0.222em" rspace="0.222em" xref="Sx2.E9.m1.3.3.3.3.3.4.cmml">∗</mo><mrow id="Sx2.E9.m1.3.3.3.3.3.3.1" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.cmml"><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.2" stretchy="false" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.cmml">(</mo><mrow id="Sx2.E9.m1.3.3.3.3.3.3.1.1" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.cmml"><mrow id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.cmml"><mi id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.3" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.3.cmml">c</mi><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.4" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.4.cmml">o</mi><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2a" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.5" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.5.cmml">s</mi><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2b" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.2" stretchy="false" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.2" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="Sx2.E9.m1.2.2.2.2.2.2.2.2" xref="Sx2.E9.m1.2.2.2.2.2.2.2.3.cmml"><msub id="Sx2.E9.m1.2.2.2.2.2.2.2.2.1" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.cmml"><mi id="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.2" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.2.cmml">y</mi><mi id="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.3" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.3.cmml">i</mi></msub><mo id="Sx2.E9.m1.2.2.2.2.2.2.2.2.2" xref="Sx2.E9.m1.2.2.2.2.2.2.2.3.cmml">,</mo><mi id="Sx2.E9.m1.1.1.1.1.1.1.1.1" xref="Sx2.E9.m1.1.1.1.1.1.1.1.1.cmml">i</mi></mrow></msub><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.3" stretchy="false" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.1.2" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.2.cmml">−</mo><mi id="Sx2.E9.m1.3.3.3.3.3.3.1.1.3" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.3.cmml">m</mi></mrow><mo id="Sx2.E9.m1.3.3.3.3.3.3.1.3" stretchy="false" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></msup><mrow id="Sx2.E9.m1.9.9.9" xref="Sx2.E9.m1.9.9.9.cmml"><msup id="Sx2.E9.m1.9.9.9.8" xref="Sx2.E9.m1.9.9.9.8.cmml"><mi id="Sx2.E9.m1.9.9.9.8.2" xref="Sx2.E9.m1.9.9.9.8.2.cmml">e</mi><mrow id="Sx2.E9.m1.6.6.6.3.3" xref="Sx2.E9.m1.6.6.6.3.3.cmml"><mi id="Sx2.E9.m1.6.6.6.3.3.5" xref="Sx2.E9.m1.6.6.6.3.3.5.cmml">s</mi><mo id="Sx2.E9.m1.6.6.6.3.3.4" lspace="0.222em" rspace="0.222em" xref="Sx2.E9.m1.6.6.6.3.3.4.cmml">∗</mo><mrow id="Sx2.E9.m1.6.6.6.3.3.3.1" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.cmml"><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.2" stretchy="false" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.cmml">(</mo><mrow id="Sx2.E9.m1.6.6.6.3.3.3.1.1" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.cmml"><mrow id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.cmml"><mi id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.3" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.3.cmml">c</mi><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.4" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.4.cmml">o</mi><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2a" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.5" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.5.cmml">s</mi><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2b" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml"><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.2" stretchy="false" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml"><mi id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.2" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="Sx2.E9.m1.5.5.5.2.2.2.2.2" xref="Sx2.E9.m1.5.5.5.2.2.2.2.3.cmml"><msub id="Sx2.E9.m1.5.5.5.2.2.2.2.2.1" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.cmml"><mi id="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.2" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.2.cmml">y</mi><mi id="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.3" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.3.cmml">i</mi></msub><mo id="Sx2.E9.m1.5.5.5.2.2.2.2.2.2" xref="Sx2.E9.m1.5.5.5.2.2.2.2.3.cmml">,</mo><mi id="Sx2.E9.m1.4.4.4.1.1.1.1.1" xref="Sx2.E9.m1.4.4.4.1.1.1.1.1.cmml">i</mi></mrow></msub><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.3" stretchy="false" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.1.2" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.2.cmml">−</mo><mi id="Sx2.E9.m1.6.6.6.3.3.3.1.1.3" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.3.cmml">m</mi></mrow><mo id="Sx2.E9.m1.6.6.6.3.3.3.1.3" stretchy="false" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.cmml">)</mo></mrow></mrow></msup><mo id="Sx2.E9.m1.9.9.9.7" rspace="0.055em" xref="Sx2.E9.m1.9.9.9.7.cmml">+</mo><mrow id="Sx2.E9.m1.9.9.9.9" xref="Sx2.E9.m1.9.9.9.9.cmml"><msub id="Sx2.E9.m1.9.9.9.9.1" xref="Sx2.E9.m1.9.9.9.9.1.cmml"><mo id="Sx2.E9.m1.9.9.9.9.1.2" xref="Sx2.E9.m1.9.9.9.9.1.2.cmml">∑</mo><mrow id="Sx2.E9.m1.9.9.9.9.1.3" xref="Sx2.E9.m1.9.9.9.9.1.3.cmml"><mi id="Sx2.E9.m1.9.9.9.9.1.3.2" xref="Sx2.E9.m1.9.9.9.9.1.3.2.cmml">j</mi><mo id="Sx2.E9.m1.9.9.9.9.1.3.1" xref="Sx2.E9.m1.9.9.9.9.1.3.1.cmml">≠</mo><msub id="Sx2.E9.m1.9.9.9.9.1.3.3" xref="Sx2.E9.m1.9.9.9.9.1.3.3.cmml"><mi id="Sx2.E9.m1.9.9.9.9.1.3.3.2" xref="Sx2.E9.m1.9.9.9.9.1.3.3.2.cmml">y</mi><mi id="Sx2.E9.m1.9.9.9.9.1.3.3.3" xref="Sx2.E9.m1.9.9.9.9.1.3.3.3.cmml">i</mi></msub></mrow></msub><msup id="Sx2.E9.m1.9.9.9.9.2" xref="Sx2.E9.m1.9.9.9.9.2.cmml"><mi id="Sx2.E9.m1.9.9.9.9.2.2" xref="Sx2.E9.m1.9.9.9.9.2.2.cmml">e</mi><mrow id="Sx2.E9.m1.9.9.9.6.3" xref="Sx2.E9.m1.9.9.9.6.3.cmml"><mrow id="Sx2.E9.m1.9.9.9.6.3.5" xref="Sx2.E9.m1.9.9.9.6.3.5.cmml"><mi id="Sx2.E9.m1.9.9.9.6.3.5.2" xref="Sx2.E9.m1.9.9.9.6.3.5.2.cmml">s</mi><mo id="Sx2.E9.m1.9.9.9.6.3.5.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E9.m1.9.9.9.6.3.5.1.cmml">∗</mo><mi id="Sx2.E9.m1.9.9.9.6.3.5.3" xref="Sx2.E9.m1.9.9.9.6.3.5.3.cmml">c</mi></mrow><mo id="Sx2.E9.m1.9.9.9.6.3.4" xref="Sx2.E9.m1.9.9.9.6.3.4.cmml">⁢</mo><mi id="Sx2.E9.m1.9.9.9.6.3.6" xref="Sx2.E9.m1.9.9.9.6.3.6.cmml">o</mi><mo id="Sx2.E9.m1.9.9.9.6.3.4a" xref="Sx2.E9.m1.9.9.9.6.3.4.cmml">⁢</mo><mi id="Sx2.E9.m1.9.9.9.6.3.7" xref="Sx2.E9.m1.9.9.9.6.3.7.cmml">s</mi><mo id="Sx2.E9.m1.9.9.9.6.3.4b" xref="Sx2.E9.m1.9.9.9.6.3.4.cmml">⁢</mo><mrow id="Sx2.E9.m1.9.9.9.6.3.3.1" xref="Sx2.E9.m1.9.9.9.6.3.3.1.1.cmml"><mo id="Sx2.E9.m1.9.9.9.6.3.3.1.2" stretchy="false" xref="Sx2.E9.m1.9.9.9.6.3.3.1.1.cmml">(</mo><msub id="Sx2.E9.m1.9.9.9.6.3.3.1.1" xref="Sx2.E9.m1.9.9.9.6.3.3.1.1.cmml"><mi id="Sx2.E9.m1.9.9.9.6.3.3.1.1.2" xref="Sx2.E9.m1.9.9.9.6.3.3.1.1.2.cmml">θ</mi><mrow id="Sx2.E9.m1.8.8.8.5.2.2.2.4" xref="Sx2.E9.m1.8.8.8.5.2.2.2.3.cmml"><mi id="Sx2.E9.m1.7.7.7.4.1.1.1.1" xref="Sx2.E9.m1.7.7.7.4.1.1.1.1.cmml">j</mi><mo id="Sx2.E9.m1.8.8.8.5.2.2.2.4.1" xref="Sx2.E9.m1.8.8.8.5.2.2.2.3.cmml">,</mo><mi id="Sx2.E9.m1.8.8.8.5.2.2.2.2" xref="Sx2.E9.m1.8.8.8.5.2.2.2.2.cmml">i</mi></mrow></msub><mo id="Sx2.E9.m1.9.9.9.6.3.3.1.3" stretchy="false" xref="Sx2.E9.m1.9.9.9.6.3.3.1.1.cmml">)</mo></mrow></mrow></msup></mrow></mrow></mfrac></mrow></mrow></mrow></mrow></mrow><mo id="Sx2.E9.m1.10.10.1.2" xref="Sx2.E9.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E9.m1.10b"><apply id="Sx2.E9.m1.10.10.1.1.cmml" xref="Sx2.E9.m1.10.10.1"><eq id="Sx2.E9.m1.10.10.1.1.1.cmml" xref="Sx2.E9.m1.10.10.1.1.1"></eq><apply id="Sx2.E9.m1.10.10.1.1.2.cmml" xref="Sx2.E9.m1.10.10.1.1.2"><times id="Sx2.E9.m1.10.10.1.1.2.1.cmml" xref="Sx2.E9.m1.10.10.1.1.2.1"></times><ci id="Sx2.E9.m1.10.10.1.1.2.2.cmml" xref="Sx2.E9.m1.10.10.1.1.2.2">𝑙</ci><ci id="Sx2.E9.m1.10.10.1.1.2.3.cmml" xref="Sx2.E9.m1.10.10.1.1.2.3">𝑜</ci><ci id="Sx2.E9.m1.10.10.1.1.2.4.cmml" xref="Sx2.E9.m1.10.10.1.1.2.4">𝑠</ci><ci id="Sx2.E9.m1.10.10.1.1.2.5.cmml" xref="Sx2.E9.m1.10.10.1.1.2.5">𝑠</ci></apply><apply id="Sx2.E9.m1.10.10.1.1.3.cmml" xref="Sx2.E9.m1.10.10.1.1.3"><minus id="Sx2.E9.m1.10.10.1.1.3.1.cmml" xref="Sx2.E9.m1.10.10.1.1.3"></minus><apply id="Sx2.E9.m1.10.10.1.1.3.2.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2"><times id="Sx2.E9.m1.10.10.1.1.3.2.1.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.1"></times><apply id="Sx2.E9.m1.10.10.1.1.3.2.2.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.2"><divide id="Sx2.E9.m1.10.10.1.1.3.2.2.1.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.2"></divide><cn id="Sx2.E9.m1.10.10.1.1.3.2.2.2.cmml" type="integer" xref="Sx2.E9.m1.10.10.1.1.3.2.2.2">1</cn><ci id="Sx2.E9.m1.10.10.1.1.3.2.2.3.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.2.3">𝑁</ci></apply><apply id="Sx2.E9.m1.10.10.1.1.3.2.3.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3"><apply id="Sx2.E9.m1.10.10.1.1.3.2.3.1.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.10.10.1.1.3.2.3.1.1.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.1">subscript</csymbol><sum id="Sx2.E9.m1.10.10.1.1.3.2.3.1.2.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.1.2"></sum><ci id="Sx2.E9.m1.10.10.1.1.3.2.3.1.3.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.1.3">𝑖</ci></apply><apply id="Sx2.E9.m1.10.10.1.1.3.2.3.2.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2"><times id="Sx2.E9.m1.10.10.1.1.3.2.3.2.1.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.1"></times><ci id="Sx2.E9.m1.10.10.1.1.3.2.3.2.2.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.2">𝑙</ci><ci id="Sx2.E9.m1.10.10.1.1.3.2.3.2.3.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.3">𝑜</ci><ci id="Sx2.E9.m1.10.10.1.1.3.2.3.2.4.cmml" xref="Sx2.E9.m1.10.10.1.1.3.2.3.2.4">𝑔</ci><apply id="Sx2.E9.m1.9.9.cmml" xref="Sx2.E9.m1.9.9"><divide id="Sx2.E9.m1.9.9.10.cmml" xref="Sx2.E9.m1.9.9"></divide><apply id="Sx2.E9.m1.3.3.3.cmml" xref="Sx2.E9.m1.3.3.3"><csymbol cd="ambiguous" id="Sx2.E9.m1.3.3.3.4.cmml" xref="Sx2.E9.m1.3.3.3">superscript</csymbol><ci id="Sx2.E9.m1.3.3.3.5.cmml" xref="Sx2.E9.m1.3.3.3.5">𝑒</ci><apply id="Sx2.E9.m1.3.3.3.3.3.cmml" xref="Sx2.E9.m1.3.3.3.3.3"><times id="Sx2.E9.m1.3.3.3.3.3.4.cmml" xref="Sx2.E9.m1.3.3.3.3.3.4"></times><ci id="Sx2.E9.m1.3.3.3.3.3.5.cmml" xref="Sx2.E9.m1.3.3.3.3.3.5">𝑠</ci><apply id="Sx2.E9.m1.3.3.3.3.3.3.1.1.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1"><minus id="Sx2.E9.m1.3.3.3.3.3.3.1.1.2.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.2"></minus><apply id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1"><times id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.2"></times><ci id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.3">𝑐</ci><ci id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.4.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.4">𝑜</ci><ci id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.5.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.5">𝑠</ci><apply id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.1.1.1.1.2">𝜃</ci><list id="Sx2.E9.m1.2.2.2.2.2.2.2.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2"><apply id="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2.1">subscript</csymbol><ci id="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.2">𝑦</ci><ci id="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2.2.2.1.3">𝑖</ci></apply><ci id="Sx2.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.1.1.1.1.1.1.1.1">𝑖</ci></list></apply></apply><ci id="Sx2.E9.m1.3.3.3.3.3.3.1.1.3.cmml" xref="Sx2.E9.m1.3.3.3.3.3.3.1.1.3">𝑚</ci></apply></apply></apply><apply id="Sx2.E9.m1.9.9.9.cmml" xref="Sx2.E9.m1.9.9.9"><plus id="Sx2.E9.m1.9.9.9.7.cmml" xref="Sx2.E9.m1.9.9.9.7"></plus><apply id="Sx2.E9.m1.9.9.9.8.cmml" xref="Sx2.E9.m1.9.9.9.8"><csymbol cd="ambiguous" id="Sx2.E9.m1.9.9.9.8.1.cmml" xref="Sx2.E9.m1.9.9.9.8">superscript</csymbol><ci id="Sx2.E9.m1.9.9.9.8.2.cmml" xref="Sx2.E9.m1.9.9.9.8.2">𝑒</ci><apply id="Sx2.E9.m1.6.6.6.3.3.cmml" xref="Sx2.E9.m1.6.6.6.3.3"><times id="Sx2.E9.m1.6.6.6.3.3.4.cmml" xref="Sx2.E9.m1.6.6.6.3.3.4"></times><ci id="Sx2.E9.m1.6.6.6.3.3.5.cmml" xref="Sx2.E9.m1.6.6.6.3.3.5">𝑠</ci><apply id="Sx2.E9.m1.6.6.6.3.3.3.1.1.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1"><minus id="Sx2.E9.m1.6.6.6.3.3.3.1.1.2.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.2"></minus><apply id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1"><times id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.2"></times><ci id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.3.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.3">𝑐</ci><ci id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.4.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.4">𝑜</ci><ci id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.5.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.5">𝑠</ci><apply id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.1.1.1.1.2">𝜃</ci><list id="Sx2.E9.m1.5.5.5.2.2.2.2.3.cmml" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2"><apply id="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.cmml" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.1.cmml" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2.1">subscript</csymbol><ci id="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.2.cmml" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.2">𝑦</ci><ci id="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.3.cmml" xref="Sx2.E9.m1.5.5.5.2.2.2.2.2.1.3">𝑖</ci></apply><ci id="Sx2.E9.m1.4.4.4.1.1.1.1.1.cmml" xref="Sx2.E9.m1.4.4.4.1.1.1.1.1">𝑖</ci></list></apply></apply><ci id="Sx2.E9.m1.6.6.6.3.3.3.1.1.3.cmml" xref="Sx2.E9.m1.6.6.6.3.3.3.1.1.3">𝑚</ci></apply></apply></apply><apply id="Sx2.E9.m1.9.9.9.9.cmml" xref="Sx2.E9.m1.9.9.9.9"><apply id="Sx2.E9.m1.9.9.9.9.1.cmml" xref="Sx2.E9.m1.9.9.9.9.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.9.9.9.9.1.1.cmml" xref="Sx2.E9.m1.9.9.9.9.1">subscript</csymbol><sum id="Sx2.E9.m1.9.9.9.9.1.2.cmml" xref="Sx2.E9.m1.9.9.9.9.1.2"></sum><apply id="Sx2.E9.m1.9.9.9.9.1.3.cmml" xref="Sx2.E9.m1.9.9.9.9.1.3"><neq id="Sx2.E9.m1.9.9.9.9.1.3.1.cmml" xref="Sx2.E9.m1.9.9.9.9.1.3.1"></neq><ci id="Sx2.E9.m1.9.9.9.9.1.3.2.cmml" xref="Sx2.E9.m1.9.9.9.9.1.3.2">𝑗</ci><apply id="Sx2.E9.m1.9.9.9.9.1.3.3.cmml" xref="Sx2.E9.m1.9.9.9.9.1.3.3"><csymbol cd="ambiguous" id="Sx2.E9.m1.9.9.9.9.1.3.3.1.cmml" xref="Sx2.E9.m1.9.9.9.9.1.3.3">subscript</csymbol><ci id="Sx2.E9.m1.9.9.9.9.1.3.3.2.cmml" xref="Sx2.E9.m1.9.9.9.9.1.3.3.2">𝑦</ci><ci id="Sx2.E9.m1.9.9.9.9.1.3.3.3.cmml" xref="Sx2.E9.m1.9.9.9.9.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="Sx2.E9.m1.9.9.9.9.2.cmml" xref="Sx2.E9.m1.9.9.9.9.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.9.9.9.9.2.1.cmml" xref="Sx2.E9.m1.9.9.9.9.2">superscript</csymbol><ci id="Sx2.E9.m1.9.9.9.9.2.2.cmml" xref="Sx2.E9.m1.9.9.9.9.2.2">𝑒</ci><apply id="Sx2.E9.m1.9.9.9.6.3.cmml" xref="Sx2.E9.m1.9.9.9.6.3"><times id="Sx2.E9.m1.9.9.9.6.3.4.cmml" xref="Sx2.E9.m1.9.9.9.6.3.4"></times><apply id="Sx2.E9.m1.9.9.9.6.3.5.cmml" xref="Sx2.E9.m1.9.9.9.6.3.5"><times id="Sx2.E9.m1.9.9.9.6.3.5.1.cmml" xref="Sx2.E9.m1.9.9.9.6.3.5.1"></times><ci id="Sx2.E9.m1.9.9.9.6.3.5.2.cmml" xref="Sx2.E9.m1.9.9.9.6.3.5.2">𝑠</ci><ci id="Sx2.E9.m1.9.9.9.6.3.5.3.cmml" xref="Sx2.E9.m1.9.9.9.6.3.5.3">𝑐</ci></apply><ci id="Sx2.E9.m1.9.9.9.6.3.6.cmml" xref="Sx2.E9.m1.9.9.9.6.3.6">𝑜</ci><ci id="Sx2.E9.m1.9.9.9.6.3.7.cmml" xref="Sx2.E9.m1.9.9.9.6.3.7">𝑠</ci><apply id="Sx2.E9.m1.9.9.9.6.3.3.1.1.cmml" xref="Sx2.E9.m1.9.9.9.6.3.3.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.9.9.9.6.3.3.1.1.1.cmml" xref="Sx2.E9.m1.9.9.9.6.3.3.1">subscript</csymbol><ci id="Sx2.E9.m1.9.9.9.6.3.3.1.1.2.cmml" xref="Sx2.E9.m1.9.9.9.6.3.3.1.1.2">𝜃</ci><list id="Sx2.E9.m1.8.8.8.5.2.2.2.3.cmml" xref="Sx2.E9.m1.8.8.8.5.2.2.2.4"><ci id="Sx2.E9.m1.7.7.7.4.1.1.1.1.cmml" xref="Sx2.E9.m1.7.7.7.4.1.1.1.1">𝑗</ci><ci id="Sx2.E9.m1.8.8.8.5.2.2.2.2.cmml" xref="Sx2.E9.m1.8.8.8.5.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E9.m1.10c">loss=-\frac{1}{N}\sum_{i}log\frac{e^{s*(cos(\theta_{y_{i},i})-m)}}{e^{s*(cos(%
\theta_{y_{i},i})-m)}+\sum_{j\neq y_{i}}e^{s*cos(\theta_{j,i})}},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E9.m1.10d">italic_l italic_o italic_s italic_s = - divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_l italic_o italic_g divide start_ARG italic_e start_POSTSUPERSCRIPT italic_s ∗ ( italic_c italic_o italic_s ( italic_θ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i end_POSTSUBSCRIPT ) - italic_m ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT italic_s ∗ ( italic_c italic_o italic_s ( italic_θ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i end_POSTSUBSCRIPT ) - italic_m ) end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_j ≠ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_s ∗ italic_c italic_o italic_s ( italic_θ start_POSTSUBSCRIPT italic_j , italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx3.p2.4">s is the magnitude of the codebook sample with i-th codebook entry; m is the margin; <math alttext="\theta_{y_{i},i}" class="ltx_Math" display="inline" id="Sx2.SSx3.p2.2.m1.2"><semantics id="Sx2.SSx3.p2.2.m1.2a"><msub id="Sx2.SSx3.p2.2.m1.2.3" xref="Sx2.SSx3.p2.2.m1.2.3.cmml"><mi id="Sx2.SSx3.p2.2.m1.2.3.2" xref="Sx2.SSx3.p2.2.m1.2.3.2.cmml">θ</mi><mrow id="Sx2.SSx3.p2.2.m1.2.2.2.2" xref="Sx2.SSx3.p2.2.m1.2.2.2.3.cmml"><msub id="Sx2.SSx3.p2.2.m1.2.2.2.2.1" xref="Sx2.SSx3.p2.2.m1.2.2.2.2.1.cmml"><mi id="Sx2.SSx3.p2.2.m1.2.2.2.2.1.2" xref="Sx2.SSx3.p2.2.m1.2.2.2.2.1.2.cmml">y</mi><mi id="Sx2.SSx3.p2.2.m1.2.2.2.2.1.3" xref="Sx2.SSx3.p2.2.m1.2.2.2.2.1.3.cmml">i</mi></msub><mo id="Sx2.SSx3.p2.2.m1.2.2.2.2.2" xref="Sx2.SSx3.p2.2.m1.2.2.2.3.cmml">,</mo><mi id="Sx2.SSx3.p2.2.m1.1.1.1.1" xref="Sx2.SSx3.p2.2.m1.1.1.1.1.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p2.2.m1.2b"><apply id="Sx2.SSx3.p2.2.m1.2.3.cmml" xref="Sx2.SSx3.p2.2.m1.2.3"><csymbol cd="ambiguous" id="Sx2.SSx3.p2.2.m1.2.3.1.cmml" xref="Sx2.SSx3.p2.2.m1.2.3">subscript</csymbol><ci id="Sx2.SSx3.p2.2.m1.2.3.2.cmml" xref="Sx2.SSx3.p2.2.m1.2.3.2">𝜃</ci><list id="Sx2.SSx3.p2.2.m1.2.2.2.3.cmml" xref="Sx2.SSx3.p2.2.m1.2.2.2.2"><apply id="Sx2.SSx3.p2.2.m1.2.2.2.2.1.cmml" xref="Sx2.SSx3.p2.2.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="Sx2.SSx3.p2.2.m1.2.2.2.2.1.1.cmml" xref="Sx2.SSx3.p2.2.m1.2.2.2.2.1">subscript</csymbol><ci id="Sx2.SSx3.p2.2.m1.2.2.2.2.1.2.cmml" xref="Sx2.SSx3.p2.2.m1.2.2.2.2.1.2">𝑦</ci><ci id="Sx2.SSx3.p2.2.m1.2.2.2.2.1.3.cmml" xref="Sx2.SSx3.p2.2.m1.2.2.2.2.1.3">𝑖</ci></apply><ci id="Sx2.SSx3.p2.2.m1.1.1.1.1.cmml" xref="Sx2.SSx3.p2.2.m1.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p2.2.m1.2c">\theta_{y_{i},i}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p2.2.m1.2d">italic_θ start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the angle between semantic embedding <math alttext="W_{y_{i}}" class="ltx_Math" display="inline" id="Sx2.SSx3.p2.3.m2.1"><semantics id="Sx2.SSx3.p2.3.m2.1a"><msub id="Sx2.SSx3.p2.3.m2.1.1" xref="Sx2.SSx3.p2.3.m2.1.1.cmml"><mi id="Sx2.SSx3.p2.3.m2.1.1.2" xref="Sx2.SSx3.p2.3.m2.1.1.2.cmml">W</mi><msub id="Sx2.SSx3.p2.3.m2.1.1.3" xref="Sx2.SSx3.p2.3.m2.1.1.3.cmml"><mi id="Sx2.SSx3.p2.3.m2.1.1.3.2" xref="Sx2.SSx3.p2.3.m2.1.1.3.2.cmml">y</mi><mi id="Sx2.SSx3.p2.3.m2.1.1.3.3" xref="Sx2.SSx3.p2.3.m2.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p2.3.m2.1b"><apply id="Sx2.SSx3.p2.3.m2.1.1.cmml" xref="Sx2.SSx3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="Sx2.SSx3.p2.3.m2.1.1.1.cmml" xref="Sx2.SSx3.p2.3.m2.1.1">subscript</csymbol><ci id="Sx2.SSx3.p2.3.m2.1.1.2.cmml" xref="Sx2.SSx3.p2.3.m2.1.1.2">𝑊</ci><apply id="Sx2.SSx3.p2.3.m2.1.1.3.cmml" xref="Sx2.SSx3.p2.3.m2.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx3.p2.3.m2.1.1.3.1.cmml" xref="Sx2.SSx3.p2.3.m2.1.1.3">subscript</csymbol><ci id="Sx2.SSx3.p2.3.m2.1.1.3.2.cmml" xref="Sx2.SSx3.p2.3.m2.1.1.3.2">𝑦</ci><ci id="Sx2.SSx3.p2.3.m2.1.1.3.3.cmml" xref="Sx2.SSx3.p2.3.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p2.3.m2.1c">W_{y_{i}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p2.3.m2.1d">italic_W start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and i-th codebook entry with <math alttext="{y_{i}}" class="ltx_Math" display="inline" id="Sx2.SSx3.p2.4.m3.1"><semantics id="Sx2.SSx3.p2.4.m3.1a"><msub id="Sx2.SSx3.p2.4.m3.1.1" xref="Sx2.SSx3.p2.4.m3.1.1.cmml"><mi id="Sx2.SSx3.p2.4.m3.1.1.2" xref="Sx2.SSx3.p2.4.m3.1.1.2.cmml">y</mi><mi id="Sx2.SSx3.p2.4.m3.1.1.3" xref="Sx2.SSx3.p2.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p2.4.m3.1b"><apply id="Sx2.SSx3.p2.4.m3.1.1.cmml" xref="Sx2.SSx3.p2.4.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx3.p2.4.m3.1.1.1.cmml" xref="Sx2.SSx3.p2.4.m3.1.1">subscript</csymbol><ci id="Sx2.SSx3.p2.4.m3.1.1.2.cmml" xref="Sx2.SSx3.p2.4.m3.1.1.2">𝑦</ci><ci id="Sx2.SSx3.p2.4.m3.1.1.3.cmml" xref="Sx2.SSx3.p2.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p2.4.m3.1c">{y_{i}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p2.4.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> class label; Besides the above loss, we also implement the other popular contrastive learning loss<cite class="ltx_cite ltx_citemacro_citep">(Qian et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib20" title="">2019</a>; Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib15" title="">2017a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib16" title="">b</a>)</cite> for ablation study detailed in Seq.Ablation Experiments.</p>
</div>
<figure class="ltx_figure" id="Sx2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="116" id="Sx2.F3.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>PCA visulaize for codebook; Up: we use pca to visualize our codebook; Bottom: the reference images.</figcaption>
</figure>
<figure class="ltx_figure" id="Sx2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="565" id="Sx2.F4.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>PCA visualization of the codebook for comparison across different methods.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="Sx2.SSx4">
<h3 class="ltx_title ltx_title_subsection">Multi-level Feature Learning</h3>
<div class="ltx_para" id="Sx2.SSx4.p1">
<p class="ltx_p" id="Sx2.SSx4.p1.1">Semantic-guided features result in high-level, meaningful representations that suppress high-frequency signals. To capture both image details and semantics simultaneously, we introduce multi-level feature learning (<span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p1.1.1">MFL</span>).</p>
</div>
<div class="ltx_para" id="Sx2.SSx4.p2">
<p class="ltx_p" id="Sx2.SSx4.p2.1"><span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p2.1.1">First</span>, we divide the codebook features into N different levels based on the intensity of semantic guidance, determined by the weight function detailed in Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E10" title="Equation 10 ‣ Multi-level Feature Learning ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">10</span></a> of the loss Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E9" title="Equation 9 ‣ Consistent Semantic Learning ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">9</span></a>. Specifically, Eq <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.E10" title="Equation 10 ‣ Multi-level Feature Learning ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">10</span></a> is monotonically decreasing function, the sum is 1 and <math alttext="w(N)=0" class="ltx_Math" display="inline" id="Sx2.SSx4.p2.1.m1.1"><semantics id="Sx2.SSx4.p2.1.m1.1a"><mrow id="Sx2.SSx4.p2.1.m1.1.2" xref="Sx2.SSx4.p2.1.m1.1.2.cmml"><mrow id="Sx2.SSx4.p2.1.m1.1.2.2" xref="Sx2.SSx4.p2.1.m1.1.2.2.cmml"><mi id="Sx2.SSx4.p2.1.m1.1.2.2.2" xref="Sx2.SSx4.p2.1.m1.1.2.2.2.cmml">w</mi><mo id="Sx2.SSx4.p2.1.m1.1.2.2.1" xref="Sx2.SSx4.p2.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="Sx2.SSx4.p2.1.m1.1.2.2.3.2" xref="Sx2.SSx4.p2.1.m1.1.2.2.cmml"><mo id="Sx2.SSx4.p2.1.m1.1.2.2.3.2.1" stretchy="false" xref="Sx2.SSx4.p2.1.m1.1.2.2.cmml">(</mo><mi id="Sx2.SSx4.p2.1.m1.1.1" xref="Sx2.SSx4.p2.1.m1.1.1.cmml">N</mi><mo id="Sx2.SSx4.p2.1.m1.1.2.2.3.2.2" stretchy="false" xref="Sx2.SSx4.p2.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx4.p2.1.m1.1.2.1" xref="Sx2.SSx4.p2.1.m1.1.2.1.cmml">=</mo><mn id="Sx2.SSx4.p2.1.m1.1.2.3" xref="Sx2.SSx4.p2.1.m1.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p2.1.m1.1b"><apply id="Sx2.SSx4.p2.1.m1.1.2.cmml" xref="Sx2.SSx4.p2.1.m1.1.2"><eq id="Sx2.SSx4.p2.1.m1.1.2.1.cmml" xref="Sx2.SSx4.p2.1.m1.1.2.1"></eq><apply id="Sx2.SSx4.p2.1.m1.1.2.2.cmml" xref="Sx2.SSx4.p2.1.m1.1.2.2"><times id="Sx2.SSx4.p2.1.m1.1.2.2.1.cmml" xref="Sx2.SSx4.p2.1.m1.1.2.2.1"></times><ci id="Sx2.SSx4.p2.1.m1.1.2.2.2.cmml" xref="Sx2.SSx4.p2.1.m1.1.2.2.2">𝑤</ci><ci id="Sx2.SSx4.p2.1.m1.1.1.cmml" xref="Sx2.SSx4.p2.1.m1.1.1">𝑁</ci></apply><cn id="Sx2.SSx4.p2.1.m1.1.2.3.cmml" type="integer" xref="Sx2.SSx4.p2.1.m1.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p2.1.m1.1c">w(N)=0</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p2.1.m1.1d">italic_w ( italic_N ) = 0</annotation></semantics></math>; the lowest-level features are not guided by semantics at all.</p>
</div>
<div class="ltx_para" id="Sx2.SSx4.p3">
<p class="ltx_p" id="Sx2.SSx4.p3.1"><span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p3.1.1">Second</span> Different level features are applied differently.</p>
</div>
<div class="ltx_para" id="Sx2.SSx4.p4">
<p class="ltx_p" id="Sx2.SSx4.p4.1">In <span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p4.1.1">Sec.Semantic Online Clustering</span>, we use mixed features to cluster encoded features and the codebook. In <span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p4.1.2">Sec.Consistent Semantic Learning</span>, high-level features are used to cluster the codebook itself, with contrastive learning guiding the compression process towards meaningful representations. Then, an aggregator merges the different level features as input to the decoder.</p>
</div>
<div class="ltx_para" id="Sx2.SSx4.p5">
<p class="ltx_p" id="Sx2.SSx4.p5.3"><span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.3.1">Second</span>, features at different levels are utilized in distinct ways. In <span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.3.2">Sec. Semantic Online Clustering</span>, a combination of features is employed to cluster the encoded features and the codebook, as the encoded features are updated online and guide the codebook preserving image’s details. In <span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.3.3">Sec. Consistent Semantic Learning</span>, only high-level features are used to directly cluster the codebookitself, minimizing the influence of RGB noise with contrastive learning guiding the compression process to produce meaningful representations. Then, an aggregator combines the features from various levels as input to the decoder.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w(l)=\frac{e^{-\alpha*l}-e^{-\alpha*N}}{\sum_{j=1}^{N-1}(e^{-\alpha*j}-e^{-%
\alpha*N})},1\leq l\leq N;" class="ltx_Math" display="block" id="Sx2.E10.m1.3"><semantics id="Sx2.E10.m1.3a"><mrow id="Sx2.E10.m1.3.3.1"><mrow id="Sx2.E10.m1.3.3.1.1.2" xref="Sx2.E10.m1.3.3.1.1.3.cmml"><mrow id="Sx2.E10.m1.3.3.1.1.1.1" xref="Sx2.E10.m1.3.3.1.1.1.1.cmml"><mrow id="Sx2.E10.m1.3.3.1.1.1.1.2" xref="Sx2.E10.m1.3.3.1.1.1.1.2.cmml"><mi id="Sx2.E10.m1.3.3.1.1.1.1.2.2" xref="Sx2.E10.m1.3.3.1.1.1.1.2.2.cmml">w</mi><mo id="Sx2.E10.m1.3.3.1.1.1.1.2.1" xref="Sx2.E10.m1.3.3.1.1.1.1.2.1.cmml">⁢</mo><mrow id="Sx2.E10.m1.3.3.1.1.1.1.2.3.2" xref="Sx2.E10.m1.3.3.1.1.1.1.2.cmml"><mo id="Sx2.E10.m1.3.3.1.1.1.1.2.3.2.1" stretchy="false" xref="Sx2.E10.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="Sx2.E10.m1.2.2" xref="Sx2.E10.m1.2.2.cmml">l</mi><mo id="Sx2.E10.m1.3.3.1.1.1.1.2.3.2.2" stretchy="false" xref="Sx2.E10.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx2.E10.m1.3.3.1.1.1.1.1" xref="Sx2.E10.m1.3.3.1.1.1.1.1.cmml">=</mo><mfrac id="Sx2.E10.m1.1.1" xref="Sx2.E10.m1.1.1.cmml"><mrow id="Sx2.E10.m1.1.1.3" xref="Sx2.E10.m1.1.1.3.cmml"><msup id="Sx2.E10.m1.1.1.3.2" xref="Sx2.E10.m1.1.1.3.2.cmml"><mi id="Sx2.E10.m1.1.1.3.2.2" xref="Sx2.E10.m1.1.1.3.2.2.cmml">e</mi><mrow id="Sx2.E10.m1.1.1.3.2.3" xref="Sx2.E10.m1.1.1.3.2.3.cmml"><mo id="Sx2.E10.m1.1.1.3.2.3a" xref="Sx2.E10.m1.1.1.3.2.3.cmml">−</mo><mrow id="Sx2.E10.m1.1.1.3.2.3.2" xref="Sx2.E10.m1.1.1.3.2.3.2.cmml"><mi id="Sx2.E10.m1.1.1.3.2.3.2.2" xref="Sx2.E10.m1.1.1.3.2.3.2.2.cmml">α</mi><mo id="Sx2.E10.m1.1.1.3.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E10.m1.1.1.3.2.3.2.1.cmml">∗</mo><mi id="Sx2.E10.m1.1.1.3.2.3.2.3" xref="Sx2.E10.m1.1.1.3.2.3.2.3.cmml">l</mi></mrow></mrow></msup><mo id="Sx2.E10.m1.1.1.3.1" xref="Sx2.E10.m1.1.1.3.1.cmml">−</mo><msup id="Sx2.E10.m1.1.1.3.3" xref="Sx2.E10.m1.1.1.3.3.cmml"><mi id="Sx2.E10.m1.1.1.3.3.2" xref="Sx2.E10.m1.1.1.3.3.2.cmml">e</mi><mrow id="Sx2.E10.m1.1.1.3.3.3" xref="Sx2.E10.m1.1.1.3.3.3.cmml"><mo id="Sx2.E10.m1.1.1.3.3.3a" xref="Sx2.E10.m1.1.1.3.3.3.cmml">−</mo><mrow id="Sx2.E10.m1.1.1.3.3.3.2" xref="Sx2.E10.m1.1.1.3.3.3.2.cmml"><mi id="Sx2.E10.m1.1.1.3.3.3.2.2" xref="Sx2.E10.m1.1.1.3.3.3.2.2.cmml">α</mi><mo id="Sx2.E10.m1.1.1.3.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E10.m1.1.1.3.3.3.2.1.cmml">∗</mo><mi id="Sx2.E10.m1.1.1.3.3.3.2.3" xref="Sx2.E10.m1.1.1.3.3.3.2.3.cmml">N</mi></mrow></mrow></msup></mrow><mrow id="Sx2.E10.m1.1.1.1" xref="Sx2.E10.m1.1.1.1.cmml"><msubsup id="Sx2.E10.m1.1.1.1.2" xref="Sx2.E10.m1.1.1.1.2.cmml"><mo id="Sx2.E10.m1.1.1.1.2.2.2" xref="Sx2.E10.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx2.E10.m1.1.1.1.2.2.3" xref="Sx2.E10.m1.1.1.1.2.2.3.cmml"><mi id="Sx2.E10.m1.1.1.1.2.2.3.2" xref="Sx2.E10.m1.1.1.1.2.2.3.2.cmml">j</mi><mo id="Sx2.E10.m1.1.1.1.2.2.3.1" xref="Sx2.E10.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx2.E10.m1.1.1.1.2.2.3.3" xref="Sx2.E10.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="Sx2.E10.m1.1.1.1.2.3" xref="Sx2.E10.m1.1.1.1.2.3.cmml"><mi id="Sx2.E10.m1.1.1.1.2.3.2" xref="Sx2.E10.m1.1.1.1.2.3.2.cmml">N</mi><mo id="Sx2.E10.m1.1.1.1.2.3.1" xref="Sx2.E10.m1.1.1.1.2.3.1.cmml">−</mo><mn id="Sx2.E10.m1.1.1.1.2.3.3" xref="Sx2.E10.m1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="Sx2.E10.m1.1.1.1.1.1" xref="Sx2.E10.m1.1.1.1.1.1.1.cmml"><mo id="Sx2.E10.m1.1.1.1.1.1.2" lspace="0em" stretchy="false" xref="Sx2.E10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E10.m1.1.1.1.1.1.1" xref="Sx2.E10.m1.1.1.1.1.1.1.cmml"><msup id="Sx2.E10.m1.1.1.1.1.1.1.2" xref="Sx2.E10.m1.1.1.1.1.1.1.2.cmml"><mi id="Sx2.E10.m1.1.1.1.1.1.1.2.2" xref="Sx2.E10.m1.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="Sx2.E10.m1.1.1.1.1.1.1.2.3" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.cmml"><mo id="Sx2.E10.m1.1.1.1.1.1.1.2.3a" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.cmml">−</mo><mrow id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.cmml"><mi id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.2" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.2.cmml">α</mi><mo id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.1.cmml">∗</mo><mi id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.3" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.3.cmml">j</mi></mrow></mrow></msup><mo id="Sx2.E10.m1.1.1.1.1.1.1.1" xref="Sx2.E10.m1.1.1.1.1.1.1.1.cmml">−</mo><msup id="Sx2.E10.m1.1.1.1.1.1.1.3" xref="Sx2.E10.m1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E10.m1.1.1.1.1.1.1.3.2" xref="Sx2.E10.m1.1.1.1.1.1.1.3.2.cmml">e</mi><mrow id="Sx2.E10.m1.1.1.1.1.1.1.3.3" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.cmml"><mo id="Sx2.E10.m1.1.1.1.1.1.1.3.3a" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.cmml">−</mo><mrow id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.2" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.2.cmml">α</mi><mo id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.1.cmml">∗</mo><mi id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.3" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.3.cmml">N</mi></mrow></mrow></msup></mrow><mo id="Sx2.E10.m1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="Sx2.E10.m1.3.3.1.1.2.3" xref="Sx2.E10.m1.3.3.1.1.3a.cmml">,</mo><mrow id="Sx2.E10.m1.3.3.1.1.2.2" xref="Sx2.E10.m1.3.3.1.1.2.2.cmml"><mn id="Sx2.E10.m1.3.3.1.1.2.2.2" xref="Sx2.E10.m1.3.3.1.1.2.2.2.cmml">1</mn><mo id="Sx2.E10.m1.3.3.1.1.2.2.3" xref="Sx2.E10.m1.3.3.1.1.2.2.3.cmml">≤</mo><mi id="Sx2.E10.m1.3.3.1.1.2.2.4" xref="Sx2.E10.m1.3.3.1.1.2.2.4.cmml">l</mi><mo id="Sx2.E10.m1.3.3.1.1.2.2.5" xref="Sx2.E10.m1.3.3.1.1.2.2.5.cmml">≤</mo><mi id="Sx2.E10.m1.3.3.1.1.2.2.6" xref="Sx2.E10.m1.3.3.1.1.2.2.6.cmml">N</mi></mrow></mrow><mo id="Sx2.E10.m1.3.3.1.2">;</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E10.m1.3b"><apply id="Sx2.E10.m1.3.3.1.1.3.cmml" xref="Sx2.E10.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="Sx2.E10.m1.3.3.1.1.3a.cmml" xref="Sx2.E10.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="Sx2.E10.m1.3.3.1.1.1.1.cmml" xref="Sx2.E10.m1.3.3.1.1.1.1"><eq id="Sx2.E10.m1.3.3.1.1.1.1.1.cmml" xref="Sx2.E10.m1.3.3.1.1.1.1.1"></eq><apply id="Sx2.E10.m1.3.3.1.1.1.1.2.cmml" xref="Sx2.E10.m1.3.3.1.1.1.1.2"><times id="Sx2.E10.m1.3.3.1.1.1.1.2.1.cmml" xref="Sx2.E10.m1.3.3.1.1.1.1.2.1"></times><ci id="Sx2.E10.m1.3.3.1.1.1.1.2.2.cmml" xref="Sx2.E10.m1.3.3.1.1.1.1.2.2">𝑤</ci><ci id="Sx2.E10.m1.2.2.cmml" xref="Sx2.E10.m1.2.2">𝑙</ci></apply><apply id="Sx2.E10.m1.1.1.cmml" xref="Sx2.E10.m1.1.1"><divide id="Sx2.E10.m1.1.1.2.cmml" xref="Sx2.E10.m1.1.1"></divide><apply id="Sx2.E10.m1.1.1.3.cmml" xref="Sx2.E10.m1.1.1.3"><minus id="Sx2.E10.m1.1.1.3.1.cmml" xref="Sx2.E10.m1.1.1.3.1"></minus><apply id="Sx2.E10.m1.1.1.3.2.cmml" xref="Sx2.E10.m1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E10.m1.1.1.3.2.1.cmml" xref="Sx2.E10.m1.1.1.3.2">superscript</csymbol><ci id="Sx2.E10.m1.1.1.3.2.2.cmml" xref="Sx2.E10.m1.1.1.3.2.2">𝑒</ci><apply id="Sx2.E10.m1.1.1.3.2.3.cmml" xref="Sx2.E10.m1.1.1.3.2.3"><minus id="Sx2.E10.m1.1.1.3.2.3.1.cmml" xref="Sx2.E10.m1.1.1.3.2.3"></minus><apply id="Sx2.E10.m1.1.1.3.2.3.2.cmml" xref="Sx2.E10.m1.1.1.3.2.3.2"><times id="Sx2.E10.m1.1.1.3.2.3.2.1.cmml" xref="Sx2.E10.m1.1.1.3.2.3.2.1"></times><ci id="Sx2.E10.m1.1.1.3.2.3.2.2.cmml" xref="Sx2.E10.m1.1.1.3.2.3.2.2">𝛼</ci><ci id="Sx2.E10.m1.1.1.3.2.3.2.3.cmml" xref="Sx2.E10.m1.1.1.3.2.3.2.3">𝑙</ci></apply></apply></apply><apply id="Sx2.E10.m1.1.1.3.3.cmml" xref="Sx2.E10.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx2.E10.m1.1.1.3.3.1.cmml" xref="Sx2.E10.m1.1.1.3.3">superscript</csymbol><ci id="Sx2.E10.m1.1.1.3.3.2.cmml" xref="Sx2.E10.m1.1.1.3.3.2">𝑒</ci><apply id="Sx2.E10.m1.1.1.3.3.3.cmml" xref="Sx2.E10.m1.1.1.3.3.3"><minus id="Sx2.E10.m1.1.1.3.3.3.1.cmml" xref="Sx2.E10.m1.1.1.3.3.3"></minus><apply id="Sx2.E10.m1.1.1.3.3.3.2.cmml" xref="Sx2.E10.m1.1.1.3.3.3.2"><times id="Sx2.E10.m1.1.1.3.3.3.2.1.cmml" xref="Sx2.E10.m1.1.1.3.3.3.2.1"></times><ci id="Sx2.E10.m1.1.1.3.3.3.2.2.cmml" xref="Sx2.E10.m1.1.1.3.3.3.2.2">𝛼</ci><ci id="Sx2.E10.m1.1.1.3.3.3.2.3.cmml" xref="Sx2.E10.m1.1.1.3.3.3.2.3">𝑁</ci></apply></apply></apply></apply><apply id="Sx2.E10.m1.1.1.1.cmml" xref="Sx2.E10.m1.1.1.1"><apply id="Sx2.E10.m1.1.1.1.2.cmml" xref="Sx2.E10.m1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E10.m1.1.1.1.2.1.cmml" xref="Sx2.E10.m1.1.1.1.2">superscript</csymbol><apply id="Sx2.E10.m1.1.1.1.2.2.cmml" xref="Sx2.E10.m1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E10.m1.1.1.1.2.2.1.cmml" xref="Sx2.E10.m1.1.1.1.2">subscript</csymbol><sum id="Sx2.E10.m1.1.1.1.2.2.2.cmml" xref="Sx2.E10.m1.1.1.1.2.2.2"></sum><apply id="Sx2.E10.m1.1.1.1.2.2.3.cmml" xref="Sx2.E10.m1.1.1.1.2.2.3"><eq id="Sx2.E10.m1.1.1.1.2.2.3.1.cmml" xref="Sx2.E10.m1.1.1.1.2.2.3.1"></eq><ci id="Sx2.E10.m1.1.1.1.2.2.3.2.cmml" xref="Sx2.E10.m1.1.1.1.2.2.3.2">𝑗</ci><cn id="Sx2.E10.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="Sx2.E10.m1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="Sx2.E10.m1.1.1.1.2.3.cmml" xref="Sx2.E10.m1.1.1.1.2.3"><minus id="Sx2.E10.m1.1.1.1.2.3.1.cmml" xref="Sx2.E10.m1.1.1.1.2.3.1"></minus><ci id="Sx2.E10.m1.1.1.1.2.3.2.cmml" xref="Sx2.E10.m1.1.1.1.2.3.2">𝑁</ci><cn id="Sx2.E10.m1.1.1.1.2.3.3.cmml" type="integer" xref="Sx2.E10.m1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx2.E10.m1.1.1.1.1.1.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1"><minus id="Sx2.E10.m1.1.1.1.1.1.1.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.1"></minus><apply id="Sx2.E10.m1.1.1.1.1.1.1.2.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E10.m1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="Sx2.E10.m1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2.2">𝑒</ci><apply id="Sx2.E10.m1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3"><minus id="Sx2.E10.m1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3"></minus><apply id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2"><times id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.1"></times><ci id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.2.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.2">𝛼</ci><ci id="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.3.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="Sx2.E10.m1.1.1.1.1.1.1.3.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E10.m1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="Sx2.E10.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3.2">𝑒</ci><apply id="Sx2.E10.m1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3"><minus id="Sx2.E10.m1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3"></minus><apply id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2"><times id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.1"></times><ci id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.2">𝛼</ci><ci id="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="Sx2.E10.m1.1.1.1.1.1.1.3.3.2.3">𝑁</ci></apply></apply></apply></apply></apply></apply></apply><apply id="Sx2.E10.m1.3.3.1.1.2.2.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2"><and id="Sx2.E10.m1.3.3.1.1.2.2a.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2"></and><apply id="Sx2.E10.m1.3.3.1.1.2.2b.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2"><leq id="Sx2.E10.m1.3.3.1.1.2.2.3.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2.3"></leq><cn id="Sx2.E10.m1.3.3.1.1.2.2.2.cmml" type="integer" xref="Sx2.E10.m1.3.3.1.1.2.2.2">1</cn><ci id="Sx2.E10.m1.3.3.1.1.2.2.4.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2.4">𝑙</ci></apply><apply id="Sx2.E10.m1.3.3.1.1.2.2c.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2"><leq id="Sx2.E10.m1.3.3.1.1.2.2.5.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2.5"></leq><share href="https://arxiv.org/html/2409.06105v1#Sx2.E10.m1.3.3.1.1.2.2.4.cmml" id="Sx2.E10.m1.3.3.1.1.2.2d.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2"></share><ci id="Sx2.E10.m1.3.3.1.1.2.2.6.cmml" xref="Sx2.E10.m1.3.3.1.1.2.2.6">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E10.m1.3c">w(l)=\frac{e^{-\alpha*l}-e^{-\alpha*N}}{\sum_{j=1}^{N-1}(e^{-\alpha*j}-e^{-%
\alpha*N})},1\leq l\leq N;</annotation><annotation encoding="application/x-llamapun" id="Sx2.E10.m1.3d">italic_w ( italic_l ) = divide start_ARG italic_e start_POSTSUPERSCRIPT - italic_α ∗ italic_l end_POSTSUPERSCRIPT - italic_e start_POSTSUPERSCRIPT - italic_α ∗ italic_N end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT ( italic_e start_POSTSUPERSCRIPT - italic_α ∗ italic_j end_POSTSUPERSCRIPT - italic_e start_POSTSUPERSCRIPT - italic_α ∗ italic_N end_POSTSUPERSCRIPT ) end_ARG , 1 ≤ italic_l ≤ italic_N ;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx4.p5.2"><span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.2.1">Finally</span>, an aggregator merges the different level features as input to the decoder. There are five available modes: linear, concat, low-level-only, high-level-only, and cross-attention.
<span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.2.2">Linear:</span> The different level features are combined through a weighted sum;
<span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.2.3">Concat:</span> The different level features are concatenated together;
<span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.2.4">Low-level-only:</span> Only the low-level features are sent to the decoder with the weight <math alttext="&lt;\sigma" class="ltx_Math" display="inline" id="Sx2.SSx4.p5.1.m1.1"><semantics id="Sx2.SSx4.p5.1.m1.1a"><mrow id="Sx2.SSx4.p5.1.m1.1.1" xref="Sx2.SSx4.p5.1.m1.1.1.cmml"><mi id="Sx2.SSx4.p5.1.m1.1.1.2" xref="Sx2.SSx4.p5.1.m1.1.1.2.cmml"></mi><mo id="Sx2.SSx4.p5.1.m1.1.1.1" xref="Sx2.SSx4.p5.1.m1.1.1.1.cmml">&lt;</mo><mi id="Sx2.SSx4.p5.1.m1.1.1.3" xref="Sx2.SSx4.p5.1.m1.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p5.1.m1.1b"><apply id="Sx2.SSx4.p5.1.m1.1.1.cmml" xref="Sx2.SSx4.p5.1.m1.1.1"><lt id="Sx2.SSx4.p5.1.m1.1.1.1.cmml" xref="Sx2.SSx4.p5.1.m1.1.1.1"></lt><csymbol cd="latexml" id="Sx2.SSx4.p5.1.m1.1.1.2.cmml" xref="Sx2.SSx4.p5.1.m1.1.1.2">absent</csymbol><ci id="Sx2.SSx4.p5.1.m1.1.1.3.cmml" xref="Sx2.SSx4.p5.1.m1.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p5.1.m1.1c">&lt;\sigma</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p5.1.m1.1d">&lt; italic_σ</annotation></semantics></math>;
<span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.2.5">High-level-only:</span> Only the high-level features are sent to the decoder with the weight <math alttext="&gt;\sigma" class="ltx_Math" display="inline" id="Sx2.SSx4.p5.2.m2.1"><semantics id="Sx2.SSx4.p5.2.m2.1a"><mrow id="Sx2.SSx4.p5.2.m2.1.1" xref="Sx2.SSx4.p5.2.m2.1.1.cmml"><mi id="Sx2.SSx4.p5.2.m2.1.1.2" xref="Sx2.SSx4.p5.2.m2.1.1.2.cmml"></mi><mo id="Sx2.SSx4.p5.2.m2.1.1.1" xref="Sx2.SSx4.p5.2.m2.1.1.1.cmml">&gt;</mo><mi id="Sx2.SSx4.p5.2.m2.1.1.3" xref="Sx2.SSx4.p5.2.m2.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p5.2.m2.1b"><apply id="Sx2.SSx4.p5.2.m2.1.1.cmml" xref="Sx2.SSx4.p5.2.m2.1.1"><gt id="Sx2.SSx4.p5.2.m2.1.1.1.cmml" xref="Sx2.SSx4.p5.2.m2.1.1.1"></gt><csymbol cd="latexml" id="Sx2.SSx4.p5.2.m2.1.1.2.cmml" xref="Sx2.SSx4.p5.2.m2.1.1.2">absent</csymbol><ci id="Sx2.SSx4.p5.2.m2.1.1.3.cmml" xref="Sx2.SSx4.p5.2.m2.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p5.2.m2.1c">&gt;\sigma</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p5.2.m2.1d">&gt; italic_σ</annotation></semantics></math>;
<span class="ltx_text ltx_font_bold" id="Sx2.SSx4.p5.2.6">Cross attention:</span> We use low-level features as query, and do cross attention with high-level features;</p>
</div>
<div class="ltx_para" id="Sx2.SSx4.p6">
<p class="ltx_p" id="Sx2.SSx4.p6.1">In Sec. Experiment, we demonstrate that even without any additional parameters, our multi-level features perform the best in terms of image quality and semantic representations; In all, our multi-level feature can learn image details and semantics simultaneously, eliminating the need for additional parameter learning. This allows for direct integration into downstream tasks, thereby it greatly enhances the potential for significantly expanding the range of applications.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx2.SSx5">
<h3 class="ltx_title ltx_title_subsection">Modeling Prior Distribution</h3>
<div class="ltx_para" id="Sx2.SSx5.p1">
<p class="ltx_p" id="Sx2.SSx5.p1.1">After embedding an image into a token sequence, we can estimate the underlying prior distribution over the discrete space, facilitating unconditional image, high-resolution image and video generation. As our primary objective is to enhance the codebook learning stage, we utilize the existing setup for the subsequent stage directly.</p>
</div>
<section class="ltx_paragraph" id="Sx2.SSx5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Image Generation</h4>
<div class="ltx_para" id="Sx2.SSx5.SSS0.Px1.p1">
<p class="ltx_p" id="Sx2.SSx5.SSS0.Px1.p1.1">After embedding an image ( I ) into a token sequence <math alttext="s=\{s_{1},\textperiodcentered\textperiodcentered\textperiodcentered,s_{h*w}\}" class="ltx_Math" display="inline" id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3"><semantics id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3a"><mrow id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.5" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.5.cmml">s</mi><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.4" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.4.cmml">=</mo><mrow id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.4.cmml"><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.4" stretchy="false" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.4.cmml">{</mo><msub id="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml">s</mi><mn id="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.5" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.4.cmml">,</mo><mrow id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.2" mathvariant="normal" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml">·</mi><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.1" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.3" mathvariant="normal" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml">·</mi><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.1a" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.4" mathvariant="normal" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.4.cmml">·</mi></mrow><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.6" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.4.cmml">,</mo><msub id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.2" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.2.cmml">s</mi><mrow id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.2" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.2.cmml">h</mi><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.1.cmml">∗</mo><mi id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.3.cmml">w</mi></mrow></msub><mo id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.7" stretchy="false" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3b"><apply id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3"><eq id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.4.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.4"></eq><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.5.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.5">𝑠</ci><set id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.4.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3"><apply id="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.2">𝑠</ci><cn id="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2"><times id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.1"></times><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.2">·</ci><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.3">·</ci><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.4.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.2.2.2.2.2.4">·</ci></apply><apply id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3">subscript</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.2">𝑠</ci><apply id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3"><times id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.1"></times><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.2">ℎ</ci><ci id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.3">𝑤</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3c">s=\{s_{1},\textperiodcentered\textperiodcentered\textperiodcentered,s_{h*w}\}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.SSS0.Px1.p1.1.m1.3d">italic_s = { italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , · · · , italic_s start_POSTSUBSCRIPT italic_h ∗ italic_w end_POSTSUBSCRIPT }</annotation></semantics></math>, the image generation process can be naturally formulated as an autoregressive next-symbol prediction problem. Specifically, we maximize the likelihood function.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(s)=\prod_{i}{p(s_{i}|s_{&lt;i})}," class="ltx_Math" display="block" id="Sx2.E11.m1.2"><semantics id="Sx2.E11.m1.2a"><mrow id="Sx2.E11.m1.2.2.1" xref="Sx2.E11.m1.2.2.1.1.cmml"><mrow id="Sx2.E11.m1.2.2.1.1" xref="Sx2.E11.m1.2.2.1.1.cmml"><mrow id="Sx2.E11.m1.2.2.1.1.3" xref="Sx2.E11.m1.2.2.1.1.3.cmml"><mi id="Sx2.E11.m1.2.2.1.1.3.2" xref="Sx2.E11.m1.2.2.1.1.3.2.cmml">p</mi><mo id="Sx2.E11.m1.2.2.1.1.3.1" xref="Sx2.E11.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="Sx2.E11.m1.2.2.1.1.3.3.2" xref="Sx2.E11.m1.2.2.1.1.3.cmml"><mo id="Sx2.E11.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="Sx2.E11.m1.2.2.1.1.3.cmml">(</mo><mi id="Sx2.E11.m1.1.1" xref="Sx2.E11.m1.1.1.cmml">s</mi><mo id="Sx2.E11.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="Sx2.E11.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="Sx2.E11.m1.2.2.1.1.2" rspace="0.111em" xref="Sx2.E11.m1.2.2.1.1.2.cmml">=</mo><mrow id="Sx2.E11.m1.2.2.1.1.1" xref="Sx2.E11.m1.2.2.1.1.1.cmml"><munder id="Sx2.E11.m1.2.2.1.1.1.2" xref="Sx2.E11.m1.2.2.1.1.1.2.cmml"><mo id="Sx2.E11.m1.2.2.1.1.1.2.2" movablelimits="false" xref="Sx2.E11.m1.2.2.1.1.1.2.2.cmml">∏</mo><mi id="Sx2.E11.m1.2.2.1.1.1.2.3" xref="Sx2.E11.m1.2.2.1.1.1.2.3.cmml">i</mi></munder><mrow id="Sx2.E11.m1.2.2.1.1.1.1" xref="Sx2.E11.m1.2.2.1.1.1.1.cmml"><mi id="Sx2.E11.m1.2.2.1.1.1.1.3" xref="Sx2.E11.m1.2.2.1.1.1.1.3.cmml">p</mi><mo id="Sx2.E11.m1.2.2.1.1.1.1.2" xref="Sx2.E11.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E11.m1.2.2.1.1.1.1.1.1" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E11.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.2" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">s</mi><mi id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.3" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.1" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.2" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="Sx2.E11.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E11.m1.2.2.1.2" xref="Sx2.E11.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E11.m1.2b"><apply id="Sx2.E11.m1.2.2.1.1.cmml" xref="Sx2.E11.m1.2.2.1"><eq id="Sx2.E11.m1.2.2.1.1.2.cmml" xref="Sx2.E11.m1.2.2.1.1.2"></eq><apply id="Sx2.E11.m1.2.2.1.1.3.cmml" xref="Sx2.E11.m1.2.2.1.1.3"><times id="Sx2.E11.m1.2.2.1.1.3.1.cmml" xref="Sx2.E11.m1.2.2.1.1.3.1"></times><ci id="Sx2.E11.m1.2.2.1.1.3.2.cmml" xref="Sx2.E11.m1.2.2.1.1.3.2">𝑝</ci><ci id="Sx2.E11.m1.1.1.cmml" xref="Sx2.E11.m1.1.1">𝑠</ci></apply><apply id="Sx2.E11.m1.2.2.1.1.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1"><apply id="Sx2.E11.m1.2.2.1.1.1.2.cmml" xref="Sx2.E11.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E11.m1.2.2.1.1.1.2.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="Sx2.E11.m1.2.2.1.1.1.2.2.cmml" xref="Sx2.E11.m1.2.2.1.1.1.2.2">product</csymbol><ci id="Sx2.E11.m1.2.2.1.1.1.2.3.cmml" xref="Sx2.E11.m1.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="Sx2.E11.m1.2.2.1.1.1.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1"><times id="Sx2.E11.m1.2.2.1.1.1.1.2.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.2"></times><ci id="Sx2.E11.m1.2.2.1.1.1.1.3.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.3">𝑝</ci><apply id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.2">𝑠</ci><ci id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.2">𝑠</ci><apply id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3"><lt id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx2.E11.m1.2.2.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E11.m1.2c">p(s)=\prod_{i}{p(s_{i}|s_{&lt;i})},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E11.m1.2d">italic_p ( italic_s ) = ∏ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_p ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx5.SSS0.Px1.p1.4">where <math alttext="p(s_{i}|s_{&lt;i})" class="ltx_Math" display="inline" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1"><semantics id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1a"><mrow id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.3" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.3.cmml">p</mi><mo id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.2" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.cmml"><mo id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.2" stretchy="false" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.cmml"><msub id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.2" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.2.cmml">s</mi><mi id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.3" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.1" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.1.cmml">|</mo><msub id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.2" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.2" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.1" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.3" stretchy="false" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1b"><apply id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1"><times id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.2"></times><ci id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.3">𝑝</ci><apply id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.1">conditional</csymbol><apply id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.2">𝑠</ci><ci id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.2">𝑠</ci><apply id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3"><lt id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.2.m1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1c">p(s_{i}|s_{&lt;i})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.SSS0.Px1.p1.2.m1.1d">italic_p ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is the probability of having the next symbol <math alttext="s_{i}" class="ltx_Math" display="inline" id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1"><semantics id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1a"><msub id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1" xref="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.2" xref="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.2.cmml">s</mi><mi id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.3" xref="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1b"><apply id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1">subscript</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.2">𝑠</ci><ci id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.SSS0.Px1.p1.3.m2.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> given all the previous symbols <math alttext="s_{&lt;i}" class="ltx_Math" display="inline" id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1"><semantics id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1a"><msub id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.2" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.2.cmml">s</mi><mrow id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.cmml"><mi id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.2" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.2.cmml"></mi><mo id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.1" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.1.cmml">&lt;</mo><mi id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.3" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1b"><apply id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1">subscript</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.2">𝑠</ci><apply id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3"><lt id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.1.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.1"></lt><csymbol cd="latexml" id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.2.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.2">absent</csymbol><ci id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.3.cmml" xref="Sx2.SSx5.SSS0.Px1.p1.4.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1c">s_{&lt;i}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.SSS0.Px1.p1.4.m3.1d">italic_s start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="Sx2.SSx5.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Video Prediction</h4>
<div class="ltx_para" id="Sx2.SSx5.SSS0.Px2.p1">
<p class="ltx_p" id="Sx2.SSx5.SSS0.Px2.p1.1">Video prediction can be formulated using an autoregressive transformer network that models the sequential input. The training objective is to predict the next image token in the sequence, conditioned on all past tokens, using causal masking in the attention matrix of the transformer blocks. Then, we minimize the following objective:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="loss=-\sum_{t=1}^{T}\sum_{i=1}^{n}{logp(s_{t,i}|s_{&lt;i},z_{t,j&lt;i})}." class="ltx_Math" display="block" id="Sx2.E12.m1.5"><semantics id="Sx2.E12.m1.5a"><mrow id="Sx2.E12.m1.5.5.1" xref="Sx2.E12.m1.5.5.1.1.cmml"><mrow id="Sx2.E12.m1.5.5.1.1" xref="Sx2.E12.m1.5.5.1.1.cmml"><mrow id="Sx2.E12.m1.5.5.1.1.3" xref="Sx2.E12.m1.5.5.1.1.3.cmml"><mi id="Sx2.E12.m1.5.5.1.1.3.2" xref="Sx2.E12.m1.5.5.1.1.3.2.cmml">l</mi><mo id="Sx2.E12.m1.5.5.1.1.3.1" xref="Sx2.E12.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="Sx2.E12.m1.5.5.1.1.3.3" xref="Sx2.E12.m1.5.5.1.1.3.3.cmml">o</mi><mo id="Sx2.E12.m1.5.5.1.1.3.1a" xref="Sx2.E12.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="Sx2.E12.m1.5.5.1.1.3.4" xref="Sx2.E12.m1.5.5.1.1.3.4.cmml">s</mi><mo id="Sx2.E12.m1.5.5.1.1.3.1b" xref="Sx2.E12.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="Sx2.E12.m1.5.5.1.1.3.5" xref="Sx2.E12.m1.5.5.1.1.3.5.cmml">s</mi></mrow><mo id="Sx2.E12.m1.5.5.1.1.2" xref="Sx2.E12.m1.5.5.1.1.2.cmml">=</mo><mrow id="Sx2.E12.m1.5.5.1.1.1" xref="Sx2.E12.m1.5.5.1.1.1.cmml"><mo id="Sx2.E12.m1.5.5.1.1.1a" xref="Sx2.E12.m1.5.5.1.1.1.cmml">−</mo><mrow id="Sx2.E12.m1.5.5.1.1.1.1" xref="Sx2.E12.m1.5.5.1.1.1.1.cmml"><munderover id="Sx2.E12.m1.5.5.1.1.1.1.2" xref="Sx2.E12.m1.5.5.1.1.1.1.2.cmml"><mo id="Sx2.E12.m1.5.5.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.2" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.1" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.3" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx2.E12.m1.5.5.1.1.1.1.2.3" xref="Sx2.E12.m1.5.5.1.1.1.1.2.3.cmml">T</mi></munderover><mrow id="Sx2.E12.m1.5.5.1.1.1.1.1" xref="Sx2.E12.m1.5.5.1.1.1.1.1.cmml"><munderover id="Sx2.E12.m1.5.5.1.1.1.1.1.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.cmml"><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.2" movablelimits="false" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.cmml"><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.1" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.2.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="Sx2.E12.m1.5.5.1.1.1.1.1.1" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.cmml"><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.3.cmml">l</mi><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.4" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.4.cmml">o</mi><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.2a" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.5" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.5.cmml">g</mi><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.2b" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.6" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.6.cmml">p</mi><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.2c" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4.2.cmml">s</mi><mrow id="Sx2.E12.m1.2.2.2.4" xref="Sx2.E12.m1.2.2.2.3.cmml"><mi id="Sx2.E12.m1.1.1.1.1" xref="Sx2.E12.m1.1.1.1.1.cmml">t</mi><mo id="Sx2.E12.m1.2.2.2.4.1" xref="Sx2.E12.m1.2.2.2.3.cmml">,</mo><mi id="Sx2.E12.m1.2.2.2.2" xref="Sx2.E12.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo fence="false" id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">z</mi><mrow id="Sx2.E12.m1.4.4.2" xref="Sx2.E12.m1.4.4.2.cmml"><mrow id="Sx2.E12.m1.4.4.2.4.2" xref="Sx2.E12.m1.4.4.2.4.1.cmml"><mi id="Sx2.E12.m1.3.3.1.1" xref="Sx2.E12.m1.3.3.1.1.cmml">t</mi><mo id="Sx2.E12.m1.4.4.2.4.2.1" xref="Sx2.E12.m1.4.4.2.4.1.cmml">,</mo><mi id="Sx2.E12.m1.4.4.2.2" xref="Sx2.E12.m1.4.4.2.2.cmml">j</mi></mrow><mo id="Sx2.E12.m1.4.4.2.3" xref="Sx2.E12.m1.4.4.2.3.cmml">&lt;</mo><mi id="Sx2.E12.m1.4.4.2.5" xref="Sx2.E12.m1.4.4.2.5.cmml">i</mi></mrow></msub></mrow></mrow><mo id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="Sx2.E12.m1.5.5.1.2" lspace="0em" xref="Sx2.E12.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E12.m1.5b"><apply id="Sx2.E12.m1.5.5.1.1.cmml" xref="Sx2.E12.m1.5.5.1"><eq id="Sx2.E12.m1.5.5.1.1.2.cmml" xref="Sx2.E12.m1.5.5.1.1.2"></eq><apply id="Sx2.E12.m1.5.5.1.1.3.cmml" xref="Sx2.E12.m1.5.5.1.1.3"><times id="Sx2.E12.m1.5.5.1.1.3.1.cmml" xref="Sx2.E12.m1.5.5.1.1.3.1"></times><ci id="Sx2.E12.m1.5.5.1.1.3.2.cmml" xref="Sx2.E12.m1.5.5.1.1.3.2">𝑙</ci><ci id="Sx2.E12.m1.5.5.1.1.3.3.cmml" xref="Sx2.E12.m1.5.5.1.1.3.3">𝑜</ci><ci id="Sx2.E12.m1.5.5.1.1.3.4.cmml" xref="Sx2.E12.m1.5.5.1.1.3.4">𝑠</ci><ci id="Sx2.E12.m1.5.5.1.1.3.5.cmml" xref="Sx2.E12.m1.5.5.1.1.3.5">𝑠</ci></apply><apply id="Sx2.E12.m1.5.5.1.1.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1"><minus id="Sx2.E12.m1.5.5.1.1.1.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1"></minus><apply id="Sx2.E12.m1.5.5.1.1.1.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1"><apply id="Sx2.E12.m1.5.5.1.1.1.1.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E12.m1.5.5.1.1.1.1.2.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E12.m1.5.5.1.1.1.1.2.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E12.m1.5.5.1.1.1.1.2.2.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="Sx2.E12.m1.5.5.1.1.1.1.2.2.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3"><eq id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.2">𝑡</ci><cn id="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.3.cmml" type="integer" xref="Sx2.E12.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx2.E12.m1.5.5.1.1.1.1.2.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.2.3">𝑇</ci></apply><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1"><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E12.m1.5.5.1.1.1.1.1.2.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.2"></sum><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3"><eq id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.2.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1"><times id="Sx2.E12.m1.5.5.1.1.1.1.1.1.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.2"></times><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.3">𝑙</ci><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.4.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.4">𝑜</ci><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.5.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.5">𝑔</ci><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.6.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.6">𝑝</ci><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.4.2">𝑠</ci><list id="Sx2.E12.m1.2.2.2.3.cmml" xref="Sx2.E12.m1.2.2.2.4"><ci id="Sx2.E12.m1.1.1.1.1.cmml" xref="Sx2.E12.m1.1.1.1.1">𝑡</ci><ci id="Sx2.E12.m1.2.2.2.2.cmml" xref="Sx2.E12.m1.2.2.2.2">𝑖</ci></list></apply><list id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2"><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx2.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑧</ci><apply id="Sx2.E12.m1.4.4.2.cmml" xref="Sx2.E12.m1.4.4.2"><lt id="Sx2.E12.m1.4.4.2.3.cmml" xref="Sx2.E12.m1.4.4.2.3"></lt><list id="Sx2.E12.m1.4.4.2.4.1.cmml" xref="Sx2.E12.m1.4.4.2.4.2"><ci id="Sx2.E12.m1.3.3.1.1.cmml" xref="Sx2.E12.m1.3.3.1.1">𝑡</ci><ci id="Sx2.E12.m1.4.4.2.2.cmml" xref="Sx2.E12.m1.4.4.2.2">𝑗</ci></list><ci id="Sx2.E12.m1.4.4.2.5.cmml" xref="Sx2.E12.m1.4.4.2.5">𝑖</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E12.m1.5c">loss=-\sum_{t=1}^{T}\sum_{i=1}^{n}{logp(s_{t,i}|s_{&lt;i},z_{t,j&lt;i})}.</annotation><annotation encoding="application/x-llamapun" id="Sx2.E12.m1.5d">italic_l italic_o italic_s italic_s = - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_l italic_o italic_g italic_p ( italic_s start_POSTSUBSCRIPT italic_t , italic_i end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t , italic_j &lt; italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">Experiments</h2>
<section class="ltx_subsection" id="Sx3.SSx1">
<h3 class="ltx_title ltx_title_subsection">Experimental Details</h3>
<div class="ltx_para" id="Sx3.SSx1.p1">
<p class="ltx_p" id="Sx3.SSx1.p1.2"><span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p1.2.1">Datasets.</span>
We evaluated the proposed method on multiple datasets, including ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Deng et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib4" title="">2009</a>)</cite>, COCO <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib14" title="">2014</a>)</cite>, and Nuscenes <cite class="ltx_cite ltx_citemacro_citep">(Caesar et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib2" title="">2020</a>)</cite>. We excluded MNIST <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib11" title="">1998</a>)</cite> and CIFAR10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky, Hinton et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib10" title="">2009</a>)</cite> due to their limited diversity and simplistic content. We instantiated SGC-VQGAN for unconditional image generation tasks with <math alttext="256\times 256" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.1.m1.1"><semantics id="Sx3.SSx1.p1.1.m1.1a"><mrow id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml"><mn id="Sx3.SSx1.p1.1.m1.1.1.2" xref="Sx3.SSx1.p1.1.m1.1.1.2.cmml">256</mn><mo id="Sx3.SSx1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx1.p1.1.m1.1.1.1.cmml">×</mo><mn id="Sx3.SSx1.p1.1.m1.1.1.3" xref="Sx3.SSx1.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><apply id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1"><times id="Sx3.SSx1.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.1"></times><cn id="Sx3.SSx1.p1.1.m1.1.1.2.cmml" type="integer" xref="Sx3.SSx1.p1.1.m1.1.1.2">256</cn><cn id="Sx3.SSx1.p1.1.m1.1.1.3.cmml" type="integer" xref="Sx3.SSx1.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.1.m1.1d">256 × 256</annotation></semantics></math> images from ImageNet and COCO, consistent with the original VQGAN<cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>. Additionally, we applied SGC-VQGAN to both unconditional image and video generation tasks using the Nuscenes dataset, setting the image size to <math alttext="288\times 512" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.2.m2.1"><semantics id="Sx3.SSx1.p1.2.m2.1a"><mrow id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml"><mn id="Sx3.SSx1.p1.2.m2.1.1.2" xref="Sx3.SSx1.p1.2.m2.1.1.2.cmml">288</mn><mo id="Sx3.SSx1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx1.p1.2.m2.1.1.1.cmml">×</mo><mn id="Sx3.SSx1.p1.2.m2.1.1.3" xref="Sx3.SSx1.p1.2.m2.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><apply id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1"><times id="Sx3.SSx1.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.1"></times><cn id="Sx3.SSx1.p1.2.m2.1.1.2.cmml" type="integer" xref="Sx3.SSx1.p1.2.m2.1.1.2">288</cn><cn id="Sx3.SSx1.p1.2.m2.1.1.3.cmml" type="integer" xref="Sx3.SSx1.p1.2.m2.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">288\times 512</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.2.m2.1d">288 × 512</annotation></semantics></math> to maintain the aspect ratio. We use Segformer <cite class="ltx_cite ltx_citemacro_citep">(Xie et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib28" title="">2021</a>)</cite> and LUSS <cite class="ltx_cite ltx_citemacro_citep">(Gao et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib6" title="">2022</a>)</cite> to infer segmentation results of Nuscenes and ImageNet<cite class="ltx_cite ltx_citemacro_citep">(Deng et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib4" title="">2009</a>)</cite> dataset;</p>
</div>
<figure class="ltx_table" id="Sx3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx3.T1.1" style="width:433.6pt;height:111.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(77.2pt,-19.9pt) scale(1.55249012188517,1.55249012188517) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx3.T1.1.1">
<tr class="ltx_tr" id="Sx3.T1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="Sx3.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="Sx3.T1.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="Sx3.T1.1.1.1.2">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="Sx3.T1.1.1.1.3">0.3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="Sx3.T1.1.1.1.4">0.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="Sx3.T1.1.1.1.5">0.7</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="Sx3.T1.1.1.1.6">0.9</td>
</tr>
<tr class="ltx_tr" id="Sx3.T1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T1.1.1.2.1">VQGAN</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T1.1.1.2.2">0.0258</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T1.1.1.2.3">0.0219</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T1.1.1.2.4">0.0076</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T1.1.1.2.5">0.0060</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T1.1.1.2.6">0.0052</td>
</tr>
<tr class="ltx_tr" id="Sx3.T1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T1.1.1.3.1">CVQ-VAE</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T1.1.1.3.2">1.0000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T1.1.1.3.3">0.9542</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T1.1.1.3.4">0.2351</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T1.1.1.3.5">0.0093</td>
<td class="ltx_td ltx_align_center" id="Sx3.T1.1.1.3.6">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx3.T1.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="Sx3.T1.1.1.4.1">
<span class="ltx_text ltx_font_bold" id="Sx3.T1.1.1.4.1.1">Ours</span> (dim=8)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="Sx3.T1.1.1.4.2"><span class="ltx_text ltx_font_bold" id="Sx3.T1.1.1.4.2.1">1.0000</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="Sx3.T1.1.1.4.3"><span class="ltx_text ltx_font_bold" id="Sx3.T1.1.1.4.3.1">0.9999</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="Sx3.T1.1.1.4.4"><span class="ltx_text ltx_font_bold" id="Sx3.T1.1.1.4.4.1">0.9674</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="Sx3.T1.1.1.4.5"><span class="ltx_text ltx_font_bold" id="Sx3.T1.1.1.4.5.1">0.8978</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="Sx3.T1.1.1.4.6"><span class="ltx_text ltx_font_bold" id="Sx3.T1.1.1.4.6.1">0.7511</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of semantic uniqueness; We compute the hit numbers of codebooks and classify these hits according to pixel semantics. The counts are then used as probabilities for these semantic classes of every entry in codebook. Finally, we provide the ratio of probabilities that exceed a given threshold. For more details, please refer to Appendix, Section Semantic Performance Analysis.</figcaption>
</figure>
<div class="ltx_para" id="Sx3.SSx1.p2">
<p class="ltx_p" id="Sx3.SSx1.p2.1"><span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p2.1.1">Metrics.</span>
We evaluated the quality of the proposed methods on three tasks: image reconstruction , image generation , and video generation. <span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p2.1.2">For image reconstruction task</span>, we used traditional patch-level evaluation metrics, including Peak Signal-to-Noise Ratio (PSNR), Structure Similarity Index (SSIM), feature-level Learned Perceptual Image Patch Similarity (LPIPS) <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib30" title="">2018</a>)</cite>. <span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p2.1.3">For image generation task</span>, we used one of the most common evaluation metric Fréchet Inception Distance (FID) <cite class="ltx_cite ltx_citemacro_citep">(Heusel et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib8" title="">2017</a>)</cite> to evaluate the quality and diversity of generated images. <span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p2.1.4">For video generation task</span>, we used Fréchet Video Distance (FVD) <cite class="ltx_cite ltx_citemacro_citep">(Unterthiner et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib24" title="">2019</a>)</cite>. In addition, we <span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p2.1.5">evaluate codebook semantics</span> using the Silhouette Score (SS) <cite class="ltx_cite ltx_citemacro_citep">(Rousseeuw <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib22" title="">1987</a>)</cite> and Davies-Bouldin Index (DBI) <cite class="ltx_cite ltx_citemacro_citep">(Davies and Bouldin <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib3" title="">1979</a>)</cite>, where higher SS values and lower DBI values indicate better clustering quality which are widely used and effective metrics for evaluating clustering quality, characterized by them robustness and intuitiveness<cite class="ltx_cite ltx_citemacro_citep">(Han, Vedaldi, and Zisserman <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib7" title="">2019</a>; Dou et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib5" title="">2019</a>; Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib13" title="">2021</a>; Qu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib21" title="">2023</a>)</cite>. For more details, please refer to Appendix.</p>
</div>
<figure class="ltx_table" id="Sx3.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx3.T2.9" style="width:433.6pt;height:56.7pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-62.7pt,8.1pt) scale(0.775743772621249,0.775743772621249) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx3.T2.9.9">
<tr class="ltx_tr" id="Sx3.T2.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.6.6.6.7"><span class="ltx_text ltx_font_bold" id="Sx3.T2.6.6.6.7.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.6.6.6.8">Latent Size</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.1.1.1.1"><math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T2.1.1.1.1.m1.1"><semantics id="Sx3.T2.1.1.1.1.m1.1a"><mrow id="Sx3.T2.1.1.1.1.m1.1.2.2" xref="Sx3.T2.1.1.1.1.m1.1.2.1.cmml"><mo id="Sx3.T2.1.1.1.1.m1.1.2.2.1" xref="Sx3.T2.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T2.1.1.1.1.m1.1.1" xref="Sx3.T2.1.1.1.1.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T2.1.1.1.1.m1.1.2.2.2" xref="Sx3.T2.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T2.1.1.1.1.m1.1b"><apply id="Sx3.T2.1.1.1.1.m1.1.2.1.cmml" xref="Sx3.T2.1.1.1.1.m1.1.2.2"><abs id="Sx3.T2.1.1.1.1.m1.1.2.1.1.cmml" xref="Sx3.T2.1.1.1.1.m1.1.2.2.1"></abs><ci id="Sx3.T2.1.1.1.1.m1.1.1.cmml" xref="Sx3.T2.1.1.1.1.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.1.1.1.1.m1.1c">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.1.1.1.1.m1.1d">| caligraphic_Z |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.2.2.2.2">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T2.2.2.2.2.m1.1"><semantics id="Sx3.T2.2.2.2.2.m1.1a"><mo id="Sx3.T2.2.2.2.2.m1.1.1" stretchy="false" xref="Sx3.T2.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.2.2.2.2.m1.1b"><ci id="Sx3.T2.2.2.2.2.m1.1.1.cmml" xref="Sx3.T2.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.3.3.3.3">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T2.3.3.3.3.m1.1"><semantics id="Sx3.T2.3.3.3.3.m1.1a"><mo id="Sx3.T2.3.3.3.3.m1.1.1" stretchy="false" xref="Sx3.T2.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.3.3.3.3.m1.1b"><ci id="Sx3.T2.3.3.3.3.m1.1.1.cmml" xref="Sx3.T2.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.4.4.4.4">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T2.4.4.4.4.m1.1"><semantics id="Sx3.T2.4.4.4.4.m1.1a"><mo id="Sx3.T2.4.4.4.4.m1.1.1" stretchy="false" xref="Sx3.T2.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.4.4.4.4.m1.1b"><ci id="Sx3.T2.4.4.4.4.m1.1.1.cmml" xref="Sx3.T2.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.4.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.4.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.5.5.5.5">SS<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T2.5.5.5.5.m1.1"><semantics id="Sx3.T2.5.5.5.5.m1.1a"><mo id="Sx3.T2.5.5.5.5.m1.1.1" stretchy="false" xref="Sx3.T2.5.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.5.5.5.5.m1.1b"><ci id="Sx3.T2.5.5.5.5.m1.1.1.cmml" xref="Sx3.T2.5.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.5.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.5.5.5.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T2.6.6.6.6">DBI<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T2.6.6.6.6.m1.1"><semantics id="Sx3.T2.6.6.6.6.m1.1a"><mo id="Sx3.T2.6.6.6.6.m1.1.1" stretchy="false" xref="Sx3.T2.6.6.6.6.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.6.6.6.6.m1.1b"><ci id="Sx3.T2.6.6.6.6.m1.1.1.cmml" xref="Sx3.T2.6.6.6.6.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.6.6.6.6.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.6.6.6.6.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="Sx3.T2.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.7.7.7.2">VQGAN<cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.7.7.7.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T2.7.7.7.1.m1.1"><semantics id="Sx3.T2.7.7.7.1.m1.1a"><mo id="Sx3.T2.7.7.7.1.m1.1.1" xref="Sx3.T2.7.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.7.7.7.1.m1.1b"><times id="Sx3.T2.7.7.7.1.m1.1.1.cmml" xref="Sx3.T2.7.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.7.7.7.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.7.7.7.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.7.7.7.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.7.7.7.4">26.24</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.7.7.7.5">0.7603</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.7.7.7.6">0.2836</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T2.7.7.7.7"><span class="ltx_text ltx_font_bold" id="Sx3.T2.7.7.7.7.1" style="color:#4D4DFF;">-0.0081</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T2.7.7.7.8"><span class="ltx_text ltx_font_bold" id="Sx3.T2.7.7.7.8.1" style="color:#4D4DFF;">4.3211</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T2.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T2.8.8.8.2">CVQVAE<cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T2.8.8.8.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T2.8.8.8.1.m1.1"><semantics id="Sx3.T2.8.8.8.1.m1.1a"><mo id="Sx3.T2.8.8.8.1.m1.1.1" xref="Sx3.T2.8.8.8.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.8.8.8.1.m1.1b"><times id="Sx3.T2.8.8.8.1.m1.1.1.cmml" xref="Sx3.T2.8.8.8.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.8.8.8.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.8.8.8.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T2.8.8.8.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T2.8.8.8.4"><span class="ltx_text ltx_font_bold" id="Sx3.T2.8.8.8.4.1" style="color:#FF4D4D;">27.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T2.8.8.8.5"><span class="ltx_text ltx_font_bold" id="Sx3.T2.8.8.8.5.1" style="color:#FF4D4D;">0.8007</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T2.8.8.8.6"><span class="ltx_text ltx_font_bold" id="Sx3.T2.8.8.8.6.1" style="color:#FF4D4D;">0.2248</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T2.8.8.8.7">-0.0297</td>
<td class="ltx_td ltx_align_center" id="Sx3.T2.8.8.8.8">4.7772</td>
</tr>
<tr class="ltx_tr" id="Sx3.T2.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T2.9.9.9.2">
<span class="ltx_text ltx_font_bold" id="Sx3.T2.9.9.9.2.1">SGC-VQGAN</span> (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T2.9.9.9.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T2.9.9.9.1.m1.1"><semantics id="Sx3.T2.9.9.9.1.m1.1a"><mo id="Sx3.T2.9.9.9.1.m1.1.1" xref="Sx3.T2.9.9.9.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T2.9.9.9.1.m1.1b"><times id="Sx3.T2.9.9.9.1.m1.1.1.cmml" xref="Sx3.T2.9.9.9.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.9.9.9.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.9.9.9.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T2.9.9.9.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T2.9.9.9.4"><span class="ltx_text ltx_font_bold" id="Sx3.T2.9.9.9.4.1" style="color:#4D4DFF;">26.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T2.9.9.9.5"><span class="ltx_text ltx_font_bold" id="Sx3.T2.9.9.9.5.1" style="color:#4D4DFF;">0.7946</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T2.9.9.9.6"><span class="ltx_text ltx_font_bold" id="Sx3.T2.9.9.9.6.1" style="color:#4D4DFF;">0.2395</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T2.9.9.9.7"><span class="ltx_text ltx_font_bold" id="Sx3.T2.9.9.9.7.1" style="color:#FF4D4D;">0.7366</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx3.T2.9.9.9.8"><span class="ltx_text ltx_font_bold" id="Sx3.T2.9.9.9.8.1" style="color:#FF4D4D;">0.4455</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Quantitative reconstruction results on the validation splits of Nuscenes. <math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T2.11.m1.1"><semantics id="Sx3.T2.11.m1.1b"><mrow id="Sx3.T2.11.m1.1.2.2" xref="Sx3.T2.11.m1.1.2.1.cmml"><mo id="Sx3.T2.11.m1.1.2.2.1" xref="Sx3.T2.11.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T2.11.m1.1.1" xref="Sx3.T2.11.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T2.11.m1.1.2.2.2" xref="Sx3.T2.11.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T2.11.m1.1c"><apply id="Sx3.T2.11.m1.1.2.1.cmml" xref="Sx3.T2.11.m1.1.2.2"><abs id="Sx3.T2.11.m1.1.2.1.1.cmml" xref="Sx3.T2.11.m1.1.2.2.1"></abs><ci id="Sx3.T2.11.m1.1.1.cmml" xref="Sx3.T2.11.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T2.11.m1.1d">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T2.11.m1.1e">| caligraphic_Z |</annotation></semantics></math> denotes the size of codebook. (Red indicates the best, while Blue indicates the second-best.)</figcaption>
</figure>
<figure class="ltx_table" id="Sx3.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx3.T3.9" style="width:433.6pt;height:158.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(44.4pt,-16.2pt) scale(1.2573737257893,1.2573737257893) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx3.T3.9.9">
<tr class="ltx_tr" id="Sx3.T3.3.3.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.3.3.3.4"><span class="ltx_text ltx_font_bold" id="Sx3.T3.3.3.3.4.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.3.3.3.5"><span class="ltx_text ltx_font_bold" id="Sx3.T3.3.3.3.5.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.3.3.3.6">Latent Size</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.1.1.1.1"><math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T3.1.1.1.1.m1.1"><semantics id="Sx3.T3.1.1.1.1.m1.1a"><mrow id="Sx3.T3.1.1.1.1.m1.1.2.2" xref="Sx3.T3.1.1.1.1.m1.1.2.1.cmml"><mo id="Sx3.T3.1.1.1.1.m1.1.2.2.1" xref="Sx3.T3.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T3.1.1.1.1.m1.1.1" xref="Sx3.T3.1.1.1.1.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T3.1.1.1.1.m1.1.2.2.2" xref="Sx3.T3.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T3.1.1.1.1.m1.1b"><apply id="Sx3.T3.1.1.1.1.m1.1.2.1.cmml" xref="Sx3.T3.1.1.1.1.m1.1.2.2"><abs id="Sx3.T3.1.1.1.1.m1.1.2.1.1.cmml" xref="Sx3.T3.1.1.1.1.m1.1.2.2.1"></abs><ci id="Sx3.T3.1.1.1.1.m1.1.1.cmml" xref="Sx3.T3.1.1.1.1.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.1.1.1.1.m1.1c">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.1.1.1.1.m1.1d">| caligraphic_Z |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.2.2.2.2">FID<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T3.2.2.2.2.m1.1"><semantics id="Sx3.T3.2.2.2.2.m1.1a"><mo id="Sx3.T3.2.2.2.2.m1.1.1" stretchy="false" xref="Sx3.T3.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.2.2.2.2.m1.1b"><ci id="Sx3.T3.2.2.2.2.m1.1.1.cmml" xref="Sx3.T3.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.2.2.2.2.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T3.3.3.3.3">FVD<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T3.3.3.3.3.m1.1"><semantics id="Sx3.T3.3.3.3.3.m1.1a"><mo id="Sx3.T3.3.3.3.3.m1.1.1" stretchy="false" xref="Sx3.T3.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.3.3.3.3.m1.1b"><ci id="Sx3.T3.3.3.3.3.m1.1.1.cmml" xref="Sx3.T3.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="Sx3.T3.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.4.4.4.2" rowspan="3"><span class="ltx_text" id="Sx3.T3.4.4.4.2.1">ImageNet</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.4.4.4.3">VQGAN</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.4.4.4.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T3.4.4.4.1.m1.1"><semantics id="Sx3.T3.4.4.4.1.m1.1a"><mo id="Sx3.T3.4.4.4.1.m1.1.1" xref="Sx3.T3.4.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.4.4.4.1.m1.1b"><times id="Sx3.T3.4.4.4.1.m1.1.1.cmml" xref="Sx3.T3.4.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.4.4.4.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.4.4.4.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.4.4.4.4">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.4.4.4.5">25.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T3.4.4.4.6">-</td>
</tr>
<tr class="ltx_tr" id="Sx3.T3.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.5.5.5.2">CVQVAE</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.5.5.5.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T3.5.5.5.1.m1.1"><semantics id="Sx3.T3.5.5.5.1.m1.1a"><mo id="Sx3.T3.5.5.5.1.m1.1.1" xref="Sx3.T3.5.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.5.5.5.1.m1.1b"><times id="Sx3.T3.5.5.5.1.m1.1.1.cmml" xref="Sx3.T3.5.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.5.5.5.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.5.5.5.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.5.5.5.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.5.5.5.4"><span class="ltx_text ltx_font_bold" id="Sx3.T3.5.5.5.4.1" style="color:#4D4DFF;">24.87</span></td>
<td class="ltx_td ltx_align_center" id="Sx3.T3.5.5.5.5">-</td>
</tr>
<tr class="ltx_tr" id="Sx3.T3.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.6.6.6.2">
<span class="ltx_text ltx_font_bold" id="Sx3.T3.6.6.6.2.1">SGC-VQGAN</span> (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.6.6.6.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T3.6.6.6.1.m1.1"><semantics id="Sx3.T3.6.6.6.1.m1.1a"><mo id="Sx3.T3.6.6.6.1.m1.1.1" xref="Sx3.T3.6.6.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.6.6.6.1.m1.1b"><times id="Sx3.T3.6.6.6.1.m1.1.1.cmml" xref="Sx3.T3.6.6.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.6.6.6.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.6.6.6.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.6.6.6.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.6.6.6.4"><span class="ltx_text ltx_font_bold" id="Sx3.T3.6.6.6.4.1" style="color:#FF4D4D;">19.92</span></td>
<td class="ltx_td ltx_align_center" id="Sx3.T3.6.6.6.5">-</td>
</tr>
<tr class="ltx_tr" id="Sx3.T3.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="Sx3.T3.7.7.7.2" rowspan="3"><span class="ltx_text" id="Sx3.T3.7.7.7.2.1">Nuscenes</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.7.7.7.3">VQGAN</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.7.7.7.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T3.7.7.7.1.m1.1"><semantics id="Sx3.T3.7.7.7.1.m1.1a"><mo id="Sx3.T3.7.7.7.1.m1.1.1" xref="Sx3.T3.7.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.7.7.7.1.m1.1b"><times id="Sx3.T3.7.7.7.1.m1.1.1.cmml" xref="Sx3.T3.7.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.7.7.7.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.7.7.7.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.7.7.7.4">8192</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T3.7.7.7.5">24.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T3.7.7.7.6">1431.04</td>
</tr>
<tr class="ltx_tr" id="Sx3.T3.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.8.8.8.2">CVQVAE</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.8.8.8.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T3.8.8.8.1.m1.1"><semantics id="Sx3.T3.8.8.8.1.m1.1a"><mo id="Sx3.T3.8.8.8.1.m1.1.1" xref="Sx3.T3.8.8.8.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.8.8.8.1.m1.1b"><times id="Sx3.T3.8.8.8.1.m1.1.1.cmml" xref="Sx3.T3.8.8.8.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.8.8.8.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.8.8.8.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.8.8.8.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T3.8.8.8.4"><span class="ltx_text ltx_font_bold" id="Sx3.T3.8.8.8.4.1" style="color:#4D4DFF;">20.72</span></td>
<td class="ltx_td ltx_align_center" id="Sx3.T3.8.8.8.5"><span class="ltx_text ltx_font_bold" id="Sx3.T3.8.8.8.5.1" style="color:#4D4DFF;">1372.72</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T3.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T3.9.9.9.2">
<span class="ltx_text ltx_font_bold" id="Sx3.T3.9.9.9.2.1">SGC-VQGAN</span> (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T3.9.9.9.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T3.9.9.9.1.m1.1"><semantics id="Sx3.T3.9.9.9.1.m1.1a"><mo id="Sx3.T3.9.9.9.1.m1.1.1" xref="Sx3.T3.9.9.9.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T3.9.9.9.1.m1.1b"><times id="Sx3.T3.9.9.9.1.m1.1.1.cmml" xref="Sx3.T3.9.9.9.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.9.9.9.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.9.9.9.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T3.9.9.9.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T3.9.9.9.4"><span class="ltx_text ltx_font_bold" id="Sx3.T3.9.9.9.4.1" style="color:#FF4D4D;">19.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx3.T3.9.9.9.5"><span class="ltx_text ltx_font_bold" id="Sx3.T3.9.9.9.5.1" style="color:#FF4D4D;">825.95</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Quantitative results for unconditional image generation on the validation splits of ImageNet<cite class="ltx_cite ltx_citemacro_citep">(Deng et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib4" title="">2009</a>)</cite> (50,000 images), COCO<cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib14" title="">2014</a>)</cite> (5,000 images) and Nuscenes<cite class="ltx_cite ltx_citemacro_citep">(Caesar et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib2" title="">2020</a>)</cite>. Quantitative results for video pmyLightRediction on the validation splits of Nuscenes. <math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T3.11.m1.1"><semantics id="Sx3.T3.11.m1.1b"><mrow id="Sx3.T3.11.m1.1.2.2" xref="Sx3.T3.11.m1.1.2.1.cmml"><mo id="Sx3.T3.11.m1.1.2.2.1" xref="Sx3.T3.11.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T3.11.m1.1.1" xref="Sx3.T3.11.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T3.11.m1.1.2.2.2" xref="Sx3.T3.11.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T3.11.m1.1c"><apply id="Sx3.T3.11.m1.1.2.1.cmml" xref="Sx3.T3.11.m1.1.2.2"><abs id="Sx3.T3.11.m1.1.2.1.1.cmml" xref="Sx3.T3.11.m1.1.2.2.1"></abs><ci id="Sx3.T3.11.m1.1.1.cmml" xref="Sx3.T3.11.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T3.11.m1.1d">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T3.11.m1.1e">| caligraphic_Z |</annotation></semantics></math> denotes the size of codebook. (Red indicates the best, while Blue indicates the second-best.)</figcaption>
</figure>
<div class="ltx_para" id="Sx3.SSx1.p3">
<p class="ltx_p" id="Sx3.SSx1.p3.1"><span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p3.1.1">Network structures and implementation details.</span>
Our implementation is based on the officially released VQ-GAN architecture <cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>. To ensure a fair comparison, we used consistent hyperparameters across all methods in our experiments. For the COCO and ImageNet datasets, images were downsampled by a factor of 8. For Nuscenes, images were resized from 288x512x3 to a grid of tokens with dimensions 18x32x32. We set the hyperparameters according to the baseline VQ-GAN work. In the first stage, we trained all models with a batch size of 10 across 8 Tesla A800 GPUs for 40 epochs focused on image reconstruction. In the second stage, for video generation and high-resolution image generation, we trained all models with a batch size of 2 across 8 Tesla A800 GPUs for 40 epochs.</p>
</div>
<figure class="ltx_figure" id="Sx3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="52" id="Sx3.F5.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Video generation for complex scenarios. The numbers represent the video frame numbers.</figcaption>
</figure>
<figure class="ltx_figure" id="Sx3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="Sx3.F6.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Image Generation in Nucenes dataset. Our model achieve highest image fidelity in terms of vehicles, zebra crossing and trees.</figcaption>
</figure>
<figure class="ltx_figure" id="Sx3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="Sx3.F7.g1" src="extracted/5842524/img/hq_2.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>High resolution image generation for complex scenarios with detailed and high-fidelity results(red lights and reflections).</figcaption>
</figure>
<figure class="ltx_table" id="Sx3.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx3.T4.16" style="width:433.6pt;height:155.1pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-61.4pt,21.9pt) scale(0.779267902154928,0.779267902154928) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx3.T4.16.16">
<tr class="ltx_tr" id="Sx3.T4.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.4.4.4.5"><span class="ltx_text ltx_font_bold" id="Sx3.T4.4.4.4.5.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.4.4.4.6"><span class="ltx_text ltx_font_bold" id="Sx3.T4.4.4.4.6.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.4.4.4.7">Latent Size</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.1.1.1.1"><math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T4.1.1.1.1.m1.1"><semantics id="Sx3.T4.1.1.1.1.m1.1a"><mrow id="Sx3.T4.1.1.1.1.m1.1.2.2" xref="Sx3.T4.1.1.1.1.m1.1.2.1.cmml"><mo id="Sx3.T4.1.1.1.1.m1.1.2.2.1" xref="Sx3.T4.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T4.1.1.1.1.m1.1.1" xref="Sx3.T4.1.1.1.1.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T4.1.1.1.1.m1.1.2.2.2" xref="Sx3.T4.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T4.1.1.1.1.m1.1b"><apply id="Sx3.T4.1.1.1.1.m1.1.2.1.cmml" xref="Sx3.T4.1.1.1.1.m1.1.2.2"><abs id="Sx3.T4.1.1.1.1.m1.1.2.1.1.cmml" xref="Sx3.T4.1.1.1.1.m1.1.2.2.1"></abs><ci id="Sx3.T4.1.1.1.1.m1.1.1.cmml" xref="Sx3.T4.1.1.1.1.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.1.1.1.1.m1.1c">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.1.1.1.1.m1.1d">| caligraphic_Z |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.2.2.2.2">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T4.2.2.2.2.m1.1"><semantics id="Sx3.T4.2.2.2.2.m1.1a"><mo id="Sx3.T4.2.2.2.2.m1.1.1" stretchy="false" xref="Sx3.T4.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.2.2.2.2.m1.1b"><ci id="Sx3.T4.2.2.2.2.m1.1.1.cmml" xref="Sx3.T4.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.3.3.3.3">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T4.3.3.3.3.m1.1"><semantics id="Sx3.T4.3.3.3.3.m1.1a"><mo id="Sx3.T4.3.3.3.3.m1.1.1" stretchy="false" xref="Sx3.T4.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.3.3.3.3.m1.1b"><ci id="Sx3.T4.3.3.3.3.m1.1.1.cmml" xref="Sx3.T4.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T4.4.4.4.4">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T4.4.4.4.4.m1.1"><semantics id="Sx3.T4.4.4.4.4.m1.1a"><mo id="Sx3.T4.4.4.4.4.m1.1.1" stretchy="false" xref="Sx3.T4.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.4.4.4.4.m1.1b"><ci id="Sx3.T4.4.4.4.4.m1.1.1.cmml" xref="Sx3.T4.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.4.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.4.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.5.5.5.2" rowspan="7"><span class="ltx_text" id="Sx3.T4.5.5.5.2.1">ImageNet</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.5.5.5.3">VQGAN <cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.5.5.5.1">16<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.5.5.5.1.m1.1"><semantics id="Sx3.T4.5.5.5.1.m1.1a"><mo id="Sx3.T4.5.5.5.1.m1.1.1" xref="Sx3.T4.5.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.5.5.5.1.m1.1b"><times id="Sx3.T4.5.5.5.1.m1.1.1.cmml" xref="Sx3.T4.5.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.5.5.5.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.5.5.5.1.m1.1d">×</annotation></semantics></math>16</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.5.5.5.4">1024</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.5.5.5.5">19.47</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.5.5.5.6">0.5214</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T4.5.5.5.7">0.1950</td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.6.6.6.2">VQGAN <cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.6.6.6.1">16<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.6.6.6.1.m1.1"><semantics id="Sx3.T4.6.6.6.1.m1.1a"><mo id="Sx3.T4.6.6.6.1.m1.1.1" xref="Sx3.T4.6.6.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.6.6.6.1.m1.1b"><times id="Sx3.T4.6.6.6.1.m1.1.1.cmml" xref="Sx3.T4.6.6.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.6.6.6.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.6.6.6.1.m1.1d">×</annotation></semantics></math>16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.6.6.6.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.6.6.6.4">19.93</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.6.6.6.5">0.5424</td>
<td class="ltx_td ltx_align_center" id="Sx3.T4.6.6.6.6">0.1766</td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.7.7.7.2">ViT-VQGAN <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib29" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.7.7.7.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.7.7.7.1.m1.1"><semantics id="Sx3.T4.7.7.7.1.m1.1a"><mo id="Sx3.T4.7.7.7.1.m1.1.1" xref="Sx3.T4.7.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.7.7.7.1.m1.1b"><times id="Sx3.T4.7.7.7.1.m1.1.1.cmml" xref="Sx3.T4.7.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.7.7.7.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.7.7.7.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.7.7.7.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.7.7.7.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.7.7.7.5">-</td>
<td class="ltx_td ltx_align_center" id="Sx3.T4.7.7.7.6">-</td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.9.9.9.3">RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Lee et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib12" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.9.9.9.2">8<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.8.8.8.1.m1.1"><semantics id="Sx3.T4.8.8.8.1.m1.1a"><mo id="Sx3.T4.8.8.8.1.m1.1.1" xref="Sx3.T4.8.8.8.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.8.8.8.1.m1.1b"><times id="Sx3.T4.8.8.8.1.m1.1.1.cmml" xref="Sx3.T4.8.8.8.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.8.8.8.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.8.8.8.1.m1.1d">×</annotation></semantics></math>8<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.9.9.9.2.m2.1"><semantics id="Sx3.T4.9.9.9.2.m2.1a"><mo id="Sx3.T4.9.9.9.2.m2.1.1" xref="Sx3.T4.9.9.9.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.9.9.9.2.m2.1b"><times id="Sx3.T4.9.9.9.2.m2.1.1.cmml" xref="Sx3.T4.9.9.9.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.9.9.9.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.9.9.9.2.m2.1d">×</annotation></semantics></math>16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.9.9.9.4">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.9.9.9.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.9.9.9.6">-</td>
<td class="ltx_td ltx_align_center" id="Sx3.T4.9.9.9.7">-</td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.11.11.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.11.11.11.3">MoVQ <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib32" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.11.11.11.2">16<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.10.10.10.1.m1.1"><semantics id="Sx3.T4.10.10.10.1.m1.1a"><mo id="Sx3.T4.10.10.10.1.m1.1.1" xref="Sx3.T4.10.10.10.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.10.10.10.1.m1.1b"><times id="Sx3.T4.10.10.10.1.m1.1.1.cmml" xref="Sx3.T4.10.10.10.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.10.10.10.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.10.10.10.1.m1.1d">×</annotation></semantics></math>16<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.11.11.11.2.m2.1"><semantics id="Sx3.T4.11.11.11.2.m2.1a"><mo id="Sx3.T4.11.11.11.2.m2.1.1" xref="Sx3.T4.11.11.11.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.11.11.11.2.m2.1b"><times id="Sx3.T4.11.11.11.2.m2.1.1.cmml" xref="Sx3.T4.11.11.11.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.11.11.11.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.11.11.11.2.m2.1d">×</annotation></semantics></math>4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.11.11.11.4">1024</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.11.11.11.5">22.42</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.11.11.11.6">0.6731</td>
<td class="ltx_td ltx_align_center" id="Sx3.T4.11.11.11.7"><span class="ltx_text ltx_font_bold" id="Sx3.T4.11.11.11.7.1" style="color:#FF4D4D;">0.1132</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.12.12.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.12.12.12.2">CVQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.12.12.12.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.12.12.12.1.m1.1"><semantics id="Sx3.T4.12.12.12.1.m1.1a"><mo id="Sx3.T4.12.12.12.1.m1.1.1" xref="Sx3.T4.12.12.12.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.12.12.12.1.m1.1b"><times id="Sx3.T4.12.12.12.1.m1.1.1.cmml" xref="Sx3.T4.12.12.12.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.12.12.12.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.12.12.12.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.12.12.12.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.12.12.12.4"><span class="ltx_text ltx_font_bold" id="Sx3.T4.12.12.12.4.1" style="color:#4D4DFF;">22.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.12.12.12.5"><span class="ltx_text ltx_font_bold" id="Sx3.T4.12.12.12.5.1" style="color:#4D4DFF;">0.6863</span></td>
<td class="ltx_td ltx_align_center" id="Sx3.T4.12.12.12.6"><span class="ltx_text ltx_font_bold" id="Sx3.T4.12.12.12.6.1" style="color:#4D4DFF;">0.1692</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.13.13.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.13.13.13.2">
<span class="ltx_text ltx_font_bold" id="Sx3.T4.13.13.13.2.1">SGC-VQGAN</span> (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.13.13.13.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.13.13.13.1.m1.1"><semantics id="Sx3.T4.13.13.13.1.m1.1a"><mo id="Sx3.T4.13.13.13.1.m1.1.1" xref="Sx3.T4.13.13.13.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.13.13.13.1.m1.1b"><times id="Sx3.T4.13.13.13.1.m1.1.1.cmml" xref="Sx3.T4.13.13.13.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.13.13.13.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.13.13.13.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.13.13.13.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.13.13.13.4"><span class="ltx_text ltx_font_bold" id="Sx3.T4.13.13.13.4.1" style="color:#FF4D4D;">23.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.13.13.13.5"><span class="ltx_text ltx_font_bold" id="Sx3.T4.13.13.13.5.1" style="color:#FF4D4D;">0.6903</span></td>
<td class="ltx_td ltx_align_center" id="Sx3.T4.13.13.13.6">0.1745</td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.14.14.14">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="Sx3.T4.14.14.14.2" rowspan="3"><span class="ltx_text" id="Sx3.T4.14.14.14.2.1">COCO</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.14.14.14.3">VQGAN <cite class="ltx_cite ltx_citemacro_citep">(Patrick Esser <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib19" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.14.14.14.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.14.14.14.1.m1.1"><semantics id="Sx3.T4.14.14.14.1.m1.1a"><mo id="Sx3.T4.14.14.14.1.m1.1.1" xref="Sx3.T4.14.14.14.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.14.14.14.1.m1.1b"><times id="Sx3.T4.14.14.14.1.m1.1.1.cmml" xref="Sx3.T4.14.14.14.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.14.14.14.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.14.14.14.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.14.14.14.4">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.14.14.14.5">21.16</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T4.14.14.14.6">0.6188</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T4.14.14.14.7">0.2136</td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.15.15.15">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.15.15.15.2">CVQGAN <cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.15.15.15.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.15.15.15.1.m1.1"><semantics id="Sx3.T4.15.15.15.1.m1.1a"><mo id="Sx3.T4.15.15.15.1.m1.1.1" xref="Sx3.T4.15.15.15.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.15.15.15.1.m1.1b"><times id="Sx3.T4.15.15.15.1.m1.1.1.cmml" xref="Sx3.T4.15.15.15.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.15.15.15.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.15.15.15.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.15.15.15.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.15.15.15.4"><span class="ltx_text ltx_font_bold" id="Sx3.T4.15.15.15.4.1" style="color:#4D4DFF;">22.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T4.15.15.15.5"><span class="ltx_text ltx_font_bold" id="Sx3.T4.15.15.15.5.1" style="color:#FF4D4D;">0.6876</span></td>
<td class="ltx_td ltx_align_center" id="Sx3.T4.15.15.15.6"><span class="ltx_text ltx_font_bold" id="Sx3.T4.15.15.15.6.1" style="color:#FF4D4D;">0.1660</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T4.16.16.16">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T4.16.16.16.2">
<span class="ltx_text ltx_font_bold" id="Sx3.T4.16.16.16.2.1">SGC-VQGAN</span> (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T4.16.16.16.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T4.16.16.16.1.m1.1"><semantics id="Sx3.T4.16.16.16.1.m1.1a"><mo id="Sx3.T4.16.16.16.1.m1.1.1" xref="Sx3.T4.16.16.16.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T4.16.16.16.1.m1.1b"><times id="Sx3.T4.16.16.16.1.m1.1.1.cmml" xref="Sx3.T4.16.16.16.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.16.16.16.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.16.16.16.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T4.16.16.16.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T4.16.16.16.4"><span class="ltx_text ltx_font_bold" id="Sx3.T4.16.16.16.4.1" style="color:#FF4D4D;">22.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T4.16.16.16.5"><span class="ltx_text ltx_font_bold" id="Sx3.T4.16.16.16.5.1" style="color:#4D4DFF;">0.6818</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx3.T4.16.16.16.6"><span class="ltx_text ltx_font_bold" id="Sx3.T4.16.16.16.6.1" style="color:#4D4DFF;">0.1749</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Quantitative reconstruction results on the validation splits of ImageNet<cite class="ltx_cite ltx_citemacro_citep">(Deng et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib4" title="">2009</a>)</cite> (50,000 images), COCO<cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib14" title="">2014</a>)</cite> (5,000 images). <math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T4.18.m1.1"><semantics id="Sx3.T4.18.m1.1b"><mrow id="Sx3.T4.18.m1.1.2.2" xref="Sx3.T4.18.m1.1.2.1.cmml"><mo id="Sx3.T4.18.m1.1.2.2.1" xref="Sx3.T4.18.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T4.18.m1.1.1" xref="Sx3.T4.18.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T4.18.m1.1.2.2.2" xref="Sx3.T4.18.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T4.18.m1.1c"><apply id="Sx3.T4.18.m1.1.2.1.cmml" xref="Sx3.T4.18.m1.1.2.2"><abs id="Sx3.T4.18.m1.1.2.1.1.cmml" xref="Sx3.T4.18.m1.1.2.2.1"></abs><ci id="Sx3.T4.18.m1.1.1.cmml" xref="Sx3.T4.18.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T4.18.m1.1d">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T4.18.m1.1e">| caligraphic_Z |</annotation></semantics></math> denotes the size of codebook. (Red indicates the best, while Blue indicates the second-best.)</figcaption>
</figure>
<figure class="ltx_table" id="Sx3.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx3.T5.6" style="width:433.6pt;height:47.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-28.7pt,3.2pt) scale(0.882985084495589,0.882985084495589) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx3.T5.6.6">
<tr class="ltx_tr" id="Sx3.T5.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.4.4.4.5"><span class="ltx_text ltx_font_bold" id="Sx3.T5.4.4.4.5.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.4.4.4.6">Latent Size</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.1.1.1.1"><math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T5.1.1.1.1.m1.1"><semantics id="Sx3.T5.1.1.1.1.m1.1a"><mrow id="Sx3.T5.1.1.1.1.m1.1.2.2" xref="Sx3.T5.1.1.1.1.m1.1.2.1.cmml"><mo id="Sx3.T5.1.1.1.1.m1.1.2.2.1" xref="Sx3.T5.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T5.1.1.1.1.m1.1.1" xref="Sx3.T5.1.1.1.1.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T5.1.1.1.1.m1.1.2.2.2" xref="Sx3.T5.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T5.1.1.1.1.m1.1b"><apply id="Sx3.T5.1.1.1.1.m1.1.2.1.cmml" xref="Sx3.T5.1.1.1.1.m1.1.2.2"><abs id="Sx3.T5.1.1.1.1.m1.1.2.1.1.cmml" xref="Sx3.T5.1.1.1.1.m1.1.2.2.1"></abs><ci id="Sx3.T5.1.1.1.1.m1.1.1.cmml" xref="Sx3.T5.1.1.1.1.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T5.1.1.1.1.m1.1c">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T5.1.1.1.1.m1.1d">| caligraphic_Z |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.2.2.2.2">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T5.2.2.2.2.m1.1"><semantics id="Sx3.T5.2.2.2.2.m1.1a"><mo id="Sx3.T5.2.2.2.2.m1.1.1" stretchy="false" xref="Sx3.T5.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T5.2.2.2.2.m1.1b"><ci id="Sx3.T5.2.2.2.2.m1.1.1.cmml" xref="Sx3.T5.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T5.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T5.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.3.3.3.3">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T5.3.3.3.3.m1.1"><semantics id="Sx3.T5.3.3.3.3.m1.1a"><mo id="Sx3.T5.3.3.3.3.m1.1.1" stretchy="false" xref="Sx3.T5.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T5.3.3.3.3.m1.1b"><ci id="Sx3.T5.3.3.3.3.m1.1.1.cmml" xref="Sx3.T5.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T5.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T5.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T5.4.4.4.4">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T5.4.4.4.4.m1.1"><semantics id="Sx3.T5.4.4.4.4.m1.1a"><mo id="Sx3.T5.4.4.4.4.m1.1.1" stretchy="false" xref="Sx3.T5.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T5.4.4.4.4.m1.1b"><ci id="Sx3.T5.4.4.4.4.m1.1.1.cmml" xref="Sx3.T5.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T5.4.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T5.4.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="Sx3.T5.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.5.5.5.2">CVQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.5.5.5.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T5.5.5.5.1.m1.1"><semantics id="Sx3.T5.5.5.5.1.m1.1a"><mo id="Sx3.T5.5.5.5.1.m1.1.1" xref="Sx3.T5.5.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T5.5.5.5.1.m1.1b"><times id="Sx3.T5.5.5.5.1.m1.1.1.cmml" xref="Sx3.T5.5.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T5.5.5.5.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T5.5.5.5.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.5.5.5.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.5.5.5.4">22.20</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T5.5.5.5.5">0.6760</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T5.5.5.5.6"><span class="ltx_text ltx_font_bold" id="Sx3.T5.5.5.5.6.1" style="color:#FF4D4D;">0.1730</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T5.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T5.6.6.6.2">
<span class="ltx_text ltx_font_bold" id="Sx3.T5.6.6.6.2.1">SGC-VQGAN</span> (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T5.6.6.6.1">32<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T5.6.6.6.1.m1.1"><semantics id="Sx3.T5.6.6.6.1.m1.1a"><mo id="Sx3.T5.6.6.6.1.m1.1.1" xref="Sx3.T5.6.6.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T5.6.6.6.1.m1.1b"><times id="Sx3.T5.6.6.6.1.m1.1.1.cmml" xref="Sx3.T5.6.6.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T5.6.6.6.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T5.6.6.6.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T5.6.6.6.3">16384</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T5.6.6.6.4"><span class="ltx_text ltx_font_bold" id="Sx3.T5.6.6.6.4.1" style="color:#FF4D4D;">22.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T5.6.6.6.5"><span class="ltx_text ltx_font_bold" id="Sx3.T5.6.6.6.5.1" style="color:#FF4D4D;">0.6803</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx3.T5.6.6.6.6">0.1738</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Quantitative reconstruction results on the validation splits of COCO<cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib14" title="">2014</a>)</cite> (5,000 images) from a model trained on ImageNet-S-919<cite class="ltx_cite ltx_citemacro_citep">(Gao et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib6" title="">2022</a>)</cite>. <math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T5.8.m1.1"><semantics id="Sx3.T5.8.m1.1b"><mrow id="Sx3.T5.8.m1.1.2.2" xref="Sx3.T5.8.m1.1.2.1.cmml"><mo id="Sx3.T5.8.m1.1.2.2.1" xref="Sx3.T5.8.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T5.8.m1.1.1" xref="Sx3.T5.8.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T5.8.m1.1.2.2.2" xref="Sx3.T5.8.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T5.8.m1.1c"><apply id="Sx3.T5.8.m1.1.2.1.cmml" xref="Sx3.T5.8.m1.1.2.2"><abs id="Sx3.T5.8.m1.1.2.1.1.cmml" xref="Sx3.T5.8.m1.1.2.2.1"></abs><ci id="Sx3.T5.8.m1.1.1.cmml" xref="Sx3.T5.8.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T5.8.m1.1d">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T5.8.m1.1e">| caligraphic_Z |</annotation></semantics></math> denotes the size of codebook. ( Red indicates the best.)</figcaption>
</figure>
<figure class="ltx_figure" id="Sx3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="456" id="Sx3.F8.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Reconstruction from different models on COCO. Compared to VQGAN and CVQ-VAE, our proposed model improves the reconstruction quality (highlighted in red boxes).</figcaption>
</figure>
<figure class="ltx_figure" id="Sx3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="Sx3.F9.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Comparison of reconstruction results between using multilevel features learning (MFL) method and not.</figcaption>
</figure>
<figure class="ltx_table" id="Sx3.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx3.T6.7" style="width:433.6pt;height:60.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(23.9pt,-3.3pt) scale(1.12393220839865,1.12393220839865) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx3.T6.7.7">
<tr class="ltx_tr" id="Sx3.T6.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.5.5.5.6"><span class="ltx_text ltx_font_bold" id="Sx3.T6.5.5.5.6.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.5.5.5.7">Latent Size</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.1.1.1.1"><math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T6.1.1.1.1.m1.1"><semantics id="Sx3.T6.1.1.1.1.m1.1a"><mrow id="Sx3.T6.1.1.1.1.m1.1.2.2" xref="Sx3.T6.1.1.1.1.m1.1.2.1.cmml"><mo id="Sx3.T6.1.1.1.1.m1.1.2.2.1" xref="Sx3.T6.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T6.1.1.1.1.m1.1.1" xref="Sx3.T6.1.1.1.1.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T6.1.1.1.1.m1.1.2.2.2" xref="Sx3.T6.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T6.1.1.1.1.m1.1b"><apply id="Sx3.T6.1.1.1.1.m1.1.2.1.cmml" xref="Sx3.T6.1.1.1.1.m1.1.2.2"><abs id="Sx3.T6.1.1.1.1.m1.1.2.1.1.cmml" xref="Sx3.T6.1.1.1.1.m1.1.2.2.1"></abs><ci id="Sx3.T6.1.1.1.1.m1.1.1.cmml" xref="Sx3.T6.1.1.1.1.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.1.1.1.1.m1.1c">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.1.1.1.1.m1.1d">| caligraphic_Z |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.2.2.2.2">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T6.2.2.2.2.m1.1"><semantics id="Sx3.T6.2.2.2.2.m1.1a"><mo id="Sx3.T6.2.2.2.2.m1.1.1" stretchy="false" xref="Sx3.T6.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T6.2.2.2.2.m1.1b"><ci id="Sx3.T6.2.2.2.2.m1.1.1.cmml" xref="Sx3.T6.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.3.3.3.3">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T6.3.3.3.3.m1.1"><semantics id="Sx3.T6.3.3.3.3.m1.1a"><mo id="Sx3.T6.3.3.3.3.m1.1.1" stretchy="false" xref="Sx3.T6.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T6.3.3.3.3.m1.1b"><ci id="Sx3.T6.3.3.3.3.m1.1.1.cmml" xref="Sx3.T6.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.4.4.4.4">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T6.4.4.4.4.m1.1"><semantics id="Sx3.T6.4.4.4.4.m1.1a"><mo id="Sx3.T6.4.4.4.4.m1.1.1" stretchy="false" xref="Sx3.T6.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T6.4.4.4.4.m1.1b"><ci id="Sx3.T6.4.4.4.4.m1.1.1.cmml" xref="Sx3.T6.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.4.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.4.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T6.5.5.5.5">DBI<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T6.5.5.5.5.m1.1"><semantics id="Sx3.T6.5.5.5.5.m1.1a"><mo id="Sx3.T6.5.5.5.5.m1.1.1" stretchy="false" xref="Sx3.T6.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T6.5.5.5.5.m1.1b"><ci id="Sx3.T6.5.5.5.5.m1.1.1.cmml" xref="Sx3.T6.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.5.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.5.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="Sx3.T6.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.6.6.6.2">SGC-VQGAN <span class="ltx_text ltx_font_bold" id="Sx3.T6.6.6.6.2.1">wo MFL</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.6.6.6.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T6.6.6.6.1.m1.1"><semantics id="Sx3.T6.6.6.6.1.m1.1a"><mo id="Sx3.T6.6.6.6.1.m1.1.1" xref="Sx3.T6.6.6.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T6.6.6.6.1.m1.1b"><times id="Sx3.T6.6.6.6.1.m1.1.1.cmml" xref="Sx3.T6.6.6.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.6.6.6.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.6.6.6.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.6.6.6.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.6.6.6.4">23.1339</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.6.6.6.5">0.7207</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T6.6.6.6.6">0.3299</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T6.6.6.6.7">4.7772</td>
</tr>
<tr class="ltx_tr" id="Sx3.T6.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T6.7.7.7.2">SGC-VQGAN <span class="ltx_text ltx_font_bold" id="Sx3.T6.7.7.7.2.1">w MFL</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T6.7.7.7.1">18<math alttext="\times" class="ltx_Math" display="inline" id="Sx3.T6.7.7.7.1.m1.1"><semantics id="Sx3.T6.7.7.7.1.m1.1a"><mo id="Sx3.T6.7.7.7.1.m1.1.1" xref="Sx3.T6.7.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.T6.7.7.7.1.m1.1b"><times id="Sx3.T6.7.7.7.1.m1.1.1.cmml" xref="Sx3.T6.7.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.7.7.7.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.7.7.7.1.m1.1d">×</annotation></semantics></math>32</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T6.7.7.7.3">8192</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T6.7.7.7.4"><span class="ltx_text ltx_font_bold" id="Sx3.T6.7.7.7.4.1">26.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T6.7.7.7.5"><span class="ltx_text ltx_font_bold" id="Sx3.T6.7.7.7.5.1">0.7946</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T6.7.7.7.6"><span class="ltx_text ltx_font_bold" id="Sx3.T6.7.7.7.6.1">0.2395</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx3.T6.7.7.7.7"><span class="ltx_text ltx_font_bold" id="Sx3.T6.7.7.7.7.1">0.4455</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation for MFL of Nuscenes. <math alttext="\left|\mathcal{Z}\right|" class="ltx_Math" display="inline" id="Sx3.T6.9.m1.1"><semantics id="Sx3.T6.9.m1.1b"><mrow id="Sx3.T6.9.m1.1.2.2" xref="Sx3.T6.9.m1.1.2.1.cmml"><mo id="Sx3.T6.9.m1.1.2.2.1" xref="Sx3.T6.9.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.T6.9.m1.1.1" xref="Sx3.T6.9.m1.1.1.cmml">𝒵</mi><mo id="Sx3.T6.9.m1.1.2.2.2" xref="Sx3.T6.9.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.T6.9.m1.1c"><apply id="Sx3.T6.9.m1.1.2.1.cmml" xref="Sx3.T6.9.m1.1.2.2"><abs id="Sx3.T6.9.m1.1.2.1.1.cmml" xref="Sx3.T6.9.m1.1.2.2.1"></abs><ci id="Sx3.T6.9.m1.1.1.cmml" xref="Sx3.T6.9.m1.1.1">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T6.9.m1.1d">\left|\mathcal{Z}\right|</annotation><annotation encoding="application/x-llamapun" id="Sx3.T6.9.m1.1e">| caligraphic_Z |</annotation></semantics></math> denotes the size of codebook.</figcaption>
</figure>
<figure class="ltx_table" id="Sx3.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx3.T7.5" style="width:433.6pt;height:229.8pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-89.7pt,47.4pt) scale(0.707244029169462,0.707244029169462) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx3.T7.5.5">
<tr class="ltx_tr" id="Sx3.T7.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.5.6"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.5.6.1">Settings</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.5.7"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.5.7.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.1.1.1.1">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T7.1.1.1.1.m1.1"><semantics id="Sx3.T7.1.1.1.1.m1.1a"><mo id="Sx3.T7.1.1.1.1.m1.1.1" stretchy="false" xref="Sx3.T7.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T7.1.1.1.1.m1.1b"><ci id="Sx3.T7.1.1.1.1.m1.1.1.cmml" xref="Sx3.T7.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T7.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T7.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.2.2.2.2">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T7.2.2.2.2.m1.1"><semantics id="Sx3.T7.2.2.2.2.m1.1a"><mo id="Sx3.T7.2.2.2.2.m1.1.1" stretchy="false" xref="Sx3.T7.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T7.2.2.2.2.m1.1b"><ci id="Sx3.T7.2.2.2.2.m1.1.1.cmml" xref="Sx3.T7.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T7.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T7.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.3.3.3.3">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T7.3.3.3.3.m1.1"><semantics id="Sx3.T7.3.3.3.3.m1.1a"><mo id="Sx3.T7.3.3.3.3.m1.1.1" stretchy="false" xref="Sx3.T7.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T7.3.3.3.3.m1.1b"><ci id="Sx3.T7.3.3.3.3.m1.1.1.cmml" xref="Sx3.T7.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T7.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T7.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.4.4.4.4">SS<math alttext="\uparrow" class="ltx_Math" display="inline" id="Sx3.T7.4.4.4.4.m1.1"><semantics id="Sx3.T7.4.4.4.4.m1.1a"><mo id="Sx3.T7.4.4.4.4.m1.1.1" stretchy="false" xref="Sx3.T7.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Sx3.T7.4.4.4.4.m1.1b"><ci id="Sx3.T7.4.4.4.4.m1.1.1.cmml" xref="Sx3.T7.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T7.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T7.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T7.5.5.5.5">DBI<math alttext="\downarrow" class="ltx_Math" display="inline" id="Sx3.T7.5.5.5.5.m1.1"><semantics id="Sx3.T7.5.5.5.5.m1.1a"><mo id="Sx3.T7.5.5.5.5.m1.1.1" stretchy="false" xref="Sx3.T7.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Sx3.T7.5.5.5.5.m1.1b"><ci id="Sx3.T7.5.5.5.5.m1.1.1.cmml" xref="Sx3.T7.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.T7.5.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.T7.5.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.6.1" rowspan="4"><span class="ltx_text" id="Sx3.T7.5.5.6.1.1">high level features proportion</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.6.2">25%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.6.3"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.6.3.1">26.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.6.4"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.6.4.1">0.7946</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.6.5"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.6.5.1">0.2395</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.6.6"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.6.6.1">0.7366</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T7.5.5.6.7"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.6.7.1">0.4455</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.7.1">50%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.7.2">26.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.7.3">0.7792</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.7.4">0.2577</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.7.5">0.5287</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.7.6">0.7180</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.8.1">75%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.8.2">26.39</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.8.3">0.7767</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.8.4">0.2586</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.8.5">0.3016</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.8.6">1.2622</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.9.1">100%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.9.2">26.07</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.9.3">0.7604</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.9.4">0.2675</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.9.5">0.1982</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.9.6">1.7481</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.10.1" rowspan="5"><span class="ltx_text" id="Sx3.T7.5.5.10.1.1">semantic loss</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.10.2">cosface <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib25" title="">2018</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.10.3">26.78</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.10.4">0.7946</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.10.5">0.2395</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.10.6"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.10.6.1">0.7366</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T7.5.5.10.7"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.10.7.1">0.4455</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.11.1">l-softmax <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib16" title="">2017b</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.11.2">27.19</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.11.3">0.8017</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.11.4">0.2285</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.11.5">0.6743</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.11.6">1.2727</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.12.1">softtriple <cite class="ltx_cite ltx_citemacro_citep">(Qian et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib20" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.12.2">26.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.12.3">0.7952</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.12.4">0.2277</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.12.5">0.3050</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.12.6">1.1998</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.13.1">sphereface <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib16" title="">2017b</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.13.2">27.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.13.3">0.8022</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.13.4">0.2288</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.13.5">0.3381</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.13.6">1.5128</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.14.1">cl <cite class="ltx_cite ltx_citemacro_citep">(Movshovitz-Attias et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib17" title="">2017</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.14.2"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.14.2.1">27.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.14.3"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.14.3.1">0.8105</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.14.4"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.14.4.1">0.2208</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.14.5">-0.0528</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.14.6">4.2540</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.15">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.15.1" rowspan="5"><span class="ltx_text" id="Sx3.T7.5.5.15.1.1">aggregation method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.15.2">concat</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.15.3"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.15.3.1">26.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.15.4"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.15.4.1">0.7946</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.15.5"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.15.5.1">0.2395</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.15.6"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.15.6.1">0.7366</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T7.5.5.15.7"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.15.7.1">0.4455</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.16">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.16.1">add</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.16.2">26.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.16.3">0.7571</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.16.4">0.2670</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.16.5">0.3880</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.16.6">0.9786</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.17.1">lowest-level</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.17.2">26.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.17.3">0.7657</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.17.4">0.2594</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.17.5">0.6994</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.17.6">0.5336</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.18">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.18.1">highest-level</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.18.2">26.14</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.18.3">0.7613</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.18.4">0.2585</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.18.5">0.1927</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.18.6">1.6848</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.19">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.19.1">cross-attention</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.19.2">25.98</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.19.3">0.7537</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.19.4">0.2690</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.19.5">0.1792</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.19.6">1.7009</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.20">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="Sx3.T7.5.5.20.1" rowspan="3"><span class="ltx_text" id="Sx3.T7.5.5.20.1.1">codebook dimension</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.20.2">32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.20.3"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.20.3.1">26.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.20.4"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.20.4.1">0.7946</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.20.5"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.20.5.1">0.2395</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx3.T7.5.5.20.6"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.20.6.1">0.7366</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx3.T7.5.5.20.7"><span class="ltx_text ltx_font_bold" id="Sx3.T7.5.5.20.7.1">0.4455</span></td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.21">
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.21.1">64</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.21.2">26.05</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.21.3">0.7608</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.21.4">0.2728</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx3.T7.5.5.21.5">0.4692</td>
<td class="ltx_td ltx_align_center" id="Sx3.T7.5.5.21.6">0.8417</td>
</tr>
<tr class="ltx_tr" id="Sx3.T7.5.5.22">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T7.5.5.22.1">256</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T7.5.5.22.2">26.27</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T7.5.5.22.3">0.7694</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T7.5.5.22.4">0.2589</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx3.T7.5.5.22.5">0.5045</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx3.T7.5.5.22.6">0.8249</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Ablation experiments on the validation splits of Nuscenes.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="Sx3.SSx2">
<h3 class="ltx_title ltx_title_subsection">Degree of Semantization</h3>
<div class="ltx_para" id="Sx3.SSx2.p1">
<p class="ltx_p" id="Sx3.SSx2.p1.1">The richness of semantic information in the codebook can be reflected by clustering quality, as smaller distances between vectors indicate closer semantic similarity. SS and DBI metrics in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T2" title="Table 2 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">2</span></a> and the visualization of the codebook in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.F4" title="Figure 4 ‣ Consistent Semantic Learning ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">4</span></a> show that our model exhibits <span class="ltx_text ltx_font_bold" id="Sx3.SSx2.p1.1.1">superior performance in clustering quality</span>, generating more semantically meaningful representations. Additionally, as demonstrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx2.F3" title="Figure 3 ‣ Consistent Semantic Learning ‣ Method ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">3</span></a>, our approach constructs a spatiotemporally consistent semantic codebook, successfully preserving the semantics of even small, distant objects. Our semantic tokens remain consistent across various images. Furthermore, based on Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx1.F1" title="Figure 1 ‣ Introduction ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">1</span></a>, our method achieves <span class="ltx_text ltx_font_bold" id="Sx3.SSx2.p1.1.2">the most balanced token semantics</span> while other methods lack specific semantic tokens, such as those representing human and vehicles, which are crucial for generating real-world scenarios. In addition, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T1" title="Table 1 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">1</span></a>, We effectively avoiding the ambiguous use of a single entry with entirely different semantics, <span class="ltx_text ltx_font_bold" id="Sx3.SSx2.p1.1.3">maximizing semantic uniqueness</span>. Finally, our method achieves a codebook with 100% activated tokens and rich semantic information, which improves performance on downstream tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx3">
<h3 class="ltx_title ltx_title_subsection">Unconditional Image Generation</h3>
<section class="ltx_paragraph" id="Sx3.SSx3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Network structures and implementation details</h4>
<div class="ltx_para" id="Sx3.SSx3.SSS0.Px1.p1">
<p class="ltx_p" id="Sx3.SSx3.SSS0.Px1.p1.1">After embedding images as a sequence, a transformer is implemented to estimate the underlying prior distribution in the second stage. The network architecture is built upon the VQGAN baseline.</p>
</div>
<div class="ltx_para" id="Sx3.SSx3.SSS0.Px1.p2">
<p class="ltx_p" id="Sx3.SSx3.SSS0.Px1.p2.1">We can see from Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T3" title="Table 3 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">3</span></a> that compared with CVQ-VAE<cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite> and VQGAN, our method has the smallest fid value both in ImageNet and Nuscenes Dataset, showing that semantic guidance is beneficial to improving the effect of downstream tasks. As Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.F6" title="Figure 6 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">6</span></a> shows, our model achieves the highest image fidelity in terms of vehicles, zebra crossing, and trees.</p>
</div>
</section>
<section class="ltx_paragraph" id="Sx3.SSx3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">High Resolution Image Generation</h4>
<div class="ltx_para" id="Sx3.SSx3.SSS0.Px2.p1">
<p class="ltx_p" id="Sx3.SSx3.SSS0.Px2.p1.1">The semantic-enhanced codebook facilitates the generation of high-resolution images. In this work, we produce high-resolution images starts from a single initial condition token in complex real-world scenarios , achieving resolutions up to 1024 <math alttext="\times" class="ltx_Math" display="inline" id="Sx3.SSx3.SSS0.Px2.p1.1.m1.1"><semantics id="Sx3.SSx3.SSS0.Px2.p1.1.m1.1a"><mo id="Sx3.SSx3.SSS0.Px2.p1.1.m1.1.1" xref="Sx3.SSx3.SSS0.Px2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSS0.Px2.p1.1.m1.1b"><times id="Sx3.SSx3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="Sx3.SSx3.SSS0.Px2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSS0.Px2.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.SSS0.Px2.p1.1.m1.1d">×</annotation></semantics></math> 576 pixels and showcasing intricate details and vivid clarity, as Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.F7" title="Figure 7 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">7</span></a> shows.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="Sx3.SSx4">
<h3 class="ltx_title ltx_title_subsection">Video Generation</h3>
<section class="ltx_paragraph" id="Sx3.SSx4.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Network structures and implementation details</h4>
<div class="ltx_para" id="Sx3.SSx4.SSS0.Px1.p1">
<p class="ltx_p" id="Sx3.SSx4.SSS0.Px1.p1.1">We employ an autoregressive transformer network to model the sequential input. Given the tokens from the past eight frames, our objective is to predict the next image token in the sequence. During the inference stage, we utilize the KV cache of all previous tokens to predict subsequent tokens. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.F5" title="Figure 5 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">5</span></a>, our method achieves consistent video prediction both temporally and spatially, leveraging a semantically enhanced codebook. As seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T3" title="Table 3 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">3</span></a>, our approach outperforms CVQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zheng and Vedaldi <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib31" title="">2023</a>)</cite> and VQGAN on the Nuscenes dataset, yielding the lowest FVD value. This demonstrates that the semantically enhanced codebook provides significant benefits for downstream tasks such as video generation.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="Sx3.SSx5">
<h3 class="ltx_title ltx_title_subsection">Image Reconstruction</h3>
<div class="ltx_para" id="Sx3.SSx5.p1">
<p class="ltx_p" id="Sx3.SSx5.p1.1">Our model demonstrates strong performance on both COCO and ImageNet datasets. As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T4" title="Table 4 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">4</span></a>, our PSNR surpasses CVQ-VAE’s on both datasets, and our SSIM also outperforms CVQ-VAE’s on ImageNet dataset. In all, our method achieves the competitive reconstruction results while enhancing semantics representation comparable to the latest approaches, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.F8" title="Figure 8 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">8</span></a> shows the comparison of images reconstructed by different models. We also validated the effectiveness of our approach in cross-domain image reconstruction by using a model trained on ImageNet-S-919<cite class="ltx_cite ltx_citemacro_citep">(Gao et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#bib.bib6" title="">2022</a>)</cite> and testing it on the COCO dataset. As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T5" title="Table 5 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">5</span></a>, our method achieved the best reconstruction performance, highlighting the effectiveness of the semantically enhanced codebook in generating meaningful representations.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx6">
<h3 class="ltx_title ltx_title_subsection">Ablation Experiments</h3>
<div class="ltx_para" id="Sx3.SSx6.p1">
<p class="ltx_p" id="Sx3.SSx6.p1.1">We conducted ablation experiments on <span class="ltx_text ltx_font_bold" id="Sx3.SSx6.p1.1.1">the proportion of high level features</span>, <span class="ltx_text ltx_font_bold" id="Sx3.SSx6.p1.1.2">aggregation method</span> of low-level features and high-level features, the types of <span class="ltx_text ltx_font_bold" id="Sx3.SSx6.p1.1.3">semantic loss</span>, <span class="ltx_text ltx_font_bold" id="Sx3.SSx6.p1.1.4">codebook dimension</span> and the effectiveness of <span class="ltx_text ltx_font_bold" id="Sx3.SSx6.p1.1.5">MFL</span>. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.F9" title="Figure 9 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">9</span></a>, our approach incorporating MFL enhances reconstruction quality.</p>
</div>
<div class="ltx_para" id="Sx3.SSx6.p2">
<p class="ltx_p" id="Sx3.SSx6.p2.1">Furthermore, as indicated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T6" title="Table 6 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">6</span></a>, our MFL method demonstrates improved performance, underscoring its effectiveness. In Addition, Based on the Table <a class="ltx_ref" href="https://arxiv.org/html/2409.06105v1#Sx3.T7" title="Table 7 ‣ Experimental Details ‣ Experiments ‣ SGC-VQGAN: Towards Complex Scene Representation via Semantic Guided Clustering Codebook"><span class="ltx_text ltx_ref_tag">7</span></a>, we recommend using CosFace as the semantic loss function, employing concatenation as the aggregation method, maintaining the codebook dimension at 32, and setting the proportion of high-level features to 25% (N = 4, <math alttext="\sigma" class="ltx_Math" display="inline" id="Sx3.SSx6.p2.1.m1.1"><semantics id="Sx3.SSx6.p2.1.m1.1a"><mi id="Sx3.SSx6.p2.1.m1.1.1" xref="Sx3.SSx6.p2.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p2.1.m1.1b"><ci id="Sx3.SSx6.p2.1.m1.1.1.cmml" xref="Sx3.SSx6.p2.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p2.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx6.p2.1.m1.1d">italic_σ</annotation></semantics></math> = 0.5).</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx4">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>
<div class="ltx_para" id="Sx4.p1">
<p class="ltx_p" id="Sx4.p1.1">We introduce a Semantic Online Clustering method to enhance token semantics through Consistent Semantic Learning, eliminating the need for highly accurate annotations. Utilizing segmentation model inference results, our approach constructs a temporospatially consistent semantic codebook, addressing issues of codebook collapse and imbalanced token semantics, thus improving performance in various tasks using VQ as a prior model. Our proposed Pyramid Feature Learning pipeline integrates multi-level features to capture both image details and semantics simultaneously. Its simplicity, with no additional parameter learning required, allows for direct application in downstream tasks, offering significant potential.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aaron van den Oord (2017)</span>
<span class="ltx_bibblock">
Aaron van den Oord, K. K., Oriol Vinyals. 2017.

</span>
<span class="ltx_bibblock">Neural Discrete Representation Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in neural information processing systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caesar et al. (2020)</span>
<span class="ltx_bibblock">
Caesar, H.; Bankiti, V.; Lang, A. H.; Vora, S.; Liong, V. E.; Xu, Q.; Krishnan, A.; Pan, Y.; Baldan, G.; and Beijbom, O. 2020.

</span>
<span class="ltx_bibblock">nuscenes: A multimodal dataset for autonomous driving.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 11621–11631.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Davies and Bouldin (1979)</span>
<span class="ltx_bibblock">
Davies, D. L.; and Bouldin, D. W. 1979.

</span>
<span class="ltx_bibblock">A cluster separation measure.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IEEE transactions on pattern analysis and machine intelligence</em>, (2): 224–227.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2009)</span>
<span class="ltx_bibblock">
Deng, J.; Dong, W.; Socher, R.; Li, L.-J.; Li, K.; and Fei-Fei, L. 2009.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">2009 IEEE conference on computer vision and pattern recognition</em>, 248–255. Ieee.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dou et al. (2019)</span>
<span class="ltx_bibblock">
Dou, Q.; Coelho de Castro, D.; Kamnitsas, K.; and Glocker, B. 2019.

</span>
<span class="ltx_bibblock">Domain generalization via model-agnostic learning of semantic features.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in neural information processing systems</em>, 32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2022)</span>
<span class="ltx_bibblock">
Gao, S.; Li, Z.-Y.; Yang, M.-H.; Cheng, M.-M.; Han, J.; and Torr, P. 2022.

</span>
<span class="ltx_bibblock">Large-scale unsupervised semantic segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">IEEE transactions on pattern analysis and machine intelligence</em>, 45(6): 7457–7476.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han, Vedaldi, and Zisserman (2019)</span>
<span class="ltx_bibblock">
Han, K.; Vedaldi, A.; and Zisserman, A. 2019.

</span>
<span class="ltx_bibblock">Learning to discover novel visual categories via deep transfer clustering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 8401–8409.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heusel et al. (2017)</span>
<span class="ltx_bibblock">
Heusel, M.; Ramsauer, H.; Unterthiner, T.; Nessler, B.; and Hochreiter, S. 2017.

</span>
<span class="ltx_bibblock">Gans trained by a two time-scale update rule converge to a local nash equilibrium.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2023)</span>
<span class="ltx_bibblock">
Hu, A.; Russell, L.; Yeo, H.; Murez, Z.; Fedoseev, G.; Kendall, A.; Shotton, J.; and Corrado, G. 2023.

</span>
<span class="ltx_bibblock">GAIA-1: A Generative World Model for Autonomous Driving.

</span>
<span class="ltx_bibblock">arXiv:2309.17080.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky, Hinton et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A.; Hinton, G.; et al. 2009.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1998)</span>
<span class="ltx_bibblock">
LeCun, Y.; Bottou, L.; Bengio, Y.; and Haffner, P. 1998.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the IEEE</em>, 86(11): 2278–2324.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2022)</span>
<span class="ltx_bibblock">
Lee, D.; Kim, C.; Kim, S.; Cho, M.; and Han, W.-S. 2022.

</span>
<span class="ltx_bibblock">Autoregressive image generation using residual quantization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 11523–11532.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Li, G.; Kang, G.; Zhu, Y.; Wei, Y.; and Yang, Y. 2021.

</span>
<span class="ltx_bibblock">Domain consensus clustering for universal domain adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 9757–9766.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2014)</span>
<span class="ltx_bibblock">
Lin, T.-Y.; Maire, M.; Belongie, S.; Hays, J.; Perona, P.; Ramanan, D.; Dollár, P.; and Zitnick, C. L. 2014.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Computer Vision–ECCV 2014: 13th European Conference, Zurich, Switzerland, September 6-12, 2014, Proceedings, Part V 13</em>, 740–755. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2017a)</span>
<span class="ltx_bibblock">
Liu, W.; Wen, Y.; Yu, Z.; Li, M.; Raj, B.; and Song, L. 2017a.

</span>
<span class="ltx_bibblock">Sphereface: Deep hypersphere embedding for face recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 212–220.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2017b)</span>
<span class="ltx_bibblock">
Liu, W.; Wen, Y.; Yu, Z.; and Yang, M. 2017b.

</span>
<span class="ltx_bibblock">Large-Margin Softmax Loss for Convolutional Neural Networks.

</span>
<span class="ltx_bibblock">arXiv:1612.02295.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Movshovitz-Attias et al. (2017)</span>
<span class="ltx_bibblock">
Movshovitz-Attias, Y.; Toshev, A.; Leung, T. K.; Ioffe, S.; and Singh, S. 2017.

</span>
<span class="ltx_bibblock">No fuss distance metric learning using proxies.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the IEEE international conference on computer vision</em>, 360–368.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oquab et al. (2024)</span>
<span class="ltx_bibblock">
Oquab, M.; Darcet, T.; Moutakanni, T.; Vo, H.; Szafraniec, M.; Khalidov, V.; Fernandez, P.; Haziza, D.; Massa, F.; El-Nouby, A.; Assran, M.; Ballas, N.; Galuba, W.; Howes, R.; Huang, P.-Y.; Li, S.-W.; Misra, I.; Rabbat, M.; Sharma, V.; Synnaeve, G.; Xu, H.; Jegou, H.; Mairal, J.; Labatut, P.; Joulin, A.; and Bojanowski, P. 2024.

</span>
<span class="ltx_bibblock">DINOv2: Learning Robust Visual Features without Supervision.

</span>
<span class="ltx_bibblock">arXiv:2304.07193.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patrick Esser (2021)</span>
<span class="ltx_bibblock">
Patrick Esser, B. O., Robin Rombach. 2021.

</span>
<span class="ltx_bibblock">Taming transformers for high-resolution image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al. (2019)</span>
<span class="ltx_bibblock">
Qian, Q.; Shang, L.; Sun, B.; Hu, J.; Li, H.; and Jin, R. 2019.

</span>
<span class="ltx_bibblock">Softtriple loss: Deep metric learning without triplet sampling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 6450–6458.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al. (2023)</span>
<span class="ltx_bibblock">
Qu, S.; Zou, T.; Röhrbein, F.; Lu, C.; Chen, G.; Tao, D.; and Jiang, C. 2023.

</span>
<span class="ltx_bibblock">Upcycling models under domain and category shift.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 20019–20028.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rousseeuw (1987)</span>
<span class="ltx_bibblock">
Rousseeuw, P. J. 1987.

</span>
<span class="ltx_bibblock">Silhouettes: a graphical aid to the interpretation and validation of cluster analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Journal of computational and applied mathematics</em>, 20: 53–65.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2024)</span>
<span class="ltx_bibblock">
Tian, K.; Jiang, Y.; Yuan, Z.; Peng, B.; and Wang, L. 2024.

</span>
<span class="ltx_bibblock">Visual Autoregressive Modeling: Scalable Image Generation via Next-Scale Prediction.

</span>
<span class="ltx_bibblock">arXiv:2404.02905.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Unterthiner et al. (2019)</span>
<span class="ltx_bibblock">
Unterthiner, T.; van Steenkiste, S.; Kurach, K.; Marinier, R.; Michalski, M.; and Gelly, S. 2019.

</span>
<span class="ltx_bibblock">FVD: A new metric for video generation.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Wang, H.; Wang, Y.; Zhou, Z.; Ji, X.; Gong, D.; Zhou, J.; Li, Z.; and Liu, W. 2018.

</span>
<span class="ltx_bibblock">Cosface: Large margin cosine loss for deep face recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 5265–5274.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Wang, X.; Zhu, Z.; Huang, G.; Wang, B.; Chen, X.; and Lu, J. 2024.

</span>
<span class="ltx_bibblock">WorldDreamer: Towards General World Models for Video Generation via Predicting Masked Tokens.

</span>
<span class="ltx_bibblock">arXiv:2401.09985.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. (2020)</span>
<span class="ltx_bibblock">
Williams, W.; Ringer, S.; Ash, T.; MacLeod, D.; Dougherty, J.; and Hughes, J. 2020.

</span>
<span class="ltx_bibblock">Hierarchical quantized autoencoders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in Neural Information Processing Systems</em>, 33: 4524–4535.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2021)</span>
<span class="ltx_bibblock">
Xie, E.; Wang, W.; Yu, Z.; Anandkumar, A.; Alvarez, J. M.; and Luo, P. 2021.

</span>
<span class="ltx_bibblock">SegFormer: Simple and efficient design for semantic segmentation with transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Advances in neural information processing systems</em>, 34: 12077–12090.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022)</span>
<span class="ltx_bibblock">
Yu, J.; Li, X.; Koh, J. Y.; Zhang, H.; Pang, R.; Qin, J.; Ku, A.; Xu, Y.; Baldridge, J.; and Wu, Y. 2022.

</span>
<span class="ltx_bibblock">Vector-quantized Image Modeling with Improved VQGAN.

</span>
<span class="ltx_bibblock">arXiv:2110.04627.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Zhang, R.; Isola, P.; Efros, A. A.; Shechtman, E.; and Wang, O. 2018.

</span>
<span class="ltx_bibblock">The unreasonable effectiveness of deep features as a perceptual metric.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 586–595.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng and Vedaldi (2023)</span>
<span class="ltx_bibblock">
Zheng, C.; and Vedaldi, A. 2023.

</span>
<span class="ltx_bibblock">Online clustered codebook.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 22798–22807.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2022)</span>
<span class="ltx_bibblock">
Zheng, C.; Vuong, T.-L.; Cai, J.; and Phung, D. 2022.

</span>
<span class="ltx_bibblock">Movq: Modulating quantized vectors for high-fidelity image generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in Neural Information Processing Systems</em>, 35: 23412–23425.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep  9 23:07:55 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
