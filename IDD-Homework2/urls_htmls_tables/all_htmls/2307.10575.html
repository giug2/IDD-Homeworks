<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2307.10575] Boosting Federated Learning Convergence with Prototype Regularization</title><meta property="og:description" content="As a distributed machine learning technique, federated learning (FL) requires clients to collaboratively train a shared model with an edge server without leaking their local data. However, the heterogeneous data distri…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Boosting Federated Learning Convergence with Prototype Regularization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Boosting Federated Learning Convergence with Prototype Regularization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2307.10575">

<!--Generated on Wed Feb 28 17:26:47 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_pruned_first">
<h1 class="ltx_title ltx_title_document" style="font-size:144%;"><span id="id1.id1" class="ltx_text ltx_font_bold">Boosting Federated Learning Convergence with Prototype Regularization</span></h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yu Qiao<sup id="id2.1.id1" class="ltx_sup">1</sup>, Huy Q. Le<sup id="id3.2.id2" class="ltx_sup">2</sup> and Choong Seon Hong<sup id="id4.3.id3" class="ltx_sup">2</sup>*
<sup id="id5.4.id4" class="ltx_sup">1</sup>
<span id="id6.5.id5" class="ltx_text ltx_font_italic">Department of Artificial Intelligence, Kyung Hee University, Yongin-si 17104, Republic of Korea
<br class="ltx_break"><sup id="id6.5.id5.1" class="ltx_sup"><span id="id6.5.id5.1.1" class="ltx_text ltx_font_upright">2</span></sup></span>
<span id="id7.6.id6" class="ltx_text ltx_font_italic">Department of Computer Science and Engineering, Kyung Hee University, Yongin-si 17104, Republic of Korea
<br class="ltx_break"></span>Email: {qiaoyu, quanghuy69, cshong}@khu.ac.kr
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">As a distributed machine learning technique, federated learning (FL) requires clients to collaboratively train a shared model with an edge server without leaking their local data. However, the heterogeneous data distribution among clients often leads to a decrease in model performance. To tackle this issue, this paper introduces a prototype-based regularization strategy to address the heterogeneity in the data distribution. Specifically, the regularization process involves the server aggregating local prototypes from distributed clients to generate a global prototype, which is then sent back to the individual clients to guide their local training. The experimental results on MNIST and Fashion-MNIST show that our proposal achieves improvements of 3.3% and 8.9% in average test accuracy, respectively, compared to the most popular baseline FedAvg. Furthermore, our approach has a fast convergence rate in heterogeneous settings.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Over the past decade, significant progress has been made in deep learning, giving rise to a succession of impressive advancements in both large language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and large vision models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Concurrently, there has been an explosive growth of intelligent devices in distributed networks, generating a massive amount of raw data that requires processing. To address this situation, a powerful distributed machine learning paradigm called federated learning (FL) has been introduced.
FL is a powerful distributed machine learning paradigm that enables edge clients and servers to collaboratively train models without compromising the privacy of the underlying data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. However, the data distribution of clients in federated scenarios is usually not Independent and Identically Distributed (non-IID), which can result in poor model performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. There have been some studies exploring how to enhance the performance of FL in non-IID settings. FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is the first optimization algorithm designed to address the challenge of data heterogeneity in federated scenarios. MPFed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> proposes a framework for addressing non-IID challenges in federated learning. The authors utilize a multi-prototype approach, where clients and the server adopt a typical FL approach for training, and model inference is based on the distance between local representations and the target prototype. CDFed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> proposes a dynamic federated learning paradigm based on Sharpley-value, where each client calculates its contribution to the global model in each iteration, thereby determining the probability of being selected for the next global iteration. Although effective, both of these strategies have high algorithmic complexity, which may pose difficulties in practical deployment. Furthermore, recent works in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> propose a prototype-based model inference strategy, which is claimed to achieve faster convergence than the baseline FedAvg. However, they only adopted a prototype-based approach for model inference without modifying the federated learning process, which may not fully leverage the potential of prototypes.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In this paper, we propose to use prototype regularization to assist local training of clients, which makes better use of the prototype knowledge shared by each client. A prototype is a vector representation of a class space, and learning different prototype representations from clients can provide global information about the class space. Specifically, in each global iteration, the server aggregates the prototypes from all clients as the global prototype and transmits it along with the updated model parameters to the clients to assist them in their next local training. The main contributions can be summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Our proposed federated training framework is based on prototypes, where both prototypes and model parameters are simultaneously optimized and updated in each iteration.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a prototype-based regularization strategy, in which clients learn from the global prototype shared by all clients by minimizing the distance between their local representations and the global prototype.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Finally, based on experiments conducted on two widely-used benchmark datasets, MNIST<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and Fashion-MNIST<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, our proposed approach achieves significant improvements in test accuracy by 3.3% and 8.9%, respectively, compared to the most popular baseline method, FedAvg. Moreover, our approach exhibits a faster convergence rate in the heterogeneous setting.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2307.10575/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="207" height="147" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The overview of the proposed FL framework that utilizes prototypes as a key component. In each global rounds, clients not only transmits their model parameters (step. 1 in this figure), but also their prototypes (step. 2) to the server for model averaging (step. 3) and prototype aggregation (step. 4). After the completion of each global round, the averaged model parameters and global prototypes are transmitted to all clients for the next round of training (step. 5).</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Proposed Framework</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Problem Statement</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.7" class="ltx_p">Consider a distributed set of clients <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\phi</annotation></semantics></math> with their private sensitive datasets <math id="S2.SS1.p1.2.m2.2" class="ltx_Math" alttext="\mathcal{D}_{i}={(\boldsymbol{x}_{i},y_{i})}" display="inline"><semantics id="S2.SS1.p1.2.m2.2a"><mrow id="S2.SS1.p1.2.m2.2.2" xref="S2.SS1.p1.2.m2.2.2.cmml"><msub id="S2.SS1.p1.2.m2.2.2.4" xref="S2.SS1.p1.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.2.2.4.2" xref="S2.SS1.p1.2.m2.2.2.4.2.cmml">𝒟</mi><mi id="S2.SS1.p1.2.m2.2.2.4.3" xref="S2.SS1.p1.2.m2.2.2.4.3.cmml">i</mi></msub><mo id="S2.SS1.p1.2.m2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S2.SS1.p1.2.m2.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p1.2.m2.2.2.2.2.4" xref="S2.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S2.SS1.p1.2.m2.2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.2.2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.2.m2.2.2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p1.2.m2.2.2.2.2.5" xref="S2.SS1.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.2b"><apply id="S2.SS1.p1.2.m2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2"><eq id="S2.SS1.p1.2.m2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.3"></eq><apply id="S2.SS1.p1.2.m2.2.2.4.cmml" xref="S2.SS1.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.4.1.cmml" xref="S2.SS1.p1.2.m2.2.2.4">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.4.2.cmml" xref="S2.SS1.p1.2.m2.2.2.4.2">𝒟</ci><ci id="S2.SS1.p1.2.m2.2.2.4.3.cmml" xref="S2.SS1.p1.2.m2.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S2.SS1.p1.2.m2.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2"><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2.2">𝑦</ci><ci id="S2.SS1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.2c">\mathcal{D}_{i}={(\boldsymbol{x}_{i},y_{i})}</annotation></semantics></math> of size <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">D</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝐷</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">D_{i}</annotation></semantics></math> in a distributed edge network. In a typical federated learning (FL) training process, clients and the edge server work together to train a shared model <math id="S2.SS1.p1.4.m4.2" class="ltx_Math" alttext="\mathcal{F}(\omega;\boldsymbol{x}_{i})" display="inline"><semantics id="S2.SS1.p1.4.m4.2a"><mrow id="S2.SS1.p1.4.m4.2.2" xref="S2.SS1.p1.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.2.2.3" xref="S2.SS1.p1.4.m4.2.2.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.2.2.2" xref="S2.SS1.p1.4.m4.2.2.2.cmml">​</mo><mrow id="S2.SS1.p1.4.m4.2.2.1.1" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml">(</mo><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">ω</mi><mo id="S2.SS1.p1.4.m4.2.2.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml">;</mo><msub id="S2.SS1.p1.4.m4.2.2.1.1.1" xref="S2.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.4" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.2b"><apply id="S2.SS1.p1.4.m4.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2"><times id="S2.SS1.p1.4.m4.2.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2.2"></times><ci id="S2.SS1.p1.4.m4.2.2.3.cmml" xref="S2.SS1.p1.4.m4.2.2.3">ℱ</ci><list id="S2.SS1.p1.4.m4.2.2.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝜔</ci><apply id="S2.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.2c">\mathcal{F}(\omega;\boldsymbol{x}_{i})</annotation></semantics></math>, where <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\omega</annotation></semantics></math> represents the model parameters of the global model, and <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\boldsymbol{x}_{i}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝒙</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\boldsymbol{x}_{i}</annotation></semantics></math> represents the feature vector of a specific client <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">i</annotation></semantics></math>. The goal is to minimize the loss function across clients with heterogeneous data, as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\mathop{\arg\min}_{\omega}{\mathcal{L}}(\omega)=\sum_{i\in\phi}\frac{D_{i}}{\sum_{i\in\phi}D_{i}}{\mathcal{L}_{i}}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i})," display="block"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.4" xref="S2.E1.m1.3.3.1.1.4.cmml"><munder id="S2.E1.m1.3.3.1.1.4.1" xref="S2.E1.m1.3.3.1.1.4.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.4.1.2" xref="S2.E1.m1.3.3.1.1.4.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.4.1.2.1" xref="S2.E1.m1.3.3.1.1.4.1.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E1.m1.3.3.1.1.4.1.2a" xref="S2.E1.m1.3.3.1.1.4.1.2.cmml">⁡</mo><mi id="S2.E1.m1.3.3.1.1.4.1.2.2" xref="S2.E1.m1.3.3.1.1.4.1.2.2.cmml">min</mi></mrow><mi id="S2.E1.m1.3.3.1.1.4.1.3" xref="S2.E1.m1.3.3.1.1.4.1.3.cmml">ω</mi></munder><mrow id="S2.E1.m1.3.3.1.1.4.2" xref="S2.E1.m1.3.3.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.4.2.2" xref="S2.E1.m1.3.3.1.1.4.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.4.2.1" xref="S2.E1.m1.3.3.1.1.4.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.4.2.3.2" xref="S2.E1.m1.3.3.1.1.4.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.4.2.3.2.1" xref="S2.E1.m1.3.3.1.1.4.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">ω</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.4.2.3.2.2" xref="S2.E1.m1.3.3.1.1.4.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><munder id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.2.3.cmml"><mo movablelimits="false" id="S2.E1.m1.3.3.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.2.3.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.2.3.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.3.3.2" xref="S2.E1.m1.3.3.1.1.2.3.3.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.2.3.3.1" xref="S2.E1.m1.3.3.1.1.2.3.3.1.cmml">∈</mo><mi id="S2.E1.m1.3.3.1.1.2.3.3.3" xref="S2.E1.m1.3.3.1.1.2.3.3.3.cmml">ϕ</mi></mrow></munder><mrow id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mfrac id="S2.E1.m1.3.3.1.1.2.2.4" xref="S2.E1.m1.3.3.1.1.2.2.4.cmml"><msub id="S2.E1.m1.3.3.1.1.2.2.4.2" xref="S2.E1.m1.3.3.1.1.2.2.4.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.4.2.2" xref="S2.E1.m1.3.3.1.1.2.2.4.2.2.cmml">D</mi><mi id="S2.E1.m1.3.3.1.1.2.2.4.2.3" xref="S2.E1.m1.3.3.1.1.2.2.4.2.3.cmml">i</mi></msub><mrow id="S2.E1.m1.3.3.1.1.2.2.4.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.cmml"><msub id="S2.E1.m1.3.3.1.1.2.2.4.3.1" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.cmml"><mo id="S2.E1.m1.3.3.1.1.2.2.4.3.1.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1.cmml">∈</mo><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3.cmml">ϕ</mi></mrow></msub><msub id="S2.E1.m1.3.3.1.1.2.2.4.3.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.2.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.2.cmml">D</mi><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.2.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.3.cmml">i</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">​</mo><msub id="S2.E1.m1.3.3.1.1.2.2.5" xref="S2.E1.m1.3.3.1.1.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.2.2.5.2" xref="S2.E1.m1.3.3.1.1.2.2.5.2.cmml">ℒ</mi><mi id="S2.E1.m1.3.3.1.1.2.2.5.3" xref="S2.E1.m1.3.3.1.1.2.2.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.3a" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">ω</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.2.2.2.2.4" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml">,</mo><msub id="S2.E1.m1.3.3.1.1.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S2.E1.m1.3.3.1.1.2.2.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.2.2.2.5" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"></eq><apply id="S2.E1.m1.3.3.1.1.4.cmml" xref="S2.E1.m1.3.3.1.1.4"><apply id="S2.E1.m1.3.3.1.1.4.1.cmml" xref="S2.E1.m1.3.3.1.1.4.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.4.1.1.cmml" xref="S2.E1.m1.3.3.1.1.4.1">subscript</csymbol><apply id="S2.E1.m1.3.3.1.1.4.1.2.cmml" xref="S2.E1.m1.3.3.1.1.4.1.2"><arg id="S2.E1.m1.3.3.1.1.4.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.4.1.2.1"></arg><min id="S2.E1.m1.3.3.1.1.4.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.4.1.2.2"></min></apply><ci id="S2.E1.m1.3.3.1.1.4.1.3.cmml" xref="S2.E1.m1.3.3.1.1.4.1.3">𝜔</ci></apply><apply id="S2.E1.m1.3.3.1.1.4.2.cmml" xref="S2.E1.m1.3.3.1.1.4.2"><times id="S2.E1.m1.3.3.1.1.4.2.1.cmml" xref="S2.E1.m1.3.3.1.1.4.2.1"></times><ci id="S2.E1.m1.3.3.1.1.4.2.2.cmml" xref="S2.E1.m1.3.3.1.1.4.2.2">ℒ</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝜔</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><apply id="S2.E1.m1.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2"></sum><apply id="S2.E1.m1.3.3.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3"><in id="S2.E1.m1.3.3.1.1.2.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3.1"></in><ci id="S2.E1.m1.3.3.1.1.2.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.2.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"><times id="S2.E1.m1.3.3.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.3"></times><apply id="S2.E1.m1.3.3.1.1.2.2.4.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4"><divide id="S2.E1.m1.3.3.1.1.2.2.4.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4"></divide><apply id="S2.E1.m1.3.3.1.1.2.2.4.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.4.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.4.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2.2">𝐷</ci><ci id="S2.E1.m1.3.3.1.1.2.2.4.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2.3">𝑖</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3"><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.4.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.2.2.4.3.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.2"></sum><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3"><in id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1"></in><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3">italic-ϕ</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.4.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.2">𝐷</ci><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.3">𝑖</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.5.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.5.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.5.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.2">ℒ</ci><ci id="S2.E1.m1.3.3.1.1.2.2.5.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3">𝑖</ci></apply><interval closure="open" id="S2.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2"><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3">ℱ</ci><list id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝜔</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\mathop{\arg\min}_{\omega}{\mathcal{L}}(\omega)=\sum_{i\in\phi}\frac{D_{i}}{\sum_{i\in\phi}D_{i}}{\mathcal{L}_{i}}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.10" class="ltx_p">where <math id="S2.SS1.p1.8.m1.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS1.p1.8.m1.1a"><msub id="S2.SS1.p1.8.m1.1.1" xref="S2.SS1.p1.8.m1.1.1.cmml"><mi id="S2.SS1.p1.8.m1.1.1.2" xref="S2.SS1.p1.8.m1.1.1.2.cmml">y</mi><mi id="S2.SS1.p1.8.m1.1.1.3" xref="S2.SS1.p1.8.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m1.1b"><apply id="S2.SS1.p1.8.m1.1.1.cmml" xref="S2.SS1.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.1.1.1.cmml" xref="S2.SS1.p1.8.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m1.1.1.2.cmml" xref="S2.SS1.p1.8.m1.1.1.2">𝑦</ci><ci id="S2.SS1.p1.8.m1.1.1.3.cmml" xref="S2.SS1.p1.8.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m1.1c">y_{i}</annotation></semantics></math> represents the label of a sample, and <math id="S2.SS1.p1.9.m2.1" class="ltx_Math" alttext="\mathcal{L}_{i}" display="inline"><semantics id="S2.SS1.p1.9.m2.1a"><msub id="S2.SS1.p1.9.m2.1.1" xref="S2.SS1.p1.9.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m2.1.1.2" xref="S2.SS1.p1.9.m2.1.1.2.cmml">ℒ</mi><mi id="S2.SS1.p1.9.m2.1.1.3" xref="S2.SS1.p1.9.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m2.1b"><apply id="S2.SS1.p1.9.m2.1.1.cmml" xref="S2.SS1.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m2.1.1.1.cmml" xref="S2.SS1.p1.9.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m2.1.1.2.cmml" xref="S2.SS1.p1.9.m2.1.1.2">ℒ</ci><ci id="S2.SS1.p1.9.m2.1.1.3.cmml" xref="S2.SS1.p1.9.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m2.1c">\mathcal{L}_{i}</annotation></semantics></math> denotes the cross-entropy loss of client <math id="S2.SS1.p1.10.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.10.m3.1a"><mi id="S2.SS1.p1.10.m3.1.1" xref="S2.SS1.p1.10.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m3.1b"><ci id="S2.SS1.p1.10.m3.1.1.cmml" xref="S2.SS1.p1.10.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m3.1c">i</annotation></semantics></math>, respectively.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Proposed Federated Learning Framework</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The typical federated training process involves distributing the global model to each client for local training, updating the model parameters independently, and aggregating the uploaded latest model parameters at the server before sending them back to the local sides for the next communication round. Our proposed framework follows a similar process, with the addition that in each global round, clients calculate their own prototypes for each class and send them to the server along with the model parameters for aggregation. Finally, the aggregated prototypes and the updated model parameters are sent back to local clients for further training. Figure <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> provides an overview of our proposed framework.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedPR: Federated Prototype Regularization</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>     Dataset <math id="alg1.l0.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="alg1.l0.m1.1a"><msub id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.l0.m1.1.1.3" xref="alg1.l0.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1">subscript</csymbol><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝒟</ci><ci id="alg1.l0.m1.1.1.3.cmml" xref="alg1.l0.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">\mathcal{D}_{i}</annotation></semantics></math>, <math id="alg1.l0.m2.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="alg1.l0.m2.1a"><msub id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml"><mi id="alg1.l0.m2.1.1.2" xref="alg1.l0.m2.1.1.2.cmml">ω</mi><mi id="alg1.l0.m2.1.1.3" xref="alg1.l0.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.cmml" xref="alg1.l0.m2.1.1">subscript</csymbol><ci id="alg1.l0.m2.1.1.2.cmml" xref="alg1.l0.m2.1.1.2">𝜔</ci><ci id="alg1.l0.m2.1.1.3.cmml" xref="alg1.l0.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\omega_{i}</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Model Training:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Initialize <math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="\omega^{0}" display="inline"><semantics id="alg1.l2.1.m1.1a"><msup id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml"><mi id="alg1.l2.1.m1.1.1.2" xref="alg1.l2.1.m1.1.1.2.cmml">ω</mi><mn id="alg1.l2.1.m1.1.1.3" xref="alg1.l2.1.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><apply id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.1.m1.1.1.1.cmml" xref="alg1.l2.1.m1.1.1">superscript</csymbol><ci id="alg1.l2.1.m1.1.1.2.cmml" xref="alg1.l2.1.m1.1.1.2">𝜔</ci><cn type="integer" id="alg1.l2.1.m1.1.1.3.cmml" xref="alg1.l2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\omega^{0}</annotation></semantics></math></span>, <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\{\overline{y}\}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.2.2" xref="alg1.l2.m1.1.2.1.cmml"><mo stretchy="false" id="alg1.l2.m1.1.2.2.1" xref="alg1.l2.m1.1.2.1.cmml">{</mo><mover accent="true" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">y</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="alg1.l2.m1.1.2.2.2" xref="alg1.l2.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><set id="alg1.l2.m1.1.2.1.cmml" xref="alg1.l2.m1.1.2.2"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">¯</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑦</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\{\overline{y}\}</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span>  <math id="alg1.l3.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t</annotation></semantics></math> = 1, 2, …, <math id="alg1.l3.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">T</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span>  <math id="alg1.l4.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i</annotation></semantics></math> = 0, 1,…, <math id="alg1.l4.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">N</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l4.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Local model updates using Eq. (<a href="#S2.E4" title="In II-C3 Local Objective ‣ II-C Prototype-based Model Training ‣ II Proposed Framework ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        Local prototype calculation using Eq. (<a href="#S2.E2" title="In II-C1 Prototype Calculation ‣ II-C Prototype-based Model Training ‣ II Proposed Framework ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>        Global prototype aggregation using Eq. (<a href="#S2.E3" title="In II-C2 Global Prototype Aggregation ‣ II-C Prototype-based Model Training ‣ II Proposed Framework ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <span id="alg1.l10.2" class="ltx_text ltx_font_bold">Model Inference:</span>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>  <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>  each sample <math id="alg1.l11.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l11.m1.1a"><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">i</annotation></semantics></math> in testing dataset <span id="alg1.l11.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     <span id="alg1.l12.2" class="ltx_text ltx_font_bold">for</span>  each class <math id="alg1.l12.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l12.m1.1a"><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">j</annotation></semantics></math> in <math id="alg1.l12.m2.1" class="ltx_Math" alttext="\{\overline{y}\}" display="inline"><semantics id="alg1.l12.m2.1a"><mrow id="alg1.l12.m2.1.2.2" xref="alg1.l12.m2.1.2.1.cmml"><mo stretchy="false" id="alg1.l12.m2.1.2.2.1" xref="alg1.l12.m2.1.2.1.cmml">{</mo><mover accent="true" id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mi id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml">y</mi><mo id="alg1.l12.m2.1.1.1" xref="alg1.l12.m2.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="alg1.l12.m2.1.2.2.2" xref="alg1.l12.m2.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><set id="alg1.l12.m2.1.2.1.cmml" xref="alg1.l12.m2.1.2.2"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><ci id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1.1">¯</ci><ci id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2">𝑦</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\{\overline{y}\}</annotation></semantics></math> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        Calculate the <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="alg1.l13.m1.1a"><msub id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">ℓ</mi><mn id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">ℓ</ci><cn type="integer" id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\ell_{2}</annotation></semantics></math> distance between <math id="alg1.l13.m2.2" class="ltx_Math" alttext="f_{e}(\omega_{e};\boldsymbol{x}_{i})" display="inline"><semantics id="alg1.l13.m2.2a"><mrow id="alg1.l13.m2.2.2" xref="alg1.l13.m2.2.2.cmml"><msub id="alg1.l13.m2.2.2.4" xref="alg1.l13.m2.2.2.4.cmml"><mi id="alg1.l13.m2.2.2.4.2" xref="alg1.l13.m2.2.2.4.2.cmml">f</mi><mi id="alg1.l13.m2.2.2.4.3" xref="alg1.l13.m2.2.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l13.m2.2.2.3" xref="alg1.l13.m2.2.2.3.cmml">​</mo><mrow id="alg1.l13.m2.2.2.2.2" xref="alg1.l13.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l13.m2.2.2.2.2.3" xref="alg1.l13.m2.2.2.2.3.cmml">(</mo><msub id="alg1.l13.m2.1.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.1.cmml"><mi id="alg1.l13.m2.1.1.1.1.1.2" xref="alg1.l13.m2.1.1.1.1.1.2.cmml">ω</mi><mi id="alg1.l13.m2.1.1.1.1.1.3" xref="alg1.l13.m2.1.1.1.1.1.3.cmml">e</mi></msub><mo id="alg1.l13.m2.2.2.2.2.4" xref="alg1.l13.m2.2.2.2.3.cmml">;</mo><msub id="alg1.l13.m2.2.2.2.2.2" xref="alg1.l13.m2.2.2.2.2.2.cmml"><mi id="alg1.l13.m2.2.2.2.2.2.2" xref="alg1.l13.m2.2.2.2.2.2.2.cmml">𝒙</mi><mi id="alg1.l13.m2.2.2.2.2.2.3" xref="alg1.l13.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l13.m2.2.2.2.2.5" xref="alg1.l13.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.2b"><apply id="alg1.l13.m2.2.2.cmml" xref="alg1.l13.m2.2.2"><times id="alg1.l13.m2.2.2.3.cmml" xref="alg1.l13.m2.2.2.3"></times><apply id="alg1.l13.m2.2.2.4.cmml" xref="alg1.l13.m2.2.2.4"><csymbol cd="ambiguous" id="alg1.l13.m2.2.2.4.1.cmml" xref="alg1.l13.m2.2.2.4">subscript</csymbol><ci id="alg1.l13.m2.2.2.4.2.cmml" xref="alg1.l13.m2.2.2.4.2">𝑓</ci><ci id="alg1.l13.m2.2.2.4.3.cmml" xref="alg1.l13.m2.2.2.4.3">𝑒</ci></apply><list id="alg1.l13.m2.2.2.2.3.cmml" xref="alg1.l13.m2.2.2.2.2"><apply id="alg1.l13.m2.1.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m2.1.1.1.1.1.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.2">𝜔</ci><ci id="alg1.l13.m2.1.1.1.1.1.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.3">𝑒</ci></apply><apply id="alg1.l13.m2.2.2.2.2.2.cmml" xref="alg1.l13.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m2.2.2.2.2.2.1.cmml" xref="alg1.l13.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m2.2.2.2.2.2.2.cmml" xref="alg1.l13.m2.2.2.2.2.2.2">𝒙</ci><ci id="alg1.l13.m2.2.2.2.2.2.3.cmml" xref="alg1.l13.m2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.2c">f_{e}(\omega_{e};\boldsymbol{x}_{i})</annotation></semantics></math>
and <math id="alg1.l13.m3.1" class="ltx_Math" alttext="\overline{y}_{j}" display="inline"><semantics id="alg1.l13.m3.1a"><msub id="alg1.l13.m3.1.1" xref="alg1.l13.m3.1.1.cmml"><mover accent="true" id="alg1.l13.m3.1.1.2" xref="alg1.l13.m3.1.1.2.cmml"><mi id="alg1.l13.m3.1.1.2.2" xref="alg1.l13.m3.1.1.2.2.cmml">y</mi><mo id="alg1.l13.m3.1.1.2.1" xref="alg1.l13.m3.1.1.2.1.cmml">¯</mo></mover><mi id="alg1.l13.m3.1.1.3" xref="alg1.l13.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.m3.1b"><apply id="alg1.l13.m3.1.1.cmml" xref="alg1.l13.m3.1.1"><csymbol cd="ambiguous" id="alg1.l13.m3.1.1.1.cmml" xref="alg1.l13.m3.1.1">subscript</csymbol><apply id="alg1.l13.m3.1.1.2.cmml" xref="alg1.l13.m3.1.1.2"><ci id="alg1.l13.m3.1.1.2.1.cmml" xref="alg1.l13.m3.1.1.2.1">¯</ci><ci id="alg1.l13.m3.1.1.2.2.cmml" xref="alg1.l13.m3.1.1.2.2">𝑦</ci></apply><ci id="alg1.l13.m3.1.1.3.cmml" xref="alg1.l13.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m3.1c">\overline{y}_{j}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="alg1.l14.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     Make final predictions based on the smallest distance

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Prototype-based Model Training</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.2" class="ltx_p">In a typical deep learning model, there are two components: a feature extraction layer denoted by <math id="S2.SS3.p1.1.m1.2" class="ltx_Math" alttext="f_{e}(\omega_{e};\boldsymbol{x})" display="inline"><semantics id="S2.SS3.p1.1.m1.2a"><mrow id="S2.SS3.p1.1.m1.2.2" xref="S2.SS3.p1.1.m1.2.2.cmml"><msub id="S2.SS3.p1.1.m1.2.2.3" xref="S2.SS3.p1.1.m1.2.2.3.cmml"><mi id="S2.SS3.p1.1.m1.2.2.3.2" xref="S2.SS3.p1.1.m1.2.2.3.2.cmml">f</mi><mi id="S2.SS3.p1.1.m1.2.2.3.3" xref="S2.SS3.p1.1.m1.2.2.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.1.m1.2.2.2" xref="S2.SS3.p1.1.m1.2.2.2.cmml">​</mo><mrow id="S2.SS3.p1.1.m1.2.2.1.1" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.1.m1.2.2.1.1.2" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml">(</mo><msub id="S2.SS3.p1.1.m1.2.2.1.1.1" xref="S2.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.2" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.3" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS3.p1.1.m1.2.2.1.1.3" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml">;</mo><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.SS3.p1.1.m1.2.2.1.1.4" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.2b"><apply id="S2.SS3.p1.1.m1.2.2.cmml" xref="S2.SS3.p1.1.m1.2.2"><times id="S2.SS3.p1.1.m1.2.2.2.cmml" xref="S2.SS3.p1.1.m1.2.2.2"></times><apply id="S2.SS3.p1.1.m1.2.2.3.cmml" xref="S2.SS3.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.2.2.3.1.cmml" xref="S2.SS3.p1.1.m1.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.1.m1.2.2.3.2.cmml" xref="S2.SS3.p1.1.m1.2.2.3.2">𝑓</ci><ci id="S2.SS3.p1.1.m1.2.2.3.3.cmml" xref="S2.SS3.p1.1.m1.2.2.3.3">𝑒</ci></apply><list id="S2.SS3.p1.1.m1.2.2.1.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1"><apply id="S2.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2">𝜔</ci><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3">𝑒</ci></apply><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝒙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.2c">f_{e}(\omega_{e};\boldsymbol{x})</annotation></semantics></math>, and a decision-making layer denoted by <math id="S2.SS3.p1.2.m2.2" class="ltx_Math" alttext="f_{d}(\omega_{d};y)" display="inline"><semantics id="S2.SS3.p1.2.m2.2a"><mrow id="S2.SS3.p1.2.m2.2.2" xref="S2.SS3.p1.2.m2.2.2.cmml"><msub id="S2.SS3.p1.2.m2.2.2.3" xref="S2.SS3.p1.2.m2.2.2.3.cmml"><mi id="S2.SS3.p1.2.m2.2.2.3.2" xref="S2.SS3.p1.2.m2.2.2.3.2.cmml">f</mi><mi id="S2.SS3.p1.2.m2.2.2.3.3" xref="S2.SS3.p1.2.m2.2.2.3.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.2.m2.2.2.2" xref="S2.SS3.p1.2.m2.2.2.2.cmml">​</mo><mrow id="S2.SS3.p1.2.m2.2.2.1.1" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.2.m2.2.2.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">(</mo><msub id="S2.SS3.p1.2.m2.2.2.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.3" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml">d</mi></msub><mo id="S2.SS3.p1.2.m2.2.2.1.1.3" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">;</mo><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">y</mi><mo stretchy="false" id="S2.SS3.p1.2.m2.2.2.1.1.4" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.2b"><apply id="S2.SS3.p1.2.m2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2"><times id="S2.SS3.p1.2.m2.2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2.2"></times><apply id="S2.SS3.p1.2.m2.2.2.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.2.2.3.1.cmml" xref="S2.SS3.p1.2.m2.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.2.m2.2.2.3.2.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2">𝑓</ci><ci id="S2.SS3.p1.2.m2.2.2.3.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3.3">𝑑</ci></apply><list id="S2.SS3.p1.2.m2.2.2.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1"><apply id="S2.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2">𝜔</ci><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3">𝑑</ci></apply><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.2c">f_{d}(\omega_{d};y)</annotation></semantics></math>. The feature extraction layer is designed to extract features from the input data, and the decision-making layer is responsible for utilizing these extracted features to make predictions or classifications.</p>
</div>
<section id="S2.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS1.4.1.1" class="ltx_text">II-C</span>1 </span>Prototype Calculation</h4>

<div id="S2.SS3.SSS1.p1" class="ltx_para">
<p id="S2.SS3.SSS1.p1.2" class="ltx_p">According to the prototype definition proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, the prototype corresponding to the <math id="S2.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.SSS1.p1.1.m1.1a"><mi id="S2.SS3.SSS1.p1.1.m1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.1.m1.1b"><ci id="S2.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.1.m1.1c">j</annotation></semantics></math>-th class of client <math id="S2.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.SSS1.p1.2.m2.1a"><mi id="S2.SS3.SSS1.p1.2.m2.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.2.m2.1b"><ci id="S2.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.2.m2.1c">i</annotation></semantics></math>-th can be calculated as follows:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.10" class="ltx_Math" alttext="\widetilde{y}_{i,j}=\frac{1}{D_{i,j}}\sum_{(x,y)\in\mathcal{D}_{i,j}}f_{e}(\omega_{e};\boldsymbol{x})," display="block"><semantics id="S2.E2.m1.10a"><mrow id="S2.E2.m1.10.10.1" xref="S2.E2.m1.10.10.1.1.cmml"><mrow id="S2.E2.m1.10.10.1.1" xref="S2.E2.m1.10.10.1.1.cmml"><msub id="S2.E2.m1.10.10.1.1.3" xref="S2.E2.m1.10.10.1.1.3.cmml"><mover accent="true" id="S2.E2.m1.10.10.1.1.3.2" xref="S2.E2.m1.10.10.1.1.3.2.cmml"><mi id="S2.E2.m1.10.10.1.1.3.2.2" xref="S2.E2.m1.10.10.1.1.3.2.2.cmml">y</mi><mo id="S2.E2.m1.10.10.1.1.3.2.1" xref="S2.E2.m1.10.10.1.1.3.2.1.cmml">~</mo></mover><mrow id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.2.2.2.4.1" xref="S2.E2.m1.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.10.10.1.1.2" xref="S2.E2.m1.10.10.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.10.10.1.1.1" xref="S2.E2.m1.10.10.1.1.1.cmml"><mfrac id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mn id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml">1</mn><msub id="S2.E2.m1.4.4.2" xref="S2.E2.m1.4.4.2.cmml"><mi id="S2.E2.m1.4.4.2.4" xref="S2.E2.m1.4.4.2.4.cmml">D</mi><mrow id="S2.E2.m1.4.4.2.2.2.4" xref="S2.E2.m1.4.4.2.2.2.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.4.4.2.2.2.4.1" xref="S2.E2.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.4.4.2.2.2.2" xref="S2.E2.m1.4.4.2.2.2.2.cmml">j</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.E2.m1.10.10.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.10.10.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.cmml"><munder id="S2.E2.m1.10.10.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.10.10.1.1.1.1.2.2" xref="S2.E2.m1.10.10.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.8.8.4" xref="S2.E2.m1.8.8.4.cmml"><mrow id="S2.E2.m1.8.8.4.6.2" xref="S2.E2.m1.8.8.4.6.1.cmml"><mo stretchy="false" id="S2.E2.m1.8.8.4.6.2.1" xref="S2.E2.m1.8.8.4.6.1.cmml">(</mo><mi id="S2.E2.m1.7.7.3.3" xref="S2.E2.m1.7.7.3.3.cmml">x</mi><mo id="S2.E2.m1.8.8.4.6.2.2" xref="S2.E2.m1.8.8.4.6.1.cmml">,</mo><mi id="S2.E2.m1.8.8.4.4" xref="S2.E2.m1.8.8.4.4.cmml">y</mi><mo stretchy="false" id="S2.E2.m1.8.8.4.6.2.3" xref="S2.E2.m1.8.8.4.6.1.cmml">)</mo></mrow><mo id="S2.E2.m1.8.8.4.5" xref="S2.E2.m1.8.8.4.5.cmml">∈</mo><msub id="S2.E2.m1.8.8.4.7" xref="S2.E2.m1.8.8.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.8.8.4.7.2" xref="S2.E2.m1.8.8.4.7.2.cmml">𝒟</mi><mrow id="S2.E2.m1.6.6.2.2.2.4" xref="S2.E2.m1.6.6.2.2.2.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.6.6.2.2.2.4.1" xref="S2.E2.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.6.6.2.2.2.2" xref="S2.E2.m1.6.6.2.2.2.2.cmml">j</mi></mrow></msub></mrow></munder><mrow id="S2.E2.m1.10.10.1.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.1.cmml"><msub id="S2.E2.m1.10.10.1.1.1.1.1.3" xref="S2.E2.m1.10.10.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.10.10.1.1.1.1.1.3.2" xref="S2.E2.m1.10.10.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E2.m1.10.10.1.1.1.1.1.3.3" xref="S2.E2.m1.10.10.1.1.1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.10.10.1.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.10.10.1.1.1.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.10.10.1.1.1.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.E2.m1.10.10.1.1.1.1.1.1.1.3" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E2.m1.9.9" xref="S2.E2.m1.9.9.cmml">𝒙</mi><mo stretchy="false" id="S2.E2.m1.10.10.1.1.1.1.1.1.1.4" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.10.10.1.2" xref="S2.E2.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.10b"><apply id="S2.E2.m1.10.10.1.1.cmml" xref="S2.E2.m1.10.10.1"><eq id="S2.E2.m1.10.10.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.2"></eq><apply id="S2.E2.m1.10.10.1.1.3.cmml" xref="S2.E2.m1.10.10.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.3.1.cmml" xref="S2.E2.m1.10.10.1.1.3">subscript</csymbol><apply id="S2.E2.m1.10.10.1.1.3.2.cmml" xref="S2.E2.m1.10.10.1.1.3.2"><ci id="S2.E2.m1.10.10.1.1.3.2.1.cmml" xref="S2.E2.m1.10.10.1.1.3.2.1">~</ci><ci id="S2.E2.m1.10.10.1.1.3.2.2.cmml" xref="S2.E2.m1.10.10.1.1.3.2.2">𝑦</ci></apply><list id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑖</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S2.E2.m1.10.10.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1"><times id="S2.E2.m1.10.10.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.2"></times><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><divide id="S2.E2.m1.4.4.3.cmml" xref="S2.E2.m1.4.4"></divide><cn type="integer" id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4">1</cn><apply id="S2.E2.m1.4.4.2.cmml" xref="S2.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.2.3.cmml" xref="S2.E2.m1.4.4.2">subscript</csymbol><ci id="S2.E2.m1.4.4.2.4.cmml" xref="S2.E2.m1.4.4.2.4">𝐷</ci><list id="S2.E2.m1.4.4.2.2.2.3.cmml" xref="S2.E2.m1.4.4.2.2.2.4"><ci id="S2.E2.m1.3.3.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1">𝑖</ci><ci id="S2.E2.m1.4.4.2.2.2.2.cmml" xref="S2.E2.m1.4.4.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S2.E2.m1.10.10.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1"><apply id="S2.E2.m1.10.10.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.1.1.2.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.10.10.1.1.1.1.2.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.2.2"></sum><apply id="S2.E2.m1.8.8.4.cmml" xref="S2.E2.m1.8.8.4"><in id="S2.E2.m1.8.8.4.5.cmml" xref="S2.E2.m1.8.8.4.5"></in><interval closure="open" id="S2.E2.m1.8.8.4.6.1.cmml" xref="S2.E2.m1.8.8.4.6.2"><ci id="S2.E2.m1.7.7.3.3.cmml" xref="S2.E2.m1.7.7.3.3">𝑥</ci><ci id="S2.E2.m1.8.8.4.4.cmml" xref="S2.E2.m1.8.8.4.4">𝑦</ci></interval><apply id="S2.E2.m1.8.8.4.7.cmml" xref="S2.E2.m1.8.8.4.7"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.4.7.1.cmml" xref="S2.E2.m1.8.8.4.7">subscript</csymbol><ci id="S2.E2.m1.8.8.4.7.2.cmml" xref="S2.E2.m1.8.8.4.7.2">𝒟</ci><list id="S2.E2.m1.6.6.2.2.2.3.cmml" xref="S2.E2.m1.6.6.2.2.2.4"><ci id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1">𝑖</ci><ci id="S2.E2.m1.6.6.2.2.2.2.cmml" xref="S2.E2.m1.6.6.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="S2.E2.m1.10.10.1.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1"><times id="S2.E2.m1.10.10.1.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.2"></times><apply id="S2.E2.m1.10.10.1.1.1.1.1.3.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.10.10.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E2.m1.10.10.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3.3">𝑒</ci></apply><list id="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1"><apply id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3">𝑒</ci></apply><ci id="S2.E2.m1.9.9.cmml" xref="S2.E2.m1.9.9">𝒙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.10c">\widetilde{y}_{i,j}=\frac{1}{D_{i,j}}\sum_{(x,y)\in\mathcal{D}_{i,j}}f_{e}(\omega_{e};\boldsymbol{x}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.SSS1.p1.8" class="ltx_p">where <math id="S2.SS3.SSS1.p1.3.m1.2" class="ltx_Math" alttext="\mathcal{D}_{i,j}" display="inline"><semantics id="S2.SS3.SSS1.p1.3.m1.2a"><msub id="S2.SS3.SSS1.p1.3.m1.2.3" xref="S2.SS3.SSS1.p1.3.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS1.p1.3.m1.2.3.2" xref="S2.SS3.SSS1.p1.3.m1.2.3.2.cmml">𝒟</mi><mrow id="S2.SS3.SSS1.p1.3.m1.2.2.2.4" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.3.m1.1.1.1.1" xref="S2.SS3.SSS1.p1.3.m1.1.1.1.1.cmml">i</mi><mo id="S2.SS3.SSS1.p1.3.m1.2.2.2.4.1" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS3.SSS1.p1.3.m1.2.2.2.2" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.3.m1.2b"><apply id="S2.SS3.SSS1.p1.3.m1.2.3.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.3.m1.2.3.1.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.3.m1.2.3.2.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.3.2">𝒟</ci><list id="S2.SS3.SSS1.p1.3.m1.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.4"><ci id="S2.SS3.SSS1.p1.3.m1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.3.m1.1.1.1.1">𝑖</ci><ci id="S2.SS3.SSS1.p1.3.m1.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.3.m1.2c">\mathcal{D}_{i,j}</annotation></semantics></math> refers to the distribution of samples in the <math id="S2.SS3.SSS1.p1.4.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.SSS1.p1.4.m2.1a"><mi id="S2.SS3.SSS1.p1.4.m2.1.1" xref="S2.SS3.SSS1.p1.4.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.4.m2.1b"><ci id="S2.SS3.SSS1.p1.4.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.4.m2.1c">j</annotation></semantics></math>-th class belonging to client <math id="S2.SS3.SSS1.p1.5.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.SSS1.p1.5.m3.1a"><mi id="S2.SS3.SSS1.p1.5.m3.1.1" xref="S2.SS3.SSS1.p1.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.5.m3.1b"><ci id="S2.SS3.SSS1.p1.5.m3.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.5.m3.1c">i</annotation></semantics></math>-th, and <math id="S2.SS3.SSS1.p1.6.m4.2" class="ltx_Math" alttext="D_{i,j}" display="inline"><semantics id="S2.SS3.SSS1.p1.6.m4.2a"><msub id="S2.SS3.SSS1.p1.6.m4.2.3" xref="S2.SS3.SSS1.p1.6.m4.2.3.cmml"><mi id="S2.SS3.SSS1.p1.6.m4.2.3.2" xref="S2.SS3.SSS1.p1.6.m4.2.3.2.cmml">D</mi><mrow id="S2.SS3.SSS1.p1.6.m4.2.2.2.4" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.6.m4.1.1.1.1" xref="S2.SS3.SSS1.p1.6.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS3.SSS1.p1.6.m4.2.2.2.4.1" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS3.SSS1.p1.6.m4.2.2.2.2" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.6.m4.2b"><apply id="S2.SS3.SSS1.p1.6.m4.2.3.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m4.2.3.1.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.6.m4.2.3.2.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.3.2">𝐷</ci><list id="S2.SS3.SSS1.p1.6.m4.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.4"><ci id="S2.SS3.SSS1.p1.6.m4.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m4.1.1.1.1">𝑖</ci><ci id="S2.SS3.SSS1.p1.6.m4.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.6.m4.2c">D_{i,j}</annotation></semantics></math> denotes the size of this distribution. This formula aims to calculate the average of the feature representations obtained from the feature extraction layer <math id="S2.SS3.SSS1.p1.7.m5.2" class="ltx_Math" alttext="f_{e}(\omega_{e};\boldsymbol{x})" display="inline"><semantics id="S2.SS3.SSS1.p1.7.m5.2a"><mrow id="S2.SS3.SSS1.p1.7.m5.2.2" xref="S2.SS3.SSS1.p1.7.m5.2.2.cmml"><msub id="S2.SS3.SSS1.p1.7.m5.2.2.3" xref="S2.SS3.SSS1.p1.7.m5.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.7.m5.2.2.3.2" xref="S2.SS3.SSS1.p1.7.m5.2.2.3.2.cmml">f</mi><mi id="S2.SS3.SSS1.p1.7.m5.2.2.3.3" xref="S2.SS3.SSS1.p1.7.m5.2.2.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.7.m5.2.2.2" xref="S2.SS3.SSS1.p1.7.m5.2.2.2.cmml">​</mo><mrow id="S2.SS3.SSS1.p1.7.m5.2.2.1.1" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.2" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.2.cmml">(</mo><msub id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.cmml"><mi id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.2" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.3" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.3" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.2.cmml">;</mo><mi id="S2.SS3.SSS1.p1.7.m5.1.1" xref="S2.SS3.SSS1.p1.7.m5.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.4" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.7.m5.2b"><apply id="S2.SS3.SSS1.p1.7.m5.2.2.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2"><times id="S2.SS3.SSS1.p1.7.m5.2.2.2.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.2"></times><apply id="S2.SS3.SSS1.p1.7.m5.2.2.3.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.7.m5.2.2.3.1.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.7.m5.2.2.3.2.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.3.2">𝑓</ci><ci id="S2.SS3.SSS1.p1.7.m5.2.2.3.3.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.3.3">𝑒</ci></apply><list id="S2.SS3.SSS1.p1.7.m5.2.2.1.2.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1"><apply id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.2">𝜔</ci><ci id="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.1.1.1.3">𝑒</ci></apply><ci id="S2.SS3.SSS1.p1.7.m5.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m5.1.1">𝒙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.7.m5.2c">f_{e}(\omega_{e};\boldsymbol{x})</annotation></semantics></math> of all the samples in <math id="S2.SS3.SSS1.p1.8.m6.2" class="ltx_Math" alttext="\mathcal{D}_{i,j}" display="inline"><semantics id="S2.SS3.SSS1.p1.8.m6.2a"><msub id="S2.SS3.SSS1.p1.8.m6.2.3" xref="S2.SS3.SSS1.p1.8.m6.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS1.p1.8.m6.2.3.2" xref="S2.SS3.SSS1.p1.8.m6.2.3.2.cmml">𝒟</mi><mrow id="S2.SS3.SSS1.p1.8.m6.2.2.2.4" xref="S2.SS3.SSS1.p1.8.m6.2.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.8.m6.1.1.1.1" xref="S2.SS3.SSS1.p1.8.m6.1.1.1.1.cmml">i</mi><mo id="S2.SS3.SSS1.p1.8.m6.2.2.2.4.1" xref="S2.SS3.SSS1.p1.8.m6.2.2.2.3.cmml">,</mo><mi id="S2.SS3.SSS1.p1.8.m6.2.2.2.2" xref="S2.SS3.SSS1.p1.8.m6.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.8.m6.2b"><apply id="S2.SS3.SSS1.p1.8.m6.2.3.cmml" xref="S2.SS3.SSS1.p1.8.m6.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.8.m6.2.3.1.cmml" xref="S2.SS3.SSS1.p1.8.m6.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.8.m6.2.3.2.cmml" xref="S2.SS3.SSS1.p1.8.m6.2.3.2">𝒟</ci><list id="S2.SS3.SSS1.p1.8.m6.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.8.m6.2.2.2.4"><ci id="S2.SS3.SSS1.p1.8.m6.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.8.m6.1.1.1.1">𝑖</ci><ci id="S2.SS3.SSS1.p1.8.m6.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.8.m6.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.8.m6.2c">\mathcal{D}_{i,j}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS2.4.1.1" class="ltx_text">II-C</span>2 </span>Global Prototype Aggregation</h4>

<div id="S2.SS3.SSS2.p1" class="ltx_para">
<p id="S2.SS3.SSS2.p1.7" class="ltx_p">The prototypes computed using the Eq. <a href="#S2.E2" title="In II-C1 Prototype Calculation ‣ II-C Prototype-based Model Training ‣ II Proposed Framework ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> can be aggregated by sending them to the server, and the aggregation process can be defined as follows <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.3" class="ltx_Math" alttext="\overline{y}_{j}=\frac{1}{N}\sum_{i\in N}\widetilde{y}_{i,j}," display="block"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mover accent="true" id="S2.E3.m1.3.3.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.cmml">y</mi><mo id="S2.E3.m1.3.3.1.1.2.2.1" xref="S2.E3.m1.3.3.1.1.2.2.1.cmml">¯</mo></mover><mi id="S2.E3.m1.3.3.1.1.2.3" xref="S2.E3.m1.3.3.1.1.2.3.cmml">j</mi></msub><mo id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml"><mfrac id="S2.E3.m1.3.3.1.1.3.2" xref="S2.E3.m1.3.3.1.1.3.2.cmml"><mn id="S2.E3.m1.3.3.1.1.3.2.2" xref="S2.E3.m1.3.3.1.1.3.2.2.cmml">1</mn><mi id="S2.E3.m1.3.3.1.1.3.2.3" xref="S2.E3.m1.3.3.1.1.3.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.3.1" xref="S2.E3.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1.3.3" xref="S2.E3.m1.3.3.1.1.3.3.cmml"><munder id="S2.E3.m1.3.3.1.1.3.3.1" xref="S2.E3.m1.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S2.E3.m1.3.3.1.1.3.3.1.2" xref="S2.E3.m1.3.3.1.1.3.3.1.2.cmml">∑</mo><mrow id="S2.E3.m1.3.3.1.1.3.3.1.3" xref="S2.E3.m1.3.3.1.1.3.3.1.3.cmml"><mi id="S2.E3.m1.3.3.1.1.3.3.1.3.2" xref="S2.E3.m1.3.3.1.1.3.3.1.3.2.cmml">i</mi><mo id="S2.E3.m1.3.3.1.1.3.3.1.3.1" xref="S2.E3.m1.3.3.1.1.3.3.1.3.1.cmml">∈</mo><mi id="S2.E3.m1.3.3.1.1.3.3.1.3.3" xref="S2.E3.m1.3.3.1.1.3.3.1.3.3.cmml">N</mi></mrow></munder><msub id="S2.E3.m1.3.3.1.1.3.3.2" xref="S2.E3.m1.3.3.1.1.3.3.2.cmml"><mover accent="true" id="S2.E3.m1.3.3.1.1.3.3.2.2" xref="S2.E3.m1.3.3.1.1.3.3.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.3.3.2.2.2" xref="S2.E3.m1.3.3.1.1.3.3.2.2.2.cmml">y</mi><mo id="S2.E3.m1.3.3.1.1.3.3.2.2.1" xref="S2.E3.m1.3.3.1.1.3.3.2.2.1.cmml">~</mo></mover><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">i</mi><mo id="S2.E3.m1.2.2.2.4.1" xref="S2.E3.m1.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"></eq><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2">subscript</csymbol><apply id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2"><ci id="S2.E3.m1.3.3.1.1.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1">¯</ci><ci id="S2.E3.m1.3.3.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2">𝑦</ci></apply><ci id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3">𝑗</ci></apply><apply id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3"><times id="S2.E3.m1.3.3.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.1"></times><apply id="S2.E3.m1.3.3.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2"><divide id="S2.E3.m1.3.3.1.1.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2"></divide><cn type="integer" id="S2.E3.m1.3.3.1.1.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2">1</cn><ci id="S2.E3.m1.3.3.1.1.3.2.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3">𝑁</ci></apply><apply id="S2.E3.m1.3.3.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.3"><apply id="S2.E3.m1.3.3.1.1.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="S2.E3.m1.3.3.1.1.3.3.1.2.cmml" xref="S2.E3.m1.3.3.1.1.3.3.1.2"></sum><apply id="S2.E3.m1.3.3.1.1.3.3.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3.3.1.3"><in id="S2.E3.m1.3.3.1.1.3.3.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.3.1.3.1"></in><ci id="S2.E3.m1.3.3.1.1.3.3.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.3.1.3.2">𝑖</ci><ci id="S2.E3.m1.3.3.1.1.3.3.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.3.1.3.3">𝑁</ci></apply></apply><apply id="S2.E3.m1.3.3.1.1.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.3.3.2">subscript</csymbol><apply id="S2.E3.m1.3.3.1.1.3.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.3.3.2.2"><ci id="S2.E3.m1.3.3.1.1.3.3.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.3.3.2.2.1">~</ci><ci id="S2.E3.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.3.3.2.2.2">𝑦</ci></apply><list id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑖</ci><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\overline{y}_{j}=\frac{1}{N}\sum_{i\in N}\widetilde{y}_{i,j},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.SSS2.p1.6" class="ltx_p">where <math id="S2.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS3.SSS2.p1.1.m1.1a"><mi id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.1b"><ci id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.1c">N</annotation></semantics></math> denotes the total number of clients in the network, and <math id="S2.SS3.SSS2.p1.2.m2.2" class="ltx_Math" alttext="\widetilde{y}_{i,j}" display="inline"><semantics id="S2.SS3.SSS2.p1.2.m2.2a"><msub id="S2.SS3.SSS2.p1.2.m2.2.3" xref="S2.SS3.SSS2.p1.2.m2.2.3.cmml"><mover accent="true" id="S2.SS3.SSS2.p1.2.m2.2.3.2" xref="S2.SS3.SSS2.p1.2.m2.2.3.2.cmml"><mi id="S2.SS3.SSS2.p1.2.m2.2.3.2.2" xref="S2.SS3.SSS2.p1.2.m2.2.3.2.2.cmml">y</mi><mo id="S2.SS3.SSS2.p1.2.m2.2.3.2.1" xref="S2.SS3.SSS2.p1.2.m2.2.3.2.1.cmml">~</mo></mover><mrow id="S2.SS3.SSS2.p1.2.m2.2.2.2.4" xref="S2.SS3.SSS2.p1.2.m2.2.2.2.3.cmml"><mi id="S2.SS3.SSS2.p1.2.m2.1.1.1.1" xref="S2.SS3.SSS2.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S2.SS3.SSS2.p1.2.m2.2.2.2.4.1" xref="S2.SS3.SSS2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S2.SS3.SSS2.p1.2.m2.2.2.2.2" xref="S2.SS3.SSS2.p1.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.2.m2.2b"><apply id="S2.SS3.SSS2.p1.2.m2.2.3.cmml" xref="S2.SS3.SSS2.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.2.m2.2.3.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.2.3">subscript</csymbol><apply id="S2.SS3.SSS2.p1.2.m2.2.3.2.cmml" xref="S2.SS3.SSS2.p1.2.m2.2.3.2"><ci id="S2.SS3.SSS2.p1.2.m2.2.3.2.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.2.3.2.1">~</ci><ci id="S2.SS3.SSS2.p1.2.m2.2.3.2.2.cmml" xref="S2.SS3.SSS2.p1.2.m2.2.3.2.2">𝑦</ci></apply><list id="S2.SS3.SSS2.p1.2.m2.2.2.2.3.cmml" xref="S2.SS3.SSS2.p1.2.m2.2.2.2.4"><ci id="S2.SS3.SSS2.p1.2.m2.1.1.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1.1.1">𝑖</ci><ci id="S2.SS3.SSS2.p1.2.m2.2.2.2.2.cmml" xref="S2.SS3.SSS2.p1.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.2.m2.2c">\widetilde{y}_{i,j}</annotation></semantics></math> represents the prototype vector for the <math id="S2.SS3.SSS2.p1.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.SSS2.p1.3.m3.1a"><mi id="S2.SS3.SSS2.p1.3.m3.1.1" xref="S2.SS3.SSS2.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.3.m3.1b"><ci id="S2.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.3.m3.1c">j</annotation></semantics></math>-th class of client <math id="S2.SS3.SSS2.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.SSS2.p1.4.m4.1a"><mi id="S2.SS3.SSS2.p1.4.m4.1.1" xref="S2.SS3.SSS2.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.4.m4.1b"><ci id="S2.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.4.m4.1c">i</annotation></semantics></math>-th, as computed by Eq. <a href="#S2.E2" title="In II-C1 Prototype Calculation ‣ II-C Prototype-based Model Training ‣ II Proposed Framework ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The aggregation process involves computing the average of these prototypes from all clients that have samples of the <math id="S2.SS3.SSS2.p1.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.SSS2.p1.5.m5.1a"><mi id="S2.SS3.SSS2.p1.5.m5.1.1" xref="S2.SS3.SSS2.p1.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.5.m5.1b"><ci id="S2.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p1.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.5.m5.1c">j</annotation></semantics></math>-th class, resulting in a global prototype vector <math id="S2.SS3.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\overline{y}_{j}" display="inline"><semantics id="S2.SS3.SSS2.p1.6.m6.1a"><msub id="S2.SS3.SSS2.p1.6.m6.1.1" xref="S2.SS3.SSS2.p1.6.m6.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p1.6.m6.1.1.2" xref="S2.SS3.SSS2.p1.6.m6.1.1.2.cmml"><mi id="S2.SS3.SSS2.p1.6.m6.1.1.2.2" xref="S2.SS3.SSS2.p1.6.m6.1.1.2.2.cmml">y</mi><mo id="S2.SS3.SSS2.p1.6.m6.1.1.2.1" xref="S2.SS3.SSS2.p1.6.m6.1.1.2.1.cmml">¯</mo></mover><mi id="S2.SS3.SSS2.p1.6.m6.1.1.3" xref="S2.SS3.SSS2.p1.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.6.m6.1b"><apply id="S2.SS3.SSS2.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.6.m6.1.1.1.cmml" xref="S2.SS3.SSS2.p1.6.m6.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p1.6.m6.1.1.2.cmml" xref="S2.SS3.SSS2.p1.6.m6.1.1.2"><ci id="S2.SS3.SSS2.p1.6.m6.1.1.2.1.cmml" xref="S2.SS3.SSS2.p1.6.m6.1.1.2.1">¯</ci><ci id="S2.SS3.SSS2.p1.6.m6.1.1.2.2.cmml" xref="S2.SS3.SSS2.p1.6.m6.1.1.2.2">𝑦</ci></apply><ci id="S2.SS3.SSS2.p1.6.m6.1.1.3.cmml" xref="S2.SS3.SSS2.p1.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.6.m6.1c">\overline{y}_{j}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS3.4.1.1" class="ltx_text">II-C</span>3 </span>Local Objective</h4>

<div id="S2.SS3.SSS3.p1" class="ltx_para">
<p id="S2.SS3.SSS3.p1.7" class="ltx_p">The global representation for each class obtained through Eq. <a href="#S2.E3" title="In II-C2 Global Prototype Aggregation ‣ II-C Prototype-based Model Training ‣ II Proposed Framework ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> can be utilized for regularization purposes. Specifically, the loss function for each client can be defined as follows:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\mathcal{L}_{i}(\omega_{i})=\mathcal{L}_{i}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i})+\ell_{2}(f_{e}(\omega_{e};\boldsymbol{x}_{i})-\overline{y}_{j})," display="block"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.2.2.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.3.2.cmml">ℒ</mi><mi id="S2.E4.m1.2.2.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.5" xref="S2.E4.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.E4.m1.2.2.1.1.4" xref="S2.E4.m1.2.2.1.1.4.cmml"><mrow id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml"><msub id="S2.E4.m1.2.2.1.1.3.2.4" xref="S2.E4.m1.2.2.1.1.3.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.2.2.1.1.3.2.4.2" xref="S2.E4.m1.2.2.1.1.3.2.4.2.cmml">ℒ</mi><mi id="S2.E4.m1.2.2.1.1.3.2.4.3" xref="S2.E4.m1.2.2.1.1.3.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.3.2.3" xref="S2.E4.m1.2.2.1.1.3.2.3.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.3.2.2.2" xref="S2.E4.m1.2.2.1.1.3.2.2.3.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.3.2.2.2.3" xref="S2.E4.m1.2.2.1.1.3.2.2.3.cmml">(</mo><mrow id="S2.E4.m1.2.2.1.1.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.2.2.1.1.2.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.2.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">ω</mi><mo id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">;</mo><msub id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.4" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.3.2.2.2.4" xref="S2.E4.m1.2.2.1.1.3.2.2.3.cmml">,</mo><msub id="S2.E4.m1.2.2.1.1.3.2.2.2.2" xref="S2.E4.m1.2.2.1.1.3.2.2.2.2.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2.2.2.2.2" xref="S2.E4.m1.2.2.1.1.3.2.2.2.2.2.cmml">y</mi><mi id="S2.E4.m1.2.2.1.1.3.2.2.2.2.3" xref="S2.E4.m1.2.2.1.1.3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.3.2.2.2.5" xref="S2.E4.m1.2.2.1.1.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.4.4" xref="S2.E4.m1.2.2.1.1.4.4.cmml">+</mo><mrow id="S2.E4.m1.2.2.1.1.4.3" xref="S2.E4.m1.2.2.1.1.4.3.cmml"><msub id="S2.E4.m1.2.2.1.1.4.3.3" xref="S2.E4.m1.2.2.1.1.4.3.3.cmml"><mi mathvariant="normal" id="S2.E4.m1.2.2.1.1.4.3.3.2" xref="S2.E4.m1.2.2.1.1.4.3.3.2.cmml">ℓ</mi><mn id="S2.E4.m1.2.2.1.1.4.3.3.3" xref="S2.E4.m1.2.2.1.1.4.3.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.4.3.2" xref="S2.E4.m1.2.2.1.1.4.3.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.4.3.1.1" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.4.3.1.1.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.2.2.1.1.4.3.1.1.1" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.cmml"><msub id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.cmml"><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.2.cmml">f</mi><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.3.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.4" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.3.cmml">;</mo><msub id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.cmml"><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.2.cmml">𝒙</mi><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.5" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.4.3.1.1.1.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.3.cmml">−</mo><msub id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.cmml"><mover accent="true" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.cmml"><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.2" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.2.cmml">y</mi><mo id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.1" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.1.cmml">¯</mo></mover><mi id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S2.E4.m1.2.2.1.1.4.3.1.1.3" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><eq id="S2.E4.m1.2.2.1.1.5.cmml" xref="S2.E4.m1.2.2.1.1.5"></eq><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"></times><apply id="S2.E4.m1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.2">ℒ</ci><ci id="S2.E4.m1.2.2.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.E4.m1.2.2.1.1.4.cmml" xref="S2.E4.m1.2.2.1.1.4"><plus id="S2.E4.m1.2.2.1.1.4.4.cmml" xref="S2.E4.m1.2.2.1.1.4.4"></plus><apply id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2"><times id="S2.E4.m1.2.2.1.1.3.2.3.cmml" xref="S2.E4.m1.2.2.1.1.3.2.3"></times><apply id="S2.E4.m1.2.2.1.1.3.2.4.cmml" xref="S2.E4.m1.2.2.1.1.3.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.2.4.1.cmml" xref="S2.E4.m1.2.2.1.1.3.2.4">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.4.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2.4.2">ℒ</ci><ci id="S2.E4.m1.2.2.1.1.3.2.4.3.cmml" xref="S2.E4.m1.2.2.1.1.3.2.4.3">𝑖</ci></apply><interval closure="open" id="S2.E4.m1.2.2.1.1.3.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2.2"><apply id="S2.E4.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1"><times id="S2.E4.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.2"></times><ci id="S2.E4.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.3">ℱ</ci><list id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1"><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝜔</ci><apply id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S2.E4.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2.2.2.2">𝑦</ci><ci id="S2.E4.m1.2.2.1.1.3.2.2.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S2.E4.m1.2.2.1.1.4.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3"><times id="S2.E4.m1.2.2.1.1.4.3.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.2"></times><apply id="S2.E4.m1.2.2.1.1.4.3.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.4.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.4.3.3.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.3.2">ℓ</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.4.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.3.3">2</cn></apply><apply id="S2.E4.m1.2.2.1.1.4.3.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1"><minus id="S2.E4.m1.2.2.1.1.4.3.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.3"></minus><apply id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2"><times id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.3"></times><apply id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.2">𝑓</ci><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.4.3">𝑒</ci></apply><list id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2"><apply id="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.1.1.1.1.3">𝑒</ci></apply><apply id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.2">𝒙</ci><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4">subscript</csymbol><apply id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2"><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.1.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.1">¯</ci><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.2.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.2.2">𝑦</ci></apply><ci id="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.3.cmml" xref="S2.E4.m1.2.2.1.1.4.3.1.1.1.4.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\mathcal{L}_{i}(\omega_{i})=\mathcal{L}_{i}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i})+\ell_{2}(f_{e}(\omega_{e};\boldsymbol{x}_{i})-\overline{y}_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.SSS3.p1.6" class="ltx_p">where <math id="S2.SS3.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\overline{y}_{j}" display="inline"><semantics id="S2.SS3.SSS3.p1.1.m1.1a"><msub id="S2.SS3.SSS3.p1.1.m1.1.1" xref="S2.SS3.SSS3.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS3.SSS3.p1.1.m1.1.1.2" xref="S2.SS3.SSS3.p1.1.m1.1.1.2.cmml"><mi id="S2.SS3.SSS3.p1.1.m1.1.1.2.2" xref="S2.SS3.SSS3.p1.1.m1.1.1.2.2.cmml">y</mi><mo id="S2.SS3.SSS3.p1.1.m1.1.1.2.1" xref="S2.SS3.SSS3.p1.1.m1.1.1.2.1.cmml">¯</mo></mover><mi id="S2.SS3.SSS3.p1.1.m1.1.1.3" xref="S2.SS3.SSS3.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.1.m1.1b"><apply id="S2.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1.2"><ci id="S2.SS3.SSS3.p1.1.m1.1.1.2.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1.2.1">¯</ci><ci id="S2.SS3.SSS3.p1.1.m1.1.1.2.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1.2.2">𝑦</ci></apply><ci id="S2.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.1.m1.1c">\overline{y}_{j}</annotation></semantics></math> belongs to <math id="S2.SS3.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbb{Y}" display="inline"><semantics id="S2.SS3.SSS3.p1.2.m2.1a"><mi id="S2.SS3.SSS3.p1.2.m2.1.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.cmml">𝕐</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.2.m2.1b"><ci id="S2.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1">𝕐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.2.m2.1c">\mathbb{Y}</annotation></semantics></math> which represents the set of global prototypes, <math id="S2.SS3.SSS3.p1.3.m3.3" class="ltx_Math" alttext="\mathcal{L}_{i}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i})" display="inline"><semantics id="S2.SS3.SSS3.p1.3.m3.3a"><mrow id="S2.SS3.SSS3.p1.3.m3.3.3" xref="S2.SS3.SSS3.p1.3.m3.3.3.cmml"><msub id="S2.SS3.SSS3.p1.3.m3.3.3.4" xref="S2.SS3.SSS3.p1.3.m3.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p1.3.m3.3.3.4.2" xref="S2.SS3.SSS3.p1.3.m3.3.3.4.2.cmml">ℒ</mi><mi id="S2.SS3.SSS3.p1.3.m3.3.3.4.3" xref="S2.SS3.SSS3.p1.3.m3.3.3.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.SSS3.p1.3.m3.3.3.3" xref="S2.SS3.SSS3.p1.3.m3.3.3.3.cmml">​</mo><mrow id="S2.SS3.SSS3.p1.3.m3.3.3.2.2" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.3" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.3.cmml">(</mo><mrow id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.3" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.2" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.2" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.2.cmml">(</mo><mi id="S2.SS3.SSS3.p1.3.m3.1.1" xref="S2.SS3.SSS3.p1.3.m3.1.1.cmml">ω</mi><mo id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.3" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.2.cmml">;</mo><msub id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.2" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.3" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.4" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.4" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.cmml"><mi id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.2" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.2.cmml">y</mi><mi id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.3" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.5" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.3.m3.3b"><apply id="S2.SS3.SSS3.p1.3.m3.3.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3"><times id="S2.SS3.SSS3.p1.3.m3.3.3.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.3"></times><apply id="S2.SS3.SSS3.p1.3.m3.3.3.4.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.3.m3.3.3.4.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.4">subscript</csymbol><ci id="S2.SS3.SSS3.p1.3.m3.3.3.4.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.4.2">ℒ</ci><ci id="S2.SS3.SSS3.p1.3.m3.3.3.4.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.4.3">𝑖</ci></apply><interval closure="open" id="S2.SS3.SSS3.p1.3.m3.3.3.2.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2"><apply id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1"><times id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.2"></times><ci id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.3">ℱ</ci><list id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1"><ci id="S2.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1">𝜔</ci><apply id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.2">𝑦</ci><ci id="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.3.3.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.3.m3.3c">\mathcal{L}_{i}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i})</annotation></semantics></math> is the supervised learning loss, and <math id="S2.SS3.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\ell_{2}(f_{e}(\omega_{e};\boldsymbol{x}_{i})-\overline{y}_{j})" display="inline"><semantics id="S2.SS3.SSS3.p1.4.m4.1a"><mrow id="S2.SS3.SSS3.p1.4.m4.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.cmml"><msub id="S2.SS3.SSS3.p1.4.m4.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml"><mi mathvariant="normal" id="S2.SS3.SSS3.p1.4.m4.1.1.3.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.2.cmml">ℓ</mi><mn id="S2.SS3.SSS3.p1.4.m4.1.1.3.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.SS3.SSS3.p1.4.m4.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml">​</mo><mrow id="S2.SS3.SSS3.p1.4.m4.1.1.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.cmml"><mrow id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.cmml"><msub id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.2.cmml">f</mi><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.4" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.2.cmml">𝒙</mi><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.5" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.3.cmml">−</mo><msub id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.cmml"><mover accent="true" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.2.cmml">y</mi><mo id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.1.cmml">¯</mo></mover><mi id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.4.m4.1b"><apply id="S2.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1"><times id="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.2"></times><apply id="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.2">ℓ</ci><cn type="integer" id="S2.SS3.SSS3.p1.4.m4.1.1.3.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.3">2</cn></apply><apply id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1"><minus id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.3"></minus><apply id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2"><times id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.3"></times><apply id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.2">𝑓</ci><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.4.3">𝑒</ci></apply><list id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2"><apply id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.1.1.1.1.3">𝑒</ci></apply><apply id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.2">𝒙</ci><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4">subscript</csymbol><apply id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2"><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.1">¯</ci><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.2.2">𝑦</ci></apply><ci id="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.1.1.1.4.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.4.m4.1c">\ell_{2}(f_{e}(\omega_{e};\boldsymbol{x}_{i})-\overline{y}_{j})</annotation></semantics></math> calculates the <math id="S2.SS3.SSS3.p1.5.m5.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S2.SS3.SSS3.p1.5.m5.1a"><msub id="S2.SS3.SSS3.p1.5.m5.1.1" xref="S2.SS3.SSS3.p1.5.m5.1.1.cmml"><mi mathvariant="normal" id="S2.SS3.SSS3.p1.5.m5.1.1.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.2.cmml">ℓ</mi><mn id="S2.SS3.SSS3.p1.5.m5.1.1.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.5.m5.1b"><apply id="S2.SS3.SSS3.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2">ℓ</ci><cn type="integer" id="S2.SS3.SSS3.p1.5.m5.1.1.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.5.m5.1c">\ell_{2}</annotation></semantics></math> distance between the local representation and the corresponding global prototype in <math id="S2.SS3.SSS3.p1.6.m6.1" class="ltx_Math" alttext="\mathbb{Y}" display="inline"><semantics id="S2.SS3.SSS3.p1.6.m6.1a"><mi id="S2.SS3.SSS3.p1.6.m6.1.1" xref="S2.SS3.SSS3.p1.6.m6.1.1.cmml">𝕐</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.6.m6.1b"><ci id="S2.SS3.SSS3.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1">𝕐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.6.m6.1c">\mathbb{Y}</annotation></semantics></math>. Detailed training processes are presented in Algorithm <a href="#alg1" title="Algorithm 1 ‣ II-B Proposed Federated Learning Framework ‣ II Proposed Framework ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Dataset and Local Model</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">To compare our strategy with the baseline FedAvg, we use two benchmark datasets: MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. MNIST is a dataset composed of handwritten digits used for recognition tasks, while Fashion-MNIST consists of various clothing images. Both datasets share the same image size of 28x28x1 pixels. For both the MNIST and Fashion-MNIST datasets in our experiments, we employ a 4-layer CNN network comprising of 2 convolutional layers and 2 fully connected layers. Similar networks have also been used in previous research <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<figure id="S3.F2" class="ltx_figure ltx_align_center"><img src="/html/2307.10575/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="140" height="106" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The top-1 average test accuracy of FedAvg and FedPR, on MNIST for different communication rounds, with the degree of data skewness set to <math id="S3.F2.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F2.3.m1.1b"><mi id="S3.F2.3.m1.1.1" xref="S3.F2.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F2.3.m1.1c"><ci id="S3.F2.3.m1.1.1.cmml" xref="S3.F2.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.m1.1d">\alpha</annotation></semantics></math> = 0.05.</figcaption>
</figure>
<figure id="S3.F3" class="ltx_figure ltx_align_center"><img src="/html/2307.10575/assets/x3.png" id="S3.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="141" height="106" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The top-1 average test accuracy of FedAvg and FedPR, on Fashion-MNIST for different communication rounds, with the degree of data skewness set to <math id="S3.F3.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F3.3.m1.1b"><mi id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><ci id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">\alpha</annotation></semantics></math> = 0.05.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">For all experiments, we use 10 clients. We use the SGD optimizer for all baselines, and the SGD momentum is set to 0.5. The other training parameters for both MNIST and Fashion-MNIST datasets are set to <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">B</annotation></semantics></math> = 8 and <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\eta</annotation></semantics></math> = 0.01, which represent the local batch size and learning rate, respectively. We denote local epoch as <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">E</annotation></semantics></math>, and set <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">E</annotation></semantics></math> = 1 for MNIST and <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">E</annotation></semantics></math> = 5 for Fashion-MNIST. To simulate the non-IID situation, we sample 2000 samples from the training dataset and distribute to all clients based on Dirichlet distribution Dir (<math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\alpha</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, where the smaller the value of <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\alpha</annotation></semantics></math>, the more unbalanced the distribution of data is among clients.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Accuracy and Communication Efficiency Comparison</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We compare our proposal with the most popular baseline <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span> with Dir(0.05). The accuracy and communication efficiency for comparison of all methods on MNIST and Fashion-MNIST are shown in Fig.<a href="#S3.F2" title="Figure 2 ‣ III-A Dataset and Local Model ‣ III Experiments ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Fig.<a href="#S3.F3" title="Figure 3 ‣ III-A Dataset and Local Model ‣ III Experiments ‣ Boosting Federated Learning Convergence with Prototype Regularization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, respectively. It shows that our prototype-based regularization strategy achieves the higher test accuracy and faster convergence rate in each global communication round than the baseline FedAvg on both these two datasets. We take the test results of the last 10 rounds for both MNIST and Fashion-MNIST, and calculate the average test accuracy for our FedPR and FedAvg. For MNIST, the average accuracy of FedPR and FedAvg is 94.62% and 91.57% respectively, while for Fashion-MNIST, the average accuracy of FedPR and FedAvg is 86.05% and 79.04% respectively. In other words, our proposed approach achieves 3.3% higher accuracy than <span id="S3.SS3.p1.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> on MNIST and 8.9% higher accuracy on Fashion-MNIST when <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\alpha</annotation></semantics></math> is set to 0.05.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this article, we have proposed a FL framework based on prototype regularization to improve the model convergence rate. Specifically, we first introduce the prototype computation method, followed by the prototype aggregation method. Finally, we propose a prototype-based regularization strategy to regularize the local training of each client. Experimental results show that compared to the baseline FedAvg, our strategy can improve accuracy by 3.3% and 8.9% on MNIST and Fashion-MNIST, respectively, and achieve faster convergence speed. For future work, our proposal will be combined with other state-of-the-art methods and tested on more datasets.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
C. Zhang, C. Zhang, M. Zhang, and I. S. Kweon, “Text-to-image diffusion model
in generative ai: A survey,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.07909</em>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
C. Zhang, C. Zhang, S. Zheng, Y. Qiao, C. Li, M. Zhang, S. K. Dam, C. M. Thwal,
Y. L. Tun, L. L. Huy <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “A complete survey on generative ai
(aigc): Is chatgpt from gpt-4 to gpt-5 all you need?” <em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2303.11717</em>, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
C. Zhang, C. Zhang, C. Li, Y. Qiao, S. Zheng, S. K. Dam, M. Zhang, J. U. Kim,
S. T. Kim, J. Choi <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “One small step for generative ai, one
giant leap for agi: A complete survey on chatgpt in aigc era,” <em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2304.06488</em>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Kirillov, E. Mintun, N. Ravi, H. Mao, C. Rolland, L. Gustafson, T. Xiao,
S. Whitehead, A. C. Berg, W.-Y. Lo <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Segment anything,”
<em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.02643</em>, 2023.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Y. Qiao, C. Zhang, T. Kang, D. Kim, S. Tariq, C. Zhang, and C. S. Hong,
“Robustness of sam: Segment anything under corruptions and beyond,”
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.07713</em>, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
C. Zhang, D. Han, Y. Qiao, J. U. Kim, S.-H. Bae, S. Lee, and C. S. Hong,
“Faster segment anything: Towards lightweight sam for mobile applications,”
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.14289</em>, 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y. Qiao, M. S. Munir, A. Adhikary, A. D. Raha, S. H. Hong, and C. S. Hong, “A
framework for multi-prototype based federated learning: Towards the edge
intelligence,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">2023 International Conference on Information
Networking (ICOIN)</em>.   IEEE, 2023, pp.
134–139.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y. Qiao, M. S. Munir, A. Adhikary, A. D. Raha, and C. S. Hong, “Cdfed:
Contribution-based dynamic federated learning for managing system and
statistical heterogeneity,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">NOMS 2023-2023 IEEE/IFIP Network
Operations and Management Symposium</em>.   IEEE, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Qiao, S.-B. Park, S. M. Kang, and C. S. Hong, “Prototype helps federated
learning: Towards faster convergence,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2303.12296</em>, 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Qiao, C. Zhang, H. Q. Le, A. D. Raha, A. Adhikary, and C. S. Hong,
“Knowledge distillation in federated learning: Where and how to distill?”
in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">2023 24th Asia-Pacific Network Operations and Management Symposium
(APNOMS)</em>.   IEEE, 2023, pp. 1–6.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Y. Qiao, M. S. Munir, A. Adhikary, H. Q. Le, A. D. Raha, C. Zhang, and C. S.
Hong, “Mp-fedcl: Multi-prototype federated contrastive learning for edge
intelligence,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.01950</em>, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner, “Gradient-based learning
applied to document recognition,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, vol. 86,
no. 11, pp. 2278–2324, 1998.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
H. Xiao, K. Rasul, and R. Vollgraf, “Fashion-mnist: a novel image dataset for
benchmarking machine learning algorithms,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1708.07747</em>, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Yurochkin, M. Agarwal, S. Ghosh, K. Greenewald, N. Hoang, and Y. Khazaeni,
“Bayesian nonparametric federated learning of neural networks,” in
<em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>.   PMLR, 2019, pp. 7252–7261.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2307.10573" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2307.10575" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2307.10575">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2307.10575" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2307.10576" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 17:26:47 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
