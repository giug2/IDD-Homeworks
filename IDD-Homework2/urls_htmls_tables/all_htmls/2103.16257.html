<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2103.16257] Model-Contrastive Federated Learning</title><meta property="og:description" content="Federated learning enables multiple parties to collaboratively train a machine learning model without communicating their local data. A key challenge in federated learning is to handle the heterogeneity of local data d…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Model-Contrastive Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Model-Contrastive Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2103.16257">

<!--Generated on Fri Mar  8 15:31:55 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Model-Contrastive Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qinbin Li
<br class="ltx_break">National University of Singapore
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">qinbin@comp.nus.edu.sg</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bingsheng He
<br class="ltx_break">National University of Singapore
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">hebs@comp.nus.edu.sg</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dawn Song
<br class="ltx_break">UC Berkeley
<br class="ltx_break"><span id="id3.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">dawnsong@berkeley.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Federated learning enables multiple parties to collaboratively train a machine learning model without communicating their local data. A key challenge in federated learning is to handle the heterogeneity of local data distribution across parties. Although many studies have been proposed to address this challenge, we find that they fail to achieve high performance in image datasets with deep learning models. In this paper, we propose MOON: model-contrastive federated learning. MOON is a simple and effective federated learning framework. The key idea of MOON is to utilize the similarity between model representations to correct the local training of individual parties, i.e., conducting contrastive learning in model-level. Our extensive experiments show that MOON significantly outperforms the other state-of-the-art federated learning algorithms on various image classification tasks.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Deep learning is data hungry. Model training can benefit a lot from a large and representative dataset (<span id="S1.p1.1.1" class="ltx_ERROR undefined">\eg</span>, ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>). However, data are usually dispersed among different parties in practice (<span id="S1.p1.1.2" class="ltx_ERROR undefined">\eg</span>, mobile devices and companies). Due to the increasing privacy concerns and data protection regulations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, parties cannot send their private data to a centralized server to train a model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To address the above challenge, federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> enables multiple parties to jointly learn a machine learning model without exchanging their local data. A popular federated learning algorithm is FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. In each round of FedAvg, the updated local models of the parties are transferred to the server, which further aggregates the local models to update the global model. The raw data is not exchanged during the learning process. Federated learning has emerged as an important machine learning area and attracted many research interests <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Moreover, it has been applied in many applications such as medical imaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, and landmark classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A key challenge in federated learning is the heterogeneity of data distribution on different parties <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. The data can be non-identically distributed among the parties in many real-world applications, which can degrade the performance of federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. When each party updates its local model, its local objective may be far from the global objective. Thus, the averaged global model is away from the global optima. There have been some studies trying to address the non-IID issue in the local training phase <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> directly limits the local updates by <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\ell_{2}</annotation></semantics></math>-norm distance, while SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> corrects the local updates via variance reduction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. However, as we show in the experiments (see Section <a href="#S4" title="4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), these approaches fail to achieve good performance on image datasets with deep learning models, which can be as bad as FedAvg.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we address the non-IID issue from a novel perspective based on an intuitive observation: <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">the global model trained on a whole dataset is able to learn a better representation than the local model trained on a skewed subset</em>. Specifically, we propose <span id="S1.p4.1.2" class="ltx_text ltx_font_bold">mo</span>del-c<span id="S1.p4.1.3" class="ltx_text ltx_font_bold">on</span>trastive learning (MOON), which corrects the local updates by maximizing the agreement of representation learned by the current local model and the representation learned by the global model. Unlike the traditional contrastive learning approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, which achieve state-of-the-art results on learning visual representations by comparing the representations of different images, MOON conducts contrastive learning in model-level by comparing the representations learned by different models. Overall, MOON is a simple and effective federated learning framework, and addresses the non-IID data issue with the novel design of model-based contrastive learning.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We conduct extensive experiments to evaluate the effectiveness of MOON. MOON significantly outperforms the other state-of-the-art federated learning algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> on various image classification datasets including CIFAR-10, CIFAR-100, and Tiny-Imagenet. With only lightweight modifications to FedAvg, MOON outperforms existing approaches by at least 2% accuracy in most cases. Moreover, the improvement of MOON is very significant on some settings. For example, on CIFAR-100 dataset with 100 parties, MOON achieves 61.8% top-1 accuracy, while the best top-1 accuracy of existing studies is 55%.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background and Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> has been a de facto approach for federated learning. The framework of FedAvg is shown in Figure <a href="#S2.F1" title="Figure 1 ‣ 2.1 Federated Learning ‣ 2 Background and Related Work ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. There are four steps in each round of FedAvg. First, the server sends a global model to the parties. Second, the parties perform stochastic gradient descent (SGD) to update their models locally. Third, the local models are sent to a central server. Last, the server averages the model weights to produce a global model for the training of the next round.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2103.16257/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="400" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The FedAvg framework. In this paper, we focus on the second step, i.e., the local training phase.</figcaption>
</figure>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">There have been quite some studies trying to improve FedAvg on non-IID data. Those studies can be divided into two categories: improvement on local training (i.e., step 2 of Figure <a href="#S2.F1" title="Figure 1 ‣ 2.1 Federated Learning ‣ 2 Background and Related Work ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and on aggregation (i.e., step 4 of Figure <a href="#S2.F1" title="Figure 1 ‣ 2.1 Federated Learning ‣ 2 Background and Related Work ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). This study belongs to the first category.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">As for studies on improving local training, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> introduces a proximal term into the objective during local training. The proximal term is computed based on the <math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><msub id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi mathvariant="normal" id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">ℓ</mi><mn id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\ell_{2}</annotation></semantics></math>-norm distance between the current global model and the local model. Thus, the local model update is limited by the proximal term during the local training. SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> corrects the local updates by introducing control variates. Like the training model, the control variates are also updated by each party during local training. The difference between the local control variate and the global control variate is used to correct the gradients in local training. However, FedProx shows experiments on MNIST and EMNIST only with multinomial logistic regression, while SCAFFOLD only shows experiments on EMNIST with logistic regression and 2-layer fully connected layer. The effectiveness of FedProx and SCAFFOLD on image datasets with deep learning models has not been well explored. As shown in our experiments, those studies have little or even no advantage over FedAvg, which motivates this study for a new approach of handling non-IID image datasets with deep learning models. We also notice that there are other related contemporary work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> when preparing this paper. We leave the comparison between MOON and these contemporary work as future studies.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">As for studies on improving the aggregation phase, FedMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> utilizes Bayesian non-parametric methods to match and average weights in a layer-wise manner. FedAvgM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> applies momentum when updating the global model on the server. Another recent study, FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, normalizes the local updates before averaging.
Our study is orthogonal to them and potentially can be combined with these techniques as we work on the local training phase.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p">Another research direction is personalized federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, which tries to learn personalized local models for each party. In this paper, we study the typical federated learning, which tries to learn a single global model for all parties.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Contrastive Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Self-supervised learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> is a recent hot research direction, which tries to learn good data representations from unlabeled data. Among those studies, contrastive learning approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> achieve state-of-the-art results on learning visual representations. The key idea of contrastive learning is to reduce the distance between the representations of different augmented views of the same image (i.e., <em id="S2.SS2.p1.1.1" class="ltx_emph ltx_font_italic">positive pairs</em>), and increase the distance between the representations of augmented views of different images (i.e., <em id="S2.SS2.p1.1.2" class="ltx_emph ltx_font_italic">negative pairs</em>).</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.9" class="ltx_p">A typical contrastive learning framework is SimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Given an image <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">x</annotation></semantics></math>, SimCLR first creates two correlated views of this image using different data augmentation operators, denoted <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑥</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">x_{i}</annotation></semantics></math> and <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="x_{j}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝑥</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">x_{j}</annotation></semantics></math>. A base encoder <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.2" xref="S2.SS2.p2.4.m4.1.2.cmml"><mi id="S2.SS2.p2.4.m4.1.2.2" xref="S2.SS2.p2.4.m4.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m4.1.2.1" xref="S2.SS2.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.4.m4.1.2.3.2" xref="S2.SS2.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.4.m4.1.2.3.2.1" xref="S2.SS2.p2.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p2.4.m4.1.2.3.2.2" xref="S2.SS2.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.2.cmml" xref="S2.SS2.p2.4.m4.1.2"><times id="S2.SS2.p2.4.m4.1.2.1.cmml" xref="S2.SS2.p2.4.m4.1.2.1"></times><ci id="S2.SS2.p2.4.m4.1.2.2.cmml" xref="S2.SS2.p2.4.m4.1.2.2">𝑓</ci><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">f(\cdot)</annotation></semantics></math> and a projection head <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mrow id="S2.SS2.p2.5.m5.1.2" xref="S2.SS2.p2.5.m5.1.2.cmml"><mi id="S2.SS2.p2.5.m5.1.2.2" xref="S2.SS2.p2.5.m5.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.5.m5.1.2.1" xref="S2.SS2.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.5.m5.1.2.3.2" xref="S2.SS2.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.5.m5.1.2.3.2.1" xref="S2.SS2.p2.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p2.5.m5.1.2.3.2.2" xref="S2.SS2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.2.cmml" xref="S2.SS2.p2.5.m5.1.2"><times id="S2.SS2.p2.5.m5.1.2.1.cmml" xref="S2.SS2.p2.5.m5.1.2.1"></times><ci id="S2.SS2.p2.5.m5.1.2.2.cmml" xref="S2.SS2.p2.5.m5.1.2.2">𝑔</ci><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">g(\cdot)</annotation></semantics></math> are trained to extract the representation vectors and map the representations to a latent space, respectively. Then, a contrastive loss (i.e., NT-Xent <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>) is applied on the projected vector <math id="S2.SS2.p2.6.m6.2" class="ltx_Math" alttext="g(f(\cdot))" display="inline"><semantics id="S2.SS2.p2.6.m6.2a"><mrow id="S2.SS2.p2.6.m6.2.2" xref="S2.SS2.p2.6.m6.2.2.cmml"><mi id="S2.SS2.p2.6.m6.2.2.3" xref="S2.SS2.p2.6.m6.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.2.2.2" xref="S2.SS2.p2.6.m6.2.2.2.cmml">​</mo><mrow id="S2.SS2.p2.6.m6.2.2.1.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.6.m6.2.2.1.1.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.6.m6.2.2.1.1.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.6.m6.2.2.1.1.1.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.2.2.1.1.1.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.1.cmml">​</mo><mrow id="S2.SS2.p2.6.m6.2.2.1.1.1.3.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.6.m6.2.2.1.1.1.3.2.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p2.6.m6.2.2.1.1.1.3.2.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS2.p2.6.m6.2.2.1.1.3" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.2b"><apply id="S2.SS2.p2.6.m6.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2"><times id="S2.SS2.p2.6.m6.2.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2.2"></times><ci id="S2.SS2.p2.6.m6.2.2.3.cmml" xref="S2.SS2.p2.6.m6.2.2.3">𝑔</ci><apply id="S2.SS2.p2.6.m6.2.2.1.1.1.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1"><times id="S2.SS2.p2.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.1"></times><ci id="S2.SS2.p2.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2">𝑓</ci><ci id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.2c">g(f(\cdot))</annotation></semantics></math>, which tries to maximize agreement between differently augmented views of the same image. Specifically, given <math id="S2.SS2.p2.7.m7.1" class="ltx_Math" alttext="2N" display="inline"><semantics id="S2.SS2.p2.7.m7.1a"><mrow id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml"><mn id="S2.SS2.p2.7.m7.1.1.2" xref="S2.SS2.p2.7.m7.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p2.7.m7.1.1.1" xref="S2.SS2.p2.7.m7.1.1.1.cmml">​</mo><mi id="S2.SS2.p2.7.m7.1.1.3" xref="S2.SS2.p2.7.m7.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><apply id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1"><times id="S2.SS2.p2.7.m7.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1"></times><cn type="integer" id="S2.SS2.p2.7.m7.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1.2">2</cn><ci id="S2.SS2.p2.7.m7.1.1.3.cmml" xref="S2.SS2.p2.7.m7.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">2N</annotation></semantics></math> augmented views and a pair of view <math id="S2.SS2.p2.8.m8.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.SS2.p2.8.m8.1a"><msub id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml"><mi id="S2.SS2.p2.8.m8.1.1.2" xref="S2.SS2.p2.8.m8.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.8.m8.1.1.3" xref="S2.SS2.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.1b"><apply id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.p2.8.m8.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.2">𝑥</ci><ci id="S2.SS2.p2.8.m8.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">x_{i}</annotation></semantics></math> and <math id="S2.SS2.p2.9.m9.1" class="ltx_Math" alttext="x_{j}" display="inline"><semantics id="S2.SS2.p2.9.m9.1a"><msub id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml"><mi id="S2.SS2.p2.9.m9.1.1.2" xref="S2.SS2.p2.9.m9.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.9.m9.1.1.3" xref="S2.SS2.p2.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.1b"><apply id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S2.SS2.p2.9.m9.1.1.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2">𝑥</ci><ci id="S2.SS2.p2.9.m9.1.1.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.1c">x_{j}</annotation></semantics></math> of same image, the contrastive loss for this pair is defined as</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.7" class="ltx_Math" alttext="l_{i,j}=-\log{\frac{\exp(\textrm{sim}(x_{i},x_{j})/\tau)}{\sum_{k=1}^{2N}\mathbb{I}_{[k\neq i]}\exp(\textrm{sim}(x_{i},x_{k})/\tau)}}" display="block"><semantics id="S2.E1.m1.7a"><mrow id="S2.E1.m1.7.8" xref="S2.E1.m1.7.8.cmml"><msub id="S2.E1.m1.7.8.2" xref="S2.E1.m1.7.8.2.cmml"><mi id="S2.E1.m1.7.8.2.2" xref="S2.E1.m1.7.8.2.2.cmml">l</mi><mrow id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">i</mi><mo id="S2.E1.m1.2.2.2.4.1" xref="S2.E1.m1.2.2.2.3.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.E1.m1.7.8.1" xref="S2.E1.m1.7.8.1.cmml">=</mo><mrow id="S2.E1.m1.7.8.3" xref="S2.E1.m1.7.8.3.cmml"><mo rspace="0.167em" id="S2.E1.m1.7.8.3a" xref="S2.E1.m1.7.8.3.cmml">−</mo><mrow id="S2.E1.m1.7.8.3.2" xref="S2.E1.m1.7.8.3.2.cmml"><mi id="S2.E1.m1.7.8.3.2.1" xref="S2.E1.m1.7.8.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E1.m1.7.8.3.2a" xref="S2.E1.m1.7.8.3.2.cmml">⁡</mo><mfrac id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml"><mrow id="S2.E1.m1.4.4.2.2" xref="S2.E1.m1.4.4.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml">exp</mi><mo id="S2.E1.m1.4.4.2.2a" xref="S2.E1.m1.4.4.2.3.cmml">⁡</mo><mrow id="S2.E1.m1.4.4.2.2.1" xref="S2.E1.m1.4.4.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.2.2.1.2" xref="S2.E1.m1.4.4.2.3.cmml">(</mo><mrow id="S2.E1.m1.4.4.2.2.1.1" xref="S2.E1.m1.4.4.2.2.1.1.cmml"><mrow id="S2.E1.m1.4.4.2.2.1.1.2" xref="S2.E1.m1.4.4.2.2.1.1.2.cmml"><mtext id="S2.E1.m1.4.4.2.2.1.1.2.4" xref="S2.E1.m1.4.4.2.2.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.2.2.1.1.2.3" xref="S2.E1.m1.4.4.2.2.1.1.2.3.cmml">​</mo><mrow id="S2.E1.m1.4.4.2.2.1.1.2.2.2" xref="S2.E1.m1.4.4.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.2.2.1.1.2.2.2.3" xref="S2.E1.m1.4.4.2.2.1.1.2.2.3.cmml">(</mo><msub id="S2.E1.m1.4.4.2.2.1.1.1.1.1.1" xref="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.4.4.2.2.1.1.2.2.2.4" xref="S2.E1.m1.4.4.2.2.1.1.2.2.3.cmml">,</mo><msub id="S2.E1.m1.4.4.2.2.1.1.2.2.2.2" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.2" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.3" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S2.E1.m1.4.4.2.2.1.1.2.2.2.5" xref="S2.E1.m1.4.4.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.2.2.1.1.3" xref="S2.E1.m1.4.4.2.2.1.1.3.cmml">/</mo><mi id="S2.E1.m1.4.4.2.2.1.1.4" xref="S2.E1.m1.4.4.2.2.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S2.E1.m1.4.4.2.2.1.3" xref="S2.E1.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.7.7.5" xref="S2.E1.m1.7.7.5.cmml"><msubsup id="S2.E1.m1.7.7.5.4" xref="S2.E1.m1.7.7.5.4.cmml"><mo id="S2.E1.m1.7.7.5.4.2.2" xref="S2.E1.m1.7.7.5.4.2.2.cmml">∑</mo><mrow id="S2.E1.m1.7.7.5.4.2.3" xref="S2.E1.m1.7.7.5.4.2.3.cmml"><mi id="S2.E1.m1.7.7.5.4.2.3.2" xref="S2.E1.m1.7.7.5.4.2.3.2.cmml">k</mi><mo id="S2.E1.m1.7.7.5.4.2.3.1" xref="S2.E1.m1.7.7.5.4.2.3.1.cmml">=</mo><mn id="S2.E1.m1.7.7.5.4.2.3.3" xref="S2.E1.m1.7.7.5.4.2.3.3.cmml">1</mn></mrow><mrow id="S2.E1.m1.7.7.5.4.3" xref="S2.E1.m1.7.7.5.4.3.cmml"><mn id="S2.E1.m1.7.7.5.4.3.2" xref="S2.E1.m1.7.7.5.4.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.5.4.3.1" xref="S2.E1.m1.7.7.5.4.3.1.cmml">​</mo><mi id="S2.E1.m1.7.7.5.4.3.3" xref="S2.E1.m1.7.7.5.4.3.3.cmml">N</mi></mrow></msubsup><mrow id="S2.E1.m1.7.7.5.3" xref="S2.E1.m1.7.7.5.3.cmml"><msub id="S2.E1.m1.7.7.5.3.3" xref="S2.E1.m1.7.7.5.3.3.cmml"><mi id="S2.E1.m1.7.7.5.3.3.2" xref="S2.E1.m1.7.7.5.3.3.2.cmml">𝕀</mi><mrow id="S2.E1.m1.5.5.3.1.1.1" xref="S2.E1.m1.5.5.3.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.3.1.1.1.2" xref="S2.E1.m1.5.5.3.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.5.5.3.1.1.1.1" xref="S2.E1.m1.5.5.3.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.3.1.1.1.1.2" xref="S2.E1.m1.5.5.3.1.1.1.1.2.cmml">k</mi><mo id="S2.E1.m1.5.5.3.1.1.1.1.1" xref="S2.E1.m1.5.5.3.1.1.1.1.1.cmml">≠</mo><mi id="S2.E1.m1.5.5.3.1.1.1.1.3" xref="S2.E1.m1.5.5.3.1.1.1.1.3.cmml">i</mi></mrow><mo stretchy="false" id="S2.E1.m1.5.5.3.1.1.1.3" xref="S2.E1.m1.5.5.3.1.1.2.1.cmml">]</mo></mrow></msub><mo lspace="0.167em" rspace="0em" id="S2.E1.m1.7.7.5.3.2" xref="S2.E1.m1.7.7.5.3.2.cmml">​</mo><mrow id="S2.E1.m1.7.7.5.3.1.1" xref="S2.E1.m1.7.7.5.3.1.2.cmml"><mi id="S2.E1.m1.6.6.4.2" xref="S2.E1.m1.6.6.4.2.cmml">exp</mi><mo id="S2.E1.m1.7.7.5.3.1.1a" xref="S2.E1.m1.7.7.5.3.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.7.7.5.3.1.1.1" xref="S2.E1.m1.7.7.5.3.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.1.2" xref="S2.E1.m1.7.7.5.3.1.2.cmml">(</mo><mrow id="S2.E1.m1.7.7.5.3.1.1.1.1" xref="S2.E1.m1.7.7.5.3.1.1.1.1.cmml"><mrow id="S2.E1.m1.7.7.5.3.1.1.1.1.2" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.cmml"><mtext id="S2.E1.m1.7.7.5.3.1.1.1.1.2.4" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.5.3.1.1.1.1.2.3" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.3" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.4" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.2" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.3" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.5" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.7.7.5.3.1.1.1.1.3" xref="S2.E1.m1.7.7.5.3.1.1.1.1.3.cmml">/</mo><mi id="S2.E1.m1.7.7.5.3.1.1.1.1.4" xref="S2.E1.m1.7.7.5.3.1.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S2.E1.m1.7.7.5.3.1.1.1.3" xref="S2.E1.m1.7.7.5.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.7b"><apply id="S2.E1.m1.7.8.cmml" xref="S2.E1.m1.7.8"><eq id="S2.E1.m1.7.8.1.cmml" xref="S2.E1.m1.7.8.1"></eq><apply id="S2.E1.m1.7.8.2.cmml" xref="S2.E1.m1.7.8.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.8.2.1.cmml" xref="S2.E1.m1.7.8.2">subscript</csymbol><ci id="S2.E1.m1.7.8.2.2.cmml" xref="S2.E1.m1.7.8.2.2">𝑙</ci><list id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.4"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑖</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S2.E1.m1.7.8.3.cmml" xref="S2.E1.m1.7.8.3"><minus id="S2.E1.m1.7.8.3.1.cmml" xref="S2.E1.m1.7.8.3"></minus><apply id="S2.E1.m1.7.8.3.2.cmml" xref="S2.E1.m1.7.8.3.2"><log id="S2.E1.m1.7.8.3.2.1.cmml" xref="S2.E1.m1.7.8.3.2.1"></log><apply id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7"><divide id="S2.E1.m1.7.7.6.cmml" xref="S2.E1.m1.7.7"></divide><apply id="S2.E1.m1.4.4.2.3.cmml" xref="S2.E1.m1.4.4.2.2"><exp id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1"></exp><apply id="S2.E1.m1.4.4.2.2.1.1.cmml" xref="S2.E1.m1.4.4.2.2.1.1"><divide id="S2.E1.m1.4.4.2.2.1.1.3.cmml" xref="S2.E1.m1.4.4.2.2.1.1.3"></divide><apply id="S2.E1.m1.4.4.2.2.1.1.2.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2"><times id="S2.E1.m1.4.4.2.2.1.1.2.3.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.3"></times><ci id="S2.E1.m1.4.4.2.2.1.1.2.4a.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.4"><mtext id="S2.E1.m1.4.4.2.2.1.1.2.4.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S2.E1.m1.4.4.2.2.1.1.2.2.3.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2"><apply id="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.2">𝑥</ci><ci id="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.4.4.2.2.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><ci id="S2.E1.m1.4.4.2.2.1.1.4.cmml" xref="S2.E1.m1.4.4.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S2.E1.m1.7.7.5.cmml" xref="S2.E1.m1.7.7.5"><apply id="S2.E1.m1.7.7.5.4.cmml" xref="S2.E1.m1.7.7.5.4"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.4.1.cmml" xref="S2.E1.m1.7.7.5.4">superscript</csymbol><apply id="S2.E1.m1.7.7.5.4.2.cmml" xref="S2.E1.m1.7.7.5.4"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.4.2.1.cmml" xref="S2.E1.m1.7.7.5.4">subscript</csymbol><sum id="S2.E1.m1.7.7.5.4.2.2.cmml" xref="S2.E1.m1.7.7.5.4.2.2"></sum><apply id="S2.E1.m1.7.7.5.4.2.3.cmml" xref="S2.E1.m1.7.7.5.4.2.3"><eq id="S2.E1.m1.7.7.5.4.2.3.1.cmml" xref="S2.E1.m1.7.7.5.4.2.3.1"></eq><ci id="S2.E1.m1.7.7.5.4.2.3.2.cmml" xref="S2.E1.m1.7.7.5.4.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.7.7.5.4.2.3.3.cmml" xref="S2.E1.m1.7.7.5.4.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.7.7.5.4.3.cmml" xref="S2.E1.m1.7.7.5.4.3"><times id="S2.E1.m1.7.7.5.4.3.1.cmml" xref="S2.E1.m1.7.7.5.4.3.1"></times><cn type="integer" id="S2.E1.m1.7.7.5.4.3.2.cmml" xref="S2.E1.m1.7.7.5.4.3.2">2</cn><ci id="S2.E1.m1.7.7.5.4.3.3.cmml" xref="S2.E1.m1.7.7.5.4.3.3">𝑁</ci></apply></apply><apply id="S2.E1.m1.7.7.5.3.cmml" xref="S2.E1.m1.7.7.5.3"><times id="S2.E1.m1.7.7.5.3.2.cmml" xref="S2.E1.m1.7.7.5.3.2"></times><apply id="S2.E1.m1.7.7.5.3.3.cmml" xref="S2.E1.m1.7.7.5.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.3.3.1.cmml" xref="S2.E1.m1.7.7.5.3.3">subscript</csymbol><ci id="S2.E1.m1.7.7.5.3.3.2.cmml" xref="S2.E1.m1.7.7.5.3.3.2">𝕀</ci><apply id="S2.E1.m1.5.5.3.1.1.2.cmml" xref="S2.E1.m1.5.5.3.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.5.5.3.1.1.2.1.cmml" xref="S2.E1.m1.5.5.3.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.5.5.3.1.1.1.1.cmml" xref="S2.E1.m1.5.5.3.1.1.1.1"><neq id="S2.E1.m1.5.5.3.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.3.1.1.1.1.1"></neq><ci id="S2.E1.m1.5.5.3.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.3.1.1.1.1.2">𝑘</ci><ci id="S2.E1.m1.5.5.3.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.3.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S2.E1.m1.7.7.5.3.1.2.cmml" xref="S2.E1.m1.7.7.5.3.1.1"><exp id="S2.E1.m1.6.6.4.2.cmml" xref="S2.E1.m1.6.6.4.2"></exp><apply id="S2.E1.m1.7.7.5.3.1.1.1.1.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1"><divide id="S2.E1.m1.7.7.5.3.1.1.1.1.3.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.3"></divide><apply id="S2.E1.m1.7.7.5.3.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2"><times id="S2.E1.m1.7.7.5.3.1.1.1.1.2.3.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.3"></times><ci id="S2.E1.m1.7.7.5.3.1.1.1.1.2.4a.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.4"><mtext id="S2.E1.m1.7.7.5.3.1.1.1.1.2.4.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2"><apply id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></interval></apply><ci id="S2.E1.m1.7.7.5.3.1.1.1.1.4.cmml" xref="S2.E1.m1.7.7.5.3.1.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.7c">l_{i,j}=-\log{\frac{\exp(\textrm{sim}(x_{i},x_{j})/\tau)}{\sum_{k=1}^{2N}\mathbb{I}_{[k\neq i]}\exp(\textrm{sim}(x_{i},x_{k})/\tau)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.2" class="ltx_p">where <math id="S2.SS2.p4.1.m1.2" class="ltx_Math" alttext="\textrm{sim}(\cdot,\cdot)" display="inline"><semantics id="S2.SS2.p4.1.m1.2a"><mrow id="S2.SS2.p4.1.m1.2.3" xref="S2.SS2.p4.1.m1.2.3.cmml"><mtext id="S2.SS2.p4.1.m1.2.3.2" xref="S2.SS2.p4.1.m1.2.3.2a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S2.SS2.p4.1.m1.2.3.1" xref="S2.SS2.p4.1.m1.2.3.1.cmml">​</mo><mrow id="S2.SS2.p4.1.m1.2.3.3.2" xref="S2.SS2.p4.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p4.1.m1.2.3.3.2.1" xref="S2.SS2.p4.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS2.p4.1.m1.2.3.3.2.2" xref="S2.SS2.p4.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p4.1.m1.2.2" xref="S2.SS2.p4.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p4.1.m1.2.3.3.2.3" xref="S2.SS2.p4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.2b"><apply id="S2.SS2.p4.1.m1.2.3.cmml" xref="S2.SS2.p4.1.m1.2.3"><times id="S2.SS2.p4.1.m1.2.3.1.cmml" xref="S2.SS2.p4.1.m1.2.3.1"></times><ci id="S2.SS2.p4.1.m1.2.3.2a.cmml" xref="S2.SS2.p4.1.m1.2.3.2"><mtext id="S2.SS2.p4.1.m1.2.3.2.cmml" xref="S2.SS2.p4.1.m1.2.3.2">sim</mtext></ci><interval closure="open" id="S2.SS2.p4.1.m1.2.3.3.1.cmml" xref="S2.SS2.p4.1.m1.2.3.3.2"><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">⋅</ci><ci id="S2.SS2.p4.1.m1.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.2c">\textrm{sim}(\cdot,\cdot)</annotation></semantics></math> is a cosine similarity function and <math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><mi id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><ci id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">\tau</annotation></semantics></math> denotes a temperature parameter. The final loss is computed by summing the contrastive loss of all pairs of the same image in a mini-batch.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.1" class="ltx_p">Besides SimCLR, there are also other contrastive learning frameworks such as CPC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, CMC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> and MoCo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. We choose SimCLR for its simplicity and effectiveness in many computer vision tasks. Still, the basic idea of contrastive learning is similar among these studies: the representations obtained from different images should be far from each other and the representations obtained from the same image should be related to each other. The idea is intuitive and has been shown to be effective.</p>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<p id="S2.SS2.p6.1" class="ltx_p">There is one recent study <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> that combines federated learning with contrastive learning. They focus on the unsupervised learning setting. Like SimCLR, they use contrastive loss to compare the representations of different images. In this paper, we focus on the supervised learning setting and propose model-contrastive learning to compare representations learned by different models.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Model-Contrastive Federated Learning</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Statement</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">Suppose there are <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N</annotation></semantics></math> parties, denoted <math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="P_{1},...,P_{N}" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3.2" xref="S3.SS1.p1.2.m2.3.3.3.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.2.cmml">P</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.3.2.4" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">P</mi><mi id="S3.SS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><list id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.2">𝑃</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">𝑃</ci><ci id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">P_{1},...,P_{N}</annotation></semantics></math>. Party <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑃</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">P_{i}</annotation></semantics></math> has a local dataset <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}^{i}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝒟</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{D}^{i}</annotation></semantics></math>. Our goal is to learn a machine learning model <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">w</annotation></semantics></math> over the dataset <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}\triangleq\bigcup_{i\in[N]}\mathcal{D}^{i}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.2" xref="S3.SS1.p1.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.2.2" xref="S3.SS1.p1.6.m6.1.2.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.SS1.p1.6.m6.1.2.1" xref="S3.SS1.p1.6.m6.1.2.1.cmml">≜</mo><mrow id="S3.SS1.p1.6.m6.1.2.3" xref="S3.SS1.p1.6.m6.1.2.3.cmml"><msub id="S3.SS1.p1.6.m6.1.2.3.1" xref="S3.SS1.p1.6.m6.1.2.3.1.cmml"><mo id="S3.SS1.p1.6.m6.1.2.3.1.2" xref="S3.SS1.p1.6.m6.1.2.3.1.2.cmml">⋃</mo><mrow id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.3.cmml">i</mi><mo id="S3.SS1.p1.6.m6.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.2.cmml">∈</mo><mrow id="S3.SS1.p1.6.m6.1.1.1.4.2" xref="S3.SS1.p1.6.m6.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.1.1.1.4.2.1" xref="S3.SS1.p1.6.m6.1.1.1.4.1.1.cmml">[</mo><mi id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.cmml">N</mi><mo stretchy="false" id="S3.SS1.p1.6.m6.1.1.1.4.2.2" xref="S3.SS1.p1.6.m6.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msup id="S3.SS1.p1.6.m6.1.2.3.2" xref="S3.SS1.p1.6.m6.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.2.3.2.2" xref="S3.SS1.p1.6.m6.1.2.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.6.m6.1.2.3.2.3" xref="S3.SS1.p1.6.m6.1.2.3.2.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><ci id="S3.SS1.p1.6.m6.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.1">≜</ci><ci id="S3.SS1.p1.6.m6.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2">𝒟</ci><apply id="S3.SS1.p1.6.m6.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3"><apply id="S3.SS1.p1.6.m6.1.2.3.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.3.1.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.1">subscript</csymbol><union id="S3.SS1.p1.6.m6.1.2.3.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.1.2"></union><apply id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.2"></in><ci id="S3.SS1.p1.6.m6.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.3">𝑖</ci><apply id="S3.SS1.p1.6.m6.1.1.1.4.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.4.2"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.1.4.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1">𝑁</ci></apply></apply></apply><apply id="S3.SS1.p1.6.m6.1.2.3.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2.2">𝒟</ci><ci id="S3.SS1.p1.6.m6.1.2.3.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathcal{D}\triangleq\bigcup_{i\in[N]}\mathcal{D}^{i}</annotation></semantics></math> with the help of a central server, while the raw data are not exchanged. The objective is to solve</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.5" class="ltx_Math" alttext="\operatorname*{arg\,min}_{w}\mathcal{L}(w)=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w)," display="block"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><mrow id="S3.E2.m1.5.5.1.1.2.2" xref="S3.E2.m1.5.5.1.1.2.2.cmml"><munder id="S3.E2.m1.5.5.1.1.2.2.1" xref="S3.E2.m1.5.5.1.1.2.2.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.2.2.1.2" xref="S3.E2.m1.5.5.1.1.2.2.1.2.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.1.2.2" xref="S3.E2.m1.5.5.1.1.2.2.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E2.m1.5.5.1.1.2.2.1.2.1" xref="S3.E2.m1.5.5.1.1.2.2.1.2.1.cmml">​</mo><mi id="S3.E2.m1.5.5.1.1.2.2.1.2.3" xref="S3.E2.m1.5.5.1.1.2.2.1.2.3.cmml">min</mi></mrow><mi id="S3.E2.m1.5.5.1.1.2.2.1.3" xref="S3.E2.m1.5.5.1.1.2.2.1.3.cmml">w</mi></munder><mo lspace="0.167em" id="S3.E2.m1.5.5.1.1.2.2a" xref="S3.E2.m1.5.5.1.1.2.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.2.1" xref="S3.E2.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.2.3.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.2.3.2.1" xref="S3.E2.m1.5.5.1.1.2.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">w</mi><mo stretchy="false" id="S3.E2.m1.5.5.1.1.2.3.2.2" xref="S3.E2.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.5.5.1.1.1" xref="S3.E2.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><munderover id="S3.E2.m1.5.5.1.1.3.1" xref="S3.E2.m1.5.5.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.5.5.1.1.3.1.2.2" xref="S3.E2.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.1.1.3.1.2.3" xref="S3.E2.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.3.1.2.3.2" xref="S3.E2.m1.5.5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.3.1.2.3.1" xref="S3.E2.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.5.5.1.1.3.1.2.3.3" xref="S3.E2.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.5.5.1.1.3.1.3" xref="S3.E2.m1.5.5.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.5.5.1.1.3.2" xref="S3.E2.m1.5.5.1.1.3.2.cmml"><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><msup id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.3.1" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.1" xref="S3.E2.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E2.m1.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.3.2.1" xref="S3.E2.m1.5.5.1.1.3.2.1.cmml">​</mo><msub id="S3.E2.m1.5.5.1.1.3.2.2" xref="S3.E2.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E2.m1.5.5.1.1.3.2.2.2" xref="S3.E2.m1.5.5.1.1.3.2.2.2.cmml">L</mi><mi id="S3.E2.m1.5.5.1.1.3.2.2.3" xref="S3.E2.m1.5.5.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.3.2.1a" xref="S3.E2.m1.5.5.1.1.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.3.2.3.2" xref="S3.E2.m1.5.5.1.1.3.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.3.2.3.2.1" xref="S3.E2.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">w</mi><mo stretchy="false" id="S3.E2.m1.5.5.1.1.3.2.3.2.2" xref="S3.E2.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1"></eq><apply id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><times id="S3.E2.m1.5.5.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.1"></times><apply id="S3.E2.m1.5.5.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2"><apply id="S3.E2.m1.5.5.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1">subscript</csymbol><apply id="S3.E2.m1.5.5.1.1.2.2.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.2"><times id="S3.E2.m1.5.5.1.1.2.2.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.2.1"></times><ci id="S3.E2.m1.5.5.1.1.2.2.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.2.2">arg</ci><ci id="S3.E2.m1.5.5.1.1.2.2.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.2.3">min</ci></apply><ci id="S3.E2.m1.5.5.1.1.2.2.1.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.3">𝑤</ci></apply><ci id="S3.E2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2">ℒ</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑤</ci></apply><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"><apply id="S3.E2.m1.5.5.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.1.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.3.1.2.cmml" xref="S3.E2.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.5.5.1.1.3.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.2"></sum><apply id="S3.E2.m1.5.5.1.1.3.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3"><eq id="S3.E2.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.5.5.1.1.3.1.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.5.5.1.1.3.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E2.m1.5.5.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2"><times id="S3.E2.m1.5.5.1.1.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.2.1"></times><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2"></divide><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2"></abs><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.3"><abs id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.3.1"></abs><ci id="S3.E2.m1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2.2">𝐿</ci><ci id="S3.E2.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2.3">𝑖</ci></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\operatorname*{arg\,min}_{w}\mathcal{L}(w)=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.8" class="ltx_p">where <math id="S3.SS1.p1.7.m1.7" class="ltx_Math" alttext="L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x,y))]" display="inline"><semantics id="S3.SS1.p1.7.m1.7a"><mrow id="S3.SS1.p1.7.m1.7.7" xref="S3.SS1.p1.7.m1.7.7.cmml"><mrow id="S3.SS1.p1.7.m1.7.7.3" xref="S3.SS1.p1.7.m1.7.7.3.cmml"><msub id="S3.SS1.p1.7.m1.7.7.3.2" xref="S3.SS1.p1.7.m1.7.7.3.2.cmml"><mi id="S3.SS1.p1.7.m1.7.7.3.2.2" xref="S3.SS1.p1.7.m1.7.7.3.2.2.cmml">L</mi><mi id="S3.SS1.p1.7.m1.7.7.3.2.3" xref="S3.SS1.p1.7.m1.7.7.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.7.7.3.1" xref="S3.SS1.p1.7.m1.7.7.3.1.cmml">​</mo><mrow id="S3.SS1.p1.7.m1.7.7.3.3.2" xref="S3.SS1.p1.7.m1.7.7.3.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.3.3.2.1" xref="S3.SS1.p1.7.m1.7.7.3.cmml">(</mo><mi id="S3.SS1.p1.7.m1.3.3" xref="S3.SS1.p1.7.m1.3.3.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.3.3.2.2" xref="S3.SS1.p1.7.m1.7.7.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.7.m1.7.7.2" xref="S3.SS1.p1.7.m1.7.7.2.cmml">=</mo><mrow id="S3.SS1.p1.7.m1.7.7.1" xref="S3.SS1.p1.7.m1.7.7.1.cmml"><msub id="S3.SS1.p1.7.m1.7.7.1.3" xref="S3.SS1.p1.7.m1.7.7.1.3.cmml"><mi id="S3.SS1.p1.7.m1.7.7.1.3.2" xref="S3.SS1.p1.7.m1.7.7.1.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p1.7.m1.2.2.2" xref="S3.SS1.p1.7.m1.2.2.2.cmml"><mrow id="S3.SS1.p1.7.m1.2.2.2.4.2" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.2.2.2.4.2.1" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.SS1.p1.7.m1.1.1.1.1" xref="S3.SS1.p1.7.m1.1.1.1.1.cmml">x</mi><mo id="S3.SS1.p1.7.m1.2.2.2.4.2.2" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.SS1.p1.7.m1.2.2.2.2" xref="S3.SS1.p1.7.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.7.m1.2.2.2.4.2.3" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS1.p1.7.m1.2.2.2.3" xref="S3.SS1.p1.7.m1.2.2.2.3.cmml">∼</mo><msup id="S3.SS1.p1.7.m1.2.2.2.5" xref="S3.SS1.p1.7.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m1.2.2.2.5.2" xref="S3.SS1.p1.7.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.SS1.p1.7.m1.2.2.2.5.3" xref="S3.SS1.p1.7.m1.2.2.2.5.3.cmml">i</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.7.7.1.2" xref="S3.SS1.p1.7.m1.7.7.1.2.cmml">​</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1" xref="S3.SS1.p1.7.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1.1" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.cmml"><msub id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2.cmml">ℓ</mi><mi id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p1.7.m1.6.6" xref="S3.SS1.p1.7.m1.6.6.cmml">w</mi><mo id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml">;</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.7.m1.4.4" xref="S3.SS1.p1.7.m1.4.4.cmml">x</mi><mo id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml">,</mo><mi id="S3.SS1.p1.7.m1.5.5" xref="S3.SS1.p1.7.m1.5.5.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.4" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.3" xref="S3.SS1.p1.7.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m1.7b"><apply id="S3.SS1.p1.7.m1.7.7.cmml" xref="S3.SS1.p1.7.m1.7.7"><eq id="S3.SS1.p1.7.m1.7.7.2.cmml" xref="S3.SS1.p1.7.m1.7.7.2"></eq><apply id="S3.SS1.p1.7.m1.7.7.3.cmml" xref="S3.SS1.p1.7.m1.7.7.3"><times id="S3.SS1.p1.7.m1.7.7.3.1.cmml" xref="S3.SS1.p1.7.m1.7.7.3.1"></times><apply id="S3.SS1.p1.7.m1.7.7.3.2.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.7.7.3.2.1.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2">subscript</csymbol><ci id="S3.SS1.p1.7.m1.7.7.3.2.2.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2.2">𝐿</ci><ci id="S3.SS1.p1.7.m1.7.7.3.2.3.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.7.m1.3.3.cmml" xref="S3.SS1.p1.7.m1.3.3">𝑤</ci></apply><apply id="S3.SS1.p1.7.m1.7.7.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1"><times id="S3.SS1.p1.7.m1.7.7.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.2"></times><apply id="S3.SS1.p1.7.m1.7.7.1.3.cmml" xref="S3.SS1.p1.7.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.7.7.1.3.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m1.7.7.1.3.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.3.2">𝔼</ci><apply id="S3.SS1.p1.7.m1.2.2.2.cmml" xref="S3.SS1.p1.7.m1.2.2.2"><csymbol cd="latexml" id="S3.SS1.p1.7.m1.2.2.2.3.cmml" xref="S3.SS1.p1.7.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.SS1.p1.7.m1.2.2.2.4.1.cmml" xref="S3.SS1.p1.7.m1.2.2.2.4.2"><ci id="S3.SS1.p1.7.m1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.1.1.1.1">𝑥</ci><ci id="S3.SS1.p1.7.m1.2.2.2.2.cmml" xref="S3.SS1.p1.7.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.SS1.p1.7.m1.2.2.2.5.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.2.2.2.5.1.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5">superscript</csymbol><ci id="S3.SS1.p1.7.m1.2.2.2.5.2.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5.2">𝒟</ci><ci id="S3.SS1.p1.7.m1.2.2.2.5.3.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.SS1.p1.7.m1.7.7.1.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.7.m1.7.7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.7.m1.7.7.1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1"><times id="S3.SS1.p1.7.m1.7.7.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.2"></times><apply id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2">ℓ</ci><ci id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3">𝑖</ci></apply><list id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1"><ci id="S3.SS1.p1.7.m1.6.6.cmml" xref="S3.SS1.p1.7.m1.6.6">𝑤</ci><interval closure="open" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2"><ci id="S3.SS1.p1.7.m1.4.4.cmml" xref="S3.SS1.p1.7.m1.4.4">𝑥</ci><ci id="S3.SS1.p1.7.m1.5.5.cmml" xref="S3.SS1.p1.7.m1.5.5">𝑦</ci></interval></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m1.7c">L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x,y))]</annotation></semantics></math> is the empirical loss of <math id="S3.SS1.p1.8.m2.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS1.p1.8.m2.1a"><msub id="S3.SS1.p1.8.m2.1.1" xref="S3.SS1.p1.8.m2.1.1.cmml"><mi id="S3.SS1.p1.8.m2.1.1.2" xref="S3.SS1.p1.8.m2.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.8.m2.1.1.3" xref="S3.SS1.p1.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m2.1b"><apply id="S3.SS1.p1.8.m2.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m2.1.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m2.1.1.2.cmml" xref="S3.SS1.p1.8.m2.1.1.2">𝑃</ci><ci id="S3.SS1.p1.8.m2.1.1.3.cmml" xref="S3.SS1.p1.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m2.1c">P_{i}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Motivation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">MOON is based on an intuitive idea: the model trained on the whole dataset is able to extract a better feature representation than the model trained on a skewed subset. For example, given a model trained on dog and cat images, we cannot expect the features learned by the model to distinguish birds and frogs which never exist during training.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">To further verify this intuition, we conduct a simple experiment on CIFAR-10. Specifically, we first train a CNN model (see Section <a href="#S4.SS1" title="4.1 Experimental Setup ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> for the detailed structure) on CIFAR-10. We use t-SNE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> to visualize the hidden vectors of images from the test dataset as shown in Figure <a href="#S3.F2.sf1" title="In Figure 2 ‣ 3.2 Motivation ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2a</span></a>. Then, we partition the dataset into 10 subsets in an unbalanced way (see Section <a href="#S4.SS1" title="4.1 Experimental Setup ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> for the partition strategy) and train a CNN model on each subset. Figure <a href="#S3.F2.sf2" title="In Figure 2 ‣ 3.2 Motivation ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2b</span></a> shows the t-SNE visualization of a randomly selected model. Apparently, the model trained on the subset learns poor features. The feature representations of most classes are even mixed and cannot be distinguished. Then, we run FedAvg algorithm on 10 subsets and show the representation learned by the global model in Figure <a href="#S3.F2.sf3" title="In Figure 2 ‣ 3.2 Motivation ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2c</span></a> and the representation learned by a selected local model (trained based on the global model) in Figure <a href="#S3.F2.sf4" title="In Figure 2 ‣ 3.2 Motivation ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2d</span></a>. We can observe that the points with the same class are more divergent in Figure <a href="#S3.F2.sf4" title="In Figure 2 ‣ 3.2 Motivation ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2d</span></a> compared with Figure <a href="#S3.F2.sf3" title="In Figure 2 ‣ 3.2 Motivation ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2c</span></a> (<span id="S3.SS2.p2.1.1" class="ltx_ERROR undefined">\eg</span>, see class 9). The local training phase even leads the model to learn a worse representation due to the skewed local data distribution. This further verifies that the global model should be able to learn a better feature representation than the local model, and there is a <em id="S3.SS2.p2.1.2" class="ltx_emph ltx_font_italic">drift</em> in the local updates. Therefore, under non-IID data scenarios, we should control the drift and bridge the gap between the representations learned by the local model and the global model.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x2.png" id="S3.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="230" height="172" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>global model</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x3.png" id="S3.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="230" height="173" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>local model</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x4.png" id="S3.F2.sf3.g1" class="ltx_graphics ltx_img_landscape" width="230" height="173" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FedAvg global model</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x5.png" id="S3.F2.sf4.g1" class="ltx_graphics ltx_img_landscape" width="230" height="173" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>FedAvg local model</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>T-SNE visualizations of hidden vectors on CIFAR-10.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Method</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Based on the above intuition, we propose MOON. MOON is designed as a simple and effective approach based on FedAvg, only introducing lightweight but novel modifications in the local training phase. Since there is always drift in local training and the global model learns a better representation than the local model, MOON aims to decrease the distance between the representation learned by the local model and the representation learned by the global model, and increase the distance between the representation learned by the local model and the representation learned by the previous local model. We achieve this from the inspiration of contrastive learning, which is now mainly used to learn visual representations. In the following, we present the network architecture, the local learning objective and the learning procedure. At last, we discuss the relation to contrastive learning.</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Network Architecture</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.5" class="ltx_p">The network has three components: a base encoder, a projection head, and an output layer. The base encoder is used to extract representation vectors from inputs. Like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, an additional projection head is introduced to map the representation to a space with a fixed dimension. Last, as we study on the supervised setting, the output layer is used to produce predicted values for each class. For ease of presentation, with model weight <math id="S3.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">w</annotation></semantics></math>, we use <math id="S3.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="F_{w}(\cdot)" display="inline"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.p1.2.m2.1.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.cmml"><msub id="S3.SS3.SSS1.p1.2.m2.1.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.1.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.2.cmml">F</mi><mi id="S3.SS3.SSS1.p1.2.m2.1.2.2.3" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.2.m2.1.2.1" xref="S3.SS3.SSS1.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.2.m2.1.2.3.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.2.m2.1.2.3.2.1" xref="S3.SS3.SSS1.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS1.p1.2.m2.1.2.3.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><apply id="S3.SS3.SSS1.p1.2.m2.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2"><times id="S3.SS3.SSS1.p1.2.m2.1.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.1"></times><apply id="S3.SS3.SSS1.p1.2.m2.1.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.1.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.1.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.2">𝐹</ci><ci id="S3.SS3.SSS1.p1.2.m2.1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.3">𝑤</ci></apply><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">F_{w}(\cdot)</annotation></semantics></math> to denote the whole network and <math id="S3.SS3.SSS1.p1.3.m3.1" class="ltx_Math" alttext="R_{w}(\cdot)" display="inline"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><mrow id="S3.SS3.SSS1.p1.3.m3.1.2" xref="S3.SS3.SSS1.p1.3.m3.1.2.cmml"><msub id="S3.SS3.SSS1.p1.3.m3.1.2.2" xref="S3.SS3.SSS1.p1.3.m3.1.2.2.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.2.2.2" xref="S3.SS3.SSS1.p1.3.m3.1.2.2.2.cmml">R</mi><mi id="S3.SS3.SSS1.p1.3.m3.1.2.2.3" xref="S3.SS3.SSS1.p1.3.m3.1.2.2.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.3.m3.1.2.1" xref="S3.SS3.SSS1.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.3.m3.1.2.3.2" xref="S3.SS3.SSS1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.3.m3.1.2.3.2.1" xref="S3.SS3.SSS1.p1.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS1.p1.3.m3.1.2.3.2.2" xref="S3.SS3.SSS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><apply id="S3.SS3.SSS1.p1.3.m3.1.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.2"><times id="S3.SS3.SSS1.p1.3.m3.1.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.2.1"></times><apply id="S3.SS3.SSS1.p1.3.m3.1.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.2.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.2.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.2.2.2">𝑅</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.2.2.3">𝑤</ci></apply><ci id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">R_{w}(\cdot)</annotation></semantics></math> to denote the network before the output layer (i.e., <math id="S3.SS3.SSS1.p1.4.m4.1" class="ltx_Math" alttext="R_{w}(x)" display="inline"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><mrow id="S3.SS3.SSS1.p1.4.m4.1.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml"><msub id="S3.SS3.SSS1.p1.4.m4.1.2.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.2.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.1.2.2.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.2.2.cmml">R</mi><mi id="S3.SS3.SSS1.p1.4.m4.1.2.2.3" xref="S3.SS3.SSS1.p1.4.m4.1.2.2.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.4.m4.1.2.1" xref="S3.SS3.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.4.m4.1.2.3.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.4.m4.1.2.3.2.1" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.SSS1.p1.4.m4.1.2.3.2.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><apply id="S3.SS3.SSS1.p1.4.m4.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2"><times id="S3.SS3.SSS1.p1.4.m4.1.2.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2.1"></times><apply id="S3.SS3.SSS1.p1.4.m4.1.2.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.1.2.2.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.4.m4.1.2.2.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2.2.2">𝑅</ci><ci id="S3.SS3.SSS1.p1.4.m4.1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2.2.3">𝑤</ci></apply><ci id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">R_{w}(x)</annotation></semantics></math> is the mapped representation vector of input <math id="S3.SS3.SSS1.p1.5.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSS1.p1.5.m5.1a"><mi id="S3.SS3.SSS1.p1.5.m5.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m5.1b"><ci id="S3.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m5.1c">x</annotation></semantics></math>).</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Local Objective</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.2" class="ltx_p">As shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3.2 Local Objective ‣ 3.3 Method ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our local loss consists two parts. The first part is a typical loss term (<span id="S3.SS3.SSS2.p1.2.1" class="ltx_ERROR undefined">\eg</span>, cross-entropy loss) in supervised learning denoted as <math id="S3.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\ell_{sup}" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><msub id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.4" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">ℓ</ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3"><times id="S3.SS3.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.4">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\ell_{sup}</annotation></semantics></math>. The second part is our proposed model-contrastive loss term denoted as <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\ell_{con}" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><msub id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.SSS2.p1.2.m2.1.1.2" xref="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.SSS2.p1.2.m2.1.1.3" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.2.m2.1.1.3.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.2.m2.1.1.3.1a" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.2.m2.1.1.3.4" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><apply id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.2">ℓ</ci><apply id="S3.SS3.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3"><times id="S3.SS3.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS3.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.2">𝑐</ci><ci id="S3.SS3.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.3">𝑜</ci><ci id="S3.SS3.SSS2.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">\ell_{con}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.SSS2.p2" class="ltx_para">
<p id="S3.SS3.SSS2.p2.17" class="ltx_p">Suppose party <math id="S3.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><msub id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml">P</mi><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><apply id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2">𝑃</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">P_{i}</annotation></semantics></math> is conducting the local training. It receives the global model <math id="S3.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><msup id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.2.m2.1.1.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><apply id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">w^{t}</annotation></semantics></math> from the server and updates the model to <math id="S3.SS3.SSS2.p2.3.m3.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><msubsup id="S3.SS3.SSS2.p2.3.m3.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.3.m3.1.1.2.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.cmml">i</mi><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">w_{i}^{t}</annotation></semantics></math> in the local training phase. For every input <math id="S3.SS3.SSS2.p2.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSS2.p2.4.m4.1a"><mi id="S3.SS3.SSS2.p2.4.m4.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m4.1b"><ci id="S3.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m4.1c">x</annotation></semantics></math>, we extract the representation of <math id="S3.SS3.SSS2.p2.5.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSS2.p2.5.m5.1a"><mi id="S3.SS3.SSS2.p2.5.m5.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m5.1b"><ci id="S3.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m5.1c">x</annotation></semantics></math> from the global model <math id="S3.SS3.SSS2.p2.6.m6.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S3.SS3.SSS2.p2.6.m6.1a"><msup id="S3.SS3.SSS2.p2.6.m6.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m6.1b"><apply id="S3.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m6.1c">w^{t}</annotation></semantics></math> (i.e., <math id="S3.SS3.SSS2.p2.7.m7.1" class="ltx_Math" alttext="z_{glob}=R_{w^{t}}(x)" display="inline"><semantics id="S3.SS3.SSS2.p2.7.m7.1a"><mrow id="S3.SS3.SSS2.p2.7.m7.1.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.cmml"><msub id="S3.SS3.SSS2.p2.7.m7.1.2.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.2.2.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p2.7.m7.1.2.2.3" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.3" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1a" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.4" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1b" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.5" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.5.cmml">b</mi></mrow></msub><mo id="S3.SS3.SSS2.p2.7.m7.1.2.1" xref="S3.SS3.SSS2.p2.7.m7.1.2.1.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.7.m7.1.2.3" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.cmml"><msub id="S3.SS3.SSS2.p2.7.m7.1.2.3.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.2.cmml">R</mi><msup id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.3" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.3.cmml">t</mi></msup></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.7.m7.1.2.3.1" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.1.cmml">​</mo><mrow id="S3.SS3.SSS2.p2.7.m7.1.2.3.3.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p2.7.m7.1.2.3.3.2.1" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.cmml">(</mo><mi id="S3.SS3.SSS2.p2.7.m7.1.1" xref="S3.SS3.SSS2.p2.7.m7.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.7.m7.1.2.3.3.2.2" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m7.1b"><apply id="S3.SS3.SSS2.p2.7.m7.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2"><eq id="S3.SS3.SSS2.p2.7.m7.1.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.1"></eq><apply id="S3.SS3.SSS2.p2.7.m7.1.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.2">𝑧</ci><apply id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3"><times id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.1"></times><ci id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.2">𝑔</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.3">𝑙</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.4.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.4">𝑜</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.2.2.3.5.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.2.3.5">𝑏</ci></apply></apply><apply id="S3.SS3.SSS2.p2.7.m7.1.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3"><times id="S3.SS3.SSS2.p2.7.m7.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.1"></times><apply id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.2">𝑅</ci><apply id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.2.3.2.3.3">𝑡</ci></apply></apply><ci id="S3.SS3.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m7.1c">z_{glob}=R_{w^{t}}(x)</annotation></semantics></math>), the representation of <math id="S3.SS3.SSS2.p2.8.m8.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSS2.p2.8.m8.1a"><mi id="S3.SS3.SSS2.p2.8.m8.1.1" xref="S3.SS3.SSS2.p2.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m8.1b"><ci id="S3.SS3.SSS2.p2.8.m8.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m8.1c">x</annotation></semantics></math> from the local model of last round <math id="S3.SS3.SSS2.p2.9.m9.1" class="ltx_Math" alttext="w_{i}^{t-1}" display="inline"><semantics id="S3.SS3.SSS2.p2.9.m9.1a"><msubsup id="S3.SS3.SSS2.p2.9.m9.1.1" xref="S3.SS3.SSS2.p2.9.m9.1.1.cmml"><mi id="S3.SS3.SSS2.p2.9.m9.1.1.2.2" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.9.m9.1.1.2.3" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.3.cmml">i</mi><mrow id="S3.SS3.SSS2.p2.9.m9.1.1.3" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.9.m9.1.1.3.2" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p2.9.m9.1.1.3.1" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.9.m9.1.1.3.3" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m9.1b"><apply id="S3.SS3.SSS2.p2.9.m9.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m9.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p2.9.m9.1.1.2.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m9.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m9.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.9.m9.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p2.9.m9.1.1.3.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.3"><minus id="S3.SS3.SSS2.p2.9.m9.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.1"></minus><ci id="S3.SS3.SSS2.p2.9.m9.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSS2.p2.9.m9.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m9.1c">w_{i}^{t-1}</annotation></semantics></math> (i.e., <math id="S3.SS3.SSS2.p2.10.m10.1" class="ltx_Math" alttext="z_{prev}=R_{w_{i}^{t-1}}(x)" display="inline"><semantics id="S3.SS3.SSS2.p2.10.m10.1a"><mrow id="S3.SS3.SSS2.p2.10.m10.1.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.cmml"><msub id="S3.SS3.SSS2.p2.10.m10.1.2.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.10.m10.1.2.2.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p2.10.m10.1.2.2.3" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.3" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1a" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.4" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1b" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.5" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.5.cmml">v</mi></mrow></msub><mo id="S3.SS3.SSS2.p2.10.m10.1.2.1" xref="S3.SS3.SSS2.p2.10.m10.1.2.1.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.10.m10.1.2.3" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.cmml"><msub id="S3.SS3.SSS2.p2.10.m10.1.2.3.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.cmml"><mi id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.2.cmml">R</mi><msubsup id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.cmml"><mi id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.3" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.3.cmml">i</mi><mrow id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.1" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.3" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.3.cmml">1</mn></mrow></msubsup></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.10.m10.1.2.3.1" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.1.cmml">​</mo><mrow id="S3.SS3.SSS2.p2.10.m10.1.2.3.3.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p2.10.m10.1.2.3.3.2.1" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.cmml">(</mo><mi id="S3.SS3.SSS2.p2.10.m10.1.1" xref="S3.SS3.SSS2.p2.10.m10.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.10.m10.1.2.3.3.2.2" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.10.m10.1b"><apply id="S3.SS3.SSS2.p2.10.m10.1.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2"><eq id="S3.SS3.SSS2.p2.10.m10.1.2.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.1"></eq><apply id="S3.SS3.SSS2.p2.10.m10.1.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m10.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m10.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.2">𝑧</ci><apply id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3"><times id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.1"></times><ci id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.2">𝑝</ci><ci id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.3">𝑟</ci><ci id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.4.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.4">𝑒</ci><ci id="S3.SS3.SSS2.p2.10.m10.1.2.2.3.5.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.2.3.5">𝑣</ci></apply></apply><apply id="S3.SS3.SSS2.p2.10.m10.1.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3"><times id="S3.SS3.SSS2.p2.10.m10.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.1"></times><apply id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.2">𝑅</ci><apply id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3">superscript</csymbol><apply id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3"><minus id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.1"></minus><ci id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.SS3.SSS2.p2.10.m10.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.10.m10.1c">z_{prev}=R_{w_{i}^{t-1}}(x)</annotation></semantics></math>), and the representation of <math id="S3.SS3.SSS2.p2.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.SSS2.p2.11.m11.1a"><mi id="S3.SS3.SSS2.p2.11.m11.1.1" xref="S3.SS3.SSS2.p2.11.m11.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.11.m11.1b"><ci id="S3.SS3.SSS2.p2.11.m11.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m11.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.11.m11.1c">x</annotation></semantics></math> from the local model being updated <math id="S3.SS3.SSS2.p2.12.m12.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="S3.SS3.SSS2.p2.12.m12.1a"><msubsup id="S3.SS3.SSS2.p2.12.m12.1.1" xref="S3.SS3.SSS2.p2.12.m12.1.1.cmml"><mi id="S3.SS3.SSS2.p2.12.m12.1.1.2.2" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.12.m12.1.1.2.3" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.3.cmml">i</mi><mi id="S3.SS3.SSS2.p2.12.m12.1.1.3" xref="S3.SS3.SSS2.p2.12.m12.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.12.m12.1b"><apply id="S3.SS3.SSS2.p2.12.m12.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.12.m12.1.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p2.12.m12.1.1.2.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.12.m12.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.12.m12.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.12.m12.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS2.p2.12.m12.1.1.3.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.12.m12.1c">w_{i}^{t}</annotation></semantics></math> (i.e., <math id="S3.SS3.SSS2.p2.13.m13.1" class="ltx_Math" alttext="z=R_{w_{i}^{t}}(x)" display="inline"><semantics id="S3.SS3.SSS2.p2.13.m13.1a"><mrow id="S3.SS3.SSS2.p2.13.m13.1.2" xref="S3.SS3.SSS2.p2.13.m13.1.2.cmml"><mi id="S3.SS3.SSS2.p2.13.m13.1.2.2" xref="S3.SS3.SSS2.p2.13.m13.1.2.2.cmml">z</mi><mo id="S3.SS3.SSS2.p2.13.m13.1.2.1" xref="S3.SS3.SSS2.p2.13.m13.1.2.1.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.13.m13.1.2.3" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.cmml"><msub id="S3.SS3.SSS2.p2.13.m13.1.2.3.2" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.cmml"><mi id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.2" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.2.cmml">R</mi><msubsup id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.cmml"><mi id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.2" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.2.cmml">w</mi><mi id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.3" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.3.cmml">i</mi><mi id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.3" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.3.cmml">t</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.13.m13.1.2.3.1" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.1.cmml">​</mo><mrow id="S3.SS3.SSS2.p2.13.m13.1.2.3.3.2" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p2.13.m13.1.2.3.3.2.1" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.cmml">(</mo><mi id="S3.SS3.SSS2.p2.13.m13.1.1" xref="S3.SS3.SSS2.p2.13.m13.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.13.m13.1.2.3.3.2.2" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.13.m13.1b"><apply id="S3.SS3.SSS2.p2.13.m13.1.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2"><eq id="S3.SS3.SSS2.p2.13.m13.1.2.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.1"></eq><ci id="S3.SS3.SSS2.p2.13.m13.1.2.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.2">𝑧</ci><apply id="S3.SS3.SSS2.p2.13.m13.1.2.3.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3"><times id="S3.SS3.SSS2.p2.13.m13.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.1"></times><apply id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.2">𝑅</ci><apply id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3">superscript</csymbol><apply id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.2">𝑤</ci><ci id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.3.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.3.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.2.3.2.3.3">𝑡</ci></apply></apply><ci id="S3.SS3.SSS2.p2.13.m13.1.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.13.m13.1c">z=R_{w_{i}^{t}}(x)</annotation></semantics></math>). Since the global model should be able to extract better representations, our goal is to decrease the distance between <math id="S3.SS3.SSS2.p2.14.m14.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.SSS2.p2.14.m14.1a"><mi id="S3.SS3.SSS2.p2.14.m14.1.1" xref="S3.SS3.SSS2.p2.14.m14.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.14.m14.1b"><ci id="S3.SS3.SSS2.p2.14.m14.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m14.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.14.m14.1c">z</annotation></semantics></math> and <math id="S3.SS3.SSS2.p2.15.m15.1" class="ltx_Math" alttext="z_{glob}" display="inline"><semantics id="S3.SS3.SSS2.p2.15.m15.1a"><msub id="S3.SS3.SSS2.p2.15.m15.1.1" xref="S3.SS3.SSS2.p2.15.m15.1.1.cmml"><mi id="S3.SS3.SSS2.p2.15.m15.1.1.2" xref="S3.SS3.SSS2.p2.15.m15.1.1.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p2.15.m15.1.1.3" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.15.m15.1.1.3.2" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.15.m15.1.1.3.1" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.15.m15.1.1.3.3" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.15.m15.1.1.3.1a" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.15.m15.1.1.3.4" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.15.m15.1.1.3.1b" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.15.m15.1.1.3.5" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.5.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.15.m15.1b"><apply id="S3.SS3.SSS2.p2.15.m15.1.1.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.15.m15.1.1.1.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.15.m15.1.1.2.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.2">𝑧</ci><apply id="S3.SS3.SSS2.p2.15.m15.1.1.3.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.3"><times id="S3.SS3.SSS2.p2.15.m15.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.1"></times><ci id="S3.SS3.SSS2.p2.15.m15.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.2">𝑔</ci><ci id="S3.SS3.SSS2.p2.15.m15.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.3">𝑙</ci><ci id="S3.SS3.SSS2.p2.15.m15.1.1.3.4.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.4">𝑜</ci><ci id="S3.SS3.SSS2.p2.15.m15.1.1.3.5.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.5">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.15.m15.1c">z_{glob}</annotation></semantics></math>, and increase the distance between <math id="S3.SS3.SSS2.p2.16.m16.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.SSS2.p2.16.m16.1a"><mi id="S3.SS3.SSS2.p2.16.m16.1.1" xref="S3.SS3.SSS2.p2.16.m16.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.16.m16.1b"><ci id="S3.SS3.SSS2.p2.16.m16.1.1.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.16.m16.1c">z</annotation></semantics></math> and <math id="S3.SS3.SSS2.p2.17.m17.1" class="ltx_Math" alttext="z_{prev}" display="inline"><semantics id="S3.SS3.SSS2.p2.17.m17.1a"><msub id="S3.SS3.SSS2.p2.17.m17.1.1" xref="S3.SS3.SSS2.p2.17.m17.1.1.cmml"><mi id="S3.SS3.SSS2.p2.17.m17.1.1.2" xref="S3.SS3.SSS2.p2.17.m17.1.1.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p2.17.m17.1.1.3" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.17.m17.1.1.3.2" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.17.m17.1.1.3.1" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.17.m17.1.1.3.3" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.17.m17.1.1.3.1a" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.17.m17.1.1.3.4" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p2.17.m17.1.1.3.1b" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p2.17.m17.1.1.3.5" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.5.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.17.m17.1b"><apply id="S3.SS3.SSS2.p2.17.m17.1.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.17.m17.1.1.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.17.m17.1.1.2.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.2">𝑧</ci><apply id="S3.SS3.SSS2.p2.17.m17.1.1.3.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.3"><times id="S3.SS3.SSS2.p2.17.m17.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.1"></times><ci id="S3.SS3.SSS2.p2.17.m17.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.2">𝑝</ci><ci id="S3.SS3.SSS2.p2.17.m17.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.3">𝑟</ci><ci id="S3.SS3.SSS2.p2.17.m17.1.1.3.4.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.4">𝑒</ci><ci id="S3.SS3.SSS2.p2.17.m17.1.1.3.5.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.3.5">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.17.m17.1c">z_{prev}</annotation></semantics></math>. Similar to NT-Xent loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, we define model-contrastive loss as</p>
</div>
<div id="S3.SS3.SSS2.p3" class="ltx_para">
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.9" class="ltx_Math" alttext="\displaystyle\ell_{con}=-\log{\frac{\exp(\textrm{sim}(z,z_{glob})/\tau)}{\exp(\textrm{sim}(z,z_{glob})/\tau)+\exp(\textrm{sim}(z,z_{prev})/\tau)}}" display="inline"><semantics id="S3.E3X.2.1.1.m1.9a"><mrow id="S3.E3X.2.1.1.m1.9.10" xref="S3.E3X.2.1.1.m1.9.10.cmml"><msub id="S3.E3X.2.1.1.m1.9.10.2" xref="S3.E3X.2.1.1.m1.9.10.2.cmml"><mi mathvariant="normal" id="S3.E3X.2.1.1.m1.9.10.2.2" xref="S3.E3X.2.1.1.m1.9.10.2.2.cmml">ℓ</mi><mrow id="S3.E3X.2.1.1.m1.9.10.2.3" xref="S3.E3X.2.1.1.m1.9.10.2.3.cmml"><mi id="S3.E3X.2.1.1.m1.9.10.2.3.2" xref="S3.E3X.2.1.1.m1.9.10.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.9.10.2.3.1" xref="S3.E3X.2.1.1.m1.9.10.2.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.9.10.2.3.3" xref="S3.E3X.2.1.1.m1.9.10.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.9.10.2.3.1a" xref="S3.E3X.2.1.1.m1.9.10.2.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.9.10.2.3.4" xref="S3.E3X.2.1.1.m1.9.10.2.3.4.cmml">n</mi></mrow></msub><mo id="S3.E3X.2.1.1.m1.9.10.1" xref="S3.E3X.2.1.1.m1.9.10.1.cmml">=</mo><mrow id="S3.E3X.2.1.1.m1.9.10.3" xref="S3.E3X.2.1.1.m1.9.10.3.cmml"><mo rspace="0.167em" id="S3.E3X.2.1.1.m1.9.10.3a" xref="S3.E3X.2.1.1.m1.9.10.3.cmml">−</mo><mrow id="S3.E3X.2.1.1.m1.9.10.3.2" xref="S3.E3X.2.1.1.m1.9.10.3.2.cmml"><mi id="S3.E3X.2.1.1.m1.9.10.3.2.1" xref="S3.E3X.2.1.1.m1.9.10.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E3X.2.1.1.m1.9.10.3.2a" xref="S3.E3X.2.1.1.m1.9.10.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E3X.2.1.1.m1.9.9" xref="S3.E3X.2.1.1.m1.9.9.cmml"><mfrac id="S3.E3X.2.1.1.m1.9.9a" xref="S3.E3X.2.1.1.m1.9.9.cmml"><mrow id="S3.E3X.2.1.1.m1.3.3.3.3" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml"><mi id="S3.E3X.2.1.1.m1.2.2.2.2" xref="S3.E3X.2.1.1.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E3X.2.1.1.m1.3.3.3.3a" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E3X.2.1.1.m1.3.3.3.3.1" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.3.3.3.3.1.2" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E3X.2.1.1.m1.3.3.3.3.1.1" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.cmml"><mtext id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.3" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.2" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.2.cmml">(</mo><mi id="S3.E3X.2.1.1.m1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml">z</mi><mo id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.2.cmml">,</mo><msub id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.3" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1a" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.4" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1b" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.5" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.4" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.2" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.2.cmml">/</mo><mi id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.3" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E3X.2.1.1.m1.3.3.3.3.1.3" xref="S3.E3X.2.1.1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E3X.2.1.1.m1.9.9.9" xref="S3.E3X.2.1.1.m1.9.9.9.cmml"><mrow id="S3.E3X.2.1.1.m1.8.8.8.5.1" xref="S3.E3X.2.1.1.m1.8.8.8.5.2.cmml"><mi id="S3.E3X.2.1.1.m1.5.5.5.2" xref="S3.E3X.2.1.1.m1.5.5.5.2.cmml">exp</mi><mo id="S3.E3X.2.1.1.m1.8.8.8.5.1a" xref="S3.E3X.2.1.1.m1.8.8.8.5.2.cmml">⁡</mo><mrow id="S3.E3X.2.1.1.m1.8.8.8.5.1.1" xref="S3.E3X.2.1.1.m1.8.8.8.5.2.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.2" xref="S3.E3X.2.1.1.m1.8.8.8.5.2.cmml">(</mo><mrow id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.cmml"><mtext id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E3X.2.1.1.m1.4.4.4.1" xref="S3.E3X.2.1.1.m1.4.4.4.1.cmml">z</mi><mo id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.2" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.3" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1a" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.4" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1b" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.5" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.4" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.2" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.2.cmml">/</mo><mi id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.3" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.3" xref="S3.E3X.2.1.1.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="S3.E3X.2.1.1.m1.9.9.9.7" xref="S3.E3X.2.1.1.m1.9.9.9.7.cmml">+</mo><mrow id="S3.E3X.2.1.1.m1.9.9.9.6.1" xref="S3.E3X.2.1.1.m1.9.9.9.6.2.cmml"><mi id="S3.E3X.2.1.1.m1.7.7.7.4" xref="S3.E3X.2.1.1.m1.7.7.7.4.cmml">exp</mi><mo id="S3.E3X.2.1.1.m1.9.9.9.6.1a" xref="S3.E3X.2.1.1.m1.9.9.9.6.2.cmml">⁡</mo><mrow id="S3.E3X.2.1.1.m1.9.9.9.6.1.1" xref="S3.E3X.2.1.1.m1.9.9.9.6.2.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.9.6.2.cmml">(</mo><mrow id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.cmml"><mtext id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E3X.2.1.1.m1.6.6.6.3" xref="S3.E3X.2.1.1.m1.6.6.6.3.cmml">z</mi><mo id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.2" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.3" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1a" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.4" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1b" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.5" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.5.cmml">v</mi></mrow></msub><mo stretchy="false" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.4" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.2.cmml">/</mo><mi id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.9b"><apply id="S3.E3X.2.1.1.m1.9.10.cmml" xref="S3.E3X.2.1.1.m1.9.10"><eq id="S3.E3X.2.1.1.m1.9.10.1.cmml" xref="S3.E3X.2.1.1.m1.9.10.1"></eq><apply id="S3.E3X.2.1.1.m1.9.10.2.cmml" xref="S3.E3X.2.1.1.m1.9.10.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.9.10.2.1.cmml" xref="S3.E3X.2.1.1.m1.9.10.2">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.9.10.2.2.cmml" xref="S3.E3X.2.1.1.m1.9.10.2.2">ℓ</ci><apply id="S3.E3X.2.1.1.m1.9.10.2.3.cmml" xref="S3.E3X.2.1.1.m1.9.10.2.3"><times id="S3.E3X.2.1.1.m1.9.10.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.9.10.2.3.1"></times><ci id="S3.E3X.2.1.1.m1.9.10.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.9.10.2.3.2">𝑐</ci><ci id="S3.E3X.2.1.1.m1.9.10.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.9.10.2.3.3">𝑜</ci><ci id="S3.E3X.2.1.1.m1.9.10.2.3.4.cmml" xref="S3.E3X.2.1.1.m1.9.10.2.3.4">𝑛</ci></apply></apply><apply id="S3.E3X.2.1.1.m1.9.10.3.cmml" xref="S3.E3X.2.1.1.m1.9.10.3"><minus id="S3.E3X.2.1.1.m1.9.10.3.1.cmml" xref="S3.E3X.2.1.1.m1.9.10.3"></minus><apply id="S3.E3X.2.1.1.m1.9.10.3.2.cmml" xref="S3.E3X.2.1.1.m1.9.10.3.2"><log id="S3.E3X.2.1.1.m1.9.10.3.2.1.cmml" xref="S3.E3X.2.1.1.m1.9.10.3.2.1"></log><apply id="S3.E3X.2.1.1.m1.9.9.cmml" xref="S3.E3X.2.1.1.m1.9.9"><divide id="S3.E3X.2.1.1.m1.9.9.10.cmml" xref="S3.E3X.2.1.1.m1.9.9"></divide><apply id="S3.E3X.2.1.1.m1.3.3.3.4.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3"><exp id="S3.E3X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2.2.2"></exp><apply id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1"><divide id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.2"></divide><apply id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1"><times id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.2"></times><ci id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.3a.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.3"><mtext id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.3">sim</mtext></ci><interval closure="open" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1"><ci id="S3.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1">𝑧</ci><apply id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3"><times id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.1"></times><ci id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.4.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.4">𝑜</ci><ci id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.5.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.1.1.1.1.3.5">𝑏</ci></apply></apply></interval></apply><ci id="S3.E3X.2.1.1.m1.3.3.3.3.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.3.3.3.3.1.1.3">𝜏</ci></apply></apply><apply id="S3.E3X.2.1.1.m1.9.9.9.cmml" xref="S3.E3X.2.1.1.m1.9.9.9"><plus id="S3.E3X.2.1.1.m1.9.9.9.7.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.7"></plus><apply id="S3.E3X.2.1.1.m1.8.8.8.5.2.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1"><exp id="S3.E3X.2.1.1.m1.5.5.5.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.5.2"></exp><apply id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1"><divide id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.2"></divide><apply id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1"><times id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.2"></times><ci id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.3a.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.3"><mtext id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.3">sim</mtext></ci><interval closure="open" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1"><ci id="S3.E3X.2.1.1.m1.4.4.4.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.4.1">𝑧</ci><apply id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3"><times id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.4">𝑜</ci><ci id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.1.1.1.1.3.5">𝑏</ci></apply></apply></interval></apply><ci id="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.8.8.8.5.1.1.1.3">𝜏</ci></apply></apply><apply id="S3.E3X.2.1.1.m1.9.9.9.6.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1"><exp id="S3.E3X.2.1.1.m1.7.7.7.4.cmml" xref="S3.E3X.2.1.1.m1.7.7.7.4"></exp><apply id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1"><divide id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.2"></divide><apply id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1"><times id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.2"></times><ci id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.3a.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.3"><mtext id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.3">sim</mtext></ci><interval closure="open" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1"><ci id="S3.E3X.2.1.1.m1.6.6.6.3.cmml" xref="S3.E3X.2.1.1.m1.6.6.6.3">𝑧</ci><apply id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3"><times id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.4">𝑒</ci><ci id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.1.1.1.1.3.5">𝑣</ci></apply></apply></interval></apply><ci id="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.9.6.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.9c">\displaystyle\ell_{con}=-\log{\frac{\exp(\textrm{sim}(z,z_{glob})/\tau)}{\exp(\textrm{sim}(z,z_{glob})/\tau)+\exp(\textrm{sim}(z,z_{prev})/\tau)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS3.SSS2.p4" class="ltx_para">
<p id="S3.SS3.SSS2.p4.2" class="ltx_p">where <math id="S3.SS3.SSS2.p4.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.SSS2.p4.1.m1.1a"><mi id="S3.SS3.SSS2.p4.1.m1.1.1" xref="S3.SS3.SSS2.p4.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.1.m1.1b"><ci id="S3.SS3.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.1.m1.1c">\tau</annotation></semantics></math> denotes a temperature parameter. The loss of an input <math id="S3.SS3.SSS2.p4.2.m2.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S3.SS3.SSS2.p4.2.m2.2a"><mrow id="S3.SS3.SSS2.p4.2.m2.2.3.2" xref="S3.SS3.SSS2.p4.2.m2.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p4.2.m2.2.3.2.1" xref="S3.SS3.SSS2.p4.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS3.SSS2.p4.2.m2.1.1" xref="S3.SS3.SSS2.p4.2.m2.1.1.cmml">x</mi><mo id="S3.SS3.SSS2.p4.2.m2.2.3.2.2" xref="S3.SS3.SSS2.p4.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS2.p4.2.m2.2.2" xref="S3.SS3.SSS2.p4.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS3.SSS2.p4.2.m2.2.3.2.3" xref="S3.SS3.SSS2.p4.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.2.m2.2b"><interval closure="open" id="S3.SS3.SSS2.p4.2.m2.2.3.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.2.3.2"><ci id="S3.SS3.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1">𝑥</ci><ci id="S3.SS3.SSS2.p4.2.m2.2.2.cmml" xref="S3.SS3.SSS2.p4.2.m2.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.2.m2.2c">(x,y)</annotation></semantics></math> is computed by</p>
</div>
<div id="S3.SS3.SSS2.p5" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\ell=\ell_{sup}(w_{i}^{t};(x,y))+\mu\ell_{con}(w_{i}^{t};w_{i}^{t-1};w^{t};x)," display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><mi mathvariant="normal" id="S3.E4.m1.4.4.1.1.7" xref="S3.E4.m1.4.4.1.1.7.cmml">ℓ</mi><mo id="S3.E4.m1.4.4.1.1.6" xref="S3.E4.m1.4.4.1.1.6.cmml">=</mo><mrow id="S3.E4.m1.4.4.1.1.5" xref="S3.E4.m1.4.4.1.1.5.cmml"><mrow id="S3.E4.m1.4.4.1.1.2.2" xref="S3.E4.m1.4.4.1.1.2.2.cmml"><msub id="S3.E4.m1.4.4.1.1.2.2.4" xref="S3.E4.m1.4.4.1.1.2.2.4.cmml"><mi mathvariant="normal" id="S3.E4.m1.4.4.1.1.2.2.4.2" xref="S3.E4.m1.4.4.1.1.2.2.4.2.cmml">ℓ</mi><mrow id="S3.E4.m1.4.4.1.1.2.2.4.3" xref="S3.E4.m1.4.4.1.1.2.2.4.3.cmml"><mi id="S3.E4.m1.4.4.1.1.2.2.4.3.2" xref="S3.E4.m1.4.4.1.1.2.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.2.2.4.3.1" xref="S3.E4.m1.4.4.1.1.2.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.4.4.1.1.2.2.4.3.3" xref="S3.E4.m1.4.4.1.1.2.2.4.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.2.2.4.3.1a" xref="S3.E4.m1.4.4.1.1.2.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.4.4.1.1.2.2.4.3.4" xref="S3.E4.m1.4.4.1.1.2.2.4.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.2.2.3" xref="S3.E4.m1.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.2.2.2.2" xref="S3.E4.m1.4.4.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.2.2.3" xref="S3.E4.m1.4.4.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E4.m1.4.4.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E4.m1.4.4.1.1.2.2.2.2.4" xref="S3.E4.m1.4.4.1.1.2.2.2.3.cmml">;</mo><mrow id="S3.E4.m1.4.4.1.1.2.2.2.2.2.2" xref="S3.E4.m1.4.4.1.1.2.2.2.2.2.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.2.2.2.2.1" xref="S3.E4.m1.4.4.1.1.2.2.2.2.2.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">x</mi><mo id="S3.E4.m1.4.4.1.1.2.2.2.2.2.2.2" xref="S3.E4.m1.4.4.1.1.2.2.2.2.2.1.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.2.2.2.2.3" xref="S3.E4.m1.4.4.1.1.2.2.2.2.2.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.2.2.5" xref="S3.E4.m1.4.4.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.5.6" xref="S3.E4.m1.4.4.1.1.5.6.cmml">+</mo><mrow id="S3.E4.m1.4.4.1.1.5.5" xref="S3.E4.m1.4.4.1.1.5.5.cmml"><mi id="S3.E4.m1.4.4.1.1.5.5.5" xref="S3.E4.m1.4.4.1.1.5.5.5.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.5.5.4" xref="S3.E4.m1.4.4.1.1.5.5.4.cmml">​</mo><msub id="S3.E4.m1.4.4.1.1.5.5.6" xref="S3.E4.m1.4.4.1.1.5.5.6.cmml"><mi mathvariant="normal" id="S3.E4.m1.4.4.1.1.5.5.6.2" xref="S3.E4.m1.4.4.1.1.5.5.6.2.cmml">ℓ</mi><mrow id="S3.E4.m1.4.4.1.1.5.5.6.3" xref="S3.E4.m1.4.4.1.1.5.5.6.3.cmml"><mi id="S3.E4.m1.4.4.1.1.5.5.6.3.2" xref="S3.E4.m1.4.4.1.1.5.5.6.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.5.5.6.3.1" xref="S3.E4.m1.4.4.1.1.5.5.6.3.1.cmml">​</mo><mi id="S3.E4.m1.4.4.1.1.5.5.6.3.3" xref="S3.E4.m1.4.4.1.1.5.5.6.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.5.5.6.3.1a" xref="S3.E4.m1.4.4.1.1.5.5.6.3.1.cmml">​</mo><mi id="S3.E4.m1.4.4.1.1.5.5.6.3.4" xref="S3.E4.m1.4.4.1.1.5.5.6.3.4.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.5.5.4a" xref="S3.E4.m1.4.4.1.1.5.5.4.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.5.5.3.3" xref="S3.E4.m1.4.4.1.1.5.5.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.5.5.3.3.4" xref="S3.E4.m1.4.4.1.1.5.5.3.4.cmml">(</mo><msubsup id="S3.E4.m1.4.4.1.1.3.3.1.1.1" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.2.cmml">w</mi><mi id="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.1.1.3.3.1.1.1.3" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E4.m1.4.4.1.1.5.5.3.3.5" xref="S3.E4.m1.4.4.1.1.5.5.3.4.cmml">;</mo><msubsup id="S3.E4.m1.4.4.1.1.4.4.2.2.2" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.cmml"><mi id="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.2" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.2.cmml">w</mi><mi id="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.3" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.3.cmml">i</mi><mrow id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.2" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.2.cmml">t</mi><mo id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.1" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.1.cmml">−</mo><mn id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.3" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E4.m1.4.4.1.1.5.5.3.3.6" xref="S3.E4.m1.4.4.1.1.5.5.3.4.cmml">;</mo><msup id="S3.E4.m1.4.4.1.1.5.5.3.3.3" xref="S3.E4.m1.4.4.1.1.5.5.3.3.3.cmml"><mi id="S3.E4.m1.4.4.1.1.5.5.3.3.3.2" xref="S3.E4.m1.4.4.1.1.5.5.3.3.3.2.cmml">w</mi><mi id="S3.E4.m1.4.4.1.1.5.5.3.3.3.3" xref="S3.E4.m1.4.4.1.1.5.5.3.3.3.3.cmml">t</mi></msup><mo id="S3.E4.m1.4.4.1.1.5.5.3.3.7" xref="S3.E4.m1.4.4.1.1.5.5.3.4.cmml">;</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.4.4.1.1.5.5.3.3.8" xref="S3.E4.m1.4.4.1.1.5.5.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.2" xref="S3.E4.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1"><eq id="S3.E4.m1.4.4.1.1.6.cmml" xref="S3.E4.m1.4.4.1.1.6"></eq><ci id="S3.E4.m1.4.4.1.1.7.cmml" xref="S3.E4.m1.4.4.1.1.7">ℓ</ci><apply id="S3.E4.m1.4.4.1.1.5.cmml" xref="S3.E4.m1.4.4.1.1.5"><plus id="S3.E4.m1.4.4.1.1.5.6.cmml" xref="S3.E4.m1.4.4.1.1.5.6"></plus><apply id="S3.E4.m1.4.4.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2"><times id="S3.E4.m1.4.4.1.1.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.2.2.3"></times><apply id="S3.E4.m1.4.4.1.1.2.2.4.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.2.2.4.1.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.2.2.4.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4.2">ℓ</ci><apply id="S3.E4.m1.4.4.1.1.2.2.4.3.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4.3"><times id="S3.E4.m1.4.4.1.1.2.2.4.3.1.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4.3.1"></times><ci id="S3.E4.m1.4.4.1.1.2.2.4.3.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4.3.2">𝑠</ci><ci id="S3.E4.m1.4.4.1.1.2.2.4.3.3.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4.3.3">𝑢</ci><ci id="S3.E4.m1.4.4.1.1.2.2.4.3.4.cmml" xref="S3.E4.m1.4.4.1.1.2.2.4.3.4">𝑝</ci></apply></apply><list id="S3.E4.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.2.2.2.2"><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3">𝑡</ci></apply><interval closure="open" id="S3.E4.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.2.2.2.2.2.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑥</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑦</ci></interval></list></apply><apply id="S3.E4.m1.4.4.1.1.5.5.cmml" xref="S3.E4.m1.4.4.1.1.5.5"><times id="S3.E4.m1.4.4.1.1.5.5.4.cmml" xref="S3.E4.m1.4.4.1.1.5.5.4"></times><ci id="S3.E4.m1.4.4.1.1.5.5.5.cmml" xref="S3.E4.m1.4.4.1.1.5.5.5">𝜇</ci><apply id="S3.E4.m1.4.4.1.1.5.5.6.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.5.5.6.1.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.5.5.6.2.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6.2">ℓ</ci><apply id="S3.E4.m1.4.4.1.1.5.5.6.3.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6.3"><times id="S3.E4.m1.4.4.1.1.5.5.6.3.1.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6.3.1"></times><ci id="S3.E4.m1.4.4.1.1.5.5.6.3.2.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6.3.2">𝑐</ci><ci id="S3.E4.m1.4.4.1.1.5.5.6.3.3.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6.3.3">𝑜</ci><ci id="S3.E4.m1.4.4.1.1.5.5.6.3.4.cmml" xref="S3.E4.m1.4.4.1.1.5.5.6.3.4">𝑛</ci></apply></apply><list id="S3.E4.m1.4.4.1.1.5.5.3.4.cmml" xref="S3.E4.m1.4.4.1.1.5.5.3.3"><apply id="S3.E4.m1.4.4.1.1.3.3.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1">superscript</csymbol><apply id="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.2">𝑤</ci><ci id="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.1.1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3.3.1.1.1.3">𝑡</ci></apply><apply id="S3.E4.m1.4.4.1.1.4.4.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.4.4.2.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2">superscript</csymbol><apply id="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.2">𝑤</ci><ci id="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3"><minus id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.1"></minus><ci id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.3.cmml" xref="S3.E4.m1.4.4.1.1.4.4.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.4.4.1.1.5.5.3.3.3.cmml" xref="S3.E4.m1.4.4.1.1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.5.5.3.3.3.1.cmml" xref="S3.E4.m1.4.4.1.1.5.5.3.3.3">superscript</csymbol><ci id="S3.E4.m1.4.4.1.1.5.5.3.3.3.2.cmml" xref="S3.E4.m1.4.4.1.1.5.5.3.3.3.2">𝑤</ci><ci id="S3.E4.m1.4.4.1.1.5.5.3.3.3.3.cmml" xref="S3.E4.m1.4.4.1.1.5.5.3.3.3.3">𝑡</ci></apply><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\ell=\ell_{sup}(w_{i}^{t};(x,y))+\mu\ell_{con}(w_{i}^{t};w_{i}^{t-1};w^{t};x),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.SSS2.p6" class="ltx_para">
<p id="S3.SS3.SSS2.p6.1" class="ltx_p">where <math id="S3.SS3.SSS2.p6.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS3.SSS2.p6.1.m1.1a"><mi id="S3.SS3.SSS2.p6.1.m1.1.1" xref="S3.SS3.SSS2.p6.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p6.1.m1.1b"><ci id="S3.SS3.SSS2.p6.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p6.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p6.1.m1.1c">\mu</annotation></semantics></math> is a hyper-parameter to control the weight of model-contrastive loss. The local objective is to minimize</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.6" class="ltx_Math" alttext="\min_{w_{i}^{t}}\mathbb{E}_{(x,y)\sim D^{i}}[\ell_{sup}(w_{i}^{t};(x,y))+\mu\ell_{con}(w_{i}^{t};w_{i}^{t-1};w^{t};x)]." display="block"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.6.1" xref="S3.E5.m1.6.6.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1" xref="S3.E5.m1.6.6.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1.3" xref="S3.E5.m1.6.6.1.1.3.cmml"><munder id="S3.E5.m1.6.6.1.1.3.1" xref="S3.E5.m1.6.6.1.1.3.1.cmml"><mi id="S3.E5.m1.6.6.1.1.3.1.2" xref="S3.E5.m1.6.6.1.1.3.1.2.cmml">min</mi><msubsup id="S3.E5.m1.6.6.1.1.3.1.3" xref="S3.E5.m1.6.6.1.1.3.1.3.cmml"><mi id="S3.E5.m1.6.6.1.1.3.1.3.2.2" xref="S3.E5.m1.6.6.1.1.3.1.3.2.2.cmml">w</mi><mi id="S3.E5.m1.6.6.1.1.3.1.3.2.3" xref="S3.E5.m1.6.6.1.1.3.1.3.2.3.cmml">i</mi><mi id="S3.E5.m1.6.6.1.1.3.1.3.3" xref="S3.E5.m1.6.6.1.1.3.1.3.3.cmml">t</mi></msubsup></munder><mo lspace="0.167em" id="S3.E5.m1.6.6.1.1.3a" xref="S3.E5.m1.6.6.1.1.3.cmml">⁡</mo><msub id="S3.E5.m1.6.6.1.1.3.2" xref="S3.E5.m1.6.6.1.1.3.2.cmml"><mi id="S3.E5.m1.6.6.1.1.3.2.2" xref="S3.E5.m1.6.6.1.1.3.2.2.cmml">𝔼</mi><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mrow id="S3.E5.m1.2.2.2.4.2" xref="S3.E5.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.4.2.1" xref="S3.E5.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">x</mi><mo id="S3.E5.m1.2.2.2.4.2.2" xref="S3.E5.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E5.m1.2.2.2.4.2.3" xref="S3.E5.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E5.m1.2.2.2.5" xref="S3.E5.m1.2.2.2.5.cmml"><mi id="S3.E5.m1.2.2.2.5.2" xref="S3.E5.m1.2.2.2.5.2.cmml">D</mi><mi id="S3.E5.m1.2.2.2.5.3" xref="S3.E5.m1.2.2.2.5.3.cmml">i</mi></msup></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.2" xref="S3.E5.m1.6.6.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.6.6.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.1.1.2.cmml"><msub id="S3.E5.m1.6.6.1.1.1.1.1.2.4" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E5.m1.6.6.1.1.1.1.1.2.4.2" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.2.cmml">ℓ</mi><mrow id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.2" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.1" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.1.cmml">​</mo><mi id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.3" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.1a" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.1.cmml">​</mo><mi id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.4" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.1.1.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.4" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.3.cmml">;</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.2.1" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">x</mi><mo id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml">,</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.5" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.1.1.1.1.1.6" xref="S3.E5.m1.6.6.1.1.1.1.1.6.cmml">+</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.5" xref="S3.E5.m1.6.6.1.1.1.1.1.5.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.5.5" xref="S3.E5.m1.6.6.1.1.1.1.1.5.5.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.1.1.5.4" xref="S3.E5.m1.6.6.1.1.1.1.1.5.4.cmml">​</mo><msub id="S3.E5.m1.6.6.1.1.1.1.1.5.6" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.cmml"><mi mathvariant="normal" id="S3.E5.m1.6.6.1.1.1.1.1.5.6.2" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.2.cmml">ℓ</mi><mrow id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.2" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.1" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.1.cmml">​</mo><mi id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.3" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.1a" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.1.cmml">​</mo><mi id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.4" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.4.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.1.1.5.4a" xref="S3.E5.m1.6.6.1.1.1.1.1.5.4.cmml">​</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.4" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.4.cmml">(</mo><msubsup id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.2.cmml">w</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.3.cmml">i</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.5" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.4.cmml">;</mo><msubsup id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.2.cmml">w</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.3.cmml">i</mi><mrow id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.2" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.2.cmml">t</mi><mo id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.1" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.1.cmml">−</mo><mn id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.3" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.6" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.4.cmml">;</mo><msup id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.2" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.2.cmml">w</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.3" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.3.cmml">t</mi></msup><mo id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.7" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.4.cmml">;</mo><mi id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml">x</mi><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.8" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.4.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo lspace="0em" id="S3.E5.m1.6.6.1.2" xref="S3.E5.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.6.1.1.cmml" xref="S3.E5.m1.6.6.1"><times id="S3.E5.m1.6.6.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2"></times><apply id="S3.E5.m1.6.6.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.3"><apply id="S3.E5.m1.6.6.1.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.3.1.1.cmml" xref="S3.E5.m1.6.6.1.1.3.1">subscript</csymbol><min id="S3.E5.m1.6.6.1.1.3.1.2.cmml" xref="S3.E5.m1.6.6.1.1.3.1.2"></min><apply id="S3.E5.m1.6.6.1.1.3.1.3.cmml" xref="S3.E5.m1.6.6.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.3.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.3.1.3">superscript</csymbol><apply id="S3.E5.m1.6.6.1.1.3.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.3.1.3.2.1.cmml" xref="S3.E5.m1.6.6.1.1.3.1.3">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.3.1.3.2.2.cmml" xref="S3.E5.m1.6.6.1.1.3.1.3.2.2">𝑤</ci><ci id="S3.E5.m1.6.6.1.1.3.1.3.2.3.cmml" xref="S3.E5.m1.6.6.1.1.3.1.3.2.3">𝑖</ci></apply><ci id="S3.E5.m1.6.6.1.1.3.1.3.3.cmml" xref="S3.E5.m1.6.6.1.1.3.1.3.3">𝑡</ci></apply></apply><apply id="S3.E5.m1.6.6.1.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.3.2.1.cmml" xref="S3.E5.m1.6.6.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.3.2.2.cmml" xref="S3.E5.m1.6.6.1.1.3.2.2">𝔼</ci><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E5.m1.2.2.2.4.1.cmml" xref="S3.E5.m1.2.2.2.4.2"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑥</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E5.m1.2.2.2.5.cmml" xref="S3.E5.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.5.1.cmml" xref="S3.E5.m1.2.2.2.5">superscript</csymbol><ci id="S3.E5.m1.2.2.2.5.2.cmml" xref="S3.E5.m1.2.2.2.5.2">𝐷</ci><ci id="S3.E5.m1.2.2.2.5.3.cmml" xref="S3.E5.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E5.m1.6.6.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.6.6.1.1.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.6.6.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1"><plus id="S3.E5.m1.6.6.1.1.1.1.1.6.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.6"></plus><apply id="S3.E5.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2"><times id="S3.E5.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.3"></times><apply id="S3.E5.m1.6.6.1.1.1.1.1.2.4.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.2.4.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.2.4.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.2">ℓ</ci><apply id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3"><times id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.1"></times><ci id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.2">𝑠</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.3">𝑢</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.4.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.4.3.4">𝑝</ci></apply></apply><list id="S3.E5.m1.6.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.2"><apply id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><interval closure="open" id="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2.2.2.2.2"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑥</ci><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝑦</ci></interval></list></apply><apply id="S3.E5.m1.6.6.1.1.1.1.1.5.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5"><times id="S3.E5.m1.6.6.1.1.1.1.1.5.4.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.4"></times><ci id="S3.E5.m1.6.6.1.1.1.1.1.5.5.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.5">𝜇</ci><apply id="S3.E5.m1.6.6.1.1.1.1.1.5.6.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.5.6.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.5.6.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.2">ℓ</ci><apply id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3"><times id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.1"></times><ci id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.2">𝑐</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.3">𝑜</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.4.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.6.3.4">𝑛</ci></apply></apply><list id="S3.E5.m1.6.6.1.1.1.1.1.5.3.4.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3"><apply id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1">superscript</csymbol><apply id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.2">𝑤</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2">superscript</csymbol><apply id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.2">𝑤</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3"><minus id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.1"></minus><ci id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.4.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3">superscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.2">𝑤</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.5.3.3.3.3">𝑡</ci></apply><ci id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5">𝑥</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">\min_{w_{i}^{t}}\mathbb{E}_{(x,y)\sim D^{i}}[\ell_{sup}(w_{i}^{t};(x,y))+\mu\ell_{con}(w_{i}^{t};w_{i}^{t-1};w^{t};x)].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2103.16257/assets/x6.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="347" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The local loss in MOON.</figcaption>
</figure>
<div id="S3.SS3.SSS2.p7" class="ltx_para">
<p id="S3.SS3.SSS2.p7.1" class="ltx_p">The overall federated learning algorithm is shown in Algorithm <a href="#algorithm1" title="In 3.3.2 Local Objective ‣ 3.3 Method ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. In each round, the server sends the global model to the parties, receives the local model from the parties, and updates the global model using weighted averaging. In local training, each party uses stochastic gradient descent to update the global model with its local data, while the objective is defined in Eq. (<a href="#S3.E5" title="In 3.3.2 Local Objective ‣ 3.3 Method ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.31" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.6.6" class="ltx_listingline">

<span id="algorithm1.6.6.1" class="ltx_text"><span id="algorithm1.6.6.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>number of communication rounds <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">T</annotation></semantics></math>, number of parties <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">N</annotation></semantics></math>, number of local epochs <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mi id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><ci id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">E</annotation></semantics></math>, temperature <math id="algorithm1.4.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="algorithm1.4.4.m4.1a"><mi id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><ci id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">\tau</annotation></semantics></math>, learning rate <math id="algorithm1.5.5.m5.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="algorithm1.5.5.m5.1a"><mi id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><ci id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">\eta</annotation></semantics></math>, hyper-parameter <math id="algorithm1.6.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="algorithm1.6.6.m6.1a"><mi id="algorithm1.6.6.m6.1.1" xref="algorithm1.6.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m6.1b"><ci id="algorithm1.6.6.m6.1.1.cmml" xref="algorithm1.6.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m6.1c">\mu</annotation></semantics></math>
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span id="algorithm1.7.7.1" class="ltx_text"><span id="algorithm1.7.7.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>The final model <math id="algorithm1.7.7.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="algorithm1.7.7.m1.1a"><msup id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml"><mi id="algorithm1.7.7.m1.1.1.2" xref="algorithm1.7.7.m1.1.1.2.cmml">w</mi><mi id="algorithm1.7.7.m1.1.1.3" xref="algorithm1.7.7.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><apply id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">superscript</csymbol><ci id="algorithm1.7.7.m1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.2">𝑤</ci><ci id="algorithm1.7.7.m1.1.1.3.cmml" xref="algorithm1.7.7.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">w^{T}</annotation></semantics></math>
</div>
<div id="algorithm1.31.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>

</div>
<div id="algorithm1.31.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="algorithm1.31.33.1" class="ltx_text ltx_font_bold">Server executes</span>:

</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>initialize <math id="algorithm1.8.8.m1.1" class="ltx_Math" alttext="w^{0}" display="inline"><semantics id="algorithm1.8.8.m1.1a"><msup id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml"><mi id="algorithm1.8.8.m1.1.1.2" xref="algorithm1.8.8.m1.1.1.2.cmml">w</mi><mn id="algorithm1.8.8.m1.1.1.3" xref="algorithm1.8.8.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><apply id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1">superscript</csymbol><ci id="algorithm1.8.8.m1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.2">𝑤</ci><cn type="integer" id="algorithm1.8.8.m1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">w^{0}</annotation></semantics></math>
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>
<span id="algorithm1.9.9.1" class="ltx_text ltx_font_bold">for</span> <math id="algorithm1.9.9.m1.4" class="ltx_Math" alttext="t=0,1,...,T-1" display="inline"><semantics id="algorithm1.9.9.m1.4a"><mrow id="algorithm1.9.9.m1.4.4" xref="algorithm1.9.9.m1.4.4.cmml"><mi id="algorithm1.9.9.m1.4.4.3" xref="algorithm1.9.9.m1.4.4.3.cmml">t</mi><mo id="algorithm1.9.9.m1.4.4.2" xref="algorithm1.9.9.m1.4.4.2.cmml">=</mo><mrow id="algorithm1.9.9.m1.4.4.1.1" xref="algorithm1.9.9.m1.4.4.1.2.cmml"><mn id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml">0</mn><mo id="algorithm1.9.9.m1.4.4.1.1.2" xref="algorithm1.9.9.m1.4.4.1.2.cmml">,</mo><mn id="algorithm1.9.9.m1.2.2" xref="algorithm1.9.9.m1.2.2.cmml">1</mn><mo id="algorithm1.9.9.m1.4.4.1.1.3" xref="algorithm1.9.9.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="algorithm1.9.9.m1.3.3" xref="algorithm1.9.9.m1.3.3.cmml">…</mi><mo id="algorithm1.9.9.m1.4.4.1.1.4" xref="algorithm1.9.9.m1.4.4.1.2.cmml">,</mo><mrow id="algorithm1.9.9.m1.4.4.1.1.1" xref="algorithm1.9.9.m1.4.4.1.1.1.cmml"><mi id="algorithm1.9.9.m1.4.4.1.1.1.2" xref="algorithm1.9.9.m1.4.4.1.1.1.2.cmml">T</mi><mo id="algorithm1.9.9.m1.4.4.1.1.1.1" xref="algorithm1.9.9.m1.4.4.1.1.1.1.cmml">−</mo><mn id="algorithm1.9.9.m1.4.4.1.1.1.3" xref="algorithm1.9.9.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.4b"><apply id="algorithm1.9.9.m1.4.4.cmml" xref="algorithm1.9.9.m1.4.4"><eq id="algorithm1.9.9.m1.4.4.2.cmml" xref="algorithm1.9.9.m1.4.4.2"></eq><ci id="algorithm1.9.9.m1.4.4.3.cmml" xref="algorithm1.9.9.m1.4.4.3">𝑡</ci><list id="algorithm1.9.9.m1.4.4.1.2.cmml" xref="algorithm1.9.9.m1.4.4.1.1"><cn type="integer" id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1">0</cn><cn type="integer" id="algorithm1.9.9.m1.2.2.cmml" xref="algorithm1.9.9.m1.2.2">1</cn><ci id="algorithm1.9.9.m1.3.3.cmml" xref="algorithm1.9.9.m1.3.3">…</ci><apply id="algorithm1.9.9.m1.4.4.1.1.1.cmml" xref="algorithm1.9.9.m1.4.4.1.1.1"><minus id="algorithm1.9.9.m1.4.4.1.1.1.1.cmml" xref="algorithm1.9.9.m1.4.4.1.1.1.1"></minus><ci id="algorithm1.9.9.m1.4.4.1.1.1.2.cmml" xref="algorithm1.9.9.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="algorithm1.9.9.m1.4.4.1.1.1.3.cmml" xref="algorithm1.9.9.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.4c">t=0,1,...,T-1</annotation></semantics></math> <span id="algorithm1.9.9.2" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.31.34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.10.10.1" class="ltx_text ltx_font_bold">for</span> <math id="algorithm1.10.10.m1.4" class="ltx_Math" alttext="i=1,2,...,N" display="inline"><semantics id="algorithm1.10.10.m1.4a"><mrow id="algorithm1.10.10.m1.4.5" xref="algorithm1.10.10.m1.4.5.cmml"><mi id="algorithm1.10.10.m1.4.5.2" xref="algorithm1.10.10.m1.4.5.2.cmml">i</mi><mo id="algorithm1.10.10.m1.4.5.1" xref="algorithm1.10.10.m1.4.5.1.cmml">=</mo><mrow id="algorithm1.10.10.m1.4.5.3.2" xref="algorithm1.10.10.m1.4.5.3.1.cmml"><mn id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml">1</mn><mo id="algorithm1.10.10.m1.4.5.3.2.1" xref="algorithm1.10.10.m1.4.5.3.1.cmml">,</mo><mn id="algorithm1.10.10.m1.2.2" xref="algorithm1.10.10.m1.2.2.cmml">2</mn><mo id="algorithm1.10.10.m1.4.5.3.2.2" xref="algorithm1.10.10.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.10.10.m1.3.3" xref="algorithm1.10.10.m1.3.3.cmml">…</mi><mo id="algorithm1.10.10.m1.4.5.3.2.3" xref="algorithm1.10.10.m1.4.5.3.1.cmml">,</mo><mi id="algorithm1.10.10.m1.4.4" xref="algorithm1.10.10.m1.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.4b"><apply id="algorithm1.10.10.m1.4.5.cmml" xref="algorithm1.10.10.m1.4.5"><eq id="algorithm1.10.10.m1.4.5.1.cmml" xref="algorithm1.10.10.m1.4.5.1"></eq><ci id="algorithm1.10.10.m1.4.5.2.cmml" xref="algorithm1.10.10.m1.4.5.2">𝑖</ci><list id="algorithm1.10.10.m1.4.5.3.1.cmml" xref="algorithm1.10.10.m1.4.5.3.2"><cn type="integer" id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">1</cn><cn type="integer" id="algorithm1.10.10.m1.2.2.cmml" xref="algorithm1.10.10.m1.2.2">2</cn><ci id="algorithm1.10.10.m1.3.3.cmml" xref="algorithm1.10.10.m1.3.3">…</ci><ci id="algorithm1.10.10.m1.4.4.cmml" xref="algorithm1.10.10.m1.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.4c">i=1,2,...,N</annotation></semantics></math> <span id="algorithm1.10.10.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="algorithm1.10.10.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
send the global model <math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="algorithm1.11.11.m1.1a"><msup id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><mi id="algorithm1.11.11.m1.1.1.2" xref="algorithm1.11.11.m1.1.1.2.cmml">w</mi><mi id="algorithm1.11.11.m1.1.1.3" xref="algorithm1.11.11.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">superscript</csymbol><ci id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2">𝑤</ci><ci id="algorithm1.11.11.m1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">w^{t}</annotation></semantics></math> to <math id="algorithm1.12.12.m2.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="algorithm1.12.12.m2.1a"><msub id="algorithm1.12.12.m2.1.1" xref="algorithm1.12.12.m2.1.1.cmml"><mi id="algorithm1.12.12.m2.1.1.2" xref="algorithm1.12.12.m2.1.1.2.cmml">P</mi><mi id="algorithm1.12.12.m2.1.1.3" xref="algorithm1.12.12.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m2.1b"><apply id="algorithm1.12.12.m2.1.1.cmml" xref="algorithm1.12.12.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m2.1.1.1.cmml" xref="algorithm1.12.12.m2.1.1">subscript</csymbol><ci id="algorithm1.12.12.m2.1.1.2.cmml" xref="algorithm1.12.12.m2.1.1.2">𝑃</ci><ci id="algorithm1.12.12.m2.1.1.3.cmml" xref="algorithm1.12.12.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m2.1c">P_{i}</annotation></semantics></math>

</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.13.13.m1.1" class="ltx_Math" alttext="w_{i}^{t}\leftarrow" display="inline"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><msubsup id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml"><mi id="algorithm1.13.13.m1.1.1.2.2.2" xref="algorithm1.13.13.m1.1.1.2.2.2.cmml">w</mi><mi id="algorithm1.13.13.m1.1.1.2.2.3" xref="algorithm1.13.13.m1.1.1.2.2.3.cmml">i</mi><mi id="algorithm1.13.13.m1.1.1.2.3" xref="algorithm1.13.13.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.cmml">←</mo><mi id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><ci id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1">←</ci><apply id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.2.1.cmml" xref="algorithm1.13.13.m1.1.1.2">superscript</csymbol><apply id="algorithm1.13.13.m1.1.1.2.2.cmml" xref="algorithm1.13.13.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.2.2.1.cmml" xref="algorithm1.13.13.m1.1.1.2">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.2.2.2.cmml" xref="algorithm1.13.13.m1.1.1.2.2.2">𝑤</ci><ci id="algorithm1.13.13.m1.1.1.2.2.3.cmml" xref="algorithm1.13.13.m1.1.1.2.2.3">𝑖</ci></apply><ci id="algorithm1.13.13.m1.1.1.2.3.cmml" xref="algorithm1.13.13.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">w_{i}^{t}\leftarrow</annotation></semantics></math> <span id="algorithm1.15.15.1" class="ltx_text ltx_font_bold">PartyLocalTraining</span>(<math id="algorithm1.14.14.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.14.14.m2.1a"><mi id="algorithm1.14.14.m2.1.1" xref="algorithm1.14.14.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m2.1b"><ci id="algorithm1.14.14.m2.1.1.cmml" xref="algorithm1.14.14.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m2.1c">i</annotation></semantics></math>, <math id="algorithm1.15.15.m3.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="algorithm1.15.15.m3.1a"><msup id="algorithm1.15.15.m3.1.1" xref="algorithm1.15.15.m3.1.1.cmml"><mi id="algorithm1.15.15.m3.1.1.2" xref="algorithm1.15.15.m3.1.1.2.cmml">w</mi><mi id="algorithm1.15.15.m3.1.1.3" xref="algorithm1.15.15.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m3.1b"><apply id="algorithm1.15.15.m3.1.1.cmml" xref="algorithm1.15.15.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m3.1.1.1.cmml" xref="algorithm1.15.15.m3.1.1">superscript</csymbol><ci id="algorithm1.15.15.m3.1.1.2.cmml" xref="algorithm1.15.15.m3.1.1.2">𝑤</ci><ci id="algorithm1.15.15.m3.1.1.3.cmml" xref="algorithm1.15.15.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m3.1c">w^{t}</annotation></semantics></math>)

</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.16.16.m1.2" class="ltx_Math" alttext="w^{t+1}\leftarrow\sum_{k=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}w_{k}^{t}" display="inline"><semantics id="algorithm1.16.16.m1.2a"><mrow id="algorithm1.16.16.m1.2.3" xref="algorithm1.16.16.m1.2.3.cmml"><msup id="algorithm1.16.16.m1.2.3.2" xref="algorithm1.16.16.m1.2.3.2.cmml"><mi id="algorithm1.16.16.m1.2.3.2.2" xref="algorithm1.16.16.m1.2.3.2.2.cmml">w</mi><mrow id="algorithm1.16.16.m1.2.3.2.3" xref="algorithm1.16.16.m1.2.3.2.3.cmml"><mi id="algorithm1.16.16.m1.2.3.2.3.2" xref="algorithm1.16.16.m1.2.3.2.3.2.cmml">t</mi><mo id="algorithm1.16.16.m1.2.3.2.3.1" xref="algorithm1.16.16.m1.2.3.2.3.1.cmml">+</mo><mn id="algorithm1.16.16.m1.2.3.2.3.3" xref="algorithm1.16.16.m1.2.3.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" stretchy="false" id="algorithm1.16.16.m1.2.3.1" xref="algorithm1.16.16.m1.2.3.1.cmml">←</mo><mrow id="algorithm1.16.16.m1.2.3.3" xref="algorithm1.16.16.m1.2.3.3.cmml"><msubsup id="algorithm1.16.16.m1.2.3.3.1" xref="algorithm1.16.16.m1.2.3.3.1.cmml"><mo id="algorithm1.16.16.m1.2.3.3.1.2.2" xref="algorithm1.16.16.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.16.16.m1.2.3.3.1.2.3" xref="algorithm1.16.16.m1.2.3.3.1.2.3.cmml"><mi id="algorithm1.16.16.m1.2.3.3.1.2.3.2" xref="algorithm1.16.16.m1.2.3.3.1.2.3.2.cmml">k</mi><mo id="algorithm1.16.16.m1.2.3.3.1.2.3.1" xref="algorithm1.16.16.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.16.16.m1.2.3.3.1.2.3.3" xref="algorithm1.16.16.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.16.16.m1.2.3.3.1.3" xref="algorithm1.16.16.m1.2.3.3.1.3.cmml">N</mi></msubsup><mrow id="algorithm1.16.16.m1.2.3.3.2" xref="algorithm1.16.16.m1.2.3.3.2.cmml"><mfrac id="algorithm1.16.16.m1.2.2" xref="algorithm1.16.16.m1.2.2.cmml"><mrow id="algorithm1.16.16.m1.1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.1.1.1.1.2" xref="algorithm1.16.16.m1.1.1.1.2.1.cmml">|</mo><msup id="algorithm1.16.16.m1.1.1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m1.1.1.1.1.1.2" xref="algorithm1.16.16.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="algorithm1.16.16.m1.1.1.1.1.1.3" xref="algorithm1.16.16.m1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="algorithm1.16.16.m1.1.1.1.1.3" xref="algorithm1.16.16.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="algorithm1.16.16.m1.2.2.2.3" xref="algorithm1.16.16.m1.2.2.2.2.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.2.2.2.3.1" xref="algorithm1.16.16.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m1.2.2.2.1" xref="algorithm1.16.16.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="algorithm1.16.16.m1.2.2.2.3.2" xref="algorithm1.16.16.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.3.3.2.1" xref="algorithm1.16.16.m1.2.3.3.2.1.cmml">​</mo><msubsup id="algorithm1.16.16.m1.2.3.3.2.2" xref="algorithm1.16.16.m1.2.3.3.2.2.cmml"><mi id="algorithm1.16.16.m1.2.3.3.2.2.2.2" xref="algorithm1.16.16.m1.2.3.3.2.2.2.2.cmml">w</mi><mi id="algorithm1.16.16.m1.2.3.3.2.2.2.3" xref="algorithm1.16.16.m1.2.3.3.2.2.2.3.cmml">k</mi><mi id="algorithm1.16.16.m1.2.3.3.2.2.3" xref="algorithm1.16.16.m1.2.3.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.2b"><apply id="algorithm1.16.16.m1.2.3.cmml" xref="algorithm1.16.16.m1.2.3"><ci id="algorithm1.16.16.m1.2.3.1.cmml" xref="algorithm1.16.16.m1.2.3.1">←</ci><apply id="algorithm1.16.16.m1.2.3.2.cmml" xref="algorithm1.16.16.m1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.3.2.1.cmml" xref="algorithm1.16.16.m1.2.3.2">superscript</csymbol><ci id="algorithm1.16.16.m1.2.3.2.2.cmml" xref="algorithm1.16.16.m1.2.3.2.2">𝑤</ci><apply id="algorithm1.16.16.m1.2.3.2.3.cmml" xref="algorithm1.16.16.m1.2.3.2.3"><plus id="algorithm1.16.16.m1.2.3.2.3.1.cmml" xref="algorithm1.16.16.m1.2.3.2.3.1"></plus><ci id="algorithm1.16.16.m1.2.3.2.3.2.cmml" xref="algorithm1.16.16.m1.2.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.16.16.m1.2.3.2.3.3.cmml" xref="algorithm1.16.16.m1.2.3.2.3.3">1</cn></apply></apply><apply id="algorithm1.16.16.m1.2.3.3.cmml" xref="algorithm1.16.16.m1.2.3.3"><apply id="algorithm1.16.16.m1.2.3.3.1.cmml" xref="algorithm1.16.16.m1.2.3.3.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.3.3.1.1.cmml" xref="algorithm1.16.16.m1.2.3.3.1">superscript</csymbol><apply id="algorithm1.16.16.m1.2.3.3.1.2.cmml" xref="algorithm1.16.16.m1.2.3.3.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.3.3.1.2.1.cmml" xref="algorithm1.16.16.m1.2.3.3.1">subscript</csymbol><sum id="algorithm1.16.16.m1.2.3.3.1.2.2.cmml" xref="algorithm1.16.16.m1.2.3.3.1.2.2"></sum><apply id="algorithm1.16.16.m1.2.3.3.1.2.3.cmml" xref="algorithm1.16.16.m1.2.3.3.1.2.3"><eq id="algorithm1.16.16.m1.2.3.3.1.2.3.1.cmml" xref="algorithm1.16.16.m1.2.3.3.1.2.3.1"></eq><ci id="algorithm1.16.16.m1.2.3.3.1.2.3.2.cmml" xref="algorithm1.16.16.m1.2.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="algorithm1.16.16.m1.2.3.3.1.2.3.3.cmml" xref="algorithm1.16.16.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.16.16.m1.2.3.3.1.3.cmml" xref="algorithm1.16.16.m1.2.3.3.1.3">𝑁</ci></apply><apply id="algorithm1.16.16.m1.2.3.3.2.cmml" xref="algorithm1.16.16.m1.2.3.3.2"><times id="algorithm1.16.16.m1.2.3.3.2.1.cmml" xref="algorithm1.16.16.m1.2.3.3.2.1"></times><apply id="algorithm1.16.16.m1.2.2.cmml" xref="algorithm1.16.16.m1.2.2"><divide id="algorithm1.16.16.m1.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2"></divide><apply id="algorithm1.16.16.m1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1"><abs id="algorithm1.16.16.m1.1.1.1.2.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.2"></abs><apply id="algorithm1.16.16.m1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.16.16.m1.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.2">𝒟</ci><ci id="algorithm1.16.16.m1.1.1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="algorithm1.16.16.m1.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2.3"><abs id="algorithm1.16.16.m1.2.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.2.3.1"></abs><ci id="algorithm1.16.16.m1.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="algorithm1.16.16.m1.2.3.3.2.2.cmml" xref="algorithm1.16.16.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.3.3.2.2.1.cmml" xref="algorithm1.16.16.m1.2.3.3.2.2">superscript</csymbol><apply id="algorithm1.16.16.m1.2.3.3.2.2.2.cmml" xref="algorithm1.16.16.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.3.3.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.3.3.2.2">subscript</csymbol><ci id="algorithm1.16.16.m1.2.3.3.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.3.3.2.2.2.2">𝑤</ci><ci id="algorithm1.16.16.m1.2.3.3.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.3.3.2.2.2.3">𝑘</ci></apply><ci id="algorithm1.16.16.m1.2.3.3.2.2.3.cmml" xref="algorithm1.16.16.m1.2.3.3.2.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.2c">w^{t+1}\leftarrow\sum_{k=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}w_{k}^{t}</annotation></semantics></math>

</div>
<div id="algorithm1.31.35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>
</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>return <math id="algorithm1.17.17.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="algorithm1.17.17.m1.1a"><msup id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml"><mi id="algorithm1.17.17.m1.1.1.2" xref="algorithm1.17.17.m1.1.1.2.cmml">w</mi><mi id="algorithm1.17.17.m1.1.1.3" xref="algorithm1.17.17.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><apply id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1">superscript</csymbol><ci id="algorithm1.17.17.m1.1.1.2.cmml" xref="algorithm1.17.17.m1.1.1.2">𝑤</ci><ci id="algorithm1.17.17.m1.1.1.3.cmml" xref="algorithm1.17.17.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">w^{T}</annotation></semantics></math>

</div>
<div id="algorithm1.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span><span id="algorithm1.19.19.1" class="ltx_text ltx_font_bold">PartyLocalTraining</span>(<math id="algorithm1.18.18.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.18.18.m1.1a"><mi id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><ci id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">i</annotation></semantics></math>, <math id="algorithm1.19.19.m2.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="algorithm1.19.19.m2.1a"><msup id="algorithm1.19.19.m2.1.1" xref="algorithm1.19.19.m2.1.1.cmml"><mi id="algorithm1.19.19.m2.1.1.2" xref="algorithm1.19.19.m2.1.1.2.cmml">w</mi><mi id="algorithm1.19.19.m2.1.1.3" xref="algorithm1.19.19.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m2.1b"><apply id="algorithm1.19.19.m2.1.1.cmml" xref="algorithm1.19.19.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.1.1.1.cmml" xref="algorithm1.19.19.m2.1.1">superscript</csymbol><ci id="algorithm1.19.19.m2.1.1.2.cmml" xref="algorithm1.19.19.m2.1.1.2">𝑤</ci><ci id="algorithm1.19.19.m2.1.1.3.cmml" xref="algorithm1.19.19.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m2.1c">w^{t}</annotation></semantics></math>):

</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span><math id="algorithm1.20.20.m1.1" class="ltx_Math" alttext="w_{i}^{t}\leftarrow w^{t}" display="inline"><semantics id="algorithm1.20.20.m1.1a"><mrow id="algorithm1.20.20.m1.1.1" xref="algorithm1.20.20.m1.1.1.cmml"><msubsup id="algorithm1.20.20.m1.1.1.2" xref="algorithm1.20.20.m1.1.1.2.cmml"><mi id="algorithm1.20.20.m1.1.1.2.2.2" xref="algorithm1.20.20.m1.1.1.2.2.2.cmml">w</mi><mi id="algorithm1.20.20.m1.1.1.2.2.3" xref="algorithm1.20.20.m1.1.1.2.2.3.cmml">i</mi><mi id="algorithm1.20.20.m1.1.1.2.3" xref="algorithm1.20.20.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="algorithm1.20.20.m1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.cmml">←</mo><msup id="algorithm1.20.20.m1.1.1.3" xref="algorithm1.20.20.m1.1.1.3.cmml"><mi id="algorithm1.20.20.m1.1.1.3.2" xref="algorithm1.20.20.m1.1.1.3.2.cmml">w</mi><mi id="algorithm1.20.20.m1.1.1.3.3" xref="algorithm1.20.20.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m1.1b"><apply id="algorithm1.20.20.m1.1.1.cmml" xref="algorithm1.20.20.m1.1.1"><ci id="algorithm1.20.20.m1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1">←</ci><apply id="algorithm1.20.20.m1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.2.1.cmml" xref="algorithm1.20.20.m1.1.1.2">superscript</csymbol><apply id="algorithm1.20.20.m1.1.1.2.2.cmml" xref="algorithm1.20.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.2">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.2.2.2">𝑤</ci><ci id="algorithm1.20.20.m1.1.1.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.2.2.3">𝑖</ci></apply><ci id="algorithm1.20.20.m1.1.1.2.3.cmml" xref="algorithm1.20.20.m1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.20.20.m1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.3.1.cmml" xref="algorithm1.20.20.m1.1.1.3">superscript</csymbol><ci id="algorithm1.20.20.m1.1.1.3.2.cmml" xref="algorithm1.20.20.m1.1.1.3.2">𝑤</ci><ci id="algorithm1.20.20.m1.1.1.3.3.cmml" xref="algorithm1.20.20.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m1.1c">w_{i}^{t}\leftarrow w^{t}</annotation></semantics></math>

</div>
<div id="algorithm1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span><span id="algorithm1.21.21.1" class="ltx_text ltx_font_bold">for</span> epoch <math id="algorithm1.21.21.m1.4" class="ltx_Math" alttext="i=1,2,...,E" display="inline"><semantics id="algorithm1.21.21.m1.4a"><mrow id="algorithm1.21.21.m1.4.5" xref="algorithm1.21.21.m1.4.5.cmml"><mi id="algorithm1.21.21.m1.4.5.2" xref="algorithm1.21.21.m1.4.5.2.cmml">i</mi><mo id="algorithm1.21.21.m1.4.5.1" xref="algorithm1.21.21.m1.4.5.1.cmml">=</mo><mrow id="algorithm1.21.21.m1.4.5.3.2" xref="algorithm1.21.21.m1.4.5.3.1.cmml"><mn id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml">1</mn><mo id="algorithm1.21.21.m1.4.5.3.2.1" xref="algorithm1.21.21.m1.4.5.3.1.cmml">,</mo><mn id="algorithm1.21.21.m1.2.2" xref="algorithm1.21.21.m1.2.2.cmml">2</mn><mo id="algorithm1.21.21.m1.4.5.3.2.2" xref="algorithm1.21.21.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.21.21.m1.3.3" xref="algorithm1.21.21.m1.3.3.cmml">…</mi><mo id="algorithm1.21.21.m1.4.5.3.2.3" xref="algorithm1.21.21.m1.4.5.3.1.cmml">,</mo><mi id="algorithm1.21.21.m1.4.4" xref="algorithm1.21.21.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.4b"><apply id="algorithm1.21.21.m1.4.5.cmml" xref="algorithm1.21.21.m1.4.5"><eq id="algorithm1.21.21.m1.4.5.1.cmml" xref="algorithm1.21.21.m1.4.5.1"></eq><ci id="algorithm1.21.21.m1.4.5.2.cmml" xref="algorithm1.21.21.m1.4.5.2">𝑖</ci><list id="algorithm1.21.21.m1.4.5.3.1.cmml" xref="algorithm1.21.21.m1.4.5.3.2"><cn type="integer" id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1">1</cn><cn type="integer" id="algorithm1.21.21.m1.2.2.cmml" xref="algorithm1.21.21.m1.2.2">2</cn><ci id="algorithm1.21.21.m1.3.3.cmml" xref="algorithm1.21.21.m1.3.3">…</ci><ci id="algorithm1.21.21.m1.4.4.cmml" xref="algorithm1.21.21.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.4c">i=1,2,...,E</annotation></semantics></math> <span id="algorithm1.21.21.2" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.23.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.23.23.1" class="ltx_text ltx_font_bold">for</span> each batch <math id="algorithm1.22.22.m1.2" class="ltx_Math" alttext="\textbf{b}=\{x,y\}" display="inline"><semantics id="algorithm1.22.22.m1.2a"><mrow id="algorithm1.22.22.m1.2.3" xref="algorithm1.22.22.m1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="algorithm1.22.22.m1.2.3.2" xref="algorithm1.22.22.m1.2.3.2a.cmml">b</mtext><mo id="algorithm1.22.22.m1.2.3.1" xref="algorithm1.22.22.m1.2.3.1.cmml">=</mo><mrow id="algorithm1.22.22.m1.2.3.3.2" xref="algorithm1.22.22.m1.2.3.3.1.cmml"><mo stretchy="false" id="algorithm1.22.22.m1.2.3.3.2.1" xref="algorithm1.22.22.m1.2.3.3.1.cmml">{</mo><mi id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml">x</mi><mo id="algorithm1.22.22.m1.2.3.3.2.2" xref="algorithm1.22.22.m1.2.3.3.1.cmml">,</mo><mi id="algorithm1.22.22.m1.2.2" xref="algorithm1.22.22.m1.2.2.cmml">y</mi><mo stretchy="false" id="algorithm1.22.22.m1.2.3.3.2.3" xref="algorithm1.22.22.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.2b"><apply id="algorithm1.22.22.m1.2.3.cmml" xref="algorithm1.22.22.m1.2.3"><eq id="algorithm1.22.22.m1.2.3.1.cmml" xref="algorithm1.22.22.m1.2.3.1"></eq><ci id="algorithm1.22.22.m1.2.3.2a.cmml" xref="algorithm1.22.22.m1.2.3.2"><mtext class="ltx_mathvariant_bold" id="algorithm1.22.22.m1.2.3.2.cmml" xref="algorithm1.22.22.m1.2.3.2">b</mtext></ci><set id="algorithm1.22.22.m1.2.3.3.1.cmml" xref="algorithm1.22.22.m1.2.3.3.2"><ci id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1">𝑥</ci><ci id="algorithm1.22.22.m1.2.2.cmml" xref="algorithm1.22.22.m1.2.2">𝑦</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.2c">\textbf{b}=\{x,y\}</annotation></semantics></math> of <math id="algorithm1.23.23.m2.1" class="ltx_Math" alttext="\mathcal{D}^{i}" display="inline"><semantics id="algorithm1.23.23.m2.1a"><msup id="algorithm1.23.23.m2.1.1" xref="algorithm1.23.23.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.23.m2.1.1.2" xref="algorithm1.23.23.m2.1.1.2.cmml">𝒟</mi><mi id="algorithm1.23.23.m2.1.1.3" xref="algorithm1.23.23.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m2.1b"><apply id="algorithm1.23.23.m2.1.1.cmml" xref="algorithm1.23.23.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m2.1.1.1.cmml" xref="algorithm1.23.23.m2.1.1">superscript</csymbol><ci id="algorithm1.23.23.m2.1.1.2.cmml" xref="algorithm1.23.23.m2.1.1.2">𝒟</ci><ci id="algorithm1.23.23.m2.1.1.3.cmml" xref="algorithm1.23.23.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m2.1c">\mathcal{D}^{i}</annotation></semantics></math> <span id="algorithm1.23.23.2" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.24.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.24.24.m1.3" class="ltx_Math" alttext="\ell_{sup}\leftarrow CrossEntropyLoss(F_{w_{i}^{t}}(x),y)" display="inline"><semantics id="algorithm1.24.24.m1.3a"><mrow id="algorithm1.24.24.m1.3.3" xref="algorithm1.24.24.m1.3.3.cmml"><msub id="algorithm1.24.24.m1.3.3.3" xref="algorithm1.24.24.m1.3.3.3.cmml"><mi mathvariant="normal" id="algorithm1.24.24.m1.3.3.3.2" xref="algorithm1.24.24.m1.3.3.3.2.cmml">ℓ</mi><mrow id="algorithm1.24.24.m1.3.3.3.3" xref="algorithm1.24.24.m1.3.3.3.3.cmml"><mi id="algorithm1.24.24.m1.3.3.3.3.2" xref="algorithm1.24.24.m1.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.3.3.1" xref="algorithm1.24.24.m1.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.3.3.3" xref="algorithm1.24.24.m1.3.3.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.3.3.1a" xref="algorithm1.24.24.m1.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.3.3.4" xref="algorithm1.24.24.m1.3.3.3.3.4.cmml">p</mi></mrow></msub><mo stretchy="false" id="algorithm1.24.24.m1.3.3.2" xref="algorithm1.24.24.m1.3.3.2.cmml">←</mo><mrow id="algorithm1.24.24.m1.3.3.1" xref="algorithm1.24.24.m1.3.3.1.cmml"><mi id="algorithm1.24.24.m1.3.3.1.3" xref="algorithm1.24.24.m1.3.3.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.4" xref="algorithm1.24.24.m1.3.3.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2a" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.5" xref="algorithm1.24.24.m1.3.3.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2b" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.6" xref="algorithm1.24.24.m1.3.3.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2c" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.7" xref="algorithm1.24.24.m1.3.3.1.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2d" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.8" xref="algorithm1.24.24.m1.3.3.1.8.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2e" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.9" xref="algorithm1.24.24.m1.3.3.1.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2f" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.10" xref="algorithm1.24.24.m1.3.3.1.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2g" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.11" xref="algorithm1.24.24.m1.3.3.1.11.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2h" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.12" xref="algorithm1.24.24.m1.3.3.1.12.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2i" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.13" xref="algorithm1.24.24.m1.3.3.1.13.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2j" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.14" xref="algorithm1.24.24.m1.3.3.1.14.cmml">y</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2k" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.15" xref="algorithm1.24.24.m1.3.3.1.15.cmml">L</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2l" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.16" xref="algorithm1.24.24.m1.3.3.1.16.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2m" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.17" xref="algorithm1.24.24.m1.3.3.1.17.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2n" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mi id="algorithm1.24.24.m1.3.3.1.18" xref="algorithm1.24.24.m1.3.3.1.18.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.2o" xref="algorithm1.24.24.m1.3.3.1.2.cmml">​</mo><mrow id="algorithm1.24.24.m1.3.3.1.1.1" xref="algorithm1.24.24.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="algorithm1.24.24.m1.3.3.1.1.1.2" xref="algorithm1.24.24.m1.3.3.1.1.2.cmml">(</mo><mrow id="algorithm1.24.24.m1.3.3.1.1.1.1" xref="algorithm1.24.24.m1.3.3.1.1.1.1.cmml"><msub id="algorithm1.24.24.m1.3.3.1.1.1.1.2" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.cmml"><mi id="algorithm1.24.24.m1.3.3.1.1.1.1.2.2" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.2.cmml">F</mi><msubsup id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.cmml"><mi id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.2" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.2.cmml">w</mi><mi id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.3" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.3.cmml">i</mi><mi id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.3" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.3.cmml">t</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.3.3.1.1.1.1.1" xref="algorithm1.24.24.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="algorithm1.24.24.m1.3.3.1.1.1.1.3.2" xref="algorithm1.24.24.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.24.24.m1.3.3.1.1.1.1.3.2.1" xref="algorithm1.24.24.m1.3.3.1.1.1.1.cmml">(</mo><mi id="algorithm1.24.24.m1.1.1" xref="algorithm1.24.24.m1.1.1.cmml">x</mi><mo stretchy="false" id="algorithm1.24.24.m1.3.3.1.1.1.1.3.2.2" xref="algorithm1.24.24.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.24.24.m1.3.3.1.1.1.3" xref="algorithm1.24.24.m1.3.3.1.1.2.cmml">,</mo><mi id="algorithm1.24.24.m1.2.2" xref="algorithm1.24.24.m1.2.2.cmml">y</mi><mo stretchy="false" id="algorithm1.24.24.m1.3.3.1.1.1.4" xref="algorithm1.24.24.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m1.3b"><apply id="algorithm1.24.24.m1.3.3.cmml" xref="algorithm1.24.24.m1.3.3"><ci id="algorithm1.24.24.m1.3.3.2.cmml" xref="algorithm1.24.24.m1.3.3.2">←</ci><apply id="algorithm1.24.24.m1.3.3.3.cmml" xref="algorithm1.24.24.m1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.3.3.3.1.cmml" xref="algorithm1.24.24.m1.3.3.3">subscript</csymbol><ci id="algorithm1.24.24.m1.3.3.3.2.cmml" xref="algorithm1.24.24.m1.3.3.3.2">ℓ</ci><apply id="algorithm1.24.24.m1.3.3.3.3.cmml" xref="algorithm1.24.24.m1.3.3.3.3"><times id="algorithm1.24.24.m1.3.3.3.3.1.cmml" xref="algorithm1.24.24.m1.3.3.3.3.1"></times><ci id="algorithm1.24.24.m1.3.3.3.3.2.cmml" xref="algorithm1.24.24.m1.3.3.3.3.2">𝑠</ci><ci id="algorithm1.24.24.m1.3.3.3.3.3.cmml" xref="algorithm1.24.24.m1.3.3.3.3.3">𝑢</ci><ci id="algorithm1.24.24.m1.3.3.3.3.4.cmml" xref="algorithm1.24.24.m1.3.3.3.3.4">𝑝</ci></apply></apply><apply id="algorithm1.24.24.m1.3.3.1.cmml" xref="algorithm1.24.24.m1.3.3.1"><times id="algorithm1.24.24.m1.3.3.1.2.cmml" xref="algorithm1.24.24.m1.3.3.1.2"></times><ci id="algorithm1.24.24.m1.3.3.1.3.cmml" xref="algorithm1.24.24.m1.3.3.1.3">𝐶</ci><ci id="algorithm1.24.24.m1.3.3.1.4.cmml" xref="algorithm1.24.24.m1.3.3.1.4">𝑟</ci><ci id="algorithm1.24.24.m1.3.3.1.5.cmml" xref="algorithm1.24.24.m1.3.3.1.5">𝑜</ci><ci id="algorithm1.24.24.m1.3.3.1.6.cmml" xref="algorithm1.24.24.m1.3.3.1.6">𝑠</ci><ci id="algorithm1.24.24.m1.3.3.1.7.cmml" xref="algorithm1.24.24.m1.3.3.1.7">𝑠</ci><ci id="algorithm1.24.24.m1.3.3.1.8.cmml" xref="algorithm1.24.24.m1.3.3.1.8">𝐸</ci><ci id="algorithm1.24.24.m1.3.3.1.9.cmml" xref="algorithm1.24.24.m1.3.3.1.9">𝑛</ci><ci id="algorithm1.24.24.m1.3.3.1.10.cmml" xref="algorithm1.24.24.m1.3.3.1.10">𝑡</ci><ci id="algorithm1.24.24.m1.3.3.1.11.cmml" xref="algorithm1.24.24.m1.3.3.1.11">𝑟</ci><ci id="algorithm1.24.24.m1.3.3.1.12.cmml" xref="algorithm1.24.24.m1.3.3.1.12">𝑜</ci><ci id="algorithm1.24.24.m1.3.3.1.13.cmml" xref="algorithm1.24.24.m1.3.3.1.13">𝑝</ci><ci id="algorithm1.24.24.m1.3.3.1.14.cmml" xref="algorithm1.24.24.m1.3.3.1.14">𝑦</ci><ci id="algorithm1.24.24.m1.3.3.1.15.cmml" xref="algorithm1.24.24.m1.3.3.1.15">𝐿</ci><ci id="algorithm1.24.24.m1.3.3.1.16.cmml" xref="algorithm1.24.24.m1.3.3.1.16">𝑜</ci><ci id="algorithm1.24.24.m1.3.3.1.17.cmml" xref="algorithm1.24.24.m1.3.3.1.17">𝑠</ci><ci id="algorithm1.24.24.m1.3.3.1.18.cmml" xref="algorithm1.24.24.m1.3.3.1.18">𝑠</ci><interval closure="open" id="algorithm1.24.24.m1.3.3.1.1.2.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1"><apply id="algorithm1.24.24.m1.3.3.1.1.1.1.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1"><times id="algorithm1.24.24.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.1"></times><apply id="algorithm1.24.24.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.3.3.1.1.1.1.2.1.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.24.24.m1.3.3.1.1.1.1.2.2.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.2">𝐹</ci><apply id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.1.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3">superscript</csymbol><apply id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.1.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3">subscript</csymbol><ci id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.2.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.2">𝑤</ci><ci id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.3.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.3.cmml" xref="algorithm1.24.24.m1.3.3.1.1.1.1.2.3.3">𝑡</ci></apply></apply><ci id="algorithm1.24.24.m1.1.1.cmml" xref="algorithm1.24.24.m1.1.1">𝑥</ci></apply><ci id="algorithm1.24.24.m1.2.2.cmml" xref="algorithm1.24.24.m1.2.2">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m1.3c">\ell_{sup}\leftarrow CrossEntropyLoss(F_{w_{i}^{t}}(x),y)</annotation></semantics></math>

</div>
<div id="algorithm1.25.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.25.25.m1.1" class="ltx_Math" alttext="z\leftarrow R_{w_{i}^{t}}(x)" display="inline"><semantics id="algorithm1.25.25.m1.1a"><mrow id="algorithm1.25.25.m1.1.2" xref="algorithm1.25.25.m1.1.2.cmml"><mi id="algorithm1.25.25.m1.1.2.2" xref="algorithm1.25.25.m1.1.2.2.cmml">z</mi><mo stretchy="false" id="algorithm1.25.25.m1.1.2.1" xref="algorithm1.25.25.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.25.25.m1.1.2.3" xref="algorithm1.25.25.m1.1.2.3.cmml"><msub id="algorithm1.25.25.m1.1.2.3.2" xref="algorithm1.25.25.m1.1.2.3.2.cmml"><mi id="algorithm1.25.25.m1.1.2.3.2.2" xref="algorithm1.25.25.m1.1.2.3.2.2.cmml">R</mi><msubsup id="algorithm1.25.25.m1.1.2.3.2.3" xref="algorithm1.25.25.m1.1.2.3.2.3.cmml"><mi id="algorithm1.25.25.m1.1.2.3.2.3.2.2" xref="algorithm1.25.25.m1.1.2.3.2.3.2.2.cmml">w</mi><mi id="algorithm1.25.25.m1.1.2.3.2.3.2.3" xref="algorithm1.25.25.m1.1.2.3.2.3.2.3.cmml">i</mi><mi id="algorithm1.25.25.m1.1.2.3.2.3.3" xref="algorithm1.25.25.m1.1.2.3.2.3.3.cmml">t</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m1.1.2.3.1" xref="algorithm1.25.25.m1.1.2.3.1.cmml">​</mo><mrow id="algorithm1.25.25.m1.1.2.3.3.2" xref="algorithm1.25.25.m1.1.2.3.cmml"><mo stretchy="false" id="algorithm1.25.25.m1.1.2.3.3.2.1" xref="algorithm1.25.25.m1.1.2.3.cmml">(</mo><mi id="algorithm1.25.25.m1.1.1" xref="algorithm1.25.25.m1.1.1.cmml">x</mi><mo stretchy="false" id="algorithm1.25.25.m1.1.2.3.3.2.2" xref="algorithm1.25.25.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m1.1b"><apply id="algorithm1.25.25.m1.1.2.cmml" xref="algorithm1.25.25.m1.1.2"><ci id="algorithm1.25.25.m1.1.2.1.cmml" xref="algorithm1.25.25.m1.1.2.1">←</ci><ci id="algorithm1.25.25.m1.1.2.2.cmml" xref="algorithm1.25.25.m1.1.2.2">𝑧</ci><apply id="algorithm1.25.25.m1.1.2.3.cmml" xref="algorithm1.25.25.m1.1.2.3"><times id="algorithm1.25.25.m1.1.2.3.1.cmml" xref="algorithm1.25.25.m1.1.2.3.1"></times><apply id="algorithm1.25.25.m1.1.2.3.2.cmml" xref="algorithm1.25.25.m1.1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.2.3.2.1.cmml" xref="algorithm1.25.25.m1.1.2.3.2">subscript</csymbol><ci id="algorithm1.25.25.m1.1.2.3.2.2.cmml" xref="algorithm1.25.25.m1.1.2.3.2.2">𝑅</ci><apply id="algorithm1.25.25.m1.1.2.3.2.3.cmml" xref="algorithm1.25.25.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.2.3.2.3.1.cmml" xref="algorithm1.25.25.m1.1.2.3.2.3">superscript</csymbol><apply id="algorithm1.25.25.m1.1.2.3.2.3.2.cmml" xref="algorithm1.25.25.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.2.3.2.3.2.1.cmml" xref="algorithm1.25.25.m1.1.2.3.2.3">subscript</csymbol><ci id="algorithm1.25.25.m1.1.2.3.2.3.2.2.cmml" xref="algorithm1.25.25.m1.1.2.3.2.3.2.2">𝑤</ci><ci id="algorithm1.25.25.m1.1.2.3.2.3.2.3.cmml" xref="algorithm1.25.25.m1.1.2.3.2.3.2.3">𝑖</ci></apply><ci id="algorithm1.25.25.m1.1.2.3.2.3.3.cmml" xref="algorithm1.25.25.m1.1.2.3.2.3.3">𝑡</ci></apply></apply><ci id="algorithm1.25.25.m1.1.1.cmml" xref="algorithm1.25.25.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m1.1c">z\leftarrow R_{w_{i}^{t}}(x)</annotation></semantics></math>

</div>
<div id="algorithm1.26.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.26.26.m1.1" class="ltx_Math" alttext="z_{glob}\leftarrow R_{w^{t}}(x)" display="inline"><semantics id="algorithm1.26.26.m1.1a"><mrow id="algorithm1.26.26.m1.1.2" xref="algorithm1.26.26.m1.1.2.cmml"><msub id="algorithm1.26.26.m1.1.2.2" xref="algorithm1.26.26.m1.1.2.2.cmml"><mi id="algorithm1.26.26.m1.1.2.2.2" xref="algorithm1.26.26.m1.1.2.2.2.cmml">z</mi><mrow id="algorithm1.26.26.m1.1.2.2.3" xref="algorithm1.26.26.m1.1.2.2.3.cmml"><mi id="algorithm1.26.26.m1.1.2.2.3.2" xref="algorithm1.26.26.m1.1.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.2.2.3.1" xref="algorithm1.26.26.m1.1.2.2.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.2.2.3.3" xref="algorithm1.26.26.m1.1.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.2.2.3.1a" xref="algorithm1.26.26.m1.1.2.2.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.2.2.3.4" xref="algorithm1.26.26.m1.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.2.2.3.1b" xref="algorithm1.26.26.m1.1.2.2.3.1.cmml">​</mo><mi id="algorithm1.26.26.m1.1.2.2.3.5" xref="algorithm1.26.26.m1.1.2.2.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="algorithm1.26.26.m1.1.2.1" xref="algorithm1.26.26.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.26.26.m1.1.2.3" xref="algorithm1.26.26.m1.1.2.3.cmml"><msub id="algorithm1.26.26.m1.1.2.3.2" xref="algorithm1.26.26.m1.1.2.3.2.cmml"><mi id="algorithm1.26.26.m1.1.2.3.2.2" xref="algorithm1.26.26.m1.1.2.3.2.2.cmml">R</mi><msup id="algorithm1.26.26.m1.1.2.3.2.3" xref="algorithm1.26.26.m1.1.2.3.2.3.cmml"><mi id="algorithm1.26.26.m1.1.2.3.2.3.2" xref="algorithm1.26.26.m1.1.2.3.2.3.2.cmml">w</mi><mi id="algorithm1.26.26.m1.1.2.3.2.3.3" xref="algorithm1.26.26.m1.1.2.3.2.3.3.cmml">t</mi></msup></msub><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.1.2.3.1" xref="algorithm1.26.26.m1.1.2.3.1.cmml">​</mo><mrow id="algorithm1.26.26.m1.1.2.3.3.2" xref="algorithm1.26.26.m1.1.2.3.cmml"><mo stretchy="false" id="algorithm1.26.26.m1.1.2.3.3.2.1" xref="algorithm1.26.26.m1.1.2.3.cmml">(</mo><mi id="algorithm1.26.26.m1.1.1" xref="algorithm1.26.26.m1.1.1.cmml">x</mi><mo stretchy="false" id="algorithm1.26.26.m1.1.2.3.3.2.2" xref="algorithm1.26.26.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m1.1b"><apply id="algorithm1.26.26.m1.1.2.cmml" xref="algorithm1.26.26.m1.1.2"><ci id="algorithm1.26.26.m1.1.2.1.cmml" xref="algorithm1.26.26.m1.1.2.1">←</ci><apply id="algorithm1.26.26.m1.1.2.2.cmml" xref="algorithm1.26.26.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.1.2.2.1.cmml" xref="algorithm1.26.26.m1.1.2.2">subscript</csymbol><ci id="algorithm1.26.26.m1.1.2.2.2.cmml" xref="algorithm1.26.26.m1.1.2.2.2">𝑧</ci><apply id="algorithm1.26.26.m1.1.2.2.3.cmml" xref="algorithm1.26.26.m1.1.2.2.3"><times id="algorithm1.26.26.m1.1.2.2.3.1.cmml" xref="algorithm1.26.26.m1.1.2.2.3.1"></times><ci id="algorithm1.26.26.m1.1.2.2.3.2.cmml" xref="algorithm1.26.26.m1.1.2.2.3.2">𝑔</ci><ci id="algorithm1.26.26.m1.1.2.2.3.3.cmml" xref="algorithm1.26.26.m1.1.2.2.3.3">𝑙</ci><ci id="algorithm1.26.26.m1.1.2.2.3.4.cmml" xref="algorithm1.26.26.m1.1.2.2.3.4">𝑜</ci><ci id="algorithm1.26.26.m1.1.2.2.3.5.cmml" xref="algorithm1.26.26.m1.1.2.2.3.5">𝑏</ci></apply></apply><apply id="algorithm1.26.26.m1.1.2.3.cmml" xref="algorithm1.26.26.m1.1.2.3"><times id="algorithm1.26.26.m1.1.2.3.1.cmml" xref="algorithm1.26.26.m1.1.2.3.1"></times><apply id="algorithm1.26.26.m1.1.2.3.2.cmml" xref="algorithm1.26.26.m1.1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.1.2.3.2.1.cmml" xref="algorithm1.26.26.m1.1.2.3.2">subscript</csymbol><ci id="algorithm1.26.26.m1.1.2.3.2.2.cmml" xref="algorithm1.26.26.m1.1.2.3.2.2">𝑅</ci><apply id="algorithm1.26.26.m1.1.2.3.2.3.cmml" xref="algorithm1.26.26.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.1.2.3.2.3.1.cmml" xref="algorithm1.26.26.m1.1.2.3.2.3">superscript</csymbol><ci id="algorithm1.26.26.m1.1.2.3.2.3.2.cmml" xref="algorithm1.26.26.m1.1.2.3.2.3.2">𝑤</ci><ci id="algorithm1.26.26.m1.1.2.3.2.3.3.cmml" xref="algorithm1.26.26.m1.1.2.3.2.3.3">𝑡</ci></apply></apply><ci id="algorithm1.26.26.m1.1.1.cmml" xref="algorithm1.26.26.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m1.1c">z_{glob}\leftarrow R_{w^{t}}(x)</annotation></semantics></math>

</div>
<div id="algorithm1.27.27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.27.27.m1.1" class="ltx_Math" alttext="z_{prev}\leftarrow R_{w_{i}^{t-1}}(x)" display="inline"><semantics id="algorithm1.27.27.m1.1a"><mrow id="algorithm1.27.27.m1.1.2" xref="algorithm1.27.27.m1.1.2.cmml"><msub id="algorithm1.27.27.m1.1.2.2" xref="algorithm1.27.27.m1.1.2.2.cmml"><mi id="algorithm1.27.27.m1.1.2.2.2" xref="algorithm1.27.27.m1.1.2.2.2.cmml">z</mi><mrow id="algorithm1.27.27.m1.1.2.2.3" xref="algorithm1.27.27.m1.1.2.2.3.cmml"><mi id="algorithm1.27.27.m1.1.2.2.3.2" xref="algorithm1.27.27.m1.1.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.1.2.2.3.1" xref="algorithm1.27.27.m1.1.2.2.3.1.cmml">​</mo><mi id="algorithm1.27.27.m1.1.2.2.3.3" xref="algorithm1.27.27.m1.1.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.1.2.2.3.1a" xref="algorithm1.27.27.m1.1.2.2.3.1.cmml">​</mo><mi id="algorithm1.27.27.m1.1.2.2.3.4" xref="algorithm1.27.27.m1.1.2.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.1.2.2.3.1b" xref="algorithm1.27.27.m1.1.2.2.3.1.cmml">​</mo><mi id="algorithm1.27.27.m1.1.2.2.3.5" xref="algorithm1.27.27.m1.1.2.2.3.5.cmml">v</mi></mrow></msub><mo stretchy="false" id="algorithm1.27.27.m1.1.2.1" xref="algorithm1.27.27.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.27.27.m1.1.2.3" xref="algorithm1.27.27.m1.1.2.3.cmml"><msub id="algorithm1.27.27.m1.1.2.3.2" xref="algorithm1.27.27.m1.1.2.3.2.cmml"><mi id="algorithm1.27.27.m1.1.2.3.2.2" xref="algorithm1.27.27.m1.1.2.3.2.2.cmml">R</mi><msubsup id="algorithm1.27.27.m1.1.2.3.2.3" xref="algorithm1.27.27.m1.1.2.3.2.3.cmml"><mi id="algorithm1.27.27.m1.1.2.3.2.3.2.2" xref="algorithm1.27.27.m1.1.2.3.2.3.2.2.cmml">w</mi><mi id="algorithm1.27.27.m1.1.2.3.2.3.2.3" xref="algorithm1.27.27.m1.1.2.3.2.3.2.3.cmml">i</mi><mrow id="algorithm1.27.27.m1.1.2.3.2.3.3" xref="algorithm1.27.27.m1.1.2.3.2.3.3.cmml"><mi id="algorithm1.27.27.m1.1.2.3.2.3.3.2" xref="algorithm1.27.27.m1.1.2.3.2.3.3.2.cmml">t</mi><mo id="algorithm1.27.27.m1.1.2.3.2.3.3.1" xref="algorithm1.27.27.m1.1.2.3.2.3.3.1.cmml">−</mo><mn id="algorithm1.27.27.m1.1.2.3.2.3.3.3" xref="algorithm1.27.27.m1.1.2.3.2.3.3.3.cmml">1</mn></mrow></msubsup></msub><mo lspace="0em" rspace="0em" id="algorithm1.27.27.m1.1.2.3.1" xref="algorithm1.27.27.m1.1.2.3.1.cmml">​</mo><mrow id="algorithm1.27.27.m1.1.2.3.3.2" xref="algorithm1.27.27.m1.1.2.3.cmml"><mo stretchy="false" id="algorithm1.27.27.m1.1.2.3.3.2.1" xref="algorithm1.27.27.m1.1.2.3.cmml">(</mo><mi id="algorithm1.27.27.m1.1.1" xref="algorithm1.27.27.m1.1.1.cmml">x</mi><mo stretchy="false" id="algorithm1.27.27.m1.1.2.3.3.2.2" xref="algorithm1.27.27.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m1.1b"><apply id="algorithm1.27.27.m1.1.2.cmml" xref="algorithm1.27.27.m1.1.2"><ci id="algorithm1.27.27.m1.1.2.1.cmml" xref="algorithm1.27.27.m1.1.2.1">←</ci><apply id="algorithm1.27.27.m1.1.2.2.cmml" xref="algorithm1.27.27.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.2.2.1.cmml" xref="algorithm1.27.27.m1.1.2.2">subscript</csymbol><ci id="algorithm1.27.27.m1.1.2.2.2.cmml" xref="algorithm1.27.27.m1.1.2.2.2">𝑧</ci><apply id="algorithm1.27.27.m1.1.2.2.3.cmml" xref="algorithm1.27.27.m1.1.2.2.3"><times id="algorithm1.27.27.m1.1.2.2.3.1.cmml" xref="algorithm1.27.27.m1.1.2.2.3.1"></times><ci id="algorithm1.27.27.m1.1.2.2.3.2.cmml" xref="algorithm1.27.27.m1.1.2.2.3.2">𝑝</ci><ci id="algorithm1.27.27.m1.1.2.2.3.3.cmml" xref="algorithm1.27.27.m1.1.2.2.3.3">𝑟</ci><ci id="algorithm1.27.27.m1.1.2.2.3.4.cmml" xref="algorithm1.27.27.m1.1.2.2.3.4">𝑒</ci><ci id="algorithm1.27.27.m1.1.2.2.3.5.cmml" xref="algorithm1.27.27.m1.1.2.2.3.5">𝑣</ci></apply></apply><apply id="algorithm1.27.27.m1.1.2.3.cmml" xref="algorithm1.27.27.m1.1.2.3"><times id="algorithm1.27.27.m1.1.2.3.1.cmml" xref="algorithm1.27.27.m1.1.2.3.1"></times><apply id="algorithm1.27.27.m1.1.2.3.2.cmml" xref="algorithm1.27.27.m1.1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.2.3.2.1.cmml" xref="algorithm1.27.27.m1.1.2.3.2">subscript</csymbol><ci id="algorithm1.27.27.m1.1.2.3.2.2.cmml" xref="algorithm1.27.27.m1.1.2.3.2.2">𝑅</ci><apply id="algorithm1.27.27.m1.1.2.3.2.3.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.2.3.2.3.1.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3">superscript</csymbol><apply id="algorithm1.27.27.m1.1.2.3.2.3.2.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.2.3.2.3.2.1.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3">subscript</csymbol><ci id="algorithm1.27.27.m1.1.2.3.2.3.2.2.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3.2.2">𝑤</ci><ci id="algorithm1.27.27.m1.1.2.3.2.3.2.3.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3.2.3">𝑖</ci></apply><apply id="algorithm1.27.27.m1.1.2.3.2.3.3.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3.3"><minus id="algorithm1.27.27.m1.1.2.3.2.3.3.1.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3.3.1"></minus><ci id="algorithm1.27.27.m1.1.2.3.2.3.3.2.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3.3.2">𝑡</ci><cn type="integer" id="algorithm1.27.27.m1.1.2.3.2.3.3.3.cmml" xref="algorithm1.27.27.m1.1.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="algorithm1.27.27.m1.1.1.cmml" xref="algorithm1.27.27.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m1.1c">z_{prev}\leftarrow R_{w_{i}^{t-1}}(x)</annotation></semantics></math>

</div>
<div id="algorithm1.28.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.28.28.m1.9" class="ltx_Math" alttext="\ell_{con}\leftarrow-\log{\frac{\exp(\textrm{sim}(z,z_{glob})/\tau)}{\exp(\textrm{sim}(z,z_{glob})/\tau)+\exp(\textrm{sim}(z,z_{prev})/\tau)}}" display="inline"><semantics id="algorithm1.28.28.m1.9a"><mrow id="algorithm1.28.28.m1.9.10" xref="algorithm1.28.28.m1.9.10.cmml"><msub id="algorithm1.28.28.m1.9.10.2" xref="algorithm1.28.28.m1.9.10.2.cmml"><mi mathvariant="normal" id="algorithm1.28.28.m1.9.10.2.2" xref="algorithm1.28.28.m1.9.10.2.2.cmml">ℓ</mi><mrow id="algorithm1.28.28.m1.9.10.2.3" xref="algorithm1.28.28.m1.9.10.2.3.cmml"><mi id="algorithm1.28.28.m1.9.10.2.3.2" xref="algorithm1.28.28.m1.9.10.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.9.10.2.3.1" xref="algorithm1.28.28.m1.9.10.2.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.9.10.2.3.3" xref="algorithm1.28.28.m1.9.10.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.9.10.2.3.1a" xref="algorithm1.28.28.m1.9.10.2.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.9.10.2.3.4" xref="algorithm1.28.28.m1.9.10.2.3.4.cmml">n</mi></mrow></msub><mo stretchy="false" id="algorithm1.28.28.m1.9.10.1" xref="algorithm1.28.28.m1.9.10.1.cmml">←</mo><mrow id="algorithm1.28.28.m1.9.10.3" xref="algorithm1.28.28.m1.9.10.3.cmml"><mo rspace="0.167em" id="algorithm1.28.28.m1.9.10.3a" xref="algorithm1.28.28.m1.9.10.3.cmml">−</mo><mrow id="algorithm1.28.28.m1.9.10.3.2" xref="algorithm1.28.28.m1.9.10.3.2.cmml"><mi id="algorithm1.28.28.m1.9.10.3.2.1" xref="algorithm1.28.28.m1.9.10.3.2.1.cmml">log</mi><mo lspace="0.167em" id="algorithm1.28.28.m1.9.10.3.2a" xref="algorithm1.28.28.m1.9.10.3.2.cmml">⁡</mo><mfrac id="algorithm1.28.28.m1.9.9" xref="algorithm1.28.28.m1.9.9.cmml"><mrow id="algorithm1.28.28.m1.3.3.3.3" xref="algorithm1.28.28.m1.3.3.3.4.cmml"><mi id="algorithm1.28.28.m1.2.2.2.2" xref="algorithm1.28.28.m1.2.2.2.2.cmml">exp</mi><mo id="algorithm1.28.28.m1.3.3.3.3a" xref="algorithm1.28.28.m1.3.3.3.4.cmml">⁡</mo><mrow id="algorithm1.28.28.m1.3.3.3.3.1" xref="algorithm1.28.28.m1.3.3.3.4.cmml"><mo stretchy="false" id="algorithm1.28.28.m1.3.3.3.3.1.2" xref="algorithm1.28.28.m1.3.3.3.4.cmml">(</mo><mrow id="algorithm1.28.28.m1.3.3.3.3.1.1" xref="algorithm1.28.28.m1.3.3.3.3.1.1.cmml"><mrow id="algorithm1.28.28.m1.3.3.3.3.1.1.1" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.cmml"><mtext id="algorithm1.28.28.m1.3.3.3.3.1.1.1.3" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.2" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.2" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.2.cmml">(</mo><mi id="algorithm1.28.28.m1.1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.1.cmml">z</mi><mo id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.3" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.2.cmml">,</mo><msub id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.2" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">z</mi><mrow id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.3" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1a" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.4" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1b" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.5" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.4" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="algorithm1.28.28.m1.3.3.3.3.1.1.2" xref="algorithm1.28.28.m1.3.3.3.3.1.1.2.cmml">/</mo><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.3" xref="algorithm1.28.28.m1.3.3.3.3.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="algorithm1.28.28.m1.3.3.3.3.1.3" xref="algorithm1.28.28.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="algorithm1.28.28.m1.9.9.9" xref="algorithm1.28.28.m1.9.9.9.cmml"><mrow id="algorithm1.28.28.m1.8.8.8.5.1" xref="algorithm1.28.28.m1.8.8.8.5.2.cmml"><mi id="algorithm1.28.28.m1.5.5.5.2" xref="algorithm1.28.28.m1.5.5.5.2.cmml">exp</mi><mo id="algorithm1.28.28.m1.8.8.8.5.1a" xref="algorithm1.28.28.m1.8.8.8.5.2.cmml">⁡</mo><mrow id="algorithm1.28.28.m1.8.8.8.5.1.1" xref="algorithm1.28.28.m1.8.8.8.5.2.cmml"><mo stretchy="false" id="algorithm1.28.28.m1.8.8.8.5.1.1.2" xref="algorithm1.28.28.m1.8.8.8.5.2.cmml">(</mo><mrow id="algorithm1.28.28.m1.8.8.8.5.1.1.1" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.cmml"><mrow id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.cmml"><mtext id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.3" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.2" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.2" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.2.cmml">(</mo><mi id="algorithm1.28.28.m1.4.4.4.1" xref="algorithm1.28.28.m1.4.4.4.1.cmml">z</mi><mo id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.2.cmml">,</mo><msub id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.2" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.2" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.3" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1a" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.4" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1b" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.5" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo stretchy="false" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.4" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="algorithm1.28.28.m1.8.8.8.5.1.1.1.2" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.2.cmml">/</mo><mi id="algorithm1.28.28.m1.8.8.8.5.1.1.1.3" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="algorithm1.28.28.m1.8.8.8.5.1.1.3" xref="algorithm1.28.28.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="algorithm1.28.28.m1.9.9.9.7" xref="algorithm1.28.28.m1.9.9.9.7.cmml">+</mo><mrow id="algorithm1.28.28.m1.9.9.9.6.1" xref="algorithm1.28.28.m1.9.9.9.6.2.cmml"><mi id="algorithm1.28.28.m1.7.7.7.4" xref="algorithm1.28.28.m1.7.7.7.4.cmml">exp</mi><mo id="algorithm1.28.28.m1.9.9.9.6.1a" xref="algorithm1.28.28.m1.9.9.9.6.2.cmml">⁡</mo><mrow id="algorithm1.28.28.m1.9.9.9.6.1.1" xref="algorithm1.28.28.m1.9.9.9.6.2.cmml"><mo stretchy="false" id="algorithm1.28.28.m1.9.9.9.6.1.1.2" xref="algorithm1.28.28.m1.9.9.9.6.2.cmml">(</mo><mrow id="algorithm1.28.28.m1.9.9.9.6.1.1.1" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.cmml"><mrow id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.cmml"><mtext id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.3" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.2" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.2" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.2.cmml">(</mo><mi id="algorithm1.28.28.m1.6.6.6.3" xref="algorithm1.28.28.m1.6.6.6.3.cmml">z</mi><mo id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.2.cmml">,</mo><msub id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.2" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.2" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.3" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1a" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.4" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1b" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.5" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.5.cmml">v</mi></mrow></msub><mo stretchy="false" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.4" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="algorithm1.28.28.m1.9.9.9.6.1.1.1.2" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.2.cmml">/</mo><mi id="algorithm1.28.28.m1.9.9.9.6.1.1.1.3" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="algorithm1.28.28.m1.9.9.9.6.1.1.3" xref="algorithm1.28.28.m1.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.m1.9b"><apply id="algorithm1.28.28.m1.9.10.cmml" xref="algorithm1.28.28.m1.9.10"><ci id="algorithm1.28.28.m1.9.10.1.cmml" xref="algorithm1.28.28.m1.9.10.1">←</ci><apply id="algorithm1.28.28.m1.9.10.2.cmml" xref="algorithm1.28.28.m1.9.10.2"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.9.10.2.1.cmml" xref="algorithm1.28.28.m1.9.10.2">subscript</csymbol><ci id="algorithm1.28.28.m1.9.10.2.2.cmml" xref="algorithm1.28.28.m1.9.10.2.2">ℓ</ci><apply id="algorithm1.28.28.m1.9.10.2.3.cmml" xref="algorithm1.28.28.m1.9.10.2.3"><times id="algorithm1.28.28.m1.9.10.2.3.1.cmml" xref="algorithm1.28.28.m1.9.10.2.3.1"></times><ci id="algorithm1.28.28.m1.9.10.2.3.2.cmml" xref="algorithm1.28.28.m1.9.10.2.3.2">𝑐</ci><ci id="algorithm1.28.28.m1.9.10.2.3.3.cmml" xref="algorithm1.28.28.m1.9.10.2.3.3">𝑜</ci><ci id="algorithm1.28.28.m1.9.10.2.3.4.cmml" xref="algorithm1.28.28.m1.9.10.2.3.4">𝑛</ci></apply></apply><apply id="algorithm1.28.28.m1.9.10.3.cmml" xref="algorithm1.28.28.m1.9.10.3"><minus id="algorithm1.28.28.m1.9.10.3.1.cmml" xref="algorithm1.28.28.m1.9.10.3"></minus><apply id="algorithm1.28.28.m1.9.10.3.2.cmml" xref="algorithm1.28.28.m1.9.10.3.2"><log id="algorithm1.28.28.m1.9.10.3.2.1.cmml" xref="algorithm1.28.28.m1.9.10.3.2.1"></log><apply id="algorithm1.28.28.m1.9.9.cmml" xref="algorithm1.28.28.m1.9.9"><divide id="algorithm1.28.28.m1.9.9.10.cmml" xref="algorithm1.28.28.m1.9.9"></divide><apply id="algorithm1.28.28.m1.3.3.3.4.cmml" xref="algorithm1.28.28.m1.3.3.3.3"><exp id="algorithm1.28.28.m1.2.2.2.2.cmml" xref="algorithm1.28.28.m1.2.2.2.2"></exp><apply id="algorithm1.28.28.m1.3.3.3.3.1.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1"><divide id="algorithm1.28.28.m1.3.3.3.3.1.1.2.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.2"></divide><apply id="algorithm1.28.28.m1.3.3.3.3.1.1.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1"><times id="algorithm1.28.28.m1.3.3.3.3.1.1.1.2.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.2"></times><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.1.3a.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.3"><mtext mathsize="70%" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.3.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.3">sim</mtext></ci><interval closure="open" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1"><ci id="algorithm1.28.28.m1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1">𝑧</ci><apply id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.2">𝑧</ci><apply id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3"><times id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.2">𝑔</ci><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.3">𝑙</ci><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.4.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.4">𝑜</ci><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.5.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.1.1.1.1.3.5">𝑏</ci></apply></apply></interval></apply><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.3.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.3">𝜏</ci></apply></apply><apply id="algorithm1.28.28.m1.9.9.9.cmml" xref="algorithm1.28.28.m1.9.9.9"><plus id="algorithm1.28.28.m1.9.9.9.7.cmml" xref="algorithm1.28.28.m1.9.9.9.7"></plus><apply id="algorithm1.28.28.m1.8.8.8.5.2.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1"><exp id="algorithm1.28.28.m1.5.5.5.2.cmml" xref="algorithm1.28.28.m1.5.5.5.2"></exp><apply id="algorithm1.28.28.m1.8.8.8.5.1.1.1.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1"><divide id="algorithm1.28.28.m1.8.8.8.5.1.1.1.2.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.2"></divide><apply id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1"><times id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.2"></times><ci id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.3a.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.3"><mtext mathsize="70%" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.3">sim</mtext></ci><interval closure="open" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1"><ci id="algorithm1.28.28.m1.4.4.4.1.cmml" xref="algorithm1.28.28.m1.4.4.4.1">𝑧</ci><apply id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.2">𝑧</ci><apply id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3"><times id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.4.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.4">𝑜</ci><ci id="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.5.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.1.1.1.1.3.5">𝑏</ci></apply></apply></interval></apply><ci id="algorithm1.28.28.m1.8.8.8.5.1.1.1.3.cmml" xref="algorithm1.28.28.m1.8.8.8.5.1.1.1.3">𝜏</ci></apply></apply><apply id="algorithm1.28.28.m1.9.9.9.6.2.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1"><exp id="algorithm1.28.28.m1.7.7.7.4.cmml" xref="algorithm1.28.28.m1.7.7.7.4"></exp><apply id="algorithm1.28.28.m1.9.9.9.6.1.1.1.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1"><divide id="algorithm1.28.28.m1.9.9.9.6.1.1.1.2.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.2"></divide><apply id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1"><times id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.2"></times><ci id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.3a.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.3"><mtext mathsize="70%" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.3">sim</mtext></ci><interval closure="open" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1"><ci id="algorithm1.28.28.m1.6.6.6.3.cmml" xref="algorithm1.28.28.m1.6.6.6.3">𝑧</ci><apply id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.2">𝑧</ci><apply id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3"><times id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.4.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.4">𝑒</ci><ci id="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.5.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.1.1.1.1.3.5">𝑣</ci></apply></apply></interval></apply><ci id="algorithm1.28.28.m1.9.9.9.6.1.1.1.3.cmml" xref="algorithm1.28.28.m1.9.9.9.6.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.m1.9c">\ell_{con}\leftarrow-\log{\frac{\exp(\textrm{sim}(z,z_{glob})/\tau)}{\exp(\textrm{sim}(z,z_{glob})/\tau)+\exp(\textrm{sim}(z,z_{prev})/\tau)}}</annotation></semantics></math>

</div>
<div id="algorithm1.29.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.29.29.m1.1" class="ltx_Math" alttext="\ell\leftarrow\ell_{sup}+\mu\ell_{con}" display="inline"><semantics id="algorithm1.29.29.m1.1a"><mrow id="algorithm1.29.29.m1.1.1" xref="algorithm1.29.29.m1.1.1.cmml"><mi mathvariant="normal" id="algorithm1.29.29.m1.1.1.2" xref="algorithm1.29.29.m1.1.1.2.cmml">ℓ</mi><mo stretchy="false" id="algorithm1.29.29.m1.1.1.1" xref="algorithm1.29.29.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.29.29.m1.1.1.3" xref="algorithm1.29.29.m1.1.1.3.cmml"><msub id="algorithm1.29.29.m1.1.1.3.2" xref="algorithm1.29.29.m1.1.1.3.2.cmml"><mi mathvariant="normal" id="algorithm1.29.29.m1.1.1.3.2.2" xref="algorithm1.29.29.m1.1.1.3.2.2.cmml">ℓ</mi><mrow id="algorithm1.29.29.m1.1.1.3.2.3" xref="algorithm1.29.29.m1.1.1.3.2.3.cmml"><mi id="algorithm1.29.29.m1.1.1.3.2.3.2" xref="algorithm1.29.29.m1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.29.29.m1.1.1.3.2.3.1" xref="algorithm1.29.29.m1.1.1.3.2.3.1.cmml">​</mo><mi id="algorithm1.29.29.m1.1.1.3.2.3.3" xref="algorithm1.29.29.m1.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="algorithm1.29.29.m1.1.1.3.2.3.1a" xref="algorithm1.29.29.m1.1.1.3.2.3.1.cmml">​</mo><mi id="algorithm1.29.29.m1.1.1.3.2.3.4" xref="algorithm1.29.29.m1.1.1.3.2.3.4.cmml">p</mi></mrow></msub><mo id="algorithm1.29.29.m1.1.1.3.1" xref="algorithm1.29.29.m1.1.1.3.1.cmml">+</mo><mrow id="algorithm1.29.29.m1.1.1.3.3" xref="algorithm1.29.29.m1.1.1.3.3.cmml"><mi id="algorithm1.29.29.m1.1.1.3.3.2" xref="algorithm1.29.29.m1.1.1.3.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="algorithm1.29.29.m1.1.1.3.3.1" xref="algorithm1.29.29.m1.1.1.3.3.1.cmml">​</mo><msub id="algorithm1.29.29.m1.1.1.3.3.3" xref="algorithm1.29.29.m1.1.1.3.3.3.cmml"><mi mathvariant="normal" id="algorithm1.29.29.m1.1.1.3.3.3.2" xref="algorithm1.29.29.m1.1.1.3.3.3.2.cmml">ℓ</mi><mrow id="algorithm1.29.29.m1.1.1.3.3.3.3" xref="algorithm1.29.29.m1.1.1.3.3.3.3.cmml"><mi id="algorithm1.29.29.m1.1.1.3.3.3.3.2" xref="algorithm1.29.29.m1.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm1.29.29.m1.1.1.3.3.3.3.1" xref="algorithm1.29.29.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.29.29.m1.1.1.3.3.3.3.3" xref="algorithm1.29.29.m1.1.1.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.29.29.m1.1.1.3.3.3.3.1a" xref="algorithm1.29.29.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.29.29.m1.1.1.3.3.3.3.4" xref="algorithm1.29.29.m1.1.1.3.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.m1.1b"><apply id="algorithm1.29.29.m1.1.1.cmml" xref="algorithm1.29.29.m1.1.1"><ci id="algorithm1.29.29.m1.1.1.1.cmml" xref="algorithm1.29.29.m1.1.1.1">←</ci><ci id="algorithm1.29.29.m1.1.1.2.cmml" xref="algorithm1.29.29.m1.1.1.2">ℓ</ci><apply id="algorithm1.29.29.m1.1.1.3.cmml" xref="algorithm1.29.29.m1.1.1.3"><plus id="algorithm1.29.29.m1.1.1.3.1.cmml" xref="algorithm1.29.29.m1.1.1.3.1"></plus><apply id="algorithm1.29.29.m1.1.1.3.2.cmml" xref="algorithm1.29.29.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.29.29.m1.1.1.3.2.1.cmml" xref="algorithm1.29.29.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.29.29.m1.1.1.3.2.2.cmml" xref="algorithm1.29.29.m1.1.1.3.2.2">ℓ</ci><apply id="algorithm1.29.29.m1.1.1.3.2.3.cmml" xref="algorithm1.29.29.m1.1.1.3.2.3"><times id="algorithm1.29.29.m1.1.1.3.2.3.1.cmml" xref="algorithm1.29.29.m1.1.1.3.2.3.1"></times><ci id="algorithm1.29.29.m1.1.1.3.2.3.2.cmml" xref="algorithm1.29.29.m1.1.1.3.2.3.2">𝑠</ci><ci id="algorithm1.29.29.m1.1.1.3.2.3.3.cmml" xref="algorithm1.29.29.m1.1.1.3.2.3.3">𝑢</ci><ci id="algorithm1.29.29.m1.1.1.3.2.3.4.cmml" xref="algorithm1.29.29.m1.1.1.3.2.3.4">𝑝</ci></apply></apply><apply id="algorithm1.29.29.m1.1.1.3.3.cmml" xref="algorithm1.29.29.m1.1.1.3.3"><times id="algorithm1.29.29.m1.1.1.3.3.1.cmml" xref="algorithm1.29.29.m1.1.1.3.3.1"></times><ci id="algorithm1.29.29.m1.1.1.3.3.2.cmml" xref="algorithm1.29.29.m1.1.1.3.3.2">𝜇</ci><apply id="algorithm1.29.29.m1.1.1.3.3.3.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.29.29.m1.1.1.3.3.3.1.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.29.29.m1.1.1.3.3.3.2.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3.2">ℓ</ci><apply id="algorithm1.29.29.m1.1.1.3.3.3.3.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3.3"><times id="algorithm1.29.29.m1.1.1.3.3.3.3.1.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3.3.1"></times><ci id="algorithm1.29.29.m1.1.1.3.3.3.3.2.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3.3.2">𝑐</ci><ci id="algorithm1.29.29.m1.1.1.3.3.3.3.3.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3.3.3">𝑜</ci><ci id="algorithm1.29.29.m1.1.1.3.3.3.3.4.cmml" xref="algorithm1.29.29.m1.1.1.3.3.3.3.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.m1.1c">\ell\leftarrow\ell_{sup}+\mu\ell_{con}</annotation></semantics></math>

</div>
<div id="algorithm1.30.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.30.30.m1.1" class="ltx_Math" alttext="w_{i}^{t}\leftarrow w_{i}^{t}-\eta\nabla\ell" display="inline"><semantics id="algorithm1.30.30.m1.1a"><mrow id="algorithm1.30.30.m1.1.1" xref="algorithm1.30.30.m1.1.1.cmml"><msubsup id="algorithm1.30.30.m1.1.1.2" xref="algorithm1.30.30.m1.1.1.2.cmml"><mi id="algorithm1.30.30.m1.1.1.2.2.2" xref="algorithm1.30.30.m1.1.1.2.2.2.cmml">w</mi><mi id="algorithm1.30.30.m1.1.1.2.2.3" xref="algorithm1.30.30.m1.1.1.2.2.3.cmml">i</mi><mi id="algorithm1.30.30.m1.1.1.2.3" xref="algorithm1.30.30.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="algorithm1.30.30.m1.1.1.1" xref="algorithm1.30.30.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.30.30.m1.1.1.3" xref="algorithm1.30.30.m1.1.1.3.cmml"><msubsup id="algorithm1.30.30.m1.1.1.3.2" xref="algorithm1.30.30.m1.1.1.3.2.cmml"><mi id="algorithm1.30.30.m1.1.1.3.2.2.2" xref="algorithm1.30.30.m1.1.1.3.2.2.2.cmml">w</mi><mi id="algorithm1.30.30.m1.1.1.3.2.2.3" xref="algorithm1.30.30.m1.1.1.3.2.2.3.cmml">i</mi><mi id="algorithm1.30.30.m1.1.1.3.2.3" xref="algorithm1.30.30.m1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="algorithm1.30.30.m1.1.1.3.1" xref="algorithm1.30.30.m1.1.1.3.1.cmml">−</mo><mrow id="algorithm1.30.30.m1.1.1.3.3" xref="algorithm1.30.30.m1.1.1.3.3.cmml"><mi id="algorithm1.30.30.m1.1.1.3.3.2" xref="algorithm1.30.30.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm1.30.30.m1.1.1.3.3.1" xref="algorithm1.30.30.m1.1.1.3.3.1.cmml">​</mo><mrow id="algorithm1.30.30.m1.1.1.3.3.3" xref="algorithm1.30.30.m1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="algorithm1.30.30.m1.1.1.3.3.3.1" xref="algorithm1.30.30.m1.1.1.3.3.3.1.cmml">∇</mo><mi mathvariant="normal" id="algorithm1.30.30.m1.1.1.3.3.3.2" xref="algorithm1.30.30.m1.1.1.3.3.3.2.cmml">ℓ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.m1.1b"><apply id="algorithm1.30.30.m1.1.1.cmml" xref="algorithm1.30.30.m1.1.1"><ci id="algorithm1.30.30.m1.1.1.1.cmml" xref="algorithm1.30.30.m1.1.1.1">←</ci><apply id="algorithm1.30.30.m1.1.1.2.cmml" xref="algorithm1.30.30.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.30.30.m1.1.1.2.1.cmml" xref="algorithm1.30.30.m1.1.1.2">superscript</csymbol><apply id="algorithm1.30.30.m1.1.1.2.2.cmml" xref="algorithm1.30.30.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.30.30.m1.1.1.2.2.1.cmml" xref="algorithm1.30.30.m1.1.1.2">subscript</csymbol><ci id="algorithm1.30.30.m1.1.1.2.2.2.cmml" xref="algorithm1.30.30.m1.1.1.2.2.2">𝑤</ci><ci id="algorithm1.30.30.m1.1.1.2.2.3.cmml" xref="algorithm1.30.30.m1.1.1.2.2.3">𝑖</ci></apply><ci id="algorithm1.30.30.m1.1.1.2.3.cmml" xref="algorithm1.30.30.m1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.30.30.m1.1.1.3.cmml" xref="algorithm1.30.30.m1.1.1.3"><minus id="algorithm1.30.30.m1.1.1.3.1.cmml" xref="algorithm1.30.30.m1.1.1.3.1"></minus><apply id="algorithm1.30.30.m1.1.1.3.2.cmml" xref="algorithm1.30.30.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.30.30.m1.1.1.3.2.1.cmml" xref="algorithm1.30.30.m1.1.1.3.2">superscript</csymbol><apply id="algorithm1.30.30.m1.1.1.3.2.2.cmml" xref="algorithm1.30.30.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.30.30.m1.1.1.3.2.2.1.cmml" xref="algorithm1.30.30.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.30.30.m1.1.1.3.2.2.2.cmml" xref="algorithm1.30.30.m1.1.1.3.2.2.2">𝑤</ci><ci id="algorithm1.30.30.m1.1.1.3.2.2.3.cmml" xref="algorithm1.30.30.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="algorithm1.30.30.m1.1.1.3.2.3.cmml" xref="algorithm1.30.30.m1.1.1.3.2.3">𝑡</ci></apply><apply id="algorithm1.30.30.m1.1.1.3.3.cmml" xref="algorithm1.30.30.m1.1.1.3.3"><times id="algorithm1.30.30.m1.1.1.3.3.1.cmml" xref="algorithm1.30.30.m1.1.1.3.3.1"></times><ci id="algorithm1.30.30.m1.1.1.3.3.2.cmml" xref="algorithm1.30.30.m1.1.1.3.3.2">𝜂</ci><apply id="algorithm1.30.30.m1.1.1.3.3.3.cmml" xref="algorithm1.30.30.m1.1.1.3.3.3"><ci id="algorithm1.30.30.m1.1.1.3.3.3.1.cmml" xref="algorithm1.30.30.m1.1.1.3.3.3.1">∇</ci><ci id="algorithm1.30.30.m1.1.1.3.3.3.2.cmml" xref="algorithm1.30.30.m1.1.1.3.3.3.2">ℓ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.m1.1c">w_{i}^{t}\leftarrow w_{i}^{t}-\eta\nabla\ell</annotation></semantics></math>

</div>
<div id="algorithm1.31.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.31.37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span>
</div>
<div id="algorithm1.31.31" class="ltx_listingline">return <math id="algorithm1.31.31.m1.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="algorithm1.31.31.m1.1a"><msubsup id="algorithm1.31.31.m1.1.1" xref="algorithm1.31.31.m1.1.1.cmml"><mi id="algorithm1.31.31.m1.1.1.2.2" xref="algorithm1.31.31.m1.1.1.2.2.cmml">w</mi><mi id="algorithm1.31.31.m1.1.1.2.3" xref="algorithm1.31.31.m1.1.1.2.3.cmml">i</mi><mi id="algorithm1.31.31.m1.1.1.3" xref="algorithm1.31.31.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.m1.1b"><apply id="algorithm1.31.31.m1.1.1.cmml" xref="algorithm1.31.31.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.31.31.m1.1.1.1.cmml" xref="algorithm1.31.31.m1.1.1">superscript</csymbol><apply id="algorithm1.31.31.m1.1.1.2.cmml" xref="algorithm1.31.31.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.31.31.m1.1.1.2.1.cmml" xref="algorithm1.31.31.m1.1.1">subscript</csymbol><ci id="algorithm1.31.31.m1.1.1.2.2.cmml" xref="algorithm1.31.31.m1.1.1.2.2">𝑤</ci><ci id="algorithm1.31.31.m1.1.1.2.3.cmml" xref="algorithm1.31.31.m1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.31.31.m1.1.1.3.cmml" xref="algorithm1.31.31.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.m1.1c">w_{i}^{t}</annotation></semantics></math> to server


</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.33.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>The MOON framework</figcaption>
</figure>
<div id="S3.SS3.SSS2.p8" class="ltx_para">
<p id="S3.SS3.SSS2.p8.2" class="ltx_p">For simplicity, we describe MOON without applying sampling technique in Algorithm <a href="#algorithm1" title="In 3.3.2 Local Objective ‣ 3.3 Method ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. MOON is still applicable when only a sample set of parties participate in federated learning each round. Like FedAvg, each party maintains its local model, which will be replaced
by the global model and updated only if the party is selected
to participate in a round. MOON only needs the latest local
model that the party has, even though it may not be updated
in round <math id="S3.SS3.SSS2.p8.1.m1.1" class="ltx_Math" alttext="(t-1)" display="inline"><semantics id="S3.SS3.SSS2.p8.1.m1.1a"><mrow id="S3.SS3.SSS2.p8.1.m1.1.1.1" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p8.1.m1.1.1.1.2" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p8.1.m1.1.1.1.1" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p8.1.m1.1.1.1.1.2" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS3.SSS2.p8.1.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS2.p8.1.m1.1.1.1.1.3" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSS2.p8.1.m1.1.1.1.3" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p8.1.m1.1b"><apply id="S3.SS3.SSS2.p8.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p8.1.m1.1.1.1"><minus id="S3.SS3.SSS2.p8.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.1"></minus><ci id="S3.SS3.SSS2.p8.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.SSS2.p8.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p8.1.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p8.1.m1.1c">(t-1)</annotation></semantics></math> (e.g., <math id="S3.SS3.SSS2.p8.2.m2.1" class="ltx_Math" alttext="w_{i}^{t-1}=w_{i}^{t-2}" display="inline"><semantics id="S3.SS3.SSS2.p8.2.m2.1a"><mrow id="S3.SS3.SSS2.p8.2.m2.1.1" xref="S3.SS3.SSS2.p8.2.m2.1.1.cmml"><msubsup id="S3.SS3.SSS2.p8.2.m2.1.1.2" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS2.p8.2.m2.1.1.2.2.2" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.2.2.cmml">w</mi><mi id="S3.SS3.SSS2.p8.2.m2.1.1.2.2.3" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.2.3.cmml">i</mi><mrow id="S3.SS3.SSS2.p8.2.m2.1.1.2.3" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p8.2.m2.1.1.2.3.2" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p8.2.m2.1.1.2.3.1" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p8.2.m2.1.1.2.3.3" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.SS3.SSS2.p8.2.m2.1.1.1" xref="S3.SS3.SSS2.p8.2.m2.1.1.1.cmml">=</mo><msubsup id="S3.SS3.SSS2.p8.2.m2.1.1.3" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p8.2.m2.1.1.3.2.2" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.2.2.cmml">w</mi><mi id="S3.SS3.SSS2.p8.2.m2.1.1.3.2.3" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.2.3.cmml">i</mi><mrow id="S3.SS3.SSS2.p8.2.m2.1.1.3.3" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p8.2.m2.1.1.3.3.2" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p8.2.m2.1.1.3.3.1" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p8.2.m2.1.1.3.3.3" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3.3.cmml">2</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p8.2.m2.1b"><apply id="S3.SS3.SSS2.p8.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1"><eq id="S3.SS3.SSS2.p8.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.1"></eq><apply id="S3.SS3.SSS2.p8.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p8.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS2.p8.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p8.2.m2.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p8.2.m2.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.SSS2.p8.2.m2.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p8.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3"><minus id="S3.SS3.SSS2.p8.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3.1"></minus><ci id="S3.SS3.SSS2.p8.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSS2.p8.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.SSS2.p8.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p8.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3">superscript</csymbol><apply id="S3.SS3.SSS2.p8.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p8.2.m2.1.1.3.2.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p8.2.m2.1.1.3.2.2.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.2.2">𝑤</ci><ci id="S3.SS3.SSS2.p8.2.m2.1.1.3.2.3.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p8.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3"><minus id="S3.SS3.SSS2.p8.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3.1"></minus><ci id="S3.SS3.SSS2.p8.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSS2.p8.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p8.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p8.2.m2.1c">w_{i}^{t-1}=w_{i}^{t-2}</annotation></semantics></math>).</p>
</div>
<div id="S3.SS3.SSS2.p9" class="ltx_para">
<p id="S3.SS3.SSS2.p9.2" class="ltx_p">An notable thing is that considering an ideal case where the local model is good enough and learns (almost) the same representation as the global model (i.e., <math id="S3.SS3.SSS2.p9.1.m1.1" class="ltx_Math" alttext="z_{glob}=z_{prev}" display="inline"><semantics id="S3.SS3.SSS2.p9.1.m1.1a"><mrow id="S3.SS3.SSS2.p9.1.m1.1.1" xref="S3.SS3.SSS2.p9.1.m1.1.1.cmml"><msub id="S3.SS3.SSS2.p9.1.m1.1.1.2" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p9.1.m1.1.1.2.2" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p9.1.m1.1.1.2.3" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.2" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.3" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1a" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.4" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1b" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.5" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.5.cmml">b</mi></mrow></msub><mo id="S3.SS3.SSS2.p9.1.m1.1.1.1" xref="S3.SS3.SSS2.p9.1.m1.1.1.1.cmml">=</mo><msub id="S3.SS3.SSS2.p9.1.m1.1.1.3" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p9.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p9.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.2" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.3" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1a" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.4" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1b" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.5" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.5.cmml">v</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.1.m1.1b"><apply id="S3.SS3.SSS2.p9.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1"><eq id="S3.SS3.SSS2.p9.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.1"></eq><apply id="S3.SS3.SSS2.p9.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p9.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.2">𝑧</ci><apply id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3"><times id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.2">𝑔</ci><ci id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.3">𝑙</ci><ci id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.4.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.4">𝑜</ci><ci id="S3.SS3.SSS2.p9.1.m1.1.1.2.3.5.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.2.3.5">𝑏</ci></apply></apply><apply id="S3.SS3.SSS2.p9.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p9.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p9.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.2">𝑧</ci><apply id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3"><times id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.2">𝑝</ci><ci id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.3">𝑟</ci><ci id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.4.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.4">𝑒</ci><ci id="S3.SS3.SSS2.p9.1.m1.1.1.3.3.5.cmml" xref="S3.SS3.SSS2.p9.1.m1.1.1.3.3.5">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.1.m1.1c">z_{glob}=z_{prev}</annotation></semantics></math>), the model-contrastive loss will be a constant (i.e., <math id="S3.SS3.SSS2.p9.2.m2.1" class="ltx_Math" alttext="-\log\frac{1}{2}" display="inline"><semantics id="S3.SS3.SSS2.p9.2.m2.1a"><mrow id="S3.SS3.SSS2.p9.2.m2.1.1" xref="S3.SS3.SSS2.p9.2.m2.1.1.cmml"><mo rspace="0.167em" id="S3.SS3.SSS2.p9.2.m2.1.1a" xref="S3.SS3.SSS2.p9.2.m2.1.1.cmml">−</mo><mrow id="S3.SS3.SSS2.p9.2.m2.1.1.2" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS2.p9.2.m2.1.1.2.1" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS3.SSS2.p9.2.m2.1.1.2a" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.cmml">⁡</mo><mfrac id="S3.SS3.SSS2.p9.2.m2.1.1.2.2" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.2.cmml"><mn id="S3.SS3.SSS2.p9.2.m2.1.1.2.2.2" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.2.2.cmml">1</mn><mn id="S3.SS3.SSS2.p9.2.m2.1.1.2.2.3" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.2.3.cmml">2</mn></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p9.2.m2.1b"><apply id="S3.SS3.SSS2.p9.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1"><minus id="S3.SS3.SSS2.p9.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1"></minus><apply id="S3.SS3.SSS2.p9.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1.2"><log id="S3.SS3.SSS2.p9.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.1"></log><apply id="S3.SS3.SSS2.p9.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.2"><divide id="S3.SS3.SSS2.p9.2.m2.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.2"></divide><cn type="integer" id="S3.SS3.SSS2.p9.2.m2.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.2.2">1</cn><cn type="integer" id="S3.SS3.SSS2.p9.2.m2.1.1.2.2.3.cmml" xref="S3.SS3.SSS2.p9.2.m2.1.1.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p9.2.m2.1c">-\log\frac{1}{2}</annotation></semantics></math>). Thus, MOON will produce the same result as FedAvg, since there is no heterogeneity issue. In this sense, our approach is robust regardless of different amount of drifts.</p>
</div>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Comparisons with Contrastive Learning</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">A comparison between MOON and SimCLR is shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.4 Comparisons with Contrastive Learning ‣ 3 Model-Contrastive Federated Learning ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The model-contrastive loss compares representations learned by different models, while the contrastive loss compares representations of different images. We also highlight the key difference between MOON and traditional contrastive learning: MOON is currently for supervised learning in a federated setting while contrastive learning is for unsupervised learning in a centralized setting. Drawing the inspirations from contrastive learning, MOON is a new learning methodology in handling non-IID data distributions among parties in federated learning.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2103.16257/assets/x7.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="238" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The comparison between SimCLR and MOON. Here <math id="S3.F4.4.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.F4.4.m1.1b"><mi id="S3.F4.4.m1.1.1" xref="S3.F4.4.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.F4.4.m1.1c"><ci id="S3.F4.4.m1.1.1.cmml" xref="S3.F4.4.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.m1.1d">x</annotation></semantics></math> denotes an image, <math id="S3.F4.5.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.F4.5.m2.1b"><mi id="S3.F4.5.m2.1.1" xref="S3.F4.5.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.F4.5.m2.1c"><ci id="S3.F4.5.m2.1.1.cmml" xref="S3.F4.5.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.5.m2.1d">w</annotation></semantics></math> denotes a model, and <math id="S3.F4.6.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.F4.6.m3.1b"><mi id="S3.F4.6.m3.1.1" xref="S3.F4.6.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.F4.6.m3.1c"><ci id="S3.F4.6.m3.1.1.cmml" xref="S3.F4.6.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.6.m3.1d">R</annotation></semantics></math> denotes the function to compute representation. SimCLR maximizes the agreement between representations of different views of the same image, while MOON maximizes the agreement between representations of the local model and the global model on the mini-batches.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We compare MOON with three state-of-the-art approaches including (1) FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, (2) FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, and (3) SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. We also compare a baseline approach named SOLO, where each party trains a model with its local data without federated learning. We conduct experiments on three datasets including CIFAR-10, CIFAR-100, and Tiny-Imagenet<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://www.kaggle.com/c/tiny-imagenet" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.kaggle.com/c/tiny-imagenet</a></span></span></span> (100,000 images with 200 classes). Moreover, we try two different network architectures. For CIFAR-10, we use a CNN network as the base encoder, which has two 5x5 convolution layers followed by 2x2 max pooling (the first with 6 channels and the second with 16 channels) and two fully connected layers with ReLU activation (the first with 120 units and the second with 84 units). For CIFAR-100 and Tiny-Imagenet, we use ResNet-50 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> as the base encoder. For all datasets, like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, we use a 2-layer MLP as the projection head. The output dimension of the projection head is set to 256 by default. Note that all baselines use the same network architecture as MOON (including the projection head) for fair comparison.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We use PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> to implement MOON and the other baselines. The code is publicly available<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://github.com/QinbinLi/MOON" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/QinbinLi/MOON</a></span></span></span>. We use the SGD optimizer with a learning rate 0.01 for all approaches. The SGD weight decay is set to 0.00001 and the SGD momentum is set to 0.9. The batch size is set to 64. The number of local epochs is set to 300 for SOLO. The number of local epochs is set to 10 for all federated learning approaches unless explicitly specified. The number of communication rounds is set to 100 for CIFAR-10/100 and 20 for Tiny-ImageNet, where all federated learning approaches have little or no accuracy gain with more communications. For MOON, we set the temperature parameter to 0.5 by default like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.6" class="ltx_p">Like previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, we use Dirichlet distribution to generate the non-IID data partition among parties. Specifically, we sample <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="p_{k}\sim Dir_{N}(\beta)" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.2" xref="S4.SS1.p3.1.m1.1.2.cmml"><msub id="S4.SS1.p3.1.m1.1.2.2" xref="S4.SS1.p3.1.m1.1.2.2.cmml"><mi id="S4.SS1.p3.1.m1.1.2.2.2" xref="S4.SS1.p3.1.m1.1.2.2.2.cmml">p</mi><mi id="S4.SS1.p3.1.m1.1.2.2.3" xref="S4.SS1.p3.1.m1.1.2.2.3.cmml">k</mi></msub><mo id="S4.SS1.p3.1.m1.1.2.1" xref="S4.SS1.p3.1.m1.1.2.1.cmml">∼</mo><mrow id="S4.SS1.p3.1.m1.1.2.3" xref="S4.SS1.p3.1.m1.1.2.3.cmml"><mi id="S4.SS1.p3.1.m1.1.2.3.2" xref="S4.SS1.p3.1.m1.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.2.3.1" xref="S4.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p3.1.m1.1.2.3.3" xref="S4.SS1.p3.1.m1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.2.3.1a" xref="S4.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><msub id="S4.SS1.p3.1.m1.1.2.3.4" xref="S4.SS1.p3.1.m1.1.2.3.4.cmml"><mi id="S4.SS1.p3.1.m1.1.2.3.4.2" xref="S4.SS1.p3.1.m1.1.2.3.4.2.cmml">r</mi><mi id="S4.SS1.p3.1.m1.1.2.3.4.3" xref="S4.SS1.p3.1.m1.1.2.3.4.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.2.3.1b" xref="S4.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p3.1.m1.1.2.3.5.2" xref="S4.SS1.p3.1.m1.1.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.3.5.2.1" xref="S4.SS1.p3.1.m1.1.2.3.cmml">(</mo><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">β</mi><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.3.5.2.2" xref="S4.SS1.p3.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.2"><csymbol cd="latexml" id="S4.SS1.p3.1.m1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.2.1">similar-to</csymbol><apply id="S4.SS1.p3.1.m1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.2.2.1.cmml" xref="S4.SS1.p3.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.2.2.2.cmml" xref="S4.SS1.p3.1.m1.1.2.2.2">𝑝</ci><ci id="S4.SS1.p3.1.m1.1.2.2.3.cmml" xref="S4.SS1.p3.1.m1.1.2.2.3">𝑘</ci></apply><apply id="S4.SS1.p3.1.m1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.2.3"><times id="S4.SS1.p3.1.m1.1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.1.2.3.1"></times><ci id="S4.SS1.p3.1.m1.1.2.3.2.cmml" xref="S4.SS1.p3.1.m1.1.2.3.2">𝐷</ci><ci id="S4.SS1.p3.1.m1.1.2.3.3.cmml" xref="S4.SS1.p3.1.m1.1.2.3.3">𝑖</ci><apply id="S4.SS1.p3.1.m1.1.2.3.4.cmml" xref="S4.SS1.p3.1.m1.1.2.3.4"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.2.3.4.1.cmml" xref="S4.SS1.p3.1.m1.1.2.3.4">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.2.3.4.2.cmml" xref="S4.SS1.p3.1.m1.1.2.3.4.2">𝑟</ci><ci id="S4.SS1.p3.1.m1.1.2.3.4.3.cmml" xref="S4.SS1.p3.1.m1.1.2.3.4.3">𝑁</ci></apply><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">p_{k}\sim Dir_{N}(\beta)</annotation></semantics></math> and allocate a <math id="S4.SS1.p3.2.m2.2" class="ltx_Math" alttext="p_{k,j}" display="inline"><semantics id="S4.SS1.p3.2.m2.2a"><msub id="S4.SS1.p3.2.m2.2.3" xref="S4.SS1.p3.2.m2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.2.3.2" xref="S4.SS1.p3.2.m2.2.3.2.cmml">p</mi><mrow id="S4.SS1.p3.2.m2.2.2.2.4" xref="S4.SS1.p3.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml">k</mi><mo id="S4.SS1.p3.2.m2.2.2.2.4.1" xref="S4.SS1.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.2.m2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><apply id="S4.SS1.p3.2.m2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2">𝑝</ci><list id="S4.SS1.p3.2.m2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"><ci id="S4.SS1.p3.2.m2.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1">𝑘</ci><ci id="S4.SS1.p3.2.m2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">p_{k,j}</annotation></semantics></math> proportion of the instances of class <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">k</annotation></semantics></math> to party <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">j</annotation></semantics></math>, where <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="Dir(\beta)" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mrow id="S4.SS1.p3.5.m5.1.2" xref="S4.SS1.p3.5.m5.1.2.cmml"><mi id="S4.SS1.p3.5.m5.1.2.2" xref="S4.SS1.p3.5.m5.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.5.m5.1.2.1" xref="S4.SS1.p3.5.m5.1.2.1.cmml">​</mo><mi id="S4.SS1.p3.5.m5.1.2.3" xref="S4.SS1.p3.5.m5.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.5.m5.1.2.1a" xref="S4.SS1.p3.5.m5.1.2.1.cmml">​</mo><mi id="S4.SS1.p3.5.m5.1.2.4" xref="S4.SS1.p3.5.m5.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.5.m5.1.2.1b" xref="S4.SS1.p3.5.m5.1.2.1.cmml">​</mo><mrow id="S4.SS1.p3.5.m5.1.2.5.2" xref="S4.SS1.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.5.m5.1.2.5.2.1" xref="S4.SS1.p3.5.m5.1.2.cmml">(</mo><mi id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">β</mi><mo stretchy="false" id="S4.SS1.p3.5.m5.1.2.5.2.2" xref="S4.SS1.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.2.cmml" xref="S4.SS1.p3.5.m5.1.2"><times id="S4.SS1.p3.5.m5.1.2.1.cmml" xref="S4.SS1.p3.5.m5.1.2.1"></times><ci id="S4.SS1.p3.5.m5.1.2.2.cmml" xref="S4.SS1.p3.5.m5.1.2.2">𝐷</ci><ci id="S4.SS1.p3.5.m5.1.2.3.cmml" xref="S4.SS1.p3.5.m5.1.2.3">𝑖</ci><ci id="S4.SS1.p3.5.m5.1.2.4.cmml" xref="S4.SS1.p3.5.m5.1.2.4">𝑟</ci><ci id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">Dir(\beta)</annotation></semantics></math> is the Dirichlet distribution with a concentration parameter <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><mi id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><ci id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">\beta</annotation></semantics></math> (0.5 by default). With the above partitioning strategy, each party can have relatively few (even no) data samples in some classes. We set the number of parties to 10 by default. The data distributions among parties in default settings are shown in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. For more experimental results, please refer to Appendix.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x8.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_img_landscape" width="147" height="112" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x9.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_img_landscape" width="147" height="115" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>CIFAR-100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F5.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x10.png" id="S4.F5.sf3.g1" class="ltx_graphics ltx_img_landscape" width="147" height="112" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-Imagenet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The data distribution of each party using non-IID data partition. The color bar denotes the number of data samples. Each rectangle represents the number of data samples of a specific class in a party. </figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Accuracy Comparison</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.12" class="ltx_p">For MOON, we tune <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mu</annotation></semantics></math> from <math id="S4.SS2.p1.2.m2.4" class="ltx_Math" alttext="\{0.1,1,5,10\}" display="inline"><semantics id="S4.SS2.p1.2.m2.4a"><mrow id="S4.SS2.p1.2.m2.4.5.2" xref="S4.SS2.p1.2.m2.4.5.1.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.4.5.2.1" xref="S4.SS2.p1.2.m2.4.5.1.cmml">{</mo><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">0.1</mn><mo id="S4.SS2.p1.2.m2.4.5.2.2" xref="S4.SS2.p1.2.m2.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml">1</mn><mo id="S4.SS2.p1.2.m2.4.5.2.3" xref="S4.SS2.p1.2.m2.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.2.m2.3.3" xref="S4.SS2.p1.2.m2.3.3.cmml">5</mn><mo id="S4.SS2.p1.2.m2.4.5.2.4" xref="S4.SS2.p1.2.m2.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.2.m2.4.4" xref="S4.SS2.p1.2.m2.4.4.cmml">10</mn><mo stretchy="false" id="S4.SS2.p1.2.m2.4.5.2.5" xref="S4.SS2.p1.2.m2.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.4b"><set id="S4.SS2.p1.2.m2.4.5.1.cmml" xref="S4.SS2.p1.2.m2.4.5.2"><cn type="float" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">0.1</cn><cn type="integer" id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2">1</cn><cn type="integer" id="S4.SS2.p1.2.m2.3.3.cmml" xref="S4.SS2.p1.2.m2.3.3">5</cn><cn type="integer" id="S4.SS2.p1.2.m2.4.4.cmml" xref="S4.SS2.p1.2.m2.4.4">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.4c">\{0.1,1,5,10\}</annotation></semantics></math> and report the best result. The best <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mu</annotation></semantics></math> of MOON for CIFAR-10, CIFAR-100, and Tiny-Imagenet are 5, 1, and 1, respectively. Note that FedProx also has a hyper-parameter <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mu</annotation></semantics></math> to control the weight of its proximal term (i.e., <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="L_{FedProx}=\ell_{FedAvg}+\mu\ell_{prox}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><msub id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2.2" xref="S4.SS2.p1.5.m5.1.1.2.2.cmml">L</mi><mrow id="S4.SS2.p1.5.m5.1.1.2.3" xref="S4.SS2.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2.3.2" xref="S4.SS2.p1.5.m5.1.1.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.2.3.1" xref="S4.SS2.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.2.3.3" xref="S4.SS2.p1.5.m5.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.2.3.1a" xref="S4.SS2.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.2.3.4" xref="S4.SS2.p1.5.m5.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.2.3.1b" xref="S4.SS2.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.2.3.5" xref="S4.SS2.p1.5.m5.1.1.2.3.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.2.3.1c" xref="S4.SS2.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.2.3.6" xref="S4.SS2.p1.5.m5.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.2.3.1d" xref="S4.SS2.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.2.3.7" xref="S4.SS2.p1.5.m5.1.1.2.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.2.3.1e" xref="S4.SS2.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.2.3.8" xref="S4.SS2.p1.5.m5.1.1.2.3.8.cmml">x</mi></mrow></msub><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><msub id="S4.SS2.p1.5.m5.1.1.3.2" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml"><mi mathvariant="normal" id="S4.SS2.p1.5.m5.1.1.3.2.2" xref="S4.SS2.p1.5.m5.1.1.3.2.2.cmml">ℓ</mi><mrow id="S4.SS2.p1.5.m5.1.1.3.2.3" xref="S4.SS2.p1.5.m5.1.1.3.2.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.2.3.2" xref="S4.SS2.p1.5.m5.1.1.3.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.2.3.1" xref="S4.SS2.p1.5.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.2.3.3" xref="S4.SS2.p1.5.m5.1.1.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.2.3.1a" xref="S4.SS2.p1.5.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.2.3.4" xref="S4.SS2.p1.5.m5.1.1.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.2.3.1b" xref="S4.SS2.p1.5.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.2.3.5" xref="S4.SS2.p1.5.m5.1.1.3.2.3.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.2.3.1c" xref="S4.SS2.p1.5.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.2.3.6" xref="S4.SS2.p1.5.m5.1.1.3.2.3.6.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.2.3.1d" xref="S4.SS2.p1.5.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.2.3.7" xref="S4.SS2.p1.5.m5.1.1.3.2.3.7.cmml">g</mi></mrow></msub><mo id="S4.SS2.p1.5.m5.1.1.3.1" xref="S4.SS2.p1.5.m5.1.1.3.1.cmml">+</mo><mrow id="S4.SS2.p1.5.m5.1.1.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.3.2" xref="S4.SS2.p1.5.m5.1.1.3.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.3.1" xref="S4.SS2.p1.5.m5.1.1.3.3.1.cmml">​</mo><msub id="S4.SS2.p1.5.m5.1.1.3.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.3.cmml"><mi mathvariant="normal" id="S4.SS2.p1.5.m5.1.1.3.3.3.2" xref="S4.SS2.p1.5.m5.1.1.3.3.3.2.cmml">ℓ</mi><mrow id="S4.SS2.p1.5.m5.1.1.3.3.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.3.3.3.2" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.3.3.3.1" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3.3.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.3.3.3.1a" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3.3.3.4" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.3.3.3.3.1b" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3.3.3.5" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.5.cmml">x</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><eq id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></eq><apply id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.2.1.cmml" xref="S4.SS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2.2">𝐿</ci><apply id="S4.SS2.p1.5.m5.1.1.2.3.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3"><times id="S4.SS2.p1.5.m5.1.1.2.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.2.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.2">𝐹</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.3">𝑒</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.4.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.4">𝑑</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.5.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.5">𝑃</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.6.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.6">𝑟</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.7.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.7">𝑜</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.8.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3.8">𝑥</ci></apply></apply><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><plus id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.1"></plus><apply id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.2.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.2.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.2">ℓ</ci><apply id="S4.SS2.p1.5.m5.1.1.3.2.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3"><times id="S4.SS2.p1.5.m5.1.1.3.2.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.3.2.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3.2">𝐹</ci><ci id="S4.SS2.p1.5.m5.1.1.3.2.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3.3">𝑒</ci><ci id="S4.SS2.p1.5.m5.1.1.3.2.3.4.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3.4">𝑑</ci><ci id="S4.SS2.p1.5.m5.1.1.3.2.3.5.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3.5">𝐴</ci><ci id="S4.SS2.p1.5.m5.1.1.3.2.3.6.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3.6">𝑣</ci><ci id="S4.SS2.p1.5.m5.1.1.3.2.3.7.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2.3.7">𝑔</ci></apply></apply><apply id="S4.SS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3"><times id="S4.SS2.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2">𝜇</ci><apply id="S4.SS2.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.2">ℓ</ci><apply id="S4.SS2.p1.5.m5.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3"><times id="S4.SS2.p1.5.m5.1.1.3.3.3.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.2">𝑝</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.3">𝑟</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.3.4.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.4">𝑜</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.3.5.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3.3.5">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">L_{FedProx}=\ell_{FedAvg}+\mu\ell_{prox}</annotation></semantics></math>). For FedProx, we tune <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\mu</annotation></semantics></math> from <math id="S4.SS2.p1.7.m7.4" class="ltx_Math" alttext="\{0.001,0.01,0.1,1\}" display="inline"><semantics id="S4.SS2.p1.7.m7.4a"><mrow id="S4.SS2.p1.7.m7.4.5.2" xref="S4.SS2.p1.7.m7.4.5.1.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.4.5.2.1" xref="S4.SS2.p1.7.m7.4.5.1.cmml">{</mo><mn id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">0.001</mn><mo id="S4.SS2.p1.7.m7.4.5.2.2" xref="S4.SS2.p1.7.m7.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.7.m7.2.2" xref="S4.SS2.p1.7.m7.2.2.cmml">0.01</mn><mo id="S4.SS2.p1.7.m7.4.5.2.3" xref="S4.SS2.p1.7.m7.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.7.m7.3.3" xref="S4.SS2.p1.7.m7.3.3.cmml">0.1</mn><mo id="S4.SS2.p1.7.m7.4.5.2.4" xref="S4.SS2.p1.7.m7.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.7.m7.4.4" xref="S4.SS2.p1.7.m7.4.4.cmml">1</mn><mo stretchy="false" id="S4.SS2.p1.7.m7.4.5.2.5" xref="S4.SS2.p1.7.m7.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.4b"><set id="S4.SS2.p1.7.m7.4.5.1.cmml" xref="S4.SS2.p1.7.m7.4.5.2"><cn type="float" id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">0.001</cn><cn type="float" id="S4.SS2.p1.7.m7.2.2.cmml" xref="S4.SS2.p1.7.m7.2.2">0.01</cn><cn type="float" id="S4.SS2.p1.7.m7.3.3.cmml" xref="S4.SS2.p1.7.m7.3.3">0.1</cn><cn type="integer" id="S4.SS2.p1.7.m7.4.4.cmml" xref="S4.SS2.p1.7.m7.4.4">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.4c">\{0.001,0.01,0.1,1\}</annotation></semantics></math> (the range is also used in the previous paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>) and report the best result. The best <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">\mu</annotation></semantics></math> of FedProx for CIFAR-10, CIFAR-100, and Tiny-Imagenet are <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mn id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><cn type="float" id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">0.01</annotation></semantics></math>, <math id="S4.SS2.p1.10.m10.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S4.SS2.p1.10.m10.1a"><mn id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><cn type="float" id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">0.001</annotation></semantics></math>, and <math id="S4.SS2.p1.11.m11.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S4.SS2.p1.11.m11.1a"><mn id="S4.SS2.p1.11.m11.1.1" xref="S4.SS2.p1.11.m11.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b"><cn type="float" id="S4.SS2.p1.11.m11.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">0.001</annotation></semantics></math>, respectively. Unless explicitly specified, we use these <math id="S4.SS2.p1.12.m12.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.12.m12.1a"><mi id="S4.SS2.p1.12.m12.1.1" xref="S4.SS2.p1.12.m12.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m12.1b"><ci id="S4.SS2.p1.12.m12.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m12.1c">\mu</annotation></semantics></math> settings for all the remaining experiments.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Accuracy Comparison ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the top-1 test accuracy of all approaches with the above default setting. Under non-IID settings, SOLO demonstrates much worse accuracy than other federated learning approaches. This demonstrates the benefits of federated learning. Comparing different federated learning approaches, we can observe that MOON is consistently the best approach among all tasks. It can outperform FedAvg by 2.6% accuracy on average of all tasks. For FedProx, its accuracy is very close to FedAvg. The proximal term in FedProx has little influence in the training since <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mu</annotation></semantics></math> is small. However, when <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\mu</annotation></semantics></math> is not set to a very small value, the convergence of FedProx is quite slow (see Section <a href="#S4.SS3" title="4.3 Communication Efficiency ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>) and the accuracy of FedProx is bad. For SCAFFOLD, it has much worse accuracy on CIFAR-100 and Tiny-Imagenet than other federated learning approaches.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>The top-1 accuracy of MOON and the other baselines on test datasets. For MOON, FedAvg, FedProx, and SCAFFOLD, we run three trials and report the mean and standard derivation. For SOLO, we report the mean and standard derivation among all parties.</figcaption>
<div id="S4.T1.15" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:163.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(73.4pt,-27.6pt) scale(1.51145318150786,1.51145318150786) ;">
<table id="S4.T1.15.15" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.15.15.16.1" class="ltx_tr">
<th id="S4.T1.15.15.16.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Method</th>
<th id="S4.T1.15.15.16.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-10</th>
<th id="S4.T1.15.15.16.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-100</th>
<th id="S4.T1.15.15.16.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Tiny-Imagenet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.3.3.3" class="ltx_tr">
<td id="S4.T1.3.3.3.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">MOON</td>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">69.1%<math id="S4.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">\pm</annotation></semantics></math></span>0.4%</td>
<td id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<span id="S4.T1.2.2.2.2.1" class="ltx_text ltx_font_bold">67.5%<math id="S4.T1.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.2.2.2.2.1.m1.1a"><mo id="S4.T1.2.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T1.2.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.1.m1.1c">\pm</annotation></semantics></math></span>0.4%</td>
<td id="S4.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<span id="S4.T1.3.3.3.3.1" class="ltx_text ltx_font_bold">25.1%<math id="S4.T1.3.3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.3.3.3.3.1.m1.1a"><mo id="S4.T1.3.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T1.3.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.1.m1.1c">\pm</annotation></semantics></math></span>0.1%</td>
</tr>
<tr id="S4.T1.6.6.6" class="ltx_tr">
<td id="S4.T1.6.6.6.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedAvg</td>
<td id="S4.T1.4.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.3%<math id="S4.T1.4.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.4.4.4.1.m1.1a"><mo id="S4.T1.4.4.4.1.m1.1.1" xref="S4.T1.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T1.4.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.m1.1c">\pm</annotation></semantics></math>0.5%</td>
<td id="S4.T1.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.5% <math id="S4.T1.5.5.5.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.5.5.5.2.m1.1a"><mo id="S4.T1.5.5.5.2.m1.1.1" xref="S4.T1.5.5.5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.2.m1.1b"><csymbol cd="latexml" id="S4.T1.5.5.5.2.m1.1.1.cmml" xref="S4.T1.5.5.5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.2.m1.1c">\pm</annotation></semantics></math>0.4%</td>
<td id="S4.T1.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23.0%<math id="S4.T1.6.6.6.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.6.6.6.3.m1.1a"><mo id="S4.T1.6.6.6.3.m1.1.1" xref="S4.T1.6.6.6.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.3.m1.1b"><csymbol cd="latexml" id="S4.T1.6.6.6.3.m1.1.1.cmml" xref="S4.T1.6.6.6.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.3.m1.1c">\pm</annotation></semantics></math>0.1%</td>
</tr>
<tr id="S4.T1.9.9.9" class="ltx_tr">
<td id="S4.T1.9.9.9.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedProx</td>
<td id="S4.T1.7.7.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.9%<math id="S4.T1.7.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.7.7.7.1.m1.1a"><mo id="S4.T1.7.7.7.1.m1.1.1" xref="S4.T1.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S4.T1.7.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.m1.1c">\pm</annotation></semantics></math>0.2%</td>
<td id="S4.T1.8.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.6%<math id="S4.T1.8.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.8.8.8.2.m1.1a"><mo id="S4.T1.8.8.8.2.m1.1.1" xref="S4.T1.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S4.T1.8.8.8.2.m1.1.1.cmml" xref="S4.T1.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.2.m1.1c">\pm</annotation></semantics></math>0.2%</td>
<td id="S4.T1.9.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23.2%<math id="S4.T1.9.9.9.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.9.9.9.3.m1.1a"><mo id="S4.T1.9.9.9.3.m1.1.1" xref="S4.T1.9.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.3.m1.1b"><csymbol cd="latexml" id="S4.T1.9.9.9.3.m1.1.1.cmml" xref="S4.T1.9.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.3.m1.1c">\pm</annotation></semantics></math>0.2%</td>
</tr>
<tr id="S4.T1.12.12.12" class="ltx_tr">
<td id="S4.T1.12.12.12.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">SCAFFOLD</td>
<td id="S4.T1.10.10.10.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.6%<math id="S4.T1.10.10.10.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.10.10.10.1.m1.1a"><mo id="S4.T1.10.10.10.1.m1.1.1" xref="S4.T1.10.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.10.1.m1.1b"><csymbol cd="latexml" id="S4.T1.10.10.10.1.m1.1.1.cmml" xref="S4.T1.10.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.10.1.m1.1c">\pm</annotation></semantics></math>0.2%</td>
<td id="S4.T1.11.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">52.5% <math id="S4.T1.11.11.11.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.11.11.11.2.m1.1a"><mo id="S4.T1.11.11.11.2.m1.1.1" xref="S4.T1.11.11.11.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.11.2.m1.1b"><csymbol cd="latexml" id="S4.T1.11.11.11.2.m1.1.1.cmml" xref="S4.T1.11.11.11.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.11.2.m1.1c">\pm</annotation></semantics></math>0.3%</td>
<td id="S4.T1.12.12.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16.0%<math id="S4.T1.12.12.12.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.12.12.12.3.m1.1a"><mo id="S4.T1.12.12.12.3.m1.1.1" xref="S4.T1.12.12.12.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.12.3.m1.1b"><csymbol cd="latexml" id="S4.T1.12.12.12.3.m1.1.1.cmml" xref="S4.T1.12.12.12.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.12.3.m1.1c">\pm</annotation></semantics></math>0.2%</td>
</tr>
<tr id="S4.T1.15.15.15" class="ltx_tr">
<td id="S4.T1.15.15.15.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">SOLO</td>
<td id="S4.T1.13.13.13.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">46.3% <math id="S4.T1.13.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.13.13.13.1.m1.1a"><mo id="S4.T1.13.13.13.1.m1.1.1" xref="S4.T1.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.13.1.m1.1b"><csymbol cd="latexml" id="S4.T1.13.13.13.1.m1.1.1.cmml" xref="S4.T1.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.13.1.m1.1c">\pm</annotation></semantics></math>5.1%</td>
<td id="S4.T1.14.14.14.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">22.3%<math id="S4.T1.14.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.14.14.14.2.m1.1a"><mo id="S4.T1.14.14.14.2.m1.1.1" xref="S4.T1.14.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.14.2.m1.1b"><csymbol cd="latexml" id="S4.T1.14.14.14.2.m1.1.1.cmml" xref="S4.T1.14.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.14.2.m1.1c">\pm</annotation></semantics></math>1.0%</td>
<td id="S4.T1.15.15.15.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">8.6%<math id="S4.T1.15.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.15.15.15.3.m1.1a"><mo id="S4.T1.15.15.15.3.m1.1.1" xref="S4.T1.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.15.3.m1.1b"><csymbol cd="latexml" id="S4.T1.15.15.15.3.m1.1.1.cmml" xref="S4.T1.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.15.3.m1.1c">\pm</annotation></semantics></math>0.4%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Communication Efficiency</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.5" class="ltx_p">Figure <a href="#S4.F6" title="Figure 6 ‣ 4.3 Communication Efficiency ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the accuracy in each round during training. As we can see, the model-contrastive loss term has little influence on the convergence rate with best <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mu</annotation></semantics></math>. The speed of accuracy improvement in MOON is almost the same as FedAvg at the beginning, while it can achieve a better accuracy later benefit from the model-contrastive loss. Since the best <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mu</annotation></semantics></math> values are generally small in FedProx, FedProx with best <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\mu</annotation></semantics></math> is very close to FedAvg, especially on CIFAR-10 and CIFAR-100. However, when setting <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">μ</mi><mo id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><eq id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1"></eq><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝜇</ci><cn type="integer" id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\mu=1</annotation></semantics></math>, FedProx becomes very slow due to the additional proximal term. This implies that limiting the <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><msub id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">ℓ</mi><mn id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">ℓ</ci><cn type="integer" id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\ell_{2}</annotation></semantics></math>-norm distance between the local model and the global model is not an effective solution. Our model-contrastive loss can effectively increase the accuracy without slowing down the convergence.</p>
</div>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x11.png" id="S4.F6.sf1.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x12.png" id="S4.F6.sf2.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>CIFAR-100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x13.png" id="S4.F6.sf3.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-Imagenet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The top-1 test accuracy in different number of communication rounds. For FedProx, we report both the accuracy with best <math id="S4.F6.3.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.F6.3.m1.1b"><mi id="S4.F6.3.m1.1.1" xref="S4.F6.3.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F6.3.m1.1c"><ci id="S4.F6.3.m1.1.1.cmml" xref="S4.F6.3.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.3.m1.1d">\mu</annotation></semantics></math> and the accuracy with <math id="S4.F6.4.m2.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.F6.4.m2.1b"><mrow id="S4.F6.4.m2.1.1" xref="S4.F6.4.m2.1.1.cmml"><mi id="S4.F6.4.m2.1.1.2" xref="S4.F6.4.m2.1.1.2.cmml">μ</mi><mo id="S4.F6.4.m2.1.1.1" xref="S4.F6.4.m2.1.1.1.cmml">=</mo><mn id="S4.F6.4.m2.1.1.3" xref="S4.F6.4.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.4.m2.1c"><apply id="S4.F6.4.m2.1.1.cmml" xref="S4.F6.4.m2.1.1"><eq id="S4.F6.4.m2.1.1.1.cmml" xref="S4.F6.4.m2.1.1.1"></eq><ci id="S4.F6.4.m2.1.1.2.cmml" xref="S4.F6.4.m2.1.1.2">𝜇</ci><cn type="integer" id="S4.F6.4.m2.1.1.3.cmml" xref="S4.F6.4.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.4.m2.1d">\mu=1</annotation></semantics></math>.</figcaption>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">We show the number of communication rounds to achieve the same accuracy as running FedAvg for 100 rounds on CIFAR-10/100 or 20 rounds on Tiny-Imagenet in Table <a href="#S4.T2" title="Table 2 ‣ 4.3 Communication Efficiency ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We can observe that the number of communication rounds is significantly reduced in MOON. MOON needs about half the number of communication rounds on CIFAR-100 and Tiny-Imagenet compared with FedAvg. On CIFAR-10, the speedup of MOON is even close to 4. MOON is much more communication-efficient than the other approaches.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The number of rounds of different approaches to achieve the same accuracy as running FedAvg for 100 rounds (CIFAR-10/100) or 20 rounds (Tiny-Imagenet). The speedup of an approach is computed against FedAvg.</figcaption>
<div id="S4.T2.14" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:137.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(36.0pt,-11.4pt) scale(1.19903932451455,1.19903932451455) ;">
<table id="S4.T2.14.14" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.14.14.15.1" class="ltx_tr">
<th id="S4.T2.14.14.15.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T2.14.14.15.1.1.1" class="ltx_text">Method</span></th>
<td id="S4.T2.14.14.15.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">CIFAR-10</td>
<td id="S4.T2.14.14.15.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">CIFAR-100</td>
<td id="S4.T2.14.14.15.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">Tiny-Imagenet</td>
</tr>
<tr id="S4.T2.14.14.16.2" class="ltx_tr">
<td id="S4.T2.14.14.16.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">#rounds</td>
<td id="S4.T2.14.14.16.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">speedup</td>
<td id="S4.T2.14.14.16.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">#rounds</td>
<td id="S4.T2.14.14.16.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">speedup</td>
<td id="S4.T2.14.14.16.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">#rounds</td>
<td id="S4.T2.14.14.16.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">speedup</td>
</tr>
<tr id="S4.T2.3.3.3" class="ltx_tr">
<th id="S4.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt">FedAvg</th>
<td id="S4.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">100</td>
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">1<math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><times id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\times</annotation></semantics></math>
</td>
<td id="S4.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">100</td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">1<math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><times id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">\times</annotation></semantics></math>
</td>
<td id="S4.T2.3.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">20</td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">1<math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><times id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\times</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.6.6.6" class="ltx_tr">
<th id="S4.T2.6.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FedProx</th>
<td id="S4.T2.6.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">52</td>
<td id="S4.T2.4.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.9<math id="S4.T2.4.4.4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.4.4.4.1.m1.1a"><mo id="S4.T2.4.4.4.1.m1.1.1" xref="S4.T2.4.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.1.m1.1b"><times id="S4.T2.4.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.1.m1.1c">\times</annotation></semantics></math>
</td>
<td id="S4.T2.6.6.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75</td>
<td id="S4.T2.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.3<math id="S4.T2.5.5.5.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.5.5.5.2.m1.1a"><mo id="S4.T2.5.5.5.2.m1.1.1" xref="S4.T2.5.5.5.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.2.m1.1b"><times id="S4.T2.5.5.5.2.m1.1.1.cmml" xref="S4.T2.5.5.5.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.2.m1.1c">\times</annotation></semantics></math>
</td>
<td id="S4.T2.6.6.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">17</td>
<td id="S4.T2.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.2<math id="S4.T2.6.6.6.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.6.6.6.3.m1.1a"><mo id="S4.T2.6.6.6.3.m1.1.1" xref="S4.T2.6.6.6.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.3.m1.1b"><times id="S4.T2.6.6.6.3.m1.1.1.cmml" xref="S4.T2.6.6.6.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.3.m1.1c">\times</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.11.11.11" class="ltx_tr">
<th id="S4.T2.11.11.11.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">SCAFFOLD</th>
<td id="S4.T2.11.11.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80</td>
<td id="S4.T2.7.7.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.3<math id="S4.T2.7.7.7.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.7.7.7.1.m1.1a"><mo id="S4.T2.7.7.7.1.m1.1.1" xref="S4.T2.7.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.1.m1.1b"><times id="S4.T2.7.7.7.1.m1.1.1.cmml" xref="S4.T2.7.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.1.m1.1c">\times</annotation></semantics></math>
</td>
<td id="S4.T2.8.8.8.2" class="ltx_td ltx_nopad ltx_align_center ltx_border_r ltx_border_t"><svg version="1.1" height="0" width="0" overflow="visible"><g transform="translate(0,0) scale(1,-1)"><path d="M 0,0 0,0" stroke="#000000" stroke-width="0.4"></path><g class="ltx_svg_fog" transform="translate(0,0)"><g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible">
<span id="S4.T2.8.8.8.2.pic1.1.1" class="ltx_inline-block">
<span id="S4.T2.8.8.8.2.pic1.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="S4.T2.8.8.8.2.pic1.1.1.1.1" class="ltx_p"></span>
</span>
</span></foreignObject></g></g><g class="ltx_svg_fog" transform="translate(0,0)"><g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible">
<span id="S4.T2.8.8.8.2.pic1.2.1" class="ltx_inline-block">
<span id="S4.T2.8.8.8.2.pic1.2.1.1" class="ltx_inline-block ltx_align_right">
<span id="S4.T2.8.8.8.2.pic1.2.1.1.1" class="ltx_p"></span>
</span>
</span></foreignObject></g></g></g></svg></td>
<td id="S4.T2.9.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">&lt;1<math id="S4.T2.9.9.9.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.9.9.9.3.m1.1a"><mo id="S4.T2.9.9.9.3.m1.1.1" xref="S4.T2.9.9.9.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.3.m1.1b"><times id="S4.T2.9.9.9.3.m1.1.1.cmml" xref="S4.T2.9.9.9.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.3.m1.1c">\times</annotation></semantics></math>
</td>
<td id="S4.T2.10.10.10.4" class="ltx_td ltx_nopad ltx_align_center ltx_border_r ltx_border_t"><svg version="1.1" height="0" width="0" overflow="visible"><g transform="translate(0,0) scale(1,-1)"><path d="M 0,0 0,0" stroke="#000000" stroke-width="0.4"></path><g class="ltx_svg_fog" transform="translate(0,0)"><g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible">
<span id="S4.T2.10.10.10.4.pic1.1.1" class="ltx_inline-block">
<span id="S4.T2.10.10.10.4.pic1.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="S4.T2.10.10.10.4.pic1.1.1.1.1" class="ltx_p"></span>
</span>
</span></foreignObject></g></g><g class="ltx_svg_fog" transform="translate(0,0)"><g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible">
<span id="S4.T2.10.10.10.4.pic1.2.1" class="ltx_inline-block">
<span id="S4.T2.10.10.10.4.pic1.2.1.1" class="ltx_inline-block ltx_align_right">
<span id="S4.T2.10.10.10.4.pic1.2.1.1.1" class="ltx_p"></span>
</span>
</span></foreignObject></g></g></g></svg></td>
<td id="S4.T2.11.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">&lt;1<math id="S4.T2.11.11.11.5.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.11.11.11.5.m1.1a"><mo id="S4.T2.11.11.11.5.m1.1.1" xref="S4.T2.11.11.11.5.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.5.m1.1b"><times id="S4.T2.11.11.11.5.m1.1.1.cmml" xref="S4.T2.11.11.11.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.5.m1.1c">\times</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.14.14.14" class="ltx_tr">
<th id="S4.T2.14.14.14.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">MOON</th>
<td id="S4.T2.14.14.14.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.14.14.14.5.1" class="ltx_text ltx_font_bold">27</span></td>
<td id="S4.T2.12.12.12.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.12.12.12.1.1" class="ltx_text ltx_font_bold">3.7<math id="S4.T2.12.12.12.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.12.12.12.1.1.m1.1a"><mo id="S4.T2.12.12.12.1.1.m1.1.1" xref="S4.T2.12.12.12.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.1.1.m1.1b"><times id="S4.T2.12.12.12.1.1.m1.1.1.cmml" xref="S4.T2.12.12.12.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.1.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.14.14.14.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.14.14.14.6.1" class="ltx_text ltx_font_bold">43</span></td>
<td id="S4.T2.13.13.13.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.13.13.13.2.1" class="ltx_text ltx_font_bold">2.3<math id="S4.T2.13.13.13.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.13.13.13.2.1.m1.1a"><mo id="S4.T2.13.13.13.2.1.m1.1.1" xref="S4.T2.13.13.13.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.2.1.m1.1b"><times id="S4.T2.13.13.13.2.1.m1.1.1.cmml" xref="S4.T2.13.13.13.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.2.1.m1.1c">\times</annotation></semantics></math></span></td>
<td id="S4.T2.14.14.14.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.14.14.14.7.1" class="ltx_text ltx_font_bold">11</span></td>
<td id="S4.T2.14.14.14.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.14.14.14.3.1" class="ltx_text ltx_font_bold">1.8<math id="S4.T2.14.14.14.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.14.14.14.3.1.m1.1a"><mo id="S4.T2.14.14.14.3.1.m1.1.1" xref="S4.T2.14.14.14.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.3.1.m1.1b"><times id="S4.T2.14.14.14.3.1.m1.1.1.cmml" xref="S4.T2.14.14.14.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.3.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x14.png" id="S4.F7.sf1.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x15.png" id="S4.F7.sf2.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>CIFAR-100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x16.png" id="S4.F7.sf3.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-Imagenet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>The top-1 test accuracy with different number of local epochs. For MOON and FedProx, <math id="S4.F7.3.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.F7.3.m1.1b"><mi id="S4.F7.3.m1.1.1" xref="S4.F7.3.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F7.3.m1.1c"><ci id="S4.F7.3.m1.1.1.cmml" xref="S4.F7.3.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.3.m1.1d">\mu</annotation></semantics></math> is set to the best <math id="S4.F7.4.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.F7.4.m2.1b"><mi id="S4.F7.4.m2.1.1" xref="S4.F7.4.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F7.4.m2.1c"><ci id="S4.F7.4.m2.1.1.cmml" xref="S4.F7.4.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.4.m2.1d">\mu</annotation></semantics></math> from Section <a href="#S4.SS2" title="4.2 Accuracy Comparison ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> for all numbers of local epochs. The accuracy of SCAFFOLD is quite bad when number of local epochs is set to 1 (45.3% on CIFAR10, 20.4% on CIFAR-100, 2.6% on Tiny-Imagenet). The accuracy of FedProx on Tiny-Imagenet with one local epoch is 1.2%.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Number of Local Epochs</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We study the effect of number of local epochs on the accuracy of final model. The results are shown in Figure <a href="#S4.F7" title="Figure 7 ‣ 4.3 Communication Efficiency ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. When the number of local epochs is 1, the local update is very small. Thus, the training is slow and the accuracy is relatively low given the same number of communication rounds. All approaches have a close accuracy (MOON is still the best). When the number of local epochs becomes too large, the accuracy of all approaches drops, which is due to the drift of local updates, i.e., the local optima are not consistent with the global optima. Nevertheless, MOON clearly outperforms the other approaches. This further verifies that MOON can effectively mitigate the negative effects of the drift by too many local updates.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Scalability</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.5" class="ltx_p">To show the scalability of MOON, we try a larger number of parties on CIFAR-100. Specifically, we try two settings: (1) We partition the dataset into 50 parties and all parties participate in federated learning in each round. (2) We partition the dataset into 100 parties and randomly sample 20 parties to participate in federated learning in each round (client sampling technique introduced in FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>). The results are shown in Table <a href="#S4.T3" title="Table 3 ‣ 4.5 Scalability ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Figure <a href="#S4.F8" title="Figure 8 ‣ 4.5 Scalability ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. For MOON, we show the results with <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mrow id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml"><mi id="S4.SS5.p1.1.m1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.2.cmml">μ</mi><mo id="S4.SS5.p1.1.m1.1.1.1" xref="S4.SS5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.1.m1.1.1.3" xref="S4.SS5.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1"><eq id="S4.SS5.p1.1.m1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1.1"></eq><ci id="S4.SS5.p1.1.m1.1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.SS5.p1.1.m1.1.1.3.cmml" xref="S4.SS5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\mu=1</annotation></semantics></math> (best <math id="S4.SS5.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS5.p1.2.m2.1a"><mi id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><ci id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\mu</annotation></semantics></math> from Section <a href="#S4.SS2" title="4.2 Accuracy Comparison ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>) and <math id="S4.SS5.p1.3.m3.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.SS5.p1.3.m3.1a"><mrow id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml"><mi id="S4.SS5.p1.3.m3.1.1.2" xref="S4.SS5.p1.3.m3.1.1.2.cmml">μ</mi><mo id="S4.SS5.p1.3.m3.1.1.1" xref="S4.SS5.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.3.m3.1.1.3" xref="S4.SS5.p1.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><apply id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1"><eq id="S4.SS5.p1.3.m3.1.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1.1"></eq><ci id="S4.SS5.p1.3.m3.1.1.2.cmml" xref="S4.SS5.p1.3.m3.1.1.2">𝜇</ci><cn type="integer" id="S4.SS5.p1.3.m3.1.1.3.cmml" xref="S4.SS5.p1.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">\mu=10</annotation></semantics></math>. For MOON (<math id="S4.SS5.p1.4.m4.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.SS5.p1.4.m4.1a"><mrow id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml"><mi id="S4.SS5.p1.4.m4.1.1.2" xref="S4.SS5.p1.4.m4.1.1.2.cmml">μ</mi><mo id="S4.SS5.p1.4.m4.1.1.1" xref="S4.SS5.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.4.m4.1.1.3" xref="S4.SS5.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><apply id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1"><eq id="S4.SS5.p1.4.m4.1.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1.1"></eq><ci id="S4.SS5.p1.4.m4.1.1.2.cmml" xref="S4.SS5.p1.4.m4.1.1.2">𝜇</ci><cn type="integer" id="S4.SS5.p1.4.m4.1.1.3.cmml" xref="S4.SS5.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">\mu=1</annotation></semantics></math>), it outperforms the FedAvg and FedProx over 2% accuracy at 200 rounds with 50 parties and 3% accuracy at 500 rounds with 100 parties. Moreover, for MOON (<math id="S4.SS5.p1.5.m5.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.SS5.p1.5.m5.1a"><mrow id="S4.SS5.p1.5.m5.1.1" xref="S4.SS5.p1.5.m5.1.1.cmml"><mi id="S4.SS5.p1.5.m5.1.1.2" xref="S4.SS5.p1.5.m5.1.1.2.cmml">μ</mi><mo id="S4.SS5.p1.5.m5.1.1.1" xref="S4.SS5.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.5.m5.1.1.3" xref="S4.SS5.p1.5.m5.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.5.m5.1b"><apply id="S4.SS5.p1.5.m5.1.1.cmml" xref="S4.SS5.p1.5.m5.1.1"><eq id="S4.SS5.p1.5.m5.1.1.1.cmml" xref="S4.SS5.p1.5.m5.1.1.1"></eq><ci id="S4.SS5.p1.5.m5.1.1.2.cmml" xref="S4.SS5.p1.5.m5.1.1.2">𝜇</ci><cn type="integer" id="S4.SS5.p1.5.m5.1.1.3.cmml" xref="S4.SS5.p1.5.m5.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.5.m5.1c">\mu=10</annotation></semantics></math>), although the large model-contrastive loss slows down the training at the beginning as shown in Figure <a href="#S4.F8" title="Figure 8 ‣ 4.5 Scalability ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, MOON can outperform the other approaches a lot with more communication rounds. Compared with FedAvg and FedProx, MOON achieves about about 7% higher accuracy at 200 rounds with 50 parties and at 500 rounds with 100 parties. SCAFFOLD has a low accuracy with a relatively large number of parties.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>The accuracy with 50 parties and 100 parties (sample fraction=0.2) on CIFAR-100.</figcaption>
<div id="S4.T3.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:194pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.9pt,-25.0pt) scale(1.34700167829398,1.34700167829398) ;">
<table id="S4.T3.4.4" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.4.4.5.1" class="ltx_tr">
<td id="S4.T3.4.4.5.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T3.4.4.5.1.1.1" class="ltx_text">Method</span></td>
<td id="S4.T3.4.4.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">#parties=50</td>
<td id="S4.T3.4.4.5.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">#parties=100</td>
</tr>
<tr id="S4.T3.4.4.6.2" class="ltx_tr">
<td id="S4.T3.4.4.6.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100 rounds</td>
<td id="S4.T3.4.4.6.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">200 rounds</td>
<td id="S4.T3.4.4.6.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">250 rounds</td>
<td id="S4.T3.4.4.6.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500 rounds</td>
</tr>
<tr id="S4.T3.1.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">MOON (<math id="S4.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T3.1.1.1.1.m1.1a"><mi id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\mu</annotation></semantics></math>=1)</td>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">54.7%</td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">58.8%</td>
<td id="S4.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">54.5%</td>
<td id="S4.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">58.2%</td>
</tr>
<tr id="S4.T3.2.2.2" class="ltx_tr">
<td id="S4.T3.2.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">MOON (<math id="S4.T3.2.2.2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T3.2.2.2.1.m1.1a"><mi id="S4.T3.2.2.2.1.m1.1.1" xref="S4.T3.2.2.2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.1.m1.1b"><ci id="S4.T3.2.2.2.1.m1.1.1.cmml" xref="S4.T3.2.2.2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.1.m1.1c">\mu</annotation></semantics></math>=10)</td>
<td id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.2.2.2.2.1" class="ltx_text ltx_font_bold">58.2%</span></td>
<td id="S4.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.2.2.2.3.1" class="ltx_text ltx_font_bold">63.2%</span></td>
<td id="S4.T3.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.2.2.2.4.1" class="ltx_text ltx_font_bold">56.9%</span></td>
<td id="S4.T3.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.2.2.2.5.1" class="ltx_text ltx_font_bold">61.8%</span></td>
</tr>
<tr id="S4.T3.4.4.7.3" class="ltx_tr">
<td id="S4.T3.4.4.7.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedAvg</td>
<td id="S4.T3.4.4.7.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.9%</td>
<td id="S4.T3.4.4.7.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.4%</td>
<td id="S4.T3.4.4.7.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.0%</td>
<td id="S4.T3.4.4.7.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.0%</td>
</tr>
<tr id="S4.T3.4.4.8.4" class="ltx_tr">
<td id="S4.T3.4.4.8.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedProx</td>
<td id="S4.T3.4.4.8.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">52.7%</td>
<td id="S4.T3.4.4.8.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.6%</td>
<td id="S4.T3.4.4.8.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.3%</td>
<td id="S4.T3.4.4.8.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.6%</td>
</tr>
<tr id="S4.T3.4.4.9.5" class="ltx_tr">
<td id="S4.T3.4.4.9.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">SCAFFOLD</td>
<td id="S4.T3.4.4.9.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">35.8%</td>
<td id="S4.T3.4.4.9.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.9%</td>
<td id="S4.T3.4.4.9.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">37.4%</td>
<td id="S4.T3.4.4.9.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.5%</td>
</tr>
<tr id="S4.T3.4.4.4" class="ltx_tr">
<td id="S4.T3.4.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">SOLO</td>
<td id="S4.T3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" colspan="2">10%<math id="S4.T3.3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.3.3.3.1.m1.1a"><mo id="S4.T3.3.3.3.1.m1.1.1" xref="S4.T3.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T3.3.3.3.1.m1.1.1.cmml" xref="S4.T3.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.1.m1.1c">\pm</annotation></semantics></math>0.9%</td>
<td id="S4.T3.4.4.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" colspan="2">7.3%<math id="S4.T3.4.4.4.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.4.4.4.2.m1.1a"><mo id="S4.T3.4.4.4.2.m1.1.1" xref="S4.T3.4.4.4.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.2.m1.1b"><csymbol cd="latexml" id="S4.T3.4.4.4.2.m1.1.1.cmml" xref="S4.T3.4.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.2.m1.1c">\pm</annotation></semantics></math>0.6%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x17.png" id="S4.F8.sf1.g1" class="ltx_graphics ltx_img_landscape" width="207" height="155" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>50 parties</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x18.png" id="S4.F8.sf2.g1" class="ltx_graphics ltx_img_landscape" width="207" height="155" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>100 parties (sample fraction=0.2)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>The top-1 test accuracy on CIFAR-100 with 50/100 parties.</figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Heterogeneity</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.3" class="ltx_p">We study the effect of data heterogeneity by varying the concentration parameter <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mi id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">\beta</annotation></semantics></math> of Dirichlet distribution on CIFAR-100. For a smaller <math id="S4.SS6.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS6.p1.2.m2.1a"><mi id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><ci id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\beta</annotation></semantics></math>, the partition will be more unbalanced. The results are shown in Table <a href="#S4.T4" title="Table 4 ‣ 4.6 Heterogeneity ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. MOON always achieves the best accuracy among three unbalanced levels. When the unbalanced level decreases (i.e., <math id="S4.SS6.p1.3.m3.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S4.SS6.p1.3.m3.1a"><mrow id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml"><mi id="S4.SS6.p1.3.m3.1.1.2" xref="S4.SS6.p1.3.m3.1.1.2.cmml">β</mi><mo id="S4.SS6.p1.3.m3.1.1.1" xref="S4.SS6.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS6.p1.3.m3.1.1.3" xref="S4.SS6.p1.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><apply id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1"><eq id="S4.SS6.p1.3.m3.1.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1.1"></eq><ci id="S4.SS6.p1.3.m3.1.1.2.cmml" xref="S4.SS6.p1.3.m3.1.1.2">𝛽</ci><cn type="integer" id="S4.SS6.p1.3.m3.1.1.3.cmml" xref="S4.SS6.p1.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.3.m3.1c">\beta=5</annotation></semantics></math>), FedProx is worse than FedAvg, while MOON still outperforms FedAvg with more than 2% accuracy. The experiments demonstrate the effectiveness and robustness of MOON.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The test accuracy with <math id="S4.T4.2.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T4.2.m1.1b"><mi id="S4.T4.2.m1.1.1" xref="S4.T4.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T4.2.m1.1c"><ci id="S4.T4.2.m1.1.1.cmml" xref="S4.T4.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.m1.1d">\beta</annotation></semantics></math> from {0.1, 0.5, 5}. </figcaption>
<div id="S4.T4.8" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:177.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(85.2pt,-34.9pt) scale(1.64700190307155,1.64700190307155) ;">
<table id="S4.T4.8.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.5.3.3" class="ltx_tr">
<th id="S4.T4.5.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Method</th>
<th id="S4.T4.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S4.T4.3.1.1.1.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S4.T4.3.1.1.1.m1.1a"><mrow id="S4.T4.3.1.1.1.m1.1.1" xref="S4.T4.3.1.1.1.m1.1.1.cmml"><mi id="S4.T4.3.1.1.1.m1.1.1.2" xref="S4.T4.3.1.1.1.m1.1.1.2.cmml">β</mi><mo id="S4.T4.3.1.1.1.m1.1.1.1" xref="S4.T4.3.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.3.1.1.1.m1.1.1.3" xref="S4.T4.3.1.1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.1.1.1.m1.1b"><apply id="S4.T4.3.1.1.1.m1.1.1.cmml" xref="S4.T4.3.1.1.1.m1.1.1"><eq id="S4.T4.3.1.1.1.m1.1.1.1.cmml" xref="S4.T4.3.1.1.1.m1.1.1.1"></eq><ci id="S4.T4.3.1.1.1.m1.1.1.2.cmml" xref="S4.T4.3.1.1.1.m1.1.1.2">𝛽</ci><cn type="float" id="S4.T4.3.1.1.1.m1.1.1.3.cmml" xref="S4.T4.3.1.1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.1.1.1.m1.1c">\beta=0.1</annotation></semantics></math></th>
<th id="S4.T4.4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S4.T4.4.2.2.2.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S4.T4.4.2.2.2.m1.1a"><mrow id="S4.T4.4.2.2.2.m1.1.1" xref="S4.T4.4.2.2.2.m1.1.1.cmml"><mi id="S4.T4.4.2.2.2.m1.1.1.2" xref="S4.T4.4.2.2.2.m1.1.1.2.cmml">β</mi><mo id="S4.T4.4.2.2.2.m1.1.1.1" xref="S4.T4.4.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T4.4.2.2.2.m1.1.1.3" xref="S4.T4.4.2.2.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.2.2.2.m1.1b"><apply id="S4.T4.4.2.2.2.m1.1.1.cmml" xref="S4.T4.4.2.2.2.m1.1.1"><eq id="S4.T4.4.2.2.2.m1.1.1.1.cmml" xref="S4.T4.4.2.2.2.m1.1.1.1"></eq><ci id="S4.T4.4.2.2.2.m1.1.1.2.cmml" xref="S4.T4.4.2.2.2.m1.1.1.2">𝛽</ci><cn type="float" id="S4.T4.4.2.2.2.m1.1.1.3.cmml" xref="S4.T4.4.2.2.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.2.2.2.m1.1c">\beta=0.5</annotation></semantics></math></th>
<th id="S4.T4.5.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S4.T4.5.3.3.3.m1.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S4.T4.5.3.3.3.m1.1a"><mrow id="S4.T4.5.3.3.3.m1.1.1" xref="S4.T4.5.3.3.3.m1.1.1.cmml"><mi id="S4.T4.5.3.3.3.m1.1.1.2" xref="S4.T4.5.3.3.3.m1.1.1.2.cmml">β</mi><mo id="S4.T4.5.3.3.3.m1.1.1.1" xref="S4.T4.5.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S4.T4.5.3.3.3.m1.1.1.3" xref="S4.T4.5.3.3.3.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.3.3.3.m1.1b"><apply id="S4.T4.5.3.3.3.m1.1.1.cmml" xref="S4.T4.5.3.3.3.m1.1.1"><eq id="S4.T4.5.3.3.3.m1.1.1.1.cmml" xref="S4.T4.5.3.3.3.m1.1.1.1"></eq><ci id="S4.T4.5.3.3.3.m1.1.1.2.cmml" xref="S4.T4.5.3.3.3.m1.1.1.2">𝛽</ci><cn type="integer" id="S4.T4.5.3.3.3.m1.1.1.3.cmml" xref="S4.T4.5.3.3.3.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.3.3.3.m1.1c">\beta=5</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.8.6.7.1" class="ltx_tr">
<td id="S4.T4.8.6.7.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">MOON</td>
<td id="S4.T4.8.6.7.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T4.8.6.7.1.2.1" class="ltx_text ltx_font_bold">64.0%</span></td>
<td id="S4.T4.8.6.7.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T4.8.6.7.1.3.1" class="ltx_text ltx_font_bold">67.5%</span></td>
<td id="S4.T4.8.6.7.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T4.8.6.7.1.4.1" class="ltx_text ltx_font_bold">68.0%</span></td>
</tr>
<tr id="S4.T4.8.6.8.2" class="ltx_tr">
<td id="S4.T4.8.6.8.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedAvg</td>
<td id="S4.T4.8.6.8.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">62.5%</td>
<td id="S4.T4.8.6.8.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.5%</td>
<td id="S4.T4.8.6.8.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.7%</td>
</tr>
<tr id="S4.T4.8.6.9.3" class="ltx_tr">
<td id="S4.T4.8.6.9.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedProx</td>
<td id="S4.T4.8.6.9.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">62.9%</td>
<td id="S4.T4.8.6.9.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.6%</td>
<td id="S4.T4.8.6.9.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.9%</td>
</tr>
<tr id="S4.T4.8.6.10.4" class="ltx_tr">
<td id="S4.T4.8.6.10.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">SCAFFOLD</td>
<td id="S4.T4.8.6.10.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">47.3%</td>
<td id="S4.T4.8.6.10.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">52.5%</td>
<td id="S4.T4.8.6.10.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.0%</td>
</tr>
<tr id="S4.T4.8.6.6" class="ltx_tr">
<td id="S4.T4.8.6.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">SOLO</td>
<td id="S4.T4.6.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">15.9%<math id="S4.T4.6.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.6.4.4.1.m1.1a"><mo id="S4.T4.6.4.4.1.m1.1.1" xref="S4.T4.6.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.6.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T4.6.4.4.1.m1.1.1.cmml" xref="S4.T4.6.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.4.4.1.m1.1c">\pm</annotation></semantics></math>1.5%</td>
<td id="S4.T4.7.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">22.3%<math id="S4.T4.7.5.5.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.7.5.5.2.m1.1a"><mo id="S4.T4.7.5.5.2.m1.1.1" xref="S4.T4.7.5.5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.7.5.5.2.m1.1b"><csymbol cd="latexml" id="S4.T4.7.5.5.2.m1.1.1.cmml" xref="S4.T4.7.5.5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.5.5.2.m1.1c">\pm</annotation></semantics></math>1%</td>
<td id="S4.T4.8.6.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">26.6%<math id="S4.T4.8.6.6.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.8.6.6.3.m1.1a"><mo id="S4.T4.8.6.6.3.m1.1.1" xref="S4.T4.8.6.6.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.8.6.6.3.m1.1b"><csymbol cd="latexml" id="S4.T4.8.6.6.3.m1.1.1.cmml" xref="S4.T4.8.6.6.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.6.6.3.m1.1c">\pm</annotation></semantics></math>1.4%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Loss Function</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.2" class="ltx_p">To maximize the agreement between the representation learned by the global model and the representation learned by the local model, our model-contrastive loss <math id="S4.SS7.p1.1.m1.1" class="ltx_Math" alttext="\ell_{con}" display="inline"><semantics id="S4.SS7.p1.1.m1.1a"><msub id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.SS7.p1.1.m1.1.1.2" xref="S4.SS7.p1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S4.SS7.p1.1.m1.1.1.3" xref="S4.SS7.p1.1.m1.1.1.3.cmml"><mi id="S4.SS7.p1.1.m1.1.1.3.2" xref="S4.SS7.p1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p1.1.m1.1.1.3.1" xref="S4.SS7.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS7.p1.1.m1.1.1.3.3" xref="S4.SS7.p1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p1.1.m1.1.1.3.1a" xref="S4.SS7.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS7.p1.1.m1.1.1.3.4" xref="S4.SS7.p1.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b"><apply id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS7.p1.1.m1.1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS7.p1.1.m1.1.1.2.cmml" xref="S4.SS7.p1.1.m1.1.1.2">ℓ</ci><apply id="S4.SS7.p1.1.m1.1.1.3.cmml" xref="S4.SS7.p1.1.m1.1.1.3"><times id="S4.SS7.p1.1.m1.1.1.3.1.cmml" xref="S4.SS7.p1.1.m1.1.1.3.1"></times><ci id="S4.SS7.p1.1.m1.1.1.3.2.cmml" xref="S4.SS7.p1.1.m1.1.1.3.2">𝑐</ci><ci id="S4.SS7.p1.1.m1.1.1.3.3.cmml" xref="S4.SS7.p1.1.m1.1.1.3.3">𝑜</ci><ci id="S4.SS7.p1.1.m1.1.1.3.4.cmml" xref="S4.SS7.p1.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">\ell_{con}</annotation></semantics></math> is proposed inspired by NT-Xent loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Another intuitive option is to use <math id="S4.SS7.p1.2.m2.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.SS7.p1.2.m2.1a"><msub id="S4.SS7.p1.2.m2.1.1" xref="S4.SS7.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS7.p1.2.m2.1.1.2" xref="S4.SS7.p1.2.m2.1.1.2.cmml">ℓ</mi><mn id="S4.SS7.p1.2.m2.1.1.3" xref="S4.SS7.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.2.m2.1b"><apply id="S4.SS7.p1.2.m2.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS7.p1.2.m2.1.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS7.p1.2.m2.1.1.2.cmml" xref="S4.SS7.p1.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S4.SS7.p1.2.m2.1.1.3.cmml" xref="S4.SS7.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.2.m2.1c">\ell_{2}</annotation></semantics></math> regularization, and the local loss is</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\ell=\ell_{sup}+\mu\left\lVert z-z_{glob}\right\rVert_{2}" display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mi mathvariant="normal" id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml">ℓ</mi><mo id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E6.m1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.3.2.cmml">ℓ</mi><mrow id="S4.E6.m1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.3.3.1a" xref="S4.E6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.3.3.4" xref="S4.E6.m1.1.1.1.3.3.4.cmml">p</mi></mrow></msub><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">​</mo><msub id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" stretchy="true" id="S4.E6.m1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml">z</mi><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1b" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.5" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.5.cmml">b</mi></mrow></msub></mrow><mo fence="true" lspace="0em" stretchy="true" id="S4.E6.m1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><eq id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2"></eq><ci id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3">ℓ</ci><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><plus id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></plus><apply id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.3.2">ℓ</ci><apply id="S4.E6.m1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.3.3"><times id="S4.E6.m1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.3.3.1"></times><ci id="S4.E6.m1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.3.3.2">𝑠</ci><ci id="S4.E6.m1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.3.3.3">𝑢</ci><ci id="S4.E6.m1.1.1.1.3.3.4.cmml" xref="S4.E6.m1.1.1.1.3.3.4">𝑝</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3">𝜇</ci><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"><minus id="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2">𝑧</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.2">𝑔</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.3">𝑙</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.4">𝑜</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.5">𝑏</ci></apply></apply></apply></apply><cn type="integer" id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\ell=\ell_{sup}+\mu\left\lVert z-z_{glob}\right\rVert_{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS7.p2" class="ltx_para">
<p id="S4.SS7.p2.4" class="ltx_p">Here we compare the approaches using different kinds of loss functions to limit the representation: no additional term (i.e., FedAvg: <math id="S4.SS7.p2.1.m1.1" class="ltx_Math" alttext="L=\ell_{sup}" display="inline"><semantics id="S4.SS7.p2.1.m1.1a"><mrow id="S4.SS7.p2.1.m1.1.1" xref="S4.SS7.p2.1.m1.1.1.cmml"><mi id="S4.SS7.p2.1.m1.1.1.2" xref="S4.SS7.p2.1.m1.1.1.2.cmml">L</mi><mo id="S4.SS7.p2.1.m1.1.1.1" xref="S4.SS7.p2.1.m1.1.1.1.cmml">=</mo><msub id="S4.SS7.p2.1.m1.1.1.3" xref="S4.SS7.p2.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="S4.SS7.p2.1.m1.1.1.3.2" xref="S4.SS7.p2.1.m1.1.1.3.2.cmml">ℓ</mi><mrow id="S4.SS7.p2.1.m1.1.1.3.3" xref="S4.SS7.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS7.p2.1.m1.1.1.3.3.2" xref="S4.SS7.p2.1.m1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p2.1.m1.1.1.3.3.1" xref="S4.SS7.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS7.p2.1.m1.1.1.3.3.3" xref="S4.SS7.p2.1.m1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p2.1.m1.1.1.3.3.1a" xref="S4.SS7.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS7.p2.1.m1.1.1.3.3.4" xref="S4.SS7.p2.1.m1.1.1.3.3.4.cmml">p</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p2.1.m1.1b"><apply id="S4.SS7.p2.1.m1.1.1.cmml" xref="S4.SS7.p2.1.m1.1.1"><eq id="S4.SS7.p2.1.m1.1.1.1.cmml" xref="S4.SS7.p2.1.m1.1.1.1"></eq><ci id="S4.SS7.p2.1.m1.1.1.2.cmml" xref="S4.SS7.p2.1.m1.1.1.2">𝐿</ci><apply id="S4.SS7.p2.1.m1.1.1.3.cmml" xref="S4.SS7.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS7.p2.1.m1.1.1.3.1.cmml" xref="S4.SS7.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS7.p2.1.m1.1.1.3.2.cmml" xref="S4.SS7.p2.1.m1.1.1.3.2">ℓ</ci><apply id="S4.SS7.p2.1.m1.1.1.3.3.cmml" xref="S4.SS7.p2.1.m1.1.1.3.3"><times id="S4.SS7.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS7.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS7.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS7.p2.1.m1.1.1.3.3.2">𝑠</ci><ci id="S4.SS7.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS7.p2.1.m1.1.1.3.3.3">𝑢</ci><ci id="S4.SS7.p2.1.m1.1.1.3.3.4.cmml" xref="S4.SS7.p2.1.m1.1.1.3.3.4">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p2.1.m1.1c">L=\ell_{sup}</annotation></semantics></math>), <math id="S4.SS7.p2.2.m2.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.SS7.p2.2.m2.1a"><msub id="S4.SS7.p2.2.m2.1.1" xref="S4.SS7.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS7.p2.2.m2.1.1.2" xref="S4.SS7.p2.2.m2.1.1.2.cmml">ℓ</mi><mn id="S4.SS7.p2.2.m2.1.1.3" xref="S4.SS7.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS7.p2.2.m2.1b"><apply id="S4.SS7.p2.2.m2.1.1.cmml" xref="S4.SS7.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS7.p2.2.m2.1.1.1.cmml" xref="S4.SS7.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS7.p2.2.m2.1.1.2.cmml" xref="S4.SS7.p2.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S4.SS7.p2.2.m2.1.1.3.cmml" xref="S4.SS7.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p2.2.m2.1c">\ell_{2}</annotation></semantics></math> norm, and our model-contrastive loss. The results are shown in Table <a href="#S4.T5" title="Table 5 ‣ 4.7 Loss Function ‣ 4 Experiments ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We can observe that simply using <math id="S4.SS7.p2.3.m3.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.SS7.p2.3.m3.1a"><msub id="S4.SS7.p2.3.m3.1.1" xref="S4.SS7.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS7.p2.3.m3.1.1.2" xref="S4.SS7.p2.3.m3.1.1.2.cmml">ℓ</mi><mn id="S4.SS7.p2.3.m3.1.1.3" xref="S4.SS7.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS7.p2.3.m3.1b"><apply id="S4.SS7.p2.3.m3.1.1.cmml" xref="S4.SS7.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS7.p2.3.m3.1.1.1.cmml" xref="S4.SS7.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS7.p2.3.m3.1.1.2.cmml" xref="S4.SS7.p2.3.m3.1.1.2">ℓ</ci><cn type="integer" id="S4.SS7.p2.3.m3.1.1.3.cmml" xref="S4.SS7.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p2.3.m3.1c">\ell_{2}</annotation></semantics></math> norm even cannot improve the accuracy compared with FedAvg on CIFAR-10. While using <math id="S4.SS7.p2.4.m4.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.SS7.p2.4.m4.1a"><msub id="S4.SS7.p2.4.m4.1.1" xref="S4.SS7.p2.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS7.p2.4.m4.1.1.2" xref="S4.SS7.p2.4.m4.1.1.2.cmml">ℓ</mi><mn id="S4.SS7.p2.4.m4.1.1.3" xref="S4.SS7.p2.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS7.p2.4.m4.1b"><apply id="S4.SS7.p2.4.m4.1.1.cmml" xref="S4.SS7.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS7.p2.4.m4.1.1.1.cmml" xref="S4.SS7.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS7.p2.4.m4.1.1.2.cmml" xref="S4.SS7.p2.4.m4.1.1.2">ℓ</ci><cn type="integer" id="S4.SS7.p2.4.m4.1.1.3.cmml" xref="S4.SS7.p2.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p2.4.m4.1c">\ell_{2}</annotation></semantics></math> norm can improve the accuracy on CIFAR-100 and Tiny-Imagenet, the accuracy is still lower than MOON. Our model-contrastive loss is an effective way to constrain the representations.</p>
</div>
<div id="S4.SS7.p3" class="ltx_para">
<p id="S4.SS7.p3.2" class="ltx_p">Our model-contrastive loss influences the local model from two aspects. Firstly, the local model learns a close representation to the global model. Secondly, the local model also learns a better representation than the previous one until the local model is good enough (i.e., <math id="S4.SS7.p3.1.m1.1" class="ltx_Math" alttext="z=z_{glob}" display="inline"><semantics id="S4.SS7.p3.1.m1.1a"><mrow id="S4.SS7.p3.1.m1.1.1" xref="S4.SS7.p3.1.m1.1.1.cmml"><mi id="S4.SS7.p3.1.m1.1.1.2" xref="S4.SS7.p3.1.m1.1.1.2.cmml">z</mi><mo id="S4.SS7.p3.1.m1.1.1.1" xref="S4.SS7.p3.1.m1.1.1.1.cmml">=</mo><msub id="S4.SS7.p3.1.m1.1.1.3" xref="S4.SS7.p3.1.m1.1.1.3.cmml"><mi id="S4.SS7.p3.1.m1.1.1.3.2" xref="S4.SS7.p3.1.m1.1.1.3.2.cmml">z</mi><mrow id="S4.SS7.p3.1.m1.1.1.3.3" xref="S4.SS7.p3.1.m1.1.1.3.3.cmml"><mi id="S4.SS7.p3.1.m1.1.1.3.3.2" xref="S4.SS7.p3.1.m1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p3.1.m1.1.1.3.3.1" xref="S4.SS7.p3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS7.p3.1.m1.1.1.3.3.3" xref="S4.SS7.p3.1.m1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p3.1.m1.1.1.3.3.1a" xref="S4.SS7.p3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS7.p3.1.m1.1.1.3.3.4" xref="S4.SS7.p3.1.m1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p3.1.m1.1.1.3.3.1b" xref="S4.SS7.p3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS7.p3.1.m1.1.1.3.3.5" xref="S4.SS7.p3.1.m1.1.1.3.3.5.cmml">b</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p3.1.m1.1b"><apply id="S4.SS7.p3.1.m1.1.1.cmml" xref="S4.SS7.p3.1.m1.1.1"><eq id="S4.SS7.p3.1.m1.1.1.1.cmml" xref="S4.SS7.p3.1.m1.1.1.1"></eq><ci id="S4.SS7.p3.1.m1.1.1.2.cmml" xref="S4.SS7.p3.1.m1.1.1.2">𝑧</ci><apply id="S4.SS7.p3.1.m1.1.1.3.cmml" xref="S4.SS7.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS7.p3.1.m1.1.1.3.1.cmml" xref="S4.SS7.p3.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS7.p3.1.m1.1.1.3.2.cmml" xref="S4.SS7.p3.1.m1.1.1.3.2">𝑧</ci><apply id="S4.SS7.p3.1.m1.1.1.3.3.cmml" xref="S4.SS7.p3.1.m1.1.1.3.3"><times id="S4.SS7.p3.1.m1.1.1.3.3.1.cmml" xref="S4.SS7.p3.1.m1.1.1.3.3.1"></times><ci id="S4.SS7.p3.1.m1.1.1.3.3.2.cmml" xref="S4.SS7.p3.1.m1.1.1.3.3.2">𝑔</ci><ci id="S4.SS7.p3.1.m1.1.1.3.3.3.cmml" xref="S4.SS7.p3.1.m1.1.1.3.3.3">𝑙</ci><ci id="S4.SS7.p3.1.m1.1.1.3.3.4.cmml" xref="S4.SS7.p3.1.m1.1.1.3.3.4">𝑜</ci><ci id="S4.SS7.p3.1.m1.1.1.3.3.5.cmml" xref="S4.SS7.p3.1.m1.1.1.3.3.5">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p3.1.m1.1c">z=z_{glob}</annotation></semantics></math> and <math id="S4.SS7.p3.2.m2.1" class="ltx_Math" alttext="\ell_{con}" display="inline"><semantics id="S4.SS7.p3.2.m2.1a"><msub id="S4.SS7.p3.2.m2.1.1" xref="S4.SS7.p3.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS7.p3.2.m2.1.1.2" xref="S4.SS7.p3.2.m2.1.1.2.cmml">ℓ</mi><mrow id="S4.SS7.p3.2.m2.1.1.3" xref="S4.SS7.p3.2.m2.1.1.3.cmml"><mi id="S4.SS7.p3.2.m2.1.1.3.2" xref="S4.SS7.p3.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p3.2.m2.1.1.3.1" xref="S4.SS7.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS7.p3.2.m2.1.1.3.3" xref="S4.SS7.p3.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS7.p3.2.m2.1.1.3.1a" xref="S4.SS7.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS7.p3.2.m2.1.1.3.4" xref="S4.SS7.p3.2.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS7.p3.2.m2.1b"><apply id="S4.SS7.p3.2.m2.1.1.cmml" xref="S4.SS7.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS7.p3.2.m2.1.1.1.cmml" xref="S4.SS7.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS7.p3.2.m2.1.1.2.cmml" xref="S4.SS7.p3.2.m2.1.1.2">ℓ</ci><apply id="S4.SS7.p3.2.m2.1.1.3.cmml" xref="S4.SS7.p3.2.m2.1.1.3"><times id="S4.SS7.p3.2.m2.1.1.3.1.cmml" xref="S4.SS7.p3.2.m2.1.1.3.1"></times><ci id="S4.SS7.p3.2.m2.1.1.3.2.cmml" xref="S4.SS7.p3.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS7.p3.2.m2.1.1.3.3.cmml" xref="S4.SS7.p3.2.m2.1.1.3.3">𝑜</ci><ci id="S4.SS7.p3.2.m2.1.1.3.4.cmml" xref="S4.SS7.p3.2.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p3.2.m2.1c">\ell_{con}</annotation></semantics></math> becomes a constant).</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>The top-1 accuracy with different kinds of loss for the second term of local objective. We tune <math id="S4.T5.3.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T5.3.m1.1b"><mi id="S4.T5.3.m1.1.1" xref="S4.T5.3.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T5.3.m1.1c"><ci id="S4.T5.3.m1.1.1.cmml" xref="S4.T5.3.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.m1.1d">\mu</annotation></semantics></math> from {0.001, 0.01 , 0.1, 1, 5, 10} for the <math id="S4.T5.4.m2.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.T5.4.m2.1b"><msub id="S4.T5.4.m2.1.1" xref="S4.T5.4.m2.1.1.cmml"><mi mathvariant="normal" id="S4.T5.4.m2.1.1.2" xref="S4.T5.4.m2.1.1.2.cmml">ℓ</mi><mn id="S4.T5.4.m2.1.1.3" xref="S4.T5.4.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T5.4.m2.1c"><apply id="S4.T5.4.m2.1.1.cmml" xref="S4.T5.4.m2.1.1"><csymbol cd="ambiguous" id="S4.T5.4.m2.1.1.1.cmml" xref="S4.T5.4.m2.1.1">subscript</csymbol><ci id="S4.T5.4.m2.1.1.2.cmml" xref="S4.T5.4.m2.1.1.2">ℓ</ci><cn type="integer" id="S4.T5.4.m2.1.1.3.cmml" xref="S4.T5.4.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.m2.1d">\ell_{2}</annotation></semantics></math> norm approach and report the best accuracy.</figcaption>
<div id="S4.T5.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:112.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(77.9pt,-20.2pt) scale(1.56056139467611,1.56056139467611) ;">
<table id="S4.T5.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.5.1.2.1" class="ltx_tr">
<th id="S4.T5.5.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">second term</th>
<th id="S4.T5.5.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-10</th>
<th id="S4.T5.5.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-100</th>
<th id="S4.T5.5.1.2.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Tiny-Imagenet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.5.1.3.1" class="ltx_tr">
<td id="S4.T5.5.1.3.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">none (FedAvg)</td>
<td id="S4.T5.5.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">66.3%</td>
<td id="S4.T5.5.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">64.5%</td>
<td id="S4.T5.5.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">23.0%</td>
</tr>
<tr id="S4.T5.5.1.1" class="ltx_tr">
<td id="S4.T5.5.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<math id="S4.T5.5.1.1.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.T5.5.1.1.1.m1.1a"><msub id="S4.T5.5.1.1.1.m1.1.1" xref="S4.T5.5.1.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T5.5.1.1.1.m1.1.1.2" xref="S4.T5.5.1.1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S4.T5.5.1.1.1.m1.1.1.3" xref="S4.T5.5.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T5.5.1.1.1.m1.1b"><apply id="S4.T5.5.1.1.1.m1.1.1.cmml" xref="S4.T5.5.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.5.1.1.1.m1.1.1.1.cmml" xref="S4.T5.5.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T5.5.1.1.1.m1.1.1.2.cmml" xref="S4.T5.5.1.1.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S4.T5.5.1.1.1.m1.1.1.3.cmml" xref="S4.T5.5.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.1.1.1.m1.1c">\ell_{2}</annotation></semantics></math> norm</td>
<td id="S4.T5.5.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.8%</td>
<td id="S4.T5.5.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.9%</td>
<td id="S4.T5.5.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24.0%</td>
</tr>
<tr id="S4.T5.5.1.4.2" class="ltx_tr">
<td id="S4.T5.5.1.4.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">MOON</td>
<td id="S4.T5.5.1.4.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T5.5.1.4.2.2.1" class="ltx_text ltx_font_bold">69.1%</span></td>
<td id="S4.T5.5.1.4.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T5.5.1.4.2.3.1" class="ltx_text ltx_font_bold">67.5%</span></td>
<td id="S4.T5.5.1.4.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T5.5.1.4.2.4.1" class="ltx_text ltx_font_bold">25.1%</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Federated learning has become a promising approach to resolve the pain of data silos in many domains such as medical imaging, object detection, and landmark classification. Non-IID is a key challenge for the effectiveness of federated learning. To improve the performance of federated deep learning models on non-IID datasets, we propose model-contrastive learning (MOON), a simple and effective approach for federated learning. MOON introduces a new learning concept, i.e., contrastive learning in model-level. Our extensive experiments show that MOON achieves significant improvement over state-of-the-art approaches on various image classification tasks. As MOON does not require the inputs to be images, it potentially can be applied to non-vision problems.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This research is supported by the National Research Foundation, Singapore under its AI Singapore Programme (AISG Award No: AISG2-RP-2020-018). Any opinions, findings and conclusions or recommendations expressed in this material are those of the authors and do not reflect the views of National Research Foundation, Singapore. The authors thank Jianxin Wu, Chaoyang He, Shixuan Sun, Yaqi Xie and Yuhang Chen for their feedback. The authors also thank Yuzhi Zhao, Wei Wang, and Mo Sha for their supports of computing resources.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas, Matthew Mattina, Paul Whatmough,
and Venkatesh Saligrama.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Federated learning based on dynamic regularization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Sebastian Caldas, Sai Meher Karthik Duddu, Peter Wu, Tian Li, Jakub
Konečnỳ, H Brendan McMahan, Virginia Smith, and Ameet Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Leaf: A benchmark for federated settings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1812.01097</span><span id="bib.bib2.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">A simple framework for contrastive learning of visual
representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2002.05709</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Ting Chen, Simon Kornblith, Kevin Swersky, Mohammad Norouzi, and Geoffrey
Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Big self-supervised models are strong semi-supervised learners.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2006.10029</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Zhongxiang Dai, Bryan Kian Hsiang Low, and Patrick Jaillet.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Federated bayesian optimization via thompson sampling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 33, 2020.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2009 IEEE conference on computer vision and pattern
recognition</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, pages 248–255. Ieee, 2009.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Canh T Dinh, Nguyen H Tran, and Tuan Dung Nguyen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with moreau envelopes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2006.08848</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, 33, 2020.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Jean-Bastien Grill, Florian Strub, Florent Altché, Corentin Tallec,
Pierre H Richemond, Elena Buchatskaya, Carl Doersch, Bernardo Avila Pires,
Zhaohan Daniel Guo, Mohammad Gheshlaghi Azar, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Bootstrap your own latent: A new approach to self-supervised
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2006.07733</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Filip Hanzely, Slavomír Hanzely, Samuel Horváth, and Peter
Richtárik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Lower bounds and optimal algorithms for personalized federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2010.02372</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Chaoyang He, Songze Li, Jinhyun So, Mi Zhang, Hongyi Wang, Xiaoyang Wang,
Praneeth Vepakomma, Abhishek Singh, Hang Qiu, Li Shen, Peilin Zhao, Yan Kang,
Yang Liu, Ramesh Raskar, Qiang Yang, Murali Annavaram, and Salman Avestimehr.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Fedml: A research library and benchmark for federated machine
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2007.13518</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Momentum contrast for unsupervised visual representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, pages 9729–9738, 2020.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Measuring the effects of non-identical data distribution for
federated visual classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1909.06335</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Federated visual classification with real-world data distribution.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2003.08082</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Sixu Hu, Yuan Li, Xu Liu, Qinbin Li, Zhaomin Wu, and Bingsheng He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">The oarf benchmark suite: Characterization and implications for
federated learning systems.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2006.07856</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Yutao Huang, Lingyang Chu, Zirui Zhou, Lanjun Wang, Jiangchuan Liu, Jian Pei,
and Yong Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Personalized cross-silo federated learning on non-iid data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Longlong Jing and Yingli Tian.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Self-supervised visual feature learning with deep neural networks: A
survey.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Pattern Analysis and Machine Intelligence</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">,
2020.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Rie Johnson and Tong Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Accelerating stochastic gradient descent using predictive variance
reduction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, pages
315–323, 2013.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Keith Bonawitz, Zachary Charles, Graham Cormode,
Rachel Cummings, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Advances and open problems in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1912.04977</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Georgios A Kaissis, Marcus R Makowski, Daniel Rückert, and Rickmer F
Braren.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Secure, privacy-preserving and federated machine learning in medical
imaging.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Nature Machine Intelligence</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, pages 1–7, 2020.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank J Reddi,
Sebastian U Stich, and Ananda Theertha Suresh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Scaffold: Stochastic controlled averaging for on-device federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 37th International Conference on Machine
Learning</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">. PMLR, 2020.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Rajesh Kumar, Abdullah Aman Khan, Sinmin Zhang, WenYong Wang, Yousif Abuidris,
Waqas Amin, and Jay Kumar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Blockchain-federated-learning and deep learning models for covid-19
detection using ct imaging.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2007.06537</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Yiqun Diao, Quan Chen, and Bingsheng He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Federated learning on non-iid data silos: An experimental study.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2102.02079</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Zeyi Wen, and Bingsheng He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Practical federated gradient boosting decision trees.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages 4642–4649, 2020.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Zeyi Wen, Zhaomin Wu, Sixu Hu, Naibo Wang, and Bingsheng He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">A survey on federated learning systems: Vision, hype and reality for
data privacy and protection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1907.09693</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Federated learning: Challenges, methods, and future directions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1908.07873</span><span id="bib.bib27.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Federated optimization in heterogeneous networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Third Conference on Machine Learning and Systems (MLSys)</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">,
2020.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">On the convergence of fedavg on non-iid data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Xiaoxiao Li, Meirui JIANG, Xiaofei Zhang, Michael Kamp, and Qi Dou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Fed{bn}: Federated learning on non-{iid} features via
local batch normalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European conference on computer vision</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 740–755.
Springer, 2014.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Yang Liu, Anbu Huang, Yun Luo, He Huang, Youzhi Liu, Yuanyuan Chen, Lican Feng,
Tianjian Chen, Han Yu, and Qiang Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Fedvision: An online visual object detection platform powered by
federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 13172–13179, 2020.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Laurens van der Maaten and Geoffrey Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Visualizing data using t-sne.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Journal of machine learning research</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 9(Nov):2579–2605, 2008.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
H Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized
data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1602.05629</span><span id="bib.bib34.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Ishan Misra and Laurens van der Maaten.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Self-supervised learning of pretext-invariant representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, pages 6707–6717, 2020.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Representation learning with contrastive predictive coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1807.03748</span><span id="bib.bib36.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Pytorch: An imperative style, high-performance deep learning library.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, pages
8026–8037, 2019.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Kihyuk Sohn.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Improved deep metric learning with multi-class n-pair loss objective.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, pages
1857–1865, 2016.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Yonglong Tian, Dilip Krishnan, and Phillip Isola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Contrastive multiview coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1906.05849</span><span id="bib.bib39.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Paul Voigt and Axel Von dem Bussche.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">The eu general data protection regulation (gdpr).
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">A Practical Guide, 1st Ed., Cham: Springer International
Publishing</span><span id="bib.bib40.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Hongyi Wang, Mikhail Yurochkin, Yuekai Sun, Dimitris Papailiopoulos, and
Yasaman Khazaeni.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Federated learning with matched averaging.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Jianyu Wang, Qinghua Liu, Hao Liang, Gauri Joshi, and H Vincent Poor.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Tackling the objective inconsistency problem in heterogeneous
federated optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib42.4.2" class="ltx_text" style="font-size:90%;">, 33, 2020.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Lixu Wang, Shichao Xu, Xiao Wang, and Qi Zhu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Addressing class imbalance in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Federated machine learning: Concept and applications.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM Transactions on Intelligent Systems and Technology (TIST)</span><span id="bib.bib44.4.2" class="ltx_text" style="font-size:90%;">,
10(2):1–19, 2019.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan Greenewald, Nghia
Hoang, and Yasaman Khazaeni.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Bayesian nonparametric federated learning of neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib45.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 36th International Conference on Machine
Learning</span><span id="bib.bib45.5.3" class="ltx_text" style="font-size:90%;">. PMLR, 2019.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Fengda Zhang, Kun Kuang, Zhaoyang You, Tao Shen, Jun Xiao, Yin Zhang, Chao Wu,
Yueting Zhuang, and Xiaolin Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Federated unsupervised representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2010.08982</span><span id="bib.bib46.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Michael Zhang, Karan Sapra, Sanja Fidler, Serena Yeung, and Jose M. Alvarez.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with first order model optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib47.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib47.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>More Details of the Datasets</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">The statistics of each dataset are shown in Table <a href="#A1.T6" title="Table 6 ‣ Appendix A More Details of the Datasets ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> when setting <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="A1.p1.1.m1.1a"><mrow id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">β</mi><mo id="A1.p1.1.m1.1.1.1" xref="A1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><eq id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1"></eq><ci id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\beta=0.5</annotation></semantics></math>. All datasets provide a training dataset and test dataset. All the reported accuracies are computed on the test dataset.</p>
</div>
<figure id="A1.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>The statistics of datasets.</figcaption>
<div id="A1.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:171.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(102.9pt,-40.6pt) scale(1.90276620258078,1.90276620258078) ;">
<table id="A1.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T6.1.1.1.1" class="ltx_tr">
<th id="A1.T6.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="A1.T6.1.1.1.1.1.1" class="ltx_text">dataset</span></th>
<th id="A1.T6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">#training samples/party</th>
<th id="A1.T6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" rowspan="2"><span id="A1.T6.1.1.1.1.3.1" class="ltx_text">#test samples</span></th>
</tr>
<tr id="A1.T6.1.1.2.2" class="ltx_tr">
<th id="A1.T6.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">mean</th>
<th id="A1.T6.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">std</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T6.1.1.3.1" class="ltx_tr">
<td id="A1.T6.1.1.3.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">CIFAR10</td>
<td id="A1.T6.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">5,000</td>
<td id="A1.T6.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">1,165</td>
<td id="A1.T6.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">10,000</td>
</tr>
<tr id="A1.T6.1.1.4.2" class="ltx_tr">
<td id="A1.T6.1.1.4.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">CIFAR100</td>
<td id="A1.T6.1.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5,000</td>
<td id="A1.T6.1.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">181</td>
<td id="A1.T6.1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10,000</td>
</tr>
<tr id="A1.T6.1.1.5.3" class="ltx_tr">
<td id="A1.T6.1.1.5.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Tiny-Imagenet</td>
<td id="A1.T6.1.1.5.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">10,000</td>
<td id="A1.T6.1.1.5.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">99</td>
<td id="A1.T6.1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">10,000</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.2" class="ltx_p">Figure <a href="#A1.F9" title="Figure 9 ‣ Appendix A More Details of the Datasets ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> and Figure <a href="#A1.F10" title="Figure 10 ‣ Appendix A More Details of the Datasets ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> show the data distribution of <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="A1.p2.1.m1.1a"><mrow id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">β</mi><mo id="A1.p2.1.m1.1.1.1" xref="A1.p2.1.m1.1.1.1.cmml">=</mo><mn id="A1.p2.1.m1.1.1.3" xref="A1.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><eq id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1"></eq><ci id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.p2.1.m1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\beta=0.1</annotation></semantics></math> and <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="A1.p2.2.m2.1a"><mrow id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml"><mi id="A1.p2.2.m2.1.1.2" xref="A1.p2.2.m2.1.1.2.cmml">β</mi><mo id="A1.p2.2.m2.1.1.1" xref="A1.p2.2.m2.1.1.1.cmml">=</mo><mn id="A1.p2.2.m2.1.1.3" xref="A1.p2.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><apply id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1"><eq id="A1.p2.2.m2.1.1.1.cmml" xref="A1.p2.2.m2.1.1.1"></eq><ci id="A1.p2.2.m2.1.1.2.cmml" xref="A1.p2.2.m2.1.1.2">𝛽</ci><cn type="integer" id="A1.p2.2.m2.1.1.3.cmml" xref="A1.p2.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">\beta=5</annotation></semantics></math> (used in Section 4.6 of the main paper), respectively.</p>
</div>
<figure id="A1.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F9.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x19.png" id="A1.F9.sf1.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F9.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x20.png" id="A1.F9.sf2.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>CIFAR-100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F9.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x21.png" id="A1.F9.sf3.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-Imagenet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>The data distribution of each party using non-IID data partition with <math id="A1.F9.2.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="A1.F9.2.m1.1b"><mrow id="A1.F9.2.m1.1.1" xref="A1.F9.2.m1.1.1.cmml"><mi id="A1.F9.2.m1.1.1.2" xref="A1.F9.2.m1.1.1.2.cmml">β</mi><mo id="A1.F9.2.m1.1.1.1" xref="A1.F9.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.2.m1.1.1.3" xref="A1.F9.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.2.m1.1c"><apply id="A1.F9.2.m1.1.1.cmml" xref="A1.F9.2.m1.1.1"><eq id="A1.F9.2.m1.1.1.1.cmml" xref="A1.F9.2.m1.1.1.1"></eq><ci id="A1.F9.2.m1.1.1.2.cmml" xref="A1.F9.2.m1.1.1.2">𝛽</ci><cn type="float" id="A1.F9.2.m1.1.1.3.cmml" xref="A1.F9.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.2.m1.1d">\beta=0.1</annotation></semantics></math>. </figcaption>
</figure>
<figure id="A1.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F10.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x22.png" id="A1.F10.sf1.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F10.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x23.png" id="A1.F10.sf2.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>CIFAR-100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F10.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x24.png" id="A1.F10.sf3.g1" class="ltx_graphics ltx_img_landscape" width="147" height="110" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-Imagenet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>The data distribution of each party using non-IID data partition with <math id="A1.F10.2.m1.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="A1.F10.2.m1.1b"><mrow id="A1.F10.2.m1.1.1" xref="A1.F10.2.m1.1.1.cmml"><mi id="A1.F10.2.m1.1.1.2" xref="A1.F10.2.m1.1.1.2.cmml">β</mi><mo id="A1.F10.2.m1.1.1.1" xref="A1.F10.2.m1.1.1.1.cmml">=</mo><mn id="A1.F10.2.m1.1.1.3" xref="A1.F10.2.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.2.m1.1c"><apply id="A1.F10.2.m1.1.1.cmml" xref="A1.F10.2.m1.1.1"><eq id="A1.F10.2.m1.1.1.1.cmml" xref="A1.F10.2.m1.1.1.1"></eq><ci id="A1.F10.2.m1.1.1.2.cmml" xref="A1.F10.2.m1.1.1.2">𝛽</ci><cn type="integer" id="A1.F10.2.m1.1.1.3.cmml" xref="A1.F10.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.2.m1.1d">\beta=5</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Projection Head</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">We use a projection head to map the representation like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Here we study the effect of the projection head. We remove the projection head and conduct experiments on CIFAR-10 and CIFAR-100 (Note that the network architecture changes for all approaches). The results are shown in Table <a href="#A2.T7" title="Table 7 ‣ Appendix B Projection Head ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. We can observe that MOON can benefit a lot from the projection head. The accuracy of MOON can be improved by about 2% on average with a projection head.</p>
</div>
<figure id="A2.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>The top1-accuracy with/without projection head.</figcaption>
<div id="A2.T7.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:318.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(82.0pt,-60.2pt) scale(1.60847886933315,1.60847886933315) ;">
<table id="A2.T7.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T7.4.4.5.1" class="ltx_tr">
<th id="A2.T7.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2">Method</th>
<th id="A2.T7.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-10</th>
<th id="A2.T7.4.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T7.4.4.6.1" class="ltx_tr">
<td id="A2.T7.4.4.6.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" rowspan="5"><span id="A2.T7.4.4.6.1.1.1" class="ltx_text">
<span id="A2.T7.4.4.6.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T7.4.4.6.1.1.1.1.1" class="ltx_tr">
<span id="A2.T7.4.4.6.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">without</span></span>
<span id="A2.T7.4.4.6.1.1.1.1.2" class="ltx_tr">
<span id="A2.T7.4.4.6.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">projection</span></span>
<span id="A2.T7.4.4.6.1.1.1.1.3" class="ltx_tr">
<span id="A2.T7.4.4.6.1.1.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">head</span></span>
</span></span></td>
<td id="A2.T7.4.4.6.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">MOON</td>
<td id="A2.T7.4.4.6.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">66.8%</td>
<td id="A2.T7.4.4.6.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">66.1%</td>
</tr>
<tr id="A2.T7.4.4.7.2" class="ltx_tr">
<td id="A2.T7.4.4.7.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="A2.T7.4.4.7.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.7%</td>
<td id="A2.T7.4.4.7.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.0%</td>
</tr>
<tr id="A2.T7.4.4.8.3" class="ltx_tr">
<td id="A2.T7.4.4.8.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedProx</td>
<td id="A2.T7.4.4.8.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.5%</td>
<td id="A2.T7.4.4.8.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.4%</td>
</tr>
<tr id="A2.T7.4.4.9.4" class="ltx_tr">
<td id="A2.T7.4.4.9.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SCAFFOLD</td>
<td id="A2.T7.4.4.9.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.1%</td>
<td id="A2.T7.4.4.9.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">49.5%</td>
</tr>
<tr id="A2.T7.2.2.2" class="ltx_tr">
<td id="A2.T7.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SOLO</td>
<td id="A2.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.8%<math id="A2.T7.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A2.T7.1.1.1.1.m1.1a"><mo id="A2.T7.1.1.1.1.m1.1.1" xref="A2.T7.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A2.T7.1.1.1.1.m1.1b"><csymbol cd="latexml" id="A2.T7.1.1.1.1.m1.1.1.cmml" xref="A2.T7.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.1.1.1.1.m1.1c">\pm</annotation></semantics></math>3.9%</td>
<td id="A2.T7.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">22.5%<math id="A2.T7.2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A2.T7.2.2.2.2.m1.1a"><mo id="A2.T7.2.2.2.2.m1.1.1" xref="A2.T7.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A2.T7.2.2.2.2.m1.1b"><csymbol cd="latexml" id="A2.T7.2.2.2.2.m1.1.1.cmml" xref="A2.T7.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.2.2.2.2.m1.1c">\pm</annotation></semantics></math>1.1%</td>
</tr>
<tr id="A2.T7.4.4.10.5" class="ltx_tr">
<td id="A2.T7.4.4.10.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" rowspan="5"><span id="A2.T7.4.4.10.5.1.1" class="ltx_text">
<span id="A2.T7.4.4.10.5.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T7.4.4.10.5.1.1.1.1" class="ltx_tr">
<span id="A2.T7.4.4.10.5.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">with</span></span>
<span id="A2.T7.4.4.10.5.1.1.1.2" class="ltx_tr">
<span id="A2.T7.4.4.10.5.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">projection</span></span>
<span id="A2.T7.4.4.10.5.1.1.1.3" class="ltx_tr">
<span id="A2.T7.4.4.10.5.1.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">head</span></span>
</span></span></td>
<td id="A2.T7.4.4.10.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MOON</td>
<td id="A2.T7.4.4.10.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.4.10.5.3.1" class="ltx_text ltx_font_bold">69.1%</span></td>
<td id="A2.T7.4.4.10.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.4.10.5.4.1" class="ltx_text ltx_font_bold">67.5%</span></td>
</tr>
<tr id="A2.T7.4.4.11.6" class="ltx_tr">
<td id="A2.T7.4.4.11.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="A2.T7.4.4.11.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.3%</td>
<td id="A2.T7.4.4.11.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.5%</td>
</tr>
<tr id="A2.T7.4.4.12.7" class="ltx_tr">
<td id="A2.T7.4.4.12.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedProx</td>
<td id="A2.T7.4.4.12.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.9%</td>
<td id="A2.T7.4.4.12.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.6%</td>
</tr>
<tr id="A2.T7.4.4.13.8" class="ltx_tr">
<td id="A2.T7.4.4.13.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SCAFFOLD</td>
<td id="A2.T7.4.4.13.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.6%</td>
<td id="A2.T7.4.4.13.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">52.5%</td>
</tr>
<tr id="A2.T7.4.4.4" class="ltx_tr">
<td id="A2.T7.4.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">SOLO</td>
<td id="A2.T7.3.3.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">46.3%<math id="A2.T7.3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A2.T7.3.3.3.1.m1.1a"><mo id="A2.T7.3.3.3.1.m1.1.1" xref="A2.T7.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A2.T7.3.3.3.1.m1.1b"><csymbol cd="latexml" id="A2.T7.3.3.3.1.m1.1.1.cmml" xref="A2.T7.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.3.3.3.1.m1.1c">\pm</annotation></semantics></math>5.1%</td>
<td id="A2.T7.4.4.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">22.3%<math id="A2.T7.4.4.4.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A2.T7.4.4.4.2.m1.1a"><mo id="A2.T7.4.4.4.2.m1.1.1" xref="A2.T7.4.4.4.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A2.T7.4.4.4.2.m1.1b"><csymbol cd="latexml" id="A2.T7.4.4.4.2.m1.1.1.cmml" xref="A2.T7.4.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.4.4.4.2.m1.1c">\pm</annotation></semantics></math>1.0%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>IID Partition</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">To further show the effect of our model-contrastive loss, we compare MOON and FedAvg when there is no heterogeneity among local datasets. The dataset is randomly and equally partitioned into the parties. The results are shown in Table <a href="#A3.T8" title="Table 8 ‣ Appendix C IID Partition ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. We can observe that the model-contrastive loss has little influence on the training when the local datasets are IID. The accuracy of MOON is still very close to FedAvg even though with a large <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">\mu</annotation></semantics></math>. MOON is still applicable when there is no heterogeneity issue in data distributions across parties.</p>
</div>
<figure id="A3.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>The top-1 accuracy of MOON and FedAvg with IID data partition on CIFAR-10.</figcaption>
<table id="A3.T8.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T8.5.6.1" class="ltx_tr">
<th id="A3.T8.5.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2">Method</th>
<th id="A3.T8.5.6.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Top-1 accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T8.1.1" class="ltx_tr">
<td id="A3.T8.1.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" rowspan="4"><span id="A3.T8.1.1.2.1" class="ltx_text">MOON</span></td>
<td id="A3.T8.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><math id="A3.T8.1.1.1.m1.1" class="ltx_Math" alttext="\mu=0.1" display="inline"><semantics id="A3.T8.1.1.1.m1.1a"><mrow id="A3.T8.1.1.1.m1.1.1" xref="A3.T8.1.1.1.m1.1.1.cmml"><mi id="A3.T8.1.1.1.m1.1.1.2" xref="A3.T8.1.1.1.m1.1.1.2.cmml">μ</mi><mo id="A3.T8.1.1.1.m1.1.1.1" xref="A3.T8.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A3.T8.1.1.1.m1.1.1.3" xref="A3.T8.1.1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T8.1.1.1.m1.1b"><apply id="A3.T8.1.1.1.m1.1.1.cmml" xref="A3.T8.1.1.1.m1.1.1"><eq id="A3.T8.1.1.1.m1.1.1.1.cmml" xref="A3.T8.1.1.1.m1.1.1.1"></eq><ci id="A3.T8.1.1.1.m1.1.1.2.cmml" xref="A3.T8.1.1.1.m1.1.1.2">𝜇</ci><cn type="float" id="A3.T8.1.1.1.m1.1.1.3.cmml" xref="A3.T8.1.1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.1.1.1.m1.1c">\mu=0.1</annotation></semantics></math></td>
<td id="A3.T8.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">73.6%</td>
</tr>
<tr id="A3.T8.2.2" class="ltx_tr">
<td id="A3.T8.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A3.T8.2.2.1.m1.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="A3.T8.2.2.1.m1.1a"><mrow id="A3.T8.2.2.1.m1.1.1" xref="A3.T8.2.2.1.m1.1.1.cmml"><mi id="A3.T8.2.2.1.m1.1.1.2" xref="A3.T8.2.2.1.m1.1.1.2.cmml">μ</mi><mo id="A3.T8.2.2.1.m1.1.1.1" xref="A3.T8.2.2.1.m1.1.1.1.cmml">=</mo><mn id="A3.T8.2.2.1.m1.1.1.3" xref="A3.T8.2.2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T8.2.2.1.m1.1b"><apply id="A3.T8.2.2.1.m1.1.1.cmml" xref="A3.T8.2.2.1.m1.1.1"><eq id="A3.T8.2.2.1.m1.1.1.1.cmml" xref="A3.T8.2.2.1.m1.1.1.1"></eq><ci id="A3.T8.2.2.1.m1.1.1.2.cmml" xref="A3.T8.2.2.1.m1.1.1.2">𝜇</ci><cn type="integer" id="A3.T8.2.2.1.m1.1.1.3.cmml" xref="A3.T8.2.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.2.2.1.m1.1c">\mu=1</annotation></semantics></math></td>
<td id="A3.T8.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.6%</td>
</tr>
<tr id="A3.T8.3.3" class="ltx_tr">
<td id="A3.T8.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A3.T8.3.3.1.m1.1" class="ltx_Math" alttext="\mu=5" display="inline"><semantics id="A3.T8.3.3.1.m1.1a"><mrow id="A3.T8.3.3.1.m1.1.1" xref="A3.T8.3.3.1.m1.1.1.cmml"><mi id="A3.T8.3.3.1.m1.1.1.2" xref="A3.T8.3.3.1.m1.1.1.2.cmml">μ</mi><mo id="A3.T8.3.3.1.m1.1.1.1" xref="A3.T8.3.3.1.m1.1.1.1.cmml">=</mo><mn id="A3.T8.3.3.1.m1.1.1.3" xref="A3.T8.3.3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T8.3.3.1.m1.1b"><apply id="A3.T8.3.3.1.m1.1.1.cmml" xref="A3.T8.3.3.1.m1.1.1"><eq id="A3.T8.3.3.1.m1.1.1.1.cmml" xref="A3.T8.3.3.1.m1.1.1.1"></eq><ci id="A3.T8.3.3.1.m1.1.1.2.cmml" xref="A3.T8.3.3.1.m1.1.1.2">𝜇</ci><cn type="integer" id="A3.T8.3.3.1.m1.1.1.3.cmml" xref="A3.T8.3.3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.3.3.1.m1.1c">\mu=5</annotation></semantics></math></td>
<td id="A3.T8.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.0%</td>
</tr>
<tr id="A3.T8.4.4" class="ltx_tr">
<td id="A3.T8.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A3.T8.4.4.1.m1.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="A3.T8.4.4.1.m1.1a"><mrow id="A3.T8.4.4.1.m1.1.1" xref="A3.T8.4.4.1.m1.1.1.cmml"><mi id="A3.T8.4.4.1.m1.1.1.2" xref="A3.T8.4.4.1.m1.1.1.2.cmml">μ</mi><mo id="A3.T8.4.4.1.m1.1.1.1" xref="A3.T8.4.4.1.m1.1.1.1.cmml">=</mo><mn id="A3.T8.4.4.1.m1.1.1.3" xref="A3.T8.4.4.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T8.4.4.1.m1.1b"><apply id="A3.T8.4.4.1.m1.1.1.cmml" xref="A3.T8.4.4.1.m1.1.1"><eq id="A3.T8.4.4.1.m1.1.1.1.cmml" xref="A3.T8.4.4.1.m1.1.1.1"></eq><ci id="A3.T8.4.4.1.m1.1.1.2.cmml" xref="A3.T8.4.4.1.m1.1.1.2">𝜇</ci><cn type="integer" id="A3.T8.4.4.1.m1.1.1.3.cmml" xref="A3.T8.4.4.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.4.4.1.m1.1c">\mu=10</annotation></semantics></math></td>
<td id="A3.T8.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.8%</td>
</tr>
<tr id="A3.T8.5.5" class="ltx_tr">
<td id="A3.T8.5.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" colspan="2">FedAvg (<math id="A3.T8.5.5.1.m1.1" class="ltx_Math" alttext="\mu=0" display="inline"><semantics id="A3.T8.5.5.1.m1.1a"><mrow id="A3.T8.5.5.1.m1.1.1" xref="A3.T8.5.5.1.m1.1.1.cmml"><mi id="A3.T8.5.5.1.m1.1.1.2" xref="A3.T8.5.5.1.m1.1.1.2.cmml">μ</mi><mo id="A3.T8.5.5.1.m1.1.1.1" xref="A3.T8.5.5.1.m1.1.1.1.cmml">=</mo><mn id="A3.T8.5.5.1.m1.1.1.3" xref="A3.T8.5.5.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T8.5.5.1.m1.1b"><apply id="A3.T8.5.5.1.m1.1.1.cmml" xref="A3.T8.5.5.1.m1.1.1"><eq id="A3.T8.5.5.1.m1.1.1.1.cmml" xref="A3.T8.5.5.1.m1.1.1.1"></eq><ci id="A3.T8.5.5.1.m1.1.1.2.cmml" xref="A3.T8.5.5.1.m1.1.1.2">𝜇</ci><cn type="integer" id="A3.T8.5.5.1.m1.1.1.3.cmml" xref="A3.T8.5.5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.5.5.1.m1.1c">\mu=0</annotation></semantics></math>)</td>
<td id="A3.T8.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">73.4%</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Hyper-Parameters Study</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Effect of <math id="A4.SS1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A4.SS1.1.m1.1b"><mi id="A4.SS1.1.m1.1.1" xref="A4.SS1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.1.m1.1c"><ci id="A4.SS1.1.m1.1.1.cmml" xref="A4.SS1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.1.m1.1d">\mu</annotation></semantics></math>
</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.7" class="ltx_p">We show the accuracy of MOON with different <math id="A4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A4.SS1.p1.1.m1.1a"><mi id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><ci id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">\mu</annotation></semantics></math> in Table <a href="#A4.T9" title="Table 9 ‣ D.1 Effect of 𝜇 ‣ Appendix D Hyper-Parameters Study ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. The best <math id="A4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A4.SS1.p1.2.m2.1a"><mi id="A4.SS1.p1.2.m2.1.1" xref="A4.SS1.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.2.m2.1b"><ci id="A4.SS1.p1.2.m2.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.2.m2.1c">\mu</annotation></semantics></math> for CIFAR-10, CIFAR-100, and Tiny-Imagenet are 5, 1, and 1, respectively. When <math id="A4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A4.SS1.p1.3.m3.1a"><mi id="A4.SS1.p1.3.m3.1.1" xref="A4.SS1.p1.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.3.m3.1b"><ci id="A4.SS1.p1.3.m3.1.1.cmml" xref="A4.SS1.p1.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.3.m3.1c">\mu</annotation></semantics></math> is set to a small value (i.e., <math id="A4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mu=0.1" display="inline"><semantics id="A4.SS1.p1.4.m4.1a"><mrow id="A4.SS1.p1.4.m4.1.1" xref="A4.SS1.p1.4.m4.1.1.cmml"><mi id="A4.SS1.p1.4.m4.1.1.2" xref="A4.SS1.p1.4.m4.1.1.2.cmml">μ</mi><mo id="A4.SS1.p1.4.m4.1.1.1" xref="A4.SS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="A4.SS1.p1.4.m4.1.1.3" xref="A4.SS1.p1.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.4.m4.1b"><apply id="A4.SS1.p1.4.m4.1.1.cmml" xref="A4.SS1.p1.4.m4.1.1"><eq id="A4.SS1.p1.4.m4.1.1.1.cmml" xref="A4.SS1.p1.4.m4.1.1.1"></eq><ci id="A4.SS1.p1.4.m4.1.1.2.cmml" xref="A4.SS1.p1.4.m4.1.1.2">𝜇</ci><cn type="float" id="A4.SS1.p1.4.m4.1.1.3.cmml" xref="A4.SS1.p1.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.4.m4.1c">\mu=0.1</annotation></semantics></math>), the accuracy of MOON is very close to FedAvg (i.e., <math id="A4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mu=0" display="inline"><semantics id="A4.SS1.p1.5.m5.1a"><mrow id="A4.SS1.p1.5.m5.1.1" xref="A4.SS1.p1.5.m5.1.1.cmml"><mi id="A4.SS1.p1.5.m5.1.1.2" xref="A4.SS1.p1.5.m5.1.1.2.cmml">μ</mi><mo id="A4.SS1.p1.5.m5.1.1.1" xref="A4.SS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="A4.SS1.p1.5.m5.1.1.3" xref="A4.SS1.p1.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.5.m5.1b"><apply id="A4.SS1.p1.5.m5.1.1.cmml" xref="A4.SS1.p1.5.m5.1.1"><eq id="A4.SS1.p1.5.m5.1.1.1.cmml" xref="A4.SS1.p1.5.m5.1.1.1"></eq><ci id="A4.SS1.p1.5.m5.1.1.2.cmml" xref="A4.SS1.p1.5.m5.1.1.2">𝜇</ci><cn type="integer" id="A4.SS1.p1.5.m5.1.1.3.cmml" xref="A4.SS1.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.5.m5.1c">\mu=0</annotation></semantics></math>) since the impact of model-contrastive loss is small. As long as we set <math id="A4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mu\geq 1" display="inline"><semantics id="A4.SS1.p1.6.m6.1a"><mrow id="A4.SS1.p1.6.m6.1.1" xref="A4.SS1.p1.6.m6.1.1.cmml"><mi id="A4.SS1.p1.6.m6.1.1.2" xref="A4.SS1.p1.6.m6.1.1.2.cmml">μ</mi><mo id="A4.SS1.p1.6.m6.1.1.1" xref="A4.SS1.p1.6.m6.1.1.1.cmml">≥</mo><mn id="A4.SS1.p1.6.m6.1.1.3" xref="A4.SS1.p1.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.6.m6.1b"><apply id="A4.SS1.p1.6.m6.1.1.cmml" xref="A4.SS1.p1.6.m6.1.1"><geq id="A4.SS1.p1.6.m6.1.1.1.cmml" xref="A4.SS1.p1.6.m6.1.1.1"></geq><ci id="A4.SS1.p1.6.m6.1.1.2.cmml" xref="A4.SS1.p1.6.m6.1.1.2">𝜇</ci><cn type="integer" id="A4.SS1.p1.6.m6.1.1.3.cmml" xref="A4.SS1.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.6.m6.1c">\mu\geq 1</annotation></semantics></math>, MOON can benefit a lot from the model-contrastive loss. Overall, we find that <math id="A4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="A4.SS1.p1.7.m7.1a"><mrow id="A4.SS1.p1.7.m7.1.1" xref="A4.SS1.p1.7.m7.1.1.cmml"><mi id="A4.SS1.p1.7.m7.1.1.2" xref="A4.SS1.p1.7.m7.1.1.2.cmml">μ</mi><mo id="A4.SS1.p1.7.m7.1.1.1" xref="A4.SS1.p1.7.m7.1.1.1.cmml">=</mo><mn id="A4.SS1.p1.7.m7.1.1.3" xref="A4.SS1.p1.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.7.m7.1b"><apply id="A4.SS1.p1.7.m7.1.1.cmml" xref="A4.SS1.p1.7.m7.1.1"><eq id="A4.SS1.p1.7.m7.1.1.1.cmml" xref="A4.SS1.p1.7.m7.1.1.1"></eq><ci id="A4.SS1.p1.7.m7.1.1.2.cmml" xref="A4.SS1.p1.7.m7.1.1.2">𝜇</ci><cn type="integer" id="A4.SS1.p1.7.m7.1.1.3.cmml" xref="A4.SS1.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.7.m7.1c">\mu=1</annotation></semantics></math> is a reasonable good choice if they do not want to tune the parameter, where MOON achieves at least 2% higher accuracy than FedAvg.</p>
</div>
<figure id="A4.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>The test accuracy of MOON with <math id="A4.T9.3.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A4.T9.3.m1.1b"><mi id="A4.T9.3.m1.1.1" xref="A4.T9.3.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A4.T9.3.m1.1c"><ci id="A4.T9.3.m1.1.1.cmml" xref="A4.T9.3.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.3.m1.1d">\mu</annotation></semantics></math> from {0, 0.1, 1, 5, 10}. Note that MOON is actually FedAvg when <math id="A4.T9.4.m2.1" class="ltx_Math" alttext="\mu=0" display="inline"><semantics id="A4.T9.4.m2.1b"><mrow id="A4.T9.4.m2.1.1" xref="A4.T9.4.m2.1.1.cmml"><mi id="A4.T9.4.m2.1.1.2" xref="A4.T9.4.m2.1.1.2.cmml">μ</mi><mo id="A4.T9.4.m2.1.1.1" xref="A4.T9.4.m2.1.1.1.cmml">=</mo><mn id="A4.T9.4.m2.1.1.3" xref="A4.T9.4.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T9.4.m2.1c"><apply id="A4.T9.4.m2.1.1.cmml" xref="A4.T9.4.m2.1.1"><eq id="A4.T9.4.m2.1.1.1.cmml" xref="A4.T9.4.m2.1.1.1"></eq><ci id="A4.T9.4.m2.1.1.2.cmml" xref="A4.T9.4.m2.1.1.2">𝜇</ci><cn type="integer" id="A4.T9.4.m2.1.1.3.cmml" xref="A4.T9.4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.4.m2.1d">\mu=0</annotation></semantics></math>.</figcaption>
<table id="A4.T9.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T9.5.1" class="ltx_tr">
<th id="A4.T9.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="A4.T9.5.1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A4.T9.5.1.1.m1.1a"><mi id="A4.T9.5.1.1.m1.1.1" xref="A4.T9.5.1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A4.T9.5.1.1.m1.1b"><ci id="A4.T9.5.1.1.m1.1.1.cmml" xref="A4.T9.5.1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.5.1.1.m1.1c">\mu</annotation></semantics></math></th>
<th id="A4.T9.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-10</th>
<th id="A4.T9.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-100</th>
<th id="A4.T9.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Tiny-Imagenet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T9.5.2.1" class="ltx_tr">
<th id="A4.T9.5.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt">0</th>
<td id="A4.T9.5.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">66.3%</td>
<td id="A4.T9.5.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">64.5%</td>
<td id="A4.T9.5.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">23.0%</td>
</tr>
<tr id="A4.T9.5.3.2" class="ltx_tr">
<th id="A4.T9.5.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">0.1</th>
<td id="A4.T9.5.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.5%</td>
<td id="A4.T9.5.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.1%</td>
<td id="A4.T9.5.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23.4%</td>
</tr>
<tr id="A4.T9.5.4.3" class="ltx_tr">
<th id="A4.T9.5.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">1</th>
<td id="A4.T9.5.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.4%</td>
<td id="A4.T9.5.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A4.T9.5.4.3.3.1" class="ltx_text ltx_font_bold">67.5%</span></td>
<td id="A4.T9.5.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A4.T9.5.4.3.4.1" class="ltx_text ltx_font_bold">25.1%</span></td>
</tr>
<tr id="A4.T9.5.5.4" class="ltx_tr">
<th id="A4.T9.5.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">5</th>
<td id="A4.T9.5.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A4.T9.5.5.4.2.1" class="ltx_text ltx_font_bold">69.1%</span></td>
<td id="A4.T9.5.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.1%</td>
<td id="A4.T9.5.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24.4%</td>
</tr>
<tr id="A4.T9.5.6.5" class="ltx_tr">
<th id="A4.T9.5.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">10</th>
<td id="A4.T9.5.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">68.3%</td>
<td id="A4.T9.5.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">67.3%</td>
<td id="A4.T9.5.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">25.0%</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Effect of temperature and output dimension</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.2" class="ltx_p">We tune <math id="A4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A4.SS2.p1.1.m1.1a"><mi id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><ci id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">\tau</annotation></semantics></math> from {0.1, 0.5, 1.0} and tune the output dimension of projection head from {64, 128, 256}. The results are shown in Figure <a href="#A4.F11" title="Figure 11 ‣ D.2 Effect of temperature and output dimension ‣ Appendix D Hyper-Parameters Study ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>. The best <math id="A4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A4.SS2.p1.2.m2.1a"><mi id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><ci id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">\tau</annotation></semantics></math> for CIFAR-10, CIFAR-100, and Tiny-Imagenet are 0.5, 1.0, and 0.5, respectively. The best output dimension for CIFAR-10, CIFAR-100, and Tiny-Imagenet are 128, 256, and 128, respectively. Generally, MOON is stable regarding the change of temperature and output dimension. As we have shown in the main paper, MOON already improves FedAvg a lot with a default setting of temperature (i.e., 0.5) and output dimension (i.e., 256). Users may tune these two hyper-parameters to achieve even better accuracy.</p>
</div>
<figure id="A4.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F11.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x25.png" id="A4.F11.sf1.g1" class="ltx_graphics ltx_img_landscape" width="221" height="166" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>The effect of <math id="A4.F11.sf1.2.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A4.F11.sf1.2.m1.1b"><mi id="A4.F11.sf1.2.m1.1.1" xref="A4.F11.sf1.2.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A4.F11.sf1.2.m1.1c"><ci id="A4.F11.sf1.2.m1.1.1.cmml" xref="A4.F11.sf1.2.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.F11.sf1.2.m1.1d">\tau</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F11.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2103.16257/assets/x26.png" id="A4.F11.sf2.g1" class="ltx_graphics ltx_img_landscape" width="221" height="166" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>The effect of output dimension</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>The top-1 accuracy of MOON trained with different temperatures and output dimensions.</figcaption>
</figure>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Combining with FedAvgM</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">As we have mentioned in the fourth paragraph of Section 2.1, MOON can be combined with the approaches working on improving the aggregation phase. Here we combine MOON and FedAvgM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. We tune the server momentum <math id="A5.p1.1.m1.3" class="ltx_Math" alttext="\beta\in\{0.1,0.7,0.9\}" display="inline"><semantics id="A5.p1.1.m1.3a"><mrow id="A5.p1.1.m1.3.4" xref="A5.p1.1.m1.3.4.cmml"><mi id="A5.p1.1.m1.3.4.2" xref="A5.p1.1.m1.3.4.2.cmml">β</mi><mo id="A5.p1.1.m1.3.4.1" xref="A5.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="A5.p1.1.m1.3.4.3.2" xref="A5.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A5.p1.1.m1.3.4.3.2.1" xref="A5.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml">0.1</mn><mo id="A5.p1.1.m1.3.4.3.2.2" xref="A5.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A5.p1.1.m1.2.2" xref="A5.p1.1.m1.2.2.cmml">0.7</mn><mo id="A5.p1.1.m1.3.4.3.2.3" xref="A5.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A5.p1.1.m1.3.3" xref="A5.p1.1.m1.3.3.cmml">0.9</mn><mo stretchy="false" id="A5.p1.1.m1.3.4.3.2.4" xref="A5.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.3b"><apply id="A5.p1.1.m1.3.4.cmml" xref="A5.p1.1.m1.3.4"><in id="A5.p1.1.m1.3.4.1.cmml" xref="A5.p1.1.m1.3.4.1"></in><ci id="A5.p1.1.m1.3.4.2.cmml" xref="A5.p1.1.m1.3.4.2">𝛽</ci><set id="A5.p1.1.m1.3.4.3.1.cmml" xref="A5.p1.1.m1.3.4.3.2"><cn type="float" id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1">0.1</cn><cn type="float" id="A5.p1.1.m1.2.2.cmml" xref="A5.p1.1.m1.2.2">0.7</cn><cn type="float" id="A5.p1.1.m1.3.3.cmml" xref="A5.p1.1.m1.3.3">0.9</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.3c">\beta\in\{0.1,0.7,0.9\}</annotation></semantics></math>. With the default experimental setting in Section 4.1, the results are shown in Table <a href="#A5.T10" title="Table 10 ‣ Appendix E Combining with FedAvgM ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. While FedAvgM is better than FedAvg, MOON can further improve FedAvgM by 2-3%.</p>
</div>
<figure id="A5.T10" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>The combining of MOON and FedAvgM.</figcaption>
<div id="A5.T10.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:97pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.9pt,-12.5pt) scale(1.34745713206253,1.34745713206253) ;">
<table id="A5.T10.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A5.T10.1.1.1.1" class="ltx_tr">
<th id="A5.T10.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Datasets</th>
<th id="A5.T10.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">FedAvg</th>
<th id="A5.T10.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">MOON</th>
<th id="A5.T10.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">FedAvgM</th>
<th id="A5.T10.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">MOON+FedAvgM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A5.T10.1.1.2.1" class="ltx_tr">
<td id="A5.T10.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">CIFAR-10</td>
<td id="A5.T10.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">66.3%</td>
<td id="A5.T10.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">69.1%</td>
<td id="A5.T10.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">67.1%</td>
<td id="A5.T10.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">69.6%</td>
</tr>
<tr id="A5.T10.1.1.3.2" class="ltx_tr">
<td id="A5.T10.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">CIFAR-100</td>
<td id="A5.T10.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.5%</td>
<td id="A5.T10.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.5%</td>
<td id="A5.T10.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.1%</td>
<td id="A5.T10.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.8%</td>
</tr>
<tr id="A5.T10.1.1.4.3" class="ltx_tr">
<td id="A5.T10.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Tiny-Imagenet</td>
<td id="A5.T10.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">23.0%</td>
<td id="A5.T10.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">25.1%</td>
<td id="A5.T10.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">23.4%</td>
<td id="A5.T10.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">25.5%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Computation Cost</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p">Since MOON introduces an additional loss term in the local training phase, the training of MOON will be slower than FedAvg. For the experiments in Table 1, the average training time per round with a NVIDIA Tesla V100 GPU and four Intel Xeon E5-2684 20-core CPUs are shown in Table <a href="#A6.T11" title="Table 11 ‣ Appendix F Computation Cost ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>. Compared with FedAvg, the computation overhead of MOON is acceptable especially on CIFAR-10 and CIFAR-100.</p>
</div>
<figure id="A6.T11" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>The average training time per round.</figcaption>
<div id="A6.T11.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:145.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(83.1pt,-28.0pt) scale(1.62134356835801,1.62134356835801) ;">
<table id="A6.T11.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A6.T11.1.1.1.1" class="ltx_tr">
<th id="A6.T11.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Method</th>
<th id="A6.T11.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-10</th>
<th id="A6.T11.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">CIFAR-100</th>
<th id="A6.T11.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Tiny-Imagenet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A6.T11.1.1.2.1" class="ltx_tr">
<td id="A6.T11.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt">FedAvg</td>
<td id="A6.T11.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">330s</td>
<td id="A6.T11.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">20min</td>
<td id="A6.T11.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">103min</td>
</tr>
<tr id="A6.T11.1.1.3.2" class="ltx_tr">
<td id="A6.T11.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedProx</td>
<td id="A6.T11.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">340s</td>
<td id="A6.T11.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24min</td>
<td id="A6.T11.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">135min</td>
</tr>
<tr id="A6.T11.1.1.4.3" class="ltx_tr">
<td id="A6.T11.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">SCAFFOLD</td>
<td id="A6.T11.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">332s</td>
<td id="A6.T11.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">20min</td>
<td id="A6.T11.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">112min</td>
</tr>
<tr id="A6.T11.1.1.5.4" class="ltx_tr">
<td id="A6.T11.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">MOON</td>
<td id="A6.T11.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">337s</td>
<td id="A6.T11.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">31min</td>
<td id="A6.T11.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">197min</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A7" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Number of Negative Pairs</h2>

<div id="A7.p1" class="ltx_para">
<p id="A7.p1.5" class="ltx_p">In typical contrastive learning, the performance usually can be improved by increasing the number of negative pairs (i.e., views of different images). In MOON, the negative pair is the local model being updated and the local model from the previous round. We consider using a single negative pair during training in the main paper. It is possible to consider multiple negative pairs if we include multiple local models from the previous rounds. Suppose the current round is <math id="A7.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A7.p1.1.m1.1a"><mi id="A7.p1.1.m1.1.1" xref="A7.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A7.p1.1.m1.1b"><ci id="A7.p1.1.m1.1.1.cmml" xref="A7.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.1.m1.1c">t</annotation></semantics></math>. Let <math id="A7.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A7.p1.2.m2.1a"><mi id="A7.p1.2.m2.1.1" xref="A7.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A7.p1.2.m2.1b"><ci id="A7.p1.2.m2.1.1.cmml" xref="A7.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.2.m2.1c">k</annotation></semantics></math> denotes the maximum number of negative pairs. Let <math id="A7.p1.3.m3.1" class="ltx_Math" alttext="z_{prev}^{i}=R_{w_{i}^{t-i}}(x)" display="inline"><semantics id="A7.p1.3.m3.1a"><mrow id="A7.p1.3.m3.1.2" xref="A7.p1.3.m3.1.2.cmml"><msubsup id="A7.p1.3.m3.1.2.2" xref="A7.p1.3.m3.1.2.2.cmml"><mi id="A7.p1.3.m3.1.2.2.2.2" xref="A7.p1.3.m3.1.2.2.2.2.cmml">z</mi><mrow id="A7.p1.3.m3.1.2.2.2.3" xref="A7.p1.3.m3.1.2.2.2.3.cmml"><mi id="A7.p1.3.m3.1.2.2.2.3.2" xref="A7.p1.3.m3.1.2.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.1.2.2.2.3.1" xref="A7.p1.3.m3.1.2.2.2.3.1.cmml">​</mo><mi id="A7.p1.3.m3.1.2.2.2.3.3" xref="A7.p1.3.m3.1.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.1.2.2.2.3.1a" xref="A7.p1.3.m3.1.2.2.2.3.1.cmml">​</mo><mi id="A7.p1.3.m3.1.2.2.2.3.4" xref="A7.p1.3.m3.1.2.2.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.1.2.2.2.3.1b" xref="A7.p1.3.m3.1.2.2.2.3.1.cmml">​</mo><mi id="A7.p1.3.m3.1.2.2.2.3.5" xref="A7.p1.3.m3.1.2.2.2.3.5.cmml">v</mi></mrow><mi id="A7.p1.3.m3.1.2.2.3" xref="A7.p1.3.m3.1.2.2.3.cmml">i</mi></msubsup><mo id="A7.p1.3.m3.1.2.1" xref="A7.p1.3.m3.1.2.1.cmml">=</mo><mrow id="A7.p1.3.m3.1.2.3" xref="A7.p1.3.m3.1.2.3.cmml"><msub id="A7.p1.3.m3.1.2.3.2" xref="A7.p1.3.m3.1.2.3.2.cmml"><mi id="A7.p1.3.m3.1.2.3.2.2" xref="A7.p1.3.m3.1.2.3.2.2.cmml">R</mi><msubsup id="A7.p1.3.m3.1.2.3.2.3" xref="A7.p1.3.m3.1.2.3.2.3.cmml"><mi id="A7.p1.3.m3.1.2.3.2.3.2.2" xref="A7.p1.3.m3.1.2.3.2.3.2.2.cmml">w</mi><mi id="A7.p1.3.m3.1.2.3.2.3.2.3" xref="A7.p1.3.m3.1.2.3.2.3.2.3.cmml">i</mi><mrow id="A7.p1.3.m3.1.2.3.2.3.3" xref="A7.p1.3.m3.1.2.3.2.3.3.cmml"><mi id="A7.p1.3.m3.1.2.3.2.3.3.2" xref="A7.p1.3.m3.1.2.3.2.3.3.2.cmml">t</mi><mo id="A7.p1.3.m3.1.2.3.2.3.3.1" xref="A7.p1.3.m3.1.2.3.2.3.3.1.cmml">−</mo><mi id="A7.p1.3.m3.1.2.3.2.3.3.3" xref="A7.p1.3.m3.1.2.3.2.3.3.3.cmml">i</mi></mrow></msubsup></msub><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.1.2.3.1" xref="A7.p1.3.m3.1.2.3.1.cmml">​</mo><mrow id="A7.p1.3.m3.1.2.3.3.2" xref="A7.p1.3.m3.1.2.3.cmml"><mo stretchy="false" id="A7.p1.3.m3.1.2.3.3.2.1" xref="A7.p1.3.m3.1.2.3.cmml">(</mo><mi id="A7.p1.3.m3.1.1" xref="A7.p1.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="A7.p1.3.m3.1.2.3.3.2.2" xref="A7.p1.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.3.m3.1b"><apply id="A7.p1.3.m3.1.2.cmml" xref="A7.p1.3.m3.1.2"><eq id="A7.p1.3.m3.1.2.1.cmml" xref="A7.p1.3.m3.1.2.1"></eq><apply id="A7.p1.3.m3.1.2.2.cmml" xref="A7.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="A7.p1.3.m3.1.2.2.1.cmml" xref="A7.p1.3.m3.1.2.2">superscript</csymbol><apply id="A7.p1.3.m3.1.2.2.2.cmml" xref="A7.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="A7.p1.3.m3.1.2.2.2.1.cmml" xref="A7.p1.3.m3.1.2.2">subscript</csymbol><ci id="A7.p1.3.m3.1.2.2.2.2.cmml" xref="A7.p1.3.m3.1.2.2.2.2">𝑧</ci><apply id="A7.p1.3.m3.1.2.2.2.3.cmml" xref="A7.p1.3.m3.1.2.2.2.3"><times id="A7.p1.3.m3.1.2.2.2.3.1.cmml" xref="A7.p1.3.m3.1.2.2.2.3.1"></times><ci id="A7.p1.3.m3.1.2.2.2.3.2.cmml" xref="A7.p1.3.m3.1.2.2.2.3.2">𝑝</ci><ci id="A7.p1.3.m3.1.2.2.2.3.3.cmml" xref="A7.p1.3.m3.1.2.2.2.3.3">𝑟</ci><ci id="A7.p1.3.m3.1.2.2.2.3.4.cmml" xref="A7.p1.3.m3.1.2.2.2.3.4">𝑒</ci><ci id="A7.p1.3.m3.1.2.2.2.3.5.cmml" xref="A7.p1.3.m3.1.2.2.2.3.5">𝑣</ci></apply></apply><ci id="A7.p1.3.m3.1.2.2.3.cmml" xref="A7.p1.3.m3.1.2.2.3">𝑖</ci></apply><apply id="A7.p1.3.m3.1.2.3.cmml" xref="A7.p1.3.m3.1.2.3"><times id="A7.p1.3.m3.1.2.3.1.cmml" xref="A7.p1.3.m3.1.2.3.1"></times><apply id="A7.p1.3.m3.1.2.3.2.cmml" xref="A7.p1.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="A7.p1.3.m3.1.2.3.2.1.cmml" xref="A7.p1.3.m3.1.2.3.2">subscript</csymbol><ci id="A7.p1.3.m3.1.2.3.2.2.cmml" xref="A7.p1.3.m3.1.2.3.2.2">𝑅</ci><apply id="A7.p1.3.m3.1.2.3.2.3.cmml" xref="A7.p1.3.m3.1.2.3.2.3"><csymbol cd="ambiguous" id="A7.p1.3.m3.1.2.3.2.3.1.cmml" xref="A7.p1.3.m3.1.2.3.2.3">superscript</csymbol><apply id="A7.p1.3.m3.1.2.3.2.3.2.cmml" xref="A7.p1.3.m3.1.2.3.2.3"><csymbol cd="ambiguous" id="A7.p1.3.m3.1.2.3.2.3.2.1.cmml" xref="A7.p1.3.m3.1.2.3.2.3">subscript</csymbol><ci id="A7.p1.3.m3.1.2.3.2.3.2.2.cmml" xref="A7.p1.3.m3.1.2.3.2.3.2.2">𝑤</ci><ci id="A7.p1.3.m3.1.2.3.2.3.2.3.cmml" xref="A7.p1.3.m3.1.2.3.2.3.2.3">𝑖</ci></apply><apply id="A7.p1.3.m3.1.2.3.2.3.3.cmml" xref="A7.p1.3.m3.1.2.3.2.3.3"><minus id="A7.p1.3.m3.1.2.3.2.3.3.1.cmml" xref="A7.p1.3.m3.1.2.3.2.3.3.1"></minus><ci id="A7.p1.3.m3.1.2.3.2.3.3.2.cmml" xref="A7.p1.3.m3.1.2.3.2.3.3.2">𝑡</ci><ci id="A7.p1.3.m3.1.2.3.2.3.3.3.cmml" xref="A7.p1.3.m3.1.2.3.2.3.3.3">𝑖</ci></apply></apply></apply><ci id="A7.p1.3.m3.1.1.cmml" xref="A7.p1.3.m3.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.3.m3.1c">z_{prev}^{i}=R_{w_{i}^{t-i}}(x)</annotation></semantics></math> (i.e., <math id="A7.p1.4.m4.1" class="ltx_Math" alttext="z_{prev}^{i}" display="inline"><semantics id="A7.p1.4.m4.1a"><msubsup id="A7.p1.4.m4.1.1" xref="A7.p1.4.m4.1.1.cmml"><mi id="A7.p1.4.m4.1.1.2.2" xref="A7.p1.4.m4.1.1.2.2.cmml">z</mi><mrow id="A7.p1.4.m4.1.1.2.3" xref="A7.p1.4.m4.1.1.2.3.cmml"><mi id="A7.p1.4.m4.1.1.2.3.2" xref="A7.p1.4.m4.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A7.p1.4.m4.1.1.2.3.1" xref="A7.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A7.p1.4.m4.1.1.2.3.3" xref="A7.p1.4.m4.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A7.p1.4.m4.1.1.2.3.1a" xref="A7.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A7.p1.4.m4.1.1.2.3.4" xref="A7.p1.4.m4.1.1.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="A7.p1.4.m4.1.1.2.3.1b" xref="A7.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A7.p1.4.m4.1.1.2.3.5" xref="A7.p1.4.m4.1.1.2.3.5.cmml">v</mi></mrow><mi id="A7.p1.4.m4.1.1.3" xref="A7.p1.4.m4.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="A7.p1.4.m4.1b"><apply id="A7.p1.4.m4.1.1.cmml" xref="A7.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A7.p1.4.m4.1.1.1.cmml" xref="A7.p1.4.m4.1.1">superscript</csymbol><apply id="A7.p1.4.m4.1.1.2.cmml" xref="A7.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A7.p1.4.m4.1.1.2.1.cmml" xref="A7.p1.4.m4.1.1">subscript</csymbol><ci id="A7.p1.4.m4.1.1.2.2.cmml" xref="A7.p1.4.m4.1.1.2.2">𝑧</ci><apply id="A7.p1.4.m4.1.1.2.3.cmml" xref="A7.p1.4.m4.1.1.2.3"><times id="A7.p1.4.m4.1.1.2.3.1.cmml" xref="A7.p1.4.m4.1.1.2.3.1"></times><ci id="A7.p1.4.m4.1.1.2.3.2.cmml" xref="A7.p1.4.m4.1.1.2.3.2">𝑝</ci><ci id="A7.p1.4.m4.1.1.2.3.3.cmml" xref="A7.p1.4.m4.1.1.2.3.3">𝑟</ci><ci id="A7.p1.4.m4.1.1.2.3.4.cmml" xref="A7.p1.4.m4.1.1.2.3.4">𝑒</ci><ci id="A7.p1.4.m4.1.1.2.3.5.cmml" xref="A7.p1.4.m4.1.1.2.3.5">𝑣</ci></apply></apply><ci id="A7.p1.4.m4.1.1.3.cmml" xref="A7.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.4.m4.1c">z_{prev}^{i}</annotation></semantics></math> is the representation learned by the local model from <math id="A7.p1.5.m5.1" class="ltx_Math" alttext="(t-i)" display="inline"><semantics id="A7.p1.5.m5.1a"><mrow id="A7.p1.5.m5.1.1.1" xref="A7.p1.5.m5.1.1.1.1.cmml"><mo stretchy="false" id="A7.p1.5.m5.1.1.1.2" xref="A7.p1.5.m5.1.1.1.1.cmml">(</mo><mrow id="A7.p1.5.m5.1.1.1.1" xref="A7.p1.5.m5.1.1.1.1.cmml"><mi id="A7.p1.5.m5.1.1.1.1.2" xref="A7.p1.5.m5.1.1.1.1.2.cmml">t</mi><mo id="A7.p1.5.m5.1.1.1.1.1" xref="A7.p1.5.m5.1.1.1.1.1.cmml">−</mo><mi id="A7.p1.5.m5.1.1.1.1.3" xref="A7.p1.5.m5.1.1.1.1.3.cmml">i</mi></mrow><mo stretchy="false" id="A7.p1.5.m5.1.1.1.3" xref="A7.p1.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.5.m5.1b"><apply id="A7.p1.5.m5.1.1.1.1.cmml" xref="A7.p1.5.m5.1.1.1"><minus id="A7.p1.5.m5.1.1.1.1.1.cmml" xref="A7.p1.5.m5.1.1.1.1.1"></minus><ci id="A7.p1.5.m5.1.1.1.1.2.cmml" xref="A7.p1.5.m5.1.1.1.1.2">𝑡</ci><ci id="A7.p1.5.m5.1.1.1.1.3.cmml" xref="A7.p1.5.m5.1.1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.5.m5.1c">(t-i)</annotation></semantics></math> round). Then, our local objective is</p>
</div>
<div id="A7.p2" class="ltx_para">
<table id="A7.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A7.E7.m1.9" class="ltx_Math" alttext="\ell_{con}=-\log{\frac{\exp(\textrm{sim}(z,z_{glob})/\tau)}{\exp(\textrm{sim}(z,z_{glob})/\tau)+\sum_{i=1}^{k}\exp(\textrm{sim}(z,z_{prev}^{i})/\tau)}}" display="block"><semantics id="A7.E7.m1.9a"><mrow id="A7.E7.m1.9.10" xref="A7.E7.m1.9.10.cmml"><msub id="A7.E7.m1.9.10.2" xref="A7.E7.m1.9.10.2.cmml"><mi mathsize="90%" mathvariant="normal" id="A7.E7.m1.9.10.2.2" xref="A7.E7.m1.9.10.2.2.cmml">ℓ</mi><mrow id="A7.E7.m1.9.10.2.3" xref="A7.E7.m1.9.10.2.3.cmml"><mi mathsize="90%" id="A7.E7.m1.9.10.2.3.2" xref="A7.E7.m1.9.10.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.9.10.2.3.1" xref="A7.E7.m1.9.10.2.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.9.10.2.3.3" xref="A7.E7.m1.9.10.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.9.10.2.3.1a" xref="A7.E7.m1.9.10.2.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.9.10.2.3.4" xref="A7.E7.m1.9.10.2.3.4.cmml">n</mi></mrow></msub><mo mathsize="90%" id="A7.E7.m1.9.10.1" xref="A7.E7.m1.9.10.1.cmml">=</mo><mrow id="A7.E7.m1.9.10.3" xref="A7.E7.m1.9.10.3.cmml"><mo mathsize="90%" rspace="0.167em" id="A7.E7.m1.9.10.3a" xref="A7.E7.m1.9.10.3.cmml">−</mo><mrow id="A7.E7.m1.9.10.3.2" xref="A7.E7.m1.9.10.3.2.cmml"><mi mathsize="90%" id="A7.E7.m1.9.10.3.2.1" xref="A7.E7.m1.9.10.3.2.1.cmml">log</mi><mo lspace="0.167em" id="A7.E7.m1.9.10.3.2a" xref="A7.E7.m1.9.10.3.2.cmml">⁡</mo><mfrac id="A7.E7.m1.9.9" xref="A7.E7.m1.9.9.cmml"><mrow id="A7.E7.m1.3.3.3.3" xref="A7.E7.m1.3.3.3.4.cmml"><mi mathsize="90%" id="A7.E7.m1.2.2.2.2" xref="A7.E7.m1.2.2.2.2.cmml">exp</mi><mo id="A7.E7.m1.3.3.3.3a" xref="A7.E7.m1.3.3.3.4.cmml">⁡</mo><mrow id="A7.E7.m1.3.3.3.3.1" xref="A7.E7.m1.3.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="A7.E7.m1.3.3.3.3.1.2" xref="A7.E7.m1.3.3.3.4.cmml">(</mo><mrow id="A7.E7.m1.3.3.3.3.1.1" xref="A7.E7.m1.3.3.3.3.1.1.cmml"><mrow id="A7.E7.m1.3.3.3.3.1.1.1" xref="A7.E7.m1.3.3.3.3.1.1.1.cmml"><mtext mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.3" xref="A7.E7.m1.3.3.3.3.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="A7.E7.m1.3.3.3.3.1.1.1.2" xref="A7.E7.m1.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="A7.E7.m1.3.3.3.3.1.1.1.1.1" xref="A7.E7.m1.3.3.3.3.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.2" xref="A7.E7.m1.3.3.3.3.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="A7.E7.m1.1.1.1.1" xref="A7.E7.m1.1.1.1.1.cmml">z</mi><mo mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.3" xref="A7.E7.m1.3.3.3.3.1.1.1.1.2.cmml">,</mo><msub id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.2" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">z</mi><mrow id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.3" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1a" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.4" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1b" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.5" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.4" xref="A7.E7.m1.3.3.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="A7.E7.m1.3.3.3.3.1.1.2" xref="A7.E7.m1.3.3.3.3.1.1.2.cmml">/</mo><mi mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.3" xref="A7.E7.m1.3.3.3.3.1.1.3.cmml">τ</mi></mrow><mo maxsize="90%" minsize="90%" id="A7.E7.m1.3.3.3.3.1.3" xref="A7.E7.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="A7.E7.m1.9.9.9" xref="A7.E7.m1.9.9.9.cmml"><mrow id="A7.E7.m1.8.8.8.5.1" xref="A7.E7.m1.8.8.8.5.2.cmml"><mi mathsize="90%" id="A7.E7.m1.5.5.5.2" xref="A7.E7.m1.5.5.5.2.cmml">exp</mi><mo id="A7.E7.m1.8.8.8.5.1a" xref="A7.E7.m1.8.8.8.5.2.cmml">⁡</mo><mrow id="A7.E7.m1.8.8.8.5.1.1" xref="A7.E7.m1.8.8.8.5.2.cmml"><mo maxsize="90%" minsize="90%" id="A7.E7.m1.8.8.8.5.1.1.2" xref="A7.E7.m1.8.8.8.5.2.cmml">(</mo><mrow id="A7.E7.m1.8.8.8.5.1.1.1" xref="A7.E7.m1.8.8.8.5.1.1.1.cmml"><mrow id="A7.E7.m1.8.8.8.5.1.1.1.1" xref="A7.E7.m1.8.8.8.5.1.1.1.1.cmml"><mtext mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.3" xref="A7.E7.m1.8.8.8.5.1.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="A7.E7.m1.8.8.8.5.1.1.1.1.2" xref="A7.E7.m1.8.8.8.5.1.1.1.1.2.cmml">​</mo><mrow id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.2" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="A7.E7.m1.4.4.4.1" xref="A7.E7.m1.4.4.4.1.cmml">z</mi><mo mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.3" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.2.cmml">,</mo><msub id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.2" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.2" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.3" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1a" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.4" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1b" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.5" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.5.cmml">b</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.4" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="A7.E7.m1.8.8.8.5.1.1.1.2" xref="A7.E7.m1.8.8.8.5.1.1.1.2.cmml">/</mo><mi mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.3" xref="A7.E7.m1.8.8.8.5.1.1.1.3.cmml">τ</mi></mrow><mo maxsize="90%" minsize="90%" id="A7.E7.m1.8.8.8.5.1.1.3" xref="A7.E7.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.055em" id="A7.E7.m1.9.9.9.7" xref="A7.E7.m1.9.9.9.7.cmml">+</mo><mrow id="A7.E7.m1.9.9.9.6" xref="A7.E7.m1.9.9.9.6.cmml"><msubsup id="A7.E7.m1.9.9.9.6.2" xref="A7.E7.m1.9.9.9.6.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="A7.E7.m1.9.9.9.6.2.2.2" xref="A7.E7.m1.9.9.9.6.2.2.2.cmml">∑</mo><mrow id="A7.E7.m1.9.9.9.6.2.2.3" xref="A7.E7.m1.9.9.9.6.2.2.3.cmml"><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.2.2.3.2" xref="A7.E7.m1.9.9.9.6.2.2.3.2.cmml">i</mi><mo mathsize="90%" id="A7.E7.m1.9.9.9.6.2.2.3.1" xref="A7.E7.m1.9.9.9.6.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="A7.E7.m1.9.9.9.6.2.2.3.3" xref="A7.E7.m1.9.9.9.6.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.2.3" xref="A7.E7.m1.9.9.9.6.2.3.cmml">k</mi></msubsup><mrow id="A7.E7.m1.9.9.9.6.1.1" xref="A7.E7.m1.9.9.9.6.1.2.cmml"><mi mathsize="90%" id="A7.E7.m1.7.7.7.4" xref="A7.E7.m1.7.7.7.4.cmml">exp</mi><mo id="A7.E7.m1.9.9.9.6.1.1a" xref="A7.E7.m1.9.9.9.6.1.2.cmml">⁡</mo><mrow id="A7.E7.m1.9.9.9.6.1.1.1" xref="A7.E7.m1.9.9.9.6.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.2" xref="A7.E7.m1.9.9.9.6.1.2.cmml">(</mo><mrow id="A7.E7.m1.9.9.9.6.1.1.1.1" xref="A7.E7.m1.9.9.9.6.1.1.1.1.cmml"><mrow id="A7.E7.m1.9.9.9.6.1.1.1.1.1" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.cmml"><mtext mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.3" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.2" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.2.cmml">​</mo><mrow id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.2" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="A7.E7.m1.6.6.6.3" xref="A7.E7.m1.6.6.6.3.cmml">z</mi><mo mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.3" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">,</mo><msubsup id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.2" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mrow id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.2" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.3" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1a" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.4" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1b" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.5" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.5.cmml">v</mi></mrow><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.3" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo maxsize="90%" minsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.4" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="A7.E7.m1.9.9.9.6.1.1.1.1.2" xref="A7.E7.m1.9.9.9.6.1.1.1.1.2.cmml">/</mo><mi mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.3" xref="A7.E7.m1.9.9.9.6.1.1.1.1.3.cmml">τ</mi></mrow><mo maxsize="90%" minsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.3" xref="A7.E7.m1.9.9.9.6.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E7.m1.9b"><apply id="A7.E7.m1.9.10.cmml" xref="A7.E7.m1.9.10"><eq id="A7.E7.m1.9.10.1.cmml" xref="A7.E7.m1.9.10.1"></eq><apply id="A7.E7.m1.9.10.2.cmml" xref="A7.E7.m1.9.10.2"><csymbol cd="ambiguous" id="A7.E7.m1.9.10.2.1.cmml" xref="A7.E7.m1.9.10.2">subscript</csymbol><ci id="A7.E7.m1.9.10.2.2.cmml" xref="A7.E7.m1.9.10.2.2">ℓ</ci><apply id="A7.E7.m1.9.10.2.3.cmml" xref="A7.E7.m1.9.10.2.3"><times id="A7.E7.m1.9.10.2.3.1.cmml" xref="A7.E7.m1.9.10.2.3.1"></times><ci id="A7.E7.m1.9.10.2.3.2.cmml" xref="A7.E7.m1.9.10.2.3.2">𝑐</ci><ci id="A7.E7.m1.9.10.2.3.3.cmml" xref="A7.E7.m1.9.10.2.3.3">𝑜</ci><ci id="A7.E7.m1.9.10.2.3.4.cmml" xref="A7.E7.m1.9.10.2.3.4">𝑛</ci></apply></apply><apply id="A7.E7.m1.9.10.3.cmml" xref="A7.E7.m1.9.10.3"><minus id="A7.E7.m1.9.10.3.1.cmml" xref="A7.E7.m1.9.10.3"></minus><apply id="A7.E7.m1.9.10.3.2.cmml" xref="A7.E7.m1.9.10.3.2"><log id="A7.E7.m1.9.10.3.2.1.cmml" xref="A7.E7.m1.9.10.3.2.1"></log><apply id="A7.E7.m1.9.9.cmml" xref="A7.E7.m1.9.9"><divide id="A7.E7.m1.9.9.10.cmml" xref="A7.E7.m1.9.9"></divide><apply id="A7.E7.m1.3.3.3.4.cmml" xref="A7.E7.m1.3.3.3.3"><exp id="A7.E7.m1.2.2.2.2.cmml" xref="A7.E7.m1.2.2.2.2"></exp><apply id="A7.E7.m1.3.3.3.3.1.1.cmml" xref="A7.E7.m1.3.3.3.3.1.1"><divide id="A7.E7.m1.3.3.3.3.1.1.2.cmml" xref="A7.E7.m1.3.3.3.3.1.1.2"></divide><apply id="A7.E7.m1.3.3.3.3.1.1.1.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1"><times id="A7.E7.m1.3.3.3.3.1.1.1.2.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.2"></times><ci id="A7.E7.m1.3.3.3.3.1.1.1.3a.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.3"><mtext mathsize="90%" id="A7.E7.m1.3.3.3.3.1.1.1.3.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.3">sim</mtext></ci><interval closure="open" id="A7.E7.m1.3.3.3.3.1.1.1.1.2.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1"><ci id="A7.E7.m1.1.1.1.1.cmml" xref="A7.E7.m1.1.1.1.1">𝑧</ci><apply id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.2">𝑧</ci><apply id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3"><times id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.1"></times><ci id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.2">𝑔</ci><ci id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.3">𝑙</ci><ci id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.4.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.4">𝑜</ci><ci id="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.5.cmml" xref="A7.E7.m1.3.3.3.3.1.1.1.1.1.1.3.5">𝑏</ci></apply></apply></interval></apply><ci id="A7.E7.m1.3.3.3.3.1.1.3.cmml" xref="A7.E7.m1.3.3.3.3.1.1.3">𝜏</ci></apply></apply><apply id="A7.E7.m1.9.9.9.cmml" xref="A7.E7.m1.9.9.9"><plus id="A7.E7.m1.9.9.9.7.cmml" xref="A7.E7.m1.9.9.9.7"></plus><apply id="A7.E7.m1.8.8.8.5.2.cmml" xref="A7.E7.m1.8.8.8.5.1"><exp id="A7.E7.m1.5.5.5.2.cmml" xref="A7.E7.m1.5.5.5.2"></exp><apply id="A7.E7.m1.8.8.8.5.1.1.1.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1"><divide id="A7.E7.m1.8.8.8.5.1.1.1.2.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.2"></divide><apply id="A7.E7.m1.8.8.8.5.1.1.1.1.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1"><times id="A7.E7.m1.8.8.8.5.1.1.1.1.2.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.2"></times><ci id="A7.E7.m1.8.8.8.5.1.1.1.1.3a.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.3"><mtext mathsize="90%" id="A7.E7.m1.8.8.8.5.1.1.1.1.3.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.3">sim</mtext></ci><interval closure="open" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.2.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1"><ci id="A7.E7.m1.4.4.4.1.cmml" xref="A7.E7.m1.4.4.4.1">𝑧</ci><apply id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.1.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.2.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.2">𝑧</ci><apply id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3"><times id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.1"></times><ci id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.3">𝑙</ci><ci id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.4.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.4">𝑜</ci><ci id="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.5.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.1.1.1.1.3.5">𝑏</ci></apply></apply></interval></apply><ci id="A7.E7.m1.8.8.8.5.1.1.1.3.cmml" xref="A7.E7.m1.8.8.8.5.1.1.1.3">𝜏</ci></apply></apply><apply id="A7.E7.m1.9.9.9.6.cmml" xref="A7.E7.m1.9.9.9.6"><apply id="A7.E7.m1.9.9.9.6.2.cmml" xref="A7.E7.m1.9.9.9.6.2"><csymbol cd="ambiguous" id="A7.E7.m1.9.9.9.6.2.1.cmml" xref="A7.E7.m1.9.9.9.6.2">superscript</csymbol><apply id="A7.E7.m1.9.9.9.6.2.2.cmml" xref="A7.E7.m1.9.9.9.6.2"><csymbol cd="ambiguous" id="A7.E7.m1.9.9.9.6.2.2.1.cmml" xref="A7.E7.m1.9.9.9.6.2">subscript</csymbol><sum id="A7.E7.m1.9.9.9.6.2.2.2.cmml" xref="A7.E7.m1.9.9.9.6.2.2.2"></sum><apply id="A7.E7.m1.9.9.9.6.2.2.3.cmml" xref="A7.E7.m1.9.9.9.6.2.2.3"><eq id="A7.E7.m1.9.9.9.6.2.2.3.1.cmml" xref="A7.E7.m1.9.9.9.6.2.2.3.1"></eq><ci id="A7.E7.m1.9.9.9.6.2.2.3.2.cmml" xref="A7.E7.m1.9.9.9.6.2.2.3.2">𝑖</ci><cn type="integer" id="A7.E7.m1.9.9.9.6.2.2.3.3.cmml" xref="A7.E7.m1.9.9.9.6.2.2.3.3">1</cn></apply></apply><ci id="A7.E7.m1.9.9.9.6.2.3.cmml" xref="A7.E7.m1.9.9.9.6.2.3">𝑘</ci></apply><apply id="A7.E7.m1.9.9.9.6.1.2.cmml" xref="A7.E7.m1.9.9.9.6.1.1"><exp id="A7.E7.m1.7.7.7.4.cmml" xref="A7.E7.m1.7.7.7.4"></exp><apply id="A7.E7.m1.9.9.9.6.1.1.1.1.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1"><divide id="A7.E7.m1.9.9.9.6.1.1.1.1.2.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.2"></divide><apply id="A7.E7.m1.9.9.9.6.1.1.1.1.1.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1"><times id="A7.E7.m1.9.9.9.6.1.1.1.1.1.2.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.2"></times><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.1.3a.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.3"><mtext mathsize="90%" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.3.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.3">sim</mtext></ci><interval closure="open" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.2.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1"><ci id="A7.E7.m1.6.6.6.3.cmml" xref="A7.E7.m1.6.6.6.3">𝑧</ci><apply id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.2">𝑧</ci><apply id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3"><times id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.3">𝑟</ci><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.4">𝑒</ci><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.5.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.2.3.5">𝑣</ci></apply></apply><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply><ci id="A7.E7.m1.9.9.9.6.1.1.1.1.3.cmml" xref="A7.E7.m1.9.9.9.6.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E7.m1.9c">\ell_{con}=-\log{\frac{\exp(\textrm{sim}(z,z_{glob})/\tau)}{\exp(\textrm{sim}(z,z_{glob})/\tau)+\sum_{i=1}^{k}\exp(\textrm{sim}(z,z_{prev}^{i})/\tau)}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="A7.p3" class="ltx_para">
<p id="A7.p3.7" class="ltx_p">If <math id="A7.p3.1.m1.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="A7.p3.1.m1.1a"><mrow id="A7.p3.1.m1.1.1" xref="A7.p3.1.m1.1.1.cmml"><mi id="A7.p3.1.m1.1.1.2" xref="A7.p3.1.m1.1.1.2.cmml">k</mi><mo id="A7.p3.1.m1.1.1.1" xref="A7.p3.1.m1.1.1.1.cmml">=</mo><mn id="A7.p3.1.m1.1.1.3" xref="A7.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.1.m1.1b"><apply id="A7.p3.1.m1.1.1.cmml" xref="A7.p3.1.m1.1.1"><eq id="A7.p3.1.m1.1.1.1.cmml" xref="A7.p3.1.m1.1.1.1"></eq><ci id="A7.p3.1.m1.1.1.2.cmml" xref="A7.p3.1.m1.1.1.2">𝑘</ci><cn type="integer" id="A7.p3.1.m1.1.1.3.cmml" xref="A7.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.1.m1.1c">k=1</annotation></semantics></math>, then the objective is the same as MOON presented in the main paper. If <math id="A7.p3.2.m2.1" class="ltx_Math" alttext="k&gt;t" display="inline"><semantics id="A7.p3.2.m2.1a"><mrow id="A7.p3.2.m2.1.1" xref="A7.p3.2.m2.1.1.cmml"><mi id="A7.p3.2.m2.1.1.2" xref="A7.p3.2.m2.1.1.2.cmml">k</mi><mo id="A7.p3.2.m2.1.1.1" xref="A7.p3.2.m2.1.1.1.cmml">&gt;</mo><mi id="A7.p3.2.m2.1.1.3" xref="A7.p3.2.m2.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.2.m2.1b"><apply id="A7.p3.2.m2.1.1.cmml" xref="A7.p3.2.m2.1.1"><gt id="A7.p3.2.m2.1.1.1.cmml" xref="A7.p3.2.m2.1.1.1"></gt><ci id="A7.p3.2.m2.1.1.2.cmml" xref="A7.p3.2.m2.1.1.2">𝑘</ci><ci id="A7.p3.2.m2.1.1.3.cmml" xref="A7.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.2.m2.1c">k&gt;t</annotation></semantics></math>, since there are at most <math id="A7.p3.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A7.p3.3.m3.1a"><mi id="A7.p3.3.m3.1.1" xref="A7.p3.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A7.p3.3.m3.1b"><ci id="A7.p3.3.m3.1.1.cmml" xref="A7.p3.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.3.m3.1c">t</annotation></semantics></math> local models from previous rounds, we only consider the previous <math id="A7.p3.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A7.p3.4.m4.1a"><mi id="A7.p3.4.m4.1.1" xref="A7.p3.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A7.p3.4.m4.1b"><ci id="A7.p3.4.m4.1.1.cmml" xref="A7.p3.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.4.m4.1c">t</annotation></semantics></math> local models (i.e., only <math id="A7.p3.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A7.p3.5.m5.1a"><mi id="A7.p3.5.m5.1.1" xref="A7.p3.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A7.p3.5.m5.1b"><ci id="A7.p3.5.m5.1.1.cmml" xref="A7.p3.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.5.m5.1c">t</annotation></semantics></math> negative pairs). There is no model-contrastive loss if <math id="A7.p3.6.m6.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="A7.p3.6.m6.1a"><mrow id="A7.p3.6.m6.1.1" xref="A7.p3.6.m6.1.1.cmml"><mi id="A7.p3.6.m6.1.1.2" xref="A7.p3.6.m6.1.1.2.cmml">t</mi><mo id="A7.p3.6.m6.1.1.1" xref="A7.p3.6.m6.1.1.1.cmml">=</mo><mn id="A7.p3.6.m6.1.1.3" xref="A7.p3.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.6.m6.1b"><apply id="A7.p3.6.m6.1.1.cmml" xref="A7.p3.6.m6.1.1"><eq id="A7.p3.6.m6.1.1.1.cmml" xref="A7.p3.6.m6.1.1.1"></eq><ci id="A7.p3.6.m6.1.1.2.cmml" xref="A7.p3.6.m6.1.1.2">𝑡</ci><cn type="integer" id="A7.p3.6.m6.1.1.3.cmml" xref="A7.p3.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.6.m6.1c">t=0</annotation></semantics></math> (i.e., the first round). Here we study the effect of the maximum number of negative pairs on CIFAR-10. The results are shown in Table <a href="#A7.T12" title="Table 12 ‣ Appendix G Number of Negative Pairs ‣ Model-Contrastive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>. Unlike typical contrastive learning, the accuracy of MOON cannot be increased by increasing the number of negative pairs. MOON can achieve the best accuracy when <math id="A7.p3.7.m7.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="A7.p3.7.m7.1a"><mrow id="A7.p3.7.m7.1.1" xref="A7.p3.7.m7.1.1.cmml"><mi id="A7.p3.7.m7.1.1.2" xref="A7.p3.7.m7.1.1.2.cmml">k</mi><mo id="A7.p3.7.m7.1.1.1" xref="A7.p3.7.m7.1.1.1.cmml">=</mo><mn id="A7.p3.7.m7.1.1.3" xref="A7.p3.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.7.m7.1b"><apply id="A7.p3.7.m7.1.1.cmml" xref="A7.p3.7.m7.1.1"><eq id="A7.p3.7.m7.1.1.1.cmml" xref="A7.p3.7.m7.1.1.1"></eq><ci id="A7.p3.7.m7.1.1.2.cmml" xref="A7.p3.7.m7.1.1.2">𝑘</ci><cn type="integer" id="A7.p3.7.m7.1.1.3.cmml" xref="A7.p3.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.7.m7.1c">k=1</annotation></semantics></math>, which is presented in our main paper.</p>
</div>
<figure id="A7.T12" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span>The effect of maximum number of negative pairs. We tune <math id="A7.T12.2.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A7.T12.2.m1.1b"><mi id="A7.T12.2.m1.1.1" xref="A7.T12.2.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A7.T12.2.m1.1c"><ci id="A7.T12.2.m1.1.1.cmml" xref="A7.T12.2.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.T12.2.m1.1d">\mu</annotation></semantics></math> from {0.1, 1, 5, 10} for all approaches and report the best accuracy.</figcaption>
<table id="A7.T12.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A7.T12.6.5.1" class="ltx_tr">
<th id="A7.T12.6.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">maximum number of negative pairs</th>
<td id="A7.T12.6.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">top-1 accuracy</td>
</tr>
<tr id="A7.T12.3.1" class="ltx_tr">
<th id="A7.T12.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt"><math id="A7.T12.3.1.1.m1.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="A7.T12.3.1.1.m1.1a"><mrow id="A7.T12.3.1.1.m1.1.1" xref="A7.T12.3.1.1.m1.1.1.cmml"><mi id="A7.T12.3.1.1.m1.1.1.2" xref="A7.T12.3.1.1.m1.1.1.2.cmml">k</mi><mo id="A7.T12.3.1.1.m1.1.1.1" xref="A7.T12.3.1.1.m1.1.1.1.cmml">=</mo><mn id="A7.T12.3.1.1.m1.1.1.3" xref="A7.T12.3.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.T12.3.1.1.m1.1b"><apply id="A7.T12.3.1.1.m1.1.1.cmml" xref="A7.T12.3.1.1.m1.1.1"><eq id="A7.T12.3.1.1.m1.1.1.1.cmml" xref="A7.T12.3.1.1.m1.1.1.1"></eq><ci id="A7.T12.3.1.1.m1.1.1.2.cmml" xref="A7.T12.3.1.1.m1.1.1.2">𝑘</ci><cn type="integer" id="A7.T12.3.1.1.m1.1.1.3.cmml" xref="A7.T12.3.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.T12.3.1.1.m1.1c">k=1</annotation></semantics></math></th>
<td id="A7.T12.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="A7.T12.3.1.2.1" class="ltx_text ltx_font_bold">69.1%</span></td>
</tr>
<tr id="A7.T12.4.2" class="ltx_tr">
<th id="A7.T12.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="A7.T12.4.2.1.m1.1" class="ltx_Math" alttext="k=2" display="inline"><semantics id="A7.T12.4.2.1.m1.1a"><mrow id="A7.T12.4.2.1.m1.1.1" xref="A7.T12.4.2.1.m1.1.1.cmml"><mi id="A7.T12.4.2.1.m1.1.1.2" xref="A7.T12.4.2.1.m1.1.1.2.cmml">k</mi><mo id="A7.T12.4.2.1.m1.1.1.1" xref="A7.T12.4.2.1.m1.1.1.1.cmml">=</mo><mn id="A7.T12.4.2.1.m1.1.1.3" xref="A7.T12.4.2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.T12.4.2.1.m1.1b"><apply id="A7.T12.4.2.1.m1.1.1.cmml" xref="A7.T12.4.2.1.m1.1.1"><eq id="A7.T12.4.2.1.m1.1.1.1.cmml" xref="A7.T12.4.2.1.m1.1.1.1"></eq><ci id="A7.T12.4.2.1.m1.1.1.2.cmml" xref="A7.T12.4.2.1.m1.1.1.2">𝑘</ci><cn type="integer" id="A7.T12.4.2.1.m1.1.1.3.cmml" xref="A7.T12.4.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.T12.4.2.1.m1.1c">k=2</annotation></semantics></math></th>
<td id="A7.T12.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.2%</td>
</tr>
<tr id="A7.T12.5.3" class="ltx_tr">
<th id="A7.T12.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="A7.T12.5.3.1.m1.1" class="ltx_Math" alttext="k=5" display="inline"><semantics id="A7.T12.5.3.1.m1.1a"><mrow id="A7.T12.5.3.1.m1.1.1" xref="A7.T12.5.3.1.m1.1.1.cmml"><mi id="A7.T12.5.3.1.m1.1.1.2" xref="A7.T12.5.3.1.m1.1.1.2.cmml">k</mi><mo id="A7.T12.5.3.1.m1.1.1.1" xref="A7.T12.5.3.1.m1.1.1.1.cmml">=</mo><mn id="A7.T12.5.3.1.m1.1.1.3" xref="A7.T12.5.3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.T12.5.3.1.m1.1b"><apply id="A7.T12.5.3.1.m1.1.1.cmml" xref="A7.T12.5.3.1.m1.1.1"><eq id="A7.T12.5.3.1.m1.1.1.1.cmml" xref="A7.T12.5.3.1.m1.1.1.1"></eq><ci id="A7.T12.5.3.1.m1.1.1.2.cmml" xref="A7.T12.5.3.1.m1.1.1.2">𝑘</ci><cn type="integer" id="A7.T12.5.3.1.m1.1.1.3.cmml" xref="A7.T12.5.3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.T12.5.3.1.m1.1c">k=5</annotation></semantics></math></th>
<td id="A7.T12.5.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.7%</td>
</tr>
<tr id="A7.T12.6.4" class="ltx_tr">
<th id="A7.T12.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><math id="A7.T12.6.4.1.m1.1" class="ltx_Math" alttext="k=100" display="inline"><semantics id="A7.T12.6.4.1.m1.1a"><mrow id="A7.T12.6.4.1.m1.1.1" xref="A7.T12.6.4.1.m1.1.1.cmml"><mi id="A7.T12.6.4.1.m1.1.1.2" xref="A7.T12.6.4.1.m1.1.1.2.cmml">k</mi><mo id="A7.T12.6.4.1.m1.1.1.1" xref="A7.T12.6.4.1.m1.1.1.1.cmml">=</mo><mn id="A7.T12.6.4.1.m1.1.1.3" xref="A7.T12.6.4.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.T12.6.4.1.m1.1b"><apply id="A7.T12.6.4.1.m1.1.1.cmml" xref="A7.T12.6.4.1.m1.1.1"><eq id="A7.T12.6.4.1.m1.1.1.1.cmml" xref="A7.T12.6.4.1.m1.1.1.1"></eq><ci id="A7.T12.6.4.1.m1.1.1.2.cmml" xref="A7.T12.6.4.1.m1.1.1.2">𝑘</ci><cn type="integer" id="A7.T12.6.4.1.m1.1.1.3.cmml" xref="A7.T12.6.4.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.T12.6.4.1.m1.1c">k=100</annotation></semantics></math></th>
<td id="A7.T12.6.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">63.5%</td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2103.16256" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2103.16257" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2103.16257">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2103.16257" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2103.16258" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  8 15:31:55 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
