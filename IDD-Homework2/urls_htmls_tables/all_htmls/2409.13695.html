<!DOCTYPE html>
<html lang="en" prefix="dcterms: http://purl.org/dc/terms/">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>1 Introduction</title>
<!--Generated on Tue Sep  3 05:05:14 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.13695v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S1" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S2" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S2.SS0.SSS0.Px1" title="In 2 Related Work"><span class="ltx_text ltx_ref_title">Long-context Language Models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S2.SS0.SSS0.Px2" title="In 2 Related Work"><span class="ltx_text ltx_ref_title">Retrieval-Augmented Generation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S2.SS0.SSS0.Px3" title="In 2 Related Work"><span class="ltx_text ltx_ref_title">Attention Mechanism.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S2.SS0.SSS0.Px4" title="In 2 Related Work"><span class="ltx_text ltx_ref_title">Fine-tuning for Long Context.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S2.SS0.SSS0.Px5" title="In 2 Related Work"><span class="ltx_text ltx_ref_title">Context Compression.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>You Only Use Reactive Attention (YOURA)</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS0.SSS0.Px1" title="In 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Limitation of Embedding Vectors — Context-Unaware</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS0.SSS0.Px2" title="In 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Attention-Based Retrieval — Context-Aware</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS0.SSS0.Px3" title="In 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Design Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS1" title="In 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Statement &amp; Definitions</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS1.SSS0.Px1" title="In 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Annotations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS1.SSS0.Px2" title="In 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Reaction Vector</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS1.SSS0.Px3" title="In 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Reaction Score</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS1.SSS0.Px4" title="In 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Problem Statement</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS2" title="In 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Embedding-Agnostic Sentence Yield (EASY) Algorithm</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS2.SSS0.Px1" title="In 3.2 Embedding-Agnostic Sentence Yield (EASY) Algorithm ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Challenge</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS2.SSS0.Px2" title="In 3.2 Embedding-Agnostic Sentence Yield (EASY) Algorithm ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title">Embedding-Agnostic Sentence Yield (EASY)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS3" title="In 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Retrieval using Reaction Score — End-to-end</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS0.SSS0.Px1" title="In 4 Experiments"><span class="ltx_text ltx_ref_title">Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS0.SSS0.Px2" title="In 4 Experiments"><span class="ltx_text ltx_ref_title">Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS0.SSS0.Px3" title="In 4 Experiments"><span class="ltx_text ltx_ref_title">Inference Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS0.SSS0.Px4" title="In 4 Experiments"><span class="ltx_text ltx_ref_title">Machine Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS0.SSS0.Px5" title="In 4 Experiments"><span class="ltx_text ltx_ref_title">Experiment Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS1" title="In 4 Experiments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Longbench QA Result</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS2" title="In 4 Experiments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>EASY Sentence Splitter Accuracy</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS2.SSS0.Px1" title="In 4.2 EASY Sentence Splitter Accuracy ‣ 4 Experiments"><span class="ltx_text ltx_ref_title">How well can the EASY algorithm split tokens into sentences?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.SS2.SSS0.Px2" title="In 4.2 EASY Sentence Splitter Accuracy ‣ 4 Experiments"><span class="ltx_text ltx_ref_title">How resilient is the EASY algorithm from edge cases?</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S5" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#A1" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Detailed Results</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">marginparsep has been altered.
<br class="ltx_break"/>topmargin has been altered.
<br class="ltx_break"/>marginparwidth has been altered.
<br class="ltx_break"/>marginparpush has been altered.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="p1.1.1">The page layout violates the ICML style.</span>
Please do not change the page layout, or include packages like geometry,
savetrees, or fullpage, which change it for you.
We’re not able to reliably undo arbitrary changes to the style. Please remove
the offending package(s), or layout-changing commands and try again.</p>
</div>
<div class="ltx_para ltx_align_center" id="p3">
<p class="ltx_p" id="p3.1"><span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_para ltx_align_center" id="p4">
<p class="ltx_p" id="p4.1"><span class="ltx_text ltx_font_smallcaps ltx_framed ltx_framed_underline" id="p4.1.1">Y</span><span class="ltx_text ltx_font_smallcaps" id="p4.1.2">ou <span class="ltx_text ltx_framed ltx_framed_underline" id="p4.1.2.1">O</span>nly <span class="ltx_text ltx_framed ltx_framed_underline" id="p4.1.2.2">U</span>se <span class="ltx_text ltx_framed ltx_framed_underline" id="p4.1.2.3">R</span>eactive <span class="ltx_text ltx_framed ltx_framed_underline" id="p4.1.2.4">A</span>ttention Slice
<br class="ltx_break"/>for Long Context Retrieval</span></p>
</div>
<div class="ltx_para ltx_align_center" id="p5">
<p class="ltx_p" id="p5.1"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_para" id="p6">
<p class="ltx_p ltx_align_center" id="p6.1"><span class="ltx_text ltx_font_bold" id="p6.1.1">Anonymous Authors</span><sup class="ltx_sup" id="p6.1.2">1 </sup></p>
</div>
<div class="ltx_para ltx_noindent" id="p7">
<br class="ltx_break"/>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Supporting longer context for Large Language Models (LLM) is a promising direction to advance LLMs.
As training a model for a longer context window is computationally expensive, many alternative solutions, such as Retrieval Augmented Generation (RAG), have been used.
However, most existing RAG methods adopt embedding-based retrieval that falls short on long contexts.</p>
<p class="ltx_p" id="id2.id2">To address such challenges, we propose an attention-based retrieval technique, <span class="ltx_text ltx_framed ltx_framed_underline" id="id2.id2.1">Y</span>ou <span class="ltx_text ltx_framed ltx_framed_underline" id="id2.id2.2">O</span>nly <span class="ltx_text ltx_framed ltx_framed_underline" id="id2.id2.3">U</span>se <span class="ltx_text ltx_framed ltx_framed_underline" id="id2.id2.4">R</span>eactive <span class="ltx_text ltx_framed ltx_framed_underline" id="id2.id2.5">A</span>ttention slice (YOURA).
YOURA leverages a novel retrieval heuristic called <span class="ltx_text ltx_font_italic" id="id2.id2.6">reaction score</span> to rank the relevance of each sentence in the input context with the query sentence.
Intuitively, we measure how the per-token attention score “reacts” to the query and greedily retrieves the most reactive sentences.
Internally, YOURA generates a token-indexed vector (called <span class="ltx_text ltx_font_italic" id="id2.id2.7">reaction vector</span>) for the whole input context.
To map each sentence to the token-indexed vector, we propose an Embedding-Agnostic Sentence Yield (EASY), a best-effort token wiggling algorithm.</p>
<p class="ltx_p" id="id3.id3">We evaluate our retrieval technique on three open-source pre-trained LLM models across six LongBench QA datasets. Our technique achieves up to 30% vLLM inference throughput improvement for serving long-context queries — with a nearly identical quality score to the simple yet effective truncate-middle approach <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib1" title="">2023</a>)</cite>.</p>
</div>
<span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span>
<sup class="ltx_sup" id="footnotex1.1">1</sup>Anonymous Institution, Anonymous City, Anonymous Region, Anonymous Country.
Correspondence to: Anonymous Author &lt;anon.email@domain.com&gt;.
 
<br class="ltx_break"/></span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Pre-trained Large Language Models (LLM) are widely explored for various Natural Language Processing (NLP) tasks.
To enhance the model for more complex tasks, researchers seek ways to extend the LLM’s context window size
via fine-tuning the pre-trained model <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib7" title="">2023b</a>); Mangrulkar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib19" title="">2022</a>)</cite>, proposing advanced attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib30" title="">2024</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib32" title="">2023</a>)</cite>, and improving Retrieval Augmented Generation (RAG).
However, fine-tuning requires additional computational power for each pre-trained model and is often targeted for specific tasks or datasets.
Advanced attention mechanisms conceptually extend the context window by selectively choosing a subsequence of tokens for attention but are susceptible to details due to the nature of dropping information at the token level.
RAG splits the contextual text into smaller chunks and retrieves a subset of chunks before inferencing based on the semantical distance to the query in the embedding vector space.
RAG’s retrieval nature has many benefits; it reduces the input size to process, which reduces the computation during inference <cite class="ltx_cite ltx_citemacro_cite">Luo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib18" title="">2024</a>)</cite> and improves the accuracy by eliminating distracting information <cite class="ltx_cite ltx_citemacro_cite">Catav (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib5" title="">2023</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S1.F1.1" style="width:433.6pt;height:305.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(98.9pt,-69.7pt) scale(1.83922332208374,1.83922332208374) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="320" id="S1.F1.1.g1" src="x1.png" width="440"/>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
YOURA improves the retrieval quality and inference throughput by retrieving only the “reactive” sentences.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">A high-quality retrieval is crucial for RAG but often suffers from lower accuracy because (1) the common words in both the query and text chunk put the semantic distance closer and (2) the semantically identical, but alphabetically different words distance the query and text chunk in the embedding vector space.
For example, the similarity distance between a query (“Where is Mary?”) and a sentence (“Her name is Mary”) may be closer to a sentence (“She is at home”) resulting in suboptimal retrieval.
<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Measured with Sentence-Transformer “All-MiniLM-L6-V2”, scipy.spatial.distance.</span></span></span></p>
</div>
<figure class="ltx_figure" id="S1.F2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S1.F2.1" style="width:487.8pt;height:196pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.9pt,-22.5pt) scale(1.29751635707966,1.29751635707966) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="290" id="S1.F2.1.g1" src="x2.png" width="710"/>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Comparison of a typical embedding-based retriever (cosine similarity distance), truncation-based approach, and our attention-based retriever (reaction score). In our evaluation, we show that reaction score is a better retrieval heuristic in terms of quality and performance. Unlike the embedding-based approach, which splits the raw string context into chunks (e.g., sentences) before retrieval, YOURA splits the token-indexed vector, <span class="ltx_text ltx_font_italic" id="S1.F2.3.1">reaction-vector</span> in (c), into chunks. Such an approach requires mapping the raw sentences to token indices. We propose Embedding Agnostic Sentence Yield (EASY) algorithm for the challenge.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We propose a fine-tuning-free, attention-based retrieval strategy, which can be applied to various off-the-shelf pre-trained LLMs to achieve improved text generation quality.
Our <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">key insight</em> is that the attention in a pre-trained model already contains information about which tokens are important for the given query.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S1.F2" title="Figure 2 ‣ 1 Introduction"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the difference between the embedding-based retrieval and our proposal; (a) is a typical embedding-based retrieval where embedding vectors for both the query and context chunk list are generated through an embedding layer.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S1.F2" title="Figure 2 ‣ 1 Introduction"><span class="ltx_text ltx_ref_tag">2</span></a> (b) is another simple yet effective alternative to the embedding distance-based approach, truncate-middle.
Since the introduction and conclusion of most documents contain the most important information, the truncation approach naively takes out the middle of the context so that the remaining text fits within the LLM’s context window size.
Unlike embedding-based retrieval or truncation, we propose an attention-based retrieval.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our proposed technique, <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.1">Y</span>ou <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.2">O</span>nly <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.3">U</span>se <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.4">R</span>eactive <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.5">A</span>ttention slice (YOURA) Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S1.F2" title="Figure 2 ‣ 1 Introduction"><span class="ltx_text ltx_ref_tag">2</span></a> (c), is a novel attention-based retrieval technique.
Anonlogically speaking, we use the attention vector generated without query as the baseline and measure how each token “reacts” to the query.
We refer to the “reactiveness” as <span class="ltx_text ltx_font_italic" id="S1.p4.1.6">Reaction Vector</span>, an absolute difference in attention scores calculated with and without the query.
The per-sentence average of the reaction vector called <span class="ltx_text ltx_font_italic" id="S1.p4.1.7">reaction score</span>, is a good ranking metric when retrieving relevant sentences, as we show in our evaluation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Properly slicing the reaction vector into sentences is crucial because YOURA splits the token sequence into chunks (as opposed to prior works, which split the raw text into chunks).
Such a difference sparks a new challenge: mapping sentences to a token sequence.
Merely associating specific token values (e.g., punctuation token) to a sentence boundary is insufficient because different tokenizer uses different vocabulary.
For example, a tokenizer may encode <span class="ltx_text" id="S1.p5.1.1" style="background-color:#ECECEC;">.The</span> (a sentence boundary with a missing white space) as two tokens: [<span class="ltx_text" id="S1.p5.1.2" style="background-color:#ECECEC;">.T</span>, <span class="ltx_text" id="S1.p5.1.3" style="background-color:#ECECEC;">he</span>].
In such case, <span class="ltx_text" id="S1.p5.1.4" style="background-color:#ECECEC;">.T</span> token becomes part of the two consecutive sentences.
Treating the token before or after <span class="ltx_text" id="S1.p5.1.5" style="background-color:#ECECEC;">.T</span> token as a sentence boundary would easily garble the remaining sentence splits.
For this challenge, we propose the Embedding-Agnostic Sentence Yield (EASY) — a best-effort token wiggling algorithm — that takes a list of raw sentences and a single token sequence as input and returns token indices for each sentence.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.2">We evaluate (1) how much YOURA improves the answer quality for the 6 LongBench QA datasets <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib1" title="">2023</a>)</cite>, (2) how YOURA reduces the inferencing computation cost by retrieving fewer, yet sufficient tokens for proper question-answering, and (3) how well our EASY algorithm maps raw texts to the token-indices.
Without any pre-training or additional embeddings, YOURA shows a higher retrieval ratio (context token count / retrieved token count) for open-source pre-trained models (Llama2, Llama3, Mistral) by up to <math alttext="\times 1.3" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mrow id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml"><mi id="S1.p6.1.m1.1.1.2" xref="S1.p6.1.m1.1.1.2.cmml"></mi><mo id="S1.p6.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.p6.1.m1.1.1.1.cmml">×</mo><mn id="S1.p6.1.m1.1.1.3" xref="S1.p6.1.m1.1.1.3.cmml">1.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><apply id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1"><times id="S1.p6.1.m1.1.1.1.cmml" xref="S1.p6.1.m1.1.1.1"></times><csymbol cd="latexml" id="S1.p6.1.m1.1.1.2.cmml" xref="S1.p6.1.m1.1.1.2">absent</csymbol><cn id="S1.p6.1.m1.1.1.3.cmml" type="float" xref="S1.p6.1.m1.1.1.3">1.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">\times 1.3</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">× 1.3</annotation></semantics></math> and still achieves a higher answer quality than prior embedding-based retrieval approaches.
With the smaller number of retrieved tokens, YOURA improves up to 30% vLLM serving throughput.
Our EASY algorithm shows an average of <math alttext="93.7" class="ltx_Math" display="inline" id="S1.p6.2.m2.1"><semantics id="S1.p6.2.m2.1a"><mn id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml">93.7</mn><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><cn id="S1.p6.2.m2.1.1.cmml" type="float" xref="S1.p6.2.m2.1.1">93.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">93.7</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.m2.1d">93.7</annotation></semantics></math>% sentence-to-token-index mapping accuracy.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We contribute the following.</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose You Only Use the Reactive Attention slice (YOURA) algorithm, a fine-tuning-free, attention-based retrieval algorithm. YOURA improves QA quality by up to 10% while improving inference throughput by up to 30%<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>The code has been open-sourced and is available at <a class="ltx_ref ltx_href" href="https://github.com/yjsoh/youra" title="">https://github.com/yjsoh/youra</a>.</span></span></span>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose an Embedding-Agnostic Sentence Yield (EASY) algorithm, which can map individual sentences to their vector slice at 93% accuracy.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We provide a detailed analysis of YOURA’s QA quality improvement on LongBench QA datasets.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Long-context Language Models.</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Training LLMs on sequences with a maximum length while still ensuring they infer well on sequences longer than the maximum is challenging.
Previous studies proposed techniques such as positional interpolation <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib6" title="">2023a</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib15" title="">2023</a>)</cite>, positional extrapolation <cite class="ltx_cite ltx_citemacro_cite">Press et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib23" title="">2021</a>)</cite>, external emory <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib29" title="">2020</a>); Martins et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib20" title="">2021</a>)</cite>, memory-retrieval augmentation strategies <cite class="ltx_cite ltx_citemacro_cite">Mohtashami &amp; Jaggi (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib21" title="">2023</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib28" title="">2024</a>)</cite> to push the limit of the context window size to 2 million and even longer <cite class="ltx_cite ltx_citemacro_cite">Ding et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib8" title="">2024</a>); Bertsch et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib2" title="">2024</a>)</cite>.
Although these works improved model accuracy on various tasks, the large context window size implies more computational and memory costs.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Retrieval-Augmented Generation.</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Retrieval-Augmented Generation (RAG) retrieves relevant document chunks from the external knowledge base.
Prior works integrate RAG with language models for question answering with long documents <cite class="ltx_cite ltx_citemacro_cite">Stelmakh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib25" title="">2022</a>)</cite> and in open-domain <cite class="ltx_cite ltx_citemacro_cite">Giorgi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib9" title="">2022</a>)</cite>. Furthermore, language models adopted retrieval at various stages such as pretraining <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib27" title="">2023</a>); Izacard et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib10" title="">2023</a>); Borgeaud et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib3" title="">2022</a>)</cite>, fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib12" title="">2022</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib31" title="">2024</a>)</cite> and inference stage <cite class="ltx_cite ltx_citemacro_cite">Khandelwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib13" title="">2019</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Attention Mechanism.</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Researchers proposed self-attention alternatives to mitigate its quadratic complexity, which becomes a computational bottleneck for a long context.
These include sparse attention mechanisms with pre-defined sparsity patterns <cite class="ltx_cite ltx_citemacro_cite">Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib34" title="">2021</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib16" title="">2023</a>)</cite>, recurrence-based method <cite class="ltx_cite ltx_citemacro_cite">Bulatov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib4" title="">2022</a>)</cite>, low-rank projection attention <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib33" title="">2024</a>)</cite>, and memory-based mechanisms <cite class="ltx_cite ltx_citemacro_cite">Lou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib17" title="">2024</a>)</cite>.
However, these approximate methods introduce inductive bias (e.g., pre=defined sparsity) that can fit well for specific domains, but may reduce model quality in general LLM training.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Fine-tuning for Long Context.</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px4.p1.1">Recent works <cite class="ltx_cite ltx_citemacro_cite">Ding et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib8" title="">2024</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib7" title="">2023b</a>); Peng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib22" title="">2023</a>)</cite> show that a pre-trained LLM context window can be extended by fine-tuning on longer texts.
However, fine-tuning approaches still require multiple self-attention computations demanding both high-quality training datasets and computational costs.
Our approach does not require fine-tuning.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">Context Compression.</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px5.p1.1">LongLLMLingua <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib11" title="">2023</a>)</cite> is one of the closest approaches to ours; they observed that the small model is capable of identifying the key relevant information, and devised a way to mitigate the “positional bias” due to the positional embeddings by shuffling the long context.
Unlike their approach, which relies on a relatively complex perplexity calculation, our approach merely simply takes the mean within the attention matrix.

</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>You Only Use Reactive Attention (YOURA)</h2>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Limitation of Embedding Vectors — Context-Unaware</h4>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p1.1">The limitation of embedding-based retrieval is that the input texts are the sole variable when generating the embedding vectors.
For example, consider the following two paragraphs each with two sentences: “Her name is Mary. She is at home.” and ”Her name is Alice. She is at home.”.
In both cases, ”She is at home” is embedded into the identical vector, resulting in equal distance to any sentence.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Attention-Based Retrieval — Context-Aware</h4>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px2.p1.1">We propose an attention-based heuristic for context-aware retrieval.
At a high level, our proposal is measuring how the query sentence impacts the language model’s attention distribution.
We observe that attention values of relevant information change more drastically than irrelevant information.
From this observation, we introduce <span class="ltx_text ltx_font_italic" id="S3.SS0.SSS0.Px2.p1.1.1">reaction vector</span> to quantify the attention shift caused by the query sentence.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Design Overview</h4>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px3.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.F3" title="Figure 3 ‣ Design Overview ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the overview of our proposed design.
The left portion of the figure depicts how a reaction vector is calculated and the right portion depicts how a reaction vector is used for the retrieval and how the language model leverages the retrieved sentences to answer the query.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="436" id="S3.F3.g1" src="x3.png" width="934"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overview of YOURA and where it is used in the Retrieval Augmented Generation (RAG) with an example (example context: ”I am an amazing researcher. I like LLM.”, example query: ”Who am I?”).
The first step is calculating the <span class="ltx_text ltx_font_italic" id="S3.F3.7.1">reaction vector</span>, an absolute difference between the attention vector with and without the query (left side of the figure).
The highlighted cells in the attention matrix indicate that the token pair exhibits a relatively high value (e.g., Who vs. I).
Once the reaction vector has been calculated, each sentence is assigned a <span class="ltx_text ltx_font_italic" id="S3.F3.8.2">reaction score</span>, the mean of a corresponding reaction vector slice.
To map each sentence to a token sequence, we propose <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.F3.9.3">E</span>mbedding-<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.F3.10.4">A</span>gnostic <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.F3.11.5">S</span>entence <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.F3.12.6">Y</span>ield (EASY) algorithm (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS2" title="3.2 Embedding-Agnostic Sentence Yield (EASY) Algorithm ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
The retriever passes on the sentences with high reaction scores to the augmentor.
The pre-trained LLM models generate answers using the augmented text, which includes the task-specific prompt, the retrieved context, and the question.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Statement &amp; Definitions</h3>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Annotations</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.5">We annotate <math alttext="\mathrm{Z}^{\text{C}}\in\mathbb{R}^{d\times c}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">Z</mi><mtext id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3a.cmml">C</mtext></msup><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1"><in id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1"></in><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2">Z</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3a.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3"><mtext id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3">C</mtext></ci></apply><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3"><times id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.1c">\mathrm{Z}^{\text{C}}\in\mathbb{R}^{d\times c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.1.m1.1d">roman_Z start_POSTSUPERSCRIPT C end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathrm{Z}^{\text{Q}}\in\mathbb{R}^{d\times q}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">Z</mi><mtext id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.3a.cmml">Q</mtext></msup><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml">q</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1"><in id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1"></in><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.2">Z</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.3a.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.3"><mtext id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.3">Q</mtext></ci></apply><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3"><times id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.1"></times><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.1c">\mathrm{Z}^{\text{Q}}\in\mathbb{R}^{d\times q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.2.m2.1d">roman_Z start_POSTSUPERSCRIPT Q end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> as the continuous representation of the <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS0.Px1.p1.5.1">context</span> and <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS0.Px1.p1.5.2">question</span>, respectively, and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.3.m3.1d">italic_d</annotation></semantics></math> is the pre-trained model’s hidden dimension, <math alttext="c" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.4.m4.1d">italic_c</annotation></semantics></math> is the context token count and <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px1.p1.5.m5.1a"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.5.m5.1b"><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.5.m5.1d">italic_q</annotation></semantics></math> is the question token count.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Reaction Vector</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.1">We define the <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS0.Px2.p1.1.1">reaction vector</span> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{ReactionVector}(\mathrm{Z}^{\text{C}},\mathrm{Z}^{\text{Q}})\\
=\text{abs}\left(\text{AttnVec}(\mathrm{Z}^{\text{C}})-\text{AttnVec}(\text{%
concat}(\mathrm{Z}^{\text{C}},\mathrm{Z}^{\text{Q}}))_{1:c}\right)" class="ltx_Math" display="block" id="S3.E1.m1.36"><semantics id="S3.E1.m1.36a"><mtable displaystyle="true" id="S3.E1.m1.36.36.6" rowspacing="0pt" xref="S3.E1.m1.33.33.3.cmml"><mtr id="S3.E1.m1.36.36.6a" xref="S3.E1.m1.33.33.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.36.36.6b" xref="S3.E1.m1.33.33.3.cmml"><mrow id="S3.E1.m1.35.35.5.32.10.10" xref="S3.E1.m1.33.33.3.cmml"><mtext id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1a.cmml">ReactionVector</mtext><mo id="S3.E1.m1.35.35.5.32.10.10.11" xref="S3.E1.m1.33.33.3.cmml">⁢</mo><mrow id="S3.E1.m1.35.35.5.32.10.10.10.2" xref="S3.E1.m1.33.33.3.cmml"><mo id="S3.E1.m1.2.2.2.2.2.2" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">(</mo><msup id="S3.E1.m1.34.34.4.31.9.9.9.1.1" xref="S3.E1.m1.33.33.3.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3" mathvariant="normal" xref="S3.E1.m1.3.3.3.3.3.3.cmml">Z</mi><mtext id="S3.E1.m1.4.4.4.4.4.4.1" xref="S3.E1.m1.4.4.4.4.4.4.1a.cmml">C</mtext></msup><mo id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.33.33.3.cmml">,</mo><msup id="S3.E1.m1.35.35.5.32.10.10.10.2.2" xref="S3.E1.m1.33.33.3.cmml"><mi id="S3.E1.m1.6.6.6.6.6.6" mathvariant="normal" xref="S3.E1.m1.6.6.6.6.6.6.cmml">Z</mi><mtext id="S3.E1.m1.7.7.7.7.7.7.1" xref="S3.E1.m1.7.7.7.7.7.7.1a.cmml">Q</mtext></msup><mo id="S3.E1.m1.8.8.8.8.8.8" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E1.m1.36.36.6c" xref="S3.E1.m1.33.33.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.36.36.6d" xref="S3.E1.m1.33.33.3.cmml"><mrow id="S3.E1.m1.36.36.6.33.23.23" xref="S3.E1.m1.33.33.3.cmml"><mi id="S3.E1.m1.36.36.6.33.23.23.24" xref="S3.E1.m1.33.33.3.cmml"></mi><mo id="S3.E1.m1.9.9.9.1.1.1" xref="S3.E1.m1.9.9.9.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.36.36.6.33.23.23.23" xref="S3.E1.m1.33.33.3.cmml"><mtext id="S3.E1.m1.10.10.10.2.2.2" xref="S3.E1.m1.10.10.10.2.2.2a.cmml">abs</mtext><mo id="S3.E1.m1.36.36.6.33.23.23.23.2" xref="S3.E1.m1.33.33.3.cmml">⁢</mo><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1" xref="S3.E1.m1.33.33.3.cmml"><mo id="S3.E1.m1.11.11.11.3.3.3" xref="S3.E1.m1.33.33.3.cmml">(</mo><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1" xref="S3.E1.m1.33.33.3.cmml"><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.1" xref="S3.E1.m1.33.33.3.cmml"><mtext id="S3.E1.m1.12.12.12.4.4.4" xref="S3.E1.m1.12.12.12.4.4.4a.cmml">AttnVec</mtext><mo id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.1.2" xref="S3.E1.m1.33.33.3.cmml">⁢</mo><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.1.1.1" xref="S3.E1.m1.33.33.3.cmml"><mo id="S3.E1.m1.13.13.13.5.5.5" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">(</mo><msup id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.1.1.1.1" xref="S3.E1.m1.33.33.3.cmml"><mi id="S3.E1.m1.14.14.14.6.6.6" mathvariant="normal" xref="S3.E1.m1.14.14.14.6.6.6.cmml">Z</mi><mtext id="S3.E1.m1.15.15.15.7.7.7.1" xref="S3.E1.m1.15.15.15.7.7.7.1a.cmml">C</mtext></msup><mo id="S3.E1.m1.16.16.16.8.8.8" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.17.17.17.9.9.9" xref="S3.E1.m1.17.17.17.9.9.9.cmml">−</mo><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2" xref="S3.E1.m1.33.33.3.cmml"><mtext id="S3.E1.m1.18.18.18.10.10.10" xref="S3.E1.m1.18.18.18.10.10.10a.cmml">AttnVec</mtext><mo id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.2" xref="S3.E1.m1.33.33.3.cmml">⁢</mo><msub id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.1" xref="S3.E1.m1.33.33.3.cmml"><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.1.1.1" xref="S3.E1.m1.33.33.3.cmml"><mo id="S3.E1.m1.19.19.19.11.11.11" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">(</mo><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.1.1.1.1" xref="S3.E1.m1.33.33.3.cmml"><mtext id="S3.E1.m1.20.20.20.12.12.12" xref="S3.E1.m1.20.20.20.12.12.12a.cmml">concat</mtext><mo id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.1.1.1.1.3" xref="S3.E1.m1.33.33.3.cmml">⁢</mo><mrow id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.1.1.1.1.2.2" xref="S3.E1.m1.33.33.3.cmml"><mo id="S3.E1.m1.21.21.21.13.13.13" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">(</mo><msup id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E1.m1.33.33.3.cmml"><mi id="S3.E1.m1.22.22.22.14.14.14" mathvariant="normal" xref="S3.E1.m1.22.22.22.14.14.14.cmml">Z</mi><mtext id="S3.E1.m1.23.23.23.15.15.15.1" xref="S3.E1.m1.23.23.23.15.15.15.1a.cmml">C</mtext></msup><mo id="S3.E1.m1.24.24.24.16.16.16" xref="S3.E1.m1.33.33.3.cmml">,</mo><msup id="S3.E1.m1.36.36.6.33.23.23.23.1.1.1.2.1.1.1.1.2.2.2" xref="S3.E1.m1.33.33.3.cmml"><mi id="S3.E1.m1.25.25.25.17.17.17" mathvariant="normal" xref="S3.E1.m1.25.25.25.17.17.17.cmml">Z</mi><mtext id="S3.E1.m1.26.26.26.18.18.18.1" xref="S3.E1.m1.26.26.26.18.18.18.1a.cmml">Q</mtext></msup><mo id="S3.E1.m1.27.27.27.19.19.19" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.28.28.28.20.20.20" stretchy="false" xref="S3.E1.m1.33.33.3.cmml">)</mo></mrow><mrow id="S3.E1.m1.29.29.29.21.21.21.1" xref="S3.E1.m1.29.29.29.21.21.21.1.cmml"><mn id="S3.E1.m1.29.29.29.21.21.21.1.2" xref="S3.E1.m1.29.29.29.21.21.21.1.2.cmml">1</mn><mo id="S3.E1.m1.29.29.29.21.21.21.1.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.29.29.29.21.21.21.1.1.cmml">:</mo><mi id="S3.E1.m1.29.29.29.21.21.21.1.3" xref="S3.E1.m1.29.29.29.21.21.21.1.3.cmml">c</mi></mrow></msub></mrow></mrow><mo id="S3.E1.m1.30.30.30.22.22.22" xref="S3.E1.m1.33.33.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.36b"><apply id="S3.E1.m1.33.33.3.cmml" xref="S3.E1.m1.36.36.6"><eq id="S3.E1.m1.9.9.9.1.1.1.cmml" xref="S3.E1.m1.9.9.9.1.1.1"></eq><apply id="S3.E1.m1.32.32.2.2.cmml" xref="S3.E1.m1.36.36.6"><times id="S3.E1.m1.32.32.2.2.3.cmml" xref="S3.E1.m1.36.36.6"></times><ci id="S3.E1.m1.1.1.1.1.1.1a.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><mtext id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">ReactionVector</mtext></ci><interval closure="open" id="S3.E1.m1.32.32.2.2.2.3.cmml" xref="S3.E1.m1.36.36.6"><apply id="S3.E1.m1.31.31.1.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6"><csymbol cd="ambiguous" id="S3.E1.m1.31.31.1.1.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6">superscript</csymbol><ci id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3">Z</ci><ci id="S3.E1.m1.4.4.4.4.4.4.1a.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1"><mtext id="S3.E1.m1.4.4.4.4.4.4.1.cmml" mathsize="70%" xref="S3.E1.m1.4.4.4.4.4.4.1">C</mtext></ci></apply><apply id="S3.E1.m1.32.32.2.2.2.2.2.cmml" xref="S3.E1.m1.36.36.6"><csymbol cd="ambiguous" id="S3.E1.m1.32.32.2.2.2.2.2.1.cmml" xref="S3.E1.m1.36.36.6">superscript</csymbol><ci id="S3.E1.m1.6.6.6.6.6.6.cmml" xref="S3.E1.m1.6.6.6.6.6.6">Z</ci><ci id="S3.E1.m1.7.7.7.7.7.7.1a.cmml" xref="S3.E1.m1.7.7.7.7.7.7.1"><mtext id="S3.E1.m1.7.7.7.7.7.7.1.cmml" mathsize="70%" xref="S3.E1.m1.7.7.7.7.7.7.1">Q</mtext></ci></apply></interval></apply><apply id="S3.E1.m1.33.33.3.3.cmml" xref="S3.E1.m1.36.36.6"><times id="S3.E1.m1.33.33.3.3.2.cmml" xref="S3.E1.m1.36.36.6"></times><ci id="S3.E1.m1.10.10.10.2.2.2a.cmml" xref="S3.E1.m1.10.10.10.2.2.2"><mtext id="S3.E1.m1.10.10.10.2.2.2.cmml" xref="S3.E1.m1.10.10.10.2.2.2">abs</mtext></ci><apply id="S3.E1.m1.33.33.3.3.1.1.1.cmml" xref="S3.E1.m1.36.36.6"><minus id="S3.E1.m1.17.17.17.9.9.9.cmml" xref="S3.E1.m1.17.17.17.9.9.9"></minus><apply id="S3.E1.m1.33.33.3.3.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6"><times id="S3.E1.m1.33.33.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.36.36.6"></times><ci id="S3.E1.m1.12.12.12.4.4.4a.cmml" xref="S3.E1.m1.12.12.12.4.4.4"><mtext id="S3.E1.m1.12.12.12.4.4.4.cmml" xref="S3.E1.m1.12.12.12.4.4.4">AttnVec</mtext></ci><apply id="S3.E1.m1.33.33.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6"><csymbol cd="ambiguous" id="S3.E1.m1.33.33.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6">superscript</csymbol><ci id="S3.E1.m1.14.14.14.6.6.6.cmml" xref="S3.E1.m1.14.14.14.6.6.6">Z</ci><ci id="S3.E1.m1.15.15.15.7.7.7.1a.cmml" xref="S3.E1.m1.15.15.15.7.7.7.1"><mtext id="S3.E1.m1.15.15.15.7.7.7.1.cmml" mathsize="70%" xref="S3.E1.m1.15.15.15.7.7.7.1">C</mtext></ci></apply></apply><apply id="S3.E1.m1.33.33.3.3.1.1.1.2.cmml" xref="S3.E1.m1.36.36.6"><times id="S3.E1.m1.33.33.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.36.36.6"></times><ci id="S3.E1.m1.18.18.18.10.10.10a.cmml" xref="S3.E1.m1.18.18.18.10.10.10"><mtext id="S3.E1.m1.18.18.18.10.10.10.cmml" xref="S3.E1.m1.18.18.18.10.10.10">AttnVec</mtext></ci><apply id="S3.E1.m1.33.33.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.36.36.6"><csymbol cd="ambiguous" id="S3.E1.m1.33.33.3.3.1.1.1.2.1.2.cmml" xref="S3.E1.m1.36.36.6">subscript</csymbol><apply id="S3.E1.m1.33.33.3.3.1.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6"><times id="S3.E1.m1.33.33.3.3.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E1.m1.36.36.6"></times><ci id="S3.E1.m1.20.20.20.12.12.12a.cmml" xref="S3.E1.m1.20.20.20.12.12.12"><mtext id="S3.E1.m1.20.20.20.12.12.12.cmml" xref="S3.E1.m1.20.20.20.12.12.12">concat</mtext></ci><interval closure="open" id="S3.E1.m1.33.33.3.3.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.36.36.6"><apply id="S3.E1.m1.33.33.3.3.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6"><csymbol cd="ambiguous" id="S3.E1.m1.33.33.3.3.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.36.36.6">superscript</csymbol><ci id="S3.E1.m1.22.22.22.14.14.14.cmml" xref="S3.E1.m1.22.22.22.14.14.14">Z</ci><ci id="S3.E1.m1.23.23.23.15.15.15.1a.cmml" xref="S3.E1.m1.23.23.23.15.15.15.1"><mtext id="S3.E1.m1.23.23.23.15.15.15.1.cmml" mathsize="70%" xref="S3.E1.m1.23.23.23.15.15.15.1">C</mtext></ci></apply><apply id="S3.E1.m1.33.33.3.3.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.36.36.6"><csymbol cd="ambiguous" id="S3.E1.m1.33.33.3.3.1.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.36.36.6">superscript</csymbol><ci id="S3.E1.m1.25.25.25.17.17.17.cmml" xref="S3.E1.m1.25.25.25.17.17.17">Z</ci><ci id="S3.E1.m1.26.26.26.18.18.18.1a.cmml" xref="S3.E1.m1.26.26.26.18.18.18.1"><mtext id="S3.E1.m1.26.26.26.18.18.18.1.cmml" mathsize="70%" xref="S3.E1.m1.26.26.26.18.18.18.1">Q</mtext></ci></apply></interval></apply><apply id="S3.E1.m1.29.29.29.21.21.21.1.cmml" xref="S3.E1.m1.29.29.29.21.21.21.1"><ci id="S3.E1.m1.29.29.29.21.21.21.1.1.cmml" xref="S3.E1.m1.29.29.29.21.21.21.1.1">:</ci><cn id="S3.E1.m1.29.29.29.21.21.21.1.2.cmml" type="integer" xref="S3.E1.m1.29.29.29.21.21.21.1.2">1</cn><ci id="S3.E1.m1.29.29.29.21.21.21.1.3.cmml" xref="S3.E1.m1.29.29.29.21.21.21.1.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.36c">\text{ReactionVector}(\mathrm{Z}^{\text{C}},\mathrm{Z}^{\text{Q}})\\
=\text{abs}\left(\text{AttnVec}(\mathrm{Z}^{\text{C}})-\text{AttnVec}(\text{%
concat}(\mathrm{Z}^{\text{C}},\mathrm{Z}^{\text{Q}}))_{1:c}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.36d">start_ROW start_CELL ReactionVector ( roman_Z start_POSTSUPERSCRIPT C end_POSTSUPERSCRIPT , roman_Z start_POSTSUPERSCRIPT Q end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL = abs ( AttnVec ( roman_Z start_POSTSUPERSCRIPT C end_POSTSUPERSCRIPT ) - AttnVec ( concat ( roman_Z start_POSTSUPERSCRIPT C end_POSTSUPERSCRIPT , roman_Z start_POSTSUPERSCRIPT Q end_POSTSUPERSCRIPT ) ) start_POSTSUBSCRIPT 1 : italic_c end_POSTSUBSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.2">where</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{AttnVec}(\mathrm{Z})=\text{Mean}_{col}(\text{AttnMatrix}(Q,K))" class="ltx_Math" display="block" id="S3.E2.m1.4"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mrow id="S3.E2.m1.4.4.3" xref="S3.E2.m1.4.4.3.cmml"><mtext id="S3.E2.m1.4.4.3.2" xref="S3.E2.m1.4.4.3.2a.cmml">AttnVec</mtext><mo id="S3.E2.m1.4.4.3.1" xref="S3.E2.m1.4.4.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.3.3.2" xref="S3.E2.m1.4.4.3.cmml"><mo id="S3.E2.m1.4.4.3.3.2.1" stretchy="false" xref="S3.E2.m1.4.4.3.cmml">(</mo><mi id="S3.E2.m1.1.1" mathvariant="normal" xref="S3.E2.m1.1.1.cmml">Z</mi><mo id="S3.E2.m1.4.4.3.3.2.2" stretchy="false" xref="S3.E2.m1.4.4.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml">=</mo><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.cmml"><msub id="S3.E2.m1.4.4.1.3" xref="S3.E2.m1.4.4.1.3.cmml"><mtext id="S3.E2.m1.4.4.1.3.2" xref="S3.E2.m1.4.4.1.3.2a.cmml">Mean</mtext><mrow id="S3.E2.m1.4.4.1.3.3" xref="S3.E2.m1.4.4.1.3.3.cmml"><mi id="S3.E2.m1.4.4.1.3.3.2" xref="S3.E2.m1.4.4.1.3.3.2.cmml">c</mi><mo id="S3.E2.m1.4.4.1.3.3.1" xref="S3.E2.m1.4.4.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.4.4.1.3.3.3" xref="S3.E2.m1.4.4.1.3.3.3.cmml">o</mi><mo id="S3.E2.m1.4.4.1.3.3.1a" xref="S3.E2.m1.4.4.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.4.4.1.3.3.4" xref="S3.E2.m1.4.4.1.3.3.4.cmml">l</mi></mrow></msub><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mo id="S3.E2.m1.4.4.1.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mtext id="S3.E2.m1.4.4.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.2a.cmml">AttnMatrix</mtext><mo id="S3.E2.m1.4.4.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.3.1.cmml"><mo id="S3.E2.m1.4.4.1.1.1.1.3.2.1" stretchy="false" xref="S3.E2.m1.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">Q</mi><mo id="S3.E2.m1.4.4.1.1.1.1.3.2.2" xref="S3.E2.m1.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">K</mi><mo id="S3.E2.m1.4.4.1.1.1.1.3.2.3" stretchy="false" xref="S3.E2.m1.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.1.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2"></eq><apply id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.3"><times id="S3.E2.m1.4.4.3.1.cmml" xref="S3.E2.m1.4.4.3.1"></times><ci id="S3.E2.m1.4.4.3.2a.cmml" xref="S3.E2.m1.4.4.3.2"><mtext id="S3.E2.m1.4.4.3.2.cmml" xref="S3.E2.m1.4.4.3.2">AttnVec</mtext></ci><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">Z</ci></apply><apply id="S3.E2.m1.4.4.1.cmml" xref="S3.E2.m1.4.4.1"><times id="S3.E2.m1.4.4.1.2.cmml" xref="S3.E2.m1.4.4.1.2"></times><apply id="S3.E2.m1.4.4.1.3.cmml" xref="S3.E2.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.3.1.cmml" xref="S3.E2.m1.4.4.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.3.2a.cmml" xref="S3.E2.m1.4.4.1.3.2"><mtext id="S3.E2.m1.4.4.1.3.2.cmml" xref="S3.E2.m1.4.4.1.3.2">Mean</mtext></ci><apply id="S3.E2.m1.4.4.1.3.3.cmml" xref="S3.E2.m1.4.4.1.3.3"><times id="S3.E2.m1.4.4.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.3.3.1"></times><ci id="S3.E2.m1.4.4.1.3.3.2.cmml" xref="S3.E2.m1.4.4.1.3.3.2">𝑐</ci><ci id="S3.E2.m1.4.4.1.3.3.3.cmml" xref="S3.E2.m1.4.4.1.3.3.3">𝑜</ci><ci id="S3.E2.m1.4.4.1.3.3.4.cmml" xref="S3.E2.m1.4.4.1.3.3.4">𝑙</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1"></times><ci id="S3.E2.m1.4.4.1.1.1.1.2a.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2"><mtext id="S3.E2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2">AttnMatrix</mtext></ci><interval closure="open" id="S3.E2.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.2"><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑄</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐾</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\text{AttnVec}(\mathrm{Z})=\text{Mean}_{col}(\text{AttnMatrix}(Q,K))</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.4d">AttnVec ( roman_Z ) = Mean start_POSTSUBSCRIPT italic_c italic_o italic_l end_POSTSUBSCRIPT ( AttnMatrix ( italic_Q , italic_K ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p2.3"><span class="ltx_text ltx_markedasmath" id="S3.SS1.SSS0.Px2.p2.3.1">AttnMatrix</span> is the dense attention function before multiplying the value projection and <math alttext="Q,K" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.2.m2.2"><semantics id="S3.SS1.SSS0.Px2.p2.2.m2.2a"><mrow id="S3.SS1.SSS0.Px2.p2.2.m2.2.3.2" xref="S3.SS1.SSS0.Px2.p2.2.m2.2.3.1.cmml"><mi id="S3.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1.cmml">Q</mi><mo id="S3.SS1.SSS0.Px2.p2.2.m2.2.3.2.1" xref="S3.SS1.SSS0.Px2.p2.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px2.p2.2.m2.2.2" xref="S3.SS1.SSS0.Px2.p2.2.m2.2.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.2.m2.2b"><list id="S3.SS1.SSS0.Px2.p2.2.m2.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p2.2.m2.2.3.2"><ci id="S3.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1">𝑄</ci><ci id="S3.SS1.SSS0.Px2.p2.2.m2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p2.2.m2.2.2">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.2.m2.2c">Q,K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.2.m2.2d">italic_Q , italic_K</annotation></semantics></math> are the query and key projection of <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p2.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p2.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.3.m3.1d">italic_Z</annotation></semantics></math>, respectively, similar to the description in the “Attention is all you need” paper  <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib26" title="">2023</a>)</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{AttnMatrix}(Q,K)" class="ltx_Math" display="inline" id="S3.E3X.2.1.1.m1.2"><semantics id="S3.E3X.2.1.1.m1.2a"><mrow id="S3.E3X.2.1.1.m1.2.3" xref="S3.E3X.2.1.1.m1.2.3.cmml"><mtext id="S3.E3X.2.1.1.m1.2.3.2" xref="S3.E3X.2.1.1.m1.2.3.2a.cmml">AttnMatrix</mtext><mo id="S3.E3X.2.1.1.m1.2.3.1" xref="S3.E3X.2.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.E3X.2.1.1.m1.2.3.3.2" xref="S3.E3X.2.1.1.m1.2.3.3.1.cmml"><mo id="S3.E3X.2.1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.E3X.2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml">Q</mi><mo id="S3.E3X.2.1.1.m1.2.3.3.2.2" xref="S3.E3X.2.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.2.2" xref="S3.E3X.2.1.1.m1.2.2.cmml">K</mi><mo id="S3.E3X.2.1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.E3X.2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.2b"><apply id="S3.E3X.2.1.1.m1.2.3.cmml" xref="S3.E3X.2.1.1.m1.2.3"><times id="S3.E3X.2.1.1.m1.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.2.3.1"></times><ci id="S3.E3X.2.1.1.m1.2.3.2a.cmml" xref="S3.E3X.2.1.1.m1.2.3.2"><mtext id="S3.E3X.2.1.1.m1.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.2.3.2">AttnMatrix</mtext></ci><interval closure="open" id="S3.E3X.2.1.1.m1.2.3.3.1.cmml" xref="S3.E3X.2.1.1.m1.2.3.3.2"><ci id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">𝑄</ci><ci id="S3.E3X.2.1.1.m1.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.2c">\displaystyle\text{AttnMatrix}(Q,K)</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.2.1.1.m1.2d">AttnMatrix ( italic_Q , italic_K )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d}}\right)" class="ltx_Math" display="inline" id="S3.E3X.3.2.2.m1.1"><semantics id="S3.E3X.3.2.2.m1.1a"><mrow id="S3.E3X.3.2.2.m1.1.2" xref="S3.E3X.3.2.2.m1.1.2.cmml"><mi id="S3.E3X.3.2.2.m1.1.2.2" xref="S3.E3X.3.2.2.m1.1.2.2.cmml"></mi><mo id="S3.E3X.3.2.2.m1.1.2.1" xref="S3.E3X.3.2.2.m1.1.2.1.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.1.2.3" xref="S3.E3X.3.2.2.m1.1.2.3.cmml"><mtext id="S3.E3X.3.2.2.m1.1.2.3.2" xref="S3.E3X.3.2.2.m1.1.2.3.2a.cmml">softmax</mtext><mo id="S3.E3X.3.2.2.m1.1.2.3.1" xref="S3.E3X.3.2.2.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.E3X.3.2.2.m1.1.2.3.3.2" xref="S3.E3X.3.2.2.m1.1.1.cmml"><mo id="S3.E3X.3.2.2.m1.1.2.3.3.2.1" xref="S3.E3X.3.2.2.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.1.1" xref="S3.E3X.3.2.2.m1.1.1.cmml"><mfrac id="S3.E3X.3.2.2.m1.1.1a" xref="S3.E3X.3.2.2.m1.1.1.cmml"><mrow id="S3.E3X.3.2.2.m1.1.1.2" xref="S3.E3X.3.2.2.m1.1.1.2.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.2.2" xref="S3.E3X.3.2.2.m1.1.1.2.2.cmml">Q</mi><mo id="S3.E3X.3.2.2.m1.1.1.2.1" xref="S3.E3X.3.2.2.m1.1.1.2.1.cmml">⁢</mo><msup id="S3.E3X.3.2.2.m1.1.1.2.3" xref="S3.E3X.3.2.2.m1.1.1.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.2.3.2" xref="S3.E3X.3.2.2.m1.1.1.2.3.2.cmml">K</mi><mi id="S3.E3X.3.2.2.m1.1.1.2.3.3" xref="S3.E3X.3.2.2.m1.1.1.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.E3X.3.2.2.m1.1.1.3" xref="S3.E3X.3.2.2.m1.1.1.3.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.3.2" xref="S3.E3X.3.2.2.m1.1.1.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="S3.E3X.3.2.2.m1.1.2.3.3.2.2" xref="S3.E3X.3.2.2.m1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.1b"><apply id="S3.E3X.3.2.2.m1.1.2.cmml" xref="S3.E3X.3.2.2.m1.1.2"><eq id="S3.E3X.3.2.2.m1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.1.2.1"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.1.2.2">absent</csymbol><apply id="S3.E3X.3.2.2.m1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.1.2.3"><times id="S3.E3X.3.2.2.m1.1.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.1.2.3.1"></times><ci id="S3.E3X.3.2.2.m1.1.2.3.2a.cmml" xref="S3.E3X.3.2.2.m1.1.2.3.2"><mtext id="S3.E3X.3.2.2.m1.1.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.1.2.3.2">softmax</mtext></ci><apply id="S3.E3X.3.2.2.m1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.2.3.3.2"><divide id="S3.E3X.3.2.2.m1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.2.3.3.2"></divide><apply id="S3.E3X.3.2.2.m1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.2"><times id="S3.E3X.3.2.2.m1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.1"></times><ci id="S3.E3X.3.2.2.m1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.2">𝑄</ci><apply id="S3.E3X.3.2.2.m1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.1.1.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.3">superscript</csymbol><ci id="S3.E3X.3.2.2.m1.1.1.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.3.2">𝐾</ci><ci id="S3.E3X.3.2.2.m1.1.1.2.3.3.cmml" xref="S3.E3X.3.2.2.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.1.1.3"><root id="S3.E3X.3.2.2.m1.1.1.3a.cmml" xref="S3.E3X.3.2.2.m1.1.1.3"></root><ci id="S3.E3X.3.2.2.m1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.1.1.3.2">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.1c">\displaystyle=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.3.2.2.m1.1d">= softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle Q" class="ltx_Math" display="inline" id="S3.E3Xa.2.1.1.m1.1"><semantics id="S3.E3Xa.2.1.1.m1.1a"><mi id="S3.E3Xa.2.1.1.m1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.1b"><ci id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.1c">\displaystyle Q</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xa.2.1.1.m1.1d">italic_Q</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{Z}\times W^{Q}" class="ltx_Math" display="inline" id="S3.E3Xa.3.2.2.m1.1"><semantics id="S3.E3Xa.3.2.2.m1.1a"><mrow id="S3.E3Xa.3.2.2.m1.1.1" xref="S3.E3Xa.3.2.2.m1.1.1.cmml"><mi id="S3.E3Xa.3.2.2.m1.1.1.2" xref="S3.E3Xa.3.2.2.m1.1.1.2.cmml"></mi><mo id="S3.E3Xa.3.2.2.m1.1.1.1" xref="S3.E3Xa.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S3.E3Xa.3.2.2.m1.1.1.3" xref="S3.E3Xa.3.2.2.m1.1.1.3.cmml"><mi id="S3.E3Xa.3.2.2.m1.1.1.3.2" mathvariant="normal" xref="S3.E3Xa.3.2.2.m1.1.1.3.2.cmml">Z</mi><mo id="S3.E3Xa.3.2.2.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3Xa.3.2.2.m1.1.1.3.1.cmml">×</mo><msup id="S3.E3Xa.3.2.2.m1.1.1.3.3" xref="S3.E3Xa.3.2.2.m1.1.1.3.3.cmml"><mi id="S3.E3Xa.3.2.2.m1.1.1.3.3.2" xref="S3.E3Xa.3.2.2.m1.1.1.3.3.2.cmml">W</mi><mi id="S3.E3Xa.3.2.2.m1.1.1.3.3.3" xref="S3.E3Xa.3.2.2.m1.1.1.3.3.3.cmml">Q</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.3.2.2.m1.1b"><apply id="S3.E3Xa.3.2.2.m1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1"><eq id="S3.E3Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E3Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.2">absent</csymbol><apply id="S3.E3Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.3"><times id="S3.E3Xa.3.2.2.m1.1.1.3.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.3.1"></times><ci id="S3.E3Xa.3.2.2.m1.1.1.3.2.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.3.2">Z</ci><apply id="S3.E3Xa.3.2.2.m1.1.1.3.3.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3Xa.3.2.2.m1.1.1.3.3.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.3.3">superscript</csymbol><ci id="S3.E3Xa.3.2.2.m1.1.1.3.3.2.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.3.3.2">𝑊</ci><ci id="S3.E3Xa.3.2.2.m1.1.1.3.3.3.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.3.2.2.m1.1c">\displaystyle=\mathrm{Z}\times W^{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xa.3.2.2.m1.1d">= roman_Z × italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle K" class="ltx_Math" display="inline" id="S3.E3Xb.2.1.1.m1.1"><semantics id="S3.E3Xb.2.1.1.m1.1a"><mi id="S3.E3Xb.2.1.1.m1.1.1" xref="S3.E3Xb.2.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.E3Xb.2.1.1.m1.1b"><ci id="S3.E3Xb.2.1.1.m1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.2.1.1.m1.1c">\displaystyle K</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xb.2.1.1.m1.1d">italic_K</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{Z}\times W^{K}" class="ltx_Math" display="inline" id="S3.E3Xb.3.2.2.m1.1"><semantics id="S3.E3Xb.3.2.2.m1.1a"><mrow id="S3.E3Xb.3.2.2.m1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.2" xref="S3.E3Xb.3.2.2.m1.1.1.2.cmml"></mi><mo id="S3.E3Xb.3.2.2.m1.1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S3.E3Xb.3.2.2.m1.1.1.3" xref="S3.E3Xb.3.2.2.m1.1.1.3.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.3.2" mathvariant="normal" xref="S3.E3Xb.3.2.2.m1.1.1.3.2.cmml">Z</mi><mo id="S3.E3Xb.3.2.2.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3Xb.3.2.2.m1.1.1.3.1.cmml">×</mo><msup id="S3.E3Xb.3.2.2.m1.1.1.3.3" xref="S3.E3Xb.3.2.2.m1.1.1.3.3.cmml"><mi id="S3.E3Xb.3.2.2.m1.1.1.3.3.2" xref="S3.E3Xb.3.2.2.m1.1.1.3.3.2.cmml">W</mi><mi id="S3.E3Xb.3.2.2.m1.1.1.3.3.3" xref="S3.E3Xb.3.2.2.m1.1.1.3.3.3.cmml">K</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xb.3.2.2.m1.1b"><apply id="S3.E3Xb.3.2.2.m1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1"><eq id="S3.E3Xb.3.2.2.m1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E3Xb.3.2.2.m1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.2">absent</csymbol><apply id="S3.E3Xb.3.2.2.m1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.3"><times id="S3.E3Xb.3.2.2.m1.1.1.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.3.1"></times><ci id="S3.E3Xb.3.2.2.m1.1.1.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.3.2">Z</ci><apply id="S3.E3Xb.3.2.2.m1.1.1.3.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.1.1.3.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.3.3">superscript</csymbol><ci id="S3.E3Xb.3.2.2.m1.1.1.3.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.3.3.2">𝑊</ci><ci id="S3.E3Xb.3.2.2.m1.1.1.3.3.3.cmml" xref="S3.E3Xb.3.2.2.m1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.3.2.2.m1.1c">\displaystyle=\mathrm{Z}\times W^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xb.3.2.2.m1.1d">= roman_Z × italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p3">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p3.4"><math alttext="\text{Mean}_{col}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p3.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p3.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.cmml"><mtext id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2a.cmml">Mean</mtext><mrow id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.2" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.2.cmml">c</mi><mo id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.1" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.3" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.3.cmml">o</mi><mo id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.1a" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.4" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2a.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2"><mtext id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2">Mean</mtext></ci><apply id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3"><times id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.2">𝑐</ci><ci id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.3">𝑜</ci><ci id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.4.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.1.m1.1c">\text{Mean}_{col}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.1.m1.1d">Mean start_POSTSUBSCRIPT italic_c italic_o italic_l end_POSTSUBSCRIPT</annotation></semantics></math> takes the attention matrix and returns a per-column mean vector (note the subscription <math alttext="1:c" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.2.m2.1"><semantics id="S3.SS1.SSS0.Px2.p3.2.m2.1a"><mrow id="S3.SS1.SSS0.Px2.p3.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.cmml"><mn id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml">1</mn><mo id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.1.cmml">:</mo><mi id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1"><ci id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.1">:</ci><cn id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml" type="integer" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.2">1</cn><ci id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.2.m2.1c">1:c</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.2.m2.1d">1 : italic_c</annotation></semantics></math> to indicate truncation from <math alttext="1" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p3.3.m3.1a"><mn id="S3.SS1.SSS0.Px2.p3.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.3.m3.1b"><cn id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.3.m3.1d">1</annotation></semantics></math> to <math alttext="c" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.4.m4.1"><semantics id="S3.SS1.SSS0.Px2.p3.4.m4.1a"><mi id="S3.SS1.SSS0.Px2.p3.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.4.m4.1b"><ci id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.4.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.4.m4.1d">italic_c</annotation></semantics></math>-th column):</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Mean}_{col}([a_{ij}]_{d\times n})_{1:c}" class="ltx_Math" display="inline" id="S3.E4X.2.1.1.m1.1"><semantics id="S3.E4X.2.1.1.m1.1a"><mrow id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml"><msub id="S3.E4X.2.1.1.m1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.3.cmml"><mtext id="S3.E4X.2.1.1.m1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.3.2a.cmml">Mean</mtext><mrow id="S3.E4X.2.1.1.m1.1.1.3.3" xref="S3.E4X.2.1.1.m1.1.1.3.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.3.3.2" xref="S3.E4X.2.1.1.m1.1.1.3.3.2.cmml">c</mi><mo id="S3.E4X.2.1.1.m1.1.1.3.3.1" xref="S3.E4X.2.1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E4X.2.1.1.m1.1.1.3.3.3" xref="S3.E4X.2.1.1.m1.1.1.3.3.3.cmml">o</mi><mo id="S3.E4X.2.1.1.m1.1.1.3.3.1a" xref="S3.E4X.2.1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E4X.2.1.1.m1.1.1.3.3.4" xref="S3.E4X.2.1.1.m1.1.1.3.3.4.cmml">l</mi></mrow></msub><mo id="S3.E4X.2.1.1.m1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.2.cmml">⁢</mo><msub id="S3.E4X.2.1.1.m1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">d</mi><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml">×</mo><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E4X.2.1.1.m1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.3.cmml"><mn id="S3.E4X.2.1.1.m1.1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.1.3.2.cmml">1</mn><mo id="S3.E4X.2.1.1.m1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E4X.2.1.1.m1.1.1.1.3.1.cmml">:</mo><mi id="S3.E4X.2.1.1.m1.1.1.1.3.3" xref="S3.E4X.2.1.1.m1.1.1.1.3.3.cmml">c</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b"><apply id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1"><times id="S3.E4X.2.1.1.m1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2"></times><apply id="S3.E4X.2.1.1.m1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.3.2a.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.2"><mtext id="S3.E4X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.2">Mean</mtext></ci><apply id="S3.E4X.2.1.1.m1.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.3"><times id="S3.E4X.2.1.1.m1.1.1.3.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.3.1"></times><ci id="S3.E4X.2.1.1.m1.1.1.3.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.3.2">𝑐</ci><ci id="S3.E4X.2.1.1.m1.1.1.3.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.3.3">𝑜</ci><ci id="S3.E4X.2.1.1.m1.1.1.3.3.4.cmml" xref="S3.E4X.2.1.1.m1.1.1.3.3.4">𝑙</ci></apply></apply><apply id="S3.E4X.2.1.1.m1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1">subscript</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3"><times id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S3.E4X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.3"><ci id="S3.E4X.2.1.1.m1.1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.3.1">:</ci><cn id="S3.E4X.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E4X.2.1.1.m1.1.1.1.3.2">1</cn><ci id="S3.E4X.2.1.1.m1.1.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">\displaystyle\text{Mean}_{col}([a_{ij}]_{d\times n})_{1:c}</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.2.1.1.m1.1d">Mean start_POSTSUBSCRIPT italic_c italic_o italic_l end_POSTSUBSCRIPT ( [ italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_d × italic_n end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT 1 : italic_c end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{d}\left(\sum_{i=1}^{d}a_{i1},\sum_{i=1}^{d}a_{i2},...,%
\sum_{i=1}^{d}a_{ic}\right)" class="ltx_Math" display="inline" id="S3.E4X.3.2.2.m1.4"><semantics id="S3.E4X.3.2.2.m1.4a"><mrow id="S3.E4X.3.2.2.m1.4.4" xref="S3.E4X.3.2.2.m1.4.4.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.5" xref="S3.E4X.3.2.2.m1.4.4.5.cmml"></mi><mo id="S3.E4X.3.2.2.m1.4.4.4" xref="S3.E4X.3.2.2.m1.4.4.4.cmml">=</mo><mrow id="S3.E4X.3.2.2.m1.4.4.3" xref="S3.E4X.3.2.2.m1.4.4.3.cmml"><mstyle displaystyle="true" id="S3.E4X.3.2.2.m1.4.4.3.5" xref="S3.E4X.3.2.2.m1.4.4.3.5.cmml"><mfrac id="S3.E4X.3.2.2.m1.4.4.3.5a" xref="S3.E4X.3.2.2.m1.4.4.3.5.cmml"><mn id="S3.E4X.3.2.2.m1.4.4.3.5.2" xref="S3.E4X.3.2.2.m1.4.4.3.5.2.cmml">1</mn><mi id="S3.E4X.3.2.2.m1.4.4.3.5.3" xref="S3.E4X.3.2.2.m1.4.4.3.5.3.cmml">d</mi></mfrac></mstyle><mo id="S3.E4X.3.2.2.m1.4.4.3.4" xref="S3.E4X.3.2.2.m1.4.4.3.4.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.4.4.3.3.3" xref="S3.E4X.3.2.2.m1.4.4.3.3.4.cmml"><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.4" xref="S3.E4X.3.2.2.m1.4.4.3.3.4.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><munderover id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1a" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml">d</mi></munderover></mstyle><msub id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.2.cmml">a</mi><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.1.cmml">⁢</mo><mn id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.5" xref="S3.E4X.3.2.2.m1.4.4.3.3.4.cmml">,</mo><mrow id="S3.E4X.3.2.2.m1.3.3.2.2.2.2" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.cmml"><munderover id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1a" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.cmml"><mo id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.2" movablelimits="false" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.2" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.2.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.1" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.3" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.3" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.3.cmml">d</mi></munderover></mstyle><msub id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.cmml"><mi id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.2" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.2.cmml">a</mi><mrow id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.2" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.1" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.1.cmml">⁢</mo><mn id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.3" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.3.cmml">2</mn></mrow></msub></mrow><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.6" xref="S3.E4X.3.2.2.m1.4.4.3.3.4.cmml">,</mo><mi id="S3.E4X.3.2.2.m1.1.1" mathvariant="normal" xref="S3.E4X.3.2.2.m1.1.1.cmml">…</mi><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.7" xref="S3.E4X.3.2.2.m1.4.4.3.3.4.cmml">,</mo><mrow id="S3.E4X.3.2.2.m1.4.4.3.3.3.3" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.cmml"><mstyle displaystyle="true" id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.cmml"><munderover id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1a" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.cmml"><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.2" movablelimits="false" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.2" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.1" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.3" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.3" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.3.cmml">d</mi></munderover></mstyle><msub id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.2" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.2.cmml">a</mi><mrow id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.2" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.1" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.3" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.3.cmml">c</mi></mrow></msub></mrow><mo id="S3.E4X.3.2.2.m1.4.4.3.3.3.8" xref="S3.E4X.3.2.2.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.4b"><apply id="S3.E4X.3.2.2.m1.4.4.cmml" xref="S3.E4X.3.2.2.m1.4.4"><eq id="S3.E4X.3.2.2.m1.4.4.4.cmml" xref="S3.E4X.3.2.2.m1.4.4.4"></eq><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.4.4.5.cmml" xref="S3.E4X.3.2.2.m1.4.4.5">absent</csymbol><apply id="S3.E4X.3.2.2.m1.4.4.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.3"><times id="S3.E4X.3.2.2.m1.4.4.3.4.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.4"></times><apply id="S3.E4X.3.2.2.m1.4.4.3.5.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.5"><divide id="S3.E4X.3.2.2.m1.4.4.3.5.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.5"></divide><cn id="S3.E4X.3.2.2.m1.4.4.3.5.2.cmml" type="integer" xref="S3.E4X.3.2.2.m1.4.4.3.5.2">1</cn><ci id="S3.E4X.3.2.2.m1.4.4.3.5.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.5.3">𝑑</ci></apply><vector id="S3.E4X.3.2.2.m1.4.4.3.3.4.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3"><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1"><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1">subscript</csymbol><sum id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.2"></sum><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3"><eq id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.1"></eq><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3">𝑑</ci></apply><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.2">𝑎</ci><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3"><times id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.1"></times><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.3.3">1</cn></apply></apply></apply><apply id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2"><apply id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1">superscript</csymbol><apply id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1">subscript</csymbol><sum id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.2"></sum><apply id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3"><eq id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.1"></eq><ci id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.2">𝑖</ci><cn id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.1.3">𝑑</ci></apply><apply id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.2">𝑎</ci><apply id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3"><times id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.1"></times><ci id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.2">𝑖</ci><cn id="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.3.3.2.2.2.2.2.3.3">2</cn></apply></apply></apply><ci id="S3.E4X.3.2.2.m1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1">…</ci><apply id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3"><apply id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1">superscript</csymbol><apply id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1">subscript</csymbol><sum id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.2"></sum><apply id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3"><eq id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.1"></eq><ci id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.2">𝑖</ci><cn id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.1.3">𝑑</ci></apply><apply id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.2">𝑎</ci><apply id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3"><times id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.1"></times><ci id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.2">𝑖</ci><ci id="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.3.3.3.3.2.3.3">𝑐</ci></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.4c">\displaystyle=\frac{1}{d}\left(\sum_{i=1}^{d}a_{i1},\sum_{i=1}^{d}a_{i2},...,%
\sum_{i=1}^{d}a_{ic}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.3.2.2.m1.4d">= divide start_ARG 1 end_ARG start_ARG italic_d end_ARG ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT , ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i 2 end_POSTSUBSCRIPT , … , ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i italic_c end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{d}\left(\sum_{i=1}^{d}a_{ij}\right)_{j=1}^{c}" class="ltx_Math" display="inline" id="S3.E4Xa.2.1.1.m1.1"><semantics id="S3.E4Xa.2.1.1.m1.1a"><mrow id="S3.E4Xa.2.1.1.m1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="S3.E4Xa.2.1.1.m1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4Xa.2.1.1.m1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.3.cmml"><mfrac id="S3.E4Xa.2.1.1.m1.1.1.1.3a" xref="S3.E4Xa.2.1.1.m1.1.1.1.3.cmml"><mn id="S3.E4Xa.2.1.1.m1.1.1.1.3.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E4Xa.2.1.1.m1.1.1.1.3.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.3.3.cmml">d</mi></mfrac></mstyle><mo id="S3.E4Xa.2.1.1.m1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E4Xa.2.1.1.m1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1a" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">d</mi></munderover></mstyle><msub id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml">c</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.2.1.1.m1.1b"><apply id="S3.E4Xa.2.1.1.m1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1"><eq id="S3.E4Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E4Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"><times id="S3.E4Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.2"></times><apply id="S3.E4Xa.2.1.1.m1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.3"><divide id="S3.E4Xa.2.1.1.m1.1.1.1.3.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.3"></divide><cn id="S3.E4Xa.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E4Xa.2.1.1.m1.1.1.1.3.2">1</cn><ci id="S3.E4Xa.2.1.1.m1.1.1.1.3.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.3.3">𝑑</ci></apply><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1"><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3"><eq id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.1"></eq><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.2">𝑗</ci><cn id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.1c">\displaystyle=\frac{1}{d}\left(\sum_{i=1}^{d}a_{ij}\right)_{j=1}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.E4Xa.2.1.1.m1.1d">= divide start_ARG 1 end_ARG start_ARG italic_d end_ARG ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p4">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p4.1">For multi-head attention, the reaction vector is a mean across heads:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Mean}_{col,heads}\left([a_{ij}^{h}]_{d\times n}\right)_{1:c}" class="ltx_Math" display="inline" id="S3.E5X.2.1.1.m1.3"><semantics id="S3.E5X.2.1.1.m1.3a"><mrow id="S3.E5X.2.1.1.m1.3.3" xref="S3.E5X.2.1.1.m1.3.3.cmml"><msub id="S3.E5X.2.1.1.m1.3.3.3" xref="S3.E5X.2.1.1.m1.3.3.3.cmml"><mtext id="S3.E5X.2.1.1.m1.3.3.3.2" xref="S3.E5X.2.1.1.m1.3.3.3.2a.cmml">Mean</mtext><mrow id="S3.E5X.2.1.1.m1.2.2.2.2" xref="S3.E5X.2.1.1.m1.2.2.2.3.cmml"><mrow id="S3.E5X.2.1.1.m1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S3.E5X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E5X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.E5X.2.1.1.m1.1.1.1.1.1.1a" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E5X.2.1.1.m1.1.1.1.1.1.4" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.4.cmml">l</mi></mrow><mo id="S3.E5X.2.1.1.m1.2.2.2.2.3" xref="S3.E5X.2.1.1.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E5X.2.1.1.m1.2.2.2.2.2" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.E5X.2.1.1.m1.2.2.2.2.2.2" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.2.cmml">h</mi><mo id="S3.E5X.2.1.1.m1.2.2.2.2.2.1" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E5X.2.1.1.m1.2.2.2.2.2.3" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.3.cmml">e</mi><mo id="S3.E5X.2.1.1.m1.2.2.2.2.2.1a" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E5X.2.1.1.m1.2.2.2.2.2.4" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.4.cmml">a</mi><mo id="S3.E5X.2.1.1.m1.2.2.2.2.2.1b" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E5X.2.1.1.m1.2.2.2.2.2.5" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.5.cmml">d</mi><mo id="S3.E5X.2.1.1.m1.2.2.2.2.2.1c" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E5X.2.1.1.m1.2.2.2.2.2.6" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.6.cmml">s</mi></mrow></mrow></msub><mo id="S3.E5X.2.1.1.m1.3.3.2" xref="S3.E5X.2.1.1.m1.3.3.2.cmml">⁢</mo><msub id="S3.E5X.2.1.1.m1.3.3.1" xref="S3.E5X.2.1.1.m1.3.3.1.cmml"><mrow id="S3.E5X.2.1.1.m1.3.3.1.1.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.cmml"><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.cmml">(</mo><msub id="S3.E5X.2.1.1.m1.3.3.1.1.1.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><msubsup id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.1" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow><mi id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">h</mi></msubsup><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.2" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.2.cmml">d</mi><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml">×</mo><mi id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E5X.2.1.1.m1.3.3.1.1.1.3" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E5X.2.1.1.m1.3.3.1.3" xref="S3.E5X.2.1.1.m1.3.3.1.3.cmml"><mn id="S3.E5X.2.1.1.m1.3.3.1.3.2" xref="S3.E5X.2.1.1.m1.3.3.1.3.2.cmml">1</mn><mo id="S3.E5X.2.1.1.m1.3.3.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E5X.2.1.1.m1.3.3.1.3.1.cmml">:</mo><mi id="S3.E5X.2.1.1.m1.3.3.1.3.3" xref="S3.E5X.2.1.1.m1.3.3.1.3.3.cmml">c</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.3b"><apply id="S3.E5X.2.1.1.m1.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3"><times id="S3.E5X.2.1.1.m1.3.3.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.2"></times><apply id="S3.E5X.2.1.1.m1.3.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.3.3.3.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.3">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.3.3.3.2a.cmml" xref="S3.E5X.2.1.1.m1.3.3.3.2"><mtext id="S3.E5X.2.1.1.m1.3.3.3.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.3.2">Mean</mtext></ci><list id="S3.E5X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2"><apply id="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1"><times id="S3.E5X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.1"></times><ci id="S3.E5X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.2">𝑐</ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.3">𝑜</ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.1.4.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.4">𝑙</ci></apply><apply id="S3.E5X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2.2"><times id="S3.E5X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.1"></times><ci id="S3.E5X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.2">ℎ</ci><ci id="S3.E5X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.3">𝑒</ci><ci id="S3.E5X.2.1.1.m1.2.2.2.2.2.4.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.4">𝑎</ci><ci id="S3.E5X.2.1.1.m1.2.2.2.2.2.5.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.5">𝑑</ci><ci id="S3.E5X.2.1.1.m1.2.2.2.2.2.6.cmml" xref="S3.E5X.2.1.1.m1.2.2.2.2.2.6">𝑠</ci></apply></list></apply><apply id="S3.E5X.2.1.1.m1.3.3.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.3.3.1.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1">subscript</csymbol><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1">subscript</csymbol><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2">𝑎</ci><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3"><times id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><ci id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">ℎ</ci></apply></apply><apply id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3"><times id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.1"></times><ci id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.2">𝑑</ci><ci id="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S3.E5X.2.1.1.m1.3.3.1.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.3"><ci id="S3.E5X.2.1.1.m1.3.3.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.3.1">:</ci><cn id="S3.E5X.2.1.1.m1.3.3.1.3.2.cmml" type="integer" xref="S3.E5X.2.1.1.m1.3.3.1.3.2">1</cn><ci id="S3.E5X.2.1.1.m1.3.3.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.3c">\displaystyle\text{Mean}_{col,heads}\left([a_{ij}^{h}]_{d\times n}\right)_{1:c}</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.2.1.1.m1.3d">Mean start_POSTSUBSCRIPT italic_c italic_o italic_l , italic_h italic_e italic_a italic_d italic_s end_POSTSUBSCRIPT ( [ italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ] start_POSTSUBSCRIPT italic_d × italic_n end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT 1 : italic_c end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{H}\sum_{h=1}^{H}\left(\frac{1}{d}\sum_{i=1}^{d}a_{ij}^{%
h}\right)_{j=1}^{c}" class="ltx_Math" display="inline" id="S3.E5X.3.2.2.m1.1"><semantics id="S3.E5X.3.2.2.m1.1a"><mrow id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E5X.3.2.2.m1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.cmml"><mfrac id="S3.E5X.3.2.2.m1.1.1.1.3a" xref="S3.E5X.3.2.2.m1.1.1.1.3.cmml"><mn id="S3.E5X.3.2.2.m1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E5X.3.2.2.m1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.3.cmml">H</mi></mfrac></mstyle><mo id="S3.E5X.3.2.2.m1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml"><munderover id="S3.E5X.3.2.2.m1.1.1.1.1.2a" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml"><mo id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.2.cmml">h</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5X.3.2.2.m1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.3.cmml">H</mi></munderover></mstyle><msubsup id="S3.E5X.3.2.2.m1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mfrac id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">1</mn><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">d</mi></mfrac></mstyle><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml"><munderover id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.3.cmml">d</mi></munderover></mstyle><msubsup id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">a</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml">j</mi></mrow><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">h</mi></msubsup></mrow></mrow><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.cmml">c</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.1b"><apply id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1"><eq id="S3.E5X.3.2.2.m1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"><times id="S3.E5X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.2"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3"><divide id="S3.E5X.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3"></divide><cn id="S3.E5X.3.2.2.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E5X.3.2.2.m1.1.1.1.3.2">1</cn><ci id="S3.E5X.3.2.2.m1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3.3">𝐻</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1"><apply id="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3"><eq id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.2">ℎ</ci><cn id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.3">𝐻</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2"><divide id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2"></divide><cn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2">1</cn><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3"><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.3">𝑑</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑎</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.3">𝑗</ci></apply></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3">ℎ</ci></apply></apply></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3"><eq id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.1"></eq><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.2">𝑗</ci><cn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle=\frac{1}{H}\sum_{h=1}^{H}\left(\frac{1}{d}\sum_{i=1}^{d}a_{ij}^{%
h}\right)_{j=1}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.3.2.2.m1.1d">= divide start_ARG 1 end_ARG start_ARG italic_H end_ARG ∑ start_POSTSUBSCRIPT italic_h = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_d end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{H}\left(\sum_{h=1}^{H}\frac{1}{d}\sum_{i=1}^{d}a_{ij}^{%
h}\right)_{j=1}^{c}" class="ltx_Math" display="inline" id="S3.E5Xa.2.1.1.m1.1"><semantics id="S3.E5Xa.2.1.1.m1.1a"><mrow id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="S3.E5Xa.2.1.1.m1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E5Xa.2.1.1.m1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.3.cmml"><mfrac id="S3.E5Xa.2.1.1.m1.1.1.1.3a" xref="S3.E5Xa.2.1.1.m1.1.1.1.3.cmml"><mn id="S3.E5Xa.2.1.1.m1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E5Xa.2.1.1.m1.1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.3.3.cmml">H</mi></mfrac></mstyle><mo id="S3.E5Xa.2.1.1.m1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E5Xa.2.1.1.m1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">H</mi></munderover></mstyle><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mfrac id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">1</mn><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">d</mi></mfrac></mstyle><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mstyle displaystyle="true" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml"><munderover id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.2" movablelimits="false" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.3.cmml">d</mi></munderover></mstyle><msubsup id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml">a</mi><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.2.cmml">i</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.3.cmml">j</mi></mrow><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">h</mi></msubsup></mrow></mrow></mrow><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.cmml">c</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><apply id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1"><eq id="S3.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1"><times id="S3.E5Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.2"></times><apply id="S3.E5Xa.2.1.1.m1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.3"><divide id="S3.E5Xa.2.1.1.m1.1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.3"></divide><cn id="S3.E5Xa.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.1.3.2">1</cn><ci id="S3.E5Xa.2.1.1.m1.1.1.1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.3.3">𝐻</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><cn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝐻</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2"><divide id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2"></divide><cn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2">1</cn><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑑</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1">subscript</csymbol><sum id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.2"></sum><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3"><eq id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.1"></eq><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.2">𝑖</ci><cn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.3.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.3">𝑑</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.2">𝑎</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.2">𝑖</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.2.3.3">𝑗</ci></apply></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.3">ℎ</ci></apply></apply></apply></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3"><eq id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.1"></eq><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.2">𝑗</ci><cn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle=\frac{1}{H}\left(\sum_{h=1}^{H}\frac{1}{d}\sum_{i=1}^{d}a_{ij}^{%
h}\right)_{j=1}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.E5Xa.2.1.1.m1.1d">= divide start_ARG 1 end_ARG start_ARG italic_H end_ARG ( ∑ start_POSTSUBSCRIPT italic_h = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_d end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Reaction Score</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px3.p1.1">Given the reaction vector, we define the <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS0.Px3.p1.1.1">reaction score (rs)</span> as follows for a vector slice represented with left-right index, <math alttext="[l,r)" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px3.p1.1.m1.2"><semantics id="S3.SS1.SSS0.Px3.p1.1.m1.2a"><mrow id="S3.SS1.SSS0.Px3.p1.1.m1.2.3.2" xref="S3.SS1.SSS0.Px3.p1.1.m1.2.3.1.cmml"><mo id="S3.SS1.SSS0.Px3.p1.1.m1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px3.p1.1.m1.2.3.1.cmml">[</mo><mi id="S3.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">l</mi><mo id="S3.SS1.SSS0.Px3.p1.1.m1.2.3.2.2" xref="S3.SS1.SSS0.Px3.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px3.p1.1.m1.2.2" xref="S3.SS1.SSS0.Px3.p1.1.m1.2.2.cmml">r</mi><mo id="S3.SS1.SSS0.Px3.p1.1.m1.2.3.2.3" stretchy="false" xref="S3.SS1.SSS0.Px3.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px3.p1.1.m1.2b"><interval closure="closed-open" id="S3.SS1.SSS0.Px3.p1.1.m1.2.3.1.cmml" xref="S3.SS1.SSS0.Px3.p1.1.m1.2.3.2"><ci id="S3.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px3.p1.1.m1.1.1">𝑙</ci><ci id="S3.SS1.SSS0.Px3.p1.1.m1.2.2.cmml" xref="S3.SS1.SSS0.Px3.p1.1.m1.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px3.p1.1.m1.2c">[l,r)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px3.p1.1.m1.2d">[ italic_l , italic_r )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{ReactionScore}(\text{ReactionVector},l,r)\\
=\text{avg}(\text{ReactionVector}[l:r])" class="ltx_math_unparsed" display="block" id="S3.E6.m1.18"><semantics id="S3.E6.m1.18a"><mtable displaystyle="true" id="S3.E6.m1.18.18" rowspacing="0pt"><mtr id="S3.E6.m1.18.18a"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.18.18b"><mrow id="S3.E6.m1.8.8.8.8.8"><mtext id="S3.E6.m1.1.1.1.1.1.1">ReactionScore</mtext><mo id="S3.E6.m1.8.8.8.8.8.9">⁢</mo><mrow id="S3.E6.m1.8.8.8.8.8.10"><mo id="S3.E6.m1.2.2.2.2.2.2" stretchy="false">(</mo><mtext id="S3.E6.m1.3.3.3.3.3.3">ReactionVector</mtext><mo id="S3.E6.m1.4.4.4.4.4.4">,</mo><mi id="S3.E6.m1.5.5.5.5.5.5">l</mi><mo id="S3.E6.m1.6.6.6.6.6.6">,</mo><mi id="S3.E6.m1.7.7.7.7.7.7">r</mi><mo id="S3.E6.m1.8.8.8.8.8.8" stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.18.18c"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.18.18d"><mrow id="S3.E6.m1.18.18.18.10.10"><mo id="S3.E6.m1.9.9.9.1.1.1">=</mo><mtext id="S3.E6.m1.10.10.10.2.2.2">avg</mtext><mrow id="S3.E6.m1.18.18.18.10.10.11"><mo id="S3.E6.m1.11.11.11.3.3.3" stretchy="false">(</mo><mtext id="S3.E6.m1.12.12.12.4.4.4">ReactionVector</mtext><mrow id="S3.E6.m1.18.18.18.10.10.11.1"><mo id="S3.E6.m1.13.13.13.5.5.5" stretchy="false">[</mo><mi id="S3.E6.m1.14.14.14.6.6.6">l</mi><mo id="S3.E6.m1.15.15.15.7.7.7" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.E6.m1.16.16.16.8.8.8">r</mi><mo id="S3.E6.m1.17.17.17.9.9.9" stretchy="false">]</mo></mrow><mo id="S3.E6.m1.18.18.18.10.10.10" stretchy="false">)</mo></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E6.m1.18b">\text{ReactionScore}(\text{ReactionVector},l,r)\\
=\text{avg}(\text{ReactionVector}[l:r])</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.18c">start_ROW start_CELL ReactionScore ( ReactionVector , italic_l , italic_r ) end_CELL end_ROW start_ROW start_CELL = avg ( ReactionVector [ italic_l : italic_r ] ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_table" id="S3.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.1.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.1.2">ID</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.1.1.1.3">Source</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S3.T1.1.1.1.4">Avg # Tokens</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.1.5">Metric</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.6"># Data</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.2.2">
<td class="ltx_td ltx_border_r" id="S3.T1.1.2.2.1"></td>
<td class="ltx_td ltx_border_r" id="S3.T1.1.2.2.2"></td>
<td class="ltx_td ltx_border_r" id="S3.T1.1.2.2.3"></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.2.2.4">Llama2</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.2.2.5">Llama3</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.2.2.6">Mistral</td>
<td class="ltx_td ltx_border_r" id="S3.T1.1.2.2.7"></td>
<td class="ltx_td" id="S3.T1.1.2.2.8"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="8" id="S3.T1.1.3.3.1">Single-Document QA</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.1.4.4.1">NarrativeQA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.4.4.2">1-1</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.1.4.4.3">Literature, Film</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.1.4.4.4">35937</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.1.4.4.5">29777</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.1.4.4.6">35937</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.4.4.7">F1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.4.8">200</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.1.5.5.1">Qasper</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.5.5.2">1-2</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.1.5.5.3">Science</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.5.5.4">5603</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.5.5.5">4922</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.5.5.6">5517</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.5.5.7">F1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.5.8">200</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.1.6.6.1">MultiFieldQA-en</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.6.6.2">1-3</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.1.6.6.3">Multi-field</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.6.6.4">8046</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.6.6.5">6889</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.6.6.6">7877</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.6.6.7">F1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.6.6.8">150</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="8" id="S3.T1.1.7.7.1">Multi-Document QA</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.1.8.8.1">HotpotQA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.8.8.2">2-1</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.1.8.8.3">Wikipedia</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.1.8.8.4">15244</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.1.8.8.5">12780</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T1.1.8.8.6">14890</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.8.8.7">F1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.8.8.8">200</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.1.9.9.1">2WikiMultihopQA</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.9.9.2">2-2</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.1.9.9.3">Wikipedia</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.9.9.4">8381</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.9.9.5">7096</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S3.T1.1.9.9.6">8281</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.9.9.7">F1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.9.9.8">200</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S3.T1.1.10.10.1">MuSiQue</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.1.10.10.2">2-3</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S3.T1.1.10.10.3">Wikipedia</td>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="S3.T1.1.10.10.4">18459</td>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="S3.T1.1.10.10.5">15544</td>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="S3.T1.1.10.10.6">18069</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.1.10.10.7">F1</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.1.10.10.8">200</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Evaluated dataset details.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Problem Statement</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px4.p1.1">We define the retrieval task as finding a set of non-overlapping chunks <math alttext="\mathit{S}=\{(l_{i},r_{i})\mid 0\leq l_{i}\leq r_{i}\leq|\mathrm{Z}^{\text{%
ctxt}}|,\,r_{i}\leq l_{i+1}\}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px4.p1.1.m1.2"><semantics id="S3.SS1.SSS0.Px4.p1.1.m1.2a"><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.4" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.4.cmml">S</mi><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.3.cmml"><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.3.cmml"><mo id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.4" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.3.cmml">)</mo></mrow><mo fence="true" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.3.1.cmml">∣</mo><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.3.cmml"><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.cmml"><mn id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.3.cmml">0</mn><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.4" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.4.cmml">≤</mo><msub id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.2.cmml">l</mi><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.6" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.6.cmml">≤</mo><msub id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.8" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.8.cmml">≤</mo><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.2.1.cmml">|</mo><msup id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.2" mathvariant="normal" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.2.cmml">Z</mi><mtext id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.3a.cmml">ctxt</mtext></msup><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.3" rspace="0.337em" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.cmml"><msub id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.1" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.1.cmml">≤</mo><msub id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.2.cmml">l</mi><mrow id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.cmml"><mi id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.2" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.1" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.3" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px4.p1.1.m1.2b"><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2"><eq id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.3"></eq><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.4.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.4">𝑆</ci><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2"><csymbol cd="latexml" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2"><apply id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.3a.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1"><and id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1a.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1"></and><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1b.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1"><leq id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.4.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.4"></leq><cn id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.3">0</cn><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5">subscript</csymbol><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.2">𝑙</ci><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1c.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1"><leq id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.6.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.6"></leq><share href="https://arxiv.org/html/2409.13695v1#S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.5.cmml" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1d.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1"></share><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7">subscript</csymbol><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.2">𝑟</ci><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1e.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1"><leq id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.8.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.8"></leq><share href="https://arxiv.org/html/2409.13695v1#S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.7.cmml" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1f.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1"></share><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1"><abs id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.2"></abs><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.2">Z</ci><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.3"><mtext id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.1.1.1.1.1.3">ctxt</mtext></ci></apply></apply></apply></apply><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2"><leq id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.1"></leq><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.2">𝑟</ci><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.2">𝑙</ci><apply id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3"><plus id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.1.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.1"></plus><ci id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.2.cmml" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.2">𝑖</ci><cn id="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px4.p1.1.m1.2.2.2.2.2.2.2.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px4.p1.1.m1.2c">\mathit{S}=\{(l_{i},r_{i})\mid 0\leq l_{i}\leq r_{i}\leq|\mathrm{Z}^{\text{%
ctxt}}|,\,r_{i}\leq l_{i+1}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px4.p1.1.m1.2d">italic_S = { ( italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∣ 0 ≤ italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≤ italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≤ | roman_Z start_POSTSUPERSCRIPT ctxt end_POSTSUPERSCRIPT | , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≤ italic_l start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT }</annotation></semantics></math>, such that</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{argmax}_{\mathit{S}}\,\text{AnsQuality}(\text{LLMInference}(\text{concat%
}(\mathit{S},q)))" class="ltx_Math" display="block" id="S3.E7.m1.16"><semantics id="S3.E7.m1.16a"><mtable displaystyle="true" id="S3.E7.m1.16.16.2" xref="S3.E7.m1.15.15.1.cmml"><mtr id="S3.E7.m1.16.16.2a" xref="S3.E7.m1.15.15.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.16.16.2b" xref="S3.E7.m1.15.15.1.cmml"><mrow id="S3.E7.m1.16.16.2.15.15.15" xref="S3.E7.m1.15.15.1.cmml"><msub id="S3.E7.m1.16.16.2.15.15.15.17" xref="S3.E7.m1.15.15.1.cmml"><mtext id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1a.cmml">argmax</mtext><mi id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">S</mi></msub><mo id="S3.E7.m1.16.16.2.15.15.15.16" lspace="0.170em" xref="S3.E7.m1.15.15.1.2.cmml">⁢</mo><mtext id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3a.cmml">AnsQuality</mtext><mo id="S3.E7.m1.16.16.2.15.15.15.16a" xref="S3.E7.m1.15.15.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.16.16.2.15.15.15.15.1" xref="S3.E7.m1.15.15.1.cmml"><mo id="S3.E7.m1.4.4.4.4.4.4" stretchy="false" xref="S3.E7.m1.15.15.1.2.cmml">(</mo><mrow id="S3.E7.m1.16.16.2.15.15.15.15.1.1" xref="S3.E7.m1.15.15.1.cmml"><mtext id="S3.E7.m1.5.5.5.5.5.5" xref="S3.E7.m1.5.5.5.5.5.5a.cmml">LLMInference</mtext><mo id="S3.E7.m1.16.16.2.15.15.15.15.1.1.2" xref="S3.E7.m1.15.15.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.16.16.2.15.15.15.15.1.1.1.1" xref="S3.E7.m1.15.15.1.cmml"><mo id="S3.E7.m1.6.6.6.6.6.6" stretchy="false" xref="S3.E7.m1.15.15.1.2.cmml">(</mo><mrow id="S3.E7.m1.16.16.2.15.15.15.15.1.1.1.1.1" xref="S3.E7.m1.15.15.1.cmml"><mtext id="S3.E7.m1.7.7.7.7.7.7" xref="S3.E7.m1.7.7.7.7.7.7a.cmml">concat</mtext><mo id="S3.E7.m1.16.16.2.15.15.15.15.1.1.1.1.1.1" xref="S3.E7.m1.15.15.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.16.16.2.15.15.15.15.1.1.1.1.1.2" xref="S3.E7.m1.15.15.1.cmml"><mo id="S3.E7.m1.8.8.8.8.8.8" stretchy="false" xref="S3.E7.m1.15.15.1.2.cmml">(</mo><mi id="S3.E7.m1.9.9.9.9.9.9" xref="S3.E7.m1.9.9.9.9.9.9.cmml">S</mi><mo id="S3.E7.m1.10.10.10.10.10.10" xref="S3.E7.m1.15.15.1.2.cmml">,</mo><mi id="S3.E7.m1.11.11.11.11.11.11" xref="S3.E7.m1.11.11.11.11.11.11.cmml">q</mi><mo id="S3.E7.m1.12.12.12.12.12.12" stretchy="false" xref="S3.E7.m1.15.15.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.13.13.13.13.13.13" stretchy="false" xref="S3.E7.m1.15.15.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.14.14.14.14.14.14" stretchy="false" xref="S3.E7.m1.15.15.1.2.cmml">)</mo></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.16b"><apply id="S3.E7.m1.15.15.1.cmml" xref="S3.E7.m1.16.16.2"><times id="S3.E7.m1.15.15.1.2.cmml" xref="S3.E7.m1.16.16.2.15.15.15.16"></times><apply id="S3.E7.m1.15.15.1.3.cmml" xref="S3.E7.m1.16.16.2"><csymbol cd="ambiguous" id="S3.E7.m1.15.15.1.3.1.cmml" xref="S3.E7.m1.16.16.2.15.15.15.16">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1a.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><mtext id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">argmax</mtext></ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1">𝑆</ci></apply><ci id="S3.E7.m1.3.3.3.3.3.3a.cmml" xref="S3.E7.m1.3.3.3.3.3.3"><mtext id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3">AnsQuality</mtext></ci><apply id="S3.E7.m1.15.15.1.1.1.1.cmml" xref="S3.E7.m1.16.16.2"><times id="S3.E7.m1.15.15.1.1.1.1.2.cmml" xref="S3.E7.m1.16.16.2"></times><ci id="S3.E7.m1.5.5.5.5.5.5a.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><mtext id="S3.E7.m1.5.5.5.5.5.5.cmml" xref="S3.E7.m1.5.5.5.5.5.5">LLMInference</mtext></ci><apply id="S3.E7.m1.15.15.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.16.16.2"><times id="S3.E7.m1.15.15.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.16.16.2"></times><ci id="S3.E7.m1.7.7.7.7.7.7a.cmml" xref="S3.E7.m1.7.7.7.7.7.7"><mtext id="S3.E7.m1.7.7.7.7.7.7.cmml" xref="S3.E7.m1.7.7.7.7.7.7">concat</mtext></ci><interval closure="open" id="S3.E7.m1.15.15.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.16.16.2"><ci id="S3.E7.m1.9.9.9.9.9.9.cmml" xref="S3.E7.m1.9.9.9.9.9.9">𝑆</ci><ci id="S3.E7.m1.11.11.11.11.11.11.cmml" xref="S3.E7.m1.11.11.11.11.11.11">𝑞</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.16c">\text{argmax}_{\mathit{S}}\,\text{AnsQuality}(\text{LLMInference}(\text{concat%
}(\mathit{S},q)))</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.16d">start_ROW start_CELL argmax start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT AnsQuality ( LLMInference ( concat ( italic_S , italic_q ) ) ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px4.p1.2">where:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.3"><math alttext="\text{concat}(\mathit{S},q)" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.2"><semantics id="S3.I1.i1.p1.1.m1.2a"><mrow id="S3.I1.i1.p1.1.m1.2.3" xref="S3.I1.i1.p1.1.m1.2.3.cmml"><mtext id="S3.I1.i1.p1.1.m1.2.3.2" xref="S3.I1.i1.p1.1.m1.2.3.2a.cmml">concat</mtext><mo id="S3.I1.i1.p1.1.m1.2.3.1" xref="S3.I1.i1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.I1.i1.p1.1.m1.2.3.3.2" xref="S3.I1.i1.p1.1.m1.2.3.3.1.cmml"><mo id="S3.I1.i1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.I1.i1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">S</mi><mo id="S3.I1.i1.p1.1.m1.2.3.3.2.2" xref="S3.I1.i1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.I1.i1.p1.1.m1.2.2" xref="S3.I1.i1.p1.1.m1.2.2.cmml">q</mi><mo id="S3.I1.i1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.I1.i1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.2b"><apply id="S3.I1.i1.p1.1.m1.2.3.cmml" xref="S3.I1.i1.p1.1.m1.2.3"><times id="S3.I1.i1.p1.1.m1.2.3.1.cmml" xref="S3.I1.i1.p1.1.m1.2.3.1"></times><ci id="S3.I1.i1.p1.1.m1.2.3.2a.cmml" xref="S3.I1.i1.p1.1.m1.2.3.2"><mtext id="S3.I1.i1.p1.1.m1.2.3.2.cmml" xref="S3.I1.i1.p1.1.m1.2.3.2">concat</mtext></ci><interval closure="open" id="S3.I1.i1.p1.1.m1.2.3.3.1.cmml" xref="S3.I1.i1.p1.1.m1.2.3.3.2"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝑆</ci><ci id="S3.I1.i1.p1.1.m1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2">𝑞</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.2c">\text{concat}(\mathit{S},q)</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.2d">concat ( italic_S , italic_q )</annotation></semantics></math> denotes the concatenation of the chunks in <math alttext="\mathit{S}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1"><semantics id="S3.I1.i1.p1.2.m2.1a"><mi id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">\mathit{S}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.1d">italic_S</annotation></semantics></math> with the query <math alttext="q" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.1"><semantics id="S3.I1.i1.p1.3.m3.1a"><mi id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b"><ci id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.3.m3.1d">italic_q</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_markedasmath" id="S3.I1.i2.p1.1.1">LLMInference</span> is the function that processes the concatenated chunks and the query using a language model.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_markedasmath" id="S3.I1.i3.p1.1.1">AnsQuality</span> measures the quality (e.g., F1 Score) of the answer produced by the inference function.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Embedding-Agnostic Sentence Yield (EASY) Algorithm</h3>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Challenge</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.1">Given a token sequence, finding the token index of sentence boundary is non-trivial for two reasons: (1) the embedding model for sentence split task (e.g., stanza) is different from the model’s embedding, and (2) embedding models with huge dictionary may result in an impossible token sequence to achieve a perfect sentence split.
For example, widely known sentence-splitting algorithms (e.g., Stanza <cite class="ltx_cite ltx_citemacro_cite">Qi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib24" title="">2020</a>)</cite>) use a different dictionary from the LLM models (e.g., Llama3-8B-Instruct).
Thus, the total token count varies across the embedding models (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.T1" title="Table 1 ‣ Reaction Score ‣ 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.1">Another challenge is that some models prefer huge dictionaries resulting in a token sequence with an impossible case to articulate a sentence boundary.
For example, llama-3 treats <span class="ltx_text" id="S3.SS2.SSS0.Px1.p2.1.1" style="background-color:#ECECEC;">.T</span> as a single token.
Although it may be useful in code generation, a missing whitespace between a punctuation period and a subsequent sentence that starts with the word “The” would result in an impossible case.
In other words, Stanza would create a token sequence (<span class="ltx_text" id="S3.SS2.SSS0.Px1.p2.1.2" style="background-color:#ECECEC;">.</span> - <span class="ltx_text" id="S3.SS2.SSS0.Px1.p2.1.3" style="background-color:#ECECEC;">The</span>), whereas Llama3 tokenizer would output (<span class="ltx_text" id="S3.SS2.SSS0.Px1.p2.1.4" style="background-color:#ECECEC;">.T</span> - <span class="ltx_text" id="S3.SS2.SSS0.Px1.p2.1.5" style="background-color:#ECECEC;">he</span>).
In such a case, an exact sentence boundary for Llama3 cannot be expressed as a token index.
For these reasons, finding the sentence boundary token index across the embedding model is non-trivial.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> EASY Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  <math alttext="seq" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mrow id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">s</mi><mo id="alg1.l0.m1.1.1.1" xref="alg1.l0.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l0.m1.1.1.3" xref="alg1.l0.m1.1.1.3.cmml">e</mi><mo id="alg1.l0.m1.1.1.1a" xref="alg1.l0.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l0.m1.1.1.4" xref="alg1.l0.m1.1.1.4.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><times id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1.1"></times><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝑠</ci><ci id="alg1.l0.m1.1.1.3.cmml" xref="alg1.l0.m1.1.1.3">𝑒</ci><ci id="alg1.l0.m1.1.1.4.cmml" xref="alg1.l0.m1.1.1.4">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">seq</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_s italic_e italic_q</annotation></semantics></math> - Encoded token sequence

</div>
<div class="ltx_listingline" id="alg1.l0a">
<span class="ltx_tag ltx_tag_listingline">0:</span>  <math alttext="TS" class="ltx_Math" display="inline" id="alg1.l0a.m1.1"><semantics id="alg1.l0a.m1.1a"><mrow id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml"><mi id="alg1.l0a.m1.1.1.2" xref="alg1.l0a.m1.1.1.2.cmml">T</mi><mo id="alg1.l0a.m1.1.1.1" xref="alg1.l0a.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l0a.m1.1.1.3" xref="alg1.l0a.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1"><times id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1.1"></times><ci id="alg1.l0a.m1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.2">𝑇</ci><ci id="alg1.l0a.m1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">TS</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m1.1d">italic_T italic_S</annotation></semantics></math> - <span class="ltx_text ltx_framed ltx_framed_underline" id="alg1.l0a.1">T</span>arget <span class="ltx_text ltx_framed ltx_framed_underline" id="alg1.l0a.2">S</span>entences generated by NLP models

</div>
<div class="ltx_listingline" id="alg1.l0b">
<span class="ltx_tag ltx_tag_listingline">0:</span>  <math alttext="tol\leftarrow 30" class="ltx_Math" display="inline" id="alg1.l0b.m1.1"><semantics id="alg1.l0b.m1.1a"><mrow id="alg1.l0b.m1.1.1" xref="alg1.l0b.m1.1.1.cmml"><mrow id="alg1.l0b.m1.1.1.2" xref="alg1.l0b.m1.1.1.2.cmml"><mi id="alg1.l0b.m1.1.1.2.2" xref="alg1.l0b.m1.1.1.2.2.cmml">t</mi><mo id="alg1.l0b.m1.1.1.2.1" xref="alg1.l0b.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l0b.m1.1.1.2.3" xref="alg1.l0b.m1.1.1.2.3.cmml">o</mi><mo id="alg1.l0b.m1.1.1.2.1a" xref="alg1.l0b.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l0b.m1.1.1.2.4" xref="alg1.l0b.m1.1.1.2.4.cmml">l</mi></mrow><mo id="alg1.l0b.m1.1.1.1" stretchy="false" xref="alg1.l0b.m1.1.1.1.cmml">←</mo><mn id="alg1.l0b.m1.1.1.3" xref="alg1.l0b.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0b.m1.1b"><apply id="alg1.l0b.m1.1.1.cmml" xref="alg1.l0b.m1.1.1"><ci id="alg1.l0b.m1.1.1.1.cmml" xref="alg1.l0b.m1.1.1.1">←</ci><apply id="alg1.l0b.m1.1.1.2.cmml" xref="alg1.l0b.m1.1.1.2"><times id="alg1.l0b.m1.1.1.2.1.cmml" xref="alg1.l0b.m1.1.1.2.1"></times><ci id="alg1.l0b.m1.1.1.2.2.cmml" xref="alg1.l0b.m1.1.1.2.2">𝑡</ci><ci id="alg1.l0b.m1.1.1.2.3.cmml" xref="alg1.l0b.m1.1.1.2.3">𝑜</ci><ci id="alg1.l0b.m1.1.1.2.4.cmml" xref="alg1.l0b.m1.1.1.2.4">𝑙</ci></apply><cn id="alg1.l0b.m1.1.1.3.cmml" type="integer" xref="alg1.l0b.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0b.m1.1c">tol\leftarrow 30</annotation><annotation encoding="application/x-llamapun" id="alg1.l0b.m1.1d">italic_t italic_o italic_l ← 30</annotation></semantics></math> - Max wiggling tries

</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math alttext="P\leftarrow[]" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">P</mi><mo id="alg1.l1.m1.1.1.1" stretchy="false" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mrow id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.cmml"><mo id="alg1.l1.m1.1.1.3.2.1" stretchy="false" xref="alg1.l1.m1.1.1.3.1.cmml">[</mo><mo id="alg1.l1.m1.1.1.3.2.2" stretchy="false" xref="alg1.l1.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑃</ci><list id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">P\leftarrow[]</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_P ← [ ]</annotation></semantics></math> {Processed sentences}

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math alttext="B\leftarrow[]" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">B</mi><mo id="alg1.l2.m1.1.1.1" stretchy="false" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mrow id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.cmml"><mo id="alg1.l2.m1.1.1.3.2.1" stretchy="false" xref="alg1.l2.m1.1.1.3.1.cmml">[</mo><mo id="alg1.l2.m1.1.1.3.2.2" stretchy="false" xref="alg1.l2.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐵</ci><list id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">B\leftarrow[]</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_B ← [ ]</annotation></semantics></math> {Sentence boundary indices}

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math alttext="i,m\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l3.m1.2"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.3" xref="alg1.l3.m1.2.3.cmml"><mrow id="alg1.l3.m1.2.3.2.2" xref="alg1.l3.m1.2.3.2.1.cmml"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">i</mi><mo id="alg1.l3.m1.2.3.2.2.1" xref="alg1.l3.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">m</mi></mrow><mo id="alg1.l3.m1.2.3.1" stretchy="false" xref="alg1.l3.m1.2.3.1.cmml">←</mo><mn id="alg1.l3.m1.2.3.3" xref="alg1.l3.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.3.cmml" xref="alg1.l3.m1.2.3"><ci id="alg1.l3.m1.2.3.1.cmml" xref="alg1.l3.m1.2.3.1">←</ci><list id="alg1.l3.m1.2.3.2.1.cmml" xref="alg1.l3.m1.2.3.2.2"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑖</ci><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝑚</ci></list><cn id="alg1.l3.m1.2.3.3.cmml" type="integer" xref="alg1.l3.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">i,m\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.2d">italic_i , italic_m ← 0</annotation></semantics></math> {Initialize indices}

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l4.1">while</span> <math alttext="P\neq TS" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">P</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">≠</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">T</mi><mo id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><neq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></neq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑃</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝑇</ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">P\neq TS</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_P ≠ italic_T italic_S</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     APPEND <math alttext="TS[i]" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml">T</mi><mo id="alg1.l5.m1.1.2.1" xref="alg1.l5.m1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.2.3" xref="alg1.l5.m1.1.2.3.cmml">S</mi><mo id="alg1.l5.m1.1.2.1a" xref="alg1.l5.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.l5.m1.1.2.4.2" xref="alg1.l5.m1.1.2.4.1.cmml"><mo id="alg1.l5.m1.1.2.4.2.1" stretchy="false" xref="alg1.l5.m1.1.2.4.1.1.cmml">[</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">i</mi><mo id="alg1.l5.m1.1.2.4.2.2" stretchy="false" xref="alg1.l5.m1.1.2.4.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><times id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1"></times><ci id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2">𝑇</ci><ci id="alg1.l5.m1.1.2.3.cmml" xref="alg1.l5.m1.1.2.3">𝑆</ci><apply id="alg1.l5.m1.1.2.4.1.cmml" xref="alg1.l5.m1.1.2.4.2"><csymbol cd="latexml" id="alg1.l5.m1.1.2.4.1.1.cmml" xref="alg1.l5.m1.1.2.4.2.1">delimited-[]</csymbol><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">TS[i]</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_T italic_S [ italic_i ]</annotation></semantics></math> to <math alttext="P" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_P</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="c\leftarrow" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">c</mi><mo id="alg1.l6.m1.1.1.1" stretchy="false" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑐</ci><csymbol cd="latexml" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">c\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_c ←</annotation></semantics></math> Length(Encode(Concat(<math alttext="P" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_P</annotation></semantics></math>))) {Candidate}

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="saved\leftarrow c" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mrow id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">s</mi><mo id="alg1.l7.m1.1.1.2.1" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">a</mi><mo id="alg1.l7.m1.1.1.2.1a" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.4" xref="alg1.l7.m1.1.1.2.4.cmml">v</mi><mo id="alg1.l7.m1.1.1.2.1b" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.5" xref="alg1.l7.m1.1.1.2.5.cmml">e</mi><mo id="alg1.l7.m1.1.1.2.1c" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.6" xref="alg1.l7.m1.1.1.2.6.cmml">d</mi></mrow><mo id="alg1.l7.m1.1.1.1" stretchy="false" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><times id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2.1"></times><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑠</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑎</ci><ci id="alg1.l7.m1.1.1.2.4.cmml" xref="alg1.l7.m1.1.1.2.4">𝑣</ci><ci id="alg1.l7.m1.1.1.2.5.cmml" xref="alg1.l7.m1.1.1.2.5">𝑒</ci><ci id="alg1.l7.m1.1.1.2.6.cmml" xref="alg1.l7.m1.1.1.2.6">𝑑</ci></apply><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">saved\leftarrow c</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_s italic_a italic_v italic_e italic_d ← italic_c</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="visited\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mrow id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">v</mi><mo id="alg1.l8.m1.1.1.2.1" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">i</mi><mo id="alg1.l8.m1.1.1.2.1a" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.4" xref="alg1.l8.m1.1.1.2.4.cmml">s</mi><mo id="alg1.l8.m1.1.1.2.1b" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.5" xref="alg1.l8.m1.1.1.2.5.cmml">i</mi><mo id="alg1.l8.m1.1.1.2.1c" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.6" xref="alg1.l8.m1.1.1.2.6.cmml">t</mi><mo id="alg1.l8.m1.1.1.2.1d" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.7" xref="alg1.l8.m1.1.1.2.7.cmml">e</mi><mo id="alg1.l8.m1.1.1.2.1e" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.8" xref="alg1.l8.m1.1.1.2.8.cmml">d</mi></mrow><mo id="alg1.l8.m1.1.1.1" stretchy="false" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mi id="alg1.l8.m1.1.1.3" mathvariant="normal" xref="alg1.l8.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><times id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2.1"></times><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑣</ci><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝑖</ci><ci id="alg1.l8.m1.1.1.2.4.cmml" xref="alg1.l8.m1.1.1.2.4">𝑠</ci><ci id="alg1.l8.m1.1.1.2.5.cmml" xref="alg1.l8.m1.1.1.2.5">𝑖</ci><ci id="alg1.l8.m1.1.1.2.6.cmml" xref="alg1.l8.m1.1.1.2.6">𝑡</ci><ci id="alg1.l8.m1.1.1.2.7.cmml" xref="alg1.l8.m1.1.1.2.7">𝑒</ci><ci id="alg1.l8.m1.1.1.2.8.cmml" xref="alg1.l8.m1.1.1.2.8">𝑑</ci></apply><emptyset id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">visited\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_v italic_i italic_s italic_i italic_t italic_e italic_d ← ∅</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l9.1">while</span> true <span class="ltx_text ltx_font_bold" id="alg1.l9.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l10.1">if</span> <math alttext="c\in visited" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">c</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">∈</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">v</mi><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">i</mi><mo id="alg1.l10.m1.1.1.3.1a" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.4" xref="alg1.l10.m1.1.1.3.4.cmml">s</mi><mo id="alg1.l10.m1.1.1.3.1b" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.5" xref="alg1.l10.m1.1.1.3.5.cmml">i</mi><mo id="alg1.l10.m1.1.1.3.1c" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.6" xref="alg1.l10.m1.1.1.3.6.cmml">t</mi><mo id="alg1.l10.m1.1.1.3.1d" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.7" xref="alg1.l10.m1.1.1.3.7.cmml">e</mi><mo id="alg1.l10.m1.1.1.3.1e" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.8" xref="alg1.l10.m1.1.1.3.8.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><in id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></in><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑐</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑣</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑖</ci><ci id="alg1.l10.m1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.3.4">𝑠</ci><ci id="alg1.l10.m1.1.1.3.5.cmml" xref="alg1.l10.m1.1.1.3.5">𝑖</ci><ci id="alg1.l10.m1.1.1.3.6.cmml" xref="alg1.l10.m1.1.1.3.6">𝑡</ci><ci id="alg1.l10.m1.1.1.3.7.cmml" xref="alg1.l10.m1.1.1.3.7">𝑒</ci><ci id="alg1.l10.m1.1.1.3.8.cmml" xref="alg1.l10.m1.1.1.3.8">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">c\in visited</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_c ∈ italic_v italic_i italic_s italic_i italic_t italic_e italic_d</annotation></semantics></math> or <math alttext="c&gt;|seq|" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">c</mi><mo id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">&gt;</mo><mrow id="alg1.l10.m2.1.1.1.1" xref="alg1.l10.m2.1.1.1.2.cmml"><mo id="alg1.l10.m2.1.1.1.1.2" stretchy="false" xref="alg1.l10.m2.1.1.1.2.1.cmml">|</mo><mrow id="alg1.l10.m2.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.cmml"><mi id="alg1.l10.m2.1.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.1.2.cmml">s</mi><mo id="alg1.l10.m2.1.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m2.1.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.1.3.cmml">e</mi><mo id="alg1.l10.m2.1.1.1.1.1.1a" xref="alg1.l10.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m2.1.1.1.1.1.4" xref="alg1.l10.m2.1.1.1.1.1.4.cmml">q</mi></mrow><mo id="alg1.l10.m2.1.1.1.1.3" stretchy="false" xref="alg1.l10.m2.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><gt id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2"></gt><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝑐</ci><apply id="alg1.l10.m2.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.1"><abs id="alg1.l10.m2.1.1.1.2.1.cmml" xref="alg1.l10.m2.1.1.1.1.2"></abs><apply id="alg1.l10.m2.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1.1"><times id="alg1.l10.m2.1.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1.1.1"></times><ci id="alg1.l10.m2.1.1.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l10.m2.1.1.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.3">𝑒</ci><ci id="alg1.l10.m2.1.1.1.1.1.4.cmml" xref="alg1.l10.m2.1.1.1.1.1.4">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">c&gt;|seq|</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">italic_c &gt; | italic_s italic_e italic_q |</annotation></semantics></math> or <math alttext="|c-saved|&gt;tol" class="ltx_Math" display="inline" id="alg1.l10.m3.1"><semantics id="alg1.l10.m3.1a"><mrow id="alg1.l10.m3.1.1" xref="alg1.l10.m3.1.1.cmml"><mrow id="alg1.l10.m3.1.1.1.1" xref="alg1.l10.m3.1.1.1.2.cmml"><mo id="alg1.l10.m3.1.1.1.1.2" stretchy="false" xref="alg1.l10.m3.1.1.1.2.1.cmml">|</mo><mrow id="alg1.l10.m3.1.1.1.1.1" xref="alg1.l10.m3.1.1.1.1.1.cmml"><mi id="alg1.l10.m3.1.1.1.1.1.2" xref="alg1.l10.m3.1.1.1.1.1.2.cmml">c</mi><mo id="alg1.l10.m3.1.1.1.1.1.1" xref="alg1.l10.m3.1.1.1.1.1.1.cmml">−</mo><mrow id="alg1.l10.m3.1.1.1.1.1.3" xref="alg1.l10.m3.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m3.1.1.1.1.1.3.2" xref="alg1.l10.m3.1.1.1.1.1.3.2.cmml">s</mi><mo id="alg1.l10.m3.1.1.1.1.1.3.1" xref="alg1.l10.m3.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m3.1.1.1.1.1.3.3" xref="alg1.l10.m3.1.1.1.1.1.3.3.cmml">a</mi><mo id="alg1.l10.m3.1.1.1.1.1.3.1a" xref="alg1.l10.m3.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m3.1.1.1.1.1.3.4" xref="alg1.l10.m3.1.1.1.1.1.3.4.cmml">v</mi><mo id="alg1.l10.m3.1.1.1.1.1.3.1b" xref="alg1.l10.m3.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m3.1.1.1.1.1.3.5" xref="alg1.l10.m3.1.1.1.1.1.3.5.cmml">e</mi><mo id="alg1.l10.m3.1.1.1.1.1.3.1c" xref="alg1.l10.m3.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m3.1.1.1.1.1.3.6" xref="alg1.l10.m3.1.1.1.1.1.3.6.cmml">d</mi></mrow></mrow><mo id="alg1.l10.m3.1.1.1.1.3" stretchy="false" xref="alg1.l10.m3.1.1.1.2.1.cmml">|</mo></mrow><mo id="alg1.l10.m3.1.1.2" xref="alg1.l10.m3.1.1.2.cmml">&gt;</mo><mrow id="alg1.l10.m3.1.1.3" xref="alg1.l10.m3.1.1.3.cmml"><mi id="alg1.l10.m3.1.1.3.2" xref="alg1.l10.m3.1.1.3.2.cmml">t</mi><mo id="alg1.l10.m3.1.1.3.1" xref="alg1.l10.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m3.1.1.3.3" xref="alg1.l10.m3.1.1.3.3.cmml">o</mi><mo id="alg1.l10.m3.1.1.3.1a" xref="alg1.l10.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m3.1.1.3.4" xref="alg1.l10.m3.1.1.3.4.cmml">l</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.1b"><apply id="alg1.l10.m3.1.1.cmml" xref="alg1.l10.m3.1.1"><gt id="alg1.l10.m3.1.1.2.cmml" xref="alg1.l10.m3.1.1.2"></gt><apply id="alg1.l10.m3.1.1.1.2.cmml" xref="alg1.l10.m3.1.1.1.1"><abs id="alg1.l10.m3.1.1.1.2.1.cmml" xref="alg1.l10.m3.1.1.1.1.2"></abs><apply id="alg1.l10.m3.1.1.1.1.1.cmml" xref="alg1.l10.m3.1.1.1.1.1"><minus id="alg1.l10.m3.1.1.1.1.1.1.cmml" xref="alg1.l10.m3.1.1.1.1.1.1"></minus><ci id="alg1.l10.m3.1.1.1.1.1.2.cmml" xref="alg1.l10.m3.1.1.1.1.1.2">𝑐</ci><apply id="alg1.l10.m3.1.1.1.1.1.3.cmml" xref="alg1.l10.m3.1.1.1.1.1.3"><times id="alg1.l10.m3.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m3.1.1.1.1.1.3.1"></times><ci id="alg1.l10.m3.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m3.1.1.1.1.1.3.2">𝑠</ci><ci id="alg1.l10.m3.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m3.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l10.m3.1.1.1.1.1.3.4.cmml" xref="alg1.l10.m3.1.1.1.1.1.3.4">𝑣</ci><ci id="alg1.l10.m3.1.1.1.1.1.3.5.cmml" xref="alg1.l10.m3.1.1.1.1.1.3.5">𝑒</ci><ci id="alg1.l10.m3.1.1.1.1.1.3.6.cmml" xref="alg1.l10.m3.1.1.1.1.1.3.6">𝑑</ci></apply></apply></apply><apply id="alg1.l10.m3.1.1.3.cmml" xref="alg1.l10.m3.1.1.3"><times id="alg1.l10.m3.1.1.3.1.cmml" xref="alg1.l10.m3.1.1.3.1"></times><ci id="alg1.l10.m3.1.1.3.2.cmml" xref="alg1.l10.m3.1.1.3.2">𝑡</ci><ci id="alg1.l10.m3.1.1.3.3.cmml" xref="alg1.l10.m3.1.1.3.3">𝑜</ci><ci id="alg1.l10.m3.1.1.3.4.cmml" xref="alg1.l10.m3.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.1c">|c-saved|&gt;tol</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m3.1d">| italic_c - italic_s italic_a italic_v italic_e italic_d | &gt; italic_t italic_o italic_l</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l10.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>           <math alttext="c\leftarrow saved" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">c</mi><mo id="alg1.l11.m1.1.1.1" stretchy="false" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">a</mi><mo id="alg1.l11.m1.1.1.3.1a" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.4" xref="alg1.l11.m1.1.1.3.4.cmml">v</mi><mo id="alg1.l11.m1.1.1.3.1b" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.5" xref="alg1.l11.m1.1.1.3.5.cmml">e</mi><mo id="alg1.l11.m1.1.1.3.1c" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.6" xref="alg1.l11.m1.1.1.3.6.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑐</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><times id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"></times><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑠</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑎</ci><ci id="alg1.l11.m1.1.1.3.4.cmml" xref="alg1.l11.m1.1.1.3.4">𝑣</ci><ci id="alg1.l11.m1.1.1.3.5.cmml" xref="alg1.l11.m1.1.1.3.5">𝑒</ci><ci id="alg1.l11.m1.1.1.3.6.cmml" xref="alg1.l11.m1.1.1.3.6">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">c\leftarrow saved</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_c ← italic_s italic_a italic_v italic_e italic_d</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>           <span class="ltx_text ltx_font_bold" id="alg1.l12.1">break</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>        ADD <math alttext="c" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_c</annotation></semantics></math> to <math alttext="visited" class="ltx_Math" display="inline" id="alg1.l14.m2.1"><semantics id="alg1.l14.m2.1a"><mrow id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mi id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">v</mi><mo id="alg1.l14.m2.1.1.1" xref="alg1.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml">i</mi><mo id="alg1.l14.m2.1.1.1a" xref="alg1.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.4" xref="alg1.l14.m2.1.1.4.cmml">s</mi><mo id="alg1.l14.m2.1.1.1b" xref="alg1.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.5" xref="alg1.l14.m2.1.1.5.cmml">i</mi><mo id="alg1.l14.m2.1.1.1c" xref="alg1.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.6" xref="alg1.l14.m2.1.1.6.cmml">t</mi><mo id="alg1.l14.m2.1.1.1d" xref="alg1.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.7" xref="alg1.l14.m2.1.1.7.cmml">e</mi><mo id="alg1.l14.m2.1.1.1e" xref="alg1.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m2.1.1.8" xref="alg1.l14.m2.1.1.8.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><times id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1.1"></times><ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">𝑣</ci><ci id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3">𝑖</ci><ci id="alg1.l14.m2.1.1.4.cmml" xref="alg1.l14.m2.1.1.4">𝑠</ci><ci id="alg1.l14.m2.1.1.5.cmml" xref="alg1.l14.m2.1.1.5">𝑖</ci><ci id="alg1.l14.m2.1.1.6.cmml" xref="alg1.l14.m2.1.1.6">𝑡</ci><ci id="alg1.l14.m2.1.1.7.cmml" xref="alg1.l14.m2.1.1.7">𝑒</ci><ci id="alg1.l14.m2.1.1.8.cmml" xref="alg1.l14.m2.1.1.8">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">visited</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m2.1d">italic_v italic_i italic_s italic_i italic_t italic_e italic_d</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math alttext="s\leftarrow" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">s</mi><mo id="alg1.l15.m1.1.1.1" stretchy="false" xref="alg1.l15.m1.1.1.1.cmml">←</mo><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1">←</ci><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑠</ci><csymbol cd="latexml" id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">s\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_s ←</annotation></semantics></math> Decode(<math alttext="seq[m:c]" class="ltx_math_unparsed" display="inline" id="alg1.l15.m2.1"><semantics id="alg1.l15.m2.1a"><mrow id="alg1.l15.m2.1b"><mi id="alg1.l15.m2.1.1">s</mi><mi id="alg1.l15.m2.1.2">e</mi><mi id="alg1.l15.m2.1.3">q</mi><mrow id="alg1.l15.m2.1.4"><mo id="alg1.l15.m2.1.4.1" stretchy="false">[</mo><mi id="alg1.l15.m2.1.4.2">m</mi><mo id="alg1.l15.m2.1.4.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="alg1.l15.m2.1.4.4">c</mi><mo id="alg1.l15.m2.1.4.5" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">seq[m:c]</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m2.1d">italic_s italic_e italic_q [ italic_m : italic_c ]</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l16.1">if</span> <math alttext="s==TS[i]" class="ltx_math_unparsed" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1b"><mi id="alg1.l16.m1.1.1">s</mi><mo id="alg1.l16.m1.1.2" rspace="0em">=</mo><mo id="alg1.l16.m1.1.3" lspace="0em">=</mo><mi id="alg1.l16.m1.1.4">T</mi><mi id="alg1.l16.m1.1.5">S</mi><mrow id="alg1.l16.m1.1.6"><mo id="alg1.l16.m1.1.6.1" stretchy="false">[</mo><mi id="alg1.l16.m1.1.6.2">i</mi><mo id="alg1.l16.m1.1.6.3" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">s==TS[i]</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_s = = italic_T italic_S [ italic_i ]</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l16.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>           <span class="ltx_text ltx_font_bold" id="alg1.l17.1">break</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l18.1">else</span> <span class="ltx_text ltx_font_bold" id="alg1.l18.2">if</span> <math alttext="s" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mi id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><ci id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_s</annotation></semantics></math> is substring of <math alttext="TS[i]" class="ltx_Math" display="inline" id="alg1.l18.m2.1"><semantics id="alg1.l18.m2.1a"><mrow id="alg1.l18.m2.1.2" xref="alg1.l18.m2.1.2.cmml"><mi id="alg1.l18.m2.1.2.2" xref="alg1.l18.m2.1.2.2.cmml">T</mi><mo id="alg1.l18.m2.1.2.1" xref="alg1.l18.m2.1.2.1.cmml">⁢</mo><mi id="alg1.l18.m2.1.2.3" xref="alg1.l18.m2.1.2.3.cmml">S</mi><mo id="alg1.l18.m2.1.2.1a" xref="alg1.l18.m2.1.2.1.cmml">⁢</mo><mrow id="alg1.l18.m2.1.2.4.2" xref="alg1.l18.m2.1.2.4.1.cmml"><mo id="alg1.l18.m2.1.2.4.2.1" stretchy="false" xref="alg1.l18.m2.1.2.4.1.1.cmml">[</mo><mi id="alg1.l18.m2.1.1" xref="alg1.l18.m2.1.1.cmml">i</mi><mo id="alg1.l18.m2.1.2.4.2.2" stretchy="false" xref="alg1.l18.m2.1.2.4.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m2.1b"><apply id="alg1.l18.m2.1.2.cmml" xref="alg1.l18.m2.1.2"><times id="alg1.l18.m2.1.2.1.cmml" xref="alg1.l18.m2.1.2.1"></times><ci id="alg1.l18.m2.1.2.2.cmml" xref="alg1.l18.m2.1.2.2">𝑇</ci><ci id="alg1.l18.m2.1.2.3.cmml" xref="alg1.l18.m2.1.2.3">𝑆</ci><apply id="alg1.l18.m2.1.2.4.1.cmml" xref="alg1.l18.m2.1.2.4.2"><csymbol cd="latexml" id="alg1.l18.m2.1.2.4.1.1.cmml" xref="alg1.l18.m2.1.2.4.2.1">delimited-[]</csymbol><ci id="alg1.l18.m2.1.1.cmml" xref="alg1.l18.m2.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m2.1c">TS[i]</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m2.1d">italic_T italic_S [ italic_i ]</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l18.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>           <math alttext="c\leftarrow c+1" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">c</mi><mo id="alg1.l19.m1.1.1.1" stretchy="false" xref="alg1.l19.m1.1.1.1.cmml">←</mo><mrow id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml"><mi id="alg1.l19.m1.1.1.3.2" xref="alg1.l19.m1.1.1.3.2.cmml">c</mi><mo id="alg1.l19.m1.1.1.3.1" xref="alg1.l19.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l19.m1.1.1.3.3" xref="alg1.l19.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><ci id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1">←</ci><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝑐</ci><apply id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3"><plus id="alg1.l19.m1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.3.1"></plus><ci id="alg1.l19.m1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.3.2">𝑐</ci><cn id="alg1.l19.m1.1.1.3.3.cmml" type="integer" xref="alg1.l19.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">c\leftarrow c+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">italic_c ← italic_c + 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l20.1">else</span>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline">21:</span>           <math alttext="c\leftarrow c-1" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">c</mi><mo id="alg1.l21.m1.1.1.1" stretchy="false" xref="alg1.l21.m1.1.1.1.cmml">←</mo><mrow id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><mi id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml">c</mi><mo id="alg1.l21.m1.1.1.3.1" xref="alg1.l21.m1.1.1.3.1.cmml">−</mo><mn id="alg1.l21.m1.1.1.3.3" xref="alg1.l21.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><ci id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1">←</ci><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑐</ci><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><minus id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1"></minus><ci id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2">𝑐</ci><cn id="alg1.l21.m1.1.1.3.3.cmml" type="integer" xref="alg1.l21.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">c\leftarrow c-1</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">italic_c ← italic_c - 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline">22:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l22.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l22.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline">23:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l23.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l23.2">while</span>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline">24:</span>     APPEND <math alttext="c" class="ltx_Math" display="inline" id="alg1.l24.m1.1"><semantics id="alg1.l24.m1.1a"><mi id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><ci id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.1d">italic_c</annotation></semantics></math> to <math alttext="B" class="ltx_Math" display="inline" id="alg1.l24.m2.1"><semantics id="alg1.l24.m2.1a"><mi id="alg1.l24.m2.1.1" xref="alg1.l24.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l24.m2.1b"><ci id="alg1.l24.m2.1.1.cmml" xref="alg1.l24.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m2.1d">italic_B</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline">25:</span>     <math alttext="m\leftarrow c" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><mi id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml">m</mi><mo id="alg1.l25.m1.1.1.1" stretchy="false" xref="alg1.l25.m1.1.1.1.cmml">←</mo><mi id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><ci id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1">←</ci><ci id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2">𝑚</ci><ci id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">m\leftarrow c</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">italic_m ← italic_c</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline">26:</span>     <math alttext="i\leftarrow i+1" class="ltx_Math" display="inline" id="alg1.l26.m1.1"><semantics id="alg1.l26.m1.1a"><mrow id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml"><mi id="alg1.l26.m1.1.1.2" xref="alg1.l26.m1.1.1.2.cmml">i</mi><mo id="alg1.l26.m1.1.1.1" stretchy="false" xref="alg1.l26.m1.1.1.1.cmml">←</mo><mrow id="alg1.l26.m1.1.1.3" xref="alg1.l26.m1.1.1.3.cmml"><mi id="alg1.l26.m1.1.1.3.2" xref="alg1.l26.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l26.m1.1.1.3.1" xref="alg1.l26.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l26.m1.1.1.3.3" xref="alg1.l26.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><apply id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1"><ci id="alg1.l26.m1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1">←</ci><ci id="alg1.l26.m1.1.1.2.cmml" xref="alg1.l26.m1.1.1.2">𝑖</ci><apply id="alg1.l26.m1.1.1.3.cmml" xref="alg1.l26.m1.1.1.3"><plus id="alg1.l26.m1.1.1.3.1.cmml" xref="alg1.l26.m1.1.1.3.1"></plus><ci id="alg1.l26.m1.1.1.3.2.cmml" xref="alg1.l26.m1.1.1.3.2">𝑖</ci><cn id="alg1.l26.m1.1.1.3.3.cmml" type="integer" xref="alg1.l26.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">i\leftarrow i+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.1d">italic_i ← italic_i + 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline">27:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l27.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l27.2">while</span>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline">28:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l28.1">return</span> <math alttext="B" class="ltx_Math" display="inline" id="alg1.l28.m1.1"><semantics id="alg1.l28.m1.1a"><mi id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.1b"><ci id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg1.l28.m1.1d">italic_B</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Embedding-Agnostic Sentence Yield (EASY)</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.1">To resolve the problem, we propose the Embedding-Agnostic Sentence Yield (EASY) algorithm.
The input to the algorithm is a single token sequence and a list of sentence strings acquired from the LLM tokenizer and the sentence splitting NLP models (e.g., Stanza <cite class="ltx_cite ltx_citemacro_cite">Qi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib24" title="">2020</a>)</cite>), respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.1">The EASY algorithm is a repetition of guessing the sentence boundary and making best efforts adjustments.
First, EASY estimates a candidate index as the encoded length of sentences that are already processed (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#alg1" title="Algorithm 1 ‣ Challenge ‣ 3.2 Embedding-Agnostic Sentence Yield (EASY) Algorithm ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">1</span></a> line 7).
EASY decodes the token subsequence between the <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS0.Px2.p2.1.1">most-recently confirmed boundary index</span> (<math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">italic_m</annotation></semantics></math> in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#alg1" title="Algorithm 1 ‣ Challenge ‣ 3.2 Embedding-Agnostic Sentence Yield (EASY) Algorithm ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">1</span></a>) and the <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS0.Px2.p2.1.2">current candidate</span> and compares it against the target sentence (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#alg1" title="Algorithm 1 ‣ Challenge ‣ 3.2 Embedding-Agnostic Sentence Yield (EASY) Algorithm ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">1</span></a> line 16).
Based on the comparison outcome (<span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS0.Px2.p2.1.3">MATCH</span>, <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS0.Px2.p2.1.4">INCLUDED</span>, <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS0.Px2.p2.1.5">NO-MATCH</span>), EASY wiggles (+1 or -1) the candidate index until the decoded subsequence matches the target or a termination condition is met (lines 17-23).
Lastly, EASY returns the list of integers, where each value is a token index corresponding to a sentence boundary.
If for some reason, the best effort fails, EASY restores the initial candidate index and appends to the boundary list.
This retains the one-to-one mapping between the target sentence and the boundary token index.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Retrieval using Reaction Score — End-to-end</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The retrieval algorithm starts with calculating the reaction vector.
If the input context is longer than the model’s context window size, we calculate the attention vector for each chunk of context window size and concatenate them before returning.
At this point, we have the reaction vector whose length equals the input context’s token sequence.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">To slice the reaction vector for each sentence, we apply the Embedding-Agnostic Sentence Yield (EASY) algorithm (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.SS2" title="3.2 Embedding-Agnostic Sentence Yield (EASY) Algorithm ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
Then the retriever slices the reaction vector and calculates the geometric mean of the reaction vector slice using the output of the EASY algorithm, a list of sentence boundary indices.
At this point, we have a list of sentences and their associated reaction scores, which will be used as a retrieval heuristic.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">For the actual retrieval, we greedily add sentences starting with the highest reaction score until the retrieval token budget is depleted or the sentence count threshold is reached (80% of total sentence count).
The retrieved sentences are reordered according to their original position as the final cleanup step.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We evaluate how the YOURA improves the answering performance of 5 pre-trained models on LongBench <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib1" title="">2023</a>)</cite> single-doc and multi-doc QA datasets.</p>
</div>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Datasets</h4>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">We evaluate YOURA on the single and multi-document QA (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.T1" title="Table 1 ‣ Reaction Score ‣ 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Models</h4>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p1.1">We used three different open-sourced LLM models: LLama2-7B, Llama3-8B, and Mistralv0.2-7B, where each model has a context window size of 4K, 8K, and 32K, respectively.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Inference Setup</h4>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px3.p1.1">For inference, we used the vLLM <cite class="ltx_cite ltx_citemacro_cite">Kwon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib14" title="">2023</a>)</cite>.
We used the LongBench <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib1" title="">2023</a>)</cite> code to evaluate the generated answers.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Machine Setup</h4>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px4.p1.1">We measured the vLLM <cite class="ltx_cite ltx_citemacro_cite">Kwon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib14" title="">2023</a>)</cite> inference performance by slightly modifying the vLLM’s throughput benchmark (v0.5.3) code on a single NVIDIA H100-80G GPU.
We used the default vLLM settings except for changing the <span class="ltx_text" id="S4.SS0.SSS0.Px4.p1.1.1" style="background-color:#ECECEC;">ignore_eos</span> to <span class="ltx_text" id="S4.SS0.SSS0.Px4.p1.1.2" style="background-color:#ECECEC;">false</span>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">Experiment Setup</h4>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px5.p1.1">We compare the following scenarios to evaluate how the YOURA improves the output quality or performance. For each setup, as done with the LongBench <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib1" title="">2023</a>)</cite>, we equalize the retrieval budget to 3500, 7500, and 31500 for models with 4K, 8K, and 32K context window sizes, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px5.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Model without context</span> No context is passed to the LLM.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.4"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.4.3">with BM25 Retrieval</span> <span class="ltx_text" id="S4.I1.i2.p1.2.2" style="background-color:#ECECEC;">B<math alttext="x" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.1.1.m1.1" style="background-color:#ECECEC;"><semantics id="S4.I1.i2.p1.1.1.1.m1.1a"><mi id="S4.I1.i2.p1.1.1.1.m1.1.1" mathbackground="#ECECEC" xref="S4.I1.i2.p1.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.1.1.m1.1b"><ci id="S4.I1.i2.p1.1.1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.1.1.m1.1d">italic_x</annotation></semantics></math>_<math alttext="y" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.2.2.m2.1" style="background-color:#ECECEC;"><semantics id="S4.I1.i2.p1.2.2.2.m2.1a"><mi id="S4.I1.i2.p1.2.2.2.m2.1.1" mathbackground="#ECECEC" xref="S4.I1.i2.p1.2.2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.2.2.m2.1b"><ci id="S4.I1.i2.p1.2.2.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.2.2.m2.1d">italic_y</annotation></semantics></math></span> indicates chunking at roughly <math alttext="x" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m1.1"><semantics id="S4.I1.i2.p1.3.m1.1a"><mi id="S4.I1.i2.p1.3.m1.1.1" xref="S4.I1.i2.p1.3.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m1.1b"><ci id="S4.I1.i2.p1.3.m1.1.1.cmml" xref="S4.I1.i2.p1.3.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m1.1d">italic_x</annotation></semantics></math> tokens and retrieving the top <math alttext="y" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m2.1"><semantics id="S4.I1.i2.p1.4.m2.1a"><mi id="S4.I1.i2.p1.4.m2.1.1" xref="S4.I1.i2.p1.4.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m2.1b"><ci id="S4.I1.i2.p1.4.m2.1.1.cmml" xref="S4.I1.i2.p1.4.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m2.1d">italic_y</annotation></semantics></math> chunks.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.4"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.4.3">with Embedding Retrieval</span> <span class="ltx_text" id="S4.I1.i3.p1.2.2" style="background-color:#ECECEC;">E<math alttext="x" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.1.1.m1.1" style="background-color:#ECECEC;"><semantics id="S4.I1.i3.p1.1.1.1.m1.1a"><mi id="S4.I1.i3.p1.1.1.1.m1.1.1" mathbackground="#ECECEC" xref="S4.I1.i3.p1.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.1.1.m1.1b"><ci id="S4.I1.i3.p1.1.1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.1.1.m1.1d">italic_x</annotation></semantics></math>_<math alttext="y" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.2.2.m2.1" style="background-color:#ECECEC;"><semantics id="S4.I1.i3.p1.2.2.2.m2.1a"><mi id="S4.I1.i3.p1.2.2.2.m2.1.1" mathbackground="#ECECEC" xref="S4.I1.i3.p1.2.2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.2.2.m2.1b"><ci id="S4.I1.i3.p1.2.2.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.2.2.m2.1d">italic_y</annotation></semantics></math></span> indicates chunking at roughly <math alttext="x" class="ltx_Math" display="inline" id="S4.I1.i3.p1.3.m1.1"><semantics id="S4.I1.i3.p1.3.m1.1a"><mi id="S4.I1.i3.p1.3.m1.1.1" xref="S4.I1.i3.p1.3.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m1.1b"><ci id="S4.I1.i3.p1.3.m1.1.1.cmml" xref="S4.I1.i3.p1.3.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.3.m1.1d">italic_x</annotation></semantics></math> tokens and retrieving the top <math alttext="y" class="ltx_Math" display="inline" id="S4.I1.i3.p1.4.m2.1"><semantics id="S4.I1.i3.p1.4.m2.1a"><mi id="S4.I1.i3.p1.4.m2.1.1" xref="S4.I1.i3.p1.4.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m2.1b"><ci id="S4.I1.i3.p1.4.m2.1.1.cmml" xref="S4.I1.i3.p1.4.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.4.m2.1d">italic_y</annotation></semantics></math> chunks. We measure the cosine similarity between each chunk’s embedding vector generated by the “paraphrase-MiniLM-L6-v2” model<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://huggingface.co/sentence-transformers/paraphrase-MiniLM-L6-v2</span></span></span>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">with Truncation</span> We use LongBench’s prompt along with its context truncation approach: the whole context, if it fits within the pre-trained model’s context window size, or the concatenation of the context head and tail with an equal context window budget, otherwise.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i5.p1.1.1">with YOURA</span> Our proposed system as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3" title="3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.1.1">Setup</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.1.2">Retr. Ratio</th>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.1.1.1.3">SDOC</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.1.1.1.4">MDoc</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.1.1.5">Overall</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.2.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.2.2.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.2.2.2">Avg</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.2.2.3">Avg</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.2.2.4">Avg</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.2.2.5">Avg</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.3.3.1">LLaMA2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.3.3.2">INF</th>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.1.3.3.3">13.65</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.1.3.3.4">19.30</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.1.3.3.5">16.47</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.4.4.1">w/ B500_7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.4.4.2">3.28</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.4.4.3">22.82</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.4.4.4">20.17</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.5">21.49</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.5.5.1">w/ B50_70</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.5.5.2">3.28</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.5.5.3">23.86</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.5.5.4">23.25</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.5.5.5">23.56</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.6.6.1">w/ E500_7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.6.6.2">3.28</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.6.6.3">17.13</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.6.6.4">19.57</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.6.6.5">18.35</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.7.7.1">w/ E50_70</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.7.7.2">3.28</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.7.7.3">24.15</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.7.7.4">22.87</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.7.7.5">23.51</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.8.8.1">w/ Trunc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.8.8.2">3.28</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.8.8.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.8.8.3.1">25.74</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.8.8.4">22.34</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.8.8.5">24.04</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.9.9.1">w/ YOURA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.9.9.2">3.39</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.9.9.3">23.22</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.9.9.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.9.9.4.1">25.17</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.9.9.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.9.9.5.1">24.20</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.10.10.1">LLaMA3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.10.10.2">INF</th>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.1.10.10.3">11.59</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.1.10.10.4">23.16</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.1.10.10.5">17.37</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.11.11.1">w/ B500_15</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.11.11.2">1.57</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.11.11.3">34.07</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.11.11.4">33.27</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.11.11.5">33.73</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.12.12.1">w/ B50_150</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.12.12.2">1.57</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.12.12.3">32.92</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.12.12.4">35.83</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.12.12.5">34.17</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.13.13.1">w/ E500_15</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.13.13.2">1.57</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.13.13.3">33.33</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.13.13.4">30.82</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.13.13.5">32.08</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.14.14.1">w/ E50_150</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.14.14.2">1.57</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.14.14.3">31.50</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.14.14.4">35.70</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.14.14.5">33.60</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.15.15.1">w/ Trunc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.15.15.2">1.57</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.15.15.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.15.15.3.1">36.83</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.15.15.4">34.72</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.15.15.5">35.93</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.16.16.1">w/ YOURA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.16.16.2">1.76</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.16.16.3">36.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.16.16.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.16.16.4.1">36.44</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.16.16.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.16.16.5.1">36.50</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.17.17.1">Mistralv0.2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.17.17.2">INF</th>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.1.17.17.3">7.02</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.1.17.17.4">11.47</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.1.17.17.5">9.25</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.18.18.1">w/ B500_63</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.18.18.2">1.04</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.18.18.3">32.29</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.18.18.4">24.66</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.18.18.5">29.02</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.19.19.1">w/ B50_630</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.19.19.2">1.04</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.19.19.3">29.14</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.19.19.4">23.28</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.19.19.5">26.63</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.20.20.1">w/ E500_63</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.20.20.2">1.04</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.20.20.3">26.79</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.20.20.4">22.06</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.20.20.5">24.76</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.21.21.1">w/ E50_630</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.21.21.2">1.04</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.21.21.3">29.14</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.21.21.4">23.28</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.21.21.5">26.63</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.22.22.1">w/ Trunc.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.22.22.2">1.04</th>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.22.22.3">32.65</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.1.22.22.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.22.22.4.1">26.62</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.22.22.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.22.22.5.1">29.64</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.1.23.23.1">w/ YOURA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.1.23.23.2">1.33</th>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="S4.T2.1.23.23.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.23.23.3.1">33.14</span></td>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="S4.T2.1.23.23.4">25.84</td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T2.1.23.23.5">29.49</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Answer quality comparison for LongBench’s single-document and multi-document QA datasets. YOURA shows better quality with a higher retrieval ratio — i.e., retrieved fewer tokens. All retrieval scenarios use the maximal budget (4K, 8K, and 32K tokens depending on the model) except for without-context setup and “YOURA”. The retrieval ratio (second column) is the average of the total token count divided by the retrieved token count.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Longbench QA Result</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">How does YOURA impact the output quality?</span>
From Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.T2" title="Table 2 ‣ Experiment Setup ‣ 4 Experiments"><span class="ltx_text ltx_ref_tag">2</span></a>, which shows the answer quality using three different open-sourced models (Llama2, Llama3, and Mistralv0.2), we make the following observations.
(1) We observe that YOURA showed better overall answer quality than all of the retrieval approaches (BM25 and embedding-based, except for Llama2 w/ B50_70) at a higher retrieval ratio — i.e., retrieving less information from the long context.
(2) When compared to the truncate-middle approach, YOURA shows better overall quality for Llama2 and Llama3, and slightly less (-0.15) for Mistral.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">(2-1) When broken down into dataset types, we observe that YOURA is better at multi-document QA than single-document QA for Llama2 and Llama3.
We claim that Trunc. truncates the key information to correctly answer multi-document QAs, but the head and tail of a single document include key information in many cases.
As for YOURA, the key information is retrieved properly for both the single-doc and multi-doc QAs resulting in a comparable answer quality.
For YOURA’s lower single-document score, we conjecture that the retrieval budget (4k, and 8k for Llama2 and Llama3, respectively) is insufficient to retrieve all of the relevant information.
As a supporting fact, the quality difference between Trunc. and YOURA decreases significantly from -2.52 to -0.26.
Experiment results for a pre-trained model with a 16k context window size would be useful for proving/disproving the conjecture but no solid 16k model is available at the time of the publication.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">(2-2) For Mistral, which has a large context window size of 32k, truncation rarely happens (as shown in the small retrieval ratio).
Without truncation, distractful information is included as part of the augmented context resulting in worse single-document answer quality than YOURA.
<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The impact of distractful information on output quality is observed in other work <cite class="ltx_cite ltx_citemacro_cite">Catav (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib5" title="">2023</a>)</cite> as well.</span></span></span>
Our explanation for multi-document QA using Mistral, where YOURA showed a slightly worse quality (-0.78), is similar to the explanation in (2-1); YOURA’s relatively high retrieval ratio resulted in leaving out some key information.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">From the observations, we conclude that the balance between the pre-trained model’s context window size and the retrieval ratio is important for long context QA.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.1.1">Mod</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.1.1.1.2">Retrieval</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.1.1.1.3">SDOC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.1.1.1.4">MDOC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.1.5">Overall Avg</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.2.1.1">L2</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.1.2">Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.1.3">5.25</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.1.4">5.76</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.5">5.50</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.3.2.1">L2</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.2.2">YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.3.2.3.1">5.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.3.2.4.1">5.78</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.3.2.5.1">5.60 (+2%)</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.4.3.1">L3</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.4.3.2">Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.4.3.3">3.23</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.4.3.4">2.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.4.3.5">3.01</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.5.4.1">L3</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.5.4.2">YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.4.3.1">3.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.4.4.1">3.03</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.5.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.4.5.1">3.39 (+13%)</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.6.5.1">M</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.6.5.2">Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.6.5.3">1.97</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.6.5.4">1.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.6.5.5">1.66</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T3.1.7.6.1">M</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.7.6.2">YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.7.6.3.1">2.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.7.6.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.7.6.4.1">1.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.7.6.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.7.6.5.1">2.18 (+31%)</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>vLLM Serving performance (request per second, higher the better) for LongBench’s single-document and multi-document QA datasets with respect to Truncation and YOURA. YOURA retrieved fewer tokens resulting in up to 30% higher inference throughput.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">How does YOURA’s higher retrieval ratio improve inference performance?</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.T3" title="Table 3 ‣ 4.1 Longbench QA Result ‣ 4 Experiments"><span class="ltx_text ltx_ref_tag">3</span></a> shows the average vllm inference throughput (requests per second) assuming offline truncation/retrieval.
We make the following observations.
First, YOURA improves the overall inference throughput, especially for models with larger context window sizes.
This is because the relative retrieval ratio is larger for models with larger context window sizes.
Second, the retrieval ratio is a good relative throughput estimator.
The relative throughput improvements (+2%, +13%, +31%) are on par with the relative retrieval ratio (+3%, +12%, +28%).
We conclude that the performance of LLM serving platforms such as vLLM is sensitive to the retrieved context size and underscores the importance of good information retrieval.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>EASY Sentence Splitter Accuracy</h3>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">How well can the EASY algorithm split tokens into sentences?</h4>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.T4" title="Table 4 ‣ How well can the EASY algorithm split tokens into sentences? ‣ 4.2 EASY Sentence Splitter Accuracy ‣ 4 Experiments"><span class="ltx_text ltx_ref_tag">4</span></a> shows the quality of our EASY sentence splitting algorithm.
We used Stanza <cite class="ltx_cite ltx_citemacro_cite">Qi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#bib.bib24" title="">2020</a>)</cite>, an open-sourced NLP toolkit, to split raw text into sentences.
Then we ran the EASY algorithm for each tokenizer model to identify the sentence boundary within a token sequence.
After decoding each token segment (delimited by the sentence boundary index), it is a match if the Stanza’s sentence (namely <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p1.1.1">target sentence</span>) matches exactly after the cleanup (e.g., trailing whitespace).
We report the average match rate for each model and dataset pair.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.3">We make the following observations.
Overall the EASY algorithm can identify the sentence boundary for models with varying dictionary sizes: Llama2, Llama3, and Mistralv0.2 tokenizers with 32000, 128256, and 32000 words, respectively.
Llama2 and Mistral showed almost identical match ratios, as both models’ tokenizers are based on similar vocabulary.
Llama3 uses roughly <math alttext="\times 4" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1"><times id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2">absent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.1.m1.1c">\times 4</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.1.m1.1d">× 4</annotation></semantics></math> more vocabulary resulting in fewer total token counts as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.T1" title="Table 1 ‣ Reaction Score ‣ 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">1</span></a> (e.g., <span class="ltx_text" id="S4.SS2.SSS0.Px1.p2.3.1" style="background-color:#ECECEC;">.T</span> into a single token).
Due to the rich vocabulary, a typo easily blurred sentence boundaries causing many imperfect matches and thus the smallest overall match quality as in the 2-1, 2-2, and 2-3 datasets.
For 1-1, 1-2, and 1-3, datasets, the rich vocabulary worked in favor.
Many atypical char sequences (e.g., <math alttext="&lt;" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.2.m2.1a"><mo id="S4.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.2.m2.1b"><lt id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.2.m2.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.2.m2.1d">&lt;</annotation></semantics></math>b<math alttext="&gt;" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p2.3.m3.1a"><mo id="S4.SS2.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.3.m3.1b"><gt id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.3.m3.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.3.m3.1d">&gt;</annotation></semantics></math>, math formula) were present in these datasets, which were properly represented with tokens using Llama3.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1">Mod</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.2">1-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.3">1-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.4">1-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.5">2-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.6">2-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.7">2-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.8">Avg</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.1">L2</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.2">94.1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.3">83.1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.4">93.5</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.5">98.4</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.6">98.8</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.7">97.8</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.2.2.8">94.3</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.3">
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.1">L3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.2">99.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.3">99.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.4">96.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.5">86.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.6">86.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.7">85.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3.8">92.5</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4.4">
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.1">M</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.2">94.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.3">83.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.4">93.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.5">98.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.6">98.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.7">97.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.8">94.3</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.1">Avg</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.2">96.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.3">88.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.4">94.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.5">94.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.6">94.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.7">93.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.5.8">93.7</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.6.6">
<td class="ltx_td ltx_align_right ltx_border_t" colspan="8" id="S4.T4.1.6.6.1">L2: Llama2-7B, L3: Llama3-8B, M: Mistralv0.2</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation of EASY algorithm’s average sentence match rate (exact match / total # of sentences) for each model and dataset (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S3.T1" title="Table 1 ‣ Reaction Score ‣ 3.1 Problem Statement &amp; Definitions ‣ 3 You Only Use Reactive Attention (YOURA)"><span class="ltx_text ltx_ref_tag">1</span></a>) pairs.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">How resilient is the EASY algorithm from edge cases?</h4>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">To quantify the resilience despite typos and overly representative dictionaries, we measured the Levenshtein distance between the target sentence and the sentence yielded by our EASY algorithm (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.T5" title="Table 5 ‣ How resilient is the EASY algorithm from edge cases? ‣ 4.2 EASY Sentence Splitter Accuracy ‣ 4 Experiments"><span class="ltx_text ltx_ref_tag">5</span></a>).
On average, one needs less than 3 character edits (insert, remove, replace) to the EASY output sentences to match the target sentences.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p2.1">The NZ row in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.T5" title="Table 5 ‣ How resilient is the EASY algorithm from edge cases? ‣ 4.2 EASY Sentence Splitter Accuracy ‣ 4 Experiments"><span class="ltx_text ltx_ref_tag">5</span></a> is the average Levenshtein distance of unmatched sentences.
From these rows, we conclude that the EASY algorithm is resilient to incorrect split and its cascading effect.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.1.1.1">Mod</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.2">1-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.3">1-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.4">1-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.5">2-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.6">2-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.7">2-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.8">Avg</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T5.1.2.2.1">L2</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.2.2.2">3.26</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.2.2.3">3.48</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.2.2.4">2.54</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.2.2.5">2.61</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.2.2.6">2.36</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.2.2.7">2.67</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.2.2.8">2.82</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.3.3.1">NZ</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.3.2">5.40</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.3.3">4.80</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.3.4">4.35</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.3.5">4.22</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.3.6">4.13</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.3.7">4.31</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.3.8">4.54</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.4.4.1">L3</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.4.2">1.71</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.4.3">3.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.4.4">2.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.4.5">3.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.4.6">2.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.4.7">3.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.4.8">2.85</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.5.5.1">NZ</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.5.2">3.70</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.5.3">4.76</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.5.4">4.52</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.5.5">4.53</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.5.6">4.29</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.5.7">4.64</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.5.8">4.41</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.6.6.1">M</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.6.2">3.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.6.3">3.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.6.4">2.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.6.5">2.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.6.6">2.38</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.6.7">2.71</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.6.8">2.89</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.7.7.1">NZ</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.7.2">5.52</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.7.3">4.85</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.7.4">4.40</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.7.5">4.29</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.7.6">4.17</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.7.7">4.38</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.7.8">4.60</td>
</tr>
</tbody>
<tfoot class="ltx_tfoot">
<tr class="ltx_tr" id="S4.T5.1.8.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t" colspan="8" id="S4.T5.1.8.1.1">L2: Llama2-7B, L3: Llama3-8B, M: Mistralv0.2</th>
</tr>
<tr class="ltx_tr" id="S4.T5.1.9.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" colspan="8" id="S4.T5.1.9.2.1">NZ* (Non-Zero): average of non-zero distances.</th>
</tr>
</tfoot>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Average Levenshtein distance between the target sentence and EASY algorithm’s sentence split.
A smaller number indicates fewer character edits (insert, remove, replace) to transform the EASY output sentence to the target sentence, and thus a better quality split.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We propose a simple, yet effective attention-based retrieval algorithm.
We show that attention vectors are useful retrieval and propose novel retrieval heuristics called reaction scores.
Our fine-tuning approach improves the output quality or the inference performance of off-the-shelf models for long-context QA tasks.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023)</span>
<span class="ltx_bibblock">
Bai, Y., Lv, X., Zhang, J., Lyu, H., Tang, J., Huang, Z., Du, Z., Liu, X., Zeng, A., Hou, L., Dong, Y., Tang, J., and Li, J.

</span>
<span class="ltx_bibblock">Longbench: A bilingual, multitask benchmark for long context understanding, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsch et al. (2024)</span>
<span class="ltx_bibblock">
Bertsch, A., Alon, U., Neubig, G., and Gormley, M.

</span>
<span class="ltx_bibblock">Unlimiformer: Long-range transformers with unlimited length input.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgeaud et al. (2022)</span>
<span class="ltx_bibblock">
Borgeaud, S., Mensch, A., Hoffmann, J., Cai, T., Rutherford, E., Millican, K., Van Den Driessche, G. B., Lespiau, J.-B., Damoc, B., Clark, A., et al.

</span>
<span class="ltx_bibblock">Improving language models by retrieving from trillions of tokens.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">International conference on machine learning</em>, pp.  2206–2240. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bulatov et al. (2022)</span>
<span class="ltx_bibblock">
Bulatov, A., Kuratov, Y., and Burtsev, M.

</span>
<span class="ltx_bibblock">Recurrent memory transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Advances in Neural Information Processing Systems</em>, 35:11079–11091, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Catav (2023)</span>
<span class="ltx_bibblock">
Catav, A.

</span>
<span class="ltx_bibblock">Less is more: Why use retrieval instead of larger context windows, Jul 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.pinecone.io/blog/why-use-retrieval-instead-of-larger-context/" title="">https://www.pinecone.io/blog/why-use-retrieval-instead-of-larger-context/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023a)</span>
<span class="ltx_bibblock">
Chen, S., Wong, S., Chen, L., and Tian, Y.

</span>
<span class="ltx_bibblock">Extending context window of large language models via positional interpolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2306.15595</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023b)</span>
<span class="ltx_bibblock">
Chen, Y., Qian, S., Tang, H., Lai, X., Liu, Z., Han, S., and Jia, J.

</span>
<span class="ltx_bibblock">Longlora: Efficient fine-tuning of long-context large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2309.12307</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al. (2024)</span>
<span class="ltx_bibblock">
Ding, Y., Zhang, L. L., Zhang, C., Xu, Y., Shang, N., Xu, J., Yang, F., and Yang, M.

</span>
<span class="ltx_bibblock">Longrope: Extending llm context window beyond 2 million tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2402.13753</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Giorgi et al. (2022)</span>
<span class="ltx_bibblock">
Giorgi, J., Soldaini, L., Wang, B., Bader, G., Lo, K., Wang, L. L., and Cohan, A.

</span>
<span class="ltx_bibblock">Exploring the challenges of open domain multi-document summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">ArXiv, abs/2212.10526</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al. (2023)</span>
<span class="ltx_bibblock">
Izacard, G., Lewis, P., Lomeli, M., Hosseini, L., Petroni, F., Schick, T., Dwivedi-Yu, J., Joulin, A., Riedel, S., and Grave, E.

</span>
<span class="ltx_bibblock">Atlas: Few-shot learning with retrieval augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Journal of Machine Learning Research</em>, 24(251):1–43, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Jiang, H., Wu, Q., Luo, X., Li, D., Lin, C.-Y., Yang, Y., and Qiu, L.

</span>
<span class="ltx_bibblock">Longllmlingua: Accelerating and enhancing llms in long context scenarios via prompt compression, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2022)</span>
<span class="ltx_bibblock">
Jiang, Z., Gao, L., Araki, J., Ding, H., Wang, Z., Callan, J., and Neubig, G.

</span>
<span class="ltx_bibblock">Retrieval as attention: End-to-end learning of retrieval and reading within a single transformer, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2212.02027" title="">https://arxiv.org/abs/2212.02027</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khandelwal et al. (2019)</span>
<span class="ltx_bibblock">
Khandelwal, U., Levy, O., Jurafsky, D., Zettlemoyer, L., and Lewis, M.

</span>
<span class="ltx_bibblock">Generalization through memorization: Nearest neighbor language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1911.00172</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwon et al. (2023)</span>
<span class="ltx_bibblock">
Kwon, W., Li, Z., Zhuang, S., Sheng, Y., Zheng, L., Yu, C. H., Gonzalez, J. E., Zhang, H., and Stoica, I.

</span>
<span class="ltx_bibblock">Efficient memory management for large language model serving with pagedattention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the ACM SIGOPS 29th Symposium on Operating Systems Principles</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Li, S., You, C., Guruganesh, G., Ainslie, J., Ontanon, S., Zaheer, M., Sanghai, S., Yang, Y., Kumar, S., and Bhojanapalli, S.

</span>
<span class="ltx_bibblock">Functional interpolation for relative positions improves long context transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2310.04418</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Liu, Z., Wang, J., Dao, T., Zhou, T., Yuan, B., Song, Z., Shrivastava, A., Zhang, C., Tian, Y., Re, C., et al.

</span>
<span class="ltx_bibblock">Deja vu: Contextual sparsity for efficient llms at inference time.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International Conference on Machine Learning</em>, pp.  22137–22176. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lou et al. (2024)</span>
<span class="ltx_bibblock">
Lou, C., Jia, Z., Zheng, Z., and Tu, K.

</span>
<span class="ltx_bibblock">Sparser is faster and less is more: Efficient sparse attention for long-range transformers, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2406.16747" title="">https://arxiv.org/abs/2406.16747</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2024)</span>
<span class="ltx_bibblock">
Luo, K., Liu, Z., Xiao, S., and Liu, K.

</span>
<span class="ltx_bibblock">Bge landmark embedding: A chunking-free embedding method for retrieval augmented long-context large language models, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mangrulkar et al. (2022)</span>
<span class="ltx_bibblock">
Mangrulkar, S., Gugger, S., Debut, L., Belkada, Y., Paul, S., and Bossan, B.

</span>
<span class="ltx_bibblock">Peft: State-of-the-art parameter-efficient fine-tuning methods.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/huggingface/peft" title="">https://github.com/huggingface/peft</a>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Martins et al. (2021)</span>
<span class="ltx_bibblock">
Martins, P. H., Marinho, Z., and Martins, A. F.

</span>
<span class="ltx_bibblock"><math alttext="\infty" class="ltx_Math" display="inline" id="bib.bib20.1.m1.1"><semantics id="bib.bib20.1.m1.1a"><mi id="bib.bib20.1.m1.1.1" mathvariant="normal" xref="bib.bib20.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="bib.bib20.1.m1.1b"><infinity id="bib.bib20.1.m1.1.1.cmml" xref="bib.bib20.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="bib.bib20.1.m1.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="bib.bib20.1.m1.1d">∞</annotation></semantics></math>-former: Infinite memory transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.2.1">arXiv preprint arXiv:2109.00301</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohtashami &amp; Jaggi (2023)</span>
<span class="ltx_bibblock">
Mohtashami, A. and Jaggi, M.

</span>
<span class="ltx_bibblock">Landmark attention: Random-access infinite context length for transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2305.16300</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2023)</span>
<span class="ltx_bibblock">
Peng, B., Quesnelle, J., Fan, H., and Shippole, E.

</span>
<span class="ltx_bibblock">Yarn: Efficient context window extension of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2309.00071</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et al. (2021)</span>
<span class="ltx_bibblock">
Press, O., Smith, N. A., and Lewis, M.

</span>
<span class="ltx_bibblock">Train short, test long: Attention with linear biases enables input length extrapolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2108.12409</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2020)</span>
<span class="ltx_bibblock">
Qi, P., Zhang, Y., Zhang, Y., Bolton, J., and Manning, C. D.

</span>
<span class="ltx_bibblock">Stanza: A python natural language processing toolkit for many human languages, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stelmakh et al. (2022)</span>
<span class="ltx_bibblock">
Stelmakh, I., Luan, Y., Dhingra, B., and Chang, M.-W.

</span>
<span class="ltx_bibblock">Asqa: Factoid questions meet long-form answers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2204.06092</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2023)</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, L., and Polosukhin, I.

</span>
<span class="ltx_bibblock">Attention is all you need, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Wang, B., Ping, W., Xu, P., McAfee, L., Liu, Z., Shoeybi, M., Dong, Y., Kuchaiev, O., Li, B., Xiao, C., et al.

</span>
<span class="ltx_bibblock">Shall we pretrain autoregressive language models with retrieval? a comprehensive study.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2304.06762</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Wang, W., Dong, L., Cheng, H., Liu, X., Yan, X., Gao, J., and Wei, F.

</span>
<span class="ltx_bibblock">Augmenting language models with long-term memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2020)</span>
<span class="ltx_bibblock">
Wu, Q., Lan, Z., Qian, K., Gu, J., Geramifard, A., and Yu, Z.

</span>
<span class="ltx_bibblock">Memformer: A memory-augmented transformer for sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2010.06891</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2024)</span>
<span class="ltx_bibblock">
Xiao, G., Tian, Y., Chen, B., Han, S., and Lewis, M.

</span>
<span class="ltx_bibblock">Efficient streaming language models with attention sinks, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Zhang, T., Patil, S. G., Jain, N., Shen, S., Zaharia, M., Stoica, I., and Gonzalez, J. E.

</span>
<span class="ltx_bibblock">Raft: Adapting language model to domain specific rag, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2403.10131" title="">https://arxiv.org/abs/2403.10131</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Zhang, Z., Sheng, Y., Zhou, T., Chen, T., Zheng, L., Cai, R., Song, Z., Tian, Y., Ré, C., Barrett, C., Wang, Z., and Chen, B.

</span>
<span class="ltx_bibblock">H<sub class="ltx_sub" id="bib.bib32.2.1">2</sub>o: Heavy-hitter oracle for efficient generative inference of large language models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2024)</span>
<span class="ltx_bibblock">
Zhao, J., Zhang, Z., Chen, B., Wang, Z., Anandkumar, A., and Tian, Y.

</span>
<span class="ltx_bibblock">Galore: Memory-efficient llm training by gradient low-rank projection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2403.03507</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2021)</span>
<span class="ltx_bibblock">
Zhu, C., Ping, W., Xiao, C., Shoeybi, M., Goldstein, T., Anandkumar, A., and Catanzaro, B.

</span>
<span class="ltx_bibblock">Long-short transformer: Efficient transformers for language and vision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Advances in neural information processing systems</em>, 34:17723–17736, 2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Detailed Results</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#A1.T6" title="Table 6 ‣ Appendix A Detailed Results"><span class="ltx_text ltx_ref_tag">6</span></a>, Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#A1.T7" title="Table 7 ‣ Appendix A Detailed Results"><span class="ltx_text ltx_ref_tag">7</span></a> are the detailed version of Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.T2" title="Table 2 ‣ Experiment Setup ‣ 4 Experiments"><span class="ltx_text ltx_ref_tag">2</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13695v1#S4.T3" title="Table 3 ‣ 4.1 Longbench QA Result ‣ 4 Experiments"><span class="ltx_text ltx_ref_tag">3</span></a>, respectively.</p>
</div>
<figure class="ltx_table" id="A1.T6">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.1.1.1.1">Setup</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="A1.T6.1.1.1.2">Retr. Rate</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="A1.T6.1.1.1.3">Single-Document QA</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_t" id="A1.T6.1.1.1.4">SDoc</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="A1.T6.1.1.1.5">Multi-Document QA</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_t" id="A1.T6.1.1.1.6">MDoc</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A1.T6.1.1.1.7">Overall</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.2.2">
<td class="ltx_td ltx_border_r" id="A1.T6.1.2.2.1"></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.2.2.2">Avg</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.2.2.3">1-1</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.2.2.4">1-2</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.2.2.5">1-3</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.2.2.6">Avg</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.2.2.7">2-1</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.2.2.8">2-2</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.2.2.9">2-3</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.2.2.10">Avg</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.2.2.11">Avg</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T6.1.3.3.1">LLaMA2</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" id="A1.T6.1.3.3.2">INF</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.3.3.3">8.89</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.3.3.4">13.87</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.3.3.5">18.19</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_tt" id="A1.T6.1.3.3.6">13.65</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.3.3.7">23.05</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.3.3.8">25.67</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.3.3.9">9.17</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_tt" id="A1.T6.1.3.3.10">19.30</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="A1.T6.1.3.3.11">16.47</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.4.4.1">w/ B500_7</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.4.4.2">3.28</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.4.4.3">12.59</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.4.4.4">21.44</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.4.4.5">34.42</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.4.4.6">22.82</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.4.4.7">25.92</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.4.4.8">27.47</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.4.4.9">7.11</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.4.4.10">20.17</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.4.4.11">21.49</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.5.5.1">w/ B50_70</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.5.5.2">3.28</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.5.5.3">16.37</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.5.5.4">21.51</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.5.5.5">33.71</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.5.5.6">23.86</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.5.5.7">27.48</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.5.5.8">28.62</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.5.5.9">13.64</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.5.5.10">23.25</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.5.5.11">23.56</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.6.6.1">w/ E500_7</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.6.6.2">3.28</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.6.6.3">12.85</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.6.6.4">16.08</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.6.6.5">22.47</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.6.6.6">17.13</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.6.6.7">25.51</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.6.6.8">24.84</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.6.6.9">8.35</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.6.6.10">19.57</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.6.6.11">18.35</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.7.7.1">w/ E50_70</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.7.7.2">3.28</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.7.7.3">17.15</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.7.7.4">20.12</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.7.7.5">35.18</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.7.7.6">24.15</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.7.7.7">28.80</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.7.7.8">27.15</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.7.7.9">12.66</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.7.7.10">22.87</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.7.7.11">23.51</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.8.8.1">w/ Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.8.8.2">3.28</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.8.8.3"><span class="ltx_text ltx_font_bold" id="A1.T6.1.8.8.3.1">18.84</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.8.8.4">21.71</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.8.8.5"><span class="ltx_text ltx_font_bold" id="A1.T6.1.8.8.5.1">36.68</span></td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.8.8.6"><span class="ltx_text ltx_font_bold" id="A1.T6.1.8.8.6.1">25.74</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.8.8.7">27.55</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.8.8.8">31.08</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.8.8.9">8.40</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.8.8.10">22.34</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.8.8.11">24.04</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.9.9.1">w/ YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.9.9.2">3.39</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.9.9.3">15.48</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.9.9.4"><span class="ltx_text ltx_font_bold" id="A1.T6.1.9.9.4.1">23.41</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.9.9.5">30.77</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.9.9.6">23.22</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.9.9.7"><span class="ltx_text ltx_font_bold" id="A1.T6.1.9.9.7.1">29.55</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.9.9.8"><span class="ltx_text ltx_font_bold" id="A1.T6.1.9.9.8.1">31.11</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.9.9.9"><span class="ltx_text ltx_font_bold" id="A1.T6.1.9.9.9.1">14.86</span></td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.9.9.10"><span class="ltx_text ltx_font_bold" id="A1.T6.1.9.9.10.1">25.17</span></td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.9.9.11"><span class="ltx_text ltx_font_bold" id="A1.T6.1.9.9.11.1">24.20</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T6.1.10.10.1">LLaMA3</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" id="A1.T6.1.10.10.2">INF</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.10.10.3">9.62</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.10.10.4">14.38</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.10.10.5">10.78</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_tt" id="A1.T6.1.10.10.6">11.59</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.10.10.7">28.43</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.10.10.8">30.46</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.10.10.9">10.60</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_tt" id="A1.T6.1.10.10.10">23.16</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="A1.T6.1.10.10.11">17.37</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.11.11">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.11.11.1">w/ B500</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.11.11.2">1.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.11.11.3">18.27</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.11.11.4">40.21</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.11.11.5">43.72</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.11.11.6">34.07</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.11.11.7">41.75</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.11.11.8">41.18</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.11.11.9">16.88</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.11.11.10">33.27</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.11.11.11">33.73</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.12.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.12.12.1">w/ B50</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.12.12.2">1.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.12.12.3">19.86</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.12.12.4">36.51</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.12.12.5">42.39</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.12.12.6">32.92</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.12.12.7">47.04</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.12.12.8">40.58</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.12.12.9">19.86</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.12.12.10">35.83</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.12.12.11">34.17</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.13.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.13.13.1">w/ E500</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.13.13.2">1.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.13.13.3">16.38</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.13.13.4">39.85</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.13.13.5">43.76</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.13.13.6">33.33</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.13.13.7">42.28</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.13.13.8">34.93</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.13.13.9">15.25</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.13.13.10">30.82</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.13.13.11">32.08</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.14.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.14.14.1">w/ E50</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.14.14.2">1.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.14.14.3">19.05</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.14.14.4">35.44</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.14.14.5">40.02</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.14.14.6">31.50</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.14.14.7">48.05</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.14.14.8"><span class="ltx_text ltx_font_bold" id="A1.T6.1.14.14.8.1">36.85</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.14.14.9">22.19</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.14.14.10">35.70</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.14.14.11">33.60</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.15.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.15.15.1">w/ Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.15.15.2">1.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.15.15.3"><span class="ltx_text ltx_font_bold" id="A1.T6.1.15.15.3.1">21.54</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.15.15.4"><span class="ltx_text ltx_font_bold" id="A1.T6.1.15.15.4.1">44.21</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.15.15.5">44.75</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.15.15.6"><span class="ltx_text ltx_font_bold" id="A1.T6.1.15.15.6.1">36.83</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.15.15.7">46.43</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.15.15.8">36.23</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.15.15.9">21.50</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.15.15.10">34.72</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.15.15.11">35.93</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.16.16">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.16.16.1">w/ YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.16.16.2">1.76</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.16.16.3">21.47</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.16.16.4">42.39</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.16.16.5"><span class="ltx_text ltx_font_bold" id="A1.T6.1.16.16.5.1">45.85</span></td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.16.16.6">36.57</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.16.16.7"><span class="ltx_text ltx_font_bold" id="A1.T6.1.16.16.7.1">50.78</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.16.16.8">34.24</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.16.16.9"><span class="ltx_text ltx_font_bold" id="A1.T6.1.16.16.9.1">24.29</span></td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.16.16.10"><span class="ltx_text ltx_font_bold" id="A1.T6.1.16.16.10.1">36.44</span></td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.16.16.11"><span class="ltx_text ltx_font_bold" id="A1.T6.1.16.16.11.1">36.50</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.17.17">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T6.1.17.17.1">Mistralv0.2</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" id="A1.T6.1.17.17.2">INF</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.17.17.3">7.24</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.17.17.4">7.69</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.17.17.5">6.13</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_tt" id="A1.T6.1.17.17.6">7.02</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.17.17.7">16.41</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.17.17.8">11.87</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="A1.T6.1.17.17.9">6.13</td>
<td class="ltx_td ltx_align_right ltx_border_rr ltx_border_tt" id="A1.T6.1.17.17.10">11.47</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="A1.T6.1.17.17.11">9.25</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.18.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.18.18.1">w/ B500_63</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.18.18.2">1.04</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.18.18.3">20.74</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.18.18.4">29.22</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.18.18.5">46.91</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.18.18.6">32.29</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.18.18.7">34.26</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.18.18.8">22.26</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.18.18.9">17.47</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.18.18.10">24.66</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.18.18.11">29.02</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.19.19">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.19.19.1">w/ B50_630</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.19.19.2">1.04</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.19.19.3">18.84</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.19.19.4">25.08</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.19.19.5">43.50</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.19.19.6">29.14</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.19.19.7">32.85</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.19.19.8">18.66</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.19.19.9">18.32</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.19.19.10">23.28</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.19.19.11">26.63</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.20.20">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.20.20.1">w/ E500_63</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.20.20.2">1.04</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.20.20.3">14.02</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.20.20.4">24.14</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.20.20.5">42.22</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.20.20.6">26.79</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.20.20.7">32.81</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.20.20.8">17.55</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.20.20.9">15.82</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.20.20.10">22.06</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.20.20.11">24.76</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.21.21">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.21.21.1">w/ E50_630</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.21.21.2">1.04</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.21.21.3">18.84</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.21.21.4">25.08</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.21.21.5">43.50</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.21.21.6">29.14</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.21.21.7">32.85</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.21.21.8">18.66</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.21.21.9">18.32</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.21.21.10">23.28</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.21.21.11">26.63</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.22.22">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.22.22.1">w/ Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.22.22.2">1.04</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.22.22.3">20.80</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.22.22.4">29.23</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.22.22.5"><span class="ltx_text ltx_font_bold" id="A1.T6.1.22.22.5.1">47.92</span></td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.22.22.6">32.65</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.22.22.7"><span class="ltx_text ltx_font_bold" id="A1.T6.1.22.22.7.1">37.28</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.22.22.8"><span class="ltx_text ltx_font_bold" id="A1.T6.1.22.22.8.1">21.72</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.22.22.9"><span class="ltx_text ltx_font_bold" id="A1.T6.1.22.22.9.1">20.86</span></td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.22.22.10"><span class="ltx_text ltx_font_bold" id="A1.T6.1.22.22.10.1">26.62</span></td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.22.22.11"><span class="ltx_text ltx_font_bold" id="A1.T6.1.22.22.11.1">29.64</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.23.23">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.1.23.23.1">w/ YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="A1.T6.1.23.23.2">1.33</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.23.23.3"><span class="ltx_text ltx_font_bold" id="A1.T6.1.23.23.3.1">22.37</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.23.23.4"><span class="ltx_text ltx_font_bold" id="A1.T6.1.23.23.4.1">30.17</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.23.23.5">46.88</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.23.23.6"><span class="ltx_text ltx_font_bold" id="A1.T6.1.23.23.6.1">33.14</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.23.23.7">36.11</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.23.23.8">21.45</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T6.1.23.23.9">19.95</td>
<td class="ltx_td ltx_align_right ltx_border_rr" id="A1.T6.1.23.23.10">25.84</td>
<td class="ltx_td ltx_align_right" id="A1.T6.1.23.23.11">29.49</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.24.24">
<td class="ltx_td ltx_align_right ltx_border_t" colspan="11" id="A1.T6.1.24.24.1">The <span class="ltx_text ltx_font_bold" id="A1.T6.1.24.24.1.1">bold score</span> indicates the best score for each pre-trained model.</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Detailed experiment results for LongBench’s single-document and multi-document QA datasets. YOURA shows better quality with a higher retrieval ratio — i.e., retrieved fewer tokens. All retrieval scenarios use the maximal budget (4K, 8K, and 32K tokens depending on model) except for without-context setup and “YOURA”. Retrieval ratio (second column) is an average of the total token count divided by the retrieved token count.</figcaption>
</figure>
<figure class="ltx_table" id="A1.T7">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.1.1.1">Model</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.1.1.2">Retrieval</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="A1.T7.1.1.1.3">Single-Document QA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="A1.T7.1.1.1.4">Multi-Document QA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.1.1.5">Overall Avg</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.2.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.2.2.1"></th>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.2.2.2">Method</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.2.2.3">1-1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.2.2.4">1-2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.2.2.5">1-3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.2.2.6">2-1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.2.2.7">2-2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.2.2.8">2-3</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.2.2.9">Req./Sec</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.3.3.1">LLaMA2</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.3.3.2">Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.3.3.3">5.58</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.3.3.4">4.68</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.3.3.5">5.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.3.3.6"><span class="ltx_text ltx_font_bold" id="A1.T7.1.3.3.6.1">5.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.3.3.7">5.87</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.3.3.8"><span class="ltx_text ltx_font_bold" id="A1.T7.1.3.3.8.1">5.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.3.3.9">5.50</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.4.4.1">LLaMA2</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.4.4.2">YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.4.4.3"><span class="ltx_text ltx_font_bold" id="A1.T7.1.4.4.3.1">5.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.4.4.4"><span class="ltx_text ltx_font_bold" id="A1.T7.1.4.4.4.1">4.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.4.4.5"><span class="ltx_text ltx_font_bold" id="A1.T7.1.4.4.5.1">5.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.4.4.6">5.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.4.4.7"><span class="ltx_text ltx_font_bold" id="A1.T7.1.4.4.7.1">6.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.4.4.8">5.63</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.4.9"><span class="ltx_text ltx_font_bold" id="A1.T7.1.4.4.9.1">5.60 (+2%)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.5.5.1">LLaMA3</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.5.5.2">Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.5.5.3">2.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.5.5.4">3.95</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.5.5.5">3.23</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.5.5.6">2.63</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.5.5.7">3.23</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.5.5.8">2.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.5.5.9">3.01</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.6.6.1">LLaMA3</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.6.6.2">YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.6.6.3"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.3.1">2.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.6.6.4"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.4.1">4.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.6.6.5"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.5.1">3.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.6.6.6"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.6.1">2.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.6.6.7"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.7.1">3.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T7.1.6.6.8"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.8.1">2.53</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.6.6.9"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.6.9.1">3.39 (+13%)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.7.7.1">Mistralv0.2</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.7.7.2">Trunc.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.7.7.3">0.55</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.7.7.4">3.17</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.7.7.5">2.19</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.7.7.6">1.08</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.7.7.7">2.14</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T7.1.7.7.8">0.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.7.7.9">1.66</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T7.1.8.8.1">Mistralv0.2</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T7.1.8.8.2">YOURA</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T7.1.8.8.3"><span class="ltx_text ltx_font_bold" id="A1.T7.1.8.8.3.1">0.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T7.1.8.8.4"><span class="ltx_text ltx_font_bold" id="A1.T7.1.8.8.4.1">4.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T7.1.8.8.5"><span class="ltx_text ltx_font_bold" id="A1.T7.1.8.8.5.1">2.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T7.1.8.8.6"><span class="ltx_text ltx_font_bold" id="A1.T7.1.8.8.6.1">1.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T7.1.8.8.7"><span class="ltx_text ltx_font_bold" id="A1.T7.1.8.8.7.1">2.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T7.1.8.8.8"><span class="ltx_text ltx_font_bold" id="A1.T7.1.8.8.8.1">1.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T7.1.8.8.9"><span class="ltx_text ltx_font_bold" id="A1.T7.1.8.8.9.1">2.18 (+31%)</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>vLLM Serving performance (request per second, higher the better) for LongBench’s single-document and multi-document QA datasets with respect to Truncation and YOURA. YOURA retrieved fewer tokens resulting in upto 30% higher inference throughput.</figcaption>
</figure>
</section><div about="" class="ltx_rdf" content="Anonymous Authors" property="dcterms:creator"></div>
<div about="" class="ltx_rdf" content="Long Context Retrieval, RAG" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" content="mlsys 2024" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" content="\text@underline{Y}ou \text@underline{O}nly \text@underline{U}se \text@underline{R}eactive \text@underline{A}ttention Slice\\
for Long Context Retrieval" property="dcterms:title"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Sep  3 05:05:14 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
