<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.13575] FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization</title><meta property="og:description" content="In federated learning, particularly in cross-device scenarios, secure aggregation has recently gained popularity as it effectively defends against inference attacks by malicious aggregators. However, secure aggregationâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.13575">

<!--Generated on Sun May  5 20:48:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xu Yang<sup id="id6.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiapeng Zhang<sup id="id7.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qifeng Zhang<sup id="id8.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhuo Tang<sup id="id9.3.id1" class="ltx_sup">1</sup>
<sup id="id10.4.id2" class="ltx_sup">1</sup>Hunan University 
<br class="ltx_break">{yangxv, zhangjp,zqfhnucsee,ztang}@hnu.edu.cn
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">In federated learning, particularly in cross-device scenarios, secure aggregation has recently gained popularity as it effectively defends against inference attacks by malicious aggregators. However, secure aggregation often requires additional communication overhead and can impede the convergence rate of the global model, which is particularly challenging in wireless network environments with extremely limited bandwidth. Therefore, achieving efficient communication compression under the premise of secure aggregation presents a highly challenging and valuable problem.
In this work, we propose a novel uplink communication compression method for federated learning, named FedMPQ.
Specifically, we utilize updates from the previous round to generate multiple robust codebooks. Secure aggregation is then achieved through trusted execution environments (TEE) or a trusted third party (TTP).
In contrast to previous works, our approach exhibits greater robustness especially in scenarios where the data is not independently and identically distributed (non-IID) and there is a lack of sufficient public data.
The experiments conducted on the LEAF dataset demonstrate that our proposed method achieves 99% of the uncompressed baselineâ€™s final accuracy, while reducing the uplink communications by 90-95%.
</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) is a secure distributed learning paradigm designed to train a global model using data dispersed across a large-scale and distributed group of edge devicesÂ <cite class="ltx_cite ltx_citemacro_cite">Kairouz <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>.
Rather than simply transmitting raw data, federated learning involves an iterative process of parameter sharing between devices and a server through heterogeneous networks. Besides, the number of participating devices can be extensive, while being connected to the internet in a slow or unstable manner.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In the design of conventional cross-device federated learning systems, during each training round, the server initiates the process by broadcasting the model to the clients.
Subsequently, clients conduct training based on their respective data and update the model using gradient descent algorithms.
The updates are then transmitted back to the server, which aggregates them considering updates from all clients in the current round. In the context of cross-device federated learning, hundreds to thousands of personal/IoT devices actively participate in each training round.
Consequently, given the characteristics of edge devices, several pressing challenges need immediate attention in cross-device federated learning.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">First and foremost, the efficiency of communication, especially in terms of the uploading process, becomes paramount in cross-device federated learning.
Under the mainstream federated learning network architecture like a mobile network, the downlink bandwidth is typically <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="8-20" display="inline"><semantics id="S1.p3.1.m1.1a"><mrow id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mn id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">8</mn><mo id="S1.p3.1.m1.1.1.1" xref="S1.p3.1.m1.1.1.1.cmml">âˆ’</mo><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><minus id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1"></minus><cn type="integer" id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">8</cn><cn type="integer" id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">8-20</annotation></semantics></math> times greater than the uplink bandwidthÂ <cite class="ltx_cite ltx_citemacro_cite">Lee <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2012</a>)</cite>, leading to a high congestion in the parameter uploading process.
Second, all clients are considered stateless, as individual clients participate in either a single round or several discontinuous rounds of the whole training process.
Third, these edge devices may have limited computational capabilities, which consequently become unbearable to the excessive computational overhead.
Fourth, client data is usually non-IID and highly sensitive in terms of privacyÂ <cite class="ltx_cite ltx_citemacro_cite">Kairouz <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2404.13575/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="457" height="228" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.2.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.2.1" class="ltx_text" style="font-size:90%;">Gradient leak.
The gradient updates from clients are exposed to the server, allowing the server to potentially infer certain features of the training data by analyzing these updates.
Where <math id="S1.F1.2.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S1.F1.2.1.m1.1b"><mi id="S1.F1.2.1.m1.1.1" xref="S1.F1.2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S1.F1.2.1.m1.1c"><ci id="S1.F1.2.1.m1.1.1.cmml" xref="S1.F1.2.1.m1.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.1.m1.1d">D</annotation></semantics></math> represents the client-customized reconstruction operation.</span></figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In light of the aforementioned challenges, the following question has become a focal point in federated learning:
<span id="S1.p4.1.1" class="ltx_text ltx_font_bold">how to reduce uplink communications and preserve model accuracy, all under the umbrella of ensuring user privacy?</span>
Numerous ongoing efforts explore the application of gradient compression algorithms in federated learning to mitigate communication overhead.
These efforts draw inspiration primarily from data-center-based training methods such as QSGDÂ <cite class="ltx_cite ltx_citemacro_cite">Alistarh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2017</a>)</cite>, PruningÂ <cite class="ltx_cite ltx_citemacro_cite">Sahu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2021</a>); <a href="#bib.bib22" title="" class="ltx_ref">Zhang <span class="ltx_text ltx_font_italic">et al.</span> </a></cite> and product quantizationÂ <cite class="ltx_cite ltx_citemacro_cite">Dai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite>.
While these algorithms demonstrate significant effectiveness and broad applicability, they often lack customized adaptations tailored to the distinctive characteristics of federated learning. This limitation not only impacts the convergence rate as well as the accuracy of the global model, but also introduces potential privacy vulnerabilities.
As shown in FigureÂ <a href="#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, all clients employ specialized compressors to compress the updates before uploading them.
Consequently, the server must individually reconstruct each clientâ€™s updates before the aggregation step, leading to a risk of gradient leakage.
It is imperative to prevent this situation, as an honest yet inquisitive server might be able to infer the training data employed in the current round from the reconstructed gradient.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To tackle this, we present a secure and communication-efficient federated learning method with multi-codebook product quantization.
In contrast to previous artsÂ <cite class="ltx_cite ltx_citemacro_cite">Oh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib15" title="" class="ltx_ref">2022</a>); Prasad <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> which use traditional product quantization or rely solely on public data, we combine local public data with the previous roundâ€™s updates to predict several shared codebooks for the upcoming round.
Specifically, during each training round, clients not only upload compressed updates but also contribute pseudo-codebooks generated from their updates. The server then generates multiple shared codebooks based on these pseudo-codebooks, which are employed for the subsequent round of training.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">This approach empowers us to obtain more robust codebooks and mitigates the impact of non-IID public data.
To safeguard data privacy, updates are aggregated within a TEE or by a TTP in the compressed domain before being decompressed, ensuring that no single party can reconstruct the updates.
Furthermore, we introduce a pruning-based error residual compression strategy, allowing clients to flexibly control the compression rate.
Therefore, it achieves data security and uplink communication compression under the common but stringent real-world scenarios, such as: (<span id="S1.p6.1.1" class="ltx_text ltx_font_bold">i</span>) Clients require flexible control over the uplink communication compression rate to adapt to varying network conditions.
(<span id="S1.p6.1.2" class="ltx_text ltx_font_bold">ii</span>) The server maintains a small amount of public data, but it differs significantly from client data.
(<span id="S1.p6.1.3" class="ltx_text ltx_font_bold">iii</span>) Participating training clients are stateless, have low device capabilities, and are numerous.
(<span id="S1.p6.1.4" class="ltx_text ltx_font_bold">iv</span>) The compression method must be suitable for secure aggregation to prevent gradient leakage.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In summary, we present the key contributions in this paper:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce FedMPQ, a novel multi-codebook product quantization compression method, which combines local public data and client updates to generate multiple codebooks.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">To the best of our knowledge, we are the first to optimize product quantization with a residual error
pruning process, addressing the issue of inflexibility in controlling the compression rate inherent in product quantization.
</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We also propose a novel aggregation scheme in which client updates are sent for aggregation in the TEE or by a TTP in the compressed domain.
This approach ensuring that neither the server nor the third party can reconstruct the source data.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">The experiments demonstrate that our proposed method achieves a higher convergence rate compared to previous works under a similar compression ratio without compromising the trained modelâ€™s accuracy. The method even works better in the scenarios with non-IID data.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2404.13575/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.4.2.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S1.F2.2.1" class="ltx_text" style="font-size:90%;">The training process of FedMPQ Framework. In each training round, <math id="S1.F2.2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S1.F2.2.1.m1.1b"><mi id="S1.F2.2.1.m1.1.1" xref="S1.F2.2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.F2.2.1.m1.1c"><ci id="S1.F2.2.1.m1.1.1.cmml" xref="S1.F2.2.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.2.1.m1.1d">N</annotation></semantics></math> clients participate, and each client uploads residual error, code, and pseudo-centroids. For further details, please refer to sectionÂ <a href="#S3" title="3 Proposed Method â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Best view in color.</span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Cross-device Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Federated learning is a machine learning setting where multiple clients collaborate in solving a machine learning problem, under the coordination of a central server.
Further, cross-device FL represents a more challenging and prevalent scenario within the field.
In addition to common constraints such as non-IID and privacy-sensitive data, this setting involves a large number of participating devices with limited computational capabilities and possibly unstable network conditions.
Consequently, the balance among the privacy security, communication efficiency and model accuracy stands as a central objective in the realm of cross-device federated learning.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Federated Learning with Server Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Federated learning faces performance challenges when the training data among clients is non-IID.
A novel complementary approach to mitigate this performance degradation involves leveraging a small public dataset when the server has access to it. The server can employ various techniques, such as auxiliary learning based on the public dataÂ <cite class="ltx_cite ltx_citemacro_cite">Mai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite> or dynamic hyperparameter tuningÂ <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib22" title="" class="ltx_ref">Zhang <span class="ltx_text ltx_font_italic">et al.</span> </a></cite>, to address this issue.
This approach has also been incorporated into communication compression strategiesÂ <cite class="ltx_cite ltx_citemacro_cite">Prasad <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>, where the server simulates the next-round updates using a public dataset.
These simulated updates are then used to tailor the next roundâ€™s communication compression strategy.
When the distribution of server data is similar to that of the aggregate samples of all clients, this strategy yields significant benefits.
However, accurately determining the overall sample distribution of clients in practice remains a demanding task.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Secure Aggregation</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">In federated learning, it is possible to gain insights into the training data through methods such as membership inference or reconstruction attacks targeted at a trained modelÂ <cite class="ltx_cite ltx_citemacro_cite">Carlini <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2022</a>); Xiao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib21" title="" class="ltx_ref">2023</a>)</cite>.
Additionally, the transmission of local updates can inadvertently lead to data exposureÂ <cite class="ltx_cite ltx_citemacro_cite">Geiping <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>.
To prevent the server from directly inspecting updates from each client, which is a primary avenue for information leakage, the Secure Aggregation protocol has been introduced.
Secure Aggregation is a widely used component in large-scale cross-device federated learning implementations, allowing server aggregation of client updates without requiring individual access to them.
While it does not provide complete prevention against client data leakage, it remains a practical protocol in cross-device federated learning where user communication and computational resources are limitedÂ <cite class="ltx_cite ltx_citemacro_cite">Kairouz <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Communication Compress</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">Communication compression is a crucial aspect of cross-device federated learning since clients often use unreliable and slow wireless networks to upload and receive parameters.
Uplink communication poses more challenges compared to downlink communicationÂ <cite class="ltx_cite ltx_citemacro_cite">Prasad <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>.
PowerSGDÂ <cite class="ltx_cite ltx_citemacro_cite">Vogels <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite> introduced an efficient low-rank gradient compressor, which improves convergence rate through error feedback. Methods such as FedVQCSÂ <cite class="ltx_cite ltx_citemacro_cite">Oh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2023</a>)</cite> employ PQ-based compression strategies, achieving high compression ratios.
However, the aforementioned approaches are not compatible with the secure aggregation paradigm, limiting their applicability.
While compression methods proposed in FetchSGDÂ <cite class="ltx_cite ltx_citemacro_cite">Rothchild <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Prasad <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> can be adapted to secure aggregation protocols, there is still room for improvement in scenarios where client data is non-IID.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p">In the context of federated learning, given an original uncompressed parameter set <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="G={g_{i}}_{i=1}^{N}" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">G</mi><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">=</mo><mmultiscripts id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2.2.2" xref="S3.p1.1.m1.1.1.3.2.2.2.cmml">g</mi><mi id="S3.p1.1.m1.1.1.3.2.2.3" xref="S3.p1.1.m1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.p1.1.m1.1.1.3a" xref="S3.p1.1.m1.1.1.3.cmml"></mrow><mrow id="S3.p1.1.m1.1.1.3.2.3" xref="S3.p1.1.m1.1.1.3.2.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2.3.2" xref="S3.p1.1.m1.1.1.3.2.3.2.cmml">i</mi><mo id="S3.p1.1.m1.1.1.3.2.3.1" xref="S3.p1.1.m1.1.1.3.2.3.1.cmml">=</mo><mn id="S3.p1.1.m1.1.1.3.2.3.3" xref="S3.p1.1.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml">N</mi></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><eq id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></eq><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">ğº</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3">superscript</csymbol><apply id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.2.1.cmml" xref="S3.p1.1.m1.1.1.3">subscript</csymbol><apply id="S3.p1.1.m1.1.1.3.2.2.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.2.2.1.cmml" xref="S3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.p1.1.m1.1.1.3.2.2.2.cmml" xref="S3.p1.1.m1.1.1.3.2.2.2">ğ‘”</ci><ci id="S3.p1.1.m1.1.1.3.2.2.3.cmml" xref="S3.p1.1.m1.1.1.3.2.2.3">ğ‘–</ci></apply><apply id="S3.p1.1.m1.1.1.3.2.3.cmml" xref="S3.p1.1.m1.1.1.3.2.3"><eq id="S3.p1.1.m1.1.1.3.2.3.1.cmml" xref="S3.p1.1.m1.1.1.3.2.3.1"></eq><ci id="S3.p1.1.m1.1.1.3.2.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2.3.2">ğ‘–</ci><cn type="integer" id="S3.p1.1.m1.1.1.3.2.3.3.cmml" xref="S3.p1.1.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">G={g_{i}}_{i=1}^{N}</annotation></semantics></math> that includes updates from <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">N</annotation></semantics></math> clients in a round, we aim to construct operations <math id="S3.p1.3.m3.2" class="ltx_Math" alttext="(\mathcal{Q},\mathcal{D})" display="inline"><semantics id="S3.p1.3.m3.2a"><mrow id="S3.p1.3.m3.2.3.2" xref="S3.p1.3.m3.2.3.1.cmml"><mo stretchy="false" id="S3.p1.3.m3.2.3.2.1" xref="S3.p1.3.m3.2.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">ğ’¬</mi><mo id="S3.p1.3.m3.2.3.2.2" xref="S3.p1.3.m3.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.2.2" xref="S3.p1.3.m3.2.2.cmml">ğ’Ÿ</mi><mo stretchy="false" id="S3.p1.3.m3.2.3.2.3" xref="S3.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.2b"><interval closure="open" id="S3.p1.3.m3.2.3.1.cmml" xref="S3.p1.3.m3.2.3.2"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">ğ’¬</ci><ci id="S3.p1.3.m3.2.2.cmml" xref="S3.p1.3.m3.2.2">ğ’Ÿ</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.2c">(\mathcal{Q},\mathcal{D})</annotation></semantics></math>, representing compression and decompression, respectively.
The objective is to fulfill the following condition:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\mathcal{D}(\frac{1}{N}\sum_{i=1}^{N}\mathcal{Q}(g_{i}))=\frac{1}{N}\sum_{i=1}^{N}\mathcal{D}(\mathcal{Q}(g_{i}))\approx\frac{1}{N}\sum_{i=1}^{N}g_{i}." display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">ğ’Ÿ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mfrac id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">âˆ‘</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">ğ’¬</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mfrac id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml"><mn id="S3.E1.m1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.2.3.2.cmml">1</mn><mi id="S3.E1.m1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.2.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml">â€‹</mo><mrow id="S3.E1.m1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.2.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.2.1.2" xref="S3.E1.m1.1.1.1.1.2.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.2.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.1.2.2.2.cmml">âˆ‘</mo><mrow id="S3.E1.m1.1.1.1.1.2.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.2.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.2.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.2.1.2.3" xref="S3.E1.m1.1.1.1.1.2.1.2.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.2.1.1" xref="S3.E1.m1.1.1.1.1.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.1.1.3" xref="S3.E1.m1.1.1.1.1.2.1.1.3.cmml">ğ’Ÿ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.1.1.2" xref="S3.E1.m1.1.1.1.1.2.1.1.2.cmml">â€‹</mo><mrow id="S3.E1.m1.1.1.1.1.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.3.cmml">ğ’¬</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.5" xref="S3.E1.m1.1.1.1.1.5.cmml">â‰ˆ</mo><mrow id="S3.E1.m1.1.1.1.1.6" xref="S3.E1.m1.1.1.1.1.6.cmml"><mfrac id="S3.E1.m1.1.1.1.1.6.2" xref="S3.E1.m1.1.1.1.1.6.2.cmml"><mn id="S3.E1.m1.1.1.1.1.6.2.2" xref="S3.E1.m1.1.1.1.1.6.2.2.cmml">1</mn><mi id="S3.E1.m1.1.1.1.1.6.2.3" xref="S3.E1.m1.1.1.1.1.6.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.6.1" xref="S3.E1.m1.1.1.1.1.6.1.cmml">â€‹</mo><mrow id="S3.E1.m1.1.1.1.1.6.3" xref="S3.E1.m1.1.1.1.1.6.3.cmml"><munderover id="S3.E1.m1.1.1.1.1.6.3.1" xref="S3.E1.m1.1.1.1.1.6.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.6.3.1.2.2" xref="S3.E1.m1.1.1.1.1.6.3.1.2.2.cmml">âˆ‘</mo><mrow id="S3.E1.m1.1.1.1.1.6.3.1.2.3" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.6.3.1.2.3.2" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.6.3.1.2.3.1" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.6.3.1.2.3.3" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.6.3.1.3" xref="S3.E1.m1.1.1.1.1.6.3.1.3.cmml">N</mi></munderover><msub id="S3.E1.m1.1.1.1.1.6.3.2" xref="S3.E1.m1.1.1.1.1.6.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.6.3.2.2" xref="S3.E1.m1.1.1.1.1.6.3.2.2.cmml">g</mi><mi id="S3.E1.m1.1.1.1.1.6.3.2.3" xref="S3.E1.m1.1.1.1.1.6.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><and id="S3.E1.m1.1.1.1.1a.cmml" xref="S3.E1.m1.1.1.1"></and><apply id="S3.E1.m1.1.1.1.1b.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4"></eq><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">ğ’Ÿ</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"><divide id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3">ğ‘</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.2">ğ‘–</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3">ğ‘</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3">ğ’¬</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ‘”</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"></times><apply id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3"><divide id="S3.E1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.3"></divide><cn type="integer" id="S3.E1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3.3">ğ‘</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1"><apply id="S3.E1.m1.1.1.1.1.2.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.2.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.2.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.2.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3.2">ğ‘–</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.2.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.2.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.1.2.3">ğ‘</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1"><times id="S3.E1.m1.1.1.1.1.2.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.2.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.3">ğ’Ÿ</ci><apply id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.3">ğ’¬</ci><apply id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2">ğ‘”</ci><ci id="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1c.cmml" xref="S3.E1.m1.1.1.1"><approx id="S3.E1.m1.1.1.1.1.5.cmml" xref="S3.E1.m1.1.1.1.1.5"></approx><share href="#S3.E1.m1.1.1.1.1.2.cmml" id="S3.E1.m1.1.1.1.1d.cmml" xref="S3.E1.m1.1.1.1"></share><apply id="S3.E1.m1.1.1.1.1.6.cmml" xref="S3.E1.m1.1.1.1.1.6"><times id="S3.E1.m1.1.1.1.1.6.1.cmml" xref="S3.E1.m1.1.1.1.1.6.1"></times><apply id="S3.E1.m1.1.1.1.1.6.2.cmml" xref="S3.E1.m1.1.1.1.1.6.2"><divide id="S3.E1.m1.1.1.1.1.6.2.1.cmml" xref="S3.E1.m1.1.1.1.1.6.2"></divide><cn type="integer" id="S3.E1.m1.1.1.1.1.6.2.2.cmml" xref="S3.E1.m1.1.1.1.1.6.2.2">1</cn><ci id="S3.E1.m1.1.1.1.1.6.2.3.cmml" xref="S3.E1.m1.1.1.1.1.6.2.3">ğ‘</ci></apply><apply id="S3.E1.m1.1.1.1.1.6.3.cmml" xref="S3.E1.m1.1.1.1.1.6.3"><apply id="S3.E1.m1.1.1.1.1.6.3.1.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.6.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.6.3.1.2.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.6.3.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.6.3.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.6.3.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3"><eq id="S3.E1.m1.1.1.1.1.6.3.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.6.3.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3.2">ğ‘–</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.6.3.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.6.3.1.3.cmml" xref="S3.E1.m1.1.1.1.1.6.3.1.3">ğ‘</ci></apply><apply id="S3.E1.m1.1.1.1.1.6.3.2.cmml" xref="S3.E1.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.6.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.6.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.6.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.6.3.2.2">ğ‘”</ci><ci id="S3.E1.m1.1.1.1.1.6.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.6.3.2.3">ğ‘–</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathcal{D}(\frac{1}{N}\sum_{i=1}^{N}\mathcal{Q}(g_{i}))=\frac{1}{N}\sum_{i=1}^{N}\mathcal{D}(\mathcal{Q}(g_{i}))\approx\frac{1}{N}\sum_{i=1}^{N}g_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.4" class="ltx_p">The equation implies that we can exchange the operation of aggregation and decompression without performance degradation, thereby avoiding the server obtaining the uncompressed updated parameters from any individual user.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">For this purpose, we propose a multi-codebook product quantization compression strategy named FedMPQ.
As shown in FigureÂ <a href="#S1.F2" title="Figure 2 â€£ 1 Introduction â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the training process of FedMPQ consists of multiple rounds, each of which is composed of five steps:</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.2" class="ltx_p"><span id="S3.p3.2.1" class="ltx_text ltx_font_bold">(1) Pull</span>: Clients download parameters, including the complete model parameters <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\theta</annotation></semantics></math> and <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">M</annotation></semantics></math> different codebooks.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.2" class="ltx_p"><span id="S3.p4.2.1" class="ltx_text ltx_font_bold">(2) Client Update</span>: In this step, <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">N</annotation></semantics></math> clients participating in the current round compute gradients z based on their local data.
Each client attempts to compress these gradients using <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p4.2.m2.1a"><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">M</annotation></semantics></math> codebooks, selecting the one with the minimum error as the result.
Finally, the clients output the compressed gradients, encoding, pseudo-centroids, and residual error.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.3" class="ltx_p"><span id="S3.p5.3.1" class="ltx_text ltx_font_bold">(3) Push</span>: Clients upload the quantization codes <math id="S3.p5.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.p5.1.m1.1a"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">q</annotation></semantics></math>, residuals <math id="S3.p5.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.p5.2.m2.1a"><mi id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><ci id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1">ğ‘Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">r</annotation></semantics></math>, and pseudo-centroids <math id="S3.p5.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.p5.3.m3.1a"><mi id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><ci id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">p</annotation></semantics></math> to the server.</p>
</div>
<div id="S3.p6" class="ltx_para">
<p id="S3.p6.1" class="ltx_p"><span id="S3.p6.1.1" class="ltx_text ltx_font_bold">(4) Model Update</span>: The server aggregates the updates securely in the compressed domain using a secure aggregation protocol and then directly recovers the aggregated updates.</p>
</div>
<div id="S3.p7" class="ltx_para">
<p id="S3.p7.2" class="ltx_p"><span id="S3.p7.2.1" class="ltx_text ltx_font_bold">(5) Codebook Update</span>: The server leverages public data to simulate the training process, generating one codebook. It also uniformly splits the pseudo-centroids uploaded by clients into <math id="S3.p7.1.m1.1" class="ltx_Math" alttext="M-1" display="inline"><semantics id="S3.p7.1.m1.1a"><mrow id="S3.p7.1.m1.1.1" xref="S3.p7.1.m1.1.1.cmml"><mi id="S3.p7.1.m1.1.1.2" xref="S3.p7.1.m1.1.1.2.cmml">M</mi><mo id="S3.p7.1.m1.1.1.1" xref="S3.p7.1.m1.1.1.1.cmml">âˆ’</mo><mn id="S3.p7.1.m1.1.1.3" xref="S3.p7.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.1.m1.1b"><apply id="S3.p7.1.m1.1.1.cmml" xref="S3.p7.1.m1.1.1"><minus id="S3.p7.1.m1.1.1.1.cmml" xref="S3.p7.1.m1.1.1.1"></minus><ci id="S3.p7.1.m1.1.1.2.cmml" xref="S3.p7.1.m1.1.1.2">ğ‘€</ci><cn type="integer" id="S3.p7.1.m1.1.1.3.cmml" xref="S3.p7.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.1.m1.1c">M-1</annotation></semantics></math> parts and clusters them to update the other <math id="S3.p7.2.m2.1" class="ltx_Math" alttext="M-1" display="inline"><semantics id="S3.p7.2.m2.1a"><mrow id="S3.p7.2.m2.1.1" xref="S3.p7.2.m2.1.1.cmml"><mi id="S3.p7.2.m2.1.1.2" xref="S3.p7.2.m2.1.1.2.cmml">M</mi><mo id="S3.p7.2.m2.1.1.1" xref="S3.p7.2.m2.1.1.1.cmml">âˆ’</mo><mn id="S3.p7.2.m2.1.1.3" xref="S3.p7.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.2.m2.1b"><apply id="S3.p7.2.m2.1.1.cmml" xref="S3.p7.2.m2.1.1"><minus id="S3.p7.2.m2.1.1.1.cmml" xref="S3.p7.2.m2.1.1.1"></minus><ci id="S3.p7.2.m2.1.1.2.cmml" xref="S3.p7.2.m2.1.1.2">ğ‘€</ci><cn type="integer" id="S3.p7.2.m2.1.1.3.cmml" xref="S3.p7.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.2.m2.1c">M-1</annotation></semantics></math> codebooks.</p>
</div>
<div id="S3.p8" class="ltx_para">
<p id="S3.p8.1" class="ltx_p">In the sequel, we elaborate the motivation and details of our proposed method, where the basic steps of Pull and Push are omitted.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Client update</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In previous researchÂ <cite class="ltx_cite ltx_citemacro_cite">Prasad <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>, public data were employed to approximate the update process on clients and generate shared codebooks. However, when there is a substantial disparity between the distribution of public data and client data, model accuracy may significantly deteriorate. Therefore, in FedMPQ, on the basis of generating codebooks using public data from the server, we aim to enable clients to upload partial information to assist the server in codebook generation without compromising privacy.
The overall client-side algorithm is outlined in AlgorithmÂ <a href="#alg1" title="Algorithm 1 â€£ 3.1 Client update â€£ 3 Proposed Method â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Client Update</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>Â Â Global model parameters <math id="alg1.l0.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">\theta</annotation></semantics></math> and <math id="alg1.l0.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">M</annotation></semantics></math> codebooks.

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>Â Â Initialize variables: <math id="alg1.l1.m1.3" class="ltx_Math" alttext="\hat{z}_{i},p_{i},r_{i}" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.4.cmml"><msub id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml"><mover accent="true" id="alg1.l1.m1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.2.cmml"><mi id="alg1.l1.m1.1.1.1.1.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.cmml">z</mi><mo id="alg1.l1.m1.1.1.1.1.2.1" xref="alg1.l1.m1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="alg1.l1.m1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l1.m1.3.3.3.4" xref="alg1.l1.m1.3.3.4.cmml">,</mo><msub id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.cmml">p</mi><mi id="alg1.l1.m1.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l1.m1.3.3.3.5" xref="alg1.l1.m1.3.3.4.cmml">,</mo><msub id="alg1.l1.m1.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.cmml"><mi id="alg1.l1.m1.3.3.3.3.2" xref="alg1.l1.m1.3.3.3.3.2.cmml">r</mi><mi id="alg1.l1.m1.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><list id="alg1.l1.m1.3.3.4.cmml" xref="alg1.l1.m1.3.3.3"><apply id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l1.m1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.2"><ci id="alg1.l1.m1.1.1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.1">^</ci><ci id="alg1.l1.m1.1.1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2">ğ‘§</ci></apply><ci id="alg1.l1.m1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.3">ğ‘–</ci></apply><apply id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2">ğ‘</ci><ci id="alg1.l1.m1.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.3">ğ‘–</ci></apply><apply id="alg1.l1.m1.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.3.1.cmml" xref="alg1.l1.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l1.m1.3.3.3.3.2.cmml" xref="alg1.l1.m1.3.3.3.3.2">ğ‘Ÿ</ci><ci id="alg1.l1.m1.3.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3.3.3">ğ‘–</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\hat{z}_{i},p_{i},r_{i}</annotation></semantics></math> for <math id="alg1.l1.m2.4" class="ltx_Math" alttext="i\in\{1,2,\ldots,M\}" display="inline"><semantics id="alg1.l1.m2.4a"><mrow id="alg1.l1.m2.4.5" xref="alg1.l1.m2.4.5.cmml"><mi id="alg1.l1.m2.4.5.2" xref="alg1.l1.m2.4.5.2.cmml">i</mi><mo id="alg1.l1.m2.4.5.1" xref="alg1.l1.m2.4.5.1.cmml">âˆˆ</mo><mrow id="alg1.l1.m2.4.5.3.2" xref="alg1.l1.m2.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l1.m2.4.5.3.2.1" xref="alg1.l1.m2.4.5.3.1.cmml">{</mo><mn id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">1</mn><mo id="alg1.l1.m2.4.5.3.2.2" xref="alg1.l1.m2.4.5.3.1.cmml">,</mo><mn id="alg1.l1.m2.2.2" xref="alg1.l1.m2.2.2.cmml">2</mn><mo id="alg1.l1.m2.4.5.3.2.3" xref="alg1.l1.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m2.3.3" xref="alg1.l1.m2.3.3.cmml">â€¦</mi><mo id="alg1.l1.m2.4.5.3.2.4" xref="alg1.l1.m2.4.5.3.1.cmml">,</mo><mi id="alg1.l1.m2.4.4" xref="alg1.l1.m2.4.4.cmml">M</mi><mo stretchy="false" id="alg1.l1.m2.4.5.3.2.5" xref="alg1.l1.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.4b"><apply id="alg1.l1.m2.4.5.cmml" xref="alg1.l1.m2.4.5"><in id="alg1.l1.m2.4.5.1.cmml" xref="alg1.l1.m2.4.5.1"></in><ci id="alg1.l1.m2.4.5.2.cmml" xref="alg1.l1.m2.4.5.2">ğ‘–</ci><set id="alg1.l1.m2.4.5.3.1.cmml" xref="alg1.l1.m2.4.5.3.2"><cn type="integer" id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">1</cn><cn type="integer" id="alg1.l1.m2.2.2.cmml" xref="alg1.l1.m2.2.2">2</cn><ci id="alg1.l1.m2.3.3.cmml" xref="alg1.l1.m2.3.3">â€¦</ci><ci id="alg1.l1.m2.4.4.cmml" xref="alg1.l1.m2.4.4">ğ‘€</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.4c">i\in\{1,2,\ldots,M\}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Â Â <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l2.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">i</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">ğ‘–</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">i=1</annotation></semantics></math> to <math id="alg1.l2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">M</annotation></semantics></math>Â <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Â Â Â Â Â Train local model with local data and obtain update gradient <math id="alg1.l3.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">ğ‘§</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">z</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>Â Â Â Â Â Compress the gradient using codebook <math id="alg1.l4.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i</annotation></semantics></math>:<math id="alg1.l4.m2.2" class="ltx_Math" alttext="q_{i}\leftarrow\text{Compress}(z,\text{Codebook}_{i})" display="inline"><semantics id="alg1.l4.m2.2a"><mrow id="alg1.l4.m2.2.2" xref="alg1.l4.m2.2.2.cmml"><msub id="alg1.l4.m2.2.2.3" xref="alg1.l4.m2.2.2.3.cmml"><mi id="alg1.l4.m2.2.2.3.2" xref="alg1.l4.m2.2.2.3.2.cmml">q</mi><mi id="alg1.l4.m2.2.2.3.3" xref="alg1.l4.m2.2.2.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l4.m2.2.2.2" xref="alg1.l4.m2.2.2.2.cmml">â†</mo><mrow id="alg1.l4.m2.2.2.1" xref="alg1.l4.m2.2.2.1.cmml"><mtext id="alg1.l4.m2.2.2.1.3" xref="alg1.l4.m2.2.2.1.3a.cmml">Compress</mtext><mo lspace="0em" rspace="0em" id="alg1.l4.m2.2.2.1.2" xref="alg1.l4.m2.2.2.1.2.cmml">â€‹</mo><mrow id="alg1.l4.m2.2.2.1.1.1" xref="alg1.l4.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l4.m2.2.2.1.1.1.2" xref="alg1.l4.m2.2.2.1.1.2.cmml">(</mo><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">z</mi><mo id="alg1.l4.m2.2.2.1.1.1.3" xref="alg1.l4.m2.2.2.1.1.2.cmml">,</mo><msub id="alg1.l4.m2.2.2.1.1.1.1" xref="alg1.l4.m2.2.2.1.1.1.1.cmml"><mtext id="alg1.l4.m2.2.2.1.1.1.1.2" xref="alg1.l4.m2.2.2.1.1.1.1.2a.cmml">Codebook</mtext><mi id="alg1.l4.m2.2.2.1.1.1.1.3" xref="alg1.l4.m2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l4.m2.2.2.1.1.1.4" xref="alg1.l4.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.2b"><apply id="alg1.l4.m2.2.2.cmml" xref="alg1.l4.m2.2.2"><ci id="alg1.l4.m2.2.2.2.cmml" xref="alg1.l4.m2.2.2.2">â†</ci><apply id="alg1.l4.m2.2.2.3.cmml" xref="alg1.l4.m2.2.2.3"><csymbol cd="ambiguous" id="alg1.l4.m2.2.2.3.1.cmml" xref="alg1.l4.m2.2.2.3">subscript</csymbol><ci id="alg1.l4.m2.2.2.3.2.cmml" xref="alg1.l4.m2.2.2.3.2">ğ‘</ci><ci id="alg1.l4.m2.2.2.3.3.cmml" xref="alg1.l4.m2.2.2.3.3">ğ‘–</ci></apply><apply id="alg1.l4.m2.2.2.1.cmml" xref="alg1.l4.m2.2.2.1"><times id="alg1.l4.m2.2.2.1.2.cmml" xref="alg1.l4.m2.2.2.1.2"></times><ci id="alg1.l4.m2.2.2.1.3a.cmml" xref="alg1.l4.m2.2.2.1.3"><mtext id="alg1.l4.m2.2.2.1.3.cmml" xref="alg1.l4.m2.2.2.1.3">Compress</mtext></ci><interval closure="open" id="alg1.l4.m2.2.2.1.1.2.cmml" xref="alg1.l4.m2.2.2.1.1.1"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">ğ‘§</ci><apply id="alg1.l4.m2.2.2.1.1.1.1.cmml" xref="alg1.l4.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.2.2.1.1.1.1.1.cmml" xref="alg1.l4.m2.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m2.2.2.1.1.1.1.2a.cmml" xref="alg1.l4.m2.2.2.1.1.1.1.2"><mtext id="alg1.l4.m2.2.2.1.1.1.1.2.cmml" xref="alg1.l4.m2.2.2.1.1.1.1.2">Codebook</mtext></ci><ci id="alg1.l4.m2.2.2.1.1.1.1.3.cmml" xref="alg1.l4.m2.2.2.1.1.1.1.3">ğ‘–</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.2c">q_{i}\leftarrow\text{Compress}(z,\text{Codebook}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>Â Â Â Â Â Compute quantization error: <math id="alg1.l5.m1.2" class="ltx_Math" alttext="r_{i}\leftarrow z-\text{Decompress}(q_{i},\text{Codebook}_{i})" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><msub id="alg1.l5.m1.2.2.4" xref="alg1.l5.m1.2.2.4.cmml"><mi id="alg1.l5.m1.2.2.4.2" xref="alg1.l5.m1.2.2.4.2.cmml">r</mi><mi id="alg1.l5.m1.2.2.4.3" xref="alg1.l5.m1.2.2.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l5.m1.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">â†</mo><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.2.4.cmml">z</mi><mo id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.2.3.cmml">âˆ’</mo><mrow id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mtext id="alg1.l5.m1.2.2.2.2.4" xref="alg1.l5.m1.2.2.2.2.4a.cmml">Decompress</mtext><mo lspace="0em" rspace="0em" id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">â€‹</mo><mrow id="alg1.l5.m1.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.2.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">(</mo><msub id="alg1.l5.m1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l5.m1.2.2.2.2.2.2.4" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.l5.m1.2.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.2.cmml"><mtext id="alg1.l5.m1.2.2.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.2.2a.cmml">Codebook</mtext><mi id="alg1.l5.m1.2.2.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l5.m1.2.2.2.2.2.2.5" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><ci id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3">â†</ci><apply id="alg1.l5.m1.2.2.4.cmml" xref="alg1.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.4.1.cmml" xref="alg1.l5.m1.2.2.4">subscript</csymbol><ci id="alg1.l5.m1.2.2.4.2.cmml" xref="alg1.l5.m1.2.2.4.2">ğ‘Ÿ</ci><ci id="alg1.l5.m1.2.2.4.3.cmml" xref="alg1.l5.m1.2.2.4.3">ğ‘–</ci></apply><apply id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"><minus id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.3"></minus><ci id="alg1.l5.m1.2.2.2.4.cmml" xref="alg1.l5.m1.2.2.2.4">ğ‘§</ci><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><times id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3"></times><ci id="alg1.l5.m1.2.2.2.2.4a.cmml" xref="alg1.l5.m1.2.2.2.2.4"><mtext id="alg1.l5.m1.2.2.2.2.4.cmml" xref="alg1.l5.m1.2.2.2.2.4">Decompress</mtext></ci><interval closure="open" id="alg1.l5.m1.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.2">ğ‘</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="alg1.l5.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.2.2a.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.2"><mtext id="alg1.l5.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.2">Codebook</mtext></ci><ci id="alg1.l5.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.3">ğ‘–</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">r_{i}\leftarrow z-\text{Decompress}(q_{i},\text{Codebook}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Â Â Â Â Â Calculate pseudo-centroid: <math id="alg1.l6.m1.3" class="ltx_Math" alttext="p_{i}\leftarrow\text{CalculatePseudoCentroid}(z,q_{i},\text{Codebook}_{i})" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml"><msub id="alg1.l6.m1.3.3.4" xref="alg1.l6.m1.3.3.4.cmml"><mi id="alg1.l6.m1.3.3.4.2" xref="alg1.l6.m1.3.3.4.2.cmml">p</mi><mi id="alg1.l6.m1.3.3.4.3" xref="alg1.l6.m1.3.3.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l6.m1.3.3.3" xref="alg1.l6.m1.3.3.3.cmml">â†</mo><mrow id="alg1.l6.m1.3.3.2" xref="alg1.l6.m1.3.3.2.cmml"><mtext id="alg1.l6.m1.3.3.2.4" xref="alg1.l6.m1.3.3.2.4a.cmml">CalculatePseudoCentroid</mtext><mo lspace="0em" rspace="0em" id="alg1.l6.m1.3.3.2.3" xref="alg1.l6.m1.3.3.2.3.cmml">â€‹</mo><mrow id="alg1.l6.m1.3.3.2.2.2" xref="alg1.l6.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="alg1.l6.m1.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.3.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">z</mi><mo id="alg1.l6.m1.3.3.2.2.2.4" xref="alg1.l6.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l6.m1.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.2.cmml">q</mi><mi id="alg1.l6.m1.2.2.1.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l6.m1.3.3.2.2.2.5" xref="alg1.l6.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l6.m1.3.3.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.cmml"><mtext id="alg1.l6.m1.3.3.2.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.2a.cmml">Codebook</mtext><mi id="alg1.l6.m1.3.3.2.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l6.m1.3.3.2.2.2.6" xref="alg1.l6.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3"><ci id="alg1.l6.m1.3.3.3.cmml" xref="alg1.l6.m1.3.3.3">â†</ci><apply id="alg1.l6.m1.3.3.4.cmml" xref="alg1.l6.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.4.1.cmml" xref="alg1.l6.m1.3.3.4">subscript</csymbol><ci id="alg1.l6.m1.3.3.4.2.cmml" xref="alg1.l6.m1.3.3.4.2">ğ‘</ci><ci id="alg1.l6.m1.3.3.4.3.cmml" xref="alg1.l6.m1.3.3.4.3">ğ‘–</ci></apply><apply id="alg1.l6.m1.3.3.2.cmml" xref="alg1.l6.m1.3.3.2"><times id="alg1.l6.m1.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.2.3"></times><ci id="alg1.l6.m1.3.3.2.4a.cmml" xref="alg1.l6.m1.3.3.2.4"><mtext id="alg1.l6.m1.3.3.2.4.cmml" xref="alg1.l6.m1.3.3.2.4">CalculatePseudoCentroid</mtext></ci><vector id="alg1.l6.m1.3.3.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">ğ‘§</ci><apply id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.2">ğ‘</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3">ğ‘–</ci></apply><apply id="alg1.l6.m1.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.3.3.2.2.2.2.2a.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2"><mtext id="alg1.l6.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2">Codebook</mtext></ci><ci id="alg1.l6.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.3">ğ‘–</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">p_{i}\leftarrow\text{CalculatePseudoCentroid}(z,q_{i},\text{Codebook}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>Â Â <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>Â Â Select the codebook with the smallest total residual: <math id="alg1.l8.m1.2" class="ltx_Math" alttext="i^{*}=\arg\min_{i}\sum_{j}|r_{i}[j]|" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><msup id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.3.2" xref="alg1.l8.m1.2.2.3.2.cmml">i</mi><mo id="alg1.l8.m1.2.2.3.3" xref="alg1.l8.m1.2.2.3.3.cmml">âˆ—</mo></msup><mo id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml">=</mo><mrow id="alg1.l8.m1.2.2.1" xref="alg1.l8.m1.2.2.1.cmml"><mrow id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.2.2.1.3.cmml"><mi id="alg1.l8.m1.2.2.1.3.1" xref="alg1.l8.m1.2.2.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="alg1.l8.m1.2.2.1.3a" xref="alg1.l8.m1.2.2.1.3.cmml">â¡</mo><msub id="alg1.l8.m1.2.2.1.3.2" xref="alg1.l8.m1.2.2.1.3.2.cmml"><mi id="alg1.l8.m1.2.2.1.3.2.2" xref="alg1.l8.m1.2.2.1.3.2.2.cmml">min</mi><mi id="alg1.l8.m1.2.2.1.3.2.3" xref="alg1.l8.m1.2.2.1.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.1.2" xref="alg1.l8.m1.2.2.1.2.cmml">â€‹</mo><mrow id="alg1.l8.m1.2.2.1.1" xref="alg1.l8.m1.2.2.1.1.cmml"><msub id="alg1.l8.m1.2.2.1.1.2" xref="alg1.l8.m1.2.2.1.1.2.cmml"><mo rspace="0em" id="alg1.l8.m1.2.2.1.1.2.2" xref="alg1.l8.m1.2.2.1.1.2.2.cmml">âˆ‘</mo><mi id="alg1.l8.m1.2.2.1.1.2.3" xref="alg1.l8.m1.2.2.1.1.2.3.cmml">j</mi></msub><mrow id="alg1.l8.m1.2.2.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.2" xref="alg1.l8.m1.2.2.1.1.1.2.1.cmml">|</mo><mrow id="alg1.l8.m1.2.2.1.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.1.cmml"><msub id="alg1.l8.m1.2.2.1.1.1.1.1.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.2.cmml"><mi id="alg1.l8.m1.2.2.1.1.1.1.1.2.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.2.2.cmml">r</mi><mi id="alg1.l8.m1.2.2.1.1.1.1.1.2.3" xref="alg1.l8.m1.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.1.1.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.1.1.cmml">â€‹</mo><mrow id="alg1.l8.m1.2.2.1.1.1.1.1.3.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.1.3.2.1" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.1.1.cmml">[</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">j</mi><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.1.3.2.2" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.1.3" xref="alg1.l8.m1.2.2.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><eq id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"></eq><apply id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.3">superscript</csymbol><ci id="alg1.l8.m1.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.3.2">ğ‘–</ci><times id="alg1.l8.m1.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.3.3"></times></apply><apply id="alg1.l8.m1.2.2.1.cmml" xref="alg1.l8.m1.2.2.1"><times id="alg1.l8.m1.2.2.1.2.cmml" xref="alg1.l8.m1.2.2.1.2"></times><apply id="alg1.l8.m1.2.2.1.3.cmml" xref="alg1.l8.m1.2.2.1.3"><arg id="alg1.l8.m1.2.2.1.3.1.cmml" xref="alg1.l8.m1.2.2.1.3.1"></arg><apply id="alg1.l8.m1.2.2.1.3.2.cmml" xref="alg1.l8.m1.2.2.1.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.3.2.1.cmml" xref="alg1.l8.m1.2.2.1.3.2">subscript</csymbol><min id="alg1.l8.m1.2.2.1.3.2.2.cmml" xref="alg1.l8.m1.2.2.1.3.2.2"></min><ci id="alg1.l8.m1.2.2.1.3.2.3.cmml" xref="alg1.l8.m1.2.2.1.3.2.3">ğ‘–</ci></apply></apply><apply id="alg1.l8.m1.2.2.1.1.cmml" xref="alg1.l8.m1.2.2.1.1"><apply id="alg1.l8.m1.2.2.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.2.1.cmml" xref="alg1.l8.m1.2.2.1.1.2">subscript</csymbol><sum id="alg1.l8.m1.2.2.1.1.2.2.cmml" xref="alg1.l8.m1.2.2.1.1.2.2"></sum><ci id="alg1.l8.m1.2.2.1.1.2.3.cmml" xref="alg1.l8.m1.2.2.1.1.2.3">ğ‘—</ci></apply><apply id="alg1.l8.m1.2.2.1.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1"><abs id="alg1.l8.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.2"></abs><apply id="alg1.l8.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1"><times id="alg1.l8.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.1"></times><apply id="alg1.l8.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.2.2">ğ‘Ÿ</ci><ci id="alg1.l8.m1.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.2.3">ğ‘–</ci></apply><apply id="alg1.l8.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="latexml" id="alg1.l8.m1.2.2.1.1.1.1.1.3.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">ğ‘—</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">i^{*}=\arg\min_{i}\sum_{j}|r_{i}[j]|</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>Â Â Prune the top-k residuals and their positions: <math id="alg1.l9.m1.2" class="ltx_Math" alttext="r_{i^{*}}\leftarrow\text{Pruning}(r_{i^{*}},k)" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><msub id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml"><mi id="alg1.l9.m1.2.2.3.2" xref="alg1.l9.m1.2.2.3.2.cmml">r</mi><msup id="alg1.l9.m1.2.2.3.3" xref="alg1.l9.m1.2.2.3.3.cmml"><mi id="alg1.l9.m1.2.2.3.3.2" xref="alg1.l9.m1.2.2.3.3.2.cmml">i</mi><mo id="alg1.l9.m1.2.2.3.3.3" xref="alg1.l9.m1.2.2.3.3.3.cmml">âˆ—</mo></msup></msub><mo stretchy="false" id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.2.cmml">â†</mo><mrow id="alg1.l9.m1.2.2.1" xref="alg1.l9.m1.2.2.1.cmml"><mtext id="alg1.l9.m1.2.2.1.3" xref="alg1.l9.m1.2.2.1.3a.cmml">Pruning</mtext><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.1.2" xref="alg1.l9.m1.2.2.1.2.cmml">â€‹</mo><mrow id="alg1.l9.m1.2.2.1.1.1" xref="alg1.l9.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l9.m1.2.2.1.1.1.2" xref="alg1.l9.m1.2.2.1.1.2.cmml">(</mo><msub id="alg1.l9.m1.2.2.1.1.1.1" xref="alg1.l9.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l9.m1.2.2.1.1.1.1.2" xref="alg1.l9.m1.2.2.1.1.1.1.2.cmml">r</mi><msup id="alg1.l9.m1.2.2.1.1.1.1.3" xref="alg1.l9.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.2.2.1.1.1.1.3.2" xref="alg1.l9.m1.2.2.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l9.m1.2.2.1.1.1.1.3.3" xref="alg1.l9.m1.2.2.1.1.1.1.3.3.cmml">âˆ—</mo></msup></msub><mo id="alg1.l9.m1.2.2.1.1.1.3" xref="alg1.l9.m1.2.2.1.1.2.cmml">,</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">k</mi><mo stretchy="false" id="alg1.l9.m1.2.2.1.1.1.4" xref="alg1.l9.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><ci id="alg1.l9.m1.2.2.2.cmml" xref="alg1.l9.m1.2.2.2">â†</ci><apply id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.3.1.cmml" xref="alg1.l9.m1.2.2.3">subscript</csymbol><ci id="alg1.l9.m1.2.2.3.2.cmml" xref="alg1.l9.m1.2.2.3.2">ğ‘Ÿ</ci><apply id="alg1.l9.m1.2.2.3.3.cmml" xref="alg1.l9.m1.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.3.3.1.cmml" xref="alg1.l9.m1.2.2.3.3">superscript</csymbol><ci id="alg1.l9.m1.2.2.3.3.2.cmml" xref="alg1.l9.m1.2.2.3.3.2">ğ‘–</ci><times id="alg1.l9.m1.2.2.3.3.3.cmml" xref="alg1.l9.m1.2.2.3.3.3"></times></apply></apply><apply id="alg1.l9.m1.2.2.1.cmml" xref="alg1.l9.m1.2.2.1"><times id="alg1.l9.m1.2.2.1.2.cmml" xref="alg1.l9.m1.2.2.1.2"></times><ci id="alg1.l9.m1.2.2.1.3a.cmml" xref="alg1.l9.m1.2.2.1.3"><mtext id="alg1.l9.m1.2.2.1.3.cmml" xref="alg1.l9.m1.2.2.1.3">Pruning</mtext></ci><interval closure="open" id="alg1.l9.m1.2.2.1.1.2.cmml" xref="alg1.l9.m1.2.2.1.1.1"><apply id="alg1.l9.m1.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l9.m1.2.2.1.1.1.1.2">ğ‘Ÿ</ci><apply id="alg1.l9.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l9.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="alg1.l9.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.2.2.1.1.1.1.3.2">ğ‘–</ci><times id="alg1.l9.m1.2.2.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.2.2.1.1.1.1.3.3"></times></apply></apply><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">ğ‘˜</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">r_{i^{*}}\leftarrow\text{Pruning}(r_{i^{*}},k)</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>Â Â Upload pruned residuals <math id="alg1.l10.m1.1" class="ltx_Math" alttext="r_{i^{*}}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">r</mi><msup id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">âˆ—</mo></msup></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">ğ‘Ÿ</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">superscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">ğ‘–</ci><times id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">r_{i^{*}}</annotation></semantics></math>, quantization code <math id="alg1.l10.m2.1" class="ltx_Math" alttext="q_{i^{*}}" display="inline"><semantics id="alg1.l10.m2.1a"><msub id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">q</mi><msup id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml"><mi id="alg1.l10.m2.1.1.3.2" xref="alg1.l10.m2.1.1.3.2.cmml">i</mi><mo id="alg1.l10.m2.1.1.3.3" xref="alg1.l10.m2.1.1.3.3.cmml">âˆ—</mo></msup></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2">ğ‘</ci><apply id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.3.1.cmml" xref="alg1.l10.m2.1.1.3">superscript</csymbol><ci id="alg1.l10.m2.1.1.3.2.cmml" xref="alg1.l10.m2.1.1.3.2">ğ‘–</ci><times id="alg1.l10.m2.1.1.3.3.cmml" xref="alg1.l10.m2.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">q_{i^{*}}</annotation></semantics></math>, pseudo-centroid <math id="alg1.l10.m3.1" class="ltx_Math" alttext="p_{i^{*}}" display="inline"><semantics id="alg1.l10.m3.1a"><msub id="alg1.l10.m3.1.1" xref="alg1.l10.m3.1.1.cmml"><mi id="alg1.l10.m3.1.1.2" xref="alg1.l10.m3.1.1.2.cmml">p</mi><msup id="alg1.l10.m3.1.1.3" xref="alg1.l10.m3.1.1.3.cmml"><mi id="alg1.l10.m3.1.1.3.2" xref="alg1.l10.m3.1.1.3.2.cmml">i</mi><mo id="alg1.l10.m3.1.1.3.3" xref="alg1.l10.m3.1.1.3.3.cmml">âˆ—</mo></msup></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.1b"><apply id="alg1.l10.m3.1.1.cmml" xref="alg1.l10.m3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.1.cmml" xref="alg1.l10.m3.1.1">subscript</csymbol><ci id="alg1.l10.m3.1.1.2.cmml" xref="alg1.l10.m3.1.1.2">ğ‘</ci><apply id="alg1.l10.m3.1.1.3.cmml" xref="alg1.l10.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.3.1.cmml" xref="alg1.l10.m3.1.1.3">superscript</csymbol><ci id="alg1.l10.m3.1.1.3.2.cmml" xref="alg1.l10.m3.1.1.3.2">ğ‘–</ci><times id="alg1.l10.m3.1.1.3.3.cmml" xref="alg1.l10.m3.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.1c">p_{i^{*}}</annotation></semantics></math>, and <math id="alg1.l10.m4.1" class="ltx_Math" alttext="i^{*}" display="inline"><semantics id="alg1.l10.m4.1a"><msup id="alg1.l10.m4.1.1" xref="alg1.l10.m4.1.1.cmml"><mi id="alg1.l10.m4.1.1.2" xref="alg1.l10.m4.1.1.2.cmml">i</mi><mo id="alg1.l10.m4.1.1.3" xref="alg1.l10.m4.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l10.m4.1b"><apply id="alg1.l10.m4.1.1.cmml" xref="alg1.l10.m4.1.1"><csymbol cd="ambiguous" id="alg1.l10.m4.1.1.1.cmml" xref="alg1.l10.m4.1.1">superscript</csymbol><ci id="alg1.l10.m4.1.1.2.cmml" xref="alg1.l10.m4.1.1.2">ğ‘–</ci><times id="alg1.l10.m4.1.1.3.cmml" xref="alg1.l10.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m4.1c">i^{*}</annotation></semantics></math> to the server

</div>
</div>
</figure>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Product Quantization</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.14" class="ltx_p">The essence of Product Quantization (PQ) is to decompose the high-dimensional vector space into the Cartesian product of subspaces and then quantize these subspaces separately <cite class="ltx_cite ltx_citemacro_cite">JÃ©gou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2011</a>)</cite>. The product quantizer consists of <math id="S3.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mi id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">M</annotation></semantics></math> codebooks
<math id="S3.SS1.SSS1.p1.2.m2.3" class="ltx_Math" alttext="\mathcal{C}=[\bm{C}^{1},\ldots,\bm{C}^{M}]" display="inline"><semantics id="S3.SS1.SSS1.p1.2.m2.3a"><mrow id="S3.SS1.SSS1.p1.2.m2.3.3" xref="S3.SS1.SSS1.p1.2.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.2.m2.3.3.4" xref="S3.SS1.SSS1.p1.2.m2.3.3.4.cmml">ğ’</mi><mo id="S3.SS1.SSS1.p1.2.m2.3.3.3" xref="S3.SS1.SSS1.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.2.m2.3.3.2.2" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.3.cmml">[</mo><msup id="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.2.cmml">ğ‘ª</mi><mn id="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.4" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml">â€¦</mi><mo id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.5" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.3.cmml">,</mo><msup id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.2.cmml">ğ‘ª</mi><mi id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.3.cmml">M</mi></msup><mo stretchy="false" id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.6" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.3b"><apply id="S3.SS1.SSS1.p1.2.m2.3.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3"><eq id="S3.SS1.SSS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3.3"></eq><ci id="S3.SS1.SSS1.p1.2.m2.3.3.4.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3.4">ğ’</ci><list id="S3.SS1.SSS1.p1.2.m2.3.3.2.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2"><apply id="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.2">ğ‘ª</ci><cn type="integer" id="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">â€¦</ci><apply id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.2">ğ‘ª</ci><ci id="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.3.3.2.2.2.3">ğ‘€</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.3c">\mathcal{C}=[\bm{C}^{1},\ldots,\bm{C}^{M}]</annotation></semantics></math>,
where the <math id="S3.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><mi id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><ci id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">n</annotation></semantics></math>-th codebook
<math id="S3.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\bm{C}^{n}\in{R}^{K\times D}" display="inline"><semantics id="S3.SS1.SSS1.p1.4.m4.1a"><mrow id="S3.SS1.SSS1.p1.4.m4.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.cmml"><msup id="S3.SS1.SSS1.p1.4.m4.1.1.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.SSS1.p1.4.m4.1.1.2.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.2.2.cmml">ğ‘ª</mi><mi id="S3.SS1.SSS1.p1.4.m4.1.1.2.3" xref="S3.SS1.SSS1.p1.4.m4.1.1.2.3.cmml">n</mi></msup><mo id="S3.SS1.SSS1.p1.4.m4.1.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS1.SSS1.p1.4.m4.1.1.3" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.4.m4.1.1.3.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.2.cmml">R</mi><mrow id="S3.SS1.SSS1.p1.4.m4.1.1.3.3" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS1.p1.4.m4.1.1.3.3.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.p1.4.m4.1.1.3.3.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3.1.cmml">Ã—</mo><mi id="S3.SS1.SSS1.p1.4.m4.1.1.3.3.3" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m4.1b"><apply id="S3.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1"><in id="S3.SS1.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1"></in><apply id="S3.SS1.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.2.2">ğ‘ª</ci><ci id="S3.SS1.SSS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.2.3">ğ‘›</ci></apply><apply id="S3.SS1.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.2">ğ‘…</ci><apply id="S3.SS1.SSS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3"><times id="S3.SS1.SSS1.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.SSS1.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3.2">ğ¾</ci><ci id="S3.SS1.SSS1.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.3.3.3">ğ·</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m4.1c">\bm{C}^{n}\in{R}^{K\times D}</annotation></semantics></math>
contains <math id="S3.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.SSS1.p1.5.m5.1a"><mi id="S3.SS1.SSS1.p1.5.m5.1.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m5.1b"><ci id="S3.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m5.1c">K</annotation></semantics></math> codewords
<math id="S3.SS1.SSS1.p1.6.m6.3" class="ltx_Math" alttext="\bm{C}^{n}=[\bm{c}^{n}_{1},\ldots,\bm{c}^{n}_{K}]" display="inline"><semantics id="S3.SS1.SSS1.p1.6.m6.3a"><mrow id="S3.SS1.SSS1.p1.6.m6.3.3" xref="S3.SS1.SSS1.p1.6.m6.3.3.cmml"><msup id="S3.SS1.SSS1.p1.6.m6.3.3.4" xref="S3.SS1.SSS1.p1.6.m6.3.3.4.cmml"><mi id="S3.SS1.SSS1.p1.6.m6.3.3.4.2" xref="S3.SS1.SSS1.p1.6.m6.3.3.4.2.cmml">ğ‘ª</mi><mi id="S3.SS1.SSS1.p1.6.m6.3.3.4.3" xref="S3.SS1.SSS1.p1.6.m6.3.3.4.3.cmml">n</mi></msup><mo id="S3.SS1.SSS1.p1.6.m6.3.3.3" xref="S3.SS1.SSS1.p1.6.m6.3.3.3.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.6.m6.3.3.2.2" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.3" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.3.cmml">[</mo><msubsup id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.2" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.2.cmml">ğ’„</mi><mn id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.3" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.3" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.4" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p1.6.m6.1.1" xref="S3.SS1.SSS1.p1.6.m6.1.1.cmml">â€¦</mi><mo id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.5" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.3.cmml">,</mo><msubsup id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.2" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.2.cmml">ğ’„</mi><mi id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.3" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.3.cmml">K</mi><mi id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.3" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.6" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m6.3b"><apply id="S3.SS1.SSS1.p1.6.m6.3.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3"><eq id="S3.SS1.SSS1.p1.6.m6.3.3.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.3"></eq><apply id="S3.SS1.SSS1.p1.6.m6.3.3.4.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.3.3.4.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.4">superscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m6.3.3.4.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.4.2">ğ‘ª</ci><ci id="S3.SS1.SSS1.p1.6.m6.3.3.4.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.4.3">ğ‘›</ci></apply><list id="S3.SS1.SSS1.p1.6.m6.3.3.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2"><apply id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.2">ğ’„</ci><ci id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.2.3">ğ‘›</ci></apply><cn type="integer" id="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1">â€¦</ci><apply id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.2">ğ’„</ci><ci id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.2.3">ğ‘›</ci></apply><ci id="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.3.3.2.2.2.3">ğ¾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m6.3c">\bm{C}^{n}=[\bm{c}^{n}_{1},\ldots,\bm{c}^{n}_{K}]</annotation></semantics></math> and each codeword is a <math id="S3.SS1.SSS1.p1.7.m7.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS1.SSS1.p1.7.m7.1a"><mi id="S3.SS1.SSS1.p1.7.m7.1.1" xref="S3.SS1.SSS1.p1.7.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.7.m7.1b"><ci id="S3.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m7.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.7.m7.1c">D</annotation></semantics></math>-dimensional cluster-centroid.
For a parameter vector <math id="S3.SS1.SSS1.p1.8.m8.1" class="ltx_Math" alttext="\bm{z}\in{R}^{L}" display="inline"><semantics id="S3.SS1.SSS1.p1.8.m8.1a"><mrow id="S3.SS1.SSS1.p1.8.m8.1.1" xref="S3.SS1.SSS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.SSS1.p1.8.m8.1.1.2" xref="S3.SS1.SSS1.p1.8.m8.1.1.2.cmml">ğ’›</mi><mo id="S3.SS1.SSS1.p1.8.m8.1.1.1" xref="S3.SS1.SSS1.p1.8.m8.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS1.SSS1.p1.8.m8.1.1.3" xref="S3.SS1.SSS1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.8.m8.1.1.3.2" xref="S3.SS1.SSS1.p1.8.m8.1.1.3.2.cmml">R</mi><mi id="S3.SS1.SSS1.p1.8.m8.1.1.3.3" xref="S3.SS1.SSS1.p1.8.m8.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.8.m8.1b"><apply id="S3.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1"><in id="S3.SS1.SSS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1.1"></in><ci id="S3.SS1.SSS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1.2">ğ’›</ci><apply id="S3.SS1.SSS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1.3.2">ğ‘…</ci><ci id="S3.SS1.SSS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1.3.3">ğ¿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.8.m8.1c">\bm{z}\in{R}^{L}</annotation></semantics></math> of a model layer, if we choose to compress it using the
<math id="S3.SS1.SSS1.p1.9.m9.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.SSS1.p1.9.m9.1a"><mi id="S3.SS1.SSS1.p1.9.m9.1.1" xref="S3.SS1.SSS1.p1.9.m9.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.9.m9.1b"><ci id="S3.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m9.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.9.m9.1c">n</annotation></semantics></math>-th codebook, the first step involves partitioning vector <math id="S3.SS1.SSS1.p1.10.m10.1" class="ltx_Math" alttext="\bm{z}\in{R}^{L}" display="inline"><semantics id="S3.SS1.SSS1.p1.10.m10.1a"><mrow id="S3.SS1.SSS1.p1.10.m10.1.1" xref="S3.SS1.SSS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.SSS1.p1.10.m10.1.1.2" xref="S3.SS1.SSS1.p1.10.m10.1.1.2.cmml">ğ’›</mi><mo id="S3.SS1.SSS1.p1.10.m10.1.1.1" xref="S3.SS1.SSS1.p1.10.m10.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS1.SSS1.p1.10.m10.1.1.3" xref="S3.SS1.SSS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.10.m10.1.1.3.2" xref="S3.SS1.SSS1.p1.10.m10.1.1.3.2.cmml">R</mi><mi id="S3.SS1.SSS1.p1.10.m10.1.1.3.3" xref="S3.SS1.SSS1.p1.10.m10.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.10.m10.1b"><apply id="S3.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1"><in id="S3.SS1.SSS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1.1"></in><ci id="S3.SS1.SSS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1.2">ğ’›</ci><apply id="S3.SS1.SSS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1.3.2">ğ‘…</ci><ci id="S3.SS1.SSS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1.3.3">ğ¿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.10.m10.1c">\bm{z}\in{R}^{L}</annotation></semantics></math> from the encoding stage into <math id="S3.SS1.SSS1.p1.11.m11.1" class="ltx_Math" alttext="\frac{L}{D}" display="inline"><semantics id="S3.SS1.SSS1.p1.11.m11.1a"><mfrac id="S3.SS1.SSS1.p1.11.m11.1.1" xref="S3.SS1.SSS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.SSS1.p1.11.m11.1.1.2" xref="S3.SS1.SSS1.p1.11.m11.1.1.2.cmml">L</mi><mi id="S3.SS1.SSS1.p1.11.m11.1.1.3" xref="S3.SS1.SSS1.p1.11.m11.1.1.3.cmml">D</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.11.m11.1b"><apply id="S3.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S3.SS1.SSS1.p1.11.m11.1.1"><divide id="S3.SS1.SSS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.SSS1.p1.11.m11.1.1"></divide><ci id="S3.SS1.SSS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.SSS1.p1.11.m11.1.1.2">ğ¿</ci><ci id="S3.SS1.SSS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.SSS1.p1.11.m11.1.1.3">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.11.m11.1c">\frac{L}{D}</annotation></semantics></math> subvectors: <math id="S3.SS1.SSS1.p1.12.m12.5" class="ltx_Math" alttext="\bm{z}=[\bm{z}^{1},\cdots,\bm{z}^{m},\cdots,\bm{z}^{\frac{L}{D}}]" display="inline"><semantics id="S3.SS1.SSS1.p1.12.m12.5a"><mrow id="S3.SS1.SSS1.p1.12.m12.5.5" xref="S3.SS1.SSS1.p1.12.m12.5.5.cmml"><mi id="S3.SS1.SSS1.p1.12.m12.5.5.5" xref="S3.SS1.SSS1.p1.12.m12.5.5.5.cmml">ğ’›</mi><mo id="S3.SS1.SSS1.p1.12.m12.5.5.4" xref="S3.SS1.SSS1.p1.12.m12.5.5.4.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.12.m12.5.5.3.3" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.4" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml">[</mo><msup id="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1" xref="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.2" xref="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.2.cmml">ğ’›</mi><mn id="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.3" xref="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.3.cmml">1</mn></msup><mo id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.5" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p1.12.m12.1.1" xref="S3.SS1.SSS1.p1.12.m12.1.1.cmml">â‹¯</mi><mo id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.6" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml">,</mo><msup id="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2" xref="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.2" xref="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.2.cmml">ğ’›</mi><mi id="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.3" xref="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.3.cmml">m</mi></msup><mo id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.7" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p1.12.m12.2.2" xref="S3.SS1.SSS1.p1.12.m12.2.2.cmml">â‹¯</mi><mo id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.8" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml">,</mo><msup id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.cmml"><mi id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.2" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.2.cmml">ğ’›</mi><mfrac id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.cmml"><mi id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.2" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.2.cmml">L</mi><mi id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.3" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.3.cmml">D</mi></mfrac></msup><mo stretchy="false" id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.9" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.12.m12.5b"><apply id="S3.SS1.SSS1.p1.12.m12.5.5.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5"><eq id="S3.SS1.SSS1.p1.12.m12.5.5.4.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.4"></eq><ci id="S3.SS1.SSS1.p1.12.m12.5.5.5.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.5">ğ’›</ci><list id="S3.SS1.SSS1.p1.12.m12.5.5.3.4.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3"><apply id="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.2">ğ’›</ci><cn type="integer" id="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.12.m12.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS1.p1.12.m12.1.1.cmml" xref="S3.SS1.SSS1.p1.12.m12.1.1">â‹¯</ci><apply id="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.2">ğ’›</ci><ci id="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.12.m12.4.4.2.2.2.3">ğ‘š</ci></apply><ci id="S3.SS1.SSS1.p1.12.m12.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m12.2.2">â‹¯</ci><apply id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.1.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3">superscript</csymbol><ci id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.2.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.2">ğ’›</ci><apply id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3"><divide id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.1.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3"></divide><ci id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.2.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.2">ğ¿</ci><ci id="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.3.cmml" xref="S3.SS1.SSS1.p1.12.m12.5.5.3.3.3.3.3">ğ·</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.12.m12.5c">\bm{z}=[\bm{z}^{1},\cdots,\bm{z}^{m},\cdots,\bm{z}^{\frac{L}{D}}]</annotation></semantics></math>. In the <math id="S3.SS1.SSS1.p1.13.m13.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.SSS1.p1.13.m13.1a"><mi id="S3.SS1.SSS1.p1.13.m13.1.1" xref="S3.SS1.SSS1.p1.13.m13.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.13.m13.1b"><ci id="S3.SS1.SSS1.p1.13.m13.1.1.cmml" xref="S3.SS1.SSS1.p1.13.m13.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.13.m13.1c">m</annotation></semantics></math>-th subspace, the product quantization approximates <math id="S3.SS1.SSS1.p1.14.m14.1" class="ltx_Math" alttext="\bm{z}^{m}" display="inline"><semantics id="S3.SS1.SSS1.p1.14.m14.1a"><msup id="S3.SS1.SSS1.p1.14.m14.1.1" xref="S3.SS1.SSS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.SSS1.p1.14.m14.1.1.2" xref="S3.SS1.SSS1.p1.14.m14.1.1.2.cmml">ğ’›</mi><mi id="S3.SS1.SSS1.p1.14.m14.1.1.3" xref="S3.SS1.SSS1.p1.14.m14.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.14.m14.1b"><apply id="S3.SS1.SSS1.p1.14.m14.1.1.cmml" xref="S3.SS1.SSS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.SSS1.p1.14.m14.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.SSS1.p1.14.m14.1.1.2">ğ’›</ci><ci id="S3.SS1.SSS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.SSS1.p1.14.m14.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.14.m14.1c">\bm{z}^{m}</annotation></semantics></math> by the nearest codeword:</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\displaystyle\hat{\bm{z}}^{m}_{n}=\arg\min_{q^{m}\in[K]}||\bm{z}^{m}_{n}-\bm{c}^{n}_{q^{m}}||." display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E2.m1.2.2.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.2.cmml">ğ’›</mi><mo id="S3.E2.m1.2.2.1.1.3.2.2.1" xref="S3.E2.m1.2.2.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.2.2.1.1.3.3" xref="S3.E2.m1.2.2.1.1.3.3.cmml">n</mi><mi id="S3.E2.m1.2.2.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.3.2.3.cmml">m</mi></msubsup><mo id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E2.m1.2.2.1.1.1.3a" xref="S3.E2.m1.2.2.1.1.1.3.cmml">â¡</mo><munder id="S3.E2.m1.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.3.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.1.3.2.2.cmml">min</mi><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><msup id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">q</mi><mi id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3.cmml">m</mi></msup><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">âˆˆ</mo><mrow id="S3.E2.m1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.4.2.1" xref="S3.E2.m1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">K</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.1.cmml">â€–</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">ğ’›</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml">n</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">m</mi></msubsup><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml">âˆ’</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">ğ’„</mi><msup id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">q</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">m</mi></msup><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">n</mi></msubsup></mrow><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.2.1.cmml">â€–</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"></eq><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2"><ci id="S3.E2.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.1">^</ci><ci id="S3.E2.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2">ğ’›</ci></apply><ci id="S3.E2.m1.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3">ğ‘š</ci></apply><ci id="S3.E2.m1.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3">ğ‘›</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><arg id="S3.E2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3.1"></arg><apply id="S3.E2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2">subscript</csymbol><min id="S3.E2.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2.2"></min><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><in id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></in><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">ğ‘</ci><ci id="S3.E2.m1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3">ğ‘š</ci></apply><apply id="S3.E2.m1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.4.1.1.cmml" xref="S3.E2.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">ğ¾</ci></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1"><minus id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.2">ğ’›</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.2.3">ğ‘š</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.3">ğ‘›</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.2">ğ’„</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.3">ğ‘›</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.2">ğ‘</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.3">ğ‘š</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\displaystyle\hat{\bm{z}}^{m}_{n}=\arg\min_{q^{m}\in[K]}||\bm{z}^{m}_{n}-\bm{c}^{n}_{q^{m}}||.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.15" class="ltx_p">Then, we obtain quantization code and the quantized reconstruction feature <math id="S3.SS1.SSS1.p1.15.m1.1" class="ltx_Math" alttext="\hat{\bm{z}}" display="inline"><semantics id="S3.SS1.SSS1.p1.15.m1.1a"><mover accent="true" id="S3.SS1.SSS1.p1.15.m1.1.1" xref="S3.SS1.SSS1.p1.15.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.15.m1.1.1.2" xref="S3.SS1.SSS1.p1.15.m1.1.1.2.cmml">ğ’›</mi><mo id="S3.SS1.SSS1.p1.15.m1.1.1.1" xref="S3.SS1.SSS1.p1.15.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.15.m1.1b"><apply id="S3.SS1.SSS1.p1.15.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.15.m1.1.1"><ci id="S3.SS1.SSS1.p1.15.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.15.m1.1.1.1">^</ci><ci id="S3.SS1.SSS1.p1.15.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.15.m1.1.1.2">ğ’›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.15.m1.1c">\hat{\bm{z}}</annotation></semantics></math> as:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="{q}_{n}=\left[{q}^{1}_{n},{q}^{2}_{n},\cdots,{q}^{\frac{L}{D}}_{n}\right]," display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.5" xref="S3.E3.m1.2.2.1.1.5.cmml"><mi id="S3.E3.m1.2.2.1.1.5.2" xref="S3.E3.m1.2.2.1.1.5.2.cmml">q</mi><mi id="S3.E3.m1.2.2.1.1.5.3" xref="S3.E3.m1.2.2.1.1.5.3.cmml">n</mi></msub><mo id="S3.E3.m1.2.2.1.1.4" xref="S3.E3.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.3.3" xref="S3.E3.m1.2.2.1.1.3.4.cmml"><mo id="S3.E3.m1.2.2.1.1.3.3.4" xref="S3.E3.m1.2.2.1.1.3.4.cmml">[</mo><msubsup id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.3.cmml">n</mi><mn id="S3.E3.m1.2.2.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.E3.m1.2.2.1.1.3.3.5" xref="S3.E3.m1.2.2.1.1.3.4.cmml">,</mo><msubsup id="S3.E3.m1.2.2.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.cmml">q</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.3.cmml">n</mi><mn id="S3.E3.m1.2.2.1.1.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.E3.m1.2.2.1.1.3.3.6" xref="S3.E3.m1.2.2.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">â‹¯</mi><mo id="S3.E3.m1.2.2.1.1.3.3.7" xref="S3.E3.m1.2.2.1.1.3.4.cmml">,</mo><msubsup id="S3.E3.m1.2.2.1.1.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.3.2.2" xref="S3.E3.m1.2.2.1.1.3.3.3.2.2.cmml">q</mi><mi id="S3.E3.m1.2.2.1.1.3.3.3.3" xref="S3.E3.m1.2.2.1.1.3.3.3.3.cmml">n</mi><mfrac id="S3.E3.m1.2.2.1.1.3.3.3.2.3" xref="S3.E3.m1.2.2.1.1.3.3.3.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.3.2.3.2" xref="S3.E3.m1.2.2.1.1.3.3.3.2.3.2.cmml">L</mi><mi id="S3.E3.m1.2.2.1.1.3.3.3.2.3.3" xref="S3.E3.m1.2.2.1.1.3.3.3.2.3.3.cmml">D</mi></mfrac></msubsup><mo id="S3.E3.m1.2.2.1.1.3.3.8" xref="S3.E3.m1.2.2.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.4"></eq><apply id="S3.E3.m1.2.2.1.1.5.cmml" xref="S3.E3.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.5.1.cmml" xref="S3.E3.m1.2.2.1.1.5">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.5.2.cmml" xref="S3.E3.m1.2.2.1.1.5.2">ğ‘</ci><ci id="S3.E3.m1.2.2.1.1.5.3.cmml" xref="S3.E3.m1.2.2.1.1.5.3">ğ‘›</ci></apply><list id="S3.E3.m1.2.2.1.1.3.4.cmml" xref="S3.E3.m1.2.2.1.1.3.3"><apply id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2">ğ‘</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3">ğ‘›</ci></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2">ğ‘</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E3.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.3">ğ‘›</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">â‹¯</ci><apply id="S3.E3.m1.2.2.1.1.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.3.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.2.2">ğ‘</ci><apply id="S3.E3.m1.2.2.1.1.3.3.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.2.3"><divide id="S3.E3.m1.2.2.1.1.3.3.3.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.2.3"></divide><ci id="S3.E3.m1.2.2.1.1.3.3.3.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.2.3.2">ğ¿</ci><ci id="S3.E3.m1.2.2.1.1.3.3.3.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.2.3.3">ğ·</ci></apply></apply><ci id="S3.E3.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.3.3">ğ‘›</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">{q}_{n}=\left[{q}^{1}_{n},{q}^{2}_{n},\cdots,{q}^{\frac{L}{D}}_{n}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\hat{\bm{z}}_{n}=\left[\hat{\bm{z}}^{1}_{n},\hat{\bm{z}}^{2}_{n},\cdots,\hat{\bm{z}}^{\frac{L}{D}}_{n}\right]," display="block"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.5" xref="S3.E4.m1.2.2.1.1.5.cmml"><mover accent="true" id="S3.E4.m1.2.2.1.1.5.2" xref="S3.E4.m1.2.2.1.1.5.2.cmml"><mi id="S3.E4.m1.2.2.1.1.5.2.2" xref="S3.E4.m1.2.2.1.1.5.2.2.cmml">ğ’›</mi><mo id="S3.E4.m1.2.2.1.1.5.2.1" xref="S3.E4.m1.2.2.1.1.5.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.2.2.1.1.5.3" xref="S3.E4.m1.2.2.1.1.5.3.cmml">n</mi></msub><mo id="S3.E4.m1.2.2.1.1.4" xref="S3.E4.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.4.cmml"><mo id="S3.E4.m1.2.2.1.1.3.3.4" xref="S3.E4.m1.2.2.1.1.3.4.cmml">[</mo><msubsup id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.2.2.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.2.cmml">ğ’›</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.2.2.1" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.3.cmml">n</mi><mn id="S3.E4.m1.2.2.1.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.E4.m1.2.2.1.1.3.3.5" xref="S3.E4.m1.2.2.1.1.3.4.cmml">,</mo><msubsup id="S3.E4.m1.2.2.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.cmml"><mover accent="true" id="S3.E4.m1.2.2.1.1.2.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2.2.cmml">ğ’›</mi><mo id="S3.E4.m1.2.2.1.1.2.2.2.2.2.1" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.2.2.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.2.3.cmml">n</mi><mn id="S3.E4.m1.2.2.1.1.2.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.E4.m1.2.2.1.1.3.3.6" xref="S3.E4.m1.2.2.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">â‹¯</mi><mo id="S3.E4.m1.2.2.1.1.3.3.7" xref="S3.E4.m1.2.2.1.1.3.4.cmml">,</mo><msubsup id="S3.E4.m1.2.2.1.1.3.3.3" xref="S3.E4.m1.2.2.1.1.3.3.3.cmml"><mover accent="true" id="S3.E4.m1.2.2.1.1.3.3.3.2.2" xref="S3.E4.m1.2.2.1.1.3.3.3.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.3.3.3.2.2.2" xref="S3.E4.m1.2.2.1.1.3.3.3.2.2.2.cmml">ğ’›</mi><mo id="S3.E4.m1.2.2.1.1.3.3.3.2.2.1" xref="S3.E4.m1.2.2.1.1.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.2.2.1.1.3.3.3.3" xref="S3.E4.m1.2.2.1.1.3.3.3.3.cmml">n</mi><mfrac id="S3.E4.m1.2.2.1.1.3.3.3.2.3" xref="S3.E4.m1.2.2.1.1.3.3.3.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.3.3.3.2.3.2" xref="S3.E4.m1.2.2.1.1.3.3.3.2.3.2.cmml">L</mi><mi id="S3.E4.m1.2.2.1.1.3.3.3.2.3.3" xref="S3.E4.m1.2.2.1.1.3.3.3.2.3.3.cmml">D</mi></mfrac></msubsup><mo id="S3.E4.m1.2.2.1.1.3.3.8" xref="S3.E4.m1.2.2.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.4"></eq><apply id="S3.E4.m1.2.2.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.5.1.cmml" xref="S3.E4.m1.2.2.1.1.5">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.5.2.cmml" xref="S3.E4.m1.2.2.1.1.5.2"><ci id="S3.E4.m1.2.2.1.1.5.2.1.cmml" xref="S3.E4.m1.2.2.1.1.5.2.1">^</ci><ci id="S3.E4.m1.2.2.1.1.5.2.2.cmml" xref="S3.E4.m1.2.2.1.1.5.2.2">ğ’›</ci></apply><ci id="S3.E4.m1.2.2.1.1.5.3.cmml" xref="S3.E4.m1.2.2.1.1.5.3">ğ‘›</ci></apply><list id="S3.E4.m1.2.2.1.1.3.4.cmml" xref="S3.E4.m1.2.2.1.1.3.3"><apply id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2"><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.2">ğ’›</ci></apply><cn type="integer" id="S3.E4.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E4.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.3">ğ‘›</ci></apply><apply id="S3.E4.m1.2.2.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2"><ci id="S3.E4.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2.1">^</ci><ci id="S3.E4.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2.2">ğ’›</ci></apply><cn type="integer" id="S3.E4.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E4.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3">ğ‘›</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">â‹¯</ci><apply id="S3.E4.m1.2.2.1.1.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.3.3.2.1.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.3.3.3.2.2.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.2.2"><ci id="S3.E4.m1.2.2.1.1.3.3.3.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.2.2.1">^</ci><ci id="S3.E4.m1.2.2.1.1.3.3.3.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.2.2.2">ğ’›</ci></apply><apply id="S3.E4.m1.2.2.1.1.3.3.3.2.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.2.3"><divide id="S3.E4.m1.2.2.1.1.3.3.3.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.2.3"></divide><ci id="S3.E4.m1.2.2.1.1.3.3.3.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.2.3.2">ğ¿</ci><ci id="S3.E4.m1.2.2.1.1.3.3.3.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.2.3.3">ğ·</ci></apply></apply><ci id="S3.E4.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3.3.3">ğ‘›</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\hat{\bm{z}}_{n}=\left[\hat{\bm{z}}^{1}_{n},\hat{\bm{z}}^{2}_{n},\cdots,\hat{\bm{z}}^{\frac{L}{D}}_{n}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.20" class="ltx_p">where <math id="S3.SS1.SSS1.p1.16.m1.1" class="ltx_Math" alttext="{q}" display="inline"><semantics id="S3.SS1.SSS1.p1.16.m1.1a"><mi id="S3.SS1.SSS1.p1.16.m1.1.1" xref="S3.SS1.SSS1.p1.16.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.16.m1.1b"><ci id="S3.SS1.SSS1.p1.16.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.16.m1.1c">{q}</annotation></semantics></math> can be represented as a binary code with <math id="S3.SS1.SSS1.p1.17.m2.2" class="ltx_Math" alttext="M\log_{2}(K)" display="inline"><semantics id="S3.SS1.SSS1.p1.17.m2.2a"><mrow id="S3.SS1.SSS1.p1.17.m2.2.2" xref="S3.SS1.SSS1.p1.17.m2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.17.m2.2.2.3" xref="S3.SS1.SSS1.p1.17.m2.2.2.3.cmml">M</mi><mo lspace="0.167em" rspace="0em" id="S3.SS1.SSS1.p1.17.m2.2.2.2" xref="S3.SS1.SSS1.p1.17.m2.2.2.2.cmml">â€‹</mo><mrow id="S3.SS1.SSS1.p1.17.m2.2.2.1.1" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.2.cmml"><msub id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.2" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.2.cmml">log</mi><mn id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.3" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS1.SSS1.p1.17.m2.2.2.1.1a" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.2.cmml">â¡</mo><mrow id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.2" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.2.1" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.2.cmml">(</mo><mi id="S3.SS1.SSS1.p1.17.m2.1.1" xref="S3.SS1.SSS1.p1.17.m2.1.1.cmml">K</mi><mo stretchy="false" id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.2.2" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.17.m2.2b"><apply id="S3.SS1.SSS1.p1.17.m2.2.2.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2"><times id="S3.SS1.SSS1.p1.17.m2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2.2"></times><ci id="S3.SS1.SSS1.p1.17.m2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2.3">ğ‘€</ci><apply id="S3.SS1.SSS1.p1.17.m2.2.2.1.2.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1"><apply id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1">subscript</csymbol><log id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.2"></log><cn type="integer" id="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.17.m2.2.2.1.1.1.3">2</cn></apply><ci id="S3.SS1.SSS1.p1.17.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.17.m2.1.1">ğ¾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.17.m2.2c">M\log_{2}(K)</annotation></semantics></math> bits.
In FedMPQ, the parameter vector <math id="S3.SS1.SSS1.p1.18.m3.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S3.SS1.SSS1.p1.18.m3.1a"><mi id="S3.SS1.SSS1.p1.18.m3.1.1" xref="S3.SS1.SSS1.p1.18.m3.1.1.cmml">ğ’›</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.18.m3.1b"><ci id="S3.SS1.SSS1.p1.18.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.18.m3.1.1">ğ’›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.18.m3.1c">\bm{z}</annotation></semantics></math> attempts to be quantized using all codebooks, and the one with the smallest distance to <math id="S3.SS1.SSS1.p1.19.m4.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S3.SS1.SSS1.p1.19.m4.1a"><mi id="S3.SS1.SSS1.p1.19.m4.1.1" xref="S3.SS1.SSS1.p1.19.m4.1.1.cmml">ğ’›</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.19.m4.1b"><ci id="S3.SS1.SSS1.p1.19.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.19.m4.1.1">ğ’›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.19.m4.1c">\bm{z}</annotation></semantics></math> is selected as the final result <math id="S3.SS1.SSS1.p1.20.m5.1" class="ltx_Math" alttext="\hat{\bm{z}}" display="inline"><semantics id="S3.SS1.SSS1.p1.20.m5.1a"><mover accent="true" id="S3.SS1.SSS1.p1.20.m5.1.1" xref="S3.SS1.SSS1.p1.20.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p1.20.m5.1.1.2" xref="S3.SS1.SSS1.p1.20.m5.1.1.2.cmml">ğ’›</mi><mo id="S3.SS1.SSS1.p1.20.m5.1.1.1" xref="S3.SS1.SSS1.p1.20.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.20.m5.1b"><apply id="S3.SS1.SSS1.p1.20.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.20.m5.1.1"><ci id="S3.SS1.SSS1.p1.20.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p1.20.m5.1.1.1">^</ci><ci id="S3.SS1.SSS1.p1.20.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.20.m5.1.1.2">ğ’›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.20.m5.1c">\hat{\bm{z}}</annotation></semantics></math>:</p>
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\displaystyle\hat{\bm{z}}=\arg\min_{n\in[M]}||\bm{z}-\hat{\bm{z}}_{n}||." display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mover accent="true" id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.3.2" xref="S3.E5.m1.2.2.1.1.3.2.cmml">ğ’›</mi><mo id="S3.E5.m1.2.2.1.1.3.1" xref="S3.E5.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E5.m1.2.2.1.1.1.3a" xref="S3.E5.m1.2.2.1.1.1.3.cmml">â¡</mo><munder id="S3.E5.m1.2.2.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.1.3.2.2.cmml">min</mi><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml">n</mi><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">âˆˆ</mo><mrow id="S3.E5.m1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.4.2.1" xref="S3.E5.m1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">M</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.4.2.2" xref="S3.E5.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.1.cmml">â€–</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">ğ’›</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml">âˆ’</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">ğ’›</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml">n</mi></msub></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.2.1.cmml">â€–</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"></eq><apply id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"><ci id="S3.E5.m1.2.2.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3.1">^</ci><ci id="S3.E5.m1.2.2.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2">ğ’›</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3"><arg id="S3.E5.m1.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.1"></arg><apply id="S3.E5.m1.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2">subscript</csymbol><min id="S3.E5.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.2"></min><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><in id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></in><ci id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">ğ‘›</ci><apply id="S3.E5.m1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.4.1.1.cmml" xref="S3.E5.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">ğ‘€</ci></apply></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><minus id="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1"></minus><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2">ğ’›</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2"><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2">ğ’›</ci></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3">ğ‘›</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\displaystyle\hat{\bm{z}}=\arg\min_{n\in[M]}||\bm{z}-\hat{\bm{z}}_{n}||.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.21" class="ltx_p">Furthermore, it is essential to consider that neural networks exhibit significant variations in the parameters across different layers.
Therefore, we maintain a separate set of codebooks for each layer of the neural network to minimize errors.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>pseudo-centroid generated</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">Generating a sufficiently robust shared codebook solely from the serverâ€™s public data is challenging because we cannot accurately simulate the data distribution of the client-side private data.
To address this issue, during the Push process in each training round, we aim to upload certain parameters that assist the server in generating the codebook for the next round while ensuring that gradients are not leaked.
Hence, we introduce a simple and efficient approach that enables the simultaneous generation of the requisite codewords during the vector quantization of updates in federated learning.
</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.8" class="ltx_p">Assume that there are <math id="S3.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="n_{i}^{m}" display="inline"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><msubsup id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.2.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.2.cmml">n</mi><mi id="S3.SS1.SSS2.p2.1.m1.1.1.2.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.SSS2.p2.1.m1.1.1.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><apply id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.2">ğ‘›</ci><ci id="S3.SS1.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.3">ğ‘–</ci></apply><ci id="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">n_{i}^{m}</annotation></semantics></math> subvectors approximated by codeword <math id="S3.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\bm{c}_{i}^{m}" display="inline"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><msubsup id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.1.1.2.2" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.2.cmml">ğ’„</mi><mi id="S3.SS1.SSS2.p2.2.m2.1.1.2.3" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.3.cmml">i</mi><mi id="S3.SS1.SSS2.p2.2.m2.1.1.3" xref="S3.SS1.SSS2.p2.2.m2.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><apply id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.2">ğ’„</ci><ci id="S3.SS1.SSS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.3">ğ‘–</ci></apply><ci id="S3.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">\bm{c}_{i}^{m}</annotation></semantics></math>, which are denoted as <math id="S3.SS1.SSS2.p2.3.m3.3" class="ltx_Math" alttext="\{\bm{s}_{1},\cdots,\bm{s}_{n_{i}^{m}}\}" display="inline"><semantics id="S3.SS1.SSS2.p2.3.m3.3a"><mrow id="S3.SS1.SSS2.p2.3.m3.3.3.2" xref="S3.SS1.SSS2.p2.3.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.3.3.2.3" xref="S3.SS1.SSS2.p2.3.m3.3.3.3.cmml">{</mo><msub id="S3.SS1.SSS2.p2.3.m3.2.2.1.1" xref="S3.SS1.SSS2.p2.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.2.2.1.1.2" xref="S3.SS1.SSS2.p2.3.m3.2.2.1.1.2.cmml">ğ’”</mi><mn id="S3.SS1.SSS2.p2.3.m3.2.2.1.1.3" xref="S3.SS1.SSS2.p2.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS2.p2.3.m3.3.3.2.4" xref="S3.SS1.SSS2.p2.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">â‹¯</mi><mo id="S3.SS1.SSS2.p2.3.m3.3.3.2.5" xref="S3.SS1.SSS2.p2.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS1.SSS2.p2.3.m3.3.3.2.2" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.2.cmml">ğ’”</mi><msubsup id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.2" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.2.cmml">n</mi><mi id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.3" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.3.cmml">i</mi><mi id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.3" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.3.cmml">m</mi></msubsup></msub><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.3.3.2.6" xref="S3.SS1.SSS2.p2.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.3b"><set id="S3.SS1.SSS2.p2.3.m3.3.3.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2"><apply id="S3.SS1.SSS2.p2.3.m3.2.2.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2.1.1.2">ğ’”</ci><cn type="integer" id="S3.SS1.SSS2.p2.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">â‹¯</ci><apply id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.2">ğ’”</ci><apply id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.2">ğ‘›</ci><ci id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.2.3">ğ‘–</ci></apply><ci id="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.2.2.3.3">ğ‘š</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.3c">\{\bm{s}_{1},\cdots,\bm{s}_{n_{i}^{m}}\}</annotation></semantics></math>, where <math id="S3.SS1.SSS2.p2.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.SSS2.p2.4.m4.1a"><mi id="S3.SS1.SSS2.p2.4.m4.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m4.1b"><ci id="S3.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m4.1c">m</annotation></semantics></math> denotes the <math id="S3.SS1.SSS2.p2.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.SSS2.p2.5.m5.1a"><mi id="S3.SS1.SSS2.p2.5.m5.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m5.1b"><ci id="S3.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m5.1c">m</annotation></semantics></math>-th codebook of the quantizer and <math id="S3.SS1.SSS2.p2.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.SSS2.p2.6.m6.1a"><mi id="S3.SS1.SSS2.p2.6.m6.1.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m6.1b"><ci id="S3.SS1.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m6.1c">i</annotation></semantics></math> denotes the <math id="S3.SS1.SSS2.p2.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.SSS2.p2.7.m7.1a"><mi id="S3.SS1.SSS2.p2.7.m7.1.1" xref="S3.SS1.SSS2.p2.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.7.m7.1b"><ci id="S3.SS1.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.7.m7.1c">i</annotation></semantics></math>-th codeword of the codebook. We then update the codeword <math id="S3.SS1.SSS2.p2.8.m8.1" class="ltx_Math" alttext="\bm{c}_{i}^{m}" display="inline"><semantics id="S3.SS1.SSS2.p2.8.m8.1a"><msubsup id="S3.SS1.SSS2.p2.8.m8.1.1" xref="S3.SS1.SSS2.p2.8.m8.1.1.cmml"><mi id="S3.SS1.SSS2.p2.8.m8.1.1.2.2" xref="S3.SS1.SSS2.p2.8.m8.1.1.2.2.cmml">ğ’„</mi><mi id="S3.SS1.SSS2.p2.8.m8.1.1.2.3" xref="S3.SS1.SSS2.p2.8.m8.1.1.2.3.cmml">i</mi><mi id="S3.SS1.SSS2.p2.8.m8.1.1.3" xref="S3.SS1.SSS2.p2.8.m8.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.8.m8.1b"><apply id="S3.SS1.SSS2.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m8.1.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p2.8.m8.1.1.2.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1.2.2">ğ’„</ci><ci id="S3.SS1.SSS2.p2.8.m8.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1.2.3">ğ‘–</ci></apply><ci id="S3.SS1.SSS2.p2.8.m8.1.1.3.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.8.m8.1c">\bm{c}_{i}^{m}</annotation></semantics></math> to approach the mean value of these subvectors:</p>
<table id="S5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E6.m1.18" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{c}_{i}^{m}&amp;\leftarrow\bm{c}_{i}^{m}\cdot(1-\gamma)+\frac{\sum_{j}^{n_{i}^{m}}\bm{s}_{j}\cdot\gamma}{n_{i}^{m}},\\
\end{split}" display="inline"><semantics id="S3.E6.m1.18a"><mtable columnspacing="0pt" id="S3.E6.m1.18.18.2"><mtr id="S3.E6.m1.18.18.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.18.18.2b"><msubsup id="S3.E6.m1.3.3.3.3.3a"><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">ğ’„</mi><mi id="S3.E6.m1.2.2.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.2.2.1.cmml">i</mi><mi id="S3.E6.m1.3.3.3.3.3.3.1" xref="S3.E6.m1.3.3.3.3.3.3.1.cmml">m</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.18.18.2c"><mrow id="S3.E6.m1.18.18.2.17.17.14.14"><mrow id="S3.E6.m1.18.18.2.17.17.14.14.1"><mi id="S3.E6.m1.18.18.2.17.17.14.14.1.2" xref="S3.E6.m1.17.17.1.1.1.cmml"></mi><mo stretchy="false" id="S3.E6.m1.4.4.4.4.1.1" xref="S3.E6.m1.4.4.4.4.1.1.cmml">â†</mo><mrow id="S3.E6.m1.18.18.2.17.17.14.14.1.1"><mrow id="S3.E6.m1.18.18.2.17.17.14.14.1.1.1"><msubsup id="S3.E6.m1.18.18.2.17.17.14.14.1.1.1.2"><mi id="S3.E6.m1.5.5.5.5.2.2" xref="S3.E6.m1.5.5.5.5.2.2.cmml">ğ’„</mi><mi id="S3.E6.m1.6.6.6.6.3.3.1" xref="S3.E6.m1.6.6.6.6.3.3.1.cmml">i</mi><mi id="S3.E6.m1.7.7.7.7.4.4.1" xref="S3.E6.m1.7.7.7.7.4.4.1.cmml">m</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.8.8.8.8.5.5" xref="S3.E6.m1.8.8.8.8.5.5.cmml">â‹…</mo><mrow id="S3.E6.m1.18.18.2.17.17.14.14.1.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.9.9.9.9.6.6" xref="S3.E6.m1.17.17.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.18.18.2.17.17.14.14.1.1.1.1.1.1"><mn id="S3.E6.m1.10.10.10.10.7.7" xref="S3.E6.m1.10.10.10.10.7.7.cmml">1</mn><mo id="S3.E6.m1.11.11.11.11.8.8" xref="S3.E6.m1.11.11.11.11.8.8.cmml">âˆ’</mo><mi id="S3.E6.m1.12.12.12.12.9.9" xref="S3.E6.m1.12.12.12.12.9.9.cmml">Î³</mi></mrow><mo stretchy="false" id="S3.E6.m1.13.13.13.13.10.10" xref="S3.E6.m1.17.17.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.14.14.14.14.11.11" xref="S3.E6.m1.14.14.14.14.11.11.cmml">+</mo><mstyle displaystyle="true" id="S3.E6.m1.15.15.15.15.12.12" xref="S3.E6.m1.15.15.15.15.12.12.cmml"><mfrac id="S3.E6.m1.15.15.15.15.12.12a" xref="S3.E6.m1.15.15.15.15.12.12.cmml"><mrow id="S3.E6.m1.15.15.15.15.12.12.2" xref="S3.E6.m1.15.15.15.15.12.12.2.cmml"><msubsup id="S3.E6.m1.15.15.15.15.12.12.2.1" xref="S3.E6.m1.15.15.15.15.12.12.2.1.cmml"><mo id="S3.E6.m1.15.15.15.15.12.12.2.1.2.2" xref="S3.E6.m1.15.15.15.15.12.12.2.1.2.2.cmml">âˆ‘</mo><mi id="S3.E6.m1.15.15.15.15.12.12.2.1.2.3" xref="S3.E6.m1.15.15.15.15.12.12.2.1.2.3.cmml">j</mi><msubsup id="S3.E6.m1.15.15.15.15.12.12.2.1.3" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3.cmml"><mi id="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.2" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.2.cmml">n</mi><mi id="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.3" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.3.cmml">i</mi><mi id="S3.E6.m1.15.15.15.15.12.12.2.1.3.3" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3.3.cmml">m</mi></msubsup></msubsup><mrow id="S3.E6.m1.15.15.15.15.12.12.2.2" xref="S3.E6.m1.15.15.15.15.12.12.2.2.cmml"><msub id="S3.E6.m1.15.15.15.15.12.12.2.2.2" xref="S3.E6.m1.15.15.15.15.12.12.2.2.2.cmml"><mi id="S3.E6.m1.15.15.15.15.12.12.2.2.2.2" xref="S3.E6.m1.15.15.15.15.12.12.2.2.2.2.cmml">ğ’”</mi><mi id="S3.E6.m1.15.15.15.15.12.12.2.2.2.3" xref="S3.E6.m1.15.15.15.15.12.12.2.2.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.15.15.15.15.12.12.2.2.1" xref="S3.E6.m1.15.15.15.15.12.12.2.2.1.cmml">â‹…</mo><mi id="S3.E6.m1.15.15.15.15.12.12.2.2.3" xref="S3.E6.m1.15.15.15.15.12.12.2.2.3.cmml">Î³</mi></mrow></mrow><msubsup id="S3.E6.m1.15.15.15.15.12.12.3" xref="S3.E6.m1.15.15.15.15.12.12.3.cmml"><mi id="S3.E6.m1.15.15.15.15.12.12.3.2.2" xref="S3.E6.m1.15.15.15.15.12.12.3.2.2.cmml">n</mi><mi id="S3.E6.m1.15.15.15.15.12.12.3.2.3" xref="S3.E6.m1.15.15.15.15.12.12.3.2.3.cmml">i</mi><mi id="S3.E6.m1.15.15.15.15.12.12.3.3" xref="S3.E6.m1.15.15.15.15.12.12.3.3.cmml">m</mi></msubsup></mfrac></mstyle></mrow></mrow><mo id="S3.E6.m1.16.16.16.16.13.13" xref="S3.E6.m1.17.17.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.18b"><apply id="S3.E6.m1.17.17.1.1.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><ci id="S3.E6.m1.4.4.4.4.1.1.cmml" xref="S3.E6.m1.4.4.4.4.1.1">â†</ci><apply id="S3.E6.m1.17.17.1.1.1.3.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.17.17.1.1.1.3.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2">superscript</csymbol><apply id="S3.E6.m1.17.17.1.1.1.3.2.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.17.17.1.1.1.3.2.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">ğ’„</ci><ci id="S3.E6.m1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1">ğ‘–</ci></apply><ci id="S3.E6.m1.3.3.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3.3.3.1">ğ‘š</ci></apply><apply id="S3.E6.m1.17.17.1.1.1.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><plus id="S3.E6.m1.14.14.14.14.11.11.cmml" xref="S3.E6.m1.14.14.14.14.11.11"></plus><apply id="S3.E6.m1.17.17.1.1.1.1.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><ci id="S3.E6.m1.8.8.8.8.5.5.cmml" xref="S3.E6.m1.8.8.8.8.5.5">â‹…</ci><apply id="S3.E6.m1.17.17.1.1.1.1.1.3.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.17.17.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2">superscript</csymbol><apply id="S3.E6.m1.17.17.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.17.17.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2">subscript</csymbol><ci id="S3.E6.m1.5.5.5.5.2.2.cmml" xref="S3.E6.m1.5.5.5.5.2.2">ğ’„</ci><ci id="S3.E6.m1.6.6.6.6.3.3.1.cmml" xref="S3.E6.m1.6.6.6.6.3.3.1">ğ‘–</ci></apply><ci id="S3.E6.m1.7.7.7.7.4.4.1.cmml" xref="S3.E6.m1.7.7.7.7.4.4.1">ğ‘š</ci></apply><apply id="S3.E6.m1.17.17.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.18.18.2.17.17.14.14.1.2"><minus id="S3.E6.m1.11.11.11.11.8.8.cmml" xref="S3.E6.m1.11.11.11.11.8.8"></minus><cn type="integer" id="S3.E6.m1.10.10.10.10.7.7.cmml" xref="S3.E6.m1.10.10.10.10.7.7">1</cn><ci id="S3.E6.m1.12.12.12.12.9.9.cmml" xref="S3.E6.m1.12.12.12.12.9.9">ğ›¾</ci></apply></apply><apply id="S3.E6.m1.15.15.15.15.12.12.cmml" xref="S3.E6.m1.15.15.15.15.12.12"><divide id="S3.E6.m1.15.15.15.15.12.12.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12"></divide><apply id="S3.E6.m1.15.15.15.15.12.12.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2"><apply id="S3.E6.m1.15.15.15.15.12.12.2.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.12.12.2.1.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1">superscript</csymbol><apply id="S3.E6.m1.15.15.15.15.12.12.2.1.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.12.12.2.1.2.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1">subscript</csymbol><sum id="S3.E6.m1.15.15.15.15.12.12.2.1.2.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.2.2"></sum><ci id="S3.E6.m1.15.15.15.15.12.12.2.1.2.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.2.3">ğ‘—</ci></apply><apply id="S3.E6.m1.15.15.15.15.12.12.2.1.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.12.12.2.1.3.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3">superscript</csymbol><apply id="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3">subscript</csymbol><ci id="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.2">ğ‘›</ci><ci id="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3.2.3">ğ‘–</ci></apply><ci id="S3.E6.m1.15.15.15.15.12.12.2.1.3.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.1.3.3">ğ‘š</ci></apply></apply><apply id="S3.E6.m1.15.15.15.15.12.12.2.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.2"><ci id="S3.E6.m1.15.15.15.15.12.12.2.2.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.2.1">â‹…</ci><apply id="S3.E6.m1.15.15.15.15.12.12.2.2.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.12.12.2.2.2.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.2.2">subscript</csymbol><ci id="S3.E6.m1.15.15.15.15.12.12.2.2.2.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.2.2.2">ğ’”</ci><ci id="S3.E6.m1.15.15.15.15.12.12.2.2.2.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.2.2.3">ğ‘—</ci></apply><ci id="S3.E6.m1.15.15.15.15.12.12.2.2.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.2.2.3">ğ›¾</ci></apply></apply><apply id="S3.E6.m1.15.15.15.15.12.12.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.3"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.12.12.3.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.3">superscript</csymbol><apply id="S3.E6.m1.15.15.15.15.12.12.3.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.3"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.12.12.3.2.1.cmml" xref="S3.E6.m1.15.15.15.15.12.12.3">subscript</csymbol><ci id="S3.E6.m1.15.15.15.15.12.12.3.2.2.cmml" xref="S3.E6.m1.15.15.15.15.12.12.3.2.2">ğ‘›</ci><ci id="S3.E6.m1.15.15.15.15.12.12.3.2.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.3.2.3">ğ‘–</ci></apply><ci id="S3.E6.m1.15.15.15.15.12.12.3.3.cmml" xref="S3.E6.m1.15.15.15.15.12.12.3.3">ğ‘š</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.18c">\displaystyle\begin{split}\bm{c}_{i}^{m}&amp;\leftarrow\bm{c}_{i}^{m}\cdot(1-\gamma)+\frac{\sum_{j}^{n_{i}^{m}}\bm{s}_{j}\cdot\gamma}{n_{i}^{m}},\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p2.9" class="ltx_p">where <math id="S3.SS1.SSS2.p2.9.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.SSS2.p2.9.m1.1a"><mi id="S3.SS1.SSS2.p2.9.m1.1.1" xref="S3.SS1.SSS2.p2.9.m1.1.1.cmml">Î³</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.9.m1.1b"><ci id="S3.SS1.SSS2.p2.9.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.9.m1.1.1">ğ›¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.9.m1.1c">\gamma</annotation></semantics></math> is a discount factor corresponding to the learning rate, which is initialized as 0.99. Subsequently, the clients will select the top half of codewords, chosen the most times, as pseudo-centroids to upload to the server.</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Residual Error Pruning</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para">
<p id="S3.SS1.SSS3.p1.2" class="ltx_p">PQ has two drawbacks.
First, it suffers from bias in compression, inevitably leading to errors.
Previous methods have often mitigated this issue by maintaining an error accumulation vector at the client, but this solution is challenging to apply in cross-device federated learning since clients are stateless. Second, PQâ€™s compression rate can hardly be flexibly controlled, making it challenging to dynamically adjust data transmission based on the actual client communication bandwidth.
To address these two issues, we propose a supplementary residual compression scheme based pruning.
By controlling the magnitude of uploaded residuals, we can simultaneously reduce errors and flexibly adjust the communication volume, allowing for better adaptation to complex real-world scenarios.
Experimental results demonstrate that residuals ranging from <math id="S3.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="0.1\%" display="inline"><semantics id="S3.SS1.SSS3.p1.1.m1.1a"><mrow id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml"><mn id="S3.SS1.SSS3.p1.1.m1.1.1.2" xref="S3.SS1.SSS3.p1.1.m1.1.1.2.cmml">0.1</mn><mo id="S3.SS1.SSS3.p1.1.m1.1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.1b"><apply id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S3.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1.2">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.1c">0.1\%</annotation></semantics></math> to <math id="S3.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="5\%" display="inline"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><mrow id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml"><mn id="S3.SS1.SSS3.p1.2.m2.1.1.2" xref="S3.SS1.SSS3.p1.2.m2.1.1.2.cmml">5</mn><mo id="S3.SS1.SSS3.p1.2.m2.1.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><apply id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S3.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">5\%</annotation></semantics></math> significantly enhance model convergence rates.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Cloud Update</h3>

<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Secure Aggregation</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.2" class="ltx_p">In regards to the problem of compressing client-to-server model updates under the Secure Aggregation primitive, <cite class="ltx_cite ltx_citemacro_cite">Prasad <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> has provided a detailed discussion and proposed a viable solution.
Building upon their SECIND approach, we have made some enhancements.
AlgorithmÂ <a href="#alg2" title="Algorithm 2 â€£ 3.2.1 Secure Aggregation â€£ 3.2 Cloud Update â€£ 3 Proposed Method â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the entire process of secure aggregation, with all sensitive operations conducted within TEE or TPP.
The aggregator can only access <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="O_{final}" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">O</mi><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1a" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.4" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1b" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.5" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1c" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.6" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">ğ‘‚</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"><times id="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2">ğ‘“</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3">ğ‘–</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.4">ğ‘›</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.5.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.5">ğ‘</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.6.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.6">ğ‘™</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">O_{final}</annotation></semantics></math> and <math id="S3.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="R_{final}" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><msub id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">R</mi><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.2.m2.1.1.3.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.2.m2.1.1.3.1a" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.4" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.2.m2.1.1.3.1b" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.5" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.2.m2.1.1.3.1c" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.6" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2">ğ‘…</ci><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3"><times id="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2">ğ‘“</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3">ğ‘–</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.4.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.4">ğ‘›</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.5.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.5">ğ‘</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.6.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.6">ğ‘™</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">R_{final}</annotation></semantics></math>, thus effectively preventing gradient leakage.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Aggregation Algorithm</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>Â Â <math id="alg2.l0.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg2.l0.m1.1a"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">N</annotation></semantics></math> clients with quantization codes, pruned residuals, and shared codebook <math id="alg2.l0.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg2.l0.m2.1a"><mi id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><ci id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1">ğ¶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">C</annotation></semantics></math>.

</div>
<div id="alg2.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>Â Â Final aggregated <math id="alg2.l0a.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="alg2.l0a.m1.1a"><mi id="alg2.l0a.m1.1.1" xref="alg2.l0a.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="alg2.l0a.m1.1b"><ci id="alg2.l0a.m1.1.1.cmml" xref="alg2.l0a.m1.1.1">ğ‘”</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0a.m1.1c">g</annotation></semantics></math>

</div>
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>Â Â // <span id="alg2.l1.2" class="ltx_text ltx_font_italic">TEE/TPP Phase: Aggregation in compress domain</span> 
</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Â Â Initialize an empty matrix <math id="alg2.l2.m1.2" class="ltx_Math" alttext="O_{\text{final}},R_{\text{final}}" display="inline"><semantics id="alg2.l2.m1.2a"><mrow id="alg2.l2.m1.2.2.2" xref="alg2.l2.m1.2.2.3.cmml"><msub id="alg2.l2.m1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.cmml"><mi id="alg2.l2.m1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.2.cmml">O</mi><mtext id="alg2.l2.m1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.3a.cmml">final</mtext></msub><mo id="alg2.l2.m1.2.2.2.3" xref="alg2.l2.m1.2.2.3.cmml">,</mo><msub id="alg2.l2.m1.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.cmml"><mi id="alg2.l2.m1.2.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.2.cmml">R</mi><mtext id="alg2.l2.m1.2.2.2.2.3" xref="alg2.l2.m1.2.2.2.2.3a.cmml">final</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.2b"><list id="alg2.l2.m1.2.2.3.cmml" xref="alg2.l2.m1.2.2.2"><apply id="alg2.l2.m1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.2">ğ‘‚</ci><ci id="alg2.l2.m1.1.1.1.1.3a.cmml" xref="alg2.l2.m1.1.1.1.1.3"><mtext mathsize="70%" id="alg2.l2.m1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.3">final</mtext></ci></apply><apply id="alg2.l2.m1.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.2.2.2.2.1.cmml" xref="alg2.l2.m1.2.2.2.2">subscript</csymbol><ci id="alg2.l2.m1.2.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2.2">ğ‘…</ci><ci id="alg2.l2.m1.2.2.2.2.3a.cmml" xref="alg2.l2.m1.2.2.2.2.3"><mtext mathsize="70%" id="alg2.l2.m1.2.2.2.2.3.cmml" xref="alg2.l2.m1.2.2.2.2.3">final</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.2c">O_{\text{final}},R_{\text{final}}</annotation></semantics></math>.

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Â Â <span id="alg2.l3.2" class="ltx_text ltx_font_bold">for</span>Â <math id="alg2.l3.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">i</mi><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">=</mo><mn id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><eq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></eq><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">ğ‘–</ci><cn type="integer" id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">i=1</annotation></semantics></math> to <math id="alg2.l3.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg2.l3.m2.1a"><mi id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">N</annotation></semantics></math>Â <span id="alg2.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>Â Â Â Â Â Initialize an empty matrix <math id="alg2.l4.m1.1" class="ltx_Math" alttext="O_{i}" display="inline"><semantics id="alg2.l4.m1.1a"><msub id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">O</mi><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">ğ‘‚</ci><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">O_{i}</annotation></semantics></math>.

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>Â Â Â Â Â <span id="alg2.l5.2" class="ltx_text ltx_font_bold">for</span>Â each element <math id="alg2.l5.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg2.l5.m1.1a"><mi id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">ğ‘’</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">e</annotation></semantics></math> in client <math id="alg2.l5.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l5.m2.1a"><mi id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">i</annotation></semantics></math>â€™s quantization codeÂ <span id="alg2.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Â Â Â Â Â Â Â Â Perform one-hot encoding on <math id="alg2.l6.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">ğ‘’</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">e</annotation></semantics></math> to create a row vector <math id="alg2.l6.m2.1" class="ltx_Math" alttext="v_{e}" display="inline"><semantics id="alg2.l6.m2.1a"><msub id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mi id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2.cmml">v</mi><mi id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1">subscript</csymbol><ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">ğ‘£</ci><ci id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">ğ‘’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">v_{e}</annotation></semantics></math> in <math id="alg2.l6.m3.1" class="ltx_Math" alttext="\mathbb{R}^{1\times K}" display="inline"><semantics id="alg2.l6.m3.1a"><msup id="alg2.l6.m3.1.1" xref="alg2.l6.m3.1.1.cmml"><mi id="alg2.l6.m3.1.1.2" xref="alg2.l6.m3.1.1.2.cmml">â„</mi><mrow id="alg2.l6.m3.1.1.3" xref="alg2.l6.m3.1.1.3.cmml"><mn id="alg2.l6.m3.1.1.3.2" xref="alg2.l6.m3.1.1.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="alg2.l6.m3.1.1.3.1" xref="alg2.l6.m3.1.1.3.1.cmml">Ã—</mo><mi id="alg2.l6.m3.1.1.3.3" xref="alg2.l6.m3.1.1.3.3.cmml">K</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><apply id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1"><csymbol cd="ambiguous" id="alg2.l6.m3.1.1.1.cmml" xref="alg2.l6.m3.1.1">superscript</csymbol><ci id="alg2.l6.m3.1.1.2.cmml" xref="alg2.l6.m3.1.1.2">â„</ci><apply id="alg2.l6.m3.1.1.3.cmml" xref="alg2.l6.m3.1.1.3"><times id="alg2.l6.m3.1.1.3.1.cmml" xref="alg2.l6.m3.1.1.3.1"></times><cn type="integer" id="alg2.l6.m3.1.1.3.2.cmml" xref="alg2.l6.m3.1.1.3.2">1</cn><ci id="alg2.l6.m3.1.1.3.3.cmml" xref="alg2.l6.m3.1.1.3.3">ğ¾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">\mathbb{R}^{1\times K}</annotation></semantics></math>.

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>Â Â Â Â Â Â Â Â Concatenate <math id="alg2.l7.m1.1" class="ltx_Math" alttext="v_{e}" display="inline"><semantics id="alg2.l7.m1.1a"><msub id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">v</mi><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">ğ‘£</ci><ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">ğ‘’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">v_{e}</annotation></semantics></math> row-wise to matrix <math id="alg2.l7.m2.1" class="ltx_Math" alttext="O_{i}" display="inline"><semantics id="alg2.l7.m2.1a"><msub id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><mi id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2.cmml">O</mi><mi id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1">subscript</csymbol><ci id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2">ğ‘‚</ci><ci id="alg2.l7.m2.1.1.3.cmml" xref="alg2.l7.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">O_{i}</annotation></semantics></math>.

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>Â Â Â Â Â <span id="alg2.l8.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg2.l8.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>Â Â Â Â Â Reconstruct pruned residuals for client <math id="alg2.l9.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l9.m1.1a"><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">i</annotation></semantics></math> to generate <math id="alg2.l9.m2.1" class="ltx_Math" alttext="R_{i}" display="inline"><semantics id="alg2.l9.m2.1a"><msub id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml"><mi id="alg2.l9.m2.1.1.2" xref="alg2.l9.m2.1.1.2.cmml">R</mi><mi id="alg2.l9.m2.1.1.3" xref="alg2.l9.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><apply id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.1.cmml" xref="alg2.l9.m2.1.1">subscript</csymbol><ci id="alg2.l9.m2.1.1.2.cmml" xref="alg2.l9.m2.1.1.2">ğ‘…</ci><ci id="alg2.l9.m2.1.1.3.cmml" xref="alg2.l9.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">R_{i}</annotation></semantics></math>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>Â Â Â Â Â <math id="alg2.l10.m1.1" class="ltx_Math" alttext="R_{\text{final}}\leftarrow R_{\text{final}}+R_{i}" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><msub id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml"><mi id="alg2.l10.m1.1.1.2.2" xref="alg2.l10.m1.1.1.2.2.cmml">R</mi><mtext id="alg2.l10.m1.1.1.2.3" xref="alg2.l10.m1.1.1.2.3a.cmml">final</mtext></msub><mo stretchy="false" id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml">â†</mo><mrow id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"><msub id="alg2.l10.m1.1.1.3.2" xref="alg2.l10.m1.1.1.3.2.cmml"><mi id="alg2.l10.m1.1.1.3.2.2" xref="alg2.l10.m1.1.1.3.2.2.cmml">R</mi><mtext id="alg2.l10.m1.1.1.3.2.3" xref="alg2.l10.m1.1.1.3.2.3a.cmml">final</mtext></msub><mo id="alg2.l10.m1.1.1.3.1" xref="alg2.l10.m1.1.1.3.1.cmml">+</mo><msub id="alg2.l10.m1.1.1.3.3" xref="alg2.l10.m1.1.1.3.3.cmml"><mi id="alg2.l10.m1.1.1.3.3.2" xref="alg2.l10.m1.1.1.3.3.2.cmml">R</mi><mi id="alg2.l10.m1.1.1.3.3.3" xref="alg2.l10.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><ci id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1">â†</ci><apply id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.2">subscript</csymbol><ci id="alg2.l10.m1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.2.2">ğ‘…</ci><ci id="alg2.l10.m1.1.1.2.3a.cmml" xref="alg2.l10.m1.1.1.2.3"><mtext mathsize="70%" id="alg2.l10.m1.1.1.2.3.cmml" xref="alg2.l10.m1.1.1.2.3">final</mtext></ci></apply><apply id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3"><plus id="alg2.l10.m1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.3.1"></plus><apply id="alg2.l10.m1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.1.cmml" xref="alg2.l10.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l10.m1.1.1.3.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2">ğ‘…</ci><ci id="alg2.l10.m1.1.1.3.2.3a.cmml" xref="alg2.l10.m1.1.1.3.2.3"><mtext mathsize="70%" id="alg2.l10.m1.1.1.3.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.3">final</mtext></ci></apply><apply id="alg2.l10.m1.1.1.3.3.cmml" xref="alg2.l10.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.3.1.cmml" xref="alg2.l10.m1.1.1.3.3">subscript</csymbol><ci id="alg2.l10.m1.1.1.3.3.2.cmml" xref="alg2.l10.m1.1.1.3.3.2">ğ‘…</ci><ci id="alg2.l10.m1.1.1.3.3.3.cmml" xref="alg2.l10.m1.1.1.3.3.3">ğ‘–</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">R_{\text{final}}\leftarrow R_{\text{final}}+R_{i}</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>Â Â Â Â Â <math id="alg2.l11.m1.1" class="ltx_Math" alttext="O_{\text{final}}\leftarrow O_{\text{final}}+O_{i}" display="inline"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><msub id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml"><mi id="alg2.l11.m1.1.1.2.2" xref="alg2.l11.m1.1.1.2.2.cmml">O</mi><mtext id="alg2.l11.m1.1.1.2.3" xref="alg2.l11.m1.1.1.2.3a.cmml">final</mtext></msub><mo stretchy="false" id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml">â†</mo><mrow id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml"><msub id="alg2.l11.m1.1.1.3.2" xref="alg2.l11.m1.1.1.3.2.cmml"><mi id="alg2.l11.m1.1.1.3.2.2" xref="alg2.l11.m1.1.1.3.2.2.cmml">O</mi><mtext id="alg2.l11.m1.1.1.3.2.3" xref="alg2.l11.m1.1.1.3.2.3a.cmml">final</mtext></msub><mo id="alg2.l11.m1.1.1.3.1" xref="alg2.l11.m1.1.1.3.1.cmml">+</mo><msub id="alg2.l11.m1.1.1.3.3" xref="alg2.l11.m1.1.1.3.3.cmml"><mi id="alg2.l11.m1.1.1.3.3.2" xref="alg2.l11.m1.1.1.3.3.2.cmml">O</mi><mi id="alg2.l11.m1.1.1.3.3.3" xref="alg2.l11.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><ci id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1">â†</ci><apply id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.2.1.cmml" xref="alg2.l11.m1.1.1.2">subscript</csymbol><ci id="alg2.l11.m1.1.1.2.2.cmml" xref="alg2.l11.m1.1.1.2.2">ğ‘‚</ci><ci id="alg2.l11.m1.1.1.2.3a.cmml" xref="alg2.l11.m1.1.1.2.3"><mtext mathsize="70%" id="alg2.l11.m1.1.1.2.3.cmml" xref="alg2.l11.m1.1.1.2.3">final</mtext></ci></apply><apply id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3"><plus id="alg2.l11.m1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.3.1"></plus><apply id="alg2.l11.m1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.3.2.1.cmml" xref="alg2.l11.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l11.m1.1.1.3.2.2.cmml" xref="alg2.l11.m1.1.1.3.2.2">ğ‘‚</ci><ci id="alg2.l11.m1.1.1.3.2.3a.cmml" xref="alg2.l11.m1.1.1.3.2.3"><mtext mathsize="70%" id="alg2.l11.m1.1.1.3.2.3.cmml" xref="alg2.l11.m1.1.1.3.2.3">final</mtext></ci></apply><apply id="alg2.l11.m1.1.1.3.3.cmml" xref="alg2.l11.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.3.3.1.cmml" xref="alg2.l11.m1.1.1.3.3">subscript</csymbol><ci id="alg2.l11.m1.1.1.3.3.2.cmml" xref="alg2.l11.m1.1.1.3.3.2">ğ‘‚</ci><ci id="alg2.l11.m1.1.1.3.3.3.cmml" xref="alg2.l11.m1.1.1.3.3.3">ğ‘–</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">O_{\text{final}}\leftarrow O_{\text{final}}+O_{i}</annotation></semantics></math>.

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>Â Â <span id="alg2.l12.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg2.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>Â Â // <span id="alg2.l13.2" class="ltx_text ltx_font_italic">Aggregator Phase: Reconstruct
</span>

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>Â Â Reconstruct aggregated gradient <math id="alg2.l14.m1.1" class="ltx_Math" alttext="g\leftarrow C\times O_{\text{final}}+R_{\text{final}}" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><mi id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml">g</mi><mo stretchy="false" id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">â†</mo><mrow id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"><mrow id="alg2.l14.m1.1.1.3.2" xref="alg2.l14.m1.1.1.3.2.cmml"><mi id="alg2.l14.m1.1.1.3.2.2" xref="alg2.l14.m1.1.1.3.2.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l14.m1.1.1.3.2.1" xref="alg2.l14.m1.1.1.3.2.1.cmml">Ã—</mo><msub id="alg2.l14.m1.1.1.3.2.3" xref="alg2.l14.m1.1.1.3.2.3.cmml"><mi id="alg2.l14.m1.1.1.3.2.3.2" xref="alg2.l14.m1.1.1.3.2.3.2.cmml">O</mi><mtext id="alg2.l14.m1.1.1.3.2.3.3" xref="alg2.l14.m1.1.1.3.2.3.3a.cmml">final</mtext></msub></mrow><mo id="alg2.l14.m1.1.1.3.1" xref="alg2.l14.m1.1.1.3.1.cmml">+</mo><msub id="alg2.l14.m1.1.1.3.3" xref="alg2.l14.m1.1.1.3.3.cmml"><mi id="alg2.l14.m1.1.1.3.3.2" xref="alg2.l14.m1.1.1.3.3.2.cmml">R</mi><mtext id="alg2.l14.m1.1.1.3.3.3" xref="alg2.l14.m1.1.1.3.3.3a.cmml">final</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><ci id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1">â†</ci><ci id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2">ğ‘”</ci><apply id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3"><plus id="alg2.l14.m1.1.1.3.1.cmml" xref="alg2.l14.m1.1.1.3.1"></plus><apply id="alg2.l14.m1.1.1.3.2.cmml" xref="alg2.l14.m1.1.1.3.2"><times id="alg2.l14.m1.1.1.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.2.1"></times><ci id="alg2.l14.m1.1.1.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.2.2">ğ¶</ci><apply id="alg2.l14.m1.1.1.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.2.3.1.cmml" xref="alg2.l14.m1.1.1.3.2.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.2.3.2.cmml" xref="alg2.l14.m1.1.1.3.2.3.2">ğ‘‚</ci><ci id="alg2.l14.m1.1.1.3.2.3.3a.cmml" xref="alg2.l14.m1.1.1.3.2.3.3"><mtext mathsize="70%" id="alg2.l14.m1.1.1.3.2.3.3.cmml" xref="alg2.l14.m1.1.1.3.2.3.3">final</mtext></ci></apply></apply><apply id="alg2.l14.m1.1.1.3.3.cmml" xref="alg2.l14.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.3.1.cmml" xref="alg2.l14.m1.1.1.3.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.3.2.cmml" xref="alg2.l14.m1.1.1.3.3.2">ğ‘…</ci><ci id="alg2.l14.m1.1.1.3.3.3a.cmml" xref="alg2.l14.m1.1.1.3.3.3"><mtext mathsize="70%" id="alg2.l14.m1.1.1.3.3.3.cmml" xref="alg2.l14.m1.1.1.3.3.3">final</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">g\leftarrow C\times O_{\text{final}}+R_{\text{final}}</annotation></semantics></math>.

</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>Â Â <span id="alg2.l15.2" class="ltx_text ltx_font_bold">return</span> Â <math id="alg2.l15.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="alg2.l15.m1.1a"><mi id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">ğ‘”</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">g</annotation></semantics></math>.

</div>
</div>
</figure>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Codebook update</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">Applying PQ to gradient compression poses a challenge since all PQ algorithms necessitate learning the codebook for compressing gradients.
Nevertheless, we cannot acquire the gradients essential for codebook learning until the commencement of model training.
An ideal solution is to simulate the client training process using public data to obtain gradients.
However, this approach is not applicable in scenarios where data is non-IID, as there may be significant differences between the public dataset and the clientsâ€™ private data.
To tackle this problem, we aim to estimate the next-round gradients by analyzing and utilizing the modelâ€™s historical information during training, especially the gradient information from the previous round.
To achieve this, we maintain multiple codebooks. One of these codebooks is computed using publicly available data, while the remaining codebooks are calculated utilizing pseudo-centroids uploaded by the clients.
AlgorithmÂ <a href="#alg3" title="Algorithm 3 â€£ 3.3.2 Communication and Computation Discussion â€£ 3.3 Performance Discussion â€£ 3 Proposed Method â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> presents the complete flow of the algorithm.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Performance Discussion</h3>

<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Convergence Discussion</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.3" class="ltx_p">The compression technique introduced by FedMPQ exhibits a bias.
For biased compression operations, represented as <math id="S3.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="Q(\cdot)" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mrow id="S3.SS3.SSS1.p1.1.m1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.2.2" xref="S3.SS3.SSS1.p1.1.m1.1.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.1.m1.1.2.1" xref="S3.SS3.SSS1.p1.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S3.SS3.SSS1.p1.1.m1.1.2.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.1.m1.1.2.3.2.1" xref="S3.SS3.SSS1.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">â‹…</mo><mo stretchy="false" id="S3.SS3.SSS1.p1.1.m1.1.2.3.2.2" xref="S3.SS3.SSS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.2"><times id="S3.SS3.SSS1.p1.1.m1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.2.1"></times><ci id="S3.SS3.SSS1.p1.1.m1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.2.2">ğ‘„</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">Q(\cdot)</annotation></semantics></math>,Â <cite class="ltx_cite ltx_citemacro_cite">Li and Li (<a href="#bib.bib11" title="" class="ltx_ref">2023</a>)</cite> have shown that biased compressed SGD converges when <math id="S3.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">ğ‘„</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">Q</annotation></semantics></math> is a <math id="S3.SS3.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><mi id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml">Ï„</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><ci id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">ğœ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">\tau</annotation></semantics></math>-contraction:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="||Q(x)-x||\leq\tau||x||,0\leq\tau&lt;1," display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1"><mrow id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.3.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.2.1.cmml">â€–</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">â€‹</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.2.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml">âˆ’</mo><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.2.1.cmml">â€–</mo></mrow><mo id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">â‰¤</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.2.cmml">Ï„</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.3.1" xref="S3.E7.m1.3.3.1.1.1.1.3.1.cmml">â€‹</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.3.3.2" xref="S3.E7.m1.3.3.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.3.3.2.1" xref="S3.E7.m1.3.3.1.1.1.1.3.3.1.1.cmml">â€–</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.3.3.2.2" xref="S3.E7.m1.3.3.1.1.1.1.3.3.1.1.cmml">â€–</mo></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E7.m1.3.3.1.1.2.2" xref="S3.E7.m1.3.3.1.1.2.2.cmml"><mn id="S3.E7.m1.3.3.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.2.cmml">0</mn><mo id="S3.E7.m1.3.3.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">â‰¤</mo><mi id="S3.E7.m1.3.3.1.1.2.2.4" xref="S3.E7.m1.3.3.1.1.2.2.4.cmml">Ï„</mi><mo id="S3.E7.m1.3.3.1.1.2.2.5" xref="S3.E7.m1.3.3.1.1.2.2.5.cmml">&lt;</mo><mn id="S3.E7.m1.3.3.1.1.2.2.6" xref="S3.E7.m1.3.3.1.1.2.2.6.cmml">1</mn></mrow></mrow><mo id="S3.E7.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3a.cmml" xref="S3.E7.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><leq id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2"></leq><apply id="S3.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1"><minus id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1"></minus><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2"><times id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.2.2">ğ‘„</ci><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">ğ‘¥</ci></apply><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.3">ğ‘¥</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3"><times id="S3.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.1"></times><ci id="S3.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.2">ğœ</ci><apply id="S3.E7.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.3.2"><csymbol cd="latexml" id="S3.E7.m1.3.3.1.1.1.1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3.3.2.1">norm</csymbol><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">ğ‘¥</ci></apply></apply></apply><apply id="S3.E7.m1.3.3.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2"><and id="S3.E7.m1.3.3.1.1.2.2a.cmml" xref="S3.E7.m1.3.3.1.1.2.2"></and><apply id="S3.E7.m1.3.3.1.1.2.2b.cmml" xref="S3.E7.m1.3.3.1.1.2.2"><leq id="S3.E7.m1.3.3.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.3"></leq><cn type="integer" id="S3.E7.m1.3.3.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2">0</cn><ci id="S3.E7.m1.3.3.1.1.2.2.4.cmml" xref="S3.E7.m1.3.3.1.1.2.2.4">ğœ</ci></apply><apply id="S3.E7.m1.3.3.1.1.2.2c.cmml" xref="S3.E7.m1.3.3.1.1.2.2"><lt id="S3.E7.m1.3.3.1.1.2.2.5.cmml" xref="S3.E7.m1.3.3.1.1.2.2.5"></lt><share href="#S3.E7.m1.3.3.1.1.2.2.4.cmml" id="S3.E7.m1.3.3.1.1.2.2d.cmml" xref="S3.E7.m1.3.3.1.1.2.2"></share><cn type="integer" id="S3.E7.m1.3.3.1.1.2.2.6.cmml" xref="S3.E7.m1.3.3.1.1.2.2.6">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">||Q(x)-x||\leq\tau||x||,0\leq\tau&lt;1,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p1.4" class="ltx_p">It is evident that PQ satisfies this condition, as long as it is enforced that there exists a zero vector within the codebook.
Furthermore, empirical experiments demonstrate that our proposed approach exhibits no significant degradation in both accuracy and convergence rate when compared to the uncompressed baseline.</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Communication and Computation Discussion</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.3" class="ltx_p">In our proposed FedMPQ, clients download the complete global model and all shared codebooks at the beginning of each round of training.
After local training is completed, they upload quantization codes, residual error and pseudo-centroids equivalent to half the size of a single codebook.
The codebooks are relatively small compared to the original gradients, making the additional overhead negligible.
Consequently, our method significantly reduces the uplink communication cost, which is cost-effective in wireless network environments.
Regarding computational expenses, the most time-consuming distance calculations in quantization can be optimized using matrix multiplication, resulting in an additional computational cost of <math id="S3.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(MLK)" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mrow id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml">ğ’ª</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">â€‹</mo><mrow id="S3.SS3.SSS2.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml">â€‹</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1a" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml">â€‹</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.4" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.4.cmml">K</mi></mrow><mo stretchy="false" id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><times id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2"></times><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">ğ’ª</ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1"><times id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1"></times><ci id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2">ğ‘€</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3">ğ¿</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.4">ğ¾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\mathcal{O}(MLK)</annotation></semantics></math> for a given vector to be quantized <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="z\in R^{L}" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mrow id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p1.2.m2.1.1.2" xref="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml">z</mi><mo id="S3.SS3.SSS2.p1.2.m2.1.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.1.cmml">âˆˆ</mo><msup id="S3.SS3.SSS2.p1.2.m2.1.1.3" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.2.cmml">R</mi><mi id="S3.SS3.SSS2.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><apply id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1"><in id="S3.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.1"></in><ci id="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.2">ğ‘§</ci><apply id="S3.SS3.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.2">ğ‘…</ci><ci id="S3.SS3.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.3">ğ¿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">z\in R^{L}</annotation></semantics></math>, where <math id="S3.SS3.SSS2.p1.3.m3.2" class="ltx_Math" alttext="M,K" display="inline"><semantics id="S3.SS3.SSS2.p1.3.m3.2a"><mrow id="S3.SS3.SSS2.p1.3.m3.2.3.2" xref="S3.SS3.SSS2.p1.3.m3.2.3.1.cmml"><mi id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">M</mi><mo id="S3.SS3.SSS2.p1.3.m3.2.3.2.1" xref="S3.SS3.SSS2.p1.3.m3.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS2.p1.3.m3.2.2" xref="S3.SS3.SSS2.p1.3.m3.2.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.2b"><list id="S3.SS3.SSS2.p1.3.m3.2.3.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.2.3.2"><ci id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1">ğ‘€</ci><ci id="S3.SS3.SSS2.p1.3.m3.2.2.cmml" xref="S3.SS3.SSS2.p1.3.m3.2.2">ğ¾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.2c">M,K</annotation></semantics></math> has the same meaning as in Section <a href="#S3.SS1.SSS1" title="3.1.1 Product Quantization â€£ 3.1 Client update â€£ 3 Proposed Method â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>.
This cost is acceptable compared to the computational overhead of client model training.</p>
</div>
<figure id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.2.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> Federated Codebook Generation</figcaption>
<div id="alg3.3" class="ltx_listing ltx_listing">
<div id="alg3.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>Â Â Pseudo-centroids <math id="alg3.l0.m1.3" class="ltx_Math" alttext="p_{1},\ldots,p_{N}" display="inline"><semantics id="alg3.l0.m1.3a"><mrow id="alg3.l0.m1.3.3.2" xref="alg3.l0.m1.3.3.3.cmml"><msub id="alg3.l0.m1.2.2.1.1" xref="alg3.l0.m1.2.2.1.1.cmml"><mi id="alg3.l0.m1.2.2.1.1.2" xref="alg3.l0.m1.2.2.1.1.2.cmml">p</mi><mn id="alg3.l0.m1.2.2.1.1.3" xref="alg3.l0.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="alg3.l0.m1.3.3.2.3" xref="alg3.l0.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg3.l0.m1.1.1" xref="alg3.l0.m1.1.1.cmml">â€¦</mi><mo id="alg3.l0.m1.3.3.2.4" xref="alg3.l0.m1.3.3.3.cmml">,</mo><msub id="alg3.l0.m1.3.3.2.2" xref="alg3.l0.m1.3.3.2.2.cmml"><mi id="alg3.l0.m1.3.3.2.2.2" xref="alg3.l0.m1.3.3.2.2.2.cmml">p</mi><mi id="alg3.l0.m1.3.3.2.2.3" xref="alg3.l0.m1.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l0.m1.3b"><list id="alg3.l0.m1.3.3.3.cmml" xref="alg3.l0.m1.3.3.2"><apply id="alg3.l0.m1.2.2.1.1.cmml" xref="alg3.l0.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg3.l0.m1.2.2.1.1.1.cmml" xref="alg3.l0.m1.2.2.1.1">subscript</csymbol><ci id="alg3.l0.m1.2.2.1.1.2.cmml" xref="alg3.l0.m1.2.2.1.1.2">ğ‘</ci><cn type="integer" id="alg3.l0.m1.2.2.1.1.3.cmml" xref="alg3.l0.m1.2.2.1.1.3">1</cn></apply><ci id="alg3.l0.m1.1.1.cmml" xref="alg3.l0.m1.1.1">â€¦</ci><apply id="alg3.l0.m1.3.3.2.2.cmml" xref="alg3.l0.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg3.l0.m1.3.3.2.2.1.cmml" xref="alg3.l0.m1.3.3.2.2">subscript</csymbol><ci id="alg3.l0.m1.3.3.2.2.2.cmml" xref="alg3.l0.m1.3.3.2.2.2">ğ‘</ci><ci id="alg3.l0.m1.3.3.2.2.3.cmml" xref="alg3.l0.m1.3.3.2.2.3">ğ‘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m1.3c">p_{1},\ldots,p_{N}</annotation></semantics></math>, codebook count <math id="alg3.l0.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg3.l0.m2.1a"><mi id="alg3.l0.m2.1.1" xref="alg3.l0.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg3.l0.m2.1b"><ci id="alg3.l0.m2.1.1.cmml" xref="alg3.l0.m2.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m2.1c">n</annotation></semantics></math>, codebook size <math id="alg3.l0.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg3.l0.m3.1a"><mi id="alg3.l0.m3.1.1" xref="alg3.l0.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg3.l0.m3.1b"><ci id="alg3.l0.m3.1.1.cmml" xref="alg3.l0.m3.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m3.1c">K</annotation></semantics></math>, codeword length <math id="alg3.l0.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg3.l0.m4.1a"><mi id="alg3.l0.m4.1.1" xref="alg3.l0.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg3.l0.m4.1b"><ci id="alg3.l0.m4.1.1.cmml" xref="alg3.l0.m4.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m4.1c">D</annotation></semantics></math>, public dataset

</div>
<div id="alg3.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>Â Â <math id="alg3.l0a.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg3.l0a.m1.1a"><mi id="alg3.l0a.m1.1.1" xref="alg3.l0a.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg3.l0a.m1.1b"><ci id="alg3.l0a.m1.1.1.cmml" xref="alg3.l0a.m1.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m1.1c">M</annotation></semantics></math> codebooks

</div>
<div id="alg3.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>Â Â Initialize an empty list <math id="alg3.l1.m1.1" class="ltx_Math" alttext="codebooks" display="inline"><semantics id="alg3.l1.m1.1a"><mrow id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml"><mi id="alg3.l1.m1.1.1.2" xref="alg3.l1.m1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.3" xref="alg3.l1.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1a" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.4" xref="alg3.l1.m1.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1b" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.5" xref="alg3.l1.m1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1c" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.6" xref="alg3.l1.m1.1.1.6.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1d" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.7" xref="alg3.l1.m1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1e" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.8" xref="alg3.l1.m1.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1f" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.9" xref="alg3.l1.m1.1.1.9.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1g" xref="alg3.l1.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l1.m1.1.1.10" xref="alg3.l1.m1.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><apply id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1"><times id="alg3.l1.m1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1"></times><ci id="alg3.l1.m1.1.1.2.cmml" xref="alg3.l1.m1.1.1.2">ğ‘</ci><ci id="alg3.l1.m1.1.1.3.cmml" xref="alg3.l1.m1.1.1.3">ğ‘œ</ci><ci id="alg3.l1.m1.1.1.4.cmml" xref="alg3.l1.m1.1.1.4">ğ‘‘</ci><ci id="alg3.l1.m1.1.1.5.cmml" xref="alg3.l1.m1.1.1.5">ğ‘’</ci><ci id="alg3.l1.m1.1.1.6.cmml" xref="alg3.l1.m1.1.1.6">ğ‘</ci><ci id="alg3.l1.m1.1.1.7.cmml" xref="alg3.l1.m1.1.1.7">ğ‘œ</ci><ci id="alg3.l1.m1.1.1.8.cmml" xref="alg3.l1.m1.1.1.8">ğ‘œ</ci><ci id="alg3.l1.m1.1.1.9.cmml" xref="alg3.l1.m1.1.1.9">ğ‘˜</ci><ci id="alg3.l1.m1.1.1.10.cmml" xref="alg3.l1.m1.1.1.10">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">codebooks</annotation></semantics></math>

</div>
<div id="alg3.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Â Â Simulate training process on public data to obtain a model gradient

</div>
<div id="alg3.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Â Â Apply k-means algorithm to generate <math id="alg3.l3.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg3.l3.m1.1a"><mi id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><ci id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">K</annotation></semantics></math> code vectors of length <math id="alg3.l3.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg3.l3.m2.1a"><mi id="alg3.l3.m2.1.1" xref="alg3.l3.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg3.l3.m2.1b"><ci id="alg3.l3.m2.1.1.cmml" xref="alg3.l3.m2.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m2.1c">D</annotation></semantics></math> for the first codebook using the simulated gradient

</div>
<div id="alg3.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>Â Â Append the first codebook to <math id="alg3.l4.m1.1" class="ltx_Math" alttext="codebooks" display="inline"><semantics id="alg3.l4.m1.1a"><mrow id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml"><mi id="alg3.l4.m1.1.1.2" xref="alg3.l4.m1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.3" xref="alg3.l4.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1a" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.4" xref="alg3.l4.m1.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1b" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.5" xref="alg3.l4.m1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1c" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.6" xref="alg3.l4.m1.1.1.6.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1d" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.7" xref="alg3.l4.m1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1e" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.8" xref="alg3.l4.m1.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1f" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.9" xref="alg3.l4.m1.1.1.9.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.1g" xref="alg3.l4.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l4.m1.1.1.10" xref="alg3.l4.m1.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1"><times id="alg3.l4.m1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1"></times><ci id="alg3.l4.m1.1.1.2.cmml" xref="alg3.l4.m1.1.1.2">ğ‘</ci><ci id="alg3.l4.m1.1.1.3.cmml" xref="alg3.l4.m1.1.1.3">ğ‘œ</ci><ci id="alg3.l4.m1.1.1.4.cmml" xref="alg3.l4.m1.1.1.4">ğ‘‘</ci><ci id="alg3.l4.m1.1.1.5.cmml" xref="alg3.l4.m1.1.1.5">ğ‘’</ci><ci id="alg3.l4.m1.1.1.6.cmml" xref="alg3.l4.m1.1.1.6">ğ‘</ci><ci id="alg3.l4.m1.1.1.7.cmml" xref="alg3.l4.m1.1.1.7">ğ‘œ</ci><ci id="alg3.l4.m1.1.1.8.cmml" xref="alg3.l4.m1.1.1.8">ğ‘œ</ci><ci id="alg3.l4.m1.1.1.9.cmml" xref="alg3.l4.m1.1.1.9">ğ‘˜</ci><ci id="alg3.l4.m1.1.1.10.cmml" xref="alg3.l4.m1.1.1.10">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">codebooks</annotation></semantics></math>

</div>
<div id="alg3.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>Â Â Divide the <math id="alg3.l5.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg3.l5.m1.1a"><mi id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><ci id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">N</annotation></semantics></math> Pseudo-centroids into <math id="alg3.l5.m2.1" class="ltx_Math" alttext="M-1" display="inline"><semantics id="alg3.l5.m2.1a"><mrow id="alg3.l5.m2.1.1" xref="alg3.l5.m2.1.1.cmml"><mi id="alg3.l5.m2.1.1.2" xref="alg3.l5.m2.1.1.2.cmml">M</mi><mo id="alg3.l5.m2.1.1.1" xref="alg3.l5.m2.1.1.1.cmml">âˆ’</mo><mn id="alg3.l5.m2.1.1.3" xref="alg3.l5.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m2.1b"><apply id="alg3.l5.m2.1.1.cmml" xref="alg3.l5.m2.1.1"><minus id="alg3.l5.m2.1.1.1.cmml" xref="alg3.l5.m2.1.1.1"></minus><ci id="alg3.l5.m2.1.1.2.cmml" xref="alg3.l5.m2.1.1.2">ğ‘€</ci><cn type="integer" id="alg3.l5.m2.1.1.3.cmml" xref="alg3.l5.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m2.1c">M-1</annotation></semantics></math> equal parts

</div>
<div id="alg3.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Â Â <span id="alg3.l6.2" class="ltx_text ltx_font_bold">for</span>Â <math id="alg3.l6.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg3.l6.m1.1a"><mrow id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml"><mi id="alg3.l6.m1.1.1.2" xref="alg3.l6.m1.1.1.2.cmml">i</mi><mo id="alg3.l6.m1.1.1.1" xref="alg3.l6.m1.1.1.1.cmml">=</mo><mn id="alg3.l6.m1.1.1.3" xref="alg3.l6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.1b"><apply id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1"><eq id="alg3.l6.m1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1"></eq><ci id="alg3.l6.m1.1.1.2.cmml" xref="alg3.l6.m1.1.1.2">ğ‘–</ci><cn type="integer" id="alg3.l6.m1.1.1.3.cmml" xref="alg3.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.1c">i=1</annotation></semantics></math> to <math id="alg3.l6.m2.1" class="ltx_Math" alttext="M-1" display="inline"><semantics id="alg3.l6.m2.1a"><mrow id="alg3.l6.m2.1.1" xref="alg3.l6.m2.1.1.cmml"><mi id="alg3.l6.m2.1.1.2" xref="alg3.l6.m2.1.1.2.cmml">M</mi><mo id="alg3.l6.m2.1.1.1" xref="alg3.l6.m2.1.1.1.cmml">âˆ’</mo><mn id="alg3.l6.m2.1.1.3" xref="alg3.l6.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m2.1b"><apply id="alg3.l6.m2.1.1.cmml" xref="alg3.l6.m2.1.1"><minus id="alg3.l6.m2.1.1.1.cmml" xref="alg3.l6.m2.1.1.1"></minus><ci id="alg3.l6.m2.1.1.2.cmml" xref="alg3.l6.m2.1.1.2">ğ‘€</ci><cn type="integer" id="alg3.l6.m2.1.1.3.cmml" xref="alg3.l6.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m2.1c">M-1</annotation></semantics></math>Â <span id="alg3.l6.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg3.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>Â Â Â Â Â Sample <math id="alg3.l7.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg3.l7.m1.1a"><mi id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><ci id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">n</annotation></semantics></math> Pseudo-centroids from the <math id="alg3.l7.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l7.m2.1a"><mi id="alg3.l7.m2.1.1" xref="alg3.l7.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l7.m2.1b"><ci id="alg3.l7.m2.1.1.cmml" xref="alg3.l7.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m2.1c">i</annotation></semantics></math>-th part

</div>
<div id="alg3.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>Â Â Â Â Â Apply k-means algorithm to generate <math id="alg3.l8.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg3.l8.m1.1a"><mi id="alg3.l8.m1.1.1" xref="alg3.l8.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.1b"><ci id="alg3.l8.m1.1.1.cmml" xref="alg3.l8.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.1c">K</annotation></semantics></math> code vectors of length <math id="alg3.l8.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg3.l8.m2.1a"><mi id="alg3.l8.m2.1.1" xref="alg3.l8.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg3.l8.m2.1b"><ci id="alg3.l8.m2.1.1.cmml" xref="alg3.l8.m2.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m2.1c">D</annotation></semantics></math> for the <math id="alg3.l8.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l8.m3.1a"><mi id="alg3.l8.m3.1.1" xref="alg3.l8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l8.m3.1b"><ci id="alg3.l8.m3.1.1.cmml" xref="alg3.l8.m3.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m3.1c">i</annotation></semantics></math>-th codebook using the sampled Pseudo-centroids

</div>
<div id="alg3.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>Â Â Â Â Â Append the <math id="alg3.l9.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l9.m1.1a"><mi id="alg3.l9.m1.1.1" xref="alg3.l9.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.1b"><ci id="alg3.l9.m1.1.1.cmml" xref="alg3.l9.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.1c">i</annotation></semantics></math>-th codebook to <math id="alg3.l9.m2.1" class="ltx_Math" alttext="codebooks" display="inline"><semantics id="alg3.l9.m2.1a"><mrow id="alg3.l9.m2.1.1" xref="alg3.l9.m2.1.1.cmml"><mi id="alg3.l9.m2.1.1.2" xref="alg3.l9.m2.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.3" xref="alg3.l9.m2.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1a" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.4" xref="alg3.l9.m2.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1b" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.5" xref="alg3.l9.m2.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1c" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.6" xref="alg3.l9.m2.1.1.6.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1d" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.7" xref="alg3.l9.m2.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1e" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.8" xref="alg3.l9.m2.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1f" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.9" xref="alg3.l9.m2.1.1.9.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m2.1.1.1g" xref="alg3.l9.m2.1.1.1.cmml">â€‹</mo><mi id="alg3.l9.m2.1.1.10" xref="alg3.l9.m2.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m2.1b"><apply id="alg3.l9.m2.1.1.cmml" xref="alg3.l9.m2.1.1"><times id="alg3.l9.m2.1.1.1.cmml" xref="alg3.l9.m2.1.1.1"></times><ci id="alg3.l9.m2.1.1.2.cmml" xref="alg3.l9.m2.1.1.2">ğ‘</ci><ci id="alg3.l9.m2.1.1.3.cmml" xref="alg3.l9.m2.1.1.3">ğ‘œ</ci><ci id="alg3.l9.m2.1.1.4.cmml" xref="alg3.l9.m2.1.1.4">ğ‘‘</ci><ci id="alg3.l9.m2.1.1.5.cmml" xref="alg3.l9.m2.1.1.5">ğ‘’</ci><ci id="alg3.l9.m2.1.1.6.cmml" xref="alg3.l9.m2.1.1.6">ğ‘</ci><ci id="alg3.l9.m2.1.1.7.cmml" xref="alg3.l9.m2.1.1.7">ğ‘œ</ci><ci id="alg3.l9.m2.1.1.8.cmml" xref="alg3.l9.m2.1.1.8">ğ‘œ</ci><ci id="alg3.l9.m2.1.1.9.cmml" xref="alg3.l9.m2.1.1.9">ğ‘˜</ci><ci id="alg3.l9.m2.1.1.10.cmml" xref="alg3.l9.m2.1.1.10">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m2.1c">codebooks</annotation></semantics></math>

</div>
<div id="alg3.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>Â Â <span id="alg3.l10.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg3.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>Â Â <span id="alg3.l11.2" class="ltx_text ltx_font_bold">return</span> Â <math id="alg3.l11.m1.1" class="ltx_Math" alttext="codebooks" display="inline"><semantics id="alg3.l11.m1.1a"><mrow id="alg3.l11.m1.1.1" xref="alg3.l11.m1.1.1.cmml"><mi id="alg3.l11.m1.1.1.2" xref="alg3.l11.m1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.3" xref="alg3.l11.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1a" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.4" xref="alg3.l11.m1.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1b" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.5" xref="alg3.l11.m1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1c" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.6" xref="alg3.l11.m1.1.1.6.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1d" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.7" xref="alg3.l11.m1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1e" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.8" xref="alg3.l11.m1.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1f" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.9" xref="alg3.l11.m1.1.1.9.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.1g" xref="alg3.l11.m1.1.1.1.cmml">â€‹</mo><mi id="alg3.l11.m1.1.1.10" xref="alg3.l11.m1.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.1b"><apply id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1"><times id="alg3.l11.m1.1.1.1.cmml" xref="alg3.l11.m1.1.1.1"></times><ci id="alg3.l11.m1.1.1.2.cmml" xref="alg3.l11.m1.1.1.2">ğ‘</ci><ci id="alg3.l11.m1.1.1.3.cmml" xref="alg3.l11.m1.1.1.3">ğ‘œ</ci><ci id="alg3.l11.m1.1.1.4.cmml" xref="alg3.l11.m1.1.1.4">ğ‘‘</ci><ci id="alg3.l11.m1.1.1.5.cmml" xref="alg3.l11.m1.1.1.5">ğ‘’</ci><ci id="alg3.l11.m1.1.1.6.cmml" xref="alg3.l11.m1.1.1.6">ğ‘</ci><ci id="alg3.l11.m1.1.1.7.cmml" xref="alg3.l11.m1.1.1.7">ğ‘œ</ci><ci id="alg3.l11.m1.1.1.8.cmml" xref="alg3.l11.m1.1.1.8">ğ‘œ</ci><ci id="alg3.l11.m1.1.1.9.cmml" xref="alg3.l11.m1.1.1.9">ğ‘˜</ci><ci id="alg3.l11.m1.1.1.10.cmml" xref="alg3.l11.m1.1.1.10">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.1c">codebooks</annotation></semantics></math>

</div>
</div>
</figure>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we introduce the datasets, parameter choices and models we experiment on.
Then we thoroughly analyse the performance of the proposed method with comprehensive comparisons and ablation studies.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Datasets and Metrics</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">As mentioned in SectionÂ <a href="#S1" title="1 Introduction â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, our experiments predominantly concentrated on tackling communication compression challenges prevalent in typical yet challenging scenarios encountered in cross-device federated learning:
(<span id="S4.SS1.SSS1.p1.1.1" class="ltx_text ltx_font_bold">i</span>) Non-IID client data.
(<span id="S4.SS1.SSS1.p1.1.2" class="ltx_text ltx_font_bold">ii</span>) A substantial number of clients with relatively modest individual data volumes.
(<span id="S4.SS1.SSS1.p1.1.3" class="ltx_text ltx_font_bold">iii</span>) A restricted quantity of data retained by the server, characterized by significant disparities compared to client data.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.1" class="ltx_p">To ensure that our experiments adhere to the aforementioned conditions, we assess the effectiveness of our approach using the following two datasets sourced from the LEAF benchmarkÂ <cite class="ltx_cite ltx_citemacro_cite">Caldas <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>: CelebAÂ <cite class="ltx_cite ltx_citemacro_cite">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2015</a>)</cite> and FemnistÂ <cite class="ltx_cite ltx_citemacro_cite">Deng (<a href="#bib.bib5" title="" class="ltx_ref">2012</a>)</cite>.
For the CelebA dataset, which comprises 2 classes, the data was partitioned into 9343 clients in a non-IID manner, with each client having an average of 21 samples. We randomly selected 20 images as public data. For the Femnist dataset, encompassing 62 classes, the data was partitioned into 1775 clients, with each client having an average of 88 samples. Furthermore, a collection of 60 images was selected to serve as public data.</p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.1" class="ltx_p">We comprehensively evaluate FedMPQ from three perspectives: convergence rounds, peak model accuracy, and total communication cost with respect to the target accuracy.
Since downlink bandwidth is usually <math id="S4.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="8-20" display="inline"><semantics id="S4.SS1.SSS1.p3.1.m1.1a"><mrow id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.SSS1.p3.1.m1.1.1.2" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml">8</mn><mo id="S4.SS1.SSS1.p3.1.m1.1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml">âˆ’</mo><mn id="S4.SS1.SSS1.p3.1.m1.1.1.3" xref="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.1b"><apply id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1"><minus id="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.1"></minus><cn type="integer" id="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.2">8</cn><cn type="integer" id="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.1c">8-20</annotation></semantics></math> times greater than the uplink bandwidthÂ <cite class="ltx_cite ltx_citemacro_cite">Lee <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2012</a>)</cite>, without loss of generality, we calculate the total communication cost with</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.1" class="ltx_Math" alttext="cost_{total}=\frac{cost_{downlink}}{8}+cost_{uplink}." display="block"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.2.1" xref="S4.E8.m1.1.1.1.1.2.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.2.1a" xref="S4.E8.m1.1.1.1.1.2.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.2.4" xref="S4.E8.m1.1.1.1.1.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.2.1b" xref="S4.E8.m1.1.1.1.1.2.1.cmml">â€‹</mo><msub id="S4.E8.m1.1.1.1.1.2.5" xref="S4.E8.m1.1.1.1.1.2.5.cmml"><mi id="S4.E8.m1.1.1.1.1.2.5.2" xref="S4.E8.m1.1.1.1.1.2.5.2.cmml">t</mi><mrow id="S4.E8.m1.1.1.1.1.2.5.3" xref="S4.E8.m1.1.1.1.1.2.5.3.cmml"><mi id="S4.E8.m1.1.1.1.1.2.5.3.2" xref="S4.E8.m1.1.1.1.1.2.5.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.2.5.3.1" xref="S4.E8.m1.1.1.1.1.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.2.5.3.3" xref="S4.E8.m1.1.1.1.1.2.5.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.2.5.3.1a" xref="S4.E8.m1.1.1.1.1.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.2.5.3.4" xref="S4.E8.m1.1.1.1.1.2.5.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.2.5.3.1b" xref="S4.E8.m1.1.1.1.1.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.2.5.3.5" xref="S4.E8.m1.1.1.1.1.2.5.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.2.5.3.1c" xref="S4.E8.m1.1.1.1.1.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.2.5.3.6" xref="S4.E8.m1.1.1.1.1.2.5.3.6.cmml">l</mi></mrow></msub></mrow><mo id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.3.cmml"><mfrac id="S4.E8.m1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.3.2.cmml"><mrow id="S4.E8.m1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.3.2.2.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2.2.2" xref="S4.E8.m1.1.1.1.1.3.2.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.1" xref="S4.E8.m1.1.1.1.1.3.2.2.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.3" xref="S4.E8.m1.1.1.1.1.3.2.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.1a" xref="S4.E8.m1.1.1.1.1.3.2.2.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.4" xref="S4.E8.m1.1.1.1.1.3.2.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.1b" xref="S4.E8.m1.1.1.1.1.3.2.2.1.cmml">â€‹</mo><msub id="S4.E8.m1.1.1.1.1.3.2.2.5" xref="S4.E8.m1.1.1.1.1.3.2.2.5.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.2" xref="S4.E8.m1.1.1.1.1.3.2.2.5.2.cmml">t</mi><mrow id="S4.E8.m1.1.1.1.1.3.2.2.5.3" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.2" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.3" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1a" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.4" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1b" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.5" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1c" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.6" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1d" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.7" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1e" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.8" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1f" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.2.2.5.3.9" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.9.cmml">k</mi></mrow></msub></mrow><mn id="S4.E8.m1.1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.1.3.2.3.cmml">8</mn></mfrac><mo id="S4.E8.m1.1.1.1.1.3.1" xref="S4.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E8.m1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.3.2" xref="S4.E8.m1.1.1.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.1" xref="S4.E8.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.3.3" xref="S4.E8.m1.1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.1a" xref="S4.E8.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.3.4" xref="S4.E8.m1.1.1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.1b" xref="S4.E8.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><msub id="S4.E8.m1.1.1.1.1.3.3.5" xref="S4.E8.m1.1.1.1.1.3.3.5.cmml"><mi id="S4.E8.m1.1.1.1.1.3.3.5.2" xref="S4.E8.m1.1.1.1.1.3.3.5.2.cmml">t</mi><mrow id="S4.E8.m1.1.1.1.1.3.3.5.3" xref="S4.E8.m1.1.1.1.1.3.3.5.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.3.5.3.2" xref="S4.E8.m1.1.1.1.1.3.3.5.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.5.3.1" xref="S4.E8.m1.1.1.1.1.3.3.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.3.5.3.3" xref="S4.E8.m1.1.1.1.1.3.3.5.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.5.3.1a" xref="S4.E8.m1.1.1.1.1.3.3.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.3.5.3.4" xref="S4.E8.m1.1.1.1.1.3.3.5.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.5.3.1b" xref="S4.E8.m1.1.1.1.1.3.3.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.3.5.3.5" xref="S4.E8.m1.1.1.1.1.3.3.5.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.5.3.1c" xref="S4.E8.m1.1.1.1.1.3.3.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.3.5.3.6" xref="S4.E8.m1.1.1.1.1.3.3.5.3.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.3.3.5.3.1d" xref="S4.E8.m1.1.1.1.1.3.3.5.3.1.cmml">â€‹</mo><mi id="S4.E8.m1.1.1.1.1.3.3.5.3.7" xref="S4.E8.m1.1.1.1.1.3.3.5.3.7.cmml">k</mi></mrow></msub></mrow></mrow></mrow><mo lspace="0em" id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"></eq><apply id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2"><times id="S4.E8.m1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2.1"></times><ci id="S4.E8.m1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2">ğ‘</ci><ci id="S4.E8.m1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.3">ğ‘œ</ci><ci id="S4.E8.m1.1.1.1.1.2.4.cmml" xref="S4.E8.m1.1.1.1.1.2.4">ğ‘ </ci><apply id="S4.E8.m1.1.1.1.1.2.5.cmml" xref="S4.E8.m1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.5.1.cmml" xref="S4.E8.m1.1.1.1.1.2.5">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.2.5.2.cmml" xref="S4.E8.m1.1.1.1.1.2.5.2">ğ‘¡</ci><apply id="S4.E8.m1.1.1.1.1.2.5.3.cmml" xref="S4.E8.m1.1.1.1.1.2.5.3"><times id="S4.E8.m1.1.1.1.1.2.5.3.1.cmml" xref="S4.E8.m1.1.1.1.1.2.5.3.1"></times><ci id="S4.E8.m1.1.1.1.1.2.5.3.2.cmml" xref="S4.E8.m1.1.1.1.1.2.5.3.2">ğ‘¡</ci><ci id="S4.E8.m1.1.1.1.1.2.5.3.3.cmml" xref="S4.E8.m1.1.1.1.1.2.5.3.3">ğ‘œ</ci><ci id="S4.E8.m1.1.1.1.1.2.5.3.4.cmml" xref="S4.E8.m1.1.1.1.1.2.5.3.4">ğ‘¡</ci><ci id="S4.E8.m1.1.1.1.1.2.5.3.5.cmml" xref="S4.E8.m1.1.1.1.1.2.5.3.5">ğ‘</ci><ci id="S4.E8.m1.1.1.1.1.2.5.3.6.cmml" xref="S4.E8.m1.1.1.1.1.2.5.3.6">ğ‘™</ci></apply></apply></apply><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.3"><plus id="S4.E8.m1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.1"></plus><apply id="S4.E8.m1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2"><divide id="S4.E8.m1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.3.2"></divide><apply id="S4.E8.m1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2"><times id="S4.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.1"></times><ci id="S4.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.2">ğ‘</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.3">ğ‘œ</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.4.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.4">ğ‘ </ci><apply id="S4.E8.m1.1.1.1.1.3.2.2.5.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3.2.2.5.1.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.2">ğ‘¡</ci><apply id="S4.E8.m1.1.1.1.1.3.2.2.5.3.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3"><times id="S4.E8.m1.1.1.1.1.3.2.2.5.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.1"></times><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.2">ğ‘‘</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.3">ğ‘œ</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.4.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.4">ğ‘¤</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.5.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.5">ğ‘›</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.6.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.6">ğ‘™</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.7.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.7">ğ‘–</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.8.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.8">ğ‘›</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.5.3.9.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2.5.3.9">ğ‘˜</ci></apply></apply></apply><cn type="integer" id="S4.E8.m1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.3.2.3">8</cn></apply><apply id="S4.E8.m1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3"><times id="S4.E8.m1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3.1"></times><ci id="S4.E8.m1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2">ğ‘</ci><ci id="S4.E8.m1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.3">ğ‘œ</ci><ci id="S4.E8.m1.1.1.1.1.3.3.4.cmml" xref="S4.E8.m1.1.1.1.1.3.3.4">ğ‘ </ci><apply id="S4.E8.m1.1.1.1.1.3.3.5.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3.3.5.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.3.3.5.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.2">ğ‘¡</ci><apply id="S4.E8.m1.1.1.1.1.3.3.5.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3"><times id="S4.E8.m1.1.1.1.1.3.3.5.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3.1"></times><ci id="S4.E8.m1.1.1.1.1.3.3.5.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3.2">ğ‘¢</ci><ci id="S4.E8.m1.1.1.1.1.3.3.5.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3.3">ğ‘</ci><ci id="S4.E8.m1.1.1.1.1.3.3.5.3.4.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3.4">ğ‘™</ci><ci id="S4.E8.m1.1.1.1.1.3.3.5.3.5.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3.5">ğ‘–</ci><ci id="S4.E8.m1.1.1.1.1.3.3.5.3.6.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3.6">ğ‘›</ci><ci id="S4.E8.m1.1.1.1.1.3.3.5.3.7.cmml" xref="S4.E8.m1.1.1.1.1.3.3.5.3.7">ğ‘˜</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">cost_{total}=\frac{cost_{downlink}}{8}+cost_{uplink}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation Details</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We implement FedMPQ based on FLSim and conducted experiments comparing three methods: pruning, scalar quantization (SQ), and single-codebook product quantization (SPQ)Â <cite class="ltx_cite ltx_citemacro_cite">Prasad <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>. We conducted multiple experiments for each item to reduce errors.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.4" class="ltx_p">For the CelebA dataset, we conducted training using a convolutional binary classifierÂ <cite class="ltx_cite ltx_citemacro_cite">Nguyen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite>, with a model size of 114KB. Each training round randomly selected 100 clients to participate. The local learning rate of <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\eta_{l}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">Î·</mi><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">ğœ‚</ci><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">ğ‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\eta_{l}</annotation></semantics></math> was set to 0.9, while the server learning rate <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">Î·</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">ğœ‚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\eta</annotation></semantics></math> was set to 0.08.
Regarding the Femnist dataset, we opted for ResNet-18 as the backbone for the classification of 62 categories, resulting in a model size of 43MB. In each training round, 30 clients were chosen to participate, with a local learning rate of <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\eta_{l}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">Î·</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">ğœ‚</ci><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">ğ‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\eta_{l}</annotation></semantics></math> set to 0.01, and a server learning rate of <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">Î·</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">ğœ‚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\eta</annotation></semantics></math> set to 0.24.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Due to the limited amount of client data, multiple training rounds can easily lead to overfitting.
To avoid this issue, each client undergoes a single full training epoch in every training round.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Experimental Results</h3>

<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13575/assets/x3.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="507" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">CelebA</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13575/assets/x4.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="461" height="507" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">The relationship between model accuracy and communications, with both FedMPQ and PQ employing the same limited public dataset for codebook training, and both uploading 0.1% of residual error. â€œUncompressedâ€ denotes the results obtained without any compression. </span></figcaption>
</figure>
<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Uplink Communications vs. Model Accuracy</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">The primary motivation behind proposing FedMPQ is to minimize uplink communication. Consequently, we have provided the model accuracy and uplink communication curves in FigureÂ <a href="#S4.F3" title="Figure 3 â€£ 4.3 Experimental Results â€£ 4 Evaluation â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We have conducted experiments for each compression strategy at various compression ratios.
Each strategy is trained until the global model converges, and the highest model accuracy is taken as the final result.
From the results, the following observations can be made:
<span id="S4.SS3.SSS1.p1.1.1" class="ltx_text ltx_font_bold">(i)</span>
Our proposed FedMPQ demonstrates the best performance in terms of uplink communication compression and final model accuracy curves. On both the CelebA and Femnist datasets, FedMPQ achieves approximately 25x uplink communication compression with minimal loss in accuracy. Under extreme compression ratios, all methods exhibit a significant decline in model accuracy, but FedMPQ still outperforms others noticeably.
<span id="S4.SS3.SSS1.p1.1.2" class="ltx_text ltx_font_bold">(ii)</span> In comparison to FedMPQ, SPQ exhibits a noticeable decline in model accuracy, indicating that codebooks generated solely from limited public data cannot effectively compress client updates.</p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Total Communication Cost vs. Model Accuracy</h4>

<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13575/assets/x5.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="507" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">CelebA</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13575/assets/x6.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_img_square" width="461" height="507" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.8.4.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.6.3" class="ltx_text" style="font-size:90%;">Model Accuracy vs. Total communication cost. <math id="S4.F4.4.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.F4.4.1.m1.1b"><mi id="S4.F4.4.1.m1.1.1" xref="S4.F4.4.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.F4.4.1.m1.1c"><ci id="S4.F4.4.1.m1.1.1.cmml" xref="S4.F4.4.1.m1.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.1.m1.1d">M</annotation></semantics></math> is the number of codebooks, <math id="S4.F4.5.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F4.5.2.m2.1b"><mi id="S4.F4.5.2.m2.1.1" xref="S4.F4.5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.5.2.m2.1c"><ci id="S4.F4.5.2.m2.1.1.cmml" xref="S4.F4.5.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.2.m2.1d">K</annotation></semantics></math> represents the number of codewords in each codebook, and <math id="S4.F4.6.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.F4.6.3.m3.1b"><mi id="S4.F4.6.3.m3.1.1" xref="S4.F4.6.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.F4.6.3.m3.1c"><ci id="S4.F4.6.3.m3.1.1.cmml" xref="S4.F4.6.3.m3.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.3.m3.1d">D</annotation></semantics></math> stands for the length of each codeword. </span></figcaption>
</figure>
<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">In federated learning, a higher uplink communication compression rate can impair the convergence rate, leading to an increase in the number of training rounds required to achieve the desired accuracy. Consequently, we have presented curves depicting the relationship between total communication cost and model accuracy. Since the performance of pruning and SQ is significantly lower than that of SPQ and FedMPQ, we only show the results for SPQ and FedMPQ. FigureÂ <a href="#S4.F4.sf1" title="In Figure 4 â€£ 4.3.2 Total Communication Cost vs. Model Accuracy â€£ 4.3 Experimental Results â€£ 4 Evaluation â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(a)</span></a> depicts the results on the CelebA dataset, and it is evident from the figure that FedMPQ outperforms SPQ significantly. SPQ exhibits a significant drop in model accuracy compared to the baseline without compression, and it is highly unstable. This indicates that compressing the model only on a limited amount of public data can severely compromise the effectiveness of federated learning when training the generator model on a small scale. FigureÂ <a href="#S4.F4.sf2" title="In Figure 4 â€£ 4.3.2 Total Communication Cost vs. Model Accuracy â€£ 4.3 Experimental Results â€£ 4 Evaluation â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(b)</span></a> illustrates the performance of our method on the Femnist dataset. Although FedMPQ and SPQ can both demonstrate noticeable effects, FedMPQ still achieves superior performance to SPQ. This indicates that, even on large-scale models, our method can still accelerate the convergence rate and yield better final model accuracy compared to SPQ.</p>
</div>
</section>
<section id="S4.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Ablation study</h4>

<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13575/assets/x7.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="507" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F5.sf1.3.2" class="ltx_text" style="font-size:90%;">CelebA</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13575/assets/x8.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_img_square" width="461" height="507" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F5.sf2.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.8.4.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.6.3" class="ltx_text" style="font-size:90%;">Effects of residual error upload ratio. On the CelebA dataset, we set <math id="S4.F5.4.1.m1.2" class="ltx_Math" alttext="M=8,K=8,D=4" display="inline"><semantics id="S4.F5.4.1.m1.2b"><mrow id="S4.F5.4.1.m1.2.2.2" xref="S4.F5.4.1.m1.2.2.3.cmml"><mrow id="S4.F5.4.1.m1.1.1.1.1" xref="S4.F5.4.1.m1.1.1.1.1.cmml"><mi id="S4.F5.4.1.m1.1.1.1.1.2" xref="S4.F5.4.1.m1.1.1.1.1.2.cmml">M</mi><mo id="S4.F5.4.1.m1.1.1.1.1.1" xref="S4.F5.4.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.F5.4.1.m1.1.1.1.1.3" xref="S4.F5.4.1.m1.1.1.1.1.3.cmml">8</mn></mrow><mo id="S4.F5.4.1.m1.2.2.2.3" xref="S4.F5.4.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.F5.4.1.m1.2.2.2.2.2" xref="S4.F5.4.1.m1.2.2.2.2.3.cmml"><mrow id="S4.F5.4.1.m1.2.2.2.2.1.1" xref="S4.F5.4.1.m1.2.2.2.2.1.1.cmml"><mi id="S4.F5.4.1.m1.2.2.2.2.1.1.2" xref="S4.F5.4.1.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="S4.F5.4.1.m1.2.2.2.2.1.1.1" xref="S4.F5.4.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="S4.F5.4.1.m1.2.2.2.2.1.1.3" xref="S4.F5.4.1.m1.2.2.2.2.1.1.3.cmml">8</mn></mrow><mo id="S4.F5.4.1.m1.2.2.2.2.2.3" xref="S4.F5.4.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S4.F5.4.1.m1.2.2.2.2.2.2" xref="S4.F5.4.1.m1.2.2.2.2.2.2.cmml"><mi id="S4.F5.4.1.m1.2.2.2.2.2.2.2" xref="S4.F5.4.1.m1.2.2.2.2.2.2.2.cmml">D</mi><mo id="S4.F5.4.1.m1.2.2.2.2.2.2.1" xref="S4.F5.4.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="S4.F5.4.1.m1.2.2.2.2.2.2.3" xref="S4.F5.4.1.m1.2.2.2.2.2.2.3.cmml">4</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.4.1.m1.2c"><apply id="S4.F5.4.1.m1.2.2.3.cmml" xref="S4.F5.4.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.F5.4.1.m1.2.2.3a.cmml" xref="S4.F5.4.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.F5.4.1.m1.1.1.1.1.cmml" xref="S4.F5.4.1.m1.1.1.1.1"><eq id="S4.F5.4.1.m1.1.1.1.1.1.cmml" xref="S4.F5.4.1.m1.1.1.1.1.1"></eq><ci id="S4.F5.4.1.m1.1.1.1.1.2.cmml" xref="S4.F5.4.1.m1.1.1.1.1.2">ğ‘€</ci><cn type="integer" id="S4.F5.4.1.m1.1.1.1.1.3.cmml" xref="S4.F5.4.1.m1.1.1.1.1.3">8</cn></apply><apply id="S4.F5.4.1.m1.2.2.2.2.3.cmml" xref="S4.F5.4.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.F5.4.1.m1.2.2.2.2.3a.cmml" xref="S4.F5.4.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.F5.4.1.m1.2.2.2.2.1.1.cmml" xref="S4.F5.4.1.m1.2.2.2.2.1.1"><eq id="S4.F5.4.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.F5.4.1.m1.2.2.2.2.1.1.1"></eq><ci id="S4.F5.4.1.m1.2.2.2.2.1.1.2.cmml" xref="S4.F5.4.1.m1.2.2.2.2.1.1.2">ğ¾</ci><cn type="integer" id="S4.F5.4.1.m1.2.2.2.2.1.1.3.cmml" xref="S4.F5.4.1.m1.2.2.2.2.1.1.3">8</cn></apply><apply id="S4.F5.4.1.m1.2.2.2.2.2.2.cmml" xref="S4.F5.4.1.m1.2.2.2.2.2.2"><eq id="S4.F5.4.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.F5.4.1.m1.2.2.2.2.2.2.1"></eq><ci id="S4.F5.4.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.F5.4.1.m1.2.2.2.2.2.2.2">ğ·</ci><cn type="integer" id="S4.F5.4.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.F5.4.1.m1.2.2.2.2.2.2.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.4.1.m1.2d">M=8,K=8,D=4</annotation></semantics></math>. On the Femnist dataset, <math id="S4.F5.5.2.m2.2" class="ltx_Math" alttext="M=4,K=32,D=4" display="inline"><semantics id="S4.F5.5.2.m2.2b"><mrow id="S4.F5.5.2.m2.2.2.2" xref="S4.F5.5.2.m2.2.2.3.cmml"><mrow id="S4.F5.5.2.m2.1.1.1.1" xref="S4.F5.5.2.m2.1.1.1.1.cmml"><mi id="S4.F5.5.2.m2.1.1.1.1.2" xref="S4.F5.5.2.m2.1.1.1.1.2.cmml">M</mi><mo id="S4.F5.5.2.m2.1.1.1.1.1" xref="S4.F5.5.2.m2.1.1.1.1.1.cmml">=</mo><mn id="S4.F5.5.2.m2.1.1.1.1.3" xref="S4.F5.5.2.m2.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.F5.5.2.m2.2.2.2.3" xref="S4.F5.5.2.m2.2.2.3a.cmml">,</mo><mrow id="S4.F5.5.2.m2.2.2.2.2.2" xref="S4.F5.5.2.m2.2.2.2.2.3.cmml"><mrow id="S4.F5.5.2.m2.2.2.2.2.1.1" xref="S4.F5.5.2.m2.2.2.2.2.1.1.cmml"><mi id="S4.F5.5.2.m2.2.2.2.2.1.1.2" xref="S4.F5.5.2.m2.2.2.2.2.1.1.2.cmml">K</mi><mo id="S4.F5.5.2.m2.2.2.2.2.1.1.1" xref="S4.F5.5.2.m2.2.2.2.2.1.1.1.cmml">=</mo><mn id="S4.F5.5.2.m2.2.2.2.2.1.1.3" xref="S4.F5.5.2.m2.2.2.2.2.1.1.3.cmml">32</mn></mrow><mo id="S4.F5.5.2.m2.2.2.2.2.2.3" xref="S4.F5.5.2.m2.2.2.2.2.3a.cmml">,</mo><mrow id="S4.F5.5.2.m2.2.2.2.2.2.2" xref="S4.F5.5.2.m2.2.2.2.2.2.2.cmml"><mi id="S4.F5.5.2.m2.2.2.2.2.2.2.2" xref="S4.F5.5.2.m2.2.2.2.2.2.2.2.cmml">D</mi><mo id="S4.F5.5.2.m2.2.2.2.2.2.2.1" xref="S4.F5.5.2.m2.2.2.2.2.2.2.1.cmml">=</mo><mn id="S4.F5.5.2.m2.2.2.2.2.2.2.3" xref="S4.F5.5.2.m2.2.2.2.2.2.2.3.cmml">4</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.5.2.m2.2c"><apply id="S4.F5.5.2.m2.2.2.3.cmml" xref="S4.F5.5.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.F5.5.2.m2.2.2.3a.cmml" xref="S4.F5.5.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.F5.5.2.m2.1.1.1.1.cmml" xref="S4.F5.5.2.m2.1.1.1.1"><eq id="S4.F5.5.2.m2.1.1.1.1.1.cmml" xref="S4.F5.5.2.m2.1.1.1.1.1"></eq><ci id="S4.F5.5.2.m2.1.1.1.1.2.cmml" xref="S4.F5.5.2.m2.1.1.1.1.2">ğ‘€</ci><cn type="integer" id="S4.F5.5.2.m2.1.1.1.1.3.cmml" xref="S4.F5.5.2.m2.1.1.1.1.3">4</cn></apply><apply id="S4.F5.5.2.m2.2.2.2.2.3.cmml" xref="S4.F5.5.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.F5.5.2.m2.2.2.2.2.3a.cmml" xref="S4.F5.5.2.m2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.F5.5.2.m2.2.2.2.2.1.1.cmml" xref="S4.F5.5.2.m2.2.2.2.2.1.1"><eq id="S4.F5.5.2.m2.2.2.2.2.1.1.1.cmml" xref="S4.F5.5.2.m2.2.2.2.2.1.1.1"></eq><ci id="S4.F5.5.2.m2.2.2.2.2.1.1.2.cmml" xref="S4.F5.5.2.m2.2.2.2.2.1.1.2">ğ¾</ci><cn type="integer" id="S4.F5.5.2.m2.2.2.2.2.1.1.3.cmml" xref="S4.F5.5.2.m2.2.2.2.2.1.1.3">32</cn></apply><apply id="S4.F5.5.2.m2.2.2.2.2.2.2.cmml" xref="S4.F5.5.2.m2.2.2.2.2.2.2"><eq id="S4.F5.5.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.F5.5.2.m2.2.2.2.2.2.2.1"></eq><ci id="S4.F5.5.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.F5.5.2.m2.2.2.2.2.2.2.2">ğ·</ci><cn type="integer" id="S4.F5.5.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.F5.5.2.m2.2.2.2.2.2.2.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.2.m2.2d">M=4,K=32,D=4</annotation></semantics></math>. Where <math id="S4.F5.6.3.m3.3" class="ltx_Math" alttext="M,K,D" display="inline"><semantics id="S4.F5.6.3.m3.3b"><mrow id="S4.F5.6.3.m3.3.4.2" xref="S4.F5.6.3.m3.3.4.1.cmml"><mi id="S4.F5.6.3.m3.1.1" xref="S4.F5.6.3.m3.1.1.cmml">M</mi><mo id="S4.F5.6.3.m3.3.4.2.1" xref="S4.F5.6.3.m3.3.4.1.cmml">,</mo><mi id="S4.F5.6.3.m3.2.2" xref="S4.F5.6.3.m3.2.2.cmml">K</mi><mo id="S4.F5.6.3.m3.3.4.2.2" xref="S4.F5.6.3.m3.3.4.1.cmml">,</mo><mi id="S4.F5.6.3.m3.3.3" xref="S4.F5.6.3.m3.3.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.6.3.m3.3c"><list id="S4.F5.6.3.m3.3.4.1.cmml" xref="S4.F5.6.3.m3.3.4.2"><ci id="S4.F5.6.3.m3.1.1.cmml" xref="S4.F5.6.3.m3.1.1">ğ‘€</ci><ci id="S4.F5.6.3.m3.2.2.cmml" xref="S4.F5.6.3.m3.2.2">ğ¾</ci><ci id="S4.F5.6.3.m3.3.3.cmml" xref="S4.F5.6.3.m3.3.3">ğ·</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.3.m3.3d">M,K,D</annotation></semantics></math> has the same meaning as in Section <a href="#S3.SS1.SSS1" title="3.1.1 Product Quantization â€£ 3.1 Client update â€£ 3 Proposed Method â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>.</span></figcaption>
</figure>
<div id="S4.SS3.SSS3.p1" class="ltx_para">
<p id="S4.SS3.SSS3.p1.1" class="ltx_p">We investigate the impact of residual error compression rates on FedMPQ performance. To facilitate quantitative analysis, we fix all clients to upload the same ratio of residuals.
As shown in FigureÂ <a href="#S4.F5.sf1" title="In Figure 5 â€£ 4.3.3 Ablation study â€£ 4.3 Experimental Results â€£ 4 Evaluation â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(a)</span></a>, On the CelebA dataset, uploading only 0.1% of the residual error effectively enhances the convergence rate and final model accuracy.
FigureÂ <a href="#S4.F5.sf2" title="In Figure 5 â€£ 4.3.3 Ablation study â€£ 4.3 Experimental Results â€£ 4 Evaluation â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(b)</span></a> presents the results on the Femnist dataset, where uploading 1% of the residual error slightly improves the convergence rate.
When uploading 5% of the residual error, both convergence rate and final model accuracy exhibit observable improvements.
Hence, different codebook shapes and models can influence the contribution of residual error to the overall performance of FedMPQ.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2404.13575/assets/x9.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="311" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.4.2.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.2.1" class="ltx_text" style="font-size:90%;">Effects of server dataset size. <math id="S4.F6.2.1.m1.2" class="ltx_Math" alttext="M=8,K=8,D=4" display="inline"><semantics id="S4.F6.2.1.m1.2b"><mrow id="S4.F6.2.1.m1.2.2.2" xref="S4.F6.2.1.m1.2.2.3.cmml"><mrow id="S4.F6.2.1.m1.1.1.1.1" xref="S4.F6.2.1.m1.1.1.1.1.cmml"><mi id="S4.F6.2.1.m1.1.1.1.1.2" xref="S4.F6.2.1.m1.1.1.1.1.2.cmml">M</mi><mo id="S4.F6.2.1.m1.1.1.1.1.1" xref="S4.F6.2.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.F6.2.1.m1.1.1.1.1.3" xref="S4.F6.2.1.m1.1.1.1.1.3.cmml">8</mn></mrow><mo id="S4.F6.2.1.m1.2.2.2.3" xref="S4.F6.2.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.F6.2.1.m1.2.2.2.2.2" xref="S4.F6.2.1.m1.2.2.2.2.3.cmml"><mrow id="S4.F6.2.1.m1.2.2.2.2.1.1" xref="S4.F6.2.1.m1.2.2.2.2.1.1.cmml"><mi id="S4.F6.2.1.m1.2.2.2.2.1.1.2" xref="S4.F6.2.1.m1.2.2.2.2.1.1.2.cmml">K</mi><mo id="S4.F6.2.1.m1.2.2.2.2.1.1.1" xref="S4.F6.2.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="S4.F6.2.1.m1.2.2.2.2.1.1.3" xref="S4.F6.2.1.m1.2.2.2.2.1.1.3.cmml">8</mn></mrow><mo id="S4.F6.2.1.m1.2.2.2.2.2.3" xref="S4.F6.2.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S4.F6.2.1.m1.2.2.2.2.2.2" xref="S4.F6.2.1.m1.2.2.2.2.2.2.cmml"><mi id="S4.F6.2.1.m1.2.2.2.2.2.2.2" xref="S4.F6.2.1.m1.2.2.2.2.2.2.2.cmml">D</mi><mo id="S4.F6.2.1.m1.2.2.2.2.2.2.1" xref="S4.F6.2.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="S4.F6.2.1.m1.2.2.2.2.2.2.3" xref="S4.F6.2.1.m1.2.2.2.2.2.2.3.cmml">4</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.2.1.m1.2c"><apply id="S4.F6.2.1.m1.2.2.3.cmml" xref="S4.F6.2.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.F6.2.1.m1.2.2.3a.cmml" xref="S4.F6.2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.F6.2.1.m1.1.1.1.1.cmml" xref="S4.F6.2.1.m1.1.1.1.1"><eq id="S4.F6.2.1.m1.1.1.1.1.1.cmml" xref="S4.F6.2.1.m1.1.1.1.1.1"></eq><ci id="S4.F6.2.1.m1.1.1.1.1.2.cmml" xref="S4.F6.2.1.m1.1.1.1.1.2">ğ‘€</ci><cn type="integer" id="S4.F6.2.1.m1.1.1.1.1.3.cmml" xref="S4.F6.2.1.m1.1.1.1.1.3">8</cn></apply><apply id="S4.F6.2.1.m1.2.2.2.2.3.cmml" xref="S4.F6.2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.F6.2.1.m1.2.2.2.2.3a.cmml" xref="S4.F6.2.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.F6.2.1.m1.2.2.2.2.1.1.cmml" xref="S4.F6.2.1.m1.2.2.2.2.1.1"><eq id="S4.F6.2.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.F6.2.1.m1.2.2.2.2.1.1.1"></eq><ci id="S4.F6.2.1.m1.2.2.2.2.1.1.2.cmml" xref="S4.F6.2.1.m1.2.2.2.2.1.1.2">ğ¾</ci><cn type="integer" id="S4.F6.2.1.m1.2.2.2.2.1.1.3.cmml" xref="S4.F6.2.1.m1.2.2.2.2.1.1.3">8</cn></apply><apply id="S4.F6.2.1.m1.2.2.2.2.2.2.cmml" xref="S4.F6.2.1.m1.2.2.2.2.2.2"><eq id="S4.F6.2.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.F6.2.1.m1.2.2.2.2.2.2.1"></eq><ci id="S4.F6.2.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.F6.2.1.m1.2.2.2.2.2.2.2">ğ·</ci><cn type="integer" id="S4.F6.2.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.F6.2.1.m1.2.2.2.2.2.2.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.2.1.m1.2d">M=8,K=8,D=4</annotation></semantics></math>.</span></figcaption>
</figure>
<div id="S4.SS3.SSS3.p2" class="ltx_para">
<p id="S4.SS3.SSS3.p2.1" class="ltx_p">FigureÂ <a href="#S4.F6" title="Figure 6 â€£ 4.3.3 Ablation study â€£ 4.3 Experimental Results â€£ 4 Evaluation â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates the impact of the number of public data on training effectiveness on the CelebA dataset. We randomly selected 20, 40, and 160 images as the public dataset and displayed the convergence curves for both PQ and FedMPQ. Across all three dataset sizes, FedMPQ consistently exhibited stable performance. However, for SPQ, the performance across all three datasets is relatively poor, particularly when the dataset size reaches 160. This observation suggests that indiscriminate expansion of the public datasetâ€™s size does not necessarily enhance codebook quality. As mentioned inÂ <cite class="ltx_cite ltx_citemacro_cite">Mai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite>, the distribution of the public data needs to closely align with the client data to achieve better results. However, this alignment is often challenging to achieve due to the non-IID of client data.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.11" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.11.12.1" class="ltx_tr">
<td id="S4.T1.11.12.1.1" class="ltx_td ltx_align_center ltx_border_tt">M</td>
<td id="S4.T1.11.12.1.2" class="ltx_td ltx_align_center ltx_border_tt">K</td>
<td id="S4.T1.11.12.1.3" class="ltx_td ltx_align_center ltx_border_tt">D</td>
<td id="S4.T1.11.12.1.4" class="ltx_td ltx_align_center ltx_border_tt">Data num</td>
<td id="S4.T1.11.12.1.5" class="ltx_td ltx_align_center ltx_border_tt">Rounds to 90% Acc</td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">4</td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">32</td>
<td id="S4.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S4.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">20</td>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="288\pm 20" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mn id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">288</mn><mo id="S4.T1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">288</cn><cn type="integer" id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">288\pm 20</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_center">16</td>
<td id="S4.T1.2.2.4" class="ltx_td ltx_align_center">2</td>
<td id="S4.T1.2.2.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.2.2.1" class="ltx_td ltx_align_center"><math id="S4.T1.2.2.1.m1.1" class="ltx_Math" alttext="338\pm 18" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><mrow id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml"><mn id="S4.T1.2.2.1.m1.1.1.2" xref="S4.T1.2.2.1.m1.1.1.2.cmml">338</mn><mo id="S4.T1.2.2.1.m1.1.1.1" xref="S4.T1.2.2.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.2.2.1.m1.1.1.3" xref="S4.T1.2.2.1.m1.1.1.3.cmml">18</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.2.2.1.m1.1.1.2.cmml" xref="S4.T1.2.2.1.m1.1.1.2">338</cn><cn type="integer" id="S4.T1.2.2.1.m1.1.1.3.cmml" xref="S4.T1.2.2.1.m1.1.1.3">18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">338\pm 18</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<td id="S4.T1.3.3.2" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.3.3.4" class="ltx_td ltx_align_center">2</td>
<td id="S4.T1.3.3.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.3.3.1" class="ltx_td ltx_align_center"><math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="426\pm 70" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><mrow id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml"><mn id="S4.T1.3.3.1.m1.1.1.2" xref="S4.T1.3.3.1.m1.1.1.2.cmml">426</mn><mo id="S4.T1.3.3.1.m1.1.1.1" xref="S4.T1.3.3.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.3.3.1.m1.1.1.3" xref="S4.T1.3.3.1.m1.1.1.3.cmml">70</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><apply id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.3.3.1.m1.1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.3.3.1.m1.1.1.2.cmml" xref="S4.T1.3.3.1.m1.1.1.2">426</cn><cn type="integer" id="S4.T1.3.3.1.m1.1.1.3.cmml" xref="S4.T1.3.3.1.m1.1.1.3">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">426\pm 70</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.4.4" class="ltx_tr">
<td id="S4.T1.4.4.2" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.4.4.3" class="ltx_td ltx_align_center">32</td>
<td id="S4.T1.4.4.4" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.4.4.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.4.4.1" class="ltx_td ltx_align_center"><math id="S4.T1.4.4.1.m1.1" class="ltx_Math" alttext="427\pm 85" display="inline"><semantics id="S4.T1.4.4.1.m1.1a"><mrow id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml"><mn id="S4.T1.4.4.1.m1.1.1.2" xref="S4.T1.4.4.1.m1.1.1.2.cmml">427</mn><mo id="S4.T1.4.4.1.m1.1.1.1" xref="S4.T1.4.4.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.4.4.1.m1.1.1.3" xref="S4.T1.4.4.1.m1.1.1.3.cmml">85</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><apply id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.4.4.1.m1.1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.4.4.1.m1.1.1.2.cmml" xref="S4.T1.4.4.1.m1.1.1.2">427</cn><cn type="integer" id="S4.T1.4.4.1.m1.1.1.3.cmml" xref="S4.T1.4.4.1.m1.1.1.3">85</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">427\pm 85</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.5.5" class="ltx_tr">
<td id="S4.T1.5.5.2" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.5.5.3" class="ltx_td ltx_align_center">16</td>
<td id="S4.T1.5.5.4" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.5.5.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.5.5.1" class="ltx_td ltx_align_center"><math id="S4.T1.5.5.1.m1.1" class="ltx_Math" alttext="547\pm 81" display="inline"><semantics id="S4.T1.5.5.1.m1.1a"><mrow id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml"><mn id="S4.T1.5.5.1.m1.1.1.2" xref="S4.T1.5.5.1.m1.1.1.2.cmml">547</mn><mo id="S4.T1.5.5.1.m1.1.1.1" xref="S4.T1.5.5.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.5.5.1.m1.1.1.3" xref="S4.T1.5.5.1.m1.1.1.3.cmml">81</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b"><apply id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.5.5.1.m1.1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.5.5.1.m1.1.1.2.cmml" xref="S4.T1.5.5.1.m1.1.1.2">547</cn><cn type="integer" id="S4.T1.5.5.1.m1.1.1.3.cmml" xref="S4.T1.5.5.1.m1.1.1.3">81</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">547\pm 81</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.6.6" class="ltx_tr">
<td id="S4.T1.6.6.2" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.6.6.3" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.6.6.4" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.6.6.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.6.6.1" class="ltx_td ltx_align_center"><math id="S4.T1.6.6.1.m1.1" class="ltx_Math" alttext="711\pm 40" display="inline"><semantics id="S4.T1.6.6.1.m1.1a"><mrow id="S4.T1.6.6.1.m1.1.1" xref="S4.T1.6.6.1.m1.1.1.cmml"><mn id="S4.T1.6.6.1.m1.1.1.2" xref="S4.T1.6.6.1.m1.1.1.2.cmml">711</mn><mo id="S4.T1.6.6.1.m1.1.1.1" xref="S4.T1.6.6.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.6.6.1.m1.1.1.3" xref="S4.T1.6.6.1.m1.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.1.m1.1b"><apply id="S4.T1.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.6.6.1.m1.1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.6.6.1.m1.1.1.2.cmml" xref="S4.T1.6.6.1.m1.1.1.2">711</cn><cn type="integer" id="S4.T1.6.6.1.m1.1.1.3.cmml" xref="S4.T1.6.6.1.m1.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.1.m1.1c">711\pm 40</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.7.7" class="ltx_tr">
<td id="S4.T1.7.7.2" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.7.7.3" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.7.7.4" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.7.7.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.7.7.1" class="ltx_td ltx_align_center"><math id="S4.T1.7.7.1.m1.1" class="ltx_Math" alttext="766\pm 80" display="inline"><semantics id="S4.T1.7.7.1.m1.1a"><mrow id="S4.T1.7.7.1.m1.1.1" xref="S4.T1.7.7.1.m1.1.1.cmml"><mn id="S4.T1.7.7.1.m1.1.1.2" xref="S4.T1.7.7.1.m1.1.1.2.cmml">766</mn><mo id="S4.T1.7.7.1.m1.1.1.1" xref="S4.T1.7.7.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.7.7.1.m1.1.1.3" xref="S4.T1.7.7.1.m1.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.1.m1.1b"><apply id="S4.T1.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.7.7.1.m1.1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.7.7.1.m1.1.1.2.cmml" xref="S4.T1.7.7.1.m1.1.1.2">766</cn><cn type="integer" id="S4.T1.7.7.1.m1.1.1.3.cmml" xref="S4.T1.7.7.1.m1.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.1.m1.1c">766\pm 80</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.8.8" class="ltx_tr">
<td id="S4.T1.8.8.2" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.8.8.3" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.8.8.4" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.8.8.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.8.8.1" class="ltx_td ltx_align_center"><math id="S4.T1.8.8.1.m1.1" class="ltx_Math" alttext="819\pm 90" display="inline"><semantics id="S4.T1.8.8.1.m1.1a"><mrow id="S4.T1.8.8.1.m1.1.1" xref="S4.T1.8.8.1.m1.1.1.cmml"><mn id="S4.T1.8.8.1.m1.1.1.2" xref="S4.T1.8.8.1.m1.1.1.2.cmml">819</mn><mo id="S4.T1.8.8.1.m1.1.1.1" xref="S4.T1.8.8.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.8.8.1.m1.1.1.3" xref="S4.T1.8.8.1.m1.1.1.3.cmml">90</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.1.m1.1b"><apply id="S4.T1.8.8.1.m1.1.1.cmml" xref="S4.T1.8.8.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.8.8.1.m1.1.1.1.cmml" xref="S4.T1.8.8.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.8.8.1.m1.1.1.2.cmml" xref="S4.T1.8.8.1.m1.1.1.2">819</cn><cn type="integer" id="S4.T1.8.8.1.m1.1.1.3.cmml" xref="S4.T1.8.8.1.m1.1.1.3">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.1.m1.1c">819\pm 90</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.9.9" class="ltx_tr">
<td id="S4.T1.9.9.2" class="ltx_td ltx_align_center">7</td>
<td id="S4.T1.9.9.3" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.9.9.4" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.9.9.5" class="ltx_td ltx_align_center">w/o public data</td>
<td id="S4.T1.9.9.1" class="ltx_td ltx_align_center"><math id="S4.T1.9.9.1.m1.1" class="ltx_Math" alttext="2900\pm 130" display="inline"><semantics id="S4.T1.9.9.1.m1.1a"><mrow id="S4.T1.9.9.1.m1.1.1" xref="S4.T1.9.9.1.m1.1.1.cmml"><mn id="S4.T1.9.9.1.m1.1.1.2" xref="S4.T1.9.9.1.m1.1.1.2.cmml">2900</mn><mo id="S4.T1.9.9.1.m1.1.1.1" xref="S4.T1.9.9.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.9.9.1.m1.1.1.3" xref="S4.T1.9.9.1.m1.1.1.3.cmml">130</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.1.m1.1b"><apply id="S4.T1.9.9.1.m1.1.1.cmml" xref="S4.T1.9.9.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.9.9.1.m1.1.1.1.cmml" xref="S4.T1.9.9.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.9.9.1.m1.1.1.2.cmml" xref="S4.T1.9.9.1.m1.1.1.2">2900</cn><cn type="integer" id="S4.T1.9.9.1.m1.1.1.3.cmml" xref="S4.T1.9.9.1.m1.1.1.3">130</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.1.m1.1c">2900\pm 130</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.10.10" class="ltx_tr">
<td id="S4.T1.10.10.2" class="ltx_td ltx_align_center">1</td>
<td id="S4.T1.10.10.3" class="ltx_td ltx_align_center">8</td>
<td id="S4.T1.10.10.4" class="ltx_td ltx_align_center">4</td>
<td id="S4.T1.10.10.5" class="ltx_td ltx_align_center">20</td>
<td id="S4.T1.10.10.1" class="ltx_td ltx_align_center"><math id="S4.T1.10.10.1.m1.1" class="ltx_Math" alttext="\infty" display="inline"><semantics id="S4.T1.10.10.1.m1.1a"><mi mathvariant="normal" id="S4.T1.10.10.1.m1.1.1" xref="S4.T1.10.10.1.m1.1.1.cmml">âˆ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.1.m1.1b"><infinity id="S4.T1.10.10.1.m1.1.1.cmml" xref="S4.T1.10.10.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.1.m1.1c">\infty</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.11.11" class="ltx_tr">
<td id="S4.T1.11.11.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" colspan="4">Uncompressed</td>
<td id="S4.T1.11.11.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S4.T1.11.11.1.m1.1" class="ltx_Math" alttext="225\pm 35" display="inline"><semantics id="S4.T1.11.11.1.m1.1a"><mrow id="S4.T1.11.11.1.m1.1.1" xref="S4.T1.11.11.1.m1.1.1.cmml"><mn id="S4.T1.11.11.1.m1.1.1.2" xref="S4.T1.11.11.1.m1.1.1.2.cmml">225</mn><mo id="S4.T1.11.11.1.m1.1.1.1" xref="S4.T1.11.11.1.m1.1.1.1.cmml">Â±</mo><mn id="S4.T1.11.11.1.m1.1.1.3" xref="S4.T1.11.11.1.m1.1.1.3.cmml">35</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.1.m1.1b"><apply id="S4.T1.11.11.1.m1.1.1.cmml" xref="S4.T1.11.11.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.11.11.1.m1.1.1.1.cmml" xref="S4.T1.11.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="integer" id="S4.T1.11.11.1.m1.1.1.2.cmml" xref="S4.T1.11.11.1.m1.1.1.2">225</cn><cn type="integer" id="S4.T1.11.11.1.m1.1.1.3.cmml" xref="S4.T1.11.11.1.m1.1.1.3">35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.1.m1.1c">225\pm 35</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.19.4.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.17.3" class="ltx_text" style="font-size:90%;">Effects of codebook shape (<math id="S4.T1.15.1.m1.2" class="ltx_Math" alttext="K,D" display="inline"><semantics id="S4.T1.15.1.m1.2b"><mrow id="S4.T1.15.1.m1.2.3.2" xref="S4.T1.15.1.m1.2.3.1.cmml"><mi id="S4.T1.15.1.m1.1.1" xref="S4.T1.15.1.m1.1.1.cmml">K</mi><mo id="S4.T1.15.1.m1.2.3.2.1" xref="S4.T1.15.1.m1.2.3.1.cmml">,</mo><mi id="S4.T1.15.1.m1.2.2" xref="S4.T1.15.1.m1.2.2.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.15.1.m1.2c"><list id="S4.T1.15.1.m1.2.3.1.cmml" xref="S4.T1.15.1.m1.2.3.2"><ci id="S4.T1.15.1.m1.1.1.cmml" xref="S4.T1.15.1.m1.1.1">ğ¾</ci><ci id="S4.T1.15.1.m1.2.2.cmml" xref="S4.T1.15.1.m1.2.2">ğ·</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.1.m1.2d">K,D</annotation></semantics></math>) and number (<math id="S4.T1.16.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.T1.16.2.m2.1b"><mi id="S4.T1.16.2.m2.1.1" xref="S4.T1.16.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.T1.16.2.m2.1c"><ci id="S4.T1.16.2.m2.1.1.cmml" xref="S4.T1.16.2.m2.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.2.m2.1d">M</annotation></semantics></math>) on CelebA. â€œuncompressedâ€ refers to the results obtained without applying any communication compression methods, â€œw/o public dataâ€ indicates that no public data was used, and â€œ<math id="S4.T1.17.3.m3.1" class="ltx_Math" alttext="M=1" display="inline"><semantics id="S4.T1.17.3.m3.1b"><mrow id="S4.T1.17.3.m3.1.1" xref="S4.T1.17.3.m3.1.1.cmml"><mi id="S4.T1.17.3.m3.1.1.2" xref="S4.T1.17.3.m3.1.1.2.cmml">M</mi><mo id="S4.T1.17.3.m3.1.1.1" xref="S4.T1.17.3.m3.1.1.1.cmml">=</mo><mn id="S4.T1.17.3.m3.1.1.3" xref="S4.T1.17.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.17.3.m3.1c"><apply id="S4.T1.17.3.m3.1.1.cmml" xref="S4.T1.17.3.m3.1.1"><eq id="S4.T1.17.3.m3.1.1.1.cmml" xref="S4.T1.17.3.m3.1.1.1"></eq><ci id="S4.T1.17.3.m3.1.1.2.cmml" xref="S4.T1.17.3.m3.1.1.2">ğ‘€</ci><cn type="integer" id="S4.T1.17.3.m3.1.1.3.cmml" xref="S4.T1.17.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.3.m3.1d">M=1</annotation></semantics></math>â€ signifies the absence of pseudo-centroids. </span></figcaption>
</figure>
<div id="S4.SS3.SSS3.p3" class="ltx_para">
<p id="S4.SS3.SSS3.p3.1" class="ltx_p">TableÂ <a href="#S4.T1" title="Table 1 â€£ 4.3.3 Ablation study â€£ 4.3 Experimental Results â€£ 4 Evaluation â€£ FedMPQ: Secure and Communication-Efficient Federated Learning with Multi-codebook Product Quantization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> presents the impact of different codebook shapes and quantities on the final model accuracy and convergence rate. From the experimental results, it is evident that both codebook quantity and shape significantly affect the modelâ€™s ultimate performance and convergence rate.
When the codebooks are sufficiently large, FedMPQ is capable of achieving performance similar to the uncompressed baseline while exhibiting very similar convergence rates.
Furthermore, â€œM=7â€ denotes results obtained exclusively from pseudo-centroids, while â€œM=1â€ reflects those derived solely from public data. While using only pseudo-centroids to generate codebooks still allows the model to achieve a 90% accuracy rate, there is a significant decrease in convergence rate. This leads to a substantial increase in total communication overhead, underscoring the indispensability of codebooks generated based on public data.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we have addressed the challenge of realizing secure and efficient communication compression in federated learning scenarios where there exists a significant gap between the public and client data. We thus introduced FedMPQ, an innovative approach that goes beyond previous product quantization-based compression methods. In FedMPQ, we maintain and update multiple codebooks simultaneously, allowing clients to adaptively select a best codebook to compress their updates. Recognizing the inflexibility of traditional product quantization in adjusting compression rates, we complemented our approach with a pruning-based residual compression method, enabling clients to finely tune compression rates according to their available bandwidth. Besides, the separation of model and codebook update ensures a secure aggregation.
Our experiments have demonstrated that these strategies can be effectively integrated to achieve substantial uplink compression, minimal performance degradation, and enhanced security guarantees.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alistarh <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Dan Alistarh, Demjan Grubic, Jerry Li, Ryota Tomioka, and Milan Vojnovic.

</span>
<span class="ltx_bibblock">Qsgd: Communication-efficient sgd via gradient quantization and encoding.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Sebastian Caldas, Sai MeherÂ Karthik Duddu, Peter Wu, Tian Li, Jakub KoneÄná»³, HÂ Brendan McMahan, Virginia Smith, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">Leaf: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.01097</span>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Nicholas Carlini, Steve Chien, Milad Nasr, Shuang Song, Andreas Terzis, and Florian Tramer.

</span>
<span class="ltx_bibblock">Membership inference attacks from first principles.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">2022 IEEE Symposium on Security and Privacy (SP)</span>, pages 1897â€“1914. IEEE, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai <span id="bib.bib4.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Xinyan Dai, Xiao Yan, Kaiwen Zhou, Han Yang, KelvinÂ KW Ng, James Cheng, and YuÂ Fan.

</span>
<span class="ltx_bibblock">Hyper-sphere quantization: Communication-efficient sgd for federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1911.04655</span>, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng [2012]</span>
<span class="ltx_bibblock">
LiÂ Deng.

</span>
<span class="ltx_bibblock">The mnist database of handwritten digit images for machine learning research [best of the web].

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">IEEE signal processing magazine</span>, 29(6):141â€“142, 2012.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiping <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Jonas Geiping, Hartmut Bauermeister, Hannah DrÃ¶ge, and Michael Moeller.

</span>
<span class="ltx_bibblock">Inverting gradients-how easy is it to break privacy in federated learning?

</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 33:16937â€“16947, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">JÃ©gou <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2011]</span>
<span class="ltx_bibblock">
Herve JÃ©gou, Matthijs Douze, and Cordelia Schmid.

</span>
<span class="ltx_bibblock">Product quantization for nearest neighbor search.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</span>, 33(1):117â€“128, 2011.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Peter Kairouz, H.Â Brendan McMahan, Brendan Avent, AurÃ©lien Bellet, Mehdi Bennis, ArjunÂ Nitin Bhagoji, K.Â A. Bonawitz, Zachary Charles, Graham Cormode, Rachel Cummings, RafaelÂ G.L. Dâ€™Oliveira, SalimÂ El Rouayheb, David Evans, Josh Gardner, Zachary Garrett, AdriÃ  GascÃ³n, Badih Ghazi, PhillipÂ B. Gibbons, Marco Gruteser, Zaid Harchaoui, Chaoyang He, Lie He, Zhouyuan Huo, Ben Hutchinson, Justin Hsu, Martin Jaggi, Tara Javidi, Gauri Joshi, Mikhail Khodak, Jakub KoneÄnÃ½, Aleksandra Korolova, Farinaz Koushanfar, Sanmi Koyejo, TancrÃ¨de Lepoint, Yang Liu, Prateek Mittal, Mehryar Mohri, Richard Nock, Ayfer Ã–zgÃ¼r, Rasmus Pagh, Mariana Raykova, Hang Qi, Daniel Ramage, Ramesh Raskar, Dawn Song, Weikang Song, SebastianÂ U. Stich, Ziteng Sun, AnandaÂ Theertha Suresh, Florian TramÃ¨r, Praneeth Vepakomma, Jianyu Wang, LiÂ Xiong, Zheng Xu, Qiang Yang, FelixÂ X. Yu, Han Yu, and Sen Zhao.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz <span id="bib.bib9.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Peter Kairouz, HÂ Brendan McMahan, Brendan Avent, AurÃ©lien Bellet, Mehdi Bennis, ArjunÂ Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham Cormode, Rachel Cummings, etÂ al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic">Foundations and TrendsÂ® in Machine Learning</span>, 14(1â€“2):1â€“210, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2012]</span>
<span class="ltx_bibblock">
Kyunghan Lee, Joohyun Lee, Yung Yi, Injong Rhee, and Song Chong.

</span>
<span class="ltx_bibblock">Mobile data offloading: How much can wifi deliver?

</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">IEEE/ACM Transactions on networking</span>, 21(2):536â€“550, 2012.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Li [2023]</span>
<span class="ltx_bibblock">
Xiaoyun Li and Ping Li.

</span>
<span class="ltx_bibblock">Analysis of error feedback in federated non-convex optimization with biased compression: Fast convergence and partial participation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages 19638â€“19688. PMLR, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib12.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2015]</span>
<span class="ltx_bibblock">
Ziwei Liu, Ping Luo, Xiaogang Wang, and Xiaoou Tang.

</span>
<span class="ltx_bibblock">Deep learning face attributes in the wild.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international conference on computer vision</span>, pages 3730â€“3738, 2015.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mai <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
VanÂ Sy Mai, RichardÂ J La, and Tao Zhang.

</span>
<span class="ltx_bibblock">Federated learning with server learning: Enhancing performance for non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2210.02614</span>, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
John Nguyen, Kshitiz Malik, Hongyuan Zhan, Ashkan Yousefpour, Mike Rabbat, Mani Malek, and Dzmitry Huba.

</span>
<span class="ltx_bibblock">Federated learning with buffered asynchronous aggregation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">International Conference on Artificial Intelligence and Statistics</span>, pages 3581â€“3607. PMLR, 2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Yongjeong Oh, Namyoon Lee, Yo-Seb Jeon, and HÂ Vincent Poor.

</span>
<span class="ltx_bibblock">Communication-efficient federated learning via quantized compressed sensing.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Wireless Communications</span>, 22(2):1087â€“1100, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2023]</span>
<span class="ltx_bibblock">
Yongjeong Oh, Yo-Seb Jeon, Mingzhe Chen, and Walid Saad.

</span>
<span class="ltx_bibblock">Fedvqcs: Federated learning via vector quantized compressed sensing.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Wireless Communications</span>, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Prasad <span id="bib.bib17.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Karthik Prasad, Sayan Ghosh, Graham Cormode, Ilya Mironov, Ashkan Yousefpour, and Pierre Stock.

</span>
<span class="ltx_bibblock">Reconciling security and communication efficiency in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2207.12779</span>, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rothchild <span id="bib.bib18.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Daniel Rothchild, Ashwinee Panda, Enayat Ullah, Nikita Ivkin, Ion Stoica, Vladimir Braverman, Joseph Gonzalez, and Raman Arora.

</span>
<span class="ltx_bibblock">FetchSGD: Communication-efficient federated learning with sketching.

</span>
<span class="ltx_bibblock">In HalÂ DaumÃ© III and Aarti Singh, editors, <span id="bib.bib18.3.1" class="ltx_text ltx_font_italic">Proceedings of the 37th International Conference on Machine Learning</span>, volume 119 of <span id="bib.bib18.4.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 8253â€“8265. PMLR, 13â€“18 Jul 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sahu <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Atal Sahu, Aritra Dutta, Ahmed MÂ Abdelmoniem, Trambak Banerjee, Marco Canini, and Panos Kalnis.

</span>
<span class="ltx_bibblock">Rethinking gradient sparsification as total error minimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 34:8133â€“8146, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vogels <span id="bib.bib20.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Thijs Vogels, SaiÂ Praneeth Karimireddy, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Powersgd: Practical low-rank gradient compression for distributed optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 32, 2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao <span id="bib.bib21.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2023]</span>
<span class="ltx_bibblock">
Xiong Xiao, Zhuo Tang, Chuanying Li, Bin Xiao, and Kenli Li.

</span>
<span class="ltx_bibblock">Sca: Sybil-based collusion attacks of iiot data poisoning in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Industrial Informatics</span>, 19(3):2608â€“2618, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Hong Zhang, JiÂ Liu, Juncheng Jia, Yang Zhou, Huaiyu Dai, and Dejing Dou.

</span>
<span class="ltx_bibblock">Fedduap: Federated learning with dynamic update and adaptive pruning using shared data on the server.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.13574" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.13575" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.13575">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.13575" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.13576" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 20:48:45 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
