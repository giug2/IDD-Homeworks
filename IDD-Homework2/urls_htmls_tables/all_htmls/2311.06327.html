<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2311.06327] B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit</title><meta property="og:description" content="The correctness and precision of particle physics simulation software, such as Geant4, is expected to yield results that closely align with real-world observations or well-established theoretical predictions. Notably, …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2311.06327">

<!--Generated on Tue Feb 27 19:37:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\vol</span>
<p id="p1.2" class="ltx_p">2022

<span id="p1.2.1" class="ltx_ERROR undefined">\published</span>xx March 2018










</p>
</div>
<h1 class="ltx_title ltx_title_document">B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Angel Bueno
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id2.1.id1" class="ltx_ERROR undefined">\auno</span>1 Felix Sattler
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id3.1.id1" class="ltx_ERROR undefined">\auno</span>1 Maximilian Perez Prada
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id4.1.id1" class="ltx_ERROR undefined">\auno</span>1
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Maurice Stephan<span id="id5.1.id1" class="ltx_ERROR undefined">\auno</span>1
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Sarah Barnes<span id="id6.2.id1" class="ltx_ERROR undefined">\auno</span>1
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_address"><sup id="id7.3.id1" class="ltx_sup">1</sup>German Aerospace Center (DLR),
<br class="ltx_break">Institute for the Protection of Maritime Infrastructures, Germany

<br class="ltx_break">
Corresponding author: Angel Bueno
<br class="ltx_break">Email address: angel.bueno@dlr.de

</span></span></span>
</div>
<div class="ltx_dates">(xx January 2018)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">The correctness and precision of particle physics simulation software, such as Geant4, is expected to yield results that closely align with real-world observations or well-established theoretical predictions. Notably, the accuracy of these simulated outcomes is contingent upon the software’s capacity to encapsulate detailed attributes, including its prowess in generating or incorporating complex geometrical constructs. While the imperatives of precision and accuracy are essential in these simulations, the need to manually code highly detailed geometries emerges as a salient bottleneck in developing software-driven physics simulations. This research proposes Blender-to-Geant4 (B2G4), a modular data workflow that utilizes Blender to create 3D scenes, which can be exported as geometry input for Geant4. B2G4 offers a range of tools to streamline the creation of simulation scenes with multiple complex geometries and realistic material properties. Here, we demonstrate the use of B2G4 in a muon scattering tomography application to image the interior of a sealed steel structure. The modularity of B2G4 paves the way for the designed scenes and tools to be embedded not only in Geant4, but in other scientific applications or simulation software.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
muon tomography<span id="id9.id1" class="ltx_ERROR undefined">\sep</span>Geant4 simulations<span id="id10.id2" class="ltx_ERROR undefined">\sep</span>synthetic data
<a target="_blank" href="https:/doi.org/10.31526/JAIS.2022.ID" title="" class="ltx_ref">10.31526/JAIS.2022.ID</a>

</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journal"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>JAIS-ID</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Muon tomography, or MT, leverages muons as a non-invasive imaging technique to visualize macroscopic three-dimensional volumes. MT harnesses two main interaction patterns to investigate a volume of interest (VOI): absorption and scattering <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib1" title="" class="ltx_ref">bonechiyandrea </a></cite>. The absorption pattern is centered around observing the attenuation of muons as they penetrate the VOI and comparing with the open-sky expectation. The scattering pattern, also known as muon scattering tomography (MST), focuses on quantifying the deflection angles of muons as they traverse the VOI. The deflections depend on the physical properties of the material traversed by the muons and thus serve as the bedrock for tomographic reconstruction. The canonical application of MST aims to quantify material densities in concealed or obscured setups where direct inspection would be costly or not feasible, such as border security applications <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib2" title="" class="ltx_ref">sarah2023 </a></cite>, infrastructure monitoring <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib3" title="" class="ltx_ref">thompson2020muon </a></cite>, non-destructive industrial testing <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib4" title="" class="ltx_ref">arbol2019non </a></cite> or nuclear fuel cask surveillance <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib5" title="" class="ltx_ref">poulson2019application </a></cite>.
<br class="ltx_break"></p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Current procedures for MT simulation are often implemented in Geant4 <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib6" title="" class="ltx_ref">agostinelli2003geant4 </a></cite>, a powerful particle physics simulation software that accurately models particle propagation and their complex interactions with matter within a well-defined setting. Geant4 encapsulates the entire simulation in a single volume, namely the world volume, in which the physics processes, the geometrical constructs of objects (so called solids), detectors, and VOIs are specified. The geometrical definition of a VOI and its solids entails native function calls in C++ to the Geant4 application programming interface (API) in order to delineate the VOI and the solid properties. The advanced geometry descriptors within the Geant4 API offer a versatile implementation for constructing approximate and realistic 3D environments and, thus, permit the precise examination and analysis of muon interactions and their subsequent effects <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib7" title="" class="ltx_ref">maxi </a></cite>. However, creating highly detailed VOIs in Geant4 can be challenging and time-consuming, as it often requires manual coding and much expertise. Therefore, established coding approaches in Geant4 fall short when it comes to efficiently designing and importing complex scenes. This limitation can hinder researchers needing rapid and smooth scene creation and exportation for validating their simulation projects.
<br class="ltx_break"></p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">This research proposes Blender-to-Geant4 (B2G4), a novel framework that synergizes the power of Blender’s 3D modeling tools <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib8" title="" class="ltx_ref">blender3D </a></cite> to enhance scene design and simulations in Geant4. Blender offers a versatile, user-friendly interface to generate intricate geometries, leveraging the power of drag-and-drop placement, solid modeling precision, shape variance randomization, and intuitive material assignments. The suite of functionalities defined in B2G4 transplants the designed scene in Blender into a readable format for Geant4, enabling the automated export and import of scenes with minimal manual effort. The B2G4 framework streamlines the development of simulation scenes in Geant4 for a diverse range of applications. This paper highlights one example workflow, including generating and analyzing detailed scenes for muon tomography.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2311.06327/assets/materials_alt.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="249" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Scene setup with three solids in Blender (left) and Geant4 (right). The plastic monkey head (pink) with two ellipsoids (yellow, blue) of lead and uranium inside sits on top of a metallic surface (red) in a cuboid world (blue). The materials used are clearly distinguishable in both Blender and Geant4, demonstrating the finesse of B2G4 in solid and material definition.</figcaption>
</figure>
<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Scene design in Geant4 with multiple solids is labor-intensive due to manual coding and iterative error rectifications. To speed up the scene design phase, several procedures have been suggested. The <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">Geometry Description Markup Language</span> (GDML) was proposed by <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">gdml2006 </a></cite>. The GDML language offers an XML-based schema designed to formulate geometry hierarchies in Geant4, emphasizing the reusability of geometric components to streamline the creation of solids in a simulation scene for Geant4. However, GDML entails manual manipulation of text files and sophisticated XML parsers for integration with Geant4, and notably, it lacks any form of visual feedback mechanism. An alternative approach presented by <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib10" title="" class="ltx_ref">Constantin_2010 </a></cite> entails transferring 3D CAD data into GDML through proprietary 3D software like FastRad. This solution introduces the necessity of proficiency in commercial 3D CAD software.
<br class="ltx_break"></p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">Over the past years, the research community in Geant4 has shifted toward open software solutions. Research work by <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib11" title="" class="ltx_ref">PINTO2019150 </a></cite> outlined an open-source workflow to convert STEP files to GDML, but the sophistication of the workflow requires manual coding and is prone to parsing errors across file formats. Proposed software by <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib12" title="" class="ltx_ref">Poole2012 </a></cite> advocates integrating 3D models into Geant4 by converting standard 3D files to Geant4 code using the TesselatedFacets feature in Geant4. Though this software is a well-established method to export 3D models into Geant4, it does not extend this capability to entire 3D scenes; that is, the geometrical attributes of each solid in a scene, their positions, and logical hierarchies in Geant4 must be manually coded one by one. Further, when adding or modifying a 3D scene, these prior workflows require compilation in Geant4.
<br class="ltx_break"></p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p">Our approach posits a newer direction in scene design for Geant4 using Blender, an open-source 3D modeling suite that is accessible, well-documented, and provides a Python interface to program external addons. Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Related work ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> depicts a scene design setup in Blender (left) and the exported scene in Geant4 (right) using our proposed B2G4 software. Notice that B2G4 permits the design of complete scenes with multiple solids, with precise geometry and material assignments. Further, B2G4 is open source (no proprietary tools are required) and provides enhanced visual feedback with easy scene editing. The dynamical scene exportation in B2G4 allows new scenes to be loaded during run time without the need for re-compilation of Geant4, a distinction crucial in scene design. In the following sections, we describe the working principles of B2G4 and explore its application in the context of muon scattering tomography.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>B2G4 description</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The standard B2G4 workflow consists of several stages: scene creation, parsing, saving, exporting into Geant4, and data interpretation. Figure 2 illustrates the complete workflow of B2G4, adapted for muon tomography data analysis. Note that these stages are grouped into three main modules: the <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">B2G4 scene exporter</span>, the <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">B2G4 data interpreter</span>, and the <span id="S3.p1.1.3" class="ltx_text ltx_font_italic">B2G4 muon tomography</span> module. After the data interpretation step by B2G4, the post-processed output is forwarded to specific use cases, here, muon tomography data analysis. The implementation of B2G4 into three independent modules enables easy scaling of the scene design process, from local prototyping in Blender to the simulation of randomized scenes at scale with loadable run-times in Geant4.
<br class="ltx_break"></p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2311.06327/assets/Figure2.jpg" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="169" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.5.1" class="ltx_text ltx_font_bold">Blender-to-Geant4 (B2G4) workflow:</span> B2G4 offers a range of tools to bridge Blender and Geant4, with Python scripts for Blender export and a C++ library for Geant4 imports. The <span id="S3.F2.6.2" class="ltx_text ltx_font_italic">B2G4 scene exporter</span> creates a graph structure that mimics the hierarchy of Geant4 scene structures, allowing the Blender scene to be translated into a format that Geant4 can read. The <span id="S3.F2.7.3" class="ltx_text ltx_font_italic">B2G4 data interpreter</span> processes particle data files produced by Geant4 simulation. The <span id="S3.F2.8.4" class="ltx_text ltx_font_italic">B2G4 muon tomography</span> framework then reconstructs the Blender scene using processed muon hits. The B2G4 modules are standalone, allowing users to employ this end-to-end workflow tailored to their specific simulation requirements in Geant4.</figcaption>
</figure>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p"><span id="S3.p2.1.1" class="ltx_text ltx_font_bold">B2G4 scene exporter:</span> The main module for scene creation and exportation is the <span id="S3.p2.1.2" class="ltx_text ltx_font_italic">B2G4 scene exporter</span>. This standalone module contains the internal scripts for the creation and saving of the scene in Blender, and the parser to Geant4:</p>
</div>
<div id="S3.p3" class="ltx_para">
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.4" class="ltx_p"><span id="S3.I1.i1.p1.4.1" class="ltx_text ltx_font_bold">Scene creation:</span> B2G4 follows the code conventions of Geant4 to define the geometric attributes of the object being modeled, that is, each solid object in Geant4 is created by describing its attributes with reference to a logical volume, including shape and physical properties. Hence, the solid design in B2G4 maintains a one-to-one correspondence with the mother-daughter logical relationship in Geant4. This logical hierarchy is implemented using the <span id="S3.I1.i1.p1.4.2" class="ltx_text ltx_font_italic">Collection</span> module in Blender, a logical data container that permits the grouping of 3D solids for easier manipulation and organization of 3D scenes. The material assignment is done via the <span id="S3.I1.i1.p1.4.3" class="ltx_text ltx_font_italic">Material Properties</span> modifier in Blender. The available materials in B2G4 have been ported from the Geant4 material database and include pure elements, NIST compounds, biological, space, bio-chemical, high-energy physics, and nuclear materials. B2G4 adopts the ionization potential to aid in material differentiation and enhance visual clarity in analysis through contrasting colors. Every material category in B2G4 has a specific color map based on the normalized ionization potential of the materials specified in the Geant4 material database. We standardize the ionization potentials of materials in a specific category by comparing them to the minimum and maximum ionization potential. In cases where two materials have the same potential, we use their density to create a color offset for better visual separation. The normalized values are then converted to a color map. Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Related work ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> depicts this color scheme for different materials for a monkey head lying on a metallic surface. The surface is <math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="G4\_STAINLESS-STEEL" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mrow id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><mrow id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.2.2" xref="S3.I1.i1.p1.1.m1.1.1.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mn id="S3.I1.i1.p1.1.m1.1.1.2.3" xref="S3.I1.i1.p1.1.m1.1.1.2.3.cmml">4</mn><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1a" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.I1.i1.p1.1.m1.1.1.2.4" xref="S3.I1.i1.p1.1.m1.1.1.2.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1b" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.5" xref="S3.I1.i1.p1.1.m1.1.1.2.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1c" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.6" xref="S3.I1.i1.p1.1.m1.1.1.2.6.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1d" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.7" xref="S3.I1.i1.p1.1.m1.1.1.2.7.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1e" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.8" xref="S3.I1.i1.p1.1.m1.1.1.2.8.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1f" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.9" xref="S3.I1.i1.p1.1.m1.1.1.2.9.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1g" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.10" xref="S3.I1.i1.p1.1.m1.1.1.2.10.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1h" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.11" xref="S3.I1.i1.p1.1.m1.1.1.2.11.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1i" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.12" xref="S3.I1.i1.p1.1.m1.1.1.2.12.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.2.1j" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.13" xref="S3.I1.i1.p1.1.m1.1.1.2.13.cmml">S</mi></mrow><mo id="S3.I1.i1.p1.1.m1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.cmml">−</mo><mrow id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.3.2" xref="S3.I1.i1.p1.1.m1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.3.1" xref="S3.I1.i1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.3.3" xref="S3.I1.i1.p1.1.m1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.3.1a" xref="S3.I1.i1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.3.4" xref="S3.I1.i1.p1.1.m1.1.1.3.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.3.1b" xref="S3.I1.i1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.3.5" xref="S3.I1.i1.p1.1.m1.1.1.3.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.3.1c" xref="S3.I1.i1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.3.6" xref="S3.I1.i1.p1.1.m1.1.1.3.6.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><minus id="S3.I1.i1.p1.1.m1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1"></minus><apply id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2"><times id="S3.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.1"></times><ci id="S3.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.2">𝐺</ci><cn type="integer" id="S3.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.3">4</cn><ci id="S3.I1.i1.p1.1.m1.1.1.2.4.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.4">_</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.5.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.5">𝑆</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.6.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.6">𝑇</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.7.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.7">𝐴</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.8.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.8">𝐼</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.9.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.9">𝑁</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.10.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.10">𝐿</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.11.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.11">𝐸</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.12.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.12">𝑆</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.13.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.13">𝑆</ci></apply><apply id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3"><times id="S3.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.1"></times><ci id="S3.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2">𝑆</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.3">𝑇</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3.4.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.4">𝐸</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3.5.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.5">𝐸</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3.6.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.6">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">G4\_STAINLESS-STEEL</annotation></semantics></math>, whereas the monkey head is <math id="S3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="G4\_Plastic" display="inline"><semantics id="S3.I1.i1.p1.2.m2.1a"><mrow id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mn id="S3.I1.i1.p1.2.m2.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.3.cmml">4</mn><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1a" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.I1.i1.p1.2.m2.1.1.4" xref="S3.I1.i1.p1.2.m2.1.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1b" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.2.m2.1.1.5" xref="S3.I1.i1.p1.2.m2.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1c" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.2.m2.1.1.6" xref="S3.I1.i1.p1.2.m2.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1d" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.2.m2.1.1.7" xref="S3.I1.i1.p1.2.m2.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1e" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.2.m2.1.1.8" xref="S3.I1.i1.p1.2.m2.1.1.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1f" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.2.m2.1.1.9" xref="S3.I1.i1.p1.2.m2.1.1.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1g" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.2.m2.1.1.10" xref="S3.I1.i1.p1.2.m2.1.1.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.2.m2.1.1.1h" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.2.m2.1.1.11" xref="S3.I1.i1.p1.2.m2.1.1.11.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><apply id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1"><times id="S3.I1.i1.p1.2.m2.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1"></times><ci id="S3.I1.i1.p1.2.m2.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.2">𝐺</ci><cn type="integer" id="S3.I1.i1.p1.2.m2.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3">4</cn><ci id="S3.I1.i1.p1.2.m2.1.1.4.cmml" xref="S3.I1.i1.p1.2.m2.1.1.4">_</ci><ci id="S3.I1.i1.p1.2.m2.1.1.5.cmml" xref="S3.I1.i1.p1.2.m2.1.1.5">𝑃</ci><ci id="S3.I1.i1.p1.2.m2.1.1.6.cmml" xref="S3.I1.i1.p1.2.m2.1.1.6">𝑙</ci><ci id="S3.I1.i1.p1.2.m2.1.1.7.cmml" xref="S3.I1.i1.p1.2.m2.1.1.7">𝑎</ci><ci id="S3.I1.i1.p1.2.m2.1.1.8.cmml" xref="S3.I1.i1.p1.2.m2.1.1.8">𝑠</ci><ci id="S3.I1.i1.p1.2.m2.1.1.9.cmml" xref="S3.I1.i1.p1.2.m2.1.1.9">𝑡</ci><ci id="S3.I1.i1.p1.2.m2.1.1.10.cmml" xref="S3.I1.i1.p1.2.m2.1.1.10">𝑖</ci><ci id="S3.I1.i1.p1.2.m2.1.1.11.cmml" xref="S3.I1.i1.p1.2.m2.1.1.11">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">G4\_Plastic</annotation></semantics></math>. The monkey brain is <math id="S3.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="G4\_Pb" display="inline"><semantics id="S3.I1.i1.p1.3.m3.1a"><mrow id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml"><mi id="S3.I1.i1.p1.3.m3.1.1.2" xref="S3.I1.i1.p1.3.m3.1.1.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.3.m3.1.1.1" xref="S3.I1.i1.p1.3.m3.1.1.1.cmml">​</mo><mn id="S3.I1.i1.p1.3.m3.1.1.3" xref="S3.I1.i1.p1.3.m3.1.1.3.cmml">4</mn><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.3.m3.1.1.1a" xref="S3.I1.i1.p1.3.m3.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.I1.i1.p1.3.m3.1.1.4" xref="S3.I1.i1.p1.3.m3.1.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.3.m3.1.1.1b" xref="S3.I1.i1.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.3.m3.1.1.5" xref="S3.I1.i1.p1.3.m3.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.3.m3.1.1.1c" xref="S3.I1.i1.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.3.m3.1.1.6" xref="S3.I1.i1.p1.3.m3.1.1.6.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b"><apply id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1"><times id="S3.I1.i1.p1.3.m3.1.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1.1"></times><ci id="S3.I1.i1.p1.3.m3.1.1.2.cmml" xref="S3.I1.i1.p1.3.m3.1.1.2">𝐺</ci><cn type="integer" id="S3.I1.i1.p1.3.m3.1.1.3.cmml" xref="S3.I1.i1.p1.3.m3.1.1.3">4</cn><ci id="S3.I1.i1.p1.3.m3.1.1.4.cmml" xref="S3.I1.i1.p1.3.m3.1.1.4">_</ci><ci id="S3.I1.i1.p1.3.m3.1.1.5.cmml" xref="S3.I1.i1.p1.3.m3.1.1.5">𝑃</ci><ci id="S3.I1.i1.p1.3.m3.1.1.6.cmml" xref="S3.I1.i1.p1.3.m3.1.1.6">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">G4\_Pb</annotation></semantics></math>, and the small cylindrical object inside is <math id="S3.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="G4\_U" display="inline"><semantics id="S3.I1.i1.p1.4.m4.1a"><mrow id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml"><mi id="S3.I1.i1.p1.4.m4.1.1.2" xref="S3.I1.i1.p1.4.m4.1.1.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.4.m4.1.1.1" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">​</mo><mn id="S3.I1.i1.p1.4.m4.1.1.3" xref="S3.I1.i1.p1.4.m4.1.1.3.cmml">4</mn><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.4.m4.1.1.1a" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.I1.i1.p1.4.m4.1.1.4" xref="S3.I1.i1.p1.4.m4.1.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.4.m4.1.1.1b" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.4.m4.1.1.5" xref="S3.I1.i1.p1.4.m4.1.1.5.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.1b"><apply id="S3.I1.i1.p1.4.m4.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1"><times id="S3.I1.i1.p1.4.m4.1.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.1"></times><ci id="S3.I1.i1.p1.4.m4.1.1.2.cmml" xref="S3.I1.i1.p1.4.m4.1.1.2">𝐺</ci><cn type="integer" id="S3.I1.i1.p1.4.m4.1.1.3.cmml" xref="S3.I1.i1.p1.4.m4.1.1.3">4</cn><ci id="S3.I1.i1.p1.4.m4.1.1.4.cmml" xref="S3.I1.i1.p1.4.m4.1.1.4">_</ci><ci id="S3.I1.i1.p1.4.m4.1.1.5.cmml" xref="S3.I1.i1.p1.4.m4.1.1.5">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.1c">G4\_U</annotation></semantics></math>.
<br class="ltx_break"></p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.8" class="ltx_p"><span id="S3.I1.i2.p1.8.1" class="ltx_text ltx_font_bold">Scene saving:</span> Once the scene has been designed, B2G4 allocates, for each <span id="S3.I1.i2.p1.8.2" class="ltx_text ltx_font_italic">Collection</span> in the scene, the mesh of the imported 3D solid, the position, and the assigned material. To achieve that, a dynamic graph is built by traversing the specified <span id="S3.I1.i2.p1.8.3" class="ltx_text ltx_font_italic">Collections</span> items. B2G4 defines a graph <math id="S3.I1.i2.p1.1.m1.2" class="ltx_Math" alttext="G=(N,E)" display="inline"><semantics id="S3.I1.i2.p1.1.m1.2a"><mrow id="S3.I1.i2.p1.1.m1.2.3" xref="S3.I1.i2.p1.1.m1.2.3.cmml"><mi id="S3.I1.i2.p1.1.m1.2.3.2" xref="S3.I1.i2.p1.1.m1.2.3.2.cmml">G</mi><mo id="S3.I1.i2.p1.1.m1.2.3.1" xref="S3.I1.i2.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S3.I1.i2.p1.1.m1.2.3.3.2" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.I1.i2.p1.1.m1.2.3.3.2.1" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">N</mi><mo id="S3.I1.i2.p1.1.m1.2.3.3.2.2" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.I1.i2.p1.1.m1.2.2" xref="S3.I1.i2.p1.1.m1.2.2.cmml">E</mi><mo stretchy="false" id="S3.I1.i2.p1.1.m1.2.3.3.2.3" xref="S3.I1.i2.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.2b"><apply id="S3.I1.i2.p1.1.m1.2.3.cmml" xref="S3.I1.i2.p1.1.m1.2.3"><eq id="S3.I1.i2.p1.1.m1.2.3.1.cmml" xref="S3.I1.i2.p1.1.m1.2.3.1"></eq><ci id="S3.I1.i2.p1.1.m1.2.3.2.cmml" xref="S3.I1.i2.p1.1.m1.2.3.2">𝐺</ci><interval closure="open" id="S3.I1.i2.p1.1.m1.2.3.3.1.cmml" xref="S3.I1.i2.p1.1.m1.2.3.3.2"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝑁</ci><ci id="S3.I1.i2.p1.1.m1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.2.2">𝐸</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.2c">G=(N,E)</annotation></semantics></math>, whose nodes <math id="S3.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.I1.i2.p1.2.m2.1a"><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">N</annotation></semantics></math> contain a <span id="S3.I1.i2.p1.8.4" class="ltx_text ltx_font_italic">Collection</span> with the solid created and their attributes. The edges <math id="S3.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.I1.i2.p1.3.m3.1a"><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">E</annotation></semantics></math> in this graph preserve the hierarchical logical relationship mother-daughter in Geant4, with the root node, the <math id="S3.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="world\,volume" display="inline"><semantics id="S3.I1.i2.p1.4.m4.1a"><mrow id="S3.I1.i2.p1.4.m4.1.1" xref="S3.I1.i2.p1.4.m4.1.1.cmml"><mi id="S3.I1.i2.p1.4.m4.1.1.2" xref="S3.I1.i2.p1.4.m4.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.3" xref="S3.I1.i2.p1.4.m4.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1a" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.4" xref="S3.I1.i2.p1.4.m4.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1b" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.5" xref="S3.I1.i2.p1.4.m4.1.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1c" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.6" xref="S3.I1.i2.p1.4.m4.1.1.6.cmml">d</mi><mo lspace="0.170em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1d" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.7" xref="S3.I1.i2.p1.4.m4.1.1.7.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1e" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.8" xref="S3.I1.i2.p1.4.m4.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1f" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.9" xref="S3.I1.i2.p1.4.m4.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1g" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.10" xref="S3.I1.i2.p1.4.m4.1.1.10.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1h" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.11" xref="S3.I1.i2.p1.4.m4.1.1.11.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.4.m4.1.1.1i" xref="S3.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i2.p1.4.m4.1.1.12" xref="S3.I1.i2.p1.4.m4.1.1.12.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.1b"><apply id="S3.I1.i2.p1.4.m4.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1"><times id="S3.I1.i2.p1.4.m4.1.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1.1"></times><ci id="S3.I1.i2.p1.4.m4.1.1.2.cmml" xref="S3.I1.i2.p1.4.m4.1.1.2">𝑤</ci><ci id="S3.I1.i2.p1.4.m4.1.1.3.cmml" xref="S3.I1.i2.p1.4.m4.1.1.3">𝑜</ci><ci id="S3.I1.i2.p1.4.m4.1.1.4.cmml" xref="S3.I1.i2.p1.4.m4.1.1.4">𝑟</ci><ci id="S3.I1.i2.p1.4.m4.1.1.5.cmml" xref="S3.I1.i2.p1.4.m4.1.1.5">𝑙</ci><ci id="S3.I1.i2.p1.4.m4.1.1.6.cmml" xref="S3.I1.i2.p1.4.m4.1.1.6">𝑑</ci><ci id="S3.I1.i2.p1.4.m4.1.1.7.cmml" xref="S3.I1.i2.p1.4.m4.1.1.7">𝑣</ci><ci id="S3.I1.i2.p1.4.m4.1.1.8.cmml" xref="S3.I1.i2.p1.4.m4.1.1.8">𝑜</ci><ci id="S3.I1.i2.p1.4.m4.1.1.9.cmml" xref="S3.I1.i2.p1.4.m4.1.1.9">𝑙</ci><ci id="S3.I1.i2.p1.4.m4.1.1.10.cmml" xref="S3.I1.i2.p1.4.m4.1.1.10">𝑢</ci><ci id="S3.I1.i2.p1.4.m4.1.1.11.cmml" xref="S3.I1.i2.p1.4.m4.1.1.11">𝑚</ci><ci id="S3.I1.i2.p1.4.m4.1.1.12.cmml" xref="S3.I1.i2.p1.4.m4.1.1.12">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.1c">world\,volume</annotation></semantics></math>. This graph <math id="S3.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.I1.i2.p1.5.m5.1a"><mi id="S3.I1.i2.p1.5.m5.1.1" xref="S3.I1.i2.p1.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.5.m5.1b"><ci id="S3.I1.i2.p1.5.m5.1.1.cmml" xref="S3.I1.i2.p1.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.5.m5.1c">G</annotation></semantics></math> serves as the basis for the exportation file required for Geant4. Next, B2G4 traverses and accesses the created graph hierarchy <math id="S3.I1.i2.p1.6.m6.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.I1.i2.p1.6.m6.1a"><mi id="S3.I1.i2.p1.6.m6.1.1" xref="S3.I1.i2.p1.6.m6.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.6.m6.1b"><ci id="S3.I1.i2.p1.6.m6.1.1.cmml" xref="S3.I1.i2.p1.6.m6.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.6.m6.1c">G</annotation></semantics></math> within the Blender environment. For every node (or <span id="S3.I1.i2.p1.8.5" class="ltx_text ltx_font_italic">Collection</span>) <math id="S3.I1.i2.p1.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.I1.i2.p1.7.m7.1a"><mi id="S3.I1.i2.p1.7.m7.1.1" xref="S3.I1.i2.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.7.m7.1b"><ci id="S3.I1.i2.p1.7.m7.1.1.cmml" xref="S3.I1.i2.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.7.m7.1c">N</annotation></semantics></math> within the graph hierarchy <math id="S3.I1.i2.p1.8.m8.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.I1.i2.p1.8.m8.1a"><mi id="S3.I1.i2.p1.8.m8.1.1" xref="S3.I1.i2.p1.8.m8.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.8.m8.1b"><ci id="S3.I1.i2.p1.8.m8.1.1.cmml" xref="S3.I1.i2.p1.8.m8.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.8.m8.1c">G</annotation></semantics></math>, relevant data is extracted to outline a logical volume, establish physical placement, and define a solid conforming to the native syntax of Geant4. After all the nodes are traversed, the resulting geometry tree encapsulates the data hierarchy of Geant4 and is stored as a JSON file. This file mirrors the Geant4 layout and incorporates pointers to individual solids. Each unique solid undergoes a singular export process to minimize redundancy, being saved as a Polygon File Format (PLY). B2G4 employs the PLY format for object exportation to establish a standardized 3D asset library, given its widespread recognition and adoption as an open-source file standard for sharing 3D triangular mesh data. This approach seeks to ensure compatibility across Geant4 applications.
<br class="ltx_break"></p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p"><span id="S3.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Scene importing:</span> Here, we describe the process of importing the JSON and PLY files into Geant4. Given that the structure of the JSON file adheres to Geant4’s scene hierarchy, parsing the JSON data to its corresponding Geant4 objects becomes rapid and efficient. To allow dynamic loading of a scene during run-time of Geant4, we resort to a single header file that loads and parses both, the JSON and the PLY files. This header file needs to be included only once in the standard Geant4 compilation process, and no external dependencies are required.
<br class="ltx_break"></p>
</div>
<div id="S3.I1.i3.p2" class="ltx_para">
<p id="S3.I1.i3.p2.1" class="ltx_p">For each JSON entry, the required data is systematically extracted. When a reference to a solid appears, the associated PLY files are loaded and constructed with <span id="S3.I1.i3.p2.1.1" class="ltx_text ltx_font_italic">G4TesselatedSolid</span>. It is important to note that every solid is created only <span id="S3.I1.i3.p2.1.2" class="ltx_text ltx_font_italic">once</span> to save computational overhead, even though it could be referenced several times. The logical volumes (<span id="S3.I1.i3.p2.1.3" class="ltx_text ltx_font_italic">G4LogicalVolume</span>) are created by parsing the required data from the JSON file and looking up the referenced <span id="S3.I1.i3.p2.1.4" class="ltx_text ltx_font_italic">G4Solid</span> from the already loaded <span id="S3.I1.i3.p2.1.5" class="ltx_text ltx_font_italic">G4TesselatedSolids</span>. The resulting <span id="S3.I1.i3.p2.1.6" class="ltx_text ltx_font_italic">G4LogicalVolume</span> is stored in an array. The creation of <span id="S3.I1.i3.p2.1.7" class="ltx_text ltx_font_italic">G4PhysicalVolume</span> objects resort to a similar association of the correct transformation data from the JSON file and logical volume, based on the name identifier.</p>
</div>
</li>
</ol>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.2" class="ltx_p">B2G4 can import scenes of various scales with ease, from intricate designs to complex landscapes. Figure <a href="#S3.F3" title="Figure 3 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> depicts two examples of scene design and exportation process using B2G4: a rotatory aircraft engine (Figure <a href="#S3.F3" title="Figure 3 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.a) and a mountain with a golden monkey head (Figure <a href="#S3.F3" title="Figure 3 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.b). Each solid in the scene is designed using the <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="Collection" display="inline"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1a" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.4" xref="S3.p4.1.m1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1b" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.5" xref="S3.p4.1.m1.1.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1c" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.6" xref="S3.p4.1.m1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1d" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.7" xref="S3.p4.1.m1.1.1.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1e" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.8" xref="S3.p4.1.m1.1.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1f" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.9" xref="S3.p4.1.m1.1.1.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1g" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.10" xref="S3.p4.1.m1.1.1.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1h" xref="S3.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.11" xref="S3.p4.1.m1.1.1.11.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><times id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1"></times><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝐶</ci><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">𝑜</ci><ci id="S3.p4.1.m1.1.1.4.cmml" xref="S3.p4.1.m1.1.1.4">𝑙</ci><ci id="S3.p4.1.m1.1.1.5.cmml" xref="S3.p4.1.m1.1.1.5">𝑙</ci><ci id="S3.p4.1.m1.1.1.6.cmml" xref="S3.p4.1.m1.1.1.6">𝑒</ci><ci id="S3.p4.1.m1.1.1.7.cmml" xref="S3.p4.1.m1.1.1.7">𝑐</ci><ci id="S3.p4.1.m1.1.1.8.cmml" xref="S3.p4.1.m1.1.1.8">𝑡</ci><ci id="S3.p4.1.m1.1.1.9.cmml" xref="S3.p4.1.m1.1.1.9">𝑖</ci><ci id="S3.p4.1.m1.1.1.10.cmml" xref="S3.p4.1.m1.1.1.10">𝑜</ci><ci id="S3.p4.1.m1.1.1.11.cmml" xref="S3.p4.1.m1.1.1.11">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">Collection</annotation></semantics></math> to maintain the one-to-one correspondence with the mother-daughter logical relationship in Geant4, including the <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="world\,volume" display="inline"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1a" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.4" xref="S3.p4.2.m2.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1b" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.5" xref="S3.p4.2.m2.1.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1c" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.6" xref="S3.p4.2.m2.1.1.6.cmml">d</mi><mo lspace="0.170em" rspace="0em" id="S3.p4.2.m2.1.1.1d" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.7" xref="S3.p4.2.m2.1.1.7.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1e" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.8" xref="S3.p4.2.m2.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1f" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.9" xref="S3.p4.2.m2.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1g" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.10" xref="S3.p4.2.m2.1.1.10.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1h" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.11" xref="S3.p4.2.m2.1.1.11.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.1.1.1i" xref="S3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.p4.2.m2.1.1.12" xref="S3.p4.2.m2.1.1.12.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><times id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1.1"></times><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑤</ci><ci id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">𝑜</ci><ci id="S3.p4.2.m2.1.1.4.cmml" xref="S3.p4.2.m2.1.1.4">𝑟</ci><ci id="S3.p4.2.m2.1.1.5.cmml" xref="S3.p4.2.m2.1.1.5">𝑙</ci><ci id="S3.p4.2.m2.1.1.6.cmml" xref="S3.p4.2.m2.1.1.6">𝑑</ci><ci id="S3.p4.2.m2.1.1.7.cmml" xref="S3.p4.2.m2.1.1.7">𝑣</ci><ci id="S3.p4.2.m2.1.1.8.cmml" xref="S3.p4.2.m2.1.1.8">𝑜</ci><ci id="S3.p4.2.m2.1.1.9.cmml" xref="S3.p4.2.m2.1.1.9">𝑙</ci><ci id="S3.p4.2.m2.1.1.10.cmml" xref="S3.p4.2.m2.1.1.10">𝑢</ci><ci id="S3.p4.2.m2.1.1.11.cmml" xref="S3.p4.2.m2.1.1.11">𝑚</ci><ci id="S3.p4.2.m2.1.1.12.cmml" xref="S3.p4.2.m2.1.1.12">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">world\,volume</annotation></semantics></math>. The scene of the rotatory aircraft contains 1.5 million triangles, whereas the scene of the mountain scene contains 4487 triangles. Both are saved in 15.2 and 0.05 seconds, respectively. Once the scene have been exported to Geant4, users can implement their custom simulation setup.
<br class="ltx_break"></p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2311.06327/assets/Figure3hr-transformed.jpg" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S3.F3.2.1" class="ltx_text ltx_font_bold">A B2G4 example of scene design and parsing from Blender into Geant4:</span> the top portion showcases the solid designed with Blender, while the bottom portion displays its equivalent in Geant4. An inset between the two images highlights the extensive details within each solid, precisely transferred from Blender into Geant4. (A) depicts an aircraft engine with highly detailed bolts and rotatory blades (B) a mountain with a cave and a golden monkey head within. The ionization potential colormap in B2G4 eases the identification of each component in a scene. </figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2311.06327/assets/Figure4.jpg" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="463" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S3.F4.2.1" class="ltx_text ltx_font_bold">Example of muon tomography:</span> A scene with a sealed steel container hiding a monkey head; (A) scene in Blender, with textures (B) exported scene in Geant4; (C) side view of the reconstruction in ASR (upper) and PoCA (lower); (D) top-view of the reconstruction with ASR (right) and PoCA (left).</figcaption>
</figure>
<div id="S3.p5" class="ltx_para ltx_noindent">
<p id="S3.p5.1" class="ltx_p"><span id="S3.p5.1.1" class="ltx_text ltx_font_bold">Particle generation with Geant4:</span> The generation of particles is always customized to suit the Geant4 scientific application. This work uses <span id="S3.p5.1.2" class="ltx_text ltx_font_italic">Cosmic-ray Shower Library (CRY)<cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib13" title="" class="ltx_ref">cry </a></cite></span>, a well-known software, to generate cosmic ray air shower particles. The simulation data is created by recording details of the interactions of atmospheric muons with detector planes. The configuration of the detectors, including their thickness and materials, must be outlined. In this context, we operate under the assumption of ideal detectors, that is, no efficiency losses or resolution effects are considered. For a more detailed review of available particle generation approaches for MT in Geant4, we refer the reader to <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib2" title="" class="ltx_ref">sarah2023 </a></cite>. 
<br class="ltx_break"></p>
</div>
<div id="S3.p6" class="ltx_para ltx_noindent">
<p id="S3.p6.1" class="ltx_p"><span id="S3.p6.1.1" class="ltx_text ltx_font_bold">B2G4 data interpreter:</span> The B2G4 data interpreter module uses the Python extension of ROOT <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">brun1997root </a></cite>, PyROOT, to parse simulation output from Geant4 into a data structure suitable for data analysis or machine learning workflows. The ROOT software provides a tree data structure to yield faster access to massive data than regular files. PyROOT provides automatic dynamic bindings between Python and C++, making it ideal for converting the Geant4 output tree data structure into a suitable format for analysis or use by machine learning algorithms.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Muon scattering tomography with B2G4</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.2" class="ltx_p">Muon scattering tomography, or MST, estimates the deflection in the muon trajectories as they traverse the VOI. The magnitude of muon deflection, known as the scattering angle <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\theta</annotation></semantics></math>, supplies information about the material type and density that the muons traverse: materials with higher densities or atomic numbers yield a larger <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\theta</annotation></semantics></math> than those with lower densities. Muon trajectories are inferred using tomographic reconstruction techniques to create a 3D scattering density map of the VOI by estimating deflection angles. Hence, for an estimated muon path, the reconstruction algorithms estimate the set of voxels most probably traversed and allocate a score based on their scattering angle. All muon tracks are processed to create a 3D material density map rendering the internal object structure. B2G4 has a module for muon tomography, assuming MST simulations and data interpretation have been carried out. The <span id="S4.p1.2.1" class="ltx_text ltx_font_italic">B2G4 muon tomography</span> module takes processed muon hitmaps as input and produces the 3D reconstructed scene designed in Blender as output. B2G4 implements two standard reconstruction algorithms in MST: Point of Closest Approach (PoCA) and Angular Scattering Reconstruction (ASR).
<br class="ltx_break"></p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.8" class="ltx_p">The PoCA algorithm assumes a singular point of scattering for a muon and calculates its minimal separation between incident (<math id="S4.p2.1.m1.1" class="ltx_Math" alttext="in" display="inline"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><times id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"></times><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝑖</ci><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">in</annotation></semantics></math>) and emergent trajectories (<math id="S4.p2.2.m2.1" class="ltx_Math" alttext="out" display="inline"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">​</mo><mi id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.p2.2.m2.1.1.1a" xref="S4.p2.2.m2.1.1.1.cmml">​</mo><mi id="S4.p2.2.m2.1.1.4" xref="S4.p2.2.m2.1.1.4.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><times id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1"></times><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝑜</ci><ci id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">𝑢</ci><ci id="S4.p2.2.m2.1.1.4.cmml" xref="S4.p2.2.m2.1.1.4">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">out</annotation></semantics></math>). PoCA employs the incident measured muon path data in terms of position <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{p}" display="inline"><semantics id="S4.p2.3.m3.1a"><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">\mathbf{p}</annotation></semantics></math> and directions <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{d}" display="inline"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">𝐝</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝐝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\mathbf{d}</annotation></semantics></math> as <math id="S4.p2.5.m5.2" class="ltx_Math" alttext="r_{in}=(\mathbf{p_{in}},\mathbf{d_{in}})" display="inline"><semantics id="S4.p2.5.m5.2a"><mrow id="S4.p2.5.m5.2.2" xref="S4.p2.5.m5.2.2.cmml"><msub id="S4.p2.5.m5.2.2.4" xref="S4.p2.5.m5.2.2.4.cmml"><mi id="S4.p2.5.m5.2.2.4.2" xref="S4.p2.5.m5.2.2.4.2.cmml">r</mi><mrow id="S4.p2.5.m5.2.2.4.3" xref="S4.p2.5.m5.2.2.4.3.cmml"><mi id="S4.p2.5.m5.2.2.4.3.2" xref="S4.p2.5.m5.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.p2.5.m5.2.2.4.3.1" xref="S4.p2.5.m5.2.2.4.3.1.cmml">​</mo><mi id="S4.p2.5.m5.2.2.4.3.3" xref="S4.p2.5.m5.2.2.4.3.3.cmml">n</mi></mrow></msub><mo id="S4.p2.5.m5.2.2.3" xref="S4.p2.5.m5.2.2.3.cmml">=</mo><mrow id="S4.p2.5.m5.2.2.2.2" xref="S4.p2.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S4.p2.5.m5.2.2.2.2.3" xref="S4.p2.5.m5.2.2.2.3.cmml">(</mo><msub id="S4.p2.5.m5.1.1.1.1.1" xref="S4.p2.5.m5.1.1.1.1.1.cmml"><mi id="S4.p2.5.m5.1.1.1.1.1.2" xref="S4.p2.5.m5.1.1.1.1.1.2.cmml">𝐩</mi><mi id="S4.p2.5.m5.1.1.1.1.1.3" xref="S4.p2.5.m5.1.1.1.1.1.3.cmml">𝐢𝐧</mi></msub><mo id="S4.p2.5.m5.2.2.2.2.4" xref="S4.p2.5.m5.2.2.2.3.cmml">,</mo><msub id="S4.p2.5.m5.2.2.2.2.2" xref="S4.p2.5.m5.2.2.2.2.2.cmml"><mi id="S4.p2.5.m5.2.2.2.2.2.2" xref="S4.p2.5.m5.2.2.2.2.2.2.cmml">𝐝</mi><mi id="S4.p2.5.m5.2.2.2.2.2.3" xref="S4.p2.5.m5.2.2.2.2.2.3.cmml">𝐢𝐧</mi></msub><mo stretchy="false" id="S4.p2.5.m5.2.2.2.2.5" xref="S4.p2.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.2b"><apply id="S4.p2.5.m5.2.2.cmml" xref="S4.p2.5.m5.2.2"><eq id="S4.p2.5.m5.2.2.3.cmml" xref="S4.p2.5.m5.2.2.3"></eq><apply id="S4.p2.5.m5.2.2.4.cmml" xref="S4.p2.5.m5.2.2.4"><csymbol cd="ambiguous" id="S4.p2.5.m5.2.2.4.1.cmml" xref="S4.p2.5.m5.2.2.4">subscript</csymbol><ci id="S4.p2.5.m5.2.2.4.2.cmml" xref="S4.p2.5.m5.2.2.4.2">𝑟</ci><apply id="S4.p2.5.m5.2.2.4.3.cmml" xref="S4.p2.5.m5.2.2.4.3"><times id="S4.p2.5.m5.2.2.4.3.1.cmml" xref="S4.p2.5.m5.2.2.4.3.1"></times><ci id="S4.p2.5.m5.2.2.4.3.2.cmml" xref="S4.p2.5.m5.2.2.4.3.2">𝑖</ci><ci id="S4.p2.5.m5.2.2.4.3.3.cmml" xref="S4.p2.5.m5.2.2.4.3.3">𝑛</ci></apply></apply><interval closure="open" id="S4.p2.5.m5.2.2.2.3.cmml" xref="S4.p2.5.m5.2.2.2.2"><apply id="S4.p2.5.m5.1.1.1.1.1.cmml" xref="S4.p2.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.5.m5.1.1.1.1.1.1.cmml" xref="S4.p2.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S4.p2.5.m5.1.1.1.1.1.2.cmml" xref="S4.p2.5.m5.1.1.1.1.1.2">𝐩</ci><ci id="S4.p2.5.m5.1.1.1.1.1.3.cmml" xref="S4.p2.5.m5.1.1.1.1.1.3">𝐢𝐧</ci></apply><apply id="S4.p2.5.m5.2.2.2.2.2.cmml" xref="S4.p2.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p2.5.m5.2.2.2.2.2.1.cmml" xref="S4.p2.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S4.p2.5.m5.2.2.2.2.2.2.cmml" xref="S4.p2.5.m5.2.2.2.2.2.2">𝐝</ci><ci id="S4.p2.5.m5.2.2.2.2.2.3.cmml" xref="S4.p2.5.m5.2.2.2.2.2.3">𝐢𝐧</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.2c">r_{in}=(\mathbf{p_{in}},\mathbf{d_{in}})</annotation></semantics></math> and <math id="S4.p2.6.m6.2" class="ltx_Math" alttext="r_{out}=(\mathbf{p_{out}},\mathbf{d_{out}})" display="inline"><semantics id="S4.p2.6.m6.2a"><mrow id="S4.p2.6.m6.2.2" xref="S4.p2.6.m6.2.2.cmml"><msub id="S4.p2.6.m6.2.2.4" xref="S4.p2.6.m6.2.2.4.cmml"><mi id="S4.p2.6.m6.2.2.4.2" xref="S4.p2.6.m6.2.2.4.2.cmml">r</mi><mrow id="S4.p2.6.m6.2.2.4.3" xref="S4.p2.6.m6.2.2.4.3.cmml"><mi id="S4.p2.6.m6.2.2.4.3.2" xref="S4.p2.6.m6.2.2.4.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.p2.6.m6.2.2.4.3.1" xref="S4.p2.6.m6.2.2.4.3.1.cmml">​</mo><mi id="S4.p2.6.m6.2.2.4.3.3" xref="S4.p2.6.m6.2.2.4.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.p2.6.m6.2.2.4.3.1a" xref="S4.p2.6.m6.2.2.4.3.1.cmml">​</mo><mi id="S4.p2.6.m6.2.2.4.3.4" xref="S4.p2.6.m6.2.2.4.3.4.cmml">t</mi></mrow></msub><mo id="S4.p2.6.m6.2.2.3" xref="S4.p2.6.m6.2.2.3.cmml">=</mo><mrow id="S4.p2.6.m6.2.2.2.2" xref="S4.p2.6.m6.2.2.2.3.cmml"><mo stretchy="false" id="S4.p2.6.m6.2.2.2.2.3" xref="S4.p2.6.m6.2.2.2.3.cmml">(</mo><msub id="S4.p2.6.m6.1.1.1.1.1" xref="S4.p2.6.m6.1.1.1.1.1.cmml"><mi id="S4.p2.6.m6.1.1.1.1.1.2" xref="S4.p2.6.m6.1.1.1.1.1.2.cmml">𝐩</mi><mi id="S4.p2.6.m6.1.1.1.1.1.3" xref="S4.p2.6.m6.1.1.1.1.1.3.cmml">𝐨𝐮𝐭</mi></msub><mo id="S4.p2.6.m6.2.2.2.2.4" xref="S4.p2.6.m6.2.2.2.3.cmml">,</mo><msub id="S4.p2.6.m6.2.2.2.2.2" xref="S4.p2.6.m6.2.2.2.2.2.cmml"><mi id="S4.p2.6.m6.2.2.2.2.2.2" xref="S4.p2.6.m6.2.2.2.2.2.2.cmml">𝐝</mi><mi id="S4.p2.6.m6.2.2.2.2.2.3" xref="S4.p2.6.m6.2.2.2.2.2.3.cmml">𝐨𝐮𝐭</mi></msub><mo stretchy="false" id="S4.p2.6.m6.2.2.2.2.5" xref="S4.p2.6.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.2b"><apply id="S4.p2.6.m6.2.2.cmml" xref="S4.p2.6.m6.2.2"><eq id="S4.p2.6.m6.2.2.3.cmml" xref="S4.p2.6.m6.2.2.3"></eq><apply id="S4.p2.6.m6.2.2.4.cmml" xref="S4.p2.6.m6.2.2.4"><csymbol cd="ambiguous" id="S4.p2.6.m6.2.2.4.1.cmml" xref="S4.p2.6.m6.2.2.4">subscript</csymbol><ci id="S4.p2.6.m6.2.2.4.2.cmml" xref="S4.p2.6.m6.2.2.4.2">𝑟</ci><apply id="S4.p2.6.m6.2.2.4.3.cmml" xref="S4.p2.6.m6.2.2.4.3"><times id="S4.p2.6.m6.2.2.4.3.1.cmml" xref="S4.p2.6.m6.2.2.4.3.1"></times><ci id="S4.p2.6.m6.2.2.4.3.2.cmml" xref="S4.p2.6.m6.2.2.4.3.2">𝑜</ci><ci id="S4.p2.6.m6.2.2.4.3.3.cmml" xref="S4.p2.6.m6.2.2.4.3.3">𝑢</ci><ci id="S4.p2.6.m6.2.2.4.3.4.cmml" xref="S4.p2.6.m6.2.2.4.3.4">𝑡</ci></apply></apply><interval closure="open" id="S4.p2.6.m6.2.2.2.3.cmml" xref="S4.p2.6.m6.2.2.2.2"><apply id="S4.p2.6.m6.1.1.1.1.1.cmml" xref="S4.p2.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.6.m6.1.1.1.1.1.1.cmml" xref="S4.p2.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S4.p2.6.m6.1.1.1.1.1.2.cmml" xref="S4.p2.6.m6.1.1.1.1.1.2">𝐩</ci><ci id="S4.p2.6.m6.1.1.1.1.1.3.cmml" xref="S4.p2.6.m6.1.1.1.1.1.3">𝐨𝐮𝐭</ci></apply><apply id="S4.p2.6.m6.2.2.2.2.2.cmml" xref="S4.p2.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p2.6.m6.2.2.2.2.2.1.cmml" xref="S4.p2.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S4.p2.6.m6.2.2.2.2.2.2.cmml" xref="S4.p2.6.m6.2.2.2.2.2.2">𝐝</ci><ci id="S4.p2.6.m6.2.2.2.2.2.3.cmml" xref="S4.p2.6.m6.2.2.2.2.2.3">𝐨𝐮𝐭</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.2c">r_{out}=(\mathbf{p_{out}},\mathbf{d_{out}})</annotation></semantics></math>. Therefore, to determine the exact location of the muon deflection, PoCA solves a system of equations given by the parametric equation of points on straight lines, <math id="S4.p2.7.m7.1" class="ltx_Math" alttext="P=\mathbf{p}+t\mathbf{d}" display="inline"><semantics id="S4.p2.7.m7.1a"><mrow id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml"><mi id="S4.p2.7.m7.1.1.2" xref="S4.p2.7.m7.1.1.2.cmml">P</mi><mo id="S4.p2.7.m7.1.1.1" xref="S4.p2.7.m7.1.1.1.cmml">=</mo><mrow id="S4.p2.7.m7.1.1.3" xref="S4.p2.7.m7.1.1.3.cmml"><mi id="S4.p2.7.m7.1.1.3.2" xref="S4.p2.7.m7.1.1.3.2.cmml">𝐩</mi><mo id="S4.p2.7.m7.1.1.3.1" xref="S4.p2.7.m7.1.1.3.1.cmml">+</mo><mrow id="S4.p2.7.m7.1.1.3.3" xref="S4.p2.7.m7.1.1.3.3.cmml"><mi id="S4.p2.7.m7.1.1.3.3.2" xref="S4.p2.7.m7.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p2.7.m7.1.1.3.3.1" xref="S4.p2.7.m7.1.1.3.3.1.cmml">​</mo><mi id="S4.p2.7.m7.1.1.3.3.3" xref="S4.p2.7.m7.1.1.3.3.3.cmml">𝐝</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><apply id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1"><eq id="S4.p2.7.m7.1.1.1.cmml" xref="S4.p2.7.m7.1.1.1"></eq><ci id="S4.p2.7.m7.1.1.2.cmml" xref="S4.p2.7.m7.1.1.2">𝑃</ci><apply id="S4.p2.7.m7.1.1.3.cmml" xref="S4.p2.7.m7.1.1.3"><plus id="S4.p2.7.m7.1.1.3.1.cmml" xref="S4.p2.7.m7.1.1.3.1"></plus><ci id="S4.p2.7.m7.1.1.3.2.cmml" xref="S4.p2.7.m7.1.1.3.2">𝐩</ci><apply id="S4.p2.7.m7.1.1.3.3.cmml" xref="S4.p2.7.m7.1.1.3.3"><times id="S4.p2.7.m7.1.1.3.3.1.cmml" xref="S4.p2.7.m7.1.1.3.3.1"></times><ci id="S4.p2.7.m7.1.1.3.3.2.cmml" xref="S4.p2.7.m7.1.1.3.3.2">𝑡</ci><ci id="S4.p2.7.m7.1.1.3.3.3.cmml" xref="S4.p2.7.m7.1.1.3.3.3">𝐝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">P=\mathbf{p}+t\mathbf{d}</annotation></semantics></math>, being <math id="S4.p2.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.p2.8.m8.1a"><mi id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.1b"><ci id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">t</annotation></semantics></math>, the variation parameter. Formally, this system of equations can be written as:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.1" class="ltx_math_unparsed" alttext="\left\{\begin{aligned} &amp;\phantom{}P_{in}=\mathbf{p_{in}}+t_{in}\mathbf{d_{in}}\\
&amp;\phantom{}P_{out}=\mathbf{p_{out}}+t_{out}\mathbf{d_{out}}\\
&amp;\overrightarrow{P_{in}P_{out}}\cdot\mathbf{d_{in}}=0\\
&amp;\overrightarrow{P_{in}P_{out}}\cdot\mathbf{d_{out}}=0\end{aligned}\right." display="block"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1b"><mo id="S4.E1.m1.1.1">{</mo><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E1.m1.1.2"><mtr id="S4.E1.m1.1.2a"><mtd id="S4.E1.m1.1.2b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.1.2c"><mrow id="S4.E1.m1.1.2.1.2.1"><msub id="S4.E1.m1.1.2.1.2.1.2"><mi id="S4.E1.m1.1.2.1.2.1.2.2">P</mi><mrow id="S4.E1.m1.1.2.1.2.1.2.3"><mi id="S4.E1.m1.1.2.1.2.1.2.3.2">i</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.1.2.1.2.3.1">​</mo><mi id="S4.E1.m1.1.2.1.2.1.2.3.3">n</mi></mrow></msub><mo id="S4.E1.m1.1.2.1.2.1.1">=</mo><mrow id="S4.E1.m1.1.2.1.2.1.3"><msub id="S4.E1.m1.1.2.1.2.1.3.2"><mi id="S4.E1.m1.1.2.1.2.1.3.2.2">𝐩</mi><mi id="S4.E1.m1.1.2.1.2.1.3.2.3">𝐢𝐧</mi></msub><mo id="S4.E1.m1.1.2.1.2.1.3.1">+</mo><mrow id="S4.E1.m1.1.2.1.2.1.3.3"><msub id="S4.E1.m1.1.2.1.2.1.3.3.2"><mi id="S4.E1.m1.1.2.1.2.1.3.3.2.2">t</mi><mrow id="S4.E1.m1.1.2.1.2.1.3.3.2.3"><mi id="S4.E1.m1.1.2.1.2.1.3.3.2.3.2">i</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.1.2.1.3.3.2.3.1">​</mo><mi id="S4.E1.m1.1.2.1.2.1.3.3.2.3.3">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.1.2.1.3.3.1">​</mo><msub id="S4.E1.m1.1.2.1.2.1.3.3.3"><mi id="S4.E1.m1.1.2.1.2.1.3.3.3.2">𝐝</mi><mi id="S4.E1.m1.1.2.1.2.1.3.3.3.3">𝐢𝐧</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E1.m1.1.2d"><mtd id="S4.E1.m1.1.2e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.1.2f"><mrow id="S4.E1.m1.1.2.2.2.1"><msub id="S4.E1.m1.1.2.2.2.1.2"><mi id="S4.E1.m1.1.2.2.2.1.2.2">P</mi><mrow id="S4.E1.m1.1.2.2.2.1.2.3"><mi id="S4.E1.m1.1.2.2.2.1.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.2.2.1.2.3.1">​</mo><mi id="S4.E1.m1.1.2.2.2.1.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.2.2.1.2.3.1a">​</mo><mi id="S4.E1.m1.1.2.2.2.1.2.3.4">t</mi></mrow></msub><mo id="S4.E1.m1.1.2.2.2.1.1">=</mo><mrow id="S4.E1.m1.1.2.2.2.1.3"><msub id="S4.E1.m1.1.2.2.2.1.3.2"><mi id="S4.E1.m1.1.2.2.2.1.3.2.2">𝐩</mi><mi id="S4.E1.m1.1.2.2.2.1.3.2.3">𝐨𝐮𝐭</mi></msub><mo id="S4.E1.m1.1.2.2.2.1.3.1">+</mo><mrow id="S4.E1.m1.1.2.2.2.1.3.3"><msub id="S4.E1.m1.1.2.2.2.1.3.3.2"><mi id="S4.E1.m1.1.2.2.2.1.3.3.2.2">t</mi><mrow id="S4.E1.m1.1.2.2.2.1.3.3.2.3"><mi id="S4.E1.m1.1.2.2.2.1.3.3.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.2.2.1.3.3.2.3.1">​</mo><mi id="S4.E1.m1.1.2.2.2.1.3.3.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.2.2.1.3.3.2.3.1a">​</mo><mi id="S4.E1.m1.1.2.2.2.1.3.3.2.3.4">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.2.2.1.3.3.1">​</mo><msub id="S4.E1.m1.1.2.2.2.1.3.3.3"><mi id="S4.E1.m1.1.2.2.2.1.3.3.3.2">𝐝</mi><mi id="S4.E1.m1.1.2.2.2.1.3.3.3.3">𝐨𝐮𝐭</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E1.m1.1.2g"><mtd id="S4.E1.m1.1.2h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.1.2i"><mrow id="S4.E1.m1.1.2.3.2.1"><mrow id="S4.E1.m1.1.2.3.2.1.2"><mover accent="true" id="S4.E1.m1.1.2.3.2.1.2.2"><mrow id="S4.E1.m1.1.2.3.2.1.2.2.2"><msub id="S4.E1.m1.1.2.3.2.1.2.2.2.2"><mi id="S4.E1.m1.1.2.3.2.1.2.2.2.2.2">P</mi><mrow id="S4.E1.m1.1.2.3.2.1.2.2.2.2.3"><mi id="S4.E1.m1.1.2.3.2.1.2.2.2.2.3.2">i</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.3.2.1.2.2.2.2.3.1">​</mo><mi id="S4.E1.m1.1.2.3.2.1.2.2.2.2.3.3">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.3.2.1.2.2.2.1">​</mo><msub id="S4.E1.m1.1.2.3.2.1.2.2.2.3"><mi id="S4.E1.m1.1.2.3.2.1.2.2.2.3.2">P</mi><mrow id="S4.E1.m1.1.2.3.2.1.2.2.2.3.3"><mi id="S4.E1.m1.1.2.3.2.1.2.2.2.3.3.2">o</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.3.2.1.2.2.2.3.3.1">​</mo><mi id="S4.E1.m1.1.2.3.2.1.2.2.2.3.3.3">u</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.3.2.1.2.2.2.3.3.1a">​</mo><mi id="S4.E1.m1.1.2.3.2.1.2.2.2.3.3.4">t</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E1.m1.1.2.3.2.1.2.2.1">→</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S4.E1.m1.1.2.3.2.1.2.1">⋅</mo><msub id="S4.E1.m1.1.2.3.2.1.2.3"><mi id="S4.E1.m1.1.2.3.2.1.2.3.2">𝐝</mi><mi id="S4.E1.m1.1.2.3.2.1.2.3.3">𝐢𝐧</mi></msub></mrow><mo id="S4.E1.m1.1.2.3.2.1.1">=</mo><mn id="S4.E1.m1.1.2.3.2.1.3">0</mn></mrow></mtd></mtr><mtr id="S4.E1.m1.1.2j"><mtd id="S4.E1.m1.1.2k"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.1.2l"><mrow id="S4.E1.m1.1.2.4.2.1"><mrow id="S4.E1.m1.1.2.4.2.1.2"><mover accent="true" id="S4.E1.m1.1.2.4.2.1.2.2"><mrow id="S4.E1.m1.1.2.4.2.1.2.2.2"><msub id="S4.E1.m1.1.2.4.2.1.2.2.2.2"><mi id="S4.E1.m1.1.2.4.2.1.2.2.2.2.2">P</mi><mrow id="S4.E1.m1.1.2.4.2.1.2.2.2.2.3"><mi id="S4.E1.m1.1.2.4.2.1.2.2.2.2.3.2">i</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.4.2.1.2.2.2.2.3.1">​</mo><mi id="S4.E1.m1.1.2.4.2.1.2.2.2.2.3.3">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.4.2.1.2.2.2.1">​</mo><msub id="S4.E1.m1.1.2.4.2.1.2.2.2.3"><mi id="S4.E1.m1.1.2.4.2.1.2.2.2.3.2">P</mi><mrow id="S4.E1.m1.1.2.4.2.1.2.2.2.3.3"><mi id="S4.E1.m1.1.2.4.2.1.2.2.2.3.3.2">o</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.4.2.1.2.2.2.3.3.1">​</mo><mi id="S4.E1.m1.1.2.4.2.1.2.2.2.3.3.3">u</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.2.4.2.1.2.2.2.3.3.1a">​</mo><mi id="S4.E1.m1.1.2.4.2.1.2.2.2.3.3.4">t</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E1.m1.1.2.4.2.1.2.2.1">→</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S4.E1.m1.1.2.4.2.1.2.1">⋅</mo><msub id="S4.E1.m1.1.2.4.2.1.2.3"><mi id="S4.E1.m1.1.2.4.2.1.2.3.2">𝐝</mi><mi id="S4.E1.m1.1.2.4.2.1.2.3.3">𝐨𝐮𝐭</mi></msub></mrow><mo id="S4.E1.m1.1.2.4.2.1.1">=</mo><mn id="S4.E1.m1.1.2.4.2.1.3">0</mn></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\left\{\begin{aligned} &amp;\phantom{}P_{in}=\mathbf{p_{in}}+t_{in}\mathbf{d_{in}}\\
&amp;\phantom{}P_{out}=\mathbf{p_{out}}+t_{out}\mathbf{d_{out}}\\
&amp;\overrightarrow{P_{in}P_{out}}\cdot\mathbf{d_{in}}=0\\
&amp;\overrightarrow{P_{in}P_{out}}\cdot\mathbf{d_{out}}=0\end{aligned}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.4" class="ltx_p">Once the PoCA point from both trajectories has been estimated, the muon path is constructed, and voxels crossed by this path will be considered possible candidates influencing the muon trajectory. Then, an information signal (or score) for the muon path, noted as <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">s</annotation></semantics></math>, proportional to the scattering angle <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.p3.2.m2.1a"><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">\theta</annotation></semantics></math>, is assigned to the voxel associated with the estimated PoCA point. B2G4 applies noise reduction by rejecting extreme angles, then computes the median for each voxel to generate the 3D scattering density map for all muon tracks. While PoCA is efficient and fast, it oversimplifies the 3D representation by assuming single-point scattering and thus neglects scattering across adjacent voxels. Conversely, ASR assigns values to neighboring voxels by defining a distance <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="D_{r}" display="inline"><semantics id="S4.p3.3.m3.1a"><msub id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">D</mi><mi id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1">subscript</csymbol><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝐷</ci><ci id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">D_{r}</annotation></semantics></math>, between the center of a voxel <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.p3.4.m4.1a"><mi id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><ci id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">c</annotation></semantics></math> and the incident/emergent muon trajectories::</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.3" class="ltx_Math" alttext="D_{r}=\max\left(\min_{t_{in}}\left|\left|P_{in}(t_{in})-c\right|\right|\,,\,\min_{t_{out}}\left|\left|P_{out}(t_{out})-c\right|\right|\right)" display="block"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml"><msub id="S4.E2.m1.3.3.4" xref="S4.E2.m1.3.3.4.cmml"><mi id="S4.E2.m1.3.3.4.2" xref="S4.E2.m1.3.3.4.2.cmml">D</mi><mi id="S4.E2.m1.3.3.4.3" xref="S4.E2.m1.3.3.4.3.cmml">r</mi></msub><mo id="S4.E2.m1.3.3.3" xref="S4.E2.m1.3.3.3.cmml">=</mo><mrow id="S4.E2.m1.3.3.2.2" xref="S4.E2.m1.3.3.2.3.cmml"><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">max</mi><mo id="S4.E2.m1.3.3.2.2a" xref="S4.E2.m1.3.3.2.3.cmml">⁡</mo><mrow id="S4.E2.m1.3.3.2.2.2" xref="S4.E2.m1.3.3.2.3.cmml"><mo id="S4.E2.m1.3.3.2.2.2.3" xref="S4.E2.m1.3.3.2.3.cmml">(</mo><mrow id="S4.E2.m1.2.2.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.cmml"><munder id="S4.E2.m1.2.2.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.3.2" xref="S4.E2.m1.2.2.1.1.1.1.3.2.cmml">min</mi><msub id="S4.E2.m1.2.2.1.1.1.1.3.3" xref="S4.E2.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.3.3.2" xref="S4.E2.m1.2.2.1.1.1.1.3.3.2.cmml">t</mi><mrow id="S4.E2.m1.2.2.1.1.1.1.3.3.3" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.3.3.3.2" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.3.3.3.1" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E2.m1.2.2.1.1.1.1.3.3.3.3" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3.3.cmml">n</mi></mrow></msub></munder><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">P</mi><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">−</mo><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo rspace="0.337em" id="S4.E2.m1.3.3.2.2.2.4" xref="S4.E2.m1.3.3.2.3.cmml">,</mo><mrow id="S4.E2.m1.3.3.2.2.2.2" xref="S4.E2.m1.3.3.2.2.2.2.cmml"><munder id="S4.E2.m1.3.3.2.2.2.2.3" xref="S4.E2.m1.3.3.2.2.2.2.3.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.3.2" xref="S4.E2.m1.3.3.2.2.2.2.3.2.cmml">min</mi><msub id="S4.E2.m1.3.3.2.2.2.2.3.3" xref="S4.E2.m1.3.3.2.2.2.2.3.3.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.3.3.2" xref="S4.E2.m1.3.3.2.2.2.2.3.3.2.cmml">t</mi><mrow id="S4.E2.m1.3.3.2.2.2.2.3.3.3" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.3.3.3.2" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.3.3.3.1" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.1.cmml">​</mo><mi id="S4.E2.m1.3.3.2.2.2.2.3.3.3.3" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.3.3.3.1a" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.1.cmml">​</mo><mi id="S4.E2.m1.3.3.2.2.2.2.3.3.3.4" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.4.cmml">t</mi></mrow></msub></munder><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.2" xref="S4.E2.m1.3.3.2.2.2.2.2.cmml">​</mo><mrow id="S4.E2.m1.3.3.2.2.2.2.1.1" xref="S4.E2.m1.3.3.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.2.2.2.2.1.1.2" xref="S4.E2.m1.3.3.2.2.2.2.1.2.1.cmml">‖</mo><mrow id="S4.E2.m1.3.3.2.2.2.2.1.1.1" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.cmml"><mrow id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.cmml"><msub id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.2" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.2.cmml">P</mi><mrow id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.2" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.1" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.3" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.1a" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.4" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.2" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2.cmml">t</mi><mrow id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.1a" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.4" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.4.cmml">t</mi></mrow></msub><mo stretchy="false" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.3.2.2.2.2.1.1.1.2" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.2.cmml">−</mo><mi id="S4.E2.m1.3.3.2.2.2.2.1.1.1.3" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.E2.m1.3.3.2.2.2.2.1.1.3" xref="S4.E2.m1.3.3.2.2.2.2.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S4.E2.m1.3.3.2.2.2.5" xref="S4.E2.m1.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3"><eq id="S4.E2.m1.3.3.3.cmml" xref="S4.E2.m1.3.3.3"></eq><apply id="S4.E2.m1.3.3.4.cmml" xref="S4.E2.m1.3.3.4"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.4.1.cmml" xref="S4.E2.m1.3.3.4">subscript</csymbol><ci id="S4.E2.m1.3.3.4.2.cmml" xref="S4.E2.m1.3.3.4.2">𝐷</ci><ci id="S4.E2.m1.3.3.4.3.cmml" xref="S4.E2.m1.3.3.4.3">𝑟</ci></apply><apply id="S4.E2.m1.3.3.2.3.cmml" xref="S4.E2.m1.3.3.2.2"><max id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"></max><apply id="S4.E2.m1.2.2.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1"><times id="S4.E2.m1.2.2.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.2"></times><apply id="S4.E2.m1.2.2.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3">subscript</csymbol><min id="S4.E2.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.2"></min><apply id="S4.E2.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.3.2">𝑡</ci><apply id="S4.E2.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3"><times id="S4.E2.m1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3.1"></times><ci id="S4.E2.m1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3.2">𝑖</ci><ci id="S4.E2.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.3.3.3.3">𝑛</ci></apply></apply></apply><apply id="S4.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1"><minus id="S4.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.2"></minus><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑃</ci><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3"><times id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑡</ci><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply><apply id="S4.E2.m1.3.3.2.2.2.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2"><times id="S4.E2.m1.3.3.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.2"></times><apply id="S4.E2.m1.3.3.2.2.2.2.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.2.2.3.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3">subscript</csymbol><min id="S4.E2.m1.3.3.2.2.2.2.3.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.2"></min><apply id="S4.E2.m1.3.3.2.2.2.2.3.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.2.2.3.3.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.2.2.3.3.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3.2">𝑡</ci><apply id="S4.E2.m1.3.3.2.2.2.2.3.3.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3"><times id="S4.E2.m1.3.3.2.2.2.2.3.3.3.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.1"></times><ci id="S4.E2.m1.3.3.2.2.2.2.3.3.3.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.2">𝑜</ci><ci id="S4.E2.m1.3.3.2.2.2.2.3.3.3.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.3">𝑢</ci><ci id="S4.E2.m1.3.3.2.2.2.2.3.3.3.4.cmml" xref="S4.E2.m1.3.3.2.2.2.2.3.3.3.4">𝑡</ci></apply></apply></apply><apply id="S4.E2.m1.3.3.2.2.2.2.1.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.E2.m1.3.3.2.2.2.2.1.2.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.2">norm</csymbol><apply id="S4.E2.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1"><minus id="S4.E2.m1.3.3.2.2.2.2.1.1.1.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.2"></minus><apply id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1"><times id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.2"></times><apply id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.2">𝑃</ci><apply id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3"><times id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.1"></times><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.2">𝑜</ci><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.3">𝑢</ci><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.4.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.2">𝑡</ci><apply id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3"><times id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.2">𝑜</ci><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.3">𝑢</ci><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.3.4">𝑡</ci></apply></apply></apply><ci id="S4.E2.m1.3.3.2.2.2.2.1.1.1.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">D_{r}=\max\left(\min_{t_{in}}\left|\left|P_{in}(t_{in})-c\right|\right|\,,\,\min_{t_{out}}\left|\left|P_{out}(t_{out})-c\right|\right|\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.6" class="ltx_p">with <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="P_{in}" display="inline"><semantics id="S4.p4.1.m1.1a"><msub id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mi id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">P</mi><mrow id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3.cmml"><mi id="S4.p4.1.m1.1.1.3.2" xref="S4.p4.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.p4.1.m1.1.1.3.1" xref="S4.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.p4.1.m1.1.1.3.3" xref="S4.p4.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1">subscript</csymbol><ci id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2">𝑃</ci><apply id="S4.p4.1.m1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.3"><times id="S4.p4.1.m1.1.1.3.1.cmml" xref="S4.p4.1.m1.1.1.3.1"></times><ci id="S4.p4.1.m1.1.1.3.2.cmml" xref="S4.p4.1.m1.1.1.3.2">𝑖</ci><ci id="S4.p4.1.m1.1.1.3.3.cmml" xref="S4.p4.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">P_{in}</annotation></semantics></math> and <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="P_{out}" display="inline"><semantics id="S4.p4.2.m2.1a"><msub id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><mi id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml">P</mi><mrow id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml"><mi id="S4.p4.2.m2.1.1.3.2" xref="S4.p4.2.m2.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.p4.2.m2.1.1.3.1" xref="S4.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.p4.2.m2.1.1.3.3" xref="S4.p4.2.m2.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.p4.2.m2.1.1.3.1a" xref="S4.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.p4.2.m2.1.1.3.4" xref="S4.p4.2.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1">subscript</csymbol><ci id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2">𝑃</ci><apply id="S4.p4.2.m2.1.1.3.cmml" xref="S4.p4.2.m2.1.1.3"><times id="S4.p4.2.m2.1.1.3.1.cmml" xref="S4.p4.2.m2.1.1.3.1"></times><ci id="S4.p4.2.m2.1.1.3.2.cmml" xref="S4.p4.2.m2.1.1.3.2">𝑜</ci><ci id="S4.p4.2.m2.1.1.3.3.cmml" xref="S4.p4.2.m2.1.1.3.3">𝑢</ci><ci id="S4.p4.2.m2.1.1.3.4.cmml" xref="S4.p4.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">P_{out}</annotation></semantics></math> the parametric muon paths from equation <a href="#S4.E1" title="In 4 Muon scattering tomography with B2G4 ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The value of <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="D_{r}" display="inline"><semantics id="S4.p4.3.m3.1a"><msub id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml">D</mi><mi id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1">subscript</csymbol><ci id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">𝐷</ci><ci id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">D_{r}</annotation></semantics></math> is compared with a threshold distance <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.p4.4.m4.1a"><mi id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><ci id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">d</annotation></semantics></math>: voxels that fulfill the condition <math id="S4.p4.5.m5.1" class="ltx_Math" alttext="D_{r}&lt;d" display="inline"><semantics id="S4.p4.5.m5.1a"><mrow id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml"><msub id="S4.p4.5.m5.1.1.2" xref="S4.p4.5.m5.1.1.2.cmml"><mi id="S4.p4.5.m5.1.1.2.2" xref="S4.p4.5.m5.1.1.2.2.cmml">D</mi><mi id="S4.p4.5.m5.1.1.2.3" xref="S4.p4.5.m5.1.1.2.3.cmml">r</mi></msub><mo id="S4.p4.5.m5.1.1.1" xref="S4.p4.5.m5.1.1.1.cmml">&lt;</mo><mi id="S4.p4.5.m5.1.1.3" xref="S4.p4.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><apply id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1"><lt id="S4.p4.5.m5.1.1.1.cmml" xref="S4.p4.5.m5.1.1.1"></lt><apply id="S4.p4.5.m5.1.1.2.cmml" xref="S4.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.p4.5.m5.1.1.2.1.cmml" xref="S4.p4.5.m5.1.1.2">subscript</csymbol><ci id="S4.p4.5.m5.1.1.2.2.cmml" xref="S4.p4.5.m5.1.1.2.2">𝐷</ci><ci id="S4.p4.5.m5.1.1.2.3.cmml" xref="S4.p4.5.m5.1.1.2.3">𝑟</ci></apply><ci id="S4.p4.5.m5.1.1.3.cmml" xref="S4.p4.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">D_{r}&lt;d</annotation></semantics></math> are activated. The threshold value <math id="S4.p4.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.p4.6.m6.1a"><mi id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><ci id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">d</annotation></semantics></math> ensures that at least one voxel for each incoming and emergent track pair is activated as a potential candidate affecting the muon trajectory. The resulting 3D scattering density maps in ASR incorporate contextual information from neighboring voxels, providing a more refined and robust representation compared to PoCA. 
<br class="ltx_break"></p>
</div>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.2" class="ltx_p">Figure <a href="#S3.F4" title="Figure 4 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates a simplified design of a steel cargo container (<math id="S4.p5.1.m1.1" class="ltx_Math" alttext="G4\_STAINLESS-STEEL" display="inline"><semantics id="S4.p5.1.m1.1a"><mrow id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml"><mrow id="S4.p5.1.m1.1.1.2" xref="S4.p5.1.m1.1.1.2.cmml"><mi id="S4.p5.1.m1.1.1.2.2" xref="S4.p5.1.m1.1.1.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mn id="S4.p5.1.m1.1.1.2.3" xref="S4.p5.1.m1.1.1.2.3.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1a" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="S4.p5.1.m1.1.1.2.4" xref="S4.p5.1.m1.1.1.2.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1b" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.5" xref="S4.p5.1.m1.1.1.2.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1c" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.6" xref="S4.p5.1.m1.1.1.2.6.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1d" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.7" xref="S4.p5.1.m1.1.1.2.7.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1e" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.8" xref="S4.p5.1.m1.1.1.2.8.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1f" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.9" xref="S4.p5.1.m1.1.1.2.9.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1g" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.10" xref="S4.p5.1.m1.1.1.2.10.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1h" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.11" xref="S4.p5.1.m1.1.1.2.11.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1i" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.12" xref="S4.p5.1.m1.1.1.2.12.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.2.1j" xref="S4.p5.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.2.13" xref="S4.p5.1.m1.1.1.2.13.cmml">S</mi></mrow><mo id="S4.p5.1.m1.1.1.1" xref="S4.p5.1.m1.1.1.1.cmml">−</mo><mrow id="S4.p5.1.m1.1.1.3" xref="S4.p5.1.m1.1.1.3.cmml"><mi id="S4.p5.1.m1.1.1.3.2" xref="S4.p5.1.m1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.3.1" xref="S4.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.3.3" xref="S4.p5.1.m1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.3.1a" xref="S4.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.3.4" xref="S4.p5.1.m1.1.1.3.4.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.3.1b" xref="S4.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.3.5" xref="S4.p5.1.m1.1.1.3.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.p5.1.m1.1.1.3.1c" xref="S4.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.p5.1.m1.1.1.3.6" xref="S4.p5.1.m1.1.1.3.6.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><apply id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1"><minus id="S4.p5.1.m1.1.1.1.cmml" xref="S4.p5.1.m1.1.1.1"></minus><apply id="S4.p5.1.m1.1.1.2.cmml" xref="S4.p5.1.m1.1.1.2"><times id="S4.p5.1.m1.1.1.2.1.cmml" xref="S4.p5.1.m1.1.1.2.1"></times><ci id="S4.p5.1.m1.1.1.2.2.cmml" xref="S4.p5.1.m1.1.1.2.2">𝐺</ci><cn type="integer" id="S4.p5.1.m1.1.1.2.3.cmml" xref="S4.p5.1.m1.1.1.2.3">4</cn><ci id="S4.p5.1.m1.1.1.2.4.cmml" xref="S4.p5.1.m1.1.1.2.4">_</ci><ci id="S4.p5.1.m1.1.1.2.5.cmml" xref="S4.p5.1.m1.1.1.2.5">𝑆</ci><ci id="S4.p5.1.m1.1.1.2.6.cmml" xref="S4.p5.1.m1.1.1.2.6">𝑇</ci><ci id="S4.p5.1.m1.1.1.2.7.cmml" xref="S4.p5.1.m1.1.1.2.7">𝐴</ci><ci id="S4.p5.1.m1.1.1.2.8.cmml" xref="S4.p5.1.m1.1.1.2.8">𝐼</ci><ci id="S4.p5.1.m1.1.1.2.9.cmml" xref="S4.p5.1.m1.1.1.2.9">𝑁</ci><ci id="S4.p5.1.m1.1.1.2.10.cmml" xref="S4.p5.1.m1.1.1.2.10">𝐿</ci><ci id="S4.p5.1.m1.1.1.2.11.cmml" xref="S4.p5.1.m1.1.1.2.11">𝐸</ci><ci id="S4.p5.1.m1.1.1.2.12.cmml" xref="S4.p5.1.m1.1.1.2.12">𝑆</ci><ci id="S4.p5.1.m1.1.1.2.13.cmml" xref="S4.p5.1.m1.1.1.2.13">𝑆</ci></apply><apply id="S4.p5.1.m1.1.1.3.cmml" xref="S4.p5.1.m1.1.1.3"><times id="S4.p5.1.m1.1.1.3.1.cmml" xref="S4.p5.1.m1.1.1.3.1"></times><ci id="S4.p5.1.m1.1.1.3.2.cmml" xref="S4.p5.1.m1.1.1.3.2">𝑆</ci><ci id="S4.p5.1.m1.1.1.3.3.cmml" xref="S4.p5.1.m1.1.1.3.3">𝑇</ci><ci id="S4.p5.1.m1.1.1.3.4.cmml" xref="S4.p5.1.m1.1.1.3.4">𝐸</ci><ci id="S4.p5.1.m1.1.1.3.5.cmml" xref="S4.p5.1.m1.1.1.3.5">𝐸</ci><ci id="S4.p5.1.m1.1.1.3.6.cmml" xref="S4.p5.1.m1.1.1.3.6">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">G4\_STAINLESS-STEEL</annotation></semantics></math>) with a leaden monkey head inside (<math id="S4.p5.2.m2.1" class="ltx_Math" alttext="G4\_Pb" display="inline"><semantics id="S4.p5.2.m2.1a"><mrow id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml"><mi id="S4.p5.2.m2.1.1.2" xref="S4.p5.2.m2.1.1.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.p5.2.m2.1.1.1" xref="S4.p5.2.m2.1.1.1.cmml">​</mo><mn id="S4.p5.2.m2.1.1.3" xref="S4.p5.2.m2.1.1.3.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.p5.2.m2.1.1.1a" xref="S4.p5.2.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.p5.2.m2.1.1.4" xref="S4.p5.2.m2.1.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.p5.2.m2.1.1.1b" xref="S4.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.p5.2.m2.1.1.5" xref="S4.p5.2.m2.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.p5.2.m2.1.1.1c" xref="S4.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.p5.2.m2.1.1.6" xref="S4.p5.2.m2.1.1.6.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><apply id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1"><times id="S4.p5.2.m2.1.1.1.cmml" xref="S4.p5.2.m2.1.1.1"></times><ci id="S4.p5.2.m2.1.1.2.cmml" xref="S4.p5.2.m2.1.1.2">𝐺</ci><cn type="integer" id="S4.p5.2.m2.1.1.3.cmml" xref="S4.p5.2.m2.1.1.3">4</cn><ci id="S4.p5.2.m2.1.1.4.cmml" xref="S4.p5.2.m2.1.1.4">_</ci><ci id="S4.p5.2.m2.1.1.5.cmml" xref="S4.p5.2.m2.1.1.5">𝑃</ci><ci id="S4.p5.2.m2.1.1.6.cmml" xref="S4.p5.2.m2.1.1.6">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">G4\_Pb</annotation></semantics></math>). The container scene comprises 27,504 triangles and is exported in 0.30 seconds. Figure <a href="#S3.F4" title="Figure 4 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.(a) showcases a texture-rich model in Blender, displaying the leaden monkey head, while Figure <a href="#S3.F4" title="Figure 4 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.(b) depicts the Geant4 import. In Figure <a href="#S3.F4" title="Figure 4 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.(c), a side view of the container’s tomographic reconstruction in PoCA (up) and ASR (low) is presented. Last, Figure <a href="#S3.F4" title="Figure 4 ‣ 3 B2G4 description ‣ B2G4: A synthetic data pipeline for the integration of Blender models in Geant4 simulation toolkit" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.(d) offers a top-view perspective reconstructed with PoCA (left) and ASR (right). Both methods show detailed facets of the monkey head, including ears, chin, and overall shape. However, while PoCA introduces noise due to its single-point scattering assumption, ASR offers a noise-resistant reconstruction by comprehensively considering all potential voxel interactions in the muon path. This makes ASR a more robust method for detailed imaging, particularly in environments with complex scattering phenomena.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Scene design in Geant4 with precise geometries poses a significant challenge, particularly given the need for manual coding of high-variance scenes. This research work introduces Blender-to-Geant4 (B2G4), a holistic workflow to integrate the 3D design capabilities of Blender with the simulation finesse of Geant4. The proposed B2G4 framework streamlines the creation of corrected and annotated 3D scenes that sidestep the traditionally time-consuming scene generation process. Although B2G4 paves the way toward synthetic data generation and fast scene design, detector creation in Blender and acceleration techniques for solid importation are left for future work. We demonstrate the capabilities of B2G4 in the context of muon tomography for the imaging of concealed objects in a steel container. A specific module in B2G4 implements the reconstruction algorithms to convert simulated data into meaningful 3D scattering maps suitable for further analysis. The created scenes in B2G4 are adaptable for integration into other frameworks, whether in the context of muon tomography or other scientific disciplines that require Geant4 simulations.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conflict of Interest</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">The authors declare that there are no conflicts of interest regarding the publication of this article.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Lorenzo Bonechi, Raffaello D’Alessandro, and Andrea Giammanco.

</span>
<span class="ltx_bibblock">Atmospheric muons as an imaging tool.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Reviews in Physics</span>, 5:100038, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Sarah Barnes, Anzori Georgadze, Andrea Giammanco, Madis Kiisk, Vitaly A. Kudryavtsev, Maxime Lagrange, and Olin Lyod Pinto.

</span>
<span class="ltx_bibblock">Cosmic-ray tomography for border security.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Instruments</span>, 7(1), 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
LF Thompson, JP Stowell, SJ Fargher, CA Steer, KL Loughney, EM O’Sullivan, JG Gluyas, SW Blaney, and RJ Pidcock.

</span>
<span class="ltx_bibblock">Muon tomography for railway tunnel imaging.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Physical Review Research</span>, 2(2):023017, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Pablo Martinez Ruiz-del Arbol, Pablo Gomez Garcia, Carlos Diez Gonzalez, and Aitor Oriol Alonso.

</span>
<span class="ltx_bibblock">Non-destructive testing of industrial equipment using muon radiography.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Philosophical Transactions of the Royal Society A</span>, 377(2137):20180054, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Dan Poulson, Jeff Bacon, Matt Durham, Elena Guardincerri, CL Morris, and Holly R Trellue.

</span>
<span class="ltx_bibblock">Application of muon tomography to fuel cask monitoring.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Philosophical Transactions of the Royal Society A</span>, 377(2137):20180052, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Sea Agostinelli, John Allison, K al Amako, John Apostolakis, H Araujo, Pedro Arce, Makoto Asai, D Axen, Swagato Banerjee, GJNI Barrand, et al.

</span>
<span class="ltx_bibblock">Geant4—a simulation toolkit.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Nuclear instruments and methods in physics research section A: Accelerators, Spectrometers, Detectors and Associated Equipment</span>, 506(3):250–303, 2003.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Maximilian Pérez Prada, Sarah Barnes, and Maurice Stephan.

</span>
<span class="ltx_bibblock">Analysis of secondary particles as a complement to muon scattering measurements.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Instruments</span>, 6(4), 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Blender Foundation.

</span>
<span class="ltx_bibblock">Blender - a 3D modelling and rendering package, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
R. Chytracek, J. Mccormick, W. Pokorski, and G. Santin.

</span>
<span class="ltx_bibblock">Geometry description markup language for physics simulation and analysis applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Nuclear Science</span>, 53(5):2892–2896, 2006.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Magdalena Constantin, Dragos E Constantin, Paul J Keall, Anisha Narula, Michelle Svatos, and Joseph Perl.

</span>
<span class="ltx_bibblock">Linking computer-aided design (cad) to geant4-based monte carlo simulations for precise implementation of complex treatment head geometries.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Physics in Medicine and Biology</span>, 55(8):N211, mar 2010.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
M. Pinto and P. Gonçalves.

</span>
<span class="ltx_bibblock">Guimesh: A tool to import step geometries into geant4 via gdml.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Computer Physics Communications</span>, 239:150–156, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
C. M. Poole, I. Cornelius, J. V. Trapp, and C. M. Langton.

</span>
<span class="ltx_bibblock">A cad interface for geant4.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Australasian Physical and Engineering Sciences in Medicine</span>, 35(3):329–334, Sep 2012.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Chris Hagmann, David Lange, and Douglas Wright.

</span>
<span class="ltx_bibblock">Cosmic-ray shower generator (cry) for monte carlo transport codes.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">2007 IEEE Nuclear Science Symposium Conference Record</span>, volume 2, pages 1143–1146, 2007.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Rene Brun and Fons Rademakers.

</span>
<span class="ltx_bibblock">Root—an object oriented data analysis framework.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Nuclear instruments and methods in physics research section A: accelerators, spectrometers, detectors and associated equipment</span>, 389(1-2):81–86, 1997.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2311.06326" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2311.06327" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2311.06327">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2311.06327" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2311.06328" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 19:37:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
