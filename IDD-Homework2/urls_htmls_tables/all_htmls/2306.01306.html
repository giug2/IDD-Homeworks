<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2306.01306] Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations</title><meta property="og:description" content="In this paper, we investigate the problem of robust Reconfigurable Intelligent Surface (RIS) phase-shifts configuration over heterogeneous communication environments.
The problem is formulated as a distributed learning…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2306.01306">

<!--Generated on Thu Feb 29 01:59:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Reconfigurable Intelligent Surface (RIS),  Federated Learning,  Causal Inference,  Invariant Learning.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Charbel Bou Chaaya, Sumudu Samarakoon, and Mehdi Bennis
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Centre for Wireless Communications, University of Oulu, Finland
<br class="ltx_break">Emails: {charbel.bouchaaya, sumudu.samarakoon, mehdi.bennis}@oulu.fi
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In this paper, we investigate the problem of robust Reconfigurable Intelligent Surface (RIS) phase-shifts configuration over heterogeneous communication environments.
The problem is formulated as a distributed learning problem over different environments in a Federated Learning (FL) setting.
Equivalently, this corresponds to a game played between multiple RISs, as learning agents, in heterogeneous environments.
Using Invariant Risk Minimization (IRM) and its FL equivalent, dubbed FL Games, we solve the RIS configuration problem by learning invariant causal representations across multiple environments and then predicting the phases.
The solution corresponds to playing according to Best Response Dynamics (BRD) which yields the Nash Equilibrium of the FL game.
The representation learner and the phase predictor are modeled by two neural networks, and their performance is validated via simulations against other benchmarks from the literature.
Our results show that causality-based learning yields a predictor that is 15% more accurate in unseen Out-of-Distribution (OoD) environments.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Reconfigurable Intelligent Surface (RIS), Federated Learning, Causal Inference, Invariant Learning.

</div>
<section id="S1" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The advent of Reconfigurable Intelligent Surfaces (RISs) will substantially boost the performance of wireless communication systems.
These surfaces are manufactured by layering stacks of sheets made out of engineered materials, called meta-materials, built on a planar structure. The reflection coefficients of the meta-material elements, called meta-atoms, vary depending on their physical states. Thus, the direction of incident electromagnetic waves on RISs can be manipulated with the aid of simple integrated circuit controllers that modify meta-atoms’ states.
In this view, the RIS technology provides a partial control over the wireless propagation environment rendering improved spectral efficiency with a minimal power footprint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. RIS is considered a fundamental enabler to achieve the 6G vision of smart radio environments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">One of the major challenges in the RIS technology is the accurate tuning of RIS phases.
To this extent, a vast majority of the existing literature on RIS-assisted communication relies on the use of Channel State Information (CSI) to train Machine Learning (ML) models that predict the optimal RIS configuration <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
These methods seek either a centralized-controller driven approach, or a distributed multi-agent optimization technique, such as Federated Learning (FL). Other works such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> exploit the users’ locations to employ a location-based passive RIS beamforming. Either way, their main focus is to draw on the statistical correlations of the observed data, while overlooking the impacts of heterogeneous system designs (e.g., different RISs, propagation environments, users distribution, etc.). Moreover, these approaches produce a high inference accuracy within a fixed environment, from which the training and testing data are drawn. They subsequently fail to have a good Out-of-Distribution (OoD) generalization in unseen environments.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Although FL provides a learning framework where multiple agents train a collaborative model while preserving privacy, its state-of-the-art approach, such as Federated Averaging (<span id="S1.p3.1.1" class="ltx_text ltx_font_smallcaps">FedAVG</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, is known to perform poorly when the local data is non-identical across participating agents. This is due to the fact that <span id="S1.p3.1.2" class="ltx_text ltx_font_smallcaps">FedAVG</span> (and its variants) solve the distributed learning problem via Empirical Risk Minimization (ERM), that minimizes the empirical distribution of the local losses assuming that the data is identically distributed.
To mitigate this issue, the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> leveraged Distributionally Robust Optimization (DRO) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and proposed a federated DRO for RIS configurations. Therein, the distributed learning problem is cast as a minimax problem, where the model’s parameters are updated to minimize the maximal weighted combination of local losses. This ensures a good performance for the aggregated model over the worst-case combination of local distributions.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">On the other hand, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> used Invariant Risk Minimization (IRM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> to formulate the problem of learning optimal RIS phase-shifts. The aim of IRM is to capture causal dependencies in the data, that are invariant across different environments. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, the authors empirically showed that using relative distances and angles between the RIS and the transmitter/receiver as causal representations for the CSI, improves the robustness of the RIS phase predictor.
However, these representations were not learned by the configuration predictor, but were predefined and fixed. Also, this solution assumes that multiple environments are known to the predictor beforehand, which is an unfeasible assumption.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The main contribution of this paper is a novel distributed IRM-based solution to the RIS configuration problem.
We cast the problem of RIS phase control as a federated learning problem with multiple RISs controllers defined over heterogeneous environments, using a game-theoretic reformulation of IRM, referred to as Federated Learning Games (<span id="S1.p5.1.1" class="ltx_text ltx_font_smallcaps">FL Games</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. The solution of this problem is proven to be the Nash Equilibrium of a strategic game where each RIS updates its configuration predictor by minimizing its local loss function. This game is indexed by a representation learner that is shared among the RISs to extract a causal representation from the CSI data. The representation learner and predictors are trained in a distributed and supervised learning manner.
The numerical validations yield that the proposed design improves the accuracy of the predictor tested in OoD settings by 15% compared to state-of-the-art RIS designs.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The remainder of this paper is organized as follows. In Section <a href="#S2" title="II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, we describe the system model and conventional approaches to the RIS configuration problem using <span id="S1.p6.1.1" class="ltx_text ltx_font_smallcaps">FedAVG</span>. The <span id="S1.p6.1.2" class="ltx_text ltx_font_smallcaps">FL Games</span> solution that involves extracting causal representations from the data is discussed in Section <a href="#S3" title="III FL Games for Phase Optimization ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>.
Section <a href="#S4" title="IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> presents the simulation results that compare the proposed algorithm with benchmarks. Concluding remarks are drawn in Section <a href="#S5" title="V Conclusions ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">System Model and Problem Formulation</span>
</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2306.01306/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="184" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S2.F1.3.2" class="ltx_text" style="font-size:90%;">System model illustrating different RIS-assisted communication scenarios. Each RIS is conceived differently from other RISs, and serves differently distributed receivers.</span></figcaption>
</figure>
<div id="S2.p1" class="ltx_para">
<p id="S2.p1.10" class="ltx_p">We consider a set of environments <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathcal{R}</annotation></semantics></math> where each environment <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">r</mi><mo id="S2.p1.2.m2.1.1.1" xref="S2.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><in id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1"></in><ci id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2">𝑟</ci><ci id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">r\in\mathcal{R}</annotation></semantics></math> consists of a RIS-assisted downlink communication between a transmitter (Tx) and a receiver (Rx) as shown in Fig. <a href="#S2.F1" title="Figure 1 ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Both the Tx and the Rx are equipped with a single antenna each, and we assume that the direct link between them is blocked in which, the channel of direct link is dominated by the reflected channel.
The RIS in environment <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">r</annotation></semantics></math> is composed by <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="N^{r}=N^{r}_{\mathrm{x}}N^{r}_{\mathrm{y}}" display="inline"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><msup id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml"><mi id="S2.p1.4.m4.1.1.2.2" xref="S2.p1.4.m4.1.1.2.2.cmml">N</mi><mi id="S2.p1.4.m4.1.1.2.3" xref="S2.p1.4.m4.1.1.2.3.cmml">r</mi></msup><mo id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml"><msubsup id="S2.p1.4.m4.1.1.3.2" xref="S2.p1.4.m4.1.1.3.2.cmml"><mi id="S2.p1.4.m4.1.1.3.2.2.2" xref="S2.p1.4.m4.1.1.3.2.2.2.cmml">N</mi><mi mathvariant="normal" id="S2.p1.4.m4.1.1.3.2.3" xref="S2.p1.4.m4.1.1.3.2.3.cmml">x</mi><mi id="S2.p1.4.m4.1.1.3.2.2.3" xref="S2.p1.4.m4.1.1.3.2.2.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.p1.4.m4.1.1.3.1" xref="S2.p1.4.m4.1.1.3.1.cmml">​</mo><msubsup id="S2.p1.4.m4.1.1.3.3" xref="S2.p1.4.m4.1.1.3.3.cmml"><mi id="S2.p1.4.m4.1.1.3.3.2.2" xref="S2.p1.4.m4.1.1.3.3.2.2.cmml">N</mi><mi mathvariant="normal" id="S2.p1.4.m4.1.1.3.3.3" xref="S2.p1.4.m4.1.1.3.3.3.cmml">y</mi><mi id="S2.p1.4.m4.1.1.3.3.2.3" xref="S2.p1.4.m4.1.1.3.3.2.3.cmml">r</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><eq id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"></eq><apply id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.2.1.cmml" xref="S2.p1.4.m4.1.1.2">superscript</csymbol><ci id="S2.p1.4.m4.1.1.2.2.cmml" xref="S2.p1.4.m4.1.1.2.2">𝑁</ci><ci id="S2.p1.4.m4.1.1.2.3.cmml" xref="S2.p1.4.m4.1.1.2.3">𝑟</ci></apply><apply id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3"><times id="S2.p1.4.m4.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.3.1"></times><apply id="S2.p1.4.m4.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.2.1.cmml" xref="S2.p1.4.m4.1.1.3.2">subscript</csymbol><apply id="S2.p1.4.m4.1.1.3.2.2.cmml" xref="S2.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.2.2.1.cmml" xref="S2.p1.4.m4.1.1.3.2">superscript</csymbol><ci id="S2.p1.4.m4.1.1.3.2.2.2.cmml" xref="S2.p1.4.m4.1.1.3.2.2.2">𝑁</ci><ci id="S2.p1.4.m4.1.1.3.2.2.3.cmml" xref="S2.p1.4.m4.1.1.3.2.2.3">𝑟</ci></apply><ci id="S2.p1.4.m4.1.1.3.2.3.cmml" xref="S2.p1.4.m4.1.1.3.2.3">x</ci></apply><apply id="S2.p1.4.m4.1.1.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.3.1.cmml" xref="S2.p1.4.m4.1.1.3.3">subscript</csymbol><apply id="S2.p1.4.m4.1.1.3.3.2.cmml" xref="S2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.3.2.1.cmml" xref="S2.p1.4.m4.1.1.3.3">superscript</csymbol><ci id="S2.p1.4.m4.1.1.3.3.2.2.cmml" xref="S2.p1.4.m4.1.1.3.3.2.2">𝑁</ci><ci id="S2.p1.4.m4.1.1.3.3.2.3.cmml" xref="S2.p1.4.m4.1.1.3.3.2.3">𝑟</ci></apply><ci id="S2.p1.4.m4.1.1.3.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3.3">y</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">N^{r}=N^{r}_{\mathrm{x}}N^{r}_{\mathrm{y}}</annotation></semantics></math> reflective elements where <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="N_{\mathrm{x}}^{r}" display="inline"><semantics id="S2.p1.5.m5.1a"><msubsup id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><mi id="S2.p1.5.m5.1.1.2.2" xref="S2.p1.5.m5.1.1.2.2.cmml">N</mi><mi mathvariant="normal" id="S2.p1.5.m5.1.1.2.3" xref="S2.p1.5.m5.1.1.2.3.cmml">x</mi><mi id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1">superscript</csymbol><apply id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.2.1.cmml" xref="S2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.p1.5.m5.1.1.2.2.cmml" xref="S2.p1.5.m5.1.1.2.2">𝑁</ci><ci id="S2.p1.5.m5.1.1.2.3.cmml" xref="S2.p1.5.m5.1.1.2.3">x</ci></apply><ci id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">N_{\mathrm{x}}^{r}</annotation></semantics></math> and <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="N_{\mathrm{y}}^{r}" display="inline"><semantics id="S2.p1.6.m6.1a"><msubsup id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2.2" xref="S2.p1.6.m6.1.1.2.2.cmml">N</mi><mi mathvariant="normal" id="S2.p1.6.m6.1.1.2.3" xref="S2.p1.6.m6.1.1.2.3.cmml">y</mi><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">superscript</csymbol><apply id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.2.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.2.cmml" xref="S2.p1.6.m6.1.1.2.2">𝑁</ci><ci id="S2.p1.6.m6.1.1.2.3.cmml" xref="S2.p1.6.m6.1.1.2.3">y</ci></apply><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">N_{\mathrm{y}}^{r}</annotation></semantics></math> are the number of horizontal and vertical reflective elements, respectively.
Additionally, the inter-element distances over horizontal and vertical axes are characterized by <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="d_{\mathrm{x}}^{r}" display="inline"><semantics id="S2.p1.7.m7.1a"><msubsup id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi id="S2.p1.7.m7.1.1.2.2" xref="S2.p1.7.m7.1.1.2.2.cmml">d</mi><mi mathvariant="normal" id="S2.p1.7.m7.1.1.2.3" xref="S2.p1.7.m7.1.1.2.3.cmml">x</mi><mi id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1">superscript</csymbol><apply id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.2.1.cmml" xref="S2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.p1.7.m7.1.1.2.2.cmml" xref="S2.p1.7.m7.1.1.2.2">𝑑</ci><ci id="S2.p1.7.m7.1.1.2.3.cmml" xref="S2.p1.7.m7.1.1.2.3">x</ci></apply><ci id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">d_{\mathrm{x}}^{r}</annotation></semantics></math> and <math id="S2.p1.8.m8.1" class="ltx_Math" alttext="d_{\mathrm{y}}^{r}" display="inline"><semantics id="S2.p1.8.m8.1a"><msubsup id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml"><mi id="S2.p1.8.m8.1.1.2.2" xref="S2.p1.8.m8.1.1.2.2.cmml">d</mi><mi mathvariant="normal" id="S2.p1.8.m8.1.1.2.3" xref="S2.p1.8.m8.1.1.2.3.cmml">y</mi><mi id="S2.p1.8.m8.1.1.3" xref="S2.p1.8.m8.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><apply id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.cmml" xref="S2.p1.8.m8.1.1">superscript</csymbol><apply id="S2.p1.8.m8.1.1.2.cmml" xref="S2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.2.1.cmml" xref="S2.p1.8.m8.1.1">subscript</csymbol><ci id="S2.p1.8.m8.1.1.2.2.cmml" xref="S2.p1.8.m8.1.1.2.2">𝑑</ci><ci id="S2.p1.8.m8.1.1.2.3.cmml" xref="S2.p1.8.m8.1.1.2.3">y</ci></apply><ci id="S2.p1.8.m8.1.1.3.cmml" xref="S2.p1.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">d_{\mathrm{y}}^{r}</annotation></semantics></math>.
Each RIS element applies a phase shift on its incident signal and the reflected signals are aggregated at the Rx.
Note that the location of the Tx is fixed while the location of Rx is arbitrary, which is sampled by a predefined distribution.
The choices of the Rx distribution along with the parameters <math id="S2.p1.9.m9.4" class="ltx_Math" alttext="(N_{\mathrm{x}}^{r},N_{\mathrm{y}}^{r},d_{\mathrm{x}}^{r},d_{\mathrm{y}}^{r})" display="inline"><semantics id="S2.p1.9.m9.4a"><mrow id="S2.p1.9.m9.4.4.4" xref="S2.p1.9.m9.4.4.5.cmml"><mo stretchy="false" id="S2.p1.9.m9.4.4.4.5" xref="S2.p1.9.m9.4.4.5.cmml">(</mo><msubsup id="S2.p1.9.m9.1.1.1.1" xref="S2.p1.9.m9.1.1.1.1.cmml"><mi id="S2.p1.9.m9.1.1.1.1.2.2" xref="S2.p1.9.m9.1.1.1.1.2.2.cmml">N</mi><mi mathvariant="normal" id="S2.p1.9.m9.1.1.1.1.2.3" xref="S2.p1.9.m9.1.1.1.1.2.3.cmml">x</mi><mi id="S2.p1.9.m9.1.1.1.1.3" xref="S2.p1.9.m9.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S2.p1.9.m9.4.4.4.6" xref="S2.p1.9.m9.4.4.5.cmml">,</mo><msubsup id="S2.p1.9.m9.2.2.2.2" xref="S2.p1.9.m9.2.2.2.2.cmml"><mi id="S2.p1.9.m9.2.2.2.2.2.2" xref="S2.p1.9.m9.2.2.2.2.2.2.cmml">N</mi><mi mathvariant="normal" id="S2.p1.9.m9.2.2.2.2.2.3" xref="S2.p1.9.m9.2.2.2.2.2.3.cmml">y</mi><mi id="S2.p1.9.m9.2.2.2.2.3" xref="S2.p1.9.m9.2.2.2.2.3.cmml">r</mi></msubsup><mo id="S2.p1.9.m9.4.4.4.7" xref="S2.p1.9.m9.4.4.5.cmml">,</mo><msubsup id="S2.p1.9.m9.3.3.3.3" xref="S2.p1.9.m9.3.3.3.3.cmml"><mi id="S2.p1.9.m9.3.3.3.3.2.2" xref="S2.p1.9.m9.3.3.3.3.2.2.cmml">d</mi><mi mathvariant="normal" id="S2.p1.9.m9.3.3.3.3.2.3" xref="S2.p1.9.m9.3.3.3.3.2.3.cmml">x</mi><mi id="S2.p1.9.m9.3.3.3.3.3" xref="S2.p1.9.m9.3.3.3.3.3.cmml">r</mi></msubsup><mo id="S2.p1.9.m9.4.4.4.8" xref="S2.p1.9.m9.4.4.5.cmml">,</mo><msubsup id="S2.p1.9.m9.4.4.4.4" xref="S2.p1.9.m9.4.4.4.4.cmml"><mi id="S2.p1.9.m9.4.4.4.4.2.2" xref="S2.p1.9.m9.4.4.4.4.2.2.cmml">d</mi><mi mathvariant="normal" id="S2.p1.9.m9.4.4.4.4.2.3" xref="S2.p1.9.m9.4.4.4.4.2.3.cmml">y</mi><mi id="S2.p1.9.m9.4.4.4.4.3" xref="S2.p1.9.m9.4.4.4.4.3.cmml">r</mi></msubsup><mo stretchy="false" id="S2.p1.9.m9.4.4.4.9" xref="S2.p1.9.m9.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.4b"><vector id="S2.p1.9.m9.4.4.5.cmml" xref="S2.p1.9.m9.4.4.4"><apply id="S2.p1.9.m9.1.1.1.1.cmml" xref="S2.p1.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.1.1.1.cmml" xref="S2.p1.9.m9.1.1.1.1">superscript</csymbol><apply id="S2.p1.9.m9.1.1.1.1.2.cmml" xref="S2.p1.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.1.1.2.1.cmml" xref="S2.p1.9.m9.1.1.1.1">subscript</csymbol><ci id="S2.p1.9.m9.1.1.1.1.2.2.cmml" xref="S2.p1.9.m9.1.1.1.1.2.2">𝑁</ci><ci id="S2.p1.9.m9.1.1.1.1.2.3.cmml" xref="S2.p1.9.m9.1.1.1.1.2.3">x</ci></apply><ci id="S2.p1.9.m9.1.1.1.1.3.cmml" xref="S2.p1.9.m9.1.1.1.1.3">𝑟</ci></apply><apply id="S2.p1.9.m9.2.2.2.2.cmml" xref="S2.p1.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.9.m9.2.2.2.2.1.cmml" xref="S2.p1.9.m9.2.2.2.2">superscript</csymbol><apply id="S2.p1.9.m9.2.2.2.2.2.cmml" xref="S2.p1.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.9.m9.2.2.2.2.2.1.cmml" xref="S2.p1.9.m9.2.2.2.2">subscript</csymbol><ci id="S2.p1.9.m9.2.2.2.2.2.2.cmml" xref="S2.p1.9.m9.2.2.2.2.2.2">𝑁</ci><ci id="S2.p1.9.m9.2.2.2.2.2.3.cmml" xref="S2.p1.9.m9.2.2.2.2.2.3">y</ci></apply><ci id="S2.p1.9.m9.2.2.2.2.3.cmml" xref="S2.p1.9.m9.2.2.2.2.3">𝑟</ci></apply><apply id="S2.p1.9.m9.3.3.3.3.cmml" xref="S2.p1.9.m9.3.3.3.3"><csymbol cd="ambiguous" id="S2.p1.9.m9.3.3.3.3.1.cmml" xref="S2.p1.9.m9.3.3.3.3">superscript</csymbol><apply id="S2.p1.9.m9.3.3.3.3.2.cmml" xref="S2.p1.9.m9.3.3.3.3"><csymbol cd="ambiguous" id="S2.p1.9.m9.3.3.3.3.2.1.cmml" xref="S2.p1.9.m9.3.3.3.3">subscript</csymbol><ci id="S2.p1.9.m9.3.3.3.3.2.2.cmml" xref="S2.p1.9.m9.3.3.3.3.2.2">𝑑</ci><ci id="S2.p1.9.m9.3.3.3.3.2.3.cmml" xref="S2.p1.9.m9.3.3.3.3.2.3">x</ci></apply><ci id="S2.p1.9.m9.3.3.3.3.3.cmml" xref="S2.p1.9.m9.3.3.3.3.3">𝑟</ci></apply><apply id="S2.p1.9.m9.4.4.4.4.cmml" xref="S2.p1.9.m9.4.4.4.4"><csymbol cd="ambiguous" id="S2.p1.9.m9.4.4.4.4.1.cmml" xref="S2.p1.9.m9.4.4.4.4">superscript</csymbol><apply id="S2.p1.9.m9.4.4.4.4.2.cmml" xref="S2.p1.9.m9.4.4.4.4"><csymbol cd="ambiguous" id="S2.p1.9.m9.4.4.4.4.2.1.cmml" xref="S2.p1.9.m9.4.4.4.4">subscript</csymbol><ci id="S2.p1.9.m9.4.4.4.4.2.2.cmml" xref="S2.p1.9.m9.4.4.4.4.2.2">𝑑</ci><ci id="S2.p1.9.m9.4.4.4.4.2.3.cmml" xref="S2.p1.9.m9.4.4.4.4.2.3">y</ci></apply><ci id="S2.p1.9.m9.4.4.4.4.3.cmml" xref="S2.p1.9.m9.4.4.4.4.3">𝑟</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.4c">(N_{\mathrm{x}}^{r},N_{\mathrm{y}}^{r},d_{\mathrm{x}}^{r},d_{\mathrm{y}}^{r})</annotation></semantics></math> collectively define the environment <math id="S2.p1.10.m10.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.p1.10.m10.1a"><mi id="S2.p1.10.m10.1.1" xref="S2.p1.10.m10.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m10.1b"><ci id="S2.p1.10.m10.1.1.cmml" xref="S2.p1.10.m10.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m10.1c">r</annotation></semantics></math>.
We assume that these environments are completely separate, i.e. each Rx receives only the signal reflected by the RIS in its corresponding environment.</p>
</div>
<section id="S2.SS1" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Channel Model</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.3" class="ltx_p">For the notation simplicity, we have omitted the notion of environment during the discussion within this subsection.
Let <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{g}\in\mathbb{C}^{N}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">𝐠</mi><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">ℂ</mi><mi id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><in id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></in><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝐠</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">ℂ</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathbf{g}\in\mathbb{C}^{N}</annotation></semantics></math> be the channel between the RIS and the Rx, which is dominated by its line-of-sight (LoS) component.
Hence, by denoting <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\varphi_{r}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">φ</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝜑</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\varphi_{r}</annotation></semantics></math> and <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\vartheta_{r}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">ϑ</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">italic-ϑ</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\vartheta_{r}</annotation></semantics></math> as the azimuth and elevation angles-of-departure (AoD) from the RIS respectively, the channel is modeled as</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\mathbf{g}=\sqrt{\alpha_{r}}\;\mathbf{a}_{N}\left(\varphi_{r},\vartheta_{r}\right)," display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.4" xref="S2.E1.m1.1.1.1.1.4.cmml">𝐠</mi><mo id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml"><msqrt id="S2.E1.m1.1.1.1.1.2.4" xref="S2.E1.m1.1.1.1.1.2.4.cmml"><msub id="S2.E1.m1.1.1.1.1.2.4.2" xref="S2.E1.m1.1.1.1.1.2.4.2.cmml"><mi id="S2.E1.m1.1.1.1.1.2.4.2.2" xref="S2.E1.m1.1.1.1.1.2.4.2.2.cmml">α</mi><mi id="S2.E1.m1.1.1.1.1.2.4.2.3" xref="S2.E1.m1.1.1.1.1.2.4.2.3.cmml">r</mi></msub></msqrt><mo lspace="0.280em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.2.3.cmml">​</mo><msub id="S2.E1.m1.1.1.1.1.2.5" xref="S2.E1.m1.1.1.1.1.2.5.cmml"><mi id="S2.E1.m1.1.1.1.1.2.5.2" xref="S2.E1.m1.1.1.1.1.2.5.2.cmml">𝐚</mi><mi id="S2.E1.m1.1.1.1.1.2.5.3" xref="S2.E1.m1.1.1.1.1.2.5.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.3a" xref="S2.E1.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.E1.m1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">φ</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S2.E1.m1.1.1.1.1.2.2.2.4" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E1.m1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.2.2.cmml">ϑ</mi><mi id="S2.E1.m1.1.1.1.1.2.2.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.2.2.3.cmml">r</mi></msub><mo id="S2.E1.m1.1.1.1.1.2.2.2.5" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"></eq><ci id="S2.E1.m1.1.1.1.1.4.cmml" xref="S2.E1.m1.1.1.1.1.4">𝐠</ci><apply id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"><times id="S2.E1.m1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3"></times><apply id="S2.E1.m1.1.1.1.1.2.4.cmml" xref="S2.E1.m1.1.1.1.1.2.4"><root id="S2.E1.m1.1.1.1.1.2.4a.cmml" xref="S2.E1.m1.1.1.1.1.2.4"></root><apply id="S2.E1.m1.1.1.1.1.2.4.2.cmml" xref="S2.E1.m1.1.1.1.1.2.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.4.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.4.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.4.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.4.2.2">𝛼</ci><ci id="S2.E1.m1.1.1.1.1.2.4.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.4.2.3">𝑟</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.2.5.cmml" xref="S2.E1.m1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.5.1.cmml" xref="S2.E1.m1.1.1.1.1.2.5">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.5.2.cmml" xref="S2.E1.m1.1.1.1.1.2.5.2">𝐚</ci><ci id="S2.E1.m1.1.1.1.1.2.5.3.cmml" xref="S2.E1.m1.1.1.1.1.2.5.3">𝑁</ci></apply><interval closure="open" id="S2.E1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2"><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2">𝜑</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply><apply id="S2.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2.2">italic-ϑ</ci><ci id="S2.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2.3">𝑟</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathbf{g}=\sqrt{\alpha_{r}}\;\mathbf{a}_{N}\left(\varphi_{r},\vartheta_{r}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.4" class="ltx_p">where <math id="S2.SS1.p1.4.m1.1" class="ltx_Math" alttext="\alpha_{r}" display="inline"><semantics id="S2.SS1.p1.4.m1.1a"><msub id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml"><mi id="S2.SS1.p1.4.m1.1.1.2" xref="S2.SS1.p1.4.m1.1.1.2.cmml">α</mi><mi id="S2.SS1.p1.4.m1.1.1.3" xref="S2.SS1.p1.4.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><apply id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m1.1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m1.1.1.2.cmml" xref="S2.SS1.p1.4.m1.1.1.2">𝛼</ci><ci id="S2.SS1.p1.4.m1.1.1.3.cmml" xref="S2.SS1.p1.4.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">\alpha_{r}</annotation></semantics></math> represents the path-loss.
Additionally, we define the steering function:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.8" class="ltx_Math" alttext="\mathbf{a}_{N}\left(\varphi,\vartheta\right)=\left[e^{\tfrac{2\pi j}{\lambda}\Delta_{1}\left(\varphi,\vartheta\right)},\cdots,e^{\tfrac{2\pi j}{\lambda}\Delta_{N}\left(\varphi,\vartheta\right)}\right]^{\mathsf{T}}," display="block"><semantics id="S2.E2.m1.8a"><mrow id="S2.E2.m1.8.8.1" xref="S2.E2.m1.8.8.1.1.cmml"><mrow id="S2.E2.m1.8.8.1.1" xref="S2.E2.m1.8.8.1.1.cmml"><mrow id="S2.E2.m1.8.8.1.1.4" xref="S2.E2.m1.8.8.1.1.4.cmml"><msub id="S2.E2.m1.8.8.1.1.4.2" xref="S2.E2.m1.8.8.1.1.4.2.cmml"><mi id="S2.E2.m1.8.8.1.1.4.2.2" xref="S2.E2.m1.8.8.1.1.4.2.2.cmml">𝐚</mi><mi id="S2.E2.m1.8.8.1.1.4.2.3" xref="S2.E2.m1.8.8.1.1.4.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.8.8.1.1.4.1" xref="S2.E2.m1.8.8.1.1.4.1.cmml">​</mo><mrow id="S2.E2.m1.8.8.1.1.4.3.2" xref="S2.E2.m1.8.8.1.1.4.3.1.cmml"><mo id="S2.E2.m1.8.8.1.1.4.3.2.1" xref="S2.E2.m1.8.8.1.1.4.3.1.cmml">(</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">φ</mi><mo id="S2.E2.m1.8.8.1.1.4.3.2.2" xref="S2.E2.m1.8.8.1.1.4.3.1.cmml">,</mo><mi id="S2.E2.m1.6.6" xref="S2.E2.m1.6.6.cmml">ϑ</mi><mo id="S2.E2.m1.8.8.1.1.4.3.2.3" xref="S2.E2.m1.8.8.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.8.8.1.1.3" xref="S2.E2.m1.8.8.1.1.3.cmml">=</mo><msup id="S2.E2.m1.8.8.1.1.2" xref="S2.E2.m1.8.8.1.1.2.cmml"><mrow id="S2.E2.m1.8.8.1.1.2.2.2" xref="S2.E2.m1.8.8.1.1.2.2.3.cmml"><mo id="S2.E2.m1.8.8.1.1.2.2.2.3" xref="S2.E2.m1.8.8.1.1.2.2.3.cmml">[</mo><msup id="S2.E2.m1.8.8.1.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.8.8.1.1.1.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.1.1.1.2.cmml">e</mi><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mstyle scriptlevel="-1" id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml"><mfrac id="S2.E2.m1.2.2.2.4a" xref="S2.E2.m1.2.2.2.4.cmml"><mrow id="S2.E2.m1.2.2.2.4.2" xref="S2.E2.m1.2.2.2.4.2.cmml"><mn id="S2.E2.m1.2.2.2.4.2.2" xref="S2.E2.m1.2.2.2.4.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.4.2.1" xref="S2.E2.m1.2.2.2.4.2.1.cmml">​</mo><mi id="S2.E2.m1.2.2.2.4.2.3" xref="S2.E2.m1.2.2.2.4.2.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.4.2.1a" xref="S2.E2.m1.2.2.2.4.2.1.cmml">​</mo><mi id="S2.E2.m1.2.2.2.4.2.4" xref="S2.E2.m1.2.2.2.4.2.4.cmml">j</mi></mrow><mi id="S2.E2.m1.2.2.2.4.3" xref="S2.E2.m1.2.2.2.4.3.cmml">λ</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">​</mo><msub id="S2.E2.m1.2.2.2.5" xref="S2.E2.m1.2.2.2.5.cmml"><mi mathvariant="normal" id="S2.E2.m1.2.2.2.5.2" xref="S2.E2.m1.2.2.2.5.2.cmml">Δ</mi><mn id="S2.E2.m1.2.2.2.5.3" xref="S2.E2.m1.2.2.2.5.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.3a" xref="S2.E2.m1.2.2.2.3.cmml">​</mo><mrow id="S2.E2.m1.2.2.2.6.2" xref="S2.E2.m1.2.2.2.6.1.cmml"><mo id="S2.E2.m1.2.2.2.6.2.1" xref="S2.E2.m1.2.2.2.6.1.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">φ</mi><mo id="S2.E2.m1.2.2.2.6.2.2" xref="S2.E2.m1.2.2.2.6.1.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">ϑ</mi><mo id="S2.E2.m1.2.2.2.6.2.3" xref="S2.E2.m1.2.2.2.6.1.cmml">)</mo></mrow></mrow></msup><mo id="S2.E2.m1.8.8.1.1.2.2.2.4" xref="S2.E2.m1.8.8.1.1.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.E2.m1.7.7" xref="S2.E2.m1.7.7.cmml">⋯</mi><mo id="S2.E2.m1.8.8.1.1.2.2.2.5" xref="S2.E2.m1.8.8.1.1.2.2.3.cmml">,</mo><msup id="S2.E2.m1.8.8.1.1.2.2.2.2" xref="S2.E2.m1.8.8.1.1.2.2.2.2.cmml"><mi id="S2.E2.m1.8.8.1.1.2.2.2.2.2" xref="S2.E2.m1.8.8.1.1.2.2.2.2.2.cmml">e</mi><mrow id="S2.E2.m1.4.4.2" xref="S2.E2.m1.4.4.2.cmml"><mstyle scriptlevel="-1" id="S2.E2.m1.4.4.2.4" xref="S2.E2.m1.4.4.2.4.cmml"><mfrac id="S2.E2.m1.4.4.2.4a" xref="S2.E2.m1.4.4.2.4.cmml"><mrow id="S2.E2.m1.4.4.2.4.2" xref="S2.E2.m1.4.4.2.4.2.cmml"><mn id="S2.E2.m1.4.4.2.4.2.2" xref="S2.E2.m1.4.4.2.4.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.2.4.2.1" xref="S2.E2.m1.4.4.2.4.2.1.cmml">​</mo><mi id="S2.E2.m1.4.4.2.4.2.3" xref="S2.E2.m1.4.4.2.4.2.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.2.4.2.1a" xref="S2.E2.m1.4.4.2.4.2.1.cmml">​</mo><mi id="S2.E2.m1.4.4.2.4.2.4" xref="S2.E2.m1.4.4.2.4.2.4.cmml">j</mi></mrow><mi id="S2.E2.m1.4.4.2.4.3" xref="S2.E2.m1.4.4.2.4.3.cmml">λ</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.2.3" xref="S2.E2.m1.4.4.2.3.cmml">​</mo><msub id="S2.E2.m1.4.4.2.5" xref="S2.E2.m1.4.4.2.5.cmml"><mi mathvariant="normal" id="S2.E2.m1.4.4.2.5.2" xref="S2.E2.m1.4.4.2.5.2.cmml">Δ</mi><mi id="S2.E2.m1.4.4.2.5.3" xref="S2.E2.m1.4.4.2.5.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.2.3a" xref="S2.E2.m1.4.4.2.3.cmml">​</mo><mrow id="S2.E2.m1.4.4.2.6.2" xref="S2.E2.m1.4.4.2.6.1.cmml"><mo id="S2.E2.m1.4.4.2.6.2.1" xref="S2.E2.m1.4.4.2.6.1.cmml">(</mo><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">φ</mi><mo id="S2.E2.m1.4.4.2.6.2.2" xref="S2.E2.m1.4.4.2.6.1.cmml">,</mo><mi id="S2.E2.m1.4.4.2.2" xref="S2.E2.m1.4.4.2.2.cmml">ϑ</mi><mo id="S2.E2.m1.4.4.2.6.2.3" xref="S2.E2.m1.4.4.2.6.1.cmml">)</mo></mrow></mrow></msup><mo id="S2.E2.m1.8.8.1.1.2.2.2.6" xref="S2.E2.m1.8.8.1.1.2.2.3.cmml">]</mo></mrow><mi id="S2.E2.m1.8.8.1.1.2.4" xref="S2.E2.m1.8.8.1.1.2.4.cmml">𝖳</mi></msup></mrow><mo id="S2.E2.m1.8.8.1.2" xref="S2.E2.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.8b"><apply id="S2.E2.m1.8.8.1.1.cmml" xref="S2.E2.m1.8.8.1"><eq id="S2.E2.m1.8.8.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.3"></eq><apply id="S2.E2.m1.8.8.1.1.4.cmml" xref="S2.E2.m1.8.8.1.1.4"><times id="S2.E2.m1.8.8.1.1.4.1.cmml" xref="S2.E2.m1.8.8.1.1.4.1"></times><apply id="S2.E2.m1.8.8.1.1.4.2.cmml" xref="S2.E2.m1.8.8.1.1.4.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.4.2.1.cmml" xref="S2.E2.m1.8.8.1.1.4.2">subscript</csymbol><ci id="S2.E2.m1.8.8.1.1.4.2.2.cmml" xref="S2.E2.m1.8.8.1.1.4.2.2">𝐚</ci><ci id="S2.E2.m1.8.8.1.1.4.2.3.cmml" xref="S2.E2.m1.8.8.1.1.4.2.3">𝑁</ci></apply><interval closure="open" id="S2.E2.m1.8.8.1.1.4.3.1.cmml" xref="S2.E2.m1.8.8.1.1.4.3.2"><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝜑</ci><ci id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6">italic-ϑ</ci></interval></apply><apply id="S2.E2.m1.8.8.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.2.3.cmml" xref="S2.E2.m1.8.8.1.1.2">superscript</csymbol><list id="S2.E2.m1.8.8.1.1.2.2.3.cmml" xref="S2.E2.m1.8.8.1.1.2.2.2"><apply id="S2.E2.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.2">𝑒</ci><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><times id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3"></times><apply id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4"><divide id="S2.E2.m1.2.2.2.4.1.cmml" xref="S2.E2.m1.2.2.2.4"></divide><apply id="S2.E2.m1.2.2.2.4.2.cmml" xref="S2.E2.m1.2.2.2.4.2"><times id="S2.E2.m1.2.2.2.4.2.1.cmml" xref="S2.E2.m1.2.2.2.4.2.1"></times><cn type="integer" id="S2.E2.m1.2.2.2.4.2.2.cmml" xref="S2.E2.m1.2.2.2.4.2.2">2</cn><ci id="S2.E2.m1.2.2.2.4.2.3.cmml" xref="S2.E2.m1.2.2.2.4.2.3">𝜋</ci><ci id="S2.E2.m1.2.2.2.4.2.4.cmml" xref="S2.E2.m1.2.2.2.4.2.4">𝑗</ci></apply><ci id="S2.E2.m1.2.2.2.4.3.cmml" xref="S2.E2.m1.2.2.2.4.3">𝜆</ci></apply><apply id="S2.E2.m1.2.2.2.5.cmml" xref="S2.E2.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.5.1.cmml" xref="S2.E2.m1.2.2.2.5">subscript</csymbol><ci id="S2.E2.m1.2.2.2.5.2.cmml" xref="S2.E2.m1.2.2.2.5.2">Δ</ci><cn type="integer" id="S2.E2.m1.2.2.2.5.3.cmml" xref="S2.E2.m1.2.2.2.5.3">1</cn></apply><interval closure="open" id="S2.E2.m1.2.2.2.6.1.cmml" xref="S2.E2.m1.2.2.2.6.2"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝜑</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">italic-ϑ</ci></interval></apply></apply><ci id="S2.E2.m1.7.7.cmml" xref="S2.E2.m1.7.7">⋯</ci><apply id="S2.E2.m1.8.8.1.1.2.2.2.2.cmml" xref="S2.E2.m1.8.8.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.8.8.1.1.2.2.2.2">superscript</csymbol><ci id="S2.E2.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.8.8.1.1.2.2.2.2.2">𝑒</ci><apply id="S2.E2.m1.4.4.2.cmml" xref="S2.E2.m1.4.4.2"><times id="S2.E2.m1.4.4.2.3.cmml" xref="S2.E2.m1.4.4.2.3"></times><apply id="S2.E2.m1.4.4.2.4.cmml" xref="S2.E2.m1.4.4.2.4"><divide id="S2.E2.m1.4.4.2.4.1.cmml" xref="S2.E2.m1.4.4.2.4"></divide><apply id="S2.E2.m1.4.4.2.4.2.cmml" xref="S2.E2.m1.4.4.2.4.2"><times id="S2.E2.m1.4.4.2.4.2.1.cmml" xref="S2.E2.m1.4.4.2.4.2.1"></times><cn type="integer" id="S2.E2.m1.4.4.2.4.2.2.cmml" xref="S2.E2.m1.4.4.2.4.2.2">2</cn><ci id="S2.E2.m1.4.4.2.4.2.3.cmml" xref="S2.E2.m1.4.4.2.4.2.3">𝜋</ci><ci id="S2.E2.m1.4.4.2.4.2.4.cmml" xref="S2.E2.m1.4.4.2.4.2.4">𝑗</ci></apply><ci id="S2.E2.m1.4.4.2.4.3.cmml" xref="S2.E2.m1.4.4.2.4.3">𝜆</ci></apply><apply id="S2.E2.m1.4.4.2.5.cmml" xref="S2.E2.m1.4.4.2.5"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.2.5.1.cmml" xref="S2.E2.m1.4.4.2.5">subscript</csymbol><ci id="S2.E2.m1.4.4.2.5.2.cmml" xref="S2.E2.m1.4.4.2.5.2">Δ</ci><ci id="S2.E2.m1.4.4.2.5.3.cmml" xref="S2.E2.m1.4.4.2.5.3">𝑁</ci></apply><interval closure="open" id="S2.E2.m1.4.4.2.6.1.cmml" xref="S2.E2.m1.4.4.2.6.2"><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝜑</ci><ci id="S2.E2.m1.4.4.2.2.cmml" xref="S2.E2.m1.4.4.2.2">italic-ϑ</ci></interval></apply></apply></list><ci id="S2.E2.m1.8.8.1.1.2.4.cmml" xref="S2.E2.m1.8.8.1.1.2.4">𝖳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.8c">\mathbf{a}_{N}\left(\varphi,\vartheta\right)=\left[e^{\tfrac{2\pi j}{\lambda}\Delta_{1}\left(\varphi,\vartheta\right)},\cdots,e^{\tfrac{2\pi j}{\lambda}\Delta_{N}\left(\varphi,\vartheta\right)}\right]^{\mathsf{T}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.5" class="ltx_p">and a set of operators for <math id="S2.SS1.p1.5.m1.3" class="ltx_Math" alttext="n=1,\dots,N" display="inline"><semantics id="S2.SS1.p1.5.m1.3a"><mrow id="S2.SS1.p1.5.m1.3.4" xref="S2.SS1.p1.5.m1.3.4.cmml"><mi id="S2.SS1.p1.5.m1.3.4.2" xref="S2.SS1.p1.5.m1.3.4.2.cmml">n</mi><mo id="S2.SS1.p1.5.m1.3.4.1" xref="S2.SS1.p1.5.m1.3.4.1.cmml">=</mo><mrow id="S2.SS1.p1.5.m1.3.4.3.2" xref="S2.SS1.p1.5.m1.3.4.3.1.cmml"><mn id="S2.SS1.p1.5.m1.1.1" xref="S2.SS1.p1.5.m1.1.1.cmml">1</mn><mo id="S2.SS1.p1.5.m1.3.4.3.2.1" xref="S2.SS1.p1.5.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.5.m1.2.2" xref="S2.SS1.p1.5.m1.2.2.cmml">…</mi><mo id="S2.SS1.p1.5.m1.3.4.3.2.2" xref="S2.SS1.p1.5.m1.3.4.3.1.cmml">,</mo><mi id="S2.SS1.p1.5.m1.3.3" xref="S2.SS1.p1.5.m1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m1.3b"><apply id="S2.SS1.p1.5.m1.3.4.cmml" xref="S2.SS1.p1.5.m1.3.4"><eq id="S2.SS1.p1.5.m1.3.4.1.cmml" xref="S2.SS1.p1.5.m1.3.4.1"></eq><ci id="S2.SS1.p1.5.m1.3.4.2.cmml" xref="S2.SS1.p1.5.m1.3.4.2">𝑛</ci><list id="S2.SS1.p1.5.m1.3.4.3.1.cmml" xref="S2.SS1.p1.5.m1.3.4.3.2"><cn type="integer" id="S2.SS1.p1.5.m1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1">1</cn><ci id="S2.SS1.p1.5.m1.2.2.cmml" xref="S2.SS1.p1.5.m1.2.2">…</ci><ci id="S2.SS1.p1.5.m1.3.3.cmml" xref="S2.SS1.p1.5.m1.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m1.3c">n=1,\dots,N</annotation></semantics></math>:</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.11" class="ltx_Math" alttext="\displaystyle\Delta_{n}\left(\varphi,\vartheta\right)={i_{N}(n)d_{\mathrm{x}}\cos(\vartheta)\sin(\varphi)+j_{N}(n)d_{\mathrm{y}}\sin(\vartheta)}," display="inline"><semantics id="S2.E3.m1.11a"><mrow id="S2.E3.m1.11.11.1" xref="S2.E3.m1.11.11.1.1.cmml"><mrow id="S2.E3.m1.11.11.1.1" xref="S2.E3.m1.11.11.1.1.cmml"><mrow id="S2.E3.m1.11.11.1.1.2" xref="S2.E3.m1.11.11.1.1.2.cmml"><msub id="S2.E3.m1.11.11.1.1.2.2" xref="S2.E3.m1.11.11.1.1.2.2.cmml"><mi mathvariant="normal" id="S2.E3.m1.11.11.1.1.2.2.2" xref="S2.E3.m1.11.11.1.1.2.2.2.cmml">Δ</mi><mi id="S2.E3.m1.11.11.1.1.2.2.3" xref="S2.E3.m1.11.11.1.1.2.2.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.11.11.1.1.2.1" xref="S2.E3.m1.11.11.1.1.2.1.cmml">​</mo><mrow id="S2.E3.m1.11.11.1.1.2.3.2" xref="S2.E3.m1.11.11.1.1.2.3.1.cmml"><mo id="S2.E3.m1.11.11.1.1.2.3.2.1" xref="S2.E3.m1.11.11.1.1.2.3.1.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">φ</mi><mo id="S2.E3.m1.11.11.1.1.2.3.2.2" xref="S2.E3.m1.11.11.1.1.2.3.1.cmml">,</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">ϑ</mi><mo id="S2.E3.m1.11.11.1.1.2.3.2.3" xref="S2.E3.m1.11.11.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.11.11.1.1.1" xref="S2.E3.m1.11.11.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.11.11.1.1.3" xref="S2.E3.m1.11.11.1.1.3.cmml"><mrow id="S2.E3.m1.11.11.1.1.3.2" xref="S2.E3.m1.11.11.1.1.3.2.cmml"><msub id="S2.E3.m1.11.11.1.1.3.2.2" xref="S2.E3.m1.11.11.1.1.3.2.2.cmml"><mi id="S2.E3.m1.11.11.1.1.3.2.2.2" xref="S2.E3.m1.11.11.1.1.3.2.2.2.cmml">i</mi><mi id="S2.E3.m1.11.11.1.1.3.2.2.3" xref="S2.E3.m1.11.11.1.1.3.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.11.11.1.1.3.2.1" xref="S2.E3.m1.11.11.1.1.3.2.1.cmml">​</mo><mrow id="S2.E3.m1.11.11.1.1.3.2.3.2" xref="S2.E3.m1.11.11.1.1.3.2.cmml"><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.2.3.2.1" xref="S2.E3.m1.11.11.1.1.3.2.cmml">(</mo><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">n</mi><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.2.3.2.2" xref="S2.E3.m1.11.11.1.1.3.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.11.11.1.1.3.2.1a" xref="S2.E3.m1.11.11.1.1.3.2.1.cmml">​</mo><msub id="S2.E3.m1.11.11.1.1.3.2.4" xref="S2.E3.m1.11.11.1.1.3.2.4.cmml"><mi id="S2.E3.m1.11.11.1.1.3.2.4.2" xref="S2.E3.m1.11.11.1.1.3.2.4.2.cmml">d</mi><mi mathvariant="normal" id="S2.E3.m1.11.11.1.1.3.2.4.3" xref="S2.E3.m1.11.11.1.1.3.2.4.3.cmml">x</mi></msub><mo lspace="0.167em" rspace="0em" id="S2.E3.m1.11.11.1.1.3.2.1b" xref="S2.E3.m1.11.11.1.1.3.2.1.cmml">​</mo><mrow id="S2.E3.m1.11.11.1.1.3.2.5.2" xref="S2.E3.m1.11.11.1.1.3.2.5.1.cmml"><mi id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">cos</mi><mo id="S2.E3.m1.11.11.1.1.3.2.5.2a" xref="S2.E3.m1.11.11.1.1.3.2.5.1.cmml">⁡</mo><mrow id="S2.E3.m1.11.11.1.1.3.2.5.2.1" xref="S2.E3.m1.11.11.1.1.3.2.5.1.cmml"><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.2.5.2.1.1" xref="S2.E3.m1.11.11.1.1.3.2.5.1.cmml">(</mo><mi id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml">ϑ</mi><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.2.5.2.1.2" xref="S2.E3.m1.11.11.1.1.3.2.5.1.cmml">)</mo></mrow></mrow><mo lspace="0.167em" rspace="0em" id="S2.E3.m1.11.11.1.1.3.2.1c" xref="S2.E3.m1.11.11.1.1.3.2.1.cmml">​</mo><mrow id="S2.E3.m1.11.11.1.1.3.2.6.2" xref="S2.E3.m1.11.11.1.1.3.2.6.1.cmml"><mi id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml">sin</mi><mo id="S2.E3.m1.11.11.1.1.3.2.6.2a" xref="S2.E3.m1.11.11.1.1.3.2.6.1.cmml">⁡</mo><mrow id="S2.E3.m1.11.11.1.1.3.2.6.2.1" xref="S2.E3.m1.11.11.1.1.3.2.6.1.cmml"><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.2.6.2.1.1" xref="S2.E3.m1.11.11.1.1.3.2.6.1.cmml">(</mo><mi id="S2.E3.m1.7.7" xref="S2.E3.m1.7.7.cmml">φ</mi><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.2.6.2.1.2" xref="S2.E3.m1.11.11.1.1.3.2.6.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.11.11.1.1.3.1" xref="S2.E3.m1.11.11.1.1.3.1.cmml">+</mo><mrow id="S2.E3.m1.11.11.1.1.3.3" xref="S2.E3.m1.11.11.1.1.3.3.cmml"><msub id="S2.E3.m1.11.11.1.1.3.3.2" xref="S2.E3.m1.11.11.1.1.3.3.2.cmml"><mi id="S2.E3.m1.11.11.1.1.3.3.2.2" xref="S2.E3.m1.11.11.1.1.3.3.2.2.cmml">j</mi><mi id="S2.E3.m1.11.11.1.1.3.3.2.3" xref="S2.E3.m1.11.11.1.1.3.3.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.11.11.1.1.3.3.1" xref="S2.E3.m1.11.11.1.1.3.3.1.cmml">​</mo><mrow id="S2.E3.m1.11.11.1.1.3.3.3.2" xref="S2.E3.m1.11.11.1.1.3.3.cmml"><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.3.3.2.1" xref="S2.E3.m1.11.11.1.1.3.3.cmml">(</mo><mi id="S2.E3.m1.8.8" xref="S2.E3.m1.8.8.cmml">n</mi><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.3.3.2.2" xref="S2.E3.m1.11.11.1.1.3.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.11.11.1.1.3.3.1a" xref="S2.E3.m1.11.11.1.1.3.3.1.cmml">​</mo><msub id="S2.E3.m1.11.11.1.1.3.3.4" xref="S2.E3.m1.11.11.1.1.3.3.4.cmml"><mi id="S2.E3.m1.11.11.1.1.3.3.4.2" xref="S2.E3.m1.11.11.1.1.3.3.4.2.cmml">d</mi><mi mathvariant="normal" id="S2.E3.m1.11.11.1.1.3.3.4.3" xref="S2.E3.m1.11.11.1.1.3.3.4.3.cmml">y</mi></msub><mo lspace="0.167em" rspace="0em" id="S2.E3.m1.11.11.1.1.3.3.1b" xref="S2.E3.m1.11.11.1.1.3.3.1.cmml">​</mo><mrow id="S2.E3.m1.11.11.1.1.3.3.5.2" xref="S2.E3.m1.11.11.1.1.3.3.5.1.cmml"><mi id="S2.E3.m1.9.9" xref="S2.E3.m1.9.9.cmml">sin</mi><mo id="S2.E3.m1.11.11.1.1.3.3.5.2a" xref="S2.E3.m1.11.11.1.1.3.3.5.1.cmml">⁡</mo><mrow id="S2.E3.m1.11.11.1.1.3.3.5.2.1" xref="S2.E3.m1.11.11.1.1.3.3.5.1.cmml"><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.3.5.2.1.1" xref="S2.E3.m1.11.11.1.1.3.3.5.1.cmml">(</mo><mi id="S2.E3.m1.10.10" xref="S2.E3.m1.10.10.cmml">ϑ</mi><mo stretchy="false" id="S2.E3.m1.11.11.1.1.3.3.5.2.1.2" xref="S2.E3.m1.11.11.1.1.3.3.5.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.11.11.1.2" xref="S2.E3.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.11b"><apply id="S2.E3.m1.11.11.1.1.cmml" xref="S2.E3.m1.11.11.1"><eq id="S2.E3.m1.11.11.1.1.1.cmml" xref="S2.E3.m1.11.11.1.1.1"></eq><apply id="S2.E3.m1.11.11.1.1.2.cmml" xref="S2.E3.m1.11.11.1.1.2"><times id="S2.E3.m1.11.11.1.1.2.1.cmml" xref="S2.E3.m1.11.11.1.1.2.1"></times><apply id="S2.E3.m1.11.11.1.1.2.2.cmml" xref="S2.E3.m1.11.11.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.11.11.1.1.2.2.1.cmml" xref="S2.E3.m1.11.11.1.1.2.2">subscript</csymbol><ci id="S2.E3.m1.11.11.1.1.2.2.2.cmml" xref="S2.E3.m1.11.11.1.1.2.2.2">Δ</ci><ci id="S2.E3.m1.11.11.1.1.2.2.3.cmml" xref="S2.E3.m1.11.11.1.1.2.2.3">𝑛</ci></apply><interval closure="open" id="S2.E3.m1.11.11.1.1.2.3.1.cmml" xref="S2.E3.m1.11.11.1.1.2.3.2"><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝜑</ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">italic-ϑ</ci></interval></apply><apply id="S2.E3.m1.11.11.1.1.3.cmml" xref="S2.E3.m1.11.11.1.1.3"><plus id="S2.E3.m1.11.11.1.1.3.1.cmml" xref="S2.E3.m1.11.11.1.1.3.1"></plus><apply id="S2.E3.m1.11.11.1.1.3.2.cmml" xref="S2.E3.m1.11.11.1.1.3.2"><times id="S2.E3.m1.11.11.1.1.3.2.1.cmml" xref="S2.E3.m1.11.11.1.1.3.2.1"></times><apply id="S2.E3.m1.11.11.1.1.3.2.2.cmml" xref="S2.E3.m1.11.11.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.11.11.1.1.3.2.2.1.cmml" xref="S2.E3.m1.11.11.1.1.3.2.2">subscript</csymbol><ci id="S2.E3.m1.11.11.1.1.3.2.2.2.cmml" xref="S2.E3.m1.11.11.1.1.3.2.2.2">𝑖</ci><ci id="S2.E3.m1.11.11.1.1.3.2.2.3.cmml" xref="S2.E3.m1.11.11.1.1.3.2.2.3">𝑁</ci></apply><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝑛</ci><apply id="S2.E3.m1.11.11.1.1.3.2.4.cmml" xref="S2.E3.m1.11.11.1.1.3.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.11.11.1.1.3.2.4.1.cmml" xref="S2.E3.m1.11.11.1.1.3.2.4">subscript</csymbol><ci id="S2.E3.m1.11.11.1.1.3.2.4.2.cmml" xref="S2.E3.m1.11.11.1.1.3.2.4.2">𝑑</ci><ci id="S2.E3.m1.11.11.1.1.3.2.4.3.cmml" xref="S2.E3.m1.11.11.1.1.3.2.4.3">x</ci></apply><apply id="S2.E3.m1.11.11.1.1.3.2.5.1.cmml" xref="S2.E3.m1.11.11.1.1.3.2.5.2"><cos id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4"></cos><ci id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5">italic-ϑ</ci></apply><apply id="S2.E3.m1.11.11.1.1.3.2.6.1.cmml" xref="S2.E3.m1.11.11.1.1.3.2.6.2"><sin id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6"></sin><ci id="S2.E3.m1.7.7.cmml" xref="S2.E3.m1.7.7">𝜑</ci></apply></apply><apply id="S2.E3.m1.11.11.1.1.3.3.cmml" xref="S2.E3.m1.11.11.1.1.3.3"><times id="S2.E3.m1.11.11.1.1.3.3.1.cmml" xref="S2.E3.m1.11.11.1.1.3.3.1"></times><apply id="S2.E3.m1.11.11.1.1.3.3.2.cmml" xref="S2.E3.m1.11.11.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.11.11.1.1.3.3.2.1.cmml" xref="S2.E3.m1.11.11.1.1.3.3.2">subscript</csymbol><ci id="S2.E3.m1.11.11.1.1.3.3.2.2.cmml" xref="S2.E3.m1.11.11.1.1.3.3.2.2">𝑗</ci><ci id="S2.E3.m1.11.11.1.1.3.3.2.3.cmml" xref="S2.E3.m1.11.11.1.1.3.3.2.3">𝑁</ci></apply><ci id="S2.E3.m1.8.8.cmml" xref="S2.E3.m1.8.8">𝑛</ci><apply id="S2.E3.m1.11.11.1.1.3.3.4.cmml" xref="S2.E3.m1.11.11.1.1.3.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.11.11.1.1.3.3.4.1.cmml" xref="S2.E3.m1.11.11.1.1.3.3.4">subscript</csymbol><ci id="S2.E3.m1.11.11.1.1.3.3.4.2.cmml" xref="S2.E3.m1.11.11.1.1.3.3.4.2">𝑑</ci><ci id="S2.E3.m1.11.11.1.1.3.3.4.3.cmml" xref="S2.E3.m1.11.11.1.1.3.3.4.3">y</ci></apply><apply id="S2.E3.m1.11.11.1.1.3.3.5.1.cmml" xref="S2.E3.m1.11.11.1.1.3.3.5.2"><sin id="S2.E3.m1.9.9.cmml" xref="S2.E3.m1.9.9"></sin><ci id="S2.E3.m1.10.10.cmml" xref="S2.E3.m1.10.10">italic-ϑ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.11c">\displaystyle\Delta_{n}\left(\varphi,\vartheta\right)={i_{N}(n)d_{\mathrm{x}}\cos(\vartheta)\sin(\varphi)+j_{N}(n)d_{\mathrm{y}}\sin(\vartheta)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.4" class="ltx_Math" alttext="\displaystyle i_{N}(n)=\left(n-1\right)\;\mathrm{mod}\;N_{\mathrm{x}},\qquad j_{N}(n)=\left\lfloor\frac{n-1}{N_{\mathrm{x}}}\right\rfloor," display="inline"><semantics id="S2.E4.m1.4a"><mrow id="S2.E4.m1.4.4.1"><mrow id="S2.E4.m1.4.4.1.1.2" xref="S2.E4.m1.4.4.1.1.3.cmml"><mrow id="S2.E4.m1.4.4.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml"><msub id="S2.E4.m1.4.4.1.1.1.1.3.2" xref="S2.E4.m1.4.4.1.1.1.1.3.2.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.3.2.2" xref="S2.E4.m1.4.4.1.1.1.1.3.2.2.cmml">i</mi><mi id="S2.E4.m1.4.4.1.1.1.1.3.2.3" xref="S2.E4.m1.4.4.1.1.1.1.3.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.3.1" xref="S2.E4.m1.4.4.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.3.3.2" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.1.1.1.1.3.3.2.1" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">n</mi><mo stretchy="false" id="S2.E4.m1.4.4.1.1.1.1.3.3.2.2" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.4.4.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">n</mi><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.280em" rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E4.m1.4.4.1.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.1.3.cmml">mod</mi><mo lspace="0.280em" rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.1.2a" xref="S2.E4.m1.4.4.1.1.1.1.1.2.cmml">​</mo><msub id="S2.E4.m1.4.4.1.1.1.1.1.4" xref="S2.E4.m1.4.4.1.1.1.1.1.4.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.1.4.2" xref="S2.E4.m1.4.4.1.1.1.1.1.4.2.cmml">N</mi><mi mathvariant="normal" id="S2.E4.m1.4.4.1.1.1.1.1.4.3" xref="S2.E4.m1.4.4.1.1.1.1.1.4.3.cmml">x</mi></msub></mrow></mrow><mo rspace="2.167em" id="S2.E4.m1.4.4.1.1.2.3" xref="S2.E4.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S2.E4.m1.4.4.1.1.2.2" xref="S2.E4.m1.4.4.1.1.2.2.cmml"><mrow id="S2.E4.m1.4.4.1.1.2.2.2" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml"><msub id="S2.E4.m1.4.4.1.1.2.2.2.2" xref="S2.E4.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S2.E4.m1.4.4.1.1.2.2.2.2.2" xref="S2.E4.m1.4.4.1.1.2.2.2.2.2.cmml">j</mi><mi id="S2.E4.m1.4.4.1.1.2.2.2.2.3" xref="S2.E4.m1.4.4.1.1.2.2.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.1.1.2.2.2.1" xref="S2.E4.m1.4.4.1.1.2.2.2.1.cmml">​</mo><mrow id="S2.E4.m1.4.4.1.1.2.2.2.3.2" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.1.1.2.2.2.3.2.1" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml">(</mo><mi id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml">n</mi><mo stretchy="false" id="S2.E4.m1.4.4.1.1.2.2.2.3.2.2" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.4.4.1.1.2.2.1" xref="S2.E4.m1.4.4.1.1.2.2.1.cmml">=</mo><mrow id="S2.E4.m1.4.4.1.1.2.2.3.2" xref="S2.E4.m1.4.4.1.1.2.2.3.1.cmml"><mo id="S2.E4.m1.4.4.1.1.2.2.3.2.1" xref="S2.E4.m1.4.4.1.1.2.2.3.1.1.cmml">⌊</mo><mstyle displaystyle="true" id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml"><mfrac id="S2.E4.m1.3.3a" xref="S2.E4.m1.3.3.cmml"><mrow id="S2.E4.m1.3.3.2" xref="S2.E4.m1.3.3.2.cmml"><mi id="S2.E4.m1.3.3.2.2" xref="S2.E4.m1.3.3.2.2.cmml">n</mi><mo id="S2.E4.m1.3.3.2.1" xref="S2.E4.m1.3.3.2.1.cmml">−</mo><mn id="S2.E4.m1.3.3.2.3" xref="S2.E4.m1.3.3.2.3.cmml">1</mn></mrow><msub id="S2.E4.m1.3.3.3" xref="S2.E4.m1.3.3.3.cmml"><mi id="S2.E4.m1.3.3.3.2" xref="S2.E4.m1.3.3.3.2.cmml">N</mi><mi mathvariant="normal" id="S2.E4.m1.3.3.3.3" xref="S2.E4.m1.3.3.3.3.cmml">x</mi></msub></mfrac></mstyle><mo id="S2.E4.m1.4.4.1.1.2.2.3.2.2" xref="S2.E4.m1.4.4.1.1.2.2.3.1.1.cmml">⌋</mo></mrow></mrow></mrow><mo id="S2.E4.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.4b"><apply id="S2.E4.m1.4.4.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.3a.cmml" xref="S2.E4.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E4.m1.4.4.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1"><eq id="S2.E4.m1.4.4.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2"></eq><apply id="S2.E4.m1.4.4.1.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3"><times id="S2.E4.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3.1"></times><apply id="S2.E4.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3.2.2">𝑖</ci><ci id="S2.E4.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3.2.3">𝑁</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝑛</ci></apply><apply id="S2.E4.m1.4.4.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1"><times id="S2.E4.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.2"></times><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1"><minus id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1"></minus><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E4.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.3">mod</ci><apply id="S2.E4.m1.4.4.1.1.1.1.1.4.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.1.4.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.1.4.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.4.2">𝑁</ci><ci id="S2.E4.m1.4.4.1.1.1.1.1.4.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.4.3">x</ci></apply></apply></apply><apply id="S2.E4.m1.4.4.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2"><eq id="S2.E4.m1.4.4.1.1.2.2.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.1"></eq><apply id="S2.E4.m1.4.4.1.1.2.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2"><times id="S2.E4.m1.4.4.1.1.2.2.2.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2.1"></times><apply id="S2.E4.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2.2.2">𝑗</ci><ci id="S2.E4.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2.2.3">𝑁</ci></apply><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">𝑛</ci></apply><apply id="S2.E4.m1.4.4.1.1.2.2.3.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.3.2"><floor id="S2.E4.m1.4.4.1.1.2.2.3.1.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.3.2.1"></floor><apply id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3"><divide id="S2.E4.m1.3.3.1.cmml" xref="S2.E4.m1.3.3"></divide><apply id="S2.E4.m1.3.3.2.cmml" xref="S2.E4.m1.3.3.2"><minus id="S2.E4.m1.3.3.2.1.cmml" xref="S2.E4.m1.3.3.2.1"></minus><ci id="S2.E4.m1.3.3.2.2.cmml" xref="S2.E4.m1.3.3.2.2">𝑛</ci><cn type="integer" id="S2.E4.m1.3.3.2.3.cmml" xref="S2.E4.m1.3.3.2.3">1</cn></apply><apply id="S2.E4.m1.3.3.3.cmml" xref="S2.E4.m1.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.3.1.cmml" xref="S2.E4.m1.3.3.3">subscript</csymbol><ci id="S2.E4.m1.3.3.3.2.cmml" xref="S2.E4.m1.3.3.3.2">𝑁</ci><ci id="S2.E4.m1.3.3.3.3.cmml" xref="S2.E4.m1.3.3.3.3">x</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.4c">\displaystyle i_{N}(n)=\left(n-1\right)\;\mathrm{mod}\;N_{\mathrm{x}},\qquad j_{N}(n)=\left\lfloor\frac{n-1}{N_{\mathrm{x}}}\right\rfloor,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.10" class="ltx_p">where <math id="S2.SS1.p1.6.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS1.p1.6.m1.1a"><mi id="S2.SS1.p1.6.m1.1.1" xref="S2.SS1.p1.6.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m1.1b"><ci id="S2.SS1.p1.6.m1.1.1.cmml" xref="S2.SS1.p1.6.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m1.1c">\lambda</annotation></semantics></math> is the wavelength, <math id="S2.SS1.p1.7.m2.1" class="ltx_Math" alttext="\mathrm{mod}" display="inline"><semantics id="S2.SS1.p1.7.m2.1a"><mi id="S2.SS1.p1.7.m2.1.1" xref="S2.SS1.p1.7.m2.1.1.cmml">mod</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m2.1b"><ci id="S2.SS1.p1.7.m2.1.1.cmml" xref="S2.SS1.p1.7.m2.1.1">mod</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m2.1c">\mathrm{mod}</annotation></semantics></math> and <math id="S2.SS1.p1.8.m3.1" class="ltx_Math" alttext="\lfloor\cdot\rfloor" display="inline"><semantics id="S2.SS1.p1.8.m3.1a"><mrow id="S2.SS1.p1.8.m3.1.2.2" xref="S2.SS1.p1.8.m3.1.2.1.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m3.1.2.2.1" xref="S2.SS1.p1.8.m3.1.2.1.1.cmml">⌊</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p1.8.m3.1.1" xref="S2.SS1.p1.8.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS1.p1.8.m3.1.2.2.2" xref="S2.SS1.p1.8.m3.1.2.1.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m3.1b"><apply id="S2.SS1.p1.8.m3.1.2.1.cmml" xref="S2.SS1.p1.8.m3.1.2.2"><floor id="S2.SS1.p1.8.m3.1.2.1.1.cmml" xref="S2.SS1.p1.8.m3.1.2.2.1"></floor><ci id="S2.SS1.p1.8.m3.1.1.cmml" xref="S2.SS1.p1.8.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m3.1c">\lfloor\cdot\rfloor</annotation></semantics></math> denote the modulus and floor operators. On the other hand, the channel <math id="S2.SS1.p1.9.m4.1" class="ltx_Math" alttext="\mathbf{h}\in\mathbb{C}^{N}" display="inline"><semantics id="S2.SS1.p1.9.m4.1a"><mrow id="S2.SS1.p1.9.m4.1.1" xref="S2.SS1.p1.9.m4.1.1.cmml"><mi id="S2.SS1.p1.9.m4.1.1.2" xref="S2.SS1.p1.9.m4.1.1.2.cmml">𝐡</mi><mo id="S2.SS1.p1.9.m4.1.1.1" xref="S2.SS1.p1.9.m4.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.9.m4.1.1.3" xref="S2.SS1.p1.9.m4.1.1.3.cmml"><mi id="S2.SS1.p1.9.m4.1.1.3.2" xref="S2.SS1.p1.9.m4.1.1.3.2.cmml">ℂ</mi><mi id="S2.SS1.p1.9.m4.1.1.3.3" xref="S2.SS1.p1.9.m4.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m4.1b"><apply id="S2.SS1.p1.9.m4.1.1.cmml" xref="S2.SS1.p1.9.m4.1.1"><in id="S2.SS1.p1.9.m4.1.1.1.cmml" xref="S2.SS1.p1.9.m4.1.1.1"></in><ci id="S2.SS1.p1.9.m4.1.1.2.cmml" xref="S2.SS1.p1.9.m4.1.1.2">𝐡</ci><apply id="S2.SS1.p1.9.m4.1.1.3.cmml" xref="S2.SS1.p1.9.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m4.1.1.3.1.cmml" xref="S2.SS1.p1.9.m4.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.9.m4.1.1.3.2.cmml" xref="S2.SS1.p1.9.m4.1.1.3.2">ℂ</ci><ci id="S2.SS1.p1.9.m4.1.1.3.3.cmml" xref="S2.SS1.p1.9.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m4.1c">\mathbf{h}\in\mathbb{C}^{N}</annotation></semantics></math> between the Tx and the RIS will have both LoS and non line-of-sight (NLoS) components. Therefore, we model <math id="S2.SS1.p1.10.m5.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S2.SS1.p1.10.m5.1a"><mi id="S2.SS1.p1.10.m5.1.1" xref="S2.SS1.p1.10.m5.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m5.1b"><ci id="S2.SS1.p1.10.m5.1.1.cmml" xref="S2.SS1.p1.10.m5.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m5.1c">\mathbf{h}</annotation></semantics></math> using Rician fading with spatial correlation, since the RIS elements are closely distanced. Accordingly, we have:</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\mathbf{h}=\sqrt{\alpha_{t}}\,\left(\sqrt{\frac{\kappa}{1+\kappa}}\,\overline{\mathbf{h}}+\sqrt{\frac{1}{1+\kappa}}\,\widetilde{\mathbf{h}}\right)," display="block"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.cmml">𝐡</mi><mo id="S2.E5.m1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><msqrt id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml"><msub id="S2.E5.m1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.3.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.3.2.2" xref="S2.E5.m1.1.1.1.1.1.3.2.2.cmml">α</mi><mi id="S2.E5.m1.1.1.1.1.1.3.2.3" xref="S2.E5.m1.1.1.1.1.1.3.2.3.cmml">t</mi></msub></msqrt><mo lspace="0.170em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml"><msqrt id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mfrac id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">κ</mi><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mn id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">1</mn><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">+</mo><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">κ</mi></mrow></mfrac></msqrt><mo lspace="0.170em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.1.1.1.2.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mover accent="true" id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">𝐡</mi><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">¯</mo></mover></mrow><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml"><msqrt id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mfrac id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mn id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">1</mn><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml"><mn id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml">1</mn><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.1.cmml">+</mo><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml">κ</mi></mrow></mfrac></msqrt><mo lspace="0.170em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.1.1.1.3.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mover accent="true" id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐡</mi><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><mo id="S2.E5.m1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.2"></eq><ci id="S2.E5.m1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3">𝐡</ci><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2"></times><apply id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3"><root id="S2.E5.m1.1.1.1.1.1.3a.cmml" xref="S2.E5.m1.1.1.1.1.1.3"></root><apply id="S2.E5.m1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="S2.E5.m1.1.1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1"><plus id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2"><times id="S2.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2"><root id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2"></root><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2"><divide id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2"></divide><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝜅</ci><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3"><plus id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1"></plus><cn type="integer" id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2">1</cn><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝜅</ci></apply></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3"><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.1">¯</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.3.2">𝐡</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3"><times id="S2.E5.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2"><root id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2"></root><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2"><divide id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2"></divide><cn type="integer" id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.2">1</cn><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3"><plus id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.1"></plus><cn type="integer" id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.2">1</cn><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.2.2.3.3">𝜅</ci></apply></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3"><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.1">~</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.3.2">𝐡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\mathbf{h}=\sqrt{\alpha_{t}}\,\left(\sqrt{\frac{\kappa}{1+\kappa}}\,\overline{\mathbf{h}}+\sqrt{\frac{1}{1+\kappa}}\,\widetilde{\mathbf{h}}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.14" class="ltx_p">where <math id="S2.SS1.p1.11.m1.1" class="ltx_Math" alttext="\alpha_{t}" display="inline"><semantics id="S2.SS1.p1.11.m1.1a"><msub id="S2.SS1.p1.11.m1.1.1" xref="S2.SS1.p1.11.m1.1.1.cmml"><mi id="S2.SS1.p1.11.m1.1.1.2" xref="S2.SS1.p1.11.m1.1.1.2.cmml">α</mi><mi id="S2.SS1.p1.11.m1.1.1.3" xref="S2.SS1.p1.11.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m1.1b"><apply id="S2.SS1.p1.11.m1.1.1.cmml" xref="S2.SS1.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m1.1.1.1.cmml" xref="S2.SS1.p1.11.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m1.1.1.2.cmml" xref="S2.SS1.p1.11.m1.1.1.2">𝛼</ci><ci id="S2.SS1.p1.11.m1.1.1.3.cmml" xref="S2.SS1.p1.11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m1.1c">\alpha_{t}</annotation></semantics></math> and <math id="S2.SS1.p1.12.m2.1" class="ltx_Math" alttext="\kappa" display="inline"><semantics id="S2.SS1.p1.12.m2.1a"><mi id="S2.SS1.p1.12.m2.1.1" xref="S2.SS1.p1.12.m2.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m2.1b"><ci id="S2.SS1.p1.12.m2.1.1.cmml" xref="S2.SS1.p1.12.m2.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m2.1c">\kappa</annotation></semantics></math> are the path-loss and the Rician coefficient respectively, <math id="S2.SS1.p1.13.m3.1" class="ltx_Math" alttext="\overline{\mathbf{h}}" display="inline"><semantics id="S2.SS1.p1.13.m3.1a"><mover accent="true" id="S2.SS1.p1.13.m3.1.1" xref="S2.SS1.p1.13.m3.1.1.cmml"><mi id="S2.SS1.p1.13.m3.1.1.2" xref="S2.SS1.p1.13.m3.1.1.2.cmml">𝐡</mi><mo id="S2.SS1.p1.13.m3.1.1.1" xref="S2.SS1.p1.13.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m3.1b"><apply id="S2.SS1.p1.13.m3.1.1.cmml" xref="S2.SS1.p1.13.m3.1.1"><ci id="S2.SS1.p1.13.m3.1.1.1.cmml" xref="S2.SS1.p1.13.m3.1.1.1">¯</ci><ci id="S2.SS1.p1.13.m3.1.1.2.cmml" xref="S2.SS1.p1.13.m3.1.1.2">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m3.1c">\overline{\mathbf{h}}</annotation></semantics></math> is the LoS factor, and <math id="S2.SS1.p1.14.m4.1" class="ltx_Math" alttext="\widetilde{\mathbf{h}}" display="inline"><semantics id="S2.SS1.p1.14.m4.1a"><mover accent="true" id="S2.SS1.p1.14.m4.1.1" xref="S2.SS1.p1.14.m4.1.1.cmml"><mi id="S2.SS1.p1.14.m4.1.1.2" xref="S2.SS1.p1.14.m4.1.1.2.cmml">𝐡</mi><mo id="S2.SS1.p1.14.m4.1.1.1" xref="S2.SS1.p1.14.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m4.1b"><apply id="S2.SS1.p1.14.m4.1.1.cmml" xref="S2.SS1.p1.14.m4.1.1"><ci id="S2.SS1.p1.14.m4.1.1.1.cmml" xref="S2.SS1.p1.14.m4.1.1.1">~</ci><ci id="S2.SS1.p1.14.m4.1.1.2.cmml" xref="S2.SS1.p1.14.m4.1.1.2">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m4.1c">\widetilde{\mathbf{h}}</annotation></semantics></math> represents the small scale fading process in the NLoS component. Further, for the LoS link, the LoS factor is:</p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\overline{\mathbf{h}}=\mathbf{a}_{N}\left(\varphi_{t},\vartheta_{t}\right)," display="block"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mover accent="true" id="S2.E6.m1.1.1.1.1.4" xref="S2.E6.m1.1.1.1.1.4.cmml"><mi id="S2.E6.m1.1.1.1.1.4.2" xref="S2.E6.m1.1.1.1.1.4.2.cmml">𝐡</mi><mo id="S2.E6.m1.1.1.1.1.4.1" xref="S2.E6.m1.1.1.1.1.4.1.cmml">¯</mo></mover><mo id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.2.cmml"><msub id="S2.E6.m1.1.1.1.1.2.4" xref="S2.E6.m1.1.1.1.1.2.4.cmml"><mi id="S2.E6.m1.1.1.1.1.2.4.2" xref="S2.E6.m1.1.1.1.1.2.4.2.cmml">𝐚</mi><mi id="S2.E6.m1.1.1.1.1.2.4.3" xref="S2.E6.m1.1.1.1.1.2.4.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.1.1.2.3" xref="S2.E6.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.E6.m1.1.1.1.1.2.2.2" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.E6.m1.1.1.1.1.2.2.2.3" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E6.m1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml">φ</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E6.m1.1.1.1.1.2.2.2.4" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E6.m1.1.1.1.1.2.2.2.2" xref="S2.E6.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E6.m1.1.1.1.1.2.2.2.2.2" xref="S2.E6.m1.1.1.1.1.2.2.2.2.2.cmml">ϑ</mi><mi id="S2.E6.m1.1.1.1.1.2.2.2.2.3" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E6.m1.1.1.1.1.2.2.2.5" xref="S2.E6.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><eq id="S2.E6.m1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3"></eq><apply id="S2.E6.m1.1.1.1.1.4.cmml" xref="S2.E6.m1.1.1.1.1.4"><ci id="S2.E6.m1.1.1.1.1.4.1.cmml" xref="S2.E6.m1.1.1.1.1.4.1">¯</ci><ci id="S2.E6.m1.1.1.1.1.4.2.cmml" xref="S2.E6.m1.1.1.1.1.4.2">𝐡</ci></apply><apply id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2"><times id="S2.E6.m1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.3"></times><apply id="S2.E6.m1.1.1.1.1.2.4.cmml" xref="S2.E6.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.4.1.cmml" xref="S2.E6.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.2.4.2.cmml" xref="S2.E6.m1.1.1.1.1.2.4.2">𝐚</ci><ci id="S2.E6.m1.1.1.1.1.2.4.3.cmml" xref="S2.E6.m1.1.1.1.1.2.4.3">𝑁</ci></apply><interval closure="open" id="S2.E6.m1.1.1.1.1.2.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2"><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2">𝜑</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E6.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2.2">italic-ϑ</ci><ci id="S2.E6.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\overline{\mathbf{h}}=\mathbf{a}_{N}\left(\varphi_{t},\vartheta_{t}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.18" class="ltx_p">where <math id="S2.SS1.p1.15.m1.2" class="ltx_Math" alttext="\left(\varphi_{t},\vartheta_{t}\right)" display="inline"><semantics id="S2.SS1.p1.15.m1.2a"><mrow id="S2.SS1.p1.15.m1.2.2.2" xref="S2.SS1.p1.15.m1.2.2.3.cmml"><mo id="S2.SS1.p1.15.m1.2.2.2.3" xref="S2.SS1.p1.15.m1.2.2.3.cmml">(</mo><msub id="S2.SS1.p1.15.m1.1.1.1.1" xref="S2.SS1.p1.15.m1.1.1.1.1.cmml"><mi id="S2.SS1.p1.15.m1.1.1.1.1.2" xref="S2.SS1.p1.15.m1.1.1.1.1.2.cmml">φ</mi><mi id="S2.SS1.p1.15.m1.1.1.1.1.3" xref="S2.SS1.p1.15.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS1.p1.15.m1.2.2.2.4" xref="S2.SS1.p1.15.m1.2.2.3.cmml">,</mo><msub id="S2.SS1.p1.15.m1.2.2.2.2" xref="S2.SS1.p1.15.m1.2.2.2.2.cmml"><mi id="S2.SS1.p1.15.m1.2.2.2.2.2" xref="S2.SS1.p1.15.m1.2.2.2.2.2.cmml">ϑ</mi><mi id="S2.SS1.p1.15.m1.2.2.2.2.3" xref="S2.SS1.p1.15.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS1.p1.15.m1.2.2.2.5" xref="S2.SS1.p1.15.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m1.2b"><interval closure="open" id="S2.SS1.p1.15.m1.2.2.3.cmml" xref="S2.SS1.p1.15.m1.2.2.2"><apply id="S2.SS1.p1.15.m1.1.1.1.1.cmml" xref="S2.SS1.p1.15.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m1.1.1.1.1.1.cmml" xref="S2.SS1.p1.15.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.15.m1.1.1.1.1.2.cmml" xref="S2.SS1.p1.15.m1.1.1.1.1.2">𝜑</ci><ci id="S2.SS1.p1.15.m1.1.1.1.1.3.cmml" xref="S2.SS1.p1.15.m1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS1.p1.15.m1.2.2.2.2.cmml" xref="S2.SS1.p1.15.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m1.2.2.2.2.1.cmml" xref="S2.SS1.p1.15.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.15.m1.2.2.2.2.2.cmml" xref="S2.SS1.p1.15.m1.2.2.2.2.2">italic-ϑ</ci><ci id="S2.SS1.p1.15.m1.2.2.2.2.3.cmml" xref="S2.SS1.p1.15.m1.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m1.2c">\left(\varphi_{t},\vartheta_{t}\right)</annotation></semantics></math> are the angles-of-arrival (AoA) to the RIS. We model the NLoS link as <math id="S2.SS1.p1.16.m2.2" class="ltx_Math" alttext="\widetilde{\mathbf{h}}\sim\mathcal{CN}\left(\mathbf{0}_{N},\mathbf{R}\right)" display="inline"><semantics id="S2.SS1.p1.16.m2.2a"><mrow id="S2.SS1.p1.16.m2.2.2" xref="S2.SS1.p1.16.m2.2.2.cmml"><mover accent="true" id="S2.SS1.p1.16.m2.2.2.3" xref="S2.SS1.p1.16.m2.2.2.3.cmml"><mi id="S2.SS1.p1.16.m2.2.2.3.2" xref="S2.SS1.p1.16.m2.2.2.3.2.cmml">𝐡</mi><mo id="S2.SS1.p1.16.m2.2.2.3.1" xref="S2.SS1.p1.16.m2.2.2.3.1.cmml">~</mo></mover><mo id="S2.SS1.p1.16.m2.2.2.2" xref="S2.SS1.p1.16.m2.2.2.2.cmml">∼</mo><mrow id="S2.SS1.p1.16.m2.2.2.1" xref="S2.SS1.p1.16.m2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.16.m2.2.2.1.3" xref="S2.SS1.p1.16.m2.2.2.1.3.cmml">𝒞</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.16.m2.2.2.1.2" xref="S2.SS1.p1.16.m2.2.2.1.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.16.m2.2.2.1.4" xref="S2.SS1.p1.16.m2.2.2.1.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.16.m2.2.2.1.2a" xref="S2.SS1.p1.16.m2.2.2.1.2.cmml">​</mo><mrow id="S2.SS1.p1.16.m2.2.2.1.1.1" xref="S2.SS1.p1.16.m2.2.2.1.1.2.cmml"><mo id="S2.SS1.p1.16.m2.2.2.1.1.1.2" xref="S2.SS1.p1.16.m2.2.2.1.1.2.cmml">(</mo><msub id="S2.SS1.p1.16.m2.2.2.1.1.1.1" xref="S2.SS1.p1.16.m2.2.2.1.1.1.1.cmml"><mn id="S2.SS1.p1.16.m2.2.2.1.1.1.1.2" xref="S2.SS1.p1.16.m2.2.2.1.1.1.1.2.cmml">𝟎</mn><mi id="S2.SS1.p1.16.m2.2.2.1.1.1.1.3" xref="S2.SS1.p1.16.m2.2.2.1.1.1.1.3.cmml">N</mi></msub><mo id="S2.SS1.p1.16.m2.2.2.1.1.1.3" xref="S2.SS1.p1.16.m2.2.2.1.1.2.cmml">,</mo><mi id="S2.SS1.p1.16.m2.1.1" xref="S2.SS1.p1.16.m2.1.1.cmml">𝐑</mi><mo id="S2.SS1.p1.16.m2.2.2.1.1.1.4" xref="S2.SS1.p1.16.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m2.2b"><apply id="S2.SS1.p1.16.m2.2.2.cmml" xref="S2.SS1.p1.16.m2.2.2"><csymbol cd="latexml" id="S2.SS1.p1.16.m2.2.2.2.cmml" xref="S2.SS1.p1.16.m2.2.2.2">similar-to</csymbol><apply id="S2.SS1.p1.16.m2.2.2.3.cmml" xref="S2.SS1.p1.16.m2.2.2.3"><ci id="S2.SS1.p1.16.m2.2.2.3.1.cmml" xref="S2.SS1.p1.16.m2.2.2.3.1">~</ci><ci id="S2.SS1.p1.16.m2.2.2.3.2.cmml" xref="S2.SS1.p1.16.m2.2.2.3.2">𝐡</ci></apply><apply id="S2.SS1.p1.16.m2.2.2.1.cmml" xref="S2.SS1.p1.16.m2.2.2.1"><times id="S2.SS1.p1.16.m2.2.2.1.2.cmml" xref="S2.SS1.p1.16.m2.2.2.1.2"></times><ci id="S2.SS1.p1.16.m2.2.2.1.3.cmml" xref="S2.SS1.p1.16.m2.2.2.1.3">𝒞</ci><ci id="S2.SS1.p1.16.m2.2.2.1.4.cmml" xref="S2.SS1.p1.16.m2.2.2.1.4">𝒩</ci><interval closure="open" id="S2.SS1.p1.16.m2.2.2.1.1.2.cmml" xref="S2.SS1.p1.16.m2.2.2.1.1.1"><apply id="S2.SS1.p1.16.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.16.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p1.16.m2.2.2.1.1.1.1">subscript</csymbol><cn type="integer" id="S2.SS1.p1.16.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p1.16.m2.2.2.1.1.1.1.2">0</cn><ci id="S2.SS1.p1.16.m2.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p1.16.m2.2.2.1.1.1.1.3">𝑁</ci></apply><ci id="S2.SS1.p1.16.m2.1.1.cmml" xref="S2.SS1.p1.16.m2.1.1">𝐑</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m2.2c">\widetilde{\mathbf{h}}\sim\mathcal{CN}\left(\mathbf{0}_{N},\mathbf{R}\right)</annotation></semantics></math>, where <math id="S2.SS1.p1.17.m3.1" class="ltx_Math" alttext="\mathbf{R}" display="inline"><semantics id="S2.SS1.p1.17.m3.1a"><mi id="S2.SS1.p1.17.m3.1.1" xref="S2.SS1.p1.17.m3.1.1.cmml">𝐑</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m3.1b"><ci id="S2.SS1.p1.17.m3.1.1.cmml" xref="S2.SS1.p1.17.m3.1.1">𝐑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m3.1c">\mathbf{R}</annotation></semantics></math> is a covariance matrix that captures the spatial correlation among the channels of the RIS elements. In the case of isotropic scattering in front of the RIS, a closed-form expression for <math id="S2.SS1.p1.18.m4.1" class="ltx_Math" alttext="\mathbf{R}" display="inline"><semantics id="S2.SS1.p1.18.m4.1a"><mi id="S2.SS1.p1.18.m4.1.1" xref="S2.SS1.p1.18.m4.1.1.cmml">𝐑</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m4.1b"><ci id="S2.SS1.p1.18.m4.1.1.cmml" xref="S2.SS1.p1.18.m4.1.1">𝐑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m4.1c">\mathbf{R}</annotation></semantics></math> is <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, Proposition 1]</cite>:</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.9" class="ltx_Math" alttext="\left[\mathbf{R}\right]_{m,n}=\mathrm{sinc}\left(\frac{2\,\lvert\mathbf{u}_{m}-\mathbf{u}_{n}\rvert}{\lambda}\right)\qquad m,n=1,\dots,N," display="block"><semantics id="S2.E7.m1.9a"><mrow id="S2.E7.m1.9.9.1"><mrow id="S2.E7.m1.9.9.1.1.2" xref="S2.E7.m1.9.9.1.1.3.cmml"><mrow id="S2.E7.m1.9.9.1.1.1.1" xref="S2.E7.m1.9.9.1.1.1.1.cmml"><msub id="S2.E7.m1.9.9.1.1.1.1.3" xref="S2.E7.m1.9.9.1.1.1.1.3.cmml"><mrow id="S2.E7.m1.9.9.1.1.1.1.3.2.2" xref="S2.E7.m1.9.9.1.1.1.1.3.2.1.cmml"><mo id="S2.E7.m1.9.9.1.1.1.1.3.2.2.1" xref="S2.E7.m1.9.9.1.1.1.1.3.2.1.1.cmml">[</mo><mi id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml">𝐑</mi><mo id="S2.E7.m1.9.9.1.1.1.1.3.2.2.2" xref="S2.E7.m1.9.9.1.1.1.1.3.2.1.1.cmml">]</mo></mrow><mrow id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.3.cmml"><mi id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">m</mi><mo id="S2.E7.m1.2.2.2.4.1" xref="S2.E7.m1.2.2.2.3.cmml">,</mo><mi id="S2.E7.m1.2.2.2.2" xref="S2.E7.m1.2.2.2.2.cmml">n</mi></mrow></msub><mo id="S2.E7.m1.9.9.1.1.1.1.2" xref="S2.E7.m1.9.9.1.1.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.9.9.1.1.1.1.1.1" xref="S2.E7.m1.9.9.1.1.1.1.1.2.cmml"><mrow id="S2.E7.m1.9.9.1.1.1.1.1.1.1" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.9.9.1.1.1.1.1.1.1.2" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1.2.cmml">sinc</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E7.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.3.3.cmml"><mo id="S2.E7.m1.9.9.1.1.1.1.1.1.1.3.2.1" xref="S2.E7.m1.3.3.cmml">(</mo><mfrac id="S2.E7.m1.3.3" xref="S2.E7.m1.3.3.cmml"><mrow id="S2.E7.m1.3.3.1" xref="S2.E7.m1.3.3.1.cmml"><mn id="S2.E7.m1.3.3.1.3" xref="S2.E7.m1.3.3.1.3.cmml">2</mn><mo lspace="0.170em" rspace="0em" id="S2.E7.m1.3.3.1.2" xref="S2.E7.m1.3.3.1.2.cmml">​</mo><mrow id="S2.E7.m1.3.3.1.1.1" xref="S2.E7.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E7.m1.3.3.1.1.1.2" xref="S2.E7.m1.3.3.1.1.2.1.cmml">|</mo><mrow id="S2.E7.m1.3.3.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.cmml"><msub id="S2.E7.m1.3.3.1.1.1.1.2" xref="S2.E7.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.E7.m1.3.3.1.1.1.1.2.2" xref="S2.E7.m1.3.3.1.1.1.1.2.2.cmml">𝐮</mi><mi id="S2.E7.m1.3.3.1.1.1.1.2.3" xref="S2.E7.m1.3.3.1.1.1.1.2.3.cmml">m</mi></msub><mo id="S2.E7.m1.3.3.1.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.1.cmml">−</mo><msub id="S2.E7.m1.3.3.1.1.1.1.3" xref="S2.E7.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E7.m1.3.3.1.1.1.1.3.2" xref="S2.E7.m1.3.3.1.1.1.1.3.2.cmml">𝐮</mi><mi id="S2.E7.m1.3.3.1.1.1.1.3.3" xref="S2.E7.m1.3.3.1.1.1.1.3.3.cmml">n</mi></msub></mrow><mo stretchy="false" id="S2.E7.m1.3.3.1.1.1.3" xref="S2.E7.m1.3.3.1.1.2.1.cmml">|</mo></mrow></mrow><mi id="S2.E7.m1.3.3.3" xref="S2.E7.m1.3.3.3.cmml">λ</mi></mfrac><mo id="S2.E7.m1.9.9.1.1.1.1.1.1.1.3.2.2" xref="S2.E7.m1.3.3.cmml">)</mo></mrow></mrow><mspace width="2em" id="S2.E7.m1.9.9.1.1.1.1.1.1.2" xref="S2.E7.m1.9.9.1.1.1.1.1.2.cmml"></mspace><mi id="S2.E7.m1.8.8" xref="S2.E7.m1.8.8.cmml">m</mi></mrow></mrow><mo id="S2.E7.m1.9.9.1.1.2.3" xref="S2.E7.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S2.E7.m1.9.9.1.1.2.2" xref="S2.E7.m1.9.9.1.1.2.2.cmml"><mi id="S2.E7.m1.9.9.1.1.2.2.2" xref="S2.E7.m1.9.9.1.1.2.2.2.cmml">n</mi><mo id="S2.E7.m1.9.9.1.1.2.2.1" xref="S2.E7.m1.9.9.1.1.2.2.1.cmml">=</mo><mrow id="S2.E7.m1.9.9.1.1.2.2.3.2" xref="S2.E7.m1.9.9.1.1.2.2.3.1.cmml"><mn id="S2.E7.m1.5.5" xref="S2.E7.m1.5.5.cmml">1</mn><mo id="S2.E7.m1.9.9.1.1.2.2.3.2.1" xref="S2.E7.m1.9.9.1.1.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.E7.m1.6.6" xref="S2.E7.m1.6.6.cmml">…</mi><mo id="S2.E7.m1.9.9.1.1.2.2.3.2.2" xref="S2.E7.m1.9.9.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E7.m1.7.7" xref="S2.E7.m1.7.7.cmml">N</mi></mrow></mrow></mrow><mo id="S2.E7.m1.9.9.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.9b"><apply id="S2.E7.m1.9.9.1.1.3.cmml" xref="S2.E7.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.9.9.1.1.3a.cmml" xref="S2.E7.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E7.m1.9.9.1.1.1.1.cmml" xref="S2.E7.m1.9.9.1.1.1.1"><eq id="S2.E7.m1.9.9.1.1.1.1.2.cmml" xref="S2.E7.m1.9.9.1.1.1.1.2"></eq><apply id="S2.E7.m1.9.9.1.1.1.1.3.cmml" xref="S2.E7.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.9.9.1.1.1.1.3.1.cmml" xref="S2.E7.m1.9.9.1.1.1.1.3">subscript</csymbol><apply id="S2.E7.m1.9.9.1.1.1.1.3.2.1.cmml" xref="S2.E7.m1.9.9.1.1.1.1.3.2.2"><csymbol cd="latexml" id="S2.E7.m1.9.9.1.1.1.1.3.2.1.1.cmml" xref="S2.E7.m1.9.9.1.1.1.1.3.2.2.1">delimited-[]</csymbol><ci id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4">𝐑</ci></apply><list id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.4"><ci id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1">𝑚</ci><ci id="S2.E7.m1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2">𝑛</ci></list></apply><list id="S2.E7.m1.9.9.1.1.1.1.1.2.cmml" xref="S2.E7.m1.9.9.1.1.1.1.1.1"><apply id="S2.E7.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1"><times id="S2.E7.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1.1"></times><ci id="S2.E7.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1.2">sinc</ci><apply id="S2.E7.m1.3.3.cmml" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1.3.2"><divide id="S2.E7.m1.3.3.2.cmml" xref="S2.E7.m1.9.9.1.1.1.1.1.1.1.3.2"></divide><apply id="S2.E7.m1.3.3.1.cmml" xref="S2.E7.m1.3.3.1"><times id="S2.E7.m1.3.3.1.2.cmml" xref="S2.E7.m1.3.3.1.2"></times><cn type="integer" id="S2.E7.m1.3.3.1.3.cmml" xref="S2.E7.m1.3.3.1.3">2</cn><apply id="S2.E7.m1.3.3.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.1"><abs id="S2.E7.m1.3.3.1.1.2.1.cmml" xref="S2.E7.m1.3.3.1.1.1.2"></abs><apply id="S2.E7.m1.3.3.1.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1"><minus id="S2.E7.m1.3.3.1.1.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1"></minus><apply id="S2.E7.m1.3.3.1.1.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.2">𝐮</ci><ci id="S2.E7.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.3">𝑚</ci></apply><apply id="S2.E7.m1.3.3.1.1.1.1.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.3.2">𝐮</ci><ci id="S2.E7.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply><ci id="S2.E7.m1.3.3.3.cmml" xref="S2.E7.m1.3.3.3">𝜆</ci></apply></apply><ci id="S2.E7.m1.8.8.cmml" xref="S2.E7.m1.8.8">𝑚</ci></list></apply><apply id="S2.E7.m1.9.9.1.1.2.2.cmml" xref="S2.E7.m1.9.9.1.1.2.2"><eq id="S2.E7.m1.9.9.1.1.2.2.1.cmml" xref="S2.E7.m1.9.9.1.1.2.2.1"></eq><ci id="S2.E7.m1.9.9.1.1.2.2.2.cmml" xref="S2.E7.m1.9.9.1.1.2.2.2">𝑛</ci><list id="S2.E7.m1.9.9.1.1.2.2.3.1.cmml" xref="S2.E7.m1.9.9.1.1.2.2.3.2"><cn type="integer" id="S2.E7.m1.5.5.cmml" xref="S2.E7.m1.5.5">1</cn><ci id="S2.E7.m1.6.6.cmml" xref="S2.E7.m1.6.6">…</ci><ci id="S2.E7.m1.7.7.cmml" xref="S2.E7.m1.7.7">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.9c">\left[\mathbf{R}\right]_{m,n}=\mathrm{sinc}\left(\frac{2\,\lvert\mathbf{u}_{m}-\mathbf{u}_{n}\rvert}{\lambda}\right)\qquad m,n=1,\dots,N,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.23" class="ltx_p">where <math id="S2.SS1.p1.19.m1.4" class="ltx_Math" alttext="\mathbf{u}_{n}=\left[i_{N}(n)\,d_{\mathrm{x}},j_{N}(n)\,d_{\mathrm{y}}\right]^{\mathsf{T}}" display="inline"><semantics id="S2.SS1.p1.19.m1.4a"><mrow id="S2.SS1.p1.19.m1.4.4" xref="S2.SS1.p1.19.m1.4.4.cmml"><msub id="S2.SS1.p1.19.m1.4.4.4" xref="S2.SS1.p1.19.m1.4.4.4.cmml"><mi id="S2.SS1.p1.19.m1.4.4.4.2" xref="S2.SS1.p1.19.m1.4.4.4.2.cmml">𝐮</mi><mi id="S2.SS1.p1.19.m1.4.4.4.3" xref="S2.SS1.p1.19.m1.4.4.4.3.cmml">n</mi></msub><mo id="S2.SS1.p1.19.m1.4.4.3" xref="S2.SS1.p1.19.m1.4.4.3.cmml">=</mo><msup id="S2.SS1.p1.19.m1.4.4.2" xref="S2.SS1.p1.19.m1.4.4.2.cmml"><mrow id="S2.SS1.p1.19.m1.4.4.2.2.2" xref="S2.SS1.p1.19.m1.4.4.2.2.3.cmml"><mo id="S2.SS1.p1.19.m1.4.4.2.2.2.3" xref="S2.SS1.p1.19.m1.4.4.2.2.3.cmml">[</mo><mrow id="S2.SS1.p1.19.m1.3.3.1.1.1.1" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.cmml"><msub id="S2.SS1.p1.19.m1.3.3.1.1.1.1.2" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.2" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.2.cmml">i</mi><mi id="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.3" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.19.m1.3.3.1.1.1.1.1" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS1.p1.19.m1.3.3.1.1.1.1.3.2" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.19.m1.3.3.1.1.1.1.3.2.1" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S2.SS1.p1.19.m1.1.1" xref="S2.SS1.p1.19.m1.1.1.cmml">n</mi><mo stretchy="false" id="S2.SS1.p1.19.m1.3.3.1.1.1.1.3.2.2" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.170em" rspace="0em" id="S2.SS1.p1.19.m1.3.3.1.1.1.1.1a" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.1.cmml">​</mo><msub id="S2.SS1.p1.19.m1.3.3.1.1.1.1.4" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.cmml"><mi id="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.2" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.2.cmml">d</mi><mi mathvariant="normal" id="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.3" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.3.cmml">x</mi></msub></mrow><mo id="S2.SS1.p1.19.m1.4.4.2.2.2.4" xref="S2.SS1.p1.19.m1.4.4.2.2.3.cmml">,</mo><mrow id="S2.SS1.p1.19.m1.4.4.2.2.2.2" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.cmml"><msub id="S2.SS1.p1.19.m1.4.4.2.2.2.2.2" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.2" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.2.cmml">j</mi><mi id="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.3" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.19.m1.4.4.2.2.2.2.1" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.1.cmml">​</mo><mrow id="S2.SS1.p1.19.m1.4.4.2.2.2.2.3.2" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.cmml"><mo stretchy="false" id="S2.SS1.p1.19.m1.4.4.2.2.2.2.3.2.1" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.cmml">(</mo><mi id="S2.SS1.p1.19.m1.2.2" xref="S2.SS1.p1.19.m1.2.2.cmml">n</mi><mo stretchy="false" id="S2.SS1.p1.19.m1.4.4.2.2.2.2.3.2.2" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.cmml">)</mo></mrow><mo lspace="0.170em" rspace="0em" id="S2.SS1.p1.19.m1.4.4.2.2.2.2.1a" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.1.cmml">​</mo><msub id="S2.SS1.p1.19.m1.4.4.2.2.2.2.4" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.cmml"><mi id="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.2" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.2.cmml">d</mi><mi mathvariant="normal" id="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.3" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.3.cmml">y</mi></msub></mrow><mo id="S2.SS1.p1.19.m1.4.4.2.2.2.5" xref="S2.SS1.p1.19.m1.4.4.2.2.3.cmml">]</mo></mrow><mi id="S2.SS1.p1.19.m1.4.4.2.4" xref="S2.SS1.p1.19.m1.4.4.2.4.cmml">𝖳</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.19.m1.4b"><apply id="S2.SS1.p1.19.m1.4.4.cmml" xref="S2.SS1.p1.19.m1.4.4"><eq id="S2.SS1.p1.19.m1.4.4.3.cmml" xref="S2.SS1.p1.19.m1.4.4.3"></eq><apply id="S2.SS1.p1.19.m1.4.4.4.cmml" xref="S2.SS1.p1.19.m1.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m1.4.4.4.1.cmml" xref="S2.SS1.p1.19.m1.4.4.4">subscript</csymbol><ci id="S2.SS1.p1.19.m1.4.4.4.2.cmml" xref="S2.SS1.p1.19.m1.4.4.4.2">𝐮</ci><ci id="S2.SS1.p1.19.m1.4.4.4.3.cmml" xref="S2.SS1.p1.19.m1.4.4.4.3">𝑛</ci></apply><apply id="S2.SS1.p1.19.m1.4.4.2.cmml" xref="S2.SS1.p1.19.m1.4.4.2"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m1.4.4.2.3.cmml" xref="S2.SS1.p1.19.m1.4.4.2">superscript</csymbol><interval closure="closed" id="S2.SS1.p1.19.m1.4.4.2.2.3.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2"><apply id="S2.SS1.p1.19.m1.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1"><times id="S2.SS1.p1.19.m1.3.3.1.1.1.1.1.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.1"></times><apply id="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.2">𝑖</ci><ci id="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.2.3">𝑁</ci></apply><ci id="S2.SS1.p1.19.m1.1.1.cmml" xref="S2.SS1.p1.19.m1.1.1">𝑛</ci><apply id="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.1.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.2.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.2">𝑑</ci><ci id="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.3.cmml" xref="S2.SS1.p1.19.m1.3.3.1.1.1.1.4.3">x</ci></apply></apply><apply id="S2.SS1.p1.19.m1.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2"><times id="S2.SS1.p1.19.m1.4.4.2.2.2.2.1.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.1"></times><apply id="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.2">𝑗</ci><ci id="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.2.3">𝑁</ci></apply><ci id="S2.SS1.p1.19.m1.2.2.cmml" xref="S2.SS1.p1.19.m1.2.2">𝑛</ci><apply id="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.1.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.4">subscript</csymbol><ci id="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.2.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.2">𝑑</ci><ci id="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.3.cmml" xref="S2.SS1.p1.19.m1.4.4.2.2.2.2.4.3">y</ci></apply></apply></interval><ci id="S2.SS1.p1.19.m1.4.4.2.4.cmml" xref="S2.SS1.p1.19.m1.4.4.2.4">𝖳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.19.m1.4c">\mathbf{u}_{n}=\left[i_{N}(n)\,d_{\mathrm{x}},j_{N}(n)\,d_{\mathrm{y}}\right]^{\mathsf{T}}</annotation></semantics></math> represents the locations of the <math id="S2.SS1.p1.20.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p1.20.m2.1a"><mi id="S2.SS1.p1.20.m2.1.1" xref="S2.SS1.p1.20.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.20.m2.1b"><ci id="S2.SS1.p1.20.m2.1.1.cmml" xref="S2.SS1.p1.20.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.20.m2.1c">n</annotation></semantics></math><sup id="S2.SS1.p1.23.1" class="ltx_sup">th</sup> element with <math id="S2.SS1.p1.21.m3.1" class="ltx_Math" alttext="i_{N}" display="inline"><semantics id="S2.SS1.p1.21.m3.1a"><msub id="S2.SS1.p1.21.m3.1.1" xref="S2.SS1.p1.21.m3.1.1.cmml"><mi id="S2.SS1.p1.21.m3.1.1.2" xref="S2.SS1.p1.21.m3.1.1.2.cmml">i</mi><mi id="S2.SS1.p1.21.m3.1.1.3" xref="S2.SS1.p1.21.m3.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.21.m3.1b"><apply id="S2.SS1.p1.21.m3.1.1.cmml" xref="S2.SS1.p1.21.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.21.m3.1.1.1.cmml" xref="S2.SS1.p1.21.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.21.m3.1.1.2.cmml" xref="S2.SS1.p1.21.m3.1.1.2">𝑖</ci><ci id="S2.SS1.p1.21.m3.1.1.3.cmml" xref="S2.SS1.p1.21.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.21.m3.1c">i_{N}</annotation></semantics></math> and <math id="S2.SS1.p1.22.m4.1" class="ltx_Math" alttext="j_{N}" display="inline"><semantics id="S2.SS1.p1.22.m4.1a"><msub id="S2.SS1.p1.22.m4.1.1" xref="S2.SS1.p1.22.m4.1.1.cmml"><mi id="S2.SS1.p1.22.m4.1.1.2" xref="S2.SS1.p1.22.m4.1.1.2.cmml">j</mi><mi id="S2.SS1.p1.22.m4.1.1.3" xref="S2.SS1.p1.22.m4.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.22.m4.1b"><apply id="S2.SS1.p1.22.m4.1.1.cmml" xref="S2.SS1.p1.22.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.22.m4.1.1.1.cmml" xref="S2.SS1.p1.22.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.22.m4.1.1.2.cmml" xref="S2.SS1.p1.22.m4.1.1.2">𝑗</ci><ci id="S2.SS1.p1.22.m4.1.1.3.cmml" xref="S2.SS1.p1.22.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.22.m4.1c">j_{N}</annotation></semantics></math> being the horizontal and vertical indices given in (<a href="#S2.E4" title="In II-A Channel Model ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), and <math id="S2.SS1.p1.23.m5.1" class="ltx_Math" alttext="\mathrm{sinc}(\cdot)" display="inline"><semantics id="S2.SS1.p1.23.m5.1a"><mrow id="S2.SS1.p1.23.m5.1.2" xref="S2.SS1.p1.23.m5.1.2.cmml"><mi id="S2.SS1.p1.23.m5.1.2.2" xref="S2.SS1.p1.23.m5.1.2.2.cmml">sinc</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.23.m5.1.2.1" xref="S2.SS1.p1.23.m5.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.23.m5.1.2.3.2" xref="S2.SS1.p1.23.m5.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.23.m5.1.2.3.2.1" xref="S2.SS1.p1.23.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p1.23.m5.1.1" xref="S2.SS1.p1.23.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS1.p1.23.m5.1.2.3.2.2" xref="S2.SS1.p1.23.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.23.m5.1b"><apply id="S2.SS1.p1.23.m5.1.2.cmml" xref="S2.SS1.p1.23.m5.1.2"><times id="S2.SS1.p1.23.m5.1.2.1.cmml" xref="S2.SS1.p1.23.m5.1.2.1"></times><ci id="S2.SS1.p1.23.m5.1.2.2.cmml" xref="S2.SS1.p1.23.m5.1.2.2">sinc</ci><ci id="S2.SS1.p1.23.m5.1.1.cmml" xref="S2.SS1.p1.23.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.23.m5.1c">\mathrm{sinc}(\cdot)</annotation></semantics></math> is the normalized sampling function.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Downlink Rate Maximization</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.2" class="ltx_p">At every transmission slot, in each environment <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">r</mi><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><in id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></in><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝑟</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">r\in\mathcal{R}</annotation></semantics></math>, the RIS selects its phases in order to enhance the downlink rate at the Rx.
Let <math id="S2.SS2.p1.2.m2.3" class="ltx_Math" alttext="\bm{\theta}^{r}=\left[\theta_{1}^{r},\dots,\theta_{N}^{r}\right]^{\mathsf{T}}" display="inline"><semantics id="S2.SS2.p1.2.m2.3a"><mrow id="S2.SS2.p1.2.m2.3.3" xref="S2.SS2.p1.2.m2.3.3.cmml"><msup id="S2.SS2.p1.2.m2.3.3.4" xref="S2.SS2.p1.2.m2.3.3.4.cmml"><mi id="S2.SS2.p1.2.m2.3.3.4.2" xref="S2.SS2.p1.2.m2.3.3.4.2.cmml">𝜽</mi><mi id="S2.SS2.p1.2.m2.3.3.4.3" xref="S2.SS2.p1.2.m2.3.3.4.3.cmml">r</mi></msup><mo id="S2.SS2.p1.2.m2.3.3.3" xref="S2.SS2.p1.2.m2.3.3.3.cmml">=</mo><msup id="S2.SS2.p1.2.m2.3.3.2" xref="S2.SS2.p1.2.m2.3.3.2.cmml"><mrow id="S2.SS2.p1.2.m2.3.3.2.2.2" xref="S2.SS2.p1.2.m2.3.3.2.2.3.cmml"><mo id="S2.SS2.p1.2.m2.3.3.2.2.2.3" xref="S2.SS2.p1.2.m2.3.3.2.2.3.cmml">[</mo><msubsup id="S2.SS2.p1.2.m2.2.2.1.1.1.1" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.2" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.2.cmml">θ</mi><mn id="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.3" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.3.cmml">1</mn><mi id="S2.SS2.p1.2.m2.2.2.1.1.1.1.3" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S2.SS2.p1.2.m2.3.3.2.2.2.4" xref="S2.SS2.p1.2.m2.3.3.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS2.p1.2.m2.3.3.2.2.2.5" xref="S2.SS2.p1.2.m2.3.3.2.2.3.cmml">,</mo><msubsup id="S2.SS2.p1.2.m2.3.3.2.2.2.2" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.cmml"><mi id="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.2" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.2.cmml">θ</mi><mi id="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.3" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.3.cmml">N</mi><mi id="S2.SS2.p1.2.m2.3.3.2.2.2.2.3" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.3.cmml">r</mi></msubsup><mo id="S2.SS2.p1.2.m2.3.3.2.2.2.6" xref="S2.SS2.p1.2.m2.3.3.2.2.3.cmml">]</mo></mrow><mi id="S2.SS2.p1.2.m2.3.3.2.4" xref="S2.SS2.p1.2.m2.3.3.2.4.cmml">𝖳</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.3b"><apply id="S2.SS2.p1.2.m2.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3"><eq id="S2.SS2.p1.2.m2.3.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3.3"></eq><apply id="S2.SS2.p1.2.m2.3.3.4.cmml" xref="S2.SS2.p1.2.m2.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.4.1.cmml" xref="S2.SS2.p1.2.m2.3.3.4">superscript</csymbol><ci id="S2.SS2.p1.2.m2.3.3.4.2.cmml" xref="S2.SS2.p1.2.m2.3.3.4.2">𝜽</ci><ci id="S2.SS2.p1.2.m2.3.3.4.3.cmml" xref="S2.SS2.p1.2.m2.3.3.4.3">𝑟</ci></apply><apply id="S2.SS2.p1.2.m2.3.3.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2">superscript</csymbol><list id="S2.SS2.p1.2.m2.3.3.2.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2"><apply id="S2.SS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.2">𝜃</ci><cn type="integer" id="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1.2.3">1</cn></apply><ci id="S2.SS2.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p1.2.m2.2.2.1.1.1.1.3">𝑟</ci></apply><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">…</ci><apply id="S2.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2">superscript</csymbol><apply id="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.2">𝜃</ci><ci id="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.2.3">𝑁</ci></apply><ci id="S2.SS2.p1.2.m2.3.3.2.2.2.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.2.2.2.2.3">𝑟</ci></apply></list><ci id="S2.SS2.p1.2.m2.3.3.2.4.cmml" xref="S2.SS2.p1.2.m2.3.3.2.4">𝖳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.3c">\bm{\theta}^{r}=\left[\theta_{1}^{r},\dots,\theta_{N}^{r}\right]^{\mathsf{T}}</annotation></semantics></math> denote the phase decisions at the RIS. Thus, the received signal at the Rx is:</p>
<table id="S2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E8.m1.1" class="ltx_Math" alttext="y_{r}=\left(\mathbf{h}_{r}^{{\mathsf{H}}}\bm{\Theta}_{r}\,\mathbf{g}_{r}\right)s_{r}+z_{r}," display="block"><semantics id="S2.E8.m1.1a"><mrow id="S2.E8.m1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><msub id="S2.E8.m1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E8.m1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.3.3.cmml">r</mi></msub><mo id="S2.E8.m1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E8.m1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐡</mi><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">r</mi><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝖧</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝚯</mi><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.1a" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S2.E8.m1.1.1.1.1.1.1.1.1.1.4" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">𝐠</mi><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">r</mi></msub></mrow><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S2.E8.m1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S2.E8.m1.1.1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.1.1.3.3.cmml">r</mi></msub></mrow><mo id="S2.E8.m1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.2.cmml">+</mo><msub id="S2.E8.m1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S2.E8.m1.1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.1.3.3.cmml">r</mi></msub></mrow></mrow><mo id="S2.E8.m1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1"><eq id="S2.E8.m1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.2"></eq><apply id="S2.E8.m1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E8.m1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1"><plus id="S2.E8.m1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.2"></plus><apply id="S2.E8.m1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1"><times id="S2.E8.m1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2"></times><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1"><times id="S2.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝐡</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑟</ci></apply><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3">𝖧</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.2">𝚯</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.2">𝐠</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.4.3">𝑟</ci></apply></apply><apply id="S2.E8.m1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><apply id="S2.E8.m1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.3.2">𝑧</ci><ci id="S2.E8.m1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">y_{r}=\left(\mathbf{h}_{r}^{{\mathsf{H}}}\bm{\Theta}_{r}\,\mathbf{g}_{r}\right)s_{r}+z_{r},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.7" class="ltx_p">where <math id="S2.SS2.p1.3.m1.3" class="ltx_Math" alttext="\bm{\Theta}_{r}=\mathrm{diag}\left(e^{j\theta_{1}^{r}},\dots,e^{j\theta_{N}^{r}}\right)" display="inline"><semantics id="S2.SS2.p1.3.m1.3a"><mrow id="S2.SS2.p1.3.m1.3.3" xref="S2.SS2.p1.3.m1.3.3.cmml"><msub id="S2.SS2.p1.3.m1.3.3.4" xref="S2.SS2.p1.3.m1.3.3.4.cmml"><mi id="S2.SS2.p1.3.m1.3.3.4.2" xref="S2.SS2.p1.3.m1.3.3.4.2.cmml">𝚯</mi><mi id="S2.SS2.p1.3.m1.3.3.4.3" xref="S2.SS2.p1.3.m1.3.3.4.3.cmml">r</mi></msub><mo id="S2.SS2.p1.3.m1.3.3.3" xref="S2.SS2.p1.3.m1.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.3.m1.3.3.2" xref="S2.SS2.p1.3.m1.3.3.2.cmml"><mi id="S2.SS2.p1.3.m1.3.3.2.4" xref="S2.SS2.p1.3.m1.3.3.2.4.cmml">diag</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m1.3.3.2.3" xref="S2.SS2.p1.3.m1.3.3.2.3.cmml">​</mo><mrow id="S2.SS2.p1.3.m1.3.3.2.2.2" xref="S2.SS2.p1.3.m1.3.3.2.2.3.cmml"><mo id="S2.SS2.p1.3.m1.3.3.2.2.2.3" xref="S2.SS2.p1.3.m1.3.3.2.2.3.cmml">(</mo><msup id="S2.SS2.p1.3.m1.2.2.1.1.1.1" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.cmml"><mi id="S2.SS2.p1.3.m1.2.2.1.1.1.1.2" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.2.cmml">e</mi><mrow id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.2" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.1" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.1.cmml">​</mo><msubsup id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.2" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.2.cmml">θ</mi><mn id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.3" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.3.cmml">1</mn><mi id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.3" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.3.cmml">r</mi></msubsup></mrow></msup><mo id="S2.SS2.p1.3.m1.3.3.2.2.2.4" xref="S2.SS2.p1.3.m1.3.3.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.3.m1.1.1" xref="S2.SS2.p1.3.m1.1.1.cmml">…</mi><mo id="S2.SS2.p1.3.m1.3.3.2.2.2.5" xref="S2.SS2.p1.3.m1.3.3.2.2.3.cmml">,</mo><msup id="S2.SS2.p1.3.m1.3.3.2.2.2.2" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.cmml"><mi id="S2.SS2.p1.3.m1.3.3.2.2.2.2.2" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.2.cmml">e</mi><mrow id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.cmml"><mi id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.2" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.1" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.1.cmml">​</mo><msubsup id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.cmml"><mi id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.2" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.2.cmml">θ</mi><mi id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.3" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.3.cmml">N</mi><mi id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.3" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.3.cmml">r</mi></msubsup></mrow></msup><mo id="S2.SS2.p1.3.m1.3.3.2.2.2.6" xref="S2.SS2.p1.3.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m1.3b"><apply id="S2.SS2.p1.3.m1.3.3.cmml" xref="S2.SS2.p1.3.m1.3.3"><eq id="S2.SS2.p1.3.m1.3.3.3.cmml" xref="S2.SS2.p1.3.m1.3.3.3"></eq><apply id="S2.SS2.p1.3.m1.3.3.4.cmml" xref="S2.SS2.p1.3.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.3.3.4.1.cmml" xref="S2.SS2.p1.3.m1.3.3.4">subscript</csymbol><ci id="S2.SS2.p1.3.m1.3.3.4.2.cmml" xref="S2.SS2.p1.3.m1.3.3.4.2">𝚯</ci><ci id="S2.SS2.p1.3.m1.3.3.4.3.cmml" xref="S2.SS2.p1.3.m1.3.3.4.3">𝑟</ci></apply><apply id="S2.SS2.p1.3.m1.3.3.2.cmml" xref="S2.SS2.p1.3.m1.3.3.2"><times id="S2.SS2.p1.3.m1.3.3.2.3.cmml" xref="S2.SS2.p1.3.m1.3.3.2.3"></times><ci id="S2.SS2.p1.3.m1.3.3.2.4.cmml" xref="S2.SS2.p1.3.m1.3.3.2.4">diag</ci><vector id="S2.SS2.p1.3.m1.3.3.2.2.3.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2"><apply id="S2.SS2.p1.3.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.3.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.2">𝑒</ci><apply id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3"><times id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.1"></times><ci id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.2">𝑗</ci><apply id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3">superscript</csymbol><apply id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.1.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.2">𝜃</ci><cn type="integer" id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.3.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.2.3">1</cn></apply><ci id="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p1.3.m1.2.2.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><ci id="S2.SS2.p1.3.m1.1.1.cmml" xref="S2.SS2.p1.3.m1.1.1">…</ci><apply id="S2.SS2.p1.3.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.3.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.2">𝑒</ci><apply id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3"><times id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.1.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.1"></times><ci id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.2.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.2">𝑗</ci><apply id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.1.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3">superscript</csymbol><apply id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.1.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3">subscript</csymbol><ci id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.2.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.2">𝜃</ci><ci id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.3.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.2.3">𝑁</ci></apply><ci id="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.3.cmml" xref="S2.SS2.p1.3.m1.3.3.2.2.2.2.3.3.3">𝑟</ci></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m1.3c">\bm{\Theta}_{r}=\mathrm{diag}\left(e^{j\theta_{1}^{r}},\dots,e^{j\theta_{N}^{r}}\right)</annotation></semantics></math> is the RIS reflection matrix, <math id="S2.SS2.p1.4.m2.1" class="ltx_Math" alttext="s_{r}" display="inline"><semantics id="S2.SS2.p1.4.m2.1a"><msub id="S2.SS2.p1.4.m2.1.1" xref="S2.SS2.p1.4.m2.1.1.cmml"><mi id="S2.SS2.p1.4.m2.1.1.2" xref="S2.SS2.p1.4.m2.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.4.m2.1.1.3" xref="S2.SS2.p1.4.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m2.1b"><apply id="S2.SS2.p1.4.m2.1.1.cmml" xref="S2.SS2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m2.1.1.1.cmml" xref="S2.SS2.p1.4.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m2.1.1.2.cmml" xref="S2.SS2.p1.4.m2.1.1.2">𝑠</ci><ci id="S2.SS2.p1.4.m2.1.1.3.cmml" xref="S2.SS2.p1.4.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m2.1c">s_{r}</annotation></semantics></math> is the transmitted signal satisfying the power budget constraint <math id="S2.SS2.p1.5.m3.1" class="ltx_Math" alttext="\mathbb{E}\left[\lvert s_{r}\rvert^{2}\right]=p" display="inline"><semantics id="S2.SS2.p1.5.m3.1a"><mrow id="S2.SS2.p1.5.m3.1.1" xref="S2.SS2.p1.5.m3.1.1.cmml"><mrow id="S2.SS2.p1.5.m3.1.1.1" xref="S2.SS2.p1.5.m3.1.1.1.cmml"><mi id="S2.SS2.p1.5.m3.1.1.1.3" xref="S2.SS2.p1.5.m3.1.1.1.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.m3.1.1.1.2" xref="S2.SS2.p1.5.m3.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.5.m3.1.1.1.1.1" xref="S2.SS2.p1.5.m3.1.1.1.1.2.cmml"><mo id="S2.SS2.p1.5.m3.1.1.1.1.1.2" xref="S2.SS2.p1.5.m3.1.1.1.1.2.1.cmml">[</mo><msup id="S2.SS2.p1.5.m3.1.1.1.1.1.1" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S2.SS2.p1.5.m3.1.1.1.1.1.1.3" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.SS2.p1.5.m3.1.1.1.1.1.3" xref="S2.SS2.p1.5.m3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.SS2.p1.5.m3.1.1.2" xref="S2.SS2.p1.5.m3.1.1.2.cmml">=</mo><mi id="S2.SS2.p1.5.m3.1.1.3" xref="S2.SS2.p1.5.m3.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m3.1b"><apply id="S2.SS2.p1.5.m3.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1"><eq id="S2.SS2.p1.5.m3.1.1.2.cmml" xref="S2.SS2.p1.5.m3.1.1.2"></eq><apply id="S2.SS2.p1.5.m3.1.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1.1"><times id="S2.SS2.p1.5.m3.1.1.1.2.cmml" xref="S2.SS2.p1.5.m3.1.1.1.2"></times><ci id="S2.SS2.p1.5.m3.1.1.1.3.cmml" xref="S2.SS2.p1.5.m3.1.1.1.3">𝔼</ci><apply id="S2.SS2.p1.5.m3.1.1.1.1.2.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.5.m3.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p1.5.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1"><abs id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.2"></abs><apply id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><cn type="integer" id="S2.SS2.p1.5.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.5.m3.1.1.1.1.1.1.3">2</cn></apply></apply></apply><ci id="S2.SS2.p1.5.m3.1.1.3.cmml" xref="S2.SS2.p1.5.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m3.1c">\mathbb{E}\left[\lvert s_{r}\rvert^{2}\right]=p</annotation></semantics></math>, and <math id="S2.SS2.p1.6.m4.2" class="ltx_Math" alttext="z_{r}\sim\mathcal{CN}\left(0,\sigma^{2}\right)" display="inline"><semantics id="S2.SS2.p1.6.m4.2a"><mrow id="S2.SS2.p1.6.m4.2.2" xref="S2.SS2.p1.6.m4.2.2.cmml"><msub id="S2.SS2.p1.6.m4.2.2.3" xref="S2.SS2.p1.6.m4.2.2.3.cmml"><mi id="S2.SS2.p1.6.m4.2.2.3.2" xref="S2.SS2.p1.6.m4.2.2.3.2.cmml">z</mi><mi id="S2.SS2.p1.6.m4.2.2.3.3" xref="S2.SS2.p1.6.m4.2.2.3.3.cmml">r</mi></msub><mo id="S2.SS2.p1.6.m4.2.2.2" xref="S2.SS2.p1.6.m4.2.2.2.cmml">∼</mo><mrow id="S2.SS2.p1.6.m4.2.2.1" xref="S2.SS2.p1.6.m4.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.6.m4.2.2.1.3" xref="S2.SS2.p1.6.m4.2.2.1.3.cmml">𝒞</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.6.m4.2.2.1.2" xref="S2.SS2.p1.6.m4.2.2.1.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.6.m4.2.2.1.4" xref="S2.SS2.p1.6.m4.2.2.1.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.6.m4.2.2.1.2a" xref="S2.SS2.p1.6.m4.2.2.1.2.cmml">​</mo><mrow id="S2.SS2.p1.6.m4.2.2.1.1.1" xref="S2.SS2.p1.6.m4.2.2.1.1.2.cmml"><mo id="S2.SS2.p1.6.m4.2.2.1.1.1.2" xref="S2.SS2.p1.6.m4.2.2.1.1.2.cmml">(</mo><mn id="S2.SS2.p1.6.m4.1.1" xref="S2.SS2.p1.6.m4.1.1.cmml">0</mn><mo id="S2.SS2.p1.6.m4.2.2.1.1.1.3" xref="S2.SS2.p1.6.m4.2.2.1.1.2.cmml">,</mo><msup id="S2.SS2.p1.6.m4.2.2.1.1.1.1" xref="S2.SS2.p1.6.m4.2.2.1.1.1.1.cmml"><mi id="S2.SS2.p1.6.m4.2.2.1.1.1.1.2" xref="S2.SS2.p1.6.m4.2.2.1.1.1.1.2.cmml">σ</mi><mn id="S2.SS2.p1.6.m4.2.2.1.1.1.1.3" xref="S2.SS2.p1.6.m4.2.2.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.SS2.p1.6.m4.2.2.1.1.1.4" xref="S2.SS2.p1.6.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m4.2b"><apply id="S2.SS2.p1.6.m4.2.2.cmml" xref="S2.SS2.p1.6.m4.2.2"><csymbol cd="latexml" id="S2.SS2.p1.6.m4.2.2.2.cmml" xref="S2.SS2.p1.6.m4.2.2.2">similar-to</csymbol><apply id="S2.SS2.p1.6.m4.2.2.3.cmml" xref="S2.SS2.p1.6.m4.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m4.2.2.3.1.cmml" xref="S2.SS2.p1.6.m4.2.2.3">subscript</csymbol><ci id="S2.SS2.p1.6.m4.2.2.3.2.cmml" xref="S2.SS2.p1.6.m4.2.2.3.2">𝑧</ci><ci id="S2.SS2.p1.6.m4.2.2.3.3.cmml" xref="S2.SS2.p1.6.m4.2.2.3.3">𝑟</ci></apply><apply id="S2.SS2.p1.6.m4.2.2.1.cmml" xref="S2.SS2.p1.6.m4.2.2.1"><times id="S2.SS2.p1.6.m4.2.2.1.2.cmml" xref="S2.SS2.p1.6.m4.2.2.1.2"></times><ci id="S2.SS2.p1.6.m4.2.2.1.3.cmml" xref="S2.SS2.p1.6.m4.2.2.1.3">𝒞</ci><ci id="S2.SS2.p1.6.m4.2.2.1.4.cmml" xref="S2.SS2.p1.6.m4.2.2.1.4">𝒩</ci><interval closure="open" id="S2.SS2.p1.6.m4.2.2.1.1.2.cmml" xref="S2.SS2.p1.6.m4.2.2.1.1.1"><cn type="integer" id="S2.SS2.p1.6.m4.1.1.cmml" xref="S2.SS2.p1.6.m4.1.1">0</cn><apply id="S2.SS2.p1.6.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.6.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m4.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m4.2.2.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.6.m4.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.m4.2.2.1.1.1.1.2">𝜎</ci><cn type="integer" id="S2.SS2.p1.6.m4.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p1.6.m4.2.2.1.1.1.1.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m4.2c">z_{r}\sim\mathcal{CN}\left(0,\sigma^{2}\right)</annotation></semantics></math> is the additive noise with power <math id="S2.SS2.p1.7.m5.1" class="ltx_Math" alttext="\sigma^{2}" display="inline"><semantics id="S2.SS2.p1.7.m5.1a"><msup id="S2.SS2.p1.7.m5.1.1" xref="S2.SS2.p1.7.m5.1.1.cmml"><mi id="S2.SS2.p1.7.m5.1.1.2" xref="S2.SS2.p1.7.m5.1.1.2.cmml">σ</mi><mn id="S2.SS2.p1.7.m5.1.1.3" xref="S2.SS2.p1.7.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m5.1b"><apply id="S2.SS2.p1.7.m5.1.1.cmml" xref="S2.SS2.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m5.1.1.1.cmml" xref="S2.SS2.p1.7.m5.1.1">superscript</csymbol><ci id="S2.SS2.p1.7.m5.1.1.2.cmml" xref="S2.SS2.p1.7.m5.1.1.2">𝜎</ci><cn type="integer" id="S2.SS2.p1.7.m5.1.1.3.cmml" xref="S2.SS2.p1.7.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m5.1c">\sigma^{2}</annotation></semantics></math>.
In this view, the objective of downlink rate maximization can be cast as follows:</p>
<table id="S2.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E9X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\underset{\bm{\theta}^{r}\,\in\,\mathcal{C}}{\textrm{maximize}}\quad" display="inline"><semantics id="S2.E9X.2.1.1.m1.1a"><mrow id="S2.E9X.2.1.1.m1.1.2.2" xref="S2.E9X.2.1.1.m1.1.1.cmml"><munder accentunder="true" id="S2.E9X.2.1.1.m1.1.1" xref="S2.E9X.2.1.1.m1.1.1.cmml"><mtext id="S2.E9X.2.1.1.m1.1.1.2" xref="S2.E9X.2.1.1.m1.1.1.2a.cmml">maximize</mtext><mrow id="S2.E9X.2.1.1.m1.1.1.1" xref="S2.E9X.2.1.1.m1.1.1.1.cmml"><msup id="S2.E9X.2.1.1.m1.1.1.1.2" xref="S2.E9X.2.1.1.m1.1.1.1.2.cmml"><mi id="S2.E9X.2.1.1.m1.1.1.1.2.2" xref="S2.E9X.2.1.1.m1.1.1.1.2.2.cmml">𝜽</mi><mi id="S2.E9X.2.1.1.m1.1.1.1.2.3" xref="S2.E9X.2.1.1.m1.1.1.1.2.3.cmml">r</mi></msup><mo lspace="0.448em" rspace="0.448em" id="S2.E9X.2.1.1.m1.1.1.1.1" xref="S2.E9X.2.1.1.m1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E9X.2.1.1.m1.1.1.1.3" xref="S2.E9X.2.1.1.m1.1.1.1.3.cmml">𝒞</mi></mrow></munder><mspace width="1em" id="S2.E9X.2.1.1.m1.1.2.2.1" xref="S2.E9X.2.1.1.m1.1.1.cmml"></mspace></mrow><annotation-xml encoding="MathML-Content" id="S2.E9X.2.1.1.m1.1b"><apply id="S2.E9X.2.1.1.m1.1.1.cmml" xref="S2.E9X.2.1.1.m1.1.2.2"><apply id="S2.E9X.2.1.1.m1.1.1.1.cmml" xref="S2.E9X.2.1.1.m1.1.1.1"><in id="S2.E9X.2.1.1.m1.1.1.1.1.cmml" xref="S2.E9X.2.1.1.m1.1.1.1.1"></in><apply id="S2.E9X.2.1.1.m1.1.1.1.2.cmml" xref="S2.E9X.2.1.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9X.2.1.1.m1.1.1.1.2.1.cmml" xref="S2.E9X.2.1.1.m1.1.1.1.2">superscript</csymbol><ci id="S2.E9X.2.1.1.m1.1.1.1.2.2.cmml" xref="S2.E9X.2.1.1.m1.1.1.1.2.2">𝜽</ci><ci id="S2.E9X.2.1.1.m1.1.1.1.2.3.cmml" xref="S2.E9X.2.1.1.m1.1.1.1.2.3">𝑟</ci></apply><ci id="S2.E9X.2.1.1.m1.1.1.1.3.cmml" xref="S2.E9X.2.1.1.m1.1.1.1.3">𝒞</ci></apply><ci id="S2.E9X.2.1.1.m1.1.1.2a.cmml" xref="S2.E9X.2.1.1.m1.1.1.2"><mtext id="S2.E9X.2.1.1.m1.1.1.2.cmml" xref="S2.E9X.2.1.1.m1.1.1.2">maximize</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9X.2.1.1.m1.1c">\displaystyle\underset{\bm{\theta}^{r}\,\in\,\mathcal{C}}{\textrm{maximize}}\quad</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E9X.4.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\log_{2}\left(1+\frac{\lvert\mathbf{h}_{r}^{\mathsf{H}}\bm{\Theta}_{r}\,\mathbf{g}_{r}\rvert^{2}p}{\sigma^{2}}\right)," display="inline"><semantics id="S2.E9X.4.1.1.m1.2a"><mrow id="S2.E9X.4.1.1.m1.2.2.1"><mrow id="S2.E9X.4.1.1.m1.2.2.1.1.2" xref="S2.E9X.4.1.1.m1.2.2.1.1.3.cmml"><msub id="S2.E9X.4.1.1.m1.2.2.1.1.1.1" xref="S2.E9X.4.1.1.m1.2.2.1.1.1.1.cmml"><mi id="S2.E9X.4.1.1.m1.2.2.1.1.1.1.2" xref="S2.E9X.4.1.1.m1.2.2.1.1.1.1.2.cmml">log</mi><mn id="S2.E9X.4.1.1.m1.2.2.1.1.1.1.3" xref="S2.E9X.4.1.1.m1.2.2.1.1.1.1.3.cmml">2</mn></msub><mo id="S2.E9X.4.1.1.m1.2.2.1.1.2a" xref="S2.E9X.4.1.1.m1.2.2.1.1.3.cmml">⁡</mo><mrow id="S2.E9X.4.1.1.m1.2.2.1.1.2.2" xref="S2.E9X.4.1.1.m1.2.2.1.1.3.cmml"><mo id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.2" xref="S2.E9X.4.1.1.m1.2.2.1.1.3.cmml">(</mo><mrow id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1" xref="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.cmml"><mn id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.2" xref="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.2.cmml">1</mn><mo id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.1" xref="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.1.cmml">+</mo><mstyle displaystyle="true" id="S2.E9X.4.1.1.m1.1.1" xref="S2.E9X.4.1.1.m1.1.1.cmml"><mfrac id="S2.E9X.4.1.1.m1.1.1a" xref="S2.E9X.4.1.1.m1.1.1.cmml"><mrow id="S2.E9X.4.1.1.m1.1.1.1" xref="S2.E9X.4.1.1.m1.1.1.1.cmml"><msup id="S2.E9X.4.1.1.m1.1.1.1.1" xref="S2.E9X.4.1.1.m1.1.1.1.1.cmml"><mrow id="S2.E9X.4.1.1.m1.1.1.1.1.1.1" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.2" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">𝐡</mi><mi id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">r</mi><mi id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">𝖧</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.1" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">𝚯</mi><mi id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.1a" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.2" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.2.cmml">𝐠</mi><mi id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.3" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.3.cmml">r</mi></msub></mrow><mo stretchy="false" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.3" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S2.E9X.4.1.1.m1.1.1.1.1.3" xref="S2.E9X.4.1.1.m1.1.1.1.1.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S2.E9X.4.1.1.m1.1.1.1.2" xref="S2.E9X.4.1.1.m1.1.1.1.2.cmml">​</mo><mi id="S2.E9X.4.1.1.m1.1.1.1.3" xref="S2.E9X.4.1.1.m1.1.1.1.3.cmml">p</mi></mrow><msup id="S2.E9X.4.1.1.m1.1.1.3" xref="S2.E9X.4.1.1.m1.1.1.3.cmml"><mi id="S2.E9X.4.1.1.m1.1.1.3.2" xref="S2.E9X.4.1.1.m1.1.1.3.2.cmml">σ</mi><mn id="S2.E9X.4.1.1.m1.1.1.3.3" xref="S2.E9X.4.1.1.m1.1.1.3.3.cmml">2</mn></msup></mfrac></mstyle></mrow><mo id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.3" xref="S2.E9X.4.1.1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E9X.4.1.1.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9X.4.1.1.m1.2b"><apply id="S2.E9X.4.1.1.m1.2.2.1.1.3.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.2"><apply id="S2.E9X.4.1.1.m1.2.2.1.1.1.1.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9X.4.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.1.1">subscript</csymbol><log id="S2.E9X.4.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.1.1.2"></log><cn type="integer" id="S2.E9X.4.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.1.1.3">2</cn></apply><apply id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1"><plus id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.1.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.1"></plus><cn type="integer" id="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.2.cmml" xref="S2.E9X.4.1.1.m1.2.2.1.1.2.2.1.2">1</cn><apply id="S2.E9X.4.1.1.m1.1.1.cmml" xref="S2.E9X.4.1.1.m1.1.1"><divide id="S2.E9X.4.1.1.m1.1.1.2.cmml" xref="S2.E9X.4.1.1.m1.1.1"></divide><apply id="S2.E9X.4.1.1.m1.1.1.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1"><times id="S2.E9X.4.1.1.m1.1.1.1.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.2"></times><apply id="S2.E9X.4.1.1.m1.1.1.1.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9X.4.1.1.m1.1.1.1.1.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1">superscript</csymbol><apply id="S2.E9X.4.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1"><abs id="S2.E9X.4.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.2"></abs><apply id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1"><times id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.1"></times><apply id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.2">𝐡</ci><ci id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑟</ci></apply><ci id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.3">𝖧</ci></apply><apply id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.2">𝚯</ci><ci id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.2">𝐠</ci><ci id="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.1.1.1.4.3">𝑟</ci></apply></apply></apply><cn type="integer" id="S2.E9X.4.1.1.m1.1.1.1.1.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.1.3">2</cn></apply><ci id="S2.E9X.4.1.1.m1.1.1.1.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.1.3">𝑝</ci></apply><apply id="S2.E9X.4.1.1.m1.1.1.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E9X.4.1.1.m1.1.1.3.1.cmml" xref="S2.E9X.4.1.1.m1.1.1.3">superscript</csymbol><ci id="S2.E9X.4.1.1.m1.1.1.3.2.cmml" xref="S2.E9X.4.1.1.m1.1.1.3.2">𝜎</ci><cn type="integer" id="S2.E9X.4.1.1.m1.1.1.3.3.cmml" xref="S2.E9X.4.1.1.m1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9X.4.1.1.m1.2c">\displaystyle\log_{2}\left(1+\frac{\lvert\mathbf{h}_{r}^{\mathsf{H}}\bm{\Theta}_{r}\,\mathbf{g}_{r}\rvert^{2}p}{\sigma^{2}}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
</tbody>
</table>
<p id="S2.SS2.p1.8" class="ltx_p">where <math id="S2.SS2.p1.8.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S2.SS2.p1.8.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.8.m1.1.1" xref="S2.SS2.p1.8.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m1.1b"><ci id="S2.SS2.p1.8.m1.1.1.cmml" xref="S2.SS2.p1.8.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m1.1c">\mathcal{C}</annotation></semantics></math> is the set of feasible RIS configurations.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.4" class="ltx_p">In order to solve (<a href="#S2.E9" title="In II-B Downlink Rate Maximization ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>), a perfect knowledge of both channels <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\mathbf{h}</annotation></semantics></math> and <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{g}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">𝐠</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝐠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\mathbf{g}</annotation></semantics></math> is assumed. Even under perfect CSI, determining the optimal set of phase shifts <math id="S2.SS2.p2.3.m3.2" class="ltx_Math" alttext="\bm{\theta}^{r\star}" display="inline"><semantics id="S2.SS2.p2.3.m3.2a"><msup id="S2.SS2.p2.3.m3.2.3" xref="S2.SS2.p2.3.m3.2.3.cmml"><mi id="S2.SS2.p2.3.m3.2.3.2" xref="S2.SS2.p2.3.m3.2.3.2.cmml">𝜽</mi><mrow id="S2.SS2.p2.3.m3.2.2.2.4" xref="S2.SS2.p2.3.m3.2.2.2.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.cmml">r</mi><mo lspace="0.222em" id="S2.SS2.p2.3.m3.2.2.2.4.1" xref="S2.SS2.p2.3.m3.2.2.2.3.cmml">⁣</mo><mo id="S2.SS2.p2.3.m3.2.2.2.2" xref="S2.SS2.p2.3.m3.2.2.2.2.cmml">⋆</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.2b"><apply id="S2.SS2.p2.3.m3.2.3.cmml" xref="S2.SS2.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.2.3.1.cmml" xref="S2.SS2.p2.3.m3.2.3">superscript</csymbol><ci id="S2.SS2.p2.3.m3.2.3.2.cmml" xref="S2.SS2.p2.3.m3.2.3.2">𝜽</ci><list id="S2.SS2.p2.3.m3.2.2.2.3.cmml" xref="S2.SS2.p2.3.m3.2.2.2.4"><ci id="S2.SS2.p2.3.m3.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1">𝑟</ci><ci id="S2.SS2.p2.3.m3.2.2.2.2.cmml" xref="S2.SS2.p2.3.m3.2.2.2.2">⋆</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.2c">\bm{\theta}^{r\star}</annotation></semantics></math> requires a heuristic search due to the notion of configuration classes <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\mathcal{C}</annotation></semantics></math>. Such solutions cannot be practically adopted since they are not scalable with the number of RIS elements. As a remedy, we resort to ML in order to devise a data-driven solution.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.9" class="ltx_p">In this context, consider that the RIS in environment <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mi id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">r</mi><mo id="S2.SS2.p3.1.m1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><in id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1"></in><ci id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">𝑟</ci><ci id="S2.SS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">r\in\mathcal{R}</annotation></semantics></math> (later referred to as agent <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">r</annotation></semantics></math>) has a dataset <math id="S2.SS2.p3.3.m3.4" class="ltx_Math" alttext="\mathcal{D}_{r}=\left\{\left(\bm{x}_{j}^{r},c_{j}^{r}\right)\;\middle|\;j=1,\dots,D_{r}\right\}" display="inline"><semantics id="S2.SS2.p3.3.m3.4a"><mrow id="S2.SS2.p3.3.m3.4.4" xref="S2.SS2.p3.3.m3.4.4.cmml"><msub id="S2.SS2.p3.3.m3.4.4.4" xref="S2.SS2.p3.3.m3.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.3.m3.4.4.4.2" xref="S2.SS2.p3.3.m3.4.4.4.2.cmml">𝒟</mi><mi id="S2.SS2.p3.3.m3.4.4.4.3" xref="S2.SS2.p3.3.m3.4.4.4.3.cmml">r</mi></msub><mo id="S2.SS2.p3.3.m3.4.4.3" xref="S2.SS2.p3.3.m3.4.4.3.cmml">=</mo><mrow id="S2.SS2.p3.3.m3.4.4.2.2" xref="S2.SS2.p3.3.m3.4.4.2.3.cmml"><mo id="S2.SS2.p3.3.m3.4.4.2.2.3" xref="S2.SS2.p3.3.m3.4.4.2.3.1.cmml">{</mo><mrow id="S2.SS2.p3.3.m3.3.3.1.1.1.2" xref="S2.SS2.p3.3.m3.3.3.1.1.1.3.cmml"><mo id="S2.SS2.p3.3.m3.3.3.1.1.1.2.3" xref="S2.SS2.p3.3.m3.3.3.1.1.1.3.cmml">(</mo><msubsup id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.2" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.3" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.3.cmml">j</mi><mi id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.3" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S2.SS2.p3.3.m3.3.3.1.1.1.2.4" xref="S2.SS2.p3.3.m3.3.3.1.1.1.3.cmml">,</mo><msubsup id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.cmml"><mi id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.2" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.2.cmml">c</mi><mi id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.3" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.3.cmml">j</mi><mi id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.3" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.3.cmml">r</mi></msubsup><mo id="S2.SS2.p3.3.m3.3.3.1.1.1.2.5" xref="S2.SS2.p3.3.m3.3.3.1.1.1.3.cmml">)</mo></mrow><mo stretchy="true" id="S2.SS2.p3.3.m3.4.4.2.2.4" xref="S2.SS2.p3.3.m3.4.4.2.3.1.cmml">|</mo><mrow id="S2.SS2.p3.3.m3.4.4.2.2.2" xref="S2.SS2.p3.3.m3.4.4.2.2.2.cmml"><mi id="S2.SS2.p3.3.m3.4.4.2.2.2.3" xref="S2.SS2.p3.3.m3.4.4.2.2.2.3.cmml">j</mi><mo id="S2.SS2.p3.3.m3.4.4.2.2.2.2" xref="S2.SS2.p3.3.m3.4.4.2.2.2.2.cmml">=</mo><mrow id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.2.cmml"><mn id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">1</mn><mo id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.2" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.2.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p3.3.m3.2.2" xref="S2.SS2.p3.3.m3.2.2.cmml">…</mi><mo id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.3" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.2.cmml">,</mo><msub id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.2" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.2.cmml">D</mi><mi id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.3" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.3.cmml">r</mi></msub></mrow></mrow><mo id="S2.SS2.p3.3.m3.4.4.2.2.5" xref="S2.SS2.p3.3.m3.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.4b"><apply id="S2.SS2.p3.3.m3.4.4.cmml" xref="S2.SS2.p3.3.m3.4.4"><eq id="S2.SS2.p3.3.m3.4.4.3.cmml" xref="S2.SS2.p3.3.m3.4.4.3"></eq><apply id="S2.SS2.p3.3.m3.4.4.4.cmml" xref="S2.SS2.p3.3.m3.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.4.4.4.1.cmml" xref="S2.SS2.p3.3.m3.4.4.4">subscript</csymbol><ci id="S2.SS2.p3.3.m3.4.4.4.2.cmml" xref="S2.SS2.p3.3.m3.4.4.4.2">𝒟</ci><ci id="S2.SS2.p3.3.m3.4.4.4.3.cmml" xref="S2.SS2.p3.3.m3.4.4.4.3">𝑟</ci></apply><apply id="S2.SS2.p3.3.m3.4.4.2.3.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2"><csymbol cd="latexml" id="S2.SS2.p3.3.m3.4.4.2.3.1.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.3">conditional-set</csymbol><interval closure="open" id="S2.SS2.p3.3.m3.3.3.1.1.1.3.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2"><apply id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.1.1.3">𝑟</ci></apply><apply id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.1.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2">superscript</csymbol><apply id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.2">𝑐</ci><ci id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.3.cmml" xref="S2.SS2.p3.3.m3.3.3.1.1.1.2.2.3">𝑟</ci></apply></interval><apply id="S2.SS2.p3.3.m3.4.4.2.2.2.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2"><eq id="S2.SS2.p3.3.m3.4.4.2.2.2.2.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2.2"></eq><ci id="S2.SS2.p3.3.m3.4.4.2.2.2.3.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2.3">𝑗</ci><list id="S2.SS2.p3.3.m3.4.4.2.2.2.1.2.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1"><cn type="integer" id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">1</cn><ci id="S2.SS2.p3.3.m3.2.2.cmml" xref="S2.SS2.p3.3.m3.2.2">…</ci><apply id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.2">𝐷</ci><ci id="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p3.3.m3.4.4.2.2.2.1.1.1.3">𝑟</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.4c">\mathcal{D}_{r}=\left\{\left(\bm{x}_{j}^{r},c_{j}^{r}\right)\;\middle|\;j=1,\dots,D_{r}\right\}</annotation></semantics></math> containing <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="D_{r}" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><msub id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml"><mi id="S2.SS2.p3.4.m4.1.1.2" xref="S2.SS2.p3.4.m4.1.1.2.cmml">D</mi><mi id="S2.SS2.p3.4.m4.1.1.3" xref="S2.SS2.p3.4.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><apply id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.1.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p3.4.m4.1.1.2.cmml" xref="S2.SS2.p3.4.m4.1.1.2">𝐷</ci><ci id="S2.SS2.p3.4.m4.1.1.3.cmml" xref="S2.SS2.p3.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">D_{r}</annotation></semantics></math> samples of observed CSI <math id="S2.SS2.p3.5.m5.2" class="ltx_Math" alttext="\bm{x}_{j}^{r}=\left(\mathbf{h}_{j}^{r},\mathbf{g}_{j}^{r}\right)" display="inline"><semantics id="S2.SS2.p3.5.m5.2a"><mrow id="S2.SS2.p3.5.m5.2.2" xref="S2.SS2.p3.5.m5.2.2.cmml"><msubsup id="S2.SS2.p3.5.m5.2.2.4" xref="S2.SS2.p3.5.m5.2.2.4.cmml"><mi id="S2.SS2.p3.5.m5.2.2.4.2.2" xref="S2.SS2.p3.5.m5.2.2.4.2.2.cmml">𝒙</mi><mi id="S2.SS2.p3.5.m5.2.2.4.2.3" xref="S2.SS2.p3.5.m5.2.2.4.2.3.cmml">j</mi><mi id="S2.SS2.p3.5.m5.2.2.4.3" xref="S2.SS2.p3.5.m5.2.2.4.3.cmml">r</mi></msubsup><mo id="S2.SS2.p3.5.m5.2.2.3" xref="S2.SS2.p3.5.m5.2.2.3.cmml">=</mo><mrow id="S2.SS2.p3.5.m5.2.2.2.2" xref="S2.SS2.p3.5.m5.2.2.2.3.cmml"><mo id="S2.SS2.p3.5.m5.2.2.2.2.3" xref="S2.SS2.p3.5.m5.2.2.2.3.cmml">(</mo><msubsup id="S2.SS2.p3.5.m5.1.1.1.1.1" xref="S2.SS2.p3.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.5.m5.1.1.1.1.1.2.2" xref="S2.SS2.p3.5.m5.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S2.SS2.p3.5.m5.1.1.1.1.1.2.3" xref="S2.SS2.p3.5.m5.1.1.1.1.1.2.3.cmml">j</mi><mi id="S2.SS2.p3.5.m5.1.1.1.1.1.3" xref="S2.SS2.p3.5.m5.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S2.SS2.p3.5.m5.2.2.2.2.4" xref="S2.SS2.p3.5.m5.2.2.2.3.cmml">,</mo><msubsup id="S2.SS2.p3.5.m5.2.2.2.2.2" xref="S2.SS2.p3.5.m5.2.2.2.2.2.cmml"><mi id="S2.SS2.p3.5.m5.2.2.2.2.2.2.2" xref="S2.SS2.p3.5.m5.2.2.2.2.2.2.2.cmml">𝐠</mi><mi id="S2.SS2.p3.5.m5.2.2.2.2.2.2.3" xref="S2.SS2.p3.5.m5.2.2.2.2.2.2.3.cmml">j</mi><mi id="S2.SS2.p3.5.m5.2.2.2.2.2.3" xref="S2.SS2.p3.5.m5.2.2.2.2.2.3.cmml">r</mi></msubsup><mo id="S2.SS2.p3.5.m5.2.2.2.2.5" xref="S2.SS2.p3.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.2b"><apply id="S2.SS2.p3.5.m5.2.2.cmml" xref="S2.SS2.p3.5.m5.2.2"><eq id="S2.SS2.p3.5.m5.2.2.3.cmml" xref="S2.SS2.p3.5.m5.2.2.3"></eq><apply id="S2.SS2.p3.5.m5.2.2.4.cmml" xref="S2.SS2.p3.5.m5.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.2.2.4.1.cmml" xref="S2.SS2.p3.5.m5.2.2.4">superscript</csymbol><apply id="S2.SS2.p3.5.m5.2.2.4.2.cmml" xref="S2.SS2.p3.5.m5.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.2.2.4.2.1.cmml" xref="S2.SS2.p3.5.m5.2.2.4">subscript</csymbol><ci id="S2.SS2.p3.5.m5.2.2.4.2.2.cmml" xref="S2.SS2.p3.5.m5.2.2.4.2.2">𝒙</ci><ci id="S2.SS2.p3.5.m5.2.2.4.2.3.cmml" xref="S2.SS2.p3.5.m5.2.2.4.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.5.m5.2.2.4.3.cmml" xref="S2.SS2.p3.5.m5.2.2.4.3">𝑟</ci></apply><interval closure="open" id="S2.SS2.p3.5.m5.2.2.2.3.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2"><apply id="S2.SS2.p3.5.m5.1.1.1.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p3.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p3.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.5.m5.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p3.5.m5.1.1.1.1.1.2.2">𝐡</ci><ci id="S2.SS2.p3.5.m5.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p3.5.m5.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.5.m5.1.1.1.1.1.3">𝑟</ci></apply><apply id="S2.SS2.p3.5.m5.2.2.2.2.2.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.2.2.2.2.2.1.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2.2">superscript</csymbol><apply id="S2.SS2.p3.5.m5.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.5.m5.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2.2.2.2">𝐠</ci><ci id="S2.SS2.p3.5.m5.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.5.m5.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.5.m5.2.2.2.2.2.3">𝑟</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.2c">\bm{x}_{j}^{r}=\left(\mathbf{h}_{j}^{r},\mathbf{g}_{j}^{r}\right)</annotation></semantics></math> that are labeled by <math id="S2.SS2.p3.6.m6.1" class="ltx_Math" alttext="c_{j}^{r}" display="inline"><semantics id="S2.SS2.p3.6.m6.1a"><msubsup id="S2.SS2.p3.6.m6.1.1" xref="S2.SS2.p3.6.m6.1.1.cmml"><mi id="S2.SS2.p3.6.m6.1.1.2.2" xref="S2.SS2.p3.6.m6.1.1.2.2.cmml">c</mi><mi id="S2.SS2.p3.6.m6.1.1.2.3" xref="S2.SS2.p3.6.m6.1.1.2.3.cmml">j</mi><mi id="S2.SS2.p3.6.m6.1.1.3" xref="S2.SS2.p3.6.m6.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.1b"><apply id="S2.SS2.p3.6.m6.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.1.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1">superscript</csymbol><apply id="S2.SS2.p3.6.m6.1.1.2.cmml" xref="S2.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.1.1.2.1.cmml" xref="S2.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p3.6.m6.1.1.2.2.cmml" xref="S2.SS2.p3.6.m6.1.1.2.2">𝑐</ci><ci id="S2.SS2.p3.6.m6.1.1.2.3.cmml" xref="S2.SS2.p3.6.m6.1.1.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.6.m6.1.1.3.cmml" xref="S2.SS2.p3.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.1c">c_{j}^{r}</annotation></semantics></math> corresponding to the optimal RIS phase shifts <math id="S2.SS2.p3.7.m7.2" class="ltx_Math" alttext="\bm{\theta}^{r\star}" display="inline"><semantics id="S2.SS2.p3.7.m7.2a"><msup id="S2.SS2.p3.7.m7.2.3" xref="S2.SS2.p3.7.m7.2.3.cmml"><mi id="S2.SS2.p3.7.m7.2.3.2" xref="S2.SS2.p3.7.m7.2.3.2.cmml">𝜽</mi><mrow id="S2.SS2.p3.7.m7.2.2.2.4" xref="S2.SS2.p3.7.m7.2.2.2.3.cmml"><mi id="S2.SS2.p3.7.m7.1.1.1.1" xref="S2.SS2.p3.7.m7.1.1.1.1.cmml">r</mi><mo lspace="0.222em" id="S2.SS2.p3.7.m7.2.2.2.4.1" xref="S2.SS2.p3.7.m7.2.2.2.3.cmml">⁣</mo><mo id="S2.SS2.p3.7.m7.2.2.2.2" xref="S2.SS2.p3.7.m7.2.2.2.2.cmml">⋆</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m7.2b"><apply id="S2.SS2.p3.7.m7.2.3.cmml" xref="S2.SS2.p3.7.m7.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.7.m7.2.3.1.cmml" xref="S2.SS2.p3.7.m7.2.3">superscript</csymbol><ci id="S2.SS2.p3.7.m7.2.3.2.cmml" xref="S2.SS2.p3.7.m7.2.3.2">𝜽</ci><list id="S2.SS2.p3.7.m7.2.2.2.3.cmml" xref="S2.SS2.p3.7.m7.2.2.2.4"><ci id="S2.SS2.p3.7.m7.1.1.1.1.cmml" xref="S2.SS2.p3.7.m7.1.1.1.1">𝑟</ci><ci id="S2.SS2.p3.7.m7.2.2.2.2.cmml" xref="S2.SS2.p3.7.m7.2.2.2.2">⋆</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m7.2c">\bm{\theta}^{r\star}</annotation></semantics></math> solving (<a href="#S2.E9" title="In II-B Downlink Rate Maximization ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>).
We then seek to construct a mapping function <math id="S2.SS2.p3.8.m8.1" class="ltx_Math" alttext="f_{\bm{w}}(\cdot)" display="inline"><semantics id="S2.SS2.p3.8.m8.1a"><mrow id="S2.SS2.p3.8.m8.1.2" xref="S2.SS2.p3.8.m8.1.2.cmml"><msub id="S2.SS2.p3.8.m8.1.2.2" xref="S2.SS2.p3.8.m8.1.2.2.cmml"><mi id="S2.SS2.p3.8.m8.1.2.2.2" xref="S2.SS2.p3.8.m8.1.2.2.2.cmml">f</mi><mi id="S2.SS2.p3.8.m8.1.2.2.3" xref="S2.SS2.p3.8.m8.1.2.2.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.8.m8.1.2.1" xref="S2.SS2.p3.8.m8.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.8.m8.1.2.3.2" xref="S2.SS2.p3.8.m8.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.8.m8.1.2.3.2.1" xref="S2.SS2.p3.8.m8.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p3.8.m8.1.1" xref="S2.SS2.p3.8.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p3.8.m8.1.2.3.2.2" xref="S2.SS2.p3.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.8.m8.1b"><apply id="S2.SS2.p3.8.m8.1.2.cmml" xref="S2.SS2.p3.8.m8.1.2"><times id="S2.SS2.p3.8.m8.1.2.1.cmml" xref="S2.SS2.p3.8.m8.1.2.1"></times><apply id="S2.SS2.p3.8.m8.1.2.2.cmml" xref="S2.SS2.p3.8.m8.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.8.m8.1.2.2.1.cmml" xref="S2.SS2.p3.8.m8.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.8.m8.1.2.2.2.cmml" xref="S2.SS2.p3.8.m8.1.2.2.2">𝑓</ci><ci id="S2.SS2.p3.8.m8.1.2.2.3.cmml" xref="S2.SS2.p3.8.m8.1.2.2.3">𝒘</ci></apply><ci id="S2.SS2.p3.8.m8.1.1.cmml" xref="S2.SS2.p3.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.8.m8.1c">f_{\bm{w}}(\cdot)</annotation></semantics></math> parameterized by <math id="S2.SS2.p3.9.m9.1" class="ltx_Math" alttext="\bm{w}" display="inline"><semantics id="S2.SS2.p3.9.m9.1a"><mi id="S2.SS2.p3.9.m9.1.1" xref="S2.SS2.p3.9.m9.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.9.m9.1b"><ci id="S2.SS2.p3.9.m9.1.1.cmml" xref="S2.SS2.p3.9.m9.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.9.m9.1c">\bm{w}</annotation></semantics></math>, that solves:</p>
<table id="S2.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E10.m1.4" class="ltx_Math" alttext="\underset{\bm{w}}{\textrm{minimize}}\qquad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\frac{1}{D_{r}}\sum_{j=1}^{D_{r}}\ell\left(c_{j}^{r},f_{\bm{w}}(\bm{x}_{j}^{r})\right)," display="block"><semantics id="S2.E10.m1.4a"><mrow id="S2.E10.m1.4.4.1"><mrow id="S2.E10.m1.4.4.1.1.1" xref="S2.E10.m1.4.4.1.1.2.cmml"><munder accentunder="true" id="S2.E10.m1.3.3" xref="S2.E10.m1.3.3.cmml"><mtext id="S2.E10.m1.3.3.2" xref="S2.E10.m1.3.3.2a.cmml">minimize</mtext><mo id="S2.E10.m1.3.3.1" xref="S2.E10.m1.3.3.1.cmml">𝒘</mo></munder><mspace width="2em" id="S2.E10.m1.4.4.1.1.1.2" xref="S2.E10.m1.4.4.1.1.2.cmml"></mspace><mrow id="S2.E10.m1.4.4.1.1.1.1" xref="S2.E10.m1.4.4.1.1.1.1.cmml"><mfrac id="S2.E10.m1.1.1" xref="S2.E10.m1.1.1.cmml"><mn id="S2.E10.m1.1.1.3" xref="S2.E10.m1.1.1.3.cmml">1</mn><mrow id="S2.E10.m1.1.1.1.3" xref="S2.E10.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E10.m1.1.1.1.3.1" xref="S2.E10.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml">ℛ</mi><mo stretchy="false" id="S2.E10.m1.1.1.1.3.2" xref="S2.E10.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E10.m1.4.4.1.1.1.1.3" xref="S2.E10.m1.4.4.1.1.1.1.3.cmml">​</mo><mrow id="S2.E10.m1.4.4.1.1.1.1.2" xref="S2.E10.m1.4.4.1.1.1.1.2.cmml"><munderover id="S2.E10.m1.4.4.1.1.1.1.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="S2.E10.m1.4.4.1.1.1.1.2.3.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.cmml"><mi id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.2" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.2.cmml">r</mi><mo id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.1" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.3" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S2.E10.m1.2.2.1.3" xref="S2.E10.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.E10.m1.2.2.1.3.1" xref="S2.E10.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.2.2.1.1" xref="S2.E10.m1.2.2.1.1.cmml">ℛ</mi><mo stretchy="false" id="S2.E10.m1.2.2.1.3.2" xref="S2.E10.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S2.E10.m1.4.4.1.1.1.1.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.cmml"><mfrac id="S2.E10.m1.4.4.1.1.1.1.2.2.4" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.cmml"><mn id="S2.E10.m1.4.4.1.1.1.1.2.2.4.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.2.cmml">1</mn><msub id="S2.E10.m1.4.4.1.1.1.1.2.2.4.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.cmml"><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.2.cmml">D</mi><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.3.cmml">r</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.E10.m1.4.4.1.1.1.1.2.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S2.E10.m1.4.4.1.1.1.1.2.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.cmml"><munderover id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.cmml"><mo movablelimits="false" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.cmml"><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.2.cmml">j</mi><mo id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.1" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.cmml"><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.2.cmml">D</mi><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.3.cmml">r</mi></msub></munderover><mrow id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.cmml"><mi mathvariant="normal" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.4" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml"><mo id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.4" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml">,</mo><mrow id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.cmml"><msub id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.cmml"><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml">f</mi><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.cmml">​</mo><mrow id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.2" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.3.cmml">j</mi><mi id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.3.cmml">r</mi></msubsup><mo stretchy="false" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.3" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.5" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.E10.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.4b"><list id="S2.E10.m1.4.4.1.1.2.cmml" xref="S2.E10.m1.4.4.1.1.1"><apply id="S2.E10.m1.3.3.cmml" xref="S2.E10.m1.3.3"><ci id="S2.E10.m1.3.3.1.cmml" xref="S2.E10.m1.3.3.1">𝒘</ci><ci id="S2.E10.m1.3.3.2a.cmml" xref="S2.E10.m1.3.3.2"><mtext id="S2.E10.m1.3.3.2.cmml" xref="S2.E10.m1.3.3.2">minimize</mtext></ci></apply><apply id="S2.E10.m1.4.4.1.1.1.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1"><times id="S2.E10.m1.4.4.1.1.1.1.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.3"></times><apply id="S2.E10.m1.1.1.cmml" xref="S2.E10.m1.1.1"><divide id="S2.E10.m1.1.1.2.cmml" xref="S2.E10.m1.1.1"></divide><cn type="integer" id="S2.E10.m1.1.1.3.cmml" xref="S2.E10.m1.1.1.3">1</cn><apply id="S2.E10.m1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.3"><abs id="S2.E10.m1.1.1.1.2.1.cmml" xref="S2.E10.m1.1.1.1.3.1"></abs><ci id="S2.E10.m1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1">ℛ</ci></apply></apply><apply id="S2.E10.m1.4.4.1.1.1.1.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2"><apply id="S2.E10.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E10.m1.4.4.1.1.1.1.2.3.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.3.2.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3">subscript</csymbol><sum id="S2.E10.m1.4.4.1.1.1.1.2.3.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.2"></sum><apply id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3"><eq id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.1"></eq><ci id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.2">𝑟</ci><cn type="integer" id="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><apply id="S2.E10.m1.2.2.1.2.cmml" xref="S2.E10.m1.2.2.1.3"><abs id="S2.E10.m1.2.2.1.2.1.cmml" xref="S2.E10.m1.2.2.1.3.1"></abs><ci id="S2.E10.m1.2.2.1.1.cmml" xref="S2.E10.m1.2.2.1.1">ℛ</ci></apply></apply><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2"><times id="S2.E10.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.3"></times><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.4.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4"><divide id="S2.E10.m1.4.4.1.1.1.1.2.2.4.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4"></divide><cn type="integer" id="S2.E10.m1.4.4.1.1.1.1.2.2.4.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.2">1</cn><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.3">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.2">𝐷</ci><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.4.3.3">𝑟</ci></apply></apply><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2"><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3">superscript</csymbol><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3">subscript</csymbol><sum id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.2"></sum><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3"><eq id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.1"></eq><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.2">𝐷</ci><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.3.3.3">𝑟</ci></apply></apply><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2"><times id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.3"></times><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.4.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.4">ℓ</ci><interval closure="open" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2"><apply id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2"><times id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.2"></times><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.2">𝑓</ci><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.3.3">𝒘</ci></apply><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1">superscript</csymbol><apply id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.2">𝒙</ci><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.2.3">𝑗</ci></apply><ci id="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E10.m1.4.4.1.1.1.1.2.2.2.2.2.2.2.1.1.1.3">𝑟</ci></apply></apply></interval></apply></apply></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.4c">\underset{\bm{w}}{\textrm{minimize}}\qquad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\frac{1}{D_{r}}\sum_{j=1}^{D_{r}}\ell\left(c_{j}^{r},f_{\bm{w}}(\bm{x}_{j}^{r})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p3.12" class="ltx_p">where <math id="S2.SS2.p3.10.m1.2" class="ltx_Math" alttext="\ell(\cdot\,,\cdot)" display="inline"><semantics id="S2.SS2.p3.10.m1.2a"><mrow id="S2.SS2.p3.10.m1.2.3" xref="S2.SS2.p3.10.m1.2.3.cmml"><mi mathvariant="normal" id="S2.SS2.p3.10.m1.2.3.2" xref="S2.SS2.p3.10.m1.2.3.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.10.m1.2.3.1" xref="S2.SS2.p3.10.m1.2.3.1.cmml">​</mo><mrow id="S2.SS2.p3.10.m1.2.3.3.2" xref="S2.SS2.p3.10.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p3.10.m1.2.3.3.2.1" xref="S2.SS2.p3.10.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" id="S2.SS2.p3.10.m1.1.1" xref="S2.SS2.p3.10.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS2.p3.10.m1.2.3.3.2.2" xref="S2.SS2.p3.10.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p3.10.m1.2.2" xref="S2.SS2.p3.10.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p3.10.m1.2.3.3.2.3" xref="S2.SS2.p3.10.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.10.m1.2b"><apply id="S2.SS2.p3.10.m1.2.3.cmml" xref="S2.SS2.p3.10.m1.2.3"><times id="S2.SS2.p3.10.m1.2.3.1.cmml" xref="S2.SS2.p3.10.m1.2.3.1"></times><ci id="S2.SS2.p3.10.m1.2.3.2.cmml" xref="S2.SS2.p3.10.m1.2.3.2">ℓ</ci><interval closure="open" id="S2.SS2.p3.10.m1.2.3.3.1.cmml" xref="S2.SS2.p3.10.m1.2.3.3.2"><ci id="S2.SS2.p3.10.m1.1.1.cmml" xref="S2.SS2.p3.10.m1.1.1">⋅</ci><ci id="S2.SS2.p3.10.m1.2.2.cmml" xref="S2.SS2.p3.10.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.10.m1.2c">\ell(\cdot\,,\cdot)</annotation></semantics></math> is the loss function in terms of phase prediction. In order to optimize the model parameter <math id="S2.SS2.p3.11.m2.1" class="ltx_Math" alttext="\bm{w}" display="inline"><semantics id="S2.SS2.p3.11.m2.1a"><mi id="S2.SS2.p3.11.m2.1.1" xref="S2.SS2.p3.11.m2.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.11.m2.1b"><ci id="S2.SS2.p3.11.m2.1.1.cmml" xref="S2.SS2.p3.11.m2.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.11.m2.1c">\bm{w}</annotation></semantics></math> in the ERM formulation in (<a href="#S2.E10" title="In II-B Downlink Rate Maximization ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>), all agents are required to share their datatsets <math id="S2.SS2.p3.12.m3.1" class="ltx_Math" alttext="\mathcal{D}_{r}" display="inline"><semantics id="S2.SS2.p3.12.m3.1a"><msub id="S2.SS2.p3.12.m3.1.1" xref="S2.SS2.p3.12.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.12.m3.1.1.2" xref="S2.SS2.p3.12.m3.1.1.2.cmml">𝒟</mi><mi id="S2.SS2.p3.12.m3.1.1.3" xref="S2.SS2.p3.12.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.12.m3.1b"><apply id="S2.SS2.p3.12.m3.1.1.cmml" xref="S2.SS2.p3.12.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.12.m3.1.1.1.cmml" xref="S2.SS2.p3.12.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.12.m3.1.1.2.cmml" xref="S2.SS2.p3.12.m3.1.1.2">𝒟</ci><ci id="S2.SS2.p3.12.m3.1.1.3.cmml" xref="S2.SS2.p3.12.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.12.m3.1c">\mathcal{D}_{r}</annotation></semantics></math> with a central server. Due to privacy concerns and communication constraints, (<a href="#S2.E10" title="In II-B Downlink Rate Maximization ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) is recast as a FL problem by minimizing a global loss function as follows:</p>
<table id="S2.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E11.m1.4" class="ltx_Math" alttext="\underset{\bm{w}}{\textrm{minimize}}\qquad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\ell_{r}\left(f_{\bm{w}}\right)," display="block"><semantics id="S2.E11.m1.4a"><mrow id="S2.E11.m1.4.4.1"><mrow id="S2.E11.m1.4.4.1.1.1" xref="S2.E11.m1.4.4.1.1.2.cmml"><munder accentunder="true" id="S2.E11.m1.3.3" xref="S2.E11.m1.3.3.cmml"><mtext id="S2.E11.m1.3.3.2" xref="S2.E11.m1.3.3.2a.cmml">minimize</mtext><mo id="S2.E11.m1.3.3.1" xref="S2.E11.m1.3.3.1.cmml">𝒘</mo></munder><mspace width="2em" id="S2.E11.m1.4.4.1.1.1.2" xref="S2.E11.m1.4.4.1.1.2.cmml"></mspace><mrow id="S2.E11.m1.4.4.1.1.1.1" xref="S2.E11.m1.4.4.1.1.1.1.cmml"><mfrac id="S2.E11.m1.1.1" xref="S2.E11.m1.1.1.cmml"><mn id="S2.E11.m1.1.1.3" xref="S2.E11.m1.1.1.3.cmml">1</mn><mrow id="S2.E11.m1.1.1.1.3" xref="S2.E11.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E11.m1.1.1.1.3.1" xref="S2.E11.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.cmml">ℛ</mi><mo stretchy="false" id="S2.E11.m1.1.1.1.3.2" xref="S2.E11.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E11.m1.4.4.1.1.1.1.2" xref="S2.E11.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S2.E11.m1.4.4.1.1.1.1.1" xref="S2.E11.m1.4.4.1.1.1.1.1.cmml"><munderover id="S2.E11.m1.4.4.1.1.1.1.1.2" xref="S2.E11.m1.4.4.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E11.m1.4.4.1.1.1.1.1.2.2.2" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.2" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">r</mi><mo id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.1" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.3" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.E11.m1.2.2.1.3" xref="S2.E11.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.E11.m1.2.2.1.3.1" xref="S2.E11.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.2.2.1.1" xref="S2.E11.m1.2.2.1.1.cmml">ℛ</mi><mo stretchy="false" id="S2.E11.m1.2.2.1.3.2" xref="S2.E11.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S2.E11.m1.4.4.1.1.1.1.1.1" xref="S2.E11.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S2.E11.m1.4.4.1.1.1.1.1.1.3" xref="S2.E11.m1.4.4.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S2.E11.m1.4.4.1.1.1.1.1.1.3.2" xref="S2.E11.m1.4.4.1.1.1.1.1.1.3.2.cmml">ℓ</mi><mi id="S2.E11.m1.4.4.1.1.1.1.1.1.3.3" xref="S2.E11.m1.4.4.1.1.1.1.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S2.E11.m1.4.4.1.1.1.1.1.1.2" xref="S2.E11.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mi id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">𝒘</mi></msub><mo id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E11.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.4b"><list id="S2.E11.m1.4.4.1.1.2.cmml" xref="S2.E11.m1.4.4.1.1.1"><apply id="S2.E11.m1.3.3.cmml" xref="S2.E11.m1.3.3"><ci id="S2.E11.m1.3.3.1.cmml" xref="S2.E11.m1.3.3.1">𝒘</ci><ci id="S2.E11.m1.3.3.2a.cmml" xref="S2.E11.m1.3.3.2"><mtext id="S2.E11.m1.3.3.2.cmml" xref="S2.E11.m1.3.3.2">minimize</mtext></ci></apply><apply id="S2.E11.m1.4.4.1.1.1.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1"><times id="S2.E11.m1.4.4.1.1.1.1.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.2"></times><apply id="S2.E11.m1.1.1.cmml" xref="S2.E11.m1.1.1"><divide id="S2.E11.m1.1.1.2.cmml" xref="S2.E11.m1.1.1"></divide><cn type="integer" id="S2.E11.m1.1.1.3.cmml" xref="S2.E11.m1.1.1.3">1</cn><apply id="S2.E11.m1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.3"><abs id="S2.E11.m1.1.1.1.2.1.cmml" xref="S2.E11.m1.1.1.1.3.1"></abs><ci id="S2.E11.m1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1">ℛ</ci></apply></apply><apply id="S2.E11.m1.4.4.1.1.1.1.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1"><apply id="S2.E11.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E11.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E11.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.2"></sum><apply id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3"><eq id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.2">𝑟</ci><cn type="integer" id="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E11.m1.2.2.1.2.cmml" xref="S2.E11.m1.2.2.1.3"><abs id="S2.E11.m1.2.2.1.2.1.cmml" xref="S2.E11.m1.2.2.1.3.1"></abs><ci id="S2.E11.m1.2.2.1.1.cmml" xref="S2.E11.m1.2.2.1.1">ℛ</ci></apply></apply><apply id="S2.E11.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1"><times id="S2.E11.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.2"></times><apply id="S2.E11.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E11.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.3.2">ℓ</ci><ci id="S2.E11.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝒘</ci></apply></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.4c">\underset{\bm{w}}{\textrm{minimize}}\qquad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\ell_{r}\left(f_{\bm{w}}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p3.14" class="ltx_p">where <math id="S2.SS2.p3.13.m1.3" class="ltx_Math" alttext="\ell_{r}\left(f_{\bm{w}}\right)=\frac{1}{D_{r}}\sum_{j=1}^{D_{r}}\ell\left(c_{j}^{r},f_{\bm{w}}(\bm{x}_{j}^{r})\right)" display="inline"><semantics id="S2.SS2.p3.13.m1.3a"><mrow id="S2.SS2.p3.13.m1.3.3" xref="S2.SS2.p3.13.m1.3.3.cmml"><mrow id="S2.SS2.p3.13.m1.1.1.1" xref="S2.SS2.p3.13.m1.1.1.1.cmml"><msub id="S2.SS2.p3.13.m1.1.1.1.3" xref="S2.SS2.p3.13.m1.1.1.1.3.cmml"><mi mathvariant="normal" id="S2.SS2.p3.13.m1.1.1.1.3.2" xref="S2.SS2.p3.13.m1.1.1.1.3.2.cmml">ℓ</mi><mi id="S2.SS2.p3.13.m1.1.1.1.3.3" xref="S2.SS2.p3.13.m1.1.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.13.m1.1.1.1.2" xref="S2.SS2.p3.13.m1.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p3.13.m1.1.1.1.1.1" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p3.13.m1.1.1.1.1.1.2" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p3.13.m1.1.1.1.1.1.1" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.13.m1.1.1.1.1.1.1.2" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.2.cmml">f</mi><mi id="S2.SS2.p3.13.m1.1.1.1.1.1.1.3" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.3.cmml">𝒘</mi></msub><mo id="S2.SS2.p3.13.m1.1.1.1.1.1.3" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p3.13.m1.3.3.4" xref="S2.SS2.p3.13.m1.3.3.4.cmml">=</mo><mrow id="S2.SS2.p3.13.m1.3.3.3" xref="S2.SS2.p3.13.m1.3.3.3.cmml"><mfrac id="S2.SS2.p3.13.m1.3.3.3.4" xref="S2.SS2.p3.13.m1.3.3.3.4.cmml"><mn id="S2.SS2.p3.13.m1.3.3.3.4.2" xref="S2.SS2.p3.13.m1.3.3.3.4.2.cmml">1</mn><msub id="S2.SS2.p3.13.m1.3.3.3.4.3" xref="S2.SS2.p3.13.m1.3.3.3.4.3.cmml"><mi id="S2.SS2.p3.13.m1.3.3.3.4.3.2" xref="S2.SS2.p3.13.m1.3.3.3.4.3.2.cmml">D</mi><mi id="S2.SS2.p3.13.m1.3.3.3.4.3.3" xref="S2.SS2.p3.13.m1.3.3.3.4.3.3.cmml">r</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.SS2.p3.13.m1.3.3.3.3" xref="S2.SS2.p3.13.m1.3.3.3.3.cmml">​</mo><mrow id="S2.SS2.p3.13.m1.3.3.3.2" xref="S2.SS2.p3.13.m1.3.3.3.2.cmml"><msubsup id="S2.SS2.p3.13.m1.3.3.3.2.3" xref="S2.SS2.p3.13.m1.3.3.3.2.3.cmml"><mo id="S2.SS2.p3.13.m1.3.3.3.2.3.2.2" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.2.cmml">∑</mo><mrow id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.cmml"><mi id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.2" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.2.cmml">j</mi><mo id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.1" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.1.cmml">=</mo><mn id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.3" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.3.cmml">1</mn></mrow><msub id="S2.SS2.p3.13.m1.3.3.3.2.3.3" xref="S2.SS2.p3.13.m1.3.3.3.2.3.3.cmml"><mi id="S2.SS2.p3.13.m1.3.3.3.2.3.3.2" xref="S2.SS2.p3.13.m1.3.3.3.2.3.3.2.cmml">D</mi><mi id="S2.SS2.p3.13.m1.3.3.3.2.3.3.3" xref="S2.SS2.p3.13.m1.3.3.3.2.3.3.3.cmml">r</mi></msub></msubsup><mrow id="S2.SS2.p3.13.m1.3.3.3.2.2" xref="S2.SS2.p3.13.m1.3.3.3.2.2.cmml"><mi mathvariant="normal" id="S2.SS2.p3.13.m1.3.3.3.2.2.4" xref="S2.SS2.p3.13.m1.3.3.3.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.13.m1.3.3.3.2.2.3" xref="S2.SS2.p3.13.m1.3.3.3.2.2.3.cmml">​</mo><mrow id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.3.cmml"><mo id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.3" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.3.cmml">(</mo><msubsup id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.2" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.2.cmml">c</mi><mi id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.3" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.3.cmml">j</mi><mi id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.3" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.4" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.3.cmml">,</mo><mrow id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.cmml"><msub id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.cmml"><mi id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.2" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.2.cmml">f</mi><mi id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.3" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.2" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.2" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.2" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.3" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.3.cmml">j</mi><mi id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.3" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.3.cmml">r</mi></msubsup><mo stretchy="false" id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.3" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.5" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.13.m1.3b"><apply id="S2.SS2.p3.13.m1.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3"><eq id="S2.SS2.p3.13.m1.3.3.4.cmml" xref="S2.SS2.p3.13.m1.3.3.4"></eq><apply id="S2.SS2.p3.13.m1.1.1.1.cmml" xref="S2.SS2.p3.13.m1.1.1.1"><times id="S2.SS2.p3.13.m1.1.1.1.2.cmml" xref="S2.SS2.p3.13.m1.1.1.1.2"></times><apply id="S2.SS2.p3.13.m1.1.1.1.3.cmml" xref="S2.SS2.p3.13.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.1.1.1.3.1.cmml" xref="S2.SS2.p3.13.m1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p3.13.m1.1.1.1.3.2.cmml" xref="S2.SS2.p3.13.m1.1.1.1.3.2">ℓ</ci><ci id="S2.SS2.p3.13.m1.1.1.1.3.3.cmml" xref="S2.SS2.p3.13.m1.1.1.1.3.3">𝑟</ci></apply><apply id="S2.SS2.p3.13.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.13.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.13.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.2">𝑓</ci><ci id="S2.SS2.p3.13.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.13.m1.1.1.1.1.1.1.3">𝒘</ci></apply></apply><apply id="S2.SS2.p3.13.m1.3.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3"><times id="S2.SS2.p3.13.m1.3.3.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.3"></times><apply id="S2.SS2.p3.13.m1.3.3.3.4.cmml" xref="S2.SS2.p3.13.m1.3.3.3.4"><divide id="S2.SS2.p3.13.m1.3.3.3.4.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.4"></divide><cn type="integer" id="S2.SS2.p3.13.m1.3.3.3.4.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.4.2">1</cn><apply id="S2.SS2.p3.13.m1.3.3.3.4.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.4.3"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.3.3.3.4.3.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.4.3">subscript</csymbol><ci id="S2.SS2.p3.13.m1.3.3.3.4.3.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.4.3.2">𝐷</ci><ci id="S2.SS2.p3.13.m1.3.3.3.4.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.4.3.3">𝑟</ci></apply></apply><apply id="S2.SS2.p3.13.m1.3.3.3.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2"><apply id="S2.SS2.p3.13.m1.3.3.3.2.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.3.3.3.2.3.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3">superscript</csymbol><apply id="S2.SS2.p3.13.m1.3.3.3.2.3.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.3.3.3.2.3.2.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3">subscript</csymbol><sum id="S2.SS2.p3.13.m1.3.3.3.2.3.2.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.2"></sum><apply id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3"><eq id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.1"></eq><ci id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.2">𝑗</ci><cn type="integer" id="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p3.13.m1.3.3.3.2.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.3.3.3.2.3.3.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.3">subscript</csymbol><ci id="S2.SS2.p3.13.m1.3.3.3.2.3.3.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.3.2">𝐷</ci><ci id="S2.SS2.p3.13.m1.3.3.3.2.3.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.3.3.3">𝑟</ci></apply></apply><apply id="S2.SS2.p3.13.m1.3.3.3.2.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2"><times id="S2.SS2.p3.13.m1.3.3.3.2.2.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.3"></times><ci id="S2.SS2.p3.13.m1.3.3.3.2.2.4.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.4">ℓ</ci><interval closure="open" id="S2.SS2.p3.13.m1.3.3.3.2.2.2.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2"><apply id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.13.m1.2.2.2.1.1.1.1.1.3">𝑟</ci></apply><apply id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2"><times id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.2"></times><apply id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.2">𝑓</ci><ci id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.3.3">𝒘</ci></apply><apply id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1">superscript</csymbol><apply id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.2">𝒙</ci><ci id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.2.3">𝑗</ci></apply><ci id="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p3.13.m1.3.3.3.2.2.2.2.2.1.1.1.3">𝑟</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.13.m1.3c">\ell_{r}\left(f_{\bm{w}}\right)=\frac{1}{D_{r}}\sum_{j=1}^{D_{r}}\ell\left(c_{j}^{r},f_{\bm{w}}(\bm{x}_{j}^{r})\right)</annotation></semantics></math> is the local loss function of agent <math id="S2.SS2.p3.14.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.p3.14.m2.1a"><mi id="S2.SS2.p3.14.m2.1.1" xref="S2.SS2.p3.14.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.14.m2.1b"><ci id="S2.SS2.p3.14.m2.1.1.cmml" xref="S2.SS2.p3.14.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.14.m2.1c">r</annotation></semantics></math>. One of the most popular approaches in FL to solve (<a href="#S2.E11" title="In II-B Downlink Rate Maximization ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>) is the <span id="S2.SS2.p3.14.1" class="ltx_text ltx_font_smallcaps">FedAVG</span> algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.2" class="ltx_p">However, the formulation in (<a href="#S2.E11" title="In II-B Downlink Rate Maximization ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>) assumes that all agents in <math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">\mathcal{R}</annotation></semantics></math> have an equal impact on training the global model <math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="\bm{w}" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><mi id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><ci id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">\bm{w}</annotation></semantics></math>.
This falls under the strong assumption of uniform and homogeneous data distribution across agents. Under data heterogeneity, drifts in the agents’ local updates with respect to the aggregated model might occur, since the local optima do not necessarily coincide with the global optima.
Thus, the obtained model suffers from the instability in convergence, and fails to generalize to OoD samples.
To obviate this issue, we resort to Invariant Risk Minimization (IRM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and its FL variant dubbed <span id="S2.SS2.p4.2.1" class="ltx_text ltx_font_smallcaps">FL Games</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">FL Games for Phase Optimization</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The key deficiency of using <span id="S3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAVG</span> on limited datasets distributed across agents is that its trained predictor heavily relies on statistical correlations among observations. These correlations are specious since they depend on the environment from which they were sampled. Thus, overfitting to these correlations prevents <span id="S3.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAVG</span> from training a predictor that is robust in unseen environments. To overcome this issue, we turn our attention to algorithms that learn causal representations that are invariant across different agents, which improves the model’s OoD generalization across many environments.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.9" class="ltx_p">In this direction, IRM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> jointly trains an <em id="S3.p2.9.1" class="ltx_emph ltx_font_italic">extraction function</em> <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="f_{\bm{\phi}}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝑓</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">f_{\bm{\phi}}</annotation></semantics></math> and a <em id="S3.p2.9.2" class="ltx_emph ltx_font_italic">predictor</em> <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="f_{\bm{w}}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">f</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">𝒘</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑓</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">f_{\bm{w}}</annotation></semantics></math> across training environments <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathcal{R}</annotation></semantics></math> in such a way that <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="f_{\bm{w}}\circ f_{\bm{\phi}}" display="inline"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><msub id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml"><mi id="S3.p2.4.m4.1.1.2.2" xref="S3.p2.4.m4.1.1.2.2.cmml">f</mi><mi id="S3.p2.4.m4.1.1.2.3" xref="S3.p2.4.m4.1.1.2.3.cmml">𝒘</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">∘</mo><msub id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml"><mi id="S3.p2.4.m4.1.1.3.2" xref="S3.p2.4.m4.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.4.m4.1.1.3.3" xref="S3.p2.4.m4.1.1.3.3.cmml">ϕ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><compose id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1"></compose><apply id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.2.1.cmml" xref="S3.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.2.cmml" xref="S3.p2.4.m4.1.1.2.2">𝑓</ci><ci id="S3.p2.4.m4.1.1.2.3.cmml" xref="S3.p2.4.m4.1.1.2.3">𝒘</ci></apply><apply id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.3.1.cmml" xref="S3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.p2.4.m4.1.1.3.2.cmml" xref="S3.p2.4.m4.1.1.3.2">𝑓</ci><ci id="S3.p2.4.m4.1.1.3.3.cmml" xref="S3.p2.4.m4.1.1.3.3">bold-italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">f_{\bm{w}}\circ f_{\bm{\phi}}</annotation></semantics></math> generalizes well in unseen environments <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{R}_{\text{all}}\supset\mathcal{R}" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><msub id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1.2.2" xref="S3.p2.5.m5.1.1.2.2.cmml">ℛ</mi><mtext id="S3.p2.5.m5.1.1.2.3" xref="S3.p2.5.m5.1.1.2.3a.cmml">all</mtext></msub><mo id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.cmml">⊃</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><subset id="S3.p2.5.m5.1.1a.cmml" xref="S3.p2.5.m5.1.1"></subset><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">ℛ</ci><apply id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.2.1.cmml" xref="S3.p2.5.m5.1.1.2">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.2.cmml" xref="S3.p2.5.m5.1.1.2.2">ℛ</ci><ci id="S3.p2.5.m5.1.1.2.3a.cmml" xref="S3.p2.5.m5.1.1.2.3"><mtext mathsize="70%" id="S3.p2.5.m5.1.1.2.3.cmml" xref="S3.p2.5.m5.1.1.2.3">all</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\mathcal{R}_{\text{all}}\supset\mathcal{R}</annotation></semantics></math>.
The main idea is to build a parameterized feature extractor <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="f_{\bm{\phi}}" display="inline"><semantics id="S3.p2.6.m6.1a"><msub id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝑓</ci><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">f_{\bm{\phi}}</annotation></semantics></math> that reveals the causal representations in the samples, so as to perform causal inference by optimizing <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="f_{\bm{w}}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">f</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">𝒘</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝑓</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">f_{\bm{w}}</annotation></semantics></math>. Thus, given an extraction function, the predictor <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="f_{\bm{w}}" display="inline"><semantics id="S3.p2.8.m8.1a"><msub id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">f</mi><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">𝒘</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝑓</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">f_{\bm{w}}</annotation></semantics></math> is the one that is simultaneously optimal across all training environments <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.p2.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">\mathcal{R}</annotation></semantics></math>. Formally, this boils down to solving the following problem:</p>
<table id="S3.E12" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E12X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\underset{\bm{\phi},\,\bm{w}}{\textrm{minimize}}" display="inline"><semantics id="S3.E12X.2.1.1.m1.2a"><munder accentunder="true" id="S3.E12X.2.1.1.m1.2.2" xref="S3.E12X.2.1.1.m1.2.2.cmml"><mtext id="S3.E12X.2.1.1.m1.2.2.3" xref="S3.E12X.2.1.1.m1.2.2.3a.cmml">minimize</mtext><mrow id="S3.E12X.2.1.1.m1.2.2.2.4" xref="S3.E12X.2.1.1.m1.2.2.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E12X.2.1.1.m1.1.1.1.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.cmml">ϕ</mi><mo rspace="0.337em" id="S3.E12X.2.1.1.m1.2.2.2.4.1" xref="S3.E12X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E12X.2.1.1.m1.2.2.2.2" xref="S3.E12X.2.1.1.m1.2.2.2.2.cmml">𝒘</mi></mrow></munder><annotation-xml encoding="MathML-Content" id="S3.E12X.2.1.1.m1.2b"><apply id="S3.E12X.2.1.1.m1.2.2.cmml" xref="S3.E12X.2.1.1.m1.2.2"><list id="S3.E12X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E12X.2.1.1.m1.2.2.2.4"><ci id="S3.E12X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1">bold-italic-ϕ</ci><ci id="S3.E12X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E12X.2.1.1.m1.2.2.2.2">𝒘</ci></list><ci id="S3.E12X.2.1.1.m1.2.2.3a.cmml" xref="S3.E12X.2.1.1.m1.2.2.3"><mtext id="S3.E12X.2.1.1.m1.2.2.3.cmml" xref="S3.E12X.2.1.1.m1.2.2.3">minimize</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.2.1.1.m1.2c">\displaystyle\underset{\bm{\phi},\,\bm{w}}{\textrm{minimize}}</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12X.4.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\quad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\ell_{r}\left(f_{\bm{w}}\circ f_{\bm{\phi}}\right)" display="inline"><semantics id="S3.E12X.4.1.1.m1.3a"><mrow id="S3.E12X.4.1.1.m1.3.3" xref="S3.E12X.4.1.1.m1.3.3.cmml"><mstyle displaystyle="true" id="S3.E12X.4.1.1.m1.1.1" xref="S3.E12X.4.1.1.m1.1.1.cmml"><mfrac id="S3.E12X.4.1.1.m1.1.1a" xref="S3.E12X.4.1.1.m1.1.1.cmml"><mn id="S3.E12X.4.1.1.m1.1.1.3" xref="S3.E12X.4.1.1.m1.1.1.3.cmml">1</mn><mrow id="S3.E12X.4.1.1.m1.1.1.1.3" xref="S3.E12X.4.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12X.4.1.1.m1.1.1.1.3.1" xref="S3.E12X.4.1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12X.4.1.1.m1.1.1.1.1" xref="S3.E12X.4.1.1.m1.1.1.1.1.cmml">ℛ</mi><mo stretchy="false" id="S3.E12X.4.1.1.m1.1.1.1.3.2" xref="S3.E12X.4.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E12X.4.1.1.m1.3.3.2" xref="S3.E12X.4.1.1.m1.3.3.2.cmml">​</mo><mrow id="S3.E12X.4.1.1.m1.3.3.1" xref="S3.E12X.4.1.1.m1.3.3.1.cmml"><mstyle displaystyle="true" id="S3.E12X.4.1.1.m1.3.3.1.2" xref="S3.E12X.4.1.1.m1.3.3.1.2.cmml"><munderover id="S3.E12X.4.1.1.m1.3.3.1.2a" xref="S3.E12X.4.1.1.m1.3.3.1.2.cmml"><mo movablelimits="false" id="S3.E12X.4.1.1.m1.3.3.1.2.2.2" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E12X.4.1.1.m1.3.3.1.2.2.3" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3.cmml"><mi id="S3.E12X.4.1.1.m1.3.3.1.2.2.3.2" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3.2.cmml">r</mi><mo id="S3.E12X.4.1.1.m1.3.3.1.2.2.3.1" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E12X.4.1.1.m1.3.3.1.2.2.3.3" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E12X.4.1.1.m1.2.2.1.3" xref="S3.E12X.4.1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E12X.4.1.1.m1.2.2.1.3.1" xref="S3.E12X.4.1.1.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12X.4.1.1.m1.2.2.1.1" xref="S3.E12X.4.1.1.m1.2.2.1.1.cmml">ℛ</mi><mo stretchy="false" id="S3.E12X.4.1.1.m1.2.2.1.3.2" xref="S3.E12X.4.1.1.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S3.E12X.4.1.1.m1.3.3.1.1" xref="S3.E12X.4.1.1.m1.3.3.1.1.cmml"><msub id="S3.E12X.4.1.1.m1.3.3.1.1.3" xref="S3.E12X.4.1.1.m1.3.3.1.1.3.cmml"><mi mathvariant="normal" id="S3.E12X.4.1.1.m1.3.3.1.1.3.2" xref="S3.E12X.4.1.1.m1.3.3.1.1.3.2.cmml">ℓ</mi><mi id="S3.E12X.4.1.1.m1.3.3.1.1.3.3" xref="S3.E12X.4.1.1.m1.3.3.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12X.4.1.1.m1.3.3.1.1.2" xref="S3.E12X.4.1.1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E12X.4.1.1.m1.3.3.1.1.1.1" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.2" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.2" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.3" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">𝒘</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.1.cmml">∘</mo><msub id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.2" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.3" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.3" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.4.1.1.m1.3b"><apply id="S3.E12X.4.1.1.m1.3.3.cmml" xref="S3.E12X.4.1.1.m1.3.3"><times id="S3.E12X.4.1.1.m1.3.3.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.2"></times><apply id="S3.E12X.4.1.1.m1.1.1.cmml" xref="S3.E12X.4.1.1.m1.1.1"><divide id="S3.E12X.4.1.1.m1.1.1.2.cmml" xref="S3.E12X.4.1.1.m1.1.1"></divide><cn type="integer" id="S3.E12X.4.1.1.m1.1.1.3.cmml" xref="S3.E12X.4.1.1.m1.1.1.3">1</cn><apply id="S3.E12X.4.1.1.m1.1.1.1.2.cmml" xref="S3.E12X.4.1.1.m1.1.1.1.3"><abs id="S3.E12X.4.1.1.m1.1.1.1.2.1.cmml" xref="S3.E12X.4.1.1.m1.1.1.1.3.1"></abs><ci id="S3.E12X.4.1.1.m1.1.1.1.1.cmml" xref="S3.E12X.4.1.1.m1.1.1.1.1">ℛ</ci></apply></apply><apply id="S3.E12X.4.1.1.m1.3.3.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1"><apply id="S3.E12X.4.1.1.m1.3.3.1.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.E12X.4.1.1.m1.3.3.1.2.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2">superscript</csymbol><apply id="S3.E12X.4.1.1.m1.3.3.1.2.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.E12X.4.1.1.m1.3.3.1.2.2.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2">subscript</csymbol><sum id="S3.E12X.4.1.1.m1.3.3.1.2.2.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.2"></sum><apply id="S3.E12X.4.1.1.m1.3.3.1.2.2.3.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3"><eq id="S3.E12X.4.1.1.m1.3.3.1.2.2.3.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3.1"></eq><ci id="S3.E12X.4.1.1.m1.3.3.1.2.2.3.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3.2">𝑟</ci><cn type="integer" id="S3.E12X.4.1.1.m1.3.3.1.2.2.3.3.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E12X.4.1.1.m1.2.2.1.2.cmml" xref="S3.E12X.4.1.1.m1.2.2.1.3"><abs id="S3.E12X.4.1.1.m1.2.2.1.2.1.cmml" xref="S3.E12X.4.1.1.m1.2.2.1.3.1"></abs><ci id="S3.E12X.4.1.1.m1.2.2.1.1.cmml" xref="S3.E12X.4.1.1.m1.2.2.1.1">ℛ</ci></apply></apply><apply id="S3.E12X.4.1.1.m1.3.3.1.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1"><times id="S3.E12X.4.1.1.m1.3.3.1.1.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.2"></times><apply id="S3.E12X.4.1.1.m1.3.3.1.1.3.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E12X.4.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E12X.4.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.3.2">ℓ</ci><ci id="S3.E12X.4.1.1.m1.3.3.1.1.3.3.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.3.3">𝑟</ci></apply><apply id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1"><compose id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.1"></compose><apply id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.2.3">𝒘</ci></apply><apply id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E12X.4.1.1.m1.3.3.1.1.1.1.1.3.3">bold-italic-ϕ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.4.1.1.m1.3c">\displaystyle\quad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\ell_{r}\left(f_{\bm{w}}\circ f_{\bm{\phi}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
<tr id="S3.E12Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span id="S3.E12Xa.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">subject to</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12Xa.4.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\quad\bm{w}\in\underset{\bm{w}^{\prime}}{\arg\min}\,\;\ell_{r}\left(f_{\bm{w}^{\prime}}\circ f_{\bm{\phi}}\right)\;\;\;\;\;\forall\,r\in\mathcal{R}." display="inline"><semantics id="S3.E12Xa.4.1.1.m1.1a"><mrow id="S3.E12Xa.4.1.1.m1.1.1.1"><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.3.cmml">𝒘</mi><mo id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.2.cmml">∈</mo><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.cmml"><munder accentunder="true" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2a" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">⁡</mo><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml">min</mi></mrow><msup id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.2.cmml">𝒘</mi><mo id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.3.cmml">′</mo></msup></munder><mo lspace="0.167em" rspace="0em" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.2.cmml">ℓ</mi><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.2a" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><msup id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">𝒘</mi><mo id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">′</mo></msup></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace width="1.556em" id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.3a.cmml"></mspace><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.cmml"><mo rspace="0.337em" id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.2" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.2.cmml">r</mi></mrow><mo id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.1" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.3" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.3.cmml">ℛ</mi></mrow></mrow><mo lspace="0em" id="S3.E12Xa.4.1.1.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12Xa.4.1.1.m1.1b"><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12Xa.4.1.1.m1.1.1.1.1.3a.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1"><in id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.2"></in><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.3">𝒘</ci><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3"><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1">superscript</csymbol><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.2">𝒘</ci><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.1.3">′</ci></apply><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2"><arg id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.1"></arg><min id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.3.2.2"></min></apply></apply><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.2">ℓ</ci><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.4.3">𝑟</ci></apply><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1"><compose id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"></compose><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝒘</ci><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">′</ci></apply></apply><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3">bold-italic-ϕ</ci></apply></apply></apply></apply><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2"><in id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.1"></in><apply id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.2.2">𝑟</ci></apply><ci id="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E12Xa.4.1.1.m1.1.1.1.1.2.2.3">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12Xa.4.1.1.m1.1c">\displaystyle\quad\bm{w}\in\underset{\bm{w}^{\prime}}{\arg\min}\,\;\ell_{r}\left(f_{\bm{w}^{\prime}}\circ f_{\bm{\phi}}\right)\;\;\;\;\;\forall\,r\in\mathcal{R}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.p2.12" class="ltx_p">Note that IRM is formulated as a single agent optimization problem, and assumes that training environments are known to the agent beforehand.
Extending IRM to the distributed setting can be done using game theory (<span id="S3.p2.12.1" class="ltx_text ltx_font_smallcaps">IRM Games</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>).
Therein, different agents, each equipped with its own predictor <math id="S3.p2.10.m1.1" class="ltx_Math" alttext="\bm{w}_{r}" display="inline"><semantics id="S3.p2.10.m1.1a"><msub id="S3.p2.10.m1.1.1" xref="S3.p2.10.m1.1.1.cmml"><mi id="S3.p2.10.m1.1.1.2" xref="S3.p2.10.m1.1.1.2.cmml">𝒘</mi><mi id="S3.p2.10.m1.1.1.3" xref="S3.p2.10.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.10.m1.1b"><apply id="S3.p2.10.m1.1.1.cmml" xref="S3.p2.10.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m1.1.1.1.cmml" xref="S3.p2.10.m1.1.1">subscript</csymbol><ci id="S3.p2.10.m1.1.1.2.cmml" xref="S3.p2.10.m1.1.1.2">𝒘</ci><ci id="S3.p2.10.m1.1.1.3.cmml" xref="S3.p2.10.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m1.1c">\bm{w}_{r}</annotation></semantics></math>, cooperate to train an ensemble model: <math id="S3.p2.11.m2.1" class="ltx_Math" alttext="\bm{w}^{\text{av}}=\sum_{r\in\mathcal{R}}\frac{D_{r}}{\sum_{n\in\mathcal{R}}D_{n}}\bm{w}_{r}" display="inline"><semantics id="S3.p2.11.m2.1a"><mrow id="S3.p2.11.m2.1.1" xref="S3.p2.11.m2.1.1.cmml"><msup id="S3.p2.11.m2.1.1.2" xref="S3.p2.11.m2.1.1.2.cmml"><mi id="S3.p2.11.m2.1.1.2.2" xref="S3.p2.11.m2.1.1.2.2.cmml">𝒘</mi><mtext id="S3.p2.11.m2.1.1.2.3" xref="S3.p2.11.m2.1.1.2.3a.cmml">av</mtext></msup><mo rspace="0.111em" id="S3.p2.11.m2.1.1.1" xref="S3.p2.11.m2.1.1.1.cmml">=</mo><mrow id="S3.p2.11.m2.1.1.3" xref="S3.p2.11.m2.1.1.3.cmml"><msub id="S3.p2.11.m2.1.1.3.1" xref="S3.p2.11.m2.1.1.3.1.cmml"><mo id="S3.p2.11.m2.1.1.3.1.2" xref="S3.p2.11.m2.1.1.3.1.2.cmml">∑</mo><mrow id="S3.p2.11.m2.1.1.3.1.3" xref="S3.p2.11.m2.1.1.3.1.3.cmml"><mi id="S3.p2.11.m2.1.1.3.1.3.2" xref="S3.p2.11.m2.1.1.3.1.3.2.cmml">r</mi><mo id="S3.p2.11.m2.1.1.3.1.3.1" xref="S3.p2.11.m2.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.11.m2.1.1.3.1.3.3" xref="S3.p2.11.m2.1.1.3.1.3.3.cmml">ℛ</mi></mrow></msub><mrow id="S3.p2.11.m2.1.1.3.2" xref="S3.p2.11.m2.1.1.3.2.cmml"><mfrac id="S3.p2.11.m2.1.1.3.2.2" xref="S3.p2.11.m2.1.1.3.2.2.cmml"><msub id="S3.p2.11.m2.1.1.3.2.2.2" xref="S3.p2.11.m2.1.1.3.2.2.2.cmml"><mi id="S3.p2.11.m2.1.1.3.2.2.2.2" xref="S3.p2.11.m2.1.1.3.2.2.2.2.cmml">D</mi><mi id="S3.p2.11.m2.1.1.3.2.2.2.3" xref="S3.p2.11.m2.1.1.3.2.2.2.3.cmml">r</mi></msub><mrow id="S3.p2.11.m2.1.1.3.2.2.3" xref="S3.p2.11.m2.1.1.3.2.2.3.cmml"><mstyle displaystyle="false" id="S3.p2.11.m2.1.1.3.2.2.3.1" xref="S3.p2.11.m2.1.1.3.2.2.3.1.cmml"><msub id="S3.p2.11.m2.1.1.3.2.2.3.1a" xref="S3.p2.11.m2.1.1.3.2.2.3.1.cmml"><mo id="S3.p2.11.m2.1.1.3.2.2.3.1.2" xref="S3.p2.11.m2.1.1.3.2.2.3.1.2.cmml">∑</mo><mrow id="S3.p2.11.m2.1.1.3.2.2.3.1.3" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3.cmml"><mi id="S3.p2.11.m2.1.1.3.2.2.3.1.3.2" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3.2.cmml">n</mi><mo id="S3.p2.11.m2.1.1.3.2.2.3.1.3.1" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.11.m2.1.1.3.2.2.3.1.3.3" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3.3.cmml">ℛ</mi></mrow></msub></mstyle><msub id="S3.p2.11.m2.1.1.3.2.2.3.2" xref="S3.p2.11.m2.1.1.3.2.2.3.2.cmml"><mi id="S3.p2.11.m2.1.1.3.2.2.3.2.2" xref="S3.p2.11.m2.1.1.3.2.2.3.2.2.cmml">D</mi><mi id="S3.p2.11.m2.1.1.3.2.2.3.2.3" xref="S3.p2.11.m2.1.1.3.2.2.3.2.3.cmml">n</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.p2.11.m2.1.1.3.2.1" xref="S3.p2.11.m2.1.1.3.2.1.cmml">​</mo><msub id="S3.p2.11.m2.1.1.3.2.3" xref="S3.p2.11.m2.1.1.3.2.3.cmml"><mi id="S3.p2.11.m2.1.1.3.2.3.2" xref="S3.p2.11.m2.1.1.3.2.3.2.cmml">𝒘</mi><mi id="S3.p2.11.m2.1.1.3.2.3.3" xref="S3.p2.11.m2.1.1.3.2.3.3.cmml">r</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.11.m2.1b"><apply id="S3.p2.11.m2.1.1.cmml" xref="S3.p2.11.m2.1.1"><eq id="S3.p2.11.m2.1.1.1.cmml" xref="S3.p2.11.m2.1.1.1"></eq><apply id="S3.p2.11.m2.1.1.2.cmml" xref="S3.p2.11.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.2.1.cmml" xref="S3.p2.11.m2.1.1.2">superscript</csymbol><ci id="S3.p2.11.m2.1.1.2.2.cmml" xref="S3.p2.11.m2.1.1.2.2">𝒘</ci><ci id="S3.p2.11.m2.1.1.2.3a.cmml" xref="S3.p2.11.m2.1.1.2.3"><mtext mathsize="70%" id="S3.p2.11.m2.1.1.2.3.cmml" xref="S3.p2.11.m2.1.1.2.3">av</mtext></ci></apply><apply id="S3.p2.11.m2.1.1.3.cmml" xref="S3.p2.11.m2.1.1.3"><apply id="S3.p2.11.m2.1.1.3.1.cmml" xref="S3.p2.11.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.3.1.1.cmml" xref="S3.p2.11.m2.1.1.3.1">subscript</csymbol><sum id="S3.p2.11.m2.1.1.3.1.2.cmml" xref="S3.p2.11.m2.1.1.3.1.2"></sum><apply id="S3.p2.11.m2.1.1.3.1.3.cmml" xref="S3.p2.11.m2.1.1.3.1.3"><in id="S3.p2.11.m2.1.1.3.1.3.1.cmml" xref="S3.p2.11.m2.1.1.3.1.3.1"></in><ci id="S3.p2.11.m2.1.1.3.1.3.2.cmml" xref="S3.p2.11.m2.1.1.3.1.3.2">𝑟</ci><ci id="S3.p2.11.m2.1.1.3.1.3.3.cmml" xref="S3.p2.11.m2.1.1.3.1.3.3">ℛ</ci></apply></apply><apply id="S3.p2.11.m2.1.1.3.2.cmml" xref="S3.p2.11.m2.1.1.3.2"><times id="S3.p2.11.m2.1.1.3.2.1.cmml" xref="S3.p2.11.m2.1.1.3.2.1"></times><apply id="S3.p2.11.m2.1.1.3.2.2.cmml" xref="S3.p2.11.m2.1.1.3.2.2"><divide id="S3.p2.11.m2.1.1.3.2.2.1.cmml" xref="S3.p2.11.m2.1.1.3.2.2"></divide><apply id="S3.p2.11.m2.1.1.3.2.2.2.cmml" xref="S3.p2.11.m2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.3.2.2.2.1.cmml" xref="S3.p2.11.m2.1.1.3.2.2.2">subscript</csymbol><ci id="S3.p2.11.m2.1.1.3.2.2.2.2.cmml" xref="S3.p2.11.m2.1.1.3.2.2.2.2">𝐷</ci><ci id="S3.p2.11.m2.1.1.3.2.2.2.3.cmml" xref="S3.p2.11.m2.1.1.3.2.2.2.3">𝑟</ci></apply><apply id="S3.p2.11.m2.1.1.3.2.2.3.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3"><apply id="S3.p2.11.m2.1.1.3.2.2.3.1.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.3.2.2.3.1.1.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.1">subscript</csymbol><sum id="S3.p2.11.m2.1.1.3.2.2.3.1.2.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.1.2"></sum><apply id="S3.p2.11.m2.1.1.3.2.2.3.1.3.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3"><in id="S3.p2.11.m2.1.1.3.2.2.3.1.3.1.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3.1"></in><ci id="S3.p2.11.m2.1.1.3.2.2.3.1.3.2.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3.2">𝑛</ci><ci id="S3.p2.11.m2.1.1.3.2.2.3.1.3.3.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.1.3.3">ℛ</ci></apply></apply><apply id="S3.p2.11.m2.1.1.3.2.2.3.2.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.3.2.2.3.2.1.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.p2.11.m2.1.1.3.2.2.3.2.2.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.2.2">𝐷</ci><ci id="S3.p2.11.m2.1.1.3.2.2.3.2.3.cmml" xref="S3.p2.11.m2.1.1.3.2.2.3.2.3">𝑛</ci></apply></apply></apply><apply id="S3.p2.11.m2.1.1.3.2.3.cmml" xref="S3.p2.11.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.3.2.3.1.cmml" xref="S3.p2.11.m2.1.1.3.2.3">subscript</csymbol><ci id="S3.p2.11.m2.1.1.3.2.3.2.cmml" xref="S3.p2.11.m2.1.1.3.2.3.2">𝒘</ci><ci id="S3.p2.11.m2.1.1.3.2.3.3.cmml" xref="S3.p2.11.m2.1.1.3.2.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m2.1c">\bm{w}^{\text{av}}=\sum_{r\in\mathcal{R}}\frac{D_{r}}{\sum_{n\in\mathcal{R}}D_{n}}\bm{w}_{r}</annotation></semantics></math>.
In contrast to (<a href="#S3.E12" title="In III FL Games for Phase Optimization ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>) that designs a unique predictor across training environments, the aggregate model <math id="S3.p2.12.m3.1" class="ltx_Math" alttext="\bm{w}^{\text{av}}" display="inline"><semantics id="S3.p2.12.m3.1a"><msup id="S3.p2.12.m3.1.1" xref="S3.p2.12.m3.1.1.cmml"><mi id="S3.p2.12.m3.1.1.2" xref="S3.p2.12.m3.1.1.2.cmml">𝒘</mi><mtext id="S3.p2.12.m3.1.1.3" xref="S3.p2.12.m3.1.1.3a.cmml">av</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p2.12.m3.1b"><apply id="S3.p2.12.m3.1.1.cmml" xref="S3.p2.12.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.12.m3.1.1.1.cmml" xref="S3.p2.12.m3.1.1">superscript</csymbol><ci id="S3.p2.12.m3.1.1.2.cmml" xref="S3.p2.12.m3.1.1.2">𝒘</ci><ci id="S3.p2.12.m3.1.1.3a.cmml" xref="S3.p2.12.m3.1.1.3"><mtext mathsize="70%" id="S3.p2.12.m3.1.1.3.cmml" xref="S3.p2.12.m3.1.1.3">av</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m3.1c">\bm{w}^{\text{av}}</annotation></semantics></math> satisfies:</p>
<table id="S3.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\underset{\bm{\phi},\,\bm{w}^{\text{av}}}{\textrm{minimize}}" display="inline"><semantics id="S3.E13X.2.1.1.m1.2a"><munder accentunder="true" id="S3.E13X.2.1.1.m1.2.2" xref="S3.E13X.2.1.1.m1.2.2.cmml"><mtext id="S3.E13X.2.1.1.m1.2.2.3" xref="S3.E13X.2.1.1.m1.2.2.3a.cmml">minimize</mtext><mrow id="S3.E13X.2.1.1.m1.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E13X.2.1.1.m1.1.1.1.1" xref="S3.E13X.2.1.1.m1.1.1.1.1.cmml">ϕ</mi><mo rspace="0.337em" id="S3.E13X.2.1.1.m1.2.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.3.cmml">,</mo><msup id="S3.E13X.2.1.1.m1.2.2.2.2.1" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.2.2.1.2" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.2.cmml">𝒘</mi><mtext id="S3.E13X.2.1.1.m1.2.2.2.2.1.3" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.3a.cmml">av</mtext></msup></mrow></munder><annotation-xml encoding="MathML-Content" id="S3.E13X.2.1.1.m1.2b"><apply id="S3.E13X.2.1.1.m1.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2"><list id="S3.E13X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2"><ci id="S3.E13X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1">bold-italic-ϕ</ci><apply id="S3.E13X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.2">𝒘</ci><ci id="S3.E13X.2.1.1.m1.2.2.2.2.1.3a.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.3"><mtext mathsize="70%" id="S3.E13X.2.1.1.m1.2.2.2.2.1.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.3">av</mtext></ci></apply></list><ci id="S3.E13X.2.1.1.m1.2.2.3a.cmml" xref="S3.E13X.2.1.1.m1.2.2.3"><mtext id="S3.E13X.2.1.1.m1.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.3">minimize</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.2.1.1.m1.2c">\displaystyle\underset{\bm{\phi},\,\bm{w}^{\text{av}}}{\textrm{minimize}}</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13X.4.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\quad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}}\right)" display="inline"><semantics id="S3.E13X.4.1.1.m1.3a"><mrow id="S3.E13X.4.1.1.m1.3.3" xref="S3.E13X.4.1.1.m1.3.3.cmml"><mstyle displaystyle="true" id="S3.E13X.4.1.1.m1.1.1" xref="S3.E13X.4.1.1.m1.1.1.cmml"><mfrac id="S3.E13X.4.1.1.m1.1.1a" xref="S3.E13X.4.1.1.m1.1.1.cmml"><mn id="S3.E13X.4.1.1.m1.1.1.3" xref="S3.E13X.4.1.1.m1.1.1.3.cmml">1</mn><mrow id="S3.E13X.4.1.1.m1.1.1.1.3" xref="S3.E13X.4.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E13X.4.1.1.m1.1.1.1.3.1" xref="S3.E13X.4.1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E13X.4.1.1.m1.1.1.1.1" xref="S3.E13X.4.1.1.m1.1.1.1.1.cmml">ℛ</mi><mo stretchy="false" id="S3.E13X.4.1.1.m1.1.1.1.3.2" xref="S3.E13X.4.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13X.4.1.1.m1.3.3.2" xref="S3.E13X.4.1.1.m1.3.3.2.cmml">​</mo><mrow id="S3.E13X.4.1.1.m1.3.3.1" xref="S3.E13X.4.1.1.m1.3.3.1.cmml"><mstyle displaystyle="true" id="S3.E13X.4.1.1.m1.3.3.1.2" xref="S3.E13X.4.1.1.m1.3.3.1.2.cmml"><munderover id="S3.E13X.4.1.1.m1.3.3.1.2a" xref="S3.E13X.4.1.1.m1.3.3.1.2.cmml"><mo movablelimits="false" id="S3.E13X.4.1.1.m1.3.3.1.2.2.2" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E13X.4.1.1.m1.3.3.1.2.2.3" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3.cmml"><mi id="S3.E13X.4.1.1.m1.3.3.1.2.2.3.2" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3.2.cmml">r</mi><mo id="S3.E13X.4.1.1.m1.3.3.1.2.2.3.1" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E13X.4.1.1.m1.3.3.1.2.2.3.3" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E13X.4.1.1.m1.2.2.1.3" xref="S3.E13X.4.1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E13X.4.1.1.m1.2.2.1.3.1" xref="S3.E13X.4.1.1.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E13X.4.1.1.m1.2.2.1.1" xref="S3.E13X.4.1.1.m1.2.2.1.1.cmml">ℛ</mi><mo stretchy="false" id="S3.E13X.4.1.1.m1.2.2.1.3.2" xref="S3.E13X.4.1.1.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S3.E13X.4.1.1.m1.3.3.1.1" xref="S3.E13X.4.1.1.m1.3.3.1.1.cmml"><msub id="S3.E13X.4.1.1.m1.3.3.1.1.3" xref="S3.E13X.4.1.1.m1.3.3.1.1.3.cmml"><mi mathvariant="normal" id="S3.E13X.4.1.1.m1.3.3.1.1.3.2" xref="S3.E13X.4.1.1.m1.3.3.1.1.3.2.cmml">ℓ</mi><mi id="S3.E13X.4.1.1.m1.3.3.1.1.3.3" xref="S3.E13X.4.1.1.m1.3.3.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13X.4.1.1.m1.3.3.1.1.2" xref="S3.E13X.4.1.1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E13X.4.1.1.m1.3.3.1.1.1.1" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.2" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.2" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.2.cmml">f</mi><msup id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.cmml"><mi id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.2" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.2.cmml">𝒘</mi><mtext id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.3" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.3a.cmml">av</mtext></msup></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.1.cmml">∘</mo><msub id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.2" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.3" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.3" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13X.4.1.1.m1.3b"><apply id="S3.E13X.4.1.1.m1.3.3.cmml" xref="S3.E13X.4.1.1.m1.3.3"><times id="S3.E13X.4.1.1.m1.3.3.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.2"></times><apply id="S3.E13X.4.1.1.m1.1.1.cmml" xref="S3.E13X.4.1.1.m1.1.1"><divide id="S3.E13X.4.1.1.m1.1.1.2.cmml" xref="S3.E13X.4.1.1.m1.1.1"></divide><cn type="integer" id="S3.E13X.4.1.1.m1.1.1.3.cmml" xref="S3.E13X.4.1.1.m1.1.1.3">1</cn><apply id="S3.E13X.4.1.1.m1.1.1.1.2.cmml" xref="S3.E13X.4.1.1.m1.1.1.1.3"><abs id="S3.E13X.4.1.1.m1.1.1.1.2.1.cmml" xref="S3.E13X.4.1.1.m1.1.1.1.3.1"></abs><ci id="S3.E13X.4.1.1.m1.1.1.1.1.cmml" xref="S3.E13X.4.1.1.m1.1.1.1.1">ℛ</ci></apply></apply><apply id="S3.E13X.4.1.1.m1.3.3.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1"><apply id="S3.E13X.4.1.1.m1.3.3.1.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.E13X.4.1.1.m1.3.3.1.2.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2">superscript</csymbol><apply id="S3.E13X.4.1.1.m1.3.3.1.2.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.E13X.4.1.1.m1.3.3.1.2.2.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2">subscript</csymbol><sum id="S3.E13X.4.1.1.m1.3.3.1.2.2.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.2"></sum><apply id="S3.E13X.4.1.1.m1.3.3.1.2.2.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3"><eq id="S3.E13X.4.1.1.m1.3.3.1.2.2.3.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3.1"></eq><ci id="S3.E13X.4.1.1.m1.3.3.1.2.2.3.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3.2">𝑟</ci><cn type="integer" id="S3.E13X.4.1.1.m1.3.3.1.2.2.3.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E13X.4.1.1.m1.2.2.1.2.cmml" xref="S3.E13X.4.1.1.m1.2.2.1.3"><abs id="S3.E13X.4.1.1.m1.2.2.1.2.1.cmml" xref="S3.E13X.4.1.1.m1.2.2.1.3.1"></abs><ci id="S3.E13X.4.1.1.m1.2.2.1.1.cmml" xref="S3.E13X.4.1.1.m1.2.2.1.1">ℛ</ci></apply></apply><apply id="S3.E13X.4.1.1.m1.3.3.1.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1"><times id="S3.E13X.4.1.1.m1.3.3.1.1.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.2"></times><apply id="S3.E13X.4.1.1.m1.3.3.1.1.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E13X.4.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E13X.4.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.3.2">ℓ</ci><ci id="S3.E13X.4.1.1.m1.3.3.1.1.3.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.3.3">𝑟</ci></apply><apply id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1"><compose id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.1"></compose><apply id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.2">𝑓</ci><apply id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.2">𝒘</ci><ci id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.3a.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.3"><mtext mathsize="50%" id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.2.3.3">av</mtext></ci></apply></apply><apply id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E13X.4.1.1.m1.3.3.1.1.1.1.1.3.3">bold-italic-ϕ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.4.1.1.m1.3c">\displaystyle\quad\frac{1}{\lvert\mathcal{R}\rvert}\sum_{r=1}^{\lvert\mathcal{R}\rvert}\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
<tr id="S3.E13Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span id="S3.E13Xa.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">subject to</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13Xa.4.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\textstyle\bm{w}_{r}\in\underset{\bm{w}^{\prime}_{r}}{\arg\min}\,\;\ell_{r}\bigg{(}\frac{f_{\bm{w}^{\prime}_{r}}+\sum\limits_{n\in\mathcal{R}\backslash\{r\}}f_{\bm{w}_{n}}}{\lvert\mathcal{R}\rvert}\circ f_{\bm{\phi}}\bigg{)}" display="inline"><semantics id="S3.E13Xa.4.1.1.m1.3a"><mrow id="S3.E13Xa.4.1.1.m1.3.3" xref="S3.E13Xa.4.1.1.m1.3.3.cmml"><msub id="S3.E13Xa.4.1.1.m1.3.3.3" xref="S3.E13Xa.4.1.1.m1.3.3.3.cmml"><mi id="S3.E13Xa.4.1.1.m1.3.3.3.2" xref="S3.E13Xa.4.1.1.m1.3.3.3.2.cmml">𝒘</mi><mi id="S3.E13Xa.4.1.1.m1.3.3.3.3" xref="S3.E13Xa.4.1.1.m1.3.3.3.3.cmml">r</mi></msub><mo id="S3.E13Xa.4.1.1.m1.3.3.2" xref="S3.E13Xa.4.1.1.m1.3.3.2.cmml">∈</mo><mrow id="S3.E13Xa.4.1.1.m1.3.3.1" xref="S3.E13Xa.4.1.1.m1.3.3.1.cmml"><munder accentunder="true" id="S3.E13Xa.4.1.1.m1.3.3.1.3" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.cmml"><mrow id="S3.E13Xa.4.1.1.m1.3.3.1.3.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.2.cmml"><mi id="S3.E13Xa.4.1.1.m1.3.3.1.3.2.1" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E13Xa.4.1.1.m1.3.3.1.3.2a" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.2.cmml">⁡</mo><mi id="S3.E13Xa.4.1.1.m1.3.3.1.3.2.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.2.2.cmml">min</mi></mrow><msubsup id="S3.E13Xa.4.1.1.m1.3.3.1.3.1" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1.cmml"><mi id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.2.cmml">𝒘</mi><mi id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.3" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1.3.cmml">r</mi><mo id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.3" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.3.cmml">′</mo></msubsup></munder><mo lspace="0.167em" rspace="0em" id="S3.E13Xa.4.1.1.m1.3.3.1.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.2.cmml">​</mo><msub id="S3.E13Xa.4.1.1.m1.3.3.1.4" xref="S3.E13Xa.4.1.1.m1.3.3.1.4.cmml"><mi mathvariant="normal" id="S3.E13Xa.4.1.1.m1.3.3.1.4.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.4.2.cmml">ℓ</mi><mi id="S3.E13Xa.4.1.1.m1.3.3.1.4.3" xref="S3.E13Xa.4.1.1.m1.3.3.1.4.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13Xa.4.1.1.m1.3.3.1.2a" xref="S3.E13Xa.4.1.1.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E13Xa.4.1.1.m1.3.3.1.1.1" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.cmml"><mfrac id="S3.E13Xa.4.1.1.m1.2.2" xref="S3.E13Xa.4.1.1.m1.2.2.cmml"><mrow id="S3.E13Xa.4.1.1.m1.1.1.1" xref="S3.E13Xa.4.1.1.m1.1.1.1.cmml"><msub id="S3.E13Xa.4.1.1.m1.1.1.1.3" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.cmml"><mi id="S3.E13Xa.4.1.1.m1.1.1.1.3.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.2.cmml">f</mi><msubsup id="S3.E13Xa.4.1.1.m1.1.1.1.3.3" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3.cmml"><mi id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.2.cmml">𝒘</mi><mi id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.3" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3.3.cmml">r</mi><mo id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.3" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.3.cmml">′</mo></msubsup></msub><mo id="S3.E13Xa.4.1.1.m1.1.1.1.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E13Xa.4.1.1.m1.1.1.1.4" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.cmml"><mstyle displaystyle="false" id="S3.E13Xa.4.1.1.m1.1.1.1.4.1" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.1.cmml"><munder id="S3.E13Xa.4.1.1.m1.1.1.1.4.1a" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.1.cmml"><mo movablelimits="false" id="S3.E13Xa.4.1.1.m1.1.1.1.4.1.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.1.2.cmml">∑</mo><mrow id="S3.E13Xa.4.1.1.m1.1.1.1.1.1" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.3" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.3.cmml">n</mi><mo id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.2.cmml">∈</mo><mrow id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.2.cmml">ℛ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.1" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.1.cmml">\</mo><mrow id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.2.1" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.1.cmml">{</mo><mi id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.1" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.2.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.1.cmml">}</mo></mrow></mrow></mrow></munder></mstyle><msub id="S3.E13Xa.4.1.1.m1.1.1.1.4.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.cmml"><mi id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.2.cmml">f</mi><msub id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.cmml"><mi id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.2" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.2.cmml">𝒘</mi><mi id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.3" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.3.cmml">n</mi></msub></msub></mrow></mrow><mrow id="S3.E13Xa.4.1.1.m1.2.2.2.3" xref="S3.E13Xa.4.1.1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E13Xa.4.1.1.m1.2.2.2.3.1" xref="S3.E13Xa.4.1.1.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.4.1.1.m1.2.2.2.1" xref="S3.E13Xa.4.1.1.m1.2.2.2.1.cmml">ℛ</mi><mo stretchy="false" id="S3.E13Xa.4.1.1.m1.2.2.2.3.2" xref="S3.E13Xa.4.1.1.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.1" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.1.cmml">∘</mo><msub id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.2" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.3" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.3.cmml">ϕ</mi></msub></mrow><mo maxsize="210%" minsize="210%" id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.3" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13Xa.4.1.1.m1.3b"><apply id="S3.E13Xa.4.1.1.m1.3.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3"><in id="S3.E13Xa.4.1.1.m1.3.3.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.2"></in><apply id="S3.E13Xa.4.1.1.m1.3.3.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.3.3.3.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.3">subscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.3.3.3.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.3.2">𝒘</ci><ci id="S3.E13Xa.4.1.1.m1.3.3.3.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.3.3">𝑟</ci></apply><apply id="S3.E13Xa.4.1.1.m1.3.3.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1"><times id="S3.E13Xa.4.1.1.m1.3.3.1.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.2"></times><apply id="S3.E13Xa.4.1.1.m1.3.3.1.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3"><apply id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1">subscript</csymbol><apply id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1">superscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.2">𝒘</ci><ci id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1.2.3">′</ci></apply><ci id="S3.E13Xa.4.1.1.m1.3.3.1.3.1.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.1.3">𝑟</ci></apply><apply id="S3.E13Xa.4.1.1.m1.3.3.1.3.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.2"><arg id="S3.E13Xa.4.1.1.m1.3.3.1.3.2.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.2.1"></arg><min id="S3.E13Xa.4.1.1.m1.3.3.1.3.2.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.3.2.2"></min></apply></apply><apply id="S3.E13Xa.4.1.1.m1.3.3.1.4.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.4"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.3.3.1.4.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.4">subscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.3.3.1.4.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.4.2">ℓ</ci><ci id="S3.E13Xa.4.1.1.m1.3.3.1.4.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.4.3">𝑟</ci></apply><apply id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1"><compose id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.1"></compose><apply id="S3.E13Xa.4.1.1.m1.2.2.cmml" xref="S3.E13Xa.4.1.1.m1.2.2"><divide id="S3.E13Xa.4.1.1.m1.2.2.3.cmml" xref="S3.E13Xa.4.1.1.m1.2.2"></divide><apply id="S3.E13Xa.4.1.1.m1.1.1.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1"><plus id="S3.E13Xa.4.1.1.m1.1.1.1.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.2"></plus><apply id="S3.E13Xa.4.1.1.m1.1.1.1.3.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.1.1.1.3.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.1.1.1.3.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.2">𝑓</ci><apply id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3">subscript</csymbol><apply id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3">superscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.2">𝒘</ci><ci id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.3.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3.2.3">′</ci></apply><ci id="S3.E13Xa.4.1.1.m1.1.1.1.3.3.3.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.3.3.3">𝑟</ci></apply></apply><apply id="S3.E13Xa.4.1.1.m1.1.1.1.4.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4"><apply id="S3.E13Xa.4.1.1.m1.1.1.1.4.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.1.1.1.4.1.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.1">subscript</csymbol><sum id="S3.E13Xa.4.1.1.m1.1.1.1.4.1.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.1.2"></sum><apply id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1"><in id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.2"></in><ci id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.3">𝑛</ci><apply id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4"><ci id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.1">\</ci><ci id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.2">ℛ</ci><set id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.4.3.2"><ci id="S3.E13Xa.4.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.1.1.1">𝑟</ci></set></apply></apply></apply><apply id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2">subscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.2">𝑓</ci><apply id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.1.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3">subscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.2.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.2">𝒘</ci><ci id="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.3.cmml" xref="S3.E13Xa.4.1.1.m1.1.1.1.4.2.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S3.E13Xa.4.1.1.m1.2.2.2.2.cmml" xref="S3.E13Xa.4.1.1.m1.2.2.2.3"><abs id="S3.E13Xa.4.1.1.m1.2.2.2.2.1.cmml" xref="S3.E13Xa.4.1.1.m1.2.2.2.3.1"></abs><ci id="S3.E13Xa.4.1.1.m1.2.2.2.1.cmml" xref="S3.E13Xa.4.1.1.m1.2.2.2.1">ℛ</ci></apply></apply><apply id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.2">𝑓</ci><ci id="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E13Xa.4.1.1.m1.3.3.1.1.1.1.2.3">bold-italic-ϕ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13Xa.4.1.1.m1.3c">\displaystyle\textstyle\bm{w}_{r}\in\underset{\bm{w}^{\prime}_{r}}{\arg\min}\,\;\ell_{r}\bigg{(}\frac{f_{\bm{w}^{\prime}_{r}}+\sum\limits_{n\in\mathcal{R}\backslash\{r\}}f_{\bm{w}_{n}}}{\lvert\mathcal{R}\rvert}\circ f_{\bm{\phi}}\bigg{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E13Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13Xb.3.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\qquad\qquad\qquad\qquad\qquad\qquad\forall r\in\mathcal{R}." display="inline"><semantics id="S3.E13Xb.3.1.1.m1.1a"><mrow id="S3.E13Xb.3.1.1.m1.1.1.1" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E13Xb.3.1.1.m1.1.1.1.1" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E13Xb.3.1.1.m1.1.1.1.1.2" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="S3.E13Xb.3.1.1.m1.1.1.1.1.2.1" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.2.1.cmml">∀</mo><mi id="S3.E13Xb.3.1.1.m1.1.1.1.1.2.2" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.2.2.cmml">r</mi></mrow><mo id="S3.E13Xb.3.1.1.m1.1.1.1.1.1" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E13Xb.3.1.1.m1.1.1.1.1.3" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.3.cmml">ℛ</mi></mrow><mo lspace="0em" id="S3.E13Xb.3.1.1.m1.1.1.1.2" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13Xb.3.1.1.m1.1b"><apply id="S3.E13Xb.3.1.1.m1.1.1.1.1.cmml" xref="S3.E13Xb.3.1.1.m1.1.1.1"><in id="S3.E13Xb.3.1.1.m1.1.1.1.1.1.cmml" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.1"></in><apply id="S3.E13Xb.3.1.1.m1.1.1.1.1.2.cmml" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E13Xb.3.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.2.1">for-all</csymbol><ci id="S3.E13Xb.3.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.2.2">𝑟</ci></apply><ci id="S3.E13Xb.3.1.1.m1.1.1.1.1.3.cmml" xref="S3.E13Xb.3.1.1.m1.1.1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13Xb.3.1.1.m1.1c">\displaystyle\qquad\qquad\qquad\qquad\qquad\qquad\forall r\in\mathcal{R}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright" colspan="3"></td>
</tr>
</tbody>
</table>
<p id="S3.p2.18" class="ltx_p">The set of constraints in (<a href="#S3.E13" title="In III FL Games for Phase Optimization ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>) represents the Nash Equilibrium of a game where the players/environments <math id="S3.p2.13.m1.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="S3.p2.13.m1.1a"><mrow id="S3.p2.13.m1.1.1" xref="S3.p2.13.m1.1.1.cmml"><mi id="S3.p2.13.m1.1.1.2" xref="S3.p2.13.m1.1.1.2.cmml">r</mi><mo id="S3.p2.13.m1.1.1.1" xref="S3.p2.13.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.13.m1.1.1.3" xref="S3.p2.13.m1.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.13.m1.1b"><apply id="S3.p2.13.m1.1.1.cmml" xref="S3.p2.13.m1.1.1"><in id="S3.p2.13.m1.1.1.1.cmml" xref="S3.p2.13.m1.1.1.1"></in><ci id="S3.p2.13.m1.1.1.2.cmml" xref="S3.p2.13.m1.1.1.2">𝑟</ci><ci id="S3.p2.13.m1.1.1.3.cmml" xref="S3.p2.13.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m1.1c">r\in\mathcal{R}</annotation></semantics></math> select actions <math id="S3.p2.14.m2.1" class="ltx_Math" alttext="\bm{w}_{k}" display="inline"><semantics id="S3.p2.14.m2.1a"><msub id="S3.p2.14.m2.1.1" xref="S3.p2.14.m2.1.1.cmml"><mi id="S3.p2.14.m2.1.1.2" xref="S3.p2.14.m2.1.1.2.cmml">𝒘</mi><mi id="S3.p2.14.m2.1.1.3" xref="S3.p2.14.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.14.m2.1b"><apply id="S3.p2.14.m2.1.1.cmml" xref="S3.p2.14.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.14.m2.1.1.1.cmml" xref="S3.p2.14.m2.1.1">subscript</csymbol><ci id="S3.p2.14.m2.1.1.2.cmml" xref="S3.p2.14.m2.1.1.2">𝒘</ci><ci id="S3.p2.14.m2.1.1.3.cmml" xref="S3.p2.14.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m2.1c">\bm{w}_{k}</annotation></semantics></math> in order to minimize their cost functions <math id="S3.p2.15.m3.1" class="ltx_Math" alttext="\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}}\right)" display="inline"><semantics id="S3.p2.15.m3.1a"><mrow id="S3.p2.15.m3.1.1" xref="S3.p2.15.m3.1.1.cmml"><msub id="S3.p2.15.m3.1.1.3" xref="S3.p2.15.m3.1.1.3.cmml"><mi mathvariant="normal" id="S3.p2.15.m3.1.1.3.2" xref="S3.p2.15.m3.1.1.3.2.cmml">ℓ</mi><mi id="S3.p2.15.m3.1.1.3.3" xref="S3.p2.15.m3.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.15.m3.1.1.2" xref="S3.p2.15.m3.1.1.2.cmml">​</mo><mrow id="S3.p2.15.m3.1.1.1.1" xref="S3.p2.15.m3.1.1.1.1.1.cmml"><mo id="S3.p2.15.m3.1.1.1.1.2" xref="S3.p2.15.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.15.m3.1.1.1.1.1" xref="S3.p2.15.m3.1.1.1.1.1.cmml"><msub id="S3.p2.15.m3.1.1.1.1.1.2" xref="S3.p2.15.m3.1.1.1.1.1.2.cmml"><mi id="S3.p2.15.m3.1.1.1.1.1.2.2" xref="S3.p2.15.m3.1.1.1.1.1.2.2.cmml">f</mi><msup id="S3.p2.15.m3.1.1.1.1.1.2.3" xref="S3.p2.15.m3.1.1.1.1.1.2.3.cmml"><mi id="S3.p2.15.m3.1.1.1.1.1.2.3.2" xref="S3.p2.15.m3.1.1.1.1.1.2.3.2.cmml">𝒘</mi><mtext id="S3.p2.15.m3.1.1.1.1.1.2.3.3" xref="S3.p2.15.m3.1.1.1.1.1.2.3.3a.cmml">av</mtext></msup></msub><mo lspace="0.222em" rspace="0.222em" id="S3.p2.15.m3.1.1.1.1.1.1" xref="S3.p2.15.m3.1.1.1.1.1.1.cmml">∘</mo><msub id="S3.p2.15.m3.1.1.1.1.1.3" xref="S3.p2.15.m3.1.1.1.1.1.3.cmml"><mi id="S3.p2.15.m3.1.1.1.1.1.3.2" xref="S3.p2.15.m3.1.1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.15.m3.1.1.1.1.1.3.3" xref="S3.p2.15.m3.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S3.p2.15.m3.1.1.1.1.3" xref="S3.p2.15.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.15.m3.1b"><apply id="S3.p2.15.m3.1.1.cmml" xref="S3.p2.15.m3.1.1"><times id="S3.p2.15.m3.1.1.2.cmml" xref="S3.p2.15.m3.1.1.2"></times><apply id="S3.p2.15.m3.1.1.3.cmml" xref="S3.p2.15.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.15.m3.1.1.3.1.cmml" xref="S3.p2.15.m3.1.1.3">subscript</csymbol><ci id="S3.p2.15.m3.1.1.3.2.cmml" xref="S3.p2.15.m3.1.1.3.2">ℓ</ci><ci id="S3.p2.15.m3.1.1.3.3.cmml" xref="S3.p2.15.m3.1.1.3.3">𝑟</ci></apply><apply id="S3.p2.15.m3.1.1.1.1.1.cmml" xref="S3.p2.15.m3.1.1.1.1"><compose id="S3.p2.15.m3.1.1.1.1.1.1.cmml" xref="S3.p2.15.m3.1.1.1.1.1.1"></compose><apply id="S3.p2.15.m3.1.1.1.1.1.2.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.15.m3.1.1.1.1.1.2.1.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p2.15.m3.1.1.1.1.1.2.2.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2.2">𝑓</ci><apply id="S3.p2.15.m3.1.1.1.1.1.2.3.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p2.15.m3.1.1.1.1.1.2.3.1.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.p2.15.m3.1.1.1.1.1.2.3.2.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2.3.2">𝒘</ci><ci id="S3.p2.15.m3.1.1.1.1.1.2.3.3a.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2.3.3"><mtext mathsize="50%" id="S3.p2.15.m3.1.1.1.1.1.2.3.3.cmml" xref="S3.p2.15.m3.1.1.1.1.1.2.3.3">av</mtext></ci></apply></apply><apply id="S3.p2.15.m3.1.1.1.1.1.3.cmml" xref="S3.p2.15.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.15.m3.1.1.1.1.1.3.1.cmml" xref="S3.p2.15.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p2.15.m3.1.1.1.1.1.3.2.cmml" xref="S3.p2.15.m3.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.p2.15.m3.1.1.1.1.1.3.3.cmml" xref="S3.p2.15.m3.1.1.1.1.1.3.3">bold-italic-ϕ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m3.1c">\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}}\right)</annotation></semantics></math>. Since there are no algorithms that guarantee reaching the Nash point of the aforementioned continuous non-zero sum game, Best Response Dynamics (BRD) is used due to its simplicity. It is worth mentioning that <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> also showed that the feature extraction map can be fixed to identity <math id="S3.p2.16.m4.1" class="ltx_Math" alttext="f_{\bm{\phi}}=\mathrm{I}" display="inline"><semantics id="S3.p2.16.m4.1a"><mrow id="S3.p2.16.m4.1.1" xref="S3.p2.16.m4.1.1.cmml"><msub id="S3.p2.16.m4.1.1.2" xref="S3.p2.16.m4.1.1.2.cmml"><mi id="S3.p2.16.m4.1.1.2.2" xref="S3.p2.16.m4.1.1.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.16.m4.1.1.2.3" xref="S3.p2.16.m4.1.1.2.3.cmml">ϕ</mi></msub><mo id="S3.p2.16.m4.1.1.1" xref="S3.p2.16.m4.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S3.p2.16.m4.1.1.3" xref="S3.p2.16.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.16.m4.1b"><apply id="S3.p2.16.m4.1.1.cmml" xref="S3.p2.16.m4.1.1"><eq id="S3.p2.16.m4.1.1.1.cmml" xref="S3.p2.16.m4.1.1.1"></eq><apply id="S3.p2.16.m4.1.1.2.cmml" xref="S3.p2.16.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p2.16.m4.1.1.2.1.cmml" xref="S3.p2.16.m4.1.1.2">subscript</csymbol><ci id="S3.p2.16.m4.1.1.2.2.cmml" xref="S3.p2.16.m4.1.1.2.2">𝑓</ci><ci id="S3.p2.16.m4.1.1.2.3.cmml" xref="S3.p2.16.m4.1.1.2.3">bold-italic-ϕ</ci></apply><ci id="S3.p2.16.m4.1.1.3.cmml" xref="S3.p2.16.m4.1.1.3">I</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m4.1c">f_{\bm{\phi}}=\mathrm{I}</annotation></semantics></math>, and the overall prediction network <math id="S3.p2.17.m5.1" class="ltx_Math" alttext="f_{\bm{w}}\circ f_{\bm{\phi}}" display="inline"><semantics id="S3.p2.17.m5.1a"><mrow id="S3.p2.17.m5.1.1" xref="S3.p2.17.m5.1.1.cmml"><msub id="S3.p2.17.m5.1.1.2" xref="S3.p2.17.m5.1.1.2.cmml"><mi id="S3.p2.17.m5.1.1.2.2" xref="S3.p2.17.m5.1.1.2.2.cmml">f</mi><mi id="S3.p2.17.m5.1.1.2.3" xref="S3.p2.17.m5.1.1.2.3.cmml">𝒘</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.p2.17.m5.1.1.1" xref="S3.p2.17.m5.1.1.1.cmml">∘</mo><msub id="S3.p2.17.m5.1.1.3" xref="S3.p2.17.m5.1.1.3.cmml"><mi id="S3.p2.17.m5.1.1.3.2" xref="S3.p2.17.m5.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.17.m5.1.1.3.3" xref="S3.p2.17.m5.1.1.3.3.cmml">ϕ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.17.m5.1b"><apply id="S3.p2.17.m5.1.1.cmml" xref="S3.p2.17.m5.1.1"><compose id="S3.p2.17.m5.1.1.1.cmml" xref="S3.p2.17.m5.1.1.1"></compose><apply id="S3.p2.17.m5.1.1.2.cmml" xref="S3.p2.17.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p2.17.m5.1.1.2.1.cmml" xref="S3.p2.17.m5.1.1.2">subscript</csymbol><ci id="S3.p2.17.m5.1.1.2.2.cmml" xref="S3.p2.17.m5.1.1.2.2">𝑓</ci><ci id="S3.p2.17.m5.1.1.2.3.cmml" xref="S3.p2.17.m5.1.1.2.3">𝒘</ci></apply><apply id="S3.p2.17.m5.1.1.3.cmml" xref="S3.p2.17.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p2.17.m5.1.1.3.1.cmml" xref="S3.p2.17.m5.1.1.3">subscript</csymbol><ci id="S3.p2.17.m5.1.1.3.2.cmml" xref="S3.p2.17.m5.1.1.3.2">𝑓</ci><ci id="S3.p2.17.m5.1.1.3.3.cmml" xref="S3.p2.17.m5.1.1.3.3">bold-italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.17.m5.1c">f_{\bm{w}}\circ f_{\bm{\phi}}</annotation></semantics></math> will be recovered by the predictor <math id="S3.p2.18.m6.1" class="ltx_Math" alttext="f_{\bm{w}}" display="inline"><semantics id="S3.p2.18.m6.1a"><msub id="S3.p2.18.m6.1.1" xref="S3.p2.18.m6.1.1.cmml"><mi id="S3.p2.18.m6.1.1.2" xref="S3.p2.18.m6.1.1.2.cmml">f</mi><mi id="S3.p2.18.m6.1.1.3" xref="S3.p2.18.m6.1.1.3.cmml">𝒘</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.18.m6.1b"><apply id="S3.p2.18.m6.1.1.cmml" xref="S3.p2.18.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.18.m6.1.1.1.cmml" xref="S3.p2.18.m6.1.1">subscript</csymbol><ci id="S3.p2.18.m6.1.1.2.cmml" xref="S3.p2.18.m6.1.1.2">𝑓</ci><ci id="S3.p2.18.m6.1.1.3.cmml" xref="S3.p2.18.m6.1.1.3">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.18.m6.1c">f_{\bm{w}}</annotation></semantics></math> solving (<a href="#S3.E13" title="In III FL Games for Phase Optimization ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>). This version of the algorithm is called <span id="S3.p2.18.1" class="ltx_text ltx_font_smallcaps">F-IRM Games</span>, while the one where the extractor and predictor are learned separately is referred to as <span id="S3.p2.18.2" class="ltx_text ltx_font_smallcaps">V-IRM Games</span>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.2" class="ltx_p"><span id="S3.p3.2.1" class="ltx_text ltx_font_smallcaps">IRM Games</span> is a very suitable fit for FL since it allows agents distributed in different environments to train a collective IRM-based model.
Hence, the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> proposed minor modifications in order to adapt it to the FL setup.
First, parallelized BRD is used to mitigate the sequential dependencies and accelerate convergence.
Moreover, <span id="S3.p3.2.2" class="ltx_text ltx_font_smallcaps">V-IRM Games</span> requires an extra round of optimization for the extraction function parameter <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\bm{\phi}" display="inline"><semantics id="S3.p3.1.m1.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\bm{\phi}</annotation></semantics></math>, which delays its convergence.
Thus, the stochastic gradient descent (SGD) over <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\bm{\phi}" display="inline"><semantics id="S3.p3.2.m2.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\bm{\phi}</annotation></semantics></math> is replaced by a Gradient Descent (GD) update that takes larger steps in the direction of the global optimum.
In contrast to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, which considered highly correlated datasets, the data in our setting shows negligible oscillations in parameter updates under BRD, in which, we do not adopt buffers in training. These buffers can be used by each agent to store the historically played actions of its opponents. Then, an agent responds to a uniform distribution over these past actions. This smoothens the oscillations of BRD caused by the local correlations in the datasets. Finally, the detailed steps of the <span id="S3.p3.2.3" class="ltx_text ltx_font_smallcaps">V-FL Games</span> algorithm that trains both a representation learner and a predictor are presented in Algorithm <a href="#alg1" title="Algorithm 1 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S4" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Simulation Results</span>
</h2>

<section id="S4.SS1" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Simulation Settings</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.13" class="ltx_p">For our experiments, we consider three different environments <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathcal{R}</annotation></semantics></math>.
In all three environments, the Tx is located at the coordinate <math id="S4.SS1.p1.2.m2.3" class="ltx_Math" alttext="(0,35,3)" display="inline"><semantics id="S4.SS1.p1.2.m2.3a"><mrow id="S4.SS1.p1.2.m2.3.4.2" xref="S4.SS1.p1.2.m2.3.4.1.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.3.4.2.1" xref="S4.SS1.p1.2.m2.3.4.1.cmml">(</mo><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">0</mn><mo id="S4.SS1.p1.2.m2.3.4.2.2" xref="S4.SS1.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml">35</mn><mo id="S4.SS1.p1.2.m2.3.4.2.3" xref="S4.SS1.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.3.3" xref="S4.SS1.p1.2.m2.3.3.cmml">3</mn><mo stretchy="false" id="S4.SS1.p1.2.m2.3.4.2.4" xref="S4.SS1.p1.2.m2.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.3b"><vector id="S4.SS1.p1.2.m2.3.4.1.cmml" xref="S4.SS1.p1.2.m2.3.4.2"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">0</cn><cn type="integer" id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2">35</cn><cn type="integer" id="S4.SS1.p1.2.m2.3.3.cmml" xref="S4.SS1.p1.2.m2.3.3">3</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.3c">(0,35,3)</annotation></semantics></math> and the RIS comprising <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="N=10\times 10" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">N</mi><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><mn id="S4.SS1.p1.3.m3.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.3.2.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.3.m3.1.1.3.1" xref="S4.SS1.p1.3.m3.1.1.3.1.cmml">×</mo><mn id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml">10</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><eq id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></eq><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝑁</ci><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><times id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.1"></times><cn type="integer" id="S4.SS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2">10</cn><cn type="integer" id="S4.SS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">N=10\times 10</annotation></semantics></math> reflective elements is at <math id="S4.SS1.p1.4.m4.3" class="ltx_Math" alttext="(10,20,1)" display="inline"><semantics id="S4.SS1.p1.4.m4.3a"><mrow id="S4.SS1.p1.4.m4.3.4.2" xref="S4.SS1.p1.4.m4.3.4.1.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.3.4.2.1" xref="S4.SS1.p1.4.m4.3.4.1.cmml">(</mo><mn id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">10</mn><mo id="S4.SS1.p1.4.m4.3.4.2.2" xref="S4.SS1.p1.4.m4.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml">20</mn><mo id="S4.SS1.p1.4.m4.3.4.2.3" xref="S4.SS1.p1.4.m4.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.4.m4.3.3" xref="S4.SS1.p1.4.m4.3.3.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.4.m4.3.4.2.4" xref="S4.SS1.p1.4.m4.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.3b"><vector id="S4.SS1.p1.4.m4.3.4.1.cmml" xref="S4.SS1.p1.4.m4.3.4.2"><cn type="integer" id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">10</cn><cn type="integer" id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2">20</cn><cn type="integer" id="S4.SS1.p1.4.m4.3.3.cmml" xref="S4.SS1.p1.4.m4.3.3">1</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.3c">(10,20,1)</annotation></semantics></math>, with the coordinates given in meters within a Cartesian system.
The Rx is located in an annular region around the RIS with inner and outer radii <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="R_{\text{min}}=1\," display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><msub id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">R</mi><mtext id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3a.cmml">min</mtext></msub><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><eq id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></eq><apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">𝑅</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3a.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3">min</mtext></ci></apply><cn type="integer" id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">R_{\text{min}}=1\,</annotation></semantics></math>m and <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="R_{\text{max}}=5\," display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><msub id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2.2" xref="S4.SS1.p1.6.m6.1.1.2.2.cmml">R</mi><mtext id="S4.SS1.p1.6.m6.1.1.2.3" xref="S4.SS1.p1.6.m6.1.1.2.3a.cmml">max</mtext></msub><mo id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><eq id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1"></eq><apply id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2.2">𝑅</ci><ci id="S4.SS1.p1.6.m6.1.1.2.3a.cmml" xref="S4.SS1.p1.6.m6.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.p1.6.m6.1.1.2.3">max</mtext></ci></apply><cn type="integer" id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">R_{\text{max}}=5\,</annotation></semantics></math>m.
The Rician factor <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\kappa" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\kappa</annotation></semantics></math> is set to <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mn id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><cn type="integer" id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">5</annotation></semantics></math>, and the pathloss coefficients are calculated by <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="\alpha_{t}=\frac{Nd_{\mathrm{x}}d_{\mathrm{y}}}{4\pi d_{t}^{2}}" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><mrow id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><msub id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml"><mi id="S4.SS1.p1.9.m9.1.1.2.2" xref="S4.SS1.p1.9.m9.1.1.2.2.cmml">α</mi><mi id="S4.SS1.p1.9.m9.1.1.2.3" xref="S4.SS1.p1.9.m9.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS1.p1.9.m9.1.1.1" xref="S4.SS1.p1.9.m9.1.1.1.cmml">=</mo><mfrac id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml"><mrow id="S4.SS1.p1.9.m9.1.1.3.2" xref="S4.SS1.p1.9.m9.1.1.3.2.cmml"><mi id="S4.SS1.p1.9.m9.1.1.3.2.2" xref="S4.SS1.p1.9.m9.1.1.3.2.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.9.m9.1.1.3.2.1" xref="S4.SS1.p1.9.m9.1.1.3.2.1.cmml">​</mo><msub id="S4.SS1.p1.9.m9.1.1.3.2.3" xref="S4.SS1.p1.9.m9.1.1.3.2.3.cmml"><mi id="S4.SS1.p1.9.m9.1.1.3.2.3.2" xref="S4.SS1.p1.9.m9.1.1.3.2.3.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p1.9.m9.1.1.3.2.3.3" xref="S4.SS1.p1.9.m9.1.1.3.2.3.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.9.m9.1.1.3.2.1a" xref="S4.SS1.p1.9.m9.1.1.3.2.1.cmml">​</mo><msub id="S4.SS1.p1.9.m9.1.1.3.2.4" xref="S4.SS1.p1.9.m9.1.1.3.2.4.cmml"><mi id="S4.SS1.p1.9.m9.1.1.3.2.4.2" xref="S4.SS1.p1.9.m9.1.1.3.2.4.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p1.9.m9.1.1.3.2.4.3" xref="S4.SS1.p1.9.m9.1.1.3.2.4.3.cmml">y</mi></msub></mrow><mrow id="S4.SS1.p1.9.m9.1.1.3.3" xref="S4.SS1.p1.9.m9.1.1.3.3.cmml"><mn id="S4.SS1.p1.9.m9.1.1.3.3.2" xref="S4.SS1.p1.9.m9.1.1.3.3.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p1.9.m9.1.1.3.3.1" xref="S4.SS1.p1.9.m9.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.p1.9.m9.1.1.3.3.3" xref="S4.SS1.p1.9.m9.1.1.3.3.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.9.m9.1.1.3.3.1a" xref="S4.SS1.p1.9.m9.1.1.3.3.1.cmml">​</mo><msubsup id="S4.SS1.p1.9.m9.1.1.3.3.4" xref="S4.SS1.p1.9.m9.1.1.3.3.4.cmml"><mi id="S4.SS1.p1.9.m9.1.1.3.3.4.2.2" xref="S4.SS1.p1.9.m9.1.1.3.3.4.2.2.cmml">d</mi><mi id="S4.SS1.p1.9.m9.1.1.3.3.4.2.3" xref="S4.SS1.p1.9.m9.1.1.3.3.4.2.3.cmml">t</mi><mn id="S4.SS1.p1.9.m9.1.1.3.3.4.3" xref="S4.SS1.p1.9.m9.1.1.3.3.4.3.cmml">2</mn></msubsup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1"><eq id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1.1"></eq><apply id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.2.1.cmml" xref="S4.SS1.p1.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.2.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2.2">𝛼</ci><ci id="S4.SS1.p1.9.m9.1.1.2.3.cmml" xref="S4.SS1.p1.9.m9.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3"><divide id="S4.SS1.p1.9.m9.1.1.3.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3"></divide><apply id="S4.SS1.p1.9.m9.1.1.3.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2"><times id="S4.SS1.p1.9.m9.1.1.3.2.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.1"></times><ci id="S4.SS1.p1.9.m9.1.1.3.2.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.2">𝑁</ci><apply id="S4.SS1.p1.9.m9.1.1.3.2.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.3.2.3.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.3">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.3.2.3.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.3.2">𝑑</ci><ci id="S4.SS1.p1.9.m9.1.1.3.2.3.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.3.3">x</ci></apply><apply id="S4.SS1.p1.9.m9.1.1.3.2.4.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.3.2.4.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.4">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.3.2.4.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.4.2">𝑑</ci><ci id="S4.SS1.p1.9.m9.1.1.3.2.4.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2.4.3">y</ci></apply></apply><apply id="S4.SS1.p1.9.m9.1.1.3.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3"><times id="S4.SS1.p1.9.m9.1.1.3.3.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.p1.9.m9.1.1.3.3.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.2">4</cn><ci id="S4.SS1.p1.9.m9.1.1.3.3.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.3">𝜋</ci><apply id="S4.SS1.p1.9.m9.1.1.3.3.4.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.3.3.4.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.4">superscript</csymbol><apply id="S4.SS1.p1.9.m9.1.1.3.3.4.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.3.3.4.2.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.4">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.3.3.4.2.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.4.2.2">𝑑</ci><ci id="S4.SS1.p1.9.m9.1.1.3.3.4.2.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.4.2.3">𝑡</ci></apply><cn type="integer" id="S4.SS1.p1.9.m9.1.1.3.3.4.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">\alpha_{t}=\frac{Nd_{\mathrm{x}}d_{\mathrm{y}}}{4\pi d_{t}^{2}}</annotation></semantics></math> and <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="\alpha_{r}=\frac{Nd_{\mathrm{x}}d_{\mathrm{y}}}{4\pi d_{r}^{2}}" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mrow id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml"><msub id="S4.SS1.p1.10.m10.1.1.2" xref="S4.SS1.p1.10.m10.1.1.2.cmml"><mi id="S4.SS1.p1.10.m10.1.1.2.2" xref="S4.SS1.p1.10.m10.1.1.2.2.cmml">α</mi><mi id="S4.SS1.p1.10.m10.1.1.2.3" xref="S4.SS1.p1.10.m10.1.1.2.3.cmml">r</mi></msub><mo id="S4.SS1.p1.10.m10.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.cmml">=</mo><mfrac id="S4.SS1.p1.10.m10.1.1.3" xref="S4.SS1.p1.10.m10.1.1.3.cmml"><mrow id="S4.SS1.p1.10.m10.1.1.3.2" xref="S4.SS1.p1.10.m10.1.1.3.2.cmml"><mi id="S4.SS1.p1.10.m10.1.1.3.2.2" xref="S4.SS1.p1.10.m10.1.1.3.2.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.10.m10.1.1.3.2.1" xref="S4.SS1.p1.10.m10.1.1.3.2.1.cmml">​</mo><msub id="S4.SS1.p1.10.m10.1.1.3.2.3" xref="S4.SS1.p1.10.m10.1.1.3.2.3.cmml"><mi id="S4.SS1.p1.10.m10.1.1.3.2.3.2" xref="S4.SS1.p1.10.m10.1.1.3.2.3.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p1.10.m10.1.1.3.2.3.3" xref="S4.SS1.p1.10.m10.1.1.3.2.3.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.10.m10.1.1.3.2.1a" xref="S4.SS1.p1.10.m10.1.1.3.2.1.cmml">​</mo><msub id="S4.SS1.p1.10.m10.1.1.3.2.4" xref="S4.SS1.p1.10.m10.1.1.3.2.4.cmml"><mi id="S4.SS1.p1.10.m10.1.1.3.2.4.2" xref="S4.SS1.p1.10.m10.1.1.3.2.4.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p1.10.m10.1.1.3.2.4.3" xref="S4.SS1.p1.10.m10.1.1.3.2.4.3.cmml">y</mi></msub></mrow><mrow id="S4.SS1.p1.10.m10.1.1.3.3" xref="S4.SS1.p1.10.m10.1.1.3.3.cmml"><mn id="S4.SS1.p1.10.m10.1.1.3.3.2" xref="S4.SS1.p1.10.m10.1.1.3.3.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p1.10.m10.1.1.3.3.1" xref="S4.SS1.p1.10.m10.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.p1.10.m10.1.1.3.3.3" xref="S4.SS1.p1.10.m10.1.1.3.3.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.10.m10.1.1.3.3.1a" xref="S4.SS1.p1.10.m10.1.1.3.3.1.cmml">​</mo><msubsup id="S4.SS1.p1.10.m10.1.1.3.3.4" xref="S4.SS1.p1.10.m10.1.1.3.3.4.cmml"><mi id="S4.SS1.p1.10.m10.1.1.3.3.4.2.2" xref="S4.SS1.p1.10.m10.1.1.3.3.4.2.2.cmml">d</mi><mi id="S4.SS1.p1.10.m10.1.1.3.3.4.2.3" xref="S4.SS1.p1.10.m10.1.1.3.3.4.2.3.cmml">r</mi><mn id="S4.SS1.p1.10.m10.1.1.3.3.4.3" xref="S4.SS1.p1.10.m10.1.1.3.3.4.3.cmml">2</mn></msubsup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1"><eq id="S4.SS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1"></eq><apply id="S4.SS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.2.1.cmml" xref="S4.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.2.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2.2">𝛼</ci><ci id="S4.SS1.p1.10.m10.1.1.2.3.cmml" xref="S4.SS1.p1.10.m10.1.1.2.3">𝑟</ci></apply><apply id="S4.SS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3"><divide id="S4.SS1.p1.10.m10.1.1.3.1.cmml" xref="S4.SS1.p1.10.m10.1.1.3"></divide><apply id="S4.SS1.p1.10.m10.1.1.3.2.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2"><times id="S4.SS1.p1.10.m10.1.1.3.2.1.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.1"></times><ci id="S4.SS1.p1.10.m10.1.1.3.2.2.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.2">𝑁</ci><apply id="S4.SS1.p1.10.m10.1.1.3.2.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.3.2.3.1.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.3">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.3.2.3.2.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.3.2">𝑑</ci><ci id="S4.SS1.p1.10.m10.1.1.3.2.3.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.3.3">x</ci></apply><apply id="S4.SS1.p1.10.m10.1.1.3.2.4.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.3.2.4.1.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.4">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.3.2.4.2.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.4.2">𝑑</ci><ci id="S4.SS1.p1.10.m10.1.1.3.2.4.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3.2.4.3">y</ci></apply></apply><apply id="S4.SS1.p1.10.m10.1.1.3.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3"><times id="S4.SS1.p1.10.m10.1.1.3.3.1.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.p1.10.m10.1.1.3.3.2.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.2">4</cn><ci id="S4.SS1.p1.10.m10.1.1.3.3.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.3">𝜋</ci><apply id="S4.SS1.p1.10.m10.1.1.3.3.4.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.3.3.4.1.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.4">superscript</csymbol><apply id="S4.SS1.p1.10.m10.1.1.3.3.4.2.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.3.3.4.2.1.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.4">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.3.3.4.2.2.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.4.2.2">𝑑</ci><ci id="S4.SS1.p1.10.m10.1.1.3.3.4.2.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.4.2.3">𝑟</ci></apply><cn type="integer" id="S4.SS1.p1.10.m10.1.1.3.3.4.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3.3.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">\alpha_{r}=\frac{Nd_{\mathrm{x}}d_{\mathrm{y}}}{4\pi d_{r}^{2}}</annotation></semantics></math>. To simplify the exhaustive search for optimal phases, we assume <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><ci id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">\mathcal{C}</annotation></semantics></math> contains two configurations classes, namely <math id="S4.SS1.p1.12.m12.4" class="ltx_Math" alttext="\bm{\theta}_{1}=\left[0,0,\dots,0\right]^{\mathsf{T}}" display="inline"><semantics id="S4.SS1.p1.12.m12.4a"><mrow id="S4.SS1.p1.12.m12.4.5" xref="S4.SS1.p1.12.m12.4.5.cmml"><msub id="S4.SS1.p1.12.m12.4.5.2" xref="S4.SS1.p1.12.m12.4.5.2.cmml"><mi id="S4.SS1.p1.12.m12.4.5.2.2" xref="S4.SS1.p1.12.m12.4.5.2.2.cmml">𝜽</mi><mn id="S4.SS1.p1.12.m12.4.5.2.3" xref="S4.SS1.p1.12.m12.4.5.2.3.cmml">1</mn></msub><mo id="S4.SS1.p1.12.m12.4.5.1" xref="S4.SS1.p1.12.m12.4.5.1.cmml">=</mo><msup id="S4.SS1.p1.12.m12.4.5.3" xref="S4.SS1.p1.12.m12.4.5.3.cmml"><mrow id="S4.SS1.p1.12.m12.4.5.3.2.2" xref="S4.SS1.p1.12.m12.4.5.3.2.1.cmml"><mo id="S4.SS1.p1.12.m12.4.5.3.2.2.1" xref="S4.SS1.p1.12.m12.4.5.3.2.1.cmml">[</mo><mn id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">0</mn><mo id="S4.SS1.p1.12.m12.4.5.3.2.2.2" xref="S4.SS1.p1.12.m12.4.5.3.2.1.cmml">,</mo><mn id="S4.SS1.p1.12.m12.2.2" xref="S4.SS1.p1.12.m12.2.2.cmml">0</mn><mo id="S4.SS1.p1.12.m12.4.5.3.2.2.3" xref="S4.SS1.p1.12.m12.4.5.3.2.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.12.m12.3.3" xref="S4.SS1.p1.12.m12.3.3.cmml">…</mi><mo id="S4.SS1.p1.12.m12.4.5.3.2.2.4" xref="S4.SS1.p1.12.m12.4.5.3.2.1.cmml">,</mo><mn id="S4.SS1.p1.12.m12.4.4" xref="S4.SS1.p1.12.m12.4.4.cmml">0</mn><mo id="S4.SS1.p1.12.m12.4.5.3.2.2.5" xref="S4.SS1.p1.12.m12.4.5.3.2.1.cmml">]</mo></mrow><mi id="S4.SS1.p1.12.m12.4.5.3.3" xref="S4.SS1.p1.12.m12.4.5.3.3.cmml">𝖳</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.4b"><apply id="S4.SS1.p1.12.m12.4.5.cmml" xref="S4.SS1.p1.12.m12.4.5"><eq id="S4.SS1.p1.12.m12.4.5.1.cmml" xref="S4.SS1.p1.12.m12.4.5.1"></eq><apply id="S4.SS1.p1.12.m12.4.5.2.cmml" xref="S4.SS1.p1.12.m12.4.5.2"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.4.5.2.1.cmml" xref="S4.SS1.p1.12.m12.4.5.2">subscript</csymbol><ci id="S4.SS1.p1.12.m12.4.5.2.2.cmml" xref="S4.SS1.p1.12.m12.4.5.2.2">𝜽</ci><cn type="integer" id="S4.SS1.p1.12.m12.4.5.2.3.cmml" xref="S4.SS1.p1.12.m12.4.5.2.3">1</cn></apply><apply id="S4.SS1.p1.12.m12.4.5.3.cmml" xref="S4.SS1.p1.12.m12.4.5.3"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.4.5.3.1.cmml" xref="S4.SS1.p1.12.m12.4.5.3">superscript</csymbol><list id="S4.SS1.p1.12.m12.4.5.3.2.1.cmml" xref="S4.SS1.p1.12.m12.4.5.3.2.2"><cn type="integer" id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">0</cn><cn type="integer" id="S4.SS1.p1.12.m12.2.2.cmml" xref="S4.SS1.p1.12.m12.2.2">0</cn><ci id="S4.SS1.p1.12.m12.3.3.cmml" xref="S4.SS1.p1.12.m12.3.3">…</ci><cn type="integer" id="S4.SS1.p1.12.m12.4.4.cmml" xref="S4.SS1.p1.12.m12.4.4">0</cn></list><ci id="S4.SS1.p1.12.m12.4.5.3.3.cmml" xref="S4.SS1.p1.12.m12.4.5.3.3">𝖳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.4c">\bm{\theta}_{1}=\left[0,0,\dots,0\right]^{\mathsf{T}}</annotation></semantics></math> and <math id="S4.SS1.p1.13.m13.7" class="ltx_Math" alttext="\bm{\theta}_{2}=\left[0,\pi,0,\pi,\dots,0,\pi\right]^{\mathsf{T}}" display="inline"><semantics id="S4.SS1.p1.13.m13.7a"><mrow id="S4.SS1.p1.13.m13.7.8" xref="S4.SS1.p1.13.m13.7.8.cmml"><msub id="S4.SS1.p1.13.m13.7.8.2" xref="S4.SS1.p1.13.m13.7.8.2.cmml"><mi id="S4.SS1.p1.13.m13.7.8.2.2" xref="S4.SS1.p1.13.m13.7.8.2.2.cmml">𝜽</mi><mn id="S4.SS1.p1.13.m13.7.8.2.3" xref="S4.SS1.p1.13.m13.7.8.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.13.m13.7.8.1" xref="S4.SS1.p1.13.m13.7.8.1.cmml">=</mo><msup id="S4.SS1.p1.13.m13.7.8.3" xref="S4.SS1.p1.13.m13.7.8.3.cmml"><mrow id="S4.SS1.p1.13.m13.7.8.3.2.2" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml"><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.1" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">[</mo><mn id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">0</mn><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.2" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">,</mo><mi id="S4.SS1.p1.13.m13.2.2" xref="S4.SS1.p1.13.m13.2.2.cmml">π</mi><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.3" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">,</mo><mn id="S4.SS1.p1.13.m13.3.3" xref="S4.SS1.p1.13.m13.3.3.cmml">0</mn><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.4" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">,</mo><mi id="S4.SS1.p1.13.m13.4.4" xref="S4.SS1.p1.13.m13.4.4.cmml">π</mi><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.5" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.13.m13.5.5" xref="S4.SS1.p1.13.m13.5.5.cmml">…</mi><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.6" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">,</mo><mn id="S4.SS1.p1.13.m13.6.6" xref="S4.SS1.p1.13.m13.6.6.cmml">0</mn><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.7" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">,</mo><mi id="S4.SS1.p1.13.m13.7.7" xref="S4.SS1.p1.13.m13.7.7.cmml">π</mi><mo id="S4.SS1.p1.13.m13.7.8.3.2.2.8" xref="S4.SS1.p1.13.m13.7.8.3.2.1.cmml">]</mo></mrow><mi id="S4.SS1.p1.13.m13.7.8.3.3" xref="S4.SS1.p1.13.m13.7.8.3.3.cmml">𝖳</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.7b"><apply id="S4.SS1.p1.13.m13.7.8.cmml" xref="S4.SS1.p1.13.m13.7.8"><eq id="S4.SS1.p1.13.m13.7.8.1.cmml" xref="S4.SS1.p1.13.m13.7.8.1"></eq><apply id="S4.SS1.p1.13.m13.7.8.2.cmml" xref="S4.SS1.p1.13.m13.7.8.2"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.7.8.2.1.cmml" xref="S4.SS1.p1.13.m13.7.8.2">subscript</csymbol><ci id="S4.SS1.p1.13.m13.7.8.2.2.cmml" xref="S4.SS1.p1.13.m13.7.8.2.2">𝜽</ci><cn type="integer" id="S4.SS1.p1.13.m13.7.8.2.3.cmml" xref="S4.SS1.p1.13.m13.7.8.2.3">2</cn></apply><apply id="S4.SS1.p1.13.m13.7.8.3.cmml" xref="S4.SS1.p1.13.m13.7.8.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.7.8.3.1.cmml" xref="S4.SS1.p1.13.m13.7.8.3">superscript</csymbol><list id="S4.SS1.p1.13.m13.7.8.3.2.1.cmml" xref="S4.SS1.p1.13.m13.7.8.3.2.2"><cn type="integer" id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">0</cn><ci id="S4.SS1.p1.13.m13.2.2.cmml" xref="S4.SS1.p1.13.m13.2.2">𝜋</ci><cn type="integer" id="S4.SS1.p1.13.m13.3.3.cmml" xref="S4.SS1.p1.13.m13.3.3">0</cn><ci id="S4.SS1.p1.13.m13.4.4.cmml" xref="S4.SS1.p1.13.m13.4.4">𝜋</ci><ci id="S4.SS1.p1.13.m13.5.5.cmml" xref="S4.SS1.p1.13.m13.5.5">…</ci><cn type="integer" id="S4.SS1.p1.13.m13.6.6.cmml" xref="S4.SS1.p1.13.m13.6.6">0</cn><ci id="S4.SS1.p1.13.m13.7.7.cmml" xref="S4.SS1.p1.13.m13.7.7">𝜋</ci></list><ci id="S4.SS1.p1.13.m13.7.8.3.3.cmml" xref="S4.SS1.p1.13.m13.7.8.3.3">𝖳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.7c">\bm{\theta}_{2}=\left[0,\pi,0,\pi,\dots,0,\pi\right]^{\mathsf{T}}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.3" class="ltx_p">In environment 1, the RIS elements are distanced by <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="d_{\mathrm{x}}=d_{\mathrm{y}}=0.5\lambda" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><msub id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2.2" xref="S4.SS1.p2.1.m1.1.1.2.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p2.1.m1.1.1.2.3" xref="S4.SS1.p2.1.m1.1.1.2.3.cmml">x</mi></msub><mo id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">=</mo><msub id="S4.SS1.p2.1.m1.1.1.4" xref="S4.SS1.p2.1.m1.1.1.4.cmml"><mi id="S4.SS1.p2.1.m1.1.1.4.2" xref="S4.SS1.p2.1.m1.1.1.4.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p2.1.m1.1.1.4.3" xref="S4.SS1.p2.1.m1.1.1.4.3.cmml">y</mi></msub><mo id="S4.SS1.p2.1.m1.1.1.5" xref="S4.SS1.p2.1.m1.1.1.5.cmml">=</mo><mrow id="S4.SS1.p2.1.m1.1.1.6" xref="S4.SS1.p2.1.m1.1.1.6.cmml"><mn id="S4.SS1.p2.1.m1.1.1.6.2" xref="S4.SS1.p2.1.m1.1.1.6.2.cmml">0.5</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.1.6.1" xref="S4.SS1.p2.1.m1.1.1.6.1.cmml">​</mo><mi id="S4.SS1.p2.1.m1.1.1.6.3" xref="S4.SS1.p2.1.m1.1.1.6.3.cmml">λ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><and id="S4.SS1.p2.1.m1.1.1a.cmml" xref="S4.SS1.p2.1.m1.1.1"></and><apply id="S4.SS1.p2.1.m1.1.1b.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"></eq><apply id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2.2">𝑑</ci><ci id="S4.SS1.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3">x</ci></apply><apply id="S4.SS1.p2.1.m1.1.1.4.cmml" xref="S4.SS1.p2.1.m1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.4.1.cmml" xref="S4.SS1.p2.1.m1.1.1.4">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.4.2.cmml" xref="S4.SS1.p2.1.m1.1.1.4.2">𝑑</ci><ci id="S4.SS1.p2.1.m1.1.1.4.3.cmml" xref="S4.SS1.p2.1.m1.1.1.4.3">y</ci></apply></apply><apply id="S4.SS1.p2.1.m1.1.1c.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.5.cmml" xref="S4.SS1.p2.1.m1.1.1.5"></eq><share href="#S4.SS1.p2.1.m1.1.1.4.cmml" id="S4.SS1.p2.1.m1.1.1d.cmml" xref="S4.SS1.p2.1.m1.1.1"></share><apply id="S4.SS1.p2.1.m1.1.1.6.cmml" xref="S4.SS1.p2.1.m1.1.1.6"><times id="S4.SS1.p2.1.m1.1.1.6.1.cmml" xref="S4.SS1.p2.1.m1.1.1.6.1"></times><cn type="float" id="S4.SS1.p2.1.m1.1.1.6.2.cmml" xref="S4.SS1.p2.1.m1.1.1.6.2">0.5</cn><ci id="S4.SS1.p2.1.m1.1.1.6.3.cmml" xref="S4.SS1.p2.1.m1.1.1.6.3">𝜆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">d_{\mathrm{x}}=d_{\mathrm{y}}=0.5\lambda</annotation></semantics></math>.
Therein, the Rx is uniformly placed around the RIS with a tendency to be deployed closer to the RIS following the distributions illustrated under Environment 1 in Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
In environment 2, the RIS is characterized by <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="d_{\mathrm{x}}=d_{\mathrm{y}}=0.25\lambda" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><msub id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2.2" xref="S4.SS1.p2.2.m2.1.1.2.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p2.2.m2.1.1.2.3" xref="S4.SS1.p2.2.m2.1.1.2.3.cmml">x</mi></msub><mo id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">=</mo><msub id="S4.SS1.p2.2.m2.1.1.4" xref="S4.SS1.p2.2.m2.1.1.4.cmml"><mi id="S4.SS1.p2.2.m2.1.1.4.2" xref="S4.SS1.p2.2.m2.1.1.4.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p2.2.m2.1.1.4.3" xref="S4.SS1.p2.2.m2.1.1.4.3.cmml">y</mi></msub><mo id="S4.SS1.p2.2.m2.1.1.5" xref="S4.SS1.p2.2.m2.1.1.5.cmml">=</mo><mrow id="S4.SS1.p2.2.m2.1.1.6" xref="S4.SS1.p2.2.m2.1.1.6.cmml"><mn id="S4.SS1.p2.2.m2.1.1.6.2" xref="S4.SS1.p2.2.m2.1.1.6.2.cmml">0.25</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p2.2.m2.1.1.6.1" xref="S4.SS1.p2.2.m2.1.1.6.1.cmml">​</mo><mi id="S4.SS1.p2.2.m2.1.1.6.3" xref="S4.SS1.p2.2.m2.1.1.6.3.cmml">λ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><and id="S4.SS1.p2.2.m2.1.1a.cmml" xref="S4.SS1.p2.2.m2.1.1"></and><apply id="S4.SS1.p2.2.m2.1.1b.cmml" xref="S4.SS1.p2.2.m2.1.1"><eq id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3"></eq><apply id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2.2">𝑑</ci><ci id="S4.SS1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.1.1.2.3">x</ci></apply><apply id="S4.SS1.p2.2.m2.1.1.4.cmml" xref="S4.SS1.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.4.1.cmml" xref="S4.SS1.p2.2.m2.1.1.4">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.4.2.cmml" xref="S4.SS1.p2.2.m2.1.1.4.2">𝑑</ci><ci id="S4.SS1.p2.2.m2.1.1.4.3.cmml" xref="S4.SS1.p2.2.m2.1.1.4.3">y</ci></apply></apply><apply id="S4.SS1.p2.2.m2.1.1c.cmml" xref="S4.SS1.p2.2.m2.1.1"><eq id="S4.SS1.p2.2.m2.1.1.5.cmml" xref="S4.SS1.p2.2.m2.1.1.5"></eq><share href="#S4.SS1.p2.2.m2.1.1.4.cmml" id="S4.SS1.p2.2.m2.1.1d.cmml" xref="S4.SS1.p2.2.m2.1.1"></share><apply id="S4.SS1.p2.2.m2.1.1.6.cmml" xref="S4.SS1.p2.2.m2.1.1.6"><times id="S4.SS1.p2.2.m2.1.1.6.1.cmml" xref="S4.SS1.p2.2.m2.1.1.6.1"></times><cn type="float" id="S4.SS1.p2.2.m2.1.1.6.2.cmml" xref="S4.SS1.p2.2.m2.1.1.6.2">0.25</cn><ci id="S4.SS1.p2.2.m2.1.1.6.3.cmml" xref="S4.SS1.p2.2.m2.1.1.6.3">𝜆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">d_{\mathrm{x}}=d_{\mathrm{y}}=0.25\lambda</annotation></semantics></math>.
In contrast to environment 1, here, the Rx is higher likely to be placed far from the RIS (see the distributions under Environment 2 in Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
The RIS in environment 3 has <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="d_{\mathrm{x}}=d_{\mathrm{y}}=0.4\lambda" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><msub id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2.2" xref="S4.SS1.p2.3.m3.1.1.2.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p2.3.m3.1.1.2.3" xref="S4.SS1.p2.3.m3.1.1.2.3.cmml">x</mi></msub><mo id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">=</mo><msub id="S4.SS1.p2.3.m3.1.1.4" xref="S4.SS1.p2.3.m3.1.1.4.cmml"><mi id="S4.SS1.p2.3.m3.1.1.4.2" xref="S4.SS1.p2.3.m3.1.1.4.2.cmml">d</mi><mi mathvariant="normal" id="S4.SS1.p2.3.m3.1.1.4.3" xref="S4.SS1.p2.3.m3.1.1.4.3.cmml">y</mi></msub><mo id="S4.SS1.p2.3.m3.1.1.5" xref="S4.SS1.p2.3.m3.1.1.5.cmml">=</mo><mrow id="S4.SS1.p2.3.m3.1.1.6" xref="S4.SS1.p2.3.m3.1.1.6.cmml"><mn id="S4.SS1.p2.3.m3.1.1.6.2" xref="S4.SS1.p2.3.m3.1.1.6.2.cmml">0.4</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p2.3.m3.1.1.6.1" xref="S4.SS1.p2.3.m3.1.1.6.1.cmml">​</mo><mi id="S4.SS1.p2.3.m3.1.1.6.3" xref="S4.SS1.p2.3.m3.1.1.6.3.cmml">λ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><and id="S4.SS1.p2.3.m3.1.1a.cmml" xref="S4.SS1.p2.3.m3.1.1"></and><apply id="S4.SS1.p2.3.m3.1.1b.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"></eq><apply id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2.2">𝑑</ci><ci id="S4.SS1.p2.3.m3.1.1.2.3.cmml" xref="S4.SS1.p2.3.m3.1.1.2.3">x</ci></apply><apply id="S4.SS1.p2.3.m3.1.1.4.cmml" xref="S4.SS1.p2.3.m3.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.4.1.cmml" xref="S4.SS1.p2.3.m3.1.1.4">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.4.2.cmml" xref="S4.SS1.p2.3.m3.1.1.4.2">𝑑</ci><ci id="S4.SS1.p2.3.m3.1.1.4.3.cmml" xref="S4.SS1.p2.3.m3.1.1.4.3">y</ci></apply></apply><apply id="S4.SS1.p2.3.m3.1.1c.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.5.cmml" xref="S4.SS1.p2.3.m3.1.1.5"></eq><share href="#S4.SS1.p2.3.m3.1.1.4.cmml" id="S4.SS1.p2.3.m3.1.1d.cmml" xref="S4.SS1.p2.3.m3.1.1"></share><apply id="S4.SS1.p2.3.m3.1.1.6.cmml" xref="S4.SS1.p2.3.m3.1.1.6"><times id="S4.SS1.p2.3.m3.1.1.6.1.cmml" xref="S4.SS1.p2.3.m3.1.1.6.1"></times><cn type="float" id="S4.SS1.p2.3.m3.1.1.6.2.cmml" xref="S4.SS1.p2.3.m3.1.1.6.2">0.4</cn><ci id="S4.SS1.p2.3.m3.1.1.6.3.cmml" xref="S4.SS1.p2.3.m3.1.1.6.3">𝜆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">d_{\mathrm{x}}=d_{\mathrm{y}}=0.4\lambda</annotation></semantics></math>.
Therein, the Rx’s distance to the RIS is uniform but the angle distribution is concentrated in one direction as illustrated in Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> under Environment 3.
Note that the data from environments 1 and 2 are used to compose the training data while environment 3 is used only for testing.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.4.2" class="ltx_text ltx_font_smallcaps">FL Games</span> for RIS</figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">Set of RISs: <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="alg1.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{R}</annotation></semantics></math>, Datasets: <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\mathcal{D}_{r}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝒟</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{D}_{r}</annotation></semantics></math>, Learning rates: <math id="alg1.l1.m3.2" class="ltx_Math" alttext="\eta_{\bm{w}},\eta_{\bm{\phi}}" display="inline"><semantics id="alg1.l1.m3.2a"><mrow id="alg1.l1.m3.2.2.2" xref="alg1.l1.m3.2.2.3.cmml"><msub id="alg1.l1.m3.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.cmml"><mi id="alg1.l1.m3.1.1.1.1.2" xref="alg1.l1.m3.1.1.1.1.2.cmml">η</mi><mi id="alg1.l1.m3.1.1.1.1.3" xref="alg1.l1.m3.1.1.1.1.3.cmml">𝒘</mi></msub><mo id="alg1.l1.m3.2.2.2.3" xref="alg1.l1.m3.2.2.3.cmml">,</mo><msub id="alg1.l1.m3.2.2.2.2" xref="alg1.l1.m3.2.2.2.2.cmml"><mi id="alg1.l1.m3.2.2.2.2.2" xref="alg1.l1.m3.2.2.2.2.2.cmml">η</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l1.m3.2.2.2.2.3" xref="alg1.l1.m3.2.2.2.2.3.cmml">ϕ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.2b"><list id="alg1.l1.m3.2.2.3.cmml" xref="alg1.l1.m3.2.2.2"><apply id="alg1.l1.m3.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.2">𝜂</ci><ci id="alg1.l1.m3.1.1.1.1.3.cmml" xref="alg1.l1.m3.1.1.1.1.3">𝒘</ci></apply><apply id="alg1.l1.m3.2.2.2.2.cmml" xref="alg1.l1.m3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m3.2.2.2.2.1.cmml" xref="alg1.l1.m3.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m3.2.2.2.2.2.cmml" xref="alg1.l1.m3.2.2.2.2.2">𝜂</ci><ci id="alg1.l1.m3.2.2.2.2.3.cmml" xref="alg1.l1.m3.2.2.2.2.3">bold-italic-ϕ</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.2c">\eta_{\bm{w}},\eta_{\bm{\phi}}</annotation></semantics></math>, Number of rounds: <math id="alg1.l1.m4.1" class="ltx_Math" alttext="\mathrm{rounds}" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">rounds</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">rounds</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\mathrm{rounds}</annotation></semantics></math>, Mini-batch size: <math id="alg1.l1.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">m</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<math id="alg1.l2.m1.2" class="ltx_Math" alttext="f_{\bm{\phi}},f_{\bm{w}^{\text{av}}}" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.3.cmml"><msub id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l2.m1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="alg1.l2.m1.2.2.2.3" xref="alg1.l2.m1.2.2.3.cmml">,</mo><msub id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.cmml"><mi id="alg1.l2.m1.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.cmml">f</mi><msup id="alg1.l2.m1.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.3.cmml"><mi id="alg1.l2.m1.2.2.2.2.3.2" xref="alg1.l2.m1.2.2.2.2.3.2.cmml">𝒘</mi><mtext id="alg1.l2.m1.2.2.2.2.3.3" xref="alg1.l2.m1.2.2.2.2.3.3a.cmml">av</mtext></msup></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><list id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.2"><apply id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.2">𝑓</ci><ci id="alg1.l2.m1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.3">bold-italic-ϕ</ci></apply><apply id="alg1.l2.m1.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l2.m1.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2">𝑓</ci><apply id="alg1.l2.m1.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.3.1.cmml" xref="alg1.l2.m1.2.2.2.2.3">superscript</csymbol><ci id="alg1.l2.m1.2.2.2.2.3.2.cmml" xref="alg1.l2.m1.2.2.2.2.3.2">𝒘</ci><ci id="alg1.l2.m1.2.2.2.2.3.3a.cmml" xref="alg1.l2.m1.2.2.2.2.3.3"><mtext mathsize="50%" id="alg1.l2.m1.2.2.2.2.3.3.cmml" xref="alg1.l2.m1.2.2.2.2.3.3">av</mtext></ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">f_{\bm{\phi}},f_{\bm{w}^{\text{av}}}</annotation></semantics></math>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span id="alg1.l3.1" class="ltx_text ltx_font_bold">Server executes:</span>

</div>
<div id="alg1.l4" class="ltx_listingline">     Initialize <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\bm{\phi}" display="inline"><semantics id="alg1.l4.m1.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\bm{\phi}</annotation></semantics></math> and <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\{\bm{w}_{r}\}_{r\in\mathcal{R}}" display="inline"><semantics id="alg1.l4.m2.1a"><msub id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mrow id="alg1.l4.m2.1.1.1.1" xref="alg1.l4.m2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l4.m2.1.1.1.1.2" xref="alg1.l4.m2.1.1.1.2.cmml">{</mo><msub id="alg1.l4.m2.1.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.1.cmml"><mi id="alg1.l4.m2.1.1.1.1.1.2" xref="alg1.l4.m2.1.1.1.1.1.2.cmml">𝒘</mi><mi id="alg1.l4.m2.1.1.1.1.1.3" xref="alg1.l4.m2.1.1.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="alg1.l4.m2.1.1.1.1.3" xref="alg1.l4.m2.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml"><mi id="alg1.l4.m2.1.1.3.2" xref="alg1.l4.m2.1.1.3.2.cmml">r</mi><mo id="alg1.l4.m2.1.1.3.1" xref="alg1.l4.m2.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m2.1.1.3.3" xref="alg1.l4.m2.1.1.3.3.cmml">ℛ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><set id="alg1.l4.m2.1.1.1.2.cmml" xref="alg1.l4.m2.1.1.1.1"><apply id="alg1.l4.m2.1.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m2.1.1.1.1.1.2.cmml" xref="alg1.l4.m2.1.1.1.1.1.2">𝒘</ci><ci id="alg1.l4.m2.1.1.1.1.1.3.cmml" xref="alg1.l4.m2.1.1.1.1.1.3">𝑟</ci></apply></set><apply id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3"><in id="alg1.l4.m2.1.1.3.1.cmml" xref="alg1.l4.m2.1.1.3.1"></in><ci id="alg1.l4.m2.1.1.3.2.cmml" xref="alg1.l4.m2.1.1.3.2">𝑟</ci><ci id="alg1.l4.m2.1.1.3.3.cmml" xref="alg1.l4.m2.1.1.3.3">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\{\bm{w}_{r}\}_{r\in\mathcal{R}}</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">     Broadcast <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\bm{\phi}" display="inline"><semantics id="alg1.l5.m1.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\bm{\phi}</annotation></semantics></math> and <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\{\bm{w}_{r}\}_{r\in\mathcal{R}}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mrow id="alg1.l5.m2.1.1.1.1" xref="alg1.l5.m2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m2.1.1.1.1.2" xref="alg1.l5.m2.1.1.1.2.cmml">{</mo><msub id="alg1.l5.m2.1.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.1.cmml"><mi id="alg1.l5.m2.1.1.1.1.1.2" xref="alg1.l5.m2.1.1.1.1.1.2.cmml">𝒘</mi><mi id="alg1.l5.m2.1.1.1.1.1.3" xref="alg1.l5.m2.1.1.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="alg1.l5.m2.1.1.1.1.3" xref="alg1.l5.m2.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml"><mi id="alg1.l5.m2.1.1.3.2" xref="alg1.l5.m2.1.1.3.2.cmml">r</mi><mo id="alg1.l5.m2.1.1.3.1" xref="alg1.l5.m2.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m2.1.1.3.3" xref="alg1.l5.m2.1.1.3.3.cmml">ℛ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><set id="alg1.l5.m2.1.1.1.2.cmml" xref="alg1.l5.m2.1.1.1.1"><apply id="alg1.l5.m2.1.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.1.1.1.2.cmml" xref="alg1.l5.m2.1.1.1.1.1.2">𝒘</ci><ci id="alg1.l5.m2.1.1.1.1.1.3.cmml" xref="alg1.l5.m2.1.1.1.1.1.3">𝑟</ci></apply></set><apply id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"><in id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3.1"></in><ci id="alg1.l5.m2.1.1.3.2.cmml" xref="alg1.l5.m2.1.1.3.2">𝑟</ci><ci id="alg1.l5.m2.1.1.3.3.cmml" xref="alg1.l5.m2.1.1.3.3">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\{\bm{w}_{r}\}_{r\in\mathcal{R}}</annotation></semantics></math> to all agents <math id="alg1.l5.m3.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="alg1.l5.m3.1a"><mrow id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">r</mi><mo id="alg1.l5.m3.1.1.1" xref="alg1.l5.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><in id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1.1"></in><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑟</ci><ci id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">r\in\mathcal{R}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">     Set <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathrm{round}\leftarrow 1" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">round</mi><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">round</ci><cn type="integer" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathrm{round}\leftarrow 1</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">     <span id="alg1.l7.1" class="ltx_text ltx_font_bold">while</span> <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\mathrm{round}\leq\mathrm{rounds}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">round</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">≤</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">rounds</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><leq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></leq><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">round</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">rounds</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathrm{round}\leq\mathrm{rounds}</annotation></semantics></math> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">         <span id="alg1.l8.1" class="ltx_text ltx_font_bold">for</span> each agent <math id="alg1.l8.m1.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">r</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><in id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></in><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑟</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">r\in\mathcal{R}</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">parallel</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l9" class="ltx_listingline">              Compute <math id="alg1.l9.m1.2" class="ltx_Math" alttext="\nabla\bm{\phi}_{r}\leftarrow\nabla_{\bm{\phi}}\,\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}};\mathcal{D}_{r}\right)" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><mrow id="alg1.l9.m1.2.2.4" xref="alg1.l9.m1.2.2.4.cmml"><mo rspace="0.167em" id="alg1.l9.m1.2.2.4.1" xref="alg1.l9.m1.2.2.4.1.cmml">∇</mo><msub id="alg1.l9.m1.2.2.4.2" xref="alg1.l9.m1.2.2.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l9.m1.2.2.4.2.2" xref="alg1.l9.m1.2.2.4.2.2.cmml">ϕ</mi><mi id="alg1.l9.m1.2.2.4.2.3" xref="alg1.l9.m1.2.2.4.2.3.cmml">r</mi></msub></mrow><mo stretchy="false" id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml">←</mo><mrow id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.2.cmml"><mrow id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.2.4.cmml"><msub id="alg1.l9.m1.2.2.2.4.1" xref="alg1.l9.m1.2.2.2.4.1.cmml"><mo rspace="0.167em" id="alg1.l9.m1.2.2.2.4.1.2" xref="alg1.l9.m1.2.2.2.4.1.2.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l9.m1.2.2.2.4.1.3" xref="alg1.l9.m1.2.2.2.4.1.3.cmml">ϕ</mi></msub><msub id="alg1.l9.m1.2.2.2.4.2" xref="alg1.l9.m1.2.2.2.4.2.cmml"><mi mathvariant="normal" id="alg1.l9.m1.2.2.2.4.2.2" xref="alg1.l9.m1.2.2.2.4.2.2.cmml">ℓ</mi><mi id="alg1.l9.m1.2.2.2.4.2.3" xref="alg1.l9.m1.2.2.2.4.2.3.cmml">r</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.2.3" xref="alg1.l9.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.3.cmml"><mo id="alg1.l9.m1.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.cmml">f</mi><msup id="alg1.l9.m1.1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2.3.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.2.cmml">𝒘</mi><mtext id="alg1.l9.m1.1.1.1.1.1.1.2.3.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.3a.cmml">av</mtext></msup></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l9.m1.1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="alg1.l9.m1.2.2.2.2.2.4" xref="alg1.l9.m1.2.2.2.2.3.cmml">;</mo><msub id="alg1.l9.m1.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml">𝒟</mi><mi id="alg1.l9.m1.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.3.cmml">r</mi></msub><mo id="alg1.l9.m1.2.2.2.2.2.5" xref="alg1.l9.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><ci id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3">←</ci><apply id="alg1.l9.m1.2.2.4.cmml" xref="alg1.l9.m1.2.2.4"><ci id="alg1.l9.m1.2.2.4.1.cmml" xref="alg1.l9.m1.2.2.4.1">∇</ci><apply id="alg1.l9.m1.2.2.4.2.cmml" xref="alg1.l9.m1.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.4.2.1.cmml" xref="alg1.l9.m1.2.2.4.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.4.2.2.cmml" xref="alg1.l9.m1.2.2.4.2.2">bold-italic-ϕ</ci><ci id="alg1.l9.m1.2.2.4.2.3.cmml" xref="alg1.l9.m1.2.2.4.2.3">𝑟</ci></apply></apply><apply id="alg1.l9.m1.2.2.2.cmml" xref="alg1.l9.m1.2.2.2"><times id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.3"></times><apply id="alg1.l9.m1.2.2.2.4.cmml" xref="alg1.l9.m1.2.2.2.4"><apply id="alg1.l9.m1.2.2.2.4.1.cmml" xref="alg1.l9.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.4.1.1.cmml" xref="alg1.l9.m1.2.2.2.4.1">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.4.1.2.cmml" xref="alg1.l9.m1.2.2.2.4.1.2">∇</ci><ci id="alg1.l9.m1.2.2.2.4.1.3.cmml" xref="alg1.l9.m1.2.2.2.4.1.3">bold-italic-ϕ</ci></apply><apply id="alg1.l9.m1.2.2.2.4.2.cmml" xref="alg1.l9.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.4.2.1.cmml" xref="alg1.l9.m1.2.2.2.4.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.4.2.2.cmml" xref="alg1.l9.m1.2.2.2.4.2.2">ℓ</ci><ci id="alg1.l9.m1.2.2.2.4.2.3.cmml" xref="alg1.l9.m1.2.2.2.4.2.3">𝑟</ci></apply></apply><list id="alg1.l9.m1.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"><compose id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"></compose><apply id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="alg1.l9.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.2">𝒘</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.2.3.3a.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.3"><mtext mathsize="50%" id="alg1.l9.m1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.3">av</mtext></ci></apply></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3">bold-italic-ϕ</ci></apply></apply><apply id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">𝒟</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3">𝑟</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">\nabla\bm{\phi}_{r}\leftarrow\nabla_{\bm{\phi}}\,\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}};\mathcal{D}_{r}\right)</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">              Communicate <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\nabla\bm{\phi}_{r}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mo rspace="0.167em" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">∇</mo><msub id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">ϕ</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">∇</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">bold-italic-ϕ</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\nabla\bm{\phi}_{r}</annotation></semantics></math> to the server

</div>
<div id="alg1.l11" class="ltx_listingline">         <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">         Update extractor:

</div>
<div id="alg1.l13" class="ltx_listingline">             <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\bm{\phi}\leftarrow\bm{\phi}-\eta_{\bm{\phi}}\sum_{r\in\mathcal{R}}\frac{D_{r}}{\sum_{n\in\mathcal{R}}D_{n}}\nabla\bm{\phi}_{k}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">ϕ</mi><mo stretchy="false" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">←</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">ϕ</mi><mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml"><msub id="alg1.l13.m1.1.1.3.3.2" xref="alg1.l13.m1.1.1.3.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.3.2.2" xref="alg1.l13.m1.1.1.3.3.2.2.cmml">η</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l13.m1.1.1.3.3.2.3" xref="alg1.l13.m1.1.1.3.3.2.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.3.1" xref="alg1.l13.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l13.m1.1.1.3.3.3" xref="alg1.l13.m1.1.1.3.3.3.cmml"><msub id="alg1.l13.m1.1.1.3.3.3.1" xref="alg1.l13.m1.1.1.3.3.3.1.cmml"><mo id="alg1.l13.m1.1.1.3.3.3.1.2" xref="alg1.l13.m1.1.1.3.3.3.1.2.cmml">∑</mo><mrow id="alg1.l13.m1.1.1.3.3.3.1.3" xref="alg1.l13.m1.1.1.3.3.3.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.3.3.1.3.2" xref="alg1.l13.m1.1.1.3.3.3.1.3.2.cmml">r</mi><mo id="alg1.l13.m1.1.1.3.3.3.1.3.1" xref="alg1.l13.m1.1.1.3.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.3.3.3.1.3.3" xref="alg1.l13.m1.1.1.3.3.3.1.3.3.cmml">ℛ</mi></mrow></msub><mrow id="alg1.l13.m1.1.1.3.3.3.2" xref="alg1.l13.m1.1.1.3.3.3.2.cmml"><mfrac id="alg1.l13.m1.1.1.3.3.3.2.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.cmml"><msub id="alg1.l13.m1.1.1.3.3.3.2.2.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.2.cmml"><mi id="alg1.l13.m1.1.1.3.3.3.2.2.2.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.2.2.cmml">D</mi><mi id="alg1.l13.m1.1.1.3.3.3.2.2.2.3" xref="alg1.l13.m1.1.1.3.3.3.2.2.2.3.cmml">r</mi></msub><mrow id="alg1.l13.m1.1.1.3.3.3.2.2.3" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.cmml"><mstyle displaystyle="false" id="alg1.l13.m1.1.1.3.3.3.2.2.3.1" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.cmml"><msub id="alg1.l13.m1.1.1.3.3.3.2.2.3.1a" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.cmml"><mo id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.2.cmml">∑</mo><mrow id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.2.cmml">n</mi><mo id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.1" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.3" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.3.cmml">ℛ</mi></mrow></msub></mstyle><msub id="alg1.l13.m1.1.1.3.3.3.2.2.3.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.3.3.2.2.3.2.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.2.2.cmml">D</mi><mi id="alg1.l13.m1.1.1.3.3.3.2.2.3.2.3" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.2.3.cmml">n</mi></msub></mrow></mfrac><mo lspace="0.167em" rspace="0em" id="alg1.l13.m1.1.1.3.3.3.2.1" xref="alg1.l13.m1.1.1.3.3.3.2.1.cmml">​</mo><mrow id="alg1.l13.m1.1.1.3.3.3.2.3" xref="alg1.l13.m1.1.1.3.3.3.2.3.cmml"><mo rspace="0.167em" id="alg1.l13.m1.1.1.3.3.3.2.3.1" xref="alg1.l13.m1.1.1.3.3.3.2.3.1.cmml">∇</mo><msub id="alg1.l13.m1.1.1.3.3.3.2.3.2" xref="alg1.l13.m1.1.1.3.3.3.2.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l13.m1.1.1.3.3.3.2.3.2.2" xref="alg1.l13.m1.1.1.3.3.3.2.3.2.2.cmml">ϕ</mi><mi id="alg1.l13.m1.1.1.3.3.3.2.3.2.3" xref="alg1.l13.m1.1.1.3.3.3.2.3.2.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">←</ci><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">bold-italic-ϕ</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><minus id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></minus><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">bold-italic-ϕ</ci><apply id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3"><times id="alg1.l13.m1.1.1.3.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.1"></times><apply id="alg1.l13.m1.1.1.3.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.3.2.2">𝜂</ci><ci id="alg1.l13.m1.1.1.3.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.3.2.3">bold-italic-ϕ</ci></apply><apply id="alg1.l13.m1.1.1.3.3.3.cmml" xref="alg1.l13.m1.1.1.3.3.3"><apply id="alg1.l13.m1.1.1.3.3.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.3.1.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.1">subscript</csymbol><sum id="alg1.l13.m1.1.1.3.3.3.1.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.1.2"></sum><apply id="alg1.l13.m1.1.1.3.3.3.1.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.1.3"><in id="alg1.l13.m1.1.1.3.3.3.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.1.3.1"></in><ci id="alg1.l13.m1.1.1.3.3.3.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.1.3.2">𝑟</ci><ci id="alg1.l13.m1.1.1.3.3.3.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.1.3.3">ℛ</ci></apply></apply><apply id="alg1.l13.m1.1.1.3.3.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2"><times id="alg1.l13.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.1"></times><apply id="alg1.l13.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2"><divide id="alg1.l13.m1.1.1.3.3.3.2.2.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2"></divide><apply id="alg1.l13.m1.1.1.3.3.3.2.2.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.3.2.2.2.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.3.3.2.2.2.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.2.2">𝐷</ci><ci id="alg1.l13.m1.1.1.3.3.3.2.2.2.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.2.3">𝑟</ci></apply><apply id="alg1.l13.m1.1.1.3.3.3.2.2.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3"><apply id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1">subscript</csymbol><sum id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.2"></sum><apply id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3"><in id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.1"></in><ci id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.2">𝑛</ci><ci id="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.1.3.3">ℛ</ci></apply></apply><apply id="alg1.l13.m1.1.1.3.3.3.2.2.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.3.2.2.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.3.3.2.2.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.2.2">𝐷</ci><ci id="alg1.l13.m1.1.1.3.3.3.2.2.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2.3.2.3">𝑛</ci></apply></apply></apply><apply id="alg1.l13.m1.1.1.3.3.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.3"><ci id="alg1.l13.m1.1.1.3.3.3.2.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.3.1">∇</ci><apply id="alg1.l13.m1.1.1.3.3.3.2.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.3.2.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.3.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.3.3.2.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.3.2.2">bold-italic-ϕ</ci><ci id="alg1.l13.m1.1.1.3.3.3.2.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\bm{\phi}\leftarrow\bm{\phi}-\eta_{\bm{\phi}}\sum_{r\in\mathcal{R}}\frac{D_{r}}{\sum_{n\in\mathcal{R}}D_{n}}\nabla\bm{\phi}_{k}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">         Broadcast <math id="alg1.l14.m1.1" class="ltx_Math" alttext="\bm{\phi}" display="inline"><semantics id="alg1.l14.m1.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\bm{\phi}</annotation></semantics></math> to all agents <math id="alg1.l14.m2.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="alg1.l14.m2.1a"><mrow id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mi id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">r</mi><mo id="alg1.l14.m2.1.1.1" xref="alg1.l14.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><in id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1.1"></in><ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">𝑟</ci><ci id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">r\in\mathcal{R}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">         <span id="alg1.l15.1" class="ltx_text ltx_font_bold">for</span> each agent <math id="alg1.l15.m1.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">r</mi><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><in id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></in><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑟</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">r\in\mathcal{R}</annotation></semantics></math> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">parallel</span> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l16" class="ltx_listingline">              Sample mini-batch <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\mathcal{B}_{r}" display="inline"><semantics id="alg1.l16.m1.1a"><msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">ℬ</mi><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">ℬ</ci><ci id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\mathcal{B}_{r}</annotation></semantics></math> of size <math id="alg1.l16.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l16.m2.1a"><mi id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">m</annotation></semantics></math> from <math id="alg1.l16.m3.1" class="ltx_Math" alttext="\mathcal{D}_{r}" display="inline"><semantics id="alg1.l16.m3.1a"><msub id="alg1.l16.m3.1.1" xref="alg1.l16.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m3.1.1.2" xref="alg1.l16.m3.1.1.2.cmml">𝒟</mi><mi id="alg1.l16.m3.1.1.3" xref="alg1.l16.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m3.1b"><apply id="alg1.l16.m3.1.1.cmml" xref="alg1.l16.m3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m3.1.1.1.cmml" xref="alg1.l16.m3.1.1">subscript</csymbol><ci id="alg1.l16.m3.1.1.2.cmml" xref="alg1.l16.m3.1.1.2">𝒟</ci><ci id="alg1.l16.m3.1.1.3.cmml" xref="alg1.l16.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m3.1c">\mathcal{D}_{r}</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">              Update predictor:

</div>
<div id="alg1.l18" class="ltx_listingline">                  <math id="alg1.l18.m1.2" class="ltx_Math" alttext="\bm{w}_{r}\leftarrow\bm{w}_{r}-\eta_{\bm{w}}\nabla_{\bm{w}_{r}}\,\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}};\mathcal{B}_{r}\right)" display="inline"><semantics id="alg1.l18.m1.2a"><mrow id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml"><msub id="alg1.l18.m1.2.2.4" xref="alg1.l18.m1.2.2.4.cmml"><mi id="alg1.l18.m1.2.2.4.2" xref="alg1.l18.m1.2.2.4.2.cmml">𝒘</mi><mi id="alg1.l18.m1.2.2.4.3" xref="alg1.l18.m1.2.2.4.3.cmml">r</mi></msub><mo stretchy="false" id="alg1.l18.m1.2.2.3" xref="alg1.l18.m1.2.2.3.cmml">←</mo><mrow id="alg1.l18.m1.2.2.2" xref="alg1.l18.m1.2.2.2.cmml"><msub id="alg1.l18.m1.2.2.2.4" xref="alg1.l18.m1.2.2.2.4.cmml"><mi id="alg1.l18.m1.2.2.2.4.2" xref="alg1.l18.m1.2.2.2.4.2.cmml">𝒘</mi><mi id="alg1.l18.m1.2.2.2.4.3" xref="alg1.l18.m1.2.2.2.4.3.cmml">r</mi></msub><mo id="alg1.l18.m1.2.2.2.3" xref="alg1.l18.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l18.m1.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.cmml"><msub id="alg1.l18.m1.2.2.2.2.4" xref="alg1.l18.m1.2.2.2.2.4.cmml"><mi id="alg1.l18.m1.2.2.2.2.4.2" xref="alg1.l18.m1.2.2.2.2.4.2.cmml">η</mi><mi id="alg1.l18.m1.2.2.2.2.4.3" xref="alg1.l18.m1.2.2.2.2.4.3.cmml">𝒘</mi></msub><mo lspace="0.167em" rspace="0em" id="alg1.l18.m1.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l18.m1.2.2.2.2.5" xref="alg1.l18.m1.2.2.2.2.5.cmml"><msub id="alg1.l18.m1.2.2.2.2.5.1" xref="alg1.l18.m1.2.2.2.2.5.1.cmml"><mo rspace="0.167em" id="alg1.l18.m1.2.2.2.2.5.1.2" xref="alg1.l18.m1.2.2.2.2.5.1.2.cmml">∇</mo><msub id="alg1.l18.m1.2.2.2.2.5.1.3" xref="alg1.l18.m1.2.2.2.2.5.1.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.5.1.3.2" xref="alg1.l18.m1.2.2.2.2.5.1.3.2.cmml">𝒘</mi><mi id="alg1.l18.m1.2.2.2.2.5.1.3.3" xref="alg1.l18.m1.2.2.2.2.5.1.3.3.cmml">r</mi></msub></msub><msub id="alg1.l18.m1.2.2.2.2.5.2" xref="alg1.l18.m1.2.2.2.2.5.2.cmml"><mi mathvariant="normal" id="alg1.l18.m1.2.2.2.2.5.2.2" xref="alg1.l18.m1.2.2.2.2.5.2.2.cmml">ℓ</mi><mi id="alg1.l18.m1.2.2.2.2.5.2.3" xref="alg1.l18.m1.2.2.2.2.5.2.3.cmml">r</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l18.m1.2.2.2.2.3a" xref="alg1.l18.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l18.m1.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.3.cmml"><mo id="alg1.l18.m1.2.2.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.cmml">f</mi><msup id="alg1.l18.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3.2.cmml">𝒘</mi><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3.3a.cmml">av</mtext></msup></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l18.m1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.cmml">∘</mo><msub id="alg1.l18.m1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l18.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="alg1.l18.m1.2.2.2.2.2.2.4" xref="alg1.l18.m1.2.2.2.2.2.3.cmml">;</mo><msub id="alg1.l18.m1.2.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l18.m1.2.2.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.2.2.cmml">ℬ</mi><mi id="alg1.l18.m1.2.2.2.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.2.2.2.3.cmml">r</mi></msub><mo id="alg1.l18.m1.2.2.2.2.2.2.5" xref="alg1.l18.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b"><apply id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2"><ci id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.3">←</ci><apply id="alg1.l18.m1.2.2.4.cmml" xref="alg1.l18.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.4.1.cmml" xref="alg1.l18.m1.2.2.4">subscript</csymbol><ci id="alg1.l18.m1.2.2.4.2.cmml" xref="alg1.l18.m1.2.2.4.2">𝒘</ci><ci id="alg1.l18.m1.2.2.4.3.cmml" xref="alg1.l18.m1.2.2.4.3">𝑟</ci></apply><apply id="alg1.l18.m1.2.2.2.cmml" xref="alg1.l18.m1.2.2.2"><minus id="alg1.l18.m1.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.3"></minus><apply id="alg1.l18.m1.2.2.2.4.cmml" xref="alg1.l18.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.4.1.cmml" xref="alg1.l18.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.4.2.cmml" xref="alg1.l18.m1.2.2.2.4.2">𝒘</ci><ci id="alg1.l18.m1.2.2.2.4.3.cmml" xref="alg1.l18.m1.2.2.2.4.3">𝑟</ci></apply><apply id="alg1.l18.m1.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2"><times id="alg1.l18.m1.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.3"></times><apply id="alg1.l18.m1.2.2.2.2.4.cmml" xref="alg1.l18.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.4.1.cmml" xref="alg1.l18.m1.2.2.2.2.4">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.4.2.cmml" xref="alg1.l18.m1.2.2.2.2.4.2">𝜂</ci><ci id="alg1.l18.m1.2.2.2.2.4.3.cmml" xref="alg1.l18.m1.2.2.2.2.4.3">𝒘</ci></apply><apply id="alg1.l18.m1.2.2.2.2.5.cmml" xref="alg1.l18.m1.2.2.2.2.5"><apply id="alg1.l18.m1.2.2.2.2.5.1.cmml" xref="alg1.l18.m1.2.2.2.2.5.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.5.1.1.cmml" xref="alg1.l18.m1.2.2.2.2.5.1">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.5.1.2.cmml" xref="alg1.l18.m1.2.2.2.2.5.1.2">∇</ci><apply id="alg1.l18.m1.2.2.2.2.5.1.3.cmml" xref="alg1.l18.m1.2.2.2.2.5.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.5.1.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.5.1.3">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.5.1.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.5.1.3.2">𝒘</ci><ci id="alg1.l18.m1.2.2.2.2.5.1.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.5.1.3.3">𝑟</ci></apply></apply><apply id="alg1.l18.m1.2.2.2.2.5.2.cmml" xref="alg1.l18.m1.2.2.2.2.5.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.5.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.5.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.5.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.5.2.2">ℓ</ci><ci id="alg1.l18.m1.2.2.2.2.5.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.5.2.3">𝑟</ci></apply></apply><list id="alg1.l18.m1.2.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.2"><apply id="alg1.l18.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1"><compose id="alg1.l18.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1"></compose><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3.2">𝒘</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.3a.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3.3"><mtext mathsize="50%" id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3.3">av</mtext></ci></apply></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.3.3">bold-italic-ϕ</ci></apply></apply><apply id="alg1.l18.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.2.2">ℬ</ci><ci id="alg1.l18.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.2.3">𝑟</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.2c">\bm{w}_{r}\leftarrow\bm{w}_{r}-\eta_{\bm{w}}\nabla_{\bm{w}_{r}}\,\ell_{r}\left(f_{\bm{w}^{\text{av}}}\circ f_{\bm{\phi}};\mathcal{B}_{r}\right)</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">              Communicate <math id="alg1.l19.m1.1" class="ltx_Math" alttext="\bm{w}_{r}" display="inline"><semantics id="alg1.l19.m1.1a"><msub id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">𝒘</mi><mi id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝒘</ci><ci id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\bm{w}_{r}</annotation></semantics></math> to the server

</div>
<div id="alg1.l20" class="ltx_listingline">         <span id="alg1.l20.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l20.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l21" class="ltx_listingline">         Average Predictor: <math id="alg1.l21.m1.1" class="ltx_Math" alttext="\bm{w}^{\text{av}}\leftarrow\sum_{r\in\mathcal{R}}\frac{D_{r}}{\sum_{n\in\mathcal{R}}D_{n}}\bm{w}_{k}" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><msup id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml"><mi id="alg1.l21.m1.1.1.2.2" xref="alg1.l21.m1.1.1.2.2.cmml">𝒘</mi><mtext id="alg1.l21.m1.1.1.2.3" xref="alg1.l21.m1.1.1.2.3a.cmml">av</mtext></msup><mo rspace="0.111em" stretchy="false" id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">←</mo><mrow id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><msub id="alg1.l21.m1.1.1.3.1" xref="alg1.l21.m1.1.1.3.1.cmml"><mo id="alg1.l21.m1.1.1.3.1.2" xref="alg1.l21.m1.1.1.3.1.2.cmml">∑</mo><mrow id="alg1.l21.m1.1.1.3.1.3" xref="alg1.l21.m1.1.1.3.1.3.cmml"><mi id="alg1.l21.m1.1.1.3.1.3.2" xref="alg1.l21.m1.1.1.3.1.3.2.cmml">r</mi><mo id="alg1.l21.m1.1.1.3.1.3.1" xref="alg1.l21.m1.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.1.1.3.1.3.3" xref="alg1.l21.m1.1.1.3.1.3.3.cmml">ℛ</mi></mrow></msub><mrow id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml"><mfrac id="alg1.l21.m1.1.1.3.2.2" xref="alg1.l21.m1.1.1.3.2.2.cmml"><msub id="alg1.l21.m1.1.1.3.2.2.2" xref="alg1.l21.m1.1.1.3.2.2.2.cmml"><mi id="alg1.l21.m1.1.1.3.2.2.2.2" xref="alg1.l21.m1.1.1.3.2.2.2.2.cmml">D</mi><mi id="alg1.l21.m1.1.1.3.2.2.2.3" xref="alg1.l21.m1.1.1.3.2.2.2.3.cmml">r</mi></msub><mrow id="alg1.l21.m1.1.1.3.2.2.3" xref="alg1.l21.m1.1.1.3.2.2.3.cmml"><mstyle displaystyle="false" id="alg1.l21.m1.1.1.3.2.2.3.1" xref="alg1.l21.m1.1.1.3.2.2.3.1.cmml"><msub id="alg1.l21.m1.1.1.3.2.2.3.1a" xref="alg1.l21.m1.1.1.3.2.2.3.1.cmml"><mo id="alg1.l21.m1.1.1.3.2.2.3.1.2" xref="alg1.l21.m1.1.1.3.2.2.3.1.2.cmml">∑</mo><mrow id="alg1.l21.m1.1.1.3.2.2.3.1.3" xref="alg1.l21.m1.1.1.3.2.2.3.1.3.cmml"><mi id="alg1.l21.m1.1.1.3.2.2.3.1.3.2" xref="alg1.l21.m1.1.1.3.2.2.3.1.3.2.cmml">n</mi><mo id="alg1.l21.m1.1.1.3.2.2.3.1.3.1" xref="alg1.l21.m1.1.1.3.2.2.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.1.1.3.2.2.3.1.3.3" xref="alg1.l21.m1.1.1.3.2.2.3.1.3.3.cmml">ℛ</mi></mrow></msub></mstyle><msub id="alg1.l21.m1.1.1.3.2.2.3.2" xref="alg1.l21.m1.1.1.3.2.2.3.2.cmml"><mi id="alg1.l21.m1.1.1.3.2.2.3.2.2" xref="alg1.l21.m1.1.1.3.2.2.3.2.2.cmml">D</mi><mi id="alg1.l21.m1.1.1.3.2.2.3.2.3" xref="alg1.l21.m1.1.1.3.2.2.3.2.3.cmml">n</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l21.m1.1.1.3.2.1" xref="alg1.l21.m1.1.1.3.2.1.cmml">​</mo><msub id="alg1.l21.m1.1.1.3.2.3" xref="alg1.l21.m1.1.1.3.2.3.cmml"><mi id="alg1.l21.m1.1.1.3.2.3.2" xref="alg1.l21.m1.1.1.3.2.3.2.cmml">𝒘</mi><mi id="alg1.l21.m1.1.1.3.2.3.3" xref="alg1.l21.m1.1.1.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><ci id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1">←</ci><apply id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1.2">superscript</csymbol><ci id="alg1.l21.m1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.2.2">𝒘</ci><ci id="alg1.l21.m1.1.1.2.3a.cmml" xref="alg1.l21.m1.1.1.2.3"><mtext mathsize="70%" id="alg1.l21.m1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.2.3">av</mtext></ci></apply><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><apply id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.1.1.cmml" xref="alg1.l21.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l21.m1.1.1.3.1.2.cmml" xref="alg1.l21.m1.1.1.3.1.2"></sum><apply id="alg1.l21.m1.1.1.3.1.3.cmml" xref="alg1.l21.m1.1.1.3.1.3"><in id="alg1.l21.m1.1.1.3.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1.3.1"></in><ci id="alg1.l21.m1.1.1.3.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.1.3.2">𝑟</ci><ci id="alg1.l21.m1.1.1.3.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.1.3.3">ℛ</ci></apply></apply><apply id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2"><times id="alg1.l21.m1.1.1.3.2.1.cmml" xref="alg1.l21.m1.1.1.3.2.1"></times><apply id="alg1.l21.m1.1.1.3.2.2.cmml" xref="alg1.l21.m1.1.1.3.2.2"><divide id="alg1.l21.m1.1.1.3.2.2.1.cmml" xref="alg1.l21.m1.1.1.3.2.2"></divide><apply id="alg1.l21.m1.1.1.3.2.2.2.cmml" xref="alg1.l21.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l21.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l21.m1.1.1.3.2.2.2.2">𝐷</ci><ci id="alg1.l21.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l21.m1.1.1.3.2.2.2.3">𝑟</ci></apply><apply id="alg1.l21.m1.1.1.3.2.2.3.cmml" xref="alg1.l21.m1.1.1.3.2.2.3"><apply id="alg1.l21.m1.1.1.3.2.2.3.1.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.2.2.3.1.1.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.1">subscript</csymbol><sum id="alg1.l21.m1.1.1.3.2.2.3.1.2.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.1.2"></sum><apply id="alg1.l21.m1.1.1.3.2.2.3.1.3.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.1.3"><in id="alg1.l21.m1.1.1.3.2.2.3.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.1.3.1"></in><ci id="alg1.l21.m1.1.1.3.2.2.3.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.1.3.2">𝑛</ci><ci id="alg1.l21.m1.1.1.3.2.2.3.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.1.3.3">ℛ</ci></apply></apply><apply id="alg1.l21.m1.1.1.3.2.2.3.2.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.2.2.3.2.1.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.3.2.2.3.2.2.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.2.2">𝐷</ci><ci id="alg1.l21.m1.1.1.3.2.2.3.2.3.cmml" xref="alg1.l21.m1.1.1.3.2.2.3.2.3">𝑛</ci></apply></apply></apply><apply id="alg1.l21.m1.1.1.3.2.3.cmml" xref="alg1.l21.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.2.3.1.cmml" xref="alg1.l21.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l21.m1.1.1.3.2.3.2.cmml" xref="alg1.l21.m1.1.1.3.2.3.2">𝒘</ci><ci id="alg1.l21.m1.1.1.3.2.3.3.cmml" xref="alg1.l21.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\bm{w}^{\text{av}}\leftarrow\sum_{r\in\mathcal{R}}\frac{D_{r}}{\sum_{n\in\mathcal{R}}D_{n}}\bm{w}_{k}</annotation></semantics></math>

</div>
<div id="alg1.l22" class="ltx_listingline">         Broadcast <math id="alg1.l22.m1.1" class="ltx_Math" alttext="\{\bm{w}_{r}\}_{r\in\mathcal{R}}" display="inline"><semantics id="alg1.l22.m1.1a"><msub id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mrow id="alg1.l22.m1.1.1.1.1" xref="alg1.l22.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l22.m1.1.1.1.1.2" xref="alg1.l22.m1.1.1.1.2.cmml">{</mo><msub id="alg1.l22.m1.1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.1.cmml"><mi id="alg1.l22.m1.1.1.1.1.1.2" xref="alg1.l22.m1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="alg1.l22.m1.1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="alg1.l22.m1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml"><mi id="alg1.l22.m1.1.1.3.2" xref="alg1.l22.m1.1.1.3.2.cmml">r</mi><mo id="alg1.l22.m1.1.1.3.1" xref="alg1.l22.m1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l22.m1.1.1.3.3" xref="alg1.l22.m1.1.1.3.3.cmml">ℛ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1">subscript</csymbol><set id="alg1.l22.m1.1.1.1.2.cmml" xref="alg1.l22.m1.1.1.1.1"><apply id="alg1.l22.m1.1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l22.m1.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.1.1.1.1.1.2">𝒘</ci><ci id="alg1.l22.m1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.1.1.1.1.1.3">𝑟</ci></apply></set><apply id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3"><in id="alg1.l22.m1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.3.1"></in><ci id="alg1.l22.m1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.3.2">𝑟</ci><ci id="alg1.l22.m1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.3.3">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">\{\bm{w}_{r}\}_{r\in\mathcal{R}}</annotation></semantics></math> to all agents <math id="alg1.l22.m2.1" class="ltx_Math" alttext="r\in\mathcal{R}" display="inline"><semantics id="alg1.l22.m2.1a"><mrow id="alg1.l22.m2.1.1" xref="alg1.l22.m2.1.1.cmml"><mi id="alg1.l22.m2.1.1.2" xref="alg1.l22.m2.1.1.2.cmml">r</mi><mo id="alg1.l22.m2.1.1.1" xref="alg1.l22.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l22.m2.1.1.3" xref="alg1.l22.m2.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m2.1b"><apply id="alg1.l22.m2.1.1.cmml" xref="alg1.l22.m2.1.1"><in id="alg1.l22.m2.1.1.1.cmml" xref="alg1.l22.m2.1.1.1"></in><ci id="alg1.l22.m2.1.1.2.cmml" xref="alg1.l22.m2.1.1.2">𝑟</ci><ci id="alg1.l22.m2.1.1.3.cmml" xref="alg1.l22.m2.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m2.1c">r\in\mathcal{R}</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">         <math id="alg1.l23.m1.1" class="ltx_Math" alttext="\mathrm{round}\leftarrow\mathrm{round}+1" display="inline"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><mi id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml">round</mi><mo stretchy="false" id="alg1.l23.m1.1.1.1" xref="alg1.l23.m1.1.1.1.cmml">←</mo><mrow id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"><mi id="alg1.l23.m1.1.1.3.2" xref="alg1.l23.m1.1.1.3.2.cmml">round</mi><mo id="alg1.l23.m1.1.1.3.1" xref="alg1.l23.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l23.m1.1.1.3.3" xref="alg1.l23.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><ci id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1">←</ci><ci id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2">round</ci><apply id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3"><plus id="alg1.l23.m1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.3.1"></plus><ci id="alg1.l23.m1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.3.2">round</ci><cn type="integer" id="alg1.l23.m1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">\mathrm{round}\leftarrow\mathrm{round}+1</annotation></semantics></math>

</div>
<div id="alg1.l24" class="ltx_listingline">     <span id="alg1.l24.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l24.2" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</figure>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.8" class="ltx_p">In this work, we leverage <span id="S4.SS1.p3.8.1" class="ltx_text ltx_font_smallcaps">V-FL Games</span> that exhibits a superior performance than <span id="S4.SS1.p3.8.2" class="ltx_text ltx_font_smallcaps">F-FL Games</span> <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\left(\text{where }f_{\bm{\phi}}=\mathrm{I}\right)" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml"><mo id="S4.SS1.p3.1.m1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.1.m1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml"><mrow id="S4.SS1.p3.1.m1.1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.2.cmml"><mtext id="S4.SS1.p3.1.m1.1.1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.1.1.2.2a.cmml">where </mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.1.1.1.2.1" xref="S4.SS1.p3.1.m1.1.1.1.1.2.1.cmml">​</mo><msub id="S4.SS1.p3.1.m1.1.1.1.1.2.3" xref="S4.SS1.p3.1.m1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.1.1.2.3.2" xref="S4.SS1.p3.1.m1.1.1.1.1.2.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p3.1.m1.1.1.1.1.2.3.3" xref="S4.SS1.p3.1.m1.1.1.1.1.2.3.3.cmml">ϕ</mi></msub></mrow><mo id="S4.SS1.p3.1.m1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S4.SS1.p3.1.m1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.3.cmml">I</mi></mrow><mo id="S4.SS1.p3.1.m1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"><eq id="S4.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1"></eq><apply id="S4.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2"><times id="S4.SS1.p3.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2.1"></times><ci id="S4.SS1.p3.1.m1.1.1.1.1.2.2a.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2.2"><mtext id="S4.SS1.p3.1.m1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2.2">where </mtext></ci><apply id="S4.SS1.p3.1.m1.1.1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2.3.2">𝑓</ci><ci id="S4.SS1.p3.1.m1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2.3.3">bold-italic-ϕ</ci></apply></apply><ci id="S4.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.3">I</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\left(\text{where }f_{\bm{\phi}}=\mathrm{I}\right)</annotation></semantics></math>.
On the other hand, the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> showed by empirical simulations, due to the fact that RIS channels have strong LoS components, that one can select fixed causal representations based on the channels in (<a href="#S2.E1" title="In II-A Channel Model ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and (<a href="#S2.E5" title="In II-A Channel Model ‣ II System Model and Problem Formulation ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). The causal representations in this case are the AoA and AoD at the RIS, <math id="S4.SS1.p3.2.m2.2" class="ltx_Math" alttext="\left(\varphi_{t},\vartheta_{t}\right)" display="inline"><semantics id="S4.SS1.p3.2.m2.2a"><mrow id="S4.SS1.p3.2.m2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.3.cmml"><mo id="S4.SS1.p3.2.m2.2.2.2.3" xref="S4.SS1.p3.2.m2.2.2.3.cmml">(</mo><msub id="S4.SS1.p3.2.m2.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.1.1.2" xref="S4.SS1.p3.2.m2.1.1.1.1.2.cmml">φ</mi><mi id="S4.SS1.p3.2.m2.1.1.1.1.3" xref="S4.SS1.p3.2.m2.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p3.2.m2.2.2.2.4" xref="S4.SS1.p3.2.m2.2.2.3.cmml">,</mo><msub id="S4.SS1.p3.2.m2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.cmml"><mi id="S4.SS1.p3.2.m2.2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.2.cmml">ϑ</mi><mi id="S4.SS1.p3.2.m2.2.2.2.2.3" xref="S4.SS1.p3.2.m2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS1.p3.2.m2.2.2.2.5" xref="S4.SS1.p3.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><interval closure="open" id="S4.SS1.p3.2.m2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2"><apply id="S4.SS1.p3.2.m2.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.2">𝜑</ci><ci id="S4.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.p3.2.m2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.2.2.1.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.2">italic-ϑ</ci><ci id="S4.SS1.p3.2.m2.2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">\left(\varphi_{t},\vartheta_{t}\right)</annotation></semantics></math> and <math id="S4.SS1.p3.3.m3.2" class="ltx_Math" alttext="\left(\varphi_{r},\vartheta_{r}\right)" display="inline"><semantics id="S4.SS1.p3.3.m3.2a"><mrow id="S4.SS1.p3.3.m3.2.2.2" xref="S4.SS1.p3.3.m3.2.2.3.cmml"><mo id="S4.SS1.p3.3.m3.2.2.2.3" xref="S4.SS1.p3.3.m3.2.2.3.cmml">(</mo><msub id="S4.SS1.p3.3.m3.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.1.1.2" xref="S4.SS1.p3.3.m3.1.1.1.1.2.cmml">φ</mi><mi id="S4.SS1.p3.3.m3.1.1.1.1.3" xref="S4.SS1.p3.3.m3.1.1.1.1.3.cmml">r</mi></msub><mo id="S4.SS1.p3.3.m3.2.2.2.4" xref="S4.SS1.p3.3.m3.2.2.3.cmml">,</mo><msub id="S4.SS1.p3.3.m3.2.2.2.2" xref="S4.SS1.p3.3.m3.2.2.2.2.cmml"><mi id="S4.SS1.p3.3.m3.2.2.2.2.2" xref="S4.SS1.p3.3.m3.2.2.2.2.2.cmml">ϑ</mi><mi id="S4.SS1.p3.3.m3.2.2.2.2.3" xref="S4.SS1.p3.3.m3.2.2.2.2.3.cmml">r</mi></msub><mo id="S4.SS1.p3.3.m3.2.2.2.5" xref="S4.SS1.p3.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.2b"><interval closure="open" id="S4.SS1.p3.3.m3.2.2.3.cmml" xref="S4.SS1.p3.3.m3.2.2.2"><apply id="S4.SS1.p3.3.m3.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.2">𝜑</ci><ci id="S4.SS1.p3.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.3">𝑟</ci></apply><apply id="S4.SS1.p3.3.m3.2.2.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.2.2.2.2.1.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2.2">italic-ϑ</ci><ci id="S4.SS1.p3.3.m3.2.2.2.2.3.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2.3">𝑟</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.2c">\left(\varphi_{r},\vartheta_{r}\right)</annotation></semantics></math>, and the relative distances RIS-Tx <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><msub id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">d</mi><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑑</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">d_{t}</annotation></semantics></math> and RIS-Rx <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="d_{r}" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><msub id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">d</mi><mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝑑</ci><ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">d_{r}</annotation></semantics></math>. This benchmark variant of <span id="S4.SS1.p3.8.3" class="ltx_text ltx_font_smallcaps">FL Games</span> where <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="f_{\bm{\phi}}" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><msub id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝑓</ci><ci id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">f_{\bm{\phi}}</annotation></semantics></math> is fixed to <math id="S4.SS1.p3.7.m7.6" class="ltx_Math" alttext="\left(\varphi_{t},\vartheta_{t},\varphi_{r},\vartheta_{r},d_{t},d_{r}\right)" display="inline"><semantics id="S4.SS1.p3.7.m7.6a"><mrow id="S4.SS1.p3.7.m7.6.6.6" xref="S4.SS1.p3.7.m7.6.6.7.cmml"><mo id="S4.SS1.p3.7.m7.6.6.6.7" xref="S4.SS1.p3.7.m7.6.6.7.cmml">(</mo><msub id="S4.SS1.p3.7.m7.1.1.1.1" xref="S4.SS1.p3.7.m7.1.1.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.1.1.2" xref="S4.SS1.p3.7.m7.1.1.1.1.2.cmml">φ</mi><mi id="S4.SS1.p3.7.m7.1.1.1.1.3" xref="S4.SS1.p3.7.m7.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p3.7.m7.6.6.6.8" xref="S4.SS1.p3.7.m7.6.6.7.cmml">,</mo><msub id="S4.SS1.p3.7.m7.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.cmml"><mi id="S4.SS1.p3.7.m7.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.cmml">ϑ</mi><mi id="S4.SS1.p3.7.m7.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS1.p3.7.m7.6.6.6.9" xref="S4.SS1.p3.7.m7.6.6.7.cmml">,</mo><msub id="S4.SS1.p3.7.m7.3.3.3.3" xref="S4.SS1.p3.7.m7.3.3.3.3.cmml"><mi id="S4.SS1.p3.7.m7.3.3.3.3.2" xref="S4.SS1.p3.7.m7.3.3.3.3.2.cmml">φ</mi><mi id="S4.SS1.p3.7.m7.3.3.3.3.3" xref="S4.SS1.p3.7.m7.3.3.3.3.3.cmml">r</mi></msub><mo id="S4.SS1.p3.7.m7.6.6.6.10" xref="S4.SS1.p3.7.m7.6.6.7.cmml">,</mo><msub id="S4.SS1.p3.7.m7.4.4.4.4" xref="S4.SS1.p3.7.m7.4.4.4.4.cmml"><mi id="S4.SS1.p3.7.m7.4.4.4.4.2" xref="S4.SS1.p3.7.m7.4.4.4.4.2.cmml">ϑ</mi><mi id="S4.SS1.p3.7.m7.4.4.4.4.3" xref="S4.SS1.p3.7.m7.4.4.4.4.3.cmml">r</mi></msub><mo id="S4.SS1.p3.7.m7.6.6.6.11" xref="S4.SS1.p3.7.m7.6.6.7.cmml">,</mo><msub id="S4.SS1.p3.7.m7.5.5.5.5" xref="S4.SS1.p3.7.m7.5.5.5.5.cmml"><mi id="S4.SS1.p3.7.m7.5.5.5.5.2" xref="S4.SS1.p3.7.m7.5.5.5.5.2.cmml">d</mi><mi id="S4.SS1.p3.7.m7.5.5.5.5.3" xref="S4.SS1.p3.7.m7.5.5.5.5.3.cmml">t</mi></msub><mo id="S4.SS1.p3.7.m7.6.6.6.12" xref="S4.SS1.p3.7.m7.6.6.7.cmml">,</mo><msub id="S4.SS1.p3.7.m7.6.6.6.6" xref="S4.SS1.p3.7.m7.6.6.6.6.cmml"><mi id="S4.SS1.p3.7.m7.6.6.6.6.2" xref="S4.SS1.p3.7.m7.6.6.6.6.2.cmml">d</mi><mi id="S4.SS1.p3.7.m7.6.6.6.6.3" xref="S4.SS1.p3.7.m7.6.6.6.6.3.cmml">r</mi></msub><mo id="S4.SS1.p3.7.m7.6.6.6.13" xref="S4.SS1.p3.7.m7.6.6.7.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.6b"><vector id="S4.SS1.p3.7.m7.6.6.7.cmml" xref="S4.SS1.p3.7.m7.6.6.6"><apply id="S4.SS1.p3.7.m7.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.2">𝜑</ci><ci id="S4.SS1.p3.7.m7.1.1.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.p3.7.m7.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.2.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2">italic-ϑ</ci><ci id="S4.SS1.p3.7.m7.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS1.p3.7.m7.3.3.3.3.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.3.3.3.3.1.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p3.7.m7.3.3.3.3.2.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3.2">𝜑</ci><ci id="S4.SS1.p3.7.m7.3.3.3.3.3.cmml" xref="S4.SS1.p3.7.m7.3.3.3.3.3">𝑟</ci></apply><apply id="S4.SS1.p3.7.m7.4.4.4.4.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.4.4.4.4.1.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4">subscript</csymbol><ci id="S4.SS1.p3.7.m7.4.4.4.4.2.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4.2">italic-ϑ</ci><ci id="S4.SS1.p3.7.m7.4.4.4.4.3.cmml" xref="S4.SS1.p3.7.m7.4.4.4.4.3">𝑟</ci></apply><apply id="S4.SS1.p3.7.m7.5.5.5.5.cmml" xref="S4.SS1.p3.7.m7.5.5.5.5"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.5.5.5.5.1.cmml" xref="S4.SS1.p3.7.m7.5.5.5.5">subscript</csymbol><ci id="S4.SS1.p3.7.m7.5.5.5.5.2.cmml" xref="S4.SS1.p3.7.m7.5.5.5.5.2">𝑑</ci><ci id="S4.SS1.p3.7.m7.5.5.5.5.3.cmml" xref="S4.SS1.p3.7.m7.5.5.5.5.3">𝑡</ci></apply><apply id="S4.SS1.p3.7.m7.6.6.6.6.cmml" xref="S4.SS1.p3.7.m7.6.6.6.6"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.6.6.6.6.1.cmml" xref="S4.SS1.p3.7.m7.6.6.6.6">subscript</csymbol><ci id="S4.SS1.p3.7.m7.6.6.6.6.2.cmml" xref="S4.SS1.p3.7.m7.6.6.6.6.2">𝑑</ci><ci id="S4.SS1.p3.7.m7.6.6.6.6.3.cmml" xref="S4.SS1.p3.7.m7.6.6.6.6.3">𝑟</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.6c">\left(\varphi_{t},\vartheta_{t},\varphi_{r},\vartheta_{r},d_{t},d_{r}\right)</annotation></semantics></math> is called <span id="S4.SS1.p3.8.4" class="ltx_text ltx_font_smallcaps">F-FL Games</span> in this paper, and is not to be confused with <span id="S4.SS1.p3.8.5" class="ltx_text ltx_font_smallcaps">F-FL Games</span> in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, where <math id="S4.SS1.p3.8.m8.1" class="ltx_Math" alttext="f_{\bm{\phi}}=\mathrm{I}" display="inline"><semantics id="S4.SS1.p3.8.m8.1a"><mrow id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml"><msub id="S4.SS1.p3.8.m8.1.1.2" xref="S4.SS1.p3.8.m8.1.1.2.cmml"><mi id="S4.SS1.p3.8.m8.1.1.2.2" xref="S4.SS1.p3.8.m8.1.1.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p3.8.m8.1.1.2.3" xref="S4.SS1.p3.8.m8.1.1.2.3.cmml">ϕ</mi></msub><mo id="S4.SS1.p3.8.m8.1.1.1" xref="S4.SS1.p3.8.m8.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S4.SS1.p3.8.m8.1.1.3" xref="S4.SS1.p3.8.m8.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><apply id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1"><eq id="S4.SS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1.1"></eq><apply id="S4.SS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.2.1.cmml" xref="S4.SS1.p3.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.2.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2.2">𝑓</ci><ci id="S4.SS1.p3.8.m8.1.1.2.3.cmml" xref="S4.SS1.p3.8.m8.1.1.2.3">bold-italic-ϕ</ci></apply><ci id="S4.SS1.p3.8.m8.1.1.3.cmml" xref="S4.SS1.p3.8.m8.1.1.3">I</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">f_{\bm{\phi}}=\mathrm{I}</annotation></semantics></math>.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2306.01306/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="232" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.6.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.4.2" class="ltx_text" style="font-size:90%;">Distributions of the receiver’s position (distance <math id="S4.F2.3.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.F2.3.1.m1.1b"><mi id="S4.F2.3.1.m1.1.1" xref="S4.F2.3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.F2.3.1.m1.1c"><ci id="S4.F2.3.1.m1.1.1.cmml" xref="S4.F2.3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.3.1.m1.1d">r</annotation></semantics></math> and angle <math id="S4.F2.4.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.F2.4.2.m2.1b"><mi id="S4.F2.4.2.m2.1.1" xref="S4.F2.4.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.F2.4.2.m2.1c"><ci id="S4.F2.4.2.m2.1.1.cmml" xref="S4.F2.4.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.2.m2.1d">\theta</annotation></semantics></math> from the RIS) in different environments.</span></figcaption>
</figure>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2306.01306/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="245" height="109" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Structure of the neural networks used for the representation learner and the predictor: circles represent activation functions and trapezoids correspond to the weights and biases. The activation function type and the output dimension are shown at the bottom and top of each layer.</span></figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2306.01306/assets/x4.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="235" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">Test accuracy convergence for all algorithms compared in the same or in a different environment.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.sf5" class="ltx_figure ltx_figure_panel"><img src="/html/2306.01306/assets/x5.png" id="S4.F4.sf5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="343" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf5.2.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="S4.F4.sf5.3.2" class="ltx_text" style="font-size:90%;">Communication rounds needed for convergence with multiple agents per environment. The number on top of the bar is the corresponding test accuracy.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2306.01306/assets/x6.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="320" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.4.2.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F4.sf2.2.1" class="ltx_text" style="font-size:90%;">Impact of the weight <math id="S4.F4.sf2.2.1.m1.1" class="ltx_Math" alttext="\alpha_{e}" display="inline"><semantics id="S4.F4.sf2.2.1.m1.1b"><msub id="S4.F4.sf2.2.1.m1.1.1" xref="S4.F4.sf2.2.1.m1.1.1.cmml"><mi id="S4.F4.sf2.2.1.m1.1.1.2" xref="S4.F4.sf2.2.1.m1.1.1.2.cmml">α</mi><mi id="S4.F4.sf2.2.1.m1.1.1.3" xref="S4.F4.sf2.2.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F4.sf2.2.1.m1.1c"><apply id="S4.F4.sf2.2.1.m1.1.1.cmml" xref="S4.F4.sf2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F4.sf2.2.1.m1.1.1.1.cmml" xref="S4.F4.sf2.2.1.m1.1.1">subscript</csymbol><ci id="S4.F4.sf2.2.1.m1.1.1.2.cmml" xref="S4.F4.sf2.2.1.m1.1.1.2">𝛼</ci><ci id="S4.F4.sf2.2.1.m1.1.1.3.cmml" xref="S4.F4.sf2.2.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.sf2.2.1.m1.1d">\alpha_{e}</annotation></semantics></math> on the testing accuracy.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2306.01306/assets/x7.png" id="S4.F4.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="318" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F4.sf3.3.2" class="ltx_text" style="font-size:90%;">Impact of number of local iterations on the testing accuracy.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.sf4" class="ltx_figure ltx_figure_panel"><img src="/html/2306.01306/assets/x8.png" id="S4.F4.sf4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="311" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F4.sf4.3.2" class="ltx_text" style="font-size:90%;">Impact of the number of samples per environment on the achievable spectral efficiency.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Performance comparison of different algorithms in OoD testing datasets.</span></figcaption>
</figure>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.8" class="ltx_p">For training in <span id="S4.SS1.p4.8.1" class="ltx_text ltx_font_smallcaps">FedAVG</span> and <span id="S4.SS1.p4.8.2" class="ltx_text ltx_font_smallcaps">V-FL Games</span>, we collect <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="D_{r}=1500" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><msub id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2.2" xref="S4.SS1.p4.1.m1.1.1.2.2.cmml">D</mi><mi id="S4.SS1.p4.1.m1.1.1.2.3" xref="S4.SS1.p4.1.m1.1.1.2.3.cmml">r</mi></msub><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">1500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></eq><apply id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2.2">𝐷</ci><ci id="S4.SS1.p4.1.m1.1.1.2.3.cmml" xref="S4.SS1.p4.1.m1.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">1500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">D_{r}=1500</annotation></semantics></math> CSI samples <math id="S4.SS1.p4.2.m2.2" class="ltx_Math" alttext="\bm{x}_{j}^{r}=\left(\mathbf{h}_{j}^{r},\mathbf{g}_{j}^{r}\right)" display="inline"><semantics id="S4.SS1.p4.2.m2.2a"><mrow id="S4.SS1.p4.2.m2.2.2" xref="S4.SS1.p4.2.m2.2.2.cmml"><msubsup id="S4.SS1.p4.2.m2.2.2.4" xref="S4.SS1.p4.2.m2.2.2.4.cmml"><mi id="S4.SS1.p4.2.m2.2.2.4.2.2" xref="S4.SS1.p4.2.m2.2.2.4.2.2.cmml">𝒙</mi><mi id="S4.SS1.p4.2.m2.2.2.4.2.3" xref="S4.SS1.p4.2.m2.2.2.4.2.3.cmml">j</mi><mi id="S4.SS1.p4.2.m2.2.2.4.3" xref="S4.SS1.p4.2.m2.2.2.4.3.cmml">r</mi></msubsup><mo id="S4.SS1.p4.2.m2.2.2.3" xref="S4.SS1.p4.2.m2.2.2.3.cmml">=</mo><mrow id="S4.SS1.p4.2.m2.2.2.2.2" xref="S4.SS1.p4.2.m2.2.2.2.3.cmml"><mo id="S4.SS1.p4.2.m2.2.2.2.2.3" xref="S4.SS1.p4.2.m2.2.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p4.2.m2.1.1.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.2.2" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.cmml">j</mi><mi id="S4.SS1.p4.2.m2.1.1.1.1.1.3" xref="S4.SS1.p4.2.m2.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S4.SS1.p4.2.m2.2.2.2.2.4" xref="S4.SS1.p4.2.m2.2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p4.2.m2.2.2.2.2.2" xref="S4.SS1.p4.2.m2.2.2.2.2.2.cmml"><mi id="S4.SS1.p4.2.m2.2.2.2.2.2.2.2" xref="S4.SS1.p4.2.m2.2.2.2.2.2.2.2.cmml">𝐠</mi><mi id="S4.SS1.p4.2.m2.2.2.2.2.2.2.3" xref="S4.SS1.p4.2.m2.2.2.2.2.2.2.3.cmml">j</mi><mi id="S4.SS1.p4.2.m2.2.2.2.2.2.3" xref="S4.SS1.p4.2.m2.2.2.2.2.2.3.cmml">r</mi></msubsup><mo id="S4.SS1.p4.2.m2.2.2.2.2.5" xref="S4.SS1.p4.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.2b"><apply id="S4.SS1.p4.2.m2.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2"><eq id="S4.SS1.p4.2.m2.2.2.3.cmml" xref="S4.SS1.p4.2.m2.2.2.3"></eq><apply id="S4.SS1.p4.2.m2.2.2.4.cmml" xref="S4.SS1.p4.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.2.2.4.1.cmml" xref="S4.SS1.p4.2.m2.2.2.4">superscript</csymbol><apply id="S4.SS1.p4.2.m2.2.2.4.2.cmml" xref="S4.SS1.p4.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.2.2.4.2.1.cmml" xref="S4.SS1.p4.2.m2.2.2.4">subscript</csymbol><ci id="S4.SS1.p4.2.m2.2.2.4.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2.4.2.2">𝒙</ci><ci id="S4.SS1.p4.2.m2.2.2.4.2.3.cmml" xref="S4.SS1.p4.2.m2.2.2.4.2.3">𝑗</ci></apply><ci id="S4.SS1.p4.2.m2.2.2.4.3.cmml" xref="S4.SS1.p4.2.m2.2.2.4.3">𝑟</ci></apply><interval closure="open" id="S4.SS1.p4.2.m2.2.2.2.3.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2"><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p4.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.2">𝐡</ci><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.p4.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1.1.3">𝑟</ci></apply><apply id="S4.SS1.p4.2.m2.2.2.2.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p4.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p4.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2.2.2.2">𝐠</ci><ci id="S4.SS1.p4.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S4.SS1.p4.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2.2.3">𝑟</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.2c">\bm{x}_{j}^{r}=\left(\mathbf{h}_{j}^{r},\mathbf{g}_{j}^{r}\right)</annotation></semantics></math> from environments 1 and 2, that are decoupled over real and imaginary parts.
This data is scaled in such a way that the normalized mean is zero and the normalized variance is one.
We also record the parameters <math id="S4.SS1.p4.3.m3.6" class="ltx_Math" alttext="\left(\varphi_{t},\vartheta_{t},\varphi_{r},\vartheta_{r},d_{t},d_{r}\right)" display="inline"><semantics id="S4.SS1.p4.3.m3.6a"><mrow id="S4.SS1.p4.3.m3.6.6.6" xref="S4.SS1.p4.3.m3.6.6.7.cmml"><mo id="S4.SS1.p4.3.m3.6.6.6.7" xref="S4.SS1.p4.3.m3.6.6.7.cmml">(</mo><msub id="S4.SS1.p4.3.m3.1.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.1.1.2" xref="S4.SS1.p4.3.m3.1.1.1.1.2.cmml">φ</mi><mi id="S4.SS1.p4.3.m3.1.1.1.1.3" xref="S4.SS1.p4.3.m3.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p4.3.m3.6.6.6.8" xref="S4.SS1.p4.3.m3.6.6.7.cmml">,</mo><msub id="S4.SS1.p4.3.m3.2.2.2.2" xref="S4.SS1.p4.3.m3.2.2.2.2.cmml"><mi id="S4.SS1.p4.3.m3.2.2.2.2.2" xref="S4.SS1.p4.3.m3.2.2.2.2.2.cmml">ϑ</mi><mi id="S4.SS1.p4.3.m3.2.2.2.2.3" xref="S4.SS1.p4.3.m3.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS1.p4.3.m3.6.6.6.9" xref="S4.SS1.p4.3.m3.6.6.7.cmml">,</mo><msub id="S4.SS1.p4.3.m3.3.3.3.3" xref="S4.SS1.p4.3.m3.3.3.3.3.cmml"><mi id="S4.SS1.p4.3.m3.3.3.3.3.2" xref="S4.SS1.p4.3.m3.3.3.3.3.2.cmml">φ</mi><mi id="S4.SS1.p4.3.m3.3.3.3.3.3" xref="S4.SS1.p4.3.m3.3.3.3.3.3.cmml">r</mi></msub><mo id="S4.SS1.p4.3.m3.6.6.6.10" xref="S4.SS1.p4.3.m3.6.6.7.cmml">,</mo><msub id="S4.SS1.p4.3.m3.4.4.4.4" xref="S4.SS1.p4.3.m3.4.4.4.4.cmml"><mi id="S4.SS1.p4.3.m3.4.4.4.4.2" xref="S4.SS1.p4.3.m3.4.4.4.4.2.cmml">ϑ</mi><mi id="S4.SS1.p4.3.m3.4.4.4.4.3" xref="S4.SS1.p4.3.m3.4.4.4.4.3.cmml">r</mi></msub><mo id="S4.SS1.p4.3.m3.6.6.6.11" xref="S4.SS1.p4.3.m3.6.6.7.cmml">,</mo><msub id="S4.SS1.p4.3.m3.5.5.5.5" xref="S4.SS1.p4.3.m3.5.5.5.5.cmml"><mi id="S4.SS1.p4.3.m3.5.5.5.5.2" xref="S4.SS1.p4.3.m3.5.5.5.5.2.cmml">d</mi><mi id="S4.SS1.p4.3.m3.5.5.5.5.3" xref="S4.SS1.p4.3.m3.5.5.5.5.3.cmml">t</mi></msub><mo id="S4.SS1.p4.3.m3.6.6.6.12" xref="S4.SS1.p4.3.m3.6.6.7.cmml">,</mo><msub id="S4.SS1.p4.3.m3.6.6.6.6" xref="S4.SS1.p4.3.m3.6.6.6.6.cmml"><mi id="S4.SS1.p4.3.m3.6.6.6.6.2" xref="S4.SS1.p4.3.m3.6.6.6.6.2.cmml">d</mi><mi id="S4.SS1.p4.3.m3.6.6.6.6.3" xref="S4.SS1.p4.3.m3.6.6.6.6.3.cmml">r</mi></msub><mo id="S4.SS1.p4.3.m3.6.6.6.13" xref="S4.SS1.p4.3.m3.6.6.7.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.6b"><vector id="S4.SS1.p4.3.m3.6.6.7.cmml" xref="S4.SS1.p4.3.m3.6.6.6"><apply id="S4.SS1.p4.3.m3.1.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.2">𝜑</ci><ci id="S4.SS1.p4.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.p4.3.m3.2.2.2.2.cmml" xref="S4.SS1.p4.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.2.2.2.2.1.cmml" xref="S4.SS1.p4.3.m3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p4.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.p4.3.m3.2.2.2.2.2">italic-ϑ</ci><ci id="S4.SS1.p4.3.m3.2.2.2.2.3.cmml" xref="S4.SS1.p4.3.m3.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS1.p4.3.m3.3.3.3.3.cmml" xref="S4.SS1.p4.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.3.3.3.3.1.cmml" xref="S4.SS1.p4.3.m3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p4.3.m3.3.3.3.3.2.cmml" xref="S4.SS1.p4.3.m3.3.3.3.3.2">𝜑</ci><ci id="S4.SS1.p4.3.m3.3.3.3.3.3.cmml" xref="S4.SS1.p4.3.m3.3.3.3.3.3">𝑟</ci></apply><apply id="S4.SS1.p4.3.m3.4.4.4.4.cmml" xref="S4.SS1.p4.3.m3.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.4.4.4.4.1.cmml" xref="S4.SS1.p4.3.m3.4.4.4.4">subscript</csymbol><ci id="S4.SS1.p4.3.m3.4.4.4.4.2.cmml" xref="S4.SS1.p4.3.m3.4.4.4.4.2">italic-ϑ</ci><ci id="S4.SS1.p4.3.m3.4.4.4.4.3.cmml" xref="S4.SS1.p4.3.m3.4.4.4.4.3">𝑟</ci></apply><apply id="S4.SS1.p4.3.m3.5.5.5.5.cmml" xref="S4.SS1.p4.3.m3.5.5.5.5"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.5.5.5.5.1.cmml" xref="S4.SS1.p4.3.m3.5.5.5.5">subscript</csymbol><ci id="S4.SS1.p4.3.m3.5.5.5.5.2.cmml" xref="S4.SS1.p4.3.m3.5.5.5.5.2">𝑑</ci><ci id="S4.SS1.p4.3.m3.5.5.5.5.3.cmml" xref="S4.SS1.p4.3.m3.5.5.5.5.3">𝑡</ci></apply><apply id="S4.SS1.p4.3.m3.6.6.6.6.cmml" xref="S4.SS1.p4.3.m3.6.6.6.6"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.6.6.6.6.1.cmml" xref="S4.SS1.p4.3.m3.6.6.6.6">subscript</csymbol><ci id="S4.SS1.p4.3.m3.6.6.6.6.2.cmml" xref="S4.SS1.p4.3.m3.6.6.6.6.2">𝑑</ci><ci id="S4.SS1.p4.3.m3.6.6.6.6.3.cmml" xref="S4.SS1.p4.3.m3.6.6.6.6.3">𝑟</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.6c">\left(\varphi_{t},\vartheta_{t},\varphi_{r},\vartheta_{r},d_{t},d_{r}\right)</annotation></semantics></math> to train <span id="S4.SS1.p4.8.3" class="ltx_text ltx_font_smallcaps">F-FL Games</span>, which are scaled using a minmax scaler that normalizes the data to the interval <math id="S4.SS1.p4.4.m4.2" class="ltx_Math" alttext="[-1,1]" display="inline"><semantics id="S4.SS1.p4.4.m4.2a"><mrow id="S4.SS1.p4.4.m4.2.2.1" xref="S4.SS1.p4.4.m4.2.2.2.cmml"><mo stretchy="false" id="S4.SS1.p4.4.m4.2.2.1.2" xref="S4.SS1.p4.4.m4.2.2.2.cmml">[</mo><mrow id="S4.SS1.p4.4.m4.2.2.1.1" xref="S4.SS1.p4.4.m4.2.2.1.1.cmml"><mo id="S4.SS1.p4.4.m4.2.2.1.1a" xref="S4.SS1.p4.4.m4.2.2.1.1.cmml">−</mo><mn id="S4.SS1.p4.4.m4.2.2.1.1.2" xref="S4.SS1.p4.4.m4.2.2.1.1.2.cmml">1</mn></mrow><mo id="S4.SS1.p4.4.m4.2.2.1.3" xref="S4.SS1.p4.4.m4.2.2.2.cmml">,</mo><mn id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">1</mn><mo stretchy="false" id="S4.SS1.p4.4.m4.2.2.1.4" xref="S4.SS1.p4.4.m4.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.2b"><interval closure="closed" id="S4.SS1.p4.4.m4.2.2.2.cmml" xref="S4.SS1.p4.4.m4.2.2.1"><apply id="S4.SS1.p4.4.m4.2.2.1.1.cmml" xref="S4.SS1.p4.4.m4.2.2.1.1"><minus id="S4.SS1.p4.4.m4.2.2.1.1.1.cmml" xref="S4.SS1.p4.4.m4.2.2.1.1"></minus><cn type="integer" id="S4.SS1.p4.4.m4.2.2.1.1.2.cmml" xref="S4.SS1.p4.4.m4.2.2.1.1.2">1</cn></apply><cn type="integer" id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.2c">[-1,1]</annotation></semantics></math> by dividing by the absolute maximum.
Unless stated otherwise, we use <math id="S4.SS1.p4.5.m5.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.SS1.p4.5.m5.1a"><mn id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><cn type="integer" id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">1000</annotation></semantics></math> samples collected from environment 3 for testing.
The design of the neural networks of the extractor and the predictor of <span id="S4.SS1.p4.8.4" class="ltx_text ltx_font_smallcaps">V-FL Games</span> is based on the multi-layer perceptrons architecture, and is shown in Fig. <a href="#S4.F3" title="Figure 3 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
Note that <span id="S4.SS1.p4.8.5" class="ltx_text ltx_font_smallcaps">FedAVG</span> and <span id="S4.SS1.p4.8.6" class="ltx_text ltx_font_smallcaps">F-FL Games</span> only use the predictor part. The considered loss function is the cross-entropy. The mini-batch size used for training the predictor is <math id="S4.SS1.p4.6.m6.1" class="ltx_Math" alttext="m=32" display="inline"><semantics id="S4.SS1.p4.6.m6.1a"><mrow id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml"><mi id="S4.SS1.p4.6.m6.1.1.2" xref="S4.SS1.p4.6.m6.1.1.2.cmml">m</mi><mo id="S4.SS1.p4.6.m6.1.1.1" xref="S4.SS1.p4.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.6.m6.1.1.3" xref="S4.SS1.p4.6.m6.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><apply id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1"><eq id="S4.SS1.p4.6.m6.1.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1.1"></eq><ci id="S4.SS1.p4.6.m6.1.1.2.cmml" xref="S4.SS1.p4.6.m6.1.1.2">𝑚</ci><cn type="integer" id="S4.SS1.p4.6.m6.1.1.3.cmml" xref="S4.SS1.p4.6.m6.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">m=32</annotation></semantics></math>, and the learning rates are fixed at <math id="S4.SS1.p4.7.m7.1" class="ltx_Math" alttext="\eta_{\bm{\phi}}=5\times 10^{-4}" display="inline"><semantics id="S4.SS1.p4.7.m7.1a"><mrow id="S4.SS1.p4.7.m7.1.1" xref="S4.SS1.p4.7.m7.1.1.cmml"><msub id="S4.SS1.p4.7.m7.1.1.2" xref="S4.SS1.p4.7.m7.1.1.2.cmml"><mi id="S4.SS1.p4.7.m7.1.1.2.2" xref="S4.SS1.p4.7.m7.1.1.2.2.cmml">η</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p4.7.m7.1.1.2.3" xref="S4.SS1.p4.7.m7.1.1.2.3.cmml">ϕ</mi></msub><mo id="S4.SS1.p4.7.m7.1.1.1" xref="S4.SS1.p4.7.m7.1.1.1.cmml">=</mo><mrow id="S4.SS1.p4.7.m7.1.1.3" xref="S4.SS1.p4.7.m7.1.1.3.cmml"><mn id="S4.SS1.p4.7.m7.1.1.3.2" xref="S4.SS1.p4.7.m7.1.1.3.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p4.7.m7.1.1.3.1" xref="S4.SS1.p4.7.m7.1.1.3.1.cmml">×</mo><msup id="S4.SS1.p4.7.m7.1.1.3.3" xref="S4.SS1.p4.7.m7.1.1.3.3.cmml"><mn id="S4.SS1.p4.7.m7.1.1.3.3.2" xref="S4.SS1.p4.7.m7.1.1.3.3.2.cmml">10</mn><mrow id="S4.SS1.p4.7.m7.1.1.3.3.3" xref="S4.SS1.p4.7.m7.1.1.3.3.3.cmml"><mo id="S4.SS1.p4.7.m7.1.1.3.3.3a" xref="S4.SS1.p4.7.m7.1.1.3.3.3.cmml">−</mo><mn id="S4.SS1.p4.7.m7.1.1.3.3.3.2" xref="S4.SS1.p4.7.m7.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.7.m7.1b"><apply id="S4.SS1.p4.7.m7.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1"><eq id="S4.SS1.p4.7.m7.1.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1.1"></eq><apply id="S4.SS1.p4.7.m7.1.1.2.cmml" xref="S4.SS1.p4.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.7.m7.1.1.2.1.cmml" xref="S4.SS1.p4.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.p4.7.m7.1.1.2.2.cmml" xref="S4.SS1.p4.7.m7.1.1.2.2">𝜂</ci><ci id="S4.SS1.p4.7.m7.1.1.2.3.cmml" xref="S4.SS1.p4.7.m7.1.1.2.3">bold-italic-ϕ</ci></apply><apply id="S4.SS1.p4.7.m7.1.1.3.cmml" xref="S4.SS1.p4.7.m7.1.1.3"><times id="S4.SS1.p4.7.m7.1.1.3.1.cmml" xref="S4.SS1.p4.7.m7.1.1.3.1"></times><cn type="integer" id="S4.SS1.p4.7.m7.1.1.3.2.cmml" xref="S4.SS1.p4.7.m7.1.1.3.2">5</cn><apply id="S4.SS1.p4.7.m7.1.1.3.3.cmml" xref="S4.SS1.p4.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.7.m7.1.1.3.3.1.cmml" xref="S4.SS1.p4.7.m7.1.1.3.3">superscript</csymbol><cn type="integer" id="S4.SS1.p4.7.m7.1.1.3.3.2.cmml" xref="S4.SS1.p4.7.m7.1.1.3.3.2">10</cn><apply id="S4.SS1.p4.7.m7.1.1.3.3.3.cmml" xref="S4.SS1.p4.7.m7.1.1.3.3.3"><minus id="S4.SS1.p4.7.m7.1.1.3.3.3.1.cmml" xref="S4.SS1.p4.7.m7.1.1.3.3.3"></minus><cn type="integer" id="S4.SS1.p4.7.m7.1.1.3.3.3.2.cmml" xref="S4.SS1.p4.7.m7.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.7.m7.1c">\eta_{\bm{\phi}}=5\times 10^{-4}</annotation></semantics></math> and <math id="S4.SS1.p4.8.m8.1" class="ltx_Math" alttext="\eta_{\bm{w}}=2\times 10^{-3}" display="inline"><semantics id="S4.SS1.p4.8.m8.1a"><mrow id="S4.SS1.p4.8.m8.1.1" xref="S4.SS1.p4.8.m8.1.1.cmml"><msub id="S4.SS1.p4.8.m8.1.1.2" xref="S4.SS1.p4.8.m8.1.1.2.cmml"><mi id="S4.SS1.p4.8.m8.1.1.2.2" xref="S4.SS1.p4.8.m8.1.1.2.2.cmml">η</mi><mi id="S4.SS1.p4.8.m8.1.1.2.3" xref="S4.SS1.p4.8.m8.1.1.2.3.cmml">𝒘</mi></msub><mo id="S4.SS1.p4.8.m8.1.1.1" xref="S4.SS1.p4.8.m8.1.1.1.cmml">=</mo><mrow id="S4.SS1.p4.8.m8.1.1.3" xref="S4.SS1.p4.8.m8.1.1.3.cmml"><mn id="S4.SS1.p4.8.m8.1.1.3.2" xref="S4.SS1.p4.8.m8.1.1.3.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p4.8.m8.1.1.3.1" xref="S4.SS1.p4.8.m8.1.1.3.1.cmml">×</mo><msup id="S4.SS1.p4.8.m8.1.1.3.3" xref="S4.SS1.p4.8.m8.1.1.3.3.cmml"><mn id="S4.SS1.p4.8.m8.1.1.3.3.2" xref="S4.SS1.p4.8.m8.1.1.3.3.2.cmml">10</mn><mrow id="S4.SS1.p4.8.m8.1.1.3.3.3" xref="S4.SS1.p4.8.m8.1.1.3.3.3.cmml"><mo id="S4.SS1.p4.8.m8.1.1.3.3.3a" xref="S4.SS1.p4.8.m8.1.1.3.3.3.cmml">−</mo><mn id="S4.SS1.p4.8.m8.1.1.3.3.3.2" xref="S4.SS1.p4.8.m8.1.1.3.3.3.2.cmml">3</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.8.m8.1b"><apply id="S4.SS1.p4.8.m8.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1"><eq id="S4.SS1.p4.8.m8.1.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1.1"></eq><apply id="S4.SS1.p4.8.m8.1.1.2.cmml" xref="S4.SS1.p4.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p4.8.m8.1.1.2.1.cmml" xref="S4.SS1.p4.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS1.p4.8.m8.1.1.2.2.cmml" xref="S4.SS1.p4.8.m8.1.1.2.2">𝜂</ci><ci id="S4.SS1.p4.8.m8.1.1.2.3.cmml" xref="S4.SS1.p4.8.m8.1.1.2.3">𝒘</ci></apply><apply id="S4.SS1.p4.8.m8.1.1.3.cmml" xref="S4.SS1.p4.8.m8.1.1.3"><times id="S4.SS1.p4.8.m8.1.1.3.1.cmml" xref="S4.SS1.p4.8.m8.1.1.3.1"></times><cn type="integer" id="S4.SS1.p4.8.m8.1.1.3.2.cmml" xref="S4.SS1.p4.8.m8.1.1.3.2">2</cn><apply id="S4.SS1.p4.8.m8.1.1.3.3.cmml" xref="S4.SS1.p4.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.8.m8.1.1.3.3.1.cmml" xref="S4.SS1.p4.8.m8.1.1.3.3">superscript</csymbol><cn type="integer" id="S4.SS1.p4.8.m8.1.1.3.3.2.cmml" xref="S4.SS1.p4.8.m8.1.1.3.3.2">10</cn><apply id="S4.SS1.p4.8.m8.1.1.3.3.3.cmml" xref="S4.SS1.p4.8.m8.1.1.3.3.3"><minus id="S4.SS1.p4.8.m8.1.1.3.3.3.1.cmml" xref="S4.SS1.p4.8.m8.1.1.3.3.3"></minus><cn type="integer" id="S4.SS1.p4.8.m8.1.1.3.3.3.2.cmml" xref="S4.SS1.p4.8.m8.1.1.3.3.3.2">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.8.m8.1c">\eta_{\bm{w}}=2\times 10^{-3}</annotation></semantics></math>.
In the figures, lines correspond to the simulation results that are averaged over five runs while the their respective standard deviations are shown as shaded areas.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Discussion</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">We first plot the evolution of the testing accuracy of all algorithms in Fig. <a href="#S4.F4.sf1" title="In Figure 4 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref">4(a)</a>.
Within the same environment (Environments 1 and 2), <span id="S4.SS2.p1.6.1" class="ltx_text ltx_font_smallcaps">FedAVG</span> and <span id="S4.SS2.p1.6.2" class="ltx_text ltx_font_smallcaps">V-FL Games</span> perform similarly with an accuracy of <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="90\%" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">90</mn><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">90\%</annotation></semantics></math>, while <span id="S4.SS2.p1.6.3" class="ltx_text ltx_font_smallcaps">F-FL Games</span> gives an accuracy of <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="87\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">87</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">87</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">87\%</annotation></semantics></math>. When testing in a different environment (Environment 3), <span id="S4.SS2.p1.6.4" class="ltx_text ltx_font_smallcaps">FedAVG</span>’s accuracy drops to <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="68\%" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">68</mn><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">68\%</annotation></semantics></math>, highlighting its lack of robustness. In this case, <span id="S4.SS2.p1.6.5" class="ltx_text ltx_font_smallcaps">F-FL Games</span> and <span id="S4.SS2.p1.6.6" class="ltx_text ltx_font_smallcaps">V-FL Games</span> yield slightly lower accuracies of <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="85\%" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mn id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">85</mn><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">85</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">85\%</annotation></semantics></math> and <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="80\%" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mn id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">80</mn><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">80\%</annotation></semantics></math>, implying they do not overfit to the statistical correlations in the channels.
It is also interesting to observe the convergence rate of the different methods. We notice that <span id="S4.SS2.p1.6.7" class="ltx_text ltx_font_smallcaps">V-FL Games</span> converges faster than <span id="S4.SS2.p1.6.8" class="ltx_text ltx_font_smallcaps">F-FL Games</span>, requiring around <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">500</annotation></semantics></math> communication epochs in both cases.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.6" class="ltx_p">Fig. <a href="#S4.F4.sf2" title="In Figure 4 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref">4(b)</a> demonstrates the impact of mixing data from different environments on model training.
Here, we keep the total number samples to be <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="D_{1}+D_{2}=3000" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml"><msub id="S4.SS2.p2.1.m1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.2.cmml">D</mi><mn id="S4.SS2.p2.1.m1.1.1.2.2.3" xref="S4.SS2.p2.1.m1.1.1.2.2.3.cmml">1</mn></msub><mo id="S4.SS2.p2.1.m1.1.1.2.1" xref="S4.SS2.p2.1.m1.1.1.2.1.cmml">+</mo><msub id="S4.SS2.p2.1.m1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2.3.2" xref="S4.SS2.p2.1.m1.1.1.2.3.2.cmml">D</mi><mn id="S4.SS2.p2.1.m1.1.1.2.3.3" xref="S4.SS2.p2.1.m1.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">3000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"><plus id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2.1"></plus><apply id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2.2">𝐷</ci><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2.3">1</cn></apply><apply id="S4.SS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3.2">𝐷</ci><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3.3">2</cn></apply></apply><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">3000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">D_{1}+D_{2}=3000</annotation></semantics></math> and vary the amount of data from the two environments, in which, <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\alpha_{e}=\frac{D_{1}}{D_{2}}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><msub id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">α</mi><mi id="S4.SS2.p2.2.m2.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.2.3.cmml">e</mi></msub><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mfrac id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><msub id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2.2" xref="S4.SS2.p2.2.m2.1.1.3.2.2.cmml">D</mi><mn id="S4.SS2.p2.2.m2.1.1.3.2.3" xref="S4.SS2.p2.2.m2.1.1.3.2.3.cmml">1</mn></msub><msub id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.2.cmml">D</mi><mn id="S4.SS2.p2.2.m2.1.1.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.cmml">2</mn></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">𝛼</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3">𝑒</ci></apply><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><divide id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3"></divide><apply id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.3.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2.2">𝐷</ci><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2.3">1</cn></apply><apply id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.2">𝐷</ci><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\alpha_{e}=\frac{D_{1}}{D_{2}}</annotation></semantics></math> represents the fraction of samples of environment 1 compared to environment 2.
We first notice that all algorithms reach their peak performance with balanced datasets, i.e. <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\alpha_{e}=0.5" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><msub id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">α</mi><mi id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml">e</mi></msub><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><eq id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></eq><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝛼</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">𝑒</ci></apply><cn type="float" id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\alpha_{e}=0.5</annotation></semantics></math>. When the datatsets are biased towards one of the environments, <span id="S4.SS2.p2.6.1" class="ltx_text ltx_font_smallcaps">FedAVG</span> loses <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="15\%" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mn id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">15</mn><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">15\%</annotation></semantics></math> of its performance. On the other hand, <span id="S4.SS2.p2.6.2" class="ltx_text ltx_font_smallcaps">F-FL Games</span> and <span id="S4.SS2.p2.6.3" class="ltx_text ltx_font_smallcaps">V-FL Games</span> maintain a steady accuracy with a slight degradation of about <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mn id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><cn type="integer" id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">3</annotation></semantics></math>–<math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="4\%" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mn id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">4</mn><mo id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="latexml" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">4\%</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">Inspired by <span id="S4.SS2.p3.3.1" class="ltx_text ltx_font_smallcaps">FedAVG</span>’s flexibility in allowing more local computations at each agent before sharing their models, we modify our proposed algorithm to study the effect of the number of local iterations on the model accuracy.
Insofar, each agent performs a few SGD updates locally prior to model sharing.
Fig. <a href="#S4.F4.sf3" title="In Figure 4 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref">4(c)</a> shows the impact of the number of local steps on the testing accuracy.
It can be noted that the accuracy drops when each RIS performs more local computations when using <span id="S4.SS2.p3.3.2" class="ltx_text ltx_font_smallcaps">FL Games</span> due to the fact that the models are overfitting to the local datasets.
However, the performance of <span id="S4.SS2.p3.3.3" class="ltx_text ltx_font_smallcaps">F-FL Games</span> is more consistent with the local steps, losing only <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="2\%" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mn id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">2</mn><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">2\%</annotation></semantics></math> of accuracy with seven local iterations, while <span id="S4.SS2.p3.3.4" class="ltx_text ltx_font_smallcaps">V-FL Games</span> loses around <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="8\%" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mn id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">8</mn><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">8\%</annotation></semantics></math> of accuracy with <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="15" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mn id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><cn type="integer" id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">15</annotation></semantics></math> local updates.
The reason for this behavior is that by letting each agent run over more samples from its local dataset, the testing accuracy at equilibrium decreases, since the played strategies do not account for the opponents’ actions.
On the other hand, the accuracy of <span id="S4.SS2.p3.3.5" class="ltx_text ltx_font_smallcaps">FedAVG</span> slightly increases with more local iterations, but still performs poorly.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.15" class="ltx_p">The effect of the dataset size <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="D_{r}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">D</mi><mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝐷</ci><ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">D_{r}</annotation></semantics></math> per agent on the achievable spectral efficiency is illustrated in Fig. <a href="#S4.F4.sf4" title="In Figure 4 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref">4(d)</a>.
Note that all agents use an equal amount of samples, i.e., <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\alpha_{e}=0.5" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><msub id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2.2" xref="S4.SS2.p4.2.m2.1.1.2.2.cmml">α</mi><mi id="S4.SS2.p4.2.m2.1.1.2.3" xref="S4.SS2.p4.2.m2.1.1.2.3.cmml">e</mi></msub><mo id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><eq id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"></eq><apply id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2.2">𝛼</ci><ci id="S4.SS2.p4.2.m2.1.1.2.3.cmml" xref="S4.SS2.p4.2.m2.1.1.2.3">𝑒</ci></apply><cn type="float" id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\alpha_{e}=0.5</annotation></semantics></math> is held.
For the comparison, we additionally present the optimal rate given by the best configurations (indicated by Best) and the rates given by random phase decision making (indicated by Random).
All algorithms reach their best performance with the highest number of samples <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="D_{r}=1250" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><msub id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2.2" xref="S4.SS2.p4.3.m3.1.1.2.2.cmml">D</mi><mi id="S4.SS2.p4.3.m3.1.1.2.3" xref="S4.SS2.p4.3.m3.1.1.2.3.cmml">r</mi></msub><mo id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">1250</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><eq id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1"></eq><apply id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2.2">𝐷</ci><ci id="S4.SS2.p4.3.m3.1.1.2.3.cmml" xref="S4.SS2.p4.3.m3.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">1250</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">D_{r}=1250</annotation></semantics></math> with about <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="21\%" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mn id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">21</mn><mo id="S4.SS2.p4.4.m4.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">21\%</annotation></semantics></math>, <math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="14\%" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mn id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">14</mn><mo id="S4.SS2.p4.5.m5.1.1.1" xref="S4.SS2.p4.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">14\%</annotation></semantics></math> and <math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="32\%" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mrow id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml"><mn id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.cmml">32</mn><mo id="S4.SS2.p4.6.m6.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1"><csymbol cd="latexml" id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">32\%</annotation></semantics></math> losses compared to Best rates in <span id="S4.SS2.p4.15.1" class="ltx_text ltx_font_smallcaps">V-FL Games</span>, <span id="S4.SS2.p4.15.2" class="ltx_text ltx_font_smallcaps">F-FL Games</span>, and <span id="S4.SS2.p4.15.3" class="ltx_text ltx_font_smallcaps">FedAVG</span>, respectively.
The advantage of learning invariant causal representations with minimal amount of data is highlighted when <math id="S4.SS2.p4.7.m7.1" class="ltx_Math" alttext="D_{r}\leq 750" display="inline"><semantics id="S4.SS2.p4.7.m7.1a"><mrow id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml"><msub id="S4.SS2.p4.7.m7.1.1.2" xref="S4.SS2.p4.7.m7.1.1.2.cmml"><mi id="S4.SS2.p4.7.m7.1.1.2.2" xref="S4.SS2.p4.7.m7.1.1.2.2.cmml">D</mi><mi id="S4.SS2.p4.7.m7.1.1.2.3" xref="S4.SS2.p4.7.m7.1.1.2.3.cmml">r</mi></msub><mo id="S4.SS2.p4.7.m7.1.1.1" xref="S4.SS2.p4.7.m7.1.1.1.cmml">≤</mo><mn id="S4.SS2.p4.7.m7.1.1.3" xref="S4.SS2.p4.7.m7.1.1.3.cmml">750</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><apply id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1"><leq id="S4.SS2.p4.7.m7.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1.1"></leq><apply id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.2.1.cmml" xref="S4.SS2.p4.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.7.m7.1.1.2.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2.2">𝐷</ci><ci id="S4.SS2.p4.7.m7.1.1.2.3.cmml" xref="S4.SS2.p4.7.m7.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S4.SS2.p4.7.m7.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3">750</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">D_{r}\leq 750</annotation></semantics></math>.
<span id="S4.SS2.p4.15.4" class="ltx_text ltx_font_smallcaps">FedAVG</span> looses its performance rapidly.
Even with <math id="S4.SS2.p4.8.m8.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS2.p4.8.m8.1a"><mn id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><cn type="integer" id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">100</annotation></semantics></math> samples per environment, <span id="S4.SS2.p4.15.5" class="ltx_text ltx_font_smallcaps">FL Games</span> algorithms lose only <math id="S4.SS2.p4.9.m9.1" class="ltx_Math" alttext="6\%" display="inline"><semantics id="S4.SS2.p4.9.m9.1a"><mrow id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml"><mn id="S4.SS2.p4.9.m9.1.1.2" xref="S4.SS2.p4.9.m9.1.1.2.cmml">6</mn><mo id="S4.SS2.p4.9.m9.1.1.1" xref="S4.SS2.p4.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.1b"><apply id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1"><csymbol cd="latexml" id="S4.SS2.p4.9.m9.1.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.9.m9.1.1.2.cmml" xref="S4.SS2.p4.9.m9.1.1.2">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.1c">6\%</annotation></semantics></math> of their performance, while <span id="S4.SS2.p4.15.6" class="ltx_text ltx_font_smallcaps">FedAVG</span> incurs more than <math id="S4.SS2.p4.10.m10.1" class="ltx_Math" alttext="15\%" display="inline"><semantics id="S4.SS2.p4.10.m10.1a"><mrow id="S4.SS2.p4.10.m10.1.1" xref="S4.SS2.p4.10.m10.1.1.cmml"><mn id="S4.SS2.p4.10.m10.1.1.2" xref="S4.SS2.p4.10.m10.1.1.2.cmml">15</mn><mo id="S4.SS2.p4.10.m10.1.1.1" xref="S4.SS2.p4.10.m10.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m10.1b"><apply id="S4.SS2.p4.10.m10.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1"><csymbol cd="latexml" id="S4.SS2.p4.10.m10.1.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.10.m10.1.1.2.cmml" xref="S4.SS2.p4.10.m10.1.1.2">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m10.1c">15\%</annotation></semantics></math> of its accuracy. <span id="S4.SS2.p4.15.7" class="ltx_text ltx_font_smallcaps">FedAVG</span> requires around <math id="S4.SS2.p4.11.m11.1" class="ltx_Math" alttext="750" display="inline"><semantics id="S4.SS2.p4.11.m11.1a"><mn id="S4.SS2.p4.11.m11.1.1" xref="S4.SS2.p4.11.m11.1.1.cmml">750</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.11.m11.1b"><cn type="integer" id="S4.SS2.p4.11.m11.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1">750</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.11.m11.1c">750</annotation></semantics></math> samples per agent to reach its best performance, that is more than <math id="S4.SS2.p4.12.m12.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S4.SS2.p4.12.m12.1a"><mrow id="S4.SS2.p4.12.m12.1.1" xref="S4.SS2.p4.12.m12.1.1.cmml"><mn id="S4.SS2.p4.12.m12.1.1.2" xref="S4.SS2.p4.12.m12.1.1.2.cmml">10</mn><mo id="S4.SS2.p4.12.m12.1.1.1" xref="S4.SS2.p4.12.m12.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.12.m12.1b"><apply id="S4.SS2.p4.12.m12.1.1.cmml" xref="S4.SS2.p4.12.m12.1.1"><csymbol cd="latexml" id="S4.SS2.p4.12.m12.1.1.1.cmml" xref="S4.SS2.p4.12.m12.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.12.m12.1.1.2.cmml" xref="S4.SS2.p4.12.m12.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.12.m12.1c">10\%</annotation></semantics></math> less than that given by <span id="S4.SS2.p4.15.8" class="ltx_text ltx_font_smallcaps">V-FL Games</span>, underscoring its weakness in OoD settings. Additionally, with <math id="S4.SS2.p4.13.m13.1" class="ltx_Math" alttext="1250" display="inline"><semantics id="S4.SS2.p4.13.m13.1a"><mn id="S4.SS2.p4.13.m13.1.1" xref="S4.SS2.p4.13.m13.1.1.cmml">1250</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.13.m13.1b"><cn type="integer" id="S4.SS2.p4.13.m13.1.1.cmml" xref="S4.SS2.p4.13.m13.1.1">1250</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.13.m13.1c">1250</annotation></semantics></math> samples per environment, the error variance of <span id="S4.SS2.p4.15.9" class="ltx_text ltx_font_smallcaps">V-FL Games</span> and <span id="S4.SS2.p4.15.10" class="ltx_text ltx_font_smallcaps">F-FL Games</span> is <math id="S4.SS2.p4.14.m14.1" class="ltx_Math" alttext="73\%" display="inline"><semantics id="S4.SS2.p4.14.m14.1a"><mrow id="S4.SS2.p4.14.m14.1.1" xref="S4.SS2.p4.14.m14.1.1.cmml"><mn id="S4.SS2.p4.14.m14.1.1.2" xref="S4.SS2.p4.14.m14.1.1.2.cmml">73</mn><mo id="S4.SS2.p4.14.m14.1.1.1" xref="S4.SS2.p4.14.m14.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.14.m14.1b"><apply id="S4.SS2.p4.14.m14.1.1.cmml" xref="S4.SS2.p4.14.m14.1.1"><csymbol cd="latexml" id="S4.SS2.p4.14.m14.1.1.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.14.m14.1.1.2.cmml" xref="S4.SS2.p4.14.m14.1.1.2">73</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.14.m14.1c">73\%</annotation></semantics></math> and <math id="S4.SS2.p4.15.m15.1" class="ltx_Math" alttext="98\%" display="inline"><semantics id="S4.SS2.p4.15.m15.1a"><mrow id="S4.SS2.p4.15.m15.1.1" xref="S4.SS2.p4.15.m15.1.1.cmml"><mn id="S4.SS2.p4.15.m15.1.1.2" xref="S4.SS2.p4.15.m15.1.1.2.cmml">98</mn><mo id="S4.SS2.p4.15.m15.1.1.1" xref="S4.SS2.p4.15.m15.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.15.m15.1b"><apply id="S4.SS2.p4.15.m15.1.1.cmml" xref="S4.SS2.p4.15.m15.1.1"><csymbol cd="latexml" id="S4.SS2.p4.15.m15.1.1.1.cmml" xref="S4.SS2.p4.15.m15.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p4.15.m15.1.1.2.cmml" xref="S4.SS2.p4.15.m15.1.1.2">98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.15.m15.1c">98\%</annotation></semantics></math> less than that of <span id="S4.SS2.p4.15.11" class="ltx_text ltx_font_smallcaps">FedAVG</span>.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.7" class="ltx_p">Finally, we vary the number of agents per environment as shown in Fig. <a href="#S4.F4.sf5" title="In Figure 4 ‣ IV-A Simulation Settings ‣ IV Simulation Results ‣ Federated Learning Games for Reconfigurable Intelligent Surfaces via Causal Representations" class="ltx_ref">4(e)</a>. For this experiment, <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="1500" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mn id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">1500</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><cn type="integer" id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">1500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">1500</annotation></semantics></math> samples from each environment are shared among all agents, so more agents having less data are involved. The achieved testing accuracies of the <span id="S4.SS2.p5.7.1" class="ltx_text ltx_font_smallcaps">FL Games</span> algorithms are still superior than the <span id="S4.SS2.p5.7.2" class="ltx_text ltx_font_smallcaps">FedAVG</span> benchmark. Surprisingly, doubling the number of collaborating RISs from <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mn id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><cn type="integer" id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">8</annotation></semantics></math> to <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mn id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><cn type="integer" id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">16</annotation></semantics></math> induces an <math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="82\%" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><mrow id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mn id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml">82</mn><mo id="S4.SS2.p5.4.m4.1.1.1" xref="S4.SS2.p5.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2">82</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">82\%</annotation></semantics></math> increase in the number of training epochs for convergence in <span id="S4.SS2.p5.7.3" class="ltx_text ltx_font_smallcaps">F-FL Games</span>. The same does not hold for <span id="S4.SS2.p5.7.4" class="ltx_text ltx_font_smallcaps">V-FL Games</span> that suffers from an <math id="S4.SS2.p5.5.m5.1" class="ltx_Math" alttext="8\%" display="inline"><semantics id="S4.SS2.p5.5.m5.1a"><mrow id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml"><mn id="S4.SS2.p5.5.m5.1.1.2" xref="S4.SS2.p5.5.m5.1.1.2.cmml">8</mn><mo id="S4.SS2.p5.5.m5.1.1.1" xref="S4.SS2.p5.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.1b"><apply id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.p5.5.m5.1.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p5.5.m5.1.1.2.cmml" xref="S4.SS2.p5.5.m5.1.1.2">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.1c">8\%</annotation></semantics></math> increase, while losing <math id="S4.SS2.p5.6.m6.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS2.p5.6.m6.1a"><mn id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><cn type="integer" id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">3</annotation></semantics></math>-<math id="S4.SS2.p5.7.m7.1" class="ltx_Math" alttext="4\%" display="inline"><semantics id="S4.SS2.p5.7.m7.1a"><mrow id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml"><mn id="S4.SS2.p5.7.m7.1.1.2" xref="S4.SS2.p5.7.m7.1.1.2.cmml">4</mn><mo id="S4.SS2.p5.7.m7.1.1.1" xref="S4.SS2.p5.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><apply id="S4.SS2.p5.7.m7.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1"><csymbol cd="latexml" id="S4.SS2.p5.7.m7.1.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p5.7.m7.1.1.2.cmml" xref="S4.SS2.p5.7.m7.1.1.2">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">4\%</annotation></semantics></math> in accuracy compared to <span id="S4.SS2.p5.7.5" class="ltx_text ltx_font_smallcaps">F-FL Games</span>. This implies that, with more agents owning fewer data, the training of a causal extractor and a predictor converges faster than training of only a predictor.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusions</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This paper proposes a distributed phase configuration control for RIS-assisted communication systems. The rate maximization problem is formulated using federated IRM as opposed to a heterogeneity-unaware ERM approach. Our novel robust RIS phase-shifts controller leverages the underlying causal representations of the data that are invariant over different environments. A neural network based feature extractor first uncovers the causal structure of the CSI data, then feeds it to another neural network based configuration predictor. Both neural networks are trained in a distributed supervised learning fashion, and the results are compared with the environment-unaware <span id="S5.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAVG</span> and an IRM-based predictor. The numerical results show that a phase predictor trained with the geometric properties of the environments demonstrated a better performance than a representation learner followed by a predictor. Moreover, the extractor-predictor network exhibits faster training convergence when using more RISs.
The extensions for multiple users and multiple antennas at Tx and Rx are left for future works.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
C. Huang, A. Zappone, G. C. Alexandropoulos, M. Debbah, and C. Yuen,
“Reconfigurable intelligent surfaces for energy efficiency in wireless
communication,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on wireless communications</em>,
vol. 18, no. 8, pp. 4157–4170, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. D. Renzo, M. Debbah, D.-T. Phan-Huy, A. Zappone, M.-S. Alouini, C. Yuen,
V. Sciancalepore, G. C. Alexandropoulos, J. Hoydis <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Smart
radio environments empowered by reconfigurable ai meta-surfaces: An idea
whose time has come,” <em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic">EURASIP Journal on Wireless Communications and
Networking</em>, vol. 2019, no. 1, pp. 1–20, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Ö. Özdoğan and E. Björnson, “Deep learning-based phase
reconfiguration for intelligent reflecting surfaces,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">2020 54th
Asilomar Conference on Signals, Systems, and Computers</em>.   IEEE, 2020, pp. 707–711.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
K. Stylianopoulos, N. Shlezinger, P. Del Hougne, and G. C. Alexandropoulos,
“Deep-learning-assisted configuration of reconfigurable intelligent surfaces
in dynamic rich-scattering environments,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">ICASSP 2022-2022 IEEE
International Conference on Acoustics, Speech and Signal Processing
(ICASSP)</em>.   IEEE, 2022, pp. 8822–8826.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
G. C. Alexandropoulos, K. Stylianopoulos, C. Huang, C. Yuen, M. Bennis, and
M. Debbah, “Pervasive machine learning for smart radio environments enabled
by reconfigurable intelligent surfaces,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>,
vol. 110, no. 9, pp. 1494–1525, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Park, S. Samarakoon, H. Shiri, M. K. Abdel-Aziz, T. Nishio, A. Elgabli, and
M. Bennis, “Extreme ultra-reliable and low-latency communication,”
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Nature Electronics</em>, vol. 5, no. 3, pp. 133–141, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
G. C. Alexandropoulos, S. Samarakoon, M. Bennis, and M. Debbah, “Phase
configuration learning in wireless networks with multiple reconfigurable
intelligent surfaces,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">2020 IEEE Globecom Workshops (GC
Wkshps</em>.   IEEE, 2020, pp. 1–6.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
C. B. Issaid, S. Samarakoon, M. Bennis, and H. V. Poor, “Federated
distributionally robust optimization for phase configuration of riss,” in
<em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">2021 IEEE Global Communications Conference (GLOBECOM)</em>.   IEEE, 2021, pp. 1–6.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Deng, M. M. Kamani, and M. Mahdavi, “Distributionally robust federated
averaging,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
vol. 33, pp. 15 111–15 122, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Samarakoon, J. Park, and M. Bennis, “Robust reconfigurable intelligent
surfaces via invariant risk and causal representations,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">2021 IEEE
22nd International Workshop on Signal Processing Advances in Wireless
Communications (SPAWC)</em>, 2021, pp. 301–305.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
M. Arjovsky, L. Bottou, I. Gulrajani, and D. Lopez-Paz, “Invariant risk
minimization,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.02893</em>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
K. Ahuja, K. Shanmugam, K. Varshney, and A. Dhurandhar, “Invariant risk
minimization games,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine
Learning</em>.   PMLR, 2020, pp. 145–155.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
S. Gupta, K. Ahuja, M. Havaei, N. Chatterjee, and Y. Bengio, “Fl games: A
federated learning framework for distribution shifts,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2205.11101</em>, 2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
E. Björnson and L. Sanguinetti, “Rayleigh fading modeling and channel
hardening for reconfigurable intelligent surfaces,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE Wireless
Communications Letters</em>, vol. 10, no. 4, pp. 830–834, 2020.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2306.01305" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2306.01306" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2306.01306">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2306.01306" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2306.01307" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 01:59:41 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
