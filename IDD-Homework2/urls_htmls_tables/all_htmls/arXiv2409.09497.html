<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation</title>
<!--Generated on Sat Sep 14 17:46:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.09497v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S1" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S2" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S2.SS0.SSS0.Px1" title="In 2 Related works ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Semantic segmentation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S2.SS0.SSS0.Px2" title="In 2 Related works ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Explainable artificial intelligence.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S2.SS0.SSS0.Px3" title="In 2 Related works ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Interpretable semantic segmentation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S2.SS0.SSS0.Px4" title="In 2 Related works ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Prototypes and semantic segmentation.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS1" title="In 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Multi-scale prototype learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS2" title="In 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Prototype grouping</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS3" title="In 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Multi-stage training procedure</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS3.SSS0.Px1" title="In 3.3 Multi-stage training procedure ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Stage 1: Multi-scale prototype learning.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS3.SSS0.Px2" title="In 3.3 Multi-stage training procedure ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Stage 2: Prototype grouping mechanism.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS1" title="In 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2" title="In 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Results and discussion</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2.SSS0.Px1" title="In 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Method Performance.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2.SSS0.Px2" title="In 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Multi-Scale prototypes analysis.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2.SSS0.Px3" title="In 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Quantitative analysis of interpretability.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2.SSS0.Px4" title="In 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title">Qualitative analysis of grouping mechanism interpretability.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S5" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S6" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Details on experimental set-up</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S7" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Transferability of ScaleProtoSeg</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S8" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Extension to large dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S9" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Sparsity Regularization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S10" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">10 </span>Group Overlap</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S11" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">11 </span>Multi-scale prototype analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S12" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">12 </span>Sparsity and Computation Overhead</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S13" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">13 </span>Group Representations and Assignments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S14" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">14 </span>Nearest Image Patches to Prototypes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S15" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">15 </span>Nearest Prototypes to Image Patches</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S16" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">16 </span>Semantic meaning of groups</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S17" title="In Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17 </span>Failure case analysis</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hugo Porta<sup class="ltx_sup" id="id1.1.id1">1</sup>     Emanuele Dalsasso<sup class="ltx_sup" id="id2.2.id2">1</sup>     Diego Marcos<sup class="ltx_sup" id="id3.3.id3">2,3</sup>     Devis Tuia<sup class="ltx_sup" id="id4.4.id4">1</sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id5.5.id5">1</sup>EPFL     <sup class="ltx_sup" id="id6.6.id6">2</sup>Inria     <sup class="ltx_sup" id="id7.7.id7">3</sup>Université Montpellier
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id8.8.id8" style="font-size:90%;">{hugo.porta, emanuele.dalsasso, devis.tuia}@epfl.ch 
<br class="ltx_break"/>diego.marcos@inria.fr
</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id9.id1">Prototypical part learning is emerging as a promising approach for making semantic segmentation interpretable. The model selects real patches seen during training as prototypes and constructs the dense prediction map based on the similarity between parts of the test image and the prototypes. This improves interpretability since the user can inspect the link between the predicted output and the patterns learned by the model in terms of prototypical information. In this paper, we propose a method for interpretable semantic segmentation that leverages multi-scale image representation for prototypical part learning. First, we introduce a prototype layer that explicitly learns diverse prototypical parts at several scales, leading to multi-scale representations in the prototype activation output. Then, we propose a sparse grouping mechanism that produces multi-scale sparse groups of these scale-specific prototypical parts. This provides a deeper understanding of the interactions between multi-scale object representations while enhancing the interpretability of the segmentation model. The experiments conducted on Pascal VOC, Cityscapes, and ADE20K demonstrate that the proposed method increases model sparsity, improves interpretability over existing prototype-based methods, and narrows the performance gap with the non-interpretable counterpart models. Code is available at <a class="ltx_ref ltx_href" href="https://github.com/eceo-epfl/ScaleProtoSeg" title="">github.com/eceo-epfl/ScaleProtoSeg</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="264" id="S1.F1.g1" src="x1.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">ScaleProtoSeg learns scale-specific prototypes at multiple scales and a sparse prototype grouping to extract patterns referring to different levels of details or scales.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In the last few years, deep learning-based semantic segmentation has seen rapid adoption in numerous fields, from industrial use cases such as autonomous driving <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib74" title="">74</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib81" title="">81</a>]</cite> to the environmental sciences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib48" title="">48</a>]</cite>. This expansion was driven by its increasing performance on a multitude of tasks and benchmarks, often coinciding with an increase in model complexity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib89" title="">89</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib86" title="">86</a>]</cite>.
This favors un-interpretable black-box models, to the detriment of their explainability.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The models’ lack of interpretability is particularly harmful in high-stakes applications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib68" title="">68</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib82" title="">82</a>]</cite> and sometimes prevents the wider adoption of deep learning models in applied fields involving high-stakes decision making <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib76" title="">76</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib26" title="">26</a>]</cite>. Indeed, deep learning models can rely on spurious cues, such as Clever-Hans predictors, often symptoms of data contamination <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib2" title="">2</a>]</cite>. This is detrimental in real use cases due to the potential lack of generalization and opaqueness of the decision process. Issues in the generalization of deep learning models are also illustrated by adversarial examples, which can be engineered via small, imperceptible perturbations of images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib47" title="">47</a>]</cite> or be inherent in natural images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib34" title="">34</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The field of eXplainable Artificial Intelligence (XAI) aims at alleviating the risks associated with the lack of model interpretability by presenting some aspects of the models’ decision process into a form understandable to humans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib20" title="">20</a>]</cite>. To produce explainable results, the model design often requires some simplifications that reduce the performance of the original, more complex black-box counterpart <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib53" title="">53</a>]</cite>. Most methods focus on classification and regression tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib72" title="">72</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib3" title="">3</a>]</cite>, including prototype-based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>]</cite>. A few works aim at making semantic segmentation models interpretable <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib83" title="">83</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib71" title="">71</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib35" title="">35</a>]</cite>. However, no approach considers questions about the relationship between prototypes across semantic classes and scales, despite instances of objects appearing at different positions in the image or at multiple range of distances. Accounting for these redundancies allows for learning more diverse prototypes for a given object across scales, in turn leading to more explicit interpretability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib57" title="">57</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we tackle these gaps and propose a method for multi-scale interpretable semantic segmentation, ScaleProtoSeg (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>), that <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">(i)</span> explicitly learns prototypes at several scales and <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">(ii)</span> groups the scale-specific prototypes thanks to a sparse grouping mechanism that provides information on the interaction between prototypical parts at multiple scales, while reducing the number of active prototypes contributing to the decision. Multi-scale prototype learning disentangles the information at different scales so that the model and the users have access to different levels of contextual information in the interpretable decision process. The sparse grouping mechanism allows a transparent understanding of the interaction of scale-specific representations such as object details and parts or similar parts at multi-scale (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>), while maintaining parts correspondences via regularization, avoiding altogether prototype pruning. We are the first to jointly leverage multi-scale representation and prototype learning in an interpretable semantic segmentation model.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We test our methods on three semantic segmentation benchmarks: Pascal VOC 2012 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib21" title="">21</a>]</cite>, Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib14" title="">14</a>]</cite>, and ADE20K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib100" title="">100</a>]</cite>, by considering DeepLabv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite> as our base model architecture. We first show that multi-scale prototype learning improves the performance of single-scale prototype-based interpretable semantic segmentation methods (with similar amounts of prototypes) across all considered benchmarks. Moreover, thanks to the sparse grouping mechanism, we demonstrate that constraining the decision process to a small group of prototypes per class enforces interpretability while retaining competitive performance. The contributions of our paper can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">we propose a multi-scale prototype layer that enforces the model to focus on the prototypical parts’ representations at multiple scales;</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">we define a grouping procedure that learns sparse combinations of the scale-specific prototypes across all scales and increases the interpretability of the decision process;</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">not only we show the superiority of our ScaleProtoSeg method in three popular datasets in semantic segmentation over the prototype-based method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>, but also highlight its improved interpretability measured in terms of <span class="ltx_text ltx_font_italic" id="S1.I1.i3.p1.1.1">stability</span>, <span class="ltx_text ltx_font_italic" id="S1.I1.i3.p1.1.2">consistency</span> and <span class="ltx_text ltx_font_italic" id="S1.I1.i3.p1.1.3">sparsity</span>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related works</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Semantic segmentation.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Fully Convolutional Networks (FCN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib55" title="">55</a>]</cite> are widely used in semantic segmentation methods. They are based on an encoder-decoder architecture, where the encoder extracts discriminative features from the input image and the decoder converts the learned semantic representation into per-pixel predictions. Following FCN, researchers focused on improving different aspects of the semantic segmentation methods such as enlarging the model receptive field while limiting the parameters increase  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib94" title="">94</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib96" title="">96</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib10" title="">10</a>]</cite>, specifying boundary information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib78" title="">78</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib93" title="">93</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib17" title="">17</a>]</cite>, or providing contextual information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib95" title="">95</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib32" title="">32</a>]</cite>. Some methods proposed specific modules learning pixel affinities or attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib97" title="">97</a>]</cite> to allow the network to base its prediction also on similar pixels that do not lie in the direct vicinity of the pixel at hand.
Furthermore, there has been a growing interest in how multi-scale information could be extracted. A common pattern in decoder architectures is the concatenation of scale-specific feature maps at multiple scales <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib89" title="">89</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib67" title="">67</a>]</cite>. For instance, Chen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite> introduce atrous spatial pyramid pooling (ASPP) to learn in parallel a multi-scale representation from a single-scale feature map. We focus on providing an interpretable version of this model relying on its widely employed decoder multi-scale architecture.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Explainable artificial intelligence.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">XAI methods can be split into <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.1">post-hoc</span> vs <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.2">by-design</span> approaches. Post-hoc methods aim to explain black-box models after training by using an auxiliary method to generate explanations, while by-design approaches enforce interpretability in the model itself. Our proposed method falls into the latter category. Some examples of interpretable by-design approaches are concept bottleneck models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib57" title="">57</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib62" title="">62</a>]</cite>; attention modules <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib99" title="">99</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib98" title="">98</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib66" title="">66</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib73" title="">73</a>]</cite> which point to critical parts of each input sample; generalized additive models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib3" title="">3</a>]</cite>; and prototype learning introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib51" title="">51</a>]</cite>, where part of an encoded input image is compared to a set of class-specific prototypes, represented by training samples. Several extensions followed the original paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>]</cite>, aiming at enforcing orthogonality in the prototype construction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib84" title="">84</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib19" title="">19</a>]</cite>, reducing the number of prototypes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib69" title="">69</a>]</cite>, or even leveraging label taxonomy via a hierarchical structure <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib30" title="">30</a>]</cite>. Prototype learning can be extended to other tasks beyond image classification such as sequence learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib60" title="">60</a>]</cite> and time series analysis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib25" title="">25</a>]</cite> and, most recently, semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>. In this work, we rely on prototype learning for interpretable semantic segmentation.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Interpretable semantic segmentation.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Among the few existing methods tackling this problem, post-hoc approaches extending Grad-CAM to semantic segmentation have been explored <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib83" title="">83</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib35" title="">35</a>]</cite>. By-design approaches can provide explainable results by leveraging symbolic language <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib71" title="">71</a>]</cite>, through the use of a semantic bottleneck <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib56" title="">56</a>]</cite> or by exploiting the attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib28" title="">28</a>]</cite>. Prototypical parts learning was proposed recently in ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> for interpretable semantic segmentation, extending the classification-based method proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>]</cite>. In this work, we aim to investigate multi-scale prototype learning to break the performance/interpretability trade-off present in ProtoSeg. This is achieved by explicitly leveraging the multi-scale nature of semantic segmentation representations (via scale-specific prototypes) and by encouraging sparsity (via sparse grouping across prototypes and scales).</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Prototypes and semantic segmentation.</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px4.p1.1">Prototype learning based on parametric or non-parametric prototypes has seen an increase of interest in image classification <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib92" title="">92</a>]</cite>, few-shot and zero-shot <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib75" title="">75</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib90" title="">90</a>]</cite>, unsupervised <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib88" title="">88</a>]</cite> and self-supervised learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib50" title="">50</a>]</cite>. For semantic segmentation, parametric prototypes are used to represent unique class embeddings, both in an explicit <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib77" title="">77</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib12" title="">12</a>]</cite> or implicit way <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib101" title="">101</a>]</cite>. Non-parametric prototypes were also leveraged, first in the few-shot learning context <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib85" title="">85</a>]</cite> and then in more classic semantic segmentation models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib87" title="">87</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib101" title="">101</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib39" title="">39</a>]</cite>.
The methods in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib87" title="">87</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib101" title="">101</a>]</cite> are the closest to our proposition: both compute multiple class-specific prototypes via online clustering and leverage metric learning losses to enforce a compact embedding space. The pixel-wise classification is then performed via nearest-prototype assignment. Despite those similarities, those works compute prototypes in the final embedding space, while we focus on enhanced interpretability via i) prototypical parts through specific regularization and ii) multi-scale object representation. These core differences limit the applicability of direct performance comparisons. Finally, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib80" title="">80</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib79" title="">79</a>]</cite> leverage non-parametric prototypes for modality and domain alignment for multi-modal semantic segmentation (e.g. video and point clouds), but do not explore issues related to interpretability or multi-scale prototype learning as our proposed method.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we present our multi-scale grouped prototypes method for interpretable semantic segmentation: ScaleProtoSeg (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>). We first introduce the multi-scale prototype architecture (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS1" title="3.1 Multi-scale prototype learning ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.1</span></a>). Then we describe the proposed grouping mechanism to extract sparse groups of prototypes across scales (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS2" title="3.2 Prototype grouping ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.2</span></a>). Lastly, we detail the multi-stage training procedure used to learn both prototypes and groups (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS3" title="3.3 Multi-stage training procedure ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="291" id="S3.F2.sf1.g1" src="x2.png" width="951"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.sf1.3.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text ltx_font_bold" id="S3.F2.sf1.4.2" style="font-size:90%;">Stage 1:<span class="ltx_text ltx_font_medium" id="S3.F2.sf1.4.2.1"> Multi-scale prototype learning.</span></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="264" id="S3.F2.sf2.g1" src="x3.png" width="951"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.sf2.3.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text ltx_font_bold" id="S3.F2.sf2.4.2" style="font-size:90%;">Stage 2:<span class="ltx_text ltx_font_medium" id="S3.F2.sf2.4.2.1"> Prototype grouping.</span></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.6.3.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.4.2" style="font-size:90%;">Overall architecture of ScaleProtoSeg. Each color in the feature maps and following layers corresponds to a specific scale (<math alttext="S=4" class="ltx_Math" display="inline" id="S3.F2.3.1.m1.1"><semantics id="S3.F2.3.1.m1.1b"><mrow id="S3.F2.3.1.m1.1.1" xref="S3.F2.3.1.m1.1.1.cmml"><mi id="S3.F2.3.1.m1.1.1.2" xref="S3.F2.3.1.m1.1.1.2.cmml">S</mi><mo id="S3.F2.3.1.m1.1.1.1" xref="S3.F2.3.1.m1.1.1.1.cmml">=</mo><mn id="S3.F2.3.1.m1.1.1.3" xref="S3.F2.3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.3.1.m1.1c"><apply id="S3.F2.3.1.m1.1.1.cmml" xref="S3.F2.3.1.m1.1.1"><eq id="S3.F2.3.1.m1.1.1.1.cmml" xref="S3.F2.3.1.m1.1.1.1"></eq><ci id="S3.F2.3.1.m1.1.1.2.cmml" xref="S3.F2.3.1.m1.1.1.2">𝑆</ci><cn id="S3.F2.3.1.m1.1.1.3.cmml" type="integer" xref="S3.F2.3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">S=4</annotation><annotation encoding="application/x-llamapun" id="S3.F2.3.1.m1.1e">italic_S = 4</annotation></semantics></math> and <math alttext="M=3" class="ltx_Math" display="inline" id="S3.F2.4.2.m2.1"><semantics id="S3.F2.4.2.m2.1b"><mrow id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml"><mi id="S3.F2.4.2.m2.1.1.2" xref="S3.F2.4.2.m2.1.1.2.cmml">M</mi><mo id="S3.F2.4.2.m2.1.1.1" xref="S3.F2.4.2.m2.1.1.1.cmml">=</mo><mn id="S3.F2.4.2.m2.1.1.3" xref="S3.F2.4.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.1c"><apply id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1"><eq id="S3.F2.4.2.m2.1.1.1.cmml" xref="S3.F2.4.2.m2.1.1.1"></eq><ci id="S3.F2.4.2.m2.1.1.2.cmml" xref="S3.F2.4.2.m2.1.1.2">𝑀</ci><cn id="S3.F2.4.2.m2.1.1.3.cmml" type="integer" xref="S3.F2.4.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.2.m2.1d">M=3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.4.2.m2.1e">italic_M = 3</annotation></semantics></math> in this illustration).</span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Multi-scale prototype learning</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.19">Our model architecture for multi-scale prototype learning is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>: <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.19.1">Stage 1</span>. It is composed of a backbone network <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_f</annotation></semantics></math>, a multi-scale prototype layer <math alttext="g_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">g</mi><mtext id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑔</ci><ci id="S3.SS1.p1.2.m2.1.1.3a.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><mtext id="S3.SS1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.2.m2.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">g_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math>, and a linear layer <math alttext="h_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">h</mi><mtext id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">ℎ</ci><ci id="S3.SS1.p1.3.m3.1.1.3a.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><mtext id="S3.SS1.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.3.m3.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">h_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math>. For an input RGB image <math alttext="\mathbf{x}\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝐱</mi><mo id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.3.2" xref="S3.SS1.p1.4.m4.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.4.m4.1.1.3.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p1.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p1.4.m4.1.1.3.3.4" xref="S3.SS1.p1.4.m4.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><in id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"></in><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝐱</ci><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3"><times id="S3.SS1.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3.3">𝑊</ci><cn id="S3.SS1.p1.4.m4.1.1.3.3.4.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathbf{x}\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_f</annotation></semantics></math> outputs a multi-scale feature map <math alttext="f(\mathbf{x})\in\mathbb{R}^{H_{r}\times W_{r}\times S\times d}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.2" xref="S3.SS1.p1.6.m6.1.2.cmml"><mrow id="S3.SS1.p1.6.m6.1.2.2" xref="S3.SS1.p1.6.m6.1.2.2.cmml"><mi id="S3.SS1.p1.6.m6.1.2.2.2" xref="S3.SS1.p1.6.m6.1.2.2.2.cmml">f</mi><mo id="S3.SS1.p1.6.m6.1.2.2.1" xref="S3.SS1.p1.6.m6.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.6.m6.1.2.2.3.2" xref="S3.SS1.p1.6.m6.1.2.2.cmml"><mo id="S3.SS1.p1.6.m6.1.2.2.3.2.1" stretchy="false" xref="S3.SS1.p1.6.m6.1.2.2.cmml">(</mo><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.6.m6.1.2.2.3.2.2" stretchy="false" xref="S3.SS1.p1.6.m6.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.6.m6.1.2.1" xref="S3.SS1.p1.6.m6.1.2.1.cmml">∈</mo><msup id="S3.SS1.p1.6.m6.1.2.3" xref="S3.SS1.p1.6.m6.1.2.3.cmml"><mi id="S3.SS1.p1.6.m6.1.2.3.2" xref="S3.SS1.p1.6.m6.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.6.m6.1.2.3.3" xref="S3.SS1.p1.6.m6.1.2.3.3.cmml"><msub id="S3.SS1.p1.6.m6.1.2.3.3.2" xref="S3.SS1.p1.6.m6.1.2.3.3.2.cmml"><mi id="S3.SS1.p1.6.m6.1.2.3.3.2.2" xref="S3.SS1.p1.6.m6.1.2.3.3.2.2.cmml">H</mi><mi id="S3.SS1.p1.6.m6.1.2.3.3.2.3" xref="S3.SS1.p1.6.m6.1.2.3.3.2.3.cmml">r</mi></msub><mo id="S3.SS1.p1.6.m6.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.6.m6.1.2.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.6.m6.1.2.3.3.3" xref="S3.SS1.p1.6.m6.1.2.3.3.3.cmml"><mi id="S3.SS1.p1.6.m6.1.2.3.3.3.2" xref="S3.SS1.p1.6.m6.1.2.3.3.3.2.cmml">W</mi><mi id="S3.SS1.p1.6.m6.1.2.3.3.3.3" xref="S3.SS1.p1.6.m6.1.2.3.3.3.3.cmml">r</mi></msub><mo id="S3.SS1.p1.6.m6.1.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.6.m6.1.2.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.6.m6.1.2.3.3.4" xref="S3.SS1.p1.6.m6.1.2.3.3.4.cmml">S</mi><mo id="S3.SS1.p1.6.m6.1.2.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.6.m6.1.2.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.6.m6.1.2.3.3.5" xref="S3.SS1.p1.6.m6.1.2.3.3.5.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><in id="S3.SS1.p1.6.m6.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.1"></in><apply id="S3.SS1.p1.6.m6.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2"><times id="S3.SS1.p1.6.m6.1.2.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.2.1"></times><ci id="S3.SS1.p1.6.m6.1.2.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2.2">𝑓</ci><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝐱</ci></apply><apply id="S3.SS1.p1.6.m6.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.3.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.3.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2">ℝ</ci><apply id="S3.SS1.p1.6.m6.1.2.3.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3"><times id="S3.SS1.p1.6.m6.1.2.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.1"></times><apply id="S3.SS1.p1.6.m6.1.2.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.3.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.3.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.2.2">𝐻</ci><ci id="S3.SS1.p1.6.m6.1.2.3.3.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.2.3">𝑟</ci></apply><apply id="S3.SS1.p1.6.m6.1.2.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.3.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.3.2">𝑊</ci><ci id="S3.SS1.p1.6.m6.1.2.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.3.3">𝑟</ci></apply><ci id="S3.SS1.p1.6.m6.1.2.3.3.4.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.4">𝑆</ci><ci id="S3.SS1.p1.6.m6.1.2.3.3.5.cmml" xref="S3.SS1.p1.6.m6.1.2.3.3.5">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">f(\mathbf{x})\in\mathbb{R}^{H_{r}\times W_{r}\times S\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_f ( bold_x ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_S × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, representing scale-specific features at <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_S</annotation></semantics></math> scales, each one with <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_d</annotation></semantics></math> dimensions. The scalar <math alttext="r" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_r</annotation></semantics></math> is a size reduction factor. In practice, we modify the ASPP layer from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite> to concatenate the scale-specific feature maps instead of summing them. At each scale <math alttext="s\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">s</mi><mo id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><in id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1"></in><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑠</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">s\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_s ∈ caligraphic_S</annotation></semantics></math>, let <math alttext="\mathbf{z}_{s}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><msub id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS1.p1.11.m11.1.1.2.3" xref="S3.SS1.p1.11.m11.1.1.2.3.cmml">s</mi></msub><mo id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.11.m11.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><in id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"></in><apply id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.2">𝐳</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3">𝑠</ci></apply><apply id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.11.m11.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\mathbf{z}_{s}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> be a vector from the scale-specific feature map <math alttext="f_{s}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.2" xref="S3.SS1.p1.12.m12.1.2.cmml"><msub id="S3.SS1.p1.12.m12.1.2.2" xref="S3.SS1.p1.12.m12.1.2.2.cmml"><mi id="S3.SS1.p1.12.m12.1.2.2.2" xref="S3.SS1.p1.12.m12.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p1.12.m12.1.2.2.3" xref="S3.SS1.p1.12.m12.1.2.2.3.cmml">s</mi></msub><mo id="S3.SS1.p1.12.m12.1.2.1" xref="S3.SS1.p1.12.m12.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.12.m12.1.2.3.2" xref="S3.SS1.p1.12.m12.1.2.cmml"><mo id="S3.SS1.p1.12.m12.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.12.m12.1.2.cmml">(</mo><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.12.m12.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.2.cmml" xref="S3.SS1.p1.12.m12.1.2"><times id="S3.SS1.p1.12.m12.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2.1"></times><apply id="S3.SS1.p1.12.m12.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.2.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.2.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.2.2">𝑓</ci><ci id="S3.SS1.p1.12.m12.1.2.2.3.cmml" xref="S3.SS1.p1.12.m12.1.2.2.3">𝑠</ci></apply><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">f_{s}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math>. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>, this vector represents the features extracted from an area of the input image corresponding to the receptive field at scale <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_s</annotation></semantics></math>. The multi-scale prototype layer <math alttext="g_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><msub id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">g</mi><mtext id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">𝑔</ci><ci id="S3.SS1.p1.14.m14.1.1.3a.cmml" xref="S3.SS1.p1.14.m14.1.1.3"><mtext id="S3.SS1.p1.14.m14.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.14.m14.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">g_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math> is composed of <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><mi id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><ci id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_M</annotation></semantics></math> learnable scale-dependent prototypes, where the <math alttext="\operatorname*{m}_{\text{th}}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><msub id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml"><mo id="S3.SS1.p1.16.m16.1.1.2" xref="S3.SS1.p1.16.m16.1.1.2.cmml">m</mo><mtext id="S3.SS1.p1.16.m16.1.1.3" xref="S3.SS1.p1.16.m16.1.1.3a.cmml">th</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><apply id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.2">m</ci><ci id="S3.SS1.p1.16.m16.1.1.3a.cmml" xref="S3.SS1.p1.16.m16.1.1.3"><mtext id="S3.SS1.p1.16.m16.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.16.m16.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">\operatorname*{m}_{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">roman_m start_POSTSUBSCRIPT th end_POSTSUBSCRIPT</annotation></semantics></math> scale-dependent prototype (with <math alttext="\operatorname*{m}\in[1,\dots,M]" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m17.3"><semantics id="S3.SS1.p1.17.m17.3a"><mrow id="S3.SS1.p1.17.m17.3.4" xref="S3.SS1.p1.17.m17.3.4.cmml"><mo id="S3.SS1.p1.17.m17.3.4.2" rspace="0.1389em" xref="S3.SS1.p1.17.m17.3.4.2.cmml">m</mo><mo id="S3.SS1.p1.17.m17.3.4.1" lspace="0.1389em" xref="S3.SS1.p1.17.m17.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p1.17.m17.3.4.3.2" xref="S3.SS1.p1.17.m17.3.4.3.1.cmml"><mo id="S3.SS1.p1.17.m17.3.4.3.2.1" stretchy="false" xref="S3.SS1.p1.17.m17.3.4.3.1.cmml">[</mo><mn id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml">1</mn><mo id="S3.SS1.p1.17.m17.3.4.3.2.2" xref="S3.SS1.p1.17.m17.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.17.m17.2.2" mathvariant="normal" xref="S3.SS1.p1.17.m17.2.2.cmml">…</mi><mo id="S3.SS1.p1.17.m17.3.4.3.2.3" xref="S3.SS1.p1.17.m17.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.17.m17.3.3" xref="S3.SS1.p1.17.m17.3.3.cmml">M</mi><mo id="S3.SS1.p1.17.m17.3.4.3.2.4" stretchy="false" xref="S3.SS1.p1.17.m17.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.3b"><apply id="S3.SS1.p1.17.m17.3.4.cmml" xref="S3.SS1.p1.17.m17.3.4"><in id="S3.SS1.p1.17.m17.3.4.1.cmml" xref="S3.SS1.p1.17.m17.3.4.1"></in><ci id="S3.SS1.p1.17.m17.3.4.2.cmml" xref="S3.SS1.p1.17.m17.3.4.2">m</ci><list id="S3.SS1.p1.17.m17.3.4.3.1.cmml" xref="S3.SS1.p1.17.m17.3.4.3.2"><cn id="S3.SS1.p1.17.m17.1.1.cmml" type="integer" xref="S3.SS1.p1.17.m17.1.1">1</cn><ci id="S3.SS1.p1.17.m17.2.2.cmml" xref="S3.SS1.p1.17.m17.2.2">…</ci><ci id="S3.SS1.p1.17.m17.3.3.cmml" xref="S3.SS1.p1.17.m17.3.3">𝑀</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.3c">\operatorname*{m}\in[1,\dots,M]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m17.3d">roman_m ∈ [ 1 , … , italic_M ]</annotation></semantics></math>) is described by the vector <math alttext="\mathbf{p}_{s,\operatorname*{m}}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m18.2"><semantics id="S3.SS1.p1.18.m18.2a"><mrow id="S3.SS1.p1.18.m18.2.3" xref="S3.SS1.p1.18.m18.2.3.cmml"><msub id="S3.SS1.p1.18.m18.2.3.2" xref="S3.SS1.p1.18.m18.2.3.2.cmml"><mi id="S3.SS1.p1.18.m18.2.3.2.2" xref="S3.SS1.p1.18.m18.2.3.2.2.cmml">𝐩</mi><mrow id="S3.SS1.p1.18.m18.2.2.2.4" xref="S3.SS1.p1.18.m18.2.2.2.3.cmml"><mi id="S3.SS1.p1.18.m18.1.1.1.1" xref="S3.SS1.p1.18.m18.1.1.1.1.cmml">s</mi><mo id="S3.SS1.p1.18.m18.2.2.2.4.1" xref="S3.SS1.p1.18.m18.2.2.2.3.cmml">,</mo><mo id="S3.SS1.p1.18.m18.2.2.2.2" lspace="0em" xref="S3.SS1.p1.18.m18.2.2.2.2.cmml">m</mo></mrow></msub><mo id="S3.SS1.p1.18.m18.2.3.1" xref="S3.SS1.p1.18.m18.2.3.1.cmml">∈</mo><msup id="S3.SS1.p1.18.m18.2.3.3" xref="S3.SS1.p1.18.m18.2.3.3.cmml"><mi id="S3.SS1.p1.18.m18.2.3.3.2" xref="S3.SS1.p1.18.m18.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.18.m18.2.3.3.3" xref="S3.SS1.p1.18.m18.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.2b"><apply id="S3.SS1.p1.18.m18.2.3.cmml" xref="S3.SS1.p1.18.m18.2.3"><in id="S3.SS1.p1.18.m18.2.3.1.cmml" xref="S3.SS1.p1.18.m18.2.3.1"></in><apply id="S3.SS1.p1.18.m18.2.3.2.cmml" xref="S3.SS1.p1.18.m18.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.2.3.2.1.cmml" xref="S3.SS1.p1.18.m18.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.18.m18.2.3.2.2.cmml" xref="S3.SS1.p1.18.m18.2.3.2.2">𝐩</ci><list id="S3.SS1.p1.18.m18.2.2.2.3.cmml" xref="S3.SS1.p1.18.m18.2.2.2.4"><ci id="S3.SS1.p1.18.m18.1.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1">𝑠</ci><ci id="S3.SS1.p1.18.m18.2.2.2.2.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2">m</ci></list></apply><apply id="S3.SS1.p1.18.m18.2.3.3.cmml" xref="S3.SS1.p1.18.m18.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.2.3.3.1.cmml" xref="S3.SS1.p1.18.m18.2.3.3">superscript</csymbol><ci id="S3.SS1.p1.18.m18.2.3.3.2.cmml" xref="S3.SS1.p1.18.m18.2.3.3.2">ℝ</ci><ci id="S3.SS1.p1.18.m18.2.3.3.3.cmml" xref="S3.SS1.p1.18.m18.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.2c">\mathbf{p}_{s,\operatorname*{m}}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.18.m18.2d">bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, which is randomly initialized and learned through gradient descent. For each feature vector <math alttext="\mathbf{z}_{s}" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m19.1"><semantics id="S3.SS1.p1.19.m19.1a"><msub id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml"><mi id="S3.SS1.p1.19.m19.1.1.2" xref="S3.SS1.p1.19.m19.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.p1.19.m19.1.1.3" xref="S3.SS1.p1.19.m19.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><apply id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.1.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">subscript</csymbol><ci id="S3.SS1.p1.19.m19.1.1.2.cmml" xref="S3.SS1.p1.19.m19.1.1.2">𝐳</ci><ci id="S3.SS1.p1.19.m19.1.1.3.cmml" xref="S3.SS1.p1.19.m19.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">\mathbf{z}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.19.m19.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, the prototypes’ activations are computed following ProtoPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>]</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g_{\text{proto}}(\mathbf{z}_{s},\mathbf{p}_{s,\operatorname*{m}})=\log\left(%
\frac{\|\mathbf{z}_{s}-\mathbf{p}_{s,\operatorname*{m}}\|_{2}^{2}+1}{\|\mathbf%
{z}_{s}-\mathbf{p}_{s,\operatorname*{m}}\|_{2}^{2}+\epsilon}\right)" class="ltx_Math" display="block" id="S3.E1.m1.11"><semantics id="S3.E1.m1.11a"><mrow id="S3.E1.m1.11.11" xref="S3.E1.m1.11.11.cmml"><mrow id="S3.E1.m1.11.11.2" xref="S3.E1.m1.11.11.2.cmml"><msub id="S3.E1.m1.11.11.2.4" xref="S3.E1.m1.11.11.2.4.cmml"><mi id="S3.E1.m1.11.11.2.4.2" xref="S3.E1.m1.11.11.2.4.2.cmml">g</mi><mtext id="S3.E1.m1.11.11.2.4.3" xref="S3.E1.m1.11.11.2.4.3a.cmml">proto</mtext></msub><mo id="S3.E1.m1.11.11.2.3" xref="S3.E1.m1.11.11.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.11.11.2.2.2" xref="S3.E1.m1.11.11.2.2.3.cmml"><mo id="S3.E1.m1.11.11.2.2.2.3" stretchy="false" xref="S3.E1.m1.11.11.2.2.3.cmml">(</mo><msub id="S3.E1.m1.10.10.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.cmml"><mi id="S3.E1.m1.10.10.1.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E1.m1.10.10.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E1.m1.11.11.2.2.2.4" xref="S3.E1.m1.11.11.2.2.3.cmml">,</mo><msub id="S3.E1.m1.11.11.2.2.2.2" xref="S3.E1.m1.11.11.2.2.2.2.cmml"><mi id="S3.E1.m1.11.11.2.2.2.2.2" xref="S3.E1.m1.11.11.2.2.2.2.2.cmml">𝐩</mi><mrow id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">s</mi><mo id="S3.E1.m1.2.2.2.4.1" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mo id="S3.E1.m1.2.2.2.2" lspace="0em" xref="S3.E1.m1.2.2.2.2.cmml">m</mo></mrow></msub><mo id="S3.E1.m1.11.11.2.2.2.5" stretchy="false" xref="S3.E1.m1.11.11.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.11.11.3" xref="S3.E1.m1.11.11.3.cmml">=</mo><mrow id="S3.E1.m1.11.11.4.2" xref="S3.E1.m1.11.11.4.1.cmml"><mi id="S3.E1.m1.9.9" xref="S3.E1.m1.9.9.cmml">log</mi><mo id="S3.E1.m1.11.11.4.2a" xref="S3.E1.m1.11.11.4.1.cmml">⁡</mo><mrow id="S3.E1.m1.11.11.4.2.1" xref="S3.E1.m1.11.11.4.1.cmml"><mo id="S3.E1.m1.11.11.4.2.1.1" xref="S3.E1.m1.11.11.4.1.cmml">(</mo><mfrac id="S3.E1.m1.8.8" xref="S3.E1.m1.8.8.cmml"><mrow id="S3.E1.m1.5.5.3" xref="S3.E1.m1.5.5.3.cmml"><msubsup id="S3.E1.m1.5.5.3.3" xref="S3.E1.m1.5.5.3.3.cmml"><mrow id="S3.E1.m1.5.5.3.3.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.2.cmml"><mo id="S3.E1.m1.5.5.3.3.1.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.3.3.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.5.5.3.3.1.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.1.1.cmml"><msub id="S3.E1.m1.5.5.3.3.1.1.1.1.2" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2.cmml"><mi id="S3.E1.m1.5.5.3.3.1.1.1.1.2.2" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.E1.m1.5.5.3.3.1.1.1.1.2.3" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.E1.m1.5.5.3.3.1.1.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.5.5.3.3.1.1.1.1.3" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.3.3.1.1.1.1.3.2" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.2.cmml">𝐩</mi><mrow id="S3.E1.m1.4.4.2.2.2.4" xref="S3.E1.m1.4.4.2.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml">s</mi><mo id="S3.E1.m1.4.4.2.2.2.4.1" xref="S3.E1.m1.4.4.2.2.2.3.cmml">,</mo><mo id="S3.E1.m1.4.4.2.2.2.2" lspace="0em" xref="S3.E1.m1.4.4.2.2.2.2.cmml">m</mo></mrow></msub></mrow><mo id="S3.E1.m1.5.5.3.3.1.1.1.3" stretchy="false" xref="S3.E1.m1.5.5.3.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.5.5.3.3.1.3" xref="S3.E1.m1.5.5.3.3.1.3.cmml">2</mn><mn id="S3.E1.m1.5.5.3.3.3" xref="S3.E1.m1.5.5.3.3.3.cmml">2</mn></msubsup><mo id="S3.E1.m1.5.5.3.4" xref="S3.E1.m1.5.5.3.4.cmml">+</mo><mn id="S3.E1.m1.5.5.3.5" xref="S3.E1.m1.5.5.3.5.cmml">1</mn></mrow><mrow id="S3.E1.m1.8.8.6" xref="S3.E1.m1.8.8.6.cmml"><msubsup id="S3.E1.m1.8.8.6.3" xref="S3.E1.m1.8.8.6.3.cmml"><mrow id="S3.E1.m1.8.8.6.3.1.1.1" xref="S3.E1.m1.8.8.6.3.1.1.2.cmml"><mo id="S3.E1.m1.8.8.6.3.1.1.1.2" stretchy="false" xref="S3.E1.m1.8.8.6.3.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.8.8.6.3.1.1.1.1" xref="S3.E1.m1.8.8.6.3.1.1.1.1.cmml"><msub id="S3.E1.m1.8.8.6.3.1.1.1.1.2" xref="S3.E1.m1.8.8.6.3.1.1.1.1.2.cmml"><mi id="S3.E1.m1.8.8.6.3.1.1.1.1.2.2" xref="S3.E1.m1.8.8.6.3.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.E1.m1.8.8.6.3.1.1.1.1.2.3" xref="S3.E1.m1.8.8.6.3.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.E1.m1.8.8.6.3.1.1.1.1.1" xref="S3.E1.m1.8.8.6.3.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.8.8.6.3.1.1.1.1.3" xref="S3.E1.m1.8.8.6.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.8.8.6.3.1.1.1.1.3.2" xref="S3.E1.m1.8.8.6.3.1.1.1.1.3.2.cmml">𝐩</mi><mrow id="S3.E1.m1.7.7.5.2.2.4" xref="S3.E1.m1.7.7.5.2.2.3.cmml"><mi id="S3.E1.m1.6.6.4.1.1.1" xref="S3.E1.m1.6.6.4.1.1.1.cmml">s</mi><mo id="S3.E1.m1.7.7.5.2.2.4.1" xref="S3.E1.m1.7.7.5.2.2.3.cmml">,</mo><mo id="S3.E1.m1.7.7.5.2.2.2" lspace="0em" xref="S3.E1.m1.7.7.5.2.2.2.cmml">m</mo></mrow></msub></mrow><mo id="S3.E1.m1.8.8.6.3.1.1.1.3" stretchy="false" xref="S3.E1.m1.8.8.6.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.8.8.6.3.1.3" xref="S3.E1.m1.8.8.6.3.1.3.cmml">2</mn><mn id="S3.E1.m1.8.8.6.3.3" xref="S3.E1.m1.8.8.6.3.3.cmml">2</mn></msubsup><mo id="S3.E1.m1.8.8.6.4" xref="S3.E1.m1.8.8.6.4.cmml">+</mo><mi id="S3.E1.m1.8.8.6.5" xref="S3.E1.m1.8.8.6.5.cmml">ϵ</mi></mrow></mfrac><mo id="S3.E1.m1.11.11.4.2.1.2" xref="S3.E1.m1.11.11.4.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.11b"><apply id="S3.E1.m1.11.11.cmml" xref="S3.E1.m1.11.11"><eq id="S3.E1.m1.11.11.3.cmml" xref="S3.E1.m1.11.11.3"></eq><apply id="S3.E1.m1.11.11.2.cmml" xref="S3.E1.m1.11.11.2"><times id="S3.E1.m1.11.11.2.3.cmml" xref="S3.E1.m1.11.11.2.3"></times><apply id="S3.E1.m1.11.11.2.4.cmml" xref="S3.E1.m1.11.11.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.11.11.2.4.1.cmml" xref="S3.E1.m1.11.11.2.4">subscript</csymbol><ci id="S3.E1.m1.11.11.2.4.2.cmml" xref="S3.E1.m1.11.11.2.4.2">𝑔</ci><ci id="S3.E1.m1.11.11.2.4.3a.cmml" xref="S3.E1.m1.11.11.2.4.3"><mtext id="S3.E1.m1.11.11.2.4.3.cmml" mathsize="70%" xref="S3.E1.m1.11.11.2.4.3">proto</mtext></ci></apply><interval closure="open" id="S3.E1.m1.11.11.2.2.3.cmml" xref="S3.E1.m1.11.11.2.2.2"><apply id="S3.E1.m1.10.10.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.10.10.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.2">𝐳</ci><ci id="S3.E1.m1.10.10.1.1.1.1.3.cmml" xref="S3.E1.m1.10.10.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E1.m1.11.11.2.2.2.2.cmml" xref="S3.E1.m1.11.11.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.11.11.2.2.2.2.1.cmml" xref="S3.E1.m1.11.11.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.11.11.2.2.2.2.2.cmml" xref="S3.E1.m1.11.11.2.2.2.2.2">𝐩</ci><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑠</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">m</ci></list></apply></interval></apply><apply id="S3.E1.m1.11.11.4.1.cmml" xref="S3.E1.m1.11.11.4.2"><log id="S3.E1.m1.9.9.cmml" xref="S3.E1.m1.9.9"></log><apply id="S3.E1.m1.8.8.cmml" xref="S3.E1.m1.8.8"><divide id="S3.E1.m1.8.8.7.cmml" xref="S3.E1.m1.8.8"></divide><apply id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.3"><plus id="S3.E1.m1.5.5.3.4.cmml" xref="S3.E1.m1.5.5.3.4"></plus><apply id="S3.E1.m1.5.5.3.3.cmml" xref="S3.E1.m1.5.5.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.2.cmml" xref="S3.E1.m1.5.5.3.3">superscript</csymbol><apply id="S3.E1.m1.5.5.3.3.1.cmml" xref="S3.E1.m1.5.5.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.2.cmml" xref="S3.E1.m1.5.5.3.3">subscript</csymbol><apply id="S3.E1.m1.5.5.3.3.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.3.3.1.1.2.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.5.5.3.3.1.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1"><minus id="S3.E1.m1.5.5.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1"></minus><apply id="S3.E1.m1.5.5.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2.2">𝐳</ci><ci id="S3.E1.m1.5.5.3.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E1.m1.5.5.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.2">𝐩</ci><list id="S3.E1.m1.4.4.2.2.2.3.cmml" xref="S3.E1.m1.4.4.2.2.2.4"><ci id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1">𝑠</ci><ci id="S3.E1.m1.4.4.2.2.2.2.cmml" xref="S3.E1.m1.4.4.2.2.2.2">m</ci></list></apply></apply></apply><cn id="S3.E1.m1.5.5.3.3.1.3.cmml" type="integer" xref="S3.E1.m1.5.5.3.3.1.3">2</cn></apply><cn id="S3.E1.m1.5.5.3.3.3.cmml" type="integer" xref="S3.E1.m1.5.5.3.3.3">2</cn></apply><cn id="S3.E1.m1.5.5.3.5.cmml" type="integer" xref="S3.E1.m1.5.5.3.5">1</cn></apply><apply id="S3.E1.m1.8.8.6.cmml" xref="S3.E1.m1.8.8.6"><plus id="S3.E1.m1.8.8.6.4.cmml" xref="S3.E1.m1.8.8.6.4"></plus><apply id="S3.E1.m1.8.8.6.3.cmml" xref="S3.E1.m1.8.8.6.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.6.3.2.cmml" xref="S3.E1.m1.8.8.6.3">superscript</csymbol><apply id="S3.E1.m1.8.8.6.3.1.cmml" xref="S3.E1.m1.8.8.6.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.6.3.1.2.cmml" xref="S3.E1.m1.8.8.6.3">subscript</csymbol><apply id="S3.E1.m1.8.8.6.3.1.1.2.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.8.8.6.3.1.1.2.1.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.8.8.6.3.1.1.1.1.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1"><minus id="S3.E1.m1.8.8.6.3.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.1"></minus><apply id="S3.E1.m1.8.8.6.3.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.6.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.8.8.6.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.2.2">𝐳</ci><ci id="S3.E1.m1.8.8.6.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E1.m1.8.8.6.3.1.1.1.1.3.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.6.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.8.8.6.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.8.8.6.3.1.1.1.1.3.2">𝐩</ci><list id="S3.E1.m1.7.7.5.2.2.3.cmml" xref="S3.E1.m1.7.7.5.2.2.4"><ci id="S3.E1.m1.6.6.4.1.1.1.cmml" xref="S3.E1.m1.6.6.4.1.1.1">𝑠</ci><ci id="S3.E1.m1.7.7.5.2.2.2.cmml" xref="S3.E1.m1.7.7.5.2.2.2">m</ci></list></apply></apply></apply><cn id="S3.E1.m1.8.8.6.3.1.3.cmml" type="integer" xref="S3.E1.m1.8.8.6.3.1.3">2</cn></apply><cn id="S3.E1.m1.8.8.6.3.3.cmml" type="integer" xref="S3.E1.m1.8.8.6.3.3">2</cn></apply><ci id="S3.E1.m1.8.8.6.5.cmml" xref="S3.E1.m1.8.8.6.5">italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.11c">g_{\text{proto}}(\mathbf{z}_{s},\mathbf{p}_{s,\operatorname*{m}})=\log\left(%
\frac{\|\mathbf{z}_{s}-\mathbf{p}_{s,\operatorname*{m}}\|_{2}^{2}+1}{\|\mathbf%
{z}_{s}-\mathbf{p}_{s,\operatorname*{m}}\|_{2}^{2}+\epsilon}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.11d">italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ) = roman_log ( divide start_ARG ∥ bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 1 end_ARG start_ARG ∥ bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ϵ end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.11">with <math alttext="\epsilon\ll 1" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">ϵ</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">≪</mo><mn id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1">much-less-than</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">italic-ϵ</ci><cn id="S3.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\epsilon\ll 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_ϵ ≪ 1</annotation></semantics></math> a constant for numerical stability. Then, for each scale-specific feature vector <math alttext="\mathbf{z}_{s}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐳</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{z}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, the <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_M</annotation></semantics></math> activation scores <math alttext="\left[g_{\text{proto}}(\mathbf{z}_{s},\mathbf{p}_{s,1}),\dots,g_{\text{proto}}%
(\mathbf{z}_{s},\mathbf{p}_{s,M})\right]" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.7"><semantics id="S3.SS1.p2.4.m4.7a"><mrow id="S3.SS1.p2.4.m4.7.7.2" xref="S3.SS1.p2.4.m4.7.7.3.cmml"><mo id="S3.SS1.p2.4.m4.7.7.2.3" xref="S3.SS1.p2.4.m4.7.7.3.cmml">[</mo><mrow id="S3.SS1.p2.4.m4.6.6.1.1" xref="S3.SS1.p2.4.m4.6.6.1.1.cmml"><msub id="S3.SS1.p2.4.m4.6.6.1.1.4" xref="S3.SS1.p2.4.m4.6.6.1.1.4.cmml"><mi id="S3.SS1.p2.4.m4.6.6.1.1.4.2" xref="S3.SS1.p2.4.m4.6.6.1.1.4.2.cmml">g</mi><mtext id="S3.SS1.p2.4.m4.6.6.1.1.4.3" xref="S3.SS1.p2.4.m4.6.6.1.1.4.3a.cmml">proto</mtext></msub><mo id="S3.SS1.p2.4.m4.6.6.1.1.3" xref="S3.SS1.p2.4.m4.6.6.1.1.3.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.6.6.1.1.2.2" xref="S3.SS1.p2.4.m4.6.6.1.1.2.3.cmml"><mo id="S3.SS1.p2.4.m4.6.6.1.1.2.2.3" stretchy="false" xref="S3.SS1.p2.4.m4.6.6.1.1.2.3.cmml">(</mo><msub id="S3.SS1.p2.4.m4.6.6.1.1.1.1.1" xref="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS1.p2.4.m4.6.6.1.1.2.2.4" xref="S3.SS1.p2.4.m4.6.6.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p2.4.m4.6.6.1.1.2.2.2" xref="S3.SS1.p2.4.m4.6.6.1.1.2.2.2.cmml"><mi id="S3.SS1.p2.4.m4.6.6.1.1.2.2.2.2" xref="S3.SS1.p2.4.m4.6.6.1.1.2.2.2.2.cmml">𝐩</mi><mrow id="S3.SS1.p2.4.m4.2.2.2.4" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.cmml">s</mi><mo id="S3.SS1.p2.4.m4.2.2.2.4.1" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml">,</mo><mn id="S3.SS1.p2.4.m4.2.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS1.p2.4.m4.6.6.1.1.2.2.5" stretchy="false" xref="S3.SS1.p2.4.m4.6.6.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.4.m4.7.7.2.4" xref="S3.SS1.p2.4.m4.7.7.3.cmml">,</mo><mi id="S3.SS1.p2.4.m4.5.5" mathvariant="normal" xref="S3.SS1.p2.4.m4.5.5.cmml">…</mi><mo id="S3.SS1.p2.4.m4.7.7.2.5" xref="S3.SS1.p2.4.m4.7.7.3.cmml">,</mo><mrow id="S3.SS1.p2.4.m4.7.7.2.2" xref="S3.SS1.p2.4.m4.7.7.2.2.cmml"><msub id="S3.SS1.p2.4.m4.7.7.2.2.4" xref="S3.SS1.p2.4.m4.7.7.2.2.4.cmml"><mi id="S3.SS1.p2.4.m4.7.7.2.2.4.2" xref="S3.SS1.p2.4.m4.7.7.2.2.4.2.cmml">g</mi><mtext id="S3.SS1.p2.4.m4.7.7.2.2.4.3" xref="S3.SS1.p2.4.m4.7.7.2.2.4.3a.cmml">proto</mtext></msub><mo id="S3.SS1.p2.4.m4.7.7.2.2.3" xref="S3.SS1.p2.4.m4.7.7.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.7.7.2.2.2.2" xref="S3.SS1.p2.4.m4.7.7.2.2.2.3.cmml"><mo id="S3.SS1.p2.4.m4.7.7.2.2.2.2.3" stretchy="false" xref="S3.SS1.p2.4.m4.7.7.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p2.4.m4.7.7.2.2.1.1.1" xref="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.2" xref="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.3" xref="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS1.p2.4.m4.7.7.2.2.2.2.4" xref="S3.SS1.p2.4.m4.7.7.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.4.m4.7.7.2.2.2.2.2" xref="S3.SS1.p2.4.m4.7.7.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.4.m4.7.7.2.2.2.2.2.2" xref="S3.SS1.p2.4.m4.7.7.2.2.2.2.2.2.cmml">𝐩</mi><mrow id="S3.SS1.p2.4.m4.4.4.2.4" xref="S3.SS1.p2.4.m4.4.4.2.3.cmml"><mi id="S3.SS1.p2.4.m4.3.3.1.1" xref="S3.SS1.p2.4.m4.3.3.1.1.cmml">s</mi><mo id="S3.SS1.p2.4.m4.4.4.2.4.1" xref="S3.SS1.p2.4.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p2.4.m4.4.4.2.2" xref="S3.SS1.p2.4.m4.4.4.2.2.cmml">M</mi></mrow></msub><mo id="S3.SS1.p2.4.m4.7.7.2.2.2.2.5" stretchy="false" xref="S3.SS1.p2.4.m4.7.7.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.4.m4.7.7.2.6" xref="S3.SS1.p2.4.m4.7.7.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.7b"><list id="S3.SS1.p2.4.m4.7.7.3.cmml" xref="S3.SS1.p2.4.m4.7.7.2"><apply id="S3.SS1.p2.4.m4.6.6.1.1.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1"><times id="S3.SS1.p2.4.m4.6.6.1.1.3.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.3"></times><apply id="S3.SS1.p2.4.m4.6.6.1.1.4.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.6.6.1.1.4.1.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.4">subscript</csymbol><ci id="S3.SS1.p2.4.m4.6.6.1.1.4.2.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.4.2">𝑔</ci><ci id="S3.SS1.p2.4.m4.6.6.1.1.4.3a.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.4.3"><mtext id="S3.SS1.p2.4.m4.6.6.1.1.4.3.cmml" mathsize="70%" xref="S3.SS1.p2.4.m4.6.6.1.1.4.3">proto</mtext></ci></apply><interval closure="open" id="S3.SS1.p2.4.m4.6.6.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.2.2"><apply id="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.2">𝐳</ci><ci id="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p2.4.m4.6.6.1.1.2.2.2.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.6.6.1.1.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.6.6.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.6.6.1.1.2.2.2.2">𝐩</ci><list id="S3.SS1.p2.4.m4.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.2.4"><ci id="S3.SS1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1">𝑠</ci><cn id="S3.SS1.p2.4.m4.2.2.2.2.cmml" type="integer" xref="S3.SS1.p2.4.m4.2.2.2.2">1</cn></list></apply></interval></apply><ci id="S3.SS1.p2.4.m4.5.5.cmml" xref="S3.SS1.p2.4.m4.5.5">…</ci><apply id="S3.SS1.p2.4.m4.7.7.2.2.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2"><times id="S3.SS1.p2.4.m4.7.7.2.2.3.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.3"></times><apply id="S3.SS1.p2.4.m4.7.7.2.2.4.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.7.7.2.2.4.1.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.4.m4.7.7.2.2.4.2.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.4.2">𝑔</ci><ci id="S3.SS1.p2.4.m4.7.7.2.2.4.3a.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.4.3"><mtext id="S3.SS1.p2.4.m4.7.7.2.2.4.3.cmml" mathsize="70%" xref="S3.SS1.p2.4.m4.7.7.2.2.4.3">proto</mtext></ci></apply><interval closure="open" id="S3.SS1.p2.4.m4.7.7.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.2.2"><apply id="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.2">𝐳</ci><ci id="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p2.4.m4.7.7.2.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.7.7.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.7.7.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.7.7.2.2.2.2.2.2">𝐩</ci><list id="S3.SS1.p2.4.m4.4.4.2.3.cmml" xref="S3.SS1.p2.4.m4.4.4.2.4"><ci id="S3.SS1.p2.4.m4.3.3.1.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1">𝑠</ci><ci id="S3.SS1.p2.4.m4.4.4.2.2.cmml" xref="S3.SS1.p2.4.m4.4.4.2.2">𝑀</ci></list></apply></interval></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.7c">\left[g_{\text{proto}}(\mathbf{z}_{s},\mathbf{p}_{s,1}),\dots,g_{\text{proto}}%
(\mathbf{z}_{s},\mathbf{p}_{s,M})\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.7d">[ italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_p start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT ) , … , italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_p start_POSTSUBSCRIPT italic_s , italic_M end_POSTSUBSCRIPT ) ]</annotation></semantics></math> are concatenated across the <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_S</annotation></semantics></math> scales indexed by <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_s</annotation></semantics></math>. The linear layer <math alttext="h_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">h</mi><mtext id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">ℎ</ci><ci id="S3.SS1.p2.7.m7.1.1.3a.cmml" xref="S3.SS1.p2.7.m7.1.1.3"><mtext id="S3.SS1.p2.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.7.m7.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">h_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math>, with weight matrix <math alttext="\mathbf{w}_{h_{\text{proto}}}\in\mathbb{R}^{C\times M\cdot S}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><msub id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.cmml">𝐰</mi><msub id="S3.SS1.p2.8.m8.1.1.2.3" xref="S3.SS1.p2.8.m8.1.1.2.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.3.2" xref="S3.SS1.p2.8.m8.1.1.2.3.2.cmml">h</mi><mtext id="S3.SS1.p2.8.m8.1.1.2.3.3" xref="S3.SS1.p2.8.m8.1.1.2.3.3a.cmml">proto</mtext></msub></msub><mo id="S3.SS1.p2.8.m8.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.2" xref="S3.SS1.p2.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.8.m8.1.1.3.3" xref="S3.SS1.p2.8.m8.1.1.3.3.cmml"><mrow id="S3.SS1.p2.8.m8.1.1.3.3.2" xref="S3.SS1.p2.8.m8.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.3.2.2" xref="S3.SS1.p2.8.m8.1.1.3.3.2.2.cmml">C</mi><mo id="S3.SS1.p2.8.m8.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.8.m8.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS1.p2.8.m8.1.1.3.3.2.3" xref="S3.SS1.p2.8.m8.1.1.3.3.2.3.cmml">M</mi></mrow><mo id="S3.SS1.p2.8.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.8.m8.1.1.3.3.1.cmml">⋅</mo><mi id="S3.SS1.p2.8.m8.1.1.3.3.3" xref="S3.SS1.p2.8.m8.1.1.3.3.3.cmml">S</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><in id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1"></in><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2">𝐰</ci><apply id="S3.SS1.p2.8.m8.1.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3.2">ℎ</ci><ci id="S3.SS1.p2.8.m8.1.1.2.3.3a.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3.3"><mtext id="S3.SS1.p2.8.m8.1.1.2.3.3.cmml" mathsize="50%" xref="S3.SS1.p2.8.m8.1.1.2.3.3">proto</mtext></ci></apply></apply><apply id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.8.m8.1.1.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3"><ci id="S3.SS1.p2.8.m8.1.1.3.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.1">⋅</ci><apply id="S3.SS1.p2.8.m8.1.1.3.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.2"><times id="S3.SS1.p2.8.m8.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.2.1"></times><ci id="S3.SS1.p2.8.m8.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.2.2">𝐶</ci><ci id="S3.SS1.p2.8.m8.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.2.3">𝑀</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.3.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\mathbf{w}_{h_{\text{proto}}}\in\mathbb{R}^{C\times M\cdot S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">bold_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_M ⋅ italic_S end_POSTSUPERSCRIPT</annotation></semantics></math>, learns a mapping from those prototype activations to the <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">italic_C</annotation></semantics></math> output classes probabilities. The classification probabilities map, obtained after processing all feature vectors <math alttext="\mathbf{z}=\left[\mathbf{z}_{1},\dots,\mathbf{z}_{S}\right]" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.3"><semantics id="S3.SS1.p2.10.m10.3a"><mrow id="S3.SS1.p2.10.m10.3.3" xref="S3.SS1.p2.10.m10.3.3.cmml"><mi id="S3.SS1.p2.10.m10.3.3.4" xref="S3.SS1.p2.10.m10.3.3.4.cmml">𝐳</mi><mo id="S3.SS1.p2.10.m10.3.3.3" xref="S3.SS1.p2.10.m10.3.3.3.cmml">=</mo><mrow id="S3.SS1.p2.10.m10.3.3.2.2" xref="S3.SS1.p2.10.m10.3.3.2.3.cmml"><mo id="S3.SS1.p2.10.m10.3.3.2.2.3" xref="S3.SS1.p2.10.m10.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p2.10.m10.2.2.1.1.1" xref="S3.SS1.p2.10.m10.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.10.m10.2.2.1.1.1.2" xref="S3.SS1.p2.10.m10.2.2.1.1.1.2.cmml">𝐳</mi><mn id="S3.SS1.p2.10.m10.2.2.1.1.1.3" xref="S3.SS1.p2.10.m10.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.10.m10.3.3.2.2.4" xref="S3.SS1.p2.10.m10.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p2.10.m10.1.1" mathvariant="normal" xref="S3.SS1.p2.10.m10.1.1.cmml">…</mi><mo id="S3.SS1.p2.10.m10.3.3.2.2.5" xref="S3.SS1.p2.10.m10.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.10.m10.3.3.2.2.2" xref="S3.SS1.p2.10.m10.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.10.m10.3.3.2.2.2.2" xref="S3.SS1.p2.10.m10.3.3.2.2.2.2.cmml">𝐳</mi><mi id="S3.SS1.p2.10.m10.3.3.2.2.2.3" xref="S3.SS1.p2.10.m10.3.3.2.2.2.3.cmml">S</mi></msub><mo id="S3.SS1.p2.10.m10.3.3.2.2.6" xref="S3.SS1.p2.10.m10.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.3b"><apply id="S3.SS1.p2.10.m10.3.3.cmml" xref="S3.SS1.p2.10.m10.3.3"><eq id="S3.SS1.p2.10.m10.3.3.3.cmml" xref="S3.SS1.p2.10.m10.3.3.3"></eq><ci id="S3.SS1.p2.10.m10.3.3.4.cmml" xref="S3.SS1.p2.10.m10.3.3.4">𝐳</ci><list id="S3.SS1.p2.10.m10.3.3.2.3.cmml" xref="S3.SS1.p2.10.m10.3.3.2.2"><apply id="S3.SS1.p2.10.m10.2.2.1.1.1.cmml" xref="S3.SS1.p2.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.10.m10.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m10.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.10.m10.2.2.1.1.1.2">𝐳</ci><cn id="S3.SS1.p2.10.m10.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.10.m10.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">…</ci><apply id="S3.SS1.p2.10.m10.3.3.2.2.2.cmml" xref="S3.SS1.p2.10.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.10.m10.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.10.m10.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.10.m10.3.3.2.2.2.2">𝐳</ci><ci id="S3.SS1.p2.10.m10.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.10.m10.3.3.2.2.2.3">𝑆</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.3c">\mathbf{z}=\left[\mathbf{z}_{1},\dots,\mathbf{z}_{S}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.3d">bold_z = [ bold_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_z start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ]</annotation></semantics></math> in parallel, is of dimension <math alttext="H_{r}\times W_{r}\times C" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><mrow id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><msub id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2.2" xref="S3.SS1.p2.11.m11.1.1.2.2.cmml">H</mi><mi id="S3.SS1.p2.11.m11.1.1.2.3" xref="S3.SS1.p2.11.m11.1.1.2.3.cmml">r</mi></msub><mo id="S3.SS1.p2.11.m11.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.11.m11.1.1.1.cmml">×</mo><msub id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.3.2" xref="S3.SS1.p2.11.m11.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p2.11.m11.1.1.3.3" xref="S3.SS1.p2.11.m11.1.1.3.3.cmml">r</mi></msub><mo id="S3.SS1.p2.11.m11.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.11.m11.1.1.1.cmml">×</mo><mi id="S3.SS1.p2.11.m11.1.1.4" xref="S3.SS1.p2.11.m11.1.1.4.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><times id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1"></times><apply id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2.2">𝐻</ci><ci id="S3.SS1.p2.11.m11.1.1.2.3.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3">𝑟</ci></apply><apply id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.3.2">𝑊</ci><ci id="S3.SS1.p2.11.m11.1.1.3.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3.3">𝑟</ci></apply><ci id="S3.SS1.p2.11.m11.1.1.4.cmml" xref="S3.SS1.p2.11.m11.1.1.4">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">H_{r}\times W_{r}\times C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_C</annotation></semantics></math>. To upscale it to the original image resolution and produce the final segmentation map, the classification probability is linearly interpolated.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.3">For semantic segmentation, the objective is to learn prototypes that are assigned to a specific class <math alttext="c\in\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">c</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><in id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></in><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑐</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">c\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_c ∈ caligraphic_C</annotation></semantics></math>. This is enforced by initializing the weights <math alttext="\mathbf{w}_{h_{\text{proto}}}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">𝐰</mi><msub id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">h</mi><mtext id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3a.cmml">proto</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐰</ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">ℎ</ci><ci id="S3.SS1.p3.2.m2.1.1.3.3a.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3"><mtext id="S3.SS1.p3.2.m2.1.1.3.3.cmml" mathsize="50%" xref="S3.SS1.p3.2.m2.1.1.3.3">proto</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathbf{w}_{h_{\text{proto}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> of the linear layer <math alttext="h_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">h</mi><mtext id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">ℎ</ci><ci id="S3.SS1.p3.3.m3.1.1.3a.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><mtext id="S3.SS1.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p3.3.m3.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">h_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math> following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>]</cite>, and replicating the same assignment to a specific class across all scales, such as with:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w_{h_{\text{proto}}}^{(c,\operatorname*{m})}=\left\{\begin{aligned} &amp;1&amp;&amp;\text{%
if}\ \mathbf{p}_{s,\operatorname*{m}}\in P_{c}\\
&amp;-0.5&amp;&amp;\text{otherwise}\end{aligned}\right." class="ltx_math_unparsed" display="block" id="S3.Ex1.m1.4"><semantics id="S3.Ex1.m1.4a"><mrow id="S3.Ex1.m1.4b"><msubsup id="S3.Ex1.m1.4.5"><mi id="S3.Ex1.m1.4.5.2.2">w</mi><msub id="S3.Ex1.m1.4.5.2.3"><mi id="S3.Ex1.m1.4.5.2.3.2">h</mi><mtext id="S3.Ex1.m1.4.5.2.3.3">proto</mtext></msub><mrow id="S3.Ex1.m1.2.2.2.4"><mo id="S3.Ex1.m1.2.2.2.4.1" stretchy="false">(</mo><mi id="S3.Ex1.m1.1.1.1.1">c</mi><mo id="S3.Ex1.m1.2.2.2.4.2">,</mo><mo id="S3.Ex1.m1.2.2.2.2" lspace="0em" rspace="0em">m</mo><mo id="S3.Ex1.m1.2.2.2.4.3" stretchy="false">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.4.6">=</mo><mrow id="S3.Ex1.m1.4.7"><mo id="S3.Ex1.m1.4.7.1">{</mo><mtable columnspacing="0pt" displaystyle="true" id="S3.Ex1.m1.4.4" rowspacing="0pt"><mtr id="S3.Ex1.m1.4.4a"><mtd id="S3.Ex1.m1.4.4b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4c"><mn id="S3.Ex1.m1.4.4.2.4.1">1</mn></mtd><mtd id="S3.Ex1.m1.4.4d"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4e"><mrow id="S3.Ex1.m1.4.4.2.2.2"><mrow id="S3.Ex1.m1.4.4.2.2.2.4"><mtext id="S3.Ex1.m1.4.4.2.2.2.4.2">if</mtext><mo id="S3.Ex1.m1.4.4.2.2.2.4.1" lspace="0.500em">⁢</mo><msub id="S3.Ex1.m1.4.4.2.2.2.4.3"><mi id="S3.Ex1.m1.4.4.2.2.2.4.3.2">𝐩</mi><mrow id="S3.Ex1.m1.4.4.2.2.2.2.2.4"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1">s</mi><mo id="S3.Ex1.m1.4.4.2.2.2.2.2.4.1">,</mo><mo id="S3.Ex1.m1.4.4.2.2.2.2.2.2" lspace="0em">m</mo></mrow></msub></mrow><mo id="S3.Ex1.m1.4.4.2.2.2.3">∈</mo><msub id="S3.Ex1.m1.4.4.2.2.2.5"><mi id="S3.Ex1.m1.4.4.2.2.2.5.2">P</mi><mi id="S3.Ex1.m1.4.4.2.2.2.5.3">c</mi></msub></mrow></mtd></mtr><mtr id="S3.Ex1.m1.4.4f"><mtd id="S3.Ex1.m1.4.4g"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4h"><mrow id="S3.Ex1.m1.4.4.3.2.1"><mo id="S3.Ex1.m1.4.4.3.2.1a">−</mo><mn id="S3.Ex1.m1.4.4.3.2.1.2">0.5</mn></mrow></mtd><mtd id="S3.Ex1.m1.4.4i"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4j"><mtext id="S3.Ex1.m1.4.4.3.4.1">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m1.4c">w_{h_{\text{proto}}}^{(c,\operatorname*{m})}=\left\{\begin{aligned} &amp;1&amp;&amp;\text{%
if}\ \mathbf{p}_{s,\operatorname*{m}}\in P_{c}\\
&amp;-0.5&amp;&amp;\text{otherwise}\end{aligned}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.4d">italic_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_c , roman_m ) end_POSTSUPERSCRIPT = { start_ROW start_CELL end_CELL start_CELL 1 end_CELL start_CELL end_CELL start_CELL if bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ∈ italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL - 0.5 end_CELL start_CELL end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.6">where <math alttext="P_{c}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m1.1"><semantics id="S3.SS1.p3.4.m1.1a"><msub id="S3.SS1.p3.4.m1.1.1" xref="S3.SS1.p3.4.m1.1.1.cmml"><mi id="S3.SS1.p3.4.m1.1.1.2" xref="S3.SS1.p3.4.m1.1.1.2.cmml">P</mi><mi id="S3.SS1.p3.4.m1.1.1.3" xref="S3.SS1.p3.4.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m1.1b"><apply id="S3.SS1.p3.4.m1.1.1.cmml" xref="S3.SS1.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m1.1.1.1.cmml" xref="S3.SS1.p3.4.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m1.1.1.2.cmml" xref="S3.SS1.p3.4.m1.1.1.2">𝑃</ci><ci id="S3.SS1.p3.4.m1.1.1.3.cmml" xref="S3.SS1.p3.4.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m1.1c">P_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m1.1d">italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the set of prototypes that we assign to class <math alttext="c\in\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m2.1"><semantics id="S3.SS1.p3.5.m2.1a"><mrow id="S3.SS1.p3.5.m2.1.1" xref="S3.SS1.p3.5.m2.1.1.cmml"><mi id="S3.SS1.p3.5.m2.1.1.2" xref="S3.SS1.p3.5.m2.1.1.2.cmml">c</mi><mo id="S3.SS1.p3.5.m2.1.1.1" xref="S3.SS1.p3.5.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.5.m2.1.1.3" xref="S3.SS1.p3.5.m2.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m2.1b"><apply id="S3.SS1.p3.5.m2.1.1.cmml" xref="S3.SS1.p3.5.m2.1.1"><in id="S3.SS1.p3.5.m2.1.1.1.cmml" xref="S3.SS1.p3.5.m2.1.1.1"></in><ci id="S3.SS1.p3.5.m2.1.1.2.cmml" xref="S3.SS1.p3.5.m2.1.1.2">𝑐</ci><ci id="S3.SS1.p3.5.m2.1.1.3.cmml" xref="S3.SS1.p3.5.m2.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m2.1c">c\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m2.1d">italic_c ∈ caligraphic_C</annotation></semantics></math>, across all scales and <math alttext="\operatorname*{m}\in[1,\dots,|P_{c}|]" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m3.3"><semantics id="S3.SS1.p3.6.m3.3a"><mrow id="S3.SS1.p3.6.m3.3.3" xref="S3.SS1.p3.6.m3.3.3.cmml"><mo id="S3.SS1.p3.6.m3.3.3.3" rspace="0.1389em" xref="S3.SS1.p3.6.m3.3.3.3.cmml">m</mo><mo id="S3.SS1.p3.6.m3.3.3.2" lspace="0.1389em" xref="S3.SS1.p3.6.m3.3.3.2.cmml">∈</mo><mrow id="S3.SS1.p3.6.m3.3.3.1.1" xref="S3.SS1.p3.6.m3.3.3.1.2.cmml"><mo id="S3.SS1.p3.6.m3.3.3.1.1.2" stretchy="false" xref="S3.SS1.p3.6.m3.3.3.1.2.cmml">[</mo><mn id="S3.SS1.p3.6.m3.1.1" xref="S3.SS1.p3.6.m3.1.1.cmml">1</mn><mo id="S3.SS1.p3.6.m3.3.3.1.1.3" xref="S3.SS1.p3.6.m3.3.3.1.2.cmml">,</mo><mi id="S3.SS1.p3.6.m3.2.2" mathvariant="normal" xref="S3.SS1.p3.6.m3.2.2.cmml">…</mi><mo id="S3.SS1.p3.6.m3.3.3.1.1.4" xref="S3.SS1.p3.6.m3.3.3.1.2.cmml">,</mo><mrow id="S3.SS1.p3.6.m3.3.3.1.1.1.1" xref="S3.SS1.p3.6.m3.3.3.1.1.1.2.cmml"><mo id="S3.SS1.p3.6.m3.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.6.m3.3.3.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p3.6.m3.3.3.1.1.1.1.1" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.2" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.2.cmml">P</mi><mi id="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.3" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS1.p3.6.m3.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.6.m3.3.3.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS1.p3.6.m3.3.3.1.1.5" stretchy="false" xref="S3.SS1.p3.6.m3.3.3.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m3.3b"><apply id="S3.SS1.p3.6.m3.3.3.cmml" xref="S3.SS1.p3.6.m3.3.3"><in id="S3.SS1.p3.6.m3.3.3.2.cmml" xref="S3.SS1.p3.6.m3.3.3.2"></in><ci id="S3.SS1.p3.6.m3.3.3.3.cmml" xref="S3.SS1.p3.6.m3.3.3.3">m</ci><list id="S3.SS1.p3.6.m3.3.3.1.2.cmml" xref="S3.SS1.p3.6.m3.3.3.1.1"><cn id="S3.SS1.p3.6.m3.1.1.cmml" type="integer" xref="S3.SS1.p3.6.m3.1.1">1</cn><ci id="S3.SS1.p3.6.m3.2.2.cmml" xref="S3.SS1.p3.6.m3.2.2">…</ci><apply id="S3.SS1.p3.6.m3.3.3.1.1.1.2.cmml" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1"><abs id="S3.SS1.p3.6.m3.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.2"></abs><apply id="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.2">𝑃</ci><ci id="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.6.m3.3.3.1.1.1.1.1.3">𝑐</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m3.3c">\operatorname*{m}\in[1,\dots,|P_{c}|]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m3.3d">roman_m ∈ [ 1 , … , | italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT | ]</annotation></semantics></math>. Those weights are frozen for the majority of the training procedure (see Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS3" title="3.3 Multi-stage training procedure ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.3</span></a>) to maintain the steering of the prototypes toward class-specific patterns.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Prototype grouping</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.9">Our model architecture for prototype grouping is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>: <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.9.1">Stage 2</span>.
Once the scale-specific prototypes <math alttext="\mathbf{p}_{s,\operatorname*{m}}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><msub id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml">𝐩</mi><mrow id="S3.SS2.p1.1.m1.2.2.2.4" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">s</mi><mo id="S3.SS2.p1.1.m1.2.2.2.4.1" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><mo id="S3.SS2.p1.1.m1.2.2.2.2" lspace="0em" xref="S3.SS2.p1.1.m1.2.2.2.2.cmml">m</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2">𝐩</ci><list id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4"><ci id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">𝑠</ci><ci id="S3.SS2.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2">m</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\mathbf{p}_{s,\operatorname*{m}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT</annotation></semantics></math> are learned through the multi-scale learning stage as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS1" title="3.1 Multi-scale prototype learning ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we group them into sparse groups across scales. For this purpose, we use class-specific grouping functions: <math alttext="g_{c}(\mathbf{z})=g_{\text{group}}^{c}(g_{\text{proto}}(\mathbf{z},P_{c}))" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.3"><semantics id="S3.SS2.p1.2.m2.3a"><mrow id="S3.SS2.p1.2.m2.3.3" xref="S3.SS2.p1.2.m2.3.3.cmml"><mrow id="S3.SS2.p1.2.m2.3.3.3" xref="S3.SS2.p1.2.m2.3.3.3.cmml"><msub id="S3.SS2.p1.2.m2.3.3.3.2" xref="S3.SS2.p1.2.m2.3.3.3.2.cmml"><mi id="S3.SS2.p1.2.m2.3.3.3.2.2" xref="S3.SS2.p1.2.m2.3.3.3.2.2.cmml">g</mi><mi id="S3.SS2.p1.2.m2.3.3.3.2.3" xref="S3.SS2.p1.2.m2.3.3.3.2.3.cmml">c</mi></msub><mo id="S3.SS2.p1.2.m2.3.3.3.1" xref="S3.SS2.p1.2.m2.3.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.3.3.3.3.2" xref="S3.SS2.p1.2.m2.3.3.3.cmml"><mo id="S3.SS2.p1.2.m2.3.3.3.3.2.1" stretchy="false" xref="S3.SS2.p1.2.m2.3.3.3.cmml">(</mo><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝐳</mi><mo id="S3.SS2.p1.2.m2.3.3.3.3.2.2" stretchy="false" xref="S3.SS2.p1.2.m2.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.2.m2.3.3.2" xref="S3.SS2.p1.2.m2.3.3.2.cmml">=</mo><mrow id="S3.SS2.p1.2.m2.3.3.1" xref="S3.SS2.p1.2.m2.3.3.1.cmml"><msubsup id="S3.SS2.p1.2.m2.3.3.1.3" xref="S3.SS2.p1.2.m2.3.3.1.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.1.3.2.2" xref="S3.SS2.p1.2.m2.3.3.1.3.2.2.cmml">g</mi><mtext id="S3.SS2.p1.2.m2.3.3.1.3.2.3" xref="S3.SS2.p1.2.m2.3.3.1.3.2.3a.cmml">group</mtext><mi id="S3.SS2.p1.2.m2.3.3.1.3.3" xref="S3.SS2.p1.2.m2.3.3.1.3.3.cmml">c</mi></msubsup><mo id="S3.SS2.p1.2.m2.3.3.1.2" xref="S3.SS2.p1.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.3.3.1.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml"><mo id="S3.SS2.p1.2.m2.3.3.1.1.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.2.m2.3.3.1.1.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml"><msub id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.2" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.2.cmml">g</mi><mtext id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.3" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.3a.cmml">proto</mtext></msub><mo id="S3.SS2.p1.2.m2.3.3.1.1.1.1.2" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.2.cmml"><mo id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml">𝐳</mi><mo id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.2.cmml">,</mo><msub id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.2.cmml">P</mi><mi id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.4" stretchy="false" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.2.m2.3.3.1.1.1.3" stretchy="false" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.3b"><apply id="S3.SS2.p1.2.m2.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3"><eq id="S3.SS2.p1.2.m2.3.3.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2"></eq><apply id="S3.SS2.p1.2.m2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.3"><times id="S3.SS2.p1.2.m2.3.3.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.3.1"></times><apply id="S3.SS2.p1.2.m2.3.3.3.2.cmml" xref="S3.SS2.p1.2.m2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.3.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.3.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.3.2.2">𝑔</ci><ci id="S3.SS2.p1.2.m2.3.3.3.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.3.2.3">𝑐</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐳</ci></apply><apply id="S3.SS2.p1.2.m2.3.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1"><times id="S3.SS2.p1.2.m2.3.3.1.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.2"></times><apply id="S3.SS2.p1.2.m2.3.3.1.3.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.1.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3">superscript</csymbol><apply id="S3.SS2.p1.2.m2.3.3.1.3.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.1.3.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.1.3.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3.2.2">𝑔</ci><ci id="S3.SS2.p1.2.m2.3.3.1.3.2.3a.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3.2.3"><mtext id="S3.SS2.p1.2.m2.3.3.1.3.2.3.cmml" mathsize="70%" xref="S3.SS2.p1.2.m2.3.3.1.3.2.3">group</mtext></ci></apply><ci id="S3.SS2.p1.2.m2.3.3.1.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3.3">𝑐</ci></apply><apply id="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1"><times id="S3.SS2.p1.2.m2.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.2"></times><apply id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.2">𝑔</ci><ci id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.3a.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.3"><mtext id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.3">proto</mtext></ci></apply><interval closure="open" id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1"><ci id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2">𝐳</ci><apply id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.2">𝑃</ci><ci id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.1.1.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.3c">g_{c}(\mathbf{z})=g_{\text{group}}^{c}(g_{\text{proto}}(\mathbf{z},P_{c}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.3d">italic_g start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( bold_z ) = italic_g start_POSTSUBSCRIPT group end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ( italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z , italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) )</annotation></semantics></math>, which group prototypes assigned to the same class and compute the groups’ activations <math alttext="g_{c}(\mathbf{z})\in\mathbb{R}^{N_{c}}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.2" xref="S3.SS2.p1.3.m3.1.2.cmml"><mrow id="S3.SS2.p1.3.m3.1.2.2" xref="S3.SS2.p1.3.m3.1.2.2.cmml"><msub id="S3.SS2.p1.3.m3.1.2.2.2" xref="S3.SS2.p1.3.m3.1.2.2.2.cmml"><mi id="S3.SS2.p1.3.m3.1.2.2.2.2" xref="S3.SS2.p1.3.m3.1.2.2.2.2.cmml">g</mi><mi id="S3.SS2.p1.3.m3.1.2.2.2.3" xref="S3.SS2.p1.3.m3.1.2.2.2.3.cmml">c</mi></msub><mo id="S3.SS2.p1.3.m3.1.2.2.1" xref="S3.SS2.p1.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.3.m3.1.2.2.3.2" xref="S3.SS2.p1.3.m3.1.2.2.cmml"><mo id="S3.SS2.p1.3.m3.1.2.2.3.2.1" stretchy="false" xref="S3.SS2.p1.3.m3.1.2.2.cmml">(</mo><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝐳</mi><mo id="S3.SS2.p1.3.m3.1.2.2.3.2.2" stretchy="false" xref="S3.SS2.p1.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.3.m3.1.2.1" xref="S3.SS2.p1.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS2.p1.3.m3.1.2.3" xref="S3.SS2.p1.3.m3.1.2.3.cmml"><mi id="S3.SS2.p1.3.m3.1.2.3.2" xref="S3.SS2.p1.3.m3.1.2.3.2.cmml">ℝ</mi><msub id="S3.SS2.p1.3.m3.1.2.3.3" xref="S3.SS2.p1.3.m3.1.2.3.3.cmml"><mi id="S3.SS2.p1.3.m3.1.2.3.3.2" xref="S3.SS2.p1.3.m3.1.2.3.3.2.cmml">N</mi><mi id="S3.SS2.p1.3.m3.1.2.3.3.3" xref="S3.SS2.p1.3.m3.1.2.3.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.2.cmml" xref="S3.SS2.p1.3.m3.1.2"><in id="S3.SS2.p1.3.m3.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.2.1"></in><apply id="S3.SS2.p1.3.m3.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.2.2"><times id="S3.SS2.p1.3.m3.1.2.2.1.cmml" xref="S3.SS2.p1.3.m3.1.2.2.1"></times><apply id="S3.SS2.p1.3.m3.1.2.2.2.cmml" xref="S3.SS2.p1.3.m3.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.2.2.2.1.cmml" xref="S3.SS2.p1.3.m3.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.2.2.2.2.cmml" xref="S3.SS2.p1.3.m3.1.2.2.2.2">𝑔</ci><ci id="S3.SS2.p1.3.m3.1.2.2.2.3.cmml" xref="S3.SS2.p1.3.m3.1.2.2.2.3">𝑐</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐳</ci></apply><apply id="S3.SS2.p1.3.m3.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.2.3.1.cmml" xref="S3.SS2.p1.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.2.3.2.cmml" xref="S3.SS2.p1.3.m3.1.2.3.2">ℝ</ci><apply id="S3.SS2.p1.3.m3.1.2.3.3.cmml" xref="S3.SS2.p1.3.m3.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.2.3.3.1.cmml" xref="S3.SS2.p1.3.m3.1.2.3.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.2.3.3.2.cmml" xref="S3.SS2.p1.3.m3.1.2.3.3.2">𝑁</ci><ci id="S3.SS2.p1.3.m3.1.2.3.3.3.cmml" xref="S3.SS2.p1.3.m3.1.2.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">g_{c}(\mathbf{z})\in\mathbb{R}^{N_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_g start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( bold_z ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>,
where <math alttext="N_{c}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">N</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑁</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the number of groups per class. Following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib57" title="">57</a>]</cite>, those functions are parametrized by sparse non-negative weight matrices <math alttext="\mathbf{w}_{g,c}\in[0,1]^{N_{c}\times|P_{c}|}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.5"><semantics id="S3.SS2.p1.5.m5.5a"><mrow id="S3.SS2.p1.5.m5.5.6" xref="S3.SS2.p1.5.m5.5.6.cmml"><msub id="S3.SS2.p1.5.m5.5.6.2" xref="S3.SS2.p1.5.m5.5.6.2.cmml"><mi id="S3.SS2.p1.5.m5.5.6.2.2" xref="S3.SS2.p1.5.m5.5.6.2.2.cmml">𝐰</mi><mrow id="S3.SS2.p1.5.m5.2.2.2.4" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml">g</mi><mo id="S3.SS2.p1.5.m5.2.2.2.4.1" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.5.m5.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S3.SS2.p1.5.m5.5.6.1" xref="S3.SS2.p1.5.m5.5.6.1.cmml">∈</mo><msup id="S3.SS2.p1.5.m5.5.6.3" xref="S3.SS2.p1.5.m5.5.6.3.cmml"><mrow id="S3.SS2.p1.5.m5.5.6.3.2.2" xref="S3.SS2.p1.5.m5.5.6.3.2.1.cmml"><mo id="S3.SS2.p1.5.m5.5.6.3.2.2.1" stretchy="false" xref="S3.SS2.p1.5.m5.5.6.3.2.1.cmml">[</mo><mn id="S3.SS2.p1.5.m5.4.4" xref="S3.SS2.p1.5.m5.4.4.cmml">0</mn><mo id="S3.SS2.p1.5.m5.5.6.3.2.2.2" xref="S3.SS2.p1.5.m5.5.6.3.2.1.cmml">,</mo><mn id="S3.SS2.p1.5.m5.5.5" xref="S3.SS2.p1.5.m5.5.5.cmml">1</mn><mo id="S3.SS2.p1.5.m5.5.6.3.2.2.3" stretchy="false" xref="S3.SS2.p1.5.m5.5.6.3.2.1.cmml">]</mo></mrow><mrow id="S3.SS2.p1.5.m5.3.3.1" xref="S3.SS2.p1.5.m5.3.3.1.cmml"><msub id="S3.SS2.p1.5.m5.3.3.1.3" xref="S3.SS2.p1.5.m5.3.3.1.3.cmml"><mi id="S3.SS2.p1.5.m5.3.3.1.3.2" xref="S3.SS2.p1.5.m5.3.3.1.3.2.cmml">N</mi><mi id="S3.SS2.p1.5.m5.3.3.1.3.3" xref="S3.SS2.p1.5.m5.3.3.1.3.3.cmml">c</mi></msub><mo id="S3.SS2.p1.5.m5.3.3.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.5.m5.3.3.1.2.cmml">×</mo><mrow id="S3.SS2.p1.5.m5.3.3.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.2.cmml"><mo id="S3.SS2.p1.5.m5.3.3.1.1.1.2" stretchy="false" xref="S3.SS2.p1.5.m5.3.3.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p1.5.m5.3.3.1.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.3.3.1.1.1.1.2" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.2.cmml">P</mi><mi id="S3.SS2.p1.5.m5.3.3.1.1.1.1.3" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS2.p1.5.m5.3.3.1.1.1.3" stretchy="false" xref="S3.SS2.p1.5.m5.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.5b"><apply id="S3.SS2.p1.5.m5.5.6.cmml" xref="S3.SS2.p1.5.m5.5.6"><in id="S3.SS2.p1.5.m5.5.6.1.cmml" xref="S3.SS2.p1.5.m5.5.6.1"></in><apply id="S3.SS2.p1.5.m5.5.6.2.cmml" xref="S3.SS2.p1.5.m5.5.6.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.5.6.2.1.cmml" xref="S3.SS2.p1.5.m5.5.6.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.5.6.2.2.cmml" xref="S3.SS2.p1.5.m5.5.6.2.2">𝐰</ci><list id="S3.SS2.p1.5.m5.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.4"><ci id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">𝑔</ci><ci id="S3.SS2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2">𝑐</ci></list></apply><apply id="S3.SS2.p1.5.m5.5.6.3.cmml" xref="S3.SS2.p1.5.m5.5.6.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.5.6.3.1.cmml" xref="S3.SS2.p1.5.m5.5.6.3">superscript</csymbol><interval closure="closed" id="S3.SS2.p1.5.m5.5.6.3.2.1.cmml" xref="S3.SS2.p1.5.m5.5.6.3.2.2"><cn id="S3.SS2.p1.5.m5.4.4.cmml" type="integer" xref="S3.SS2.p1.5.m5.4.4">0</cn><cn id="S3.SS2.p1.5.m5.5.5.cmml" type="integer" xref="S3.SS2.p1.5.m5.5.5">1</cn></interval><apply id="S3.SS2.p1.5.m5.3.3.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1"><times id="S3.SS2.p1.5.m5.3.3.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.2"></times><apply id="S3.SS2.p1.5.m5.3.3.1.3.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.1.3.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.1.3.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3.2">𝑁</ci><ci id="S3.SS2.p1.5.m5.3.3.1.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3.3">𝑐</ci></apply><apply id="S3.SS2.p1.5.m5.3.3.1.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1"><abs id="S3.SS2.p1.5.m5.3.3.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.2"></abs><apply id="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.2">𝑃</ci><ci id="S3.SS2.p1.5.m5.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.5c">\mathbf{w}_{g,c}\in[0,1]^{N_{c}\times|P_{c}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.5d">bold_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT ∈ [ 0 , 1 ] start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × | italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT</annotation></semantics></math>, where each row is constrained on the probability simplex: <math alttext="{w}_{g,c}^{(\operatorname*{n},\operatorname*{m})}\geq 0" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.4"><semantics id="S3.SS2.p1.6.m6.4a"><mrow id="S3.SS2.p1.6.m6.4.5" xref="S3.SS2.p1.6.m6.4.5.cmml"><msubsup id="S3.SS2.p1.6.m6.4.5.2" xref="S3.SS2.p1.6.m6.4.5.2.cmml"><mi id="S3.SS2.p1.6.m6.4.5.2.2.2" xref="S3.SS2.p1.6.m6.4.5.2.2.2.cmml">w</mi><mrow id="S3.SS2.p1.6.m6.2.2.2.4" xref="S3.SS2.p1.6.m6.2.2.2.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.cmml">g</mi><mo id="S3.SS2.p1.6.m6.2.2.2.4.1" xref="S3.SS2.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.6.m6.2.2.2.2" xref="S3.SS2.p1.6.m6.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.SS2.p1.6.m6.4.4.2.4" xref="S3.SS2.p1.6.m6.4.4.2.3.cmml"><mo id="S3.SS2.p1.6.m6.4.4.2.4.1" stretchy="false" xref="S3.SS2.p1.6.m6.4.4.2.3.cmml">(</mo><mo id="S3.SS2.p1.6.m6.3.3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p1.6.m6.3.3.1.1.cmml">n</mo><mo id="S3.SS2.p1.6.m6.4.4.2.4.2" xref="S3.SS2.p1.6.m6.4.4.2.3.cmml">,</mo><mo id="S3.SS2.p1.6.m6.4.4.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p1.6.m6.4.4.2.2.cmml">m</mo><mo id="S3.SS2.p1.6.m6.4.4.2.4.3" stretchy="false" xref="S3.SS2.p1.6.m6.4.4.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p1.6.m6.4.5.1" xref="S3.SS2.p1.6.m6.4.5.1.cmml">≥</mo><mn id="S3.SS2.p1.6.m6.4.5.3" xref="S3.SS2.p1.6.m6.4.5.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.4b"><apply id="S3.SS2.p1.6.m6.4.5.cmml" xref="S3.SS2.p1.6.m6.4.5"><geq id="S3.SS2.p1.6.m6.4.5.1.cmml" xref="S3.SS2.p1.6.m6.4.5.1"></geq><apply id="S3.SS2.p1.6.m6.4.5.2.cmml" xref="S3.SS2.p1.6.m6.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.4.5.2.1.cmml" xref="S3.SS2.p1.6.m6.4.5.2">superscript</csymbol><apply id="S3.SS2.p1.6.m6.4.5.2.2.cmml" xref="S3.SS2.p1.6.m6.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.4.5.2.2.1.cmml" xref="S3.SS2.p1.6.m6.4.5.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.4.5.2.2.2.cmml" xref="S3.SS2.p1.6.m6.4.5.2.2.2">𝑤</ci><list id="S3.SS2.p1.6.m6.2.2.2.3.cmml" xref="S3.SS2.p1.6.m6.2.2.2.4"><ci id="S3.SS2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1">𝑔</ci><ci id="S3.SS2.p1.6.m6.2.2.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2.2.2">𝑐</ci></list></apply><interval closure="open" id="S3.SS2.p1.6.m6.4.4.2.3.cmml" xref="S3.SS2.p1.6.m6.4.4.2.4"><ci id="S3.SS2.p1.6.m6.3.3.1.1.cmml" xref="S3.SS2.p1.6.m6.3.3.1.1">n</ci><ci id="S3.SS2.p1.6.m6.4.4.2.2.cmml" xref="S3.SS2.p1.6.m6.4.4.2.2">m</ci></interval></apply><cn id="S3.SS2.p1.6.m6.4.5.3.cmml" type="integer" xref="S3.SS2.p1.6.m6.4.5.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.4c">{w}_{g,c}^{(\operatorname*{n},\operatorname*{m})}\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.4d">italic_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_n , roman_m ) end_POSTSUPERSCRIPT ≥ 0</annotation></semantics></math> and <math alttext="\sum_{\operatorname*{m}}{{w}_{g,c}^{(\operatorname*{n},\operatorname*{m})}}=1,%
\forall\operatorname*{n}\in[1,\dots,N_{c}]" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.8"><semantics id="S3.SS2.p1.7.m7.8a"><mrow id="S3.SS2.p1.7.m7.8.8.2" xref="S3.SS2.p1.7.m7.8.8.3.cmml"><mrow id="S3.SS2.p1.7.m7.7.7.1.1" xref="S3.SS2.p1.7.m7.7.7.1.1.cmml"><mrow id="S3.SS2.p1.7.m7.7.7.1.1.2" xref="S3.SS2.p1.7.m7.7.7.1.1.2.cmml"><msub id="S3.SS2.p1.7.m7.7.7.1.1.2.1" xref="S3.SS2.p1.7.m7.7.7.1.1.2.1.cmml"><mo id="S3.SS2.p1.7.m7.7.7.1.1.2.1.2" xref="S3.SS2.p1.7.m7.7.7.1.1.2.1.2.cmml">∑</mo><mo id="S3.SS2.p1.7.m7.7.7.1.1.2.1.3" xref="S3.SS2.p1.7.m7.7.7.1.1.2.1.3.cmml">m</mo></msub><msubsup id="S3.SS2.p1.7.m7.7.7.1.1.2.2" xref="S3.SS2.p1.7.m7.7.7.1.1.2.2.cmml"><mi id="S3.SS2.p1.7.m7.7.7.1.1.2.2.2.2" xref="S3.SS2.p1.7.m7.7.7.1.1.2.2.2.2.cmml">w</mi><mrow id="S3.SS2.p1.7.m7.2.2.2.4" xref="S3.SS2.p1.7.m7.2.2.2.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.cmml">g</mi><mo id="S3.SS2.p1.7.m7.2.2.2.4.1" xref="S3.SS2.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.7.m7.2.2.2.2" xref="S3.SS2.p1.7.m7.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.SS2.p1.7.m7.4.4.2.4" xref="S3.SS2.p1.7.m7.4.4.2.3.cmml"><mo id="S3.SS2.p1.7.m7.4.4.2.4.1" stretchy="false" xref="S3.SS2.p1.7.m7.4.4.2.3.cmml">(</mo><mo id="S3.SS2.p1.7.m7.3.3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p1.7.m7.3.3.1.1.cmml">n</mo><mo id="S3.SS2.p1.7.m7.4.4.2.4.2" xref="S3.SS2.p1.7.m7.4.4.2.3.cmml">,</mo><mo id="S3.SS2.p1.7.m7.4.4.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p1.7.m7.4.4.2.2.cmml">m</mo><mo id="S3.SS2.p1.7.m7.4.4.2.4.3" stretchy="false" xref="S3.SS2.p1.7.m7.4.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS2.p1.7.m7.7.7.1.1.1" xref="S3.SS2.p1.7.m7.7.7.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.7.m7.7.7.1.1.3" xref="S3.SS2.p1.7.m7.7.7.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p1.7.m7.8.8.2.3" xref="S3.SS2.p1.7.m7.8.8.3a.cmml">,</mo><mrow id="S3.SS2.p1.7.m7.8.8.2.2" xref="S3.SS2.p1.7.m7.8.8.2.2.cmml"><mrow id="S3.SS2.p1.7.m7.8.8.2.2.3" xref="S3.SS2.p1.7.m7.8.8.2.2.3.cmml"><mo id="S3.SS2.p1.7.m7.8.8.2.2.3.1" xref="S3.SS2.p1.7.m7.8.8.2.2.3.1.cmml">∀</mo><mo id="S3.SS2.p1.7.m7.8.8.2.2.3.2" lspace="0.167em" rspace="0.1389em" xref="S3.SS2.p1.7.m7.8.8.2.2.3.2.cmml">n</mo></mrow><mo id="S3.SS2.p1.7.m7.8.8.2.2.2" lspace="0.1389em" xref="S3.SS2.p1.7.m7.8.8.2.2.2.cmml">∈</mo><mrow id="S3.SS2.p1.7.m7.8.8.2.2.1.1" xref="S3.SS2.p1.7.m7.8.8.2.2.1.2.cmml"><mo id="S3.SS2.p1.7.m7.8.8.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.7.m7.8.8.2.2.1.2.cmml">[</mo><mn id="S3.SS2.p1.7.m7.5.5" xref="S3.SS2.p1.7.m7.5.5.cmml">1</mn><mo id="S3.SS2.p1.7.m7.8.8.2.2.1.1.3" xref="S3.SS2.p1.7.m7.8.8.2.2.1.2.cmml">,</mo><mi id="S3.SS2.p1.7.m7.6.6" mathvariant="normal" xref="S3.SS2.p1.7.m7.6.6.cmml">…</mi><mo id="S3.SS2.p1.7.m7.8.8.2.2.1.1.4" xref="S3.SS2.p1.7.m7.8.8.2.2.1.2.cmml">,</mo><msub id="S3.SS2.p1.7.m7.8.8.2.2.1.1.1" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.2" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.2.cmml">N</mi><mi id="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.3" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS2.p1.7.m7.8.8.2.2.1.1.5" stretchy="false" xref="S3.SS2.p1.7.m7.8.8.2.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.8b"><apply id="S3.SS2.p1.7.m7.8.8.3.cmml" xref="S3.SS2.p1.7.m7.8.8.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.8.8.3a.cmml" xref="S3.SS2.p1.7.m7.8.8.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p1.7.m7.7.7.1.1.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1"><eq id="S3.SS2.p1.7.m7.7.7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.1"></eq><apply id="S3.SS2.p1.7.m7.7.7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2"><apply id="S3.SS2.p1.7.m7.7.7.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.7.7.1.1.2.1.1.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.1">subscript</csymbol><sum id="S3.SS2.p1.7.m7.7.7.1.1.2.1.2.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.1.2"></sum><ci id="S3.SS2.p1.7.m7.7.7.1.1.2.1.3.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.1.3">m</ci></apply><apply id="S3.SS2.p1.7.m7.7.7.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.7.7.1.1.2.2.1.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.2">superscript</csymbol><apply id="S3.SS2.p1.7.m7.7.7.1.1.2.2.2.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.7.7.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.7.m7.7.7.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.7.m7.7.7.1.1.2.2.2.2">𝑤</ci><list id="S3.SS2.p1.7.m7.2.2.2.3.cmml" xref="S3.SS2.p1.7.m7.2.2.2.4"><ci id="S3.SS2.p1.7.m7.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1">𝑔</ci><ci id="S3.SS2.p1.7.m7.2.2.2.2.cmml" xref="S3.SS2.p1.7.m7.2.2.2.2">𝑐</ci></list></apply><interval closure="open" id="S3.SS2.p1.7.m7.4.4.2.3.cmml" xref="S3.SS2.p1.7.m7.4.4.2.4"><ci id="S3.SS2.p1.7.m7.3.3.1.1.cmml" xref="S3.SS2.p1.7.m7.3.3.1.1">n</ci><ci id="S3.SS2.p1.7.m7.4.4.2.2.cmml" xref="S3.SS2.p1.7.m7.4.4.2.2">m</ci></interval></apply></apply><cn id="S3.SS2.p1.7.m7.7.7.1.1.3.cmml" type="integer" xref="S3.SS2.p1.7.m7.7.7.1.1.3">1</cn></apply><apply id="S3.SS2.p1.7.m7.8.8.2.2.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2"><in id="S3.SS2.p1.7.m7.8.8.2.2.2.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.2"></in><apply id="S3.SS2.p1.7.m7.8.8.2.2.3.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.3"><csymbol cd="latexml" id="S3.SS2.p1.7.m7.8.8.2.2.3.1.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.3.1">for-all</csymbol><ci id="S3.SS2.p1.7.m7.8.8.2.2.3.2.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.3.2">n</ci></apply><list id="S3.SS2.p1.7.m7.8.8.2.2.1.2.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1"><cn id="S3.SS2.p1.7.m7.5.5.cmml" type="integer" xref="S3.SS2.p1.7.m7.5.5">1</cn><ci id="S3.SS2.p1.7.m7.6.6.cmml" xref="S3.SS2.p1.7.m7.6.6">…</ci><apply id="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.2">𝑁</ci><ci id="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.8.8.2.2.1.1.1.3">𝑐</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.8c">\sum_{\operatorname*{m}}{{w}_{g,c}^{(\operatorname*{n},\operatorname*{m})}}=1,%
\forall\operatorname*{n}\in[1,\dots,N_{c}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.8d">∑ start_POSTSUBSCRIPT roman_m end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_n , roman_m ) end_POSTSUPERSCRIPT = 1 , ∀ roman_n ∈ [ 1 , … , italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ]</annotation></semantics></math>. The output group activation for the group <math alttext="g_{c,\operatorname*{n}}(\mathbf{z})" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.3"><semantics id="S3.SS2.p1.8.m8.3a"><mrow id="S3.SS2.p1.8.m8.3.4" xref="S3.SS2.p1.8.m8.3.4.cmml"><msub id="S3.SS2.p1.8.m8.3.4.2" xref="S3.SS2.p1.8.m8.3.4.2.cmml"><mi id="S3.SS2.p1.8.m8.3.4.2.2" xref="S3.SS2.p1.8.m8.3.4.2.2.cmml">g</mi><mrow id="S3.SS2.p1.8.m8.2.2.2.4" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.cmml">c</mi><mo id="S3.SS2.p1.8.m8.2.2.2.4.1" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml">,</mo><mo id="S3.SS2.p1.8.m8.2.2.2.2" lspace="0em" xref="S3.SS2.p1.8.m8.2.2.2.2.cmml">n</mo></mrow></msub><mo id="S3.SS2.p1.8.m8.3.4.1" xref="S3.SS2.p1.8.m8.3.4.1.cmml">⁢</mo><mrow id="S3.SS2.p1.8.m8.3.4.3.2" xref="S3.SS2.p1.8.m8.3.4.cmml"><mo id="S3.SS2.p1.8.m8.3.4.3.2.1" stretchy="false" xref="S3.SS2.p1.8.m8.3.4.cmml">(</mo><mi id="S3.SS2.p1.8.m8.3.3" xref="S3.SS2.p1.8.m8.3.3.cmml">𝐳</mi><mo id="S3.SS2.p1.8.m8.3.4.3.2.2" stretchy="false" xref="S3.SS2.p1.8.m8.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.3b"><apply id="S3.SS2.p1.8.m8.3.4.cmml" xref="S3.SS2.p1.8.m8.3.4"><times id="S3.SS2.p1.8.m8.3.4.1.cmml" xref="S3.SS2.p1.8.m8.3.4.1"></times><apply id="S3.SS2.p1.8.m8.3.4.2.cmml" xref="S3.SS2.p1.8.m8.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.3.4.2.1.cmml" xref="S3.SS2.p1.8.m8.3.4.2">subscript</csymbol><ci id="S3.SS2.p1.8.m8.3.4.2.2.cmml" xref="S3.SS2.p1.8.m8.3.4.2.2">𝑔</ci><list id="S3.SS2.p1.8.m8.2.2.2.3.cmml" xref="S3.SS2.p1.8.m8.2.2.2.4"><ci id="S3.SS2.p1.8.m8.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1">𝑐</ci><ci id="S3.SS2.p1.8.m8.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2">n</ci></list></apply><ci id="S3.SS2.p1.8.m8.3.3.cmml" xref="S3.SS2.p1.8.m8.3.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.3c">g_{c,\operatorname*{n}}(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.3d">italic_g start_POSTSUBSCRIPT italic_c , roman_n end_POSTSUBSCRIPT ( bold_z )</annotation></semantics></math> that combines the prototypes <math alttext="\mathbf{p}_{\operatorname*{m}}\in P_{c}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><mrow id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><msub id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2.2" xref="S3.SS2.p1.9.m9.1.1.2.2.cmml">𝐩</mi><mo id="S3.SS2.p1.9.m9.1.1.2.3" xref="S3.SS2.p1.9.m9.1.1.2.3.cmml">m</mo></msub><mo id="S3.SS2.p1.9.m9.1.1.1" xref="S3.SS2.p1.9.m9.1.1.1.cmml">∈</mo><msub id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><in id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1"></in><apply id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2.2">𝐩</ci><ci id="S3.SS2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.2.3">m</ci></apply><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">𝑃</ci><ci id="S3.SS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathbf{p}_{\operatorname*{m}}\in P_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">bold_p start_POSTSUBSCRIPT roman_m end_POSTSUBSCRIPT ∈ italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> at multiple scales is computed as follows:</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g_{c,\operatorname*{n}}(\mathbf{z})=\prod_{\operatorname*{m}=1,\dots,|P_{c}|}{%
g_{\text{proto}}(\mathbf{z},\mathbf{p}_{\operatorname*{m}})^{{w}_{g,c}^{(%
\operatorname*{n},\operatorname*{m})}}}." class="ltx_Math" display="block" id="S3.E2.m1.12"><semantics id="S3.E2.m1.12a"><mrow id="S3.E2.m1.12.12.1" xref="S3.E2.m1.12.12.1.1.cmml"><mrow id="S3.E2.m1.12.12.1.1" xref="S3.E2.m1.12.12.1.1.cmml"><mrow id="S3.E2.m1.12.12.1.1.3" xref="S3.E2.m1.12.12.1.1.3.cmml"><msub id="S3.E2.m1.12.12.1.1.3.2" xref="S3.E2.m1.12.12.1.1.3.2.cmml"><mi id="S3.E2.m1.12.12.1.1.3.2.2" xref="S3.E2.m1.12.12.1.1.3.2.2.cmml">g</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">c</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mo id="S3.E2.m1.2.2.2.2" lspace="0em" xref="S3.E2.m1.2.2.2.2.cmml">n</mo></mrow></msub><mo id="S3.E2.m1.12.12.1.1.3.1" xref="S3.E2.m1.12.12.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.12.12.1.1.3.3.2" xref="S3.E2.m1.12.12.1.1.3.cmml"><mo id="S3.E2.m1.12.12.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.12.12.1.1.3.cmml">(</mo><mi id="S3.E2.m1.10.10" xref="S3.E2.m1.10.10.cmml">𝐳</mi><mo id="S3.E2.m1.12.12.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.12.12.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.12.12.1.1.2" rspace="0.111em" xref="S3.E2.m1.12.12.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.12.12.1.1.1" xref="S3.E2.m1.12.12.1.1.1.cmml"><munder id="S3.E2.m1.12.12.1.1.1.2" xref="S3.E2.m1.12.12.1.1.1.2.cmml"><mo id="S3.E2.m1.12.12.1.1.1.2.2" movablelimits="false" xref="S3.E2.m1.12.12.1.1.1.2.2.cmml">∏</mo><mrow id="S3.E2.m1.5.5.3" xref="S3.E2.m1.5.5.3.cmml"><mo id="S3.E2.m1.5.5.3.5" rspace="0.1389em" xref="S3.E2.m1.5.5.3.5.cmml">m</mo><mo id="S3.E2.m1.5.5.3.4" lspace="0.1389em" xref="S3.E2.m1.5.5.3.4.cmml">=</mo><mrow id="S3.E2.m1.5.5.3.3.1" xref="S3.E2.m1.5.5.3.3.2.cmml"><mn id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">1</mn><mo id="S3.E2.m1.5.5.3.3.1.2" xref="S3.E2.m1.5.5.3.3.2.cmml">,</mo><mi id="S3.E2.m1.4.4.2.2" mathvariant="normal" xref="S3.E2.m1.4.4.2.2.cmml">…</mi><mo id="S3.E2.m1.5.5.3.3.1.3" xref="S3.E2.m1.5.5.3.3.2.cmml">,</mo><mrow id="S3.E2.m1.5.5.3.3.1.1.1" xref="S3.E2.m1.5.5.3.3.1.1.2.cmml"><mo id="S3.E2.m1.5.5.3.3.1.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.3.3.1.1.2.1.cmml">|</mo><msub id="S3.E2.m1.5.5.3.3.1.1.1.1" xref="S3.E2.m1.5.5.3.3.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.3.3.1.1.1.1.2" xref="S3.E2.m1.5.5.3.3.1.1.1.1.2.cmml">P</mi><mi id="S3.E2.m1.5.5.3.3.1.1.1.1.3" xref="S3.E2.m1.5.5.3.3.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.E2.m1.5.5.3.3.1.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></munder><mrow id="S3.E2.m1.12.12.1.1.1.1" xref="S3.E2.m1.12.12.1.1.1.1.cmml"><msub id="S3.E2.m1.12.12.1.1.1.1.3" xref="S3.E2.m1.12.12.1.1.1.1.3.cmml"><mi id="S3.E2.m1.12.12.1.1.1.1.3.2" xref="S3.E2.m1.12.12.1.1.1.1.3.2.cmml">g</mi><mtext id="S3.E2.m1.12.12.1.1.1.1.3.3" xref="S3.E2.m1.12.12.1.1.1.1.3.3a.cmml">proto</mtext></msub><mo id="S3.E2.m1.12.12.1.1.1.1.2" xref="S3.E2.m1.12.12.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E2.m1.12.12.1.1.1.1.1" xref="S3.E2.m1.12.12.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.12.12.1.1.1.1.1.1.1" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.12.12.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.11.11" xref="S3.E2.m1.11.11.cmml">𝐳</mi><mo id="S3.E2.m1.12.12.1.1.1.1.1.1.1.3" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E2.m1.12.12.1.1.1.1.1.1.1.1" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.2.cmml">𝐩</mi><mo id="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.3.cmml">m</mo></msub><mo id="S3.E2.m1.12.12.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.cmml">)</mo></mrow><msubsup id="S3.E2.m1.9.9.4" xref="S3.E2.m1.9.9.4.cmml"><mi id="S3.E2.m1.9.9.4.6.2" xref="S3.E2.m1.9.9.4.6.2.cmml">w</mi><mrow id="S3.E2.m1.7.7.2.2.2.4" xref="S3.E2.m1.7.7.2.2.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml">g</mi><mo id="S3.E2.m1.7.7.2.2.2.4.1" xref="S3.E2.m1.7.7.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.7.7.2.2.2.2" xref="S3.E2.m1.7.7.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.E2.m1.9.9.4.4.2.4" xref="S3.E2.m1.9.9.4.4.2.3.cmml"><mo id="S3.E2.m1.9.9.4.4.2.4.1" stretchy="false" xref="S3.E2.m1.9.9.4.4.2.3.cmml">(</mo><mo id="S3.E2.m1.8.8.3.3.1.1" lspace="0em" rspace="0em" xref="S3.E2.m1.8.8.3.3.1.1.cmml">n</mo><mo id="S3.E2.m1.9.9.4.4.2.4.2" xref="S3.E2.m1.9.9.4.4.2.3.cmml">,</mo><mo id="S3.E2.m1.9.9.4.4.2.2" lspace="0em" rspace="0em" xref="S3.E2.m1.9.9.4.4.2.2.cmml">m</mo><mo id="S3.E2.m1.9.9.4.4.2.4.3" stretchy="false" xref="S3.E2.m1.9.9.4.4.2.3.cmml">)</mo></mrow></msubsup></msup></mrow></mrow></mrow><mo id="S3.E2.m1.12.12.1.2" lspace="0em" xref="S3.E2.m1.12.12.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.12b"><apply id="S3.E2.m1.12.12.1.1.cmml" xref="S3.E2.m1.12.12.1"><eq id="S3.E2.m1.12.12.1.1.2.cmml" xref="S3.E2.m1.12.12.1.1.2"></eq><apply id="S3.E2.m1.12.12.1.1.3.cmml" xref="S3.E2.m1.12.12.1.1.3"><times id="S3.E2.m1.12.12.1.1.3.1.cmml" xref="S3.E2.m1.12.12.1.1.3.1"></times><apply id="S3.E2.m1.12.12.1.1.3.2.cmml" xref="S3.E2.m1.12.12.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.3.2.1.cmml" xref="S3.E2.m1.12.12.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.12.12.1.1.3.2.2.cmml" xref="S3.E2.m1.12.12.1.1.3.2.2">𝑔</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑐</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">n</ci></list></apply><ci id="S3.E2.m1.10.10.cmml" xref="S3.E2.m1.10.10">𝐳</ci></apply><apply id="S3.E2.m1.12.12.1.1.1.cmml" xref="S3.E2.m1.12.12.1.1.1"><apply id="S3.E2.m1.12.12.1.1.1.2.cmml" xref="S3.E2.m1.12.12.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.1.2.1.cmml" xref="S3.E2.m1.12.12.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E2.m1.12.12.1.1.1.2.2.cmml" xref="S3.E2.m1.12.12.1.1.1.2.2">product</csymbol><apply id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.3"><eq id="S3.E2.m1.5.5.3.4.cmml" xref="S3.E2.m1.5.5.3.4"></eq><ci id="S3.E2.m1.5.5.3.5.cmml" xref="S3.E2.m1.5.5.3.5">m</ci><list id="S3.E2.m1.5.5.3.3.2.cmml" xref="S3.E2.m1.5.5.3.3.1"><cn id="S3.E2.m1.3.3.1.1.cmml" type="integer" xref="S3.E2.m1.3.3.1.1">1</cn><ci id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">…</ci><apply id="S3.E2.m1.5.5.3.3.1.1.2.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1"><abs id="S3.E2.m1.5.5.3.3.1.1.2.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.2"></abs><apply id="S3.E2.m1.5.5.3.3.1.1.1.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.2">𝑃</ci><ci id="S3.E2.m1.5.5.3.3.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1.1.3">𝑐</ci></apply></apply></list></apply></apply><apply id="S3.E2.m1.12.12.1.1.1.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1"><times id="S3.E2.m1.12.12.1.1.1.1.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.2"></times><apply id="S3.E2.m1.12.12.1.1.1.1.3.cmml" xref="S3.E2.m1.12.12.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.1.1.3.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.12.12.1.1.1.1.3.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.3.2">𝑔</ci><ci id="S3.E2.m1.12.12.1.1.1.1.3.3a.cmml" xref="S3.E2.m1.12.12.1.1.1.1.3.3"><mtext id="S3.E2.m1.12.12.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E2.m1.12.12.1.1.1.1.3.3">proto</mtext></ci></apply><apply id="S3.E2.m1.12.12.1.1.1.1.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.1.1.1.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1">superscript</csymbol><interval closure="open" id="S3.E2.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1"><ci id="S3.E2.m1.11.11.cmml" xref="S3.E2.m1.11.11">𝐳</ci><apply id="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.2">𝐩</ci><ci id="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.1.1.3">m</ci></apply></interval><apply id="S3.E2.m1.9.9.4.cmml" xref="S3.E2.m1.9.9.4"><csymbol cd="ambiguous" id="S3.E2.m1.9.9.4.5.cmml" xref="S3.E2.m1.9.9.4">superscript</csymbol><apply id="S3.E2.m1.9.9.4.6.cmml" xref="S3.E2.m1.9.9.4"><csymbol cd="ambiguous" id="S3.E2.m1.9.9.4.6.1.cmml" xref="S3.E2.m1.9.9.4">subscript</csymbol><ci id="S3.E2.m1.9.9.4.6.2.cmml" xref="S3.E2.m1.9.9.4.6.2">𝑤</ci><list id="S3.E2.m1.7.7.2.2.2.3.cmml" xref="S3.E2.m1.7.7.2.2.2.4"><ci id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1">𝑔</ci><ci id="S3.E2.m1.7.7.2.2.2.2.cmml" xref="S3.E2.m1.7.7.2.2.2.2">𝑐</ci></list></apply><interval closure="open" id="S3.E2.m1.9.9.4.4.2.3.cmml" xref="S3.E2.m1.9.9.4.4.2.4"><ci id="S3.E2.m1.8.8.3.3.1.1.cmml" xref="S3.E2.m1.8.8.3.3.1.1">n</ci><ci id="S3.E2.m1.9.9.4.4.2.2.cmml" xref="S3.E2.m1.9.9.4.4.2.2">m</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.12c">g_{c,\operatorname*{n}}(\mathbf{z})=\prod_{\operatorname*{m}=1,\dots,|P_{c}|}{%
g_{\text{proto}}(\mathbf{z},\mathbf{p}_{\operatorname*{m}})^{{w}_{g,c}^{(%
\operatorname*{n},\operatorname*{m})}}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.12d">italic_g start_POSTSUBSCRIPT italic_c , roman_n end_POSTSUBSCRIPT ( bold_z ) = ∏ start_POSTSUBSCRIPT roman_m = 1 , … , | italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT | end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z , bold_p start_POSTSUBSCRIPT roman_m end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_n , roman_m ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.5">The projection on the simplex and the weighted geometric mean are used to learn sparse weight matrices, as group activations can be high only if all prototypes in the group are strongly activated. The linear layer <math alttext="h_{\text{group}}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">h</mi><mtext id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3a.cmml">group</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ℎ</ci><ci id="S3.SS2.p3.1.m1.1.1.3a.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><mtext id="S3.SS2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.1.m1.1.1.3">group</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">h_{\text{group}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT</annotation></semantics></math> is adapted to accommodate groups through a weight matrix <math alttext="\mathbf{w}_{h_{\text{group}}}\in\mathbb{R}^{C\times N}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><msub id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2.2" xref="S3.SS2.p3.2.m2.1.1.2.2.cmml">𝐰</mi><msub id="S3.SS2.p3.2.m2.1.1.2.3" xref="S3.SS2.p3.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2.3.2" xref="S3.SS2.p3.2.m2.1.1.2.3.2.cmml">h</mi><mtext id="S3.SS2.p3.2.m2.1.1.2.3.3" xref="S3.SS2.p3.2.m2.1.1.2.3.3a.cmml">group</mtext></msub></msub><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.3.2" xref="S3.SS2.p3.2.m2.1.1.3.3.2.cmml">C</mi><mo id="S3.SS2.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.2.m2.1.1.3.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><in id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></in><apply id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2.2">𝐰</ci><apply id="S3.SS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3.2">ℎ</ci><ci id="S3.SS2.p3.2.m2.1.1.2.3.3a.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3.3"><mtext id="S3.SS2.p3.2.m2.1.1.2.3.3.cmml" mathsize="50%" xref="S3.SS2.p3.2.m2.1.1.2.3.3">group</mtext></ci></apply></apply><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3"><times id="S3.SS2.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.2">𝐶</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\mathbf{w}_{h_{\text{group}}}\in\mathbb{R}^{C\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">bold_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N=N_{c}\times C" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">N</mi><mo id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml"><msub id="S3.SS2.p3.3.m3.1.1.3.2" xref="S3.SS2.p3.3.m3.1.1.3.2.cmml"><mi id="S3.SS2.p3.3.m3.1.1.3.2.2" xref="S3.SS2.p3.3.m3.1.1.3.2.2.cmml">N</mi><mi id="S3.SS2.p3.3.m3.1.1.3.2.3" xref="S3.SS2.p3.3.m3.1.1.3.2.3.cmml">c</mi></msub><mo id="S3.SS2.p3.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.3.m3.1.1.3.1.cmml">×</mo><mi id="S3.SS2.p3.3.m3.1.1.3.3" xref="S3.SS2.p3.3.m3.1.1.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><eq id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1"></eq><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝑁</ci><apply id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3"><times id="S3.SS2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.3.1"></times><apply id="S3.SS2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.3.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.3.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.3.2.2">𝑁</ci><ci id="S3.SS2.p3.3.m3.1.1.3.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3.2.3">𝑐</ci></apply><ci id="S3.SS2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">N=N_{c}\times C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_N = italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × italic_C</annotation></semantics></math> is the total number of groups, each one containing a sparse combination of the set of <math alttext="M\times S" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">M</mi><mo id="S3.SS2.p3.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><times id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1"></times><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑀</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">M\times S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_M × italic_S</annotation></semantics></math> prototypes. The layer <math alttext="h_{\text{group}}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">h</mi><mtext id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3a.cmml">group</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">ℎ</ci><ci id="S3.SS2.p3.5.m5.1.1.3a.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><mtext id="S3.SS2.p3.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.5.m5.1.1.3">group</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">h_{\text{group}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT</annotation></semantics></math> follows the same initialization process as in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS1" title="3.1 Multi-scale prototype learning ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.1</span></a>, but with group assignment.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Multi-stage training procedure</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In order to train ScaleProtoSeg, we resort to a two-stage training procedure: first, we learn the multi-scale prototypes and project them to the training set patches, without any grouping. Then we learn the prototypes grouping functions with the prototypes fixed. The two stages are illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a> and detailed below.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Stage 1: Multi-scale prototype learning.</h4>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.7">For the multi-scale prototype learning we apply a training procedure similar to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>, which consists of three steps. First, in a warm-up step, the ASPP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite> and the scale-specific prototypes are trained while freezing the rest of the backbone <math alttext="f" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.1.m1.1d">italic_f</annotation></semantics></math> and the last linear layer <math alttext="h_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">ℎ</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3a.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3"><mtext id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">h_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.2.m2.1d">italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math>. Second, we run a joint optimization stage where all the model is trained except the last linear layer <math alttext="h_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2">ℎ</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3a.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3"><mtext id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">h_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.3.m3.1d">italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math>. Third, for all scales <math alttext="s\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS3.SSS0.Px1.p1.4.m4.1a"><mrow id="S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml">s</mi><mo id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1"><in id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2">𝑠</ci><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m4.1c">s\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.4.m4.1d">italic_s ∈ caligraphic_S</annotation></semantics></math>, the prototypes are projected to their nearest vector <math alttext="\mathbf{z}_{s}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS3.SSS0.Px1.p1.5.m5.1a"><msub id="S3.SS3.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml">𝐳</mi><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.2">𝐳</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.5.m5.1c">\mathbf{z}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.5.m5.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> from the training set, and duplicates are removed. The fine-tuning stage from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> is not necessary for ScaleProtoSeg, as we replace the last layer <math alttext="h_{\text{proto}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS3.SSS0.Px1.p1.6.m6.1a"><msub id="S3.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2">ℎ</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3a.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3"><mtext id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m6.1c">h_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.6.m6.1d">italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="h_{\text{group}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS3.SSS0.Px1.p1.7.m7.1a"><msub id="S3.SS3.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.3" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.3a.cmml">group</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.7.m7.1b"><apply id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.2">ℎ</ci><ci id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.3a.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.3"><mtext id="S3.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px1.p1.7.m7.1.1.3">group</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.7.m7.1c">h_{\text{group}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.7.m7.1d">italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT</annotation></semantics></math> in the second stage below. Moreover, contrary to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>, we do not need to run their pruning algorithm, as the sparse grouping mechanism will also enforce a natural decrease in the number of prototypes used.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.12">In all those steps, we apply as a regularization loss the diversity loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>, which aims to prevent the prototypes from activating the same region of an object.
To enforce diversity among scale-specific prototypes, the diversity loss is evaluated independently at each scale <math alttext="s\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p2.1.m1.1a"><mrow id="S3.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml">s</mi><mo id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1"><in id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1"></in><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2">𝑠</ci><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.1.m1.1c">s\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.1.m1.1d">italic_s ∈ caligraphic_S</annotation></semantics></math>.
Indeed, the multi-scale prototype layer aims to represent similar parts across scales with different contextual information. For each class <math alttext="c\in\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p2.2.m2.1a"><mrow id="S3.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml">c</mi><mo id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1"><in id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.1"></in><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.2">𝑐</ci><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.2.m2.1c">c\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.2.m2.1d">italic_c ∈ caligraphic_C</annotation></semantics></math> and scale <math alttext="s\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.3.m3.1"><semantics id="S3.SS3.SSS0.Px1.p2.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml">s</mi><mo id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1"><in id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1"></in><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2">𝑠</ci><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.3.m3.1c">s\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.3.m3.1d">italic_s ∈ caligraphic_S</annotation></semantics></math>, we note <math alttext="P_{s,c}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.4.m4.2"><semantics id="S3.SS3.SSS0.Px1.p2.4.m4.2a"><msub id="S3.SS3.SSS0.Px1.p2.4.m4.2.3" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.2.3.2" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.3.2.cmml">P</mi><mrow id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.4" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.cmml">s</mi><mo id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.4.1" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.4.m4.2b"><apply id="S3.SS3.SSS0.Px1.p2.4.m4.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.4.m4.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.4.m4.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.3.2">𝑃</ci><list id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.4"><ci id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1">𝑠</ci><ci id="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.4.m4.2c">P_{s,c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.4.m4.2d">italic_P start_POSTSUBSCRIPT italic_s , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> as the set of prototypes assigned to <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS3.SSS0.Px1.p2.5.m5.1a"><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.5.m5.1b"><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.5.m5.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.5.m5.1d">italic_c</annotation></semantics></math> and <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS3.SSS0.Px1.p2.6.m6.1a"><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.6.m6.1b"><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.6.m6.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.6.m6.1d">italic_s</annotation></semantics></math>. Furthermore, for the scale-specific feature map <math alttext="f_{s}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS3.SSS0.Px1.p2.7.m7.1a"><mrow id="S3.SS3.SSS0.Px1.p2.7.m7.1.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.cmml"><msub id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.2.cmml">f</mi><mi id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.3" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.3.cmml">s</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.1" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.1.cmml">𝐱</mi><mo id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.7.m7.1b"><apply id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2"><times id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.1"></times><apply id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.2">𝑓</ci><ci id="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.2.2.3">𝑠</ci></apply><ci id="S3.SS3.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.7.m7.1c">f_{s}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.7.m7.1d">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> we note <math alttext="y_{\mathbf{z}}\in\{1,\dots,C\}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.8.m8.3"><semantics id="S3.SS3.SSS0.Px1.p2.8.m8.3a"><mrow id="S3.SS3.SSS0.Px1.p2.8.m8.3.4" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.cmml"><msub id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.2" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.2.cmml">y</mi><mi id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.3" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.3.cmml">𝐳</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.1" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.1.cmml">∈</mo><mrow id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.2" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.1.cmml"><mo id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.1.cmml">{</mo><mn id="S3.SS3.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.cmml">1</mn><mo id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.2.2" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.8.m8.2.2" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.8.m8.2.2.cmml">…</mi><mo id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.2.3" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.8.m8.3.3" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.3.cmml">C</mi><mo id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.2.4" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.8.m8.3b"><apply id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4"><in id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.1"></in><apply id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.2">𝑦</ci><ci id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.2.3">𝐳</ci></apply><set id="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.4.3.2"><cn id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1">1</cn><ci id="S3.SS3.SSS0.Px1.p2.8.m8.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.2.2">…</ci><ci id="S3.SS3.SSS0.Px1.p2.8.m8.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.3.3">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.8.m8.3c">y_{\mathbf{z}}\in\{1,\dots,C\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.8.m8.3d">italic_y start_POSTSUBSCRIPT bold_z end_POSTSUBSCRIPT ∈ { 1 , … , italic_C }</annotation></semantics></math> as the ground truth labels for each vector <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.9.m9.1"><semantics id="S3.SS3.SSS0.Px1.p2.9.m9.1a"><mi id="S3.SS3.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.9.m9.1b"><ci id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.9.m9.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.9.m9.1d">bold_z</annotation></semantics></math> across all scales.
<br class="ltx_break"/>First, for the diversity loss, we define <math alttext="v(f_{s}(\mathbf{x}),\mathbf{p}_{s,\operatorname*{m}})" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.10.m10.5"><semantics id="S3.SS3.SSS0.Px1.p2.10.m10.5a"><mrow id="S3.SS3.SSS0.Px1.p2.10.m10.5.5" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.cmml"><mi id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.4" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.4.cmml">v</mi><mo id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.3" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.3.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.3.cmml"><mo id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.3.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.2.cmml">f</mi><mi id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p2.10.m10.3.3" xref="S3.SS3.SSS0.Px1.p2.10.m10.3.3.cmml">𝐱</mi><mo id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.3.2.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.4" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2.2.cmml">𝐩</mi><mrow id="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.4" xref="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.1.1.cmml">s</mi><mo id="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.4.1" xref="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.3.cmml">,</mo><mo id="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.2" lspace="0em" xref="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.2.cmml">m</mo></mrow></msub><mo id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.5" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.10.m10.5b"><apply id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5"><times id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.3"></times><ci id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.4.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.4">𝑣</ci><interval closure="open" id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2"><apply id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1"><times id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.1"></times><apply id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.2">𝑓</ci><ci id="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.4.4.1.1.1.2.3">𝑠</ci></apply><ci id="S3.SS3.SSS0.Px1.p2.10.m10.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.3.3">𝐱</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.5.5.2.2.2.2">𝐩</ci><list id="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.4"><ci id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.1.1">𝑠</ci><ci id="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.2.2.2.2">m</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.10.m10.5c">v(f_{s}(\mathbf{x}),\mathbf{p}_{s,\operatorname*{m}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.10.m10.5d">italic_v ( italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x ) , bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT )</annotation></semantics></math> as the softmax vector of distances between each vector assigned to a class <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.11.m11.1"><semantics id="S3.SS3.SSS0.Px1.p2.11.m11.1a"><mi id="S3.SS3.SSS0.Px1.p2.11.m11.1.1" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.11.m11.1b"><ci id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.11.m11.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.11.m11.1d">italic_c</annotation></semantics></math>, and a prototype <math alttext="\mathbf{p}_{s,\operatorname*{m}}\in P_{s,c}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.12.m12.4"><semantics id="S3.SS3.SSS0.Px1.p2.12.m12.4a"><mrow id="S3.SS3.SSS0.Px1.p2.12.m12.4.5" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.cmml"><msub id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2.2" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2.2.cmml">𝐩</mi><mrow id="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.4" xref="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.1.1.cmml">s</mi><mo id="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.4.1" xref="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.3.cmml">,</mo><mo id="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.2" lspace="0em" xref="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.2.cmml">m</mo></mrow></msub><mo id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.1" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.1.cmml">∈</mo><msub id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3.2" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3.2.cmml">P</mi><mrow id="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.4" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.12.m12.3.3.1.1" xref="S3.SS3.SSS0.Px1.p2.12.m12.3.3.1.1.cmml">s</mi><mo id="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.4.1" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.2" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.2.cmml">c</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.12.m12.4b"><apply id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5"><in id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.1"></in><apply id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.2.2">𝐩</ci><list id="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.4"><ci id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.1.1">𝑠</ci><ci id="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.2.2.2.2">m</ci></list></apply><apply id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.5.3.2">𝑃</ci><list id="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.4"><ci id="S3.SS3.SSS0.Px1.p2.12.m12.3.3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.3.3.1.1">𝑠</ci><ci id="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.4.4.2.2">𝑐</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.12.m12.4c">\mathbf{p}_{s,\operatorname*{m}}\in P_{s,c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.12.m12.4d">bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ∈ italic_P start_POSTSUBSCRIPT italic_s , italic_c end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S17.EGx1">
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle v(f_{s}(\mathbf{x}),\mathbf{p}_{s,\operatorname*{m}})=" class="ltx_Math" display="inline" id="S3.Ex2.m1.5"><semantics id="S3.Ex2.m1.5a"><mrow id="S3.Ex2.m1.5.5" xref="S3.Ex2.m1.5.5.cmml"><mrow id="S3.Ex2.m1.5.5.2" xref="S3.Ex2.m1.5.5.2.cmml"><mi id="S3.Ex2.m1.5.5.2.4" xref="S3.Ex2.m1.5.5.2.4.cmml">v</mi><mo id="S3.Ex2.m1.5.5.2.3" xref="S3.Ex2.m1.5.5.2.3.cmml">⁢</mo><mrow id="S3.Ex2.m1.5.5.2.2.2" xref="S3.Ex2.m1.5.5.2.2.3.cmml"><mo id="S3.Ex2.m1.5.5.2.2.2.3" stretchy="false" xref="S3.Ex2.m1.5.5.2.2.3.cmml">(</mo><mrow id="S3.Ex2.m1.4.4.1.1.1.1" xref="S3.Ex2.m1.4.4.1.1.1.1.cmml"><msub id="S3.Ex2.m1.4.4.1.1.1.1.2" xref="S3.Ex2.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.4.4.1.1.1.1.2.2" xref="S3.Ex2.m1.4.4.1.1.1.1.2.2.cmml">f</mi><mi id="S3.Ex2.m1.4.4.1.1.1.1.2.3" xref="S3.Ex2.m1.4.4.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.Ex2.m1.4.4.1.1.1.1.1" xref="S3.Ex2.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex2.m1.4.4.1.1.1.1.3.2" xref="S3.Ex2.m1.4.4.1.1.1.1.cmml"><mo id="S3.Ex2.m1.4.4.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex2.m1.4.4.1.1.1.1.cmml">(</mo><mi id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml">𝐱</mi><mo id="S3.Ex2.m1.4.4.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex2.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.5.5.2.2.2.4" xref="S3.Ex2.m1.5.5.2.2.3.cmml">,</mo><msub id="S3.Ex2.m1.5.5.2.2.2.2" xref="S3.Ex2.m1.5.5.2.2.2.2.cmml"><mi id="S3.Ex2.m1.5.5.2.2.2.2.2" xref="S3.Ex2.m1.5.5.2.2.2.2.2.cmml">𝐩</mi><mrow id="S3.Ex2.m1.2.2.2.4" xref="S3.Ex2.m1.2.2.2.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.cmml">s</mi><mo id="S3.Ex2.m1.2.2.2.4.1" xref="S3.Ex2.m1.2.2.2.3.cmml">,</mo><mo id="S3.Ex2.m1.2.2.2.2" lspace="0em" xref="S3.Ex2.m1.2.2.2.2.cmml">m</mo></mrow></msub><mo id="S3.Ex2.m1.5.5.2.2.2.5" stretchy="false" xref="S3.Ex2.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.5.5.3" xref="S3.Ex2.m1.5.5.3.cmml">=</mo><mi id="S3.Ex2.m1.5.5.4" xref="S3.Ex2.m1.5.5.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.5b"><apply id="S3.Ex2.m1.5.5.cmml" xref="S3.Ex2.m1.5.5"><eq id="S3.Ex2.m1.5.5.3.cmml" xref="S3.Ex2.m1.5.5.3"></eq><apply id="S3.Ex2.m1.5.5.2.cmml" xref="S3.Ex2.m1.5.5.2"><times id="S3.Ex2.m1.5.5.2.3.cmml" xref="S3.Ex2.m1.5.5.2.3"></times><ci id="S3.Ex2.m1.5.5.2.4.cmml" xref="S3.Ex2.m1.5.5.2.4">𝑣</ci><interval closure="open" id="S3.Ex2.m1.5.5.2.2.3.cmml" xref="S3.Ex2.m1.5.5.2.2.2"><apply id="S3.Ex2.m1.4.4.1.1.1.1.cmml" xref="S3.Ex2.m1.4.4.1.1.1.1"><times id="S3.Ex2.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex2.m1.4.4.1.1.1.1.1"></times><apply id="S3.Ex2.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex2.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.4.4.1.1.1.1.2.2">𝑓</ci><ci id="S3.Ex2.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.4.4.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3">𝐱</ci></apply><apply id="S3.Ex2.m1.5.5.2.2.2.2.cmml" xref="S3.Ex2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.5.5.2.2.2.2.1.cmml" xref="S3.Ex2.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S3.Ex2.m1.5.5.2.2.2.2.2.cmml" xref="S3.Ex2.m1.5.5.2.2.2.2.2">𝐩</ci><list id="S3.Ex2.m1.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.4"><ci id="S3.Ex2.m1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1">𝑠</ci><ci id="S3.Ex2.m1.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2">m</ci></list></apply></interval></apply><csymbol cd="latexml" id="S3.Ex2.m1.5.5.4.cmml" xref="S3.Ex2.m1.5.5.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.5c">\displaystyle v(f_{s}(\mathbf{x}),\mathbf{p}_{s,\operatorname*{m}})=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.5d">italic_v ( italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x ) , bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{softmax}(\|\mathbf{z}_{s}-\mathbf{p}_{s,\operatorname*{m}}%
\|^{2}:" class="ltx_math_unparsed" display="inline" id="S3.Ex2.m2.2"><semantics id="S3.Ex2.m2.2a"><mrow id="S3.Ex2.m2.2b"><mtext id="S3.Ex2.m2.2.3">softmax</mtext><mrow id="S3.Ex2.m2.2.4"><mo id="S3.Ex2.m2.2.4.1" stretchy="false">(</mo><mo id="S3.Ex2.m2.2.4.2" lspace="0em" rspace="0.167em">∥</mo><msub id="S3.Ex2.m2.2.4.3"><mi id="S3.Ex2.m2.2.4.3.2">𝐳</mi><mi id="S3.Ex2.m2.2.4.3.3">s</mi></msub><mo id="S3.Ex2.m2.2.4.4">−</mo><msub id="S3.Ex2.m2.2.4.5"><mi id="S3.Ex2.m2.2.4.5.2">𝐩</mi><mrow id="S3.Ex2.m2.2.2.2.4"><mi id="S3.Ex2.m2.1.1.1.1">s</mi><mo id="S3.Ex2.m2.2.2.2.4.1">,</mo><mo id="S3.Ex2.m2.2.2.2.2" lspace="0em">m</mo></mrow></msub><msup id="S3.Ex2.m2.2.4.6"><mo id="S3.Ex2.m2.2.4.6.2" lspace="0em" rspace="0.167em">∥</mo><mn id="S3.Ex2.m2.2.4.6.3">2</mn></msup><mo id="S3.Ex2.m2.2.4.7">:</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m2.2c">\displaystyle\text{softmax}(\|\mathbf{z}_{s}-\mathbf{p}_{s,\operatorname*{m}}%
\|^{2}:</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m2.2d">softmax ( ∥ bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - bold_p start_POSTSUBSCRIPT italic_s , roman_m end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT :</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\forall\mathbf{z}_{s}\in f_{s}(\mathbf{x}),y_{\mathbf{z}}=c)" class="ltx_math_unparsed" display="inline" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1b"><mo id="S3.E3.m1.1.2" rspace="0.167em">∀</mo><msub id="S3.E3.m1.1.3"><mi id="S3.E3.m1.1.3.2">𝐳</mi><mi id="S3.E3.m1.1.3.3">s</mi></msub><mo id="S3.E3.m1.1.4">∈</mo><msub id="S3.E3.m1.1.5"><mi id="S3.E3.m1.1.5.2">f</mi><mi id="S3.E3.m1.1.5.3">s</mi></msub><mrow id="S3.E3.m1.1.6"><mo id="S3.E3.m1.1.6.1" stretchy="false">(</mo><mi id="S3.E3.m1.1.1">𝐱</mi><mo id="S3.E3.m1.1.6.2" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.1.7">,</mo><msub id="S3.E3.m1.1.8"><mi id="S3.E3.m1.1.8.2">y</mi><mi id="S3.E3.m1.1.8.3">𝐳</mi></msub><mo id="S3.E3.m1.1.9">=</mo><mi id="S3.E3.m1.1.10">c</mi><mo id="S3.E3.m1.1.11" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\forall\mathbf{z}_{s}\in f_{s}(\mathbf{x}),y_{\mathbf{z}}=c)</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">∀ bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x ) , italic_y start_POSTSUBSCRIPT bold_z end_POSTSUBSCRIPT = italic_c )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.14">Next we use the Jeffrey similarity <math alttext="S_{J}(U_{1},\dots,U_{l})" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.13.m1.3"><semantics id="S3.SS3.SSS0.Px1.p2.13.m1.3a"><mrow id="S3.SS3.SSS0.Px1.p2.13.m1.3.3" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.cmml"><msub id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.cmml"><mi id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.2" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.2.cmml">S</mi><mi id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.3" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.3.cmml">J</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.3" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.3.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.3.cmml"><mo id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.3.cmml">(</mo><msub id="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1" xref="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.2.cmml">U</mi><mn id="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.4" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.13.m1.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.13.m1.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.5" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.2.cmml">U</mi><mi id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.3" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.3.cmml">l</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.6" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.13.m1.3b"><apply id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3"><times id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.3"></times><apply id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.2.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.2">𝑆</ci><ci id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.4.3">𝐽</ci></apply><vector id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2"><apply id="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.2">𝑈</ci><cn id="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p2.13.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS0.Px1.p2.13.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.1.1">…</ci><apply id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.2">𝑈</ci><ci id="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m1.3.3.2.2.2.3">𝑙</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.13.m1.3c">S_{J}(U_{1},\dots,U_{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.13.m1.3d">italic_S start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ( italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_U start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> as a measure of similarity between distributions <math alttext="(U_{1},\dots,U_{l})" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.14.m2.3"><semantics id="S3.SS3.SSS0.Px1.p2.14.m2.3a"><mrow id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.3.cmml"><mo id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.3.cmml">(</mo><msub id="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1" xref="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.2" xref="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.2.cmml">U</mi><mn id="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.3" xref="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.4" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.14.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p2.14.m2.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.5" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.2" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.2.cmml">U</mi><mi id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.3" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.3.cmml">l</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.6" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.14.m2.3b"><vector id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2"><apply id="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.2">𝑈</ci><cn id="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p2.14.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.SSS0.Px1.p2.14.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.1.1">…</ci><apply id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.2">𝑈</ci><ci id="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.14.m2.3.3.2.2.3">𝑙</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.14.m2.3c">(U_{1},\dots,U_{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.14.m2.3d">( italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_U start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math>, following ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S_{J}(U_{1},\dots,U_{l})=\frac{1}{\binom{l}{2}}\sum_{i&lt;j}\exp(-D_{J}(U_{i},U_{%
j}))" class="ltx_Math" display="block" id="S3.E4.m1.7"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml"><mrow id="S3.E4.m1.6.6.2" xref="S3.E4.m1.6.6.2.cmml"><msub id="S3.E4.m1.6.6.2.4" xref="S3.E4.m1.6.6.2.4.cmml"><mi id="S3.E4.m1.6.6.2.4.2" xref="S3.E4.m1.6.6.2.4.2.cmml">S</mi><mi id="S3.E4.m1.6.6.2.4.3" xref="S3.E4.m1.6.6.2.4.3.cmml">J</mi></msub><mo id="S3.E4.m1.6.6.2.3" xref="S3.E4.m1.6.6.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.2.2.2" xref="S3.E4.m1.6.6.2.2.3.cmml"><mo id="S3.E4.m1.6.6.2.2.2.3" stretchy="false" xref="S3.E4.m1.6.6.2.2.3.cmml">(</mo><msub id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">U</mi><mn id="S3.E4.m1.5.5.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E4.m1.6.6.2.2.2.4" xref="S3.E4.m1.6.6.2.2.3.cmml">,</mo><mi id="S3.E4.m1.3.3" mathvariant="normal" xref="S3.E4.m1.3.3.cmml">…</mi><mo id="S3.E4.m1.6.6.2.2.2.5" xref="S3.E4.m1.6.6.2.2.3.cmml">,</mo><msub id="S3.E4.m1.6.6.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.cmml"><mi id="S3.E4.m1.6.6.2.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.2.cmml">U</mi><mi id="S3.E4.m1.6.6.2.2.2.2.3" xref="S3.E4.m1.6.6.2.2.2.2.3.cmml">l</mi></msub><mo id="S3.E4.m1.6.6.2.2.2.6" stretchy="false" xref="S3.E4.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.4" xref="S3.E4.m1.7.7.4.cmml">=</mo><mrow id="S3.E4.m1.7.7.3" xref="S3.E4.m1.7.7.3.cmml"><mfrac id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><mn id="S3.E4.m1.2.2.4" xref="S3.E4.m1.2.2.4.cmml">1</mn><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.1.cmml">(</mo><mfrac id="S3.E4.m1.2.2.2.2.2.2" linethickness="0pt" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">l</mi><mn id="S3.E4.m1.2.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.2.1.cmml">2</mn></mfrac><mo id="S3.E4.m1.2.2.2.4.2" xref="S3.E4.m1.2.2.2.3.1.cmml">)</mo></mrow></mfrac><mo id="S3.E4.m1.7.7.3.2" xref="S3.E4.m1.7.7.3.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.3.1" xref="S3.E4.m1.7.7.3.1.cmml"><munder id="S3.E4.m1.7.7.3.1.2" xref="S3.E4.m1.7.7.3.1.2.cmml"><mo id="S3.E4.m1.7.7.3.1.2.2" movablelimits="false" xref="S3.E4.m1.7.7.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.7.7.3.1.2.3" xref="S3.E4.m1.7.7.3.1.2.3.cmml"><mi id="S3.E4.m1.7.7.3.1.2.3.2" xref="S3.E4.m1.7.7.3.1.2.3.2.cmml">i</mi><mo id="S3.E4.m1.7.7.3.1.2.3.1" xref="S3.E4.m1.7.7.3.1.2.3.1.cmml">&lt;</mo><mi id="S3.E4.m1.7.7.3.1.2.3.3" xref="S3.E4.m1.7.7.3.1.2.3.3.cmml">j</mi></mrow></munder><mrow id="S3.E4.m1.7.7.3.1.1.1" xref="S3.E4.m1.7.7.3.1.1.2.cmml"><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">exp</mi><mo id="S3.E4.m1.7.7.3.1.1.1a" xref="S3.E4.m1.7.7.3.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.7.7.3.1.1.1.1" xref="S3.E4.m1.7.7.3.1.1.2.cmml"><mo id="S3.E4.m1.7.7.3.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.7.7.3.1.1.2.cmml">(</mo><mrow id="S3.E4.m1.7.7.3.1.1.1.1.1" xref="S3.E4.m1.7.7.3.1.1.1.1.1.cmml"><mo id="S3.E4.m1.7.7.3.1.1.1.1.1a" xref="S3.E4.m1.7.7.3.1.1.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.7.7.3.1.1.1.1.1.2" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.cmml"><msub id="S3.E4.m1.7.7.3.1.1.1.1.1.2.4" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.cmml"><mi id="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.2" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.2.cmml">D</mi><mi id="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.3" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.3.cmml">J</mi></msub><mo id="S3.E4.m1.7.7.3.1.1.1.1.1.2.3" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.2.cmml">U</mi><mi id="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.4" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.2.cmml">U</mi><mi id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.7.7.3.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.7.7.3.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7"><eq id="S3.E4.m1.7.7.4.cmml" xref="S3.E4.m1.7.7.4"></eq><apply id="S3.E4.m1.6.6.2.cmml" xref="S3.E4.m1.6.6.2"><times id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.3"></times><apply id="S3.E4.m1.6.6.2.4.cmml" xref="S3.E4.m1.6.6.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.4.1.cmml" xref="S3.E4.m1.6.6.2.4">subscript</csymbol><ci id="S3.E4.m1.6.6.2.4.2.cmml" xref="S3.E4.m1.6.6.2.4.2">𝑆</ci><ci id="S3.E4.m1.6.6.2.4.3.cmml" xref="S3.E4.m1.6.6.2.4.3">𝐽</ci></apply><vector id="S3.E4.m1.6.6.2.2.3.cmml" xref="S3.E4.m1.6.6.2.2.2"><apply id="S3.E4.m1.5.5.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.2">𝑈</ci><cn id="S3.E4.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.5.5.1.1.1.1.3">1</cn></apply><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">…</ci><apply id="S3.E4.m1.6.6.2.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.2.2.2.1.cmml" xref="S3.E4.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.6.6.2.2.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.2.2.2">𝑈</ci><ci id="S3.E4.m1.6.6.2.2.2.2.3.cmml" xref="S3.E4.m1.6.6.2.2.2.2.3">𝑙</ci></apply></vector></apply><apply id="S3.E4.m1.7.7.3.cmml" xref="S3.E4.m1.7.7.3"><times id="S3.E4.m1.7.7.3.2.cmml" xref="S3.E4.m1.7.7.3.2"></times><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><divide id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2"></divide><cn id="S3.E4.m1.2.2.4.cmml" type="integer" xref="S3.E4.m1.2.2.4">1</cn><apply id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><csymbol cd="latexml" id="S3.E4.m1.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.2.4.1">binomial</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1">𝑙</ci><cn id="S3.E4.m1.2.2.2.2.2.2.2.1.cmml" type="integer" xref="S3.E4.m1.2.2.2.2.2.2.2.1">2</cn></apply></apply><apply id="S3.E4.m1.7.7.3.1.cmml" xref="S3.E4.m1.7.7.3.1"><apply id="S3.E4.m1.7.7.3.1.2.cmml" xref="S3.E4.m1.7.7.3.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.1.2.1.cmml" xref="S3.E4.m1.7.7.3.1.2">subscript</csymbol><sum id="S3.E4.m1.7.7.3.1.2.2.cmml" xref="S3.E4.m1.7.7.3.1.2.2"></sum><apply id="S3.E4.m1.7.7.3.1.2.3.cmml" xref="S3.E4.m1.7.7.3.1.2.3"><lt id="S3.E4.m1.7.7.3.1.2.3.1.cmml" xref="S3.E4.m1.7.7.3.1.2.3.1"></lt><ci id="S3.E4.m1.7.7.3.1.2.3.2.cmml" xref="S3.E4.m1.7.7.3.1.2.3.2">𝑖</ci><ci id="S3.E4.m1.7.7.3.1.2.3.3.cmml" xref="S3.E4.m1.7.7.3.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.7.7.3.1.1.2.cmml" xref="S3.E4.m1.7.7.3.1.1.1"><exp id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"></exp><apply id="S3.E4.m1.7.7.3.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1"><minus id="S3.E4.m1.7.7.3.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1"></minus><apply id="S3.E4.m1.7.7.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2"><times id="S3.E4.m1.7.7.3.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.3"></times><apply id="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.1.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.2.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.2">𝐷</ci><ci id="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.3.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.4.3">𝐽</ci></apply><interval closure="open" id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2"><apply id="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.2">𝑈</ci><ci id="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.2">𝑈</ci><ci id="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.7.7.3.1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">S_{J}(U_{1},\dots,U_{l})=\frac{1}{\binom{l}{2}}\sum_{i&lt;j}\exp(-D_{J}(U_{i},U_{%
j}))</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.7d">italic_S start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ( italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_U start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG ( FRACOP start_ARG italic_l end_ARG start_ARG 2 end_ARG ) end_ARG ∑ start_POSTSUBSCRIPT italic_i &lt; italic_j end_POSTSUBSCRIPT roman_exp ( - italic_D start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ( italic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.17">with <math alttext="D_{J}(U,V)" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.15.m1.2"><semantics id="S3.SS3.SSS0.Px1.p2.15.m1.2a"><mrow id="S3.SS3.SSS0.Px1.p2.15.m1.2.3" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.cmml"><msub id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.2" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.2.cmml">D</mi><mi id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.3" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.3.cmml">J</mi></msub><mo id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.2" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.1.cmml"><mo id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p2.15.m1.1.1" xref="S3.SS3.SSS0.Px1.p2.15.m1.1.1.cmml">U</mi><mo id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.2.2" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.15.m1.2.2" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.2.cmml">V</mi><mo id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.15.m1.2b"><apply id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3"><times id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.1"></times><apply id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.2">𝐷</ci><ci id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.2.3">𝐽</ci></apply><interval closure="open" id="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.3.3.2"><ci id="S3.SS3.SSS0.Px1.p2.15.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.1.1">𝑈</ci><ci id="S3.SS3.SSS0.Px1.p2.15.m1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.15.m1.2.2">𝑉</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.15.m1.2c">D_{J}(U,V)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.15.m1.2d">italic_D start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ( italic_U , italic_V )</annotation></semantics></math> the Jeffrey’s divergence defined in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib41" title="">41</a>]</cite>. The diversity loss is then computed as follows for a given class <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.16.m2.1"><semantics id="S3.SS3.SSS0.Px1.p2.16.m2.1a"><mi id="S3.SS3.SSS0.Px1.p2.16.m2.1.1" xref="S3.SS3.SSS0.Px1.p2.16.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.16.m2.1b"><ci id="S3.SS3.SSS0.Px1.p2.16.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.16.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.16.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.16.m2.1d">italic_c</annotation></semantics></math> and scale <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.17.m3.1"><semantics id="S3.SS3.SSS0.Px1.p2.17.m3.1a"><mi id="S3.SS3.SSS0.Px1.p2.17.m3.1.1" xref="S3.SS3.SSS0.Px1.p2.17.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.17.m3.1b"><ci id="S3.SS3.SSS0.Px1.p2.17.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.17.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.17.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.17.m3.1d">italic_s</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S17.EGx2">
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{J}(f_{s}(\mathbf{x}),P_{s,c})=" class="ltx_Math" display="inline" id="S3.Ex3.m1.5"><semantics id="S3.Ex3.m1.5a"><mrow id="S3.Ex3.m1.5.5" xref="S3.Ex3.m1.5.5.cmml"><mrow id="S3.Ex3.m1.5.5.2" xref="S3.Ex3.m1.5.5.2.cmml"><msub id="S3.Ex3.m1.5.5.2.4" xref="S3.Ex3.m1.5.5.2.4.cmml"><mi id="S3.Ex3.m1.5.5.2.4.2" xref="S3.Ex3.m1.5.5.2.4.2.cmml">L</mi><mi id="S3.Ex3.m1.5.5.2.4.3" xref="S3.Ex3.m1.5.5.2.4.3.cmml">J</mi></msub><mo id="S3.Ex3.m1.5.5.2.3" xref="S3.Ex3.m1.5.5.2.3.cmml">⁢</mo><mrow id="S3.Ex3.m1.5.5.2.2.2" xref="S3.Ex3.m1.5.5.2.2.3.cmml"><mo id="S3.Ex3.m1.5.5.2.2.2.3" stretchy="false" xref="S3.Ex3.m1.5.5.2.2.3.cmml">(</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.cmml"><msub id="S3.Ex3.m1.4.4.1.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.Ex3.m1.4.4.1.1.1.1.2.2" xref="S3.Ex3.m1.4.4.1.1.1.1.2.2.cmml">f</mi><mi id="S3.Ex3.m1.4.4.1.1.1.1.2.3" xref="S3.Ex3.m1.4.4.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.Ex3.m1.4.4.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.1.3.2" xref="S3.Ex3.m1.4.4.1.1.1.1.cmml"><mo id="S3.Ex3.m1.4.4.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex3.m1.4.4.1.1.1.1.cmml">(</mo><mi id="S3.Ex3.m1.3.3" xref="S3.Ex3.m1.3.3.cmml">𝐱</mi><mo id="S3.Ex3.m1.4.4.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex3.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.5.5.2.2.2.4" xref="S3.Ex3.m1.5.5.2.2.3.cmml">,</mo><msub id="S3.Ex3.m1.5.5.2.2.2.2" xref="S3.Ex3.m1.5.5.2.2.2.2.cmml"><mi id="S3.Ex3.m1.5.5.2.2.2.2.2" xref="S3.Ex3.m1.5.5.2.2.2.2.2.cmml">P</mi><mrow id="S3.Ex3.m1.2.2.2.4" xref="S3.Ex3.m1.2.2.2.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml">s</mi><mo id="S3.Ex3.m1.2.2.2.4.1" xref="S3.Ex3.m1.2.2.2.3.cmml">,</mo><mi id="S3.Ex3.m1.2.2.2.2" xref="S3.Ex3.m1.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S3.Ex3.m1.5.5.2.2.2.5" stretchy="false" xref="S3.Ex3.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.5.5.3" xref="S3.Ex3.m1.5.5.3.cmml">=</mo><mi id="S3.Ex3.m1.5.5.4" xref="S3.Ex3.m1.5.5.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.5b"><apply id="S3.Ex3.m1.5.5.cmml" xref="S3.Ex3.m1.5.5"><eq id="S3.Ex3.m1.5.5.3.cmml" xref="S3.Ex3.m1.5.5.3"></eq><apply id="S3.Ex3.m1.5.5.2.cmml" xref="S3.Ex3.m1.5.5.2"><times id="S3.Ex3.m1.5.5.2.3.cmml" xref="S3.Ex3.m1.5.5.2.3"></times><apply id="S3.Ex3.m1.5.5.2.4.cmml" xref="S3.Ex3.m1.5.5.2.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.5.5.2.4.1.cmml" xref="S3.Ex3.m1.5.5.2.4">subscript</csymbol><ci id="S3.Ex3.m1.5.5.2.4.2.cmml" xref="S3.Ex3.m1.5.5.2.4.2">𝐿</ci><ci id="S3.Ex3.m1.5.5.2.4.3.cmml" xref="S3.Ex3.m1.5.5.2.4.3">𝐽</ci></apply><interval closure="open" id="S3.Ex3.m1.5.5.2.2.3.cmml" xref="S3.Ex3.m1.5.5.2.2.2"><apply id="S3.Ex3.m1.4.4.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1"><times id="S3.Ex3.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1"></times><apply id="S3.Ex3.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex3.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.2.2">𝑓</ci><ci id="S3.Ex3.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.Ex3.m1.3.3.cmml" xref="S3.Ex3.m1.3.3">𝐱</ci></apply><apply id="S3.Ex3.m1.5.5.2.2.2.2.cmml" xref="S3.Ex3.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.5.5.2.2.2.2.1.cmml" xref="S3.Ex3.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S3.Ex3.m1.5.5.2.2.2.2.2.cmml" xref="S3.Ex3.m1.5.5.2.2.2.2.2">𝑃</ci><list id="S3.Ex3.m1.2.2.2.3.cmml" xref="S3.Ex3.m1.2.2.2.4"><ci id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1">𝑠</ci><ci id="S3.Ex3.m1.2.2.2.2.cmml" xref="S3.Ex3.m1.2.2.2.2">𝑐</ci></list></apply></interval></apply><csymbol cd="latexml" id="S3.Ex3.m1.5.5.4.cmml" xref="S3.Ex3.m1.5.5.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.5c">\displaystyle L_{J}(f_{s}(\mathbf{x}),P_{s,c})=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.5d">italic_L start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x ) , italic_P start_POSTSUBSCRIPT italic_s , italic_c end_POSTSUBSCRIPT ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle S_{J}(v(f_{s}(\mathbf{x}),\mathbf{p}_{s,1}),\dots," class="ltx_math_unparsed" display="inline" id="S3.Ex3.m2.4"><semantics id="S3.Ex3.m2.4a"><mrow id="S3.Ex3.m2.4b"><msub id="S3.Ex3.m2.4.5"><mi id="S3.Ex3.m2.4.5.2">S</mi><mi id="S3.Ex3.m2.4.5.3">J</mi></msub><mrow id="S3.Ex3.m2.4.6"><mo id="S3.Ex3.m2.4.6.1" stretchy="false">(</mo><mi id="S3.Ex3.m2.4.6.2">v</mi><mrow id="S3.Ex3.m2.4.6.3"><mo id="S3.Ex3.m2.4.6.3.1" stretchy="false">(</mo><msub id="S3.Ex3.m2.4.6.3.2"><mi id="S3.Ex3.m2.4.6.3.2.2">f</mi><mi id="S3.Ex3.m2.4.6.3.2.3">s</mi></msub><mrow id="S3.Ex3.m2.4.6.3.3"><mo id="S3.Ex3.m2.4.6.3.3.1" stretchy="false">(</mo><mi id="S3.Ex3.m2.3.3">𝐱</mi><mo id="S3.Ex3.m2.4.6.3.3.2" stretchy="false">)</mo></mrow><mo id="S3.Ex3.m2.4.6.3.4">,</mo><msub id="S3.Ex3.m2.4.6.3.5"><mi id="S3.Ex3.m2.4.6.3.5.2">𝐩</mi><mrow id="S3.Ex3.m2.2.2.2.4"><mi id="S3.Ex3.m2.1.1.1.1">s</mi><mo id="S3.Ex3.m2.2.2.2.4.1">,</mo><mn id="S3.Ex3.m2.2.2.2.2">1</mn></mrow></msub><mo id="S3.Ex3.m2.4.6.3.6" stretchy="false">)</mo></mrow><mo id="S3.Ex3.m2.4.6.4">,</mo><mi id="S3.Ex3.m2.4.4" mathvariant="normal">…</mi><mo id="S3.Ex3.m2.4.6.5">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex3.m2.4c">\displaystyle S_{J}(v(f_{s}(\mathbf{x}),\mathbf{p}_{s,1}),\dots,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m2.4d">italic_S start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ( italic_v ( italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x ) , bold_p start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT ) , … ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle v(f_{s}(\mathbf{x}),\mathbf{p}_{s,M}))" class="ltx_math_unparsed" display="inline" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3b"><mi id="S3.E5.m1.3.4">v</mi><mrow id="S3.E5.m1.3.5"><mo id="S3.E5.m1.3.5.1" stretchy="false">(</mo><msub id="S3.E5.m1.3.5.2"><mi id="S3.E5.m1.3.5.2.2">f</mi><mi id="S3.E5.m1.3.5.2.3">s</mi></msub><mrow id="S3.E5.m1.3.5.3"><mo id="S3.E5.m1.3.5.3.1" stretchy="false">(</mo><mi id="S3.E5.m1.3.3">𝐱</mi><mo id="S3.E5.m1.3.5.3.2" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.5.4">,</mo><msub id="S3.E5.m1.3.5.5"><mi id="S3.E5.m1.3.5.5.2">𝐩</mi><mrow id="S3.E5.m1.2.2.2.4"><mi id="S3.E5.m1.1.1.1.1">s</mi><mo id="S3.E5.m1.2.2.2.4.1">,</mo><mi id="S3.E5.m1.2.2.2.2">M</mi></mrow></msub><mo id="S3.E5.m1.3.5.6" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.6" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\displaystyle v(f_{s}(\mathbf{x}),\mathbf{p}_{s,M}))</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">italic_v ( italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x ) , bold_p start_POSTSUBSCRIPT italic_s , italic_M end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.20">and the total loss across all classes and scales is:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{J}=\frac{1}{C\cdot S}\sum_{c\in\mathcal{C}}\sum_{s\in\mathcal{S}}L_{J}(f_{s%
}(\mathbf{x}),P_{s,c})" class="ltx_Math" display="block" id="S3.E6.m1.5"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><msub id="S3.E6.m1.5.5.4" xref="S3.E6.m1.5.5.4.cmml"><mi id="S3.E6.m1.5.5.4.2" xref="S3.E6.m1.5.5.4.2.cmml">L</mi><mi id="S3.E6.m1.5.5.4.3" xref="S3.E6.m1.5.5.4.3.cmml">J</mi></msub><mo id="S3.E6.m1.5.5.3" xref="S3.E6.m1.5.5.3.cmml">=</mo><mrow id="S3.E6.m1.5.5.2" xref="S3.E6.m1.5.5.2.cmml"><mfrac id="S3.E6.m1.5.5.2.4" xref="S3.E6.m1.5.5.2.4.cmml"><mn id="S3.E6.m1.5.5.2.4.2" xref="S3.E6.m1.5.5.2.4.2.cmml">1</mn><mrow id="S3.E6.m1.5.5.2.4.3" xref="S3.E6.m1.5.5.2.4.3.cmml"><mi id="S3.E6.m1.5.5.2.4.3.2" xref="S3.E6.m1.5.5.2.4.3.2.cmml">C</mi><mo id="S3.E6.m1.5.5.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.5.5.2.4.3.1.cmml">⋅</mo><mi id="S3.E6.m1.5.5.2.4.3.3" xref="S3.E6.m1.5.5.2.4.3.3.cmml">S</mi></mrow></mfrac><mo id="S3.E6.m1.5.5.2.3" xref="S3.E6.m1.5.5.2.3.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.2.2" xref="S3.E6.m1.5.5.2.2.cmml"><munder id="S3.E6.m1.5.5.2.2.3" xref="S3.E6.m1.5.5.2.2.3.cmml"><mo id="S3.E6.m1.5.5.2.2.3.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.5.5.2.2.3.2.cmml">∑</mo><mrow id="S3.E6.m1.5.5.2.2.3.3" xref="S3.E6.m1.5.5.2.2.3.3.cmml"><mi id="S3.E6.m1.5.5.2.2.3.3.2" xref="S3.E6.m1.5.5.2.2.3.3.2.cmml">c</mi><mo id="S3.E6.m1.5.5.2.2.3.3.1" xref="S3.E6.m1.5.5.2.2.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.2.2.3.3.3" xref="S3.E6.m1.5.5.2.2.3.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S3.E6.m1.5.5.2.2.2" xref="S3.E6.m1.5.5.2.2.2.cmml"><munder id="S3.E6.m1.5.5.2.2.2.3" xref="S3.E6.m1.5.5.2.2.2.3.cmml"><mo id="S3.E6.m1.5.5.2.2.2.3.2" movablelimits="false" xref="S3.E6.m1.5.5.2.2.2.3.2.cmml">∑</mo><mrow id="S3.E6.m1.5.5.2.2.2.3.3" xref="S3.E6.m1.5.5.2.2.2.3.3.cmml"><mi id="S3.E6.m1.5.5.2.2.2.3.3.2" xref="S3.E6.m1.5.5.2.2.2.3.3.2.cmml">s</mi><mo id="S3.E6.m1.5.5.2.2.2.3.3.1" xref="S3.E6.m1.5.5.2.2.2.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.2.2.2.3.3.3" xref="S3.E6.m1.5.5.2.2.2.3.3.3.cmml">𝒮</mi></mrow></munder><mrow id="S3.E6.m1.5.5.2.2.2.2" xref="S3.E6.m1.5.5.2.2.2.2.cmml"><msub id="S3.E6.m1.5.5.2.2.2.2.4" xref="S3.E6.m1.5.5.2.2.2.2.4.cmml"><mi id="S3.E6.m1.5.5.2.2.2.2.4.2" xref="S3.E6.m1.5.5.2.2.2.2.4.2.cmml">L</mi><mi id="S3.E6.m1.5.5.2.2.2.2.4.3" xref="S3.E6.m1.5.5.2.2.2.2.4.3.cmml">J</mi></msub><mo id="S3.E6.m1.5.5.2.2.2.2.3" xref="S3.E6.m1.5.5.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.2.2.2.2.2.2" xref="S3.E6.m1.5.5.2.2.2.2.2.3.cmml"><mo id="S3.E6.m1.5.5.2.2.2.2.2.2.3" stretchy="false" xref="S3.E6.m1.5.5.2.2.2.2.2.3.cmml">(</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">𝐱</mi><mo id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.5.5.2.2.2.2.2.2.4" xref="S3.E6.m1.5.5.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E6.m1.5.5.2.2.2.2.2.2.2" xref="S3.E6.m1.5.5.2.2.2.2.2.2.2.cmml"><mi id="S3.E6.m1.5.5.2.2.2.2.2.2.2.2" xref="S3.E6.m1.5.5.2.2.2.2.2.2.2.2.cmml">P</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S3.E6.m1.5.5.2.2.2.2.2.2.5" stretchy="false" xref="S3.E6.m1.5.5.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><eq id="S3.E6.m1.5.5.3.cmml" xref="S3.E6.m1.5.5.3"></eq><apply id="S3.E6.m1.5.5.4.cmml" xref="S3.E6.m1.5.5.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.4.1.cmml" xref="S3.E6.m1.5.5.4">subscript</csymbol><ci id="S3.E6.m1.5.5.4.2.cmml" xref="S3.E6.m1.5.5.4.2">𝐿</ci><ci id="S3.E6.m1.5.5.4.3.cmml" xref="S3.E6.m1.5.5.4.3">𝐽</ci></apply><apply id="S3.E6.m1.5.5.2.cmml" xref="S3.E6.m1.5.5.2"><times id="S3.E6.m1.5.5.2.3.cmml" xref="S3.E6.m1.5.5.2.3"></times><apply id="S3.E6.m1.5.5.2.4.cmml" xref="S3.E6.m1.5.5.2.4"><divide id="S3.E6.m1.5.5.2.4.1.cmml" xref="S3.E6.m1.5.5.2.4"></divide><cn id="S3.E6.m1.5.5.2.4.2.cmml" type="integer" xref="S3.E6.m1.5.5.2.4.2">1</cn><apply id="S3.E6.m1.5.5.2.4.3.cmml" xref="S3.E6.m1.5.5.2.4.3"><ci id="S3.E6.m1.5.5.2.4.3.1.cmml" xref="S3.E6.m1.5.5.2.4.3.1">⋅</ci><ci id="S3.E6.m1.5.5.2.4.3.2.cmml" xref="S3.E6.m1.5.5.2.4.3.2">𝐶</ci><ci id="S3.E6.m1.5.5.2.4.3.3.cmml" xref="S3.E6.m1.5.5.2.4.3.3">𝑆</ci></apply></apply><apply id="S3.E6.m1.5.5.2.2.cmml" xref="S3.E6.m1.5.5.2.2"><apply id="S3.E6.m1.5.5.2.2.3.cmml" xref="S3.E6.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.2.3.1.cmml" xref="S3.E6.m1.5.5.2.2.3">subscript</csymbol><sum id="S3.E6.m1.5.5.2.2.3.2.cmml" xref="S3.E6.m1.5.5.2.2.3.2"></sum><apply id="S3.E6.m1.5.5.2.2.3.3.cmml" xref="S3.E6.m1.5.5.2.2.3.3"><in id="S3.E6.m1.5.5.2.2.3.3.1.cmml" xref="S3.E6.m1.5.5.2.2.3.3.1"></in><ci id="S3.E6.m1.5.5.2.2.3.3.2.cmml" xref="S3.E6.m1.5.5.2.2.3.3.2">𝑐</ci><ci id="S3.E6.m1.5.5.2.2.3.3.3.cmml" xref="S3.E6.m1.5.5.2.2.3.3.3">𝒞</ci></apply></apply><apply id="S3.E6.m1.5.5.2.2.2.cmml" xref="S3.E6.m1.5.5.2.2.2"><apply id="S3.E6.m1.5.5.2.2.2.3.cmml" xref="S3.E6.m1.5.5.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.2.2.3.1.cmml" xref="S3.E6.m1.5.5.2.2.2.3">subscript</csymbol><sum id="S3.E6.m1.5.5.2.2.2.3.2.cmml" xref="S3.E6.m1.5.5.2.2.2.3.2"></sum><apply id="S3.E6.m1.5.5.2.2.2.3.3.cmml" xref="S3.E6.m1.5.5.2.2.2.3.3"><in id="S3.E6.m1.5.5.2.2.2.3.3.1.cmml" xref="S3.E6.m1.5.5.2.2.2.3.3.1"></in><ci id="S3.E6.m1.5.5.2.2.2.3.3.2.cmml" xref="S3.E6.m1.5.5.2.2.2.3.3.2">𝑠</ci><ci id="S3.E6.m1.5.5.2.2.2.3.3.3.cmml" xref="S3.E6.m1.5.5.2.2.2.3.3.3">𝒮</ci></apply></apply><apply id="S3.E6.m1.5.5.2.2.2.2.cmml" xref="S3.E6.m1.5.5.2.2.2.2"><times id="S3.E6.m1.5.5.2.2.2.2.3.cmml" xref="S3.E6.m1.5.5.2.2.2.2.3"></times><apply id="S3.E6.m1.5.5.2.2.2.2.4.cmml" xref="S3.E6.m1.5.5.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.2.2.2.4.1.cmml" xref="S3.E6.m1.5.5.2.2.2.2.4">subscript</csymbol><ci id="S3.E6.m1.5.5.2.2.2.2.4.2.cmml" xref="S3.E6.m1.5.5.2.2.2.2.4.2">𝐿</ci><ci id="S3.E6.m1.5.5.2.2.2.2.4.3.cmml" xref="S3.E6.m1.5.5.2.2.2.2.4.3">𝐽</ci></apply><interval closure="open" id="S3.E6.m1.5.5.2.2.2.2.2.3.cmml" xref="S3.E6.m1.5.5.2.2.2.2.2.2"><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1"><times id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1"></times><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝐱</ci></apply><apply id="S3.E6.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.5.5.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.5.5.2.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.2.2.2.2.2.2.2.2">𝑃</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑠</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑐</ci></list></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">L_{J}=\frac{1}{C\cdot S}\sum_{c\in\mathcal{C}}\sum_{s\in\mathcal{S}}L_{J}(f_{s%
}(\mathbf{x}),P_{s,c})</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.5d">italic_L start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_C ⋅ italic_S end_ARG ∑ start_POSTSUBSCRIPT italic_c ∈ caligraphic_C end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_s ∈ caligraphic_S end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x ) , italic_P start_POSTSUBSCRIPT italic_s , italic_c end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.21">The final loss term for the multi-scale prototype learning (<span class="ltx_text ltx_font_bold" id="S3.SS3.SSS0.Px1.p2.21.1">Stage 1</span>) becomes:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{proto}}=L_{\text{CE}}+\lambda_{J}\cdot L_{J}" class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><msub id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.2.2" xref="S3.E7.m1.1.1.2.2.cmml">L</mi><mtext id="S3.E7.m1.1.1.2.3" xref="S3.E7.m1.1.1.2.3a.cmml">proto</mtext></msub><mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml">L</mi><mtext id="S3.E7.m1.1.1.3.2.3" xref="S3.E7.m1.1.1.3.2.3a.cmml">CE</mtext></msub><mo id="S3.E7.m1.1.1.3.1" xref="S3.E7.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml"><msub id="S3.E7.m1.1.1.3.3.2" xref="S3.E7.m1.1.1.3.3.2.cmml"><mi id="S3.E7.m1.1.1.3.3.2.2" xref="S3.E7.m1.1.1.3.3.2.2.cmml">λ</mi><mi id="S3.E7.m1.1.1.3.3.2.3" xref="S3.E7.m1.1.1.3.3.2.3.cmml">J</mi></msub><mo id="S3.E7.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E7.m1.1.1.3.3.1.cmml">⋅</mo><msub id="S3.E7.m1.1.1.3.3.3" xref="S3.E7.m1.1.1.3.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.3.2" xref="S3.E7.m1.1.1.3.3.3.2.cmml">L</mi><mi id="S3.E7.m1.1.1.3.3.3.3" xref="S3.E7.m1.1.1.3.3.3.3.cmml">J</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"></eq><apply id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.2.2">𝐿</ci><ci id="S3.E7.m1.1.1.2.3a.cmml" xref="S3.E7.m1.1.1.2.3"><mtext id="S3.E7.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.2.3">proto</mtext></ci></apply><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><plus id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2">𝐿</ci><ci id="S3.E7.m1.1.1.3.2.3a.cmml" xref="S3.E7.m1.1.1.3.2.3"><mtext id="S3.E7.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.3.2.3">CE</mtext></ci></apply><apply id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3"><ci id="S3.E7.m1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3.1">⋅</ci><apply id="S3.E7.m1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.3.2.1.cmml" xref="S3.E7.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.3.3.2.2.cmml" xref="S3.E7.m1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E7.m1.1.1.3.3.2.3.cmml" xref="S3.E7.m1.1.1.3.3.2.3">𝐽</ci></apply><apply id="S3.E7.m1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.3.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.3.2">𝐿</ci><ci id="S3.E7.m1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3.3">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">L_{\text{proto}}=L_{\text{CE}}+\lambda_{J}\cdot L_{J}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_L start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT = italic_L start_POSTSUBSCRIPT CE end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT ⋅ italic_L start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.19">with <math alttext="L_{\text{CE}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.18.m1.1"><semantics id="S3.SS3.SSS0.Px1.p2.18.m1.1a"><msub id="S3.SS3.SSS0.Px1.p2.18.m1.1.1" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.18.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1.2.cmml">L</mi><mtext id="S3.SS3.SSS0.Px1.p2.18.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1.3a.cmml">CE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.18.m1.1b"><apply id="S3.SS3.SSS0.Px1.p2.18.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.18.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.18.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1.2">𝐿</ci><ci id="S3.SS3.SSS0.Px1.p2.18.m1.1.1.3a.cmml" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1.3"><mtext id="S3.SS3.SSS0.Px1.p2.18.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px1.p2.18.m1.1.1.3">CE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.18.m1.1c">L_{\text{CE}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.18.m1.1d">italic_L start_POSTSUBSCRIPT CE end_POSTSUBSCRIPT</annotation></semantics></math> the per patch cross-entropy loss and <math alttext="\lambda_{J}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.19.m2.1"><semantics id="S3.SS3.SSS0.Px1.p2.19.m2.1a"><msub id="S3.SS3.SSS0.Px1.p2.19.m2.1.1" xref="S3.SS3.SSS0.Px1.p2.19.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.19.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p2.19.m2.1.1.2.cmml">λ</mi><mi id="S3.SS3.SSS0.Px1.p2.19.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p2.19.m2.1.1.3.cmml">J</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.19.m2.1b"><apply id="S3.SS3.SSS0.Px1.p2.19.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.19.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.19.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.19.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.19.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.19.m2.1.1.2">𝜆</ci><ci id="S3.SS3.SSS0.Px1.p2.19.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.19.m2.1.1.3">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.19.m2.1c">\lambda_{J}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.19.m2.1d">italic_λ start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT</annotation></semantics></math> a hyperparameter controlling the weight of the regularization.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Stage 2: Prototype grouping mechanism.</h4>
<div class="ltx_para" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.6">The multi-scale prototype grouping mechanism is applied to the learned scale-specific prototypes after they are projected to the training set patches. We proceed with two steps: we first run a warm-up step to train the class-specific grouping functions <math alttext="g_{\text{group}}^{c}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><msubsup id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">g</mi><mtext id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3a.cmml">group</mtext><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.2">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3"><mtext id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.3">group</mtext></ci></apply><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">g_{\text{group}}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.1.m1.1d">italic_g start_POSTSUBSCRIPT group end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> while keeping the rest of the model frozen, namely the backbone <math alttext="f" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.2.m2.1d">italic_f</annotation></semantics></math> and the prototypes, so that we maintain interpretability. Then, in the second step, we run a joint training phase where we finetune both the grouping functions and the last linear layer <math alttext="h_{\text{group}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3a.cmml">group</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2">ℎ</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3"><mtext id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3">group</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">h_{\text{group}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.3.m3.1d">italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT</annotation></semantics></math>.
During the learning of the groups, we apply a sparsity regularization term promoting that only a limited subset of prototypes are active for a given group. For this purpose, we define an entropic loss term, <math alttext="L_{\text{ent}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS3.SSS0.Px2.p1.4.m4.1a"><msub id="S3.SS3.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml">L</mi><mtext id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3a.cmml">ent</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.2">𝐿</ci><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3"><mtext id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.3">ent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.4.m4.1c">L_{\text{ent}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.4.m4.1d">italic_L start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT</annotation></semantics></math>, on the weight matrices <math alttext="\mathbf{w}_{g,c}\in[0,1]^{N\times|P_{c}|}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.5.m5.5"><semantics id="S3.SS3.SSS0.Px2.p1.5.m5.5a"><mrow id="S3.SS3.SSS0.Px2.p1.5.m5.5.6" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.cmml"><msub id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2.2.cmml">𝐰</mi><mrow id="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.4" xref="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1.1.cmml">g</mi><mo id="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.4.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.cmml"><mrow id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.1.cmml"><mo id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.2.1" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.1.cmml">[</mo><mn id="S3.SS3.SSS0.Px2.p1.5.m5.4.4" xref="S3.SS3.SSS0.Px2.p1.5.m5.4.4.cmml">0</mn><mo id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.1.cmml">,</mo><mn id="S3.SS3.SSS0.Px2.p1.5.m5.5.5" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.5.cmml">1</mn><mo id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.2.3" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.1.cmml">]</mo></mrow><mrow id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.3" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.3.cmml">N</mi><mo id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.2.cmml">×</mo><mrow id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.2.cmml"><mo id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.2" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.2.1.cmml">|</mo><msub id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.2.cmml">P</mi><mi id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.3" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.5.m5.5b"><apply id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6"><in id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.1"></in><apply id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.2.2">𝐰</ci><list id="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.4"><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.1.1">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.2.2.2.2">𝑐</ci></list></apply><apply id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3">superscript</csymbol><interval closure="closed" id="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.6.3.2.2"><cn id="S3.SS3.SSS0.Px2.p1.5.m5.4.4.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.5.m5.4.4">0</cn><cn id="S3.SS3.SSS0.Px2.p1.5.m5.5.5.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.5.m5.5.5">1</cn></interval><apply id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1"><times id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.2"></times><ci id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.3">𝑁</ci><apply id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1"><abs id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.2"></abs><apply id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.2">𝑃</ci><ci id="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.3.3.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.5.m5.5c">\mathbf{w}_{g,c}\in[0,1]^{N\times|P_{c}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.5.m5.5d">bold_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT ∈ [ 0 , 1 ] start_POSTSUPERSCRIPT italic_N × | italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT</annotation></semantics></math>. Indeed, as we are projecting each row of those weight matrices <math alttext="\mathbf{w}_{g,c}^{(\operatorname*{n},:)}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.6.m6.4"><semantics id="S3.SS3.SSS0.Px2.p1.6.m6.4a"><msubsup id="S3.SS3.SSS0.Px2.p1.6.m6.4.5" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.5.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m6.4.5.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.5.2.2.cmml">𝐰</mi><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.4" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.1.1.cmml">g</mi><mo id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.4.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.4" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.3.cmml"><mo id="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.4.1" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.3.cmml">(</mo><mo id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.1.1.cmml">n</mo><mo id="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.4.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.3.cmml">,</mo><mo id="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.2" rspace="0em" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.2.cmml">:</mo><mo id="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.4.3" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.6.m6.4b"><apply id="S3.SS3.SSS0.Px2.p1.6.m6.4.5.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.5"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.4.5.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.5">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.6.m6.4.5.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.5"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.4.5.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.5">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.6.m6.4.5.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.5.2.2">𝐰</ci><list id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.4"><ci id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.1.1">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.2">𝑐</ci></list></apply><interval closure="open" id="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.4"><ci id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.1.1">n</ci><ci id="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.4.4.2.2">:</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.6.m6.4c">\mathbf{w}_{g,c}^{(\operatorname*{n},:)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.6.m6.4d">bold_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_n , : ) end_POSTSUPERSCRIPT</annotation></semantics></math> on the probability simplex it is possible to directly compute and minimize information theory measures such as the entropy of those rows, to enforce a sparse combination of prototypes among each group. The entropy loss is computed as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{ent}}=\frac{1}{C\cdot N}\sum_{c\in\mathcal{C}}\sum_{\operatorname*{n}%
=1}^{N_{c}}\sum_{\operatorname*{m}=1}^{M}-w_{g,c}^{(\operatorname*{n},%
\operatorname*{m})}\log(w_{g,c}^{(\operatorname*{n},\operatorname*{m})})" class="ltx_Math" display="block" id="S3.E8.m1.10"><semantics id="S3.E8.m1.10a"><mrow id="S3.E8.m1.10.10" xref="S3.E8.m1.10.10.cmml"><msub id="S3.E8.m1.10.10.3" xref="S3.E8.m1.10.10.3.cmml"><mi id="S3.E8.m1.10.10.3.2" xref="S3.E8.m1.10.10.3.2.cmml">L</mi><mtext id="S3.E8.m1.10.10.3.3" xref="S3.E8.m1.10.10.3.3a.cmml">ent</mtext></msub><mo id="S3.E8.m1.10.10.2" xref="S3.E8.m1.10.10.2.cmml">=</mo><mrow id="S3.E8.m1.10.10.1" xref="S3.E8.m1.10.10.1.cmml"><mrow id="S3.E8.m1.10.10.1.3" xref="S3.E8.m1.10.10.1.3.cmml"><mfrac id="S3.E8.m1.10.10.1.3.2" xref="S3.E8.m1.10.10.1.3.2.cmml"><mn id="S3.E8.m1.10.10.1.3.2.2" xref="S3.E8.m1.10.10.1.3.2.2.cmml">1</mn><mrow id="S3.E8.m1.10.10.1.3.2.3" xref="S3.E8.m1.10.10.1.3.2.3.cmml"><mi id="S3.E8.m1.10.10.1.3.2.3.2" xref="S3.E8.m1.10.10.1.3.2.3.2.cmml">C</mi><mo id="S3.E8.m1.10.10.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m1.10.10.1.3.2.3.1.cmml">⋅</mo><mi id="S3.E8.m1.10.10.1.3.2.3.3" xref="S3.E8.m1.10.10.1.3.2.3.3.cmml">N</mi></mrow></mfrac><mo id="S3.E8.m1.10.10.1.3.1" xref="S3.E8.m1.10.10.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.10.10.1.3.3" xref="S3.E8.m1.10.10.1.3.3.cmml"><munder id="S3.E8.m1.10.10.1.3.3.1" xref="S3.E8.m1.10.10.1.3.3.1.cmml"><mo id="S3.E8.m1.10.10.1.3.3.1.2" movablelimits="false" rspace="0em" xref="S3.E8.m1.10.10.1.3.3.1.2.cmml">∑</mo><mrow id="S3.E8.m1.10.10.1.3.3.1.3" xref="S3.E8.m1.10.10.1.3.3.1.3.cmml"><mi id="S3.E8.m1.10.10.1.3.3.1.3.2" xref="S3.E8.m1.10.10.1.3.3.1.3.2.cmml">c</mi><mo id="S3.E8.m1.10.10.1.3.3.1.3.1" xref="S3.E8.m1.10.10.1.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.10.10.1.3.3.1.3.3" xref="S3.E8.m1.10.10.1.3.3.1.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S3.E8.m1.10.10.1.3.3.2" xref="S3.E8.m1.10.10.1.3.3.2.cmml"><munderover id="S3.E8.m1.10.10.1.3.3.2.1" xref="S3.E8.m1.10.10.1.3.3.2.1.cmml"><mo id="S3.E8.m1.10.10.1.3.3.2.1.2.2" movablelimits="false" rspace="0em" xref="S3.E8.m1.10.10.1.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.10.10.1.3.3.2.1.2.3" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3.cmml"><mo id="S3.E8.m1.10.10.1.3.3.2.1.2.3.2" rspace="0.1389em" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3.2.cmml">n</mo><mo id="S3.E8.m1.10.10.1.3.3.2.1.2.3.1" lspace="0.1389em" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.10.10.1.3.3.2.1.2.3.3" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E8.m1.10.10.1.3.3.2.1.3" xref="S3.E8.m1.10.10.1.3.3.2.1.3.cmml"><mi id="S3.E8.m1.10.10.1.3.3.2.1.3.2" xref="S3.E8.m1.10.10.1.3.3.2.1.3.2.cmml">N</mi><mi id="S3.E8.m1.10.10.1.3.3.2.1.3.3" xref="S3.E8.m1.10.10.1.3.3.2.1.3.3.cmml">c</mi></msub></munderover><munderover id="S3.E8.m1.10.10.1.3.3.2.2" xref="S3.E8.m1.10.10.1.3.3.2.2.cmml"><mo id="S3.E8.m1.10.10.1.3.3.2.2.2.2" movablelimits="false" rspace="0em" xref="S3.E8.m1.10.10.1.3.3.2.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.10.10.1.3.3.2.2.2.3" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3.cmml"><mo id="S3.E8.m1.10.10.1.3.3.2.2.2.3.2" rspace="0.1389em" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3.2.cmml">m</mo><mo id="S3.E8.m1.10.10.1.3.3.2.2.2.3.1" lspace="0.1389em" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.10.10.1.3.3.2.2.2.3.3" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.10.10.1.3.3.2.2.3" xref="S3.E8.m1.10.10.1.3.3.2.2.3.cmml">M</mi></munderover></mrow></mrow></mrow><mo id="S3.E8.m1.10.10.1.2" lspace="0em" xref="S3.E8.m1.10.10.1.2.cmml">−</mo><mrow id="S3.E8.m1.10.10.1.1" xref="S3.E8.m1.10.10.1.1.cmml"><msubsup id="S3.E8.m1.10.10.1.1.3" xref="S3.E8.m1.10.10.1.1.3.cmml"><mi id="S3.E8.m1.10.10.1.1.3.2.2" xref="S3.E8.m1.10.10.1.1.3.2.2.cmml">w</mi><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">g</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.E8.m1.4.4.2.4" xref="S3.E8.m1.4.4.2.3.cmml"><mo id="S3.E8.m1.4.4.2.4.1" stretchy="false" xref="S3.E8.m1.4.4.2.3.cmml">(</mo><mo id="S3.E8.m1.3.3.1.1" lspace="0em" rspace="0em" xref="S3.E8.m1.3.3.1.1.cmml">n</mo><mo id="S3.E8.m1.4.4.2.4.2" xref="S3.E8.m1.4.4.2.3.cmml">,</mo><mo id="S3.E8.m1.4.4.2.2" lspace="0em" rspace="0em" xref="S3.E8.m1.4.4.2.2.cmml">m</mo><mo id="S3.E8.m1.4.4.2.4.3" stretchy="false" xref="S3.E8.m1.4.4.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.E8.m1.10.10.1.1.2" lspace="0.167em" xref="S3.E8.m1.10.10.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.10.10.1.1.1.1" xref="S3.E8.m1.10.10.1.1.1.2.cmml"><mi id="S3.E8.m1.9.9" xref="S3.E8.m1.9.9.cmml">log</mi><mo id="S3.E8.m1.10.10.1.1.1.1a" xref="S3.E8.m1.10.10.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.10.10.1.1.1.1.1" xref="S3.E8.m1.10.10.1.1.1.2.cmml"><mo id="S3.E8.m1.10.10.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.10.10.1.1.1.2.cmml">(</mo><msubsup id="S3.E8.m1.10.10.1.1.1.1.1.1" xref="S3.E8.m1.10.10.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.10.10.1.1.1.1.1.1.2.2" xref="S3.E8.m1.10.10.1.1.1.1.1.1.2.2.cmml">w</mi><mrow id="S3.E8.m1.6.6.2.4" xref="S3.E8.m1.6.6.2.3.cmml"><mi id="S3.E8.m1.5.5.1.1" xref="S3.E8.m1.5.5.1.1.cmml">g</mi><mo id="S3.E8.m1.6.6.2.4.1" xref="S3.E8.m1.6.6.2.3.cmml">,</mo><mi id="S3.E8.m1.6.6.2.2" xref="S3.E8.m1.6.6.2.2.cmml">c</mi></mrow><mrow id="S3.E8.m1.8.8.2.4" xref="S3.E8.m1.8.8.2.3.cmml"><mo id="S3.E8.m1.8.8.2.4.1" stretchy="false" xref="S3.E8.m1.8.8.2.3.cmml">(</mo><mo id="S3.E8.m1.7.7.1.1" lspace="0em" rspace="0em" xref="S3.E8.m1.7.7.1.1.cmml">n</mo><mo id="S3.E8.m1.8.8.2.4.2" xref="S3.E8.m1.8.8.2.3.cmml">,</mo><mo id="S3.E8.m1.8.8.2.2" lspace="0em" rspace="0em" xref="S3.E8.m1.8.8.2.2.cmml">m</mo><mo id="S3.E8.m1.8.8.2.4.3" stretchy="false" xref="S3.E8.m1.8.8.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.E8.m1.10.10.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.10.10.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.10b"><apply id="S3.E8.m1.10.10.cmml" xref="S3.E8.m1.10.10"><eq id="S3.E8.m1.10.10.2.cmml" xref="S3.E8.m1.10.10.2"></eq><apply id="S3.E8.m1.10.10.3.cmml" xref="S3.E8.m1.10.10.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.3.1.cmml" xref="S3.E8.m1.10.10.3">subscript</csymbol><ci id="S3.E8.m1.10.10.3.2.cmml" xref="S3.E8.m1.10.10.3.2">𝐿</ci><ci id="S3.E8.m1.10.10.3.3a.cmml" xref="S3.E8.m1.10.10.3.3"><mtext id="S3.E8.m1.10.10.3.3.cmml" mathsize="70%" xref="S3.E8.m1.10.10.3.3">ent</mtext></ci></apply><apply id="S3.E8.m1.10.10.1.cmml" xref="S3.E8.m1.10.10.1"><minus id="S3.E8.m1.10.10.1.2.cmml" xref="S3.E8.m1.10.10.1.2"></minus><apply id="S3.E8.m1.10.10.1.3.cmml" xref="S3.E8.m1.10.10.1.3"><times id="S3.E8.m1.10.10.1.3.1.cmml" xref="S3.E8.m1.10.10.1.3.1"></times><apply id="S3.E8.m1.10.10.1.3.2.cmml" xref="S3.E8.m1.10.10.1.3.2"><divide id="S3.E8.m1.10.10.1.3.2.1.cmml" xref="S3.E8.m1.10.10.1.3.2"></divide><cn id="S3.E8.m1.10.10.1.3.2.2.cmml" type="integer" xref="S3.E8.m1.10.10.1.3.2.2">1</cn><apply id="S3.E8.m1.10.10.1.3.2.3.cmml" xref="S3.E8.m1.10.10.1.3.2.3"><ci id="S3.E8.m1.10.10.1.3.2.3.1.cmml" xref="S3.E8.m1.10.10.1.3.2.3.1">⋅</ci><ci id="S3.E8.m1.10.10.1.3.2.3.2.cmml" xref="S3.E8.m1.10.10.1.3.2.3.2">𝐶</ci><ci id="S3.E8.m1.10.10.1.3.2.3.3.cmml" xref="S3.E8.m1.10.10.1.3.2.3.3">𝑁</ci></apply></apply><apply id="S3.E8.m1.10.10.1.3.3.cmml" xref="S3.E8.m1.10.10.1.3.3"><apply id="S3.E8.m1.10.10.1.3.3.1.cmml" xref="S3.E8.m1.10.10.1.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.3.3.1.1.cmml" xref="S3.E8.m1.10.10.1.3.3.1">subscript</csymbol><sum id="S3.E8.m1.10.10.1.3.3.1.2.cmml" xref="S3.E8.m1.10.10.1.3.3.1.2"></sum><apply id="S3.E8.m1.10.10.1.3.3.1.3.cmml" xref="S3.E8.m1.10.10.1.3.3.1.3"><in id="S3.E8.m1.10.10.1.3.3.1.3.1.cmml" xref="S3.E8.m1.10.10.1.3.3.1.3.1"></in><ci id="S3.E8.m1.10.10.1.3.3.1.3.2.cmml" xref="S3.E8.m1.10.10.1.3.3.1.3.2">𝑐</ci><ci id="S3.E8.m1.10.10.1.3.3.1.3.3.cmml" xref="S3.E8.m1.10.10.1.3.3.1.3.3">𝒞</ci></apply></apply><apply id="S3.E8.m1.10.10.1.3.3.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2"><apply id="S3.E8.m1.10.10.1.3.3.2.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.3.3.2.1.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1">superscript</csymbol><apply id="S3.E8.m1.10.10.1.3.3.2.1.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.3.3.2.1.2.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1">subscript</csymbol><sum id="S3.E8.m1.10.10.1.3.3.2.1.2.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.2.2"></sum><apply id="S3.E8.m1.10.10.1.3.3.2.1.2.3.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3"><eq id="S3.E8.m1.10.10.1.3.3.2.1.2.3.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3.1"></eq><ci id="S3.E8.m1.10.10.1.3.3.2.1.2.3.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3.2">n</ci><cn id="S3.E8.m1.10.10.1.3.3.2.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.10.10.1.3.3.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.10.10.1.3.3.2.1.3.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.3.3.2.1.3.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.3">subscript</csymbol><ci id="S3.E8.m1.10.10.1.3.3.2.1.3.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.3.2">𝑁</ci><ci id="S3.E8.m1.10.10.1.3.3.2.1.3.3.cmml" xref="S3.E8.m1.10.10.1.3.3.2.1.3.3">𝑐</ci></apply></apply><apply id="S3.E8.m1.10.10.1.3.3.2.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.3.3.2.2.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2">superscript</csymbol><apply id="S3.E8.m1.10.10.1.3.3.2.2.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.3.3.2.2.2.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2">subscript</csymbol><sum id="S3.E8.m1.10.10.1.3.3.2.2.2.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2.2.2"></sum><apply id="S3.E8.m1.10.10.1.3.3.2.2.2.3.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3"><eq id="S3.E8.m1.10.10.1.3.3.2.2.2.3.1.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3.1"></eq><ci id="S3.E8.m1.10.10.1.3.3.2.2.2.3.2.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3.2">m</ci><cn id="S3.E8.m1.10.10.1.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.10.10.1.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.10.10.1.3.3.2.2.3.cmml" xref="S3.E8.m1.10.10.1.3.3.2.2.3">𝑀</ci></apply></apply></apply></apply><apply id="S3.E8.m1.10.10.1.1.cmml" xref="S3.E8.m1.10.10.1.1"><times id="S3.E8.m1.10.10.1.1.2.cmml" xref="S3.E8.m1.10.10.1.1.2"></times><apply id="S3.E8.m1.10.10.1.1.3.cmml" xref="S3.E8.m1.10.10.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.1.3.1.cmml" xref="S3.E8.m1.10.10.1.1.3">superscript</csymbol><apply id="S3.E8.m1.10.10.1.1.3.2.cmml" xref="S3.E8.m1.10.10.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.1.3.2.1.cmml" xref="S3.E8.m1.10.10.1.1.3">subscript</csymbol><ci id="S3.E8.m1.10.10.1.1.3.2.2.cmml" xref="S3.E8.m1.10.10.1.1.3.2.2">𝑤</ci><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑔</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑐</ci></list></apply><interval closure="open" id="S3.E8.m1.4.4.2.3.cmml" xref="S3.E8.m1.4.4.2.4"><ci id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1">n</ci><ci id="S3.E8.m1.4.4.2.2.cmml" xref="S3.E8.m1.4.4.2.2">m</ci></interval></apply><apply id="S3.E8.m1.10.10.1.1.1.2.cmml" xref="S3.E8.m1.10.10.1.1.1.1"><log id="S3.E8.m1.9.9.cmml" xref="S3.E8.m1.9.9"></log><apply id="S3.E8.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.E8.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.10.10.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.10.10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.10.10.1.1.1.1.1.1.2.2">𝑤</ci><list id="S3.E8.m1.6.6.2.3.cmml" xref="S3.E8.m1.6.6.2.4"><ci id="S3.E8.m1.5.5.1.1.cmml" xref="S3.E8.m1.5.5.1.1">𝑔</ci><ci id="S3.E8.m1.6.6.2.2.cmml" xref="S3.E8.m1.6.6.2.2">𝑐</ci></list></apply><interval closure="open" id="S3.E8.m1.8.8.2.3.cmml" xref="S3.E8.m1.8.8.2.4"><ci id="S3.E8.m1.7.7.1.1.cmml" xref="S3.E8.m1.7.7.1.1">n</ci><ci id="S3.E8.m1.8.8.2.2.cmml" xref="S3.E8.m1.8.8.2.2">m</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.10c">L_{\text{ent}}=\frac{1}{C\cdot N}\sum_{c\in\mathcal{C}}\sum_{\operatorname*{n}%
=1}^{N_{c}}\sum_{\operatorname*{m}=1}^{M}-w_{g,c}^{(\operatorname*{n},%
\operatorname*{m})}\log(w_{g,c}^{(\operatorname*{n},\operatorname*{m})})</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.10d">italic_L start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_C ⋅ italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_c ∈ caligraphic_C end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT roman_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT roman_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT - italic_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_n , roman_m ) end_POSTSUPERSCRIPT roman_log ( italic_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_n , roman_m ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.12">Then, in the second step, we fine-tune also the linear layer <math alttext="h_{\text{group}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.7.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.7.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.7.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.7.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px2.p1.7.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1.3a.cmml">group</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.7.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.7.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.7.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.7.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1.2">ℎ</ci><ci id="S3.SS3.SSS0.Px2.p1.7.m1.1.1.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1.3"><mtext id="S3.SS3.SSS0.Px2.p1.7.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px2.p1.7.m1.1.1.3">group</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.7.m1.1c">h_{\text{group}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.7.m1.1d">italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT</annotation></semantics></math>. To enforce more sparsity, following the training protocol from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib8" title="">8</a>]</cite>, we apply an L1-norm loss term on <math alttext="h_{\text{group}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.8.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.8.m2.1a"><msub id="S3.SS3.SSS0.Px2.p1.8.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.8.m2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px2.p1.8.m2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1.3a.cmml">group</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.8.m2.1b"><apply id="S3.SS3.SSS0.Px2.p1.8.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.8.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.8.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1.2">ℎ</ci><ci id="S3.SS3.SSS0.Px2.p1.8.m2.1.1.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1.3"><mtext id="S3.SS3.SSS0.Px2.p1.8.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px2.p1.8.m2.1.1.3">group</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.8.m2.1c">h_{\text{group}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.8.m2.1d">italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT</annotation></semantics></math> solely on the weights <math alttext="w_{h_{\text{group}}}^{c,\operatorname*{n}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.9.m3.2"><semantics id="S3.SS3.SSS0.Px2.p1.9.m3.2a"><msubsup id="S3.SS3.SSS0.Px2.p1.9.m3.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.2" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.2.cmml">w</mi><msub id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.2" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.2.cmml">h</mi><mtext id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.3" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.3a.cmml">group</mtext></msub><mrow id="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.4" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.9.m3.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.9.m3.1.1.1.1.cmml">c</mi><mo id="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.4.1" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.3.cmml">,</mo><mo id="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.2" lspace="0em" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.2.cmml">n</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.9.m3.2b"><apply id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.2">𝑤</ci><apply id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.2">ℎ</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.3"><mtext id="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.3.cmml" mathsize="50%" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.3.2.3.3">group</mtext></ci></apply></apply><list id="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.4"><ci id="S3.SS3.SSS0.Px2.p1.9.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.1.1.1.1">𝑐</ci><ci id="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m3.2.2.2.2">n</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.9.m3.2c">w_{h_{\text{group}}}^{c,\operatorname*{n}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.9.m3.2d">italic_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c , roman_n end_POSTSUPERSCRIPT</annotation></semantics></math> where the group <math alttext="\mathbf{g}_{\operatorname*{n}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.10.m4.1"><semantics id="S3.SS3.SSS0.Px2.p1.10.m4.1a"><msub id="S3.SS3.SSS0.Px2.p1.10.m4.1.1" xref="S3.SS3.SSS0.Px2.p1.10.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.10.m4.1.1.2" xref="S3.SS3.SSS0.Px2.p1.10.m4.1.1.2.cmml">𝐠</mi><mo id="S3.SS3.SSS0.Px2.p1.10.m4.1.1.3" xref="S3.SS3.SSS0.Px2.p1.10.m4.1.1.3.cmml">n</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.10.m4.1b"><apply id="S3.SS3.SSS0.Px2.p1.10.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.10.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.10.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m4.1.1.2">𝐠</ci><ci id="S3.SS3.SSS0.Px2.p1.10.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m4.1.1.3">n</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.10.m4.1c">\mathbf{g}_{\operatorname*{n}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.10.m4.1d">bold_g start_POSTSUBSCRIPT roman_n end_POSTSUBSCRIPT</annotation></semantics></math> is not in the set of groups <math alttext="G_{c}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.11.m5.1"><semantics id="S3.SS3.SSS0.Px2.p1.11.m5.1a"><msub id="S3.SS3.SSS0.Px2.p1.11.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.11.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m5.1.1.2" xref="S3.SS3.SSS0.Px2.p1.11.m5.1.1.2.cmml">G</mi><mi id="S3.SS3.SSS0.Px2.p1.11.m5.1.1.3" xref="S3.SS3.SSS0.Px2.p1.11.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.11.m5.1b"><apply id="S3.SS3.SSS0.Px2.p1.11.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.11.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m5.1.1.2">𝐺</ci><ci id="S3.SS3.SSS0.Px2.p1.11.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.11.m5.1c">G_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.11.m5.1d">italic_G start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> assigned to class <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.12.m6.1"><semantics id="S3.SS3.SSS0.Px2.p1.12.m6.1a"><mi id="S3.SS3.SSS0.Px2.p1.12.m6.1.1" xref="S3.SS3.SSS0.Px2.p1.12.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.12.m6.1b"><ci id="S3.SS3.SSS0.Px2.p1.12.m6.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.12.m6.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.12.m6.1d">italic_c</annotation></semantics></math>. The total loss term for the grouping mechanism (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>: <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS0.Px2.p1.12.1">Stage 2</span>) becomes:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{proto}}=L_{\text{CE}}+\lambda_{\text{ent}}\cdot L_{\text{ent}}+%
\lambda_{\text{L1}}\cdot\sum_{c\in\mathcal{C}}\sum_{\operatorname*{n}:\mathbf{%
g}_{\operatorname*{n}}\notin G_{c}}|w_{h_{\text{group}}}^{(c,\operatorname*{n}%
)}|" class="ltx_Math" display="block" id="S3.E9.m1.3"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml"><msub id="S3.E9.m1.3.3.3" xref="S3.E9.m1.3.3.3.cmml"><mi id="S3.E9.m1.3.3.3.2" xref="S3.E9.m1.3.3.3.2.cmml">L</mi><mtext id="S3.E9.m1.3.3.3.3" xref="S3.E9.m1.3.3.3.3a.cmml">proto</mtext></msub><mo id="S3.E9.m1.3.3.2" xref="S3.E9.m1.3.3.2.cmml">=</mo><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.cmml"><msub id="S3.E9.m1.3.3.1.3" xref="S3.E9.m1.3.3.1.3.cmml"><mi id="S3.E9.m1.3.3.1.3.2" xref="S3.E9.m1.3.3.1.3.2.cmml">L</mi><mtext id="S3.E9.m1.3.3.1.3.3" xref="S3.E9.m1.3.3.1.3.3a.cmml">CE</mtext></msub><mo id="S3.E9.m1.3.3.1.2" xref="S3.E9.m1.3.3.1.2.cmml">+</mo><mrow id="S3.E9.m1.3.3.1.4" xref="S3.E9.m1.3.3.1.4.cmml"><msub id="S3.E9.m1.3.3.1.4.2" xref="S3.E9.m1.3.3.1.4.2.cmml"><mi id="S3.E9.m1.3.3.1.4.2.2" xref="S3.E9.m1.3.3.1.4.2.2.cmml">λ</mi><mtext id="S3.E9.m1.3.3.1.4.2.3" xref="S3.E9.m1.3.3.1.4.2.3a.cmml">ent</mtext></msub><mo id="S3.E9.m1.3.3.1.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E9.m1.3.3.1.4.1.cmml">⋅</mo><msub id="S3.E9.m1.3.3.1.4.3" xref="S3.E9.m1.3.3.1.4.3.cmml"><mi id="S3.E9.m1.3.3.1.4.3.2" xref="S3.E9.m1.3.3.1.4.3.2.cmml">L</mi><mtext id="S3.E9.m1.3.3.1.4.3.3" xref="S3.E9.m1.3.3.1.4.3.3a.cmml">ent</mtext></msub></mrow><mo id="S3.E9.m1.3.3.1.2a" xref="S3.E9.m1.3.3.1.2.cmml">+</mo><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><msub id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml"><mi id="S3.E9.m1.3.3.1.1.3.2" xref="S3.E9.m1.3.3.1.1.3.2.cmml">λ</mi><mtext id="S3.E9.m1.3.3.1.1.3.3" xref="S3.E9.m1.3.3.1.1.3.3a.cmml">L1</mtext></msub><mo id="S3.E9.m1.3.3.1.1.2" lspace="0.222em" rspace="0.055em" xref="S3.E9.m1.3.3.1.1.2.cmml">⋅</mo><mrow id="S3.E9.m1.3.3.1.1.1" xref="S3.E9.m1.3.3.1.1.1.cmml"><munder id="S3.E9.m1.3.3.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.2.cmml"><mo id="S3.E9.m1.3.3.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E9.m1.3.3.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9.m1.3.3.1.1.1.2.3" xref="S3.E9.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E9.m1.3.3.1.1.1.2.3.2" xref="S3.E9.m1.3.3.1.1.1.2.3.2.cmml">c</mi><mo id="S3.E9.m1.3.3.1.1.1.2.3.1" xref="S3.E9.m1.3.3.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.3.3.1.1.1.2.3.3" xref="S3.E9.m1.3.3.1.1.1.2.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S3.E9.m1.3.3.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.cmml"><munder id="S3.E9.m1.3.3.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E9.m1.3.3.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E9.m1.3.3.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.2.3" xref="S3.E9.m1.3.3.1.1.1.1.2.3.cmml"><mo id="S3.E9.m1.3.3.1.1.1.1.2.3.2" xref="S3.E9.m1.3.3.1.1.1.1.2.3.2.cmml">n</mo><mo id="S3.E9.m1.3.3.1.1.1.1.2.3.1" rspace="0.278em" xref="S3.E9.m1.3.3.1.1.1.1.2.3.1.cmml">:</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.2.3.3" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.cmml"><msub id="S3.E9.m1.3.3.1.1.1.1.2.3.3.2" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.2" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.2.cmml">𝐠</mi><mo id="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.3" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.3.cmml">n</mo></msub><mo id="S3.E9.m1.3.3.1.1.1.1.2.3.3.1" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.1.cmml">∉</mo><msub id="S3.E9.m1.3.3.1.1.1.1.2.3.3.3" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.2" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.2.cmml">G</mi><mi id="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.3" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.3.cmml">c</mi></msub></mrow></mrow></munder><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.1.2.1.cmml">|</mo><msubsup id="S3.E9.m1.3.3.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">w</mi><msub id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mtext id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.3a.cmml">group</mtext></msub><mrow id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.3.cmml"><mo id="S3.E9.m1.2.2.2.4.1" stretchy="false" xref="S3.E9.m1.2.2.2.3.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">c</mi><mo id="S3.E9.m1.2.2.2.4.2" xref="S3.E9.m1.2.2.2.3.cmml">,</mo><mo id="S3.E9.m1.2.2.2.2" lspace="0em" rspace="0em" xref="S3.E9.m1.2.2.2.2.cmml">n</mo><mo id="S3.E9.m1.2.2.2.4.3" stretchy="false" xref="S3.E9.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.E9.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><eq id="S3.E9.m1.3.3.2.cmml" xref="S3.E9.m1.3.3.2"></eq><apply id="S3.E9.m1.3.3.3.cmml" xref="S3.E9.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3">subscript</csymbol><ci id="S3.E9.m1.3.3.3.2.cmml" xref="S3.E9.m1.3.3.3.2">𝐿</ci><ci id="S3.E9.m1.3.3.3.3a.cmml" xref="S3.E9.m1.3.3.3.3"><mtext id="S3.E9.m1.3.3.3.3.cmml" mathsize="70%" xref="S3.E9.m1.3.3.3.3">proto</mtext></ci></apply><apply id="S3.E9.m1.3.3.1.cmml" xref="S3.E9.m1.3.3.1"><plus id="S3.E9.m1.3.3.1.2.cmml" xref="S3.E9.m1.3.3.1.2"></plus><apply id="S3.E9.m1.3.3.1.3.cmml" xref="S3.E9.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.3.1.cmml" xref="S3.E9.m1.3.3.1.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.3.2.cmml" xref="S3.E9.m1.3.3.1.3.2">𝐿</ci><ci id="S3.E9.m1.3.3.1.3.3a.cmml" xref="S3.E9.m1.3.3.1.3.3"><mtext id="S3.E9.m1.3.3.1.3.3.cmml" mathsize="70%" xref="S3.E9.m1.3.3.1.3.3">CE</mtext></ci></apply><apply id="S3.E9.m1.3.3.1.4.cmml" xref="S3.E9.m1.3.3.1.4"><ci id="S3.E9.m1.3.3.1.4.1.cmml" xref="S3.E9.m1.3.3.1.4.1">⋅</ci><apply id="S3.E9.m1.3.3.1.4.2.cmml" xref="S3.E9.m1.3.3.1.4.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.4.2.1.cmml" xref="S3.E9.m1.3.3.1.4.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.4.2.2.cmml" xref="S3.E9.m1.3.3.1.4.2.2">𝜆</ci><ci id="S3.E9.m1.3.3.1.4.2.3a.cmml" xref="S3.E9.m1.3.3.1.4.2.3"><mtext id="S3.E9.m1.3.3.1.4.2.3.cmml" mathsize="70%" xref="S3.E9.m1.3.3.1.4.2.3">ent</mtext></ci></apply><apply id="S3.E9.m1.3.3.1.4.3.cmml" xref="S3.E9.m1.3.3.1.4.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.4.3.1.cmml" xref="S3.E9.m1.3.3.1.4.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.4.3.2.cmml" xref="S3.E9.m1.3.3.1.4.3.2">𝐿</ci><ci id="S3.E9.m1.3.3.1.4.3.3a.cmml" xref="S3.E9.m1.3.3.1.4.3.3"><mtext id="S3.E9.m1.3.3.1.4.3.3.cmml" mathsize="70%" xref="S3.E9.m1.3.3.1.4.3.3">ent</mtext></ci></apply></apply><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1"><ci id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2">⋅</ci><apply id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.3.2.cmml" xref="S3.E9.m1.3.3.1.1.3.2">𝜆</ci><ci id="S3.E9.m1.3.3.1.1.3.3a.cmml" xref="S3.E9.m1.3.3.1.1.3.3"><mtext id="S3.E9.m1.3.3.1.1.3.3.cmml" mathsize="70%" xref="S3.E9.m1.3.3.1.1.3.3">L1</mtext></ci></apply><apply id="S3.E9.m1.3.3.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1"><apply id="S3.E9.m1.3.3.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.3.3.1.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.2.2"></sum><apply id="S3.E9.m1.3.3.1.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.1.2.3"><in id="S3.E9.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.2.3.1"></in><ci id="S3.E9.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.2.3.2">𝑐</ci><ci id="S3.E9.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S3.E9.m1.3.3.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1"><apply id="S3.E9.m1.3.3.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2"></sum><apply id="S3.E9.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3"><ci id="S3.E9.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.1">:</ci><ci id="S3.E9.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.2">n</ci><apply id="S3.E9.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3"><notin id="S3.E9.m1.3.3.1.1.1.1.2.3.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.1"></notin><apply id="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.2">𝐠</ci><ci id="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.2.3">n</ci></apply><apply id="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.2">𝐺</ci><ci id="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="S3.E9.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1"><abs id="S3.E9.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2"></abs><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.2">𝑤</ci><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.2">ℎ</ci><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.3a.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.3"><mtext id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" mathsize="50%" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.3.3">group</mtext></ci></apply></apply><interval closure="open" id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.4"><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝑐</ci><ci id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">n</ci></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">L_{\text{proto}}=L_{\text{CE}}+\lambda_{\text{ent}}\cdot L_{\text{ent}}+%
\lambda_{\text{L1}}\cdot\sum_{c\in\mathcal{C}}\sum_{\operatorname*{n}:\mathbf{%
g}_{\operatorname*{n}}\notin G_{c}}|w_{h_{\text{group}}}^{(c,\operatorname*{n}%
)}|</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.3d">italic_L start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT = italic_L start_POSTSUBSCRIPT CE end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT ⋅ italic_L start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT L1 end_POSTSUBSCRIPT ⋅ ∑ start_POSTSUBSCRIPT italic_c ∈ caligraphic_C end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT roman_n : bold_g start_POSTSUBSCRIPT roman_n end_POSTSUBSCRIPT ∉ italic_G start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_c , roman_n ) end_POSTSUPERSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.17">where <math alttext="\lambda_{\text{ent}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.13.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.13.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.13.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.13.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1.2.cmml">λ</mi><mtext id="S3.SS3.SSS0.Px2.p1.13.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1.3a.cmml">ent</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.13.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.13.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.13.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.13.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1.2">𝜆</ci><ci id="S3.SS3.SSS0.Px2.p1.13.m1.1.1.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1.3"><mtext id="S3.SS3.SSS0.Px2.p1.13.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px2.p1.13.m1.1.1.3">ent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.13.m1.1c">\lambda_{\text{ent}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.13.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{\text{L1}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.14.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.14.m2.1a"><msub id="S3.SS3.SSS0.Px2.p1.14.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.14.m2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1.2.cmml">λ</mi><mtext id="S3.SS3.SSS0.Px2.p1.14.m2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1.3a.cmml">L1</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.14.m2.1b"><apply id="S3.SS3.SSS0.Px2.p1.14.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.14.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.14.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1.2">𝜆</ci><ci id="S3.SS3.SSS0.Px2.p1.14.m2.1.1.3a.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1.3"><mtext id="S3.SS3.SSS0.Px2.p1.14.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS0.Px2.p1.14.m2.1.1.3">L1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.14.m2.1c">\lambda_{\text{L1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.14.m2.1d">italic_λ start_POSTSUBSCRIPT L1 end_POSTSUBSCRIPT</annotation></semantics></math> are hyperparameters controlling the weight of the regularization terms. Once the whole architecture is trained, a final post-processing stage is done: the weights of the grouping function matrices <math alttext="\mathbf{w}_{g,c}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.15.m3.2"><semantics id="S3.SS3.SSS0.Px2.p1.15.m3.2a"><msub id="S3.SS3.SSS0.Px2.p1.15.m3.2.3" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.15.m3.2.3.2" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.3.2.cmml">𝐰</mi><mrow id="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.4" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.15.m3.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.15.m3.1.1.1.1.cmml">g</mi><mo id="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.4.1" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.15.m3.2b"><apply id="S3.SS3.SSS0.Px2.p1.15.m3.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.15.m3.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.15.m3.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.3.2">𝐰</ci><list id="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.4"><ci id="S3.SS3.SSS0.Px2.p1.15.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m3.1.1.1.1">𝑔</ci><ci id="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m3.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.15.m3.2c">\mathbf{w}_{g,c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.15.m3.2d">bold_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> below a certain threshold <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.16.m4.1"><semantics id="S3.SS3.SSS0.Px2.p1.16.m4.1a"><mi id="S3.SS3.SSS0.Px2.p1.16.m4.1.1" xref="S3.SS3.SSS0.Px2.p1.16.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.16.m4.1b"><ci id="S3.SS3.SSS0.Px2.p1.16.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.16.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.16.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.16.m4.1d">italic_α</annotation></semantics></math> are set to <math alttext="0" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.17.m5.1"><semantics id="S3.SS3.SSS0.Px2.p1.17.m5.1a"><mn id="S3.SS3.SSS0.Px2.p1.17.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.17.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.17.m5.1b"><cn id="S3.SS3.SSS0.Px2.p1.17.m5.1.1.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.17.m5.1.1">0</cn></annotation-xml></semantics></math>. This enforces even more sparsity within the groups.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental setup</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.16">In all the experiments presented in the section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2" title="4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4.2</span></a>, we use DeepLabv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite> with ResNet-101 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib33" title="">33</a>]</cite> pre-trained on ImageNet as the backbone. For the multi-scale prototype learning, we assign <math alttext="M=3" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">M</mi><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><eq id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑀</ci><cn id="S4.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">M=3</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_M = 3</annotation></semantics></math> scale-dependent prototypes per scale to each class and <math alttext="S=4" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">S</mi><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑆</ci><cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">S=4</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_S = 4</annotation></semantics></math> scales, so <math alttext="12" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><cn id="S4.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">12</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">12</annotation></semantics></math> prototypes per class in total. Moreover, we set the number of groups per class to <math alttext="N_{c}=3" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><msub id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2.2" xref="S4.SS1.p1.4.m4.1.1.2.2.cmml">N</mi><mi id="S4.SS1.p1.4.m4.1.1.2.3" xref="S4.SS1.p1.4.m4.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><eq id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></eq><apply id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2.2">𝑁</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3">𝑐</ci></apply><cn id="S4.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">N_{c}=3</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = 3</annotation></semantics></math> for the grouping mechanism. We evaluate ScaleProtoSeg on <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.16.1">(i)</span> Pascal VOC 2012 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib21" title="">21</a>]</cite> (made of <math alttext="1464" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mn id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">1464</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><cn id="S4.SS1.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1">1464</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">1464</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">1464</annotation></semantics></math> train, <math alttext="1449" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mn id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">1449</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><cn id="S4.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS1.p1.6.m6.1.1">1449</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">1449</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">1449</annotation></semantics></math> validation, and <math alttext="1446" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><mn id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">1446</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><cn id="S4.SS1.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1">1446</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">1446</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">1446</annotation></semantics></math> test images with <math alttext="21" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><mn id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><cn id="S4.SS1.p1.8.m8.1.1.cmml" type="integer" xref="S4.SS1.p1.8.m8.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">21</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">21</annotation></semantics></math> classes; the Pascal VOC training set is extended to <math alttext="10582" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.1"><semantics id="S4.SS1.p1.9.m9.1a"><mn id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">10582</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><cn id="S4.SS1.p1.9.m9.1.1.cmml" type="integer" xref="S4.SS1.p1.9.m9.1.1">10582</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">10582</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m9.1d">10582</annotation></semantics></math> images following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib29" title="">29</a>]</cite>), <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.16.2">(ii)</span> Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib14" title="">14</a>]</cite> (composed of <math alttext="2975" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m10.1"><semantics id="S4.SS1.p1.10.m10.1a"><mn id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">2975</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><cn id="S4.SS1.p1.10.m10.1.1.cmml" type="integer" xref="S4.SS1.p1.10.m10.1.1">2975</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">2975</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m10.1d">2975</annotation></semantics></math> train, <math alttext="500" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m11.1"><semantics id="S4.SS1.p1.11.m11.1a"><mn id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><cn id="S4.SS1.p1.11.m11.1.1.cmml" type="integer" xref="S4.SS1.p1.11.m11.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">500</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m11.1d">500</annotation></semantics></math> validation, and <math alttext="1525" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m12.1"><semantics id="S4.SS1.p1.12.m12.1a"><mn id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">1525</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><cn id="S4.SS1.p1.12.m12.1.1.cmml" type="integer" xref="S4.SS1.p1.12.m12.1.1">1525</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">1525</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m12.1d">1525</annotation></semantics></math> test images of street scenes, with <math alttext="19" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m13.1"><semantics id="S4.SS1.p1.13.m13.1a"><mn id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b"><cn id="S4.SS1.p1.13.m13.1.1.cmml" type="integer" xref="S4.SS1.p1.13.m13.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">19</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.m13.1d">19</annotation></semantics></math> classes) and <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.16.3">(iii)</span> ADE20K (a scene-parsing dataset with 150 fine-grained semantic classes split in <math alttext="\sim 20000" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m14.1"><semantics id="S4.SS1.p1.14.m14.1a"><mrow id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml"><mi id="S4.SS1.p1.14.m14.1.1.2" xref="S4.SS1.p1.14.m14.1.1.2.cmml"></mi><mo id="S4.SS1.p1.14.m14.1.1.1" xref="S4.SS1.p1.14.m14.1.1.1.cmml">∼</mo><mn id="S4.SS1.p1.14.m14.1.1.3" xref="S4.SS1.p1.14.m14.1.1.3.cmml">20000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b"><apply id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1"><csymbol cd="latexml" id="S4.SS1.p1.14.m14.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.SS1.p1.14.m14.1.1.2.cmml" xref="S4.SS1.p1.14.m14.1.1.2">absent</csymbol><cn id="S4.SS1.p1.14.m14.1.1.3.cmml" type="integer" xref="S4.SS1.p1.14.m14.1.1.3">20000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">\sim 20000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.14.m14.1d">∼ 20000</annotation></semantics></math> training and <math alttext="2000" class="ltx_Math" display="inline" id="S4.SS1.p1.15.m15.1"><semantics id="S4.SS1.p1.15.m15.1a"><mn id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.1b"><cn id="S4.SS1.p1.15.m15.1.1.cmml" type="integer" xref="S4.SS1.p1.15.m15.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.1c">2000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.15.m15.1d">2000</annotation></semantics></math> validation images; for the training of ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> on ADE20K we extend the number of prototypes to <math alttext="12" class="ltx_Math" display="inline" id="S4.SS1.p1.16.m16.1"><semantics id="S4.SS1.p1.16.m16.1a"><mn id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m16.1b"><cn id="S4.SS1.p1.16.m16.1.1.cmml" type="integer" xref="S4.SS1.p1.16.m16.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m16.1c">12</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.16.m16.1d">12</annotation></semantics></math> for direct comparison with ScaleProtoSeg). A detailed description of the experimental setup is available in the supplementary materials in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S6" title="6 Details on experimental set-up ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results and discussion</h3>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Method Performance.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.2">In Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.T1" title="Table 1 ‣ Method Performance. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>, we present the performance of our interpretable semantic segmentation method ScaleProtoSeg. Due to the well-known lack of faithfulness of saliency-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib68" title="">68</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib1" title="">1</a>]</cite> and the difficulty to compare against other by-design methods <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.SSS0.Px1.p1.2.1">not</span> based on prototypes (different benchmark datasets, different backbones and/or lack of public code repositories) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib71" title="">71</a>]</cite>, we compare ScaleProtoSeg against ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> (the closest previous methods in the literature aimed at prototype-based interpretability for semantic segmentation) and the non-interpretable counterpart DeepLabv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite>. It is worth mentioning that, as interpretability comes at the price of constrained and regularized training (namely through prototype projection to real training samples, the use of the diversity loss, and the sparse grouping mechanism), an interpretable model aims to close the gap with the non-interpretable counterpart, which acts as an upper-bound. In this regard, ScaleProtoSeg showcases a substantial improvement over ProtoSeg in terms of mIoU for Cityscapes and ADE20K, namely of <math alttext="\sim 1.5\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">∼</mo><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mn id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">1.5</mn><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2">absent</csymbol><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.2">1.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">\sim 1.5\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">∼ 1.5 %</annotation></semantics></math> and <math alttext="4\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">4</mn><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">4\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">4 %</annotation></semantics></math>. For ADE20K, the proposed ScaleProtoSeg goes beyond its original goal of enabling interpretability by surpassing the performance of its black-box counterpart.
The Cityscapes and ADE20K datasets present more natural images with numerous objects at various scales, unlike in Pascal, where our method provides less of an advantage (results are on par with those of ProtoSeg). Indeed, we hypothesize that learning explicitly scale-specific prototypes at multiple scales is more advantageous in segmentation tasks with a large depth of field. In the supplementary materials, we further demonstrate the transferability of ScaleProtoSeg (a) to the medical domain, (b) to another segmentation architecture and (c) to a larger benchmark dataset (COCO-Stuff) in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S7" title="7 Transferability of ScaleProtoSeg ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S8" title="8 Extension to large dataset ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.8">This observation is confirmed by the results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.T2" title="Table 2 ‣ Method Performance. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>, which showcases the high improvement brought by the projection step of ScaleProtoSeg, performed during the proposed multi-scale prototype learning (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>: <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p2.8.1">Stage 1</span>). This improvement comes with an increase of solely two prototypes per class from 190 to 228 prototypes on Pascal VOC and 210 (201 after deduplication) to 252 on Cityscapes.
Furthermore, in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.T2" title="Table 2 ‣ Method Performance. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a> we observe that, through the grouping mechanism and thresholding, we reduce the total number of prototypes used by our model by <math alttext="51.3\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml">51.3</mn><mo id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2">51.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.1.m1.1c">51.3\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.1.m1.1d">51.3 %</annotation></semantics></math>, <math alttext="48.0\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml">48.0</mn><mo id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.2">48.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.2.m2.1c">48.0\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.2.m2.1d">48.0 %</annotation></semantics></math>, and <math alttext="37.1\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p2.3.m3.1a"><mrow id="S4.SS2.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.2.cmml">37.1</mn><mo id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.3.m3.1b"><apply id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.2">37.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.3.m3.1c">37.1\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.3.m3.1d">37.1 %</annotation></semantics></math> for Cityscapes, Pascal, and ADE20K respectively, compared to <math alttext="32.6\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p2.4.m4.1a"><mrow id="S4.SS2.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml">32.6</mn><mo id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.1" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2">32.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.4.m4.1c">32.6\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.4.m4.1d">32.6 %</annotation></semantics></math>, <math alttext="36.7\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.5.m5.1"><semantics id="S4.SS2.SSS0.Px1.p2.5.m5.1a"><mrow id="S4.SS2.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.5.m5.1.1.2" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml">36.7</mn><mo id="S4.SS2.SSS0.Px1.p2.5.m5.1.1.1" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.5.m5.1b"><apply id="S4.SS2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.5.m5.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1.2">36.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.5.m5.1c">36.7\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.5.m5.1d">36.7 %</annotation></semantics></math>, and <math alttext="35.5\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.6.m6.1"><semantics id="S4.SS2.SSS0.Px1.p2.6.m6.1a"><mrow id="S4.SS2.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.2" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml">35.5</mn><mo id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.6.m6.1b"><apply id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.2">35.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.6.m6.1c">35.5\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.6.m6.1d">35.5 %</annotation></semantics></math> for ProtoSeg after deduplication and pruning. As a result, ScaleProtoSeg uses fewer prototypes than ProtoSeg despite a higher initial count except for ADE20K (see Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS1" title="4.1 Experimental setup ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4.1</span></a>). The proposed grouping mechanism (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.F2" title="Figure 2 ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>: <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p2.8.2">Stage 2</span>) trades better interpretability and simplified decision process (interaction of only 3 groups per class) with only <math alttext="0.4\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.7.m7.1"><semantics id="S4.SS2.SSS0.Px1.p2.7.m7.1a"><mrow id="S4.SS2.SSS0.Px1.p2.7.m7.1.1" xref="S4.SS2.SSS0.Px1.p2.7.m7.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.7.m7.1.1.2" xref="S4.SS2.SSS0.Px1.p2.7.m7.1.1.2.cmml">0.4</mn><mo id="S4.SS2.SSS0.Px1.p2.7.m7.1.1.1" xref="S4.SS2.SSS0.Px1.p2.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.7.m7.1b"><apply id="S4.SS2.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m7.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.7.m7.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.7.m7.1.1.2">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.7.m7.1c">0.4\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.7.m7.1d">0.4 %</annotation></semantics></math> to <math alttext="0.8\%" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.8.m8.1"><semantics id="S4.SS2.SSS0.Px1.p2.8.m8.1a"><mrow id="S4.SS2.SSS0.Px1.p2.8.m8.1.1" xref="S4.SS2.SSS0.Px1.p2.8.m8.1.1.cmml"><mn id="S4.SS2.SSS0.Px1.p2.8.m8.1.1.2" xref="S4.SS2.SSS0.Px1.p2.8.m8.1.1.2.cmml">0.8</mn><mo id="S4.SS2.SSS0.Px1.p2.8.m8.1.1.1" xref="S4.SS2.SSS0.Px1.p2.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.8.m8.1b"><apply id="S4.SS2.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m8.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p2.8.m8.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m8.1.1.1">percent</csymbol><cn id="S4.SS2.SSS0.Px1.p2.8.m8.1.1.2.cmml" type="float" xref="S4.SS2.SSS0.Px1.p2.8.m8.1.1.2">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.8.m8.1c">0.8\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.8.m8.1d">0.8 %</annotation></semantics></math> mIoU loss.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p3.1">In the supplementary materials, we detail the capability of controlling the sparsity-performance trade-off via the thresholding of the grouping weights matrices and the entropy regularization in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S9" title="9 Sparsity Regularization ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">9</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S10" title="10 Group Overlap ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.6" style="width:216.8pt;height:57.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-106.9pt,28.2pt) scale(0.503497051630554,0.503497051630554) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.6.6.7.1">
<td class="ltx_td ltx_border_r" id="S4.T1.6.6.7.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S4.T1.6.6.7.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6.7.1.2.1">
<tr class="ltx_tr" id="S4.T1.6.6.7.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.7.1.2.1.1.1">Cityscapes</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.7.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.7.1.2.1.2.1">mIoU</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S4.T1.6.6.7.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6.7.1.3.1">
<tr class="ltx_tr" id="S4.T1.6.6.7.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.7.1.3.1.1.1">Pascal</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.7.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.7.1.3.1.2.1">mIoU</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.7.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6.7.1.4.1">
<tr class="ltx_tr" id="S4.T1.6.6.7.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.7.1.4.1.1.1">ADE20K</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.7.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.7.1.4.1.2.1">mIoU</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.8.2">
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.6.6.8.2.1">Method</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.6.8.2.2">val</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.6.8.2.3">test</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.6.8.2.4">val</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.6.8.2.5">test</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.6.8.2.6">val</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.9.3">
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.6.6.9.3.1">DeepLabv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.6.9.3.2">71.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.6.9.3.3">70.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.6.9.3.4">77.69</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.6.9.3.5">79.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.6.9.3.6">34.00</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.3">
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.3.3.3.4">ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1">67.54<math alttext="\pm 0.22" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mo id="S4.T1.1.1.1.1.m1.1.1a" xref="S4.T1.1.1.1.1.m1.1.1.cmml">±</mo><mn id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2.cmml">0.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.1.1.1.1.m1.1.1.2.cmml" type="float" xref="S4.T1.1.1.1.1.m1.1.1.2">0.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\pm 0.22</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">± 0.22</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.3.3.3.5">67.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.2.2.1">71.98<math alttext="\pm 0.11" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.1.m1.1"><semantics id="S4.T1.2.2.2.2.1.m1.1a"><mrow id="S4.T1.2.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.2.1.m1.1.1.cmml"><mo id="S4.T1.2.2.2.2.1.m1.1.1a" xref="S4.T1.2.2.2.2.1.m1.1.1.cmml">±</mo><mn id="S4.T1.2.2.2.2.1.m1.1.1.2" xref="S4.T1.2.2.2.2.1.m1.1.1.2.cmml">0.11</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.1.m1.1b"><apply id="S4.T1.2.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.2.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.2.2.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.2.2.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.2.2.2.2.1.m1.1.1.2.cmml" type="float" xref="S4.T1.2.2.2.2.1.m1.1.1.2">0.11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.1.m1.1c">\pm 0.11</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.1.m1.1d">± 0.11</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.3.3.3.6"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.3.6.1">72.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.3">29.67<math alttext="\pm 0.23" class="ltx_Math" display="inline" id="S4.T1.3.3.3.3.m1.1"><semantics id="S4.T1.3.3.3.3.m1.1a"><mrow id="S4.T1.3.3.3.3.m1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.cmml"><mo id="S4.T1.3.3.3.3.m1.1.1a" xref="S4.T1.3.3.3.3.m1.1.1.cmml">±</mo><mn id="S4.T1.3.3.3.3.m1.1.1.2" xref="S4.T1.3.3.3.3.m1.1.1.2.cmml">0.23</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.3.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.3.3.3.3.m1.1.1.2.cmml" type="float" xref="S4.T1.3.3.3.3.m1.1.1.2">0.23</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.m1.1c">\pm 0.23</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.3.m1.1d">± 0.23</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.6">
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.6.6.6.4">ScaleProtoSeg</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.4.1"><span class="ltx_text ltx_font_bold" id="S4.T1.4.4.4.1.1">68.97<math alttext="\pm 0.25" class="ltx_Math" display="inline" id="S4.T1.4.4.4.1.1.m1.1"><semantics id="S4.T1.4.4.4.1.1.m1.1a"><mrow id="S4.T1.4.4.4.1.1.m1.1.1" xref="S4.T1.4.4.4.1.1.m1.1.1.cmml"><mo id="S4.T1.4.4.4.1.1.m1.1.1a" xref="S4.T1.4.4.4.1.1.m1.1.1.cmml">±</mo><mn id="S4.T1.4.4.4.1.1.m1.1.1.2" xref="S4.T1.4.4.4.1.1.m1.1.1.2.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.1.m1.1b"><apply id="S4.T1.4.4.4.1.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.4.4.4.1.1.m1.1.1.1.cmml" xref="S4.T1.4.4.4.1.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.4.4.4.1.1.m1.1.1.2.cmml" type="float" xref="S4.T1.4.4.4.1.1.m1.1.1.2">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.1.m1.1c">\pm 0.25</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.1.1.m1.1d">± 0.25</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.6.6.5"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.6.5.1">68.52</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.5.2">71.80<math alttext="\pm 0.38" class="ltx_Math" display="inline" id="S4.T1.5.5.5.2.m1.1"><semantics id="S4.T1.5.5.5.2.m1.1a"><mrow id="S4.T1.5.5.5.2.m1.1.1" xref="S4.T1.5.5.5.2.m1.1.1.cmml"><mo id="S4.T1.5.5.5.2.m1.1.1a" xref="S4.T1.5.5.5.2.m1.1.1.cmml">±</mo><mn id="S4.T1.5.5.5.2.m1.1.1.2" xref="S4.T1.5.5.5.2.m1.1.1.2.cmml">0.38</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.2.m1.1b"><apply id="S4.T1.5.5.5.2.m1.1.1.cmml" xref="S4.T1.5.5.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.5.5.5.2.m1.1.1.1.cmml" xref="S4.T1.5.5.5.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.5.5.5.2.m1.1.1.2.cmml" type="float" xref="S4.T1.5.5.5.2.m1.1.1.2">0.38</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.2.m1.1c">\pm 0.38</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.5.2.m1.1d">± 0.38</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.6.6.6">72.35</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6.3"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.6.3.1">34.18<math alttext="\pm 0.18" class="ltx_Math" display="inline" id="S4.T1.6.6.6.3.1.m1.1"><semantics id="S4.T1.6.6.6.3.1.m1.1a"><mrow id="S4.T1.6.6.6.3.1.m1.1.1" xref="S4.T1.6.6.6.3.1.m1.1.1.cmml"><mo id="S4.T1.6.6.6.3.1.m1.1.1a" xref="S4.T1.6.6.6.3.1.m1.1.1.cmml">±</mo><mn id="S4.T1.6.6.6.3.1.m1.1.1.2" xref="S4.T1.6.6.6.3.1.m1.1.1.2.cmml">0.18</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.3.1.m1.1b"><apply id="S4.T1.6.6.6.3.1.m1.1.1.cmml" xref="S4.T1.6.6.6.3.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.6.6.6.3.1.m1.1.1.1.cmml" xref="S4.T1.6.6.6.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T1.6.6.6.3.1.m1.1.1.2.cmml" type="float" xref="S4.T1.6.6.6.3.1.m1.1.1.2">0.18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.3.1.m1.1c">\pm 0.18</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.6.3.1.m1.1d">± 0.18</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.8.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.9.2" style="font-size:90%;">ScaleProtoSeg mIoU performance on Pascal VOC, Cityscapes, and ADE20K. On the validation sets, we report the results over 3 runs, while for the test sets the results are based on  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> and our best ScaleProtoSeg validation run.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.4" style="width:496.9pt;height:75.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-46.5pt,7.1pt) scale(0.842286443710696,0.842286443710696) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.1.1.1.1">Dataset</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S4.T2.4.1.1.1.2">Cityscapes</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S4.T2.4.1.1.1.3">Pascal</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S4.T2.4.1.1.1.4">ADE20K</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.4.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.2.2.1.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.4.1.2.2.2">ProtoSeg</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.4.1.2.2.3">ScaleProtoSeg</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.4.1.2.2.4">ProtoSeg</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.4.1.2.2.5">ScaleProtoSeg</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.4.1.2.2.6">ProtoSeg</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.4.1.2.2.7">ScaleProtoSeg</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.4.1.3.3.1"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.3.3.1.1">Step</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.3.3.2">project</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.3.3.3">pruned</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.3.3.4">project</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.3.3.5">grouped</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.3.3.6">project</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.3.3.7">pruned</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.3.3.8">project</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.3.3.9">grouped</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.3.3.10">project</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.3.3.11">pruned</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.3.3.12">project</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.3.3.13">grouped</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.4.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.4.4.1.1">Prototypes</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.4.2">190</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.4.4.3">128</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.4.4">228</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.4.4.5"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.4.4.5.1">111</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.4.6">201</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.4.4.7">133</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.4.8">252</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.4.4.9"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.4.4.9.1">131</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.4.10">1756</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.4.4.11">1161</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.1.4.4.12">1800</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.1.4.4.13"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.4.4.13.1">1132</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.4.1.5.5.1"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.5.5.1.1">mIoU</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.5.5.2">67.24</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.5.5.3">67.23</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.5.5.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.5.5.4.1">70.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.5.5.5">69.22</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.5.5.6">72.00</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.5.5.7">72.05</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.5.5.8"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.5.5.8.1">72.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.5.5.9">72.26</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.5.5.10">30.89</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.5.5.11">29.97</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T2.4.1.5.5.12"><span class="ltx_text ltx_font_bold" id="S4.T2.4.1.5.5.12.1">34.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.4.1.5.5.13">34.32</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.9.2.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.2.1" style="font-size:90%;">Methods performance at different training steps based on the results from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> and our best ScaleProtoSeg run. The number of prototypes indicated in the <span class="ltx_text ltx_font_italic" id="S4.T2.2.1.1">project</span> step (during <span class="ltx_text ltx_font_bold" id="S4.T2.2.1.2">Stage 1</span>) is after the duplicate removal. The number of prototypes in the <span class="ltx_text ltx_font_italic" id="S4.T2.2.1.3">grouped</span> step (during <span class="ltx_text ltx_font_bold" id="S4.T2.2.1.4">Stage 2</span>) corresponds to a threshold of <math alttext="0.05" class="ltx_Math" display="inline" id="S4.T2.2.1.m1.1"><semantics id="S4.T2.2.1.m1.1b"><mn id="S4.T2.2.1.m1.1.1" xref="S4.T2.2.1.m1.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.1c"><cn id="S4.T2.2.1.m1.1.1.cmml" type="float" xref="S4.T2.2.1.m1.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.1d">0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.1.m1.1e">0.05</annotation></semantics></math> on the group matrices.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="374" id="S4.F3.sf1.g1" src="extracted/5854717/images/n_comp.jpg" width="685"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F3.sf1.3.2" style="font-size:90%;">Per-scale average number of connected components</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="374" id="S4.F3.sf2.g1" src="extracted/5854717/images/avg_area.jpg" width="685"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F3.sf2.3.2" style="font-size:90%;">Per-scale average pixel area of the connected components</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.4.2.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.2.1" style="font-size:90%;">Analysis of the binarized prototype activations at multiple percentile thresholds <math alttext="p_{th}\in\{0.8,0.9,0.99\}" class="ltx_Math" display="inline" id="S4.F3.2.1.m1.3"><semantics id="S4.F3.2.1.m1.3b"><mrow id="S4.F3.2.1.m1.3.4" xref="S4.F3.2.1.m1.3.4.cmml"><msub id="S4.F3.2.1.m1.3.4.2" xref="S4.F3.2.1.m1.3.4.2.cmml"><mi id="S4.F3.2.1.m1.3.4.2.2" xref="S4.F3.2.1.m1.3.4.2.2.cmml">p</mi><mrow id="S4.F3.2.1.m1.3.4.2.3" xref="S4.F3.2.1.m1.3.4.2.3.cmml"><mi id="S4.F3.2.1.m1.3.4.2.3.2" xref="S4.F3.2.1.m1.3.4.2.3.2.cmml">t</mi><mo id="S4.F3.2.1.m1.3.4.2.3.1" xref="S4.F3.2.1.m1.3.4.2.3.1.cmml">⁢</mo><mi id="S4.F3.2.1.m1.3.4.2.3.3" xref="S4.F3.2.1.m1.3.4.2.3.3.cmml">h</mi></mrow></msub><mo id="S4.F3.2.1.m1.3.4.1" xref="S4.F3.2.1.m1.3.4.1.cmml">∈</mo><mrow id="S4.F3.2.1.m1.3.4.3.2" xref="S4.F3.2.1.m1.3.4.3.1.cmml"><mo id="S4.F3.2.1.m1.3.4.3.2.1" stretchy="false" xref="S4.F3.2.1.m1.3.4.3.1.cmml">{</mo><mn id="S4.F3.2.1.m1.1.1" xref="S4.F3.2.1.m1.1.1.cmml">0.8</mn><mo id="S4.F3.2.1.m1.3.4.3.2.2" xref="S4.F3.2.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.F3.2.1.m1.2.2" xref="S4.F3.2.1.m1.2.2.cmml">0.9</mn><mo id="S4.F3.2.1.m1.3.4.3.2.3" xref="S4.F3.2.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.F3.2.1.m1.3.3" xref="S4.F3.2.1.m1.3.3.cmml">0.99</mn><mo id="S4.F3.2.1.m1.3.4.3.2.4" stretchy="false" xref="S4.F3.2.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.2.1.m1.3c"><apply id="S4.F3.2.1.m1.3.4.cmml" xref="S4.F3.2.1.m1.3.4"><in id="S4.F3.2.1.m1.3.4.1.cmml" xref="S4.F3.2.1.m1.3.4.1"></in><apply id="S4.F3.2.1.m1.3.4.2.cmml" xref="S4.F3.2.1.m1.3.4.2"><csymbol cd="ambiguous" id="S4.F3.2.1.m1.3.4.2.1.cmml" xref="S4.F3.2.1.m1.3.4.2">subscript</csymbol><ci id="S4.F3.2.1.m1.3.4.2.2.cmml" xref="S4.F3.2.1.m1.3.4.2.2">𝑝</ci><apply id="S4.F3.2.1.m1.3.4.2.3.cmml" xref="S4.F3.2.1.m1.3.4.2.3"><times id="S4.F3.2.1.m1.3.4.2.3.1.cmml" xref="S4.F3.2.1.m1.3.4.2.3.1"></times><ci id="S4.F3.2.1.m1.3.4.2.3.2.cmml" xref="S4.F3.2.1.m1.3.4.2.3.2">𝑡</ci><ci id="S4.F3.2.1.m1.3.4.2.3.3.cmml" xref="S4.F3.2.1.m1.3.4.2.3.3">ℎ</ci></apply></apply><set id="S4.F3.2.1.m1.3.4.3.1.cmml" xref="S4.F3.2.1.m1.3.4.3.2"><cn id="S4.F3.2.1.m1.1.1.cmml" type="float" xref="S4.F3.2.1.m1.1.1">0.8</cn><cn id="S4.F3.2.1.m1.2.2.cmml" type="float" xref="S4.F3.2.1.m1.2.2">0.9</cn><cn id="S4.F3.2.1.m1.3.3.cmml" type="float" xref="S4.F3.2.1.m1.3.3">0.99</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.1.m1.3d">p_{th}\in\{0.8,0.9,0.99\}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.2.1.m1.3e">italic_p start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT ∈ { 0.8 , 0.9 , 0.99 }</annotation></semantics></math> on Cityscapes and ADE20K validation sets.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Multi-Scale prototypes analysis.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">After the prototype projection at the end of the multi-scale prototype learning stage, different patterns of prototype activations emerge across scales. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.F3" title="Figure 3 ‣ Method Performance. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a>, we present a quantitative analysis of the prototype activations scale-specific patterns on Cityscapes and ADE20k. For this purpose, we first binarize the activation maps of the multi-scale prototype layer from ScaleProtoSeg on the validation set of both datasets: we do so with multiple percentiles <math alttext="p_{th}\in\{0.8,0.9,0.99\}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.1.m1.3"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.3a"><mrow id="S4.SS2.SSS0.Px2.p1.1.m1.3.4" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.cmml"><msub id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.cmml"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.2.cmml">p</mi><mrow id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.2.cmml">t</mi><mo id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.3.cmml">h</mi></mrow></msub><mo id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml"><mo id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">0.8</mn><mo id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS0.Px2.p1.1.m1.2.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.2.2.cmml">0.9</mn><mo id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S4.SS2.SSS0.Px2.p1.1.m1.3.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.3.cmml">0.99</mn><mo id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.4" stretchy="false" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.3b"><apply id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4"><in id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.1"></in><apply id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.2">𝑝</ci><apply id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3"><times id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.1"></times><ci id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.2">𝑡</ci><ci id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.2.3.3">ℎ</ci></apply></apply><set id="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.4.3.2"><cn id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" type="float" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">0.8</cn><cn id="S4.SS2.SSS0.Px2.p1.1.m1.2.2.cmml" type="float" xref="S4.SS2.SSS0.Px2.p1.1.m1.2.2">0.9</cn><cn id="S4.SS2.SSS0.Px2.p1.1.m1.3.3.cmml" type="float" xref="S4.SS2.SSS0.Px2.p1.1.m1.3.3">0.99</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.3c">p_{th}\in\{0.8,0.9,0.99\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.1.m1.3d">italic_p start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT ∈ { 0.8 , 0.9 , 0.99 }</annotation></semantics></math>. Then we measure the number of connected components in the binarized maps as well as their average area in number of pixels. The average results per scale across all scale-specific prototypes are displayed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.F3" title="Figure 3 ‣ Method Performance. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p2.1">We compute the connected components with the standard algorithm from <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.1">opencv</span> with an 8-connectivity relation between non-zero elements. We observe an overall decrease in the number of connected components when going from <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.2">Scale 1</span> to <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.3">Scale 4</span> across all thresholds and datasets and an increase in the average pixel area of the detected components (especially for ADE20K, which is less focused on images with large depth of field). In practice, this can be interpreted as a consequence of the lower field of view of the feature maps specific to <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.4">Scale 1</span> compared to those of <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.5">Scale 4</span> in the ASPP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite>, where each scale-specific feature map vector represents a smaller receptive field on the image with less context. As such, the prototypes specific to <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.6">Scale 1</span> can be activated by smaller-scale prototypical parts and texture components. This analysis reflects the advantage of learning explicitly scale-specific prototypes across multiple scales: not only ScaleProtoSeg shows a performance improvement (see Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.T2" title="Table 2 ‣ Method Performance. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>), but it also learns diverse object representations across scales, highlighting the multi-scale nature of semantic segmentation. In the supplementary material, we also analyzed if the prototypes present equivariance properties across scales in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S11" title="11 Multi-scale prototype analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="285" id="S4.F4.g1" src="x4.png" width="951"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.9.3.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.4.2" style="font-size:90%;">ScaleProtoSeg provides the interpretation of a segmentation through the analysis of groups of prototypes. For the example of the class <span class="ltx_text ltx_font_italic" id="S4.F4.4.2.1">car</span> on Cityscapes, <math alttext="2" class="ltx_Math" display="inline" id="S4.F4.3.1.m1.1"><semantics id="S4.F4.3.1.m1.1b"><mn id="S4.F4.3.1.m1.1.1" xref="S4.F4.3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.F4.3.1.m1.1c"><cn id="S4.F4.3.1.m1.1.1.cmml" type="integer" xref="S4.F4.3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.3.1.m1.1d">2</annotation><annotation encoding="application/x-llamapun" id="S4.F4.3.1.m1.1e">2</annotation></semantics></math> prototypes per scale (whose activations are displayed <span class="ltx_text ltx_font_bold" id="S4.F4.4.2.2">at the top</span> of the figure) are used by the model across the <math alttext="3" class="ltx_Math" display="inline" id="S4.F4.4.2.m2.1"><semantics id="S4.F4.4.2.m2.1b"><mn id="S4.F4.4.2.m2.1.1" xref="S4.F4.4.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.F4.4.2.m2.1c"><cn id="S4.F4.4.2.m2.1.1.cmml" type="integer" xref="S4.F4.4.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.2.m2.1d">3</annotation><annotation encoding="application/x-llamapun" id="S4.F4.4.2.m2.1e">3</annotation></semantics></math> learned groups shown <span class="ltx_text ltx_font_bold" id="S4.F4.4.2.3">at the bottom right</span>. For this class, groups correspond to the bottom part, the main part or the upper part of the car.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Quantitative analysis of interpretability.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px3.p1.6">The quantitative evaluation of interpretability is an intrinsic problem in the field of XAI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib1" title="">1</a>]</cite> and especially in the context of per-design methods such as prototypical-parts learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib91" title="">91</a>]</cite>. Several studies proposed human-based evaluations of explainable methods for classification tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib13" title="">13</a>]</cite>. However, scaling those evaluation scenarios to semantic segmentation raises concerns due to the complexity of the necessary human feedback compared to classification. We propose to quantitatively assess the degree of interpretability in terms of <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.6.1">consistency</span>, <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.6.2">stability</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px3.p1.6.3">sparsity</span>. The first two metrics have been proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib37" title="">37</a>]</cite> to measure the interpretability of a classification model.
We leverage the part-annotations extension of Pascal and Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib58" title="">58</a>]</cite> covering respectively 16 and 5 classes, and propose an extension of these metrics to the task of semantic segmentation. Given an input image <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.1.m1.1d">bold_x</annotation></semantics></math> and a prototype <math alttext="\mathbf{p}_{\operatorname*{m}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px3.p1.2.m2.1a"><msub id="S4.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml">𝐩</mi><mo id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml">m</mo></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.2">𝐩</ci><ci id="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.m2.1.1.3">m</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.2.m2.1c">\mathbf{p}_{\operatorname*{m}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.2.m2.1d">bold_p start_POSTSUBSCRIPT roman_m end_POSTSUBSCRIPT</annotation></semantics></math>, the prototype activation <math alttext="g_{\text{proto}}(\mathbf{z},\mathbf{p}_{\operatorname*{m}}),\&gt;\forall\mathbf{z%
}\in f(\mathbf{x})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.3.m3.4"><semantics id="S4.SS2.SSS0.Px3.p1.3.m3.4a"><mrow id="S4.SS2.SSS0.Px3.p1.3.m3.4.4" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.cmml"><mrow id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.3.cmml"><mrow id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.cmml"><msub id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.2.cmml">g</mi><mtext id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.3" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.3a.cmml">proto</mtext></msub><mo id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml">𝐳</mi><mo id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.2.cmml">,</mo><msub id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.2.cmml">𝐩</mi><mo id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.3.cmml">m</mo></msub><mo id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.4" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.3" rspace="0.387em" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.3.cmml">,</mo><mrow id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.cmml"><mo id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.1" rspace="0.167em" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.1.cmml">∀</mo><mi id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.2.cmml">𝐳</mi></mrow></mrow><mo id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.3" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.3.cmml">∈</mo><mrow id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.cmml"><mi id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.2.cmml">f</mi><mo id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.1" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.3.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.cmml"><mo id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.cmml">(</mo><mi id="S4.SS2.SSS0.Px3.p1.3.m3.2.2" xref="S4.SS2.SSS0.Px3.p1.3.m3.2.2.cmml">𝐱</mi><mo id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.3.m3.4b"><apply id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4"><in id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.3.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.3"></in><list id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2"><apply id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1"><times id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.2"></times><apply id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.2">𝑔</ci><ci id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.3a.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.3"><mtext id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.3.3">proto</mtext></ci></apply><interval closure="open" id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1"><ci id="S4.SS2.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.1.1">𝐳</ci><apply id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.2">𝐩</ci><ci id="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.3.3.1.1.1.1.1.1.3">m</ci></apply></interval></apply><apply id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2"><csymbol cd="latexml" id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.1">for-all</csymbol><ci id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.2.2.2.2">𝐳</ci></apply></list><apply id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4"><times id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.1"></times><ci id="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.4.4.4.2">𝑓</ci><ci id="S4.SS2.SSS0.Px3.p1.3.m3.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.3.m3.2.2">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.3.m3.4c">g_{\text{proto}}(\mathbf{z},\mathbf{p}_{\operatorname*{m}}),\&gt;\forall\mathbf{z%
}\in f(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.3.m3.4d">italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z , bold_p start_POSTSUBSCRIPT roman_m end_POSTSUBSCRIPT ) , ∀ bold_z ∈ italic_f ( bold_x )</annotation></semantics></math> is binarized using multiple percentile thresholds: <math alttext="\{70^{th},80^{th},90^{th}\}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.4.m4.3"><semantics id="S4.SS2.SSS0.Px3.p1.4.m4.3a"><mrow id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.4.cmml"><mo id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.4" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.4.cmml">{</mo><msup id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.cmml"><mn id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.2.cmml">70</mn><mrow id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.2" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.1" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.3.cmml">h</mi></mrow></msup><mo id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.5" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.4.cmml">,</mo><msup id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.cmml"><mn id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.2" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.2.cmml">80</mn><mrow id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.cmml"><mi id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.2" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.2.cmml">t</mi><mo id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.1" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.3.cmml">h</mi></mrow></msup><mo id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.6" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.4.cmml">,</mo><msup id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.cmml"><mn id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.2" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.2.cmml">90</mn><mrow id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.cmml"><mi id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.2" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.2.cmml">t</mi><mo id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.1" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.3" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.3.cmml">h</mi></mrow></msup><mo id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.7" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.4.m4.3b"><set id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.4.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3"><apply id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1">superscript</csymbol><cn id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.2">70</cn><apply id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3"><times id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.2">𝑡</ci><ci id="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.1.1.1.1.3.3">ℎ</ci></apply></apply><apply id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2">superscript</csymbol><cn id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.2.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.2">80</cn><apply id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3"><times id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.1"></times><ci id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.2.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.2">𝑡</ci><ci id="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.2.2.2.2.3.3">ℎ</ci></apply></apply><apply id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3">superscript</csymbol><cn id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.2.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.2">90</cn><apply id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3"><times id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.1"></times><ci id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.2.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.2">𝑡</ci><ci id="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.m4.3.3.3.3.3.3">ℎ</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.4.m4.3c">\{70^{th},80^{th},90^{th}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.4.m4.3d">{ 70 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT , 80 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT , 90 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT }</annotation></semantics></math> instead of a fixed size bounding box, as multiple objects of the same class can be present in <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.5.m5.1"><semantics id="S4.SS2.SSS0.Px3.p1.5.m5.1a"><mi id="S4.SS2.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px3.p1.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.5.m5.1b"><ci id="S4.SS2.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.5.m5.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.5.m5.1d">bold_x</annotation></semantics></math>. We then compute the average consistency and stability scores across the multiple thresholds on the part-annotated validation sets for 3 runs per method, similarly to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib37" title="">37</a>]</cite>. We also introduce a global sparsity metric that measures the number of active prototypes per class after thresholding the last linear layer absolute values with <math alttext="\tau_{th}=0.005" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.6.m6.1"><semantics id="S4.SS2.SSS0.Px3.p1.6.m6.1a"><mrow id="S4.SS2.SSS0.Px3.p1.6.m6.1.1" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.cmml"><msub id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.2" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.2.cmml">τ</mi><mrow id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.cmml"><mi id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.2" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.2.cmml">t</mi><mo id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.1" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.3" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.3.cmml">h</mi></mrow></msub><mo id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.1" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.3" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.6.m6.1b"><apply id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1"><eq id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.1"></eq><apply id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.2">𝜏</ci><apply id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3"><times id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.1"></times><ci id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.2.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.2">𝑡</ci><ci id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.2.3.3">ℎ</ci></apply></apply><cn id="S4.SS2.SSS0.Px3.p1.6.m6.1.1.3.cmml" type="float" xref="S4.SS2.SSS0.Px3.p1.6.m6.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.6.m6.1c">\tau_{th}=0.005</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.6.m6.1d">italic_τ start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT = 0.005</annotation></semantics></math>, which is similar to the sparsity ratio used as a measure of interpretations’ compactness in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib61" title="">61</a>]</cite>. The measured sparsity is linked to several properties of interpretability: transparency <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib24" title="">24</a>]</cite>, understandability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib15" title="">15</a>]</cite>, and simplicity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib60" title="">60</a>]</cite>. Despite this metrics not being exhaustive, our assessment shows that ScaleProtoSeg displays overall enhanced interpretability over ProtoSeg (see Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.T3" title="Table 3 ‣ Quantitative analysis of interpretability. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.T4" title="Table 4 ‣ Quantitative analysis of interpretability. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<figure class="ltx_table" id="S4.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.9" style="width:216.8pt;height:53.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-36.4pt,9.1pt) scale(0.748480123677169,0.748480123677169) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.9.9.10.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T3.9.9.10.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T3.9.9.10.1.2">Pascal</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.3.3.3.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.4.1">Methods:</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.1">Consistency <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><mo id="S4.T3.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T3.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.2.2">Stability <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.2.m1.1a"><mo id="S4.T3.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T3.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m1.1b"><ci id="S4.T3.2.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.3.3">Sparsity <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.3.3.3.3.m1.1"><semantics id="S4.T3.3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T3.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><ci id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.6.6.6.4">ProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.4.4.4.1">35.05 <math alttext="\pm 1.44" class="ltx_Math" display="inline" id="S4.T3.4.4.4.1.m1.1"><semantics id="S4.T3.4.4.4.1.m1.1a"><mrow id="S4.T3.4.4.4.1.m1.1.1" xref="S4.T3.4.4.4.1.m1.1.1.cmml"><mo id="S4.T3.4.4.4.1.m1.1.1a" xref="S4.T3.4.4.4.1.m1.1.1.cmml">±</mo><mn id="S4.T3.4.4.4.1.m1.1.1.2" xref="S4.T3.4.4.4.1.m1.1.1.2.cmml">1.44</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.1.m1.1b"><apply id="S4.T3.4.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.4.4.4.1.m1.1.1.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T3.4.4.4.1.m1.1.1.2.cmml" type="float" xref="S4.T3.4.4.4.1.m1.1.1.2">1.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.1.m1.1c">\pm 1.44</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.4.1.m1.1d">± 1.44</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.5.5.2">73.45 <math alttext="\pm 0.45" class="ltx_Math" display="inline" id="S4.T3.5.5.5.2.m1.1"><semantics id="S4.T3.5.5.5.2.m1.1a"><mrow id="S4.T3.5.5.5.2.m1.1.1" xref="S4.T3.5.5.5.2.m1.1.1.cmml"><mo id="S4.T3.5.5.5.2.m1.1.1a" xref="S4.T3.5.5.5.2.m1.1.1.cmml">±</mo><mn id="S4.T3.5.5.5.2.m1.1.1.2" xref="S4.T3.5.5.5.2.m1.1.1.2.cmml">0.45</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.2.m1.1b"><apply id="S4.T3.5.5.5.2.m1.1.1.cmml" xref="S4.T3.5.5.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.5.5.5.2.m1.1.1.1.cmml" xref="S4.T3.5.5.5.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T3.5.5.5.2.m1.1.1.2.cmml" type="float" xref="S4.T3.5.5.5.2.m1.1.1.2">0.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.2.m1.1c">\pm 0.45</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.5.2.m1.1d">± 0.45</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.6.6.3">157.67 <math alttext="\pm 3.40" class="ltx_Math" display="inline" id="S4.T3.6.6.6.3.m1.1"><semantics id="S4.T3.6.6.6.3.m1.1a"><mrow id="S4.T3.6.6.6.3.m1.1.1" xref="S4.T3.6.6.6.3.m1.1.1.cmml"><mo id="S4.T3.6.6.6.3.m1.1.1a" xref="S4.T3.6.6.6.3.m1.1.1.cmml">±</mo><mn id="S4.T3.6.6.6.3.m1.1.1.2" xref="S4.T3.6.6.6.3.m1.1.1.2.cmml">3.40</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.6.3.m1.1b"><apply id="S4.T3.6.6.6.3.m1.1.1.cmml" xref="S4.T3.6.6.6.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.6.6.6.3.m1.1.1.1.cmml" xref="S4.T3.6.6.6.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T3.6.6.6.3.m1.1.1.2.cmml" type="float" xref="S4.T3.6.6.6.3.m1.1.1.2">3.40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.6.3.m1.1c">\pm 3.40</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.6.3.m1.1d">± 3.40</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.9.9.9.4">ScaleProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.7.7.7.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.7.7.1.1">38.78</span> <math alttext="\pm 1.68" class="ltx_Math" display="inline" id="S4.T3.7.7.7.1.m1.1"><semantics id="S4.T3.7.7.7.1.m1.1a"><mrow id="S4.T3.7.7.7.1.m1.1.1" xref="S4.T3.7.7.7.1.m1.1.1.cmml"><mo id="S4.T3.7.7.7.1.m1.1.1a" xref="S4.T3.7.7.7.1.m1.1.1.cmml">±</mo><mn id="S4.T3.7.7.7.1.m1.1.1.2" xref="S4.T3.7.7.7.1.m1.1.1.2.cmml">1.68</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.7.1.m1.1b"><apply id="S4.T3.7.7.7.1.m1.1.1.cmml" xref="S4.T3.7.7.7.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.7.7.7.1.m1.1.1.1.cmml" xref="S4.T3.7.7.7.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T3.7.7.7.1.m1.1.1.2.cmml" type="float" xref="S4.T3.7.7.7.1.m1.1.1.2">1.68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.7.1.m1.1c">\pm 1.68</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.7.7.1.m1.1d">± 1.68</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.8.8.8.2">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.8.8.2.1">76.30</span> <math alttext="\pm 0.26" class="ltx_Math" display="inline" id="S4.T3.8.8.8.2.m1.1"><semantics id="S4.T3.8.8.8.2.m1.1a"><mrow id="S4.T3.8.8.8.2.m1.1.1" xref="S4.T3.8.8.8.2.m1.1.1.cmml"><mo id="S4.T3.8.8.8.2.m1.1.1a" xref="S4.T3.8.8.8.2.m1.1.1.cmml">±</mo><mn id="S4.T3.8.8.8.2.m1.1.1.2" xref="S4.T3.8.8.8.2.m1.1.1.2.cmml">0.26</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.8.2.m1.1b"><apply id="S4.T3.8.8.8.2.m1.1.1.cmml" xref="S4.T3.8.8.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.8.8.8.2.m1.1.1.1.cmml" xref="S4.T3.8.8.8.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T3.8.8.8.2.m1.1.1.2.cmml" type="float" xref="S4.T3.8.8.8.2.m1.1.1.2">0.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.8.2.m1.1c">\pm 0.26</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.8.8.2.m1.1d">± 0.26</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.9.9.9.3">
<span class="ltx_text ltx_font_bold" id="S4.T3.9.9.9.3.1">23.34</span> <math alttext="\pm 5.22" class="ltx_Math" display="inline" id="S4.T3.9.9.9.3.m1.1"><semantics id="S4.T3.9.9.9.3.m1.1a"><mrow id="S4.T3.9.9.9.3.m1.1.1" xref="S4.T3.9.9.9.3.m1.1.1.cmml"><mo id="S4.T3.9.9.9.3.m1.1.1a" xref="S4.T3.9.9.9.3.m1.1.1.cmml">±</mo><mn id="S4.T3.9.9.9.3.m1.1.1.2" xref="S4.T3.9.9.9.3.m1.1.1.2.cmml">5.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.9.3.m1.1b"><apply id="S4.T3.9.9.9.3.m1.1.1.cmml" xref="S4.T3.9.9.9.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.9.9.9.3.m1.1.1.1.cmml" xref="S4.T3.9.9.9.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T3.9.9.9.3.m1.1.1.2.cmml" type="float" xref="S4.T3.9.9.9.3.m1.1.1.2">5.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.9.3.m1.1c">\pm 5.22</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.9.9.3.m1.1d">± 5.22</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.11.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.12.2" style="font-size:90%;">Consistency, stability, and sparsity scores on Pascal part-annotated sets.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.9" style="width:216.8pt;height:54.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-33.9pt,8.6pt) scale(0.761626755151819,0.761626755151819) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.9.9.10.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T4.9.9.10.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T4.9.9.10.1.2">Cityscapes</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.3.3.3.4"><span class="ltx_text ltx_font_bold" id="S4.T4.3.3.3.4.1">Methods:</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.1.1">Consistency <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T4.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.2.2.2.2">Stability <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.m1.1"><semantics id="S4.T4.2.2.2.2.m1.1a"><mo id="S4.T4.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T4.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m1.1b"><ci id="S4.T4.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.3.3.3.3">Sparsity <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T4.3.3.3.3.m1.1"><semantics id="S4.T4.3.3.3.3.m1.1a"><mo id="S4.T4.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T4.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.3.m1.1b"><ci id="S4.T4.3.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.6.6.6.4">ProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.4.4.1">
<span class="ltx_text ltx_font_bold" id="S4.T4.4.4.4.1.1">34.48</span> <math alttext="\pm 1.74" class="ltx_Math" display="inline" id="S4.T4.4.4.4.1.m1.1"><semantics id="S4.T4.4.4.4.1.m1.1a"><mrow id="S4.T4.4.4.4.1.m1.1.1" xref="S4.T4.4.4.4.1.m1.1.1.cmml"><mo id="S4.T4.4.4.4.1.m1.1.1a" xref="S4.T4.4.4.4.1.m1.1.1.cmml">±</mo><mn id="S4.T4.4.4.4.1.m1.1.1.2" xref="S4.T4.4.4.4.1.m1.1.1.2.cmml">1.74</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.1.m1.1b"><apply id="S4.T4.4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.4.4.4.1.m1.1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T4.4.4.4.1.m1.1.1.2.cmml" type="float" xref="S4.T4.4.4.4.1.m1.1.1.2">1.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.1.m1.1c">\pm 1.74</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.4.1.m1.1d">± 1.74</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.5.5.5.2">27.00 <math alttext="\pm 1.58" class="ltx_Math" display="inline" id="S4.T4.5.5.5.2.m1.1"><semantics id="S4.T4.5.5.5.2.m1.1a"><mrow id="S4.T4.5.5.5.2.m1.1.1" xref="S4.T4.5.5.5.2.m1.1.1.cmml"><mo id="S4.T4.5.5.5.2.m1.1.1a" xref="S4.T4.5.5.5.2.m1.1.1.cmml">±</mo><mn id="S4.T4.5.5.5.2.m1.1.1.2" xref="S4.T4.5.5.5.2.m1.1.1.2.cmml">1.58</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.2.m1.1b"><apply id="S4.T4.5.5.5.2.m1.1.1.cmml" xref="S4.T4.5.5.5.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.5.5.5.2.m1.1.1.1.cmml" xref="S4.T4.5.5.5.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T4.5.5.5.2.m1.1.1.2.cmml" type="float" xref="S4.T4.5.5.5.2.m1.1.1.2">1.58</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.2.m1.1c">\pm 1.58</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.5.5.2.m1.1d">± 1.58</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.6.6.6.3">134 <math alttext="\pm 2.45" class="ltx_Math" display="inline" id="S4.T4.6.6.6.3.m1.1"><semantics id="S4.T4.6.6.6.3.m1.1a"><mrow id="S4.T4.6.6.6.3.m1.1.1" xref="S4.T4.6.6.6.3.m1.1.1.cmml"><mo id="S4.T4.6.6.6.3.m1.1.1a" xref="S4.T4.6.6.6.3.m1.1.1.cmml">±</mo><mn id="S4.T4.6.6.6.3.m1.1.1.2" xref="S4.T4.6.6.6.3.m1.1.1.2.cmml">2.45</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.3.m1.1b"><apply id="S4.T4.6.6.6.3.m1.1.1.cmml" xref="S4.T4.6.6.6.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.6.6.6.3.m1.1.1.1.cmml" xref="S4.T4.6.6.6.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T4.6.6.6.3.m1.1.1.2.cmml" type="float" xref="S4.T4.6.6.6.3.m1.1.1.2">2.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.3.m1.1c">\pm 2.45</annotation><annotation encoding="application/x-llamapun" id="S4.T4.6.6.6.3.m1.1d">± 2.45</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.9.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.9.9.9.4">ScaleProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.7.7.7.1">31.11 <math alttext="\pm 1.66" class="ltx_Math" display="inline" id="S4.T4.7.7.7.1.m1.1"><semantics id="S4.T4.7.7.7.1.m1.1a"><mrow id="S4.T4.7.7.7.1.m1.1.1" xref="S4.T4.7.7.7.1.m1.1.1.cmml"><mo id="S4.T4.7.7.7.1.m1.1.1a" xref="S4.T4.7.7.7.1.m1.1.1.cmml">±</mo><mn id="S4.T4.7.7.7.1.m1.1.1.2" xref="S4.T4.7.7.7.1.m1.1.1.2.cmml">1.66</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.7.1.m1.1b"><apply id="S4.T4.7.7.7.1.m1.1.1.cmml" xref="S4.T4.7.7.7.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.7.7.7.1.m1.1.1.1.cmml" xref="S4.T4.7.7.7.1.m1.1.1">plus-or-minus</csymbol><cn id="S4.T4.7.7.7.1.m1.1.1.2.cmml" type="float" xref="S4.T4.7.7.7.1.m1.1.1.2">1.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.7.1.m1.1c">\pm 1.66</annotation><annotation encoding="application/x-llamapun" id="S4.T4.7.7.7.1.m1.1d">± 1.66</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.8.8.8.2">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.8.8.2.1">32.54</span> <math alttext="\pm 2.36" class="ltx_Math" display="inline" id="S4.T4.8.8.8.2.m1.1"><semantics id="S4.T4.8.8.8.2.m1.1a"><mrow id="S4.T4.8.8.8.2.m1.1.1" xref="S4.T4.8.8.8.2.m1.1.1.cmml"><mo id="S4.T4.8.8.8.2.m1.1.1a" xref="S4.T4.8.8.8.2.m1.1.1.cmml">±</mo><mn id="S4.T4.8.8.8.2.m1.1.1.2" xref="S4.T4.8.8.8.2.m1.1.1.2.cmml">2.36</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.8.2.m1.1b"><apply id="S4.T4.8.8.8.2.m1.1.1.cmml" xref="S4.T4.8.8.8.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.8.8.8.2.m1.1.1.1.cmml" xref="S4.T4.8.8.8.2.m1.1.1">plus-or-minus</csymbol><cn id="S4.T4.8.8.8.2.m1.1.1.2.cmml" type="float" xref="S4.T4.8.8.8.2.m1.1.1.2">2.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.8.2.m1.1c">\pm 2.36</annotation><annotation encoding="application/x-llamapun" id="S4.T4.8.8.8.2.m1.1d">± 2.36</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.9.9.9.3">
<span class="ltx_text ltx_font_bold" id="S4.T4.9.9.9.3.1">12.91</span> <math alttext="\pm 1.26" class="ltx_Math" display="inline" id="S4.T4.9.9.9.3.m1.1"><semantics id="S4.T4.9.9.9.3.m1.1a"><mrow id="S4.T4.9.9.9.3.m1.1.1" xref="S4.T4.9.9.9.3.m1.1.1.cmml"><mo id="S4.T4.9.9.9.3.m1.1.1a" xref="S4.T4.9.9.9.3.m1.1.1.cmml">±</mo><mn id="S4.T4.9.9.9.3.m1.1.1.2" xref="S4.T4.9.9.9.3.m1.1.1.2.cmml">1.26</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.9.3.m1.1b"><apply id="S4.T4.9.9.9.3.m1.1.1.cmml" xref="S4.T4.9.9.9.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.9.9.9.3.m1.1.1.1.cmml" xref="S4.T4.9.9.9.3.m1.1.1">plus-or-minus</csymbol><cn id="S4.T4.9.9.9.3.m1.1.1.2.cmml" type="float" xref="S4.T4.9.9.9.3.m1.1.1.2">1.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.9.3.m1.1c">\pm 1.26</annotation><annotation encoding="application/x-llamapun" id="S4.T4.9.9.9.3.m1.1d">± 1.26</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.11.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S4.T4.12.2" style="font-size:90%;">Consistency, stability, and sparsity scores on Cityscapes part-annotated sets.</span></figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Qualitative analysis of grouping mechanism interpretability.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p1.3">In terms of interpretability, the groups can be first represented through specific visualization for each sample, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.F4" title="Figure 4 ‣ Multi-Scale prototypes analysis. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a>, where the images on the graph display the prototype activations for an input sample. Those activations are grouped per scale and provide local explanations for the model. Moreover, the edges in those visualizations are static for all samples assigned to the class <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.3.1">car</span> in Cityscapes, and so provide global explanations on the model behavior. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.F4" title="Figure 4 ‣ Multi-Scale prototypes analysis. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a>, we can easily observe, despite the large number of prototypes compared to the model mean of <math alttext="3.39" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p1.1.m1.1a"><mn id="S4.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml">3.39</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.1.m1.1b"><cn id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" type="float" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1">3.39</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.1.m1.1c">3.39</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.1.m1.1d">3.39</annotation></semantics></math>, that different patterns emerge for each group. The first group focuses mainly on a prototype in <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.3.2">Scale 4</span> activated on the bottom part of the cars and another similar at <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.3.3">Scale 2</span>. The second group focuses on a prototype at <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.3.4">Scale 1</span>, which activates the top of the cars with another one similar at <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.3.5">Scale 3</span>. Lastly, the third group focuses on multiple parts of the cars and, will activate on the main body of them. Groups <math alttext="1" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px4.p1.2.m2.1a"><mn id="S4.SS2.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.2.m2.1b"><cn id="S4.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.2.m2.1d">1</annotation></semantics></math> and <math alttext="2" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px4.p1.3.m3.1a"><mn id="S4.SS2.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.3.m3.1b"><cn id="S4.SS2.SSS0.Px4.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p1.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.3.m3.1d">2</annotation></semantics></math>, by combining similar prototypes across two scales, show transparently the use of multi-scale information in the model. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.F4" title="Figure 4 ‣ Multi-Scale prototypes analysis. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates that the grouping mechanism in our method can be represented for both local and global interpretability. The example of group assignments for the class <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.3.6">car</span> illustrates the identified parts in the group visualization. Interestingly, the second group seems more activated on cars further in the depth field, as its main activated prototype is from <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p1.3.7">Scale 1</span> with a smaller field of view. This clearly illustrates the role of scale in the identification of prototypical parts.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.F5.9" style="width:216.8pt;height:115.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-147.8pt,78.5pt) scale(0.423117719543056,0.423117719543056) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.F5.9.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.F5.3.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.F5.3.3.3.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.F5.3.3.3.4.1" style="width:8.9pt;height:55.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:55.6pt;transform:translate(-23.35pt,-22.38pt) rotate(-90deg) ;">
<p class="ltx_p" id="S4.F5.3.3.3.4.1.1">Original</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.1.1.1.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.1.1.1.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000000_005898_original.jpg" width="220"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.2.2.2.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.2.2.2.2.g1" src="extracted/5854717/images/plot_img_ADE_val_00000139_original.jpg" width="220"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.3.3.3.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.3.3.3.3.g1" src="extracted/5854717/images/plot_img_2011_002730_original.jpg" width="220"/></td>
</tr>
<tr class="ltx_tr" id="S4.F5.6.6.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.F5.6.6.6.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.F5.6.6.6.4.1" style="width:20.1pt;height:85.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:85.4pt;transform:translate(-32.63pt,-29.36pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S4.F5.6.6.6.4.1.1" style="width:85.4pt;">ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.4.4.4.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.4.4.4.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000000_005898_max_class_bus.jpg" width="220"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.5.5.5.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.5.5.5.2.g1" src="extracted/5854717/images/plot_img_ADE_val_00000139_max_class_bed.jpg" width="220"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.6.6.6.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.6.6.6.3.g1" src="extracted/5854717/images/plot_img_2011_002730_max_class_horse.jpg" width="220"/></td>
</tr>
<tr class="ltx_tr" id="S4.F5.9.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.F5.9.9.9.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.F5.9.9.9.4.1" style="width:16.3pt;height:85.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:85.4pt;transform:translate(-34.53pt,-32.2pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S4.F5.9.9.9.4.1.1" style="width:85.4pt;">ScaleProtoSeg groups</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.7.7.7.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.7.7.7.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000000_005898_max_class_bus_group.jpg" width="220"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.8.8.8.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.8.8.8.2.g1" src="extracted/5854717/images/plot_img_ADE_val_00000139_max_class_bed_group.jpg" width="220"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F5.9.9.9.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S4.F5.9.9.9.3.g1" src="extracted/5854717/images/plot_img_2011_002730_max_class_horse_group.jpg" width="220"/></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.14.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.15.2" style="font-size:90%;">Model prototype and group assignments for the class <span class="ltx_text ltx_font_italic" id="S4.F5.15.2.1">bus</span>, <span class="ltx_text ltx_font_italic" id="S4.F5.15.2.2">bed</span>, and <span class="ltx_text ltx_font_italic" id="S4.F5.15.2.3">horse</span> on Cityscapes, ADE20K, and Pascal.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.SSS0.Px4.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p2.3">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.F5" title="Figure 5 ‣ Qualitative analysis of grouping mechanism interpretability. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">5</span></a>, we show the final decision process based on the prototype assignments for ProtoSeg (row <math alttext="2" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p2.1.m1.1a"><mn id="S4.SS2.SSS0.Px4.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p2.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.1.m1.1b"><cn id="S4.SS2.SSS0.Px4.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p2.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.1.m1.1d">2</annotation></semantics></math>) and the group assignments for ScaleProtoSeg (row <math alttext="3" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px4.p2.2.m2.1a"><mn id="S4.SS2.SSS0.Px4.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px4.p2.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.2.m2.1b"><cn id="S4.SS2.SSS0.Px4.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p2.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.2.m2.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.2.m2.1d">3</annotation></semantics></math>). The ProtoSeg outputs were computed based on a rerun of the model after pruning. In all three examples of Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.F5" title="Figure 5 ‣ Qualitative analysis of grouping mechanism interpretability. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">5</span></a>, our groups identify one or more prototypical parts each, for the class <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p2.3.1">bus</span>, <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p2.3.2">bed</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px4.p2.3.3">horse</span>. For instance, in the bus image, the first group in red corresponds to both the front and back top of the bus, a pattern that can be also seen in the other two images. Moreover, we see through those examples that, due to the limited number of groups <math alttext="(N_{c}=3)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.3.m3.1"><semantics id="S4.SS2.SSS0.Px4.p2.3.m3.1a"><mrow id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.cmml"><msub id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.2" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.3" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.1" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.3" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.3.cmml">3</mn></mrow><mo id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.3.m3.1b"><apply id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1"><eq id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.1"></eq><apply id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.2">𝑁</ci><ci id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.2.3">𝑐</ci></apply><cn id="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p2.3.m3.1.1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.3.m3.1c">(N_{c}=3)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.3.m3.1d">( italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = 3 )</annotation></semantics></math> in ScaleProtoSeg, the interpretation of the final decision process is more constrained compared to the baseline method ProtoSeg. Indeed, even if we consider the prototype interactions leading to the group and their assignment, our method still uses fewer prototypes compared to ProtoSeg, as described in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.T2" title="Table 2 ‣ Method Performance. ‣ 4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>. Lastly, as detailed in the supplementary Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S12" title="12 Sparsity and Computation Overhead ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">12</span></a>, our method enforces stronger sparsity regularization on the final classification layer inducing a smaller computation overhead on DeepLabv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite> compared to ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px4.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p3.1">Overall, through the sparsity of the groups, their simple visualizations, their small number, and the sparse final linear layer, we advocate that our method enables the user to investigate more transparently the semantic segmentation model while improving upon the state-of-the-art ProtoSeg.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we present an interpretable semantic segmentation model, ScaleProtoSeg, that leverages multi-scale representations for prototype learning and introduces a novel grouping mechanism to learn prototype interactions across scales. We showed that our model results are particularly advantageous in complex datasets presenting many objects at different depths: Cityscapes and ADE20K. Moreover, through our analysis, we evaluated ScaleProtoSeg interpretability across <math alttext="3" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mn id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><cn id="S5.p1.1.m1.1.1.cmml" type="integer" xref="S5.p1.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">3</annotation></semantics></math> quantitative metrics: <span class="ltx_text ltx_font_italic" id="S5.p1.1.1">consistency</span>, <span class="ltx_text ltx_font_italic" id="S5.p1.1.2">stability</span>, and <span class="ltx_text ltx_font_italic" id="S5.p1.1.3">sparsity</span> and inspected the different patterns learned by the prototypes across scales. This showcases the potential of multi-scale prototype learning to provide a deeper understanding of the effect of scales on object representations. Lastly, our novel grouping mechanism provides a clear representation of the final decision process: it shows how the model learns to group the prototypes across scales by limiting the number of active groups, allowing for their easy and sparse visualization for all images.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.1.1" style="font-size:90%;">
Julius Adebayo, Justin Gilmer, Michael Muelly, Ian Goodfellow, Moritz Hardt, and Been Kim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.2.1" style="font-size:90%;">Sanity checks for saliency maps.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib1.4.2" style="font-size:90%;">, 31, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.1.1" style="font-size:90%;">
Julius Adebayo, Michael Muelly, Harold Abelson, and Been Kim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.2.1" style="font-size:90%;">Post hoc explanations may be ineffective for detecting unknown spurious correlation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib2.4.2" style="font-size:90%;">International conference on learning representations</span><span class="ltx_text" id="bib.bib2.5.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.1.1" style="font-size:90%;">
Rishabh Agarwal, Levi Melnick, Nicholas Frosst, Xuezhou Zhang, Ben Lengerich, Rich Caruana, and Geoffrey E Hinton.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.2.1" style="font-size:90%;">Neural additive models: Interpretable machine learning with neural nets.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib3.4.2" style="font-size:90%;">, 34:4699–4711, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.1.1" style="font-size:90%;">
I Arganda-Carreras, HS Seung, A Cardona, and J Schindelin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.2.1" style="font-size:90%;">Segmentation of neuronal structures in em stacks challenge-isbi 2012, 2012.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.1.1" style="font-size:90%;">
Miguel A Belenguer-Plomer, Mihai A Tanase, Angel Fernandez-Carrillo, and Emilio Chuvieco.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.2.1" style="font-size:90%;">Burned area detection and mapping using sentinel-1 backscatter coefficient and thermal anomalies.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.3.1" style="font-size:90%;">Remote Sensing of Environment</span><span class="ltx_text" id="bib.bib5.4.2" style="font-size:90%;">, 233:111345, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.1.1" style="font-size:90%;">
Andrea Bontempelli, Stefano Teso, Katya Tentori, Fausto Giunchiglia, and Andrea Passerini.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.2.1" style="font-size:90%;">Concept-level debugging of part-prototype networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.3.1" style="font-size:90%;">arXiv preprint arXiv:2205.15769</span><span class="ltx_text" id="bib.bib6.4.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.1.1" style="font-size:90%;">
Holger Caesar, Jasper Uijlings, and Vittorio Ferrari.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.2.1" style="font-size:90%;">Coco-stuff: Thing and stuff classes in context.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib7.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib7.5.3" style="font-size:90%;">, pages 1209–1218, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.1.1" style="font-size:90%;">
Chaofan Chen, Oscar Li, Daniel Tao, Alina Barnett, Cynthia Rudin, and Jonathan K Su.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.2.1" style="font-size:90%;">This looks like that: deep learning for interpretable image recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib8.4.2" style="font-size:90%;">, 32, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.1.1" style="font-size:90%;">
Liang-Chieh Chen, George Papandreou, Iasonas Kokkinos, Kevin Murphy, and Alan L Yuille.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.2.1" style="font-size:90%;">Deeplab: Semantic image segmentation with deep convolutional nets, atrous convolution, and fully connected crfs.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.3.1" style="font-size:90%;">IEEE transactions on pattern analysis and machine intelligence</span><span class="ltx_text" id="bib.bib9.4.2" style="font-size:90%;">, 40(4):834–848, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.1.1" style="font-size:90%;">
Liang-Chieh Chen, Yukun Zhu, George Papandreou, Florian Schroff, and Hartwig Adam.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.2.1" style="font-size:90%;">Encoder-decoder with atrous separable convolution for semantic image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib10.4.2" style="font-size:90%;">Proceedings of the European conference on computer vision (ECCV)</span><span class="ltx_text" id="bib.bib10.5.3" style="font-size:90%;">, pages 801–818, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.1.1" style="font-size:90%;">
Bowen Cheng, Ishan Misra, Alexander G Schwing, Alexander Kirillov, and Rohit Girdhar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.2.1" style="font-size:90%;">Masked-attention mask transformer for universal image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib11.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib11.5.3" style="font-size:90%;">, pages 1290–1299, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.1.1" style="font-size:90%;">
Bowen Cheng, Alex Schwing, and Alexander Kirillov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.2.1" style="font-size:90%;">Per-pixel classification is not all you need for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib12.4.2" style="font-size:90%;">, 34:17864–17875, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.1.1" style="font-size:90%;">
Julien Colin, Thomas Fel, Rémi Cadène, and Thomas Serre.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.2.1" style="font-size:90%;">What i cannot predict, i do not understand: A human-centered evaluation framework for explainability methods.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib13.4.2" style="font-size:90%;">, 35:2832–2845, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.1.1" style="font-size:90%;">
Marius Cordts, Mohamed Omran, Sebastian Ramos, Timo Rehfeld, Markus Enzweiler, Rodrigo Benenson, Uwe Franke, Stefan Roth, and Bernt Schiele.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.2.1" style="font-size:90%;">The cityscapes dataset for semantic urban scene understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib14.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib14.5.3" style="font-size:90%;">, pages 3213–3223, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.1.1" style="font-size:90%;">
Omid Davoodi, Shayan Mohammadizadehsamakosh, and Majid Komeili.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.2.1" style="font-size:90%;">On the interpretability of part-prototype based classifiers: a human centric analysis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.3.1" style="font-size:90%;">Scientific Reports</span><span class="ltx_text" id="bib.bib15.4.2" style="font-size:90%;">, 13(1):23088, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.1.1" style="font-size:90%;">
Daan de Geus, Panagiotis Meletis, Chenyang Lu, Xiaoxiao Wen, and Gijs Dubbelman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.2.1" style="font-size:90%;">Part-aware panoptic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib16.4.2" style="font-size:90%;">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span><span class="ltx_text" id="bib.bib16.5.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.1.1" style="font-size:90%;">
Henghui Ding, Xudong Jiang, Ai Qun Liu, Nadia Magnenat Thalmann, and Gang Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.2.1" style="font-size:90%;">Boundary-aware feature propagation for scene segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib17.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib17.5.3" style="font-size:90%;">, pages 6819–6829, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.1.1" style="font-size:90%;">
Nanqing Dong and Eric P Xing.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.2.1" style="font-size:90%;">Few-shot semantic segmentation with prototype learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib18.4.2" style="font-size:90%;">BMVC</span><span class="ltx_text" id="bib.bib18.5.3" style="font-size:90%;">, volume 3, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.1.1" style="font-size:90%;">
Jon Donnelly, Alina Jade Barnett, and Chaofan Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.2.1" style="font-size:90%;">Deformable protopnet: An interpretable image classifier using deformable prototypes.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib19.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib19.5.3" style="font-size:90%;">, pages 10265–10275, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.1.1" style="font-size:90%;">
Finale Doshi-Velez and Been Kim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.2.1" style="font-size:90%;">Towards a rigorous science of interpretable machine learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.3.1" style="font-size:90%;">arXiv preprint arXiv:1702.08608</span><span class="ltx_text" id="bib.bib20.4.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.1.1" style="font-size:90%;">
M. Everingham, L. Van Gool, C. K. I. Williams, J. Winn, and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.2.1" style="font-size:90%;">The PASCAL Visual Object Classes Challenge 2012 (VOC2012) Results.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.3.1" style="font-size:90%;">http://www.pascal-network.org/challenges/VOC/voc2012/workshop/index.html.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.1.1" style="font-size:90%;">
Di Feng, Christian Haase-Schütz, Lars Rosenbaum, Heinz Hertlein, Claudius Glaeser, Fabian Timm, Werner Wiesbeck, and Klaus Dietmayer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.2.1" style="font-size:90%;">Deep multi-modal object detection and semantic segmentation for autonomous driving: Datasets, methods, and challenges.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.3.1" style="font-size:90%;">IEEE Transactions on Intelligent Transportation Systems</span><span class="ltx_text" id="bib.bib22.4.2" style="font-size:90%;">, 22(3):1341–1360, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.1.1" style="font-size:90%;">
Jun Fu, Jing Liu, Haijie Tian, Yong Li, Yongjun Bao, Zhiwei Fang, and Hanqing Lu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.2.1" style="font-size:90%;">Dual attention network for scene segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib23.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib23.5.3" style="font-size:90%;">, pages 3146–3154, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.1.1" style="font-size:90%;">
Srishti Gautam, Ahcene Boubekki, Stine Hansen, Suaiba Salahuddin, Robert Jenssen, Marina Höhne, and Michael Kampffmeyer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.2.1" style="font-size:90%;">Protovae: A trustworthy self-explainable prototypical variational model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib24.4.2" style="font-size:90%;">, 35:17940–17952, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.1.1" style="font-size:90%;">
Alan H Gee, Diego Garcia-Olano, Joydeep Ghosh, and David Paydarfar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.2.1" style="font-size:90%;">Explaining deep classification of time-series data with learned prototypes.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib25.4.2" style="font-size:90%;">CEUR workshop proceedings</span><span class="ltx_text" id="bib.bib25.5.3" style="font-size:90%;">, volume 2429, page 15. NIH Public Access, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.1.1" style="font-size:90%;">
Marzyeh Ghassemi, Luke Oakden-Rayner, and Andrew L Beam.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.2.1" style="font-size:90%;">The false hope of current approaches to explainable artificial intelligence in health care.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.3.1" style="font-size:90%;">The Lancet Digital Health</span><span class="ltx_text" id="bib.bib26.4.2" style="font-size:90%;">, 3(11):e745–e750, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.1.1" style="font-size:90%;">
Yash Goyal, Ziyan Wu, Jan Ernst, Dhruv Batra, Devi Parikh, and Stefan Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.2.1" style="font-size:90%;">Counterfactual visual explanations.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib27.4.2" style="font-size:90%;">International Conference on Machine Learning</span><span class="ltx_text" id="bib.bib27.5.3" style="font-size:90%;">, pages 2376–2384. PMLR, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.1.1" style="font-size:90%;">
Ran Gu, Guotai Wang, Tao Song, Rui Huang, Michael Aertsen, Jan Deprest, Sébastien Ourselin, Tom Vercauteren, and Shaoting Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.2.1" style="font-size:90%;">Ca-net: Comprehensive attention convolutional neural networks for explainable medical image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.3.1" style="font-size:90%;">IEEE transactions on medical imaging</span><span class="ltx_text" id="bib.bib28.4.2" style="font-size:90%;">, 40(2):699–711, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.1.1" style="font-size:90%;">
Bharath Hariharan, Pablo Arbeláez, Lubomir Bourdev, Subhransu Maji, and Jitendra Malik.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.2.1" style="font-size:90%;">Semantic contours from inverse detectors.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib29.4.2" style="font-size:90%;">2011 international conference on computer vision</span><span class="ltx_text" id="bib.bib29.5.3" style="font-size:90%;">, pages 991–998. IEEE, 2011.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.1.1" style="font-size:90%;">
Peter Hase, Chaofan Chen, Oscar Li, and Cynthia Rudin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.2.1" style="font-size:90%;">Interpretable image recognition with hierarchical prototypes.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib30.4.2" style="font-size:90%;">Proceedings of the AAAI Conference on Human Computation and Crowdsourcing</span><span class="ltx_text" id="bib.bib30.5.3" style="font-size:90%;">, volume 7, pages 32–40, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.1.1" style="font-size:90%;">
Trevor Hastie and Robert Tibshirani.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.2.1" style="font-size:90%;">Generalized additive models: some applications.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.3.1" style="font-size:90%;">Journal of the American Statistical Association</span><span class="ltx_text" id="bib.bib31.4.2" style="font-size:90%;">, 82(398):371–386, 1987.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.1.1" style="font-size:90%;">
Junjun He, Zhongying Deng, Lei Zhou, Yali Wang, and Yu Qiao.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.2.1" style="font-size:90%;">Adaptive pyramid context network for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib32.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib32.5.3" style="font-size:90%;">, pages 7519–7528, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.1.1" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.2.1" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib33.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib33.5.3" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.1.1" style="font-size:90%;">
Dan Hendrycks, Kevin Zhao, Steven Basart, Jacob Steinhardt, and Dawn Song.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.2.1" style="font-size:90%;">Natural adversarial examples.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib34.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib34.5.3" style="font-size:90%;">, pages 15262–15271, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.1.1" style="font-size:90%;">
Lukas Hoyer, Mauricio Munoz, Prateek Katiyar, Anna Khoreva, and Volker Fischer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.2.1" style="font-size:90%;">Grid saliency for context explanations of semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib35.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib35.4.2" style="font-size:90%;">, 32, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.1.1" style="font-size:90%;">
Qin Huang, Chunyang Xia, Chihao Wu, Siyang Li, Ye Wang, Yuhang Song, and C-C Jay Kuo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.2.1" style="font-size:90%;">Semantic segmentation with reverse attention.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib36.3.1" style="font-size:90%;">arXiv preprint arXiv:1707.06426</span><span class="ltx_text" id="bib.bib36.4.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.1.1" style="font-size:90%;">
Qihan Huang, Mengqi Xue, Wenqi Huang, Haofei Zhang, Jie Song, Yongcheng Jing, and Mingli Song.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.2.1" style="font-size:90%;">Evaluation and improvement of interpretability for self-explainable part-prototype networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib37.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib37.5.3" style="font-size:90%;">, pages 2011–2020, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.1.1" style="font-size:90%;">
Zilong Huang, Xinggang Wang, Lichao Huang, Chang Huang, Yunchao Wei, and Wenyu Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.2.1" style="font-size:90%;">Ccnet: Criss-cross attention for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib38.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib38.5.3" style="font-size:90%;">, pages 603–612, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.1.1" style="font-size:90%;">
Jyh-Jing Hwang, Stella X Yu, Jianbo Shi, Maxwell D Collins, Tien-Ju Yang, Xiao Zhang, and Liang-Chieh Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.2.1" style="font-size:90%;">Segsort: Segmentation by discriminative sorting of segments.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib39.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib39.5.3" style="font-size:90%;">, pages 7334–7344, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.1.1" style="font-size:90%;">
Shipra Jain, Danda Pani Paudel, Martin Danelljan, and Luc Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.2.1" style="font-size:90%;">Scaling semantic segmentation beyond 1k classes on a single gpu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib40.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib40.5.3" style="font-size:90%;">, pages 7426–7436, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.1.1" style="font-size:90%;">
Harold Jeffreys.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.2.1" style="font-size:90%;">The theory of probability</span><span class="ltx_text" id="bib.bib41.3.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.4.1" style="font-size:90%;">OuP Oxford, 1998.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.1.1" style="font-size:90%;">
Saumya Jetley, Bernardino Romera-Paredes, Sadeep Jayasumana, and Philip Torr.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.2.1" style="font-size:90%;">Prototypical priors: From improving classification to zero-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib42.3.1" style="font-size:90%;">arXiv preprint arXiv:1512.01192</span><span class="ltx_text" id="bib.bib42.4.2" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.1.1" style="font-size:90%;">
Jeya Vikranth Jeyakumar, Luke Dickens, Luis Garcia, Yu-Hsi Cheng, Diego Ramirez Echavarria, Joseph Noor, Alessandra Russo, Lance Kaplan, Erik Blasch, and Mani Srivastava.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.2.1" style="font-size:90%;">Automatic concept extraction for concept bottleneck-based video classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib43.3.1" style="font-size:90%;">arXiv preprint arXiv:2206.10129</span><span class="ltx_text" id="bib.bib43.4.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.1.1" style="font-size:90%;">
Been Kim, Martin Wattenberg, Justin Gilmer, Carrie Cai, James Wexler, Fernanda Viegas, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.2.1" style="font-size:90%;">Interpretability beyond feature attribution: Quantitative testing with concept activation vectors (tcav).
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib44.4.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib44.5.3" style="font-size:90%;">, pages 2668–2677. PMLR, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.1.1" style="font-size:90%;">
Sunnie SY Kim, Nicole Meister, Vikram V Ramaswamy, Ruth Fong, and Olga Russakovsky.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.2.1" style="font-size:90%;">Hive: evaluating the human interpretability of visual explanations.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.3.1" style="font-size:90%;">arXiv preprint arXiv:2112.03184</span><span class="ltx_text" id="bib.bib45.4.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.1.1" style="font-size:90%;">
Pang Wei Koh, Thao Nguyen, Yew Siang Tang, Stephen Mussmann, Emma Pierson, Been Kim, and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.2.1" style="font-size:90%;">Concept bottleneck models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib46.4.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib46.5.3" style="font-size:90%;">, pages 5338–5348. PMLR, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.1.1" style="font-size:90%;">
Alexey Kurakin, Ian J Goodfellow, and Samy Bengio.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.2.1" style="font-size:90%;">Adversarial examples in the physical world.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib47.4.2" style="font-size:90%;">Artificial intelligence safety and security</span><span class="ltx_text" id="bib.bib47.5.3" style="font-size:90%;">, pages 99–112. Chapman and Hall/CRC, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.1.1" style="font-size:90%;">
Nataliia Kussul, Mykola Lavreniuk, Sergii Skakun, and Andrii Shelestov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.2.1" style="font-size:90%;">Deep learning classification of land cover and crop types using remote sensing data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.3.1" style="font-size:90%;">IEEE Geoscience and Remote Sensing Letters</span><span class="ltx_text" id="bib.bib48.4.2" style="font-size:90%;">, 14(5):778–782, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.1.1" style="font-size:90%;">
Sebastian Lapuschkin, Stephan Wäldchen, Alexander Binder, Grégoire Montavon, Wojciech Samek, and Klaus-Robert Müller.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.2.1" style="font-size:90%;">Unmasking clever hans predictors and assessing what machines really learn.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib49.3.1" style="font-size:90%;">Nature communications</span><span class="ltx_text" id="bib.bib49.4.2" style="font-size:90%;">, 10(1):1096, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.1.1" style="font-size:90%;">
Junnan Li, Pan Zhou, Caiming Xiong, and Steven CH Hoi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.2.1" style="font-size:90%;">Prototypical contrastive learning of unsupervised representations.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib50.3.1" style="font-size:90%;">arXiv preprint arXiv:2005.04966</span><span class="ltx_text" id="bib.bib50.4.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.1.1" style="font-size:90%;">
Oscar Li, Hao Liu, Chaofan Chen, and Cynthia Rudin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.2.1" style="font-size:90%;">Deep learning for case-based reasoning through prototypes: A neural network that explains its predictions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib51.4.2" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial Intelligence</span><span class="ltx_text" id="bib.bib51.5.3" style="font-size:90%;">, volume 32, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.1.1" style="font-size:90%;">
Guosheng Lin, Anton Milan, Chunhua Shen, and Ian Reid.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.2.1" style="font-size:90%;">Refinenet: Multi-path refinement networks for high-resolution semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib52.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib52.5.3" style="font-size:90%;">, pages 1925–1934, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.1.1" style="font-size:90%;">
Pantelis Linardatos, Vasilis Papastefanopoulos, and Sotiris Kotsiantis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.2.1" style="font-size:90%;">Explainable ai: A review of machine learning interpretability methods.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib53.3.1" style="font-size:90%;">Entropy</span><span class="ltx_text" id="bib.bib53.4.2" style="font-size:90%;">, 23(1):18, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.1.1" style="font-size:90%;">
Sifei Liu, Shalini De Mello, Jinwei Gu, Guangyu Zhong, Ming-Hsuan Yang, and Jan Kautz.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.2.1" style="font-size:90%;">Learning affinity via spatial propagation networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib54.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib54.4.2" style="font-size:90%;">, 30, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.1.1" style="font-size:90%;">
Jonathan Long, Evan Shelhamer, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.2.1" style="font-size:90%;">Fully convolutional networks for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib55.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib55.5.3" style="font-size:90%;">, pages 3431–3440, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.1.1" style="font-size:90%;">
Max Losch, Mario Fritz, and Bernt Schiele.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.2.1" style="font-size:90%;">Interpretability beyond classification output: Semantic bottleneck networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib56.3.1" style="font-size:90%;">arXiv preprint arXiv:1907.10882</span><span class="ltx_text" id="bib.bib56.4.2" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.1.1" style="font-size:90%;">
Diego Marcos, Ruth Fong, Sylvain Lobry, Rémi Flamary, Nicolas Courty, and Devis Tuia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.2.1" style="font-size:90%;">Contextual semantic interpretability.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib57.4.2" style="font-size:90%;">Proceedings of the Asian Conference on Computer Vision</span><span class="ltx_text" id="bib.bib57.5.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.1.1" style="font-size:90%;">
Panagiotis Meletis, Xiaoxiao Wen, Chenyang Lu, Daan de Geus, and Gijs Dubbelman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.2.1" style="font-size:90%;">Cityscapes-panoptic-parts and pascal-panoptic-parts datasets for scene understanding.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.1.1" style="font-size:90%;">
Pascal Mettes, Elise Van der Pol, and Cees Snoek.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.2.1" style="font-size:90%;">Hyperspherical prototype networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib59.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib59.4.2" style="font-size:90%;">, 32, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.1.1" style="font-size:90%;">
Yao Ming, Panpan Xu, Huamin Qu, and Liu Ren.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.2.1" style="font-size:90%;">Interpretable and steerable sequence learning via prototypes.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib60.4.2" style="font-size:90%;">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span><span class="ltx_text" id="bib.bib60.5.3" style="font-size:90%;">, pages 903–913, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.1.1" style="font-size:90%;">
Meike Nauta, Jörg Schlötterer, Maurice Van Keulen, and Christin Seifert.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.2.1" style="font-size:90%;">Pip-net: Patch-based intuitive prototypes for interpretable image classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib61.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib61.5.3" style="font-size:90%;">, pages 2744–2753, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.1.1" style="font-size:90%;">
Tuomas Oikarinen, Subhro Das, Lam M Nguyen, and Tsui-Wei Weng.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.2.1" style="font-size:90%;">Label-free concept bottleneck models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib62.3.1" style="font-size:90%;">arXiv preprint arXiv:2304.06129</span><span class="ltx_text" id="bib.bib62.4.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.1.1" style="font-size:90%;">
Jeremy Petch, Shuang Di, and Walter Nelson.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.2.1" style="font-size:90%;">Opening the black box: the promise and limitations of explainable machine learning in cardiology.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib63.3.1" style="font-size:90%;">Canadian Journal of Cardiology</span><span class="ltx_text" id="bib.bib63.4.2" style="font-size:90%;">, 38(2):204–213, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.1.1" style="font-size:90%;">
René Ranftl, Alexey Bochkovskiy, and Vladlen Koltun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.2.1" style="font-size:90%;">Vision transformers for dense prediction.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib64.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib64.5.3" style="font-size:90%;">, pages 12179–12188, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.1.1" style="font-size:90%;">
Dmitry Rashkovetsky, Florian Mauracher, Martin Langer, and Michael Schmitt.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.2.1" style="font-size:90%;">Wildfire detection from multisensor satellite imagery using deep semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib65.3.1" style="font-size:90%;">IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</span><span class="ltx_text" id="bib.bib65.4.2" style="font-size:90%;">, 14:7001–7016, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.1.1" style="font-size:90%;">
Mattia Rigotti, Christoph Miksovic, Ioana Giurgiu, Thomas Gschwind, and Paolo Scotton.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.2.1" style="font-size:90%;">Attention-based interpretability with concept transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib66.4.2" style="font-size:90%;">International Conference on Learning Representations</span><span class="ltx_text" id="bib.bib66.5.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.1.1" style="font-size:90%;">
Olaf Ronneberger, Philipp Fischer, and Thomas Brox.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.2.1" style="font-size:90%;">U-net: Convolutional networks for biomedical image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib67.4.2" style="font-size:90%;">Medical Image Computing and Computer-Assisted Intervention–MICCAI 2015: 18th International Conference, Munich, Germany, October 5-9, 2015, Proceedings, Part III 18</span><span class="ltx_text" id="bib.bib67.5.3" style="font-size:90%;">, pages 234–241. Springer, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.1.1" style="font-size:90%;">
Cynthia Rudin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.2.1" style="font-size:90%;">Stop explaining black box machine learning models for high stakes decisions and use interpretable models instead.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib68.3.1" style="font-size:90%;">Nature machine intelligence</span><span class="ltx_text" id="bib.bib68.4.2" style="font-size:90%;">, 1(5):206–215, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.1.1" style="font-size:90%;">
Dawid Rymarczyk, Łukasz Struski, Jacek Tabor, and Bartosz Zieliński.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.2.1" style="font-size:90%;">Protopshare: Prototypical parts sharing for similarity discovery in interpretable image classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib69.4.2" style="font-size:90%;">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</span><span class="ltx_text" id="bib.bib69.5.3" style="font-size:90%;">, pages 1420–1430, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.1.1" style="font-size:90%;">
Mikołaj Sacha, Dawid Rymarczyk, Łukasz Struski, Jacek Tabor, and Bartosz Zieliński.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.2.1" style="font-size:90%;">Protoseg: Interpretable semantic segmentation with prototypical parts.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib70.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision</span><span class="ltx_text" id="bib.bib70.5.3" style="font-size:90%;">, pages 1481–1492, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.1.1" style="font-size:90%;">
Alberto Santamaria-Pang, James Kubricht, Aritra Chowdhury, Chitresh Bhushan, and Peter Tu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.2.1" style="font-size:90%;">Towards emergent language symbolic semantic segmentation and model interpretability.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib71.4.2" style="font-size:90%;">Medical Image Computing and Computer Assisted Intervention–MICCAI 2020: 23rd International Conference, Lima, Peru, October 4–8, 2020, Proceedings, Part I 23</span><span class="ltx_text" id="bib.bib71.5.3" style="font-size:90%;">, pages 326–334. Springer, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.1.1" style="font-size:90%;">
Ramprasaath R Selvaraju, Michael Cogswell, Abhishek Das, Ramakrishna Vedantam, Devi Parikh, and Dhruv Batra.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.2.1" style="font-size:90%;">Grad-cam: Visual explanations from deep networks via gradient-based localization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib72.4.2" style="font-size:90%;">Proceedings of the IEEE international conference on computer vision</span><span class="ltx_text" id="bib.bib72.5.3" style="font-size:90%;">, pages 618–626, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.1.1" style="font-size:90%;">
Sofia Serrano and Noah A Smith.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.2.1" style="font-size:90%;">Is attention interpretable?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib73.3.1" style="font-size:90%;">arXiv preprint arXiv:1906.03731</span><span class="ltx_text" id="bib.bib73.4.2" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.1.1" style="font-size:90%;">
Mennatullah Siam, Mostafa Gamal, Moemen Abdel-Razek, Senthil Yogamani, Martin Jagersand, and Hong Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.2.1" style="font-size:90%;">A comparative study of real-time semantic segmentation for autonomous driving.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib74.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition workshops</span><span class="ltx_text" id="bib.bib74.5.3" style="font-size:90%;">, pages 587–597, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib75.1.1" style="font-size:90%;">
Jake Snell, Kevin Swersky, and Richard Zemel.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib75.2.1" style="font-size:90%;">Prototypical networks for few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib75.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib75.4.2" style="font-size:90%;">, 30, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.1.1" style="font-size:90%;">
Gregor Stiglic, Primoz Kocbek, Nino Fijacko, Marinka Zitnik, Katrien Verbert, and Leona Cilar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.2.1" style="font-size:90%;">Interpretability of machine learning-based prediction models in healthcare.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib76.3.1" style="font-size:90%;">Wiley Interdisciplinary Reviews: Data Mining and Knowledge Discovery</span><span class="ltx_text" id="bib.bib76.4.2" style="font-size:90%;">, 10(5):e1379, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.1.1" style="font-size:90%;">
Robin Strudel, Ricardo Garcia, Ivan Laptev, and Cordelia Schmid.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.2.1" style="font-size:90%;">Segmenter: Transformer for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib77.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib77.5.3" style="font-size:90%;">, pages 7262–7272, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.1.1" style="font-size:90%;">
Towaki Takikawa, David Acuna, Varun Jampani, and Sanja Fidler.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.2.1" style="font-size:90%;">Gated-scnn: Gated shape cnns for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib78.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib78.5.3" style="font-size:90%;">, pages 5229–5238, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_tag_bibitem">[79]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.1.1" style="font-size:90%;">
Pin Tang, Hai-Ming Xu, and Chao Ma.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.2.1" style="font-size:90%;">Prototransfer: Cross-modal prototype transfer for point cloud segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib79.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib79.5.3" style="font-size:90%;">, pages 3337–3347, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_tag_bibitem">[80]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib80.1.1" style="font-size:90%;">
Yin Tang, Tao Chen, Xiruo Jiang, Yazhou Yao, Guo-Sen Xie, and Heng-Tao Shen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib80.2.1" style="font-size:90%;">Holistic prototype attention network for few-shot vos.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib80.3.1" style="font-size:90%;">arXiv preprint arXiv:2307.07933</span><span class="ltx_text" id="bib.bib80.4.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_tag_bibitem">[81]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib81.1.1" style="font-size:90%;">
Michael Treml, José Arjona-Medina, Thomas Unterthiner, Rupesh Durgesh, Felix Friedmann, Peter Schuberth, Andreas Mayr, Martin Heusel, Markus Hofmarcher, Michael Widrich, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib81.2.1" style="font-size:90%;">Speeding up semantic segmentation for autonomous driving.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib81.3.1" style="font-size:90%;">2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_tag_bibitem">[82]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib82.1.1" style="font-size:90%;">
Devis Tuia, Ribana Roscher, Jan Dirk Wegner, Nathan Jacobs, Xiaoxiang Zhu, and Gustau Camps-Valls.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib82.2.1" style="font-size:90%;">Toward a collective agenda on ai for earth science data analysis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib82.3.1" style="font-size:90%;">IEEE Geoscience and Remote Sensing Magazine</span><span class="ltx_text" id="bib.bib82.4.2" style="font-size:90%;">, 9(2):88–104, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_tag_bibitem">[83]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.1.1" style="font-size:90%;">
Kira Vinogradova, Alexandr Dibrov, and Gene Myers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.2.1" style="font-size:90%;">Towards interpretable semantic segmentation via gradient-weighted class activation mapping (student abstract).
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib83.4.2" style="font-size:90%;">Proceedings of the AAAI conference on artificial intelligence</span><span class="ltx_text" id="bib.bib83.5.3" style="font-size:90%;">, volume 34, pages 13943–13944, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_tag_bibitem">[84]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.1.1" style="font-size:90%;">
Jiaqi Wang, Huafeng Liu, Xinyue Wang, and Liping Jing.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.2.1" style="font-size:90%;">Interpretable image recognition by constructing transparent embedding space.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib84.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib84.5.3" style="font-size:90%;">, pages 895–904, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_tag_bibitem">[85]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib85.1.1" style="font-size:90%;">
Kaixin Wang, Jun Hao Liew, Yingtian Zou, Daquan Zhou, and Jiashi Feng.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib85.2.1" style="font-size:90%;">Panet: Few-shot image semantic segmentation with prototype alignment.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib85.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib85.4.2" style="font-size:90%;">proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib85.5.3" style="font-size:90%;">, pages 9197–9206, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_tag_bibitem">[86]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib86.1.1" style="font-size:90%;">
Wenhai Wang, Jifeng Dai, Zhe Chen, Zhenhang Huang, Zhiqi Li, Xizhou Zhu, Xiaowei Hu, Tong Lu, Lewei Lu, Hongsheng Li, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib86.2.1" style="font-size:90%;">Internimage: Exploring large-scale vision foundation models with deformable convolutions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib86.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib86.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib86.5.3" style="font-size:90%;">, pages 14408–14419, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib87">
<span class="ltx_tag ltx_tag_bibitem">[87]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib87.1.1" style="font-size:90%;">
Wenguan Wang, Cheng Han, Tianfei Zhou, and Dongfang Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib87.2.1" style="font-size:90%;">Visual recognition with deep nearest centroids.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib87.3.1" style="font-size:90%;">arXiv preprint arXiv:2209.07383</span><span class="ltx_text" id="bib.bib87.4.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib88">
<span class="ltx_tag ltx_tag_bibitem">[88]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib88.1.1" style="font-size:90%;">
Zhirong Wu, Yuanjun Xiong, Stella X Yu, and Dahua Lin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib88.2.1" style="font-size:90%;">Unsupervised feature learning via non-parametric instance discrimination.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib88.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib88.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib88.5.3" style="font-size:90%;">, pages 3733–3742, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib89">
<span class="ltx_tag ltx_tag_bibitem">[89]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib89.1.1" style="font-size:90%;">
Enze Xie, Wenhai Wang, Zhiding Yu, Anima Anandkumar, Jose M Alvarez, and Ping Luo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib89.2.1" style="font-size:90%;">Segformer: Simple and efficient design for semantic segmentation with transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib89.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib89.4.2" style="font-size:90%;">, 34:12077–12090, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib90">
<span class="ltx_tag ltx_tag_bibitem">[90]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib90.1.1" style="font-size:90%;">
Wenjia Xu, Yongqin Xian, Jiuniu Wang, Bernt Schiele, and Zeynep Akata.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib90.2.1" style="font-size:90%;">Attribute prototype network for zero-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib90.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib90.4.2" style="font-size:90%;">, 33:21969–21980, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib91">
<span class="ltx_tag ltx_tag_bibitem">[91]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib91.1.1" style="font-size:90%;">
Romain Xu-Darme, Georges Quénot, Zakaria Chihani, and Marie-Christine Rousset.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib91.2.1" style="font-size:90%;">Sanity checks and improvements for patch visualisation in prototype-based image classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib91.3.1" style="font-size:90%;">arXiv preprint arXiv:2302.08508</span><span class="ltx_text" id="bib.bib91.4.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib92">
<span class="ltx_tag ltx_tag_bibitem">[92]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib92.1.1" style="font-size:90%;">
Hong-Ming Yang, Xu-Yao Zhang, Fei Yin, and Cheng-Lin Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib92.2.1" style="font-size:90%;">Robust classification with convolutional prototype learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib92.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib92.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib92.5.3" style="font-size:90%;">, pages 3474–3482, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib93">
<span class="ltx_tag ltx_tag_bibitem">[93]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib93.1.1" style="font-size:90%;">
Changqian Yu, Jingbo Wang, Chao Peng, Changxin Gao, Gang Yu, and Nong Sang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib93.2.1" style="font-size:90%;">Learning a discriminative feature network for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib93.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib93.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib93.5.3" style="font-size:90%;">, pages 1857–1866, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib94">
<span class="ltx_tag ltx_tag_bibitem">[94]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib94.1.1" style="font-size:90%;">
Fisher Yu and Vladlen Koltun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib94.2.1" style="font-size:90%;">Multi-scale context aggregation by dilated convolutions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib94.3.1" style="font-size:90%;">arXiv preprint arXiv:1511.07122</span><span class="ltx_text" id="bib.bib94.4.2" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib95">
<span class="ltx_tag ltx_tag_bibitem">[95]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib95.1.1" style="font-size:90%;">
Hang Zhang, Kristin Dana, Jianping Shi, Zhongyue Zhang, Xiaogang Wang, Ambrish Tyagi, and Amit Agrawal.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib95.2.1" style="font-size:90%;">Context encoding for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib95.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib95.4.2" style="font-size:90%;">Proceedings of the IEEE conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib95.5.3" style="font-size:90%;">, pages 7151–7160, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib96">
<span class="ltx_tag ltx_tag_bibitem">[96]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib96.1.1" style="font-size:90%;">
Hengshuang Zhao, Jianping Shi, Xiaojuan Qi, Xiaogang Wang, and Jiaya Jia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib96.2.1" style="font-size:90%;">Pyramid scene parsing network.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib96.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib96.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib96.5.3" style="font-size:90%;">, pages 2881–2890, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib97">
<span class="ltx_tag ltx_tag_bibitem">[97]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib97.1.1" style="font-size:90%;">
Hengshuang Zhao, Yi Zhang, Shu Liu, Jianping Shi, Chen Change Loy, Dahua Lin, and Jiaya Jia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib97.2.1" style="font-size:90%;">Psanet: Point-wise spatial attention network for scene parsing.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib97.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib97.4.2" style="font-size:90%;">Proceedings of the European conference on computer vision (ECCV)</span><span class="ltx_text" id="bib.bib97.5.3" style="font-size:90%;">, pages 267–283, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib98">
<span class="ltx_tag ltx_tag_bibitem">[98]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib98.1.1" style="font-size:90%;">
Heliang Zheng, Jianlong Fu, Tao Mei, and Jiebo Luo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib98.2.1" style="font-size:90%;">Learning multi-attention convolutional neural network for fine-grained image recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib98.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib98.4.2" style="font-size:90%;">Proceedings of the IEEE international conference on computer vision</span><span class="ltx_text" id="bib.bib98.5.3" style="font-size:90%;">, pages 5209–5217, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib99">
<span class="ltx_tag ltx_tag_bibitem">[99]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib99.1.1" style="font-size:90%;">
Bolei Zhou, Aditya Khosla, Agata Lapedriza, Aude Oliva, and Antonio Torralba.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib99.2.1" style="font-size:90%;">Learning deep features for discriminative localization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib99.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib99.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib99.5.3" style="font-size:90%;">, pages 2921–2929, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib100">
<span class="ltx_tag ltx_tag_bibitem">[100]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib100.1.1" style="font-size:90%;">
Bolei Zhou, Hang Zhao, Xavier Puig, Sanja Fidler, Adela Barriuso, and Antonio Torralba.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib100.2.1" style="font-size:90%;">Scene parsing through ade20k dataset.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib100.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib100.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib100.5.3" style="font-size:90%;">, pages 633–641, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib101">
<span class="ltx_tag ltx_tag_bibitem">[101]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib101.1.1" style="font-size:90%;">
Tianfei Zhou, Wenguan Wang, Ender Konukoglu, and Luc Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib101.2.1" style="font-size:90%;">Rethinking semantic segmentation: A prototype view.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib101.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib101.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib101.5.3" style="font-size:90%;">, pages 2582–2593, 2022.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_sectional-block" id="p1.1">
<section class="ltx_section ltx_centering" id="Sx1">
<h2 class="ltx_title ltx_title_section">Supplementary: Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation</h2>
</section>
</div>
</div>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Details on experimental set-up</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this section, we provide the details of the experimental set-up briefly described in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS1" title="4.1 Experimental setup ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4.1</span></a> to support reproducing the results.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.7">Firstly, across all training stages, the prototypes are the same size as the output feature maps of the non-concatenated ASPP in DeepLabv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite>: <math alttext="D=64" class="ltx_Math" display="inline" id="S6.p2.1.m1.1"><semantics id="S6.p2.1.m1.1a"><mrow id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml"><mi id="S6.p2.1.m1.1.1.2" xref="S6.p2.1.m1.1.1.2.cmml">D</mi><mo id="S6.p2.1.m1.1.1.1" xref="S6.p2.1.m1.1.1.1.cmml">=</mo><mn id="S6.p2.1.m1.1.1.3" xref="S6.p2.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><apply id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1"><eq id="S6.p2.1.m1.1.1.1.cmml" xref="S6.p2.1.m1.1.1.1"></eq><ci id="S6.p2.1.m1.1.1.2.cmml" xref="S6.p2.1.m1.1.1.2">𝐷</ci><cn id="S6.p2.1.m1.1.1.3.cmml" type="integer" xref="S6.p2.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">D=64</annotation><annotation encoding="application/x-llamapun" id="S6.p2.1.m1.1d">italic_D = 64</annotation></semantics></math>. For both multi-scale prototype training and the grouping mechanism we leverage augmentation techniques, such as random horizontal flipping, cropping, and scaling images by a factor between <math alttext="[0,1.5]" class="ltx_Math" display="inline" id="S6.p2.2.m2.2"><semantics id="S6.p2.2.m2.2a"><mrow id="S6.p2.2.m2.2.3.2" xref="S6.p2.2.m2.2.3.1.cmml"><mo id="S6.p2.2.m2.2.3.2.1" stretchy="false" xref="S6.p2.2.m2.2.3.1.cmml">[</mo><mn id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml">0</mn><mo id="S6.p2.2.m2.2.3.2.2" xref="S6.p2.2.m2.2.3.1.cmml">,</mo><mn id="S6.p2.2.m2.2.2" xref="S6.p2.2.m2.2.2.cmml">1.5</mn><mo id="S6.p2.2.m2.2.3.2.3" stretchy="false" xref="S6.p2.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.2b"><interval closure="closed" id="S6.p2.2.m2.2.3.1.cmml" xref="S6.p2.2.m2.2.3.2"><cn id="S6.p2.2.m2.1.1.cmml" type="integer" xref="S6.p2.2.m2.1.1">0</cn><cn id="S6.p2.2.m2.2.2.cmml" type="float" xref="S6.p2.2.m2.2.2">1.5</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.2c">[0,1.5]</annotation><annotation encoding="application/x-llamapun" id="S6.p2.2.m2.2d">[ 0 , 1.5 ]</annotation></semantics></math> for Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib14" title="">14</a>]</cite> and Pascal VOC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib21" title="">21</a>]</cite>, and <math alttext="[0,2]" class="ltx_Math" display="inline" id="S6.p2.3.m3.2"><semantics id="S6.p2.3.m3.2a"><mrow id="S6.p2.3.m3.2.3.2" xref="S6.p2.3.m3.2.3.1.cmml"><mo id="S6.p2.3.m3.2.3.2.1" stretchy="false" xref="S6.p2.3.m3.2.3.1.cmml">[</mo><mn id="S6.p2.3.m3.1.1" xref="S6.p2.3.m3.1.1.cmml">0</mn><mo id="S6.p2.3.m3.2.3.2.2" xref="S6.p2.3.m3.2.3.1.cmml">,</mo><mn id="S6.p2.3.m3.2.2" xref="S6.p2.3.m3.2.2.cmml">2</mn><mo id="S6.p2.3.m3.2.3.2.3" stretchy="false" xref="S6.p2.3.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.3.m3.2b"><interval closure="closed" id="S6.p2.3.m3.2.3.1.cmml" xref="S6.p2.3.m3.2.3.2"><cn id="S6.p2.3.m3.1.1.cmml" type="integer" xref="S6.p2.3.m3.1.1">0</cn><cn id="S6.p2.3.m3.2.2.cmml" type="integer" xref="S6.p2.3.m3.2.2">2</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.3.m3.2c">[0,2]</annotation><annotation encoding="application/x-llamapun" id="S6.p2.3.m3.2d">[ 0 , 2 ]</annotation></semantics></math> for ADE20K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib100" title="">100</a>]</cite>. The batch size used in all the training stages is <math alttext="10" class="ltx_Math" display="inline" id="S6.p2.4.m4.1"><semantics id="S6.p2.4.m4.1a"><mn id="S6.p2.4.m4.1.1" xref="S6.p2.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S6.p2.4.m4.1b"><cn id="S6.p2.4.m4.1.1.cmml" type="integer" xref="S6.p2.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.4.m4.1c">10</annotation><annotation encoding="application/x-llamapun" id="S6.p2.4.m4.1d">10</annotation></semantics></math> and we select the Adam optimizer with a weight decay of <math alttext="5e^{-4}" class="ltx_Math" display="inline" id="S6.p2.5.m5.1"><semantics id="S6.p2.5.m5.1a"><mrow id="S6.p2.5.m5.1.1" xref="S6.p2.5.m5.1.1.cmml"><mn id="S6.p2.5.m5.1.1.2" xref="S6.p2.5.m5.1.1.2.cmml">5</mn><mo id="S6.p2.5.m5.1.1.1" xref="S6.p2.5.m5.1.1.1.cmml">⁢</mo><msup id="S6.p2.5.m5.1.1.3" xref="S6.p2.5.m5.1.1.3.cmml"><mi id="S6.p2.5.m5.1.1.3.2" xref="S6.p2.5.m5.1.1.3.2.cmml">e</mi><mrow id="S6.p2.5.m5.1.1.3.3" xref="S6.p2.5.m5.1.1.3.3.cmml"><mo id="S6.p2.5.m5.1.1.3.3a" xref="S6.p2.5.m5.1.1.3.3.cmml">−</mo><mn id="S6.p2.5.m5.1.1.3.3.2" xref="S6.p2.5.m5.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.5.m5.1b"><apply id="S6.p2.5.m5.1.1.cmml" xref="S6.p2.5.m5.1.1"><times id="S6.p2.5.m5.1.1.1.cmml" xref="S6.p2.5.m5.1.1.1"></times><cn id="S6.p2.5.m5.1.1.2.cmml" type="integer" xref="S6.p2.5.m5.1.1.2">5</cn><apply id="S6.p2.5.m5.1.1.3.cmml" xref="S6.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S6.p2.5.m5.1.1.3.1.cmml" xref="S6.p2.5.m5.1.1.3">superscript</csymbol><ci id="S6.p2.5.m5.1.1.3.2.cmml" xref="S6.p2.5.m5.1.1.3.2">𝑒</ci><apply id="S6.p2.5.m5.1.1.3.3.cmml" xref="S6.p2.5.m5.1.1.3.3"><minus id="S6.p2.5.m5.1.1.3.3.1.cmml" xref="S6.p2.5.m5.1.1.3.3"></minus><cn id="S6.p2.5.m5.1.1.3.3.2.cmml" type="integer" xref="S6.p2.5.m5.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.5.m5.1c">5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S6.p2.5.m5.1d">5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S6.p2.6.m6.1"><semantics id="S6.p2.6.m6.1a"><mrow id="S6.p2.6.m6.1.1" xref="S6.p2.6.m6.1.1.cmml"><msub id="S6.p2.6.m6.1.1.2" xref="S6.p2.6.m6.1.1.2.cmml"><mi id="S6.p2.6.m6.1.1.2.2" xref="S6.p2.6.m6.1.1.2.2.cmml">β</mi><mn id="S6.p2.6.m6.1.1.2.3" xref="S6.p2.6.m6.1.1.2.3.cmml">1</mn></msub><mo id="S6.p2.6.m6.1.1.1" xref="S6.p2.6.m6.1.1.1.cmml">=</mo><mn id="S6.p2.6.m6.1.1.3" xref="S6.p2.6.m6.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.6.m6.1b"><apply id="S6.p2.6.m6.1.1.cmml" xref="S6.p2.6.m6.1.1"><eq id="S6.p2.6.m6.1.1.1.cmml" xref="S6.p2.6.m6.1.1.1"></eq><apply id="S6.p2.6.m6.1.1.2.cmml" xref="S6.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S6.p2.6.m6.1.1.2.1.cmml" xref="S6.p2.6.m6.1.1.2">subscript</csymbol><ci id="S6.p2.6.m6.1.1.2.2.cmml" xref="S6.p2.6.m6.1.1.2.2">𝛽</ci><cn id="S6.p2.6.m6.1.1.2.3.cmml" type="integer" xref="S6.p2.6.m6.1.1.2.3">1</cn></apply><cn id="S6.p2.6.m6.1.1.3.cmml" type="float" xref="S6.p2.6.m6.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.6.m6.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S6.p2.6.m6.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, and <math alttext="\beta_{2}=0.999" class="ltx_Math" display="inline" id="S6.p2.7.m7.1"><semantics id="S6.p2.7.m7.1a"><mrow id="S6.p2.7.m7.1.1" xref="S6.p2.7.m7.1.1.cmml"><msub id="S6.p2.7.m7.1.1.2" xref="S6.p2.7.m7.1.1.2.cmml"><mi id="S6.p2.7.m7.1.1.2.2" xref="S6.p2.7.m7.1.1.2.2.cmml">β</mi><mn id="S6.p2.7.m7.1.1.2.3" xref="S6.p2.7.m7.1.1.2.3.cmml">2</mn></msub><mo id="S6.p2.7.m7.1.1.1" xref="S6.p2.7.m7.1.1.1.cmml">=</mo><mn id="S6.p2.7.m7.1.1.3" xref="S6.p2.7.m7.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.7.m7.1b"><apply id="S6.p2.7.m7.1.1.cmml" xref="S6.p2.7.m7.1.1"><eq id="S6.p2.7.m7.1.1.1.cmml" xref="S6.p2.7.m7.1.1.1"></eq><apply id="S6.p2.7.m7.1.1.2.cmml" xref="S6.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S6.p2.7.m7.1.1.2.1.cmml" xref="S6.p2.7.m7.1.1.2">subscript</csymbol><ci id="S6.p2.7.m7.1.1.2.2.cmml" xref="S6.p2.7.m7.1.1.2.2">𝛽</ci><cn id="S6.p2.7.m7.1.1.2.3.cmml" type="integer" xref="S6.p2.7.m7.1.1.2.3">2</cn></apply><cn id="S6.p2.7.m7.1.1.3.cmml" type="float" xref="S6.p2.7.m7.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.7.m7.1c">\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="S6.p2.7.m7.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math> for our experiments. Moreover, as the batch size in our experiments is limited, we freeze the batch normalization parameters of the ResNet-101 backbone due to its impact on performance.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.12">For the multi-scale prototype training stage, we set the weights of the loss terms to <math alttext="\lambda_{L1}=1e^{-4}" class="ltx_Math" display="inline" id="S6.p3.1.m1.1"><semantics id="S6.p3.1.m1.1a"><mrow id="S6.p3.1.m1.1.1" xref="S6.p3.1.m1.1.1.cmml"><msub id="S6.p3.1.m1.1.1.2" xref="S6.p3.1.m1.1.1.2.cmml"><mi id="S6.p3.1.m1.1.1.2.2" xref="S6.p3.1.m1.1.1.2.2.cmml">λ</mi><mrow id="S6.p3.1.m1.1.1.2.3" xref="S6.p3.1.m1.1.1.2.3.cmml"><mi id="S6.p3.1.m1.1.1.2.3.2" xref="S6.p3.1.m1.1.1.2.3.2.cmml">L</mi><mo id="S6.p3.1.m1.1.1.2.3.1" xref="S6.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mn id="S6.p3.1.m1.1.1.2.3.3" xref="S6.p3.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S6.p3.1.m1.1.1.1" xref="S6.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S6.p3.1.m1.1.1.3" xref="S6.p3.1.m1.1.1.3.cmml"><mn id="S6.p3.1.m1.1.1.3.2" xref="S6.p3.1.m1.1.1.3.2.cmml">1</mn><mo id="S6.p3.1.m1.1.1.3.1" xref="S6.p3.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S6.p3.1.m1.1.1.3.3" xref="S6.p3.1.m1.1.1.3.3.cmml"><mi id="S6.p3.1.m1.1.1.3.3.2" xref="S6.p3.1.m1.1.1.3.3.2.cmml">e</mi><mrow id="S6.p3.1.m1.1.1.3.3.3" xref="S6.p3.1.m1.1.1.3.3.3.cmml"><mo id="S6.p3.1.m1.1.1.3.3.3a" xref="S6.p3.1.m1.1.1.3.3.3.cmml">−</mo><mn id="S6.p3.1.m1.1.1.3.3.3.2" xref="S6.p3.1.m1.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.1.m1.1b"><apply id="S6.p3.1.m1.1.1.cmml" xref="S6.p3.1.m1.1.1"><eq id="S6.p3.1.m1.1.1.1.cmml" xref="S6.p3.1.m1.1.1.1"></eq><apply id="S6.p3.1.m1.1.1.2.cmml" xref="S6.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S6.p3.1.m1.1.1.2.1.cmml" xref="S6.p3.1.m1.1.1.2">subscript</csymbol><ci id="S6.p3.1.m1.1.1.2.2.cmml" xref="S6.p3.1.m1.1.1.2.2">𝜆</ci><apply id="S6.p3.1.m1.1.1.2.3.cmml" xref="S6.p3.1.m1.1.1.2.3"><times id="S6.p3.1.m1.1.1.2.3.1.cmml" xref="S6.p3.1.m1.1.1.2.3.1"></times><ci id="S6.p3.1.m1.1.1.2.3.2.cmml" xref="S6.p3.1.m1.1.1.2.3.2">𝐿</ci><cn id="S6.p3.1.m1.1.1.2.3.3.cmml" type="integer" xref="S6.p3.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S6.p3.1.m1.1.1.3.cmml" xref="S6.p3.1.m1.1.1.3"><times id="S6.p3.1.m1.1.1.3.1.cmml" xref="S6.p3.1.m1.1.1.3.1"></times><cn id="S6.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S6.p3.1.m1.1.1.3.2">1</cn><apply id="S6.p3.1.m1.1.1.3.3.cmml" xref="S6.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S6.p3.1.m1.1.1.3.3.1.cmml" xref="S6.p3.1.m1.1.1.3.3">superscript</csymbol><ci id="S6.p3.1.m1.1.1.3.3.2.cmml" xref="S6.p3.1.m1.1.1.3.3.2">𝑒</ci><apply id="S6.p3.1.m1.1.1.3.3.3.cmml" xref="S6.p3.1.m1.1.1.3.3.3"><minus id="S6.p3.1.m1.1.1.3.3.3.1.cmml" xref="S6.p3.1.m1.1.1.3.3.3"></minus><cn id="S6.p3.1.m1.1.1.3.3.3.2.cmml" type="integer" xref="S6.p3.1.m1.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.1.m1.1c">\lambda_{L1}=1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S6.p3.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_L 1 end_POSTSUBSCRIPT = 1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{J}=0.25" class="ltx_Math" display="inline" id="S6.p3.2.m2.1"><semantics id="S6.p3.2.m2.1a"><mrow id="S6.p3.2.m2.1.1" xref="S6.p3.2.m2.1.1.cmml"><msub id="S6.p3.2.m2.1.1.2" xref="S6.p3.2.m2.1.1.2.cmml"><mi id="S6.p3.2.m2.1.1.2.2" xref="S6.p3.2.m2.1.1.2.2.cmml">λ</mi><mi id="S6.p3.2.m2.1.1.2.3" xref="S6.p3.2.m2.1.1.2.3.cmml">J</mi></msub><mo id="S6.p3.2.m2.1.1.1" xref="S6.p3.2.m2.1.1.1.cmml">=</mo><mn id="S6.p3.2.m2.1.1.3" xref="S6.p3.2.m2.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.2.m2.1b"><apply id="S6.p3.2.m2.1.1.cmml" xref="S6.p3.2.m2.1.1"><eq id="S6.p3.2.m2.1.1.1.cmml" xref="S6.p3.2.m2.1.1.1"></eq><apply id="S6.p3.2.m2.1.1.2.cmml" xref="S6.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.p3.2.m2.1.1.2.1.cmml" xref="S6.p3.2.m2.1.1.2">subscript</csymbol><ci id="S6.p3.2.m2.1.1.2.2.cmml" xref="S6.p3.2.m2.1.1.2.2">𝜆</ci><ci id="S6.p3.2.m2.1.1.2.3.cmml" xref="S6.p3.2.m2.1.1.2.3">𝐽</ci></apply><cn id="S6.p3.2.m2.1.1.3.cmml" type="float" xref="S6.p3.2.m2.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.2.m2.1c">\lambda_{J}=0.25</annotation><annotation encoding="application/x-llamapun" id="S6.p3.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT = 0.25</annotation></semantics></math> following ProtoSeg on both Cityscapes and Pascal VOC, and <math alttext="\lambda_{L1}=1e^{-5}" class="ltx_Math" display="inline" id="S6.p3.3.m3.1"><semantics id="S6.p3.3.m3.1a"><mrow id="S6.p3.3.m3.1.1" xref="S6.p3.3.m3.1.1.cmml"><msub id="S6.p3.3.m3.1.1.2" xref="S6.p3.3.m3.1.1.2.cmml"><mi id="S6.p3.3.m3.1.1.2.2" xref="S6.p3.3.m3.1.1.2.2.cmml">λ</mi><mrow id="S6.p3.3.m3.1.1.2.3" xref="S6.p3.3.m3.1.1.2.3.cmml"><mi id="S6.p3.3.m3.1.1.2.3.2" xref="S6.p3.3.m3.1.1.2.3.2.cmml">L</mi><mo id="S6.p3.3.m3.1.1.2.3.1" xref="S6.p3.3.m3.1.1.2.3.1.cmml">⁢</mo><mn id="S6.p3.3.m3.1.1.2.3.3" xref="S6.p3.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S6.p3.3.m3.1.1.1" xref="S6.p3.3.m3.1.1.1.cmml">=</mo><mrow id="S6.p3.3.m3.1.1.3" xref="S6.p3.3.m3.1.1.3.cmml"><mn id="S6.p3.3.m3.1.1.3.2" xref="S6.p3.3.m3.1.1.3.2.cmml">1</mn><mo id="S6.p3.3.m3.1.1.3.1" xref="S6.p3.3.m3.1.1.3.1.cmml">⁢</mo><msup id="S6.p3.3.m3.1.1.3.3" xref="S6.p3.3.m3.1.1.3.3.cmml"><mi id="S6.p3.3.m3.1.1.3.3.2" xref="S6.p3.3.m3.1.1.3.3.2.cmml">e</mi><mrow id="S6.p3.3.m3.1.1.3.3.3" xref="S6.p3.3.m3.1.1.3.3.3.cmml"><mo id="S6.p3.3.m3.1.1.3.3.3a" xref="S6.p3.3.m3.1.1.3.3.3.cmml">−</mo><mn id="S6.p3.3.m3.1.1.3.3.3.2" xref="S6.p3.3.m3.1.1.3.3.3.2.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.3.m3.1b"><apply id="S6.p3.3.m3.1.1.cmml" xref="S6.p3.3.m3.1.1"><eq id="S6.p3.3.m3.1.1.1.cmml" xref="S6.p3.3.m3.1.1.1"></eq><apply id="S6.p3.3.m3.1.1.2.cmml" xref="S6.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.p3.3.m3.1.1.2.1.cmml" xref="S6.p3.3.m3.1.1.2">subscript</csymbol><ci id="S6.p3.3.m3.1.1.2.2.cmml" xref="S6.p3.3.m3.1.1.2.2">𝜆</ci><apply id="S6.p3.3.m3.1.1.2.3.cmml" xref="S6.p3.3.m3.1.1.2.3"><times id="S6.p3.3.m3.1.1.2.3.1.cmml" xref="S6.p3.3.m3.1.1.2.3.1"></times><ci id="S6.p3.3.m3.1.1.2.3.2.cmml" xref="S6.p3.3.m3.1.1.2.3.2">𝐿</ci><cn id="S6.p3.3.m3.1.1.2.3.3.cmml" type="integer" xref="S6.p3.3.m3.1.1.2.3.3">1</cn></apply></apply><apply id="S6.p3.3.m3.1.1.3.cmml" xref="S6.p3.3.m3.1.1.3"><times id="S6.p3.3.m3.1.1.3.1.cmml" xref="S6.p3.3.m3.1.1.3.1"></times><cn id="S6.p3.3.m3.1.1.3.2.cmml" type="integer" xref="S6.p3.3.m3.1.1.3.2">1</cn><apply id="S6.p3.3.m3.1.1.3.3.cmml" xref="S6.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S6.p3.3.m3.1.1.3.3.1.cmml" xref="S6.p3.3.m3.1.1.3.3">superscript</csymbol><ci id="S6.p3.3.m3.1.1.3.3.2.cmml" xref="S6.p3.3.m3.1.1.3.3.2">𝑒</ci><apply id="S6.p3.3.m3.1.1.3.3.3.cmml" xref="S6.p3.3.m3.1.1.3.3.3"><minus id="S6.p3.3.m3.1.1.3.3.3.1.cmml" xref="S6.p3.3.m3.1.1.3.3.3"></minus><cn id="S6.p3.3.m3.1.1.3.3.3.2.cmml" type="integer" xref="S6.p3.3.m3.1.1.3.3.3.2">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.3.m3.1c">\lambda_{L1}=1e^{-5}</annotation><annotation encoding="application/x-llamapun" id="S6.p3.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_L 1 end_POSTSUBSCRIPT = 1 italic_e start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> for ADE20K due to the large number of classes. For the datasets: Cityscapes and Pascal VOC, we run first the warm-up step for <math alttext="3000" class="ltx_Math" display="inline" id="S6.p3.4.m4.1"><semantics id="S6.p3.4.m4.1a"><mn id="S6.p3.4.m4.1.1" xref="S6.p3.4.m4.1.1.cmml">3000</mn><annotation-xml encoding="MathML-Content" id="S6.p3.4.m4.1b"><cn id="S6.p3.4.m4.1.1.cmml" type="integer" xref="S6.p3.4.m4.1.1">3000</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.4.m4.1c">3000</annotation><annotation encoding="application/x-llamapun" id="S6.p3.4.m4.1d">3000</annotation></semantics></math> batch iterations with a fixed learning rate of <math alttext="2.5e^{-4}" class="ltx_Math" display="inline" id="S6.p3.5.m5.1"><semantics id="S6.p3.5.m5.1a"><mrow id="S6.p3.5.m5.1.1" xref="S6.p3.5.m5.1.1.cmml"><mn id="S6.p3.5.m5.1.1.2" xref="S6.p3.5.m5.1.1.2.cmml">2.5</mn><mo id="S6.p3.5.m5.1.1.1" xref="S6.p3.5.m5.1.1.1.cmml">⁢</mo><msup id="S6.p3.5.m5.1.1.3" xref="S6.p3.5.m5.1.1.3.cmml"><mi id="S6.p3.5.m5.1.1.3.2" xref="S6.p3.5.m5.1.1.3.2.cmml">e</mi><mrow id="S6.p3.5.m5.1.1.3.3" xref="S6.p3.5.m5.1.1.3.3.cmml"><mo id="S6.p3.5.m5.1.1.3.3a" xref="S6.p3.5.m5.1.1.3.3.cmml">−</mo><mn id="S6.p3.5.m5.1.1.3.3.2" xref="S6.p3.5.m5.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.5.m5.1b"><apply id="S6.p3.5.m5.1.1.cmml" xref="S6.p3.5.m5.1.1"><times id="S6.p3.5.m5.1.1.1.cmml" xref="S6.p3.5.m5.1.1.1"></times><cn id="S6.p3.5.m5.1.1.2.cmml" type="float" xref="S6.p3.5.m5.1.1.2">2.5</cn><apply id="S6.p3.5.m5.1.1.3.cmml" xref="S6.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S6.p3.5.m5.1.1.3.1.cmml" xref="S6.p3.5.m5.1.1.3">superscript</csymbol><ci id="S6.p3.5.m5.1.1.3.2.cmml" xref="S6.p3.5.m5.1.1.3.2">𝑒</ci><apply id="S6.p3.5.m5.1.1.3.3.cmml" xref="S6.p3.5.m5.1.1.3.3"><minus id="S6.p3.5.m5.1.1.3.3.1.cmml" xref="S6.p3.5.m5.1.1.3.3"></minus><cn id="S6.p3.5.m5.1.1.3.3.2.cmml" type="integer" xref="S6.p3.5.m5.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.5.m5.1c">2.5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S6.p3.5.m5.1d">2.5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. The joint training step is run for <math alttext="30000" class="ltx_Math" display="inline" id="S6.p3.6.m6.1"><semantics id="S6.p3.6.m6.1a"><mn id="S6.p3.6.m6.1.1" xref="S6.p3.6.m6.1.1.cmml">30000</mn><annotation-xml encoding="MathML-Content" id="S6.p3.6.m6.1b"><cn id="S6.p3.6.m6.1.1.cmml" type="integer" xref="S6.p3.6.m6.1.1">30000</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.6.m6.1c">30000</annotation><annotation encoding="application/x-llamapun" id="S6.p3.6.m6.1d">30000</annotation></semantics></math> batch iterations with an initial learning rate of <math alttext="2.5e^{-5}" class="ltx_Math" display="inline" id="S6.p3.7.m7.1"><semantics id="S6.p3.7.m7.1a"><mrow id="S6.p3.7.m7.1.1" xref="S6.p3.7.m7.1.1.cmml"><mn id="S6.p3.7.m7.1.1.2" xref="S6.p3.7.m7.1.1.2.cmml">2.5</mn><mo id="S6.p3.7.m7.1.1.1" xref="S6.p3.7.m7.1.1.1.cmml">⁢</mo><msup id="S6.p3.7.m7.1.1.3" xref="S6.p3.7.m7.1.1.3.cmml"><mi id="S6.p3.7.m7.1.1.3.2" xref="S6.p3.7.m7.1.1.3.2.cmml">e</mi><mrow id="S6.p3.7.m7.1.1.3.3" xref="S6.p3.7.m7.1.1.3.3.cmml"><mo id="S6.p3.7.m7.1.1.3.3a" xref="S6.p3.7.m7.1.1.3.3.cmml">−</mo><mn id="S6.p3.7.m7.1.1.3.3.2" xref="S6.p3.7.m7.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.7.m7.1b"><apply id="S6.p3.7.m7.1.1.cmml" xref="S6.p3.7.m7.1.1"><times id="S6.p3.7.m7.1.1.1.cmml" xref="S6.p3.7.m7.1.1.1"></times><cn id="S6.p3.7.m7.1.1.2.cmml" type="float" xref="S6.p3.7.m7.1.1.2">2.5</cn><apply id="S6.p3.7.m7.1.1.3.cmml" xref="S6.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S6.p3.7.m7.1.1.3.1.cmml" xref="S6.p3.7.m7.1.1.3">superscript</csymbol><ci id="S6.p3.7.m7.1.1.3.2.cmml" xref="S6.p3.7.m7.1.1.3.2">𝑒</ci><apply id="S6.p3.7.m7.1.1.3.3.cmml" xref="S6.p3.7.m7.1.1.3.3"><minus id="S6.p3.7.m7.1.1.3.3.1.cmml" xref="S6.p3.7.m7.1.1.3.3"></minus><cn id="S6.p3.7.m7.1.1.3.3.2.cmml" type="integer" xref="S6.p3.7.m7.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.7.m7.1c">2.5e^{-5}</annotation><annotation encoding="application/x-llamapun" id="S6.p3.7.m7.1d">2.5 italic_e start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> for ResNet-101 and <math alttext="2.5e^{-4}" class="ltx_Math" display="inline" id="S6.p3.8.m8.1"><semantics id="S6.p3.8.m8.1a"><mrow id="S6.p3.8.m8.1.1" xref="S6.p3.8.m8.1.1.cmml"><mn id="S6.p3.8.m8.1.1.2" xref="S6.p3.8.m8.1.1.2.cmml">2.5</mn><mo id="S6.p3.8.m8.1.1.1" xref="S6.p3.8.m8.1.1.1.cmml">⁢</mo><msup id="S6.p3.8.m8.1.1.3" xref="S6.p3.8.m8.1.1.3.cmml"><mi id="S6.p3.8.m8.1.1.3.2" xref="S6.p3.8.m8.1.1.3.2.cmml">e</mi><mrow id="S6.p3.8.m8.1.1.3.3" xref="S6.p3.8.m8.1.1.3.3.cmml"><mo id="S6.p3.8.m8.1.1.3.3a" xref="S6.p3.8.m8.1.1.3.3.cmml">−</mo><mn id="S6.p3.8.m8.1.1.3.3.2" xref="S6.p3.8.m8.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.8.m8.1b"><apply id="S6.p3.8.m8.1.1.cmml" xref="S6.p3.8.m8.1.1"><times id="S6.p3.8.m8.1.1.1.cmml" xref="S6.p3.8.m8.1.1.1"></times><cn id="S6.p3.8.m8.1.1.2.cmml" type="float" xref="S6.p3.8.m8.1.1.2">2.5</cn><apply id="S6.p3.8.m8.1.1.3.cmml" xref="S6.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="S6.p3.8.m8.1.1.3.1.cmml" xref="S6.p3.8.m8.1.1.3">superscript</csymbol><ci id="S6.p3.8.m8.1.1.3.2.cmml" xref="S6.p3.8.m8.1.1.3.2">𝑒</ci><apply id="S6.p3.8.m8.1.1.3.3.cmml" xref="S6.p3.8.m8.1.1.3.3"><minus id="S6.p3.8.m8.1.1.3.3.1.cmml" xref="S6.p3.8.m8.1.1.3.3"></minus><cn id="S6.p3.8.m8.1.1.3.3.2.cmml" type="integer" xref="S6.p3.8.m8.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.8.m8.1c">2.5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S6.p3.8.m8.1d">2.5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for the prototype and ASPP layers. For this step, we leverage a learning rate scheduler following the polynomial learning rate policy with <math alttext="power=0.9" class="ltx_Math" display="inline" id="S6.p3.9.m9.1"><semantics id="S6.p3.9.m9.1a"><mrow id="S6.p3.9.m9.1.1" xref="S6.p3.9.m9.1.1.cmml"><mrow id="S6.p3.9.m9.1.1.2" xref="S6.p3.9.m9.1.1.2.cmml"><mi id="S6.p3.9.m9.1.1.2.2" xref="S6.p3.9.m9.1.1.2.2.cmml">p</mi><mo id="S6.p3.9.m9.1.1.2.1" xref="S6.p3.9.m9.1.1.2.1.cmml">⁢</mo><mi id="S6.p3.9.m9.1.1.2.3" xref="S6.p3.9.m9.1.1.2.3.cmml">o</mi><mo id="S6.p3.9.m9.1.1.2.1a" xref="S6.p3.9.m9.1.1.2.1.cmml">⁢</mo><mi id="S6.p3.9.m9.1.1.2.4" xref="S6.p3.9.m9.1.1.2.4.cmml">w</mi><mo id="S6.p3.9.m9.1.1.2.1b" xref="S6.p3.9.m9.1.1.2.1.cmml">⁢</mo><mi id="S6.p3.9.m9.1.1.2.5" xref="S6.p3.9.m9.1.1.2.5.cmml">e</mi><mo id="S6.p3.9.m9.1.1.2.1c" xref="S6.p3.9.m9.1.1.2.1.cmml">⁢</mo><mi id="S6.p3.9.m9.1.1.2.6" xref="S6.p3.9.m9.1.1.2.6.cmml">r</mi></mrow><mo id="S6.p3.9.m9.1.1.1" xref="S6.p3.9.m9.1.1.1.cmml">=</mo><mn id="S6.p3.9.m9.1.1.3" xref="S6.p3.9.m9.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.9.m9.1b"><apply id="S6.p3.9.m9.1.1.cmml" xref="S6.p3.9.m9.1.1"><eq id="S6.p3.9.m9.1.1.1.cmml" xref="S6.p3.9.m9.1.1.1"></eq><apply id="S6.p3.9.m9.1.1.2.cmml" xref="S6.p3.9.m9.1.1.2"><times id="S6.p3.9.m9.1.1.2.1.cmml" xref="S6.p3.9.m9.1.1.2.1"></times><ci id="S6.p3.9.m9.1.1.2.2.cmml" xref="S6.p3.9.m9.1.1.2.2">𝑝</ci><ci id="S6.p3.9.m9.1.1.2.3.cmml" xref="S6.p3.9.m9.1.1.2.3">𝑜</ci><ci id="S6.p3.9.m9.1.1.2.4.cmml" xref="S6.p3.9.m9.1.1.2.4">𝑤</ci><ci id="S6.p3.9.m9.1.1.2.5.cmml" xref="S6.p3.9.m9.1.1.2.5">𝑒</ci><ci id="S6.p3.9.m9.1.1.2.6.cmml" xref="S6.p3.9.m9.1.1.2.6">𝑟</ci></apply><cn id="S6.p3.9.m9.1.1.3.cmml" type="float" xref="S6.p3.9.m9.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.9.m9.1c">power=0.9</annotation><annotation encoding="application/x-llamapun" id="S6.p3.9.m9.1d">italic_p italic_o italic_w italic_e italic_r = 0.9</annotation></semantics></math>. Lastly, the fine-tuning step is done over <math alttext="2000" class="ltx_Math" display="inline" id="S6.p3.10.m10.1"><semantics id="S6.p3.10.m10.1a"><mn id="S6.p3.10.m10.1.1" xref="S6.p3.10.m10.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="S6.p3.10.m10.1b"><cn id="S6.p3.10.m10.1.1.cmml" type="integer" xref="S6.p3.10.m10.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.10.m10.1c">2000</annotation><annotation encoding="application/x-llamapun" id="S6.p3.10.m10.1d">2000</annotation></semantics></math> batch iterations extended to <math alttext="6000" class="ltx_Math" display="inline" id="S6.p3.11.m11.1"><semantics id="S6.p3.11.m11.1a"><mn id="S6.p3.11.m11.1.1" xref="S6.p3.11.m11.1.1.cmml">6000</mn><annotation-xml encoding="MathML-Content" id="S6.p3.11.m11.1b"><cn id="S6.p3.11.m11.1.1.cmml" type="integer" xref="S6.p3.11.m11.1.1">6000</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.11.m11.1c">6000</annotation><annotation encoding="application/x-llamapun" id="S6.p3.11.m11.1d">6000</annotation></semantics></math> for Pascal with a fixed learning rate of <math alttext="1e^{-5}" class="ltx_Math" display="inline" id="S6.p3.12.m12.1"><semantics id="S6.p3.12.m12.1a"><mrow id="S6.p3.12.m12.1.1" xref="S6.p3.12.m12.1.1.cmml"><mn id="S6.p3.12.m12.1.1.2" xref="S6.p3.12.m12.1.1.2.cmml">1</mn><mo id="S6.p3.12.m12.1.1.1" xref="S6.p3.12.m12.1.1.1.cmml">⁢</mo><msup id="S6.p3.12.m12.1.1.3" xref="S6.p3.12.m12.1.1.3.cmml"><mi id="S6.p3.12.m12.1.1.3.2" xref="S6.p3.12.m12.1.1.3.2.cmml">e</mi><mrow id="S6.p3.12.m12.1.1.3.3" xref="S6.p3.12.m12.1.1.3.3.cmml"><mo id="S6.p3.12.m12.1.1.3.3a" xref="S6.p3.12.m12.1.1.3.3.cmml">−</mo><mn id="S6.p3.12.m12.1.1.3.3.2" xref="S6.p3.12.m12.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.12.m12.1b"><apply id="S6.p3.12.m12.1.1.cmml" xref="S6.p3.12.m12.1.1"><times id="S6.p3.12.m12.1.1.1.cmml" xref="S6.p3.12.m12.1.1.1"></times><cn id="S6.p3.12.m12.1.1.2.cmml" type="integer" xref="S6.p3.12.m12.1.1.2">1</cn><apply id="S6.p3.12.m12.1.1.3.cmml" xref="S6.p3.12.m12.1.1.3"><csymbol cd="ambiguous" id="S6.p3.12.m12.1.1.3.1.cmml" xref="S6.p3.12.m12.1.1.3">superscript</csymbol><ci id="S6.p3.12.m12.1.1.3.2.cmml" xref="S6.p3.12.m12.1.1.3.2">𝑒</ci><apply id="S6.p3.12.m12.1.1.3.3.cmml" xref="S6.p3.12.m12.1.1.3.3"><minus id="S6.p3.12.m12.1.1.3.3.1.cmml" xref="S6.p3.12.m12.1.1.3.3"></minus><cn id="S6.p3.12.m12.1.1.3.3.2.cmml" type="integer" xref="S6.p3.12.m12.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.12.m12.1c">1e^{-5}</annotation><annotation encoding="application/x-llamapun" id="S6.p3.12.m12.1d">1 italic_e start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>. For ADE20K we leverage the same learning rate and learning rate scheduler as for the other two datasets but we double the number of batch iterations compared to Cityscapes on all steps: 6000 batches for warm-up, 60000 batches for joint training, and 4000 batches for fine-tuning.</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.1">The training of ProtoSeg on ADE20K follows the same experimental set-up as the multi-scale prototype training stage described above and as mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS1" title="4.1 Experimental setup ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4.1</span></a>: 12 prototypes per class were used to match ScaleProtoSeg.</p>
</div>
<div class="ltx_para" id="S6.p5">
<p class="ltx_p" id="S6.p5.8">During the training of the grouping mechanism, we set the weights of the loss terms to <math alttext="\lambda_{L1}=1e^{-3}" class="ltx_Math" display="inline" id="S6.p5.1.m1.1"><semantics id="S6.p5.1.m1.1a"><mrow id="S6.p5.1.m1.1.1" xref="S6.p5.1.m1.1.1.cmml"><msub id="S6.p5.1.m1.1.1.2" xref="S6.p5.1.m1.1.1.2.cmml"><mi id="S6.p5.1.m1.1.1.2.2" xref="S6.p5.1.m1.1.1.2.2.cmml">λ</mi><mrow id="S6.p5.1.m1.1.1.2.3" xref="S6.p5.1.m1.1.1.2.3.cmml"><mi id="S6.p5.1.m1.1.1.2.3.2" xref="S6.p5.1.m1.1.1.2.3.2.cmml">L</mi><mo id="S6.p5.1.m1.1.1.2.3.1" xref="S6.p5.1.m1.1.1.2.3.1.cmml">⁢</mo><mn id="S6.p5.1.m1.1.1.2.3.3" xref="S6.p5.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S6.p5.1.m1.1.1.1" xref="S6.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S6.p5.1.m1.1.1.3" xref="S6.p5.1.m1.1.1.3.cmml"><mn id="S6.p5.1.m1.1.1.3.2" xref="S6.p5.1.m1.1.1.3.2.cmml">1</mn><mo id="S6.p5.1.m1.1.1.3.1" xref="S6.p5.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S6.p5.1.m1.1.1.3.3" xref="S6.p5.1.m1.1.1.3.3.cmml"><mi id="S6.p5.1.m1.1.1.3.3.2" xref="S6.p5.1.m1.1.1.3.3.2.cmml">e</mi><mrow id="S6.p5.1.m1.1.1.3.3.3" xref="S6.p5.1.m1.1.1.3.3.3.cmml"><mo id="S6.p5.1.m1.1.1.3.3.3a" xref="S6.p5.1.m1.1.1.3.3.3.cmml">−</mo><mn id="S6.p5.1.m1.1.1.3.3.3.2" xref="S6.p5.1.m1.1.1.3.3.3.2.cmml">3</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p5.1.m1.1b"><apply id="S6.p5.1.m1.1.1.cmml" xref="S6.p5.1.m1.1.1"><eq id="S6.p5.1.m1.1.1.1.cmml" xref="S6.p5.1.m1.1.1.1"></eq><apply id="S6.p5.1.m1.1.1.2.cmml" xref="S6.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S6.p5.1.m1.1.1.2.1.cmml" xref="S6.p5.1.m1.1.1.2">subscript</csymbol><ci id="S6.p5.1.m1.1.1.2.2.cmml" xref="S6.p5.1.m1.1.1.2.2">𝜆</ci><apply id="S6.p5.1.m1.1.1.2.3.cmml" xref="S6.p5.1.m1.1.1.2.3"><times id="S6.p5.1.m1.1.1.2.3.1.cmml" xref="S6.p5.1.m1.1.1.2.3.1"></times><ci id="S6.p5.1.m1.1.1.2.3.2.cmml" xref="S6.p5.1.m1.1.1.2.3.2">𝐿</ci><cn id="S6.p5.1.m1.1.1.2.3.3.cmml" type="integer" xref="S6.p5.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S6.p5.1.m1.1.1.3.cmml" xref="S6.p5.1.m1.1.1.3"><times id="S6.p5.1.m1.1.1.3.1.cmml" xref="S6.p5.1.m1.1.1.3.1"></times><cn id="S6.p5.1.m1.1.1.3.2.cmml" type="integer" xref="S6.p5.1.m1.1.1.3.2">1</cn><apply id="S6.p5.1.m1.1.1.3.3.cmml" xref="S6.p5.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S6.p5.1.m1.1.1.3.3.1.cmml" xref="S6.p5.1.m1.1.1.3.3">superscript</csymbol><ci id="S6.p5.1.m1.1.1.3.3.2.cmml" xref="S6.p5.1.m1.1.1.3.3.2">𝑒</ci><apply id="S6.p5.1.m1.1.1.3.3.3.cmml" xref="S6.p5.1.m1.1.1.3.3.3"><minus id="S6.p5.1.m1.1.1.3.3.3.1.cmml" xref="S6.p5.1.m1.1.1.3.3.3"></minus><cn id="S6.p5.1.m1.1.1.3.3.3.2.cmml" type="integer" xref="S6.p5.1.m1.1.1.3.3.3.2">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.1.m1.1c">\lambda_{L1}=1e^{-3}</annotation><annotation encoding="application/x-llamapun" id="S6.p5.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_L 1 end_POSTSUBSCRIPT = 1 italic_e start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math> for Cityscapes and Pascal VOC, and <math alttext="\lambda_{L1}=1e^{-4}" class="ltx_Math" display="inline" id="S6.p5.2.m2.1"><semantics id="S6.p5.2.m2.1a"><mrow id="S6.p5.2.m2.1.1" xref="S6.p5.2.m2.1.1.cmml"><msub id="S6.p5.2.m2.1.1.2" xref="S6.p5.2.m2.1.1.2.cmml"><mi id="S6.p5.2.m2.1.1.2.2" xref="S6.p5.2.m2.1.1.2.2.cmml">λ</mi><mrow id="S6.p5.2.m2.1.1.2.3" xref="S6.p5.2.m2.1.1.2.3.cmml"><mi id="S6.p5.2.m2.1.1.2.3.2" xref="S6.p5.2.m2.1.1.2.3.2.cmml">L</mi><mo id="S6.p5.2.m2.1.1.2.3.1" xref="S6.p5.2.m2.1.1.2.3.1.cmml">⁢</mo><mn id="S6.p5.2.m2.1.1.2.3.3" xref="S6.p5.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S6.p5.2.m2.1.1.1" xref="S6.p5.2.m2.1.1.1.cmml">=</mo><mrow id="S6.p5.2.m2.1.1.3" xref="S6.p5.2.m2.1.1.3.cmml"><mn id="S6.p5.2.m2.1.1.3.2" xref="S6.p5.2.m2.1.1.3.2.cmml">1</mn><mo id="S6.p5.2.m2.1.1.3.1" xref="S6.p5.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S6.p5.2.m2.1.1.3.3" xref="S6.p5.2.m2.1.1.3.3.cmml"><mi id="S6.p5.2.m2.1.1.3.3.2" xref="S6.p5.2.m2.1.1.3.3.2.cmml">e</mi><mrow id="S6.p5.2.m2.1.1.3.3.3" xref="S6.p5.2.m2.1.1.3.3.3.cmml"><mo id="S6.p5.2.m2.1.1.3.3.3a" xref="S6.p5.2.m2.1.1.3.3.3.cmml">−</mo><mn id="S6.p5.2.m2.1.1.3.3.3.2" xref="S6.p5.2.m2.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p5.2.m2.1b"><apply id="S6.p5.2.m2.1.1.cmml" xref="S6.p5.2.m2.1.1"><eq id="S6.p5.2.m2.1.1.1.cmml" xref="S6.p5.2.m2.1.1.1"></eq><apply id="S6.p5.2.m2.1.1.2.cmml" xref="S6.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.p5.2.m2.1.1.2.1.cmml" xref="S6.p5.2.m2.1.1.2">subscript</csymbol><ci id="S6.p5.2.m2.1.1.2.2.cmml" xref="S6.p5.2.m2.1.1.2.2">𝜆</ci><apply id="S6.p5.2.m2.1.1.2.3.cmml" xref="S6.p5.2.m2.1.1.2.3"><times id="S6.p5.2.m2.1.1.2.3.1.cmml" xref="S6.p5.2.m2.1.1.2.3.1"></times><ci id="S6.p5.2.m2.1.1.2.3.2.cmml" xref="S6.p5.2.m2.1.1.2.3.2">𝐿</ci><cn id="S6.p5.2.m2.1.1.2.3.3.cmml" type="integer" xref="S6.p5.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S6.p5.2.m2.1.1.3.cmml" xref="S6.p5.2.m2.1.1.3"><times id="S6.p5.2.m2.1.1.3.1.cmml" xref="S6.p5.2.m2.1.1.3.1"></times><cn id="S6.p5.2.m2.1.1.3.2.cmml" type="integer" xref="S6.p5.2.m2.1.1.3.2">1</cn><apply id="S6.p5.2.m2.1.1.3.3.cmml" xref="S6.p5.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S6.p5.2.m2.1.1.3.3.1.cmml" xref="S6.p5.2.m2.1.1.3.3">superscript</csymbol><ci id="S6.p5.2.m2.1.1.3.3.2.cmml" xref="S6.p5.2.m2.1.1.3.3.2">𝑒</ci><apply id="S6.p5.2.m2.1.1.3.3.3.cmml" xref="S6.p5.2.m2.1.1.3.3.3"><minus id="S6.p5.2.m2.1.1.3.3.3.1.cmml" xref="S6.p5.2.m2.1.1.3.3.3"></minus><cn id="S6.p5.2.m2.1.1.3.3.3.2.cmml" type="integer" xref="S6.p5.2.m2.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.2.m2.1c">\lambda_{L1}=1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S6.p5.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_L 1 end_POSTSUBSCRIPT = 1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for ADE20K. Moreover, we set <math alttext="\lambda_{ent}=0.05" class="ltx_Math" display="inline" id="S6.p5.3.m3.1"><semantics id="S6.p5.3.m3.1a"><mrow id="S6.p5.3.m3.1.1" xref="S6.p5.3.m3.1.1.cmml"><msub id="S6.p5.3.m3.1.1.2" xref="S6.p5.3.m3.1.1.2.cmml"><mi id="S6.p5.3.m3.1.1.2.2" xref="S6.p5.3.m3.1.1.2.2.cmml">λ</mi><mrow id="S6.p5.3.m3.1.1.2.3" xref="S6.p5.3.m3.1.1.2.3.cmml"><mi id="S6.p5.3.m3.1.1.2.3.2" xref="S6.p5.3.m3.1.1.2.3.2.cmml">e</mi><mo id="S6.p5.3.m3.1.1.2.3.1" xref="S6.p5.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S6.p5.3.m3.1.1.2.3.3" xref="S6.p5.3.m3.1.1.2.3.3.cmml">n</mi><mo id="S6.p5.3.m3.1.1.2.3.1a" xref="S6.p5.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S6.p5.3.m3.1.1.2.3.4" xref="S6.p5.3.m3.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S6.p5.3.m3.1.1.1" xref="S6.p5.3.m3.1.1.1.cmml">=</mo><mn id="S6.p5.3.m3.1.1.3" xref="S6.p5.3.m3.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p5.3.m3.1b"><apply id="S6.p5.3.m3.1.1.cmml" xref="S6.p5.3.m3.1.1"><eq id="S6.p5.3.m3.1.1.1.cmml" xref="S6.p5.3.m3.1.1.1"></eq><apply id="S6.p5.3.m3.1.1.2.cmml" xref="S6.p5.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.p5.3.m3.1.1.2.1.cmml" xref="S6.p5.3.m3.1.1.2">subscript</csymbol><ci id="S6.p5.3.m3.1.1.2.2.cmml" xref="S6.p5.3.m3.1.1.2.2">𝜆</ci><apply id="S6.p5.3.m3.1.1.2.3.cmml" xref="S6.p5.3.m3.1.1.2.3"><times id="S6.p5.3.m3.1.1.2.3.1.cmml" xref="S6.p5.3.m3.1.1.2.3.1"></times><ci id="S6.p5.3.m3.1.1.2.3.2.cmml" xref="S6.p5.3.m3.1.1.2.3.2">𝑒</ci><ci id="S6.p5.3.m3.1.1.2.3.3.cmml" xref="S6.p5.3.m3.1.1.2.3.3">𝑛</ci><ci id="S6.p5.3.m3.1.1.2.3.4.cmml" xref="S6.p5.3.m3.1.1.2.3.4">𝑡</ci></apply></apply><cn id="S6.p5.3.m3.1.1.3.cmml" type="float" xref="S6.p5.3.m3.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.3.m3.1c">\lambda_{ent}=0.05</annotation><annotation encoding="application/x-llamapun" id="S6.p5.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_e italic_n italic_t end_POSTSUBSCRIPT = 0.05</annotation></semantics></math> for Cityscapes and Pascal VOC, and <math alttext="\lambda_{ent}=0.25" class="ltx_Math" display="inline" id="S6.p5.4.m4.1"><semantics id="S6.p5.4.m4.1a"><mrow id="S6.p5.4.m4.1.1" xref="S6.p5.4.m4.1.1.cmml"><msub id="S6.p5.4.m4.1.1.2" xref="S6.p5.4.m4.1.1.2.cmml"><mi id="S6.p5.4.m4.1.1.2.2" xref="S6.p5.4.m4.1.1.2.2.cmml">λ</mi><mrow id="S6.p5.4.m4.1.1.2.3" xref="S6.p5.4.m4.1.1.2.3.cmml"><mi id="S6.p5.4.m4.1.1.2.3.2" xref="S6.p5.4.m4.1.1.2.3.2.cmml">e</mi><mo id="S6.p5.4.m4.1.1.2.3.1" xref="S6.p5.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S6.p5.4.m4.1.1.2.3.3" xref="S6.p5.4.m4.1.1.2.3.3.cmml">n</mi><mo id="S6.p5.4.m4.1.1.2.3.1a" xref="S6.p5.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S6.p5.4.m4.1.1.2.3.4" xref="S6.p5.4.m4.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S6.p5.4.m4.1.1.1" xref="S6.p5.4.m4.1.1.1.cmml">=</mo><mn id="S6.p5.4.m4.1.1.3" xref="S6.p5.4.m4.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p5.4.m4.1b"><apply id="S6.p5.4.m4.1.1.cmml" xref="S6.p5.4.m4.1.1"><eq id="S6.p5.4.m4.1.1.1.cmml" xref="S6.p5.4.m4.1.1.1"></eq><apply id="S6.p5.4.m4.1.1.2.cmml" xref="S6.p5.4.m4.1.1.2"><csymbol cd="ambiguous" id="S6.p5.4.m4.1.1.2.1.cmml" xref="S6.p5.4.m4.1.1.2">subscript</csymbol><ci id="S6.p5.4.m4.1.1.2.2.cmml" xref="S6.p5.4.m4.1.1.2.2">𝜆</ci><apply id="S6.p5.4.m4.1.1.2.3.cmml" xref="S6.p5.4.m4.1.1.2.3"><times id="S6.p5.4.m4.1.1.2.3.1.cmml" xref="S6.p5.4.m4.1.1.2.3.1"></times><ci id="S6.p5.4.m4.1.1.2.3.2.cmml" xref="S6.p5.4.m4.1.1.2.3.2">𝑒</ci><ci id="S6.p5.4.m4.1.1.2.3.3.cmml" xref="S6.p5.4.m4.1.1.2.3.3">𝑛</ci><ci id="S6.p5.4.m4.1.1.2.3.4.cmml" xref="S6.p5.4.m4.1.1.2.3.4">𝑡</ci></apply></apply><cn id="S6.p5.4.m4.1.1.3.cmml" type="float" xref="S6.p5.4.m4.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.4.m4.1c">\lambda_{ent}=0.25</annotation><annotation encoding="application/x-llamapun" id="S6.p5.4.m4.1d">italic_λ start_POSTSUBSCRIPT italic_e italic_n italic_t end_POSTSUBSCRIPT = 0.25</annotation></semantics></math> for ADE20K. We run the warm-up stage to train the group projections for <math alttext="2000" class="ltx_Math" display="inline" id="S6.p5.5.m5.1"><semantics id="S6.p5.5.m5.1a"><mn id="S6.p5.5.m5.1.1" xref="S6.p5.5.m5.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="S6.p5.5.m5.1b"><cn id="S6.p5.5.m5.1.1.cmml" type="integer" xref="S6.p5.5.m5.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.5.m5.1c">2000</annotation><annotation encoding="application/x-llamapun" id="S6.p5.5.m5.1d">2000</annotation></semantics></math> batch iterations with a fixed learning rate of <math alttext="2.5e^{-4}" class="ltx_Math" display="inline" id="S6.p5.6.m6.1"><semantics id="S6.p5.6.m6.1a"><mrow id="S6.p5.6.m6.1.1" xref="S6.p5.6.m6.1.1.cmml"><mn id="S6.p5.6.m6.1.1.2" xref="S6.p5.6.m6.1.1.2.cmml">2.5</mn><mo id="S6.p5.6.m6.1.1.1" xref="S6.p5.6.m6.1.1.1.cmml">⁢</mo><msup id="S6.p5.6.m6.1.1.3" xref="S6.p5.6.m6.1.1.3.cmml"><mi id="S6.p5.6.m6.1.1.3.2" xref="S6.p5.6.m6.1.1.3.2.cmml">e</mi><mrow id="S6.p5.6.m6.1.1.3.3" xref="S6.p5.6.m6.1.1.3.3.cmml"><mo id="S6.p5.6.m6.1.1.3.3a" xref="S6.p5.6.m6.1.1.3.3.cmml">−</mo><mn id="S6.p5.6.m6.1.1.3.3.2" xref="S6.p5.6.m6.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p5.6.m6.1b"><apply id="S6.p5.6.m6.1.1.cmml" xref="S6.p5.6.m6.1.1"><times id="S6.p5.6.m6.1.1.1.cmml" xref="S6.p5.6.m6.1.1.1"></times><cn id="S6.p5.6.m6.1.1.2.cmml" type="float" xref="S6.p5.6.m6.1.1.2">2.5</cn><apply id="S6.p5.6.m6.1.1.3.cmml" xref="S6.p5.6.m6.1.1.3"><csymbol cd="ambiguous" id="S6.p5.6.m6.1.1.3.1.cmml" xref="S6.p5.6.m6.1.1.3">superscript</csymbol><ci id="S6.p5.6.m6.1.1.3.2.cmml" xref="S6.p5.6.m6.1.1.3.2">𝑒</ci><apply id="S6.p5.6.m6.1.1.3.3.cmml" xref="S6.p5.6.m6.1.1.3.3"><minus id="S6.p5.6.m6.1.1.3.3.1.cmml" xref="S6.p5.6.m6.1.1.3.3"></minus><cn id="S6.p5.6.m6.1.1.3.3.2.cmml" type="integer" xref="S6.p5.6.m6.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.6.m6.1c">2.5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S6.p5.6.m6.1d">2.5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for all datasets. Then, we run the fine-tuning stage for <math alttext="30000" class="ltx_Math" display="inline" id="S6.p5.7.m7.1"><semantics id="S6.p5.7.m7.1a"><mn id="S6.p5.7.m7.1.1" xref="S6.p5.7.m7.1.1.cmml">30000</mn><annotation-xml encoding="MathML-Content" id="S6.p5.7.m7.1b"><cn id="S6.p5.7.m7.1.1.cmml" type="integer" xref="S6.p5.7.m7.1.1">30000</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.7.m7.1c">30000</annotation><annotation encoding="application/x-llamapun" id="S6.p5.7.m7.1d">30000</annotation></semantics></math> batches with a learning rate of <math alttext="2.5e^{-4}" class="ltx_Math" display="inline" id="S6.p5.8.m8.1"><semantics id="S6.p5.8.m8.1a"><mrow id="S6.p5.8.m8.1.1" xref="S6.p5.8.m8.1.1.cmml"><mn id="S6.p5.8.m8.1.1.2" xref="S6.p5.8.m8.1.1.2.cmml">2.5</mn><mo id="S6.p5.8.m8.1.1.1" xref="S6.p5.8.m8.1.1.1.cmml">⁢</mo><msup id="S6.p5.8.m8.1.1.3" xref="S6.p5.8.m8.1.1.3.cmml"><mi id="S6.p5.8.m8.1.1.3.2" xref="S6.p5.8.m8.1.1.3.2.cmml">e</mi><mrow id="S6.p5.8.m8.1.1.3.3" xref="S6.p5.8.m8.1.1.3.3.cmml"><mo id="S6.p5.8.m8.1.1.3.3a" xref="S6.p5.8.m8.1.1.3.3.cmml">−</mo><mn id="S6.p5.8.m8.1.1.3.3.2" xref="S6.p5.8.m8.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p5.8.m8.1b"><apply id="S6.p5.8.m8.1.1.cmml" xref="S6.p5.8.m8.1.1"><times id="S6.p5.8.m8.1.1.1.cmml" xref="S6.p5.8.m8.1.1.1"></times><cn id="S6.p5.8.m8.1.1.2.cmml" type="float" xref="S6.p5.8.m8.1.1.2">2.5</cn><apply id="S6.p5.8.m8.1.1.3.cmml" xref="S6.p5.8.m8.1.1.3"><csymbol cd="ambiguous" id="S6.p5.8.m8.1.1.3.1.cmml" xref="S6.p5.8.m8.1.1.3">superscript</csymbol><ci id="S6.p5.8.m8.1.1.3.2.cmml" xref="S6.p5.8.m8.1.1.3.2">𝑒</ci><apply id="S6.p5.8.m8.1.1.3.3.cmml" xref="S6.p5.8.m8.1.1.3.3"><minus id="S6.p5.8.m8.1.1.3.3.1.cmml" xref="S6.p5.8.m8.1.1.3.3"></minus><cn id="S6.p5.8.m8.1.1.3.3.2.cmml" type="integer" xref="S6.p5.8.m8.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p5.8.m8.1c">2.5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S6.p5.8.m8.1d">2.5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and the same optimizer and scheduling policy as in the prototype joint training phase for all datasets.</p>
</div>
<div class="ltx_para" id="S6.p6">
<p class="ltx_p" id="S6.p6.6">We evaluate ScaleProtoSeg on Pascal VOC for which we set the training image resolution to <math alttext="321\times 321" class="ltx_Math" display="inline" id="S6.p6.1.m1.1"><semantics id="S6.p6.1.m1.1a"><mrow id="S6.p6.1.m1.1.1" xref="S6.p6.1.m1.1.1.cmml"><mn id="S6.p6.1.m1.1.1.2" xref="S6.p6.1.m1.1.1.2.cmml">321</mn><mo id="S6.p6.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.p6.1.m1.1.1.1.cmml">×</mo><mn id="S6.p6.1.m1.1.1.3" xref="S6.p6.1.m1.1.1.3.cmml">321</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p6.1.m1.1b"><apply id="S6.p6.1.m1.1.1.cmml" xref="S6.p6.1.m1.1.1"><times id="S6.p6.1.m1.1.1.1.cmml" xref="S6.p6.1.m1.1.1.1"></times><cn id="S6.p6.1.m1.1.1.2.cmml" type="integer" xref="S6.p6.1.m1.1.1.2">321</cn><cn id="S6.p6.1.m1.1.1.3.cmml" type="integer" xref="S6.p6.1.m1.1.1.3">321</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p6.1.m1.1c">321\times 321</annotation><annotation encoding="application/x-llamapun" id="S6.p6.1.m1.1d">321 × 321</annotation></semantics></math> and the testing one to <math alttext="513\times 513" class="ltx_Math" display="inline" id="S6.p6.2.m2.1"><semantics id="S6.p6.2.m2.1a"><mrow id="S6.p6.2.m2.1.1" xref="S6.p6.2.m2.1.1.cmml"><mn id="S6.p6.2.m2.1.1.2" xref="S6.p6.2.m2.1.1.2.cmml">513</mn><mo id="S6.p6.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.p6.2.m2.1.1.1.cmml">×</mo><mn id="S6.p6.2.m2.1.1.3" xref="S6.p6.2.m2.1.1.3.cmml">513</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p6.2.m2.1b"><apply id="S6.p6.2.m2.1.1.cmml" xref="S6.p6.2.m2.1.1"><times id="S6.p6.2.m2.1.1.1.cmml" xref="S6.p6.2.m2.1.1.1"></times><cn id="S6.p6.2.m2.1.1.2.cmml" type="integer" xref="S6.p6.2.m2.1.1.2">513</cn><cn id="S6.p6.2.m2.1.1.3.cmml" type="integer" xref="S6.p6.2.m2.1.1.3">513</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p6.2.m2.1c">513\times 513</annotation><annotation encoding="application/x-llamapun" id="S6.p6.2.m2.1d">513 × 513</annotation></semantics></math>. Moreover, we use multi-scale inputs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite> with scales <math alttext="\{0.5,0.75,1\}" class="ltx_Math" display="inline" id="S6.p6.3.m3.3"><semantics id="S6.p6.3.m3.3a"><mrow id="S6.p6.3.m3.3.4.2" xref="S6.p6.3.m3.3.4.1.cmml"><mo id="S6.p6.3.m3.3.4.2.1" stretchy="false" xref="S6.p6.3.m3.3.4.1.cmml">{</mo><mn id="S6.p6.3.m3.1.1" xref="S6.p6.3.m3.1.1.cmml">0.5</mn><mo id="S6.p6.3.m3.3.4.2.2" xref="S6.p6.3.m3.3.4.1.cmml">,</mo><mn id="S6.p6.3.m3.2.2" xref="S6.p6.3.m3.2.2.cmml">0.75</mn><mo id="S6.p6.3.m3.3.4.2.3" xref="S6.p6.3.m3.3.4.1.cmml">,</mo><mn id="S6.p6.3.m3.3.3" xref="S6.p6.3.m3.3.3.cmml">1</mn><mo id="S6.p6.3.m3.3.4.2.4" stretchy="false" xref="S6.p6.3.m3.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.p6.3.m3.3b"><set id="S6.p6.3.m3.3.4.1.cmml" xref="S6.p6.3.m3.3.4.2"><cn id="S6.p6.3.m3.1.1.cmml" type="float" xref="S6.p6.3.m3.1.1">0.5</cn><cn id="S6.p6.3.m3.2.2.cmml" type="float" xref="S6.p6.3.m3.2.2">0.75</cn><cn id="S6.p6.3.m3.3.3.cmml" type="integer" xref="S6.p6.3.m3.3.3">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S6.p6.3.m3.3c">\{0.5,0.75,1\}</annotation><annotation encoding="application/x-llamapun" id="S6.p6.3.m3.3d">{ 0.5 , 0.75 , 1 }</annotation></semantics></math> during training. We also evaluate ScaleProtoSeg on Cityscapes, for this dataset, we do not use MSC input training, we set the training resolution to <math alttext="513\times 513" class="ltx_Math" display="inline" id="S6.p6.4.m4.1"><semantics id="S6.p6.4.m4.1a"><mrow id="S6.p6.4.m4.1.1" xref="S6.p6.4.m4.1.1.cmml"><mn id="S6.p6.4.m4.1.1.2" xref="S6.p6.4.m4.1.1.2.cmml">513</mn><mo id="S6.p6.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.p6.4.m4.1.1.1.cmml">×</mo><mn id="S6.p6.4.m4.1.1.3" xref="S6.p6.4.m4.1.1.3.cmml">513</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p6.4.m4.1b"><apply id="S6.p6.4.m4.1.1.cmml" xref="S6.p6.4.m4.1.1"><times id="S6.p6.4.m4.1.1.1.cmml" xref="S6.p6.4.m4.1.1.1"></times><cn id="S6.p6.4.m4.1.1.2.cmml" type="integer" xref="S6.p6.4.m4.1.1.2">513</cn><cn id="S6.p6.4.m4.1.1.3.cmml" type="integer" xref="S6.p6.4.m4.1.1.3">513</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p6.4.m4.1c">513\times 513</annotation><annotation encoding="application/x-llamapun" id="S6.p6.4.m4.1d">513 × 513</annotation></semantics></math> and the testing one to <math alttext="1024\times 2048" class="ltx_Math" display="inline" id="S6.p6.5.m5.1"><semantics id="S6.p6.5.m5.1a"><mrow id="S6.p6.5.m5.1.1" xref="S6.p6.5.m5.1.1.cmml"><mn id="S6.p6.5.m5.1.1.2" xref="S6.p6.5.m5.1.1.2.cmml">1024</mn><mo id="S6.p6.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.p6.5.m5.1.1.1.cmml">×</mo><mn id="S6.p6.5.m5.1.1.3" xref="S6.p6.5.m5.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p6.5.m5.1b"><apply id="S6.p6.5.m5.1.1.cmml" xref="S6.p6.5.m5.1.1"><times id="S6.p6.5.m5.1.1.1.cmml" xref="S6.p6.5.m5.1.1.1"></times><cn id="S6.p6.5.m5.1.1.2.cmml" type="integer" xref="S6.p6.5.m5.1.1.2">1024</cn><cn id="S6.p6.5.m5.1.1.3.cmml" type="integer" xref="S6.p6.5.m5.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p6.5.m5.1c">1024\times 2048</annotation><annotation encoding="application/x-llamapun" id="S6.p6.5.m5.1d">1024 × 2048</annotation></semantics></math>. Lastly, we evaluate ScaleProtoSeg and ProtoSeg on ADE20K with no MSC input, a training resolution of <math alttext="512\times 512" class="ltx_Math" display="inline" id="S6.p6.6.m6.1"><semantics id="S6.p6.6.m6.1a"><mrow id="S6.p6.6.m6.1.1" xref="S6.p6.6.m6.1.1.cmml"><mn id="S6.p6.6.m6.1.1.2" xref="S6.p6.6.m6.1.1.2.cmml">512</mn><mo id="S6.p6.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.p6.6.m6.1.1.1.cmml">×</mo><mn id="S6.p6.6.m6.1.1.3" xref="S6.p6.6.m6.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p6.6.m6.1b"><apply id="S6.p6.6.m6.1.1.cmml" xref="S6.p6.6.m6.1.1"><times id="S6.p6.6.m6.1.1.1.cmml" xref="S6.p6.6.m6.1.1.1"></times><cn id="S6.p6.6.m6.1.1.2.cmml" type="integer" xref="S6.p6.6.m6.1.1.2">512</cn><cn id="S6.p6.6.m6.1.1.3.cmml" type="integer" xref="S6.p6.6.m6.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p6.6.m6.1c">512\times 512</annotation><annotation encoding="application/x-llamapun" id="S6.p6.6.m6.1d">512 × 512</annotation></semantics></math>, and at test time we resize the smallest size of the image to the training resolution and keep the aspect ratio. Lastly, the performance of DeepLabv2 on ADE20K was extracted from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib36" title="">36</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S6.p7">
<p class="ltx_p" id="S6.p7.1">The interpretability evaluation of our method is done on the parts annotated validation sets from Cityscapes and PASCAL-Context <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib58" title="">58</a>]</cite>. In particular, to align to the classes and images covered during training for Pascal, we tested on the overlap images between PASCAL VOC and PASCAL-Context and so used the semantic annotations from PASCAL VOC and the part annotations from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib58" title="">58</a>]</cite> for the 16 classes covered. This represents 925 validation images for Pascal. Moreover, the stability and consistency metrics require part keypoints in their formulation, for this purpose we leverage the standard algorithm from opencv with an 8-connectivity relation between non-zero elements to compute the centroids of every connected component in the part annotations, similar to Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2" title="4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4.2</span></a>. The prototype activations are computed using the images in their native size for both datasets and interpolated to their corresponding part annotation size. We leverage multiple binarization thresholds on the prototype activations as mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2" title="4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4.2</span></a> to improve the robustness of those metrics in terms of variance across runs and to avoid a strong dependency on a fixed hyperparameter contrary to the window size used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib37" title="">37</a>]</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Transferability of ScaleProtoSeg</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.8">To demonstrate the transferability of the proposed ScaleProtoSeg method beyond the domain of natural images, we run experiments on a medical dataset. In particular, we use the EM segmentation challenge dataset from ISBI 2012 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib4" title="">4</a>]</cite>, containing 30 images of size <math alttext="512\times 512" class="ltx_Math" display="inline" id="S7.p1.1.m1.1"><semantics id="S7.p1.1.m1.1a"><mrow id="S7.p1.1.m1.1.1" xref="S7.p1.1.m1.1.1.cmml"><mn id="S7.p1.1.m1.1.1.2" xref="S7.p1.1.m1.1.1.2.cmml">512</mn><mo id="S7.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.p1.1.m1.1.1.1.cmml">×</mo><mn id="S7.p1.1.m1.1.1.3" xref="S7.p1.1.m1.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.1.m1.1b"><apply id="S7.p1.1.m1.1.1.cmml" xref="S7.p1.1.m1.1.1"><times id="S7.p1.1.m1.1.1.1.cmml" xref="S7.p1.1.m1.1.1.1"></times><cn id="S7.p1.1.m1.1.1.2.cmml" type="integer" xref="S7.p1.1.m1.1.1.2">512</cn><cn id="S7.p1.1.m1.1.1.3.cmml" type="integer" xref="S7.p1.1.m1.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">512\times 512</annotation><annotation encoding="application/x-llamapun" id="S7.p1.1.m1.1d">512 × 512</annotation></semantics></math> with 2 classes that are randomly split 2 times in 20 training and 10 validation images, similar to the experiment in ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>. The architecture used as the backbone for this experiment is the original U-Net <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib67" title="">67</a>]</cite>. The applicability of ScaleProtoSeg to another segmentation backbone is straightforward as it simply requires stacking the ASPP at the network output before the classification layer, allowing the extraction of multi-scale feature maps. The prototype layer contains 10 and 12 prototypes per class for ProtoSeg and ScaleProtoSeg respectively, so 3 prototypes per scale and class for ScaleProtoSeg and similarly 3 groups per class. We run 3 experiments per method in the same set-up as in ProtoSeg with pruning and grouping for each method respectively. For the prototype training stage, we skip the warm-up step and run the joint training and fine-tuning step for 10000 batches iterations each with a batch size of 2. The learning rate for the joint step is fixed at <math alttext="1e^{-4}" class="ltx_Math" display="inline" id="S7.p1.2.m2.1"><semantics id="S7.p1.2.m2.1a"><mrow id="S7.p1.2.m2.1.1" xref="S7.p1.2.m2.1.1.cmml"><mn id="S7.p1.2.m2.1.1.2" xref="S7.p1.2.m2.1.1.2.cmml">1</mn><mo id="S7.p1.2.m2.1.1.1" xref="S7.p1.2.m2.1.1.1.cmml">⁢</mo><msup id="S7.p1.2.m2.1.1.3" xref="S7.p1.2.m2.1.1.3.cmml"><mi id="S7.p1.2.m2.1.1.3.2" xref="S7.p1.2.m2.1.1.3.2.cmml">e</mi><mrow id="S7.p1.2.m2.1.1.3.3" xref="S7.p1.2.m2.1.1.3.3.cmml"><mo id="S7.p1.2.m2.1.1.3.3a" xref="S7.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S7.p1.2.m2.1.1.3.3.2" xref="S7.p1.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.2.m2.1b"><apply id="S7.p1.2.m2.1.1.cmml" xref="S7.p1.2.m2.1.1"><times id="S7.p1.2.m2.1.1.1.cmml" xref="S7.p1.2.m2.1.1.1"></times><cn id="S7.p1.2.m2.1.1.2.cmml" type="integer" xref="S7.p1.2.m2.1.1.2">1</cn><apply id="S7.p1.2.m2.1.1.3.cmml" xref="S7.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S7.p1.2.m2.1.1.3.1.cmml" xref="S7.p1.2.m2.1.1.3">superscript</csymbol><ci id="S7.p1.2.m2.1.1.3.2.cmml" xref="S7.p1.2.m2.1.1.3.2">𝑒</ci><apply id="S7.p1.2.m2.1.1.3.3.cmml" xref="S7.p1.2.m2.1.1.3.3"><minus id="S7.p1.2.m2.1.1.3.3.1.cmml" xref="S7.p1.2.m2.1.1.3.3"></minus><cn id="S7.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S7.p1.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.2.m2.1c">1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.2.m2.1d">1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and we use the same learning scheduler as in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S6" title="6 Details on experimental set-up ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a>. The learning rate for the fine-tuning step is constant and fixed at <math alttext="1e^{-5}" class="ltx_Math" display="inline" id="S7.p1.3.m3.1"><semantics id="S7.p1.3.m3.1a"><mrow id="S7.p1.3.m3.1.1" xref="S7.p1.3.m3.1.1.cmml"><mn id="S7.p1.3.m3.1.1.2" xref="S7.p1.3.m3.1.1.2.cmml">1</mn><mo id="S7.p1.3.m3.1.1.1" xref="S7.p1.3.m3.1.1.1.cmml">⁢</mo><msup id="S7.p1.3.m3.1.1.3" xref="S7.p1.3.m3.1.1.3.cmml"><mi id="S7.p1.3.m3.1.1.3.2" xref="S7.p1.3.m3.1.1.3.2.cmml">e</mi><mrow id="S7.p1.3.m3.1.1.3.3" xref="S7.p1.3.m3.1.1.3.3.cmml"><mo id="S7.p1.3.m3.1.1.3.3a" xref="S7.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="S7.p1.3.m3.1.1.3.3.2" xref="S7.p1.3.m3.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.3.m3.1b"><apply id="S7.p1.3.m3.1.1.cmml" xref="S7.p1.3.m3.1.1"><times id="S7.p1.3.m3.1.1.1.cmml" xref="S7.p1.3.m3.1.1.1"></times><cn id="S7.p1.3.m3.1.1.2.cmml" type="integer" xref="S7.p1.3.m3.1.1.2">1</cn><apply id="S7.p1.3.m3.1.1.3.cmml" xref="S7.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S7.p1.3.m3.1.1.3.1.cmml" xref="S7.p1.3.m3.1.1.3">superscript</csymbol><ci id="S7.p1.3.m3.1.1.3.2.cmml" xref="S7.p1.3.m3.1.1.3.2">𝑒</ci><apply id="S7.p1.3.m3.1.1.3.3.cmml" xref="S7.p1.3.m3.1.1.3.3"><minus id="S7.p1.3.m3.1.1.3.3.1.cmml" xref="S7.p1.3.m3.1.1.3.3"></minus><cn id="S7.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S7.p1.3.m3.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.3.m3.1c">1e^{-5}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.3.m3.1d">1 italic_e start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>. The weights of the loss terms for both methods during the prototype training stage are set to <math alttext="\lambda_{L1}=1e^{-4}" class="ltx_Math" display="inline" id="S7.p1.4.m4.1"><semantics id="S7.p1.4.m4.1a"><mrow id="S7.p1.4.m4.1.1" xref="S7.p1.4.m4.1.1.cmml"><msub id="S7.p1.4.m4.1.1.2" xref="S7.p1.4.m4.1.1.2.cmml"><mi id="S7.p1.4.m4.1.1.2.2" xref="S7.p1.4.m4.1.1.2.2.cmml">λ</mi><mrow id="S7.p1.4.m4.1.1.2.3" xref="S7.p1.4.m4.1.1.2.3.cmml"><mi id="S7.p1.4.m4.1.1.2.3.2" xref="S7.p1.4.m4.1.1.2.3.2.cmml">L</mi><mo id="S7.p1.4.m4.1.1.2.3.1" xref="S7.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mn id="S7.p1.4.m4.1.1.2.3.3" xref="S7.p1.4.m4.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S7.p1.4.m4.1.1.1" xref="S7.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S7.p1.4.m4.1.1.3" xref="S7.p1.4.m4.1.1.3.cmml"><mn id="S7.p1.4.m4.1.1.3.2" xref="S7.p1.4.m4.1.1.3.2.cmml">1</mn><mo id="S7.p1.4.m4.1.1.3.1" xref="S7.p1.4.m4.1.1.3.1.cmml">⁢</mo><msup id="S7.p1.4.m4.1.1.3.3" xref="S7.p1.4.m4.1.1.3.3.cmml"><mi id="S7.p1.4.m4.1.1.3.3.2" xref="S7.p1.4.m4.1.1.3.3.2.cmml">e</mi><mrow id="S7.p1.4.m4.1.1.3.3.3" xref="S7.p1.4.m4.1.1.3.3.3.cmml"><mo id="S7.p1.4.m4.1.1.3.3.3a" xref="S7.p1.4.m4.1.1.3.3.3.cmml">−</mo><mn id="S7.p1.4.m4.1.1.3.3.3.2" xref="S7.p1.4.m4.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.4.m4.1b"><apply id="S7.p1.4.m4.1.1.cmml" xref="S7.p1.4.m4.1.1"><eq id="S7.p1.4.m4.1.1.1.cmml" xref="S7.p1.4.m4.1.1.1"></eq><apply id="S7.p1.4.m4.1.1.2.cmml" xref="S7.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S7.p1.4.m4.1.1.2.1.cmml" xref="S7.p1.4.m4.1.1.2">subscript</csymbol><ci id="S7.p1.4.m4.1.1.2.2.cmml" xref="S7.p1.4.m4.1.1.2.2">𝜆</ci><apply id="S7.p1.4.m4.1.1.2.3.cmml" xref="S7.p1.4.m4.1.1.2.3"><times id="S7.p1.4.m4.1.1.2.3.1.cmml" xref="S7.p1.4.m4.1.1.2.3.1"></times><ci id="S7.p1.4.m4.1.1.2.3.2.cmml" xref="S7.p1.4.m4.1.1.2.3.2">𝐿</ci><cn id="S7.p1.4.m4.1.1.2.3.3.cmml" type="integer" xref="S7.p1.4.m4.1.1.2.3.3">1</cn></apply></apply><apply id="S7.p1.4.m4.1.1.3.cmml" xref="S7.p1.4.m4.1.1.3"><times id="S7.p1.4.m4.1.1.3.1.cmml" xref="S7.p1.4.m4.1.1.3.1"></times><cn id="S7.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S7.p1.4.m4.1.1.3.2">1</cn><apply id="S7.p1.4.m4.1.1.3.3.cmml" xref="S7.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S7.p1.4.m4.1.1.3.3.1.cmml" xref="S7.p1.4.m4.1.1.3.3">superscript</csymbol><ci id="S7.p1.4.m4.1.1.3.3.2.cmml" xref="S7.p1.4.m4.1.1.3.3.2">𝑒</ci><apply id="S7.p1.4.m4.1.1.3.3.3.cmml" xref="S7.p1.4.m4.1.1.3.3.3"><minus id="S7.p1.4.m4.1.1.3.3.3.1.cmml" xref="S7.p1.4.m4.1.1.3.3.3"></minus><cn id="S7.p1.4.m4.1.1.3.3.3.2.cmml" type="integer" xref="S7.p1.4.m4.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.4.m4.1c">\lambda_{L1}=1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.4.m4.1d">italic_λ start_POSTSUBSCRIPT italic_L 1 end_POSTSUBSCRIPT = 1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{J}=0.25" class="ltx_Math" display="inline" id="S7.p1.5.m5.1"><semantics id="S7.p1.5.m5.1a"><mrow id="S7.p1.5.m5.1.1" xref="S7.p1.5.m5.1.1.cmml"><msub id="S7.p1.5.m5.1.1.2" xref="S7.p1.5.m5.1.1.2.cmml"><mi id="S7.p1.5.m5.1.1.2.2" xref="S7.p1.5.m5.1.1.2.2.cmml">λ</mi><mi id="S7.p1.5.m5.1.1.2.3" xref="S7.p1.5.m5.1.1.2.3.cmml">J</mi></msub><mo id="S7.p1.5.m5.1.1.1" xref="S7.p1.5.m5.1.1.1.cmml">=</mo><mn id="S7.p1.5.m5.1.1.3" xref="S7.p1.5.m5.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.5.m5.1b"><apply id="S7.p1.5.m5.1.1.cmml" xref="S7.p1.5.m5.1.1"><eq id="S7.p1.5.m5.1.1.1.cmml" xref="S7.p1.5.m5.1.1.1"></eq><apply id="S7.p1.5.m5.1.1.2.cmml" xref="S7.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S7.p1.5.m5.1.1.2.1.cmml" xref="S7.p1.5.m5.1.1.2">subscript</csymbol><ci id="S7.p1.5.m5.1.1.2.2.cmml" xref="S7.p1.5.m5.1.1.2.2">𝜆</ci><ci id="S7.p1.5.m5.1.1.2.3.cmml" xref="S7.p1.5.m5.1.1.2.3">𝐽</ci></apply><cn id="S7.p1.5.m5.1.1.3.cmml" type="float" xref="S7.p1.5.m5.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.5.m5.1c">\lambda_{J}=0.25</annotation><annotation encoding="application/x-llamapun" id="S7.p1.5.m5.1d">italic_λ start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT = 0.25</annotation></semantics></math>. In the grouping stage for ScaleProtoSeg, we also skip the warm-up step and run the joint training step for 10000 batch iterations with a learning of <math alttext="5e^{-5}" class="ltx_Math" display="inline" id="S7.p1.6.m6.1"><semantics id="S7.p1.6.m6.1a"><mrow id="S7.p1.6.m6.1.1" xref="S7.p1.6.m6.1.1.cmml"><mn id="S7.p1.6.m6.1.1.2" xref="S7.p1.6.m6.1.1.2.cmml">5</mn><mo id="S7.p1.6.m6.1.1.1" xref="S7.p1.6.m6.1.1.1.cmml">⁢</mo><msup id="S7.p1.6.m6.1.1.3" xref="S7.p1.6.m6.1.1.3.cmml"><mi id="S7.p1.6.m6.1.1.3.2" xref="S7.p1.6.m6.1.1.3.2.cmml">e</mi><mrow id="S7.p1.6.m6.1.1.3.3" xref="S7.p1.6.m6.1.1.3.3.cmml"><mo id="S7.p1.6.m6.1.1.3.3a" xref="S7.p1.6.m6.1.1.3.3.cmml">−</mo><mn id="S7.p1.6.m6.1.1.3.3.2" xref="S7.p1.6.m6.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.6.m6.1b"><apply id="S7.p1.6.m6.1.1.cmml" xref="S7.p1.6.m6.1.1"><times id="S7.p1.6.m6.1.1.1.cmml" xref="S7.p1.6.m6.1.1.1"></times><cn id="S7.p1.6.m6.1.1.2.cmml" type="integer" xref="S7.p1.6.m6.1.1.2">5</cn><apply id="S7.p1.6.m6.1.1.3.cmml" xref="S7.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S7.p1.6.m6.1.1.3.1.cmml" xref="S7.p1.6.m6.1.1.3">superscript</csymbol><ci id="S7.p1.6.m6.1.1.3.2.cmml" xref="S7.p1.6.m6.1.1.3.2">𝑒</ci><apply id="S7.p1.6.m6.1.1.3.3.cmml" xref="S7.p1.6.m6.1.1.3.3"><minus id="S7.p1.6.m6.1.1.3.3.1.cmml" xref="S7.p1.6.m6.1.1.3.3"></minus><cn id="S7.p1.6.m6.1.1.3.3.2.cmml" type="integer" xref="S7.p1.6.m6.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.6.m6.1c">5e^{-5}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.6.m6.1d">5 italic_e start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> following the same scheduler as in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S6" title="6 Details on experimental set-up ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a>. The weights of the loss terms during the grouping stage are set to <math alttext="\lambda_{L1}=1e^{-4}" class="ltx_Math" display="inline" id="S7.p1.7.m7.1"><semantics id="S7.p1.7.m7.1a"><mrow id="S7.p1.7.m7.1.1" xref="S7.p1.7.m7.1.1.cmml"><msub id="S7.p1.7.m7.1.1.2" xref="S7.p1.7.m7.1.1.2.cmml"><mi id="S7.p1.7.m7.1.1.2.2" xref="S7.p1.7.m7.1.1.2.2.cmml">λ</mi><mrow id="S7.p1.7.m7.1.1.2.3" xref="S7.p1.7.m7.1.1.2.3.cmml"><mi id="S7.p1.7.m7.1.1.2.3.2" xref="S7.p1.7.m7.1.1.2.3.2.cmml">L</mi><mo id="S7.p1.7.m7.1.1.2.3.1" xref="S7.p1.7.m7.1.1.2.3.1.cmml">⁢</mo><mn id="S7.p1.7.m7.1.1.2.3.3" xref="S7.p1.7.m7.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S7.p1.7.m7.1.1.1" xref="S7.p1.7.m7.1.1.1.cmml">=</mo><mrow id="S7.p1.7.m7.1.1.3" xref="S7.p1.7.m7.1.1.3.cmml"><mn id="S7.p1.7.m7.1.1.3.2" xref="S7.p1.7.m7.1.1.3.2.cmml">1</mn><mo id="S7.p1.7.m7.1.1.3.1" xref="S7.p1.7.m7.1.1.3.1.cmml">⁢</mo><msup id="S7.p1.7.m7.1.1.3.3" xref="S7.p1.7.m7.1.1.3.3.cmml"><mi id="S7.p1.7.m7.1.1.3.3.2" xref="S7.p1.7.m7.1.1.3.3.2.cmml">e</mi><mrow id="S7.p1.7.m7.1.1.3.3.3" xref="S7.p1.7.m7.1.1.3.3.3.cmml"><mo id="S7.p1.7.m7.1.1.3.3.3a" xref="S7.p1.7.m7.1.1.3.3.3.cmml">−</mo><mn id="S7.p1.7.m7.1.1.3.3.3.2" xref="S7.p1.7.m7.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.7.m7.1b"><apply id="S7.p1.7.m7.1.1.cmml" xref="S7.p1.7.m7.1.1"><eq id="S7.p1.7.m7.1.1.1.cmml" xref="S7.p1.7.m7.1.1.1"></eq><apply id="S7.p1.7.m7.1.1.2.cmml" xref="S7.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S7.p1.7.m7.1.1.2.1.cmml" xref="S7.p1.7.m7.1.1.2">subscript</csymbol><ci id="S7.p1.7.m7.1.1.2.2.cmml" xref="S7.p1.7.m7.1.1.2.2">𝜆</ci><apply id="S7.p1.7.m7.1.1.2.3.cmml" xref="S7.p1.7.m7.1.1.2.3"><times id="S7.p1.7.m7.1.1.2.3.1.cmml" xref="S7.p1.7.m7.1.1.2.3.1"></times><ci id="S7.p1.7.m7.1.1.2.3.2.cmml" xref="S7.p1.7.m7.1.1.2.3.2">𝐿</ci><cn id="S7.p1.7.m7.1.1.2.3.3.cmml" type="integer" xref="S7.p1.7.m7.1.1.2.3.3">1</cn></apply></apply><apply id="S7.p1.7.m7.1.1.3.cmml" xref="S7.p1.7.m7.1.1.3"><times id="S7.p1.7.m7.1.1.3.1.cmml" xref="S7.p1.7.m7.1.1.3.1"></times><cn id="S7.p1.7.m7.1.1.3.2.cmml" type="integer" xref="S7.p1.7.m7.1.1.3.2">1</cn><apply id="S7.p1.7.m7.1.1.3.3.cmml" xref="S7.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S7.p1.7.m7.1.1.3.3.1.cmml" xref="S7.p1.7.m7.1.1.3.3">superscript</csymbol><ci id="S7.p1.7.m7.1.1.3.3.2.cmml" xref="S7.p1.7.m7.1.1.3.3.2">𝑒</ci><apply id="S7.p1.7.m7.1.1.3.3.3.cmml" xref="S7.p1.7.m7.1.1.3.3.3"><minus id="S7.p1.7.m7.1.1.3.3.3.1.cmml" xref="S7.p1.7.m7.1.1.3.3.3"></minus><cn id="S7.p1.7.m7.1.1.3.3.3.2.cmml" type="integer" xref="S7.p1.7.m7.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.7.m7.1c">\lambda_{L1}=1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.7.m7.1d">italic_λ start_POSTSUBSCRIPT italic_L 1 end_POSTSUBSCRIPT = 1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{ent}=0.25" class="ltx_Math" display="inline" id="S7.p1.8.m8.1"><semantics id="S7.p1.8.m8.1a"><mrow id="S7.p1.8.m8.1.1" xref="S7.p1.8.m8.1.1.cmml"><msub id="S7.p1.8.m8.1.1.2" xref="S7.p1.8.m8.1.1.2.cmml"><mi id="S7.p1.8.m8.1.1.2.2" xref="S7.p1.8.m8.1.1.2.2.cmml">λ</mi><mrow id="S7.p1.8.m8.1.1.2.3" xref="S7.p1.8.m8.1.1.2.3.cmml"><mi id="S7.p1.8.m8.1.1.2.3.2" xref="S7.p1.8.m8.1.1.2.3.2.cmml">e</mi><mo id="S7.p1.8.m8.1.1.2.3.1" xref="S7.p1.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S7.p1.8.m8.1.1.2.3.3" xref="S7.p1.8.m8.1.1.2.3.3.cmml">n</mi><mo id="S7.p1.8.m8.1.1.2.3.1a" xref="S7.p1.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S7.p1.8.m8.1.1.2.3.4" xref="S7.p1.8.m8.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S7.p1.8.m8.1.1.1" xref="S7.p1.8.m8.1.1.1.cmml">=</mo><mn id="S7.p1.8.m8.1.1.3" xref="S7.p1.8.m8.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.8.m8.1b"><apply id="S7.p1.8.m8.1.1.cmml" xref="S7.p1.8.m8.1.1"><eq id="S7.p1.8.m8.1.1.1.cmml" xref="S7.p1.8.m8.1.1.1"></eq><apply id="S7.p1.8.m8.1.1.2.cmml" xref="S7.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S7.p1.8.m8.1.1.2.1.cmml" xref="S7.p1.8.m8.1.1.2">subscript</csymbol><ci id="S7.p1.8.m8.1.1.2.2.cmml" xref="S7.p1.8.m8.1.1.2.2">𝜆</ci><apply id="S7.p1.8.m8.1.1.2.3.cmml" xref="S7.p1.8.m8.1.1.2.3"><times id="S7.p1.8.m8.1.1.2.3.1.cmml" xref="S7.p1.8.m8.1.1.2.3.1"></times><ci id="S7.p1.8.m8.1.1.2.3.2.cmml" xref="S7.p1.8.m8.1.1.2.3.2">𝑒</ci><ci id="S7.p1.8.m8.1.1.2.3.3.cmml" xref="S7.p1.8.m8.1.1.2.3.3">𝑛</ci><ci id="S7.p1.8.m8.1.1.2.3.4.cmml" xref="S7.p1.8.m8.1.1.2.3.4">𝑡</ci></apply></apply><cn id="S7.p1.8.m8.1.1.3.cmml" type="float" xref="S7.p1.8.m8.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.8.m8.1c">\lambda_{ent}=0.25</annotation><annotation encoding="application/x-llamapun" id="S7.p1.8.m8.1d">italic_λ start_POSTSUBSCRIPT italic_e italic_n italic_t end_POSTSUBSCRIPT = 0.25</annotation></semantics></math>. The optimizer and augmentation pipeline used across all stages and methods is the same as in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S6" title="6 Details on experimental set-up ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a>. We report the mIoU in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S7.T5" title="Table 5 ‣ 7 Transferability of ScaleProtoSeg ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">5</span></a>. Results show that <span class="ltx_text ltx_font_italic" id="S7.p1.8.1">ScaleProtoSeg can transfer to another backbone and image modality</span>. Indeed, not only ScaleProtoSeg outperforms ProtoSeg in datasets with complex scenarios (CityScapes and ADE20K), but it also yields marginally better performance in the considered medical dataset despite the fact that the images do not present multi-scale features (similarly to the PASCAL VOC benchmark).</p>
</div>
<figure class="ltx_table" id="S7.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S7.T5.4" style="width:216.8pt;height:40.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-37.2pt,6.9pt) scale(0.744624152640389,0.744624152640389) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S7.T5.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T5.4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S7.T5.4.4.5.1.1"><span class="ltx_text ltx_font_bold" id="S7.T5.4.4.5.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T5.4.4.5.1.2"><span class="ltx_text ltx_font_bold" id="S7.T5.4.4.5.1.2.1">EM Split 1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T5.4.4.5.1.3"><span class="ltx_text ltx_font_bold" id="S7.T5.4.4.5.1.3.1">EM Split 2</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T5.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S7.T5.2.2.2.3">ProtoSeg (U-Net + ASPP)</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T5.1.1.1.1">77.63 <math alttext="\pm 0.29" class="ltx_Math" display="inline" id="S7.T5.1.1.1.1.m1.1"><semantics id="S7.T5.1.1.1.1.m1.1a"><mrow id="S7.T5.1.1.1.1.m1.1.1" xref="S7.T5.1.1.1.1.m1.1.1.cmml"><mo id="S7.T5.1.1.1.1.m1.1.1a" xref="S7.T5.1.1.1.1.m1.1.1.cmml">±</mo><mn id="S7.T5.1.1.1.1.m1.1.1.2" xref="S7.T5.1.1.1.1.m1.1.1.2.cmml">0.29</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.1.1.1.1.m1.1b"><apply id="S7.T5.1.1.1.1.m1.1.1.cmml" xref="S7.T5.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S7.T5.1.1.1.1.m1.1.1.1.cmml" xref="S7.T5.1.1.1.1.m1.1.1">plus-or-minus</csymbol><cn id="S7.T5.1.1.1.1.m1.1.1.2.cmml" type="float" xref="S7.T5.1.1.1.1.m1.1.1.2">0.29</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.1.1.1.1.m1.1c">\pm 0.29</annotation><annotation encoding="application/x-llamapun" id="S7.T5.1.1.1.1.m1.1d">± 0.29</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T5.2.2.2.2">78.92 <math alttext="\pm 0.19" class="ltx_Math" display="inline" id="S7.T5.2.2.2.2.m1.1"><semantics id="S7.T5.2.2.2.2.m1.1a"><mrow id="S7.T5.2.2.2.2.m1.1.1" xref="S7.T5.2.2.2.2.m1.1.1.cmml"><mo id="S7.T5.2.2.2.2.m1.1.1a" xref="S7.T5.2.2.2.2.m1.1.1.cmml">±</mo><mn id="S7.T5.2.2.2.2.m1.1.1.2" xref="S7.T5.2.2.2.2.m1.1.1.2.cmml">0.19</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.2.2.2.2.m1.1b"><apply id="S7.T5.2.2.2.2.m1.1.1.cmml" xref="S7.T5.2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S7.T5.2.2.2.2.m1.1.1.1.cmml" xref="S7.T5.2.2.2.2.m1.1.1">plus-or-minus</csymbol><cn id="S7.T5.2.2.2.2.m1.1.1.2.cmml" type="float" xref="S7.T5.2.2.2.2.m1.1.1.2">0.19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.2.2.2.2.m1.1c">\pm 0.19</annotation><annotation encoding="application/x-llamapun" id="S7.T5.2.2.2.2.m1.1d">± 0.19</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S7.T5.4.4.4.3">ScaleProtoSeg (U-Net + ASPP)</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S7.T5.3.3.3.1">
<span class="ltx_text ltx_font_bold" id="S7.T5.3.3.3.1.1">77.97</span> <math alttext="\pm 0.16" class="ltx_Math" display="inline" id="S7.T5.3.3.3.1.m1.1"><semantics id="S7.T5.3.3.3.1.m1.1a"><mrow id="S7.T5.3.3.3.1.m1.1.1" xref="S7.T5.3.3.3.1.m1.1.1.cmml"><mo id="S7.T5.3.3.3.1.m1.1.1a" xref="S7.T5.3.3.3.1.m1.1.1.cmml">±</mo><mn id="S7.T5.3.3.3.1.m1.1.1.2" xref="S7.T5.3.3.3.1.m1.1.1.2.cmml">0.16</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.3.3.3.1.m1.1b"><apply id="S7.T5.3.3.3.1.m1.1.1.cmml" xref="S7.T5.3.3.3.1.m1.1.1"><csymbol cd="latexml" id="S7.T5.3.3.3.1.m1.1.1.1.cmml" xref="S7.T5.3.3.3.1.m1.1.1">plus-or-minus</csymbol><cn id="S7.T5.3.3.3.1.m1.1.1.2.cmml" type="float" xref="S7.T5.3.3.3.1.m1.1.1.2">0.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.3.3.3.1.m1.1c">\pm 0.16</annotation><annotation encoding="application/x-llamapun" id="S7.T5.3.3.3.1.m1.1d">± 0.16</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S7.T5.4.4.4.2">
<span class="ltx_text ltx_font_bold" id="S7.T5.4.4.4.2.1">79.29</span> <math alttext="\pm 0.17" class="ltx_Math" display="inline" id="S7.T5.4.4.4.2.m1.1"><semantics id="S7.T5.4.4.4.2.m1.1a"><mrow id="S7.T5.4.4.4.2.m1.1.1" xref="S7.T5.4.4.4.2.m1.1.1.cmml"><mo id="S7.T5.4.4.4.2.m1.1.1a" xref="S7.T5.4.4.4.2.m1.1.1.cmml">±</mo><mn id="S7.T5.4.4.4.2.m1.1.1.2" xref="S7.T5.4.4.4.2.m1.1.1.2.cmml">0.17</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.4.4.4.2.m1.1b"><apply id="S7.T5.4.4.4.2.m1.1.1.cmml" xref="S7.T5.4.4.4.2.m1.1.1"><csymbol cd="latexml" id="S7.T5.4.4.4.2.m1.1.1.1.cmml" xref="S7.T5.4.4.4.2.m1.1.1">plus-or-minus</csymbol><cn id="S7.T5.4.4.4.2.m1.1.1.2.cmml" type="float" xref="S7.T5.4.4.4.2.m1.1.1.2">0.17</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.4.4.4.2.m1.1c">\pm 0.17</annotation><annotation encoding="application/x-llamapun" id="S7.T5.4.4.4.2.m1.1d">± 0.17</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T5.6.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S7.T5.7.2" style="font-size:90%;">IoU performance of ScaleProtoSeg compared against ProtoSeg. Results demonstrate the effective transferability of ScaleProtoSeg to another segmentation architecture (U-Net) and the medical domain (ISBI 2012 dataset) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib4" title="">4</a>]</cite>.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Extension to large dataset</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.2">In order to test our method in a use case close to real-world applications we extend our evaluation to a large benchmark: COCO-Stuff <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib7" title="">7</a>]</cite>, containing 182 classes with 118k training and 5k validation samples. We leverage a similar setup to ADE20K for the model hyperparameters, except that in the multi-scale prototype training stage, we iterate for a total of 110k iterations: 6k warm-up steps, 100k joint steps, and 4k finetuning steps. Moreover, the iterations are done directly on a batch of size 10. We also use multi-scale inputs with scales <math alttext="\{0.5,0.75,1\}" class="ltx_Math" display="inline" id="S8.p1.1.m1.3"><semantics id="S8.p1.1.m1.3a"><mrow id="S8.p1.1.m1.3.4.2" xref="S8.p1.1.m1.3.4.1.cmml"><mo id="S8.p1.1.m1.3.4.2.1" stretchy="false" xref="S8.p1.1.m1.3.4.1.cmml">{</mo><mn id="S8.p1.1.m1.1.1" xref="S8.p1.1.m1.1.1.cmml">0.5</mn><mo id="S8.p1.1.m1.3.4.2.2" xref="S8.p1.1.m1.3.4.1.cmml">,</mo><mn id="S8.p1.1.m1.2.2" xref="S8.p1.1.m1.2.2.cmml">0.75</mn><mo id="S8.p1.1.m1.3.4.2.3" xref="S8.p1.1.m1.3.4.1.cmml">,</mo><mn id="S8.p1.1.m1.3.3" xref="S8.p1.1.m1.3.3.cmml">1</mn><mo id="S8.p1.1.m1.3.4.2.4" stretchy="false" xref="S8.p1.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.p1.1.m1.3b"><set id="S8.p1.1.m1.3.4.1.cmml" xref="S8.p1.1.m1.3.4.2"><cn id="S8.p1.1.m1.1.1.cmml" type="float" xref="S8.p1.1.m1.1.1">0.5</cn><cn id="S8.p1.1.m1.2.2.cmml" type="float" xref="S8.p1.1.m1.2.2">0.75</cn><cn id="S8.p1.1.m1.3.3.cmml" type="integer" xref="S8.p1.1.m1.3.3">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.1.m1.3c">\{0.5,0.75,1\}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.1.m1.3d">{ 0.5 , 0.75 , 1 }</annotation></semantics></math> and a training resolution of <math alttext="321\times 321" class="ltx_Math" display="inline" id="S8.p1.2.m2.1"><semantics id="S8.p1.2.m2.1a"><mrow id="S8.p1.2.m2.1.1" xref="S8.p1.2.m2.1.1.cmml"><mn id="S8.p1.2.m2.1.1.2" xref="S8.p1.2.m2.1.1.2.cmml">321</mn><mo id="S8.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S8.p1.2.m2.1.1.1.cmml">×</mo><mn id="S8.p1.2.m2.1.1.3" xref="S8.p1.2.m2.1.1.3.cmml">321</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.p1.2.m2.1b"><apply id="S8.p1.2.m2.1.1.cmml" xref="S8.p1.2.m2.1.1"><times id="S8.p1.2.m2.1.1.1.cmml" xref="S8.p1.2.m2.1.1.1"></times><cn id="S8.p1.2.m2.1.1.2.cmml" type="integer" xref="S8.p1.2.m2.1.1.2">321</cn><cn id="S8.p1.2.m2.1.1.3.cmml" type="integer" xref="S8.p1.2.m2.1.1.3">321</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.2.m2.1c">321\times 321</annotation><annotation encoding="application/x-llamapun" id="S8.p1.2.m2.1d">321 × 321</annotation></semantics></math>, while testing at the native resolution. The objective is to align to the set-up for the DeepLabv2 baseline provided at this repository: <a class="ltx_ref ltx_href" href="https://github.com/kazuto1011/deeplab-pytorch" title="">github.com/kazuto1011/deeplab-pytorch</a>. The results for our method: ScaleProtoSeg are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S8.T6" title="Table 6 ‣ 8 Extension to large dataset ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a>, and showcase that our method despite lower performance stays competitive with DeepLabv2 on a larger dataset while providing interpretability. Moreover, ProtoSeg trained in a similar set-up has a performance of 32.97 mIoU without pruning for one run, and so ScaleProtoSeg slightly outperforms it.</p>
</div>
<figure class="ltx_table" id="S8.T6">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T6.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S8.T6.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S8.T6.1.2.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S8.T6.1.2.1.2">
<table class="ltx_tabular ltx_align_middle" id="S8.T6.1.2.1.2.1">
<tr class="ltx_tr" id="S8.T6.1.2.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S8.T6.1.2.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S8.T6.1.2.1.2.1.1.1.1">COCO-Stuff</span></td>
</tr>
<tr class="ltx_tr" id="S8.T6.1.2.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S8.T6.1.2.1.2.1.2.1"><span class="ltx_text ltx_font_bold" id="S8.T6.1.2.1.2.1.2.1.1">mIoU</span></td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T6.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S8.T6.1.3.1.1">DeepLabv2</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S8.T6.1.3.1.2">39.7</td>
</tr>
<tr class="ltx_tr" id="S8.T6.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S8.T6.1.1.2">ScaleProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S8.T6.1.1.1">34.50 <math alttext="\pm 0.19" class="ltx_Math" display="inline" id="S8.T6.1.1.1.m1.1"><semantics id="S8.T6.1.1.1.m1.1a"><mrow id="S8.T6.1.1.1.m1.1.1" xref="S8.T6.1.1.1.m1.1.1.cmml"><mo id="S8.T6.1.1.1.m1.1.1a" xref="S8.T6.1.1.1.m1.1.1.cmml">±</mo><mn id="S8.T6.1.1.1.m1.1.1.2" xref="S8.T6.1.1.1.m1.1.1.2.cmml">0.19</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T6.1.1.1.m1.1b"><apply id="S8.T6.1.1.1.m1.1.1.cmml" xref="S8.T6.1.1.1.m1.1.1"><csymbol cd="latexml" id="S8.T6.1.1.1.m1.1.1.1.cmml" xref="S8.T6.1.1.1.m1.1.1">plus-or-minus</csymbol><cn id="S8.T6.1.1.1.m1.1.1.2.cmml" type="float" xref="S8.T6.1.1.1.m1.1.1.2">0.19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T6.1.1.1.m1.1c">\pm 0.19</annotation><annotation encoding="application/x-llamapun" id="S8.T6.1.1.1.m1.1d">± 0.19</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S8.T6.3.1.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="S8.T6.4.2" style="font-size:90%;">ScaleProtoSeg mIoU performance on COCO-Stuff validation set. We report the results over 3 runs for our method.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S9">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Sparsity Regularization</h2>
<div class="ltx_para" id="S9.p1">
<p class="ltx_p" id="S9.p1.7">In the grouping mechanism, it is also possible to control for the sparsity-performance trade-off via the thresholding of the grouping weights in the matrices <math alttext="\mathbf{w}_{g,c}" class="ltx_Math" display="inline" id="S9.p1.1.m1.2"><semantics id="S9.p1.1.m1.2a"><msub id="S9.p1.1.m1.2.3" xref="S9.p1.1.m1.2.3.cmml"><mi id="S9.p1.1.m1.2.3.2" xref="S9.p1.1.m1.2.3.2.cmml">𝐰</mi><mrow id="S9.p1.1.m1.2.2.2.4" xref="S9.p1.1.m1.2.2.2.3.cmml"><mi id="S9.p1.1.m1.1.1.1.1" xref="S9.p1.1.m1.1.1.1.1.cmml">g</mi><mo id="S9.p1.1.m1.2.2.2.4.1" xref="S9.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S9.p1.1.m1.2.2.2.2" xref="S9.p1.1.m1.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S9.p1.1.m1.2b"><apply id="S9.p1.1.m1.2.3.cmml" xref="S9.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S9.p1.1.m1.2.3.1.cmml" xref="S9.p1.1.m1.2.3">subscript</csymbol><ci id="S9.p1.1.m1.2.3.2.cmml" xref="S9.p1.1.m1.2.3.2">𝐰</ci><list id="S9.p1.1.m1.2.2.2.3.cmml" xref="S9.p1.1.m1.2.2.2.4"><ci id="S9.p1.1.m1.1.1.1.1.cmml" xref="S9.p1.1.m1.1.1.1.1">𝑔</ci><ci id="S9.p1.1.m1.2.2.2.2.cmml" xref="S9.p1.1.m1.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.1.m1.2c">\mathbf{w}_{g,c}</annotation><annotation encoding="application/x-llamapun" id="S9.p1.1.m1.2d">bold_w start_POSTSUBSCRIPT italic_g , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> defined in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS2" title="3.2 Prototype grouping ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.2</span></a>. This is demonstrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S9.T7" title="Table 7 ‣ 9 Sparsity Regularization ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">7</span></a>. The best results are obtained for threshold <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S9.p1.2.m2.1"><semantics id="S9.p1.2.m2.1a"><mrow id="S9.p1.2.m2.1.1" xref="S9.p1.2.m2.1.1.cmml"><mi id="S9.p1.2.m2.1.1.2" xref="S9.p1.2.m2.1.1.2.cmml">α</mi><mo id="S9.p1.2.m2.1.1.1" xref="S9.p1.2.m2.1.1.1.cmml">=</mo><mn id="S9.p1.2.m2.1.1.3" xref="S9.p1.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.p1.2.m2.1b"><apply id="S9.p1.2.m2.1.1.cmml" xref="S9.p1.2.m2.1.1"><eq id="S9.p1.2.m2.1.1.1.cmml" xref="S9.p1.2.m2.1.1.1"></eq><ci id="S9.p1.2.m2.1.1.2.cmml" xref="S9.p1.2.m2.1.1.2">𝛼</ci><cn id="S9.p1.2.m2.1.1.3.cmml" type="float" xref="S9.p1.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.2.m2.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.p1.2.m2.1d">italic_α = 0.05</annotation></semantics></math> on all datasets. At this threshold, the groups are sparse with an average of <math alttext="3.70" class="ltx_Math" display="inline" id="S9.p1.3.m3.1"><semantics id="S9.p1.3.m3.1a"><mn id="S9.p1.3.m3.1.1" xref="S9.p1.3.m3.1.1.cmml">3.70</mn><annotation-xml encoding="MathML-Content" id="S9.p1.3.m3.1b"><cn id="S9.p1.3.m3.1.1.cmml" type="float" xref="S9.p1.3.m3.1.1">3.70</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.3.m3.1c">3.70</annotation><annotation encoding="application/x-llamapun" id="S9.p1.3.m3.1d">3.70</annotation></semantics></math>, <math alttext="3.39" class="ltx_Math" display="inline" id="S9.p1.4.m4.1"><semantics id="S9.p1.4.m4.1a"><mn id="S9.p1.4.m4.1.1" xref="S9.p1.4.m4.1.1.cmml">3.39</mn><annotation-xml encoding="MathML-Content" id="S9.p1.4.m4.1b"><cn id="S9.p1.4.m4.1.1.cmml" type="float" xref="S9.p1.4.m4.1.1">3.39</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.4.m4.1c">3.39</annotation><annotation encoding="application/x-llamapun" id="S9.p1.4.m4.1d">3.39</annotation></semantics></math>, and <math alttext="4.08" class="ltx_Math" display="inline" id="S9.p1.5.m5.1"><semantics id="S9.p1.5.m5.1a"><mn id="S9.p1.5.m5.1.1" xref="S9.p1.5.m5.1.1.cmml">4.08</mn><annotation-xml encoding="MathML-Content" id="S9.p1.5.m5.1b"><cn id="S9.p1.5.m5.1.1.cmml" type="float" xref="S9.p1.5.m5.1.1">4.08</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.5.m5.1c">4.08</annotation><annotation encoding="application/x-llamapun" id="S9.p1.5.m5.1d">4.08</annotation></semantics></math> active prototypes per group for Pascal, Cityscapes, and ADE20K, which leads to better interpretability performance for the sparsity metric compared to ProtoSeg.
Moreover, we analyze the effect of the entropy regularization on the grouping mechanism as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S9.T8" title="Table 8 ‣ 9 Sparsity Regularization ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">8</span></a>. This regularization enables our method to use fewer prototypes in total and per group while providing similar performance, with up to <math alttext="20" class="ltx_Math" display="inline" id="S9.p1.6.m6.1"><semantics id="S9.p1.6.m6.1a"><mn id="S9.p1.6.m6.1.1" xref="S9.p1.6.m6.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S9.p1.6.m6.1b"><cn id="S9.p1.6.m6.1.1.cmml" type="integer" xref="S9.p1.6.m6.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.6.m6.1c">20</annotation><annotation encoding="application/x-llamapun" id="S9.p1.6.m6.1d">20</annotation></semantics></math> total prototypes dropped and <math alttext="2.5" class="ltx_Math" display="inline" id="S9.p1.7.m7.1"><semantics id="S9.p1.7.m7.1a"><mn id="S9.p1.7.m7.1.1" xref="S9.p1.7.m7.1.1.cmml">2.5</mn><annotation-xml encoding="MathML-Content" id="S9.p1.7.m7.1b"><cn id="S9.p1.7.m7.1.1.cmml" type="float" xref="S9.p1.7.m7.1.1">2.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.7.m7.1c">2.5</annotation><annotation encoding="application/x-llamapun" id="S9.p1.7.m7.1d">2.5</annotation></semantics></math> prototypes per group less for Cityscapes.</p>
</div>
<figure class="ltx_table" id="S9.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S9.T7.9" style="width:216.8pt;height:141.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-29.1pt,19.0pt) scale(0.788518209350678,0.788518209350678) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S9.T7.9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S9.T7.9.9.10.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S9.T7.9.9.10.1.1"><span class="ltx_text ltx_font_bold" id="S9.T7.9.9.10.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T7.9.9.10.1.2"><span class="ltx_text ltx_font_bold" id="S9.T7.9.9.10.1.2.1">Threshold</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T7.9.9.10.1.3"><span class="ltx_text ltx_font_bold" id="S9.T7.9.9.10.1.3.1">Prototypes</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T7.9.9.10.1.4"><span class="ltx_text ltx_font_bold" id="S9.T7.9.9.10.1.4.1">Group Avg</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T7.9.9.10.1.5"><span class="ltx_text ltx_font_bold" id="S9.T7.9.9.10.1.5.1">mIoU</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S9.T7.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S9.T7.1.1.1.2" rowspan="3"><span class="ltx_text" id="S9.T7.1.1.1.2.1">Pascal</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.1.1.1.1"><math alttext="\alpha=0." class="ltx_Math" display="inline" id="S9.T7.1.1.1.1.m1.1"><semantics id="S9.T7.1.1.1.1.m1.1a"><mrow id="S9.T7.1.1.1.1.m1.1.1.1" xref="S9.T7.1.1.1.1.m1.1.1.1.1.cmml"><mrow id="S9.T7.1.1.1.1.m1.1.1.1.1" xref="S9.T7.1.1.1.1.m1.1.1.1.1.cmml"><mi id="S9.T7.1.1.1.1.m1.1.1.1.1.2" xref="S9.T7.1.1.1.1.m1.1.1.1.1.2.cmml">α</mi><mo id="S9.T7.1.1.1.1.m1.1.1.1.1.1" xref="S9.T7.1.1.1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S9.T7.1.1.1.1.m1.1.1.1.1.3" xref="S9.T7.1.1.1.1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S9.T7.1.1.1.1.m1.1.1.1.2" lspace="0em" xref="S9.T7.1.1.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.1.1.1.1.m1.1b"><apply id="S9.T7.1.1.1.1.m1.1.1.1.1.cmml" xref="S9.T7.1.1.1.1.m1.1.1.1"><eq id="S9.T7.1.1.1.1.m1.1.1.1.1.1.cmml" xref="S9.T7.1.1.1.1.m1.1.1.1.1.1"></eq><ci id="S9.T7.1.1.1.1.m1.1.1.1.1.2.cmml" xref="S9.T7.1.1.1.1.m1.1.1.1.1.2">𝛼</ci><cn id="S9.T7.1.1.1.1.m1.1.1.1.1.3.cmml" type="integer" xref="S9.T7.1.1.1.1.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.1.1.1.1.m1.1c">\alpha=0.</annotation><annotation encoding="application/x-llamapun" id="S9.T7.1.1.1.1.m1.1d">italic_α = 0 .</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.1.1.1.3">133</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.1.1.1.4">4.00</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.1.1.1.5">72.11</td>
</tr>
<tr class="ltx_tr" id="S9.T7.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.2.2.2.1"><math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S9.T7.2.2.2.1.m1.1"><semantics id="S9.T7.2.2.2.1.m1.1a"><mrow id="S9.T7.2.2.2.1.m1.1.1" xref="S9.T7.2.2.2.1.m1.1.1.cmml"><mi id="S9.T7.2.2.2.1.m1.1.1.2" xref="S9.T7.2.2.2.1.m1.1.1.2.cmml">α</mi><mo id="S9.T7.2.2.2.1.m1.1.1.1" xref="S9.T7.2.2.2.1.m1.1.1.1.cmml">=</mo><mn id="S9.T7.2.2.2.1.m1.1.1.3" xref="S9.T7.2.2.2.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.2.2.2.1.m1.1b"><apply id="S9.T7.2.2.2.1.m1.1.1.cmml" xref="S9.T7.2.2.2.1.m1.1.1"><eq id="S9.T7.2.2.2.1.m1.1.1.1.cmml" xref="S9.T7.2.2.2.1.m1.1.1.1"></eq><ci id="S9.T7.2.2.2.1.m1.1.1.2.cmml" xref="S9.T7.2.2.2.1.m1.1.1.2">𝛼</ci><cn id="S9.T7.2.2.2.1.m1.1.1.3.cmml" type="float" xref="S9.T7.2.2.2.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.2.2.2.1.m1.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.T7.2.2.2.1.m1.1d">italic_α = 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.2.2.2.2">131</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.2.2.2.3">3.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.2.2.2.4"><span class="ltx_text ltx_font_bold" id="S9.T7.2.2.2.4.1">72.26</span></td>
</tr>
<tr class="ltx_tr" id="S9.T7.3.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.3.3.3.1"><math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S9.T7.3.3.3.1.m1.1"><semantics id="S9.T7.3.3.3.1.m1.1a"><mrow id="S9.T7.3.3.3.1.m1.1.1" xref="S9.T7.3.3.3.1.m1.1.1.cmml"><mi id="S9.T7.3.3.3.1.m1.1.1.2" xref="S9.T7.3.3.3.1.m1.1.1.2.cmml">α</mi><mo id="S9.T7.3.3.3.1.m1.1.1.1" xref="S9.T7.3.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S9.T7.3.3.3.1.m1.1.1.3" xref="S9.T7.3.3.3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.3.3.3.1.m1.1b"><apply id="S9.T7.3.3.3.1.m1.1.1.cmml" xref="S9.T7.3.3.3.1.m1.1.1"><eq id="S9.T7.3.3.3.1.m1.1.1.1.cmml" xref="S9.T7.3.3.3.1.m1.1.1.1"></eq><ci id="S9.T7.3.3.3.1.m1.1.1.2.cmml" xref="S9.T7.3.3.3.1.m1.1.1.2">𝛼</ci><cn id="S9.T7.3.3.3.1.m1.1.1.3.cmml" type="float" xref="S9.T7.3.3.3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.3.3.3.1.m1.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S9.T7.3.3.3.1.m1.1d">italic_α = 0.1</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.3.3.3.2"><span class="ltx_text ltx_font_bold" id="S9.T7.3.3.3.2.1">126</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.3.3.3.3"><span class="ltx_text ltx_font_bold" id="S9.T7.3.3.3.3.1">3.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.3.3.3.4">72.12</td>
</tr>
<tr class="ltx_tr" id="S9.T7.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S9.T7.4.4.4.2" rowspan="3"><span class="ltx_text" id="S9.T7.4.4.4.2.1">Cityscapes</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.4.4.4.1"><math alttext="\alpha=0." class="ltx_Math" display="inline" id="S9.T7.4.4.4.1.m1.1"><semantics id="S9.T7.4.4.4.1.m1.1a"><mrow id="S9.T7.4.4.4.1.m1.1.1.1" xref="S9.T7.4.4.4.1.m1.1.1.1.1.cmml"><mrow id="S9.T7.4.4.4.1.m1.1.1.1.1" xref="S9.T7.4.4.4.1.m1.1.1.1.1.cmml"><mi id="S9.T7.4.4.4.1.m1.1.1.1.1.2" xref="S9.T7.4.4.4.1.m1.1.1.1.1.2.cmml">α</mi><mo id="S9.T7.4.4.4.1.m1.1.1.1.1.1" xref="S9.T7.4.4.4.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S9.T7.4.4.4.1.m1.1.1.1.1.3" xref="S9.T7.4.4.4.1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S9.T7.4.4.4.1.m1.1.1.1.2" lspace="0em" xref="S9.T7.4.4.4.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.4.4.4.1.m1.1b"><apply id="S9.T7.4.4.4.1.m1.1.1.1.1.cmml" xref="S9.T7.4.4.4.1.m1.1.1.1"><eq id="S9.T7.4.4.4.1.m1.1.1.1.1.1.cmml" xref="S9.T7.4.4.4.1.m1.1.1.1.1.1"></eq><ci id="S9.T7.4.4.4.1.m1.1.1.1.1.2.cmml" xref="S9.T7.4.4.4.1.m1.1.1.1.1.2">𝛼</ci><cn id="S9.T7.4.4.4.1.m1.1.1.1.1.3.cmml" type="integer" xref="S9.T7.4.4.4.1.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.4.4.4.1.m1.1c">\alpha=0.</annotation><annotation encoding="application/x-llamapun" id="S9.T7.4.4.4.1.m1.1d">italic_α = 0 .</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.4.4.4.3">114</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.4.4.4.4">3.68</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.4.4.4.5">69.20</td>
</tr>
<tr class="ltx_tr" id="S9.T7.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.5.5.5.1"><math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S9.T7.5.5.5.1.m1.1"><semantics id="S9.T7.5.5.5.1.m1.1a"><mrow id="S9.T7.5.5.5.1.m1.1.1" xref="S9.T7.5.5.5.1.m1.1.1.cmml"><mi id="S9.T7.5.5.5.1.m1.1.1.2" xref="S9.T7.5.5.5.1.m1.1.1.2.cmml">α</mi><mo id="S9.T7.5.5.5.1.m1.1.1.1" xref="S9.T7.5.5.5.1.m1.1.1.1.cmml">=</mo><mn id="S9.T7.5.5.5.1.m1.1.1.3" xref="S9.T7.5.5.5.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.5.5.5.1.m1.1b"><apply id="S9.T7.5.5.5.1.m1.1.1.cmml" xref="S9.T7.5.5.5.1.m1.1.1"><eq id="S9.T7.5.5.5.1.m1.1.1.1.cmml" xref="S9.T7.5.5.5.1.m1.1.1.1"></eq><ci id="S9.T7.5.5.5.1.m1.1.1.2.cmml" xref="S9.T7.5.5.5.1.m1.1.1.2">𝛼</ci><cn id="S9.T7.5.5.5.1.m1.1.1.3.cmml" type="float" xref="S9.T7.5.5.5.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.5.5.5.1.m1.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.T7.5.5.5.1.m1.1d">italic_α = 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.5.5.5.2">111</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.5.5.5.3">3.39</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.5.5.5.4"><span class="ltx_text ltx_font_bold" id="S9.T7.5.5.5.4.1">69.22</span></td>
</tr>
<tr class="ltx_tr" id="S9.T7.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.6.6.6.1"><math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S9.T7.6.6.6.1.m1.1"><semantics id="S9.T7.6.6.6.1.m1.1a"><mrow id="S9.T7.6.6.6.1.m1.1.1" xref="S9.T7.6.6.6.1.m1.1.1.cmml"><mi id="S9.T7.6.6.6.1.m1.1.1.2" xref="S9.T7.6.6.6.1.m1.1.1.2.cmml">α</mi><mo id="S9.T7.6.6.6.1.m1.1.1.1" xref="S9.T7.6.6.6.1.m1.1.1.1.cmml">=</mo><mn id="S9.T7.6.6.6.1.m1.1.1.3" xref="S9.T7.6.6.6.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.6.6.6.1.m1.1b"><apply id="S9.T7.6.6.6.1.m1.1.1.cmml" xref="S9.T7.6.6.6.1.m1.1.1"><eq id="S9.T7.6.6.6.1.m1.1.1.1.cmml" xref="S9.T7.6.6.6.1.m1.1.1.1"></eq><ci id="S9.T7.6.6.6.1.m1.1.1.2.cmml" xref="S9.T7.6.6.6.1.m1.1.1.2">𝛼</ci><cn id="S9.T7.6.6.6.1.m1.1.1.3.cmml" type="float" xref="S9.T7.6.6.6.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.6.6.6.1.m1.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S9.T7.6.6.6.1.m1.1d">italic_α = 0.1</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.6.6.6.2"><span class="ltx_text ltx_font_bold" id="S9.T7.6.6.6.2.1">109</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.6.6.6.3"><span class="ltx_text ltx_font_bold" id="S9.T7.6.6.6.3.1">3.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.6.6.6.4">69.03</td>
</tr>
<tr class="ltx_tr" id="S9.T7.7.7.7">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S9.T7.7.7.7.2" rowspan="3"><span class="ltx_text" id="S9.T7.7.7.7.2.1">ADE20K</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.7.7.7.1"><math alttext="\alpha=0." class="ltx_Math" display="inline" id="S9.T7.7.7.7.1.m1.1"><semantics id="S9.T7.7.7.7.1.m1.1a"><mrow id="S9.T7.7.7.7.1.m1.1.1.1" xref="S9.T7.7.7.7.1.m1.1.1.1.1.cmml"><mrow id="S9.T7.7.7.7.1.m1.1.1.1.1" xref="S9.T7.7.7.7.1.m1.1.1.1.1.cmml"><mi id="S9.T7.7.7.7.1.m1.1.1.1.1.2" xref="S9.T7.7.7.7.1.m1.1.1.1.1.2.cmml">α</mi><mo id="S9.T7.7.7.7.1.m1.1.1.1.1.1" xref="S9.T7.7.7.7.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S9.T7.7.7.7.1.m1.1.1.1.1.3" xref="S9.T7.7.7.7.1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S9.T7.7.7.7.1.m1.1.1.1.2" lspace="0em" xref="S9.T7.7.7.7.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.7.7.7.1.m1.1b"><apply id="S9.T7.7.7.7.1.m1.1.1.1.1.cmml" xref="S9.T7.7.7.7.1.m1.1.1.1"><eq id="S9.T7.7.7.7.1.m1.1.1.1.1.1.cmml" xref="S9.T7.7.7.7.1.m1.1.1.1.1.1"></eq><ci id="S9.T7.7.7.7.1.m1.1.1.1.1.2.cmml" xref="S9.T7.7.7.7.1.m1.1.1.1.1.2">𝛼</ci><cn id="S9.T7.7.7.7.1.m1.1.1.1.1.3.cmml" type="integer" xref="S9.T7.7.7.7.1.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.7.7.7.1.m1.1c">\alpha=0.</annotation><annotation encoding="application/x-llamapun" id="S9.T7.7.7.7.1.m1.1d">italic_α = 0 .</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.7.7.7.3">1168</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.7.7.7.4">4.53</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T7.7.7.7.5">34.03</td>
</tr>
<tr class="ltx_tr" id="S9.T7.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.8.8.8.1"><math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S9.T7.8.8.8.1.m1.1"><semantics id="S9.T7.8.8.8.1.m1.1a"><mrow id="S9.T7.8.8.8.1.m1.1.1" xref="S9.T7.8.8.8.1.m1.1.1.cmml"><mi id="S9.T7.8.8.8.1.m1.1.1.2" xref="S9.T7.8.8.8.1.m1.1.1.2.cmml">α</mi><mo id="S9.T7.8.8.8.1.m1.1.1.1" xref="S9.T7.8.8.8.1.m1.1.1.1.cmml">=</mo><mn id="S9.T7.8.8.8.1.m1.1.1.3" xref="S9.T7.8.8.8.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.8.8.8.1.m1.1b"><apply id="S9.T7.8.8.8.1.m1.1.1.cmml" xref="S9.T7.8.8.8.1.m1.1.1"><eq id="S9.T7.8.8.8.1.m1.1.1.1.cmml" xref="S9.T7.8.8.8.1.m1.1.1.1"></eq><ci id="S9.T7.8.8.8.1.m1.1.1.2.cmml" xref="S9.T7.8.8.8.1.m1.1.1.2">𝛼</ci><cn id="S9.T7.8.8.8.1.m1.1.1.3.cmml" type="float" xref="S9.T7.8.8.8.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.8.8.8.1.m1.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.T7.8.8.8.1.m1.1d">italic_α = 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.8.8.8.2">1132</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.8.8.8.3">4.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T7.8.8.8.4"><span class="ltx_text ltx_font_bold" id="S9.T7.8.8.8.4.1">34.32</span></td>
</tr>
<tr class="ltx_tr" id="S9.T7.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T7.9.9.9.1"><math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S9.T7.9.9.9.1.m1.1"><semantics id="S9.T7.9.9.9.1.m1.1a"><mrow id="S9.T7.9.9.9.1.m1.1.1" xref="S9.T7.9.9.9.1.m1.1.1.cmml"><mi id="S9.T7.9.9.9.1.m1.1.1.2" xref="S9.T7.9.9.9.1.m1.1.1.2.cmml">α</mi><mo id="S9.T7.9.9.9.1.m1.1.1.1" xref="S9.T7.9.9.9.1.m1.1.1.1.cmml">=</mo><mn id="S9.T7.9.9.9.1.m1.1.1.3" xref="S9.T7.9.9.9.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.9.9.9.1.m1.1b"><apply id="S9.T7.9.9.9.1.m1.1.1.cmml" xref="S9.T7.9.9.9.1.m1.1.1"><eq id="S9.T7.9.9.9.1.m1.1.1.1.cmml" xref="S9.T7.9.9.9.1.m1.1.1.1"></eq><ci id="S9.T7.9.9.9.1.m1.1.1.2.cmml" xref="S9.T7.9.9.9.1.m1.1.1.2">𝛼</ci><cn id="S9.T7.9.9.9.1.m1.1.1.3.cmml" type="float" xref="S9.T7.9.9.9.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.9.9.9.1.m1.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S9.T7.9.9.9.1.m1.1d">italic_α = 0.1</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T7.9.9.9.2"><span class="ltx_text ltx_font_bold" id="S9.T7.9.9.9.2.1">1067</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T7.9.9.9.3"><span class="ltx_text ltx_font_bold" id="S9.T7.9.9.9.3.1">3.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T7.9.9.9.4">34.16</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S9.T7.13.2.1" style="font-size:90%;">Table 7</span>: </span><span class="ltx_text" id="S9.T7.11.1" style="font-size:90%;">Ablation study of the effect of thresholding on the grouping mechanism with <math alttext="\lambda_{\text{ent}}=0.05" class="ltx_Math" display="inline" id="S9.T7.11.1.m1.1"><semantics id="S9.T7.11.1.m1.1b"><mrow id="S9.T7.11.1.m1.1.1" xref="S9.T7.11.1.m1.1.1.cmml"><msub id="S9.T7.11.1.m1.1.1.2" xref="S9.T7.11.1.m1.1.1.2.cmml"><mi id="S9.T7.11.1.m1.1.1.2.2" xref="S9.T7.11.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S9.T7.11.1.m1.1.1.2.3" xref="S9.T7.11.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S9.T7.11.1.m1.1.1.1" xref="S9.T7.11.1.m1.1.1.1.cmml">=</mo><mn id="S9.T7.11.1.m1.1.1.3" xref="S9.T7.11.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T7.11.1.m1.1c"><apply id="S9.T7.11.1.m1.1.1.cmml" xref="S9.T7.11.1.m1.1.1"><eq id="S9.T7.11.1.m1.1.1.1.cmml" xref="S9.T7.11.1.m1.1.1.1"></eq><apply id="S9.T7.11.1.m1.1.1.2.cmml" xref="S9.T7.11.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.T7.11.1.m1.1.1.2.1.cmml" xref="S9.T7.11.1.m1.1.1.2">subscript</csymbol><ci id="S9.T7.11.1.m1.1.1.2.2.cmml" xref="S9.T7.11.1.m1.1.1.2.2">𝜆</ci><ci id="S9.T7.11.1.m1.1.1.2.3a.cmml" xref="S9.T7.11.1.m1.1.1.2.3"><mtext id="S9.T7.11.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S9.T7.11.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S9.T7.11.1.m1.1.1.3.cmml" type="float" xref="S9.T7.11.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T7.11.1.m1.1d">\lambda_{\text{ent}}=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.T7.11.1.m1.1e">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0.05</annotation></semantics></math> on our ScaleProtoSeg best performing run.</span></figcaption>
</figure>
<figure class="ltx_table" id="S9.T8">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S9.T8.6" style="width:216.8pt;height:92.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-38.8pt,16.6pt) scale(0.736230427834458,0.736230427834458) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S9.T8.6.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S9.T8.6.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S9.T8.6.6.7.1.1"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.7.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T8.6.6.7.1.2"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.7.1.2.1">Regularization</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T8.6.6.7.1.3"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.7.1.3.1">Prototypes</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T8.6.6.7.1.4"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.7.1.4.1">Group Avg</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S9.T8.6.6.7.1.5"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.7.1.5.1">mIoU</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S9.T8.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S9.T8.1.1.1.2" rowspan="2"><span class="ltx_text" id="S9.T8.1.1.1.2.1">Pascal</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.1.1.1.1"><math alttext="\lambda_{\text{ent}}=0" class="ltx_Math" display="inline" id="S9.T8.1.1.1.1.m1.1"><semantics id="S9.T8.1.1.1.1.m1.1a"><mrow id="S9.T8.1.1.1.1.m1.1.1" xref="S9.T8.1.1.1.1.m1.1.1.cmml"><msub id="S9.T8.1.1.1.1.m1.1.1.2" xref="S9.T8.1.1.1.1.m1.1.1.2.cmml"><mi id="S9.T8.1.1.1.1.m1.1.1.2.2" xref="S9.T8.1.1.1.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S9.T8.1.1.1.1.m1.1.1.2.3" xref="S9.T8.1.1.1.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S9.T8.1.1.1.1.m1.1.1.1" xref="S9.T8.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S9.T8.1.1.1.1.m1.1.1.3" xref="S9.T8.1.1.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T8.1.1.1.1.m1.1b"><apply id="S9.T8.1.1.1.1.m1.1.1.cmml" xref="S9.T8.1.1.1.1.m1.1.1"><eq id="S9.T8.1.1.1.1.m1.1.1.1.cmml" xref="S9.T8.1.1.1.1.m1.1.1.1"></eq><apply id="S9.T8.1.1.1.1.m1.1.1.2.cmml" xref="S9.T8.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.T8.1.1.1.1.m1.1.1.2.1.cmml" xref="S9.T8.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S9.T8.1.1.1.1.m1.1.1.2.2.cmml" xref="S9.T8.1.1.1.1.m1.1.1.2.2">𝜆</ci><ci id="S9.T8.1.1.1.1.m1.1.1.2.3a.cmml" xref="S9.T8.1.1.1.1.m1.1.1.2.3"><mtext id="S9.T8.1.1.1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S9.T8.1.1.1.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S9.T8.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S9.T8.1.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T8.1.1.1.1.m1.1c">\lambda_{\text{ent}}=0</annotation><annotation encoding="application/x-llamapun" id="S9.T8.1.1.1.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.1.1.1.3">146</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.1.1.1.4">5.59</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.1.1.1.5">72.22</td>
</tr>
<tr class="ltx_tr" id="S9.T8.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.2.2.2.1"><math alttext="\lambda_{\text{ent}}=0.05" class="ltx_Math" display="inline" id="S9.T8.2.2.2.1.m1.1"><semantics id="S9.T8.2.2.2.1.m1.1a"><mrow id="S9.T8.2.2.2.1.m1.1.1" xref="S9.T8.2.2.2.1.m1.1.1.cmml"><msub id="S9.T8.2.2.2.1.m1.1.1.2" xref="S9.T8.2.2.2.1.m1.1.1.2.cmml"><mi id="S9.T8.2.2.2.1.m1.1.1.2.2" xref="S9.T8.2.2.2.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S9.T8.2.2.2.1.m1.1.1.2.3" xref="S9.T8.2.2.2.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S9.T8.2.2.2.1.m1.1.1.1" xref="S9.T8.2.2.2.1.m1.1.1.1.cmml">=</mo><mn id="S9.T8.2.2.2.1.m1.1.1.3" xref="S9.T8.2.2.2.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T8.2.2.2.1.m1.1b"><apply id="S9.T8.2.2.2.1.m1.1.1.cmml" xref="S9.T8.2.2.2.1.m1.1.1"><eq id="S9.T8.2.2.2.1.m1.1.1.1.cmml" xref="S9.T8.2.2.2.1.m1.1.1.1"></eq><apply id="S9.T8.2.2.2.1.m1.1.1.2.cmml" xref="S9.T8.2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.T8.2.2.2.1.m1.1.1.2.1.cmml" xref="S9.T8.2.2.2.1.m1.1.1.2">subscript</csymbol><ci id="S9.T8.2.2.2.1.m1.1.1.2.2.cmml" xref="S9.T8.2.2.2.1.m1.1.1.2.2">𝜆</ci><ci id="S9.T8.2.2.2.1.m1.1.1.2.3a.cmml" xref="S9.T8.2.2.2.1.m1.1.1.2.3"><mtext id="S9.T8.2.2.2.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S9.T8.2.2.2.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S9.T8.2.2.2.1.m1.1.1.3.cmml" type="float" xref="S9.T8.2.2.2.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T8.2.2.2.1.m1.1c">\lambda_{\text{ent}}=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.T8.2.2.2.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S9.T8.2.2.2.2.1">131</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S9.T8.2.2.2.3.1">3.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.2.2.2.4"><span class="ltx_text ltx_font_bold" id="S9.T8.2.2.2.4.1">72.26</span></td>
</tr>
<tr class="ltx_tr" id="S9.T8.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S9.T8.3.3.3.2" rowspan="2"><span class="ltx_text" id="S9.T8.3.3.3.2.1">Cityscapes</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.3.3.3.1"><math alttext="\lambda_{\text{ent}}=0" class="ltx_Math" display="inline" id="S9.T8.3.3.3.1.m1.1"><semantics id="S9.T8.3.3.3.1.m1.1a"><mrow id="S9.T8.3.3.3.1.m1.1.1" xref="S9.T8.3.3.3.1.m1.1.1.cmml"><msub id="S9.T8.3.3.3.1.m1.1.1.2" xref="S9.T8.3.3.3.1.m1.1.1.2.cmml"><mi id="S9.T8.3.3.3.1.m1.1.1.2.2" xref="S9.T8.3.3.3.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S9.T8.3.3.3.1.m1.1.1.2.3" xref="S9.T8.3.3.3.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S9.T8.3.3.3.1.m1.1.1.1" xref="S9.T8.3.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S9.T8.3.3.3.1.m1.1.1.3" xref="S9.T8.3.3.3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T8.3.3.3.1.m1.1b"><apply id="S9.T8.3.3.3.1.m1.1.1.cmml" xref="S9.T8.3.3.3.1.m1.1.1"><eq id="S9.T8.3.3.3.1.m1.1.1.1.cmml" xref="S9.T8.3.3.3.1.m1.1.1.1"></eq><apply id="S9.T8.3.3.3.1.m1.1.1.2.cmml" xref="S9.T8.3.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.T8.3.3.3.1.m1.1.1.2.1.cmml" xref="S9.T8.3.3.3.1.m1.1.1.2">subscript</csymbol><ci id="S9.T8.3.3.3.1.m1.1.1.2.2.cmml" xref="S9.T8.3.3.3.1.m1.1.1.2.2">𝜆</ci><ci id="S9.T8.3.3.3.1.m1.1.1.2.3a.cmml" xref="S9.T8.3.3.3.1.m1.1.1.2.3"><mtext id="S9.T8.3.3.3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S9.T8.3.3.3.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S9.T8.3.3.3.1.m1.1.1.3.cmml" type="integer" xref="S9.T8.3.3.3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T8.3.3.3.1.m1.1c">\lambda_{\text{ent}}=0</annotation><annotation encoding="application/x-llamapun" id="S9.T8.3.3.3.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.3.3.3.3">132</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.3.3.3.4">5.79</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.3.3.3.5"><span class="ltx_text ltx_font_bold" id="S9.T8.3.3.3.5.1">69.22</span></td>
</tr>
<tr class="ltx_tr" id="S9.T8.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.4.4.4.1"><math alttext="\lambda_{\text{ent}}=0.05" class="ltx_Math" display="inline" id="S9.T8.4.4.4.1.m1.1"><semantics id="S9.T8.4.4.4.1.m1.1a"><mrow id="S9.T8.4.4.4.1.m1.1.1" xref="S9.T8.4.4.4.1.m1.1.1.cmml"><msub id="S9.T8.4.4.4.1.m1.1.1.2" xref="S9.T8.4.4.4.1.m1.1.1.2.cmml"><mi id="S9.T8.4.4.4.1.m1.1.1.2.2" xref="S9.T8.4.4.4.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S9.T8.4.4.4.1.m1.1.1.2.3" xref="S9.T8.4.4.4.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S9.T8.4.4.4.1.m1.1.1.1" xref="S9.T8.4.4.4.1.m1.1.1.1.cmml">=</mo><mn id="S9.T8.4.4.4.1.m1.1.1.3" xref="S9.T8.4.4.4.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T8.4.4.4.1.m1.1b"><apply id="S9.T8.4.4.4.1.m1.1.1.cmml" xref="S9.T8.4.4.4.1.m1.1.1"><eq id="S9.T8.4.4.4.1.m1.1.1.1.cmml" xref="S9.T8.4.4.4.1.m1.1.1.1"></eq><apply id="S9.T8.4.4.4.1.m1.1.1.2.cmml" xref="S9.T8.4.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.T8.4.4.4.1.m1.1.1.2.1.cmml" xref="S9.T8.4.4.4.1.m1.1.1.2">subscript</csymbol><ci id="S9.T8.4.4.4.1.m1.1.1.2.2.cmml" xref="S9.T8.4.4.4.1.m1.1.1.2.2">𝜆</ci><ci id="S9.T8.4.4.4.1.m1.1.1.2.3a.cmml" xref="S9.T8.4.4.4.1.m1.1.1.2.3"><mtext id="S9.T8.4.4.4.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S9.T8.4.4.4.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S9.T8.4.4.4.1.m1.1.1.3.cmml" type="float" xref="S9.T8.4.4.4.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T8.4.4.4.1.m1.1c">\lambda_{\text{ent}}=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.T8.4.4.4.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.4.4.4.2"><span class="ltx_text ltx_font_bold" id="S9.T8.4.4.4.2.1">111</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.4.4.4.3"><span class="ltx_text ltx_font_bold" id="S9.T8.4.4.4.3.1">3.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S9.T8.4.4.4.4"><span class="ltx_text ltx_font_bold" id="S9.T8.4.4.4.4.1">69.22</span></td>
</tr>
<tr class="ltx_tr" id="S9.T8.5.5.5">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S9.T8.5.5.5.2" rowspan="2"><span class="ltx_text" id="S9.T8.5.5.5.2.1">ADE20K</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.5.5.5.1"><math alttext="\lambda_{\text{ent}}=0" class="ltx_Math" display="inline" id="S9.T8.5.5.5.1.m1.1"><semantics id="S9.T8.5.5.5.1.m1.1a"><mrow id="S9.T8.5.5.5.1.m1.1.1" xref="S9.T8.5.5.5.1.m1.1.1.cmml"><msub id="S9.T8.5.5.5.1.m1.1.1.2" xref="S9.T8.5.5.5.1.m1.1.1.2.cmml"><mi id="S9.T8.5.5.5.1.m1.1.1.2.2" xref="S9.T8.5.5.5.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S9.T8.5.5.5.1.m1.1.1.2.3" xref="S9.T8.5.5.5.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S9.T8.5.5.5.1.m1.1.1.1" xref="S9.T8.5.5.5.1.m1.1.1.1.cmml">=</mo><mn id="S9.T8.5.5.5.1.m1.1.1.3" xref="S9.T8.5.5.5.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T8.5.5.5.1.m1.1b"><apply id="S9.T8.5.5.5.1.m1.1.1.cmml" xref="S9.T8.5.5.5.1.m1.1.1"><eq id="S9.T8.5.5.5.1.m1.1.1.1.cmml" xref="S9.T8.5.5.5.1.m1.1.1.1"></eq><apply id="S9.T8.5.5.5.1.m1.1.1.2.cmml" xref="S9.T8.5.5.5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.T8.5.5.5.1.m1.1.1.2.1.cmml" xref="S9.T8.5.5.5.1.m1.1.1.2">subscript</csymbol><ci id="S9.T8.5.5.5.1.m1.1.1.2.2.cmml" xref="S9.T8.5.5.5.1.m1.1.1.2.2">𝜆</ci><ci id="S9.T8.5.5.5.1.m1.1.1.2.3a.cmml" xref="S9.T8.5.5.5.1.m1.1.1.2.3"><mtext id="S9.T8.5.5.5.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S9.T8.5.5.5.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S9.T8.5.5.5.1.m1.1.1.3.cmml" type="integer" xref="S9.T8.5.5.5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T8.5.5.5.1.m1.1c">\lambda_{\text{ent}}=0</annotation><annotation encoding="application/x-llamapun" id="S9.T8.5.5.5.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.5.5.5.3">1405</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.5.5.5.4">6.06</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S9.T8.5.5.5.5">33.40</td>
</tr>
<tr class="ltx_tr" id="S9.T8.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T8.6.6.6.1"><math alttext="\lambda_{\text{ent}}=0.25" class="ltx_Math" display="inline" id="S9.T8.6.6.6.1.m1.1"><semantics id="S9.T8.6.6.6.1.m1.1a"><mrow id="S9.T8.6.6.6.1.m1.1.1" xref="S9.T8.6.6.6.1.m1.1.1.cmml"><msub id="S9.T8.6.6.6.1.m1.1.1.2" xref="S9.T8.6.6.6.1.m1.1.1.2.cmml"><mi id="S9.T8.6.6.6.1.m1.1.1.2.2" xref="S9.T8.6.6.6.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S9.T8.6.6.6.1.m1.1.1.2.3" xref="S9.T8.6.6.6.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S9.T8.6.6.6.1.m1.1.1.1" xref="S9.T8.6.6.6.1.m1.1.1.1.cmml">=</mo><mn id="S9.T8.6.6.6.1.m1.1.1.3" xref="S9.T8.6.6.6.1.m1.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T8.6.6.6.1.m1.1b"><apply id="S9.T8.6.6.6.1.m1.1.1.cmml" xref="S9.T8.6.6.6.1.m1.1.1"><eq id="S9.T8.6.6.6.1.m1.1.1.1.cmml" xref="S9.T8.6.6.6.1.m1.1.1.1"></eq><apply id="S9.T8.6.6.6.1.m1.1.1.2.cmml" xref="S9.T8.6.6.6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S9.T8.6.6.6.1.m1.1.1.2.1.cmml" xref="S9.T8.6.6.6.1.m1.1.1.2">subscript</csymbol><ci id="S9.T8.6.6.6.1.m1.1.1.2.2.cmml" xref="S9.T8.6.6.6.1.m1.1.1.2.2">𝜆</ci><ci id="S9.T8.6.6.6.1.m1.1.1.2.3a.cmml" xref="S9.T8.6.6.6.1.m1.1.1.2.3"><mtext id="S9.T8.6.6.6.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S9.T8.6.6.6.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S9.T8.6.6.6.1.m1.1.1.3.cmml" type="float" xref="S9.T8.6.6.6.1.m1.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T8.6.6.6.1.m1.1c">\lambda_{\text{ent}}=0.25</annotation><annotation encoding="application/x-llamapun" id="S9.T8.6.6.6.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T8.6.6.6.2"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.6.2.1">1132</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T8.6.6.6.3"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.6.3.1">4.08</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S9.T8.6.6.6.4"><span class="ltx_text ltx_font_bold" id="S9.T8.6.6.6.4.1">34.32</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S9.T8.10.2.1" style="font-size:90%;">Table 8</span>: </span><span class="ltx_text" id="S9.T8.8.1" style="font-size:90%;">Ablation study on the effect of the entropy regularization on the grouping mechanism with <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S9.T8.8.1.m1.1"><semantics id="S9.T8.8.1.m1.1b"><mrow id="S9.T8.8.1.m1.1.1" xref="S9.T8.8.1.m1.1.1.cmml"><mi id="S9.T8.8.1.m1.1.1.2" xref="S9.T8.8.1.m1.1.1.2.cmml">α</mi><mo id="S9.T8.8.1.m1.1.1.1" xref="S9.T8.8.1.m1.1.1.1.cmml">=</mo><mn id="S9.T8.8.1.m1.1.1.3" xref="S9.T8.8.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.T8.8.1.m1.1c"><apply id="S9.T8.8.1.m1.1.1.cmml" xref="S9.T8.8.1.m1.1.1"><eq id="S9.T8.8.1.m1.1.1.1.cmml" xref="S9.T8.8.1.m1.1.1.1"></eq><ci id="S9.T8.8.1.m1.1.1.2.cmml" xref="S9.T8.8.1.m1.1.1.2">𝛼</ci><cn id="S9.T8.8.1.m1.1.1.3.cmml" type="float" xref="S9.T8.8.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.T8.8.1.m1.1d">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S9.T8.8.1.m1.1e">italic_α = 0.05</annotation></semantics></math> on our ScaleProtoSeg best performing run.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S10">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">10 </span>Group Overlap</h2>
<div class="ltx_para" id="S10.p1">
<p class="ltx_p" id="S10.p1.1">In this section, we extend the analysis on the effect of the entropy loss regularization on the grouping mechanism presented above, as entropy regularization also impacts the overlap between group activations and supports identifying prototypical parts.</p>
</div>
<figure class="ltx_table" id="S10.T9">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S10.T9.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S10.T9.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S10.T9.6.7.1.1"><span class="ltx_text ltx_font_bold" id="S10.T9.6.7.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S10.T9.6.7.1.2"><span class="ltx_text ltx_font_bold" id="S10.T9.6.7.1.2.1">Regularization</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S10.T9.6.7.1.3"><span class="ltx_text ltx_font_bold" id="S10.T9.6.7.1.3.1">mIoU Groups</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S10.T9.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S10.T9.1.1.2" rowspan="2"><span class="ltx_text" id="S10.T9.1.1.2.1">Pascal</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S10.T9.1.1.1"><math alttext="\lambda_{\text{ent}}=0" class="ltx_Math" display="inline" id="S10.T9.1.1.1.m1.1"><semantics id="S10.T9.1.1.1.m1.1a"><mrow id="S10.T9.1.1.1.m1.1.1" xref="S10.T9.1.1.1.m1.1.1.cmml"><msub id="S10.T9.1.1.1.m1.1.1.2" xref="S10.T9.1.1.1.m1.1.1.2.cmml"><mi id="S10.T9.1.1.1.m1.1.1.2.2" xref="S10.T9.1.1.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S10.T9.1.1.1.m1.1.1.2.3" xref="S10.T9.1.1.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S10.T9.1.1.1.m1.1.1.1" xref="S10.T9.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S10.T9.1.1.1.m1.1.1.3" xref="S10.T9.1.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S10.T9.1.1.1.m1.1b"><apply id="S10.T9.1.1.1.m1.1.1.cmml" xref="S10.T9.1.1.1.m1.1.1"><eq id="S10.T9.1.1.1.m1.1.1.1.cmml" xref="S10.T9.1.1.1.m1.1.1.1"></eq><apply id="S10.T9.1.1.1.m1.1.1.2.cmml" xref="S10.T9.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.T9.1.1.1.m1.1.1.2.1.cmml" xref="S10.T9.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S10.T9.1.1.1.m1.1.1.2.2.cmml" xref="S10.T9.1.1.1.m1.1.1.2.2">𝜆</ci><ci id="S10.T9.1.1.1.m1.1.1.2.3a.cmml" xref="S10.T9.1.1.1.m1.1.1.2.3"><mtext id="S10.T9.1.1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S10.T9.1.1.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S10.T9.1.1.1.m1.1.1.3.cmml" type="integer" xref="S10.T9.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T9.1.1.1.m1.1c">\lambda_{\text{ent}}=0</annotation><annotation encoding="application/x-llamapun" id="S10.T9.1.1.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S10.T9.1.1.3">47.45</td>
</tr>
<tr class="ltx_tr" id="S10.T9.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S10.T9.2.2.1"><math alttext="\lambda_{\text{ent}}=0.05" class="ltx_Math" display="inline" id="S10.T9.2.2.1.m1.1"><semantics id="S10.T9.2.2.1.m1.1a"><mrow id="S10.T9.2.2.1.m1.1.1" xref="S10.T9.2.2.1.m1.1.1.cmml"><msub id="S10.T9.2.2.1.m1.1.1.2" xref="S10.T9.2.2.1.m1.1.1.2.cmml"><mi id="S10.T9.2.2.1.m1.1.1.2.2" xref="S10.T9.2.2.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S10.T9.2.2.1.m1.1.1.2.3" xref="S10.T9.2.2.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S10.T9.2.2.1.m1.1.1.1" xref="S10.T9.2.2.1.m1.1.1.1.cmml">=</mo><mn id="S10.T9.2.2.1.m1.1.1.3" xref="S10.T9.2.2.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S10.T9.2.2.1.m1.1b"><apply id="S10.T9.2.2.1.m1.1.1.cmml" xref="S10.T9.2.2.1.m1.1.1"><eq id="S10.T9.2.2.1.m1.1.1.1.cmml" xref="S10.T9.2.2.1.m1.1.1.1"></eq><apply id="S10.T9.2.2.1.m1.1.1.2.cmml" xref="S10.T9.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.T9.2.2.1.m1.1.1.2.1.cmml" xref="S10.T9.2.2.1.m1.1.1.2">subscript</csymbol><ci id="S10.T9.2.2.1.m1.1.1.2.2.cmml" xref="S10.T9.2.2.1.m1.1.1.2.2">𝜆</ci><ci id="S10.T9.2.2.1.m1.1.1.2.3a.cmml" xref="S10.T9.2.2.1.m1.1.1.2.3"><mtext id="S10.T9.2.2.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S10.T9.2.2.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S10.T9.2.2.1.m1.1.1.3.cmml" type="float" xref="S10.T9.2.2.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T9.2.2.1.m1.1c">\lambda_{\text{ent}}=0.05</annotation><annotation encoding="application/x-llamapun" id="S10.T9.2.2.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S10.T9.2.2.2"><span class="ltx_text ltx_font_bold" id="S10.T9.2.2.2.1">28.29</span></td>
</tr>
<tr class="ltx_tr" id="S10.T9.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S10.T9.3.3.2" rowspan="2"><span class="ltx_text" id="S10.T9.3.3.2.1">Cityscapes</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S10.T9.3.3.1"><math alttext="\lambda_{\text{ent}}=0" class="ltx_Math" display="inline" id="S10.T9.3.3.1.m1.1"><semantics id="S10.T9.3.3.1.m1.1a"><mrow id="S10.T9.3.3.1.m1.1.1" xref="S10.T9.3.3.1.m1.1.1.cmml"><msub id="S10.T9.3.3.1.m1.1.1.2" xref="S10.T9.3.3.1.m1.1.1.2.cmml"><mi id="S10.T9.3.3.1.m1.1.1.2.2" xref="S10.T9.3.3.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S10.T9.3.3.1.m1.1.1.2.3" xref="S10.T9.3.3.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S10.T9.3.3.1.m1.1.1.1" xref="S10.T9.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S10.T9.3.3.1.m1.1.1.3" xref="S10.T9.3.3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S10.T9.3.3.1.m1.1b"><apply id="S10.T9.3.3.1.m1.1.1.cmml" xref="S10.T9.3.3.1.m1.1.1"><eq id="S10.T9.3.3.1.m1.1.1.1.cmml" xref="S10.T9.3.3.1.m1.1.1.1"></eq><apply id="S10.T9.3.3.1.m1.1.1.2.cmml" xref="S10.T9.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.T9.3.3.1.m1.1.1.2.1.cmml" xref="S10.T9.3.3.1.m1.1.1.2">subscript</csymbol><ci id="S10.T9.3.3.1.m1.1.1.2.2.cmml" xref="S10.T9.3.3.1.m1.1.1.2.2">𝜆</ci><ci id="S10.T9.3.3.1.m1.1.1.2.3a.cmml" xref="S10.T9.3.3.1.m1.1.1.2.3"><mtext id="S10.T9.3.3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S10.T9.3.3.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S10.T9.3.3.1.m1.1.1.3.cmml" type="integer" xref="S10.T9.3.3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T9.3.3.1.m1.1c">\lambda_{\text{ent}}=0</annotation><annotation encoding="application/x-llamapun" id="S10.T9.3.3.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S10.T9.3.3.3">61.65</td>
</tr>
<tr class="ltx_tr" id="S10.T9.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S10.T9.4.4.1"><math alttext="\lambda_{\text{ent}}=0.05" class="ltx_Math" display="inline" id="S10.T9.4.4.1.m1.1"><semantics id="S10.T9.4.4.1.m1.1a"><mrow id="S10.T9.4.4.1.m1.1.1" xref="S10.T9.4.4.1.m1.1.1.cmml"><msub id="S10.T9.4.4.1.m1.1.1.2" xref="S10.T9.4.4.1.m1.1.1.2.cmml"><mi id="S10.T9.4.4.1.m1.1.1.2.2" xref="S10.T9.4.4.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S10.T9.4.4.1.m1.1.1.2.3" xref="S10.T9.4.4.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S10.T9.4.4.1.m1.1.1.1" xref="S10.T9.4.4.1.m1.1.1.1.cmml">=</mo><mn id="S10.T9.4.4.1.m1.1.1.3" xref="S10.T9.4.4.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S10.T9.4.4.1.m1.1b"><apply id="S10.T9.4.4.1.m1.1.1.cmml" xref="S10.T9.4.4.1.m1.1.1"><eq id="S10.T9.4.4.1.m1.1.1.1.cmml" xref="S10.T9.4.4.1.m1.1.1.1"></eq><apply id="S10.T9.4.4.1.m1.1.1.2.cmml" xref="S10.T9.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.T9.4.4.1.m1.1.1.2.1.cmml" xref="S10.T9.4.4.1.m1.1.1.2">subscript</csymbol><ci id="S10.T9.4.4.1.m1.1.1.2.2.cmml" xref="S10.T9.4.4.1.m1.1.1.2.2">𝜆</ci><ci id="S10.T9.4.4.1.m1.1.1.2.3a.cmml" xref="S10.T9.4.4.1.m1.1.1.2.3"><mtext id="S10.T9.4.4.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S10.T9.4.4.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S10.T9.4.4.1.m1.1.1.3.cmml" type="float" xref="S10.T9.4.4.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T9.4.4.1.m1.1c">\lambda_{\text{ent}}=0.05</annotation><annotation encoding="application/x-llamapun" id="S10.T9.4.4.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S10.T9.4.4.2"><span class="ltx_text ltx_font_bold" id="S10.T9.4.4.2.1">43.48</span></td>
</tr>
<tr class="ltx_tr" id="S10.T9.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S10.T9.5.5.2" rowspan="2"><span class="ltx_text" id="S10.T9.5.5.2.1">ADE20K</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S10.T9.5.5.1"><math alttext="\lambda_{\text{ent}}=0" class="ltx_Math" display="inline" id="S10.T9.5.5.1.m1.1"><semantics id="S10.T9.5.5.1.m1.1a"><mrow id="S10.T9.5.5.1.m1.1.1" xref="S10.T9.5.5.1.m1.1.1.cmml"><msub id="S10.T9.5.5.1.m1.1.1.2" xref="S10.T9.5.5.1.m1.1.1.2.cmml"><mi id="S10.T9.5.5.1.m1.1.1.2.2" xref="S10.T9.5.5.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S10.T9.5.5.1.m1.1.1.2.3" xref="S10.T9.5.5.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S10.T9.5.5.1.m1.1.1.1" xref="S10.T9.5.5.1.m1.1.1.1.cmml">=</mo><mn id="S10.T9.5.5.1.m1.1.1.3" xref="S10.T9.5.5.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S10.T9.5.5.1.m1.1b"><apply id="S10.T9.5.5.1.m1.1.1.cmml" xref="S10.T9.5.5.1.m1.1.1"><eq id="S10.T9.5.5.1.m1.1.1.1.cmml" xref="S10.T9.5.5.1.m1.1.1.1"></eq><apply id="S10.T9.5.5.1.m1.1.1.2.cmml" xref="S10.T9.5.5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.T9.5.5.1.m1.1.1.2.1.cmml" xref="S10.T9.5.5.1.m1.1.1.2">subscript</csymbol><ci id="S10.T9.5.5.1.m1.1.1.2.2.cmml" xref="S10.T9.5.5.1.m1.1.1.2.2">𝜆</ci><ci id="S10.T9.5.5.1.m1.1.1.2.3a.cmml" xref="S10.T9.5.5.1.m1.1.1.2.3"><mtext id="S10.T9.5.5.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S10.T9.5.5.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S10.T9.5.5.1.m1.1.1.3.cmml" type="integer" xref="S10.T9.5.5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T9.5.5.1.m1.1c">\lambda_{\text{ent}}=0</annotation><annotation encoding="application/x-llamapun" id="S10.T9.5.5.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S10.T9.5.5.3">50.25</td>
</tr>
<tr class="ltx_tr" id="S10.T9.6.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S10.T9.6.6.1"><math alttext="\lambda_{\text{ent}}=0.25" class="ltx_Math" display="inline" id="S10.T9.6.6.1.m1.1"><semantics id="S10.T9.6.6.1.m1.1a"><mrow id="S10.T9.6.6.1.m1.1.1" xref="S10.T9.6.6.1.m1.1.1.cmml"><msub id="S10.T9.6.6.1.m1.1.1.2" xref="S10.T9.6.6.1.m1.1.1.2.cmml"><mi id="S10.T9.6.6.1.m1.1.1.2.2" xref="S10.T9.6.6.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S10.T9.6.6.1.m1.1.1.2.3" xref="S10.T9.6.6.1.m1.1.1.2.3a.cmml">ent</mtext></msub><mo id="S10.T9.6.6.1.m1.1.1.1" xref="S10.T9.6.6.1.m1.1.1.1.cmml">=</mo><mn id="S10.T9.6.6.1.m1.1.1.3" xref="S10.T9.6.6.1.m1.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S10.T9.6.6.1.m1.1b"><apply id="S10.T9.6.6.1.m1.1.1.cmml" xref="S10.T9.6.6.1.m1.1.1"><eq id="S10.T9.6.6.1.m1.1.1.1.cmml" xref="S10.T9.6.6.1.m1.1.1.1"></eq><apply id="S10.T9.6.6.1.m1.1.1.2.cmml" xref="S10.T9.6.6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S10.T9.6.6.1.m1.1.1.2.1.cmml" xref="S10.T9.6.6.1.m1.1.1.2">subscript</csymbol><ci id="S10.T9.6.6.1.m1.1.1.2.2.cmml" xref="S10.T9.6.6.1.m1.1.1.2.2">𝜆</ci><ci id="S10.T9.6.6.1.m1.1.1.2.3a.cmml" xref="S10.T9.6.6.1.m1.1.1.2.3"><mtext id="S10.T9.6.6.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S10.T9.6.6.1.m1.1.1.2.3">ent</mtext></ci></apply><cn id="S10.T9.6.6.1.m1.1.1.3.cmml" type="float" xref="S10.T9.6.6.1.m1.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T9.6.6.1.m1.1c">\lambda_{\text{ent}}=0.25</annotation><annotation encoding="application/x-llamapun" id="S10.T9.6.6.1.m1.1d">italic_λ start_POSTSUBSCRIPT ent end_POSTSUBSCRIPT = 0.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S10.T9.6.6.2"><span class="ltx_text ltx_font_bold" id="S10.T9.6.6.2.1">42.74</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S10.T9.10.2.1" style="font-size:90%;">Table 9</span>: </span><span class="ltx_text" id="S10.T9.8.1" style="font-size:90%;">Analysis of the effect of the entropy regularization on the group activations overlap measured via mIoU with a threshold <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S10.T9.8.1.m1.1"><semantics id="S10.T9.8.1.m1.1b"><mrow id="S10.T9.8.1.m1.1.1" xref="S10.T9.8.1.m1.1.1.cmml"><mi id="S10.T9.8.1.m1.1.1.2" xref="S10.T9.8.1.m1.1.1.2.cmml">α</mi><mo id="S10.T9.8.1.m1.1.1.1" xref="S10.T9.8.1.m1.1.1.1.cmml">=</mo><mn id="S10.T9.8.1.m1.1.1.3" xref="S10.T9.8.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S10.T9.8.1.m1.1c"><apply id="S10.T9.8.1.m1.1.1.cmml" xref="S10.T9.8.1.m1.1.1"><eq id="S10.T9.8.1.m1.1.1.1.cmml" xref="S10.T9.8.1.m1.1.1.1"></eq><ci id="S10.T9.8.1.m1.1.1.2.cmml" xref="S10.T9.8.1.m1.1.1.2">𝛼</ci><cn id="S10.T9.8.1.m1.1.1.3.cmml" type="float" xref="S10.T9.8.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T9.8.1.m1.1d">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S10.T9.8.1.m1.1e">italic_α = 0.05</annotation></semantics></math> on our ScaleProtoSeg best performing run.</span></figcaption>
</figure>
<div class="ltx_para" id="S10.p2">
<p class="ltx_p" id="S10.p2.2">We observe that besides reducing the number of prototypes used in the groups as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S9.T8" title="Table 8 ‣ 9 Sparsity Regularization ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">8</span></a>, the entropy loss also encourages diversity in the activations of the groups assigned to the same class as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S10.F6" title="Figure 6 ‣ 10 Group Overlap ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a> for Cityscapes. In Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S10.T9" title="Table 9 ‣ 10 Group Overlap ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">9</span></a>, we present a quantitative analysis of this phenomenon. Firstly, on the validation sets of Pascal, Cityscapes, and ADE20K, we binarize all the group activations using the <math alttext="95^{th}" class="ltx_Math" display="inline" id="S10.p2.1.m1.1"><semantics id="S10.p2.1.m1.1a"><msup id="S10.p2.1.m1.1.1" xref="S10.p2.1.m1.1.1.cmml"><mn id="S10.p2.1.m1.1.1.2" xref="S10.p2.1.m1.1.1.2.cmml">95</mn><mrow id="S10.p2.1.m1.1.1.3" xref="S10.p2.1.m1.1.1.3.cmml"><mi id="S10.p2.1.m1.1.1.3.2" xref="S10.p2.1.m1.1.1.3.2.cmml">t</mi><mo id="S10.p2.1.m1.1.1.3.1" xref="S10.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S10.p2.1.m1.1.1.3.3" xref="S10.p2.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S10.p2.1.m1.1b"><apply id="S10.p2.1.m1.1.1.cmml" xref="S10.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S10.p2.1.m1.1.1.1.cmml" xref="S10.p2.1.m1.1.1">superscript</csymbol><cn id="S10.p2.1.m1.1.1.2.cmml" type="integer" xref="S10.p2.1.m1.1.1.2">95</cn><apply id="S10.p2.1.m1.1.1.3.cmml" xref="S10.p2.1.m1.1.1.3"><times id="S10.p2.1.m1.1.1.3.1.cmml" xref="S10.p2.1.m1.1.1.3.1"></times><ci id="S10.p2.1.m1.1.1.3.2.cmml" xref="S10.p2.1.m1.1.1.3.2">𝑡</ci><ci id="S10.p2.1.m1.1.1.3.3.cmml" xref="S10.p2.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.p2.1.m1.1c">95^{th}</annotation><annotation encoding="application/x-llamapun" id="S10.p2.1.m1.1d">95 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> percentile. Then we compute on those validation sets the mIoU between the binarized group activation maps assigned to the same class, as a measure of overlap in the group activations. We observe that the entropy regularization on all three datasets decreases the overlap between groups of up to <math alttext="19\%" class="ltx_Math" display="inline" id="S10.p2.2.m2.1"><semantics id="S10.p2.2.m2.1a"><mrow id="S10.p2.2.m2.1.1" xref="S10.p2.2.m2.1.1.cmml"><mn id="S10.p2.2.m2.1.1.2" xref="S10.p2.2.m2.1.1.2.cmml">19</mn><mo id="S10.p2.2.m2.1.1.1" xref="S10.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S10.p2.2.m2.1b"><apply id="S10.p2.2.m2.1.1.cmml" xref="S10.p2.2.m2.1.1"><csymbol cd="latexml" id="S10.p2.2.m2.1.1.1.cmml" xref="S10.p2.2.m2.1.1.1">percent</csymbol><cn id="S10.p2.2.m2.1.1.2.cmml" type="integer" xref="S10.p2.2.m2.1.1.2">19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.p2.2.m2.1c">19\%</annotation><annotation encoding="application/x-llamapun" id="S10.p2.2.m2.1d">19 %</annotation></semantics></math> for Pascal. A low overlap between group activations enables the model to focus on different prototypical parts of the object and avoid groups all focusing on the whole object. Those results can be explained by the increased sparsity of the grouping functions, which ultimately leads to more variation in prototype assignment between the groups.</p>
</div>
<figure class="ltx_figure" id="S10.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S10.F6.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="114" id="S10.F6.sf1.g1" src="extracted/5854717/images/plot_img_frankfurt_000000_011007_group_0_class_truck.jpg" width="685"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="114" id="S10.F6.sf1.g2" src="extracted/5854717/images/plot_img_frankfurt_000000_011007_group_1_class_truck.jpg" width="685"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="114" id="S10.F6.sf1.g3" src="extracted/5854717/images/plot_img_frankfurt_000000_011007_group_2_class_truck.jpg" width="685"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S10.F6.sf1.3.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S10.F6.sf1.4.2" style="font-size:90%;">Group activations <span class="ltx_text ltx_font_bold" id="S10.F6.sf1.4.2.1">without</span> entropy regularization</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S10.F6.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="114" id="S10.F6.sf2.g1" src="extracted/5854717/images/plot_img_frankfurt_000000_011007_group_0_class_truck_reg.jpg" width="685"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="114" id="S10.F6.sf2.g2" src="extracted/5854717/images/plot_img_frankfurt_000000_011007_group_1_class_truck_reg.jpg" width="685"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="114" id="S10.F6.sf2.g3" src="extracted/5854717/images/plot_img_frankfurt_000000_011007_group_2_class_truck_reg.jpg" width="685"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S10.F6.sf2.3.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S10.F6.sf2.4.2" style="font-size:90%;">Group activations <span class="ltx_text ltx_font_bold" id="S10.F6.sf2.4.2.1">with</span> entropy regularization</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S10.F6.3.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S10.F6.4.2" style="font-size:90%;">Example of group activations with or without entropy regularization for the class <span class="ltx_text ltx_font_italic" id="S10.F6.4.2.1">truck</span> on Cityscapes.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S11">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">11 </span>Multi-scale prototype analysis</h2>
<div class="ltx_para" id="S11.p1">
<p class="ltx_p" id="S11.p1.12">In the proposed ScaleProtoSeg method, each set of prototypes assigned to a scale <math alttext="s\in S" class="ltx_Math" display="inline" id="S11.p1.1.m1.1"><semantics id="S11.p1.1.m1.1a"><mrow id="S11.p1.1.m1.1.1" xref="S11.p1.1.m1.1.1.cmml"><mi id="S11.p1.1.m1.1.1.2" xref="S11.p1.1.m1.1.1.2.cmml">s</mi><mo id="S11.p1.1.m1.1.1.1" xref="S11.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S11.p1.1.m1.1.1.3" xref="S11.p1.1.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.1.m1.1b"><apply id="S11.p1.1.m1.1.1.cmml" xref="S11.p1.1.m1.1.1"><in id="S11.p1.1.m1.1.1.1.cmml" xref="S11.p1.1.m1.1.1.1"></in><ci id="S11.p1.1.m1.1.1.2.cmml" xref="S11.p1.1.m1.1.1.2">𝑠</ci><ci id="S11.p1.1.m1.1.1.3.cmml" xref="S11.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.1.m1.1c">s\in S</annotation><annotation encoding="application/x-llamapun" id="S11.p1.1.m1.1d">italic_s ∈ italic_S</annotation></semantics></math> corresponds to a specific field of view (FOV) from the ASPP layer in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib9" title="">9</a>]</cite>. We hypothesize that certain class-specific prototypes form pairs or groups of quasi-equivariant prototype activations between scales. Our definition of quasi-equivariance across scales is as follows. For a class <math alttext="c\in\mathcal{C}" class="ltx_Math" display="inline" id="S11.p1.2.m2.1"><semantics id="S11.p1.2.m2.1a"><mrow id="S11.p1.2.m2.1.1" xref="S11.p1.2.m2.1.1.cmml"><mi id="S11.p1.2.m2.1.1.2" xref="S11.p1.2.m2.1.1.2.cmml">c</mi><mo id="S11.p1.2.m2.1.1.1" xref="S11.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S11.p1.2.m2.1.1.3" xref="S11.p1.2.m2.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.2.m2.1b"><apply id="S11.p1.2.m2.1.1.cmml" xref="S11.p1.2.m2.1.1"><in id="S11.p1.2.m2.1.1.1.cmml" xref="S11.p1.2.m2.1.1.1"></in><ci id="S11.p1.2.m2.1.1.2.cmml" xref="S11.p1.2.m2.1.1.2">𝑐</ci><ci id="S11.p1.2.m2.1.1.3.cmml" xref="S11.p1.2.m2.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.2.m2.1c">c\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.2.m2.1d">italic_c ∈ caligraphic_C</annotation></semantics></math>, let us consider <math alttext="\forall\mathbf{x}\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S11.p1.3.m3.1"><semantics id="S11.p1.3.m3.1a"><mrow id="S11.p1.3.m3.1.1" xref="S11.p1.3.m3.1.1.cmml"><mrow id="S11.p1.3.m3.1.1.2" xref="S11.p1.3.m3.1.1.2.cmml"><mo id="S11.p1.3.m3.1.1.2.1" rspace="0.167em" xref="S11.p1.3.m3.1.1.2.1.cmml">∀</mo><mi id="S11.p1.3.m3.1.1.2.2" xref="S11.p1.3.m3.1.1.2.2.cmml">𝐱</mi></mrow><mo id="S11.p1.3.m3.1.1.1" xref="S11.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S11.p1.3.m3.1.1.3" xref="S11.p1.3.m3.1.1.3.cmml"><mi id="S11.p1.3.m3.1.1.3.2" xref="S11.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S11.p1.3.m3.1.1.3.3" xref="S11.p1.3.m3.1.1.3.3.cmml"><mi id="S11.p1.3.m3.1.1.3.3.2" xref="S11.p1.3.m3.1.1.3.3.2.cmml">H</mi><mo id="S11.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S11.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S11.p1.3.m3.1.1.3.3.3" xref="S11.p1.3.m3.1.1.3.3.3.cmml">W</mi><mo id="S11.p1.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S11.p1.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S11.p1.3.m3.1.1.3.3.4" xref="S11.p1.3.m3.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.3.m3.1b"><apply id="S11.p1.3.m3.1.1.cmml" xref="S11.p1.3.m3.1.1"><in id="S11.p1.3.m3.1.1.1.cmml" xref="S11.p1.3.m3.1.1.1"></in><apply id="S11.p1.3.m3.1.1.2.cmml" xref="S11.p1.3.m3.1.1.2"><csymbol cd="latexml" id="S11.p1.3.m3.1.1.2.1.cmml" xref="S11.p1.3.m3.1.1.2.1">for-all</csymbol><ci id="S11.p1.3.m3.1.1.2.2.cmml" xref="S11.p1.3.m3.1.1.2.2">𝐱</ci></apply><apply id="S11.p1.3.m3.1.1.3.cmml" xref="S11.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S11.p1.3.m3.1.1.3.1.cmml" xref="S11.p1.3.m3.1.1.3">superscript</csymbol><ci id="S11.p1.3.m3.1.1.3.2.cmml" xref="S11.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S11.p1.3.m3.1.1.3.3.cmml" xref="S11.p1.3.m3.1.1.3.3"><times id="S11.p1.3.m3.1.1.3.3.1.cmml" xref="S11.p1.3.m3.1.1.3.3.1"></times><ci id="S11.p1.3.m3.1.1.3.3.2.cmml" xref="S11.p1.3.m3.1.1.3.3.2">𝐻</ci><ci id="S11.p1.3.m3.1.1.3.3.3.cmml" xref="S11.p1.3.m3.1.1.3.3.3">𝑊</ci><cn id="S11.p1.3.m3.1.1.3.3.4.cmml" type="integer" xref="S11.p1.3.m3.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.3.m3.1c">\forall\mathbf{x}\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.3.m3.1d">∀ bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and its downscaled version <math alttext="\mathbf{x^{\prime}}\in\mathbb{R}^{\frac{H}{2}\times\frac{W}{2}\times 3}" class="ltx_Math" display="inline" id="S11.p1.4.m4.1"><semantics id="S11.p1.4.m4.1a"><mrow id="S11.p1.4.m4.1.1" xref="S11.p1.4.m4.1.1.cmml"><msup id="S11.p1.4.m4.1.1.2" xref="S11.p1.4.m4.1.1.2.cmml"><mi id="S11.p1.4.m4.1.1.2.2" xref="S11.p1.4.m4.1.1.2.2.cmml">𝐱</mi><mo id="S11.p1.4.m4.1.1.2.3" xref="S11.p1.4.m4.1.1.2.3.cmml">′</mo></msup><mo id="S11.p1.4.m4.1.1.1" xref="S11.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S11.p1.4.m4.1.1.3" xref="S11.p1.4.m4.1.1.3.cmml"><mi id="S11.p1.4.m4.1.1.3.2" xref="S11.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S11.p1.4.m4.1.1.3.3" xref="S11.p1.4.m4.1.1.3.3.cmml"><mfrac id="S11.p1.4.m4.1.1.3.3.2" xref="S11.p1.4.m4.1.1.3.3.2.cmml"><mi id="S11.p1.4.m4.1.1.3.3.2.2" xref="S11.p1.4.m4.1.1.3.3.2.2.cmml">H</mi><mn id="S11.p1.4.m4.1.1.3.3.2.3" xref="S11.p1.4.m4.1.1.3.3.2.3.cmml">2</mn></mfrac><mo id="S11.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S11.p1.4.m4.1.1.3.3.1.cmml">×</mo><mfrac id="S11.p1.4.m4.1.1.3.3.3" xref="S11.p1.4.m4.1.1.3.3.3.cmml"><mi id="S11.p1.4.m4.1.1.3.3.3.2" xref="S11.p1.4.m4.1.1.3.3.3.2.cmml">W</mi><mn id="S11.p1.4.m4.1.1.3.3.3.3" xref="S11.p1.4.m4.1.1.3.3.3.3.cmml">2</mn></mfrac><mo id="S11.p1.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S11.p1.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S11.p1.4.m4.1.1.3.3.4" xref="S11.p1.4.m4.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.4.m4.1b"><apply id="S11.p1.4.m4.1.1.cmml" xref="S11.p1.4.m4.1.1"><in id="S11.p1.4.m4.1.1.1.cmml" xref="S11.p1.4.m4.1.1.1"></in><apply id="S11.p1.4.m4.1.1.2.cmml" xref="S11.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S11.p1.4.m4.1.1.2.1.cmml" xref="S11.p1.4.m4.1.1.2">superscript</csymbol><ci id="S11.p1.4.m4.1.1.2.2.cmml" xref="S11.p1.4.m4.1.1.2.2">𝐱</ci><ci id="S11.p1.4.m4.1.1.2.3.cmml" xref="S11.p1.4.m4.1.1.2.3">′</ci></apply><apply id="S11.p1.4.m4.1.1.3.cmml" xref="S11.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S11.p1.4.m4.1.1.3.1.cmml" xref="S11.p1.4.m4.1.1.3">superscript</csymbol><ci id="S11.p1.4.m4.1.1.3.2.cmml" xref="S11.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S11.p1.4.m4.1.1.3.3.cmml" xref="S11.p1.4.m4.1.1.3.3"><times id="S11.p1.4.m4.1.1.3.3.1.cmml" xref="S11.p1.4.m4.1.1.3.3.1"></times><apply id="S11.p1.4.m4.1.1.3.3.2.cmml" xref="S11.p1.4.m4.1.1.3.3.2"><divide id="S11.p1.4.m4.1.1.3.3.2.1.cmml" xref="S11.p1.4.m4.1.1.3.3.2"></divide><ci id="S11.p1.4.m4.1.1.3.3.2.2.cmml" xref="S11.p1.4.m4.1.1.3.3.2.2">𝐻</ci><cn id="S11.p1.4.m4.1.1.3.3.2.3.cmml" type="integer" xref="S11.p1.4.m4.1.1.3.3.2.3">2</cn></apply><apply id="S11.p1.4.m4.1.1.3.3.3.cmml" xref="S11.p1.4.m4.1.1.3.3.3"><divide id="S11.p1.4.m4.1.1.3.3.3.1.cmml" xref="S11.p1.4.m4.1.1.3.3.3"></divide><ci id="S11.p1.4.m4.1.1.3.3.3.2.cmml" xref="S11.p1.4.m4.1.1.3.3.3.2">𝑊</ci><cn id="S11.p1.4.m4.1.1.3.3.3.3.cmml" type="integer" xref="S11.p1.4.m4.1.1.3.3.3.3">2</cn></apply><cn id="S11.p1.4.m4.1.1.3.3.4.cmml" type="integer" xref="S11.p1.4.m4.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.4.m4.1c">\mathbf{x^{\prime}}\in\mathbb{R}^{\frac{H}{2}\times\frac{W}{2}\times 3}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.4.m4.1d">bold_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_H end_ARG start_ARG 2 end_ARG × divide start_ARG italic_W end_ARG start_ARG 2 end_ARG × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> (the factor of 2 here matched the atrous rate increase from scale 1 to 2). Let us select the candidate pair of quasi-equivariant prototypes <math alttext="\mathbf{p}_{1,i}\in P_{1,c}" class="ltx_Math" display="inline" id="S11.p1.5.m5.4"><semantics id="S11.p1.5.m5.4a"><mrow id="S11.p1.5.m5.4.5" xref="S11.p1.5.m5.4.5.cmml"><msub id="S11.p1.5.m5.4.5.2" xref="S11.p1.5.m5.4.5.2.cmml"><mi id="S11.p1.5.m5.4.5.2.2" xref="S11.p1.5.m5.4.5.2.2.cmml">𝐩</mi><mrow id="S11.p1.5.m5.2.2.2.4" xref="S11.p1.5.m5.2.2.2.3.cmml"><mn id="S11.p1.5.m5.1.1.1.1" xref="S11.p1.5.m5.1.1.1.1.cmml">1</mn><mo id="S11.p1.5.m5.2.2.2.4.1" xref="S11.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S11.p1.5.m5.2.2.2.2" xref="S11.p1.5.m5.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S11.p1.5.m5.4.5.1" xref="S11.p1.5.m5.4.5.1.cmml">∈</mo><msub id="S11.p1.5.m5.4.5.3" xref="S11.p1.5.m5.4.5.3.cmml"><mi id="S11.p1.5.m5.4.5.3.2" xref="S11.p1.5.m5.4.5.3.2.cmml">P</mi><mrow id="S11.p1.5.m5.4.4.2.4" xref="S11.p1.5.m5.4.4.2.3.cmml"><mn id="S11.p1.5.m5.3.3.1.1" xref="S11.p1.5.m5.3.3.1.1.cmml">1</mn><mo id="S11.p1.5.m5.4.4.2.4.1" xref="S11.p1.5.m5.4.4.2.3.cmml">,</mo><mi id="S11.p1.5.m5.4.4.2.2" xref="S11.p1.5.m5.4.4.2.2.cmml">c</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.5.m5.4b"><apply id="S11.p1.5.m5.4.5.cmml" xref="S11.p1.5.m5.4.5"><in id="S11.p1.5.m5.4.5.1.cmml" xref="S11.p1.5.m5.4.5.1"></in><apply id="S11.p1.5.m5.4.5.2.cmml" xref="S11.p1.5.m5.4.5.2"><csymbol cd="ambiguous" id="S11.p1.5.m5.4.5.2.1.cmml" xref="S11.p1.5.m5.4.5.2">subscript</csymbol><ci id="S11.p1.5.m5.4.5.2.2.cmml" xref="S11.p1.5.m5.4.5.2.2">𝐩</ci><list id="S11.p1.5.m5.2.2.2.3.cmml" xref="S11.p1.5.m5.2.2.2.4"><cn id="S11.p1.5.m5.1.1.1.1.cmml" type="integer" xref="S11.p1.5.m5.1.1.1.1">1</cn><ci id="S11.p1.5.m5.2.2.2.2.cmml" xref="S11.p1.5.m5.2.2.2.2">𝑖</ci></list></apply><apply id="S11.p1.5.m5.4.5.3.cmml" xref="S11.p1.5.m5.4.5.3"><csymbol cd="ambiguous" id="S11.p1.5.m5.4.5.3.1.cmml" xref="S11.p1.5.m5.4.5.3">subscript</csymbol><ci id="S11.p1.5.m5.4.5.3.2.cmml" xref="S11.p1.5.m5.4.5.3.2">𝑃</ci><list id="S11.p1.5.m5.4.4.2.3.cmml" xref="S11.p1.5.m5.4.4.2.4"><cn id="S11.p1.5.m5.3.3.1.1.cmml" type="integer" xref="S11.p1.5.m5.3.3.1.1">1</cn><ci id="S11.p1.5.m5.4.4.2.2.cmml" xref="S11.p1.5.m5.4.4.2.2">𝑐</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.5.m5.4c">\mathbf{p}_{1,i}\in P_{1,c}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.5.m5.4d">bold_p start_POSTSUBSCRIPT 1 , italic_i end_POSTSUBSCRIPT ∈ italic_P start_POSTSUBSCRIPT 1 , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{p}_{2,j}\in P_{2,c}" class="ltx_Math" display="inline" id="S11.p1.6.m6.4"><semantics id="S11.p1.6.m6.4a"><mrow id="S11.p1.6.m6.4.5" xref="S11.p1.6.m6.4.5.cmml"><msub id="S11.p1.6.m6.4.5.2" xref="S11.p1.6.m6.4.5.2.cmml"><mi id="S11.p1.6.m6.4.5.2.2" xref="S11.p1.6.m6.4.5.2.2.cmml">𝐩</mi><mrow id="S11.p1.6.m6.2.2.2.4" xref="S11.p1.6.m6.2.2.2.3.cmml"><mn id="S11.p1.6.m6.1.1.1.1" xref="S11.p1.6.m6.1.1.1.1.cmml">2</mn><mo id="S11.p1.6.m6.2.2.2.4.1" xref="S11.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="S11.p1.6.m6.2.2.2.2" xref="S11.p1.6.m6.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S11.p1.6.m6.4.5.1" xref="S11.p1.6.m6.4.5.1.cmml">∈</mo><msub id="S11.p1.6.m6.4.5.3" xref="S11.p1.6.m6.4.5.3.cmml"><mi id="S11.p1.6.m6.4.5.3.2" xref="S11.p1.6.m6.4.5.3.2.cmml">P</mi><mrow id="S11.p1.6.m6.4.4.2.4" xref="S11.p1.6.m6.4.4.2.3.cmml"><mn id="S11.p1.6.m6.3.3.1.1" xref="S11.p1.6.m6.3.3.1.1.cmml">2</mn><mo id="S11.p1.6.m6.4.4.2.4.1" xref="S11.p1.6.m6.4.4.2.3.cmml">,</mo><mi id="S11.p1.6.m6.4.4.2.2" xref="S11.p1.6.m6.4.4.2.2.cmml">c</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.6.m6.4b"><apply id="S11.p1.6.m6.4.5.cmml" xref="S11.p1.6.m6.4.5"><in id="S11.p1.6.m6.4.5.1.cmml" xref="S11.p1.6.m6.4.5.1"></in><apply id="S11.p1.6.m6.4.5.2.cmml" xref="S11.p1.6.m6.4.5.2"><csymbol cd="ambiguous" id="S11.p1.6.m6.4.5.2.1.cmml" xref="S11.p1.6.m6.4.5.2">subscript</csymbol><ci id="S11.p1.6.m6.4.5.2.2.cmml" xref="S11.p1.6.m6.4.5.2.2">𝐩</ci><list id="S11.p1.6.m6.2.2.2.3.cmml" xref="S11.p1.6.m6.2.2.2.4"><cn id="S11.p1.6.m6.1.1.1.1.cmml" type="integer" xref="S11.p1.6.m6.1.1.1.1">2</cn><ci id="S11.p1.6.m6.2.2.2.2.cmml" xref="S11.p1.6.m6.2.2.2.2">𝑗</ci></list></apply><apply id="S11.p1.6.m6.4.5.3.cmml" xref="S11.p1.6.m6.4.5.3"><csymbol cd="ambiguous" id="S11.p1.6.m6.4.5.3.1.cmml" xref="S11.p1.6.m6.4.5.3">subscript</csymbol><ci id="S11.p1.6.m6.4.5.3.2.cmml" xref="S11.p1.6.m6.4.5.3.2">𝑃</ci><list id="S11.p1.6.m6.4.4.2.3.cmml" xref="S11.p1.6.m6.4.4.2.4"><cn id="S11.p1.6.m6.3.3.1.1.cmml" type="integer" xref="S11.p1.6.m6.3.3.1.1">2</cn><ci id="S11.p1.6.m6.4.4.2.2.cmml" xref="S11.p1.6.m6.4.4.2.2">𝑐</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.6.m6.4c">\mathbf{p}_{2,j}\in P_{2,c}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.6.m6.4d">bold_p start_POSTSUBSCRIPT 2 , italic_j end_POSTSUBSCRIPT ∈ italic_P start_POSTSUBSCRIPT 2 , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and compute their respective activation maps <math alttext="\mathbf{A}_{1,i}" class="ltx_Math" display="inline" id="S11.p1.7.m7.2"><semantics id="S11.p1.7.m7.2a"><msub id="S11.p1.7.m7.2.3" xref="S11.p1.7.m7.2.3.cmml"><mi id="S11.p1.7.m7.2.3.2" xref="S11.p1.7.m7.2.3.2.cmml">𝐀</mi><mrow id="S11.p1.7.m7.2.2.2.4" xref="S11.p1.7.m7.2.2.2.3.cmml"><mn id="S11.p1.7.m7.1.1.1.1" xref="S11.p1.7.m7.1.1.1.1.cmml">1</mn><mo id="S11.p1.7.m7.2.2.2.4.1" xref="S11.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S11.p1.7.m7.2.2.2.2" xref="S11.p1.7.m7.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p1.7.m7.2b"><apply id="S11.p1.7.m7.2.3.cmml" xref="S11.p1.7.m7.2.3"><csymbol cd="ambiguous" id="S11.p1.7.m7.2.3.1.cmml" xref="S11.p1.7.m7.2.3">subscript</csymbol><ci id="S11.p1.7.m7.2.3.2.cmml" xref="S11.p1.7.m7.2.3.2">𝐀</ci><list id="S11.p1.7.m7.2.2.2.3.cmml" xref="S11.p1.7.m7.2.2.2.4"><cn id="S11.p1.7.m7.1.1.1.1.cmml" type="integer" xref="S11.p1.7.m7.1.1.1.1">1</cn><ci id="S11.p1.7.m7.2.2.2.2.cmml" xref="S11.p1.7.m7.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.7.m7.2c">\mathbf{A}_{1,i}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.7.m7.2d">bold_A start_POSTSUBSCRIPT 1 , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from all <math alttext="\mathbf{z}_{1}\in f_{1}(\mathbf{x^{\prime}})" class="ltx_Math" display="inline" id="S11.p1.8.m8.1"><semantics id="S11.p1.8.m8.1a"><mrow id="S11.p1.8.m8.1.1" xref="S11.p1.8.m8.1.1.cmml"><msub id="S11.p1.8.m8.1.1.3" xref="S11.p1.8.m8.1.1.3.cmml"><mi id="S11.p1.8.m8.1.1.3.2" xref="S11.p1.8.m8.1.1.3.2.cmml">𝐳</mi><mn id="S11.p1.8.m8.1.1.3.3" xref="S11.p1.8.m8.1.1.3.3.cmml">1</mn></msub><mo id="S11.p1.8.m8.1.1.2" xref="S11.p1.8.m8.1.1.2.cmml">∈</mo><mrow id="S11.p1.8.m8.1.1.1" xref="S11.p1.8.m8.1.1.1.cmml"><msub id="S11.p1.8.m8.1.1.1.3" xref="S11.p1.8.m8.1.1.1.3.cmml"><mi id="S11.p1.8.m8.1.1.1.3.2" xref="S11.p1.8.m8.1.1.1.3.2.cmml">f</mi><mn id="S11.p1.8.m8.1.1.1.3.3" xref="S11.p1.8.m8.1.1.1.3.3.cmml">1</mn></msub><mo id="S11.p1.8.m8.1.1.1.2" xref="S11.p1.8.m8.1.1.1.2.cmml">⁢</mo><mrow id="S11.p1.8.m8.1.1.1.1.1" xref="S11.p1.8.m8.1.1.1.1.1.1.cmml"><mo id="S11.p1.8.m8.1.1.1.1.1.2" stretchy="false" xref="S11.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><msup id="S11.p1.8.m8.1.1.1.1.1.1" xref="S11.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S11.p1.8.m8.1.1.1.1.1.1.2" xref="S11.p1.8.m8.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="S11.p1.8.m8.1.1.1.1.1.1.3" xref="S11.p1.8.m8.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S11.p1.8.m8.1.1.1.1.1.3" stretchy="false" xref="S11.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.8.m8.1b"><apply id="S11.p1.8.m8.1.1.cmml" xref="S11.p1.8.m8.1.1"><in id="S11.p1.8.m8.1.1.2.cmml" xref="S11.p1.8.m8.1.1.2"></in><apply id="S11.p1.8.m8.1.1.3.cmml" xref="S11.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S11.p1.8.m8.1.1.3.1.cmml" xref="S11.p1.8.m8.1.1.3">subscript</csymbol><ci id="S11.p1.8.m8.1.1.3.2.cmml" xref="S11.p1.8.m8.1.1.3.2">𝐳</ci><cn id="S11.p1.8.m8.1.1.3.3.cmml" type="integer" xref="S11.p1.8.m8.1.1.3.3">1</cn></apply><apply id="S11.p1.8.m8.1.1.1.cmml" xref="S11.p1.8.m8.1.1.1"><times id="S11.p1.8.m8.1.1.1.2.cmml" xref="S11.p1.8.m8.1.1.1.2"></times><apply id="S11.p1.8.m8.1.1.1.3.cmml" xref="S11.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S11.p1.8.m8.1.1.1.3.1.cmml" xref="S11.p1.8.m8.1.1.1.3">subscript</csymbol><ci id="S11.p1.8.m8.1.1.1.3.2.cmml" xref="S11.p1.8.m8.1.1.1.3.2">𝑓</ci><cn id="S11.p1.8.m8.1.1.1.3.3.cmml" type="integer" xref="S11.p1.8.m8.1.1.1.3.3">1</cn></apply><apply id="S11.p1.8.m8.1.1.1.1.1.1.cmml" xref="S11.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S11.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S11.p1.8.m8.1.1.1.1.1">superscript</csymbol><ci id="S11.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S11.p1.8.m8.1.1.1.1.1.1.2">𝐱</ci><ci id="S11.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S11.p1.8.m8.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.8.m8.1c">\mathbf{z}_{1}\in f_{1}(\mathbf{x^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S11.p1.8.m8.1d">bold_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> with <math alttext="g_{\text{proto}}(\mathbf{z}_{1},\mathbf{p}_{1,i})" class="ltx_Math" display="inline" id="S11.p1.9.m9.4"><semantics id="S11.p1.9.m9.4a"><mrow id="S11.p1.9.m9.4.4" xref="S11.p1.9.m9.4.4.cmml"><msub id="S11.p1.9.m9.4.4.4" xref="S11.p1.9.m9.4.4.4.cmml"><mi id="S11.p1.9.m9.4.4.4.2" xref="S11.p1.9.m9.4.4.4.2.cmml">g</mi><mtext id="S11.p1.9.m9.4.4.4.3" xref="S11.p1.9.m9.4.4.4.3a.cmml">proto</mtext></msub><mo id="S11.p1.9.m9.4.4.3" xref="S11.p1.9.m9.4.4.3.cmml">⁢</mo><mrow id="S11.p1.9.m9.4.4.2.2" xref="S11.p1.9.m9.4.4.2.3.cmml"><mo id="S11.p1.9.m9.4.4.2.2.3" stretchy="false" xref="S11.p1.9.m9.4.4.2.3.cmml">(</mo><msub id="S11.p1.9.m9.3.3.1.1.1" xref="S11.p1.9.m9.3.3.1.1.1.cmml"><mi id="S11.p1.9.m9.3.3.1.1.1.2" xref="S11.p1.9.m9.3.3.1.1.1.2.cmml">𝐳</mi><mn id="S11.p1.9.m9.3.3.1.1.1.3" xref="S11.p1.9.m9.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S11.p1.9.m9.4.4.2.2.4" xref="S11.p1.9.m9.4.4.2.3.cmml">,</mo><msub id="S11.p1.9.m9.4.4.2.2.2" xref="S11.p1.9.m9.4.4.2.2.2.cmml"><mi id="S11.p1.9.m9.4.4.2.2.2.2" xref="S11.p1.9.m9.4.4.2.2.2.2.cmml">𝐩</mi><mrow id="S11.p1.9.m9.2.2.2.4" xref="S11.p1.9.m9.2.2.2.3.cmml"><mn id="S11.p1.9.m9.1.1.1.1" xref="S11.p1.9.m9.1.1.1.1.cmml">1</mn><mo id="S11.p1.9.m9.2.2.2.4.1" xref="S11.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S11.p1.9.m9.2.2.2.2" xref="S11.p1.9.m9.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S11.p1.9.m9.4.4.2.2.5" stretchy="false" xref="S11.p1.9.m9.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.9.m9.4b"><apply id="S11.p1.9.m9.4.4.cmml" xref="S11.p1.9.m9.4.4"><times id="S11.p1.9.m9.4.4.3.cmml" xref="S11.p1.9.m9.4.4.3"></times><apply id="S11.p1.9.m9.4.4.4.cmml" xref="S11.p1.9.m9.4.4.4"><csymbol cd="ambiguous" id="S11.p1.9.m9.4.4.4.1.cmml" xref="S11.p1.9.m9.4.4.4">subscript</csymbol><ci id="S11.p1.9.m9.4.4.4.2.cmml" xref="S11.p1.9.m9.4.4.4.2">𝑔</ci><ci id="S11.p1.9.m9.4.4.4.3a.cmml" xref="S11.p1.9.m9.4.4.4.3"><mtext id="S11.p1.9.m9.4.4.4.3.cmml" mathsize="70%" xref="S11.p1.9.m9.4.4.4.3">proto</mtext></ci></apply><interval closure="open" id="S11.p1.9.m9.4.4.2.3.cmml" xref="S11.p1.9.m9.4.4.2.2"><apply id="S11.p1.9.m9.3.3.1.1.1.cmml" xref="S11.p1.9.m9.3.3.1.1.1"><csymbol cd="ambiguous" id="S11.p1.9.m9.3.3.1.1.1.1.cmml" xref="S11.p1.9.m9.3.3.1.1.1">subscript</csymbol><ci id="S11.p1.9.m9.3.3.1.1.1.2.cmml" xref="S11.p1.9.m9.3.3.1.1.1.2">𝐳</ci><cn id="S11.p1.9.m9.3.3.1.1.1.3.cmml" type="integer" xref="S11.p1.9.m9.3.3.1.1.1.3">1</cn></apply><apply id="S11.p1.9.m9.4.4.2.2.2.cmml" xref="S11.p1.9.m9.4.4.2.2.2"><csymbol cd="ambiguous" id="S11.p1.9.m9.4.4.2.2.2.1.cmml" xref="S11.p1.9.m9.4.4.2.2.2">subscript</csymbol><ci id="S11.p1.9.m9.4.4.2.2.2.2.cmml" xref="S11.p1.9.m9.4.4.2.2.2.2">𝐩</ci><list id="S11.p1.9.m9.2.2.2.3.cmml" xref="S11.p1.9.m9.2.2.2.4"><cn id="S11.p1.9.m9.1.1.1.1.cmml" type="integer" xref="S11.p1.9.m9.1.1.1.1">1</cn><ci id="S11.p1.9.m9.2.2.2.2.cmml" xref="S11.p1.9.m9.2.2.2.2">𝑖</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.9.m9.4c">g_{\text{proto}}(\mathbf{z}_{1},\mathbf{p}_{1,i})</annotation><annotation encoding="application/x-llamapun" id="S11.p1.9.m9.4d">italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_p start_POSTSUBSCRIPT 1 , italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, and <math alttext="\mathbf{A}_{2,j}" class="ltx_Math" display="inline" id="S11.p1.10.m10.2"><semantics id="S11.p1.10.m10.2a"><msub id="S11.p1.10.m10.2.3" xref="S11.p1.10.m10.2.3.cmml"><mi id="S11.p1.10.m10.2.3.2" xref="S11.p1.10.m10.2.3.2.cmml">𝐀</mi><mrow id="S11.p1.10.m10.2.2.2.4" xref="S11.p1.10.m10.2.2.2.3.cmml"><mn id="S11.p1.10.m10.1.1.1.1" xref="S11.p1.10.m10.1.1.1.1.cmml">2</mn><mo id="S11.p1.10.m10.2.2.2.4.1" xref="S11.p1.10.m10.2.2.2.3.cmml">,</mo><mi id="S11.p1.10.m10.2.2.2.2" xref="S11.p1.10.m10.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p1.10.m10.2b"><apply id="S11.p1.10.m10.2.3.cmml" xref="S11.p1.10.m10.2.3"><csymbol cd="ambiguous" id="S11.p1.10.m10.2.3.1.cmml" xref="S11.p1.10.m10.2.3">subscript</csymbol><ci id="S11.p1.10.m10.2.3.2.cmml" xref="S11.p1.10.m10.2.3.2">𝐀</ci><list id="S11.p1.10.m10.2.2.2.3.cmml" xref="S11.p1.10.m10.2.2.2.4"><cn id="S11.p1.10.m10.1.1.1.1.cmml" type="integer" xref="S11.p1.10.m10.1.1.1.1">2</cn><ci id="S11.p1.10.m10.2.2.2.2.cmml" xref="S11.p1.10.m10.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.10.m10.2c">\mathbf{A}_{2,j}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.10.m10.2d">bold_A start_POSTSUBSCRIPT 2 , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> from all <math alttext="\mathbf{z}_{2}\in f_{2}(\mathbf{x})" class="ltx_Math" display="inline" id="S11.p1.11.m11.1"><semantics id="S11.p1.11.m11.1a"><mrow id="S11.p1.11.m11.1.2" xref="S11.p1.11.m11.1.2.cmml"><msub id="S11.p1.11.m11.1.2.2" xref="S11.p1.11.m11.1.2.2.cmml"><mi id="S11.p1.11.m11.1.2.2.2" xref="S11.p1.11.m11.1.2.2.2.cmml">𝐳</mi><mn id="S11.p1.11.m11.1.2.2.3" xref="S11.p1.11.m11.1.2.2.3.cmml">2</mn></msub><mo id="S11.p1.11.m11.1.2.1" xref="S11.p1.11.m11.1.2.1.cmml">∈</mo><mrow id="S11.p1.11.m11.1.2.3" xref="S11.p1.11.m11.1.2.3.cmml"><msub id="S11.p1.11.m11.1.2.3.2" xref="S11.p1.11.m11.1.2.3.2.cmml"><mi id="S11.p1.11.m11.1.2.3.2.2" xref="S11.p1.11.m11.1.2.3.2.2.cmml">f</mi><mn id="S11.p1.11.m11.1.2.3.2.3" xref="S11.p1.11.m11.1.2.3.2.3.cmml">2</mn></msub><mo id="S11.p1.11.m11.1.2.3.1" xref="S11.p1.11.m11.1.2.3.1.cmml">⁢</mo><mrow id="S11.p1.11.m11.1.2.3.3.2" xref="S11.p1.11.m11.1.2.3.cmml"><mo id="S11.p1.11.m11.1.2.3.3.2.1" stretchy="false" xref="S11.p1.11.m11.1.2.3.cmml">(</mo><mi id="S11.p1.11.m11.1.1" xref="S11.p1.11.m11.1.1.cmml">𝐱</mi><mo id="S11.p1.11.m11.1.2.3.3.2.2" stretchy="false" xref="S11.p1.11.m11.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.11.m11.1b"><apply id="S11.p1.11.m11.1.2.cmml" xref="S11.p1.11.m11.1.2"><in id="S11.p1.11.m11.1.2.1.cmml" xref="S11.p1.11.m11.1.2.1"></in><apply id="S11.p1.11.m11.1.2.2.cmml" xref="S11.p1.11.m11.1.2.2"><csymbol cd="ambiguous" id="S11.p1.11.m11.1.2.2.1.cmml" xref="S11.p1.11.m11.1.2.2">subscript</csymbol><ci id="S11.p1.11.m11.1.2.2.2.cmml" xref="S11.p1.11.m11.1.2.2.2">𝐳</ci><cn id="S11.p1.11.m11.1.2.2.3.cmml" type="integer" xref="S11.p1.11.m11.1.2.2.3">2</cn></apply><apply id="S11.p1.11.m11.1.2.3.cmml" xref="S11.p1.11.m11.1.2.3"><times id="S11.p1.11.m11.1.2.3.1.cmml" xref="S11.p1.11.m11.1.2.3.1"></times><apply id="S11.p1.11.m11.1.2.3.2.cmml" xref="S11.p1.11.m11.1.2.3.2"><csymbol cd="ambiguous" id="S11.p1.11.m11.1.2.3.2.1.cmml" xref="S11.p1.11.m11.1.2.3.2">subscript</csymbol><ci id="S11.p1.11.m11.1.2.3.2.2.cmml" xref="S11.p1.11.m11.1.2.3.2.2">𝑓</ci><cn id="S11.p1.11.m11.1.2.3.2.3.cmml" type="integer" xref="S11.p1.11.m11.1.2.3.2.3">2</cn></apply><ci id="S11.p1.11.m11.1.1.cmml" xref="S11.p1.11.m11.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.11.m11.1c">\mathbf{z}_{2}\in f_{2}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S11.p1.11.m11.1d">bold_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( bold_x )</annotation></semantics></math> with <math alttext="g_{\text{proto}}(\mathbf{z}_{2},\mathbf{p}_{2,j})" class="ltx_Math" display="inline" id="S11.p1.12.m12.4"><semantics id="S11.p1.12.m12.4a"><mrow id="S11.p1.12.m12.4.4" xref="S11.p1.12.m12.4.4.cmml"><msub id="S11.p1.12.m12.4.4.4" xref="S11.p1.12.m12.4.4.4.cmml"><mi id="S11.p1.12.m12.4.4.4.2" xref="S11.p1.12.m12.4.4.4.2.cmml">g</mi><mtext id="S11.p1.12.m12.4.4.4.3" xref="S11.p1.12.m12.4.4.4.3a.cmml">proto</mtext></msub><mo id="S11.p1.12.m12.4.4.3" xref="S11.p1.12.m12.4.4.3.cmml">⁢</mo><mrow id="S11.p1.12.m12.4.4.2.2" xref="S11.p1.12.m12.4.4.2.3.cmml"><mo id="S11.p1.12.m12.4.4.2.2.3" stretchy="false" xref="S11.p1.12.m12.4.4.2.3.cmml">(</mo><msub id="S11.p1.12.m12.3.3.1.1.1" xref="S11.p1.12.m12.3.3.1.1.1.cmml"><mi id="S11.p1.12.m12.3.3.1.1.1.2" xref="S11.p1.12.m12.3.3.1.1.1.2.cmml">𝐳</mi><mn id="S11.p1.12.m12.3.3.1.1.1.3" xref="S11.p1.12.m12.3.3.1.1.1.3.cmml">2</mn></msub><mo id="S11.p1.12.m12.4.4.2.2.4" xref="S11.p1.12.m12.4.4.2.3.cmml">,</mo><msub id="S11.p1.12.m12.4.4.2.2.2" xref="S11.p1.12.m12.4.4.2.2.2.cmml"><mi id="S11.p1.12.m12.4.4.2.2.2.2" xref="S11.p1.12.m12.4.4.2.2.2.2.cmml">𝐩</mi><mrow id="S11.p1.12.m12.2.2.2.4" xref="S11.p1.12.m12.2.2.2.3.cmml"><mn id="S11.p1.12.m12.1.1.1.1" xref="S11.p1.12.m12.1.1.1.1.cmml">2</mn><mo id="S11.p1.12.m12.2.2.2.4.1" xref="S11.p1.12.m12.2.2.2.3.cmml">,</mo><mi id="S11.p1.12.m12.2.2.2.2" xref="S11.p1.12.m12.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S11.p1.12.m12.4.4.2.2.5" stretchy="false" xref="S11.p1.12.m12.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.12.m12.4b"><apply id="S11.p1.12.m12.4.4.cmml" xref="S11.p1.12.m12.4.4"><times id="S11.p1.12.m12.4.4.3.cmml" xref="S11.p1.12.m12.4.4.3"></times><apply id="S11.p1.12.m12.4.4.4.cmml" xref="S11.p1.12.m12.4.4.4"><csymbol cd="ambiguous" id="S11.p1.12.m12.4.4.4.1.cmml" xref="S11.p1.12.m12.4.4.4">subscript</csymbol><ci id="S11.p1.12.m12.4.4.4.2.cmml" xref="S11.p1.12.m12.4.4.4.2">𝑔</ci><ci id="S11.p1.12.m12.4.4.4.3a.cmml" xref="S11.p1.12.m12.4.4.4.3"><mtext id="S11.p1.12.m12.4.4.4.3.cmml" mathsize="70%" xref="S11.p1.12.m12.4.4.4.3">proto</mtext></ci></apply><interval closure="open" id="S11.p1.12.m12.4.4.2.3.cmml" xref="S11.p1.12.m12.4.4.2.2"><apply id="S11.p1.12.m12.3.3.1.1.1.cmml" xref="S11.p1.12.m12.3.3.1.1.1"><csymbol cd="ambiguous" id="S11.p1.12.m12.3.3.1.1.1.1.cmml" xref="S11.p1.12.m12.3.3.1.1.1">subscript</csymbol><ci id="S11.p1.12.m12.3.3.1.1.1.2.cmml" xref="S11.p1.12.m12.3.3.1.1.1.2">𝐳</ci><cn id="S11.p1.12.m12.3.3.1.1.1.3.cmml" type="integer" xref="S11.p1.12.m12.3.3.1.1.1.3">2</cn></apply><apply id="S11.p1.12.m12.4.4.2.2.2.cmml" xref="S11.p1.12.m12.4.4.2.2.2"><csymbol cd="ambiguous" id="S11.p1.12.m12.4.4.2.2.2.1.cmml" xref="S11.p1.12.m12.4.4.2.2.2">subscript</csymbol><ci id="S11.p1.12.m12.4.4.2.2.2.2.cmml" xref="S11.p1.12.m12.4.4.2.2.2.2">𝐩</ci><list id="S11.p1.12.m12.2.2.2.3.cmml" xref="S11.p1.12.m12.2.2.2.4"><cn id="S11.p1.12.m12.1.1.1.1.cmml" type="integer" xref="S11.p1.12.m12.1.1.1.1">2</cn><ci id="S11.p1.12.m12.2.2.2.2.cmml" xref="S11.p1.12.m12.2.2.2.2">𝑗</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.12.m12.4c">g_{\text{proto}}(\mathbf{z}_{2},\mathbf{p}_{2,j})</annotation><annotation encoding="application/x-llamapun" id="S11.p1.12.m12.4d">italic_g start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , bold_p start_POSTSUBSCRIPT 2 , italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>. The pair of prototypes is considered as quasi-equivariant if:</p>
<table class="ltx_equation ltx_eqn_table" id="S11.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{\text{upsample}}(\mathbf{A}_{1,i})\sim\mathbf{A}_{2,j}" class="ltx_Math" display="block" id="S11.E10.m1.5"><semantics id="S11.E10.m1.5a"><mrow id="S11.E10.m1.5.5" xref="S11.E10.m1.5.5.cmml"><mrow id="S11.E10.m1.5.5.1" xref="S11.E10.m1.5.5.1.cmml"><msub id="S11.E10.m1.5.5.1.3" xref="S11.E10.m1.5.5.1.3.cmml"><mi id="S11.E10.m1.5.5.1.3.2" xref="S11.E10.m1.5.5.1.3.2.cmml">f</mi><mtext id="S11.E10.m1.5.5.1.3.3" xref="S11.E10.m1.5.5.1.3.3a.cmml">upsample</mtext></msub><mo id="S11.E10.m1.5.5.1.2" xref="S11.E10.m1.5.5.1.2.cmml">⁢</mo><mrow id="S11.E10.m1.5.5.1.1.1" xref="S11.E10.m1.5.5.1.1.1.1.cmml"><mo id="S11.E10.m1.5.5.1.1.1.2" stretchy="false" xref="S11.E10.m1.5.5.1.1.1.1.cmml">(</mo><msub id="S11.E10.m1.5.5.1.1.1.1" xref="S11.E10.m1.5.5.1.1.1.1.cmml"><mi id="S11.E10.m1.5.5.1.1.1.1.2" xref="S11.E10.m1.5.5.1.1.1.1.2.cmml">𝐀</mi><mrow id="S11.E10.m1.2.2.2.4" xref="S11.E10.m1.2.2.2.3.cmml"><mn id="S11.E10.m1.1.1.1.1" xref="S11.E10.m1.1.1.1.1.cmml">1</mn><mo id="S11.E10.m1.2.2.2.4.1" xref="S11.E10.m1.2.2.2.3.cmml">,</mo><mi id="S11.E10.m1.2.2.2.2" xref="S11.E10.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S11.E10.m1.5.5.1.1.1.3" stretchy="false" xref="S11.E10.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S11.E10.m1.5.5.2" xref="S11.E10.m1.5.5.2.cmml">∼</mo><msub id="S11.E10.m1.5.5.3" xref="S11.E10.m1.5.5.3.cmml"><mi id="S11.E10.m1.5.5.3.2" xref="S11.E10.m1.5.5.3.2.cmml">𝐀</mi><mrow id="S11.E10.m1.4.4.2.4" xref="S11.E10.m1.4.4.2.3.cmml"><mn id="S11.E10.m1.3.3.1.1" xref="S11.E10.m1.3.3.1.1.cmml">2</mn><mo id="S11.E10.m1.4.4.2.4.1" xref="S11.E10.m1.4.4.2.3.cmml">,</mo><mi id="S11.E10.m1.4.4.2.2" xref="S11.E10.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S11.E10.m1.5b"><apply id="S11.E10.m1.5.5.cmml" xref="S11.E10.m1.5.5"><csymbol cd="latexml" id="S11.E10.m1.5.5.2.cmml" xref="S11.E10.m1.5.5.2">similar-to</csymbol><apply id="S11.E10.m1.5.5.1.cmml" xref="S11.E10.m1.5.5.1"><times id="S11.E10.m1.5.5.1.2.cmml" xref="S11.E10.m1.5.5.1.2"></times><apply id="S11.E10.m1.5.5.1.3.cmml" xref="S11.E10.m1.5.5.1.3"><csymbol cd="ambiguous" id="S11.E10.m1.5.5.1.3.1.cmml" xref="S11.E10.m1.5.5.1.3">subscript</csymbol><ci id="S11.E10.m1.5.5.1.3.2.cmml" xref="S11.E10.m1.5.5.1.3.2">𝑓</ci><ci id="S11.E10.m1.5.5.1.3.3a.cmml" xref="S11.E10.m1.5.5.1.3.3"><mtext id="S11.E10.m1.5.5.1.3.3.cmml" mathsize="70%" xref="S11.E10.m1.5.5.1.3.3">upsample</mtext></ci></apply><apply id="S11.E10.m1.5.5.1.1.1.1.cmml" xref="S11.E10.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S11.E10.m1.5.5.1.1.1.1.1.cmml" xref="S11.E10.m1.5.5.1.1.1">subscript</csymbol><ci id="S11.E10.m1.5.5.1.1.1.1.2.cmml" xref="S11.E10.m1.5.5.1.1.1.1.2">𝐀</ci><list id="S11.E10.m1.2.2.2.3.cmml" xref="S11.E10.m1.2.2.2.4"><cn id="S11.E10.m1.1.1.1.1.cmml" type="integer" xref="S11.E10.m1.1.1.1.1">1</cn><ci id="S11.E10.m1.2.2.2.2.cmml" xref="S11.E10.m1.2.2.2.2">𝑖</ci></list></apply></apply><apply id="S11.E10.m1.5.5.3.cmml" xref="S11.E10.m1.5.5.3"><csymbol cd="ambiguous" id="S11.E10.m1.5.5.3.1.cmml" xref="S11.E10.m1.5.5.3">subscript</csymbol><ci id="S11.E10.m1.5.5.3.2.cmml" xref="S11.E10.m1.5.5.3.2">𝐀</ci><list id="S11.E10.m1.4.4.2.3.cmml" xref="S11.E10.m1.4.4.2.4"><cn id="S11.E10.m1.3.3.1.1.cmml" type="integer" xref="S11.E10.m1.3.3.1.1">2</cn><ci id="S11.E10.m1.4.4.2.2.cmml" xref="S11.E10.m1.4.4.2.2">𝑗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.E10.m1.5c">f_{\text{upsample}}(\mathbf{A}_{1,i})\sim\mathbf{A}_{2,j}</annotation><annotation encoding="application/x-llamapun" id="S11.E10.m1.5d">italic_f start_POSTSUBSCRIPT upsample end_POSTSUBSCRIPT ( bold_A start_POSTSUBSCRIPT 1 , italic_i end_POSTSUBSCRIPT ) ∼ bold_A start_POSTSUBSCRIPT 2 , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S11.p1.15">with <math alttext="f_{\text{upsample}}" class="ltx_Math" display="inline" id="S11.p1.13.m1.1"><semantics id="S11.p1.13.m1.1a"><msub id="S11.p1.13.m1.1.1" xref="S11.p1.13.m1.1.1.cmml"><mi id="S11.p1.13.m1.1.1.2" xref="S11.p1.13.m1.1.1.2.cmml">f</mi><mtext id="S11.p1.13.m1.1.1.3" xref="S11.p1.13.m1.1.1.3a.cmml">upsample</mtext></msub><annotation-xml encoding="MathML-Content" id="S11.p1.13.m1.1b"><apply id="S11.p1.13.m1.1.1.cmml" xref="S11.p1.13.m1.1.1"><csymbol cd="ambiguous" id="S11.p1.13.m1.1.1.1.cmml" xref="S11.p1.13.m1.1.1">subscript</csymbol><ci id="S11.p1.13.m1.1.1.2.cmml" xref="S11.p1.13.m1.1.1.2">𝑓</ci><ci id="S11.p1.13.m1.1.1.3a.cmml" xref="S11.p1.13.m1.1.1.3"><mtext id="S11.p1.13.m1.1.1.3.cmml" mathsize="70%" xref="S11.p1.13.m1.1.1.3">upsample</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.13.m1.1c">f_{\text{upsample}}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.13.m1.1d">italic_f start_POSTSUBSCRIPT upsample end_POSTSUBSCRIPT</annotation></semantics></math> the upsampling function for <math alttext="\mathbf{A}_{1,i}" class="ltx_Math" display="inline" id="S11.p1.14.m2.2"><semantics id="S11.p1.14.m2.2a"><msub id="S11.p1.14.m2.2.3" xref="S11.p1.14.m2.2.3.cmml"><mi id="S11.p1.14.m2.2.3.2" xref="S11.p1.14.m2.2.3.2.cmml">𝐀</mi><mrow id="S11.p1.14.m2.2.2.2.4" xref="S11.p1.14.m2.2.2.2.3.cmml"><mn id="S11.p1.14.m2.1.1.1.1" xref="S11.p1.14.m2.1.1.1.1.cmml">1</mn><mo id="S11.p1.14.m2.2.2.2.4.1" xref="S11.p1.14.m2.2.2.2.3.cmml">,</mo><mi id="S11.p1.14.m2.2.2.2.2" xref="S11.p1.14.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p1.14.m2.2b"><apply id="S11.p1.14.m2.2.3.cmml" xref="S11.p1.14.m2.2.3"><csymbol cd="ambiguous" id="S11.p1.14.m2.2.3.1.cmml" xref="S11.p1.14.m2.2.3">subscript</csymbol><ci id="S11.p1.14.m2.2.3.2.cmml" xref="S11.p1.14.m2.2.3.2">𝐀</ci><list id="S11.p1.14.m2.2.2.2.3.cmml" xref="S11.p1.14.m2.2.2.2.4"><cn id="S11.p1.14.m2.1.1.1.1.cmml" type="integer" xref="S11.p1.14.m2.1.1.1.1">1</cn><ci id="S11.p1.14.m2.2.2.2.2.cmml" xref="S11.p1.14.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.14.m2.2c">\mathbf{A}_{1,i}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.14.m2.2d">bold_A start_POSTSUBSCRIPT 1 , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to the original size of <math alttext="\mathbf{A}_{2,j}" class="ltx_Math" display="inline" id="S11.p1.15.m3.2"><semantics id="S11.p1.15.m3.2a"><msub id="S11.p1.15.m3.2.3" xref="S11.p1.15.m3.2.3.cmml"><mi id="S11.p1.15.m3.2.3.2" xref="S11.p1.15.m3.2.3.2.cmml">𝐀</mi><mrow id="S11.p1.15.m3.2.2.2.4" xref="S11.p1.15.m3.2.2.2.3.cmml"><mn id="S11.p1.15.m3.1.1.1.1" xref="S11.p1.15.m3.1.1.1.1.cmml">2</mn><mo id="S11.p1.15.m3.2.2.2.4.1" xref="S11.p1.15.m3.2.2.2.3.cmml">,</mo><mi id="S11.p1.15.m3.2.2.2.2" xref="S11.p1.15.m3.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p1.15.m3.2b"><apply id="S11.p1.15.m3.2.3.cmml" xref="S11.p1.15.m3.2.3"><csymbol cd="ambiguous" id="S11.p1.15.m3.2.3.1.cmml" xref="S11.p1.15.m3.2.3">subscript</csymbol><ci id="S11.p1.15.m3.2.3.2.cmml" xref="S11.p1.15.m3.2.3.2">𝐀</ci><list id="S11.p1.15.m3.2.2.2.3.cmml" xref="S11.p1.15.m3.2.2.2.4"><cn id="S11.p1.15.m3.1.1.1.1.cmml" type="integer" xref="S11.p1.15.m3.1.1.1.1">2</cn><ci id="S11.p1.15.m3.2.2.2.2.cmml" xref="S11.p1.15.m3.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.15.m3.2c">\mathbf{A}_{2,j}</annotation><annotation encoding="application/x-llamapun" id="S11.p1.15.m3.2d">bold_A start_POSTSUBSCRIPT 2 , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. The similarity measure between activations is defined below.</p>
</div>
<div class="ltx_para" id="S11.p2">
<p class="ltx_p" id="S11.p2.25">In order to identify the sets of prototypes with quasi-equivariant activations for a specific class <math alttext="c\in\mathcal{C}" class="ltx_Math" display="inline" id="S11.p2.1.m1.1"><semantics id="S11.p2.1.m1.1a"><mrow id="S11.p2.1.m1.1.1" xref="S11.p2.1.m1.1.1.cmml"><mi id="S11.p2.1.m1.1.1.2" xref="S11.p2.1.m1.1.1.2.cmml">c</mi><mo id="S11.p2.1.m1.1.1.1" xref="S11.p2.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S11.p2.1.m1.1.1.3" xref="S11.p2.1.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.1.m1.1b"><apply id="S11.p2.1.m1.1.1.cmml" xref="S11.p2.1.m1.1.1"><in id="S11.p2.1.m1.1.1.1.cmml" xref="S11.p2.1.m1.1.1.1"></in><ci id="S11.p2.1.m1.1.1.2.cmml" xref="S11.p2.1.m1.1.1.2">𝑐</ci><ci id="S11.p2.1.m1.1.1.3.cmml" xref="S11.p2.1.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.1.m1.1c">c\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.1.m1.1d">italic_c ∈ caligraphic_C</annotation></semantics></math> we first specify the increasing atrous rates ratio of each ASPP output feature maps with respect to the smallest one: <math alttext="\{r_{1\rightarrow 1},r_{1\rightarrow 2},r_{1\rightarrow 3},r_{1\rightarrow 4}\}" class="ltx_Math" display="inline" id="S11.p2.2.m2.4"><semantics id="S11.p2.2.m2.4a"><mrow id="S11.p2.2.m2.4.4.4" xref="S11.p2.2.m2.4.4.5.cmml"><mo id="S11.p2.2.m2.4.4.4.5" stretchy="false" xref="S11.p2.2.m2.4.4.5.cmml">{</mo><msub id="S11.p2.2.m2.1.1.1.1" xref="S11.p2.2.m2.1.1.1.1.cmml"><mi id="S11.p2.2.m2.1.1.1.1.2" xref="S11.p2.2.m2.1.1.1.1.2.cmml">r</mi><mrow id="S11.p2.2.m2.1.1.1.1.3" xref="S11.p2.2.m2.1.1.1.1.3.cmml"><mn id="S11.p2.2.m2.1.1.1.1.3.2" xref="S11.p2.2.m2.1.1.1.1.3.2.cmml">1</mn><mo id="S11.p2.2.m2.1.1.1.1.3.1" stretchy="false" xref="S11.p2.2.m2.1.1.1.1.3.1.cmml">→</mo><mn id="S11.p2.2.m2.1.1.1.1.3.3" xref="S11.p2.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S11.p2.2.m2.4.4.4.6" xref="S11.p2.2.m2.4.4.5.cmml">,</mo><msub id="S11.p2.2.m2.2.2.2.2" xref="S11.p2.2.m2.2.2.2.2.cmml"><mi id="S11.p2.2.m2.2.2.2.2.2" xref="S11.p2.2.m2.2.2.2.2.2.cmml">r</mi><mrow id="S11.p2.2.m2.2.2.2.2.3" xref="S11.p2.2.m2.2.2.2.2.3.cmml"><mn id="S11.p2.2.m2.2.2.2.2.3.2" xref="S11.p2.2.m2.2.2.2.2.3.2.cmml">1</mn><mo id="S11.p2.2.m2.2.2.2.2.3.1" stretchy="false" xref="S11.p2.2.m2.2.2.2.2.3.1.cmml">→</mo><mn id="S11.p2.2.m2.2.2.2.2.3.3" xref="S11.p2.2.m2.2.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S11.p2.2.m2.4.4.4.7" xref="S11.p2.2.m2.4.4.5.cmml">,</mo><msub id="S11.p2.2.m2.3.3.3.3" xref="S11.p2.2.m2.3.3.3.3.cmml"><mi id="S11.p2.2.m2.3.3.3.3.2" xref="S11.p2.2.m2.3.3.3.3.2.cmml">r</mi><mrow id="S11.p2.2.m2.3.3.3.3.3" xref="S11.p2.2.m2.3.3.3.3.3.cmml"><mn id="S11.p2.2.m2.3.3.3.3.3.2" xref="S11.p2.2.m2.3.3.3.3.3.2.cmml">1</mn><mo id="S11.p2.2.m2.3.3.3.3.3.1" stretchy="false" xref="S11.p2.2.m2.3.3.3.3.3.1.cmml">→</mo><mn id="S11.p2.2.m2.3.3.3.3.3.3" xref="S11.p2.2.m2.3.3.3.3.3.3.cmml">3</mn></mrow></msub><mo id="S11.p2.2.m2.4.4.4.8" xref="S11.p2.2.m2.4.4.5.cmml">,</mo><msub id="S11.p2.2.m2.4.4.4.4" xref="S11.p2.2.m2.4.4.4.4.cmml"><mi id="S11.p2.2.m2.4.4.4.4.2" xref="S11.p2.2.m2.4.4.4.4.2.cmml">r</mi><mrow id="S11.p2.2.m2.4.4.4.4.3" xref="S11.p2.2.m2.4.4.4.4.3.cmml"><mn id="S11.p2.2.m2.4.4.4.4.3.2" xref="S11.p2.2.m2.4.4.4.4.3.2.cmml">1</mn><mo id="S11.p2.2.m2.4.4.4.4.3.1" stretchy="false" xref="S11.p2.2.m2.4.4.4.4.3.1.cmml">→</mo><mn id="S11.p2.2.m2.4.4.4.4.3.3" xref="S11.p2.2.m2.4.4.4.4.3.3.cmml">4</mn></mrow></msub><mo id="S11.p2.2.m2.4.4.4.9" stretchy="false" xref="S11.p2.2.m2.4.4.5.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.2.m2.4b"><set id="S11.p2.2.m2.4.4.5.cmml" xref="S11.p2.2.m2.4.4.4"><apply id="S11.p2.2.m2.1.1.1.1.cmml" xref="S11.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S11.p2.2.m2.1.1.1.1.1.cmml" xref="S11.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S11.p2.2.m2.1.1.1.1.2.cmml" xref="S11.p2.2.m2.1.1.1.1.2">𝑟</ci><apply id="S11.p2.2.m2.1.1.1.1.3.cmml" xref="S11.p2.2.m2.1.1.1.1.3"><ci id="S11.p2.2.m2.1.1.1.1.3.1.cmml" xref="S11.p2.2.m2.1.1.1.1.3.1">→</ci><cn id="S11.p2.2.m2.1.1.1.1.3.2.cmml" type="integer" xref="S11.p2.2.m2.1.1.1.1.3.2">1</cn><cn id="S11.p2.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S11.p2.2.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S11.p2.2.m2.2.2.2.2.cmml" xref="S11.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S11.p2.2.m2.2.2.2.2.1.cmml" xref="S11.p2.2.m2.2.2.2.2">subscript</csymbol><ci id="S11.p2.2.m2.2.2.2.2.2.cmml" xref="S11.p2.2.m2.2.2.2.2.2">𝑟</ci><apply id="S11.p2.2.m2.2.2.2.2.3.cmml" xref="S11.p2.2.m2.2.2.2.2.3"><ci id="S11.p2.2.m2.2.2.2.2.3.1.cmml" xref="S11.p2.2.m2.2.2.2.2.3.1">→</ci><cn id="S11.p2.2.m2.2.2.2.2.3.2.cmml" type="integer" xref="S11.p2.2.m2.2.2.2.2.3.2">1</cn><cn id="S11.p2.2.m2.2.2.2.2.3.3.cmml" type="integer" xref="S11.p2.2.m2.2.2.2.2.3.3">2</cn></apply></apply><apply id="S11.p2.2.m2.3.3.3.3.cmml" xref="S11.p2.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S11.p2.2.m2.3.3.3.3.1.cmml" xref="S11.p2.2.m2.3.3.3.3">subscript</csymbol><ci id="S11.p2.2.m2.3.3.3.3.2.cmml" xref="S11.p2.2.m2.3.3.3.3.2">𝑟</ci><apply id="S11.p2.2.m2.3.3.3.3.3.cmml" xref="S11.p2.2.m2.3.3.3.3.3"><ci id="S11.p2.2.m2.3.3.3.3.3.1.cmml" xref="S11.p2.2.m2.3.3.3.3.3.1">→</ci><cn id="S11.p2.2.m2.3.3.3.3.3.2.cmml" type="integer" xref="S11.p2.2.m2.3.3.3.3.3.2">1</cn><cn id="S11.p2.2.m2.3.3.3.3.3.3.cmml" type="integer" xref="S11.p2.2.m2.3.3.3.3.3.3">3</cn></apply></apply><apply id="S11.p2.2.m2.4.4.4.4.cmml" xref="S11.p2.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="S11.p2.2.m2.4.4.4.4.1.cmml" xref="S11.p2.2.m2.4.4.4.4">subscript</csymbol><ci id="S11.p2.2.m2.4.4.4.4.2.cmml" xref="S11.p2.2.m2.4.4.4.4.2">𝑟</ci><apply id="S11.p2.2.m2.4.4.4.4.3.cmml" xref="S11.p2.2.m2.4.4.4.4.3"><ci id="S11.p2.2.m2.4.4.4.4.3.1.cmml" xref="S11.p2.2.m2.4.4.4.4.3.1">→</ci><cn id="S11.p2.2.m2.4.4.4.4.3.2.cmml" type="integer" xref="S11.p2.2.m2.4.4.4.4.3.2">1</cn><cn id="S11.p2.2.m2.4.4.4.4.3.3.cmml" type="integer" xref="S11.p2.2.m2.4.4.4.4.3.3">4</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.2.m2.4c">\{r_{1\rightarrow 1},r_{1\rightarrow 2},r_{1\rightarrow 3},r_{1\rightarrow 4}\}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.2.m2.4d">{ italic_r start_POSTSUBSCRIPT 1 → 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 → 2 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 → 3 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 → 4 end_POSTSUBSCRIPT }</annotation></semantics></math> in the case of <math alttext="S=4" class="ltx_Math" display="inline" id="S11.p2.3.m3.1"><semantics id="S11.p2.3.m3.1a"><mrow id="S11.p2.3.m3.1.1" xref="S11.p2.3.m3.1.1.cmml"><mi id="S11.p2.3.m3.1.1.2" xref="S11.p2.3.m3.1.1.2.cmml">S</mi><mo id="S11.p2.3.m3.1.1.1" xref="S11.p2.3.m3.1.1.1.cmml">=</mo><mn id="S11.p2.3.m3.1.1.3" xref="S11.p2.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.3.m3.1b"><apply id="S11.p2.3.m3.1.1.cmml" xref="S11.p2.3.m3.1.1"><eq id="S11.p2.3.m3.1.1.1.cmml" xref="S11.p2.3.m3.1.1.1"></eq><ci id="S11.p2.3.m3.1.1.2.cmml" xref="S11.p2.3.m3.1.1.2">𝑆</ci><cn id="S11.p2.3.m3.1.1.3.cmml" type="integer" xref="S11.p2.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.3.m3.1c">S=4</annotation><annotation encoding="application/x-llamapun" id="S11.p2.3.m3.1d">italic_S = 4</annotation></semantics></math>. The objective is to compute for all training images <math alttext="\mathbf{x}\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S11.p2.4.m4.1"><semantics id="S11.p2.4.m4.1a"><mrow id="S11.p2.4.m4.1.1" xref="S11.p2.4.m4.1.1.cmml"><mi id="S11.p2.4.m4.1.1.2" xref="S11.p2.4.m4.1.1.2.cmml">𝐱</mi><mo id="S11.p2.4.m4.1.1.1" xref="S11.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S11.p2.4.m4.1.1.3" xref="S11.p2.4.m4.1.1.3.cmml"><mi id="S11.p2.4.m4.1.1.3.2" xref="S11.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S11.p2.4.m4.1.1.3.3" xref="S11.p2.4.m4.1.1.3.3.cmml"><mi id="S11.p2.4.m4.1.1.3.3.2" xref="S11.p2.4.m4.1.1.3.3.2.cmml">H</mi><mo id="S11.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S11.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S11.p2.4.m4.1.1.3.3.3" xref="S11.p2.4.m4.1.1.3.3.3.cmml">W</mi><mo id="S11.p2.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S11.p2.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S11.p2.4.m4.1.1.3.3.4" xref="S11.p2.4.m4.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.4.m4.1b"><apply id="S11.p2.4.m4.1.1.cmml" xref="S11.p2.4.m4.1.1"><in id="S11.p2.4.m4.1.1.1.cmml" xref="S11.p2.4.m4.1.1.1"></in><ci id="S11.p2.4.m4.1.1.2.cmml" xref="S11.p2.4.m4.1.1.2">𝐱</ci><apply id="S11.p2.4.m4.1.1.3.cmml" xref="S11.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S11.p2.4.m4.1.1.3.1.cmml" xref="S11.p2.4.m4.1.1.3">superscript</csymbol><ci id="S11.p2.4.m4.1.1.3.2.cmml" xref="S11.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S11.p2.4.m4.1.1.3.3.cmml" xref="S11.p2.4.m4.1.1.3.3"><times id="S11.p2.4.m4.1.1.3.3.1.cmml" xref="S11.p2.4.m4.1.1.3.3.1"></times><ci id="S11.p2.4.m4.1.1.3.3.2.cmml" xref="S11.p2.4.m4.1.1.3.3.2">𝐻</ci><ci id="S11.p2.4.m4.1.1.3.3.3.cmml" xref="S11.p2.4.m4.1.1.3.3.3">𝑊</ci><cn id="S11.p2.4.m4.1.1.3.3.4.cmml" type="integer" xref="S11.p2.4.m4.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.4.m4.1c">\mathbf{x}\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.4.m4.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, downscaled versions of the original image <math alttext="\mathbf{x}_{1\rightarrow s}" class="ltx_Math" display="inline" id="S11.p2.5.m5.1"><semantics id="S11.p2.5.m5.1a"><msub id="S11.p2.5.m5.1.1" xref="S11.p2.5.m5.1.1.cmml"><mi id="S11.p2.5.m5.1.1.2" xref="S11.p2.5.m5.1.1.2.cmml">𝐱</mi><mrow id="S11.p2.5.m5.1.1.3" xref="S11.p2.5.m5.1.1.3.cmml"><mn id="S11.p2.5.m5.1.1.3.2" xref="S11.p2.5.m5.1.1.3.2.cmml">1</mn><mo id="S11.p2.5.m5.1.1.3.1" stretchy="false" xref="S11.p2.5.m5.1.1.3.1.cmml">→</mo><mi id="S11.p2.5.m5.1.1.3.3" xref="S11.p2.5.m5.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p2.5.m5.1b"><apply id="S11.p2.5.m5.1.1.cmml" xref="S11.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S11.p2.5.m5.1.1.1.cmml" xref="S11.p2.5.m5.1.1">subscript</csymbol><ci id="S11.p2.5.m5.1.1.2.cmml" xref="S11.p2.5.m5.1.1.2">𝐱</ci><apply id="S11.p2.5.m5.1.1.3.cmml" xref="S11.p2.5.m5.1.1.3"><ci id="S11.p2.5.m5.1.1.3.1.cmml" xref="S11.p2.5.m5.1.1.3.1">→</ci><cn id="S11.p2.5.m5.1.1.3.2.cmml" type="integer" xref="S11.p2.5.m5.1.1.3.2">1</cn><ci id="S11.p2.5.m5.1.1.3.3.cmml" xref="S11.p2.5.m5.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.5.m5.1c">\mathbf{x}_{1\rightarrow s}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.5.m5.1d">bold_x start_POSTSUBSCRIPT 1 → italic_s end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="\mathbf{x}_{1\rightarrow s}\in\mathbb{R}^{\frac{H}{r_{1\rightarrow s}}\times%
\frac{W}{r_{1\rightarrow s}}\times 3}" class="ltx_Math" display="inline" id="S11.p2.6.m6.1"><semantics id="S11.p2.6.m6.1a"><mrow id="S11.p2.6.m6.1.1" xref="S11.p2.6.m6.1.1.cmml"><msub id="S11.p2.6.m6.1.1.2" xref="S11.p2.6.m6.1.1.2.cmml"><mi id="S11.p2.6.m6.1.1.2.2" xref="S11.p2.6.m6.1.1.2.2.cmml">𝐱</mi><mrow id="S11.p2.6.m6.1.1.2.3" xref="S11.p2.6.m6.1.1.2.3.cmml"><mn id="S11.p2.6.m6.1.1.2.3.2" xref="S11.p2.6.m6.1.1.2.3.2.cmml">1</mn><mo id="S11.p2.6.m6.1.1.2.3.1" stretchy="false" xref="S11.p2.6.m6.1.1.2.3.1.cmml">→</mo><mi id="S11.p2.6.m6.1.1.2.3.3" xref="S11.p2.6.m6.1.1.2.3.3.cmml">s</mi></mrow></msub><mo id="S11.p2.6.m6.1.1.1" xref="S11.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S11.p2.6.m6.1.1.3" xref="S11.p2.6.m6.1.1.3.cmml"><mi id="S11.p2.6.m6.1.1.3.2" xref="S11.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S11.p2.6.m6.1.1.3.3" xref="S11.p2.6.m6.1.1.3.3.cmml"><mfrac id="S11.p2.6.m6.1.1.3.3.2" xref="S11.p2.6.m6.1.1.3.3.2.cmml"><mi id="S11.p2.6.m6.1.1.3.3.2.2" xref="S11.p2.6.m6.1.1.3.3.2.2.cmml">H</mi><msub id="S11.p2.6.m6.1.1.3.3.2.3" xref="S11.p2.6.m6.1.1.3.3.2.3.cmml"><mi id="S11.p2.6.m6.1.1.3.3.2.3.2" xref="S11.p2.6.m6.1.1.3.3.2.3.2.cmml">r</mi><mrow id="S11.p2.6.m6.1.1.3.3.2.3.3" xref="S11.p2.6.m6.1.1.3.3.2.3.3.cmml"><mn id="S11.p2.6.m6.1.1.3.3.2.3.3.2" xref="S11.p2.6.m6.1.1.3.3.2.3.3.2.cmml">1</mn><mo id="S11.p2.6.m6.1.1.3.3.2.3.3.1" stretchy="false" xref="S11.p2.6.m6.1.1.3.3.2.3.3.1.cmml">→</mo><mi id="S11.p2.6.m6.1.1.3.3.2.3.3.3" xref="S11.p2.6.m6.1.1.3.3.2.3.3.3.cmml">s</mi></mrow></msub></mfrac><mo id="S11.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S11.p2.6.m6.1.1.3.3.1.cmml">×</mo><mfrac id="S11.p2.6.m6.1.1.3.3.3" xref="S11.p2.6.m6.1.1.3.3.3.cmml"><mi id="S11.p2.6.m6.1.1.3.3.3.2" xref="S11.p2.6.m6.1.1.3.3.3.2.cmml">W</mi><msub id="S11.p2.6.m6.1.1.3.3.3.3" xref="S11.p2.6.m6.1.1.3.3.3.3.cmml"><mi id="S11.p2.6.m6.1.1.3.3.3.3.2" xref="S11.p2.6.m6.1.1.3.3.3.3.2.cmml">r</mi><mrow id="S11.p2.6.m6.1.1.3.3.3.3.3" xref="S11.p2.6.m6.1.1.3.3.3.3.3.cmml"><mn id="S11.p2.6.m6.1.1.3.3.3.3.3.2" xref="S11.p2.6.m6.1.1.3.3.3.3.3.2.cmml">1</mn><mo id="S11.p2.6.m6.1.1.3.3.3.3.3.1" stretchy="false" xref="S11.p2.6.m6.1.1.3.3.3.3.3.1.cmml">→</mo><mi id="S11.p2.6.m6.1.1.3.3.3.3.3.3" xref="S11.p2.6.m6.1.1.3.3.3.3.3.3.cmml">s</mi></mrow></msub></mfrac><mo id="S11.p2.6.m6.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S11.p2.6.m6.1.1.3.3.1.cmml">×</mo><mn id="S11.p2.6.m6.1.1.3.3.4" xref="S11.p2.6.m6.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.6.m6.1b"><apply id="S11.p2.6.m6.1.1.cmml" xref="S11.p2.6.m6.1.1"><in id="S11.p2.6.m6.1.1.1.cmml" xref="S11.p2.6.m6.1.1.1"></in><apply id="S11.p2.6.m6.1.1.2.cmml" xref="S11.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S11.p2.6.m6.1.1.2.1.cmml" xref="S11.p2.6.m6.1.1.2">subscript</csymbol><ci id="S11.p2.6.m6.1.1.2.2.cmml" xref="S11.p2.6.m6.1.1.2.2">𝐱</ci><apply id="S11.p2.6.m6.1.1.2.3.cmml" xref="S11.p2.6.m6.1.1.2.3"><ci id="S11.p2.6.m6.1.1.2.3.1.cmml" xref="S11.p2.6.m6.1.1.2.3.1">→</ci><cn id="S11.p2.6.m6.1.1.2.3.2.cmml" type="integer" xref="S11.p2.6.m6.1.1.2.3.2">1</cn><ci id="S11.p2.6.m6.1.1.2.3.3.cmml" xref="S11.p2.6.m6.1.1.2.3.3">𝑠</ci></apply></apply><apply id="S11.p2.6.m6.1.1.3.cmml" xref="S11.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S11.p2.6.m6.1.1.3.1.cmml" xref="S11.p2.6.m6.1.1.3">superscript</csymbol><ci id="S11.p2.6.m6.1.1.3.2.cmml" xref="S11.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S11.p2.6.m6.1.1.3.3.cmml" xref="S11.p2.6.m6.1.1.3.3"><times id="S11.p2.6.m6.1.1.3.3.1.cmml" xref="S11.p2.6.m6.1.1.3.3.1"></times><apply id="S11.p2.6.m6.1.1.3.3.2.cmml" xref="S11.p2.6.m6.1.1.3.3.2"><divide id="S11.p2.6.m6.1.1.3.3.2.1.cmml" xref="S11.p2.6.m6.1.1.3.3.2"></divide><ci id="S11.p2.6.m6.1.1.3.3.2.2.cmml" xref="S11.p2.6.m6.1.1.3.3.2.2">𝐻</ci><apply id="S11.p2.6.m6.1.1.3.3.2.3.cmml" xref="S11.p2.6.m6.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S11.p2.6.m6.1.1.3.3.2.3.1.cmml" xref="S11.p2.6.m6.1.1.3.3.2.3">subscript</csymbol><ci id="S11.p2.6.m6.1.1.3.3.2.3.2.cmml" xref="S11.p2.6.m6.1.1.3.3.2.3.2">𝑟</ci><apply id="S11.p2.6.m6.1.1.3.3.2.3.3.cmml" xref="S11.p2.6.m6.1.1.3.3.2.3.3"><ci id="S11.p2.6.m6.1.1.3.3.2.3.3.1.cmml" xref="S11.p2.6.m6.1.1.3.3.2.3.3.1">→</ci><cn id="S11.p2.6.m6.1.1.3.3.2.3.3.2.cmml" type="integer" xref="S11.p2.6.m6.1.1.3.3.2.3.3.2">1</cn><ci id="S11.p2.6.m6.1.1.3.3.2.3.3.3.cmml" xref="S11.p2.6.m6.1.1.3.3.2.3.3.3">𝑠</ci></apply></apply></apply><apply id="S11.p2.6.m6.1.1.3.3.3.cmml" xref="S11.p2.6.m6.1.1.3.3.3"><divide id="S11.p2.6.m6.1.1.3.3.3.1.cmml" xref="S11.p2.6.m6.1.1.3.3.3"></divide><ci id="S11.p2.6.m6.1.1.3.3.3.2.cmml" xref="S11.p2.6.m6.1.1.3.3.3.2">𝑊</ci><apply id="S11.p2.6.m6.1.1.3.3.3.3.cmml" xref="S11.p2.6.m6.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S11.p2.6.m6.1.1.3.3.3.3.1.cmml" xref="S11.p2.6.m6.1.1.3.3.3.3">subscript</csymbol><ci id="S11.p2.6.m6.1.1.3.3.3.3.2.cmml" xref="S11.p2.6.m6.1.1.3.3.3.3.2">𝑟</ci><apply id="S11.p2.6.m6.1.1.3.3.3.3.3.cmml" xref="S11.p2.6.m6.1.1.3.3.3.3.3"><ci id="S11.p2.6.m6.1.1.3.3.3.3.3.1.cmml" xref="S11.p2.6.m6.1.1.3.3.3.3.3.1">→</ci><cn id="S11.p2.6.m6.1.1.3.3.3.3.3.2.cmml" type="integer" xref="S11.p2.6.m6.1.1.3.3.3.3.3.2">1</cn><ci id="S11.p2.6.m6.1.1.3.3.3.3.3.3.cmml" xref="S11.p2.6.m6.1.1.3.3.3.3.3.3">𝑠</ci></apply></apply></apply><cn id="S11.p2.6.m6.1.1.3.3.4.cmml" type="integer" xref="S11.p2.6.m6.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.6.m6.1c">\mathbf{x}_{1\rightarrow s}\in\mathbb{R}^{\frac{H}{r_{1\rightarrow s}}\times%
\frac{W}{r_{1\rightarrow s}}\times 3}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.6.m6.1d">bold_x start_POSTSUBSCRIPT 1 → italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_H end_ARG start_ARG italic_r start_POSTSUBSCRIPT 1 → italic_s end_POSTSUBSCRIPT end_ARG × divide start_ARG italic_W end_ARG start_ARG italic_r start_POSTSUBSCRIPT 1 → italic_s end_POSTSUBSCRIPT end_ARG × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. Then, for all distinct pairs of feature map scales such that <math alttext="(s,s^{\prime})\in S^{2}" class="ltx_Math" display="inline" id="S11.p2.7.m7.2"><semantics id="S11.p2.7.m7.2a"><mrow id="S11.p2.7.m7.2.2" xref="S11.p2.7.m7.2.2.cmml"><mrow id="S11.p2.7.m7.2.2.1.1" xref="S11.p2.7.m7.2.2.1.2.cmml"><mo id="S11.p2.7.m7.2.2.1.1.2" stretchy="false" xref="S11.p2.7.m7.2.2.1.2.cmml">(</mo><mi id="S11.p2.7.m7.1.1" xref="S11.p2.7.m7.1.1.cmml">s</mi><mo id="S11.p2.7.m7.2.2.1.1.3" xref="S11.p2.7.m7.2.2.1.2.cmml">,</mo><msup id="S11.p2.7.m7.2.2.1.1.1" xref="S11.p2.7.m7.2.2.1.1.1.cmml"><mi id="S11.p2.7.m7.2.2.1.1.1.2" xref="S11.p2.7.m7.2.2.1.1.1.2.cmml">s</mi><mo id="S11.p2.7.m7.2.2.1.1.1.3" xref="S11.p2.7.m7.2.2.1.1.1.3.cmml">′</mo></msup><mo id="S11.p2.7.m7.2.2.1.1.4" stretchy="false" xref="S11.p2.7.m7.2.2.1.2.cmml">)</mo></mrow><mo id="S11.p2.7.m7.2.2.2" xref="S11.p2.7.m7.2.2.2.cmml">∈</mo><msup id="S11.p2.7.m7.2.2.3" xref="S11.p2.7.m7.2.2.3.cmml"><mi id="S11.p2.7.m7.2.2.3.2" xref="S11.p2.7.m7.2.2.3.2.cmml">S</mi><mn id="S11.p2.7.m7.2.2.3.3" xref="S11.p2.7.m7.2.2.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.7.m7.2b"><apply id="S11.p2.7.m7.2.2.cmml" xref="S11.p2.7.m7.2.2"><in id="S11.p2.7.m7.2.2.2.cmml" xref="S11.p2.7.m7.2.2.2"></in><interval closure="open" id="S11.p2.7.m7.2.2.1.2.cmml" xref="S11.p2.7.m7.2.2.1.1"><ci id="S11.p2.7.m7.1.1.cmml" xref="S11.p2.7.m7.1.1">𝑠</ci><apply id="S11.p2.7.m7.2.2.1.1.1.cmml" xref="S11.p2.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S11.p2.7.m7.2.2.1.1.1.1.cmml" xref="S11.p2.7.m7.2.2.1.1.1">superscript</csymbol><ci id="S11.p2.7.m7.2.2.1.1.1.2.cmml" xref="S11.p2.7.m7.2.2.1.1.1.2">𝑠</ci><ci id="S11.p2.7.m7.2.2.1.1.1.3.cmml" xref="S11.p2.7.m7.2.2.1.1.1.3">′</ci></apply></interval><apply id="S11.p2.7.m7.2.2.3.cmml" xref="S11.p2.7.m7.2.2.3"><csymbol cd="ambiguous" id="S11.p2.7.m7.2.2.3.1.cmml" xref="S11.p2.7.m7.2.2.3">superscript</csymbol><ci id="S11.p2.7.m7.2.2.3.2.cmml" xref="S11.p2.7.m7.2.2.3.2">𝑆</ci><cn id="S11.p2.7.m7.2.2.3.3.cmml" type="integer" xref="S11.p2.7.m7.2.2.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.7.m7.2c">(s,s^{\prime})\in S^{2}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.7.m7.2d">( italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∈ italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="s&lt;s^{\prime}" class="ltx_Math" display="inline" id="S11.p2.8.m8.1"><semantics id="S11.p2.8.m8.1a"><mrow id="S11.p2.8.m8.1.1" xref="S11.p2.8.m8.1.1.cmml"><mi id="S11.p2.8.m8.1.1.2" xref="S11.p2.8.m8.1.1.2.cmml">s</mi><mo id="S11.p2.8.m8.1.1.1" xref="S11.p2.8.m8.1.1.1.cmml">&lt;</mo><msup id="S11.p2.8.m8.1.1.3" xref="S11.p2.8.m8.1.1.3.cmml"><mi id="S11.p2.8.m8.1.1.3.2" xref="S11.p2.8.m8.1.1.3.2.cmml">s</mi><mo id="S11.p2.8.m8.1.1.3.3" xref="S11.p2.8.m8.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.8.m8.1b"><apply id="S11.p2.8.m8.1.1.cmml" xref="S11.p2.8.m8.1.1"><lt id="S11.p2.8.m8.1.1.1.cmml" xref="S11.p2.8.m8.1.1.1"></lt><ci id="S11.p2.8.m8.1.1.2.cmml" xref="S11.p2.8.m8.1.1.2">𝑠</ci><apply id="S11.p2.8.m8.1.1.3.cmml" xref="S11.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S11.p2.8.m8.1.1.3.1.cmml" xref="S11.p2.8.m8.1.1.3">superscript</csymbol><ci id="S11.p2.8.m8.1.1.3.2.cmml" xref="S11.p2.8.m8.1.1.3.2">𝑠</ci><ci id="S11.p2.8.m8.1.1.3.3.cmml" xref="S11.p2.8.m8.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.8.m8.1c">s&lt;s^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.8.m8.1d">italic_s &lt; italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, we select <math alttext="\mathbf{x}_{1\rightarrow s}" class="ltx_Math" display="inline" id="S11.p2.9.m9.1"><semantics id="S11.p2.9.m9.1a"><msub id="S11.p2.9.m9.1.1" xref="S11.p2.9.m9.1.1.cmml"><mi id="S11.p2.9.m9.1.1.2" xref="S11.p2.9.m9.1.1.2.cmml">𝐱</mi><mrow id="S11.p2.9.m9.1.1.3" xref="S11.p2.9.m9.1.1.3.cmml"><mn id="S11.p2.9.m9.1.1.3.2" xref="S11.p2.9.m9.1.1.3.2.cmml">1</mn><mo id="S11.p2.9.m9.1.1.3.1" stretchy="false" xref="S11.p2.9.m9.1.1.3.1.cmml">→</mo><mi id="S11.p2.9.m9.1.1.3.3" xref="S11.p2.9.m9.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p2.9.m9.1b"><apply id="S11.p2.9.m9.1.1.cmml" xref="S11.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S11.p2.9.m9.1.1.1.cmml" xref="S11.p2.9.m9.1.1">subscript</csymbol><ci id="S11.p2.9.m9.1.1.2.cmml" xref="S11.p2.9.m9.1.1.2">𝐱</ci><apply id="S11.p2.9.m9.1.1.3.cmml" xref="S11.p2.9.m9.1.1.3"><ci id="S11.p2.9.m9.1.1.3.1.cmml" xref="S11.p2.9.m9.1.1.3.1">→</ci><cn id="S11.p2.9.m9.1.1.3.2.cmml" type="integer" xref="S11.p2.9.m9.1.1.3.2">1</cn><ci id="S11.p2.9.m9.1.1.3.3.cmml" xref="S11.p2.9.m9.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.9.m9.1c">\mathbf{x}_{1\rightarrow s}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.9.m9.1d">bold_x start_POSTSUBSCRIPT 1 → italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{x}_{1\rightarrow s^{\prime}}" class="ltx_Math" display="inline" id="S11.p2.10.m10.1"><semantics id="S11.p2.10.m10.1a"><msub id="S11.p2.10.m10.1.1" xref="S11.p2.10.m10.1.1.cmml"><mi id="S11.p2.10.m10.1.1.2" xref="S11.p2.10.m10.1.1.2.cmml">𝐱</mi><mrow id="S11.p2.10.m10.1.1.3" xref="S11.p2.10.m10.1.1.3.cmml"><mn id="S11.p2.10.m10.1.1.3.2" xref="S11.p2.10.m10.1.1.3.2.cmml">1</mn><mo id="S11.p2.10.m10.1.1.3.1" stretchy="false" xref="S11.p2.10.m10.1.1.3.1.cmml">→</mo><msup id="S11.p2.10.m10.1.1.3.3" xref="S11.p2.10.m10.1.1.3.3.cmml"><mi id="S11.p2.10.m10.1.1.3.3.2" xref="S11.p2.10.m10.1.1.3.3.2.cmml">s</mi><mo id="S11.p2.10.m10.1.1.3.3.3" xref="S11.p2.10.m10.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p2.10.m10.1b"><apply id="S11.p2.10.m10.1.1.cmml" xref="S11.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S11.p2.10.m10.1.1.1.cmml" xref="S11.p2.10.m10.1.1">subscript</csymbol><ci id="S11.p2.10.m10.1.1.2.cmml" xref="S11.p2.10.m10.1.1.2">𝐱</ci><apply id="S11.p2.10.m10.1.1.3.cmml" xref="S11.p2.10.m10.1.1.3"><ci id="S11.p2.10.m10.1.1.3.1.cmml" xref="S11.p2.10.m10.1.1.3.1">→</ci><cn id="S11.p2.10.m10.1.1.3.2.cmml" type="integer" xref="S11.p2.10.m10.1.1.3.2">1</cn><apply id="S11.p2.10.m10.1.1.3.3.cmml" xref="S11.p2.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S11.p2.10.m10.1.1.3.3.1.cmml" xref="S11.p2.10.m10.1.1.3.3">superscript</csymbol><ci id="S11.p2.10.m10.1.1.3.3.2.cmml" xref="S11.p2.10.m10.1.1.3.3.2">𝑠</ci><ci id="S11.p2.10.m10.1.1.3.3.3.cmml" xref="S11.p2.10.m10.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.10.m10.1c">\mathbf{x}_{1\rightarrow s^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.10.m10.1d">bold_x start_POSTSUBSCRIPT 1 → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to compute <math alttext="f_{s}(\mathbf{x}_{1\rightarrow s^{\prime}})" class="ltx_Math" display="inline" id="S11.p2.11.m11.1"><semantics id="S11.p2.11.m11.1a"><mrow id="S11.p2.11.m11.1.1" xref="S11.p2.11.m11.1.1.cmml"><msub id="S11.p2.11.m11.1.1.3" xref="S11.p2.11.m11.1.1.3.cmml"><mi id="S11.p2.11.m11.1.1.3.2" xref="S11.p2.11.m11.1.1.3.2.cmml">f</mi><mi id="S11.p2.11.m11.1.1.3.3" xref="S11.p2.11.m11.1.1.3.3.cmml">s</mi></msub><mo id="S11.p2.11.m11.1.1.2" xref="S11.p2.11.m11.1.1.2.cmml">⁢</mo><mrow id="S11.p2.11.m11.1.1.1.1" xref="S11.p2.11.m11.1.1.1.1.1.cmml"><mo id="S11.p2.11.m11.1.1.1.1.2" stretchy="false" xref="S11.p2.11.m11.1.1.1.1.1.cmml">(</mo><msub id="S11.p2.11.m11.1.1.1.1.1" xref="S11.p2.11.m11.1.1.1.1.1.cmml"><mi id="S11.p2.11.m11.1.1.1.1.1.2" xref="S11.p2.11.m11.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S11.p2.11.m11.1.1.1.1.1.3" xref="S11.p2.11.m11.1.1.1.1.1.3.cmml"><mn id="S11.p2.11.m11.1.1.1.1.1.3.2" xref="S11.p2.11.m11.1.1.1.1.1.3.2.cmml">1</mn><mo id="S11.p2.11.m11.1.1.1.1.1.3.1" stretchy="false" xref="S11.p2.11.m11.1.1.1.1.1.3.1.cmml">→</mo><msup id="S11.p2.11.m11.1.1.1.1.1.3.3" xref="S11.p2.11.m11.1.1.1.1.1.3.3.cmml"><mi id="S11.p2.11.m11.1.1.1.1.1.3.3.2" xref="S11.p2.11.m11.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S11.p2.11.m11.1.1.1.1.1.3.3.3" xref="S11.p2.11.m11.1.1.1.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><mo id="S11.p2.11.m11.1.1.1.1.3" stretchy="false" xref="S11.p2.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.11.m11.1b"><apply id="S11.p2.11.m11.1.1.cmml" xref="S11.p2.11.m11.1.1"><times id="S11.p2.11.m11.1.1.2.cmml" xref="S11.p2.11.m11.1.1.2"></times><apply id="S11.p2.11.m11.1.1.3.cmml" xref="S11.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S11.p2.11.m11.1.1.3.1.cmml" xref="S11.p2.11.m11.1.1.3">subscript</csymbol><ci id="S11.p2.11.m11.1.1.3.2.cmml" xref="S11.p2.11.m11.1.1.3.2">𝑓</ci><ci id="S11.p2.11.m11.1.1.3.3.cmml" xref="S11.p2.11.m11.1.1.3.3">𝑠</ci></apply><apply id="S11.p2.11.m11.1.1.1.1.1.cmml" xref="S11.p2.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S11.p2.11.m11.1.1.1.1.1.1.cmml" xref="S11.p2.11.m11.1.1.1.1">subscript</csymbol><ci id="S11.p2.11.m11.1.1.1.1.1.2.cmml" xref="S11.p2.11.m11.1.1.1.1.1.2">𝐱</ci><apply id="S11.p2.11.m11.1.1.1.1.1.3.cmml" xref="S11.p2.11.m11.1.1.1.1.1.3"><ci id="S11.p2.11.m11.1.1.1.1.1.3.1.cmml" xref="S11.p2.11.m11.1.1.1.1.1.3.1">→</ci><cn id="S11.p2.11.m11.1.1.1.1.1.3.2.cmml" type="integer" xref="S11.p2.11.m11.1.1.1.1.1.3.2">1</cn><apply id="S11.p2.11.m11.1.1.1.1.1.3.3.cmml" xref="S11.p2.11.m11.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S11.p2.11.m11.1.1.1.1.1.3.3.1.cmml" xref="S11.p2.11.m11.1.1.1.1.1.3.3">superscript</csymbol><ci id="S11.p2.11.m11.1.1.1.1.1.3.3.2.cmml" xref="S11.p2.11.m11.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S11.p2.11.m11.1.1.1.1.1.3.3.3.cmml" xref="S11.p2.11.m11.1.1.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.11.m11.1c">f_{s}(\mathbf{x}_{1\rightarrow s^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S11.p2.11.m11.1d">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 1 → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="f_{s^{\prime}}(\mathbf{x}_{1\rightarrow s})" class="ltx_Math" display="inline" id="S11.p2.12.m12.1"><semantics id="S11.p2.12.m12.1a"><mrow id="S11.p2.12.m12.1.1" xref="S11.p2.12.m12.1.1.cmml"><msub id="S11.p2.12.m12.1.1.3" xref="S11.p2.12.m12.1.1.3.cmml"><mi id="S11.p2.12.m12.1.1.3.2" xref="S11.p2.12.m12.1.1.3.2.cmml">f</mi><msup id="S11.p2.12.m12.1.1.3.3" xref="S11.p2.12.m12.1.1.3.3.cmml"><mi id="S11.p2.12.m12.1.1.3.3.2" xref="S11.p2.12.m12.1.1.3.3.2.cmml">s</mi><mo id="S11.p2.12.m12.1.1.3.3.3" xref="S11.p2.12.m12.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S11.p2.12.m12.1.1.2" xref="S11.p2.12.m12.1.1.2.cmml">⁢</mo><mrow id="S11.p2.12.m12.1.1.1.1" xref="S11.p2.12.m12.1.1.1.1.1.cmml"><mo id="S11.p2.12.m12.1.1.1.1.2" stretchy="false" xref="S11.p2.12.m12.1.1.1.1.1.cmml">(</mo><msub id="S11.p2.12.m12.1.1.1.1.1" xref="S11.p2.12.m12.1.1.1.1.1.cmml"><mi id="S11.p2.12.m12.1.1.1.1.1.2" xref="S11.p2.12.m12.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S11.p2.12.m12.1.1.1.1.1.3" xref="S11.p2.12.m12.1.1.1.1.1.3.cmml"><mn id="S11.p2.12.m12.1.1.1.1.1.3.2" xref="S11.p2.12.m12.1.1.1.1.1.3.2.cmml">1</mn><mo id="S11.p2.12.m12.1.1.1.1.1.3.1" stretchy="false" xref="S11.p2.12.m12.1.1.1.1.1.3.1.cmml">→</mo><mi id="S11.p2.12.m12.1.1.1.1.1.3.3" xref="S11.p2.12.m12.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S11.p2.12.m12.1.1.1.1.3" stretchy="false" xref="S11.p2.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.12.m12.1b"><apply id="S11.p2.12.m12.1.1.cmml" xref="S11.p2.12.m12.1.1"><times id="S11.p2.12.m12.1.1.2.cmml" xref="S11.p2.12.m12.1.1.2"></times><apply id="S11.p2.12.m12.1.1.3.cmml" xref="S11.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="S11.p2.12.m12.1.1.3.1.cmml" xref="S11.p2.12.m12.1.1.3">subscript</csymbol><ci id="S11.p2.12.m12.1.1.3.2.cmml" xref="S11.p2.12.m12.1.1.3.2">𝑓</ci><apply id="S11.p2.12.m12.1.1.3.3.cmml" xref="S11.p2.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S11.p2.12.m12.1.1.3.3.1.cmml" xref="S11.p2.12.m12.1.1.3.3">superscript</csymbol><ci id="S11.p2.12.m12.1.1.3.3.2.cmml" xref="S11.p2.12.m12.1.1.3.3.2">𝑠</ci><ci id="S11.p2.12.m12.1.1.3.3.3.cmml" xref="S11.p2.12.m12.1.1.3.3.3">′</ci></apply></apply><apply id="S11.p2.12.m12.1.1.1.1.1.cmml" xref="S11.p2.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S11.p2.12.m12.1.1.1.1.1.1.cmml" xref="S11.p2.12.m12.1.1.1.1">subscript</csymbol><ci id="S11.p2.12.m12.1.1.1.1.1.2.cmml" xref="S11.p2.12.m12.1.1.1.1.1.2">𝐱</ci><apply id="S11.p2.12.m12.1.1.1.1.1.3.cmml" xref="S11.p2.12.m12.1.1.1.1.1.3"><ci id="S11.p2.12.m12.1.1.1.1.1.3.1.cmml" xref="S11.p2.12.m12.1.1.1.1.1.3.1">→</ci><cn id="S11.p2.12.m12.1.1.1.1.1.3.2.cmml" type="integer" xref="S11.p2.12.m12.1.1.1.1.1.3.2">1</cn><ci id="S11.p2.12.m12.1.1.1.1.1.3.3.cmml" xref="S11.p2.12.m12.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.12.m12.1c">f_{s^{\prime}}(\mathbf{x}_{1\rightarrow s})</annotation><annotation encoding="application/x-llamapun" id="S11.p2.12.m12.1d">italic_f start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 1 → italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>. The objective is to align, through the downscaling of the image, the semantic parts covered by the FOV of each ASPP scale <math alttext="s" class="ltx_Math" display="inline" id="S11.p2.13.m13.1"><semantics id="S11.p2.13.m13.1a"><mi id="S11.p2.13.m13.1.1" xref="S11.p2.13.m13.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S11.p2.13.m13.1b"><ci id="S11.p2.13.m13.1.1.cmml" xref="S11.p2.13.m13.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.13.m13.1c">s</annotation><annotation encoding="application/x-llamapun" id="S11.p2.13.m13.1d">italic_s</annotation></semantics></math> and <math alttext="s^{\prime}" class="ltx_Math" display="inline" id="S11.p2.14.m14.1"><semantics id="S11.p2.14.m14.1a"><msup id="S11.p2.14.m14.1.1" xref="S11.p2.14.m14.1.1.cmml"><mi id="S11.p2.14.m14.1.1.2" xref="S11.p2.14.m14.1.1.2.cmml">s</mi><mo id="S11.p2.14.m14.1.1.3" xref="S11.p2.14.m14.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S11.p2.14.m14.1b"><apply id="S11.p2.14.m14.1.1.cmml" xref="S11.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S11.p2.14.m14.1.1.1.cmml" xref="S11.p2.14.m14.1.1">superscript</csymbol><ci id="S11.p2.14.m14.1.1.2.cmml" xref="S11.p2.14.m14.1.1.2">𝑠</ci><ci id="S11.p2.14.m14.1.1.3.cmml" xref="S11.p2.14.m14.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.14.m14.1c">s^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.14.m14.1d">italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. Then we compare all pairs of prototypes from the scales <math alttext="s" class="ltx_Math" display="inline" id="S11.p2.15.m15.1"><semantics id="S11.p2.15.m15.1a"><mi id="S11.p2.15.m15.1.1" xref="S11.p2.15.m15.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S11.p2.15.m15.1b"><ci id="S11.p2.15.m15.1.1.cmml" xref="S11.p2.15.m15.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.15.m15.1c">s</annotation><annotation encoding="application/x-llamapun" id="S11.p2.15.m15.1d">italic_s</annotation></semantics></math> and <math alttext="s^{\prime}" class="ltx_Math" display="inline" id="S11.p2.16.m16.1"><semantics id="S11.p2.16.m16.1a"><msup id="S11.p2.16.m16.1.1" xref="S11.p2.16.m16.1.1.cmml"><mi id="S11.p2.16.m16.1.1.2" xref="S11.p2.16.m16.1.1.2.cmml">s</mi><mo id="S11.p2.16.m16.1.1.3" xref="S11.p2.16.m16.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S11.p2.16.m16.1b"><apply id="S11.p2.16.m16.1.1.cmml" xref="S11.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S11.p2.16.m16.1.1.1.cmml" xref="S11.p2.16.m16.1.1">superscript</csymbol><ci id="S11.p2.16.m16.1.1.2.cmml" xref="S11.p2.16.m16.1.1.2">𝑠</ci><ci id="S11.p2.16.m16.1.1.3.cmml" xref="S11.p2.16.m16.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.16.m16.1c">s^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.16.m16.1d">italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. For a specific pair <math alttext="(\mathbf{p}_{s,i},\mathbf{p}_{s^{\prime},j})" class="ltx_Math" display="inline" id="S11.p2.17.m17.6"><semantics id="S11.p2.17.m17.6a"><mrow id="S11.p2.17.m17.6.6.2" xref="S11.p2.17.m17.6.6.3.cmml"><mo id="S11.p2.17.m17.6.6.2.3" stretchy="false" xref="S11.p2.17.m17.6.6.3.cmml">(</mo><msub id="S11.p2.17.m17.5.5.1.1" xref="S11.p2.17.m17.5.5.1.1.cmml"><mi id="S11.p2.17.m17.5.5.1.1.2" xref="S11.p2.17.m17.5.5.1.1.2.cmml">𝐩</mi><mrow id="S11.p2.17.m17.2.2.2.4" xref="S11.p2.17.m17.2.2.2.3.cmml"><mi id="S11.p2.17.m17.1.1.1.1" xref="S11.p2.17.m17.1.1.1.1.cmml">s</mi><mo id="S11.p2.17.m17.2.2.2.4.1" xref="S11.p2.17.m17.2.2.2.3.cmml">,</mo><mi id="S11.p2.17.m17.2.2.2.2" xref="S11.p2.17.m17.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S11.p2.17.m17.6.6.2.4" xref="S11.p2.17.m17.6.6.3.cmml">,</mo><msub id="S11.p2.17.m17.6.6.2.2" xref="S11.p2.17.m17.6.6.2.2.cmml"><mi id="S11.p2.17.m17.6.6.2.2.2" xref="S11.p2.17.m17.6.6.2.2.2.cmml">𝐩</mi><mrow id="S11.p2.17.m17.4.4.2.2" xref="S11.p2.17.m17.4.4.2.3.cmml"><msup id="S11.p2.17.m17.4.4.2.2.1" xref="S11.p2.17.m17.4.4.2.2.1.cmml"><mi id="S11.p2.17.m17.4.4.2.2.1.2" xref="S11.p2.17.m17.4.4.2.2.1.2.cmml">s</mi><mo id="S11.p2.17.m17.4.4.2.2.1.3" xref="S11.p2.17.m17.4.4.2.2.1.3.cmml">′</mo></msup><mo id="S11.p2.17.m17.4.4.2.2.2" xref="S11.p2.17.m17.4.4.2.3.cmml">,</mo><mi id="S11.p2.17.m17.3.3.1.1" xref="S11.p2.17.m17.3.3.1.1.cmml">j</mi></mrow></msub><mo id="S11.p2.17.m17.6.6.2.5" stretchy="false" xref="S11.p2.17.m17.6.6.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.17.m17.6b"><interval closure="open" id="S11.p2.17.m17.6.6.3.cmml" xref="S11.p2.17.m17.6.6.2"><apply id="S11.p2.17.m17.5.5.1.1.cmml" xref="S11.p2.17.m17.5.5.1.1"><csymbol cd="ambiguous" id="S11.p2.17.m17.5.5.1.1.1.cmml" xref="S11.p2.17.m17.5.5.1.1">subscript</csymbol><ci id="S11.p2.17.m17.5.5.1.1.2.cmml" xref="S11.p2.17.m17.5.5.1.1.2">𝐩</ci><list id="S11.p2.17.m17.2.2.2.3.cmml" xref="S11.p2.17.m17.2.2.2.4"><ci id="S11.p2.17.m17.1.1.1.1.cmml" xref="S11.p2.17.m17.1.1.1.1">𝑠</ci><ci id="S11.p2.17.m17.2.2.2.2.cmml" xref="S11.p2.17.m17.2.2.2.2">𝑖</ci></list></apply><apply id="S11.p2.17.m17.6.6.2.2.cmml" xref="S11.p2.17.m17.6.6.2.2"><csymbol cd="ambiguous" id="S11.p2.17.m17.6.6.2.2.1.cmml" xref="S11.p2.17.m17.6.6.2.2">subscript</csymbol><ci id="S11.p2.17.m17.6.6.2.2.2.cmml" xref="S11.p2.17.m17.6.6.2.2.2">𝐩</ci><list id="S11.p2.17.m17.4.4.2.3.cmml" xref="S11.p2.17.m17.4.4.2.2"><apply id="S11.p2.17.m17.4.4.2.2.1.cmml" xref="S11.p2.17.m17.4.4.2.2.1"><csymbol cd="ambiguous" id="S11.p2.17.m17.4.4.2.2.1.1.cmml" xref="S11.p2.17.m17.4.4.2.2.1">superscript</csymbol><ci id="S11.p2.17.m17.4.4.2.2.1.2.cmml" xref="S11.p2.17.m17.4.4.2.2.1.2">𝑠</ci><ci id="S11.p2.17.m17.4.4.2.2.1.3.cmml" xref="S11.p2.17.m17.4.4.2.2.1.3">′</ci></apply><ci id="S11.p2.17.m17.3.3.1.1.cmml" xref="S11.p2.17.m17.3.3.1.1">𝑗</ci></list></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.17.m17.6c">(\mathbf{p}_{s,i},\mathbf{p}_{s^{\prime},j})</annotation><annotation encoding="application/x-llamapun" id="S11.p2.17.m17.6d">( bold_p start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT , bold_p start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> we compute from the feature maps <math alttext="f_{s}(\mathbf{x}_{1\rightarrow s^{\prime}})" class="ltx_Math" display="inline" id="S11.p2.18.m18.1"><semantics id="S11.p2.18.m18.1a"><mrow id="S11.p2.18.m18.1.1" xref="S11.p2.18.m18.1.1.cmml"><msub id="S11.p2.18.m18.1.1.3" xref="S11.p2.18.m18.1.1.3.cmml"><mi id="S11.p2.18.m18.1.1.3.2" xref="S11.p2.18.m18.1.1.3.2.cmml">f</mi><mi id="S11.p2.18.m18.1.1.3.3" xref="S11.p2.18.m18.1.1.3.3.cmml">s</mi></msub><mo id="S11.p2.18.m18.1.1.2" xref="S11.p2.18.m18.1.1.2.cmml">⁢</mo><mrow id="S11.p2.18.m18.1.1.1.1" xref="S11.p2.18.m18.1.1.1.1.1.cmml"><mo id="S11.p2.18.m18.1.1.1.1.2" stretchy="false" xref="S11.p2.18.m18.1.1.1.1.1.cmml">(</mo><msub id="S11.p2.18.m18.1.1.1.1.1" xref="S11.p2.18.m18.1.1.1.1.1.cmml"><mi id="S11.p2.18.m18.1.1.1.1.1.2" xref="S11.p2.18.m18.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S11.p2.18.m18.1.1.1.1.1.3" xref="S11.p2.18.m18.1.1.1.1.1.3.cmml"><mn id="S11.p2.18.m18.1.1.1.1.1.3.2" xref="S11.p2.18.m18.1.1.1.1.1.3.2.cmml">1</mn><mo id="S11.p2.18.m18.1.1.1.1.1.3.1" stretchy="false" xref="S11.p2.18.m18.1.1.1.1.1.3.1.cmml">→</mo><msup id="S11.p2.18.m18.1.1.1.1.1.3.3" xref="S11.p2.18.m18.1.1.1.1.1.3.3.cmml"><mi id="S11.p2.18.m18.1.1.1.1.1.3.3.2" xref="S11.p2.18.m18.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S11.p2.18.m18.1.1.1.1.1.3.3.3" xref="S11.p2.18.m18.1.1.1.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><mo id="S11.p2.18.m18.1.1.1.1.3" stretchy="false" xref="S11.p2.18.m18.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.18.m18.1b"><apply id="S11.p2.18.m18.1.1.cmml" xref="S11.p2.18.m18.1.1"><times id="S11.p2.18.m18.1.1.2.cmml" xref="S11.p2.18.m18.1.1.2"></times><apply id="S11.p2.18.m18.1.1.3.cmml" xref="S11.p2.18.m18.1.1.3"><csymbol cd="ambiguous" id="S11.p2.18.m18.1.1.3.1.cmml" xref="S11.p2.18.m18.1.1.3">subscript</csymbol><ci id="S11.p2.18.m18.1.1.3.2.cmml" xref="S11.p2.18.m18.1.1.3.2">𝑓</ci><ci id="S11.p2.18.m18.1.1.3.3.cmml" xref="S11.p2.18.m18.1.1.3.3">𝑠</ci></apply><apply id="S11.p2.18.m18.1.1.1.1.1.cmml" xref="S11.p2.18.m18.1.1.1.1"><csymbol cd="ambiguous" id="S11.p2.18.m18.1.1.1.1.1.1.cmml" xref="S11.p2.18.m18.1.1.1.1">subscript</csymbol><ci id="S11.p2.18.m18.1.1.1.1.1.2.cmml" xref="S11.p2.18.m18.1.1.1.1.1.2">𝐱</ci><apply id="S11.p2.18.m18.1.1.1.1.1.3.cmml" xref="S11.p2.18.m18.1.1.1.1.1.3"><ci id="S11.p2.18.m18.1.1.1.1.1.3.1.cmml" xref="S11.p2.18.m18.1.1.1.1.1.3.1">→</ci><cn id="S11.p2.18.m18.1.1.1.1.1.3.2.cmml" type="integer" xref="S11.p2.18.m18.1.1.1.1.1.3.2">1</cn><apply id="S11.p2.18.m18.1.1.1.1.1.3.3.cmml" xref="S11.p2.18.m18.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S11.p2.18.m18.1.1.1.1.1.3.3.1.cmml" xref="S11.p2.18.m18.1.1.1.1.1.3.3">superscript</csymbol><ci id="S11.p2.18.m18.1.1.1.1.1.3.3.2.cmml" xref="S11.p2.18.m18.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S11.p2.18.m18.1.1.1.1.1.3.3.3.cmml" xref="S11.p2.18.m18.1.1.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.18.m18.1c">f_{s}(\mathbf{x}_{1\rightarrow s^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S11.p2.18.m18.1d">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 1 → italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="f_{s^{\prime}}(\mathbf{x}_{1\rightarrow s})" class="ltx_Math" display="inline" id="S11.p2.19.m19.1"><semantics id="S11.p2.19.m19.1a"><mrow id="S11.p2.19.m19.1.1" xref="S11.p2.19.m19.1.1.cmml"><msub id="S11.p2.19.m19.1.1.3" xref="S11.p2.19.m19.1.1.3.cmml"><mi id="S11.p2.19.m19.1.1.3.2" xref="S11.p2.19.m19.1.1.3.2.cmml">f</mi><msup id="S11.p2.19.m19.1.1.3.3" xref="S11.p2.19.m19.1.1.3.3.cmml"><mi id="S11.p2.19.m19.1.1.3.3.2" xref="S11.p2.19.m19.1.1.3.3.2.cmml">s</mi><mo id="S11.p2.19.m19.1.1.3.3.3" xref="S11.p2.19.m19.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S11.p2.19.m19.1.1.2" xref="S11.p2.19.m19.1.1.2.cmml">⁢</mo><mrow id="S11.p2.19.m19.1.1.1.1" xref="S11.p2.19.m19.1.1.1.1.1.cmml"><mo id="S11.p2.19.m19.1.1.1.1.2" stretchy="false" xref="S11.p2.19.m19.1.1.1.1.1.cmml">(</mo><msub id="S11.p2.19.m19.1.1.1.1.1" xref="S11.p2.19.m19.1.1.1.1.1.cmml"><mi id="S11.p2.19.m19.1.1.1.1.1.2" xref="S11.p2.19.m19.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S11.p2.19.m19.1.1.1.1.1.3" xref="S11.p2.19.m19.1.1.1.1.1.3.cmml"><mn id="S11.p2.19.m19.1.1.1.1.1.3.2" xref="S11.p2.19.m19.1.1.1.1.1.3.2.cmml">1</mn><mo id="S11.p2.19.m19.1.1.1.1.1.3.1" stretchy="false" xref="S11.p2.19.m19.1.1.1.1.1.3.1.cmml">→</mo><mi id="S11.p2.19.m19.1.1.1.1.1.3.3" xref="S11.p2.19.m19.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S11.p2.19.m19.1.1.1.1.3" stretchy="false" xref="S11.p2.19.m19.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.19.m19.1b"><apply id="S11.p2.19.m19.1.1.cmml" xref="S11.p2.19.m19.1.1"><times id="S11.p2.19.m19.1.1.2.cmml" xref="S11.p2.19.m19.1.1.2"></times><apply id="S11.p2.19.m19.1.1.3.cmml" xref="S11.p2.19.m19.1.1.3"><csymbol cd="ambiguous" id="S11.p2.19.m19.1.1.3.1.cmml" xref="S11.p2.19.m19.1.1.3">subscript</csymbol><ci id="S11.p2.19.m19.1.1.3.2.cmml" xref="S11.p2.19.m19.1.1.3.2">𝑓</ci><apply id="S11.p2.19.m19.1.1.3.3.cmml" xref="S11.p2.19.m19.1.1.3.3"><csymbol cd="ambiguous" id="S11.p2.19.m19.1.1.3.3.1.cmml" xref="S11.p2.19.m19.1.1.3.3">superscript</csymbol><ci id="S11.p2.19.m19.1.1.3.3.2.cmml" xref="S11.p2.19.m19.1.1.3.3.2">𝑠</ci><ci id="S11.p2.19.m19.1.1.3.3.3.cmml" xref="S11.p2.19.m19.1.1.3.3.3">′</ci></apply></apply><apply id="S11.p2.19.m19.1.1.1.1.1.cmml" xref="S11.p2.19.m19.1.1.1.1"><csymbol cd="ambiguous" id="S11.p2.19.m19.1.1.1.1.1.1.cmml" xref="S11.p2.19.m19.1.1.1.1">subscript</csymbol><ci id="S11.p2.19.m19.1.1.1.1.1.2.cmml" xref="S11.p2.19.m19.1.1.1.1.1.2">𝐱</ci><apply id="S11.p2.19.m19.1.1.1.1.1.3.cmml" xref="S11.p2.19.m19.1.1.1.1.1.3"><ci id="S11.p2.19.m19.1.1.1.1.1.3.1.cmml" xref="S11.p2.19.m19.1.1.1.1.1.3.1">→</ci><cn id="S11.p2.19.m19.1.1.1.1.1.3.2.cmml" type="integer" xref="S11.p2.19.m19.1.1.1.1.1.3.2">1</cn><ci id="S11.p2.19.m19.1.1.1.1.1.3.3.cmml" xref="S11.p2.19.m19.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.19.m19.1c">f_{s^{\prime}}(\mathbf{x}_{1\rightarrow s})</annotation><annotation encoding="application/x-llamapun" id="S11.p2.19.m19.1d">italic_f start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 1 → italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>, the activation maps <math alttext="f_{\text{upsample}}(\mathbf{A}_{s,i})" class="ltx_Math" display="inline" id="S11.p2.20.m20.3"><semantics id="S11.p2.20.m20.3a"><mrow id="S11.p2.20.m20.3.3" xref="S11.p2.20.m20.3.3.cmml"><msub id="S11.p2.20.m20.3.3.3" xref="S11.p2.20.m20.3.3.3.cmml"><mi id="S11.p2.20.m20.3.3.3.2" xref="S11.p2.20.m20.3.3.3.2.cmml">f</mi><mtext id="S11.p2.20.m20.3.3.3.3" xref="S11.p2.20.m20.3.3.3.3a.cmml">upsample</mtext></msub><mo id="S11.p2.20.m20.3.3.2" xref="S11.p2.20.m20.3.3.2.cmml">⁢</mo><mrow id="S11.p2.20.m20.3.3.1.1" xref="S11.p2.20.m20.3.3.1.1.1.cmml"><mo id="S11.p2.20.m20.3.3.1.1.2" stretchy="false" xref="S11.p2.20.m20.3.3.1.1.1.cmml">(</mo><msub id="S11.p2.20.m20.3.3.1.1.1" xref="S11.p2.20.m20.3.3.1.1.1.cmml"><mi id="S11.p2.20.m20.3.3.1.1.1.2" xref="S11.p2.20.m20.3.3.1.1.1.2.cmml">𝐀</mi><mrow id="S11.p2.20.m20.2.2.2.4" xref="S11.p2.20.m20.2.2.2.3.cmml"><mi id="S11.p2.20.m20.1.1.1.1" xref="S11.p2.20.m20.1.1.1.1.cmml">s</mi><mo id="S11.p2.20.m20.2.2.2.4.1" xref="S11.p2.20.m20.2.2.2.3.cmml">,</mo><mi id="S11.p2.20.m20.2.2.2.2" xref="S11.p2.20.m20.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S11.p2.20.m20.3.3.1.1.3" stretchy="false" xref="S11.p2.20.m20.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.20.m20.3b"><apply id="S11.p2.20.m20.3.3.cmml" xref="S11.p2.20.m20.3.3"><times id="S11.p2.20.m20.3.3.2.cmml" xref="S11.p2.20.m20.3.3.2"></times><apply id="S11.p2.20.m20.3.3.3.cmml" xref="S11.p2.20.m20.3.3.3"><csymbol cd="ambiguous" id="S11.p2.20.m20.3.3.3.1.cmml" xref="S11.p2.20.m20.3.3.3">subscript</csymbol><ci id="S11.p2.20.m20.3.3.3.2.cmml" xref="S11.p2.20.m20.3.3.3.2">𝑓</ci><ci id="S11.p2.20.m20.3.3.3.3a.cmml" xref="S11.p2.20.m20.3.3.3.3"><mtext id="S11.p2.20.m20.3.3.3.3.cmml" mathsize="70%" xref="S11.p2.20.m20.3.3.3.3">upsample</mtext></ci></apply><apply id="S11.p2.20.m20.3.3.1.1.1.cmml" xref="S11.p2.20.m20.3.3.1.1"><csymbol cd="ambiguous" id="S11.p2.20.m20.3.3.1.1.1.1.cmml" xref="S11.p2.20.m20.3.3.1.1">subscript</csymbol><ci id="S11.p2.20.m20.3.3.1.1.1.2.cmml" xref="S11.p2.20.m20.3.3.1.1.1.2">𝐀</ci><list id="S11.p2.20.m20.2.2.2.3.cmml" xref="S11.p2.20.m20.2.2.2.4"><ci id="S11.p2.20.m20.1.1.1.1.cmml" xref="S11.p2.20.m20.1.1.1.1">𝑠</ci><ci id="S11.p2.20.m20.2.2.2.2.cmml" xref="S11.p2.20.m20.2.2.2.2">𝑖</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.20.m20.3c">f_{\text{upsample}}(\mathbf{A}_{s,i})</annotation><annotation encoding="application/x-llamapun" id="S11.p2.20.m20.3d">italic_f start_POSTSUBSCRIPT upsample end_POSTSUBSCRIPT ( bold_A start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\mathbf{A}_{s^{\prime},j}" class="ltx_Math" display="inline" id="S11.p2.21.m21.2"><semantics id="S11.p2.21.m21.2a"><msub id="S11.p2.21.m21.2.3" xref="S11.p2.21.m21.2.3.cmml"><mi id="S11.p2.21.m21.2.3.2" xref="S11.p2.21.m21.2.3.2.cmml">𝐀</mi><mrow id="S11.p2.21.m21.2.2.2.2" xref="S11.p2.21.m21.2.2.2.3.cmml"><msup id="S11.p2.21.m21.2.2.2.2.1" xref="S11.p2.21.m21.2.2.2.2.1.cmml"><mi id="S11.p2.21.m21.2.2.2.2.1.2" xref="S11.p2.21.m21.2.2.2.2.1.2.cmml">s</mi><mo id="S11.p2.21.m21.2.2.2.2.1.3" xref="S11.p2.21.m21.2.2.2.2.1.3.cmml">′</mo></msup><mo id="S11.p2.21.m21.2.2.2.2.2" xref="S11.p2.21.m21.2.2.2.3.cmml">,</mo><mi id="S11.p2.21.m21.1.1.1.1" xref="S11.p2.21.m21.1.1.1.1.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p2.21.m21.2b"><apply id="S11.p2.21.m21.2.3.cmml" xref="S11.p2.21.m21.2.3"><csymbol cd="ambiguous" id="S11.p2.21.m21.2.3.1.cmml" xref="S11.p2.21.m21.2.3">subscript</csymbol><ci id="S11.p2.21.m21.2.3.2.cmml" xref="S11.p2.21.m21.2.3.2">𝐀</ci><list id="S11.p2.21.m21.2.2.2.3.cmml" xref="S11.p2.21.m21.2.2.2.2"><apply id="S11.p2.21.m21.2.2.2.2.1.cmml" xref="S11.p2.21.m21.2.2.2.2.1"><csymbol cd="ambiguous" id="S11.p2.21.m21.2.2.2.2.1.1.cmml" xref="S11.p2.21.m21.2.2.2.2.1">superscript</csymbol><ci id="S11.p2.21.m21.2.2.2.2.1.2.cmml" xref="S11.p2.21.m21.2.2.2.2.1.2">𝑠</ci><ci id="S11.p2.21.m21.2.2.2.2.1.3.cmml" xref="S11.p2.21.m21.2.2.2.2.1.3">′</ci></apply><ci id="S11.p2.21.m21.1.1.1.1.cmml" xref="S11.p2.21.m21.1.1.1.1">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.21.m21.2c">\mathbf{A}_{s^{\prime},j}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.21.m21.2d">bold_A start_POSTSUBSCRIPT italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, as described above. The similarity measure is then computed as follows, as we want to focus on the most activated parts for the objects assigned to <math alttext="c" class="ltx_Math" display="inline" id="S11.p2.22.m22.1"><semantics id="S11.p2.22.m22.1a"><mi id="S11.p2.22.m22.1.1" xref="S11.p2.22.m22.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S11.p2.22.m22.1b"><ci id="S11.p2.22.m22.1.1.cmml" xref="S11.p2.22.m22.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.22.m22.1c">c</annotation><annotation encoding="application/x-llamapun" id="S11.p2.22.m22.1d">italic_c</annotation></semantics></math> we threshold the activation maps to a percentile <math alttext="p_{th}\in\{0.6,0.7\}" class="ltx_Math" display="inline" id="S11.p2.23.m23.2"><semantics id="S11.p2.23.m23.2a"><mrow id="S11.p2.23.m23.2.3" xref="S11.p2.23.m23.2.3.cmml"><msub id="S11.p2.23.m23.2.3.2" xref="S11.p2.23.m23.2.3.2.cmml"><mi id="S11.p2.23.m23.2.3.2.2" xref="S11.p2.23.m23.2.3.2.2.cmml">p</mi><mrow id="S11.p2.23.m23.2.3.2.3" xref="S11.p2.23.m23.2.3.2.3.cmml"><mi id="S11.p2.23.m23.2.3.2.3.2" xref="S11.p2.23.m23.2.3.2.3.2.cmml">t</mi><mo id="S11.p2.23.m23.2.3.2.3.1" xref="S11.p2.23.m23.2.3.2.3.1.cmml">⁢</mo><mi id="S11.p2.23.m23.2.3.2.3.3" xref="S11.p2.23.m23.2.3.2.3.3.cmml">h</mi></mrow></msub><mo id="S11.p2.23.m23.2.3.1" xref="S11.p2.23.m23.2.3.1.cmml">∈</mo><mrow id="S11.p2.23.m23.2.3.3.2" xref="S11.p2.23.m23.2.3.3.1.cmml"><mo id="S11.p2.23.m23.2.3.3.2.1" stretchy="false" xref="S11.p2.23.m23.2.3.3.1.cmml">{</mo><mn id="S11.p2.23.m23.1.1" xref="S11.p2.23.m23.1.1.cmml">0.6</mn><mo id="S11.p2.23.m23.2.3.3.2.2" xref="S11.p2.23.m23.2.3.3.1.cmml">,</mo><mn id="S11.p2.23.m23.2.2" xref="S11.p2.23.m23.2.2.cmml">0.7</mn><mo id="S11.p2.23.m23.2.3.3.2.3" stretchy="false" xref="S11.p2.23.m23.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.23.m23.2b"><apply id="S11.p2.23.m23.2.3.cmml" xref="S11.p2.23.m23.2.3"><in id="S11.p2.23.m23.2.3.1.cmml" xref="S11.p2.23.m23.2.3.1"></in><apply id="S11.p2.23.m23.2.3.2.cmml" xref="S11.p2.23.m23.2.3.2"><csymbol cd="ambiguous" id="S11.p2.23.m23.2.3.2.1.cmml" xref="S11.p2.23.m23.2.3.2">subscript</csymbol><ci id="S11.p2.23.m23.2.3.2.2.cmml" xref="S11.p2.23.m23.2.3.2.2">𝑝</ci><apply id="S11.p2.23.m23.2.3.2.3.cmml" xref="S11.p2.23.m23.2.3.2.3"><times id="S11.p2.23.m23.2.3.2.3.1.cmml" xref="S11.p2.23.m23.2.3.2.3.1"></times><ci id="S11.p2.23.m23.2.3.2.3.2.cmml" xref="S11.p2.23.m23.2.3.2.3.2">𝑡</ci><ci id="S11.p2.23.m23.2.3.2.3.3.cmml" xref="S11.p2.23.m23.2.3.2.3.3">ℎ</ci></apply></apply><set id="S11.p2.23.m23.2.3.3.1.cmml" xref="S11.p2.23.m23.2.3.3.2"><cn id="S11.p2.23.m23.1.1.cmml" type="float" xref="S11.p2.23.m23.1.1">0.6</cn><cn id="S11.p2.23.m23.2.2.cmml" type="float" xref="S11.p2.23.m23.2.2">0.7</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.23.m23.2c">p_{th}\in\{0.6,0.7\}</annotation><annotation encoding="application/x-llamapun" id="S11.p2.23.m23.2d">italic_p start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT ∈ { 0.6 , 0.7 }</annotation></semantics></math> only considering the positions where the ground truth label <math alttext="y_{\mathbf{z}}=c" class="ltx_Math" display="inline" id="S11.p2.24.m24.1"><semantics id="S11.p2.24.m24.1a"><mrow id="S11.p2.24.m24.1.1" xref="S11.p2.24.m24.1.1.cmml"><msub id="S11.p2.24.m24.1.1.2" xref="S11.p2.24.m24.1.1.2.cmml"><mi id="S11.p2.24.m24.1.1.2.2" xref="S11.p2.24.m24.1.1.2.2.cmml">y</mi><mi id="S11.p2.24.m24.1.1.2.3" xref="S11.p2.24.m24.1.1.2.3.cmml">𝐳</mi></msub><mo id="S11.p2.24.m24.1.1.1" xref="S11.p2.24.m24.1.1.1.cmml">=</mo><mi id="S11.p2.24.m24.1.1.3" xref="S11.p2.24.m24.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.24.m24.1b"><apply id="S11.p2.24.m24.1.1.cmml" xref="S11.p2.24.m24.1.1"><eq id="S11.p2.24.m24.1.1.1.cmml" xref="S11.p2.24.m24.1.1.1"></eq><apply id="S11.p2.24.m24.1.1.2.cmml" xref="S11.p2.24.m24.1.1.2"><csymbol cd="ambiguous" id="S11.p2.24.m24.1.1.2.1.cmml" xref="S11.p2.24.m24.1.1.2">subscript</csymbol><ci id="S11.p2.24.m24.1.1.2.2.cmml" xref="S11.p2.24.m24.1.1.2.2">𝑦</ci><ci id="S11.p2.24.m24.1.1.2.3.cmml" xref="S11.p2.24.m24.1.1.2.3">𝐳</ci></apply><ci id="S11.p2.24.m24.1.1.3.cmml" xref="S11.p2.24.m24.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.24.m24.1c">y_{\mathbf{z}}=c</annotation><annotation encoding="application/x-llamapun" id="S11.p2.24.m24.1d">italic_y start_POSTSUBSCRIPT bold_z end_POSTSUBSCRIPT = italic_c</annotation></semantics></math>. Then we derive the mIoU between the binarized activation maps across all the training set images, defining our similarity measure. Pairs of quasi-equivariant prototypes are identified when the mIoU is above a fixed threshold <math alttext="\text{IoU}_{th}=0.5" class="ltx_Math" display="inline" id="S11.p2.25.m25.1"><semantics id="S11.p2.25.m25.1a"><mrow id="S11.p2.25.m25.1.1" xref="S11.p2.25.m25.1.1.cmml"><msub id="S11.p2.25.m25.1.1.2" xref="S11.p2.25.m25.1.1.2.cmml"><mtext id="S11.p2.25.m25.1.1.2.2" xref="S11.p2.25.m25.1.1.2.2a.cmml">IoU</mtext><mrow id="S11.p2.25.m25.1.1.2.3" xref="S11.p2.25.m25.1.1.2.3.cmml"><mi id="S11.p2.25.m25.1.1.2.3.2" xref="S11.p2.25.m25.1.1.2.3.2.cmml">t</mi><mo id="S11.p2.25.m25.1.1.2.3.1" xref="S11.p2.25.m25.1.1.2.3.1.cmml">⁢</mo><mi id="S11.p2.25.m25.1.1.2.3.3" xref="S11.p2.25.m25.1.1.2.3.3.cmml">h</mi></mrow></msub><mo id="S11.p2.25.m25.1.1.1" xref="S11.p2.25.m25.1.1.1.cmml">=</mo><mn id="S11.p2.25.m25.1.1.3" xref="S11.p2.25.m25.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p2.25.m25.1b"><apply id="S11.p2.25.m25.1.1.cmml" xref="S11.p2.25.m25.1.1"><eq id="S11.p2.25.m25.1.1.1.cmml" xref="S11.p2.25.m25.1.1.1"></eq><apply id="S11.p2.25.m25.1.1.2.cmml" xref="S11.p2.25.m25.1.1.2"><csymbol cd="ambiguous" id="S11.p2.25.m25.1.1.2.1.cmml" xref="S11.p2.25.m25.1.1.2">subscript</csymbol><ci id="S11.p2.25.m25.1.1.2.2a.cmml" xref="S11.p2.25.m25.1.1.2.2"><mtext id="S11.p2.25.m25.1.1.2.2.cmml" xref="S11.p2.25.m25.1.1.2.2">IoU</mtext></ci><apply id="S11.p2.25.m25.1.1.2.3.cmml" xref="S11.p2.25.m25.1.1.2.3"><times id="S11.p2.25.m25.1.1.2.3.1.cmml" xref="S11.p2.25.m25.1.1.2.3.1"></times><ci id="S11.p2.25.m25.1.1.2.3.2.cmml" xref="S11.p2.25.m25.1.1.2.3.2">𝑡</ci><ci id="S11.p2.25.m25.1.1.2.3.3.cmml" xref="S11.p2.25.m25.1.1.2.3.3">ℎ</ci></apply></apply><cn id="S11.p2.25.m25.1.1.3.cmml" type="float" xref="S11.p2.25.m25.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.25.m25.1c">\text{IoU}_{th}=0.5</annotation><annotation encoding="application/x-llamapun" id="S11.p2.25.m25.1d">IoU start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT = 0.5</annotation></semantics></math> on the training set. Lastly, pairs of quasi-equivariant prototypes are merged into groups if they overlap across scales.</p>
</div>
<div class="ltx_para" id="S11.p3">
<p class="ltx_p" id="S11.p3.4">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S11.F7" title="Figure 7 ‣ 11 Multi-scale prototype analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">7</span></a>, we present the results of the equivariance analysis on three datasets. Interestingly, we observe that for both Cityscapes and Pascal VOC there are more than <math alttext="50\%" class="ltx_Math" display="inline" id="S11.p3.1.m1.1"><semantics id="S11.p3.1.m1.1a"><mrow id="S11.p3.1.m1.1.1" xref="S11.p3.1.m1.1.1.cmml"><mn id="S11.p3.1.m1.1.1.2" xref="S11.p3.1.m1.1.1.2.cmml">50</mn><mo id="S11.p3.1.m1.1.1.1" xref="S11.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.1.m1.1b"><apply id="S11.p3.1.m1.1.1.cmml" xref="S11.p3.1.m1.1.1"><csymbol cd="latexml" id="S11.p3.1.m1.1.1.1.cmml" xref="S11.p3.1.m1.1.1.1">percent</csymbol><cn id="S11.p3.1.m1.1.1.2.cmml" type="integer" xref="S11.p3.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.1.m1.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="S11.p3.1.m1.1d">50 %</annotation></semantics></math> of classes with quasi-equivariant groups for <math alttext="p_{th}=0.6" class="ltx_Math" display="inline" id="S11.p3.2.m2.1"><semantics id="S11.p3.2.m2.1a"><mrow id="S11.p3.2.m2.1.1" xref="S11.p3.2.m2.1.1.cmml"><msub id="S11.p3.2.m2.1.1.2" xref="S11.p3.2.m2.1.1.2.cmml"><mi id="S11.p3.2.m2.1.1.2.2" xref="S11.p3.2.m2.1.1.2.2.cmml">p</mi><mrow id="S11.p3.2.m2.1.1.2.3" xref="S11.p3.2.m2.1.1.2.3.cmml"><mi id="S11.p3.2.m2.1.1.2.3.2" xref="S11.p3.2.m2.1.1.2.3.2.cmml">t</mi><mo id="S11.p3.2.m2.1.1.2.3.1" xref="S11.p3.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S11.p3.2.m2.1.1.2.3.3" xref="S11.p3.2.m2.1.1.2.3.3.cmml">h</mi></mrow></msub><mo id="S11.p3.2.m2.1.1.1" xref="S11.p3.2.m2.1.1.1.cmml">=</mo><mn id="S11.p3.2.m2.1.1.3" xref="S11.p3.2.m2.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.2.m2.1b"><apply id="S11.p3.2.m2.1.1.cmml" xref="S11.p3.2.m2.1.1"><eq id="S11.p3.2.m2.1.1.1.cmml" xref="S11.p3.2.m2.1.1.1"></eq><apply id="S11.p3.2.m2.1.1.2.cmml" xref="S11.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S11.p3.2.m2.1.1.2.1.cmml" xref="S11.p3.2.m2.1.1.2">subscript</csymbol><ci id="S11.p3.2.m2.1.1.2.2.cmml" xref="S11.p3.2.m2.1.1.2.2">𝑝</ci><apply id="S11.p3.2.m2.1.1.2.3.cmml" xref="S11.p3.2.m2.1.1.2.3"><times id="S11.p3.2.m2.1.1.2.3.1.cmml" xref="S11.p3.2.m2.1.1.2.3.1"></times><ci id="S11.p3.2.m2.1.1.2.3.2.cmml" xref="S11.p3.2.m2.1.1.2.3.2">𝑡</ci><ci id="S11.p3.2.m2.1.1.2.3.3.cmml" xref="S11.p3.2.m2.1.1.2.3.3">ℎ</ci></apply></apply><cn id="S11.p3.2.m2.1.1.3.cmml" type="float" xref="S11.p3.2.m2.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.2.m2.1c">p_{th}=0.6</annotation><annotation encoding="application/x-llamapun" id="S11.p3.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT = 0.6</annotation></semantics></math>, demonstrating that the network learns through its multi-scale prototypes similar activations for similar prototypical parts in the image at different scales. For ADE20K, we observe that only <math alttext="12\%" class="ltx_Math" display="inline" id="S11.p3.3.m3.1"><semantics id="S11.p3.3.m3.1a"><mrow id="S11.p3.3.m3.1.1" xref="S11.p3.3.m3.1.1.cmml"><mn id="S11.p3.3.m3.1.1.2" xref="S11.p3.3.m3.1.1.2.cmml">12</mn><mo id="S11.p3.3.m3.1.1.1" xref="S11.p3.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.3.m3.1b"><apply id="S11.p3.3.m3.1.1.cmml" xref="S11.p3.3.m3.1.1"><csymbol cd="latexml" id="S11.p3.3.m3.1.1.1.cmml" xref="S11.p3.3.m3.1.1.1">percent</csymbol><cn id="S11.p3.3.m3.1.1.2.cmml" type="integer" xref="S11.p3.3.m3.1.1.2">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.3.m3.1c">12\%</annotation><annotation encoding="application/x-llamapun" id="S11.p3.3.m3.1d">12 %</annotation></semantics></math> of classes have quasi-equivariant groups. We argue that since ADE20K is characterized by many complex scenes, as we constrain the representation space to the learning of only 12 prototypes across scales, all the learned prototypes represent scale-specific contextual information. We suppose that if we were to increase the number of prototypes per scale, redundant information would start to appear across scales and more prototypes would be activated on similar prototypical parts at different scales, leading to an increase in the number of classes with quasi-equivariant groups. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S11.F8" title="Figure 8 ‣ 11 Multi-scale prototype analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">8</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S11.F9" title="Figure 9 ‣ 11 Multi-scale prototype analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">9</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S11.F10" title="Figure 10 ‣ 11 Multi-scale prototype analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a> we show examples of pair of quasi-equivariant prototypes for <math alttext="p_{th}=0.6" class="ltx_Math" display="inline" id="S11.p3.4.m4.1"><semantics id="S11.p3.4.m4.1a"><mrow id="S11.p3.4.m4.1.1" xref="S11.p3.4.m4.1.1.cmml"><msub id="S11.p3.4.m4.1.1.2" xref="S11.p3.4.m4.1.1.2.cmml"><mi id="S11.p3.4.m4.1.1.2.2" xref="S11.p3.4.m4.1.1.2.2.cmml">p</mi><mrow id="S11.p3.4.m4.1.1.2.3" xref="S11.p3.4.m4.1.1.2.3.cmml"><mi id="S11.p3.4.m4.1.1.2.3.2" xref="S11.p3.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S11.p3.4.m4.1.1.2.3.1" xref="S11.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S11.p3.4.m4.1.1.2.3.3" xref="S11.p3.4.m4.1.1.2.3.3.cmml">h</mi></mrow></msub><mo id="S11.p3.4.m4.1.1.1" xref="S11.p3.4.m4.1.1.1.cmml">=</mo><mn id="S11.p3.4.m4.1.1.3" xref="S11.p3.4.m4.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.4.m4.1b"><apply id="S11.p3.4.m4.1.1.cmml" xref="S11.p3.4.m4.1.1"><eq id="S11.p3.4.m4.1.1.1.cmml" xref="S11.p3.4.m4.1.1.1"></eq><apply id="S11.p3.4.m4.1.1.2.cmml" xref="S11.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S11.p3.4.m4.1.1.2.1.cmml" xref="S11.p3.4.m4.1.1.2">subscript</csymbol><ci id="S11.p3.4.m4.1.1.2.2.cmml" xref="S11.p3.4.m4.1.1.2.2">𝑝</ci><apply id="S11.p3.4.m4.1.1.2.3.cmml" xref="S11.p3.4.m4.1.1.2.3"><times id="S11.p3.4.m4.1.1.2.3.1.cmml" xref="S11.p3.4.m4.1.1.2.3.1"></times><ci id="S11.p3.4.m4.1.1.2.3.2.cmml" xref="S11.p3.4.m4.1.1.2.3.2">𝑡</ci><ci id="S11.p3.4.m4.1.1.2.3.3.cmml" xref="S11.p3.4.m4.1.1.2.3.3">ℎ</ci></apply></apply><cn id="S11.p3.4.m4.1.1.3.cmml" type="float" xref="S11.p3.4.m4.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.4.m4.1c">p_{th}=0.6</annotation><annotation encoding="application/x-llamapun" id="S11.p3.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT = 0.6</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S11.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="374" id="S11.F7.sf1.g1" src="extracted/5854717/images/group_equivariance.jpg" width="685"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F7.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S11.F7.sf1.3.2" style="font-size:90%;">Ratio of quasi-equivariant groups identified.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="374" id="S11.F7.sf2.g1" src="extracted/5854717/images/proto_equivariance.jpg" width="685"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F7.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S11.F7.sf2.3.2" style="font-size:90%;">Ratio of prototypes in the quasi-equivariant groups.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="374" id="S11.F7.sf3.g1" src="extracted/5854717/images/class_equivariance.jpg" width="685"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F7.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S11.F7.sf3.3.2" style="font-size:90%;">Ratio of classes with quasi-equivariant groups.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F7.5.2.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S11.F7.2.1" style="font-size:90%;">Analysis of the presence of quasi-equivariant groups in all three datasets for <math alttext="p_{th}\in\{0.6,0.7\}" class="ltx_Math" display="inline" id="S11.F7.2.1.m1.2"><semantics id="S11.F7.2.1.m1.2b"><mrow id="S11.F7.2.1.m1.2.3" xref="S11.F7.2.1.m1.2.3.cmml"><msub id="S11.F7.2.1.m1.2.3.2" xref="S11.F7.2.1.m1.2.3.2.cmml"><mi id="S11.F7.2.1.m1.2.3.2.2" xref="S11.F7.2.1.m1.2.3.2.2.cmml">p</mi><mrow id="S11.F7.2.1.m1.2.3.2.3" xref="S11.F7.2.1.m1.2.3.2.3.cmml"><mi id="S11.F7.2.1.m1.2.3.2.3.2" xref="S11.F7.2.1.m1.2.3.2.3.2.cmml">t</mi><mo id="S11.F7.2.1.m1.2.3.2.3.1" xref="S11.F7.2.1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S11.F7.2.1.m1.2.3.2.3.3" xref="S11.F7.2.1.m1.2.3.2.3.3.cmml">h</mi></mrow></msub><mo id="S11.F7.2.1.m1.2.3.1" xref="S11.F7.2.1.m1.2.3.1.cmml">∈</mo><mrow id="S11.F7.2.1.m1.2.3.3.2" xref="S11.F7.2.1.m1.2.3.3.1.cmml"><mo id="S11.F7.2.1.m1.2.3.3.2.1" stretchy="false" xref="S11.F7.2.1.m1.2.3.3.1.cmml">{</mo><mn id="S11.F7.2.1.m1.1.1" xref="S11.F7.2.1.m1.1.1.cmml">0.6</mn><mo id="S11.F7.2.1.m1.2.3.3.2.2" xref="S11.F7.2.1.m1.2.3.3.1.cmml">,</mo><mn id="S11.F7.2.1.m1.2.2" xref="S11.F7.2.1.m1.2.2.cmml">0.7</mn><mo id="S11.F7.2.1.m1.2.3.3.2.3" stretchy="false" xref="S11.F7.2.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.F7.2.1.m1.2c"><apply id="S11.F7.2.1.m1.2.3.cmml" xref="S11.F7.2.1.m1.2.3"><in id="S11.F7.2.1.m1.2.3.1.cmml" xref="S11.F7.2.1.m1.2.3.1"></in><apply id="S11.F7.2.1.m1.2.3.2.cmml" xref="S11.F7.2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S11.F7.2.1.m1.2.3.2.1.cmml" xref="S11.F7.2.1.m1.2.3.2">subscript</csymbol><ci id="S11.F7.2.1.m1.2.3.2.2.cmml" xref="S11.F7.2.1.m1.2.3.2.2">𝑝</ci><apply id="S11.F7.2.1.m1.2.3.2.3.cmml" xref="S11.F7.2.1.m1.2.3.2.3"><times id="S11.F7.2.1.m1.2.3.2.3.1.cmml" xref="S11.F7.2.1.m1.2.3.2.3.1"></times><ci id="S11.F7.2.1.m1.2.3.2.3.2.cmml" xref="S11.F7.2.1.m1.2.3.2.3.2">𝑡</ci><ci id="S11.F7.2.1.m1.2.3.2.3.3.cmml" xref="S11.F7.2.1.m1.2.3.2.3.3">ℎ</ci></apply></apply><set id="S11.F7.2.1.m1.2.3.3.1.cmml" xref="S11.F7.2.1.m1.2.3.3.2"><cn id="S11.F7.2.1.m1.1.1.cmml" type="float" xref="S11.F7.2.1.m1.1.1">0.6</cn><cn id="S11.F7.2.1.m1.2.2.cmml" type="float" xref="S11.F7.2.1.m1.2.2">0.7</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.F7.2.1.m1.2d">p_{th}\in\{0.6,0.7\}</annotation><annotation encoding="application/x-llamapun" id="S11.F7.2.1.m1.2e">italic_p start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT ∈ { 0.6 , 0.7 }</annotation></semantics></math> on our best performing ScaleProtoSeg run. In <span class="ltx_text ltx_font_bold" id="S11.F7.2.1.1">(a)</span>, the number of quasi-equivariant groups is compared to the total number of groups defined in the sparse grouping mechanism.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S11.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F8.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F8.sf1.g1" src="extracted/5854717/images/plot_img_jena_000011_000019_class_car_pscale_0_imscale_2_pid_0_act.jpg" width="329"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F8.sf1.g2" src="extracted/5854717/images/plot_img_jena_000011_000019_class_car_pscale_1_imscale_3_pid_2_act.jpg" width="329"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F8.sf1.6.3.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S11.F8.sf1.4.2" style="font-size:90%;">Prototype activations on a pair of quasi-equivariant prototypes for an input image downscaled by a ratio of <math alttext="2" class="ltx_Math" display="inline" id="S11.F8.sf1.3.1.m1.1"><semantics id="S11.F8.sf1.3.1.m1.1b"><mn id="S11.F8.sf1.3.1.m1.1.1" xref="S11.F8.sf1.3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S11.F8.sf1.3.1.m1.1c"><cn id="S11.F8.sf1.3.1.m1.1.1.cmml" type="integer" xref="S11.F8.sf1.3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F8.sf1.3.1.m1.1d">2</annotation><annotation encoding="application/x-llamapun" id="S11.F8.sf1.3.1.m1.1e">2</annotation></semantics></math> and <math alttext="1" class="ltx_Math" display="inline" id="S11.F8.sf1.4.2.m2.1"><semantics id="S11.F8.sf1.4.2.m2.1b"><mn id="S11.F8.sf1.4.2.m2.1.1" xref="S11.F8.sf1.4.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S11.F8.sf1.4.2.m2.1c"><cn id="S11.F8.sf1.4.2.m2.1.1.cmml" type="integer" xref="S11.F8.sf1.4.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F8.sf1.4.2.m2.1d">1</annotation><annotation encoding="application/x-llamapun" id="S11.F8.sf1.4.2.m2.1e">1</annotation></semantics></math> respectively.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F8.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F8.sf2.g1" src="extracted/5854717/images/plot_img_jena_000011_000019_class_car_pscale_0_imscale_2_pid_0.jpg" width="329"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F8.sf2.g2" src="extracted/5854717/images/plot_img_jena_000011_000019_class_car_pscale_1_imscale_3_pid_2.jpg" width="329"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F8.sf2.6.3.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S11.F8.sf2.4.2" style="font-size:90%;">Binarized prototype activations on a pair of quasi-equivariant prototypes for an input image downscaled by a ratio of <math alttext="2" class="ltx_Math" display="inline" id="S11.F8.sf2.3.1.m1.1"><semantics id="S11.F8.sf2.3.1.m1.1b"><mn id="S11.F8.sf2.3.1.m1.1.1" xref="S11.F8.sf2.3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S11.F8.sf2.3.1.m1.1c"><cn id="S11.F8.sf2.3.1.m1.1.1.cmml" type="integer" xref="S11.F8.sf2.3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F8.sf2.3.1.m1.1d">2</annotation><annotation encoding="application/x-llamapun" id="S11.F8.sf2.3.1.m1.1e">2</annotation></semantics></math> and <math alttext="1" class="ltx_Math" display="inline" id="S11.F8.sf2.4.2.m2.1"><semantics id="S11.F8.sf2.4.2.m2.1b"><mn id="S11.F8.sf2.4.2.m2.1.1" xref="S11.F8.sf2.4.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S11.F8.sf2.4.2.m2.1c"><cn id="S11.F8.sf2.4.2.m2.1.1.cmml" type="integer" xref="S11.F8.sf2.4.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F8.sf2.4.2.m2.1d">1</annotation><annotation encoding="application/x-llamapun" id="S11.F8.sf2.4.2.m2.1e">1</annotation></semantics></math> respectively.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F8.5.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S11.F8.6.2" style="font-size:90%;">Example of quasi-equivariant pair of prototypes for the class <span class="ltx_text ltx_font_italic" id="S11.F8.6.2.1">car</span> on Cityscapes. Prototype on the left is from <span class="ltx_text ltx_font_italic" id="S11.F8.6.2.2">Scale 1</span> and on the right is from <span class="ltx_text ltx_font_italic" id="S11.F8.6.2.3">Scale 2</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S11.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F9.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F9.sf1.g1" src="extracted/5854717/images/plot_img_jena_000084_000019_class_rider_pscale_0_imscale_1_pid_2_Act.jpg" width="329"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F9.sf1.g2" src="extracted/5854717/images/plot_img_jena_000084_000019_class_rider_pscale_2_imscale_3_pid_0_act.jpg" width="329"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F9.sf1.6.3.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S11.F9.sf1.4.2" style="font-size:90%;">Prototype activations on a pair of quasi-equivariant prototypes for an input image downscaled by a ratio of <math alttext="3" class="ltx_Math" display="inline" id="S11.F9.sf1.3.1.m1.1"><semantics id="S11.F9.sf1.3.1.m1.1b"><mn id="S11.F9.sf1.3.1.m1.1.1" xref="S11.F9.sf1.3.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S11.F9.sf1.3.1.m1.1c"><cn id="S11.F9.sf1.3.1.m1.1.1.cmml" type="integer" xref="S11.F9.sf1.3.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F9.sf1.3.1.m1.1d">3</annotation><annotation encoding="application/x-llamapun" id="S11.F9.sf1.3.1.m1.1e">3</annotation></semantics></math> and <math alttext="1" class="ltx_Math" display="inline" id="S11.F9.sf1.4.2.m2.1"><semantics id="S11.F9.sf1.4.2.m2.1b"><mn id="S11.F9.sf1.4.2.m2.1.1" xref="S11.F9.sf1.4.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S11.F9.sf1.4.2.m2.1c"><cn id="S11.F9.sf1.4.2.m2.1.1.cmml" type="integer" xref="S11.F9.sf1.4.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F9.sf1.4.2.m2.1d">1</annotation><annotation encoding="application/x-llamapun" id="S11.F9.sf1.4.2.m2.1e">1</annotation></semantics></math> respectively.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F9.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F9.sf2.g1" src="extracted/5854717/images/plot_img_jena_000084_000019_class_rider_pscale_0_imscale_1_pid_2.jpg" width="329"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F9.sf2.g2" src="extracted/5854717/images/plot_img_jena_000084_000019_class_rider_pscale_2_imscale_3_pid_0.jpg" width="329"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F9.sf2.6.3.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S11.F9.sf2.4.2" style="font-size:90%;">Binarized prototype activations on a pair of quasi-equivariant prototypes for an input image downscaled by a ratio of <math alttext="3" class="ltx_Math" display="inline" id="S11.F9.sf2.3.1.m1.1"><semantics id="S11.F9.sf2.3.1.m1.1b"><mn id="S11.F9.sf2.3.1.m1.1.1" xref="S11.F9.sf2.3.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S11.F9.sf2.3.1.m1.1c"><cn id="S11.F9.sf2.3.1.m1.1.1.cmml" type="integer" xref="S11.F9.sf2.3.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F9.sf2.3.1.m1.1d">3</annotation><annotation encoding="application/x-llamapun" id="S11.F9.sf2.3.1.m1.1e">3</annotation></semantics></math> and <math alttext="1" class="ltx_Math" display="inline" id="S11.F9.sf2.4.2.m2.1"><semantics id="S11.F9.sf2.4.2.m2.1b"><mn id="S11.F9.sf2.4.2.m2.1.1" xref="S11.F9.sf2.4.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S11.F9.sf2.4.2.m2.1c"><cn id="S11.F9.sf2.4.2.m2.1.1.cmml" type="integer" xref="S11.F9.sf2.4.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F9.sf2.4.2.m2.1d">1</annotation><annotation encoding="application/x-llamapun" id="S11.F9.sf2.4.2.m2.1e">1</annotation></semantics></math> respectively.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F9.5.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="S11.F9.6.2" style="font-size:90%;">Example of quasi-equivariant pair of prototypes for the class <span class="ltx_text ltx_font_italic" id="S11.F9.6.2.1">rider</span> on Cityscapes. Prototype on the left is from <span class="ltx_text ltx_font_italic" id="S11.F9.6.2.2">Scale 1</span> and on the right is from <span class="ltx_text ltx_font_italic" id="S11.F9.6.2.3">Scale 3</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S11.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F10.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F10.sf1.g1" src="extracted/5854717/images/plot_img_jena_000105_000019_class_person_pscale_0_imscale_1_pid_0_act.jpg" width="329"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F10.sf1.g2" src="extracted/5854717/images/plot_img_jena_000105_000019_class_person_pscale_2_imscale_3_pid_0_act.jpg" width="329"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F10.sf1.6.3.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S11.F10.sf1.4.2" style="font-size:90%;">Prototype activations on a pair of quasi-equivariant prototypes for an input image downscaled by a ratio of <math alttext="3" class="ltx_Math" display="inline" id="S11.F10.sf1.3.1.m1.1"><semantics id="S11.F10.sf1.3.1.m1.1b"><mn id="S11.F10.sf1.3.1.m1.1.1" xref="S11.F10.sf1.3.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S11.F10.sf1.3.1.m1.1c"><cn id="S11.F10.sf1.3.1.m1.1.1.cmml" type="integer" xref="S11.F10.sf1.3.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F10.sf1.3.1.m1.1d">3</annotation><annotation encoding="application/x-llamapun" id="S11.F10.sf1.3.1.m1.1e">3</annotation></semantics></math> and <math alttext="1" class="ltx_Math" display="inline" id="S11.F10.sf1.4.2.m2.1"><semantics id="S11.F10.sf1.4.2.m2.1b"><mn id="S11.F10.sf1.4.2.m2.1.1" xref="S11.F10.sf1.4.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S11.F10.sf1.4.2.m2.1c"><cn id="S11.F10.sf1.4.2.m2.1.1.cmml" type="integer" xref="S11.F10.sf1.4.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F10.sf1.4.2.m2.1d">1</annotation><annotation encoding="application/x-llamapun" id="S11.F10.sf1.4.2.m2.1e">1</annotation></semantics></math> respectively.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S11.F10.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F10.sf2.g1" src="extracted/5854717/images/plot_img_jena_000105_000019_class_person_pscale_0_imscale_1_pid_0.jpg" width="329"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="102" id="S11.F10.sf2.g2" src="extracted/5854717/images/plot_img_jena_000105_000019_class_person_pscale_2_imscale_3_pid_0.jpg" width="329"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F10.sf2.6.3.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S11.F10.sf2.4.2" style="font-size:90%;">Binarized prototype activations on a pair of quasi-equivariant prototypes for an input image downscaled by a ratio of <math alttext="3" class="ltx_Math" display="inline" id="S11.F10.sf2.3.1.m1.1"><semantics id="S11.F10.sf2.3.1.m1.1b"><mn id="S11.F10.sf2.3.1.m1.1.1" xref="S11.F10.sf2.3.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S11.F10.sf2.3.1.m1.1c"><cn id="S11.F10.sf2.3.1.m1.1.1.cmml" type="integer" xref="S11.F10.sf2.3.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F10.sf2.3.1.m1.1d">3</annotation><annotation encoding="application/x-llamapun" id="S11.F10.sf2.3.1.m1.1e">3</annotation></semantics></math> and <math alttext="1" class="ltx_Math" display="inline" id="S11.F10.sf2.4.2.m2.1"><semantics id="S11.F10.sf2.4.2.m2.1b"><mn id="S11.F10.sf2.4.2.m2.1.1" xref="S11.F10.sf2.4.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S11.F10.sf2.4.2.m2.1c"><cn id="S11.F10.sf2.4.2.m2.1.1.cmml" type="integer" xref="S11.F10.sf2.4.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S11.F10.sf2.4.2.m2.1d">1</annotation><annotation encoding="application/x-llamapun" id="S11.F10.sf2.4.2.m2.1e">1</annotation></semantics></math> respectively.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S11.F10.5.1.1" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text" id="S11.F10.6.2" style="font-size:90%;">Example of quasi-equivariant pair of prototypes for the class <span class="ltx_text ltx_font_italic" id="S11.F10.6.2.1">person</span> on Cityscapes. Prototype on the left is from <span class="ltx_text ltx_font_italic" id="S11.F10.6.2.2">Scale 1</span> and on the right is from <span class="ltx_text ltx_font_italic" id="S11.F10.6.2.3">Scale 3</span>.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S12">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">12 </span>Sparsity and Computation Overhead</h2>
<figure class="ltx_table" id="S12.T10">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S12.T10.18" style="width:216.8pt;height:81.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-59.7pt,22.4pt) scale(0.645053887431108,0.645053887431108) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S12.T10.18.18">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S12.T10.18.18.19.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S12.T10.18.18.19.1.1"><span class="ltx_text ltx_font_bold" id="S12.T10.18.18.19.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S12.T10.18.18.19.1.2"><span class="ltx_text ltx_font_bold" id="S12.T10.18.18.19.1.2.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S12.T10.18.18.19.1.3"><span class="ltx_text ltx_font_bold" id="S12.T10.18.18.19.1.3.1">Avg Weight</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S12.T10.18.18.19.1.4"><span class="ltx_text ltx_font_bold" id="S12.T10.18.18.19.1.4.1">Parameters</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S12.T10.18.18.19.1.5"><span class="ltx_text ltx_font_bold" id="S12.T10.18.18.19.1.5.1">It/s</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S12.T10.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S12.T10.3.3.3.4" rowspan="2"><span class="ltx_text" id="S12.T10.3.3.3.4.1">Pascal</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S12.T10.3.3.3.5">ProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.1.1.1.1">0.527 <math alttext="\pm 0.004" class="ltx_Math" display="inline" id="S12.T10.1.1.1.1.m1.1"><semantics id="S12.T10.1.1.1.1.m1.1a"><mrow id="S12.T10.1.1.1.1.m1.1.1" xref="S12.T10.1.1.1.1.m1.1.1.cmml"><mo id="S12.T10.1.1.1.1.m1.1.1a" xref="S12.T10.1.1.1.1.m1.1.1.cmml">±</mo><mn id="S12.T10.1.1.1.1.m1.1.1.2" xref="S12.T10.1.1.1.1.m1.1.1.2.cmml">0.004</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.1.1.1.1.m1.1b"><apply id="S12.T10.1.1.1.1.m1.1.1.cmml" xref="S12.T10.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S12.T10.1.1.1.1.m1.1.1.1.cmml" xref="S12.T10.1.1.1.1.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.1.1.1.1.m1.1.1.2.cmml" type="float" xref="S12.T10.1.1.1.1.m1.1.1.2">0.004</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.1.1.1.1.m1.1c">\pm 0.004</annotation><annotation encoding="application/x-llamapun" id="S12.T10.1.1.1.1.m1.1d">± 0.004</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.2.2.2.2">12.1K <math alttext="\pm 0.3" class="ltx_Math" display="inline" id="S12.T10.2.2.2.2.m1.1"><semantics id="S12.T10.2.2.2.2.m1.1a"><mrow id="S12.T10.2.2.2.2.m1.1.1" xref="S12.T10.2.2.2.2.m1.1.1.cmml"><mo id="S12.T10.2.2.2.2.m1.1.1a" xref="S12.T10.2.2.2.2.m1.1.1.cmml">±</mo><mn id="S12.T10.2.2.2.2.m1.1.1.2" xref="S12.T10.2.2.2.2.m1.1.1.2.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.2.2.2.2.m1.1b"><apply id="S12.T10.2.2.2.2.m1.1.1.cmml" xref="S12.T10.2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S12.T10.2.2.2.2.m1.1.1.1.cmml" xref="S12.T10.2.2.2.2.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.2.2.2.2.m1.1.1.2.cmml" type="float" xref="S12.T10.2.2.2.2.m1.1.1.2">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.2.2.2.2.m1.1c">\pm 0.3</annotation><annotation encoding="application/x-llamapun" id="S12.T10.2.2.2.2.m1.1d">± 0.3</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.3.3.3.3">
<span class="ltx_text ltx_font_bold" id="S12.T10.3.3.3.3.1">20.7</span> <math alttext="\pm 0.2" class="ltx_Math" display="inline" id="S12.T10.3.3.3.3.m1.1"><semantics id="S12.T10.3.3.3.3.m1.1a"><mrow id="S12.T10.3.3.3.3.m1.1.1" xref="S12.T10.3.3.3.3.m1.1.1.cmml"><mo id="S12.T10.3.3.3.3.m1.1.1a" xref="S12.T10.3.3.3.3.m1.1.1.cmml">±</mo><mn id="S12.T10.3.3.3.3.m1.1.1.2" xref="S12.T10.3.3.3.3.m1.1.1.2.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.3.3.3.3.m1.1b"><apply id="S12.T10.3.3.3.3.m1.1.1.cmml" xref="S12.T10.3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S12.T10.3.3.3.3.m1.1.1.1.cmml" xref="S12.T10.3.3.3.3.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.3.3.3.3.m1.1.1.2.cmml" type="float" xref="S12.T10.3.3.3.3.m1.1.1.2">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.3.3.3.3.m1.1c">\pm 0.2</annotation><annotation encoding="application/x-llamapun" id="S12.T10.3.3.3.3.m1.1d">± 0.2</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S12.T10.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S12.T10.6.6.6.4">ScaleProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S12.T10.4.4.4.1">
<span class="ltx_text ltx_font_bold" id="S12.T10.4.4.4.1.1">0.063</span> <math alttext="\pm 0.001" class="ltx_Math" display="inline" id="S12.T10.4.4.4.1.m1.1"><semantics id="S12.T10.4.4.4.1.m1.1a"><mrow id="S12.T10.4.4.4.1.m1.1.1" xref="S12.T10.4.4.4.1.m1.1.1.cmml"><mo id="S12.T10.4.4.4.1.m1.1.1a" xref="S12.T10.4.4.4.1.m1.1.1.cmml">±</mo><mn id="S12.T10.4.4.4.1.m1.1.1.2" xref="S12.T10.4.4.4.1.m1.1.1.2.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.4.4.4.1.m1.1b"><apply id="S12.T10.4.4.4.1.m1.1.1.cmml" xref="S12.T10.4.4.4.1.m1.1.1"><csymbol cd="latexml" id="S12.T10.4.4.4.1.m1.1.1.1.cmml" xref="S12.T10.4.4.4.1.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.4.4.4.1.m1.1.1.2.cmml" type="float" xref="S12.T10.4.4.4.1.m1.1.1.2">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.4.4.4.1.m1.1c">\pm 0.001</annotation><annotation encoding="application/x-llamapun" id="S12.T10.4.4.4.1.m1.1d">± 0.001</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S12.T10.5.5.5.2">
<span class="ltx_text ltx_font_bold" id="S12.T10.5.5.5.2.1">9.1K</span> <math alttext="\pm 0.0" class="ltx_Math" display="inline" id="S12.T10.5.5.5.2.m1.1"><semantics id="S12.T10.5.5.5.2.m1.1a"><mrow id="S12.T10.5.5.5.2.m1.1.1" xref="S12.T10.5.5.5.2.m1.1.1.cmml"><mo id="S12.T10.5.5.5.2.m1.1.1a" xref="S12.T10.5.5.5.2.m1.1.1.cmml">±</mo><mn id="S12.T10.5.5.5.2.m1.1.1.2" xref="S12.T10.5.5.5.2.m1.1.1.2.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.5.5.5.2.m1.1b"><apply id="S12.T10.5.5.5.2.m1.1.1.cmml" xref="S12.T10.5.5.5.2.m1.1.1"><csymbol cd="latexml" id="S12.T10.5.5.5.2.m1.1.1.1.cmml" xref="S12.T10.5.5.5.2.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.5.5.5.2.m1.1.1.2.cmml" type="float" xref="S12.T10.5.5.5.2.m1.1.1.2">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.5.5.5.2.m1.1c">\pm 0.0</annotation><annotation encoding="application/x-llamapun" id="S12.T10.5.5.5.2.m1.1d">± 0.0</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S12.T10.6.6.6.3">15.6 <math alttext="\pm 0.5" class="ltx_Math" display="inline" id="S12.T10.6.6.6.3.m1.1"><semantics id="S12.T10.6.6.6.3.m1.1a"><mrow id="S12.T10.6.6.6.3.m1.1.1" xref="S12.T10.6.6.6.3.m1.1.1.cmml"><mo id="S12.T10.6.6.6.3.m1.1.1a" xref="S12.T10.6.6.6.3.m1.1.1.cmml">±</mo><mn id="S12.T10.6.6.6.3.m1.1.1.2" xref="S12.T10.6.6.6.3.m1.1.1.2.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.6.6.6.3.m1.1b"><apply id="S12.T10.6.6.6.3.m1.1.1.cmml" xref="S12.T10.6.6.6.3.m1.1.1"><csymbol cd="latexml" id="S12.T10.6.6.6.3.m1.1.1.1.cmml" xref="S12.T10.6.6.6.3.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.6.6.6.3.m1.1.1.2.cmml" type="float" xref="S12.T10.6.6.6.3.m1.1.1.2">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.6.6.6.3.m1.1c">\pm 0.5</annotation><annotation encoding="application/x-llamapun" id="S12.T10.6.6.6.3.m1.1d">± 0.5</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S12.T10.9.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S12.T10.9.9.9.4" rowspan="2"><span class="ltx_text" id="S12.T10.9.9.9.4.1">Cityscapes</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S12.T10.9.9.9.5">ProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.7.7.7.1">0.523 <math alttext="\pm 0.001" class="ltx_Math" display="inline" id="S12.T10.7.7.7.1.m1.1"><semantics id="S12.T10.7.7.7.1.m1.1a"><mrow id="S12.T10.7.7.7.1.m1.1.1" xref="S12.T10.7.7.7.1.m1.1.1.cmml"><mo id="S12.T10.7.7.7.1.m1.1.1a" xref="S12.T10.7.7.7.1.m1.1.1.cmml">±</mo><mn id="S12.T10.7.7.7.1.m1.1.1.2" xref="S12.T10.7.7.7.1.m1.1.1.2.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.7.7.7.1.m1.1b"><apply id="S12.T10.7.7.7.1.m1.1.1.cmml" xref="S12.T10.7.7.7.1.m1.1.1"><csymbol cd="latexml" id="S12.T10.7.7.7.1.m1.1.1.1.cmml" xref="S12.T10.7.7.7.1.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.7.7.7.1.m1.1.1.2.cmml" type="float" xref="S12.T10.7.7.7.1.m1.1.1.2">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.7.7.7.1.m1.1c">\pm 0.001</annotation><annotation encoding="application/x-llamapun" id="S12.T10.7.7.7.1.m1.1d">± 0.001</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.8.8.8.2">9.9K <math alttext="\pm 0.2" class="ltx_Math" display="inline" id="S12.T10.8.8.8.2.m1.1"><semantics id="S12.T10.8.8.8.2.m1.1a"><mrow id="S12.T10.8.8.8.2.m1.1.1" xref="S12.T10.8.8.8.2.m1.1.1.cmml"><mo id="S12.T10.8.8.8.2.m1.1.1a" xref="S12.T10.8.8.8.2.m1.1.1.cmml">±</mo><mn id="S12.T10.8.8.8.2.m1.1.1.2" xref="S12.T10.8.8.8.2.m1.1.1.2.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.8.8.8.2.m1.1b"><apply id="S12.T10.8.8.8.2.m1.1.1.cmml" xref="S12.T10.8.8.8.2.m1.1.1"><csymbol cd="latexml" id="S12.T10.8.8.8.2.m1.1.1.1.cmml" xref="S12.T10.8.8.8.2.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.8.8.8.2.m1.1.1.2.cmml" type="float" xref="S12.T10.8.8.8.2.m1.1.1.2">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.8.8.8.2.m1.1c">\pm 0.2</annotation><annotation encoding="application/x-llamapun" id="S12.T10.8.8.8.2.m1.1d">± 0.2</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.9.9.9.3">
<span class="ltx_text ltx_font_bold" id="S12.T10.9.9.9.3.1">52.5</span> <math alttext="\pm 0.2" class="ltx_Math" display="inline" id="S12.T10.9.9.9.3.m1.1"><semantics id="S12.T10.9.9.9.3.m1.1a"><mrow id="S12.T10.9.9.9.3.m1.1.1" xref="S12.T10.9.9.9.3.m1.1.1.cmml"><mo id="S12.T10.9.9.9.3.m1.1.1a" xref="S12.T10.9.9.9.3.m1.1.1.cmml">±</mo><mn id="S12.T10.9.9.9.3.m1.1.1.2" xref="S12.T10.9.9.9.3.m1.1.1.2.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.9.9.9.3.m1.1b"><apply id="S12.T10.9.9.9.3.m1.1.1.cmml" xref="S12.T10.9.9.9.3.m1.1.1"><csymbol cd="latexml" id="S12.T10.9.9.9.3.m1.1.1.1.cmml" xref="S12.T10.9.9.9.3.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.9.9.9.3.m1.1.1.2.cmml" type="float" xref="S12.T10.9.9.9.3.m1.1.1.2">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.9.9.9.3.m1.1c">\pm 0.2</annotation><annotation encoding="application/x-llamapun" id="S12.T10.9.9.9.3.m1.1d">± 0.2</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S12.T10.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S12.T10.12.12.12.4">ScaleProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S12.T10.10.10.10.1">
<span class="ltx_text ltx_font_bold" id="S12.T10.10.10.10.1.1">0.071</span> <math alttext="\pm 0.001" class="ltx_Math" display="inline" id="S12.T10.10.10.10.1.m1.1"><semantics id="S12.T10.10.10.10.1.m1.1a"><mrow id="S12.T10.10.10.10.1.m1.1.1" xref="S12.T10.10.10.10.1.m1.1.1.cmml"><mo id="S12.T10.10.10.10.1.m1.1.1a" xref="S12.T10.10.10.10.1.m1.1.1.cmml">±</mo><mn id="S12.T10.10.10.10.1.m1.1.1.2" xref="S12.T10.10.10.10.1.m1.1.1.2.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.10.10.10.1.m1.1b"><apply id="S12.T10.10.10.10.1.m1.1.1.cmml" xref="S12.T10.10.10.10.1.m1.1.1"><csymbol cd="latexml" id="S12.T10.10.10.10.1.m1.1.1.1.cmml" xref="S12.T10.10.10.10.1.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.10.10.10.1.m1.1.1.2.cmml" type="float" xref="S12.T10.10.10.10.1.m1.1.1.2">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.10.10.10.1.m1.1c">\pm 0.001</annotation><annotation encoding="application/x-llamapun" id="S12.T10.10.10.10.1.m1.1d">± 0.001</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S12.T10.11.11.11.2">
<span class="ltx_text ltx_font_bold" id="S12.T10.11.11.11.2.1">7.6K</span> <math alttext="\pm 0.1" class="ltx_Math" display="inline" id="S12.T10.11.11.11.2.m1.1"><semantics id="S12.T10.11.11.11.2.m1.1a"><mrow id="S12.T10.11.11.11.2.m1.1.1" xref="S12.T10.11.11.11.2.m1.1.1.cmml"><mo id="S12.T10.11.11.11.2.m1.1.1a" xref="S12.T10.11.11.11.2.m1.1.1.cmml">±</mo><mn id="S12.T10.11.11.11.2.m1.1.1.2" xref="S12.T10.11.11.11.2.m1.1.1.2.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.11.11.11.2.m1.1b"><apply id="S12.T10.11.11.11.2.m1.1.1.cmml" xref="S12.T10.11.11.11.2.m1.1.1"><csymbol cd="latexml" id="S12.T10.11.11.11.2.m1.1.1.1.cmml" xref="S12.T10.11.11.11.2.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.11.11.11.2.m1.1.1.2.cmml" type="float" xref="S12.T10.11.11.11.2.m1.1.1.2">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.11.11.11.2.m1.1c">\pm 0.1</annotation><annotation encoding="application/x-llamapun" id="S12.T10.11.11.11.2.m1.1d">± 0.1</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S12.T10.12.12.12.3">5.1 <math alttext="\pm 0.0" class="ltx_Math" display="inline" id="S12.T10.12.12.12.3.m1.1"><semantics id="S12.T10.12.12.12.3.m1.1a"><mrow id="S12.T10.12.12.12.3.m1.1.1" xref="S12.T10.12.12.12.3.m1.1.1.cmml"><mo id="S12.T10.12.12.12.3.m1.1.1a" xref="S12.T10.12.12.12.3.m1.1.1.cmml">±</mo><mn id="S12.T10.12.12.12.3.m1.1.1.2" xref="S12.T10.12.12.12.3.m1.1.1.2.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.12.12.12.3.m1.1b"><apply id="S12.T10.12.12.12.3.m1.1.1.cmml" xref="S12.T10.12.12.12.3.m1.1.1"><csymbol cd="latexml" id="S12.T10.12.12.12.3.m1.1.1.1.cmml" xref="S12.T10.12.12.12.3.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.12.12.12.3.m1.1.1.2.cmml" type="float" xref="S12.T10.12.12.12.3.m1.1.1.2">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.12.12.12.3.m1.1c">\pm 0.0</annotation><annotation encoding="application/x-llamapun" id="S12.T10.12.12.12.3.m1.1d">± 0.0</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S12.T10.15.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S12.T10.15.15.15.4" rowspan="2"><span class="ltx_text" id="S12.T10.15.15.15.4.1">ADE20K</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S12.T10.15.15.15.5">ProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.13.13.13.1">0.503 <math alttext="\pm 0.001" class="ltx_Math" display="inline" id="S12.T10.13.13.13.1.m1.1"><semantics id="S12.T10.13.13.13.1.m1.1a"><mrow id="S12.T10.13.13.13.1.m1.1.1" xref="S12.T10.13.13.13.1.m1.1.1.cmml"><mo id="S12.T10.13.13.13.1.m1.1.1a" xref="S12.T10.13.13.13.1.m1.1.1.cmml">±</mo><mn id="S12.T10.13.13.13.1.m1.1.1.2" xref="S12.T10.13.13.13.1.m1.1.1.2.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.13.13.13.1.m1.1b"><apply id="S12.T10.13.13.13.1.m1.1.1.cmml" xref="S12.T10.13.13.13.1.m1.1.1"><csymbol cd="latexml" id="S12.T10.13.13.13.1.m1.1.1.1.cmml" xref="S12.T10.13.13.13.1.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.13.13.13.1.m1.1.1.2.cmml" type="float" xref="S12.T10.13.13.13.1.m1.1.1.2">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.13.13.13.1.m1.1c">\pm 0.001</annotation><annotation encoding="application/x-llamapun" id="S12.T10.13.13.13.1.m1.1d">± 0.001</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.14.14.14.2">238.2K <math alttext="\pm 2.2" class="ltx_Math" display="inline" id="S12.T10.14.14.14.2.m1.1"><semantics id="S12.T10.14.14.14.2.m1.1a"><mrow id="S12.T10.14.14.14.2.m1.1.1" xref="S12.T10.14.14.14.2.m1.1.1.cmml"><mo id="S12.T10.14.14.14.2.m1.1.1a" xref="S12.T10.14.14.14.2.m1.1.1.cmml">±</mo><mn id="S12.T10.14.14.14.2.m1.1.1.2" xref="S12.T10.14.14.14.2.m1.1.1.2.cmml">2.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.14.14.14.2.m1.1b"><apply id="S12.T10.14.14.14.2.m1.1.1.cmml" xref="S12.T10.14.14.14.2.m1.1.1"><csymbol cd="latexml" id="S12.T10.14.14.14.2.m1.1.1.1.cmml" xref="S12.T10.14.14.14.2.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.14.14.14.2.m1.1.1.2.cmml" type="float" xref="S12.T10.14.14.14.2.m1.1.1.2">2.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.14.14.14.2.m1.1c">\pm 2.2</annotation><annotation encoding="application/x-llamapun" id="S12.T10.14.14.14.2.m1.1d">± 2.2</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S12.T10.15.15.15.3">
<span class="ltx_text ltx_font_bold" id="S12.T10.15.15.15.3.1">51.9</span> <math alttext="\pm 2.0" class="ltx_Math" display="inline" id="S12.T10.15.15.15.3.m1.1"><semantics id="S12.T10.15.15.15.3.m1.1a"><mrow id="S12.T10.15.15.15.3.m1.1.1" xref="S12.T10.15.15.15.3.m1.1.1.cmml"><mo id="S12.T10.15.15.15.3.m1.1.1a" xref="S12.T10.15.15.15.3.m1.1.1.cmml">±</mo><mn id="S12.T10.15.15.15.3.m1.1.1.2" xref="S12.T10.15.15.15.3.m1.1.1.2.cmml">2.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.15.15.15.3.m1.1b"><apply id="S12.T10.15.15.15.3.m1.1.1.cmml" xref="S12.T10.15.15.15.3.m1.1.1"><csymbol cd="latexml" id="S12.T10.15.15.15.3.m1.1.1.1.cmml" xref="S12.T10.15.15.15.3.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.15.15.15.3.m1.1.1.2.cmml" type="float" xref="S12.T10.15.15.15.3.m1.1.1.2">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.15.15.15.3.m1.1c">\pm 2.0</annotation><annotation encoding="application/x-llamapun" id="S12.T10.15.15.15.3.m1.1d">± 2.0</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S12.T10.18.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S12.T10.18.18.18.4">ScaleProtoSeg</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S12.T10.16.16.16.1">
<span class="ltx_text ltx_font_bold" id="S12.T10.16.16.16.1.1">0.437</span> <math alttext="\pm 0.001" class="ltx_Math" display="inline" id="S12.T10.16.16.16.1.m1.1"><semantics id="S12.T10.16.16.16.1.m1.1a"><mrow id="S12.T10.16.16.16.1.m1.1.1" xref="S12.T10.16.16.16.1.m1.1.1.cmml"><mo id="S12.T10.16.16.16.1.m1.1.1a" xref="S12.T10.16.16.16.1.m1.1.1.cmml">±</mo><mn id="S12.T10.16.16.16.1.m1.1.1.2" xref="S12.T10.16.16.16.1.m1.1.1.2.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.16.16.16.1.m1.1b"><apply id="S12.T10.16.16.16.1.m1.1.1.cmml" xref="S12.T10.16.16.16.1.m1.1.1"><csymbol cd="latexml" id="S12.T10.16.16.16.1.m1.1.1.1.cmml" xref="S12.T10.16.16.16.1.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.16.16.16.1.m1.1.1.2.cmml" type="float" xref="S12.T10.16.16.16.1.m1.1.1.2">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.16.16.16.1.m1.1c">\pm 0.001</annotation><annotation encoding="application/x-llamapun" id="S12.T10.16.16.16.1.m1.1d">± 0.001</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S12.T10.17.17.17.2">
<span class="ltx_text ltx_font_bold" id="S12.T10.17.17.17.2.1">135.4K</span> <math alttext="\pm 0.3" class="ltx_Math" display="inline" id="S12.T10.17.17.17.2.m1.1"><semantics id="S12.T10.17.17.17.2.m1.1a"><mrow id="S12.T10.17.17.17.2.m1.1.1" xref="S12.T10.17.17.17.2.m1.1.1.cmml"><mo id="S12.T10.17.17.17.2.m1.1.1a" xref="S12.T10.17.17.17.2.m1.1.1.cmml">±</mo><mn id="S12.T10.17.17.17.2.m1.1.1.2" xref="S12.T10.17.17.17.2.m1.1.1.2.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.17.17.17.2.m1.1b"><apply id="S12.T10.17.17.17.2.m1.1.1.cmml" xref="S12.T10.17.17.17.2.m1.1.1"><csymbol cd="latexml" id="S12.T10.17.17.17.2.m1.1.1.1.cmml" xref="S12.T10.17.17.17.2.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.17.17.17.2.m1.1.1.2.cmml" type="float" xref="S12.T10.17.17.17.2.m1.1.1.2">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.17.17.17.2.m1.1c">\pm 0.3</annotation><annotation encoding="application/x-llamapun" id="S12.T10.17.17.17.2.m1.1d">± 0.3</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S12.T10.18.18.18.3">14.5 <math alttext="\pm 0.8" class="ltx_Math" display="inline" id="S12.T10.18.18.18.3.m1.1"><semantics id="S12.T10.18.18.18.3.m1.1a"><mrow id="S12.T10.18.18.18.3.m1.1.1" xref="S12.T10.18.18.18.3.m1.1.1.cmml"><mo id="S12.T10.18.18.18.3.m1.1.1a" xref="S12.T10.18.18.18.3.m1.1.1.cmml">±</mo><mn id="S12.T10.18.18.18.3.m1.1.1.2" xref="S12.T10.18.18.18.3.m1.1.1.2.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.T10.18.18.18.3.m1.1b"><apply id="S12.T10.18.18.18.3.m1.1.1.cmml" xref="S12.T10.18.18.18.3.m1.1.1"><csymbol cd="latexml" id="S12.T10.18.18.18.3.m1.1.1.1.cmml" xref="S12.T10.18.18.18.3.m1.1.1">plus-or-minus</csymbol><cn id="S12.T10.18.18.18.3.m1.1.1.2.cmml" type="float" xref="S12.T10.18.18.18.3.m1.1.1.2">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.18.18.18.3.m1.1c">\pm 0.8</annotation><annotation encoding="application/x-llamapun" id="S12.T10.18.18.18.3.m1.1d">± 0.8</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S12.T10.24.3.1" style="font-size:90%;">Table 10</span>: </span><span class="ltx_text" id="S12.T10.22.2" style="font-size:90%;">Analysis of the sparsity of the final classification layer via the average absolute weight in <math alttext="\mathbf{w}_{h_{\text{proto}}}" class="ltx_Math" display="inline" id="S12.T10.21.1.m1.1"><semantics id="S12.T10.21.1.m1.1b"><msub id="S12.T10.21.1.m1.1.1" xref="S12.T10.21.1.m1.1.1.cmml"><mi id="S12.T10.21.1.m1.1.1.2" xref="S12.T10.21.1.m1.1.1.2.cmml">𝐰</mi><msub id="S12.T10.21.1.m1.1.1.3" xref="S12.T10.21.1.m1.1.1.3.cmml"><mi id="S12.T10.21.1.m1.1.1.3.2" xref="S12.T10.21.1.m1.1.1.3.2.cmml">h</mi><mtext id="S12.T10.21.1.m1.1.1.3.3" xref="S12.T10.21.1.m1.1.1.3.3a.cmml">proto</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S12.T10.21.1.m1.1c"><apply id="S12.T10.21.1.m1.1.1.cmml" xref="S12.T10.21.1.m1.1.1"><csymbol cd="ambiguous" id="S12.T10.21.1.m1.1.1.1.cmml" xref="S12.T10.21.1.m1.1.1">subscript</csymbol><ci id="S12.T10.21.1.m1.1.1.2.cmml" xref="S12.T10.21.1.m1.1.1.2">𝐰</ci><apply id="S12.T10.21.1.m1.1.1.3.cmml" xref="S12.T10.21.1.m1.1.1.3"><csymbol cd="ambiguous" id="S12.T10.21.1.m1.1.1.3.1.cmml" xref="S12.T10.21.1.m1.1.1.3">subscript</csymbol><ci id="S12.T10.21.1.m1.1.1.3.2.cmml" xref="S12.T10.21.1.m1.1.1.3.2">ℎ</ci><ci id="S12.T10.21.1.m1.1.1.3.3a.cmml" xref="S12.T10.21.1.m1.1.1.3.3"><mtext id="S12.T10.21.1.m1.1.1.3.3.cmml" mathsize="50%" xref="S12.T10.21.1.m1.1.1.3.3">proto</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.21.1.m1.1d">\mathbf{w}_{h_{\text{proto}}}</annotation><annotation encoding="application/x-llamapun" id="S12.T10.21.1.m1.1e">bold_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for ProtoSeg and <math alttext="\mathbf{w}_{h_{\text{group}}}" class="ltx_Math" display="inline" id="S12.T10.22.2.m2.1"><semantics id="S12.T10.22.2.m2.1b"><msub id="S12.T10.22.2.m2.1.1" xref="S12.T10.22.2.m2.1.1.cmml"><mi id="S12.T10.22.2.m2.1.1.2" xref="S12.T10.22.2.m2.1.1.2.cmml">𝐰</mi><msub id="S12.T10.22.2.m2.1.1.3" xref="S12.T10.22.2.m2.1.1.3.cmml"><mi id="S12.T10.22.2.m2.1.1.3.2" xref="S12.T10.22.2.m2.1.1.3.2.cmml">h</mi><mtext id="S12.T10.22.2.m2.1.1.3.3" xref="S12.T10.22.2.m2.1.1.3.3a.cmml">group</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S12.T10.22.2.m2.1c"><apply id="S12.T10.22.2.m2.1.1.cmml" xref="S12.T10.22.2.m2.1.1"><csymbol cd="ambiguous" id="S12.T10.22.2.m2.1.1.1.cmml" xref="S12.T10.22.2.m2.1.1">subscript</csymbol><ci id="S12.T10.22.2.m2.1.1.2.cmml" xref="S12.T10.22.2.m2.1.1.2">𝐰</ci><apply id="S12.T10.22.2.m2.1.1.3.cmml" xref="S12.T10.22.2.m2.1.1.3"><csymbol cd="ambiguous" id="S12.T10.22.2.m2.1.1.3.1.cmml" xref="S12.T10.22.2.m2.1.1.3">subscript</csymbol><ci id="S12.T10.22.2.m2.1.1.3.2.cmml" xref="S12.T10.22.2.m2.1.1.3.2">ℎ</ci><ci id="S12.T10.22.2.m2.1.1.3.3a.cmml" xref="S12.T10.22.2.m2.1.1.3.3"><mtext id="S12.T10.22.2.m2.1.1.3.3.cmml" mathsize="50%" xref="S12.T10.22.2.m2.1.1.3.3">group</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.T10.22.2.m2.1d">\mathbf{w}_{h_{\text{group}}}</annotation><annotation encoding="application/x-llamapun" id="S12.T10.22.2.m2.1e">bold_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for ScaleProtoSeg, and the computation overhead with respect to DeepLabv2 induced by the interpretable methods.</span></figcaption>
</figure>
<div class="ltx_para" id="S12.p1">
<p class="ltx_p" id="S12.p1.2">In the sparse grouping mechanism proposed in our method, we also enforce a strong sparsity regularization on the last layer <math alttext="h_{\text{proto}}" class="ltx_Math" display="inline" id="S12.p1.1.m1.1"><semantics id="S12.p1.1.m1.1a"><msub id="S12.p1.1.m1.1.1" xref="S12.p1.1.m1.1.1.cmml"><mi id="S12.p1.1.m1.1.1.2" xref="S12.p1.1.m1.1.1.2.cmml">h</mi><mtext id="S12.p1.1.m1.1.1.3" xref="S12.p1.1.m1.1.1.3a.cmml">proto</mtext></msub><annotation-xml encoding="MathML-Content" id="S12.p1.1.m1.1b"><apply id="S12.p1.1.m1.1.1.cmml" xref="S12.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S12.p1.1.m1.1.1.1.cmml" xref="S12.p1.1.m1.1.1">subscript</csymbol><ci id="S12.p1.1.m1.1.1.2.cmml" xref="S12.p1.1.m1.1.1.2">ℎ</ci><ci id="S12.p1.1.m1.1.1.3a.cmml" xref="S12.p1.1.m1.1.1.3"><mtext id="S12.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S12.p1.1.m1.1.1.3">proto</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.1.m1.1c">h_{\text{proto}}</annotation><annotation encoding="application/x-llamapun" id="S12.p1.1.m1.1d">italic_h start_POSTSUBSCRIPT proto end_POSTSUBSCRIPT</annotation></semantics></math> which enables the model to constrain the negative effect of the prototypes not assigned to a class in the final decision process, as shown in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S3.SS3" title="3.3 Multi-stage training procedure ‣ 3 Method ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">3.3</span></a>. We see in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S12.T10" title="Table 10 ‣ 12 Sparsity and Computation Overhead ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a> that our method presents a small average absolute weight on <math alttext="\mathbf{w}_{h_{\text{group}}}" class="ltx_Math" display="inline" id="S12.p1.2.m2.1"><semantics id="S12.p1.2.m2.1a"><msub id="S12.p1.2.m2.1.1" xref="S12.p1.2.m2.1.1.cmml"><mi id="S12.p1.2.m2.1.1.2" xref="S12.p1.2.m2.1.1.2.cmml">𝐰</mi><msub id="S12.p1.2.m2.1.1.3" xref="S12.p1.2.m2.1.1.3.cmml"><mi id="S12.p1.2.m2.1.1.3.2" xref="S12.p1.2.m2.1.1.3.2.cmml">h</mi><mtext id="S12.p1.2.m2.1.1.3.3" xref="S12.p1.2.m2.1.1.3.3a.cmml">group</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S12.p1.2.m2.1b"><apply id="S12.p1.2.m2.1.1.cmml" xref="S12.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S12.p1.2.m2.1.1.1.cmml" xref="S12.p1.2.m2.1.1">subscript</csymbol><ci id="S12.p1.2.m2.1.1.2.cmml" xref="S12.p1.2.m2.1.1.2">𝐰</ci><apply id="S12.p1.2.m2.1.1.3.cmml" xref="S12.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S12.p1.2.m2.1.1.3.1.cmml" xref="S12.p1.2.m2.1.1.3">subscript</csymbol><ci id="S12.p1.2.m2.1.1.3.2.cmml" xref="S12.p1.2.m2.1.1.3.2">ℎ</ci><ci id="S12.p1.2.m2.1.1.3.3a.cmml" xref="S12.p1.2.m2.1.1.3.3"><mtext id="S12.p1.2.m2.1.1.3.3.cmml" mathsize="50%" xref="S12.p1.2.m2.1.1.3.3">group</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.2.m2.1c">\mathbf{w}_{h_{\text{group}}}</annotation><annotation encoding="application/x-llamapun" id="S12.p1.2.m2.1d">bold_w start_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT group end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and as a consequence a strong sparsity for both Pascal VOC and Cityscapes, especially compared to ProtoSeg. Moreover, despite the increased complexity of ADE20K, our method presents still a smaller average absolute weight than ProtoSeg.</p>
</div>
<div class="ltx_para" id="S12.p2">
<p class="ltx_p" id="S12.p2.2">We also analyze in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S12.T10" title="Table 10 ‣ 12 Sparsity and Computation Overhead ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a> the number of extra-parameters necessary in our method and ProtoSeg compared to the black-box baseline: DeepLabv2, after pruning at inference. We observe that, due to the limited number of active prototypes and the group projection, ScaleProtoSeg requires less computational overhead, especially for a large number of classes like in ADE20K, where our method uses <math alttext="43\%" class="ltx_Math" display="inline" id="S12.p2.1.m1.1"><semantics id="S12.p2.1.m1.1a"><mrow id="S12.p2.1.m1.1.1" xref="S12.p2.1.m1.1.1.cmml"><mn id="S12.p2.1.m1.1.1.2" xref="S12.p2.1.m1.1.1.2.cmml">43</mn><mo id="S12.p2.1.m1.1.1.1" xref="S12.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S12.p2.1.m1.1b"><apply id="S12.p2.1.m1.1.1.cmml" xref="S12.p2.1.m1.1.1"><csymbol cd="latexml" id="S12.p2.1.m1.1.1.1.cmml" xref="S12.p2.1.m1.1.1.1">percent</csymbol><cn id="S12.p2.1.m1.1.1.2.cmml" type="integer" xref="S12.p2.1.m1.1.1.2">43</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p2.1.m1.1c">43\%</annotation><annotation encoding="application/x-llamapun" id="S12.p2.1.m1.1d">43 %</annotation></semantics></math> less extra parameters. Those results are computed on 3 local runs per method, and it is important to highlight that ProtoSeg on Pascal despite similar performance presents <math alttext="\sim 25" class="ltx_Math" display="inline" id="S12.p2.2.m2.1"><semantics id="S12.p2.2.m2.1a"><mrow id="S12.p2.2.m2.1.1" xref="S12.p2.2.m2.1.1.cmml"><mi id="S12.p2.2.m2.1.1.2" xref="S12.p2.2.m2.1.1.2.cmml"></mi><mo id="S12.p2.2.m2.1.1.1" xref="S12.p2.2.m2.1.1.1.cmml">∼</mo><mn id="S12.p2.2.m2.1.1.3" xref="S12.p2.2.m2.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S12.p2.2.m2.1b"><apply id="S12.p2.2.m2.1.1.cmml" xref="S12.p2.2.m2.1.1"><csymbol cd="latexml" id="S12.p2.2.m2.1.1.1.cmml" xref="S12.p2.2.m2.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S12.p2.2.m2.1.1.2.cmml" xref="S12.p2.2.m2.1.1.2">absent</csymbol><cn id="S12.p2.2.m2.1.1.3.cmml" type="integer" xref="S12.p2.2.m2.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p2.2.m2.1c">\sim 25</annotation><annotation encoding="application/x-llamapun" id="S12.p2.2.m2.1d">∼ 25</annotation></semantics></math> more prototypes after pruning compared to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite>, which also directly impacts the sparsity metric in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S8.T6" title="Table 6 ‣ 8 Extension to large dataset ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div class="ltx_para" id="S12.p3">
<p class="ltx_p" id="S12.p3.1">It is also important to consider the computational overhead during training. First, we showed that the added number of parameters compared to DeepLabv2 is minimal. However, some overhead complexity arises in ProtoSeg and ScaleProto from the KLD regularisation loss and the prototype projection. In particular, the impact on training time of the KLD loss is much more important in the case of ProtoSeg at a high number of prototypes compared to ScaleProtoSeg as in our method we parallelize the loss across scales. Moreover, at training time the fine-tuning of the classification layer and groups after the prototype projection of our method adds only a limited overhead to the training as we tune only a handful of parameters for a few epochs.</p>
</div>
<div class="ltx_para" id="S12.p4">
<p class="ltx_p" id="S12.p4.1">Finally as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S12.T10" title="Table 10 ‣ 12 Sparsity and Computation Overhead ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a> at inference our method is slower than ProtoSeg due to the grouping process but we believe that is likely due to a lack of parallelization in our code.</p>
</div>
</section>
<section class="ltx_section" id="S13">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">13 </span>Group Representations and Assignments</h2>
<figure class="ltx_figure" id="S13.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="285" id="S13.F11.g1" src="x5.png" width="951"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S13.F11.9.3.1" style="font-size:90%;">Figure 11</span>: </span><span class="ltx_text" id="S13.F11.4.2" style="font-size:90%;">ScaleProtoSeg provides an interpretation of the resulted segmentation through groups of prototypes. For an example of the class <span class="ltx_text ltx_font_italic" id="S13.F11.4.2.1">person</span> on Cityscapes, <math alttext="2" class="ltx_Math" display="inline" id="S13.F11.3.1.m1.1"><semantics id="S13.F11.3.1.m1.1b"><mn id="S13.F11.3.1.m1.1.1" xref="S13.F11.3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S13.F11.3.1.m1.1c"><cn id="S13.F11.3.1.m1.1.1.cmml" type="integer" xref="S13.F11.3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S13.F11.3.1.m1.1d">2</annotation><annotation encoding="application/x-llamapun" id="S13.F11.3.1.m1.1e">2</annotation></semantics></math> prototypes per scale (whose activations are displayed <span class="ltx_text ltx_font_bold" id="S13.F11.4.2.2">at the top</span> of the figure) are used by the model across the <math alttext="3" class="ltx_Math" display="inline" id="S13.F11.4.2.m2.1"><semantics id="S13.F11.4.2.m2.1b"><mn id="S13.F11.4.2.m2.1.1" xref="S13.F11.4.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S13.F11.4.2.m2.1c"><cn id="S13.F11.4.2.m2.1.1.cmml" type="integer" xref="S13.F11.4.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S13.F11.4.2.m2.1d">3</annotation><annotation encoding="application/x-llamapun" id="S13.F11.4.2.m2.1e">3</annotation></semantics></math> learned groups shown <span class="ltx_text ltx_font_bold" id="S13.F11.4.2.3">at the bottom right</span>. For this class, groups can correspond to the feet, the main body or the head of the person.</span></figcaption>
</figure>
<div class="ltx_para" id="S13.p1">
<p class="ltx_p" id="S13.p1.1">In this section, we aim to present more representative examples of our results in terms of interpretability. First, we show in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S13.F11" title="Figure 11 ‣ 13 Group Representations and Assignments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">11</span></a> an example of group activations for the class <span class="ltx_text ltx_font_italic" id="S13.p1.1.1">person</span> in Cityscapes, where groups 1 and 2 identify the head and feet respectively of a <span class="ltx_text ltx_font_italic" id="S13.p1.1.2">person</span>, while group 3 identifies the main body of the <span class="ltx_text ltx_font_italic" id="S13.p1.1.3">persons</span>. Interestingly, similarly to the class <span class="ltx_text ltx_font_italic" id="S13.p1.1.4">car</span> in the main paper, group 2 is mainly activated by a prototype at scale 1 and as a consequence seems to be more present on <span class="ltx_text ltx_font_italic" id="S13.p1.1.5">person</span> further away in the image as seen in <span class="ltx_text ltx_font_bold" id="S13.p1.1.6">(b)</span>. This level of understanding of the scale effect on the model representation is a key contribution of our method compared to ProtoSeg in terms of interpretability.</p>
</div>
<div class="ltx_para" id="S13.p2">
<p class="ltx_p" id="S13.p2.1">Moreover, we show in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S13.F12" title="Figure 12 ‣ 13 Group Representations and Assignments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">12</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S13.F13" title="Figure 13 ‣ 13 Group Representations and Assignments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">13</span></a> more comparative results between our method and ProtoSeg, where again the limitations on the number of groups simplify the analysis of the decision process for our method as seen for the class <span class="ltx_text ltx_font_italic" id="S13.p2.1.1">bicycle</span> and <span class="ltx_text ltx_font_italic" id="S13.p2.1.2">chair</span>. In the analysis of the class <span class="ltx_text ltx_font_italic" id="S13.p2.1.3">rider</span> and <span class="ltx_text ltx_font_italic" id="S13.p2.1.4">aeroplane</span>, we can observe another advantage of our method as ProtoSeg presents a failure case of prototype pruning where only one prototype specific to the class <span class="ltx_text ltx_font_italic" id="S13.p2.1.5">rider</span> or <span class="ltx_text ltx_font_italic" id="S13.p2.1.6">aeroplane</span> is left after post-processing.</p>
</div>
<figure class="ltx_figure" id="S13.F12">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S13.F12.15">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S13.F12.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F12.3.3.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F12.3.3.4.1" style="width:8.9pt;height:55.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:55.6pt;transform:translate(-23.35pt,-22.38pt) rotate(-90deg) ;">
<p class="ltx_p" id="S13.F12.3.3.4.1.1">Original</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.1.1.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.1.1.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000001_038645_original.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.2.2.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.2.2.2.g1" src="extracted/5854717/images/plot_img_munster_000140_000019_original.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.3.3.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.3.3.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00001250_original.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F12.6.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F12.6.6.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F12.6.6.4.1" style="width:20.1pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-22.67pt,-19.4pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F12.6.6.4.1.1" style="width:65.4pt;">ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.4.4.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.4.4.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000001_038645_max_class_bicycle.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.5.5.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.5.5.2.g1" src="extracted/5854717/images/plot_img_munster_000140_000019_max_class_rider.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.6.6.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.6.6.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00001250_max_class_chair.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F12.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F12.9.9.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F12.9.9.4.1" style="width:18.3pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-23.6pt,-20.78pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F12.9.9.4.1.1" style="width:65.4pt;">ScaleProtoSeg groups</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.7.7.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.7.7.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000001_038645_max_class_bicycle_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.8.8.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.8.8.2.g1" src="extracted/5854717/images/plot_img_munster_000140_000019_max_class_rider_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.9.9.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.9.9.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00001250_max_class_chair_group.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F12.12.12">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F12.12.12.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F12.12.12.4.1" style="width:20.1pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-22.67pt,-19.4pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F12.12.12.4.1.1" style="width:65.4pt;">ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> output</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.10.10.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.10.10.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000001_038645_segmentation.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.11.11.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.11.11.2.g1" src="extracted/5854717/images/plot_img_munster_000140_000019_segmentation.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.12.12.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.12.12.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00001250_segmentation.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F12.15.15">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F12.15.15.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F12.15.15.4.1" style="width:20.1pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-22.67pt,-19.4pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F12.15.15.4.1.1" style="width:65.4pt;">ScaleProtoSeg output</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.13.13.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.13.13.1.g1" src="extracted/5854717/images/plot_img_frankfurt_000001_038645_segmentation_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.14.14.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.14.14.2.g1" src="extracted/5854717/images/plot_img_munster_000140_000019_segmentation_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F12.15.15.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F12.15.15.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00001250_segmentation_group.jpg" width="206"/></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S13.F12.20.1.1" style="font-size:90%;">Figure 12</span>: </span><span class="ltx_text" id="S13.F12.21.2" style="font-size:90%;">Model prototype, group assignments and prediction for the class <span class="ltx_text ltx_font_italic" id="S13.F12.21.2.1">bicycle</span>, <span class="ltx_text ltx_font_italic" id="S13.F12.21.2.2">rider</span>, and <span class="ltx_text ltx_font_italic" id="S13.F12.21.2.3">chair</span> on Cityscapes, and ADE20K.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S13.F13">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S13.F13.15">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S13.F13.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F13.3.3.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F13.3.3.4.1" style="width:8.9pt;height:55.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:55.6pt;transform:translate(-23.35pt,-22.38pt) rotate(-90deg) ;">
<p class="ltx_p" id="S13.F13.3.3.4.1.1">Original</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.1.1.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.1.1.1.g1" src="extracted/5854717/images/plot_img_2007_009706_original.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.2.2.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.2.2.2.g1" src="extracted/5854717/images/plot_img_2010_001174_original.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.3.3.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.3.3.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00000294_original.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F13.6.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F13.6.6.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F13.6.6.4.1" style="width:20.1pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-22.67pt,-19.4pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F13.6.6.4.1.1" style="width:65.4pt;">ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.4.4.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.4.4.1.g1" src="extracted/5854717/images/plot_img_2007_009706_max_class_diningtable.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.5.5.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.5.5.2.g1" src="extracted/5854717/images/plot_img_2010_001174_max_class_aeroplane.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.6.6.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.6.6.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00000294_max_class_animal.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F13.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F13.9.9.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F13.9.9.4.1" style="width:18.3pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-23.6pt,-20.78pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F13.9.9.4.1.1" style="width:65.4pt;">ScaleProtoSeg groups</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.7.7.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.7.7.1.g1" src="extracted/5854717/images/plot_img_2007_009706_max_class_diningtable_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.8.8.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.8.8.2.g1" src="extracted/5854717/images/plot_img_2010_001174_max_class_aeroplane_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.9.9.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.9.9.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00000294_max_class_animal_group.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F13.12.12">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F13.12.12.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F13.12.12.4.1" style="width:20.1pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-22.67pt,-19.4pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F13.12.12.4.1.1" style="width:65.4pt;">ProtoSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib70" title="">70</a>]</cite> output</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.10.10.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.10.10.1.g1" src="extracted/5854717/images/plot_img_2007_009706_segmentation.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.11.11.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.11.11.2.g1" src="extracted/5854717/images/plot_img_2010_001174_segmentation.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.12.12.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.12.12.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00000294_segmentation.jpg" width="206"/></td>
</tr>
<tr class="ltx_tr" id="S13.F13.15.15">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S13.F13.15.15.4" style="padding-left:1.5pt;padding-right:1.5pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S13.F13.15.15.4.1" style="width:20.1pt;height:65.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:65.4pt;transform:translate(-22.67pt,-19.4pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S13.F13.15.15.4.1.1" style="width:65.4pt;">ScaleProtoSeg output</p>
</span></div>
</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.13.13.1" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.13.13.1.g1" src="extracted/5854717/images/plot_img_2007_009706_segmentation_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.14.14.2" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.14.14.2.g1" src="extracted/5854717/images/plot_img_2010_001174_segmentation_group.jpg" width="206"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S13.F13.15.15.3" style="padding-left:1.5pt;padding-right:1.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S13.F13.15.15.3.g1" src="extracted/5854717/images/plot_img_ADE_val_00000294_segmentation_group.jpg" width="206"/></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S13.F13.20.1.1" style="font-size:90%;">Figure 13</span>: </span><span class="ltx_text" id="S13.F13.21.2" style="font-size:90%;">Model prototype, group assignments and prediction for the class <span class="ltx_text ltx_font_italic" id="S13.F13.21.2.1">dinning table</span>, <span class="ltx_text ltx_font_italic" id="S13.F13.21.2.2">aeroplane</span>, and <span class="ltx_text ltx_font_italic" id="S13.F13.21.2.3">animal</span> on Pascal, and ADE20K.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S14">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">14 </span>Nearest Image Patches to Prototypes</h2>
<div class="ltx_para" id="S14.p1">
<p class="ltx_p" id="S14.p1.1">For the learned prototypes to be interpretable to the users, the semantic parts that they represent should be similar across images. To analyze whether our method is consistent across images, we extend the consistency metric from Section <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S4.SS2" title="4.2 Results and discussion ‣ 4 Experiments ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4.2</span></a> with visualizations of the nearest images in the validation set from a few prototypes in Cityscapes and Pascal VOC. Those visualizations are shown in Figures [<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S14.F14" title="Figure 14 ‣ 14 Nearest Image Patches to Prototypes ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">14</span></a> - <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S14.F19" title="Figure 19 ‣ 14 Nearest Image Patches to Prototypes ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">19</span></a>], and showcase strong semantic correspondences between the prototypes and their closest patches.</p>
</div>
<figure class="ltx_figure" id="S14.F14">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S14.F14.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F14.10.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S14.F14.10.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F14.10.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F14.10.1.1.1.1.1" style="width:113.8pt;">Prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_align_center" id="S14.F14.10.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F14.10.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F14.1.g1" src="extracted/5854717/images/35_used/org/prototype-img_scale_0_35-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F14.2.g1" src="extracted/5854717/images/35_used/org/prototype-img_scale_0_35-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S14.F14.11"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S14.F14.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F14.12.1.1">
<td class="ltx_td ltx_align_center" id="S14.F14.12.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F14.12.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F14.12.1.1.1.1.1" style="width:113.8pt;">Top 1 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F14.12.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F14.12.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F14.12.2.2">
<td class="ltx_td ltx_align_center" id="S14.F14.12.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F14.12.2.2.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F14.12.2.2.1.1.1" style="width:113.8pt;">Top 2 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F14.12.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F14.12.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F14.12.3.3">
<td class="ltx_td ltx_align_center" id="S14.F14.12.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F14.12.3.3.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F14.12.3.3.1.1.1" style="width:113.8pt;">Top 3 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F14.12.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F14.12.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F14.3.g1" src="extracted/5854717/images/35_used/closest/prototype-img_class_person_scale_0_35_closest_0-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F14.4.g1" src="extracted/5854717/images/35_used/closest/prototype-img_class_person_scale_0_35_closest_0-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F14.5.g1" src="extracted/5854717/images/35_used/closest/prototype-img_class_person_scale_0_35_closest_1-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F14.6.g1" src="extracted/5854717/images/35_used/closest/prototype-img_class_person_scale_0_35_closest_1-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S14.F14.7.g1" src="extracted/5854717/images/35_used/closest/prototype-img_class_person_scale_0_35_closest_2-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F14.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F14.8.g1" src="extracted/5854717/images/35_used/closest/prototype-img_class_person_scale_0_35_closest_2-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S14.F14.14.1.1" style="font-size:90%;">Figure 14</span>: </span><span class="ltx_text" id="S14.F14.15.2" style="font-size:90%;">The first row represents a prototype for the class <span class="ltx_text ltx_font_italic" id="S14.F14.15.2.1">person</span> in Cityscapes marked by a red box and the activation of the prototype on its image. The second to fourth rows show the closest patches to the prototype and its activation on the images containing the patches.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S14.F15">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S14.F15.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F15.10.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S14.F15.10.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F15.10.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F15.10.1.1.1.1.1" style="width:113.8pt;">Prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_align_center" id="S14.F15.10.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F15.10.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.1.g1" src="extracted/5854717/images/97_used/org/prototype-img_scale_1_97-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.2.g1" src="extracted/5854717/images/97_used/org/prototype-img_scale_1_97-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S14.F15.11"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S14.F15.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F15.12.1.1">
<td class="ltx_td ltx_align_center" id="S14.F15.12.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F15.12.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F15.12.1.1.1.1.1" style="width:113.8pt;">Top 1 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F15.12.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F15.12.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F15.12.2.2">
<td class="ltx_td ltx_align_center" id="S14.F15.12.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F15.12.2.2.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F15.12.2.2.1.1.1" style="width:113.8pt;">Top 2 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F15.12.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F15.12.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F15.12.3.3">
<td class="ltx_td ltx_align_center" id="S14.F15.12.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F15.12.3.3.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F15.12.3.3.1.1.1" style="width:113.8pt;">Top 3 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F15.12.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F15.12.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.3.g1" src="extracted/5854717/images/97_used/closest/prototype-img_class_car_scale_1_97_closest_0-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.4.g1" src="extracted/5854717/images/97_used/closest/prototype-img_class_car_scale_1_97_closest_0-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.5.g1" src="extracted/5854717/images/97_used/closest/prototype-img_class_car_scale_1_97_closest_1-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.6.g1" src="extracted/5854717/images/97_used/closest/prototype-img_class_car_scale_1_97_closest_1-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.7.g1" src="extracted/5854717/images/97_used/closest/prototype-img_class_car_scale_1_97_closest_2-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F15.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F15.8.g1" src="extracted/5854717/images/97_used/closest/prototype-img_class_car_scale_1_97_closest_2-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S14.F15.14.1.1" style="font-size:90%;">Figure 15</span>: </span><span class="ltx_text" id="S14.F15.15.2" style="font-size:90%;">The first row represents a prototype for the class <span class="ltx_text ltx_font_italic" id="S14.F15.15.2.1">car</span> in Cityscapes marked by a red box and the activation of the prototype on its image. The second to fourth rows show the closest patches to the prototype and its activation on the images containing the patches.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S14.F16">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S14.F16.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F16.10.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S14.F16.10.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F16.10.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F16.10.1.1.1.1.1" style="width:113.8pt;">Prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_align_center" id="S14.F16.10.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F16.10.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S14.F16.1.g1" src="extracted/5854717/images/227_used/org/prototype-img_scale_3_227-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F16.2.g1" src="extracted/5854717/images/227_used/org/prototype-img_scale_3_227-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S14.F16.11"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S14.F16.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F16.12.1.1">
<td class="ltx_td ltx_align_center" id="S14.F16.12.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F16.12.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F16.12.1.1.1.1.1" style="width:113.8pt;">Top 1 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F16.12.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F16.12.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F16.12.2.2">
<td class="ltx_td ltx_align_center" id="S14.F16.12.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F16.12.2.2.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F16.12.2.2.1.1.1" style="width:113.8pt;">Top 2 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F16.12.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F16.12.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F16.12.3.3">
<td class="ltx_td ltx_align_center" id="S14.F16.12.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F16.12.3.3.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F16.12.3.3.1.1.1" style="width:113.8pt;">Top 3 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F16.12.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F16.12.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F16.3.g1" src="extracted/5854717/images/227_used/closest/prototype-img_class_bicycle_scale_3_227_closest_0-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F16.4.g1" src="extracted/5854717/images/227_used/closest/prototype-img_class_bicycle_scale_3_227_closest_0-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F16.5.g1" src="extracted/5854717/images/227_used/closest/prototype-img_class_bicycle_scale_3_227_closest_1-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F16.6.g1" src="extracted/5854717/images/227_used/closest/prototype-img_class_bicycle_scale_3_227_closest_1-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F16.7.g1" src="extracted/5854717/images/227_used/closest/prototype-img_class_bicycle_scale_3_227_closest_2-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F16.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F16.8.g1" src="extracted/5854717/images/227_used/closest/prototype-img_class_bicycle_scale_3_227_closest_2-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S14.F16.14.1.1" style="font-size:90%;">Figure 16</span>: </span><span class="ltx_text" id="S14.F16.15.2" style="font-size:90%;">The first row represents a prototype for the class <span class="ltx_text ltx_font_italic" id="S14.F16.15.2.1">bicycle</span> in Cityscapes marked by a red box and the activation of the prototype on its image. The second to fourth rows show the closest patches to the prototype and its activation on the images containing the patches.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S14.F17">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S14.F17.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F17.10.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S14.F17.10.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F17.10.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F17.10.1.1.1.1.1" style="width:113.8pt;">Prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_align_center" id="S14.F17.10.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F17.10.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.1.g1" src="extracted/5854717/images/9_used/org/prototype-img_scale_0_9-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.2.g1" src="extracted/5854717/images/9_used/org/prototype-img_scale_0_9-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S14.F17.11"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S14.F17.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F17.12.1.1">
<td class="ltx_td ltx_align_center" id="S14.F17.12.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F17.12.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F17.12.1.1.1.1.1" style="width:113.8pt;">Top 1 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F17.12.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F17.12.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F17.12.2.2">
<td class="ltx_td ltx_align_center" id="S14.F17.12.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F17.12.2.2.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F17.12.2.2.1.1.1" style="width:113.8pt;">Top 2 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F17.12.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F17.12.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F17.12.3.3">
<td class="ltx_td ltx_align_center" id="S14.F17.12.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F17.12.3.3.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F17.12.3.3.1.1.1" style="width:113.8pt;">Top 3 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F17.12.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F17.12.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.3.g1" src="extracted/5854717/images/9_used/closest/prototype-img_class_bird_scale_0_9_closest_0-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.4.g1" src="extracted/5854717/images/9_used/closest/prototype-img_class_bird_scale_0_9_closest_0-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.5.g1" src="extracted/5854717/images/9_used/closest/prototype-img_class_bird_scale_0_9_closest_1-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.6.g1" src="extracted/5854717/images/9_used/closest/prototype-img_class_bird_scale_0_9_closest_1-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.7.g1" src="extracted/5854717/images/9_used/closest/prototype-img_class_bird_scale_0_9_closest_2-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F17.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F17.8.g1" src="extracted/5854717/images/9_used/closest/prototype-img_class_bird_scale_0_9_closest_2-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S14.F17.14.1.1" style="font-size:90%;">Figure 17</span>: </span><span class="ltx_text" id="S14.F17.15.2" style="font-size:90%;">The first row represents a prototype for the class <span class="ltx_text ltx_font_italic" id="S14.F17.15.2.1">bird</span> in PASCAL VOC marked by a red box and the activation of the prototype on its image. The second to fourth rows show the closest patches to the prototype and its activation on the images containing the patches.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S14.F18">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S14.F18.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F18.10.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S14.F18.10.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F18.10.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F18.10.1.1.1.1.1" style="width:113.8pt;">Prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_align_center" id="S14.F18.10.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F18.10.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.1.g1" src="extracted/5854717/images/89_used/org/prototype-img_scale_1_89-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.2.g1" src="extracted/5854717/images/89_used/org/prototype-img_scale_1_89-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S14.F18.11"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S14.F18.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F18.12.1.1">
<td class="ltx_td ltx_align_center" id="S14.F18.12.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F18.12.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F18.12.1.1.1.1.1" style="width:113.8pt;">Top 1 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F18.12.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F18.12.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F18.12.2.2">
<td class="ltx_td ltx_align_center" id="S14.F18.12.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F18.12.2.2.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F18.12.2.2.1.1.1" style="width:113.8pt;">Top 2 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F18.12.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F18.12.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F18.12.3.3">
<td class="ltx_td ltx_align_center" id="S14.F18.12.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F18.12.3.3.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F18.12.3.3.1.1.1" style="width:113.8pt;">Top 3 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F18.12.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F18.12.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.3.g1" src="extracted/5854717/images/89_used/closest/prototype-img_class_cat_scale_1_89_closest_0-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.4.g1" src="extracted/5854717/images/89_used/closest/prototype-img_class_cat_scale_1_89_closest_0-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.5.g1" src="extracted/5854717/images/89_used/closest/prototype-img_class_cat_scale_1_89_closest_1-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.6.g1" src="extracted/5854717/images/89_used/closest/prototype-img_class_cat_scale_1_89_closest_1-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.7.g1" src="extracted/5854717/images/89_used/closest/prototype-img_class_cat_scale_1_89_closest_2-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F18.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F18.8.g1" src="extracted/5854717/images/89_used/closest/prototype-img_class_cat_scale_1_89_closest_2-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S14.F18.14.1.1" style="font-size:90%;">Figure 18</span>: </span><span class="ltx_text" id="S14.F18.15.2" style="font-size:90%;">The first row represents a prototype for the class <span class="ltx_text ltx_font_italic" id="S14.F18.15.2.1">cat</span> in PASCAL VOC marked by a red box and the activation of the prototype on its image. The second to fourth rows show the closest patches to the prototype and its activation on the images containing the patches.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S14.F19">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S14.F19.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F19.10.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S14.F19.10.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F19.10.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F19.10.1.1.1.1.1" style="width:113.8pt;">Prototypes</p>
</span></div>
</th>
<td class="ltx_td ltx_align_center" id="S14.F19.10.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F19.10.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.1.g1" src="extracted/5854717/images/162_used/org/prototype-img_scale_2_162-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.2.g1" src="extracted/5854717/images/162_used/org/prototype-img_scale_2_162-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S14.F19.11"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S14.F19.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S14.F19.12.1.1">
<td class="ltx_td ltx_align_center" id="S14.F19.12.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F19.12.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F19.12.1.1.1.1.1" style="width:113.8pt;">Top 1 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F19.12.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F19.12.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F19.12.2.2">
<td class="ltx_td ltx_align_center" id="S14.F19.12.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F19.12.2.2.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F19.12.2.2.1.1.1" style="width:113.8pt;">Top 2 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F19.12.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F19.12.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S14.F19.12.3.3">
<td class="ltx_td ltx_align_center" id="S14.F19.12.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S14.F19.12.3.3.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S14.F19.12.3.3.1.1.1" style="width:113.8pt;">Top 3 Patch</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S14.F19.12.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S14.F19.12.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.3.g1" src="extracted/5854717/images/162_used/closest/prototype-img_class_dog_scale_2_162_closest_0-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.4.g1" src="extracted/5854717/images/162_used/closest/prototype-img_class_dog_scale_2_162_closest_0-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.5.g1" src="extracted/5854717/images/162_used/closest/prototype-img_class_dog_scale_2_162_closest_1-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.6.g1" src="extracted/5854717/images/162_used/closest/prototype-img_class_dog_scale_2_162_closest_1-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.7.g1" src="extracted/5854717/images/162_used/closest/prototype-img_class_dog_scale_2_162_closest_2-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S14.F19.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S14.F19.8.g1" src="extracted/5854717/images/162_used/closest/prototype-img_class_dog_scale_2_162_closest_2-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S14.F19.14.1.1" style="font-size:90%;">Figure 19</span>: </span><span class="ltx_text" id="S14.F19.15.2" style="font-size:90%;">The first row represents a prototype for the class <span class="ltx_text ltx_font_italic" id="S14.F19.15.2.1">dog</span> in PASCAL VOC marked by a red box and the activation of the prototype on its image. The second to fourth rows show the closest patches to the prototype and its activation on the images containing the patches.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S15">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">15 </span>Nearest Prototypes to Image Patches</h2>
<div class="ltx_para" id="S15.p1">
<p class="ltx_p" id="S15.p1.1">To further analyze the semantic correspondences in the prototype layer of the model, we study the nearest prototypes to all image patches during the decision process. This is also directly linked to the consistency metric. To this purpose, in Figure [<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S15.F20" title="Figure 20 ‣ 15 Nearest Prototypes to Image Patches ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">20</span></a> - <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S15.F25" title="Figure 25 ‣ 15 Nearest Prototypes to Image Patches ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">25</span></a>] we visualize the three closest prototypes for random patches in an image. The visualizations again showcase good semantic matches for our proposed method.</p>
</div>
<figure class="ltx_figure" id="S15.F20">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F20.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F20.9.1.1">
<td class="ltx_td ltx_align_center" id="S15.F20.9.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F20.9.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F20.9.1.1.1.1.1" style="width:113.8pt;">Image Patches</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F20.9.1.1.2"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F20.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F20.1.g1" src="extracted/5854717/images/93/sample-93-arrow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S15.F20.10"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F20.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F20.11.1.1">
<td class="ltx_td ltx_align_center" id="S15.F20.11.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F20.11.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F20.11.1.1.1.1.1" style="width:113.8pt;">Top 1 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F20.11.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F20.11.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F20.11.2.2">
<td class="ltx_td ltx_align_center" id="S15.F20.11.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F20.11.2.2.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F20.11.2.2.1.1.1" style="width:113.8pt;">Top 2 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F20.11.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F20.11.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F20.11.3.3">
<td class="ltx_td ltx_align_center" id="S15.F20.11.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F20.11.3.3.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F20.11.3.3.1.1.1" style="width:113.8pt;">Top 3 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F20.11.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F20.11.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F20.2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S15.F20.2.g1" src="extracted/5854717/images/93/person_loc_0/prototype-img_scale_1_91-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F20.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F20.3.g1" src="extracted/5854717/images/93/person_loc_0/sample_93_loc_0_closest_0_scale_1_91-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F20.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F20.4.g1" src="extracted/5854717/images/93/person_loc_0/prototype-img_scale_0_35-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F20.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F20.5.g1" src="extracted/5854717/images/93/person_loc_0/sample_93_loc_0_closest_1_scale_0_35-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F20.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F20.6.g1" src="extracted/5854717/images/93/person_loc_0/prototype-img_scale_3_204-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F20.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F20.7.g1" src="extracted/5854717/images/93/person_loc_0/sample_93_loc_0_closest_2_scale_3_204-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S15.F20.17.1.1" style="font-size:90%;">Figure 20</span>: </span><span class="ltx_text" id="S15.F20.18.2" style="font-size:90%;">The first row represents a validation image from Cityscapes with three randomly selected patches <span class="ltx_text" id="S15.F20.18.2.1" style="color:#FF0000;">red</span>, <span class="ltx_text" id="S15.F20.18.2.2" style="color:#00FF00;">green</span>, <span class="ltx_text" id="S15.F20.18.2.3" style="color:#0000FF;">blue</span>. The second to fourth rows show the closest prototypes to the <span class="ltx_text" id="S15.F20.18.2.4" style="color:#FF0000;">red patch</span> via its activation on itself and on the image containing the <span class="ltx_text" id="S15.F20.18.2.5" style="color:#FF0000;">red patch</span>. In the second column, the bounding boxes correspond to the similarly activated area centered around the random patch.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S15.F21">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F21.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F21.9.1.1">
<td class="ltx_td ltx_align_center" id="S15.F21.9.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F21.9.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F21.9.1.1.1.1.1" style="width:113.8pt;">Image Patches</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F21.9.1.1.2"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F21.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F21.1.g1" src="extracted/5854717/images/472/sample-472-arrow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S15.F21.10"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F21.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F21.11.1.1">
<td class="ltx_td ltx_align_center" id="S15.F21.11.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F21.11.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F21.11.1.1.1.1.1" style="width:113.8pt;">Top 1 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F21.11.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F21.11.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F21.11.2.2">
<td class="ltx_td ltx_align_center" id="S15.F21.11.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F21.11.2.2.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F21.11.2.2.1.1.1" style="width:113.8pt;">Top 2 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F21.11.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F21.11.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F21.11.3.3">
<td class="ltx_td ltx_align_center" id="S15.F21.11.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F21.11.3.3.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F21.11.3.3.1.1.1" style="width:113.8pt;">Top 3 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F21.11.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F21.11.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F21.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F21.2.g1" src="extracted/5854717/images/472/car_loc_1/prototype-img_scale_3_211-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F21.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F21.3.g1" src="extracted/5854717/images/472/car_loc_1/sample_472_loc_1_closest_0_scale_3_211-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F21.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F21.4.g1" src="extracted/5854717/images/472/car_loc_1/prototype-img_scale_2_154-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F21.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F21.5.g1" src="extracted/5854717/images/472/car_loc_1/sample_472_loc_1_closest_1_scale_2_154-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F21.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F21.6.g1" src="extracted/5854717/images/472/car_loc_1/prototype-img_scale_1_96-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F21.7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S15.F21.7.g1" src="extracted/5854717/images/472/car_loc_1/sample_472_loc_1_closest_2_scale_1_96-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S15.F21.17.1.1" style="font-size:90%;">Figure 21</span>: </span><span class="ltx_text" id="S15.F21.18.2" style="font-size:90%;">The first row represents a validation image from Cityscapes with three randomly selected patches <span class="ltx_text" id="S15.F21.18.2.1" style="color:#FF0000;">red</span>, <span class="ltx_text" id="S15.F21.18.2.2" style="color:#00FF00;">green</span>, <span class="ltx_text" id="S15.F21.18.2.3" style="color:#0000FF;">blue</span>. The second to fourth rows show the closest prototypes to the <span class="ltx_text" id="S15.F21.18.2.4" style="color:#00FF00;">green patch</span> via its activation on itself and on the image containing the <span class="ltx_text" id="S15.F21.18.2.5" style="color:#00FF00;">green patch</span>. In the second column, the bounding boxes correspond to the similarly activated area centered around the random patch.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S15.F22">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F22.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F22.9.1.1">
<td class="ltx_td ltx_align_center" id="S15.F22.9.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F22.9.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F22.9.1.1.1.1.1" style="width:113.8pt;">Image Patches</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F22.9.1.1.2"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F22.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F22.1.g1" src="extracted/5854717/images/334/sample-334-arrow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S15.F22.10"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F22.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F22.11.1.1">
<td class="ltx_td ltx_align_center" id="S15.F22.11.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F22.11.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F22.11.1.1.1.1.1" style="width:113.8pt;">Top 1 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F22.11.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F22.11.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F22.11.2.2">
<td class="ltx_td ltx_align_center" id="S15.F22.11.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F22.11.2.2.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F22.11.2.2.1.1.1" style="width:113.8pt;">Top 2 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F22.11.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F22.11.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F22.11.3.3">
<td class="ltx_td ltx_align_center" id="S15.F22.11.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F22.11.3.3.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F22.11.3.3.1.1.1" style="width:113.8pt;">Top 3 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F22.11.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F22.11.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F22.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F22.2.g1" src="extracted/5854717/images/334/pole_loc_1/prototype-img_scale_1_73-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F22.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F22.3.g1" src="extracted/5854717/images/334/pole_loc_1/sample_334_loc_1_closest_0_scale_1_73-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F22.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F22.4.g1" src="extracted/5854717/images/334/pole_loc_1/prototype-img_scale_3_188-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F22.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F22.5.g1" src="extracted/5854717/images/334/pole_loc_1/sample_334_loc_1_closest_1_scale_3_188-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F22.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F22.6.g1" src="extracted/5854717/images/334/pole_loc_1/prototype-img_scale_2_129-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F22.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F22.7.g1" src="extracted/5854717/images/334/pole_loc_1/sample_334_loc_1_closest_2_scale_2_129-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S15.F22.17.1.1" style="font-size:90%;">Figure 22</span>: </span><span class="ltx_text" id="S15.F22.18.2" style="font-size:90%;">The first row represents a validation image from Cityscapes with three randomly selected patches <span class="ltx_text" id="S15.F22.18.2.1" style="color:#FF0000;">red</span>, <span class="ltx_text" id="S15.F22.18.2.2" style="color:#00FF00;">green</span>, <span class="ltx_text" id="S15.F22.18.2.3" style="color:#0000FF;">blue</span>. The second to fourth rows show the closest prototypes to the <span class="ltx_text" id="S15.F22.18.2.4" style="color:#00FF00;">green patch</span> via its activation on itself and on the image containing the <span class="ltx_text" id="S15.F22.18.2.5" style="color:#00FF00;">green patch</span>. In the second column, the bounding boxes correspond to the similarly activated area centered around the random patch.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S15.F23">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F23.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F23.9.1.1">
<td class="ltx_td ltx_align_center" id="S15.F23.9.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F23.9.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F23.9.1.1.1.1.1" style="width:113.8pt;">Image Patches</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F23.9.1.1.2"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F23.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F23.1.g1" src="extracted/5854717/images/594/sample_594_scale_1_85-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S15.F23.10"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F23.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F23.11.1.1">
<td class="ltx_td ltx_align_center" id="S15.F23.11.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F23.11.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F23.11.1.1.1.1.1" style="width:113.8pt;">Top 1 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F23.11.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F23.11.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F23.11.2.2">
<td class="ltx_td ltx_align_center" id="S15.F23.11.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F23.11.2.2.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F23.11.2.2.1.1.1" style="width:113.8pt;">Top 2 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F23.11.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F23.11.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F23.11.3.3">
<td class="ltx_td ltx_align_center" id="S15.F23.11.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F23.11.3.3.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F23.11.3.3.1.1.1" style="width:113.8pt;">Top 3 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F23.11.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F23.11.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F23.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F23.2.g1" src="extracted/5854717/images/594/car_loc_2/prototype-img_scale_2_147-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F23.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F23.3.g1" src="extracted/5854717/images/594/car_loc_2/sample_594_loc_2_closest_0_scale_2_147-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F23.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F23.4.g1" src="extracted/5854717/images/594/car_loc_2/prototype-img_scale_0_23-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F23.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F23.5.g1" src="extracted/5854717/images/594/car_loc_2/sample_594_loc_2_closest_1_scale_0_23-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F23.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F23.6.g1" src="extracted/5854717/images/594/car_loc_2/prototype-img_scale_1_85-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F23.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F23.7.g1" src="extracted/5854717/images/594/car_loc_2/sample_594_loc_2_closest_2_scale_1_85-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S15.F23.17.1.1" style="font-size:90%;">Figure 23</span>: </span><span class="ltx_text" id="S15.F23.18.2" style="font-size:90%;">The first row represents a validation image from PASCAL VOC with three randomly selected patches <span class="ltx_text" id="S15.F23.18.2.1" style="color:#FF0000;">red</span>, <span class="ltx_text" id="S15.F23.18.2.2" style="color:#00FF00;">green</span>, <span class="ltx_text" id="S15.F23.18.2.3" style="color:#0000FF;">blue</span>. The second to fourth rows show the closest prototypes to the <span class="ltx_text" id="S15.F23.18.2.4" style="color:#0000FF;">blue patch</span> via its activation on itself and on the image containing the <span class="ltx_text" id="S15.F23.18.2.5" style="color:#0000FF;">blue patch</span>. In the second column, the bounding boxes correspond to the similarly activated area centered around the random patch.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S15.F24">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F24.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F24.9.1.1">
<td class="ltx_td ltx_align_center" id="S15.F24.9.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F24.9.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F24.9.1.1.1.1.1" style="width:113.8pt;">Image Patches</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F24.9.1.1.2"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F24.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F24.1.g1" src="extracted/5854717/images/247/sample_247_scale_1_104-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S15.F24.10"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F24.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F24.11.1.1">
<td class="ltx_td ltx_align_center" id="S15.F24.11.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F24.11.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F24.11.1.1.1.1.1" style="width:113.8pt;">Top 1 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F24.11.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F24.11.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F24.11.2.2">
<td class="ltx_td ltx_align_center" id="S15.F24.11.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F24.11.2.2.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F24.11.2.2.1.1.1" style="width:113.8pt;">Top 2 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F24.11.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F24.11.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F24.11.3.3">
<td class="ltx_td ltx_align_center" id="S15.F24.11.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F24.11.3.3.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F24.11.3.3.1.1.1" style="width:113.8pt;">Top 3 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F24.11.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F24.11.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F24.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F24.2.g1" src="extracted/5854717/images/247/person_loc_1/prototype-img_scale_2_172-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F24.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F24.3.g1" src="extracted/5854717/images/247/person_loc_1/sample_247_loc_1_closest_0_scale_2_172-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F24.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F24.4.g1" src="extracted/5854717/images/247/person_loc_1/prototype-img_scale_1_109-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F24.5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S15.F24.5.g1" src="extracted/5854717/images/247/person_loc_1/sample_247_loc_1_closest_1_scale_1_109-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F24.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F24.6.g1" src="extracted/5854717/images/247/person_loc_1/prototype-img_scale_0_47-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F24.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F24.7.g1" src="extracted/5854717/images/247/person_loc_1/sample_247_loc_1_closest_0_scale_2_172-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S15.F24.17.1.1" style="font-size:90%;">Figure 24</span>: </span><span class="ltx_text" id="S15.F24.18.2" style="font-size:90%;">The first row represents a validation image from PASCAL VOC with three randomly selected patches <span class="ltx_text" id="S15.F24.18.2.1" style="color:#FF0000;">red</span>, <span class="ltx_text" id="S15.F24.18.2.2" style="color:#00FF00;">green</span>, <span class="ltx_text" id="S15.F24.18.2.3" style="color:#0000FF;">blue</span>. The second to fourth rows show the closest prototypes to the <span class="ltx_text" id="S15.F24.18.2.4" style="color:#00FF00;">green patch</span> via its activation on itself and on the image containing the <span class="ltx_text" id="S15.F24.18.2.5" style="color:#00FF00;">green patch</span>. In the second column, the bounding boxes correspond to the similarly activated area centered around the random patch.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S15.F25">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F25.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F25.9.1.1">
<td class="ltx_td ltx_align_center" id="S15.F25.9.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F25.9.1.1.1.1" style="width:8.9pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.46pt,-51.99pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F25.9.1.1.1.1.1" style="width:113.8pt;">Image Patches</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F25.9.1.1.2"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F25.1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S15.F25.1.g1" src="extracted/5854717/images/858/sample_858_scale_0_37-original_with_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S15.F25.10"><span class="ltx_rule" style="width:433.6pt;height:0.5pt;background:black;display:inline-block;"> </span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S15.F25.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S15.F25.11.1.1">
<td class="ltx_td ltx_align_center" id="S15.F25.11.1.1.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F25.11.1.1.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F25.11.1.1.1.1.1" style="width:113.8pt;">Top 1 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F25.11.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F25.11.1.1.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F25.11.2.2">
<td class="ltx_td ltx_align_center" id="S15.F25.11.2.2.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F25.11.2.2.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F25.11.2.2.1.1.1" style="width:113.8pt;">Top 2 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F25.11.2.2.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F25.11.2.2.3"></td>
</tr>
<tr class="ltx_tr" id="S15.F25.11.3.3">
<td class="ltx_td ltx_align_center" id="S15.F25.11.3.3.1">
<div class="ltx_inline-block ltx_transformed_outer" id="S15.F25.11.3.3.1.1" style="width:8.8pt;height:113.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:113.8pt;transform:translate(-52.52pt,-52.07pt) rotate(-90deg) ;">
<p class="ltx_p ltx_parbox ltx_align_middle" id="S15.F25.11.3.3.1.1.1" style="width:113.8pt;">Top 3 Prototype</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center" id="S15.F25.11.3.3.2"></td>
<td class="ltx_td ltx_align_center" id="S15.F25.11.3.3.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F25.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F25.2.g1" src="extracted/5854717/images/858/dog_loc_2/prototype-img_scale_1_101-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F25.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F25.3.g1" src="extracted/5854717/images/858/dog_loc_2/sample_858_loc_2_closest_0_scale_1_101-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F25.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F25.4.g1" src="extracted/5854717/images/858/dog_loc_2/prototype-img_scale_3_227-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F25.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F25.5.g1" src="extracted/5854717/images/858/dog_loc_2/sample_858_loc_2_closest_1_scale_3_227-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F25.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F25.6.g1" src="extracted/5854717/images/858/dog_loc_2/prototype-img_scale_0_37-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S15.F25.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="157" id="S15.F25.7.g1" src="extracted/5854717/images/858/dog_loc_2/sample_858_loc_2_closest_2_scale_0_37-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S15.F25.17.1.1" style="font-size:90%;">Figure 25</span>: </span><span class="ltx_text" id="S15.F25.18.2" style="font-size:90%;">The first row represents a validation image from PASCAL VOC with three randomly selected patches <span class="ltx_text" id="S15.F25.18.2.1" style="color:#FF0000;">red</span>, <span class="ltx_text" id="S15.F25.18.2.2" style="color:#00FF00;">green</span>, <span class="ltx_text" id="S15.F25.18.2.3" style="color:#0000FF;">blue</span>. The second to fourth rows show the closest prototypes to the <span class="ltx_text" id="S15.F25.18.2.4" style="color:#0000FF;">blue patch</span> via its activation on itself and on the image containing the <span class="ltx_text" id="S15.F25.18.2.5" style="color:#0000FF;">blue patch</span>. In the second column, the bounding boxes correspond to the similarly activated area centered around the random patch.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S16">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">16 </span>Semantic meaning of groups</h2>
<div class="ltx_para" id="S16.p1">
<p class="ltx_p" id="S16.p1.1">We provide a clearer understanding of the grouping mechanism by showing, in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S16.F26" title="Figure 26 ‣ 16 Semantic meaning of groups ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">26</span></a>, the activations of prototypes assigned to the same group for a given class. It can be observed that prototypes are grouped into semantically meaningful groups.</p>
</div>
<figure class="ltx_figure" id="S16.F26"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="771" id="S16.F26.g1" src="x6.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S16.F26.8.1.1" style="font-size:90%;">Figure 26</span>: </span><span class="ltx_text ltx_font_bold" id="S16.F26.9.2" style="font-size:90%;">Top:<span class="ltx_text ltx_font_medium" id="S16.F26.9.2.1"> for the classes <span class="ltx_text ltx_font_italic" id="S16.F26.9.2.1.1">dog</span> and <span class="ltx_text ltx_font_italic" id="S16.F26.9.2.1.2">sheep</span> on Pascal VOC, prototypes with the highest activation for the considered group represent the head. </span>Bottom<span class="ltx_text ltx_font_medium" id="S16.F26.9.2.2">: for the class <span class="ltx_text ltx_font_italic" id="S16.F26.9.2.2.1">bicycle</span> of Cityscapes, prototypes with the highest activation for the considered group represent the bicycle wheels, while for the class <span class="ltx_text ltx_font_italic" id="S16.F26.9.2.2.2">rider</span> they mainly highlight the person’s upper body.</span></span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S17">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">17 </span>Failure case analysis</h2>
<div class="ltx_para" id="S17.p1">
<p class="ltx_p" id="S17.p1.1">In this section, we analyze an image from PASCAL VOC where the IoU for a given class: cow, falls below a threshold set to <math alttext="\epsilon_{IoU}=0.2" class="ltx_Math" display="inline" id="S17.p1.1.m1.1"><semantics id="S17.p1.1.m1.1a"><mrow id="S17.p1.1.m1.1.1" xref="S17.p1.1.m1.1.1.cmml"><msub id="S17.p1.1.m1.1.1.2" xref="S17.p1.1.m1.1.1.2.cmml"><mi id="S17.p1.1.m1.1.1.2.2" xref="S17.p1.1.m1.1.1.2.2.cmml">ϵ</mi><mrow id="S17.p1.1.m1.1.1.2.3" xref="S17.p1.1.m1.1.1.2.3.cmml"><mi id="S17.p1.1.m1.1.1.2.3.2" xref="S17.p1.1.m1.1.1.2.3.2.cmml">I</mi><mo id="S17.p1.1.m1.1.1.2.3.1" xref="S17.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S17.p1.1.m1.1.1.2.3.3" xref="S17.p1.1.m1.1.1.2.3.3.cmml">o</mi><mo id="S17.p1.1.m1.1.1.2.3.1a" xref="S17.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S17.p1.1.m1.1.1.2.3.4" xref="S17.p1.1.m1.1.1.2.3.4.cmml">U</mi></mrow></msub><mo id="S17.p1.1.m1.1.1.1" xref="S17.p1.1.m1.1.1.1.cmml">=</mo><mn id="S17.p1.1.m1.1.1.3" xref="S17.p1.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S17.p1.1.m1.1b"><apply id="S17.p1.1.m1.1.1.cmml" xref="S17.p1.1.m1.1.1"><eq id="S17.p1.1.m1.1.1.1.cmml" xref="S17.p1.1.m1.1.1.1"></eq><apply id="S17.p1.1.m1.1.1.2.cmml" xref="S17.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S17.p1.1.m1.1.1.2.1.cmml" xref="S17.p1.1.m1.1.1.2">subscript</csymbol><ci id="S17.p1.1.m1.1.1.2.2.cmml" xref="S17.p1.1.m1.1.1.2.2">italic-ϵ</ci><apply id="S17.p1.1.m1.1.1.2.3.cmml" xref="S17.p1.1.m1.1.1.2.3"><times id="S17.p1.1.m1.1.1.2.3.1.cmml" xref="S17.p1.1.m1.1.1.2.3.1"></times><ci id="S17.p1.1.m1.1.1.2.3.2.cmml" xref="S17.p1.1.m1.1.1.2.3.2">𝐼</ci><ci id="S17.p1.1.m1.1.1.2.3.3.cmml" xref="S17.p1.1.m1.1.1.2.3.3">𝑜</ci><ci id="S17.p1.1.m1.1.1.2.3.4.cmml" xref="S17.p1.1.m1.1.1.2.3.4">𝑈</ci></apply></apply><cn id="S17.p1.1.m1.1.1.3.cmml" type="float" xref="S17.p1.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S17.p1.1.m1.1c">\epsilon_{IoU}=0.2</annotation><annotation encoding="application/x-llamapun" id="S17.p1.1.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_I italic_o italic_U end_POSTSUBSCRIPT = 0.2</annotation></semantics></math>, to describe how our method can be leveraged for interpretability analysis.
For this failure, we observe in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S17.F27" title="Figure 27 ‣ 17 Failure case analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">27</span></a> that the veal in the image is classified as a sheep. Indeed, we observe in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S17.F28" title="Figure 28 ‣ 17 Failure case analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">28</span></a> that for the group activations of the class cow, only the first group is slightly activated essentially on the second cow behind, while the 3 sheep groups activate both the top and bottom of the animal. We observe that all the main prototypes for the cow groups in Figure [ <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S17.F30" title="Figure 30 ‣ 17 Failure case analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">30</span></a> -  <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S17.F32" title="Figure 32 ‣ 17 Failure case analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">32</span></a>] either activate a part not visible on the veal or seem to rather focus on the ”texture” of the animal which can be misleading in this case. For the class sheep, we observed in Figure [ <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S17.F33" title="Figure 33 ‣ 17 Failure case analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">33</span></a> -  <a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#S17.F35" title="Figure 35 ‣ 17 Failure case analysis ‣ Multi-Scale Grouped Prototypes for Interpretable Semantic Segmentation"><span class="ltx_text ltx_ref_tag">35</span></a>] that the two most activated groups: 1 and 3, are driven by the same prototype which is a Scale 1 prototype focusing on texture. This seems reasonable knowing that the wool is a characteristic specific to this class and that a similar aspect can be seen for the veal.
To avoid learning misleading ”texture” prototypes such as the one mentioned previously, the method presented in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.09497v1#bib.bib6" title="">6</a>]</cite> can be leveraged to enforce forgetting such prototypes via human expert feedback.</p>
</div>
<figure class="ltx_figure" id="S17.F27">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F27.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F27.5.1.1">
<td class="ltx_td ltx_align_center" id="S17.F27.5.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F27.5.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F27.5.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F27.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F27.1.g1" src="extracted/5854717/images/failure_1/plot_img_1181_original.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F27.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F27.2.g1" src="extracted/5854717/images/failure_1/plot_img_1181_segmentation.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F27.3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="456" id="S17.F27.3.g1" src="extracted/5854717/images/failure_1/plot_img_1181_segmentation_misprediction_sheep.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F27.8.1.1" style="font-size:90%;">Figure 27</span>: </span><span class="ltx_text" id="S17.F27.9.2" style="font-size:90%;">PASCAL VOC image with its predictions for the class <span class="ltx_text ltx_font_italic" id="S17.F27.9.2.1">cow</span> and in particular the most common error for this class is with the class <span class="ltx_text ltx_font_italic" id="S17.F27.9.2.2">sheep</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F28">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F28.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F28.5.1.1">
<td class="ltx_td ltx_align_center" id="S17.F28.5.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F28.5.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F28.5.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F28.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F28.1.g1" src="extracted/5854717/images/failure_1/plot_img_1181_group_0_class_cow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F28.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F28.2.g1" src="extracted/5854717/images/failure_1/plot_img_1181_group_1_class_cow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F28.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F28.3.g1" src="extracted/5854717/images/failure_1/plot_img_1181_group_2_class_cow.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F28.7.1.1" style="font-size:90%;">Figure 28</span>: </span><span class="ltx_text" id="S17.F28.8.2" style="font-size:90%;">Group activations of the class <span class="ltx_text ltx_font_italic" id="S17.F28.8.2.1">cow</span> for the image.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F29">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F29.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F29.5.1.1">
<td class="ltx_td ltx_align_center" id="S17.F29.5.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F29.5.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F29.5.1.1.3"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F29.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F29.1.g1" src="extracted/5854717/images/failure_1/plot_img_1181_group_0_class_sheep.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F29.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F29.2.g1" src="extracted/5854717/images/failure_1/plot_img_1181_group_1_class_sheep.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F29.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="456" id="S17.F29.3.g1" src="extracted/5854717/images/failure_1/plot_img_1181_group_2_class_sheep.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F29.7.1.1" style="font-size:90%;">Figure 29</span>: </span><span class="ltx_text" id="S17.F29.8.2" style="font-size:90%;">Group activations of the class <span class="ltx_text ltx_font_italic" id="S17.F29.8.2.1">sheep</span> for the image.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F30">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F30.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F30.6.1.1">
<td class="ltx_td ltx_align_center" id="S17.F30.6.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F30.6.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F30.6.1.1.3"></td>
<td class="ltx_td ltx_align_center" id="S17.F30.6.1.1.4"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F30.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F30.1.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_1_95-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F30.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F30.2.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_95_class_cow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F30.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F30.3.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_1_94-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F30.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F30.4.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_94_class_cow.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F30.8.1.1" style="font-size:90%;">Figure 30</span>: </span><span class="ltx_text" id="S17.F30.9.2" style="font-size:90%;">Most activated prototypes represented by their training sample and their activation on the input image for Group 1 of class <span class="ltx_text ltx_font_italic" id="S17.F30.9.2.1">cow</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F31">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F31.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F31.6.1.1">
<td class="ltx_td ltx_align_center" id="S17.F31.6.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F31.6.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F31.6.1.1.3"></td>
<td class="ltx_td ltx_align_center" id="S17.F31.6.1.1.4"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F31.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F31.1.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_0_31-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F31.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F31.2.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_31_class_cow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F31.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F31.3.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_2_158-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F31.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F31.4.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_158_class_cow.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F31.8.1.1" style="font-size:90%;">Figure 31</span>: </span><span class="ltx_text" id="S17.F31.9.2" style="font-size:90%;">Most activated prototypes represented by their training sample and their activation on the input image for Group 2 of class <span class="ltx_text ltx_font_italic" id="S17.F31.9.2.1">cow</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F32">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F32.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F32.6.1.1">
<td class="ltx_td ltx_align_center" id="S17.F32.6.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F32.6.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F32.6.1.1.3"></td>
<td class="ltx_td ltx_align_center" id="S17.F32.6.1.1.4"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F32.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F32.1.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_0_32-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F32.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F32.2.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_32_class_cow.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F32.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F32.3.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_2_158-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F32.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F32.4.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_158_class_cow.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F32.8.1.1" style="font-size:90%;">Figure 32</span>: </span><span class="ltx_text" id="S17.F32.9.2" style="font-size:90%;">Most activated prototypes represented by their training sample and their activation on the input image for Group 3 of class <span class="ltx_text ltx_font_italic" id="S17.F32.9.2.1">cow</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F33">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F33.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F33.6.1.1">
<td class="ltx_td ltx_align_center" id="S17.F33.6.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F33.6.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F33.6.1.1.3"></td>
<td class="ltx_td ltx_align_center" id="S17.F33.6.1.1.4"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F33.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F33.1.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_0_52-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F33.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F33.2.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_52_class_sheep.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F33.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F33.3.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_1_115-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F33.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F33.4.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_115_class_sheep.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F33.8.1.1" style="font-size:90%;">Figure 33</span>: </span><span class="ltx_text" id="S17.F33.9.2" style="font-size:90%;">Most activated prototypes represented by their training sample and their activation on the input image for Group 1 of class <span class="ltx_text ltx_font_italic" id="S17.F33.9.2.1">sheep</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F34">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F34.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F34.6.1.1">
<td class="ltx_td ltx_align_center" id="S17.F34.6.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F34.6.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F34.6.1.1.3"></td>
<td class="ltx_td ltx_align_center" id="S17.F34.6.1.1.4"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F34.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F34.1.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_1_114-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F34.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F34.2.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_114_class_sheep.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F34.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F34.3.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_2_177-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F34.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F34.4.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_177_class_sheep.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F34.8.1.1" style="font-size:90%;">Figure 34</span>: </span><span class="ltx_text" id="S17.F34.9.2" style="font-size:90%;">Most activated prototypes represented by their training sample and their activation on the input image for Group 2 of class <span class="ltx_text ltx_font_italic" id="S17.F34.9.2.1">sheep</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S17.F35">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S17.F35.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S17.F35.6.1.1">
<td class="ltx_td ltx_align_center" id="S17.F35.6.1.1.1"></td>
<td class="ltx_td ltx_align_center" id="S17.F35.6.1.1.2"></td>
<td class="ltx_td ltx_align_center" id="S17.F35.6.1.1.3"></td>
<td class="ltx_td ltx_align_center" id="S17.F35.6.1.1.4"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F35.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F35.1.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_0_52-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F35.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F35.2.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_52_class_sheep.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F35.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F35.3.g1" src="extracted/5854717/images/failure_1/Failure_1/prototype-img_scale_1_114-original_with_self_act_and_box.jpg" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S17.F35.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="118" id="S17.F35.4.g1" src="extracted/5854717/images/failure_1/Failure_1/plot_img_1181_proto_114_class_sheep.jpg" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S17.F35.8.1.1" style="font-size:90%;">Figure 35</span>: </span><span class="ltx_text" id="S17.F35.9.2" style="font-size:90%;">Most activated prototypes represented by their training sample and their activation on the input image for Group 3 of class <span class="ltx_text ltx_font_italic" id="S17.F35.9.2.1">sheep</span>.</span></figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Sep 14 17:46:27 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
