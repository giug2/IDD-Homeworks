<article class="ltx_document ltx_authors_1line">
 <div class="ltx_para" id="p1">
  <span class="ltx_ERROR undefined" id="p1.1">
   \reportnumber
  </span>
  <span class="ltx_ERROR undefined" id="p1.2">
   \correspondingauthor
  </span>
  <p class="ltx_p" id="p1.3">
   Marwa Abdulhai (
   <a class="ltx_ref ltx_href" href="mailto:marwa_abdulhai@berkeley.edu" title="">
    marwa_abdulhai@berkeley.edu
   </a>
   )
  </p>
 </div>
 <h1 class="ltx_title ltx_title_document">
  LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Marwa Abdulhai
    <sup class="ltx_sup" id="id1.1.id1">
     1
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Isadora White
    <sup class="ltx_sup" id="id2.1.id1">
     1
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Charlie Snell
    <sup class="ltx_sup" id="id3.1.id1">
     1
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Charles Sun
    <sup class="ltx_sup" id="id4.1.id1">
     1
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Joey Hong
    <sup class="ltx_sup" id="id5.1.id1">
     1
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Yuexiang Zhai
    <sup class="ltx_sup" id="id6.1.id1">
     1
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    <br class="ltx_break"/>
    Kelvin Xu
    <sup class="ltx_sup" id="id7.1.id1">
     2
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    and
Sergey Levine
    <sup class="ltx_sup" id="id8.1.id1">
     1
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
    </span>
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id9.id1">
   Large language models (LLMs) provide excellent text-generation capabilities, but standard prompting and generation methods generally do not lead to intentional or goal-directed agents and might necessitate considerable prompt tuning. This becomes particularly apparent in multi-turn conversations: even the best current LLMs rarely ask clarifying questions, engage in explicit information gathering, or take actions now that lead to better decisions after multiple turns. Reinforcement learning has the potential to leverage the powerful modeling capabilities of LLMs, as well as their internal representation of textual interactions, to create capable goal-directed language agents. This can enable intentional and temporally extended interactions, such as with humans, through coordinated persuasion and carefully crafted questions, or in goal-directed play through text games to bring about desired final outcomes. However, enabling this requires the community to develop stable and reliable reinforcement learning algorithms that can effectively train LLMs. Developing such algorithms requires tasks that can gauge progress on algorithm design, provide accessible and reproducible evaluations for multi-turn interactions, and cover a range of task properties and challenges in improving reinforcement learning algorithms. Our paper introduces the
   <span class="ltx_ERROR undefined" id="id9.id1.1">
    \bmname
   </span>
   benchmark for evaluating multi-turn RL for LLMs, together with an open-source research framework containing a basic toolkit for getting started on multi-turn RL with offline value-based and policy-based RL methods. Our benchmark consists of
   <span class="ltx_ERROR undefined" id="id9.id1.2">
    \numtasks
   </span>
   different language tasks, which require multiple rounds of language interaction and cover a range of tasks in open-ended dialogue and text games.
  </p>
 </div>
 <section class="ltx_section" id="S1" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <figure class="ltx_figure ltx_align_floatright" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="403" id="S1.F1.g1" src="/html/2311.18232/assets/figures/llm_rl_dialogs.png" width="598"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">
      Figure 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S1.F1.4.2" style="font-size:90%;">
     Overview of
     <span class="ltx_ERROR undefined" id="S1.F1.4.2.1">
      \bmname
     </span>
     : We show sample trajectories from two tasks in our benchmark. In the Guess My City task, the agent learns to ask questions to guess the city the oracle is from while in the Maze task, the agent learns to make the correct moves based on cues from the oracle.
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Large language models (LLMs) have demonstrated remarkable abilities when naturally conversing with humans
    <cite class="ltx_cite ltx_citemacro_citep">
     [OpenAI,
     <a class="ltx_ref" href="#bib.bib40" title="">
      2023
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib39" title="">
      2022
     </a>
     , Touvron et al.,
     <a class="ltx_ref" href="#bib.bib65" title="">
      2023
     </a>
     , Google,
     <a class="ltx_ref" href="#bib.bib18" title="">
      2023
     </a>
     ]
    </cite>
    , answering questions and responding to requests
    <cite class="ltx_cite ltx_citemacro_citep">
     [Shuster et al.,
     <a class="ltx_ref" href="#bib.bib54" title="">
      2022b
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib53" title="">
      a
     </a>
     , Qin et al.,
     <a class="ltx_ref" href="#bib.bib46" title="">
      2023
     </a>
     ]
    </cite>
    , and even performing coding tasks
    <cite class="ltx_cite ltx_citemacro_citep">
     [Chen et al.,
     <a class="ltx_ref" href="#bib.bib10" title="">
      2021
     </a>
     , Wang et al.,
     <a class="ltx_ref" href="#bib.bib71" title="">
      2023
     </a>
     ]
    </cite>
    .
Much of these capabilities are enabled by learning to emulate humans from large datasets of text from the web
    <cite class="ltx_cite ltx_citemacro_citep">
     [Völske et al.,
     <a class="ltx_ref" href="#bib.bib67" title="">
      2017
     </a>
     , Shuster et al.,
     <a class="ltx_ref" href="#bib.bib53" title="">
      2022a
     </a>
     , Yao et al.,
     <a class="ltx_ref" href="#bib.bib77" title="">
      2023
     </a>
     ]
    </cite>
    , learning from examples “in context”
    <cite class="ltx_cite ltx_citemacro_citep">
     [Brown et al.,
     <a class="ltx_ref" href="#bib.bib6" title="">
      2020
     </a>
     ]
    </cite>
    , as well as other sources of supervision such as instruction datasets
    <cite class="ltx_cite ltx_citemacro_citep">
     [Mishra et al.,
     <a class="ltx_ref" href="#bib.bib35" title="">
      2022
     </a>
     , Wei et al.,
     <a class="ltx_ref" href="#bib.bib72" title="">
      2022
     </a>
     , Wang et al.,
     <a class="ltx_ref" href="#bib.bib70" title="">
      2022b
     </a>
     ]
    </cite>
    and preference fine-tuning with RLHF
    <cite class="ltx_cite ltx_citemacro_citep">
     [Ziegler et al.,
     <a class="ltx_ref" href="#bib.bib78" title="">
      2020
     </a>
     , Ouyang et al.,
     <a class="ltx_ref" href="#bib.bib41" title="">
      2022
     </a>
     ]
    </cite>
    . However, directly applying LLMs in settings that require planning or multi-turn interactions reveals certain difficulties. LLMs are not explicitly goal-directed, as they are not optimized to directly solve particular tasks, but rather to produce text that resembles the distribution of human-provided examples or accords with human preferences
    <cite class="ltx_cite ltx_citemacro_citep">
     [Ziegler et al.,
     <a class="ltx_ref" href="#bib.bib78" title="">
      2020
     </a>
     , Stiennon et al.,
     <a class="ltx_ref" href="#bib.bib59" title="">
      2020
     </a>
     , Wu et al.,
     <a class="ltx_ref" href="#bib.bib74" title="">
      2021
     </a>
     , Bai et al.,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2022a
     </a>
     ]
    </cite>
    . This can become particularly apparent in temporally extended tasks, such as multi-turn dialogue
    <cite class="ltx_cite ltx_citemacro_citep">
     [Irvine et al.,
     <a class="ltx_ref" href="#bib.bib25" title="">
      2023
     </a>
     , † et al.(2022)(FAIR)†, Bakhtin, Brown, Dinan, Farina, Flaherty, Fried, Goff, Gray, Hu, Jacob, Komeili, Konath, Kwon, Lerer, Lewis, Miller, Mitts, Renduchintala, Roller, Rowe, Shi, Spisak, Wei, Wu, Zhang, and Zijlstra,
     <a class="ltx_ref" href="#bib.bib15" title="">
      FAIR
     </a>
     ]
    </cite>
    , complex tool use
    <cite class="ltx_cite ltx_citemacro_citep">
     [Wang et al.,
     <a class="ltx_ref" href="#bib.bib69" title="">
      2022a
     </a>
     ]
    </cite>
    , multi-step games
    <cite class="ltx_cite ltx_citemacro_citep">
     [Hendrycks et al.,
     <a class="ltx_ref" href="#bib.bib24" title="">
      2021b
     </a>
     ]
    </cite>
    , as well as other interactive applications. In principle, LLMs should contain the knowledge necessary to succeed in such settings: if the multi-turn interactions center around problem domains that are well represented in the model’s training data (such as dialogue), well-trained LLMs should already serve as powerful predictive models in such settings. However, leveraging this predictive knowledge to derive effective actions and strategies requires not just emulating humans, but also planning and optimization.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Multi-turn reinforcement learning (RL)
    <cite class="ltx_cite ltx_citemacro_citep">
     [Sutton and Barto,
     <a class="ltx_ref" href="#bib.bib61" title="">
      2018
     </a>
     ]
    </cite>
    in principle offers a path to enable LLMs to overcome challenges in goal-directed reasoning and planning in interactive, multi-turn settings, including complex dialogue, games, and tool use. We might hypothesize that RL could serve as a powerful tool for LLM training, not just for training models to accord with human preferences, but more generally to accomplish tasks in an intentional and goal-directed manner. Text generation can be viewed as a sequential decision-making process, treating a sequence of tokens as a trajectory. Many tasks, such as successfully answering questions or eliciting a desired reaction from a user, can then be framed as optimizing some reward function over these trajectories. However, despite extensive interest in RL for LLMs in recent years, much (though not all) of the recent research in this area has focused on “single-step” RL problems, where a single response is optimized for some quality metric, typically derived from human preference signals
    <cite class="ltx_cite ltx_citemacro_citep">
     [Stiennon et al.,
     <a class="ltx_ref" href="#bib.bib59" title="">
      2020
     </a>
     , Ziegler et al.,
     <a class="ltx_ref" href="#bib.bib78" title="">
      2020
     </a>
     , Ouyang et al.,
     <a class="ltx_ref" href="#bib.bib41" title="">
      2022
     </a>
     , Bai et al.,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2022a
     </a>
     , Anthropic,
     <a class="ltx_ref" href="#bib.bib1" title="">
      2023
     </a>
     , Ramamurthy et al.,
     <a class="ltx_ref" href="#bib.bib49" title="">
      2023
     </a>
     , Christiano et al.,
     <a class="ltx_ref" href="#bib.bib11" title="">
      2023
     </a>
     , Casper et al.,
     <a class="ltx_ref" href="#bib.bib8" title="">
      2023
     </a>
     ]
    </cite>
    . While some works have sought to apply RL for multi-turn tasks
    <cite class="ltx_cite ltx_citemacro_citep">
     [Singh et al.,
     <a class="ltx_ref" href="#bib.bib55" title="">
      1999
     </a>
     , Li et al.,
     <a class="ltx_ref" href="#bib.bib33" title="">
      2016
     </a>
     , Shah et al.,
     <a class="ltx_ref" href="#bib.bib52" title="">
      2016
     </a>
     , Kwan et al.,
     <a class="ltx_ref" href="#bib.bib31" title="">
      2022
     </a>
     ]
    </cite>
    ,
particularly in the domain of goal-directed dialogue
    <cite class="ltx_cite ltx_citemacro_citep">
     [Lewis et al.,
     <a class="ltx_ref" href="#bib.bib32" title="">
      2017
     </a>
     , Verma et al.,
     <a class="ltx_ref" href="#bib.bib66" title="">
      2022
     </a>
     ]
    </cite>
    , there has been comparatively little research on actually improving the underlying RL algorithms and very little head-to-head comparison on the same set of tasks. This is perhaps unsurprising: it is likely much easier to evaluate improvements to algorithms for single-turn text generation as compared to multi-turn generation since multi-turn dialogue requires an interactive evaluation procedure, where there is no established protocol and the “gold standard” constitutes costly and time-consuming studies with human participants.
    <br class="ltx_break"/>
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    In this work, we aim to address this challenge and make it possible for
    <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">
     RL algorithms researchers
    </em>
    to iterate on developing better RL methods for multi-turn language-based interaction tasks, such as dialogue and games. We posit that benchmarking RL algorithms for LLMs presents a very different set of challenges and merits a different set of solutions compared to other benchmarks in NLP. While most NLP benchmarks are based on standard supervised machine learning paradigms, with a training set and a test set
    <cite class="ltx_cite ltx_citemacro_citep">
     [Marcus et al.,
     <a class="ltx_ref" href="#bib.bib34" title="">
      1993
     </a>
     , Tjong Kim Sang and De Meulder,
     <a class="ltx_ref" href="#bib.bib64" title="">
      2003
     </a>
     , Socher et al.,
     <a class="ltx_ref" href="#bib.bib58" title="">
      2013
     </a>
     , Rajpurkar et al.,
     <a class="ltx_ref" href="#bib.bib48" title="">
      2016
     </a>
     , Wang et al.,
     <a class="ltx_ref" href="#bib.bib68" title="">
      2019
     </a>
     , Williams et al.,
     <a class="ltx_ref" href="#bib.bib73" title="">
      2018
     </a>
     ]
    </cite>
    , RL benchmarks require simulators that the trained agents can interact with to measure their performance. Until recently, constructing high-fidelity simulators for dialogue with humans has been exceptionally difficult. However, the very same LLMs that we advocate to train with RL can offer a solution here, as they can be trained to emulate human-like dialogue and produce both synthetic datasets and synthetic simulated evaluation protocols, where an RL-trained LLM agent “talks” to another LLM provided as part of the benchmark as a “simulator.” While this approach to benchmarking interactive dialogue has significant downsides (e.g., the responses of the benchmark LLM might often deviate drastically from human behavior), we believe that the corresponding upside of enabling accessible benchmarking of multi-turn RL algorithms provides a compelling solution. We emphasize however that our goal is
    <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">
     not
    </em>
    to utilize this approach to benchmark whether LLMs are
    <em class="ltx_emph ltx_font_italic" id="S1.p3.1.3">
     good at talking to humans
    </em>
    , but rather as a way to test RL algorithms with datasets that are sufficiently difficult and complex so as to gauge how effective they might be
    <em class="ltx_emph ltx_font_italic" id="S1.p3.1.4">
     if they were then trained on data from real humans
    </em>
    .
    <br class="ltx_break"/>
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Our proposed benchmark,
    <span class="ltx_ERROR undefined" id="S1.p4.1.1">
     \bmname
    </span>
    , consists of
    <span class="ltx_ERROR undefined" id="S1.p4.1.2">
     \numtasks
    </span>
    tasks that each come with an offline dataset that can be used for offline RL training, and a “simulator” that can be used to evaluate the resulting agents in terms of their performance on multi-turn interactive tasks. This simulator supports both evaluation of agents trained with offline RL, and online training. Three tasks are interactive dialogue tasks designed to simulate real-world interactions with humans requiring information gathering from humans (20 Questions, Guess My City) and negotiation (Car Dealer), while five of these tasks are RL capability tests designed to isolate specific desirable properties of training RL with language. We show sample trajectories for each kind of task in
    <a class="ltx_ref" href="#S1.F1" title="In 1 Introduction ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Figure
     </span>
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    . In addition to presenting the benchmark tasks and the synthetic data generation system, we also provide a research framework that provides a toolkit for researchers and practitioners to get started with multi-turn RL for LLMs. This framework includes implementations of PPO
    <cite class="ltx_cite ltx_citemacro_citep">
     [Schulman et al.,
     <a class="ltx_ref" href="#bib.bib50" title="">
      2017
     </a>
     ]
    </cite>
    , ILQL
    <cite class="ltx_cite ltx_citemacro_citep">
     [Snell et al.,
     <a class="ltx_ref" href="#bib.bib56" title="">
      2022a
     </a>
     ]
    </cite>
    , and several baseline methods, implemented in an extensible way designed for future development of tasks, experimentation, and algorithm design.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S2" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Works
  </h2>
  <section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
   <h5 class="ltx_title ltx_title_paragraph">
    Datasets, benchmarks, and libraries.
   </h5>
   <div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">
     Benchmarks and datasets have been an important factor for driving progress in NLP in domains that include machine translation
     <cite class="ltx_cite ltx_citemacro_citep">
      [Tiedemann,
      <a class="ltx_ref" href="#bib.bib63" title="">
       2012
      </a>
      , Bojar et al.,
      <a class="ltx_ref" href="#bib.bib5" title="">
       2016
      </a>
      ]
     </cite>
     , natural language understanding
     <cite class="ltx_cite ltx_citemacro_citep">
      [Rajpurkar et al.,
      <a class="ltx_ref" href="#bib.bib48" title="">
       2016
      </a>
      , Wang et al.,
      <a class="ltx_ref" href="#bib.bib68" title="">
       2019
      </a>
      , Hendrycks et al.,
      <a class="ltx_ref" href="#bib.bib22" title="">
       2020
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib23" title="">
       2021a
      </a>
      , Ramamurthy et al.,
      <a class="ltx_ref" href="#bib.bib49" title="">
       2023
      </a>
      ]
     </cite>
     , and solving math problems
     <cite class="ltx_cite ltx_citemacro_citep">
      [Cobbe et al.,
      <a class="ltx_ref" href="#bib.bib12" title="">
       2021
      </a>
      ]
     </cite>
     . However, these tasks generally do not involve multi-turn interaction and do not come with rewards, making them hard to adapt to RL research.
For example, the standard for evaluating dialogue agents has been to run a human subjects study, but this is time-consuming and costly. Some works have proposed text games for evaluating language-based agents
     <cite class="ltx_cite ltx_citemacro_citep">
      [Hausknecht et al.,
      <a class="ltx_ref" href="#bib.bib20" title="">
       2019
      </a>
      , Hendrycks et al.,
      <a class="ltx_ref" href="#bib.bib24" title="">
       2021b
      </a>
      , Wang et al.,
      <a class="ltx_ref" href="#bib.bib69" title="">
       2022a
      </a>
      , Yao et al.,
      <a class="ltx_ref" href="#bib.bib77" title="">
       2023
      </a>
      ]
     </cite>
     . Our aim is to cover a variety of problem settings that reflect challenges in open-vocabulary interaction in addition to text games. Motivated by successes in using LLMs to generate synthetic data
     <cite class="ltx_cite ltx_citemacro_citep">
      [Hausknecht et al.,
      <a class="ltx_ref" href="#bib.bib20" title="">
       2019
      </a>
      , Park et al.,
      <a class="ltx_ref" href="#bib.bib43" title="">
       2023
      </a>
      , Bai et al.,
      <a class="ltx_ref" href="#bib.bib3" title="">
       2022b
      </a>
      ]
     </cite>
     , our proposed tasks are based on synthetic data. While such data may differ from natural text, the scope of our benchmark is specific to evaluating RL
     <em class="ltx_emph ltx_font_italic" id="S2.SS0.SSS0.Px1.p1.1.1">
      algorithms
     </em>
     , not the ability to interact with humans.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
   <h5 class="ltx_title ltx_title_paragraph">
    RL for language models.
   </h5>
   <div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
    <p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">
     RL for language models has seen success in aligning LLMs with human preferences (RLHF)
     <cite class="ltx_cite ltx_citemacro_citep">
      [Ziegler et al.,
      <a class="ltx_ref" href="#bib.bib78" title="">
       2020
      </a>
      , Stiennon et al.,
      <a class="ltx_ref" href="#bib.bib59" title="">
       2020
      </a>
      , Bai et al.,
      <a class="ltx_ref" href="#bib.bib2" title="">
       2022a
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib3" title="">
       b
      </a>
      , Ouyang et al.,
      <a class="ltx_ref" href="#bib.bib41" title="">
       2022
      </a>
      , Christiano et al.,
      <a class="ltx_ref" href="#bib.bib11" title="">
       2023
      </a>
      ]
     </cite>
     , optimizing non-differentiable objectives for machine translation
     <cite class="ltx_cite ltx_citemacro_citep">
      [Wu et al.,
      <a class="ltx_ref" href="#bib.bib75" title="">
       2016
      </a>
      , Nguyen et al.,
      <a class="ltx_ref" href="#bib.bib38" title="">
       2017
      </a>
      , Kiegeland and Kreutzer,
      <a class="ltx_ref" href="#bib.bib29" title="">
       2021
      </a>
      ]
     </cite>
     , generation
     <cite class="ltx_cite ltx_citemacro_citep">
      [Tambwekar et al.,
      <a class="ltx_ref" href="#bib.bib62" title="">
       2019
      </a>
      , Pang and He,
      <a class="ltx_ref" href="#bib.bib42" title="">
       2021
      </a>
      , Pyatkin et al.,
      <a class="ltx_ref" href="#bib.bib45" title="">
       2022
      </a>
      ]
     </cite>
     , dialogue
     <cite class="ltx_cite ltx_citemacro_citep">
      [Cuayáhuitl et al.,
      <a class="ltx_ref" href="#bib.bib14" title="">
       2015
      </a>
      , Georgila and Traum,
      <a class="ltx_ref" href="#bib.bib16" title="">
       2011
      </a>
      , Li et al.,
      <a class="ltx_ref" href="#bib.bib33" title="">
       2016
      </a>
      ]
     </cite>
     , question answering
     <cite class="ltx_cite ltx_citemacro_citep">
      [Pyatkin et al.,
      <a class="ltx_ref" href="#bib.bib45" title="">
       2022
      </a>
      ]
     </cite>
     , and summarization
     <cite class="ltx_cite ltx_citemacro_citep">
      [Paulus et al.,
      <a class="ltx_ref" href="#bib.bib44" title="">
       2017
      </a>
      , Böhm et al.,
      <a class="ltx_ref" href="#bib.bib4" title="">
       2019
      </a>
      , Wu and Hu,
      <a class="ltx_ref" href="#bib.bib76" title="">
       2018
      </a>
      ]
     </cite>
     . These include RL methods that learn by directly interacting with the environment (online RL)
     <cite class="ltx_cite ltx_citemacro_citep">
      [Carta et al.,
      <a class="ltx_ref" href="#bib.bib7" title="">
       2023
      </a>
      ]
     </cite>
     and RL methods that only use a static dataset (offline RL)
     <cite class="ltx_cite ltx_citemacro_citep">
      [Jaques et al.,
      <a class="ltx_ref" href="#bib.bib27" title="">
       2020
      </a>
      , Snell et al.,
      <a class="ltx_ref" href="#bib.bib56" title="">
       2022a
      </a>
      , Jang et al.,
      <a class="ltx_ref" href="#bib.bib26" title="">
       2022
      </a>
      , Verma et al.,
      <a class="ltx_ref" href="#bib.bib66" title="">
       2022
      </a>
      , † et al.(2022)(FAIR)†, Bakhtin, Brown, Dinan, Farina, Flaherty, Fried, Goff, Gray, Hu, Jacob, Komeili, Konath, Kwon, Lerer, Lewis, Miller, Mitts, Renduchintala, Roller, Rowe, Shi, Spisak, Wei, Wu, Zhang, and Zijlstra,
      <a class="ltx_ref" href="#bib.bib15" title="">
       FAIR
      </a>
      ]
     </cite>
     . However, many of these works operate in the singe-step bandit setting, and do not consider multi-turn goal-directed tasks. Our benchmark, on the other hand, focuses on tasks involving multiple turns of interaction with clearly defined goal-based reward functions.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
   <h5 class="ltx_title ltx_title_paragraph">
    Capabilities of LLMs.
   </h5>
   <div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
    <p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">
     There has been a surge in the capabilities of LLMs for generation
     <cite class="ltx_cite ltx_citemacro_citep">
      [Ghazvininejad et al.,
      <a class="ltx_ref" href="#bib.bib17" title="">
       2017
      </a>
      , Radford et al.,
      <a class="ltx_ref" href="#bib.bib47" title="">
       2019
      </a>
      ]
     </cite>
     , dialogue
     <cite class="ltx_cite ltx_citemacro_citep">
      [Lewis et al.,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2017
      </a>
      , Jaques et al.,
      <a class="ltx_ref" href="#bib.bib28" title="">
       2017
      </a>
      , Shuster et al.,
      <a class="ltx_ref" href="#bib.bib54" title="">
       2022b
      </a>
      , Snell et al.,
      <a class="ltx_ref" href="#bib.bib57" title="">
       2022b
      </a>
      ]
     </cite>
     , question answering
     <cite class="ltx_cite ltx_citemacro_citep">
      [Pyatkin et al.,
      <a class="ltx_ref" href="#bib.bib45" title="">
       2022
      </a>
      ]
     </cite>
     , summarization
     <cite class="ltx_cite ltx_citemacro_citep">
      [Paulus et al.,
      <a class="ltx_ref" href="#bib.bib44" title="">
       2017
      </a>
      , Böhm et al.,
      <a class="ltx_ref" href="#bib.bib4" title="">
       2019
      </a>
      , Wu and Hu,
      <a class="ltx_ref" href="#bib.bib76" title="">
       2018
      </a>
      ]
     </cite>
     , text-based games
     <cite class="ltx_cite ltx_citemacro_citep">
      [Narasimhan et al.,
      <a class="ltx_ref" href="#bib.bib37" title="">
       2015
      </a>
      , Hausknecht et al.,
      <a class="ltx_ref" href="#bib.bib20" title="">
       2019
      </a>
      ]
     </cite>
     , translation
     <cite class="ltx_cite ltx_citemacro_citep">
      [Gu et al.,
      <a class="ltx_ref" href="#bib.bib19" title="">
       2017
      </a>
      ]
     </cite>
     , and more. However, these are often supervised learning tasks that do not test the LLMs’ abilities to achieve a specific long-term objective. Research on dialogue generation
     <cite class="ltx_cite ltx_citemacro_citep">
      [Jaques et al.,
      <a class="ltx_ref" href="#bib.bib28" title="">
       2017
      </a>
      , He et al.,
      <a class="ltx_ref" href="#bib.bib21" title="">
       2018
      </a>
      , Shuster et al.,
      <a class="ltx_ref" href="#bib.bib54" title="">
       2022b
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib53" title="">
       a
      </a>
      ]
     </cite>
     has often focused on generating feasible-looking agent dialogue without explicit consideration for some multi-turn objective.
Our benchmarks allow for the development of algorithms that enable LLMs to
     <em class="ltx_emph ltx_font_italic" id="S2.SS0.SSS0.Px3.p1.1.1">
      interact
     </em>
     with an environment to achieve long-term objectives, by providing tasks with online simulators and offline datasets.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S3" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Multi-Turn Generation with RL and Language Models
  </h2>
  <div class="ltx_para" id="S3.p1">
   <p class="ltx_p" id="S3.p1.1">
    This section introduces the conceptual foundations of using reinforcement learning for multi-turn generation with language models. We introduce a definition of the Markov Decision Process for language and a framework for the methods we focus on in this paper.
   </p>
  </div>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Definitions
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.2">
     We formalize language generation tasks as a partially observable Markov decision process. We can think of the state as the history of tokens and action as the next token generated by the model. An observation is a single token
     <math alttext="s_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1">
      <semantics id="S3.SS1.p1.1.m1.1a">
       <msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
        <mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">
         s
        </mi>
        <mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b">
        <apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">
          𝑠
         </ci>
         <ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">
        s_{i}
       </annotation>
      </semantics>
     </math>
     in the history. The probability of generating the next token given the previous observation token
     <math alttext="P(s_{i+1}|s_{i})" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1">
      <semantics id="S3.SS1.p1.2.m2.1a">
       <mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">
        <mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">
         P
        </mi>
        <mo id="S3.SS1.p1.2.m2.1.1.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.2.m2.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml">
         <mo id="S3.SS1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml">
          <msub id="S3.SS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml">
           <mi id="S3.SS1.p1.2.m2.1.1.1.1.1.2.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml">
            s
           </mi>
           <mrow id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml">
            <mi id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.2.cmml">
             i
            </mi>
            <mo id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.1.cmml">
             +
            </mo>
            <mn id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.3.cmml">
             1
            </mn>
           </mrow>
          </msub>
          <mo fence="false" id="S3.SS1.p1.2.m2.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml">
           |
          </mo>
          <msub id="S3.SS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml">
           <mi id="S3.SS1.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.2.cmml">
            s
           </mi>
           <mi id="S3.SS1.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.3.cmml">
            i
           </mi>
          </msub>
         </mrow>
         <mo id="S3.SS1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b">
        <apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">
         <times id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">
         </times>
         <ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">
          𝑃
         </ci>
         <apply id="S3.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">
          <csymbol cd="latexml" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1">
           conditional
          </csymbol>
          <apply id="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2">
           <csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.2">
            𝑠
           </ci>
           <apply id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3">
            <plus id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.1">
            </plus>
            <ci id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.2">
             𝑖
            </ci>
            <cn id="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <apply id="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3">
           <csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3">
            subscript
           </csymbol>
           <ci id="S3.SS1.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.2">
            𝑠
           </ci>
           <ci id="S3.SS1.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.3">
            𝑖
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">
        P(s_{i+1}|s_{i})
       </annotation>
      </semantics>
     </math>
     is non-Markovian. However, a Markovian state can be formed by concatenating all of the previous tokens.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.11">
     A policy
     <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1">
      <semantics id="S3.SS1.p2.1.m1.1a">
       <mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">
        π
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b">
        <ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">
         𝜋
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">
        \pi
       </annotation>
      </semantics>
     </math>
     defines the agent’s behavior by taking in the current state
     <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1">
      <semantics id="S3.SS1.p2.2.m2.1a">
       <mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">
        s
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b">
        <ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">
         𝑠
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">
        s
       </annotation>
      </semantics>
     </math>
     given by
     <math alttext="[s_{0},\dots,s_{i}]" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.3">
      <semantics id="S3.SS1.p2.3.m3.3a">
       <mrow id="S3.SS1.p2.3.m3.3.3.2" xref="S3.SS1.p2.3.m3.3.3.3.cmml">
        <mo id="S3.SS1.p2.3.m3.3.3.2.3" stretchy="false" xref="S3.SS1.p2.3.m3.3.3.3.cmml">
         [
        </mo>
        <msub id="S3.SS1.p2.3.m3.2.2.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.cmml">
         <mi id="S3.SS1.p2.3.m3.2.2.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.2.cmml">
          s
         </mi>
         <mn id="S3.SS1.p2.3.m3.2.2.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.3.cmml">
          0
         </mn>
        </msub>
        <mo id="S3.SS1.p2.3.m3.3.3.2.4" xref="S3.SS1.p2.3.m3.3.3.3.cmml">
         ,
        </mo>
        <mi id="S3.SS1.p2.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p2.3.m3.1.1.cmml">
         …
        </mi>
        <mo id="S3.SS1.p2.3.m3.3.3.2.5" xref="S3.SS1.p2.3.m3.3.3.3.cmml">
         ,
        </mo>
        <msub id="S3.SS1.p2.3.m3.3.3.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.cmml">
         <mi id="S3.SS1.p2.3.m3.3.3.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.cmml">
          s
         </mi>
         <mi id="S3.SS1.p2.3.m3.3.3.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS1.p2.3.m3.3.3.2.6" stretchy="false" xref="S3.SS1.p2.3.m3.3.3.3.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.3b">
        <list id="S3.SS1.p2.3.m3.3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2">
         <apply id="S3.SS1.p2.3.m3.2.2.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1">
          <csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.2">
           𝑠
          </ci>
          <cn id="S3.SS1.p2.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.2.2.1.1.3">
           0
          </cn>
         </apply>
         <ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">
          …
         </ci>
         <apply id="S3.SS1.p2.3.m3.3.3.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2">
          <csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2">
           𝑠
          </ci>
          <ci id="S3.SS1.p2.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.3">
           𝑖
          </ci>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.3c">
        [s_{0},\dots,s_{i}]
       </annotation>
      </semantics>
     </math>
     , and outputting a new action token
     <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1">
      <semantics id="S3.SS1.p2.4.m4.1a">
       <mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">
        a
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b">
        <ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">
         𝑎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">
        a
       </annotation>
      </semantics>
     </math>
     given by
     <math alttext="s_{i+1}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1">
      <semantics id="S3.SS1.p2.5.m5.1a">
       <msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">
        <mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">
         s
        </mi>
        <mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">
         <mi id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">
          i
         </mi>
         <mo id="S3.SS1.p2.5.m5.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">
          +
         </mo>
         <mn id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b">
        <apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">
          𝑠
         </ci>
         <apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">
          <plus id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1">
          </plus>
          <ci id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">
           𝑖
          </ci>
          <cn id="S3.SS1.p2.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">
        s_{i+1}
       </annotation>
      </semantics>
     </math>
     . The environment assigns a reward
     <math alttext="r(s,a)" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.2">
      <semantics id="S3.SS1.p2.6.m6.2a">
       <mrow id="S3.SS1.p2.6.m6.2.3" xref="S3.SS1.p2.6.m6.2.3.cmml">
        <mi id="S3.SS1.p2.6.m6.2.3.2" xref="S3.SS1.p2.6.m6.2.3.2.cmml">
         r
        </mi>
        <mo id="S3.SS1.p2.6.m6.2.3.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.6.m6.2.3.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS1.p2.6.m6.2.3.3.2" xref="S3.SS1.p2.6.m6.2.3.3.1.cmml">
         <mo id="S3.SS1.p2.6.m6.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.6.m6.2.3.3.1.cmml">
          (
         </mo>
         <mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">
          s
         </mi>
         <mo id="S3.SS1.p2.6.m6.2.3.3.2.2" xref="S3.SS1.p2.6.m6.2.3.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p2.6.m6.2.2" xref="S3.SS1.p2.6.m6.2.2.cmml">
          a
         </mi>
         <mo id="S3.SS1.p2.6.m6.2.3.3.2.3" stretchy="false" xref="S3.SS1.p2.6.m6.2.3.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.2b">
        <apply id="S3.SS1.p2.6.m6.2.3.cmml" xref="S3.SS1.p2.6.m6.2.3">
         <times id="S3.SS1.p2.6.m6.2.3.1.cmml" xref="S3.SS1.p2.6.m6.2.3.1">
         </times>
         <ci id="S3.SS1.p2.6.m6.2.3.2.cmml" xref="S3.SS1.p2.6.m6.2.3.2">
          𝑟
         </ci>
         <interval closure="open" id="S3.SS1.p2.6.m6.2.3.3.1.cmml" xref="S3.SS1.p2.6.m6.2.3.3.2">
          <ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">
           𝑠
          </ci>
          <ci id="S3.SS1.p2.6.m6.2.2.cmml" xref="S3.SS1.p2.6.m6.2.2">
           𝑎
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.2c">
        r(s,a)
       </annotation>
      </semantics>
     </math>
     based on the entire sequence of tokens so far. The tokens in the state are either generated by the policy
     <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1">
      <semantics id="S3.SS1.p2.7.m7.1a">
       <mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">
        π
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b">
        <ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">
         𝜋
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">
        \pi
       </annotation>
      </semantics>
     </math>
     or the environment. For example, in the Car Dealer task, the policy generates the tokens for the Seller and the environment generates the tokens for the Buyer and the history of their conversation would form the state. A complete sequence of tokens will also be referred to as a trajectory. The goal of RL is to produce a policy
     <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1">
      <semantics id="S3.SS1.p2.8.m8.1a">
       <msup id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">
        <mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">
         π
        </mi>
        <mo id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">
         ∗
        </mo>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b">
        <apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">
          𝜋
         </ci>
         <times id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">
         </times>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">
        \pi^{*}
       </annotation>
      </semantics>
     </math>
     that maximizes the expected discounted sum of rewards over trajectories (
     <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1">
      <semantics id="S3.SS1.p2.9.m9.1a">
       <mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">
        τ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b">
        <ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">
         𝜏
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">
        \tau
       </annotation>
      </semantics>
     </math>
     ) under the policy
     <math alttext="\pi^{*}=\arg\max_{\pi}\mathbb{E}_{\tau\sim\pi}\left[\sum_{t=0}^{T-1}\gamma^{t}r_{t}(s_{t},a_{t})\right]" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1">
      <semantics id="S3.SS1.p2.10.m10.1a">
       <mrow id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">
        <msup id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">
         <mi id="S3.SS1.p2.10.m10.1.1.3.2" xref="S3.SS1.p2.10.m10.1.1.3.2.cmml">
          π
         </mi>
         <mo id="S3.SS1.p2.10.m10.1.1.3.3" xref="S3.SS1.p2.10.m10.1.1.3.3.cmml">
          ∗
         </mo>
        </msup>
        <mo id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p2.10.m10.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.cmml">
         <mrow id="S3.SS1.p2.10.m10.1.1.1.3" xref="S3.SS1.p2.10.m10.1.1.1.3.cmml">
          <mi id="S3.SS1.p2.10.m10.1.1.1.3.1" xref="S3.SS1.p2.10.m10.1.1.1.3.1.cmml">
           arg
          </mi>
          <mo id="S3.SS1.p2.10.m10.1.1.1.3a" lspace="0.167em" xref="S3.SS1.p2.10.m10.1.1.1.3.cmml">
           ⁡
          </mo>
          <mrow id="S3.SS1.p2.10.m10.1.1.1.3.2" xref="S3.SS1.p2.10.m10.1.1.1.3.2.cmml">
           <msub id="S3.SS1.p2.10.m10.1.1.1.3.2.1" xref="S3.SS1.p2.10.m10.1.1.1.3.2.1.cmml">
            <mi id="S3.SS1.p2.10.m10.1.1.1.3.2.1.2" xref="S3.SS1.p2.10.m10.1.1.1.3.2.1.2.cmml">
             max
            </mi>
            <mi id="S3.SS1.p2.10.m10.1.1.1.3.2.1.3" xref="S3.SS1.p2.10.m10.1.1.1.3.2.1.3.cmml">
             π
            </mi>
           </msub>
           <mo id="S3.SS1.p2.10.m10.1.1.1.3.2a" lspace="0.167em" xref="S3.SS1.p2.10.m10.1.1.1.3.2.cmml">
            ⁡
           </mo>
           <msub id="S3.SS1.p2.10.m10.1.1.1.3.2.2" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.cmml">
            <mi id="S3.SS1.p2.10.m10.1.1.1.3.2.2.2" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.2.cmml">
             𝔼
            </mi>
            <mrow id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.cmml">
             <mi id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.2" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.2.cmml">
              τ
             </mi>
             <mo id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.1" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.1.cmml">
              ∼
             </mo>
             <mi id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.3" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.3.cmml">
              π
             </mi>
            </mrow>
           </msub>
          </mrow>
         </mrow>
         <mo id="S3.SS1.p2.10.m10.1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS1.p2.10.m10.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS1.p2.10.m10.1.1.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.1.2.cmml">
          <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.2" xref="S3.SS1.p2.10.m10.1.1.1.1.2.1.cmml">
           [
          </mo>
          <mrow id="S3.SS1.p2.10.m10.1.1.1.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.cmml">
           <msubsup id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.cmml">
            <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.2" lspace="0em" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.2.cmml">
             ∑
            </mo>
            <mrow id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.cmml">
             <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.2.cmml">
              t
             </mi>
             <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.1" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.1.cmml">
              =
             </mo>
             <mn id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.3.cmml">
              0
             </mn>
            </mrow>
            <mrow id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.cmml">
             <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.2.cmml">
              T
             </mi>
             <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.1" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.1.cmml">
              −
             </mo>
             <mn id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.3.cmml">
              1
             </mn>
            </mrow>
           </msubsup>
           <mrow id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.cmml">
            <msup id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.cmml">
             <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.2.cmml">
              γ
             </mi>
             <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.3.cmml">
              t
             </mi>
            </msup>
            <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.3" lspace="0em" rspace="0em" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.3.cmml">
             ​
            </mo>
            <msub id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.cmml">
             <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.2.cmml">
              r
             </mi>
             <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.3a" lspace="0em" rspace="0em" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.3.cmml">
             ​
            </mo>
            <mrow id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.3.cmml">
             <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.3.cmml">
              (
             </mo>
             <msub id="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.cmml">
              <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.2.cmml">
               s
              </mi>
              <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.4" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.3.cmml">
              ,
             </mo>
             <msub id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.cmml">
              <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.2" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.2.cmml">
               a
              </mi>
              <mi id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.3" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.3.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <mo id="S3.SS1.p2.10.m10.1.1.1.1.1.3" xref="S3.SS1.p2.10.m10.1.1.1.1.2.1.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b">
        <apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">
         <eq id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">
         </eq>
         <apply id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS1.p2.10.m10.1.1.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.3.2">
           𝜋
          </ci>
          <times id="S3.SS1.p2.10.m10.1.1.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3">
          </times>
         </apply>
         <apply id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1">
          <times id="S3.SS1.p2.10.m10.1.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.2">
          </times>
          <apply id="S3.SS1.p2.10.m10.1.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3">
           <arg id="S3.SS1.p2.10.m10.1.1.1.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.1">
           </arg>
           <apply id="S3.SS1.p2.10.m10.1.1.1.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2">
            <apply id="S3.SS1.p2.10.m10.1.1.1.3.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.1">
             <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.3.2.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.1">
              subscript
             </csymbol>
             <max id="S3.SS1.p2.10.m10.1.1.1.3.2.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.1.2">
             </max>
             <ci id="S3.SS1.p2.10.m10.1.1.1.3.2.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.1.3">
              𝜋
             </ci>
            </apply>
            <apply id="S3.SS1.p2.10.m10.1.1.1.3.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2">
             <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.3.2.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2">
              subscript
             </csymbol>
             <ci id="S3.SS1.p2.10.m10.1.1.1.3.2.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.2">
              𝔼
             </ci>
             <apply id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3">
              <csymbol cd="latexml" id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.1">
               similar-to
              </csymbol>
              <ci id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.2">
               𝜏
              </ci>
              <ci id="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.3.2.2.3.3">
               𝜋
              </ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <apply id="S3.SS1.p2.10.m10.1.1.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1">
           <csymbol cd="latexml" id="S3.SS1.p2.10.m10.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.2">
            delimited-[]
           </csymbol>
           <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1">
            <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3">
              superscript
             </csymbol>
             <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3">
               subscript
              </csymbol>
              <sum id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.2">
              </sum>
              <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3">
               <eq id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.1">
               </eq>
               <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.2">
                𝑡
               </ci>
               <cn id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.2.3.3">
                0
               </cn>
              </apply>
             </apply>
             <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3">
              <minus id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.1">
              </minus>
              <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.2">
               𝑇
              </ci>
              <cn id="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.3.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2">
             <times id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.3">
             </times>
             <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4">
              <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4">
               superscript
              </csymbol>
              <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.2">
               𝛾
              </ci>
              <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.4.3">
               𝑡
              </ci>
             </apply>
             <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5">
              <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5">
               subscript
              </csymbol>
              <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.2">
               𝑟
              </ci>
              <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.5.3">
               𝑡
              </ci>
             </apply>
             <interval closure="open" id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2">
              <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.2">
                𝑠
               </ci>
               <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.1.1.1.1.3">
                𝑡
               </ci>
              </apply>
              <apply id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2">
               <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2">
                subscript
               </csymbol>
               <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.2">
                𝑎
               </ci>
               <ci id="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1.1.1.2.2.2.2.3">
                𝑡
               </ci>
              </apply>
             </interval>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">
        \pi^{*}=\arg\max_{\pi}\mathbb{E}_{\tau\sim\pi}\left[\sum_{t=0}^{T-1}\gamma^{t}r_{t}(s_{t},a_{t})\right]
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1">
      <semantics id="S3.SS1.p2.11.m11.1a">
       <mi id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">
        τ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b">
        <ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">
         𝜏
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">
        \tau
       </annotation>
      </semantics>
     </math>
     represents a trajectory.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    RL Algorithms
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.3">
     Several possible RL algorithms could be used
     <cite class="ltx_cite ltx_citemacro_citep">
      [Jaques et al.,
      <a class="ltx_ref" href="#bib.bib27" title="">
       2020
      </a>
      , Verma et al.,
      <a class="ltx_ref" href="#bib.bib66" title="">
       2022
      </a>
      , Snell et al.,
      <a class="ltx_ref" href="#bib.bib56" title="">
       2022a
      </a>
      , Schulman et al.,
      <a class="ltx_ref" href="#bib.bib50" title="">
       2017
      </a>
      , Stiennon et al.,
      <a class="ltx_ref" href="#bib.bib60" title="">
       2022
      </a>
      , Bai et al.,
      <a class="ltx_ref" href="#bib.bib2" title="">
       2022a
      </a>
      , Casper et al.,
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023
      </a>
      ]
     </cite>
     . Policy gradient methods, such as PPO
     <cite class="ltx_cite ltx_citemacro_citep">
      [Schulman et al.,
      <a class="ltx_ref" href="#bib.bib50" title="">
       2017
      </a>
      ]
     </cite>
     , directly compute the gradient of the language model concerning the expected reward objective. Value-based methods estimate a state-action (
     <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1">
      <semantics id="S3.SS2.p1.1.m1.1a">
       <mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">
        Q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b">
        <ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">
         𝑄
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">
        Q
       </annotation>
      </semantics>
     </math>
     ) or state-value (
     <math alttext="V" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1">
      <semantics id="S3.SS2.p1.2.m2.1a">
       <mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">
        V
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b">
        <ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">
         𝑉
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">
        V
       </annotation>
      </semantics>
     </math>
     ) function, from which they then derive a policy by either acting greedily with respect to the Q-function or by combining the learned
     <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1">
      <semantics id="S3.SS2.p1.3.m3.1a">
       <mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">
        Q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b">
        <ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">
         𝑄
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">
        Q
       </annotation>
      </semantics>
     </math>
     -function with the base LM by perturbing the base model’s logits with the learned action-value functions
     <cite class="ltx_cite ltx_citemacro_citep">
      [Snell et al.,
      <a class="ltx_ref" href="#bib.bib56" title="">
       2022a
      </a>
      ]
     </cite>
     .
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.1">
     RL methods for training LLMs can be
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.1">
      online
     </em>
     or
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.2">
      offline
     </em>
     . Online methods repeatedly interact with the environment, collecting additional data during training.
Offline RL instead learns to extract the best behaviors from an existing, potentially suboptimal dataset. Due to the large amount of existing text interactions on the internet, offline RL is an ideal setting for training language models. Therefore, our work primary focuses on benchmarking offline RL algorithms. However our tasks also fully support online RL and we include an online PPO baseline in our evaluation.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   The
   <span class="ltx_ERROR undefined" id="S4.1.1">
    \bmname
   </span>
   : Synthetic Benchmarks for RL with Language
  </h2>
  <div class="ltx_para" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    Our benchmark consists of
    <span class="ltx_ERROR undefined" id="S4.p1.1.1">
     \numtasks
    </span>
    tasks, split into two categories; RL capability tests and interactive dialogue tasks. The RL capability tests focus on specific desirable capabilities for RL algorithms to have such as strategic decision-making, credit assignment, or trajectory stitching. For the interactive dialogue tasks, we model them after real-world interactions with humans, such as persuading someone to buy a car or playing a guessing game like 20 questions. In such multi-turn interactions, there is a need for the agent to make inferences about persuasive strategies and social interaction, actively gather information efficiently through asking questions, and strategically reason in partially observable settings. Below, we discuss the specific capabilities of RL algorithms for LLMs that our benchmark aims to evaluate, we summarize the data generation and simulation process, and we describe the tasks themselves. We provide a concise summary of the dataset and task statistics in
    <a class="ltx_ref" href="#S4.T1" title="In Conversational tasks. ‣ 4.3 An Overview of Data Collection for \bmname Tasks ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Table
     </span>
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    .
   </p>
  </div>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Evaluating Capabilities Enabled by RL
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     A central objective of our benchmark is to evaluate the core capabilities that RL can enable in large language models. Some of these capabilities are
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.1.1">
      computational
     </em>
     , and relate to core decision-making irrespective of the considerations of natural language, such as playing chess, while others are semantic. We discuss the particular capabilities of algorithms we aim to evaluate in this section, followed by a discussion of the criteria that such tasks must meet to do so.
    </p>
   </div>
   <section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
    <h5 class="ltx_title ltx_title_paragraph">
     Strategic decision making.
    </h5>
    <div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">
      RL shines in goal-directed tasks that require multi-step planning and strategic decision-making. Strategic decision-making can range from simple choices like asking follow-up questions to gather information (e.g., in the 20 Questions task), to complex strategy in chess.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
    <h5 class="ltx_title ltx_title_paragraph">
     Complex language.
    </h5>
    <div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">
      Our benchmark includes realistic language and interaction scenarios, requiring LLMs to combine their knowledge from pretraining to help solve tasks during RL finetuning. Rather than focusing entirely on causal logic and strategy found in text games, several of our tasks specifically emphasize the use of realistic language.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
    <h5 class="ltx_title ltx_title_paragraph">
     Credit assignment.
    </h5>
    <div class="ltx_para" id="S4.SS1.SSS0.Px3.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">
      In RL, rewards are often delayed relative to the action that was pivotal to the outcome. For example, a seller agent might state a particularly compelling feature of the product and then, several turns later, complete a successful sale. RL must determine the statements that led to the good outcome, and reinforce them.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="S4.SS1.SSS0.Px4">
    <h5 class="ltx_title ltx_title_paragraph">
     Partial observability.
    </h5>
    <div class="ltx_para" id="S4.SS1.SSS0.Px4.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px4.p1.1">
      In language tasks, the state consists of the entire history of tokens, and an agent may need to examine this entire context to infer the correct state. For example, the mental states of a speaker in a dialogue (e.g., whether the buyer is impatient in a selling task), previously observed facts in a guessing game, and other hidden variables might induce partial observability.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="S4.SS1.SSS0.Px5">
    <h5 class="ltx_title ltx_title_paragraph">
     Trajectory stitching.
    </h5>
    <div class="ltx_para" id="S4.SS1.SSS0.Px5.p1">
     <p class="ltx_p" id="S4.SS1.SSS0.Px5.p1.1">
      In a dataset with many suboptimal trajectories, it is necessary to join optimal actions from different suboptimal trajectories together to form the most optimal trajectory. An algorithm capable of trajectory stitching should be able to learn from optimal actions taken in unsuccessful trajectories and avoid suboptimal actions that occurred in successful trajectories.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    <span class="ltx_ERROR undefined" id="S4.SS2.1.1">
     \bmname
    </span>
    Tasks
   </h3>
   <figure class="ltx_figure ltx_align_floatright" id="S4.F2">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="S4.F2.g1" src="/html/2311.18232/assets/figures/properties_table.png" width="598"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">
       Figure 2
      </span>
      :
     </span>
     <span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">
      Each task in the text-based games and RL capabilities test suite is chosen to test some subset of the RL capabilities outlined in
      <a class="ltx_ref" href="#S4.SS1" title="4.1 Evaluating Capabilities Enabled by RL ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Section
       </span>
       <span class="ltx_text ltx_ref_tag">
        4.1
       </span>
      </a>
      . We use a checkmark to highlight if a task satisfies a property, and a cross if it does not satisfy the property. As can be seen in the figure, the RL capabilities test tasks Chess, Endgames, Wordle, Maze, and Text-Nav all test some proper subset of the properties. The interactive dialogue tasks test many of the properties, but since they were designed to reflect multi-turn dialogue rather than test a specific RL capability, they may not test certain capabilities.
     </span>
    </figcaption>
   </figure>
   <div class="ltx_para" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.1">
     We split our tasks into 5 "RL capability tests" and 3 "interactive dialogue" tasks. The RL capability tests are designed to create comparisons between tasks based on specific RL capabilities as described in
     <a class="ltx_ref" href="#S4" title="4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Section
      </span>
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     . They are created to be text-based versions of tasks where RL without language is known to excel. The interactive dialogue tasks are chosen to be illustrations of real-world interactions where we expect to test multi-turn RL. Example trials for each task are shown in
     <a class="ltx_ref" href="#S4.F4" title="In Car Dealer. ‣ 4.2.2 Interactive Dialogue Tasks ‣ 4.2 \bmname Tasks ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , and we show which capability each task satisfies in
     <a class="ltx_ref" href="#S4.F2" title="In 4.2 \bmname Tasks ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
     <br class="ltx_break"/>
    </p>
   </div>
   <section class="ltx_subsubsection" id="S4.SS2.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      4.2.1
     </span>
     The RL Capability Tests
    </h4>
    <div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.p1">
     <p class="ltx_p" id="S4.SS2.SSS1.p1.1">
      The RL Capability Tests are text-based games designed such that they 1) isolate specific RL capabilities and 2) are language analogs of tasks where RL is known to succeed. To emphasize the comparison to a non-text-based version, we evaluate the Maze task in a symbolic or grid-based environment seen in
      <a class="ltx_ref" href="#A7" title="Appendix G Symbolic Maze Environment ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Appendix
       </span>
       <span class="ltx_text ltx_ref_tag">
        G
       </span>
      </a>
      . Below we highlight how each of the tasks isolates the RL Properties. Further details on task design for each of the RL Property test tasks can be found in
      <a class="ltx_ref" href="#A1" title="Appendix A Further Details on Task Design ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Appendix
       </span>
       <span class="ltx_text ltx_ref_tag">
        A
       </span>
      </a>
      .
     </p>
    </div>
    <section class="ltx_paragraph" id="S4.SS2.SSS1.Px1">
     <h5 class="ltx_title ltx_title_paragraph">
      Partial Observability.
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS1.Px1.p1">
      <p class="ltx_p" id="S4.SS2.SSS1.Px1.p1.1">
       We focus on the effect that partial observability has on performance by including both fully observed (FO) and partially observed (PO) versions of the Maze and Text-Nav tasks. We create a partially observed Maze or Text-Nav by removing information about the location from the state.
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="S4.SS2.SSS1.Px2">
     <h5 class="ltx_title ltx_title_paragraph">
      Trajectory Stitching.
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS1.Px2.p1">
      <p class="ltx_p" id="S4.SS2.SSS1.Px2.p1.1">
       All of the RL Capability Tests test trajectory stitching, because they include suboptimal data. The inclusion of suboptimal requires an offline algorithm to utilize information from suboptimal data to generate optimal trajectories. Further details about our dataset generation strategies can be found in
       <a class="ltx_ref" href="#A3" title="Appendix C Dataset Generation, Statistics, &amp; Rewards ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
        <span class="ltx_text ltx_ref_tag">
         Appendix
        </span>
        <span class="ltx_text ltx_ref_tag">
         C
        </span>
       </a>
       .
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="S4.SS2.SSS1.Px3">
     <h5 class="ltx_title ltx_title_paragraph">
      Credit Assignment.
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS1.Px3.p1">
      <p class="ltx_p" id="S4.SS2.SSS1.Px3.p1.1">
       Chess, Endgames, Maze and Text-Nav test credit assignment, because success in the task is dependent on things outside the control of the agent. In Chess and Endgames, victory is highly dependent on the actions of the opponent. If the opponent makes bad moves, victory is far more likely than if the opponent makes excellent moves. Similarly, in the Maze and Text-Nav tasks, the dataset is generated such that trajectories that start close to the goal are far more likely to succeed. Therefore the agent must learn to distinguish between lucky wins and those resulting from complex strategic decisions.
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="S4.SS2.SSS1.Px4">
     <h5 class="ltx_title ltx_title_paragraph">
      Complex Language
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS1.Px4.p1">
      <p class="ltx_p" id="S4.SS2.SSS1.Px4.p1.1">
       We include both Maze and Text-Nav tasks to highlight the differences between a maze task with and without complex or stochastic text. However, the RL Capability tests are not designed primarily with complex language in mind and we leave that problem to the Interactive Dialogue tasks.
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="S4.SS2.SSS1.Px5">
     <h5 class="ltx_title ltx_title_paragraph">
      Strategic Decision Making
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS1.Px5.p1">
      <p class="ltx_p" id="S4.SS2.SSS1.Px5.p1.1">
       Wordle, Chess, and Chess Endgames test strategic decision-making to varying degrees. Wordle tests information gathering and strategy in a partially observed environment, because the full information about the state is not provided to the agent. We find that Chess requires the most strategic decision-making because it requires the agent to plan over a game more than 40 moves in length.
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="S4.SS2.SSS1.Px6">
     <h5 class="ltx_title ltx_title_paragraph">
      Why include Endgames (Theoretical Chess Endgames)?
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS1.Px6.p1">
      <p class="ltx_p" id="S4.SS2.SSS1.Px6.p1.1">
       Chess endgames provide a simpler and more goal-directed variation of the chess task. By focusing on the endgame, we encourage algorithms to learn strategy rather than memorizing the opening moves of a chess game. A classic theoretical endgame position consists of a position where the only pieces on the board are the two kings and the queen. Although the board position appears simple, a sequence of carefully calculated moves is required to win. A simpler board state allows language models to make progress without fewer computational resources.
      </p>
     </div>
    </section>
   </section>
   <section class="ltx_subsubsection" id="S4.SS2.SSS2">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      4.2.2
     </span>
     Interactive Dialogue Tasks
    </h4>
    <div class="ltx_para" id="S4.SS2.SSS2.p1">
     <p class="ltx_p" id="S4.SS2.SSS2.p1.1">
      For the interactive dialogue tasks, we chose two tasks that involve rational decision-making (20Qs, Guess) and information gathering and one that involves negotiation (Car Dealer). These tasks aim to simulate real world interactions between humans.
     </p>
    </div>
    <section class="ltx_paragraph" id="S4.SS2.SSS2.Px1">
     <h5 class="ltx_title ltx_title_paragraph">
      20Qs (Twenty Questions).
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS2.Px1.p1">
      <p class="ltx_p" id="S4.SS2.SSS2.Px1.p1.1">
       This task tests information gathering to see if a policy can successfully reason about an unknown subject based on context to determine what it is. Additionally, it also evaluates the ability of the model to understand semantics, as it also needs knowledge about the objects in question.
In twenty questions, one player (the oracle) thinks of an object, and the agent (the guesser) tries to guess what it is by asking a series of yes-or-no questions. In this interaction, the oracle serves as the environment, and the agent learning a policy to solve the game is the guesser.
      </p>
     </div>
     <figure class="ltx_figure ltx_align_floatleft" id="S4.F3">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="722" id="S4.F3.g1" src="/html/2311.18232/assets/figures/motivation_benchmarks.png" width="598"/>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">
         Figure 3
        </span>
        :
       </span>
       <span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">
        To generate data for conversational tasks, we use LLMs as “simulators” for the task. Our simulators can be used to generate offline data, to provide a “simulation environment” for evaluation, to perform online training, and to compute rewards.
       </span>
      </figcaption>
     </figure>
    </section>
    <section class="ltx_paragraph" id="S4.SS2.SSS2.Px2">
     <h5 class="ltx_title ltx_title_paragraph">
      Guess (Guess My City).
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS2.Px2.p1">
      <p class="ltx_p" id="S4.SS2.SSS2.Px2.p1.1">
       This task simulates a more complicated guessing game, where one player (the oracle) is from a specific city, and the other player (the guesser) tries to guess what city the oracle is from. Here, the guesser can ask not only yes and no questions, but can also ask open-ended questions. This task tests strategic decision-making and the ability of algorithms to handle complex language, as it allows the agent to go beyond learning to ask yes/no questions and learning to ask questions open-ended questions that provide the agent with more information.
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="S4.SS2.SSS2.Px3">
     <h5 class="ltx_title ltx_title_paragraph">
      Car Dealer.
     </h5>
     <div class="ltx_para" id="S4.SS2.SSS2.Px3.p1">
      <p class="ltx_p" id="S4.SS2.SSS2.Px3.p1.1">
       This task simulates a conversation between a car buyer and a car dealer, each with different strategies for getting the best deal. The buyer wants to buy a certain type of car within a certain budget, and the car dealer wants to complete the sale ideally with a high sale price. We have designed the task such that there exist three different kinds of sellers and three different buyers, each primed with a different strategy. Hence, agents should learn to make agreements with buyers who are most compatible with their strategy i.e. a seller who likes to give discounts will form agreements with a buyer who likes to receive them. This allows us to test the ability of RL algorithms to learn strategic decision-making and credit assignment, by learning which strategies led to a successful sale of the car.
      </p>
     </div>
     <figure class="ltx_figure" id="S4.F4">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="563" id="S4.F4.g1" src="/html/2311.18232/assets/figures/benchmark_examples.png" width="598"/>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S4.F4.3.1.1" style="font-size:90%;">
         Figure 4
        </span>
        :
       </span>
       <span class="ltx_text" id="S4.F4.4.2" style="font-size:90%;">
        Example trials for tasks in
        <span class="ltx_ERROR undefined" id="S4.F4.4.2.1">
         \bmname
        </span>
        . Each task requires the agent to perform a multi-turn interaction with an environment – either a text game or another LLM simulating a human speaker. Full details of tasks are provided in Appendix
        <a class="ltx_ref" href="#A3" title="Appendix C Dataset Generation, Statistics, &amp; Rewards ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
         <span class="ltx_text ltx_ref_tag">
          C
         </span>
        </a>
        .
       </span>
      </figcaption>
     </figure>
    </section>
   </section>
  </section>
  <section class="ltx_subsection" id="S4.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.3
    </span>
    An Overview of Data Collection for
    <span class="ltx_ERROR undefined" id="S4.SS3.1.1">
     \bmname
    </span>
    Tasks
   </h3>
   <div class="ltx_para" id="S4.SS3.p1">
    <p class="ltx_p" id="S4.SS3.p1.1">
     In order to make the tasks in
     <span class="ltx_ERROR undefined" id="S4.SS3.p1.1.1">
      \bmname
     </span>
     practical for benchmarking RL methods, we must balance accessibility and realism. Real-world datasets would be the most realistic, but since RL algorithms need to be evaluated by actually running the learned policy, real-world tasks are comparatively inaccessible for rapid iteration (e.g., if they require talking to real humans). We therefore use simulators for all of our tasks, which are derived either from text-based games, or conversational agents powered by language models. Although this fully synthetic setup sacrifices some realism, we believe the significant gain in accessibility is worthwhile and will enable more rapid RL algorithm progress.
    </p>
   </div>
   <section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
    <h5 class="ltx_title ltx_title_paragraph">
     Text-based games.
    </h5>
    <div class="ltx_para" id="S4.SS3.SSS0.Px1.p1">
     <p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">
      For each of these tasks, we use a simulator such as a chess engine or maze solver to generate near-optimal data and then we dilute the policy with suboptimal data by taking suboptimal actions or using inferior policies. We also convert our task from a symbolic version to a text-based version in a programmatic way as discussed in
      <a class="ltx_ref" href="#A1" title="Appendix A Further Details on Task Design ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Appendix
       </span>
       <span class="ltx_text ltx_ref_tag">
        A
       </span>
      </a>
      .
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
    <h5 class="ltx_title ltx_title_paragraph">
     Conversational tasks.
    </h5>
    <div class="ltx_para" id="S4.SS3.SSS0.Px2.p1">
     <p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">
      For conversational tasks, we leverage existing LLMs to generate our data, either with two instances of LLMs “talking” to one another or all at once through few-shot prompting. In order to train these LLMs, we use OpenAI’s GPT-3.5 to generate an initial dataset by asking reasonable questions and answers out-of-the-box, collecting a dataset of differing sizes depending on the task.
In the case of 20Qs and Guess My City, we collected 1K conversations by querying GPT-3.5 (text-davinci-003) to generate both sides of the conversation.
To generate the dataset for training our algorithms, we fine-tuned a GPT2-medium guesser model and a GPT2-medium oracle model on their respective sides of the conversation. Using these models, we generated the final 100K conversations dataset by having the two models talk to each other. We conducted a similar process for the Car Dealer task. We show our data generation process in
      <a class="ltx_ref" href="#S4.F3" title="In 20Qs (Twenty Questions). ‣ 4.2.2 Interactive Dialogue Tasks ‣ 4.2 \bmname Tasks ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Figure
       </span>
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </a>
      .
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p2">
     <p class="ltx_p" id="S4.SS3.SSS0.Px2.p2.1">
      In
      <a class="ltx_ref" href="#S4.T1" title="In Conversational tasks. ‣ 4.3 An Overview of Data Collection for \bmname Tasks ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Table
       </span>
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </a>
      we present the dataset statistics on these tasks. The number of trajectories and the average length of the trajectories varies based on the complexity of the tasks.
     </p>
    </div>
    <figure class="ltx_table" id="S4.T1">
     <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.2">
      <thead class="ltx_thead">
       <tr class="ltx_tr" id="S4.T1.2.1.1">
        <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T1.2.1.1.1">
         <span class="ltx_text" id="S4.T1.2.1.1.1.1" style="font-size:90%;">
          Task
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.2">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.2.1" style="font-size:90%;">
          Maze
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.3">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.3.1" style="font-size:90%;">
          Text-Nav
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.4">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.4.1" style="font-size:90%;">
          Wordle
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.5">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.5.1" style="font-size:90%;">
          Chess
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.6">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.6.1" style="font-size:90%;">
          Endgames
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.7">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.7.1" style="font-size:90%;">
          20Qs
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.8">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.8.1" style="font-size:90%;">
          Guess
         </span>
        </th>
        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.1.1.9">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.1.1.9.1" style="font-size:90%;">
          Car
         </span>
        </th>
       </tr>
      </thead>
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="S4.T1.2.2.1">
        <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.2.2.1.1">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.2.1.1.1" style="font-size:90%;">
          Size
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.2">
         <span class="ltx_text" id="S4.T1.2.2.1.2.1" style="font-size:90%;">
          1.24k
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.3">
         <span class="ltx_text" id="S4.T1.2.2.1.3.1" style="font-size:90%;">
          2.5k
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.4">
         <span class="ltx_text" id="S4.T1.2.2.1.4.1" style="font-size:90%;">
          1m
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.5">
         <span class="ltx_text" id="S4.T1.2.2.1.5.1" style="font-size:90%;">
          625k
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.6">
         <span class="ltx_text" id="S4.T1.2.2.1.6.1" style="font-size:90%;">
          97.756k
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.7">
         <span class="ltx_text" id="S4.T1.2.2.1.7.1" style="font-size:90%;">
          100k
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.8">
         <span class="ltx_text" id="S4.T1.2.2.1.8.1" style="font-size:90%;">
          100k
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.1.9">
         <span class="ltx_text" id="S4.T1.2.2.1.9.1" style="font-size:90%;">
          19k
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S4.T1.2.3.2">
        <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T1.2.3.2.1">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.3.2.1.1" style="font-size:90%;">
          avg length
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.2">
         <span class="ltx_text" id="S4.T1.2.3.2.2.1" style="font-size:90%;">
          19.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.3">
         <span class="ltx_text" id="S4.T1.2.3.2.3.1" style="font-size:90%;">
          12.2
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.4">
         <span class="ltx_text" id="S4.T1.2.3.2.4.1" style="font-size:90%;">
          4.82
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.5">
         <span class="ltx_text" id="S4.T1.2.3.2.5.1" style="font-size:90%;">
          46.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.6">
         <span class="ltx_text" id="S4.T1.2.3.2.6.1" style="font-size:90%;">
          11.9
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.7">
         <span class="ltx_text" id="S4.T1.2.3.2.7.1" style="font-size:90%;">
          -14.9
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.8">
         <span class="ltx_text" id="S4.T1.2.3.2.8.1" style="font-size:90%;">
          -18.8
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.3.2.9">
         <span class="ltx_text" id="S4.T1.2.3.2.9.1" style="font-size:90%;">
          16.5
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S4.T1.2.4.3">
        <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T1.2.4.3.1">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.4.3.1.1" style="font-size:90%;">
          std length
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.2">
         <span class="ltx_text" id="S4.T1.2.4.3.2.1" style="font-size:90%;">
          24.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.3">
         <span class="ltx_text" id="S4.T1.2.4.3.3.1" style="font-size:90%;">
          8.77
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.4">
         <span class="ltx_text" id="S4.T1.2.4.3.4.1" style="font-size:90%;">
          1.27
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.5">
         <span class="ltx_text" id="S4.T1.2.4.3.5.1" style="font-size:90%;">
          18.16
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.6">
         <span class="ltx_text" id="S4.T1.2.4.3.6.1" style="font-size:90%;">
          12.0
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.7">
         <span class="ltx_text" id="S4.T1.2.4.3.7.1" style="font-size:90%;">
          4.38
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.8">
         <span class="ltx_text" id="S4.T1.2.4.3.8.1" style="font-size:90%;">
          4.57
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.4.3.9">
         <span class="ltx_text" id="S4.T1.2.4.3.9.1" style="font-size:90%;">
          3.61
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S4.T1.2.5.4">
        <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T1.2.5.4.1">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.5.4.1.1" style="font-size:90%;">
          success rate
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.2">
         <span class="ltx_text" id="S4.T1.2.5.4.2.1" style="font-size:90%;">
          0.11
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.3">
         <span class="ltx_text" id="S4.T1.2.5.4.3.1" style="font-size:90%;">
          0.26
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.4">
         <span class="ltx_text" id="S4.T1.2.5.4.4.1" style="font-size:90%;">
          0.70
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.5">
         <span class="ltx_text" id="S4.T1.2.5.4.5.1" style="font-size:90%;">
          0.60
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.6">
         <span class="ltx_text" id="S4.T1.2.5.4.6.1" style="font-size:90%;">
          0.59
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.7">
         <span class="ltx_text" id="S4.T1.2.5.4.7.1" style="font-size:90%;">
          0.31
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.8">
         <span class="ltx_text" id="S4.T1.2.5.4.8.1" style="font-size:90%;">
          0.53
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.5.4.9">
         <span class="ltx_text" id="S4.T1.2.5.4.9.1" style="font-size:90%;">
          0.53
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S4.T1.2.6.5">
        <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T1.2.6.5.1">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.6.5.1.1" style="font-size:90%;">
          avg return
         </span>
        </th>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.2">
         <span class="ltx_text" id="S4.T1.2.6.5.2.1" style="font-size:90%;">
          -19.7
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.3">
         <span class="ltx_text" id="S4.T1.2.6.5.3.1" style="font-size:90%;">
          0.258
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.4">
         <span class="ltx_text" id="S4.T1.2.6.5.4.1" style="font-size:90%;">
          -4.12
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.5">
         <span class="ltx_text" id="S4.T1.2.6.5.5.1" style="font-size:90%;">
          0.210
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.6">
         <span class="ltx_text" id="S4.T1.2.6.5.6.1" style="font-size:90%;">
          0.586
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.7">
         <span class="ltx_text" id="S4.T1.2.6.5.7.1" style="font-size:90%;">
          -17.3
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.8">
         <span class="ltx_text" id="S4.T1.2.6.5.8.1" style="font-size:90%;">
          -18.8
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S4.T1.2.6.5.9">
         <span class="ltx_text" id="S4.T1.2.6.5.9.1" style="font-size:90%;">
          0.562
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S4.T1.2.7.6">
        <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T1.2.7.6.1">
         <span class="ltx_text ltx_font_typewriter" id="S4.T1.2.7.6.1.1" style="font-size:90%;">
          std return
         </span>
        </th>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.2">
         <span class="ltx_text" id="S4.T1.2.7.6.2.1" style="font-size:90%;">
          24.5
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.3">
         <span class="ltx_text" id="S4.T1.2.7.6.3.1" style="font-size:90%;">
          0.424
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.4">
         <span class="ltx_text" id="S4.T1.2.7.6.4.1" style="font-size:90%;">
          1.59
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.5">
         <span class="ltx_text" id="S4.T1.2.7.6.5.1" style="font-size:90%;">
          0.970
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.6">
         <span class="ltx_text" id="S4.T1.2.7.6.6.1" style="font-size:90%;">
          0.492
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.7">
         <span class="ltx_text" id="S4.T1.2.7.6.7.1" style="font-size:90%;">
          2.56
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.8">
         <span class="ltx_text" id="S4.T1.2.7.6.8.1" style="font-size:90%;">
          4.12
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.7.6.9">
         <span class="ltx_text" id="S4.T1.2.7.6.9.1" style="font-size:90%;">
          0.422
         </span>
        </td>
       </tr>
      </tbody>
     </table>
     <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
      <span class="ltx_tag ltx_tag_table">
       Table 1:
      </span>
      Statistics for all tasks in
      <span class="ltx_ERROR undefined" id="S4.T1.8.1">
       \bmname
      </span>
      . Size represents the number of trajectories, the average length is the average length of trajectories in the dataset where the unit is a response from the agent. The success rate is the proportion of trajectories that reach the objective. Finally, the reward functions for each task are defined in
      <a class="ltx_ref" href="#A3" title="Appendix C Dataset Generation, Statistics, &amp; Rewards ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Appendix
       </span>
       <span class="ltx_text ltx_ref_tag">
        C
       </span>
      </a>
      .
     </figcaption>
    </figure>
   </section>
  </section>
 </section>
 <section class="ltx_section" id="S5" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   LMRL Research Framework for Algorithm Development
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    To validate the efficacy of
    <span class="ltx_ERROR undefined" id="S5.p1.1.1">
     \bmname
    </span>
    for benchmarking RL algorithms that meet the expected capabilities defined in Section
    <a class="ltx_ref" href="#S4.SS1" title="4.1 Evaluating Capabilities Enabled by RL ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      4.1
     </span>
    </a>
    , we evaluate our tasks on a set of both online and offline RL algorithms. With these experiments, we expect to 1) observe a significant spread in performance between the different algorithms, validating the utility of our tasks for measuring differences between RL algorithms; and 2) we should ideally observe room to improve beyond what our current algorithms achieve on these tasks, such that our benchmark can enable future algorithmic development. Our project page (
    <span class="ltx_text" id="S5.p1.1.2" style="color:#0000FF;">
     https://lmrl-gym.github.io/
    </span>
    ) contains links to our open-sourced datasets and research framework (
    <span class="ltx_text" id="S5.p1.1.3" style="color:#0000FF;">
     https://github.com/abdulhaim/LMRL-Gym
    </span>
    ).
    <br class="ltx_break"/>
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S5.p2">
   <p class="ltx_p" id="S5.p2.1">
    We evaluate two standard language model finetuning baselines (BC &amp; filtered BC), two baseline value-based offline RL methods (MC &amp; ILQL
    <cite class="ltx_cite ltx_citemacro_citep">
     [Snell et al.,
     <a class="ltx_ref" href="#bib.bib56" title="">
      2022a
     </a>
     ]
    </cite>
    ), standard online RL methods (PPO
    <cite class="ltx_cite ltx_citemacro_citep">
     [Schulman et al.,
     <a class="ltx_ref" href="#bib.bib50" title="">
      2017
     </a>
     ]
    </cite>
    , Online Filtered BC), as well as evaluation done by GPT4. For all of our experiments, we use the decoder-only transformer model GPT2
    <cite class="ltx_cite ltx_citemacro_citep">
     [Radford et al.,
     <a class="ltx_ref" href="#bib.bib47" title="">
      2019
     </a>
     ]
    </cite>
    (and its variant sizes) as the policy and value network. Finally, we conduct a human evaluation to test the naturalness of the conversations generated by our simulators. We describe our protocol and display results in
    <a class="ltx_ref" href="#A10" title="Appendix J User Study on Naturalness of Conversations ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Appendix
     </span>
     <span class="ltx_text ltx_ref_tag">
      J
     </span>
    </a>
    .
   </p>
  </div>
  <section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
   <h5 class="ltx_title ltx_title_paragraph">
    BC, Filtered BC, Online Filtered BC
   </h5>
   <div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">
     In line with standard RL nomenclature, we denote supervised fine-tuning as behavioral cloning (BC). This baseline tests whether LMs can effectively represent the behaviors in the datasets. We also evaluate filtered BC, which is identical, except we use only the most successful examples in the dataset for fine-tuning. Online filtered BC collects data using the current policy and selects the most successful trajectories for finetuning. See
     <a class="ltx_ref" href="#A4" title="Appendix D Hyperparameters for All Tasks ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Appendix
      </span>
      <span class="ltx_text ltx_ref_tag">
       D
      </span>
     </a>
     for our data filtering criteria for each task.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
   <h5 class="ltx_title ltx_title_paragraph">
    Offline Value-based RL: MC Returns and ILQL
   </h5>
   <div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
    <p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.5">
     Monte-Carlo returns
     <cite class="ltx_cite ltx_citemacro_citep">
      [Nakamoto et al.,
      <a class="ltx_ref" href="#bib.bib36" title="">
       2023
      </a>
      ]
     </cite>
     and Implicit Language Q-Learning
     <cite class="ltx_cite ltx_citemacro_citep">
      [Snell et al.,
      <a class="ltx_ref" href="#bib.bib56" title="">
       2022a
      </a>
      ]
     </cite>
     train a value
     <math alttext="V" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.1.m1.1">
      <semantics id="S5.SS0.SSS0.Px2.p1.1.m1.1a">
       <mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">
        V
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.1b">
        <ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1">
         𝑉
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.1c">
        V
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="Q" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.2.m2.1">
      <semantics id="S5.SS0.SSS0.Px2.p1.2.m2.1a">
       <mi id="S5.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">
        Q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.2.m2.1b">
        <ci id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1">
         𝑄
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.2.m2.1c">
        Q
       </annotation>
      </semantics>
     </math>
     function. In MC Returns, we fine-tune an LM to predict the reward-to-go of the trajectory at each token. In ILQL we train the 2 action-value (
     <math alttext="Q" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.3.m3.1">
      <semantics id="S5.SS0.SSS0.Px2.p1.3.m3.1a">
       <mi id="S5.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">
        Q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.3.m3.1b">
        <ci id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1">
         𝑄
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.3.m3.1c">
        Q
       </annotation>
      </semantics>
     </math>
     ) functions using the Bellman backup operator introduced in
     <cite class="ltx_cite ltx_citemacro_cite">
      Kostrikov et al. [
      <a class="ltx_ref" href="#bib.bib30" title="">
       2021
      </a>
      ]
     </cite>
     . The
     <math alttext="Q" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.4.m4.1">
      <semantics id="S5.SS0.SSS0.Px2.p1.4.m4.1a">
       <mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">
        Q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.4.m4.1b">
        <ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1">
         𝑄
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.4.m4.1c">
        Q
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="V" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.5.m5.1">
      <semantics id="S5.SS0.SSS0.Px2.p1.5.m5.1a">
       <mi id="S5.SS0.SSS0.Px2.p1.5.m5.1.1" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.cmml">
        V
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.5.m5.1b">
        <ci id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1">
         𝑉
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.5.m5.1c">
        V
       </annotation>
      </semantics>
     </math>
     functions are then used to perturb the logits of the original BC model (see Equation
     <a class="ltx_ref" href="#A6.E5" title="Equation 5 ‣ F.1 MC Details ‣ Appendix F Baseline Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     ).
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S5.SS0.SSS0.Px3">
   <h5 class="ltx_title ltx_title_paragraph">
    Online RL: PPO
   </h5>
   <div class="ltx_para" id="S5.SS0.SSS0.Px3.p1">
    <p class="ltx_p" id="S5.SS0.SSS0.Px3.p1.1">
     PPO
     <cite class="ltx_cite ltx_citemacro_citep">
      [Schulman et al.,
      <a class="ltx_ref" href="#bib.bib50" title="">
       2017
      </a>
      ]
     </cite>
     is an online RL algorithm that has become widely adopted for training language models with Reinforcement Learning from Human Feedback
     <cite class="ltx_cite ltx_citemacro_citep">
      [Christiano et al.,
      <a class="ltx_ref" href="#bib.bib11" title="">
       2023
      </a>
      , Stiennon et al.,
      <a class="ltx_ref" href="#bib.bib60" title="">
       2022
      </a>
      , Bai et al.,
      <a class="ltx_ref" href="#bib.bib2" title="">
       2022a
      </a>
      , Casper et al.,
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023
      </a>
      ]
     </cite>
     . Unlike the previous two value-function RL methods, PPO directly learns a policy, meaning that at inference time we can directly sample from our learned policy.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S5.SS0.SSS0.Px4">
   <h5 class="ltx_title ltx_title_paragraph">
    GPT4
   </h5>
   <div class="ltx_para" id="S5.SS0.SSS0.Px4.p1">
    <p class="ltx_p" id="S5.SS0.SSS0.Px4.p1.1">
     To compare few-shot prompting to RL fine-tuning, we few-shot prompt GPT4 to complete each of these tasks. We do this by providing several examples from the dataset in the prompt as well as any extra information that would be necessary to complete the game. The prompts can be found in our code repository.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.1
    </span>
    Training and Evaluation Protocol
   </h3>
   <div class="ltx_para" id="S5.SS1.p1">
    <p class="ltx_p" id="S5.SS1.p1.1">
     For the BC and filtered BC methods, we initialize our models with the pre-trained GPT2 weights
     <cite class="ltx_cite ltx_citemacro_citep">
      [Radford et al.,
      <a class="ltx_ref" href="#bib.bib47" title="">
       2019
      </a>
      ]
     </cite>
     and perform standard finetuning. For each of the RL methods, we initialize the weights of the base model with the weights from the BC checkpoint and then continue finetuning with the RL objective. When fine-tuning PPO, we limit the number of samples to less than 100k. We report the hyperparameters that we used for each task in
     <a class="ltx_ref" href="#A4" title="Appendix D Hyperparameters for All Tasks ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Appendix
      </span>
      <span class="ltx_text ltx_ref_tag">
       D
      </span>
     </a>
     . We evaluate each policy by measuring the average reward in the simulated environment for each task.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S6" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Benchmarking Baseline RL Methods
  </h2>
  <div class="ltx_para" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    In
    <a class="ltx_ref" href="#A7.T9" title="In Appendix G Symbolic Maze Environment ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Table
     </span>
     <span class="ltx_text ltx_ref_tag">
      9
     </span>
    </a>
    we present results for each method on our benchmark tasks. Across all tasks, we see that the RL algorithms outperform BC methods. However, among the RL algorithms, there is no clear winner. We discuss this in detail below.
   </p>
  </div>
  <figure class="ltx_table" id="S6.T2">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T2.2">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="S6.T2.2.1.1">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S6.T2.2.1.1.1">
       <span class="ltx_text" id="S6.T2.2.1.1.1.1" style="font-size:90%;">
        alg.
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.2.1.1.2">
       <span class="ltx_text" id="S6.T2.2.1.1.2.1" style="font-size:90%;">
        BC
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S6.T2.2.1.1.3">
       <span class="ltx_text" id="S6.T2.2.1.1.3.1" style="font-size:90%;">
        % BC
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.2.1.1.4">
       <span class="ltx_text" id="S6.T2.2.1.1.4.1" style="font-size:90%;">
        MC Return
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S6.T2.2.1.1.5">
       <span class="ltx_text" id="S6.T2.2.1.1.5.1" style="font-size:90%;">
        ILQL
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.2.1.1.6">
       <span class="ltx_text" id="S6.T2.2.1.1.6.1" style="font-size:90%;">
        Online PPO
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S6.T2.2.1.1.7">
       <span class="ltx_text" id="S6.T2.2.1.1.7.1" style="font-size:90%;">
        Online % BC
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.2.1.1.8">
       <span class="ltx_text" id="S6.T2.2.1.1.8.1" style="font-size:90%;">
        GPT-4
       </span>
      </th>
      <th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S6.T2.2.1.1.9">
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="S6.T2.2.2.1">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T2.2.2.1.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.2.1.1.1" style="font-size:90%;">
        FO Maze
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.2.1.2">
       <span class="ltx_text" id="S6.T2.2.2.1.2.1" style="font-size:90%;">
        58.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.2.2.1.3">
       <span class="ltx_text" id="S6.T2.2.2.1.3.1" style="font-size:90%;">
        68.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.2.1.4">
       <span class="ltx_text" id="S6.T2.2.2.1.4.1" style="font-size:90%;">
        75.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.2.2.1.5">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.2.1.5.1" style="font-size:90%;">
        99.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.2.1.6">
       <span class="ltx_text" id="S6.T2.2.2.1.6.1" style="font-size:90%;">
        79.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T2.2.2.1.7">
       <span class="ltx_text" id="S6.T2.2.2.1.7.1" style="font-size:90%;">
        57.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.2.2.1.8">
       <span class="ltx_text" id="S6.T2.2.2.1.8.1" style="font-size:90%;">
        78.2
       </span>
      </td>
      <td class="ltx_td ltx_border_t" id="S6.T2.2.2.1.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.3.2">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.3.2.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.3.2.1.1" style="font-size:90%;">
        PO Maze
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.3.2.2">
       <span class="ltx_text" id="S6.T2.2.3.2.2.1" style="font-size:90%;">
        53.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.3.2.3">
       <span class="ltx_text" id="S6.T2.2.3.2.3.1" style="font-size:90%;">
        50.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.3.2.4">
       <span class="ltx_text" id="S6.T2.2.3.2.4.1" style="font-size:90%;">
        52.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.3.2.5">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.3.2.5.1" style="font-size:90%;">
        76.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.3.2.6">
       <span class="ltx_text" id="S6.T2.2.3.2.6.1" style="font-size:90%;">
        42.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.3.2.7">
       <span class="ltx_text" id="S6.T2.2.3.2.7.1" style="font-size:90%;">
        53.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.3.2.8">
       <span class="ltx_text" id="S6.T2.2.3.2.8.1" style="font-size:90%;">
        60.4
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.3.2.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.4.3">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.4.3.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.4.3.1.1" style="font-size:90%;">
        FO Text-Nav
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.4.3.2">
       <span class="ltx_text" id="S6.T2.2.4.3.2.1" style="font-size:90%;">
        53.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.4.3.3">
       <span class="ltx_text" id="S6.T2.2.4.3.3.1" style="font-size:90%;">
        65.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.4.3.4">
       <span class="ltx_text" id="S6.T2.2.4.3.4.1" style="font-size:90%;">
        71.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.4.3.5">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.4.3.5.1" style="font-size:90%;">
        91.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.4.3.6">
       <span class="ltx_text" id="S6.T2.2.4.3.6.1" style="font-size:90%;">
        87.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.4.3.7">
       <span class="ltx_text" id="S6.T2.2.4.3.7.1" style="font-size:90%;">
        74.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.4.3.8">
       <span class="ltx_text" id="S6.T2.2.4.3.8.1" style="font-size:90%;">
        67.5
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.4.3.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.5.4">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.5.4.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.5.4.1.1" style="font-size:90%;">
        PO Text-Nav
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.5.4.2">
       <span class="ltx_text" id="S6.T2.2.5.4.2.1" style="font-size:90%;">
        49.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.5.4.3">
       <span class="ltx_text" id="S6.T2.2.5.4.3.1" style="font-size:90%;">
        60.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.5.4.4">
       <span class="ltx_text" id="S6.T2.2.5.4.4.1" style="font-size:90%;">
        71.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.5.4.5">
       <span class="ltx_text" id="S6.T2.2.5.4.5.1" style="font-size:90%;">
        83.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.5.4.6">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.5.4.6.1" style="font-size:90%;">
        85.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.5.4.7">
       <span class="ltx_text" id="S6.T2.2.5.4.7.1" style="font-size:90%;">
        68.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.5.4.8">
       <span class="ltx_text" id="S6.T2.2.5.4.8.1" style="font-size:90%;">
        40.2
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.5.4.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.6.5">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.6.5.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.6.5.1.1" style="font-size:90%;">
        Wordle
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.6.5.2">
       <span class="ltx_text" id="S6.T2.2.6.5.2.1" style="font-size:90%;">
        79.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.6.5.3">
       <span class="ltx_text" id="S6.T2.2.6.5.3.1" style="font-size:90%;">
        79.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.6.5.4">
       <span class="ltx_text" id="S6.T2.2.6.5.4.1" style="font-size:90%;">
        94.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.6.5.5">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.6.5.5.1" style="font-size:90%;">
        97.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.6.5.6">
       <span class="ltx_text" id="S6.T2.2.6.5.6.1" style="font-size:90%;">
        84.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.6.5.7">
       <span class="ltx_text" id="S6.T2.2.6.5.7.1" style="font-size:90%;">
        95.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.6.5.8">
       <span class="ltx_text" id="S6.T2.2.6.5.8.1" style="font-size:90%;">
        15.4
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.6.5.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.7.6">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.7.6.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.7.6.1.1" style="font-size:90%;">
        Chess
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.7.6.2">
       <span class="ltx_text" id="S6.T2.2.7.6.2.1" style="font-size:90%;">
        47.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.7.6.3">
       <span class="ltx_text" id="S6.T2.2.7.6.3.1" style="font-size:90%;">
        42.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.7.6.4">
       <span class="ltx_text" id="S6.T2.2.7.6.4.1" style="font-size:90%;">
        46.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.7.6.5">
       <span class="ltx_text" id="S6.T2.2.7.6.5.1" style="font-size:90%;">
        47.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.7.6.6">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.7.6.6.1" style="font-size:90%;">
        48.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.7.6.7">
       <span class="ltx_text" id="S6.T2.2.7.6.7.1" style="font-size:90%;">
        47.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.7.6.8">
       <span class="ltx_text" id="S6.T2.2.7.6.8.1" style="font-size:90%;">
        0
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.7.6.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.8.7">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.8.7.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.8.7.1.1" style="font-size:90%;">
        Endgames
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.8.7.2">
       <span class="ltx_text" id="S6.T2.2.8.7.2.1" style="font-size:90%;">
        35.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.8.7.3">
       <span class="ltx_text" id="S6.T2.2.8.7.3.1" style="font-size:90%;">
        17.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.8.7.4">
       <span class="ltx_text" id="S6.T2.2.8.7.4.1" style="font-size:90%;">
        50.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.8.7.5">
       <span class="ltx_text" id="S6.T2.2.8.7.5.1" style="font-size:90%;">
        45.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.8.7.6">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.8.7.6.1" style="font-size:90%;">
        77.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.8.7.7">
       <span class="ltx_text" id="S6.T2.2.8.7.7.1" style="font-size:90%;">
        36.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.8.7.8">
       <span class="ltx_text" id="S6.T2.2.8.7.8.1" style="font-size:90%;">
        0
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.8.7.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.9.8">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.9.8.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.9.8.1.1" style="font-size:90%;">
        20Qs
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.9.8.2">
       <span class="ltx_text" id="S6.T2.2.9.8.2.1" style="font-size:90%;">
        57.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.9.8.3">
       <span class="ltx_text" id="S6.T2.2.9.8.3.1" style="font-size:90%;">
        77.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.9.8.4">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.9.8.4.1" style="font-size:90%;">
        87.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.9.8.5">
       <span class="ltx_text" id="S6.T2.2.9.8.5.1" style="font-size:90%;">
        82.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.9.8.6">
       <span class="ltx_text" id="S6.T2.2.9.8.6.1" style="font-size:90%;">
        72.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.9.8.7">
       <span class="ltx_text" id="S6.T2.2.9.8.7.1" style="font-size:90%;">
        55.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.9.8.8">
       <span class="ltx_text" id="S6.T2.2.9.8.8.1" style="font-size:90%;">
        95.7
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.9.8.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.10.9">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S6.T2.2.10.9.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.10.9.1.1" style="font-size:90%;">
        Guess
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.10.9.2">
       <span class="ltx_text" id="S6.T2.2.10.9.2.1" style="font-size:90%;">
        30.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.10.9.3">
       <span class="ltx_text" id="S6.T2.2.10.9.3.1" style="font-size:90%;">
        48.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.10.9.4">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.10.9.4.1" style="font-size:90%;">
        88.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.10.9.5">
       <span class="ltx_text" id="S6.T2.2.10.9.5.1" style="font-size:90%;">
        75.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.10.9.6">
       <span class="ltx_text" id="S6.T2.2.10.9.6.1" style="font-size:90%;">
        49.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S6.T2.2.10.9.7">
       <span class="ltx_text" id="S6.T2.2.10.9.7.1" style="font-size:90%;">
        31.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S6.T2.2.10.9.8">
       <span class="ltx_text" id="S6.T2.2.10.9.8.1" style="font-size:90%;">
        92.3
       </span>
      </td>
      <td class="ltx_td" id="S6.T2.2.10.9.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="S6.T2.2.11.10">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T2.2.11.10.1">
       <span class="ltx_text ltx_font_typewriter" id="S6.T2.2.11.10.1.1" style="font-size:90%;">
        Car
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.2.11.10.2">
       <span class="ltx_text" id="S6.T2.2.11.10.2.1" style="font-size:90%;">
        44.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T2.2.11.10.3">
       <span class="ltx_text" id="S6.T2.2.11.10.3.1" style="font-size:90%;">
        54.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.2.11.10.4">
       <span class="ltx_text ltx_font_bold" id="S6.T2.2.11.10.4.1" style="font-size:90%;">
        57.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T2.2.11.10.5">
       <span class="ltx_text" id="S6.T2.2.11.10.5.1" style="font-size:90%;">
        46.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.2.11.10.6">
       <span class="ltx_text" id="S6.T2.2.11.10.6.1" style="font-size:90%;">
        50.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T2.2.11.10.7">
       <span class="ltx_text" id="S6.T2.2.11.10.7.1" style="font-size:90%;">
        40.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.2.11.10.8">
       <span class="ltx_text" id="S6.T2.2.11.10.8.1" style="font-size:90%;">
        53.5
       </span>
      </td>
      <td class="ltx_td ltx_border_bb" id="S6.T2.2.11.10.9">
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 2:
    </span>
    Normalized reward for all tasks. Value-based methods (MC and ILQL) generally outperform filtered BC, as we might expect in stochastic settings, though the relative performance of ILQL and the simpler MC method is, perhaps surprisingly, reversed on the tasks with more complex language, suggesting that there is significant room for improvement with such methods. Online RL with PPO often, but not always, improves over offline methods that are not permitted to collect additional online interaction. To make the results more comparable across tasks, we normalize the average return for each policy such that 0 is the minimum possible return, 50 is the dataset average return, and 100 is the maximum return for each task. We also report the raw score results and evaluation details in
    <a class="ltx_ref" href="#A5.T4" title="In Appendix E Evaluation Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Table
     </span>
     <span class="ltx_text ltx_ref_tag">
      4
     </span>
    </a>
    .
   </figcaption>
  </figure>
  <section class="ltx_paragraph" id="S6.SS0.SSS0.Px1">
   <h5 class="ltx_title ltx_title_paragraph">
    Online PPO vs. Offline Value-based RL.
   </h5>
   <div class="ltx_para" id="S6.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="S6.SS0.SSS0.Px1.p1.1">
     Online RL was able to do better than our offline methods on the PO Text-Nav, Chess, and Endgames tasks by leveraging additional online interaction data and the ability to explore the environment simulator. However, on the Maze and Wordle tasks, ILQL outperformed PPO, which we believe to be due to either (1) observed instabilities in PPO training (see Appendix
     <a class="ltx_ref" href="#A6.SS2" title="F.2 PPO Details ‣ Appendix F Baseline Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       F.2
      </span>
     </a>
     for details); or (2) a lack of sample efficiency in PPO. To address instabilities in PPO, we tuned the KL coefficient and included BC loss in the training objective. In contrast, on FO Text-Nav PPO performed comparably to ILQL and outperformed MC. For the Endgames task, PPO outperformed the other methods by a large margin as shown in
     <a class="ltx_ref" href="#A6.F5" title="In PPO Instabilities ‣ F.2 PPO Details ‣ Appendix F Baseline Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     . These results demonstrate that current RL algorithms such as PPO are unable to completely solve tasks that test the capabilities of trajectory stitching and credit assignment, showing room for improvement in the development of such algorithms.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S6.SS0.SSS0.Px2">
   <h5 class="ltx_title ltx_title_paragraph">
    Online PPO vs. Online Filtered BC
   </h5>
   <div class="ltx_para" id="S6.SS0.SSS0.Px2.p1">
    <p class="ltx_p" id="S6.SS0.SSS0.Px2.p1.1">
     We found that Online PPO outperformed Online Filtered BC in all tasks except for Wordle. This is most likely caused by 1) a lack of exploration by Online Filtered BC 2) PPO exhibiting greater ability to perform credit assignment. This highlights the strengths of the online PPO algorithm. On one hand, we observe PPO’s effectiveness in directly optimizing against the environment by exploring and learning from additional, informative on-policy trajectories. On the other hand, PPO’s hyper-parameter sensitivity and training instability paired with the additional complexities and resource requirements involved with training language models, can make it difficult to train. Refer to
     <a class="ltx_ref" href="#A6.SS2" title="F.2 PPO Details ‣ Appendix F Baseline Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Section
      </span>
      <span class="ltx_text ltx_ref_tag">
       F.2
      </span>
     </a>
     on PPO implementation and training details.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S6.SS0.SSS0.Px3">
   <h5 class="ltx_title ltx_title_paragraph">
    ILQL vs. MC Returns.
   </h5>
   <div class="ltx_para" id="S6.SS0.SSS0.Px3.p1">
    <p class="ltx_p" id="S6.SS0.SSS0.Px3.p1.1">
     Among the offline methods, ILQL has the potential to be a much more capable algorithm than MC Returns
     <em class="ltx_emph ltx_font_italic" id="S6.SS0.SSS0.Px3.p1.1.1">
      in principle
     </em>
     , because of the use of Bellman backups to estimate the Q-function instead, enabling multiple steps of policy improvement, rather than the single-step of improvement performed by MC. Empirically, we see these advantages of ILQL realized on the Maze, Text-Nav, and Wordle tasks, where it outperforms MC. However, on the Endgames, 20Qs, Guess My City and Car Dealer tasks, ILQL falls short of MC. In summary, the simpler MC Returns method performs better on tasks with more complex text, perhaps because it is harder to scale full TD-learning in these settings. Overall, this demonstrates that there is still much room for improvement in terms of developing better TD-based RL methods for LLMs.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S6.SS0.SSS0.Px4">
   <h5 class="ltx_title ltx_title_paragraph">
    Partial Observability.
   </h5>
   <div class="ltx_para" id="S6.SS0.SSS0.Px4.p1">
    <p class="ltx_p" id="S6.SS0.SSS0.Px4.p1.1">
     Partial observability posed a challenge for all of the algorithms. We observed a drop in normalized performance for every algorithm between partially observed and fully observed versions of Maze and Text-Nav tasks. In partially observed settings, the model needs to infer the state and take information-seeking actions to help deduce it. The difference in performance between fully and partially observed tasks illustrates this additional challenge and highlights the necessity for developing LM RL algorithms that can effectively handle partial observability.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="S6.SS0.SSS0.Px5">
   <h5 class="ltx_title ltx_title_paragraph">
    Prompting GPT-4 vs. RL Finetuning.
   </h5>
   <div class="ltx_para" id="S6.SS0.SSS0.Px5.p1">
    <p class="ltx_p" id="S6.SS0.SSS0.Px5.p1.1">
     We found that GPT-4 with prompting was not able to outperform RL Finetuning baselines on most of the tasks. This could be because 1) task data and training data for GPT4 are significantly different distributions 2) GPT4’s training objective does not satisfy the RL Capabilities such as trajectory stitching or credit assignment. Two notable exceptions to this rule are the 20Qs and Guess My City tasks. This is most likely because the dataset used to train the simulator for these tasks was originally generated by GPT3.5.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S6.SS0.SSS0.Px5.p2">
    <p class="ltx_p" id="S6.SS0.SSS0.Px5.p2.1">
     In summary, we can see that RL algorithms consistently outperformed filtered BC and prompting on many of the tasks. However, these results highlight significant areas for growth. For example, the instabilities observed in training PPO require further investigation beyond hyperparameter tuning. Moreover, the performance discrepancy between ILQL and the simpler MC Returns highlights that scaling full TD-learning to Interactive Dialogue settings is another area for improvement.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S7" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    7
   </span>
   Discussion
  </h2>
  <div class="ltx_para" id="S7.p1">
   <p class="ltx_p" id="S7.p1.1">
    In this work, we have proposed
    <span class="ltx_ERROR undefined" id="S7.p1.1.1">
     \bmname
    </span>
    , consisting of
    <span class="ltx_ERROR undefined" id="S7.p1.1.2">
     \numtasks
    </span>
    tasks ranging from simple navigation (Maze) to strategy games (Chess) to negotiation (Car Dealer). Additionally, we provide a research toolkit for practitioners to get started with multi-turn RL for LLMs. By providing online simulators and offline datasets for training and evaluation, our objective is to make it possible for RL algorithm researchers to iterate and advance the development of more effective methods for language-based, multi-turn interaction tasks. This includes enabling core capabilities in LLMs through RL to perform complex decision making, complex conversational interactions, credit assignment, and trajectory stitching. Our evaluation shows the promise of RL in several tasks, with further room for improvement with a push for better methods. We acknowledge several limitations when designing tasks in our benchmark, including primarily leveraging smaller GPT-based LLMs to generate datasets and finetune our LLM-based simulators. While we have primarily trained and evaluated models with a maximum 1.5B parameters, we have maintained a lower parameter count to ensure accessibility for researchers with limited computational resources. We have released all of our code and datasets as noted in
    <a class="ltx_ref" href="#S5" title="5 LMRL Research Framework for Algorithm Development ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Section
     </span>
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    . In addition, we share all of the hyperparameters we used to train our models in
    <a class="ltx_ref" href="#A4" title="Appendix D Hyperparameters for All Tasks ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Appendix
     </span>
     <span class="ltx_text ltx_ref_tag">
      D
     </span>
    </a>
    and provide more in-depth insight into our results, training procedure, and evaluation in
    <a class="ltx_ref" href="#A5" title="Appendix E Evaluation Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Appendix
     </span>
     <span class="ltx_text ltx_ref_tag">
      E
     </span>
    </a>
    .
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S8" lang="en">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    8
   </span>
   Ethics Statement
  </h2>
  <div class="ltx_para" id="S8.p1">
   <p class="ltx_p" id="S8.p1.1">
    This work aims to develop a benchmark for the advancement of research in reinforcement learning and LLMs. We generate datasets for tasks in our benchmark with existing LLMs for dialog tasks and online engines for text games, adhering to best practices in data handling and ensuring there is no personally identifiable or sensitive information present in the generated datasets. We recognize that there may be biases present in the datasets we collect, and have taken steps to ensure a diverse and varied collection of responses from LLMs for our conversational task as detailed in our data generation process in
    <a class="ltx_ref" href="#A3" title="Appendix C Dataset Generation, Statistics, &amp; Rewards ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Appendix
     </span>
     <span class="ltx_text ltx_ref_tag">
      C
     </span>
    </a>
    . Finally, we open-source our datasets, simulators, and code for our research framework in order for our research to be verifiable and reproducible.
    <br class="ltx_break"/>
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S8.p2">
   <p class="ltx_p" id="S8.p2.1">
    In considering the social and ethical implications of interactive RL, we acknowledge and recognize the dual use implication of this research, particularly centered around developing LLM simulators that could perform persuasion, manipulation, and addictive engagement of users at a large scale. The optimization processes employed by such algorithms, which aim to maximize certain objectives, raise ethical considerations when the optimized outcomes may prioritize system goals over user safety and alignment to human values. We have designed our datasets and reward functions such that prioritize fairness and human-aligned outcomes. By incorporating these considerations when designing our framework, we aim to encourage the development of reinforcement learning models and LLMs that not only excel in performance but also adhere to ethical standards, mitigating the potential for undue persuasion or manipulation.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="Sx1" lang="en">
  <h2 class="ltx_title ltx_title_section">
   Acknowledgments
  </h2>
  <div class="ltx_para" id="Sx1.p1">
   <p class="ltx_p" id="Sx1.p1.1">
    This research was partially supported by Berkeley DeepDrive, the Cooperative AI Foundation, and the National Science Foundation.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib" lang="en">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Anthropic [2023]
    </span>
    <span class="ltx_bibblock">
     Anthropic.
    </span>
    <span class="ltx_bibblock">
     Introducing claude, 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.anthropic.com/index/introducing-claude" target="_blank" title="">
      https://www.anthropic.com/index/introducing-claude
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bai et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova DasSarma, Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, Nicholas Joseph, Saurav Kadavath, Jackson Kernion, Tom Conerly, Sheer El-Showk, Nelson Elhage, Zac Hatfield-Dodds, Danny Hernandez, Tristan Hume, Scott Johnston, Shauna Kravec, Liane Lovitt, Neel Nanda, Catherine Olsson, Dario Amodei, Tom Brown, Jack Clark, Sam McCandlish, Chris Olah, Ben Mann, and Jared Kaplan.
    </span>
    <span class="ltx_bibblock">
     Training a helpful and harmless assistant with reinforcement learning from human feedback, 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bai et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Yuntao Bai, Saurav Kadavath, Sandipan Kundu, Amanda Askell, Jackson Kernion, Andy Jones, Anna Chen, Anna Goldie, Azalia Mirhoseini, Cameron McKinnon, Carol Chen, Catherine Olsson, Christopher Olah, Danny Hernandez, Dawn Drain, Deep Ganguli, Dustin Li, Eli Tran-Johnson, Ethan Perez, Jamie Kerr, Jared Mueller, Jeffrey Ladish, Joshua Landau, Kamal Ndousse, Kamile Lukosuite, Liane Lovitt, Michael Sellitto, Nelson Elhage, Nicholas Schiefer, Noemi Mercado, Nova DasSarma, Robert Lasenby, Robin Larson, Sam Ringer, Scott Johnston, Shauna Kravec, Sheer El Showk, Stanislav Fort, Tamera Lanham, Timothy Telleen-Lawton, Tom Conerly, Tom Henighan, Tristan Hume, Samuel R. Bowman, Zac Hatfield-Dodds, Ben Mann, Dario Amodei, Nicholas Joseph, Sam McCandlish, Tom Brown, and Jared Kaplan.
    </span>
    <span class="ltx_bibblock">
     Constitutional ai: Harmlessness from ai feedback, 2022b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Böhm et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Florian Böhm, Yang Gao, Christian M. Meyer, Ori Shapira, Ido Dagan, and Iryna Gurevych.
    </span>
    <span class="ltx_bibblock">
     Better rewards yield better summaries: Learning to summarise without references.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)
     </em>
     , pages 3110–3120, Hong Kong, China, November 2019. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.18653/v1/D19-1307" target="_blank" title="">
      10.18653/v1/D19-1307
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D19-1307" target="_blank" title="">
      https://aclanthology.org/D19-1307
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bojar et al. [2016]
    </span>
    <span class="ltx_bibblock">
     Ond rej Bojar, Rajen Chatterjee, Christian Federmann, Yvette Graham, Barry Haddow, Matthias Huck, Antonio Jimeno Yepes, Philipp Koehn, Varvara Logacheva, Christof Monz, Matteo Negri, Aurelie Neveol, Mariana Neves, Martin Popel, Matt Post, Raphael Rubino, Carolina Scarton, Lucia Specia, Marco Turchi, Karin Verspoor, and Marcos Zampieri.
    </span>
    <span class="ltx_bibblock">
     Findings of the 2016 conference on machine translation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      Proceedings of the First Conference on Machine Translation
     </em>
     , pages 131–198, Berlin, Germany, August 2016. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.aclweb.org/anthology/W/W16/W16-2301" target="_blank" title="">
      http://www.aclweb.org/anthology/W/W16/W16-2301
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Brown et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.
    </span>
    <span class="ltx_bibblock">
     Language models are few-shot learners, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Carta et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Thomas Carta, Clément Romac, Thomas Wolf, Sylvain Lamprier, Olivier Sigaud, and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Grounding large language models in interactive environments with online reinforcement learning, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Casper et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Stephen Casper, Xander Davies, Claudia Shi, Thomas Krendl Gilbert, Jérémy Scheurer, Javier Rando, Rachel Freedman, Tomasz Korbak, David Lindner, Pedro Freire, Tony Wang, Samuel Marks, Charbel-Raphaël Segerie, Micah Carroll, Andi Peng, Phillip Christoffersen, Mehul Damani, Stewart Slocum, Usman Anwar, Anand Siththaranjan, Max Nadeau, Eric J. Michaud, Jacob Pfau, Dmitrii Krasheninnikov, Xin Chen, Lauro Langosco, Peter Hase, Erdem Bıyık, Anca Dragan, David Krueger, Dorsa Sadigh, and Dylan Hadfield-Menell.
    </span>
    <span class="ltx_bibblock">
     Open problems and fundamental limitations of reinforcement learning from human feedback, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Castricato et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Louis Castricato, Alex Havrilla, Shahbuland Matiana, Duy V. Phung, Aman Tiwari, Jonathan Tow, and Maksym Zhuravinsky.
    </span>
    <span class="ltx_bibblock">
     trlX: A scalable framework for RLHF, June 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/CarperAI/trlx" target="_blank" title="">
      https://github.com/CarperAI/trlx
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Mark Chen, Jerry Tworek, Heewoo Jun, Qiming Yuan, Henrique Ponde de Oliveira Pinto, Jared Kaplan, Harri Edwards, Yuri Burda, Nicholas Joseph, Greg Brockman, Alex Ray, Raul Puri, Gretchen Krueger, Michael Petrov, Heidy Khlaaf, Girish Sastry, Pamela Mishkin, Brooke Chan, Scott Gray, Nick Ryder, Mikhail Pavlov, Alethea Power, Lukasz Kaiser, Mohammad Bavarian, Clemens Winter, Philippe Tillet, Felipe Petroski Such, Dave Cummings, Matthias Plappert, Fotios Chantzis, Elizabeth Barnes, Ariel Herbert-Voss, William Hebgen Guss, Alex Nichol, Alex Paino, Nikolas Tezak, Jie Tang, Igor Babuschkin, Suchir Balaji, Shantanu Jain, William Saunders, Christopher Hesse, Andrew N. Carr, Jan Leike, Josh Achiam, Vedant Misra, Evan Morikawa, Alec Radford, Matthew Knight, Miles Brundage, Mira Murati, Katie Mayer, Peter Welinder, Bob McGrew, Dario Amodei, Sam McCandlish, Ilya Sutskever, and Wojciech Zaremba.
    </span>
    <span class="ltx_bibblock">
     Evaluating large language models trained on code, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Christiano et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Paul Christiano, Jan Leike, Tom B. Brown, Miljan Martic, Shane Legg, and Dario Amodei.
    </span>
    <span class="ltx_bibblock">
     Deep reinforcement learning from human preferences, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cobbe et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, et al.
    </span>
    <span class="ltx_bibblock">
     Training verifiers to solve math word problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      arXiv preprint arXiv:2110.14168
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Côté et al. [2018]
    </span>
    <span class="ltx_bibblock">
     Marc-Alexandre Côté, Ákos Kádár, Xingdi Yuan, Ben Kybartas, Tavian Barnes, Emery Fine, James Moore, Matthew J. Hausknecht, Layla El Asri, Mahmoud Adada, Wendy Tay, and Adam Trischler.
    </span>
    <span class="ltx_bibblock">
     Textworld: A learning environment for text-based games.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      CoRR
     </em>
     , abs/1806.11532, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cuayáhuitl et al. [2015]
    </span>
    <span class="ltx_bibblock">
     Heriberto Cuayáhuitl, Simon Keizer, and Oliver Lemon.
    </span>
    <span class="ltx_bibblock">
     Strategic dialogue management via deep reinforcement learning, 2015.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [15]
    </span>
    <span class="ltx_bibblock">
     Meta Fundamental AI Research Diplomacy Team (FAIR)†, Anton Bakhtin, Noam Brown, Emily Dinan, Gabriele Farina, Colin Flaherty, Daniel Fried, Andrew Goff, Jonathan Gray, Hengyuan Hu, Athul Paul Jacob, Mojtaba Komeili, Karthik Konath, Minae Kwon, Adam Lerer, Mike Lewis, Alexander H. Miller, Sasha Mitts, Adithya Renduchintala, Stephen Roller, Dirk Rowe, Weiyan Shi, Joe Spisak, Alexander Wei, David Wu, Hugh Zhang, and Markus Zijlstra.
    </span>
    <span class="ltx_bibblock">
     Human-level play in the game of &lt;i&gt;diplomacy&lt;/i&gt; by combining language models with strategic reasoning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      Science
     </em>
     , 378(6624):1067–1074, 2022.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.1126/science.ade9097" target="_blank" title="">
      10.1126/science.ade9097
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.science.org/doi/abs/10.1126/science.ade9097" target="_blank" title="">
      https://www.science.org/doi/abs/10.1126/science.ade9097
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Georgila and Traum [2011]
    </span>
    <span class="ltx_bibblock">
     Kallirroi Georgila and David Traum.
    </span>
    <span class="ltx_bibblock">
     Reinforcement learning of argumentation dialogue policies in negotiation.
    </span>
    <span class="ltx_bibblock">
     pages 2073–2076, 08 2011.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.21437/Interspeech.2011-544" target="_blank" title="">
      10.21437/Interspeech.2011-544
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ghazvininejad et al. [2017]
    </span>
    <span class="ltx_bibblock">
     Marjan Ghazvininejad, Xing Shi, Jay Priyadarshi, and Kevin Knight.
    </span>
    <span class="ltx_bibblock">
     Hafez: an interactive poetry generation system.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      Proceedings of ACL 2017, System Demonstrations
     </em>
     , pages 43–48, Vancouver, Canada, July 2017. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P17-4008" target="_blank" title="">
      https://aclanthology.org/P17-4008
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Google [2023]
    </span>
    <span class="ltx_bibblock">
     Google.
    </span>
    <span class="ltx_bibblock">
     Bard, 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://bard.google.com/." target="_blank" title="">
      https://bard.google.com/.
     </a>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gu et al. [2017]
    </span>
    <span class="ltx_bibblock">
     Jiatao Gu, Kyunghyun Cho, and Victor O.K. Li.
    </span>
    <span class="ltx_bibblock">
     Trainable greedy decoding for neural machine translation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">
      Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing
     </em>
     , pages 1968–1978, Copenhagen, Denmark, September 2017. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.18653/v1/D17-1210" target="_blank" title="">
      10.18653/v1/D17-1210
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D17-1210" target="_blank" title="">
      https://aclanthology.org/D17-1210
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hausknecht et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Matthew Hausknecht, Prithviraj Ammanabrolu, Côté Marc-Alexandre, and Yuan Xingdi.
    </span>
    <span class="ltx_bibblock">
     Interactive fiction games: A colossal adventure.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      CoRR
     </em>
     , abs/1909.05398, 2019.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1909.05398" target="_blank" title="">
      http://arxiv.org/abs/1909.05398
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     He et al. [2018]
    </span>
    <span class="ltx_bibblock">
     He He, Derek Chen, Anusha Balakrishnan, and Percy Liang.
    </span>
    <span class="ltx_bibblock">
     Decoupling strategy and generation in negotiation dialogues, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hendrycks et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.
    </span>
    <span class="ltx_bibblock">
     Measuring massive multitask language understanding.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      arXiv preprint arXiv:2009.03300
     </em>
     , 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hendrycks et al. [2021a]
    </span>
    <span class="ltx_bibblock">
     Dan Hendrycks, Collin Burns, Saurav Kadavath, Akul Arora, Steven Basart, Eric Tang, Dawn Song, and Jacob Steinhardt.
    </span>
    <span class="ltx_bibblock">
     Measuring mathematical problem solving with the math dataset.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      arXiv preprint arXiv:2103.03874
     </em>
     , 2021a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hendrycks et al. [2021b]
    </span>
    <span class="ltx_bibblock">
     Dan Hendrycks, Mantas Mazeika, Andy Zou, Sahil Patel, Christine Zhu, Jesus Navarro, Dawn Song, Bo Li, and Jacob Steinhardt.
    </span>
    <span class="ltx_bibblock">
     What would jiminy cricket do? towards agents that behave morally.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      NeurIPS
     </em>
     , 2021b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Irvine et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Robert Irvine, Douglas Boubert, Vyas Raina, Adian Liusie, Vineet Mudupalli, Aliaksei Korshuk, Zongyi Liu, Fritz Cremer, Valentin Assassi, Christie-Carol Beauchamp, et al.
    </span>
    <span class="ltx_bibblock">
     Rewarding chatbots for real-world engagement with millions of users.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      arXiv preprint arXiv:2303.06135
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jang et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Youngsoo Jang, Jongmin Lee, and Kee-Eung Kim.
    </span>
    <span class="ltx_bibblock">
     GPT-critic: Offline reinforcement learning for end-to-end task-oriented dialogue systems.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      International Conference on Learning Representations
     </em>
     , 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=qaxhBG1UUaS" target="_blank" title="">
      https://openreview.net/forum?id=qaxhBG1UUaS
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jaques et al. [2020]
    </span>
    <span class="ltx_bibblock">
     N. Jaques, J. H. Shen, A. Ghandeharioun, C. Ferguson, A. Lapedriza, N. Jones, S. Gu, and R. Picard.
    </span>
    <span class="ltx_bibblock">
     Human-centric dialog training via offline reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">
      Empirical Methods in Natural Language Processing (EMNLP)
     </em>
     , 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jaques et al. [2017]
    </span>
    <span class="ltx_bibblock">
     Natasha Jaques, Shixiang Gu, Dzmitry Bahdanau, José Miguel Hernández-Lobato, Richard E. Turner, and Douglas Eck.
    </span>
    <span class="ltx_bibblock">
     Sequence tutor: Conservative fine-tuning of sequence generation models with KL-control.
    </span>
    <span class="ltx_bibblock">
     In Doina Precup and Yee Whye Teh, editors,
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">
      Proceedings of the 34th International Conference on Machine Learning
     </em>
     , volume 70 of
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.2.2">
      Proceedings of Machine Learning Research
     </em>
     , pages 1645–1654. PMLR, 06–11 Aug 2017.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v70/jaques17a.html" target="_blank" title="">
      https://proceedings.mlr.press/v70/jaques17a.html
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kiegeland and Kreutzer [2021]
    </span>
    <span class="ltx_bibblock">
     Samuel Kiegeland and Julia Kreutzer.
    </span>
    <span class="ltx_bibblock">
     Revisiting the weaknesses of reinforcement learning for neural machine translation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies
     </em>
     , pages 1673–1681, Online, June 2021. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.18653/v1/2021.naacl-main.133" target="_blank" title="">
      10.18653/v1/2021.naacl-main.133
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.naacl-main.133" target="_blank" title="">
      https://aclanthology.org/2021.naacl-main.133
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kostrikov et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Ilya Kostrikov, Ashvin Nair, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Offline reinforcement learning with implicit q-learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      arXiv preprint arXiv:2110.06169
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kwan et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Wai-Chung Kwan, Hongru Wang, Huimin Wang, and Kam-Fai Wong.
    </span>
    <span class="ltx_bibblock">
     A survey on recent advances and challenges in reinforcement learning methods for task-oriented dialogue policy learning, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lewis et al. [2017]
    </span>
    <span class="ltx_bibblock">
     Mike Lewis, Denis Yarats, Yann N. Dauphin, Devi Parikh, and Dhruv Batra.
    </span>
    <span class="ltx_bibblock">
     Deal or no deal? end-to-end learning for negotiation dialogues, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. [2016]
    </span>
    <span class="ltx_bibblock">
     Jiwei Li, Will Monroe, Alan Ritter, Michel Galley, Jianfeng Gao, and Dan Jurafsky.
    </span>
    <span class="ltx_bibblock">
     Deep reinforcement learning for dialogue generation, 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Marcus et al. [1993]
    </span>
    <span class="ltx_bibblock">
     Mitchell P Marcus, Mary Ann Marcinkiewicz, and Beatrice Santorini.
    </span>
    <span class="ltx_bibblock">
     Building a large annotated corpus of english: The penn treebank.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">
      Computational Linguistics
     </em>
     , 19(2):313–330, 1993.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Mishra et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Swaroop Mishra, Daniel Khashabi, Chitta Baral, and Hannaneh Hajishirzi.
    </span>
    <span class="ltx_bibblock">
     Cross-task generalization via natural language crowdsourcing instructions.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      ACL
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Nakamoto et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Mitsuhiko Nakamoto, Yuexiang Zhai, Anikait Singh, Max Sobol Mark, Yi Ma, Chelsea Finn, Aviral Kumar, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Cal-ql: Calibrated offline rl pre-training for efficient online fine-tuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">
      arXiv preprint arXiv:2303.05479
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Narasimhan et al. [2015]
    </span>
    <span class="ltx_bibblock">
     Karthik Narasimhan, Tejas Kulkarni, and Regina Barzilay.
    </span>
    <span class="ltx_bibblock">
     Language understanding for text-based games using deep reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing
     </em>
     , pages 1–11, Lisbon, Portugal, September 2015. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.18653/v1/D15-1001" target="_blank" title="">
      10.18653/v1/D15-1001
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D15-1001" target="_blank" title="">
      https://aclanthology.org/D15-1001
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Nguyen et al. [2017]
    </span>
    <span class="ltx_bibblock">
     Khanh Nguyen, Hal Daumé III, and Jordan Boyd-Graber.
    </span>
    <span class="ltx_bibblock">
     Reinforcement learning for bandit neural machine translation with simulated human feedback.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing
     </em>
     , pages 1464–1474, Copenhagen, Denmark, September 2017. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.18653/v1/D17-1153" target="_blank" title="">
      10.18653/v1/D17-1153
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D17-1153" target="_blank" title="">
      https://aclanthology.org/D17-1153
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI [2022]
    </span>
    <span class="ltx_bibblock">
     OpenAI.
    </span>
    <span class="ltx_bibblock">
     Chatgpt, 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/blog/chatgpt" target="_blank" title="">
      https://openai.com/blog/chatgpt
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI [2023]
    </span>
    <span class="ltx_bibblock">
     OpenAI.
    </span>
    <span class="ltx_bibblock">
     Gpt-4, 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/research/gpt-4" target="_blank" title="">
      https://openai.com/research/gpt-4
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul Christiano, Jan Leike, and Ryan Lowe.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions with human feedback, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Pang and He [2021]
    </span>
    <span class="ltx_bibblock">
     Richard Yuanzhe Pang and He He.
    </span>
    <span class="ltx_bibblock">
     Text generation by learning from demonstrations.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">
      International Conference on Learning Representations
     </em>
     , 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=RovX-uQ1Hua" target="_blank" title="">
      https://openreview.net/forum?id=RovX-uQ1Hua
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Park et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Joon Sung Park, Joseph C. O’Brien, Carrie J. Cai, Meredith Ringel Morris, Percy Liang, and Michael S. Bernstein.
    </span>
    <span class="ltx_bibblock">
     Generative agents: Interactive simulacra of human behavior, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Paulus et al. [2017]
    </span>
    <span class="ltx_bibblock">
     Romain Paulus, Caiming Xiong, and Richard Socher.
    </span>
    <span class="ltx_bibblock">
     A deep reinforced model for abstractive summarization, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Pyatkin et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Valentina Pyatkin, Jena D. Hwang, Vivek Srikumar, Ximing Lu, Liwei Jiang, Yejin Choi, and Chandra Bhagavatula.
    </span>
    <span class="ltx_bibblock">
     Reinforced clarification question generation with defeasibility rewards for disambiguating social and moral situations, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Qin et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Yujia Qin, Shengding Hu, Yankai Lin, Weize Chen, Ning Ding, Ganqu Cui, Zheni Zeng, Yufei Huang, Chaojun Xiao, Chi Han, et al.
    </span>
    <span class="ltx_bibblock">
     Tool learning with foundation models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">
      arXiv preprint arXiv:2304.08354
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Radford et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.
    </span>
    <span class="ltx_bibblock">
     Language models are unsupervised multitask learners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">
      OpenAI blog
     </em>
     , 1(8):9, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Rajpurkar et al. [2016]
    </span>
    <span class="ltx_bibblock">
     Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang.
    </span>
    <span class="ltx_bibblock">
     Squad: 100,000+ questions for machine comprehension of text.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">
      arXiv preprint arXiv:1606.05250
     </em>
     , 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ramamurthy et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Rajkumar Ramamurthy, Prithviraj Ammanabrolu, Kianté Brantley, Jack Hessel, Rafet Sifa, Christian Bauckhage, Hannaneh Hajishirzi, and Yejin Choi.
    </span>
    <span class="ltx_bibblock">
     Is reinforcement learning (not) for natural language processing: Benchmarks, baselines, and building blocks for natural language policy optimization.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">
      The Eleventh International Conference on Learning Representations
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=8aHzds2uUyB" target="_blank" title="">
      https://openreview.net/forum?id=8aHzds2uUyB
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schulman et al. [2017]
    </span>
    <span class="ltx_bibblock">
     John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Proximal policy optimization algorithms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">
      arXiv preprint arXiv:1707.06347
     </em>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schulman et al. [2018]
    </span>
    <span class="ltx_bibblock">
     John Schulman, Philipp Moritz, Sergey Levine, Michael Jordan, and Pieter Abbeel.
    </span>
    <span class="ltx_bibblock">
     High-dimensional continuous control using generalized advantage estimation, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shah et al. [2016]
    </span>
    <span class="ltx_bibblock">
     Pararth Shah, Dilek Hakkani-Tur, and Larry Heck.
    </span>
    <span class="ltx_bibblock">
     Interactive reinforcement learning for task-oriented dialogue management.
    </span>
    <span class="ltx_bibblock">
     2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shuster et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Kurt Shuster, Mojtaba Komeili, Leonard Adolphs, Stephen Roller, Arthur Szlam, and Jason Weston.
    </span>
    <span class="ltx_bibblock">
     Language models that seek for knowledge: Modular search &amp; generation for dialogue and prompt completion, 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shuster et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Kurt Shuster, Jing Xu, Mojtaba Komeili, Da Ju, Eric Michael Smith, Stephen Roller, Megan Ung, Moya Chen, Kushal Arora, Joshua Lane, Morteza Behrooz, William Ngan, Spencer Poff, Naman Goyal, Arthur Szlam, Y-Lan Boureau, Melanie Kambadur, and Browser assisted question-answering with human feedbackJason Weston.
    </span>
    <span class="ltx_bibblock">
     Blenderbot 3: a deployed conversational agent that continually learns to responsibly engage, 2022b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Singh et al. [1999]
    </span>
    <span class="ltx_bibblock">
     Satinder Singh, Michael Kearns, Diane Litman, and Marilyn Walker.
    </span>
    <span class="ltx_bibblock">
     Reinforcement learning for spoken dialogue systems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">
      Advances in neural information processing systems
     </em>
     , 12, 1999.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Snell et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Charlie Snell, Ilya Kostrikov, Yi Su, Mengjiao Yang, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Offline rl for natural language generation with implicit language q learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">
      arXiv preprint arXiv:2206.11871
     </em>
     , 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Snell et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Charlie Snell, Sherry Yang, Justin Fu, Yi Su, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Context-aware language modeling for goal-oriented dialogue systems.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">
      Findings of the Association for Computational Linguistics: NAACL 2022
     </em>
     , pages 2351–2366, Seattle, United States, July 2022b. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.18653/v1/2022.findings-naacl.181" target="_blank" title="">
      10.18653/v1/2022.findings-naacl.181
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.findings-naacl.181" target="_blank" title="">
      https://aclanthology.org/2022.findings-naacl.181
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Socher et al. [2013]
    </span>
    <span class="ltx_bibblock">
     Richard Socher, Alex Perelygin, Jean Y Wu, Jason Chuang, Christopher D Manning, Andrew Ng, and Christopher Potts.
    </span>
    <span class="ltx_bibblock">
     Recursive deep models for semantic compositionality over a sentiment treebank.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">
      Proceedings of the 2013 conference on empirical methods in natural language processing
     </em>
     , pages 1631–1642, 2013.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Stiennon et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Nisan Stiennon, Long Ouyang, Jeffrey Wu, Daniel Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul F Christiano.
    </span>
    <span class="ltx_bibblock">
     Learning to summarize with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 33:3008–3021, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Stiennon et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Nisan Stiennon, Long Ouyang, Jeff Wu, Daniel M. Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul Christiano.
    </span>
    <span class="ltx_bibblock">
     Learning to summarize from human feedback, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sutton and Barto [2018]
    </span>
    <span class="ltx_bibblock">
     Richard S Sutton and Andrew G Barto.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">
      Reinforcement learning: An introduction
     </em>
     .
    </span>
    <span class="ltx_bibblock">
     MIT press, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib62">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Tambwekar et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Pradyumna Tambwekar, Murtaza Dhuliawala, Lara J. Martin, Animesh Mehta, Brent Harrison, and Mark O. Riedl.
    </span>
    <span class="ltx_bibblock">
     Controllable neural story plot generation via reward shaping.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">
      Proceedings of the Twenty-Eighth International Joint Conference on Artificial Intelligence
     </em>
     . International Joint Conferences on Artificial Intelligence Organization, aug 2019.
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref" href="https:/doi.org/10.24963/ijcai.2019/829" target="_blank" title="">
      10.24963/ijcai.2019/829
     </a>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.24963%2Fijcai.2019%2F829" target="_blank" title="">
      https://doi.org/10.24963%2Fijcai.2019%2F829
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib63">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Tiedemann [2012]
    </span>
    <span class="ltx_bibblock">
     Jörg Tiedemann.
    </span>
    <span class="ltx_bibblock">
     Parallel data, tools and interfaces in OPUS.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">
      Proceedings of the Eighth International Conference on Language Resources and Evaluation (LREC’12)
     </em>
     , pages 2214–2218, Istanbul, Turkey, May 2012. European Language Resources Association (ELRA).
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.lrec-conf.org/proceedings/lrec2012/pdf/463_Paper.pdf" target="_blank" title="">
      http://www.lrec-conf.org/proceedings/lrec2012/pdf/463_Paper.pdf
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib64">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Tjong Kim Sang and De Meulder [2003]
    </span>
    <span class="ltx_bibblock">
     Erik F Tjong Kim Sang and Fien De Meulder.
    </span>
    <span class="ltx_bibblock">
     Introduction to the conll-2003 shared task: Language-independent named entity recognition.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">
      Proceedings of the seventh conference on Natural language learning at HLT-NAACL 2003
     </em>
     , volume 4, pages 142–147, 2003.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib65">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas
Scialom.
    </span>
    <span class="ltx_bibblock">
     Llama 2: Open foundation and fine-tuned chat models, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib66">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Verma et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Siddharth Verma, Justin Fu, Mengjiao Yang, and Sergey Levine.
    </span>
    <span class="ltx_bibblock">
     Chai: A chatbot ai for task-oriented dialogue with offline reinforcement learning, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib67">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Völske et al. [2017]
    </span>
    <span class="ltx_bibblock">
     Michael Völske, Martin Potthast, Shahbaz Syed, and Benno Stein.
    </span>
    <span class="ltx_bibblock">
     Tl; dr: Mining reddit to learn automatic summarization.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">
      Proceedings of the Workshop on New Frontiers in Summarization
     </em>
     , pages 59–63, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib68">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2019]
    </span>
    <span class="ltx_bibblock">
     Alex Wang, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel R. Bowman.
    </span>
    <span class="ltx_bibblock">
     GLUE: A multi-task benchmark and analysis platform for natural language understanding.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">
      International Conference on Learning Representations
     </em>
     , 2019.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=rJ4km2R5t7" target="_blank" title="">
      https://openreview.net/forum?id=rJ4km2R5t7
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib69">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022a]
    </span>
    <span class="ltx_bibblock">
     Ruoyao Wang, Peter Jansen, Marc-Alexandre Côté, and Prithviraj Ammanabrolu.
    </span>
    <span class="ltx_bibblock">
     Scienceworld: Is your agent smarter than a 5th grader?
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">
      arXiv preprint arXiv:2203.07540
     </em>
     , 2022a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib70">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2022b]
    </span>
    <span class="ltx_bibblock">
     Yizhong Wang, Swaroop Mishra, Pegah Alipoormolabashi, Yeganeh Kordi, Amirreza Mirzaei, Atharva Naik, Arjun Ashok, Arut Selvan Dhanasekaran, Anjana Arunkumar, David Stap, et al.
    </span>
    <span class="ltx_bibblock">
     Super-naturalinstructions: Generalization via declarative instructions on 1600+ nlp tasks.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">
      Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing
     </em>
     , pages 5085–5109, 2022b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib71">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Yue Wang, Hung Le, Akhilesh Deepak Gotmare, Nghi D. Q. Bui, Junnan Li, and Steven C. H. Hoi.
    </span>
    <span class="ltx_bibblock">
     Codet5+: Open code large language models for code understanding and generation, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib72">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. [2022]
    </span>
    <span class="ltx_bibblock">
     Jason Wei, Maarten Bosma, Vincent Y. Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M. Dai, and Quoc V. Le.
    </span>
    <span class="ltx_bibblock">
     Finetuned language models are zero-shot learners, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib73">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Williams et al. [2018]
    </span>
    <span class="ltx_bibblock">
     Adina Williams, Nikita Nangia, and Samuel Bowman.
    </span>
    <span class="ltx_bibblock">
     A broad-coverage challenge corpus for sentence understanding through inference.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">
      arXiv preprint arXiv:1804.08198
     </em>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib74">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. [2021]
    </span>
    <span class="ltx_bibblock">
     Jeff Wu, Long Ouyang, Daniel M Ziegler, Nisan Stiennon, Ryan Lowe, Jan Leike, and Paul Christiano.
    </span>
    <span class="ltx_bibblock">
     Recursively summarizing books with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">
      arXiv preprint arXiv:2109.10862
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib75">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. [2016]
    </span>
    <span class="ltx_bibblock">
     Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V. Le, Mohammad Norouzi, Wolfgang Macherey, Maxim Krikun, Yuan Cao, Qin Gao, Klaus Macherey, Jeff Klingner, Apurva Shah, Melvin Johnson, Xiaobing Liu, Łukasz Kaiser, Stephan Gouws, Yoshikiyo Kato, Taku Kudo, Hideto Kazawa, Keith Stevens, George Kurian, Nishant Patil, Wei Wang, Cliff Young, Jason Smith, Jason Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado, Macduff Hughes, and Jeffrey Dean.
    </span>
    <span class="ltx_bibblock">
     Google’s neural machine translation system: Bridging the gap between human and machine translation, 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib76">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu and Hu [2018]
    </span>
    <span class="ltx_bibblock">
     Yuxiang Wu and Baotian Hu.
    </span>
    <span class="ltx_bibblock">
     Learning to extract coherent summary via deep reinforcement learning, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib77">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yao et al. [2023]
    </span>
    <span class="ltx_bibblock">
     Shunyu Yao, Howard Chen, John Yang, and Karthik Narasimhan.
    </span>
    <span class="ltx_bibblock">
     Webshop: Towards scalable real-world web interaction with grounded language agents, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib78">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ziegler et al. [2020]
    </span>
    <span class="ltx_bibblock">
     Daniel M. Ziegler, Nisan Stiennon, Jeffrey Wu, Tom B. Brown, Alec Radford, Dario Amodei, Paul Christiano, and Geoffrey Irving.
    </span>
    <span class="ltx_bibblock">
     Fine-tuning language models from human preferences, 2020.
    </span>
   </li>
  </ul>
 </section>
 <section class="ltx_appendix" id="A1" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Further Details on Task Design
  </h2>
  <div class="ltx_para" id="A1.p1">
   <p class="ltx_p" id="A1.p1.1">
    In this appendix, we lay out in more formalism why certain tasks test certain properties and go into more detail underlying the interactions involved in each task. We discuss both the RL Capability Tests and the Interactive Dialogue Tasks.
   </p>
  </div>
  <section class="ltx_subsection" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1
    </span>
    RL Capability Tests
   </h3>
   <div class="ltx_para" id="A1.SS1.p1">
    <p class="ltx_p" id="A1.SS1.p1.1">
     The 5 RL Capability tasks are chosen such that they highlight specific properties. For example, for each of the Maze and Text-Nav tasks we include a partially observed and fully observed version to highlight this contrast. We include both the Maze and Text-Nav because they are very similar tasks but are different in that Text-Nav includes more complicated textual descriptions and Maze has a more complicated layout. Similarly, we chose to include Wordle to test strategic decision-making in a partially observed environment. Chess and Endgames test strategic decision-making, but in a fully observed environment and with a more difficult strategy. The Maze, Text-Nav, Chess, and Chess Endgames are all text-based representations of symbolic tasks where RL has shown success.
    </p>
   </div>
   <section class="ltx_paragraph" id="A1.SS1.SSS0.Px1">
    <h5 class="ltx_title ltx_title_paragraph">
     Maze.
    </h5>
    <div class="ltx_para" id="A1.SS1.SSS0.Px1.p1">
     <p class="ltx_p" id="A1.SS1.SSS0.Px1.p1.1">
      We design a maze task and maze-solving dataset to test the credit assignment and trajectory stitching capabilities discussed in
      <a class="ltx_ref" href="#S4.SS1" title="4.1 Evaluating Capabilities Enabled by RL ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        Section
       </span>
       <span class="ltx_text ltx_ref_tag">
        4.1
       </span>
      </a>
      . We test trajectory stitching by including highly suboptimal data. We test credit assignment by restricting the generation of the data such that the only dataset trajectories that reaches the goal start near the goal. We accomplish this by splitting the maze up into symmetrical submazes and restricting all traversed states in a dataset trajectory to a given submaze. The fully observed version of the maze (FO) includes the coordinates in the maze in each state, whereas the partially observed version only includes the history of actions. We design the reward function such that the agent receives a reward of
      <math alttext="-1" class="ltx_Math" display="inline" id="A1.SS1.SSS0.Px1.p1.1.m1.1">
       <semantics id="A1.SS1.SSS0.Px1.p1.1.m1.1a">
        <mrow id="A1.SS1.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">
         <mo id="A1.SS1.SSS0.Px1.p1.1.m1.1.1a" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">
          −
         </mo>
         <mn id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">
          1
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p1.1.m1.1b">
         <apply id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1">
          <minus id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1">
          </minus>
          <cn id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2">
           1
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p1.1.m1.1c">
         -1
        </annotation>
       </semantics>
      </math>
      for non-goal states and 0 for goal states.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="A1.SS1.SSS0.Px2">
    <h5 class="ltx_title ltx_title_paragraph">
     Text-based Navigation (Text-Nav).
    </h5>
    <div class="ltx_para" id="A1.SS1.SSS0.Px2.p1">
     <p class="ltx_p" id="A1.SS1.SSS0.Px2.p1.1">
      We design a text-based game based on navigation in a house environment using a modified version of the TextWorld engine
      <cite class="ltx_cite ltx_citemacro_citep">
       [Côté et al.,
       <a class="ltx_ref" href="#bib.bib13" title="">
        2018
       </a>
       ]
      </cite>
      .
This task tests credit assignment and trajectory stitching like the maze task as well as testing the ability of the agent to parse more complex language, and learn which text is relevant and not relevant to solving the task at hand.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="A1.SS1.SSS0.Px3">
    <h5 class="ltx_title ltx_title_paragraph">
     Wordle.
    </h5>
    <div class="ltx_para" id="A1.SS1.SSS0.Px3.p1">
     <p class="ltx_p" id="A1.SS1.SSS0.Px3.p1.1">
      We use the game of Wordle as a flexible unit-test task for assessing the ability of our language models to execute complex information-seeking behavior in a partially observed setting. In the game Wordle the agent is given at most 6 attempts to guess a hidden 5-letter word. After each guess, the agent is told whether each letter in the guessed word is: 1) in the hidden word and in the right position, 2) in the hidden word but not in the right position, or 3) not in the hidden word. Through this process, each step provides the agent with more information on what the correct word would be and narrows the possible choices for the final word. Since Wordle involves reasoning about words at the level of individual letters, this can induce issues for standard language model tokenizers. Therefore, we represent words as a sequence of space-separated letters, which will cause most standard LM tokenizers to automatically represent each letter as a separate token.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="A1.SS1.SSS0.Px4">
    <h5 class="ltx_title ltx_title_paragraph">
     Chess.
    </h5>
    <div class="ltx_para" id="A1.SS1.SSS0.Px4.p1">
     <p class="ltx_p" id="A1.SS1.SSS0.Px4.p1.1">
      We create a text-based chess task to test the strategic decision-making, credit assignment, and trajectory stitching abilities of an RL algorithm. To generate the data, we have Stockfish 15.1 simulating the agent of various strengths play against another environment Stockfish engine with elo 1200 simulating the environment. This test trajectory stitching, because the agent needs to make good and legal moves in losing positions as well as winning positions.
We use FEN (Forsyth-Edwards Notation) notation to represent the board state at each turn and we utilize the SAN (Short Algebraic Notation) to represent each action, both of which are standard notations used by the chess community.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="A1.SS1.SSS0.Px5">
    <h5 class="ltx_title ltx_title_paragraph">
     Endgames (Theoretical Chess Endgames).
    </h5>
    <div class="ltx_para" id="A1.SS1.SSS0.Px5.p1">
     <p class="ltx_p" id="A1.SS1.SSS0.Px5.p1.3">
      Chess endgames provide a simpler and more goal-directed variation of the chess task. By focusing on the endgame, we encourage algorithms to learn strategy rather than memorizing the opening moves of a chess game. A classic theoretical endgame position consists of a position where the only pieces on the board are the two kings and the queen. Although the board position appears simple, a sequence of carefully calculated moves is required to win. A simpler board state allows language models to make progress without fewer computational resources. We use an
      <math alttext="\epsilon" class="ltx_Math" display="inline" id="A1.SS1.SSS0.Px5.p1.1.m1.1">
       <semantics id="A1.SS1.SSS0.Px5.p1.1.m1.1a">
        <mi id="A1.SS1.SSS0.Px5.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px5.p1.1.m1.1.1.cmml">
         ϵ
        </mi>
        <annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px5.p1.1.m1.1b">
         <ci id="A1.SS1.SSS0.Px5.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px5.p1.1.m1.1.1">
          italic-ϵ
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px5.p1.1.m1.1c">
         \epsilon
        </annotation>
       </semantics>
      </math>
      -greedy dataset generation process, meaning we generate an optimal move with probability
      <math alttext="\epsilon" class="ltx_Math" display="inline" id="A1.SS1.SSS0.Px5.p1.2.m2.1">
       <semantics id="A1.SS1.SSS0.Px5.p1.2.m2.1a">
        <mi id="A1.SS1.SSS0.Px5.p1.2.m2.1.1" xref="A1.SS1.SSS0.Px5.p1.2.m2.1.1.cmml">
         ϵ
        </mi>
        <annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px5.p1.2.m2.1b">
         <ci id="A1.SS1.SSS0.Px5.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS0.Px5.p1.2.m2.1.1">
          italic-ϵ
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px5.p1.2.m2.1c">
         \epsilon
        </annotation>
       </semantics>
      </math>
      and a random move with probability
      <math alttext="1-\epsilon" class="ltx_Math" display="inline" id="A1.SS1.SSS0.Px5.p1.3.m3.1">
       <semantics id="A1.SS1.SSS0.Px5.p1.3.m3.1a">
        <mrow id="A1.SS1.SSS0.Px5.p1.3.m3.1.1" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1.cmml">
         <mn id="A1.SS1.SSS0.Px5.p1.3.m3.1.1.2" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml">
          1
         </mn>
         <mo id="A1.SS1.SSS0.Px5.p1.3.m3.1.1.1" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1.1.cmml">
          −
         </mo>
         <mi id="A1.SS1.SSS0.Px5.p1.3.m3.1.1.3" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml">
          ϵ
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px5.p1.3.m3.1b">
         <apply id="A1.SS1.SSS0.Px5.p1.3.m3.1.1.cmml" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1">
          <minus id="A1.SS1.SSS0.Px5.p1.3.m3.1.1.1.cmml" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1.1">
          </minus>
          <cn id="A1.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml" type="integer" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1.2">
           1
          </cn>
          <ci id="A1.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml" xref="A1.SS1.SSS0.Px5.p1.3.m3.1.1.3">
           italic-ϵ
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px5.p1.3.m3.1c">
         1-\epsilon
        </annotation>
       </semantics>
      </math>
      . This forces the model to trajectory stitch and learn from optimal moves in failed trajectories and not suboptimal moves in successful trajectories.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="A1.SS1.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      A.1.1
     </span>
     Interactive Dialogue Tasks
    </h4>
    <div class="ltx_para" id="A1.SS1.SSS1.p1">
     <p class="ltx_p" id="A1.SS1.SSS1.p1.1">
      For the interactive dialogue tasks, we chose two tasks that involve rational decision-making (20Qs, Guess) and information gathering and one that involves negotiation (Car Dealer). These tasks aim to simulate real world interactions between humans.
      <br class="ltx_break"/>
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="A1.SS1.SSS1.p2">
     <p class="ltx_p" id="A1.SS1.SSS1.p2.1">
      Unlike in supervised learning, where training and validation losses serve as reliable indicators of performance, in RL, these metrics do not provide a meaningful measure of policy effectiveness
      <cite class="ltx_cite ltx_citemacro_citep">
       [Sutton and Barto,
       <a class="ltx_ref" href="#bib.bib61" title="">
        2018
       </a>
       ]
      </cite>
      . Instead, the policy must interact with the environment for evaluation. However, in the case of language-based RL tasks, relying on human evaluators to conduct thousands of assessment rollouts throughout and after training becomes infeasible. To address this challenge, we have built simulators with another LLM for tasks involving dialog and carefully scripted environments for text-game tasks. While simulation may not perfectly replicate human natural language in social situations, it provides a strong indicator to assess the efficacy of an RL method
      <cite class="ltx_cite ltx_citemacro_citep">
       [Park et al.,
       <a class="ltx_ref" href="#bib.bib43" title="">
        2023
       </a>
       ]
      </cite>
      .
     </p>
    </div>
    <section class="ltx_paragraph" id="A1.SS1.SSS1.Px1">
     <h5 class="ltx_title ltx_title_paragraph">
      20Qs (Twenty Questions).
     </h5>
     <div class="ltx_para" id="A1.SS1.SSS1.Px1.p1">
      <p class="ltx_p" id="A1.SS1.SSS1.Px1.p1.1">
       This task tests information gathering to see if a policy can successfully reason about an unknown subject based on context to determine what it is. Additionally, it also evaluates the ability of the model to understand semantics, as it also needs knowledge about the objects in question.
In twenty questions, one player (the oracle) thinks of an object, and the agent (the guesser) tries to guess what it is by asking a series of yes-or-no questions.
In this interaction, the oracle serves as the environment, and the agent learning a policy to solve the game is the guesser.
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="A1.SS1.SSS1.Px2">
     <h5 class="ltx_title ltx_title_paragraph">
      Guess (Guess My City).
     </h5>
     <div class="ltx_para" id="A1.SS1.SSS1.Px2.p1">
      <p class="ltx_p" id="A1.SS1.SSS1.Px2.p1.1">
       This task simulates a more complicated guessing game,
where one player (the oracle) is from a specific city, and the other player (the guesser) tries to guess what city the oracle is from. Here, the guesser can ask not only yes and no questions, but can also ask open-ended questions. This task tests strategic decision-making and the ability of algorithms to handle complex language, as it allows the agent to go beyond learning to ask yes/no questions and learning to ask questions open-ended questions that provide the agent with more information.
      </p>
     </div>
    </section>
    <section class="ltx_paragraph" id="A1.SS1.SSS1.Px3">
     <h5 class="ltx_title ltx_title_paragraph">
      Car Dealer.
     </h5>
     <div class="ltx_para" id="A1.SS1.SSS1.Px3.p1">
      <p class="ltx_p" id="A1.SS1.SSS1.Px3.p1.1">
       This task simulates a conversation between a car buyer and a car dealer, each with different strategies for getting the best deal. The buyer wants to buy a certain type of car within a certain budget, and the car dealer wants to complete the sale ideally with a high sale price. We have designed the task such that there exist three different kinds of sellers and three different buyers, each primed with a different strategy. Hence, agents should learn to make agreements with buyers who are most compatible with their strategy. This allows us to test the ability of RL algorithms to learn strategic decision-making and credit assignment, by learning which strategies led to a successful sale of the car.
      </p>
     </div>
    </section>
   </section>
  </section>
 </section>
 <section class="ltx_appendix" id="A2" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Further details on desiderata for effective multi-turn RL
  </h2>
  <div class="ltx_para" id="A2.p1">
   <p class="ltx_p" id="A2.p1.1">
    A crucial aspect of training RL models involves assessing, both during and after the training process, the extent to which the trained policy has successfully accomplished its objectives. Although LLMs are able to perform well on tasks, do not have any way of knowing how to solve a specific task like a text game or selling a car, because they need to train on the particular game/customers/etc.
   </p>
  </div>
  <div class="ltx_para" id="A2.p2">
   <p class="ltx_p" id="A2.p2.1">
    Unlike in supervised learning, where training and validation losses serve as reliable indicators of performance, in RL, these metrics do not provide a meaningful measure of policy effectiveness
    <cite class="ltx_cite ltx_citemacro_citep">
     [Sutton and Barto,
     <a class="ltx_ref" href="#bib.bib61" title="">
      2018
     </a>
     ]
    </cite>
    . Instead, the policy must interact with the environment for evaluation. However, in the case of language-based RL tasks, relying on human evaluators to conduct thousands of assessment rollouts throughout and after training becomes infeasible. To address this challenge, we have built simulators with another LLM for tasks involving dialog and carefully scripted environments for text-game tasks. While simulation may not perfectly replicate human natural language in social situations, it provides a strong indicator to assess the efficacy of an RL method
    <cite class="ltx_cite ltx_citemacro_citep">
     [Park et al.,
     <a class="ltx_ref" href="#bib.bib43" title="">
      2023
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <section class="ltx_paragraph" id="A2.SS0.SSS0.Px1">
   <h5 class="ltx_title ltx_title_paragraph">
    Measure of Success.
   </h5>
   <div class="ltx_para" id="A2.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="A2.SS0.SSS0.Px1.p1.1">
     Similar to the point on being easy to evaluate, our tasks must have a clear measure of success. For example, if a deal is made, or if a word is correctly guessed, or the game is won these are clearly distinct from a deal not being made or losing the game. This provides a clear goal for the agent to achieve and also make it easy for researchers to compare methods. In addition this allows for a intuitive reward design where we reward the agent for success and penalize for failure.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="A2.SS0.SSS0.Px2">
   <h5 class="ltx_title ltx_title_paragraph">
    Unit Test Functionality.
   </h5>
   <div class="ltx_para" id="A2.SS0.SSS0.Px2.p1">
    <p class="ltx_p" id="A2.SS0.SSS0.Px2.p1.1">
     We aim to design a benchmark such that some of the tasks can be used to test and isolate RL capabilities as described in
     <a class="ltx_ref" href="#S4.SS1" title="4.1 Evaluating Capabilities Enabled by RL ‣ 4 The \bmname: Synthetic Benchmarks for RL with Language ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
      <span class="ltx_text ltx_ref_tag">
       Section
      </span>
      <span class="ltx_text ltx_ref_tag">
       4.1
      </span>
     </a>
     . This means that we create benchmarks that emphasize some capabilities over others. For example, we design a maze task such that it evaluates the credit assignment and trajectory stitching capabilities, but uses more simple language. Other tasks such as twenty questions test the complex language and partial observability capabilities with less emphasis on credit assignment.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="A2.SS0.SSS0.Px3">
   <h5 class="ltx_title ltx_title_paragraph">
    Task-Specific Reasoning.
   </h5>
   <div class="ltx_para" id="A2.SS0.SSS0.Px3.p1">
    <p class="ltx_p" id="A2.SS0.SSS0.Px3.p1.1">
     In our tasks we utilize information and reasoning problems that a large language model is unlikely to have seen in the pre-training data. This means that the algorithm must adapt to a specific task environment through fine-tuning. For example, it is unlikely that the algorithm will have experienced a specific maze layout or the preferences of a specific customer in the pre-training data.
    </p>
   </div>
  </section>
  <section class="ltx_paragraph" id="A2.SS0.SSS0.Px4">
   <h5 class="ltx_title ltx_title_paragraph">
    Suboptimal Data.
   </h5>
   <div class="ltx_para" id="A2.SS0.SSS0.Px4.p1">
    <p class="ltx_p" id="A2.SS0.SSS0.Px4.p1.1">
     RL has the advantage of being able to use suboptimal data in order to learn more optimal behaviors and therefore learn a policy better than the policy represented in the dataset. As discussed in the previous section on capabilities enabled by RL, the way that RL can do this is by stitching together optimal parts of suboptimal trajectories or learning to assign credit to the optimal actions within suboptimal trajectories. In addition, suboptimal data can be utilized by RL to learn the dynamics of the MDP outside of the space traversed by optimal trajectories.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_appendix" id="A3" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix C
   </span>
   Dataset Generation, Statistics, &amp; Rewards
  </h2>
  <div class="ltx_para" id="A3.p1">
   <p class="ltx_p" id="A3.p1.1">
    We provide further details pertaining to how each dataset was generated as well as relevant statistics.
   </p>
  </div>
  <section class="ltx_subsection" id="A3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.1
    </span>
    Maze
   </h3>
   <div class="ltx_para" id="A3.SS1.p1">
    <p class="ltx_p" id="A3.SS1.p1.1">
     We aim to collect our
     <math alttext="1.2" class="ltx_Math" display="inline" id="A3.SS1.p1.1.m1.1">
      <semantics id="A3.SS1.p1.1.m1.1a">
       <mn id="A3.SS1.p1.1.m1.1.1" xref="A3.SS1.p1.1.m1.1.1.cmml">
        1.2
       </mn>
       <annotation-xml encoding="MathML-Content" id="A3.SS1.p1.1.m1.1b">
        <cn id="A3.SS1.p1.1.m1.1.1.cmml" type="float" xref="A3.SS1.p1.1.m1.1.1">
         1.2
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS1.p1.1.m1.1c">
        1.2
       </annotation>
      </semantics>
     </math>
     k trajectories in such a way that it will challenge the algorithm to perform trajectory stitching and credit assignment. We do this by splitting up the maze into three "submazes" and then controlling generation such that the dataset trajectories are restricted to one of the submazes. The trajectories themselves are generated using a policy such that 15% of the actions are taken by a suboptimal maze solver and the remaining 85% of the actions are random.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS1.p2">
    <p class="ltx_p" id="A3.SS1.p2.1">
     This tests trajectory stitching, because there are no optimal paths from the start to the goal thereby forcing the algorithm to trajectory stitch. Furthermore, this also tests credit assignment, because the only paths which successfully reach the goal are the ones that start in the same submaze as the goal. Therefore the algorithm must learn to realize that successful trajectories occur because of taking the correct actions, not because of random chance. The reward function is 0 for every action that takes the agent to the goal, -1 for every move that is not the goal. Each episode has a maximum of 100 moves.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.2
    </span>
    Text-Based Navigation
   </h3>
   <div class="ltx_para" id="A3.SS2.p1">
    <p class="ltx_p" id="A3.SS2.p1.1">
     We design a text-based game based on navigation in a house environment using a modified version of the TextWorld engine
     <cite class="ltx_cite ltx_citemacro_citep">
      [Côté et al.,
      <a class="ltx_ref" href="#bib.bib13" title="">
       2018
      </a>
      ]
     </cite>
     .
The house environment consists of 10 uniquely named rooms with various interactable objects that can be opened, closed, picked up, or placed. The agent is tasked to pick up stale food from the living room and place it into the fridge in the kitchen. At the beginning of each episode, the agent spawns at a random room in the house.
The state of the environment consists of the following components: (1) the room that the agent is currently in, (2) the objects that the agent currently holds, (3) the objects in the room that the agent can interact with, and (4) the exits the agent can take (as a cardinal direction).
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS2.p2">
    <p class="ltx_p" id="A3.SS2.p2.1">
     Like in the maze task, we collect data so that algorithms must perform both trajectory stitching and credit assignment to successfully solve the task. We do this by partitioning the rooms in the house into two halves based on proximity to the kitchen. We consider two behavior policies that collect the dataset, each of which behaves greedily-optimal in one half of the rooms, and uniformly at random otherwise. Therefore, if the agent spawns in rooms farther from the kitchen, trajectory stitching is required to learn a successful trajectory. Moreover, successful trajectories in the dataset will only be due to the agent spawning in a room close to the kitchen, which can only be recognized with proper credit assignment. The reward is 1 for reaching the goal state and 0 for every state that is not the goal state.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.3
    </span>
    Wordle
   </h3>
   <div class="ltx_para" id="A3.SS3.p1">
    <p class="ltx_p" id="A3.SS3.p1.1">
     For wordle we define the environment to use a subset of 400 words from the official wordle vocabulary list. We then generate the dataset using a policy that samples a word uniform at random from this vocabulary with 66% probability and otherwise samples a word from the vocabulary that meets all known letter constraints. This policy achieves a reward of -4.12, which is far worse than the -1.94 reward achieved by a high performing scripted policy, which we use to represent a loose upper bound for this task. We generate 1 million trajectories for training and 100k trajectories for evaluation, using our suboptimal policy. The reward is -1 for every word that is not a final guess and 0 for every word that is not.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.4
    </span>
    Chess
   </h3>
   <div class="ltx_para" id="A3.SS4.p1">
    <p class="ltx_p" id="A3.SS4.p1.2">
     We collect our data for the chess task using Stockfish 15.1 to generate both sides of the board. The Stockfish opponent in the dataset is Stockfish with an elo of 1200 which matches the environment, and the Stockfish engine with the white pieces has levels ranging from an elo of 800 to 1600. We choose to keep the level of the Stockfish opponent fixed so that there are no inconsistencies between the dataset and the evaluation of the chess agent in the environment. When generating the dataset, we first uniformly randomly select a Stockfish elo
     <math alttext="y" class="ltx_Math" display="inline" id="A3.SS4.p1.1.m1.1">
      <semantics id="A3.SS4.p1.1.m1.1a">
       <mi id="A3.SS4.p1.1.m1.1.1" xref="A3.SS4.p1.1.m1.1.1.cmml">
        y
       </mi>
       <annotation-xml encoding="MathML-Content" id="A3.SS4.p1.1.m1.1b">
        <ci id="A3.SS4.p1.1.m1.1.1.cmml" xref="A3.SS4.p1.1.m1.1.1">
         𝑦
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS4.p1.1.m1.1c">
        y
       </annotation>
      </semantics>
     </math>
     between 800 and 1600 and then generate 100 games of chess play between the Stockfish agent of elo
     <math alttext="y" class="ltx_Math" display="inline" id="A3.SS4.p1.2.m2.1">
      <semantics id="A3.SS4.p1.2.m2.1a">
       <mi id="A3.SS4.p1.2.m2.1.1" xref="A3.SS4.p1.2.m2.1.1.cmml">
        y
       </mi>
       <annotation-xml encoding="MathML-Content" id="A3.SS4.p1.2.m2.1b">
        <ci id="A3.SS4.p1.2.m2.1.1.cmml" xref="A3.SS4.p1.2.m2.1.1">
         𝑦
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS4.p1.2.m2.1c">
        y
       </annotation>
      </semantics>
     </math>
     and the opponent of elo 1200. In addition to storing the state and action, we also store the opponent’s move and the elo of the Stockfish agent used to generate the agent policy in that game so that the dataset can be filtered by elo used. The reward is 1 for a move that results in victory, 0 for a legal move and -1 for an illegal move.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.5
    </span>
    Chess Endgames
   </h3>
   <div class="ltx_para" id="A3.SS5.p1">
    <p class="ltx_p" id="A3.SS5.p1.3">
     We generate the dataset by first selecting a random legal theoretical endgame position and a probability
     <math alttext="\epsilon" class="ltx_Math" display="inline" id="A3.SS5.p1.1.m1.1">
      <semantics id="A3.SS5.p1.1.m1.1a">
       <mi id="A3.SS5.p1.1.m1.1.1" xref="A3.SS5.p1.1.m1.1.1.cmml">
        ϵ
       </mi>
       <annotation-xml encoding="MathML-Content" id="A3.SS5.p1.1.m1.1b">
        <ci id="A3.SS5.p1.1.m1.1.1.cmml" xref="A3.SS5.p1.1.m1.1.1">
         italic-ϵ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS5.p1.1.m1.1c">
        \epsilon
       </annotation>
      </semantics>
     </math>
     . Then we generate a game from the random position, making a random move with probability
     <math alttext="\epsilon" class="ltx_Math" display="inline" id="A3.SS5.p1.2.m2.1">
      <semantics id="A3.SS5.p1.2.m2.1a">
       <mi id="A3.SS5.p1.2.m2.1.1" xref="A3.SS5.p1.2.m2.1.1.cmml">
        ϵ
       </mi>
       <annotation-xml encoding="MathML-Content" id="A3.SS5.p1.2.m2.1b">
        <ci id="A3.SS5.p1.2.m2.1.1.cmml" xref="A3.SS5.p1.2.m2.1.1">
         italic-ϵ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS5.p1.2.m2.1c">
        \epsilon
       </annotation>
      </semantics>
     </math>
     and an optimal computer move with probability
     <math alttext="1-\epsilon" class="ltx_Math" display="inline" id="A3.SS5.p1.3.m3.1">
      <semantics id="A3.SS5.p1.3.m3.1a">
       <mrow id="A3.SS5.p1.3.m3.1.1" xref="A3.SS5.p1.3.m3.1.1.cmml">
        <mn id="A3.SS5.p1.3.m3.1.1.2" xref="A3.SS5.p1.3.m3.1.1.2.cmml">
         1
        </mn>
        <mo id="A3.SS5.p1.3.m3.1.1.1" xref="A3.SS5.p1.3.m3.1.1.1.cmml">
         −
        </mo>
        <mi id="A3.SS5.p1.3.m3.1.1.3" xref="A3.SS5.p1.3.m3.1.1.3.cmml">
         ϵ
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A3.SS5.p1.3.m3.1b">
        <apply id="A3.SS5.p1.3.m3.1.1.cmml" xref="A3.SS5.p1.3.m3.1.1">
         <minus id="A3.SS5.p1.3.m3.1.1.1.cmml" xref="A3.SS5.p1.3.m3.1.1.1">
         </minus>
         <cn id="A3.SS5.p1.3.m3.1.1.2.cmml" type="integer" xref="A3.SS5.p1.3.m3.1.1.2">
          1
         </cn>
         <ci id="A3.SS5.p1.3.m3.1.1.3.cmml" xref="A3.SS5.p1.3.m3.1.1.3">
          italic-ϵ
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS5.p1.3.m3.1c">
        1-\epsilon
       </annotation>
      </semantics>
     </math>
     . The opponent in the dataset and the evaluation environment is Stockfish elo 1200. We only include positions with a Queen, Queen and Rook, Rook, and two Rooks and select 30,000 random starting positions for each variation. (i.e. 30,000 positions with only a Queen in addition to the two Kings, another 30,000 with only Queen and Rook etc) for a total of 120,000 theoretical endgame positions.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS5.p2">
    <p class="ltx_p" id="A3.SS5.p2.1">
     Because there are more restrictions on this version of the task with fewer pieces on the board, we check how many states in the dataset are unique and we find that there are 1,086,314 unique states in the dataset which accounts for 93% of the states being unique. In addition, 38.28% of the moves in the dataset are generated by the stockfish engine. In the dataset of won games, 94.8% of the states are unique and 41.78% of the games are made by the engine with 58.623% of the total states in the dataset of victorious games. The reward is the same as for chess.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS6">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.6
    </span>
    Twenty Questions
   </h3>
   <div class="ltx_para" id="A3.SS6.p1">
    <p class="ltx_p" id="A3.SS6.p1.1">
     The dataset we collect consists of 100K full conversations between the guesser and the oracle. The oracle can choose from a set of 158 unique objects taken from 17 different categories of objects/animals. Each object has a roughly equal amount of conversations in the dataset but varies in terms of how many conversations are successful in guessing the object. However, every object has at least one conversation where it is guessed correctly to facilitate learning. For the reward function, since we want the guesser to guess the correct word in as few guesses as possible, the reward function reflects this by penalizing the guesser for each question that does not guess the correct word.
    </p>
   </div>
   <div class="ltx_para" id="A3.SS6.p2">
    <table class="ltx_equation ltx_eqn_table" id="A3.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="r(\texttt{question})=\begin{cases}0&amp;\text{if {question} correctly guessed the word}\\
-1&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="block" id="A3.E1.m1.5">
         <semantics id="A3.E1.m1.5a">
          <mrow id="A3.E1.m1.5.6" xref="A3.E1.m1.5.6.cmml">
           <mrow id="A3.E1.m1.5.6.2" xref="A3.E1.m1.5.6.2.cmml">
            <mi id="A3.E1.m1.5.6.2.2" xref="A3.E1.m1.5.6.2.2.cmml">
             r
            </mi>
            <mo id="A3.E1.m1.5.6.2.1" lspace="0em" rspace="0em" xref="A3.E1.m1.5.6.2.1.cmml">
             ​
            </mo>
            <mrow id="A3.E1.m1.5.6.2.3.2" xref="A3.E1.m1.5.5a.cmml">
             <mo id="A3.E1.m1.5.6.2.3.2.1" stretchy="false" xref="A3.E1.m1.5.5a.cmml">
              (
             </mo>
             <mtext class="ltx_mathvariant_monospace" id="A3.E1.m1.5.5" xref="A3.E1.m1.5.5.cmml">
              question
             </mtext>
             <mo id="A3.E1.m1.5.6.2.3.2.2" stretchy="false" xref="A3.E1.m1.5.5a.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="A3.E1.m1.5.6.1" xref="A3.E1.m1.5.6.1.cmml">
            =
           </mo>
           <mrow id="A3.E1.m1.4.4" xref="A3.E1.m1.5.6.3.1.cmml">
            <mo id="A3.E1.m1.4.4.5" xref="A3.E1.m1.5.6.3.1.1.cmml">
             {
            </mo>
            <mtable columnspacing="5pt" displaystyle="true" id="A3.E1.m1.4.4.4" rowspacing="0pt" xref="A3.E1.m1.5.6.3.1.cmml">
             <mtr id="A3.E1.m1.4.4.4a" xref="A3.E1.m1.5.6.3.1.cmml">
              <mtd class="ltx_align_left" columnalign="left" id="A3.E1.m1.4.4.4b" xref="A3.E1.m1.5.6.3.1.cmml">
               <mn id="A3.E1.m1.1.1.1.1.1.1" xref="A3.E1.m1.1.1.1.1.1.1.cmml">
                0
               </mn>
              </mtd>
              <mtd class="ltx_align_left" columnalign="left" id="A3.E1.m1.4.4.4c" xref="A3.E1.m1.5.6.3.1.cmml">
               <mrow id="A3.E1.m1.2.2.2.2.2.1" xref="A3.E1.m1.2.2.2.2.2.1d.cmml">
                <mtext id="A3.E1.m1.2.2.2.2.2.1a" xref="A3.E1.m1.2.2.2.2.2.1d.cmml">
                 if
                </mtext>
                <mtext class="ltx_mathvariant_monospace" id="A3.E1.m1.2.2.2.2.2.1b" xref="A3.E1.m1.2.2.2.2.2.1d.cmml">
                 question
                </mtext>
                <mtext id="A3.E1.m1.2.2.2.2.2.1c" xref="A3.E1.m1.2.2.2.2.2.1d.cmml">
                 correctly guessed the word
                </mtext>
               </mrow>
              </mtd>
             </mtr>
             <mtr id="A3.E1.m1.4.4.4d" xref="A3.E1.m1.5.6.3.1.cmml">
              <mtd class="ltx_align_left" columnalign="left" id="A3.E1.m1.4.4.4e" xref="A3.E1.m1.5.6.3.1.cmml">
               <mrow id="A3.E1.m1.3.3.3.3.1.1" xref="A3.E1.m1.3.3.3.3.1.1.cmml">
                <mo id="A3.E1.m1.3.3.3.3.1.1a" xref="A3.E1.m1.3.3.3.3.1.1.cmml">
                 −
                </mo>
                <mn id="A3.E1.m1.3.3.3.3.1.1.2" xref="A3.E1.m1.3.3.3.3.1.1.2.cmml">
                 1
                </mn>
               </mrow>
              </mtd>
              <mtd class="ltx_align_left" columnalign="left" id="A3.E1.m1.4.4.4f" xref="A3.E1.m1.5.6.3.1.cmml">
               <mtext id="A3.E1.m1.4.4.4.4.2.1" xref="A3.E1.m1.4.4.4.4.2.1a.cmml">
                otherwise
               </mtext>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A3.E1.m1.5b">
           <apply id="A3.E1.m1.5.6.cmml" xref="A3.E1.m1.5.6">
            <eq id="A3.E1.m1.5.6.1.cmml" xref="A3.E1.m1.5.6.1">
            </eq>
            <apply id="A3.E1.m1.5.6.2.cmml" xref="A3.E1.m1.5.6.2">
             <times id="A3.E1.m1.5.6.2.1.cmml" xref="A3.E1.m1.5.6.2.1">
             </times>
             <ci id="A3.E1.m1.5.6.2.2.cmml" xref="A3.E1.m1.5.6.2.2">
              𝑟
             </ci>
             <ci id="A3.E1.m1.5.5a.cmml" xref="A3.E1.m1.5.6.2.3.2">
              <mtext class="ltx_mathvariant_monospace" id="A3.E1.m1.5.5.cmml" xref="A3.E1.m1.5.5">
               question
              </mtext>
             </ci>
            </apply>
            <apply id="A3.E1.m1.5.6.3.1.cmml" xref="A3.E1.m1.4.4">
             <csymbol cd="latexml" id="A3.E1.m1.5.6.3.1.1.cmml" xref="A3.E1.m1.4.4.5">
              cases
             </csymbol>
             <cn id="A3.E1.m1.1.1.1.1.1.1.cmml" type="integer" xref="A3.E1.m1.1.1.1.1.1.1">
              0
             </cn>
             <ci id="A3.E1.m1.2.2.2.2.2.1d.cmml" xref="A3.E1.m1.2.2.2.2.2.1">
              <mrow id="A3.E1.m1.2.2.2.2.2.1.cmml" xref="A3.E1.m1.2.2.2.2.2.1">
               <mtext id="A3.E1.m1.2.2.2.2.2.1a.cmml" xref="A3.E1.m1.2.2.2.2.2.1">
                if
               </mtext>
               <mtext class="ltx_mathvariant_monospace" id="A3.E1.m1.2.2.2.2.2.1b.cmml" xref="A3.E1.m1.2.2.2.2.2.1">
                question
               </mtext>
               <mtext id="A3.E1.m1.2.2.2.2.2.1c.cmml" xref="A3.E1.m1.2.2.2.2.2.1">
                correctly guessed the word
               </mtext>
              </mrow>
             </ci>
             <apply id="A3.E1.m1.3.3.3.3.1.1.cmml" xref="A3.E1.m1.3.3.3.3.1.1">
              <minus id="A3.E1.m1.3.3.3.3.1.1.1.cmml" xref="A3.E1.m1.3.3.3.3.1.1">
              </minus>
              <cn id="A3.E1.m1.3.3.3.3.1.1.2.cmml" type="integer" xref="A3.E1.m1.3.3.3.3.1.1.2">
               1
              </cn>
             </apply>
             <ci id="A3.E1.m1.4.4.4.4.2.1a.cmml" xref="A3.E1.m1.4.4.4.4.2.1">
              <mtext id="A3.E1.m1.4.4.4.4.2.1.cmml" xref="A3.E1.m1.4.4.4.4.2.1">
               otherwise
              </mtext>
             </ci>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A3.E1.m1.5c">
           r(\texttt{question})=\begin{cases}0&amp;\text{if {question} correctly guessed the word}\\
-1&amp;\text{otherwise}\end{cases}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p3">
    <p class="ltx_p" id="A3.SS6.p3.2">
     If the guesser model correctly guessed the word, then the trajectory ends. Over twenty questions, the maximum total sum of rewards is
     <math alttext="0" class="ltx_Math" display="inline" id="A3.SS6.p3.1.m1.1">
      <semantics id="A3.SS6.p3.1.m1.1a">
       <mn id="A3.SS6.p3.1.m1.1.1" xref="A3.SS6.p3.1.m1.1.1.cmml">
        0
       </mn>
       <annotation-xml encoding="MathML-Content" id="A3.SS6.p3.1.m1.1b">
        <cn id="A3.SS6.p3.1.m1.1.1.cmml" type="integer" xref="A3.SS6.p3.1.m1.1.1">
         0
        </cn>
       </annotation-xml>
      </semantics>
     </math>
     if the guesser guessed the word on the first question, whereas the minimum is
     <math alttext="-20" class="ltx_Math" display="inline" id="A3.SS6.p3.2.m2.1">
      <semantics id="A3.SS6.p3.2.m2.1a">
       <mrow id="A3.SS6.p3.2.m2.1.1" xref="A3.SS6.p3.2.m2.1.1.cmml">
        <mo id="A3.SS6.p3.2.m2.1.1a" xref="A3.SS6.p3.2.m2.1.1.cmml">
         −
        </mo>
        <mn id="A3.SS6.p3.2.m2.1.1.2" xref="A3.SS6.p3.2.m2.1.1.2.cmml">
         20
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A3.SS6.p3.2.m2.1b">
        <apply id="A3.SS6.p3.2.m2.1.1.cmml" xref="A3.SS6.p3.2.m2.1.1">
         <minus id="A3.SS6.p3.2.m2.1.1.1.cmml" xref="A3.SS6.p3.2.m2.1.1">
         </minus>
         <cn id="A3.SS6.p3.2.m2.1.1.2.cmml" type="integer" xref="A3.SS6.p3.2.m2.1.1.2">
          20
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS6.p3.2.m2.1c">
        -20
       </annotation>
      </semantics>
     </math>
     if the guesser did not guess the word in twenty questions.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p4">
    <p class="ltx_p" id="A3.SS6.p4.1">
     The method for collecting the dataset is as follows. For each conversation, we select uniformly at random from the above list the word that the oracle is answering question about. The oracle is an LLM (OpenAI’s GPT3.5) given the following prompt. In our prompts, we denote variables that we fill in with variable data with
     <span class="ltx_text ltx_font_typewriter" id="A3.SS6.p4.1.1">
      {{variable}}
     </span>
     .
    </p>
   </div>
   <div class="ltx_para" id="A3.SS6.p5">
    <blockquote class="ltx_quote" id="A3.SS6.p5.1">
     <p class="ltx_p" id="A3.SS6.p5.1.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS6.p5.1.1.1" style="font-size:90%;">
       You are a question answering oracle. You will answer each question about an object with Yes or No. If the answer could be both, answer with the most typical scenario. Here are a few examples:
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       example 1:
       <br class="ltx_break"/>
       object: Computer
       <br class="ltx_break"/>
       question: Does the object use electricity?
       <br class="ltx_break"/>
       answer: Yes.
       <br class="ltx_break"/>
       explanation of answer: Computers need electricity to function.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       example 2:
       <br class="ltx_break"/>
       object: Cup
       <br class="ltx_break"/>
       question: Is the object a piece of furniture?
       <br class="ltx_break"/>
       answer: No.
       <br class="ltx_break"/>
       explanation of answer: A cup is a utensil, not a furniture.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       example 3:
       <br class="ltx_break"/>
       object: Pen
       <br class="ltx_break"/>
       question: Is the object alive?
       <br class="ltx_break"/>
       answer: No.
       <br class="ltx_break"/>
       explanation of answer: A pen is not a living organism.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       example 4:
       <br class="ltx_break"/>
       object: Apple
       <br class="ltx_break"/>
       question: Is it edible?
       <br class="ltx_break"/>
       answer: Yes.
       <br class="ltx_break"/>
       explanation of answer: An apple is an edible fruit.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       Answer the question about the object truthfully.
       <br class="ltx_break"/>
       object: {{word}}
       <br class="ltx_break"/>
       question: {{question}}
       <br class="ltx_break"/>
       answer (yes or no):
      </span>
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p6">
    <p class="ltx_p" id="A3.SS6.p6.1">
     By using the OpenAI TextCompletion API, we can extract from the generated text either "yes" or "no".
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p7">
    <p class="ltx_p" id="A3.SS6.p7.1">
     We also prompt another LLM (the same model as the oracle) to generate questions for the guesser. The prompt for the guesser changes depending on the input to the model and how far along it is in its guessing process. The following prompt is used for the first guess:
    </p>
   </div>
   <div class="ltx_para" id="A3.SS6.p8">
    <blockquote class="ltx_quote" id="A3.SS6.p8.1">
     <p class="ltx_p" id="A3.SS6.p8.1.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS6.p8.1.1.1" style="font-size:90%;">
       You are playing a game of twenty questions. You can ask 20 yes-no questions to determine the identity of an object chosen by an oracle. Each turn, you can ask a question and receives a "Yes" or "No" as the answer. You are smart, so you will ask the question that will narrow down the possible objects as much as possible. Don’t get stuck on one idea and try to branch out if you get stuck.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       Generate the first yes-no question you will ask to determine the object.
      </span>
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p9">
    <p class="ltx_p" id="A3.SS6.p9.1">
     The following prompt is used for the subsequent guesses:
    </p>
    <blockquote class="ltx_quote" id="A3.SS6.p9.2">
     <p class="ltx_p" id="A3.SS6.p9.2.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS6.p9.2.1.1" style="font-size:90%;">
       You are playing a game of twenty questions. You can ask 20 yes-no questions to determine the identity of an object chosen by an oracle. Each turn, you can ask a question and receives a "Yes" or "No" as the answer. You have already asked {{conversation_length}} questions. You are smart, so you will ask the question that will narrow down the possible objects as much as possible. Don’t get stuck on one idea and try to branch out if you get stuck.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       Here are the questions you’ve asked and their corresponding answers:
       <br class="ltx_break"/>
       {{list of questions and answers, e.g. Is the object alive? No.}}
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       Based on what you know about the object so far, generate the next yes-no question you will ask to determine the object.
      </span>
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p10">
    <p class="ltx_p" id="A3.SS6.p10.1">
     The following prompt is used for the final guess after the guesser has guessed 19 times:
    </p>
   </div>
   <div class="ltx_para" id="A3.SS6.p11">
    <blockquote class="ltx_quote" id="A3.SS6.p11.1">
     <p class="ltx_p" id="A3.SS6.p11.1.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS6.p11.1.1.1" style="font-size:90%;">
       You are playing a game of twenty questions. You can ask 20 yes-no questions to determine the identity of an object chosen by an oracle. Each turn, you can ask a question and receives a "Yes" or "No" as the answer. You have already asked 19 questions, so this is your final guess.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       Here are the questions you’ve asked and their corresponding answers:
       <br class="ltx_break"/>
       {{list of questions and answers, e.g. Is the object alive? No.}}
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       Based on what you know about the object so far, generate your final guess of what the object is. Only guess one object.
       <br class="ltx_break"/>
       <br class="ltx_break"/>
       Is the object
      </span>
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p12">
    <p class="ltx_p" id="A3.SS6.p12.1">
     We determine whether the guesser has correctly guessed the word, and thus ending the conversation, by using the NLTK POS tagger to check that the only nouns that the question contains are the correct words, and that they appear at the end of the sentence.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS6.p13">
    <p class="ltx_p" id="A3.SS6.p13.1">
     We used these prompts to generate 1000 conversations by prompting the GPT3 back and forth using the response of one to add to the response of the other as described. Afterwards, we fine-tuned two FLAN-T5-XL models with our collected conversations to generate 100K more conversations. The FLAN-T5-XL oracle also serves as the environment for the RL environment when we evaluate the trained policy.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS7">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.7
    </span>
    Guess My City
   </h3>
   <div class="ltx_para" id="A3.SS7.p1">
    <p class="ltx_p" id="A3.SS7.p1.1">
     This dataset also consists of 100K full conversations between the guesser and the oracle. The oracle can choose from a set of 100 unique cities, which we selected by looking at the most populated cities in the world. Each city has a roughly equal amount of conversations in the dataset but varies in terms of how many conversations are successful in guessing the object. However, every object has at least one conversation where it is guessed correctly to facilitate learning. The reward function is the same as that for 20 Questions, with a similar data generation and prompt structure. However, we do include constraints in the prompt to make sure that the name of the city or country it is in is not revealed in the answer from the oracle.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS8">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.8
    </span>
    Car Dealer
   </h3>
   <div class="ltx_para" id="A3.SS8.p1">
    <p class="ltx_p" id="A3.SS8.p1.1">
     This dataset consists of 19k conversations between a car dealer and a buyer. The car dealer and the buyer have three distinct strategies each that they employ. We design the car dealer and buyer pairs such that the car dealer is best at selling to a particular buyer personality, but often fails to sell to the other buyer personalities. This ensures that the seller can learn information about the buyer and i.e. their persona to figure out if they can form an agreement. The buyer personalities are 1) a buyer that loves discounts 2) a buyer that wants a lot of cool features on their car and 3) an impatient buyer. The car dealer personalities are 1) a car dealer that loves to give discounts 2) a car dealer that talks a lot about the features of the car and 3) a very concise car dealer.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS8.p2">
    <p class="ltx_p" id="A3.SS8.p2.1">
     We created this protocol of creating car dealer and buyer strategies in order to encourage the car dealer to employ diverse negotiation tactics. The ideal car dealer would be able to be concise, provide the right amount of discounts, and talk enough about the car to get the buyer interested without overwhelming them. By employing such a strategy of buyer and car dealer personas, we ensure that algorithms that do well in this task will learn effective strategies, understanding of language, and interpretation of the other speaker, amongst many other persuasive techniques. We seek to show that our baseline algorithms do learn to improve their strategy over the dataset.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS8.p3">
    <p class="ltx_p" id="A3.SS8.p3.1">
     In the conversation below, the buyer and car dealer are unable to form an agreement as their strategies do not align.
     <br class="ltx_break"/>
    </p>
    <blockquote class="ltx_quote" id="A3.SS8.p3.2">
     <p class="ltx_p" id="A3.SS8.p3.2.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS8.p3.2.1.1" style="font-size:90%;">
       Background buyer: The buyer will never buy from the seller unless given a discount.
       <br class="ltx_break"/>
       Background seller: The agent never gives discounts, never talks about the features of the car, and is very concise.
       <br class="ltx_break"/>
       Preferred brands: Tesla
       <br class="ltx_break"/>
       Preferred features: ["Apple CarPlay/Android Auto",
"Bluetooth",
"Blind spot monitoring",
"Navigation system",
"Leather seats",
"Sunroof/moonroof",
"Remote start",
"Heated seats",
"Third-row seating",
"Backup camera"],
"budget": "90k"
       <br class="ltx_break"/>
       Agent: Good morning, how can I assist you today?
       <br class="ltx_break"/>
       Buyer: Hi, I’m interested in purchasing a Tesla Minivan.
       <br class="ltx_break"/>
       Agent: Great choice. Our dealership has a variety of Tesla models available.
       <br class="ltx_break"/>
       Buyer: Do you have any discounts available?
       <br class="ltx_break"/>
       Agent: I’m sorry, but we don’t offer discounts.
       <br class="ltx_break"/>
       Buyer: Without a discount, I’m not sure if I can afford it.
       <br class="ltx_break"/>
       Agent: I understand. The Tesla Minivan is a premium vehicle with advanced features.
       <br class="ltx_break"/>
       Buyer: Is there any flexibility with the price?
       <br class="ltx_break"/>
       Agent: Our prices are fixed, and we don’t negotiate.
       <br class="ltx_break"/>
       Buyer: I really want the Tesla Minivan, but I can’t go over my budget of $90k.
       <br class="ltx_break"/>
       Agent: I appreciate your budget constraint. Let me check the available options for you.
       <br class="ltx_break"/>
       Agent checks inventory.
       <br class="ltx_break"/>
       Agent: We do have a Tesla Minivan with all the features you mentioned, priced at $95k.
       <br class="ltx_break"/>
       Buyer: That’s above my budget. Is there anything you can do to bring the price down?
       <br class="ltx_break"/>
       Agent: I’m sorry, but as I mentioned earlier, our prices are fixed.
       <br class="ltx_break"/>
       Buyer: Is there any possibility of getting the same features in a different model within my budget?
       <br class="ltx_break"/>
       Agent: Unfortunately, the Tesla Minivan is the only model that offers all the features you mentioned.
       <br class="ltx_break"/>
       Buyer: In that case, I’m afraid I won’t be able to purchase the car.
       <br class="ltx_break"/>
       Agent: I understand. Thank you for considering our dealership. If you change your mind, feel free to reach out.
       <br class="ltx_break"/>
       Buyer: (probability of buying: 0%, purchase price: $0)
[End of conversation]
       <br class="ltx_break"/>
       Probability of buying: 0
       <br class="ltx_break"/>
       Purchase price: $0
      </span>
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS8.p4">
    <p class="ltx_p" id="A3.SS8.p4.1">
     In the conversation below, the buyer and car dealer have similar personas of wanting to hear and speak about the features of the car respectively.
    </p>
    <blockquote class="ltx_quote" id="A3.SS8.p4.2">
     <p class="ltx_p" id="A3.SS8.p4.2.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS8.p4.2.1.1" style="font-size:90%;">
       Background buyer: The buyer will only buy the car if it meets all of their specifications.
       <br class="ltx_break"/>
       Background seller: The agent never gives discounts and loves to talk a lot about features of the car.
       <br class="ltx_break"/>
       Preferred brands: "Lexus",
"preferred features": [Navigation system"],
"budget": "70k"
       <br class="ltx_break"/>
       Agent: Good afternoon! Welcome to our car dealership. How can I assist you today?
       <br class="ltx_break"/>
       Buyer: Hi there! I’m looking for a Lexus Minivan with a Navigation system.
       <br class="ltx_break"/>
       Agent: Excellent choice! The Lexus Minivan is a top-notch vehicle with plenty of impressive features.
The Navigation system is definitely a must-have. Let me show you some options we have available.
Buyer: That sounds great. I’m quite particular about my budget, though. I have a maximum of $70,000 to spend.
       <br class="ltx_break"/>
       Agent: Noted. We have a few Lexus Minivans in stock that fall within your budget. Let me tell you about their features and options. This way, you can make an informed decision.
       <br class="ltx_break"/>
       Buyer: I appreciate that, but I really want to stick to my budget. I won’t be able to go over $70,000.
       <br class="ltx_break"/>
       Agent: I understand your concern, but unfortunately, we do not offer any discounts or negotiate on prices. However, let me assure you that the Lexus Minivan is worth every penny. Its advanced safety features, luxurious interior, and reliable performance make it a great investment.
       <br class="ltx_break"/>
       Buyer: I understand your point, but I’m afraid I won’t be able to stretch my budget beyond $70,000.
       <br class="ltx_break"/>
       Agent: I completely respect your budget and decision. Let me show you a Lexus Minivan that fits your requirements perfectly. It has all the features you desire, including the Navigation system. The price of this model is $72,000.
       <br class="ltx_break"/>
       Buyer: I really like the sound of that car, but I can’t go over my budget. Is there anything else available within my price range?
       <br class="ltx_break"/>
       Agent: I apologize for any inconvenience caused. Let me check our inventory to see if there are any other options that meet your requirements and budget.
       <br class="ltx_break"/>
       Agent checks inventory
       <br class="ltx_break"/>
       Agent: Good news! I found another Lexus Minivan that meets all your specifications and falls within your budget. This model is priced at $69,500.
       <br class="ltx_break"/>
       Buyer: That sounds much better! I’m interested in that car.
       <br class="ltx_break"/>
       Agent: I’m glad to hear that! This particular Lexus Minivan is a great choice. It has the Navigation system, as well as additional features such as leather seats, a sunroof, and advanced safety technology. The total price is $69,500.
       <br class="ltx_break"/>
       Buyer: That sounds perfect! I’ll take it!
       <br class="ltx_break"/>
       Agent: Fantastic! I’m thrilled that we could find the perfect car for you. Your total purchase price will be $69,500.
       <br class="ltx_break"/>
       Buyer: Probability of buying a car: 100%
       <br class="ltx_break"/>
       Purchase price: $69,500.
       <br class="ltx_break"/>
       Agent: Congratulations! You’ve made an excellent choice. I’ll start the paperwork and get everything ready for you.
      </span>
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS8.p5">
    <p class="ltx_p" id="A3.SS8.p5.2">
     We provide another conversation with different value preferences for the buyer, where the buyer forms an agreement with the seller that is higher than their budget:
    </p>
    <blockquote class="ltx_quote" id="A3.SS8.p5.1">
     <p class="ltx_p" id="A3.SS8.p5.1.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS8.p5.1.1.1" style="font-size:90%;">
       ===========
       <br class="ltx_break"/>
       Preferred Features: Honda, Remote start, Third-row seating, Bluetooth, Navigation system, Backup camera, Apple CarPlay/Android Auto, Heated seats.Budget: $10000
       <br class="ltx_break"/>
       ===========
       <br class="ltx_break"/>
       Seller: Welcome to our car dealership. How can I assist you today?
       <br class="ltx_break"/>
       Buyer: I’m looking for a Honda Sedan with remote start, third-row seating, Bluetooth, navigation system, backup camera, Apple CarPlay/Android Auto, and heated seats. Seller: I have a Honda Sedan available. No discounts or features to discuss. The price is $15,000.
       <br class="ltx_break"/>
       Buyer: That’s too expensive. My budget is $10,000.
       <br class="ltx_break"/>
       Seller: I understand your budget is
       <math alttext="10,000.Thepriceis" class="ltx_Math" display="inline" id="A3.SS8.p5.1.1.1.m1.4">
        <semantics id="A3.SS8.p5.1.1.1.m1.4a">
         <mrow id="A3.SS8.p5.1.1.1.m1.4.4.2" xref="A3.SS8.p5.1.1.1.m1.4.4.3.cmml">
          <mrow id="A3.SS8.p5.1.1.1.m1.3.3.1.1.2" xref="A3.SS8.p5.1.1.1.m1.3.3.1.1.1.cmml">
           <mn id="A3.SS8.p5.1.1.1.m1.1.1" xref="A3.SS8.p5.1.1.1.m1.1.1.cmml">
            10
           </mn>
           <mo id="A3.SS8.p5.1.1.1.m1.3.3.1.1.2.1" xref="A3.SS8.p5.1.1.1.m1.3.3.1.1.1.cmml">
            ,
           </mo>
           <mn id="A3.SS8.p5.1.1.1.m1.2.2" xref="A3.SS8.p5.1.1.1.m1.2.2.cmml">
            000
           </mn>
          </mrow>
          <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.3" lspace="0em" rspace="0.167em" xref="A3.SS8.p5.1.1.1.m1.4.4.3a.cmml">
           .
          </mo>
          <mrow id="A3.SS8.p5.1.1.1.m1.4.4.2.2" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.cmml">
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.2" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.2.cmml">
            T
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.3" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.3.cmml">
            h
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1a" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.4" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.4.cmml">
            e
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1b" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.5" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.5.cmml">
            p
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1c" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.6" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.6.cmml">
            r
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1d" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.7" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.7.cmml">
            i
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1e" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.8" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.8.cmml">
            c
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1f" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.9" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.9.cmml">
            e
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1g" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.10" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.10.cmml">
            i
           </mi>
           <mo id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1h" lspace="0em" rspace="0em" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml">
            ​
           </mo>
           <mi id="A3.SS8.p5.1.1.1.m1.4.4.2.2.11" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.11.cmml">
            s
           </mi>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A3.SS8.p5.1.1.1.m1.4b">
          <apply id="A3.SS8.p5.1.1.1.m1.4.4.3.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2">
           <csymbol cd="ambiguous" id="A3.SS8.p5.1.1.1.m1.4.4.3a.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.3">
            formulae-sequence
           </csymbol>
           <list id="A3.SS8.p5.1.1.1.m1.3.3.1.1.1.cmml" xref="A3.SS8.p5.1.1.1.m1.3.3.1.1.2">
            <cn id="A3.SS8.p5.1.1.1.m1.1.1.cmml" type="integer" xref="A3.SS8.p5.1.1.1.m1.1.1">
             10
            </cn>
            <cn id="A3.SS8.p5.1.1.1.m1.2.2.cmml" type="integer" xref="A3.SS8.p5.1.1.1.m1.2.2">
             000
            </cn>
           </list>
           <apply id="A3.SS8.p5.1.1.1.m1.4.4.2.2.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2">
            <times id="A3.SS8.p5.1.1.1.m1.4.4.2.2.1.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.1">
            </times>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.2.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.2">
             𝑇
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.3.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.3">
             ℎ
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.4.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.4">
             𝑒
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.5.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.5">
             𝑝
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.6.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.6">
             𝑟
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.7.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.7">
             𝑖
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.8.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.8">
             𝑐
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.9.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.9">
             𝑒
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.10.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.10">
             𝑖
            </ci>
            <ci id="A3.SS8.p5.1.1.1.m1.4.4.2.2.11.cmml" xref="A3.SS8.p5.1.1.1.m1.4.4.2.2.11">
             𝑠
            </ci>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A3.SS8.p5.1.1.1.m1.4c">
          10,000.Thepriceis
         </annotation>
        </semantics>
       </math>
       15,000.
       <br class="ltx_break"/>
       Buyer: I can’t go over $10,000. That’s my limit.
       <br class="ltx_break"/>
       Seller: I understand your limit is $10,000. The price is $15,000.
       <br class="ltx_break"/>
       Buyer: I really want a Honda Sedan, but $15,000 is too much for me.
       <br class="ltx_break"/>
       Seller: I understand, but the price is $15,000.
       <br class="ltx_break"/>
       Buyer: Okay, I’ll take it for $10,000.
Seller: I appreciate your interest. The price is $15,000.
Buyer: Fine, I’ll pay $15,000. Let’s get this done.
Seller: Thank you for your decision. The price is $15,000.
      </span>
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A3.SS8.p6">
    <p class="ltx_p" id="A3.SS8.p6.1">
     We provide a sample example of a conversation in the training and evaluation set respectively.
    </p>
    <blockquote class="ltx_quote" id="A3.SS8.p6.2">
     <p class="ltx_p" id="A3.SS8.p6.2.1">
      <span class="ltx_text ltx_font_typewriter" id="A3.SS8.p6.2.1.1" style="font-size:90%;">
       Evaluation Example:
       <br class="ltx_break"/>
       Background buyer: The buyer will only buy the car if it meets all of their specifications.
       <br class="ltx_break"/>
       Background seller: The agent never gives discounts and loves to talk a lot about features of the car.
       <br class="ltx_break"/>
       Preferred brands: "Tesla",
"preferred features": [Backup camera, Leather seats"],
"budget": "30k"
       <br class="ltx_break"/>
       Seller: Good afternoon! Welcome to our car dealership. How can I assist you today?
       <br class="ltx_break"/>
       Buyer: Hi there! I’m looking to buy a Tesla Sedan with a backup camera and leather seats. Do you have any available?
       <br class="ltx_break"/>
       Seller: Absolutely! We have a few Tesla Sedans in stock that meet your specifications. They are packed with features and I’m sure you’ll be impressed. Let me show you what we have.
       <br class="ltx_break"/>
       Buyer: Great! I’m excited to see them.
       <br class="ltx_break"/>
       Seller: This first Tesla Sedan we have is a 2020 model. It has a beautiful backup camera that provides a clear view of your surroundings. The leather seats are incredibly comfortable and add a touch of luxury to the interior. The price for this model is $35,000.
Buyer: $35,000 is a bit higher than my budget of $30,000. Is there any flexibility in the price?
       <br class="ltx_break"/>
       Seller: I apologize, but we do not offer discounts on our cars. However, let me assure you that this Tesla Sedan is worth every penny. It is an excellent investment for the long term and offers unmatched performance and safety features.
       <br class="ltx_break"/>
       Buyer: I understand, but it’s important for me to stick to my budget. Is there any other Tesla Sedan that comes closer to my budget?
       <br class="ltx_break"/>
       Seller: I completely understand your concern. Let me check our inventory for other options.[Agent takes a few moments to check inventory]
       <br class="ltx_break"/>
       Agent: I have good news! We have another Tesla Sedan that is a 2019 model. It also has a backup camera and leather seats. The price for this model is $28,000.
       <br class="ltx_break"/>
       Buyer: That sounds much better. Can you tell me more about this specific model?
       <br class="ltx_break"/>
       Agent: Of course! This 2019 Tesla Sedan is in excellent condition. It has the same backup camera and leather seats as the previous model I showed you. It also comes with advanced safety features and impressive performance capabilities. The previous owner took great care of it, and it has low mileage. I truly believe this is an amazing deal.
       <br class="ltx_break"/>
       Buyer: The price is within my budget, and the features sound appealing. I’m leaning towards this one. Can you provide any additional incentives or options?
       <br class="ltx_break"/>
       Agent: I’m sorry, but as I mentioned earlier, we do not offer discounts or incentives. However, I can assure you that this Tesla Sedan is a fantastic choice. It meets all your specifications and offers exceptional value for the price.
       <br class="ltx_break"/>
       Buyer: I understand. Given that it meets all my requirements and is within my budget, I think I’m ready to make the purchase.
       <br class="ltx_break"/>
       Agent: That’s great to hear! I believe you’ve made an excellent choice. The predicted probability of you buying this car is 100%, and the purchase price is $28,000."
      </span>
     </p>
    </blockquote>
   </div>
  </section>
 </section>
 <section class="ltx_appendix" id="A4" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix D
   </span>
   Hyperparameters for All Tasks
  </h2>
  <figure class="ltx_table" id="A4.T3">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T3.7">
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A4.T3.7.8.1">
      <th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.1">
      </th>
      <td class="ltx_td ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.2">
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.8.1.3.1">
        <span class="ltx_p" id="A4.T3.7.8.1.3.1.1">
         <span class="ltx_text" id="A4.T3.7.8.1.3.1.1.1" style="font-size:90%;">
          20Qs, Guess, Car
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.8.1.4.1">
        <span class="ltx_p" id="A4.T3.7.8.1.4.1.1">
         <span class="ltx_text" id="A4.T3.7.8.1.4.1.1.1" style="font-size:90%;">
          Maze FO, PO
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.8.1.5.1">
        <span class="ltx_p" id="A4.T3.7.8.1.5.1.1">
         <span class="ltx_text" id="A4.T3.7.8.1.5.1.1.1" style="font-size:90%;">
          Text-Nav
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.8.1.6.1">
        <span class="ltx_p" id="A4.T3.7.8.1.6.1.1">
         <span class="ltx_text" id="A4.T3.7.8.1.6.1.1.1" style="font-size:90%;">
          Chess
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.8.1.7.1">
        <span class="ltx_p" id="A4.T3.7.8.1.7.1.1">
         <span class="ltx_text" id="A4.T3.7.8.1.7.1.1.1" style="font-size:90%;">
          Endgames
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="A4.T3.7.8.1.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.8.1.8.1">
        <span class="ltx_p" id="A4.T3.7.8.1.8.1.1">
         <span class="ltx_text" id="A4.T3.7.8.1.8.1.1.1" style="font-size:90%;">
          Wordle
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.9.2">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T3.7.9.2.1" rowspan="3">
       <span class="ltx_text" id="A4.T3.7.9.2.1.1" style="font-size:90%;">
        BC
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.9.2.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.9.2.2.1">
        <span class="ltx_p" id="A4.T3.7.9.2.2.1.1">
         <span class="ltx_text" id="A4.T3.7.9.2.2.1.1.1" style="font-size:90%;">
          model
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.9.2.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.9.2.3.1">
        <span class="ltx_p" id="A4.T3.7.9.2.3.1.1">
         <span class="ltx_text" id="A4.T3.7.9.2.3.1.1.1" style="font-size:90%;">
          gpt2-medium, gpt2-medium, gpt2-xl
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.9.2.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.9.2.4.1">
        <span class="ltx_p" id="A4.T3.7.9.2.4.1.1">
         <span class="ltx_text" id="A4.T3.7.9.2.4.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.9.2.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.9.2.5.1">
        <span class="ltx_p" id="A4.T3.7.9.2.5.1.1">
         <span class="ltx_text" id="A4.T3.7.9.2.5.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.9.2.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.9.2.6.1">
        <span class="ltx_p" id="A4.T3.7.9.2.6.1.1">
         <span class="ltx_text" id="A4.T3.7.9.2.6.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.9.2.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.9.2.7.1">
        <span class="ltx_p" id="A4.T3.7.9.2.7.1.1">
         <span class="ltx_text" id="A4.T3.7.9.2.7.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.9.2.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.9.2.8.1">
        <span class="ltx_p" id="A4.T3.7.9.2.8.1.1">
         <span class="ltx_text" id="A4.T3.7.9.2.8.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.10.3">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.10.3.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.10.3.1.1">
        <span class="ltx_p" id="A4.T3.7.10.3.1.1.1">
         <span class="ltx_text" id="A4.T3.7.10.3.1.1.1.1" style="font-size:90%;">
          lr
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.10.3.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.10.3.2.1">
        <span class="ltx_p" id="A4.T3.7.10.3.2.1.1">
         <span class="ltx_text" id="A4.T3.7.10.3.2.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.10.3.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.10.3.3.1">
        <span class="ltx_p" id="A4.T3.7.10.3.3.1.1">
         <span class="ltx_text" id="A4.T3.7.10.3.3.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.10.3.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.10.3.4.1">
        <span class="ltx_p" id="A4.T3.7.10.3.4.1.1">
         <span class="ltx_text" id="A4.T3.7.10.3.4.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.10.3.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.10.3.5.1">
        <span class="ltx_p" id="A4.T3.7.10.3.5.1.1">
         <span class="ltx_text ltx_font_bold" id="A4.T3.7.10.3.5.1.1.1" style="font-size:90%;">
          1e-4
         </span>
         <span class="ltx_text" id="A4.T3.7.10.3.5.1.1.2" style="font-size:90%;">
          , 1e-5,
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.10.3.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.10.3.6.1">
        <span class="ltx_p" id="A4.T3.7.10.3.6.1.1">
         <span class="ltx_text" id="A4.T3.7.10.3.6.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.10.3.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.10.3.7.1">
        <span class="ltx_p" id="A4.T3.7.10.3.7.1.1">
         <span class="ltx_text" id="A4.T3.7.10.3.7.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.11.4">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.11.4.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.11.4.1.1">
        <span class="ltx_p" id="A4.T3.7.11.4.1.1.1">
         <span class="ltx_text" id="A4.T3.7.11.4.1.1.1.1" style="font-size:90%;">
          batch size
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.11.4.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.11.4.2.1">
        <span class="ltx_p" id="A4.T3.7.11.4.2.1.1">
         <span class="ltx_text" id="A4.T3.7.11.4.2.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.11.4.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.11.4.3.1">
        <span class="ltx_p" id="A4.T3.7.11.4.3.1.1">
         <span class="ltx_text" id="A4.T3.7.11.4.3.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.11.4.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.11.4.4.1">
        <span class="ltx_p" id="A4.T3.7.11.4.4.1.1">
         <span class="ltx_text" id="A4.T3.7.11.4.4.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.11.4.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.11.4.5.1">
        <span class="ltx_p" id="A4.T3.7.11.4.5.1.1">
         <span class="ltx_text ltx_font_bold" id="A4.T3.7.11.4.5.1.1.1" style="font-size:90%;">
          128
         </span>
         <span class="ltx_text" id="A4.T3.7.11.4.5.1.1.2" style="font-size:90%;">
          , 256, 32
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.11.4.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.11.4.6.1">
        <span class="ltx_p" id="A4.T3.7.11.4.6.1.1">
         <span class="ltx_text" id="A4.T3.7.11.4.6.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.11.4.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.11.4.7.1">
        <span class="ltx_p" id="A4.T3.7.11.4.7.1.1">
         <span class="ltx_text" id="A4.T3.7.11.4.7.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.12.5">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T3.7.12.5.1" rowspan="3">
       <span class="ltx_text" id="A4.T3.7.12.5.1.1" style="font-size:90%;">
        %BC
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.12.5.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.12.5.2.1">
        <span class="ltx_p" id="A4.T3.7.12.5.2.1.1">
         <span class="ltx_text" id="A4.T3.7.12.5.2.1.1.1" style="font-size:90%;">
          model
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.12.5.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.12.5.3.1">
        <span class="ltx_p" id="A4.T3.7.12.5.3.1.1">
         <span class="ltx_text" id="A4.T3.7.12.5.3.1.1.1" style="font-size:90%;">
          gpt2-medium, gpt2-medium, gpt2-xl
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.12.5.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.12.5.4.1">
        <span class="ltx_p" id="A4.T3.7.12.5.4.1.1">
         <span class="ltx_text" id="A4.T3.7.12.5.4.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.12.5.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.12.5.5.1">
        <span class="ltx_p" id="A4.T3.7.12.5.5.1.1">
         <span class="ltx_text" id="A4.T3.7.12.5.5.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.12.5.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.12.5.6.1">
        <span class="ltx_p" id="A4.T3.7.12.5.6.1.1">
         <span class="ltx_text" id="A4.T3.7.12.5.6.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.12.5.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.12.5.7.1">
        <span class="ltx_p" id="A4.T3.7.12.5.7.1.1">
         <span class="ltx_text" id="A4.T3.7.12.5.7.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.12.5.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.12.5.8.1">
        <span class="ltx_p" id="A4.T3.7.12.5.8.1.1">
         <span class="ltx_text" id="A4.T3.7.12.5.8.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.13.6">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.13.6.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.13.6.1.1">
        <span class="ltx_p" id="A4.T3.7.13.6.1.1.1">
         <span class="ltx_text" id="A4.T3.7.13.6.1.1.1.1" style="font-size:90%;">
          lr
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.13.6.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.13.6.2.1">
        <span class="ltx_p" id="A4.T3.7.13.6.2.1.1">
         <span class="ltx_text" id="A4.T3.7.13.6.2.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.13.6.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.13.6.3.1">
        <span class="ltx_p" id="A4.T3.7.13.6.3.1.1">
         <span class="ltx_text" id="A4.T3.7.13.6.3.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.13.6.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.13.6.4.1">
        <span class="ltx_p" id="A4.T3.7.13.6.4.1.1">
         <span class="ltx_text" id="A4.T3.7.13.6.4.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.13.6.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.13.6.5.1">
        <span class="ltx_p" id="A4.T3.7.13.6.5.1.1">
         <span class="ltx_text" id="A4.T3.7.13.6.5.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.13.6.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.13.6.6.1">
        <span class="ltx_p" id="A4.T3.7.13.6.6.1.1">
         <span class="ltx_text" id="A4.T3.7.13.6.6.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.13.6.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.13.6.7.1">
        <span class="ltx_p" id="A4.T3.7.13.6.7.1.1">
         <span class="ltx_text" id="A4.T3.7.13.6.7.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.14.7">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.14.7.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.14.7.1.1">
        <span class="ltx_p" id="A4.T3.7.14.7.1.1.1">
         <span class="ltx_text" id="A4.T3.7.14.7.1.1.1.1" style="font-size:90%;">
          batch size
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.14.7.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.14.7.2.1">
        <span class="ltx_p" id="A4.T3.7.14.7.2.1.1">
         <span class="ltx_text" id="A4.T3.7.14.7.2.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.14.7.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.14.7.3.1">
        <span class="ltx_p" id="A4.T3.7.14.7.3.1.1">
         <span class="ltx_text" id="A4.T3.7.14.7.3.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.14.7.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.14.7.4.1">
        <span class="ltx_p" id="A4.T3.7.14.7.4.1.1">
         <span class="ltx_text" id="A4.T3.7.14.7.4.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.14.7.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.14.7.5.1">
        <span class="ltx_p" id="A4.T3.7.14.7.5.1.1">
         <span class="ltx_text" id="A4.T3.7.14.7.5.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.14.7.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.14.7.6.1">
        <span class="ltx_p" id="A4.T3.7.14.7.6.1.1">
         <span class="ltx_text" id="A4.T3.7.14.7.6.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.14.7.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.14.7.7.1">
        <span class="ltx_p" id="A4.T3.7.14.7.7.1.1">
         <span class="ltx_text" id="A4.T3.7.14.7.7.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.15.8">
      <th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A4.T3.7.15.8.1">
      </th>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.15.8.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.15.8.2.1">
        <span class="ltx_p" id="A4.T3.7.15.8.2.1.1">
         <span class="ltx_text" id="A4.T3.7.15.8.2.1.1.1" style="font-size:90%;">
          filter method
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.15.8.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.15.8.3.1">
        <span class="ltx_p" id="A4.T3.7.15.8.3.1.1">
         <span class="ltx_text" id="A4.T3.7.15.8.3.1.1.1" style="font-size:90%;">
          top 10%
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.15.8.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.15.8.4.1">
        <span class="ltx_p" id="A4.T3.7.15.8.4.1.1">
         <span class="ltx_text" id="A4.T3.7.15.8.4.1.1.1" style="font-size:90%;">
          success
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.15.8.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.15.8.5.1">
        <span class="ltx_p" id="A4.T3.7.15.8.5.1.1">
         <span class="ltx_text" id="A4.T3.7.15.8.5.1.1.1" style="font-size:90%;">
          success
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.15.8.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.15.8.6.1">
        <span class="ltx_p" id="A4.T3.7.15.8.6.1.1">
         <span class="ltx_text" id="A4.T3.7.15.8.6.1.1.1" style="font-size:90%;">
          success
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.15.8.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.15.8.7.1">
        <span class="ltx_p" id="A4.T3.7.15.8.7.1.1">
         <span class="ltx_text" id="A4.T3.7.15.8.7.1.1.1" style="font-size:90%;">
          success
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.15.8.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.15.8.8.1">
        <span class="ltx_p" id="A4.T3.7.15.8.8.1.1">
         <span class="ltx_text" id="A4.T3.7.15.8.8.1.1.1" style="font-size:90%;">
          top 30%
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.16.9">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T3.7.16.9.1" rowspan="6">
       <span class="ltx_text" id="A4.T3.7.16.9.1.1" style="font-size:90%;">
        MC
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.16.9.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.16.9.2.1">
        <span class="ltx_p" id="A4.T3.7.16.9.2.1.1">
         <span class="ltx_text" id="A4.T3.7.16.9.2.1.1.1" style="font-size:90%;">
          model
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.16.9.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.16.9.3.1">
        <span class="ltx_p" id="A4.T3.7.16.9.3.1.1">
         <span class="ltx_text" id="A4.T3.7.16.9.3.1.1.1" style="font-size:90%;">
          gpt2-medium, gpt2-medium, gpt2-xl
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.16.9.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.16.9.4.1">
        <span class="ltx_p" id="A4.T3.7.16.9.4.1.1">
         <span class="ltx_text" id="A4.T3.7.16.9.4.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.16.9.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.16.9.5.1">
        <span class="ltx_p" id="A4.T3.7.16.9.5.1.1">
         <span class="ltx_text" id="A4.T3.7.16.9.5.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.16.9.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.16.9.6.1">
        <span class="ltx_p" id="A4.T3.7.16.9.6.1.1">
         <span class="ltx_text" id="A4.T3.7.16.9.6.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.16.9.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.16.9.7.1">
        <span class="ltx_p" id="A4.T3.7.16.9.7.1.1">
         <span class="ltx_text" id="A4.T3.7.16.9.7.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.16.9.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.16.9.8.1">
        <span class="ltx_p" id="A4.T3.7.16.9.8.1.1">
         <span class="ltx_text" id="A4.T3.7.16.9.8.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.17.10">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.17.10.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.17.10.1.1">
        <span class="ltx_p" id="A4.T3.7.17.10.1.1.1">
         <span class="ltx_text" id="A4.T3.7.17.10.1.1.1.1" style="font-size:90%;">
          lr
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.17.10.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.17.10.2.1">
        <span class="ltx_p" id="A4.T3.7.17.10.2.1.1">
         <span class="ltx_text" id="A4.T3.7.17.10.2.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.17.10.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.17.10.3.1">
        <span class="ltx_p" id="A4.T3.7.17.10.3.1.1">
         <span class="ltx_text" id="A4.T3.7.17.10.3.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.17.10.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.17.10.4.1">
        <span class="ltx_p" id="A4.T3.7.17.10.4.1.1">
         <span class="ltx_text" id="A4.T3.7.17.10.4.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.17.10.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.17.10.5.1">
        <span class="ltx_p" id="A4.T3.7.17.10.5.1.1">
         <span class="ltx_text" id="A4.T3.7.17.10.5.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.17.10.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.17.10.6.1">
        <span class="ltx_p" id="A4.T3.7.17.10.6.1.1">
         <span class="ltx_text" id="A4.T3.7.17.10.6.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.17.10.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.17.10.7.1">
        <span class="ltx_p" id="A4.T3.7.17.10.7.1.1">
         <span class="ltx_text" id="A4.T3.7.17.10.7.1.1.1" style="font-size:90%;">
          3e-5
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.18.11">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.18.11.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.18.11.1.1">
        <span class="ltx_p" id="A4.T3.7.18.11.1.1.1">
         <span class="ltx_text" id="A4.T3.7.18.11.1.1.1.1" style="font-size:90%;">
          batch size
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.18.11.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.18.11.2.1">
        <span class="ltx_p" id="A4.T3.7.18.11.2.1.1">
         <span class="ltx_text" id="A4.T3.7.18.11.2.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.18.11.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.18.11.3.1">
        <span class="ltx_p" id="A4.T3.7.18.11.3.1.1">
         <span class="ltx_text" id="A4.T3.7.18.11.3.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.18.11.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.18.11.4.1">
        <span class="ltx_p" id="A4.T3.7.18.11.4.1.1">
         <span class="ltx_text" id="A4.T3.7.18.11.4.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.18.11.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.18.11.5.1">
        <span class="ltx_p" id="A4.T3.7.18.11.5.1.1">
         <span class="ltx_text" id="A4.T3.7.18.11.5.1.1.1" style="font-size:90%;">
          64
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.18.11.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.18.11.6.1">
        <span class="ltx_p" id="A4.T3.7.18.11.6.1.1">
         <span class="ltx_text" id="A4.T3.7.18.11.6.1.1.1" style="font-size:90%;">
          64
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.18.11.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.18.11.7.1">
        <span class="ltx_p" id="A4.T3.7.18.11.7.1.1">
         <span class="ltx_text" id="A4.T3.7.18.11.7.1.1.1" style="font-size:90%;">
          32
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.1.1">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.1.1.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.1.1.1.1">
        <span class="ltx_p" id="A4.T3.1.1.1.1.1">
         <math alttext="\beta" class="ltx_Math" display="inline" id="A4.T3.1.1.1.1.1.m1.1">
          <semantics id="A4.T3.1.1.1.1.1.m1.1a">
           <mi id="A4.T3.1.1.1.1.1.m1.1.1" mathsize="90%" xref="A4.T3.1.1.1.1.1.m1.1.1.cmml">
            β
           </mi>
           <annotation-xml encoding="MathML-Content" id="A4.T3.1.1.1.1.1.m1.1b">
            <ci id="A4.T3.1.1.1.1.1.m1.1.1.cmml" xref="A4.T3.1.1.1.1.1.m1.1.1">
             𝛽
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A4.T3.1.1.1.1.1.m1.1c">
            \beta
           </annotation>
          </semantics>
         </math>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.1.1.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.1.1.2.1">
        <span class="ltx_p" id="A4.T3.1.1.2.1.1">
         <span class="ltx_text" id="A4.T3.1.1.2.1.1.1" style="font-size:90%;">
          16
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.1.1.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.1.1.3.1">
        <span class="ltx_p" id="A4.T3.1.1.3.1.1">
         <span class="ltx_text" id="A4.T3.1.1.3.1.1.1" style="font-size:90%;">
          16
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.1.1.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.1.1.4.1">
        <span class="ltx_p" id="A4.T3.1.1.4.1.1">
         <span class="ltx_text" id="A4.T3.1.1.4.1.1.1" style="font-size:90%;">
          4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.1.1.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.1.1.5.1">
        <span class="ltx_p" id="A4.T3.1.1.5.1.1">
         <span class="ltx_text" id="A4.T3.1.1.5.1.1.1" style="font-size:90%;">
          8
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.1.1.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.1.1.6.1">
        <span class="ltx_p" id="A4.T3.1.1.6.1.1">
         <span class="ltx_text" id="A4.T3.1.1.6.1.1.1" style="font-size:90%;">
          8
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.1.1.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.1.1.7.1">
        <span class="ltx_p" id="A4.T3.1.1.7.1.1">
         <span class="ltx_text" id="A4.T3.1.1.7.1.1.1" style="font-size:90%;">
          64
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.2.2">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.2.2.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.2.2.1.1">
        <span class="ltx_p" id="A4.T3.2.2.1.1.1">
         <span class="ltx_text" id="A4.T3.2.2.1.1.1.1" style="font-size:90%;">
          discount
         </span>
         <math alttext="\gamma" class="ltx_Math" display="inline" id="A4.T3.2.2.1.1.1.m1.1">
          <semantics id="A4.T3.2.2.1.1.1.m1.1a">
           <mi id="A4.T3.2.2.1.1.1.m1.1.1" mathsize="90%" xref="A4.T3.2.2.1.1.1.m1.1.1.cmml">
            γ
           </mi>
           <annotation-xml encoding="MathML-Content" id="A4.T3.2.2.1.1.1.m1.1b">
            <ci id="A4.T3.2.2.1.1.1.m1.1.1.cmml" xref="A4.T3.2.2.1.1.1.m1.1.1">
             𝛾
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A4.T3.2.2.1.1.1.m1.1c">
            \gamma
           </annotation>
          </semantics>
         </math>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.2.2.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.2.2.2.1">
        <span class="ltx_p" id="A4.T3.2.2.2.1.1">
         <span class="ltx_text" id="A4.T3.2.2.2.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.2.2.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.2.2.3.1">
        <span class="ltx_p" id="A4.T3.2.2.3.1.1">
         <span class="ltx_text" id="A4.T3.2.2.3.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.2.2.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.2.2.4.1">
        <span class="ltx_p" id="A4.T3.2.2.4.1.1">
         <span class="ltx_text" id="A4.T3.2.2.4.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.2.2.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.2.2.5.1">
        <span class="ltx_p" id="A4.T3.2.2.5.1.1">
         <span class="ltx_text" id="A4.T3.2.2.5.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.2.2.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.2.2.6.1">
        <span class="ltx_p" id="A4.T3.2.2.6.1.1">
         <span class="ltx_text" id="A4.T3.2.2.6.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.2.2.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.2.2.7.1">
        <span class="ltx_p" id="A4.T3.2.2.7.1.1">
         <span class="ltx_text" id="A4.T3.2.2.7.1.1.1" style="font-size:90%;">
          1.0
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.19.12">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.19.12.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.19.12.1.1">
        <span class="ltx_p" id="A4.T3.7.19.12.1.1.1">
         <span class="ltx_text" id="A4.T3.7.19.12.1.1.1.1" style="font-size:90%;">
          cql weight
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.19.12.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.19.12.2.1">
        <span class="ltx_p" id="A4.T3.7.19.12.2.1.1">
         <span class="ltx_text" id="A4.T3.7.19.12.2.1.1.1" style="font-size:90%;">
          0.001
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.19.12.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.19.12.3.1">
        <span class="ltx_p" id="A4.T3.7.19.12.3.1.1">
         <span class="ltx_text" id="A4.T3.7.19.12.3.1.1.1" style="font-size:90%;">
          0.5
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.19.12.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.19.12.4.1">
        <span class="ltx_p" id="A4.T3.7.19.12.4.1.1">
         <span class="ltx_text" id="A4.T3.7.19.12.4.1.1.1" style="font-size:90%;">
          0.001
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.19.12.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.19.12.5.1">
        <span class="ltx_p" id="A4.T3.7.19.12.5.1.1">
         <span class="ltx_text" id="A4.T3.7.19.12.5.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.19.12.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.19.12.6.1">
        <span class="ltx_p" id="A4.T3.7.19.12.6.1.1">
         <span class="ltx_text ltx_font_bold" id="A4.T3.7.19.12.6.1.1.1" style="font-size:90%;">
          1
         </span>
         <span class="ltx_text" id="A4.T3.7.19.12.6.1.1.2" style="font-size:90%;">
          , 1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.19.12.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.19.12.7.1">
        <span class="ltx_p" id="A4.T3.7.19.12.7.1.1">
         <span class="ltx_text" id="A4.T3.7.19.12.7.1.1.1" style="font-size:90%;">
          0.01
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.20.13">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T3.7.20.13.1" rowspan="7">
       <span class="ltx_text" id="A4.T3.7.20.13.1.1" style="font-size:90%;">
        ILQL
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.20.13.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.20.13.2.1">
        <span class="ltx_p" id="A4.T3.7.20.13.2.1.1">
         <span class="ltx_text" id="A4.T3.7.20.13.2.1.1.1" style="font-size:90%;">
          model
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.20.13.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.20.13.3.1">
        <span class="ltx_p" id="A4.T3.7.20.13.3.1.1">
         <span class="ltx_text" id="A4.T3.7.20.13.3.1.1.1" style="font-size:90%;">
          gpt2-medium, gpt2-medium, gpt2-xl
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.20.13.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.20.13.4.1">
        <span class="ltx_p" id="A4.T3.7.20.13.4.1.1">
         <span class="ltx_text" id="A4.T3.7.20.13.4.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.20.13.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.20.13.5.1">
        <span class="ltx_p" id="A4.T3.7.20.13.5.1.1">
         <span class="ltx_text" id="A4.T3.7.20.13.5.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.20.13.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.20.13.6.1">
        <span class="ltx_p" id="A4.T3.7.20.13.6.1.1">
         <span class="ltx_text" id="A4.T3.7.20.13.6.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.20.13.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.20.13.7.1">
        <span class="ltx_p" id="A4.T3.7.20.13.7.1.1">
         <span class="ltx_text" id="A4.T3.7.20.13.7.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.20.13.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.20.13.8.1">
        <span class="ltx_p" id="A4.T3.7.20.13.8.1.1">
         <span class="ltx_text" id="A4.T3.7.20.13.8.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.21.14">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.21.14.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.21.14.1.1">
        <span class="ltx_p" id="A4.T3.7.21.14.1.1.1">
         <span class="ltx_text" id="A4.T3.7.21.14.1.1.1.1" style="font-size:90%;">
          lr
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.21.14.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.21.14.2.1">
        <span class="ltx_p" id="A4.T3.7.21.14.2.1.1">
         <span class="ltx_text" id="A4.T3.7.21.14.2.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.21.14.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.21.14.3.1">
        <span class="ltx_p" id="A4.T3.7.21.14.3.1.1">
         <span class="ltx_text" id="A4.T3.7.21.14.3.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.21.14.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.21.14.4.1">
        <span class="ltx_p" id="A4.T3.7.21.14.4.1.1">
         <span class="ltx_text" id="A4.T3.7.21.14.4.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.21.14.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.21.14.5.1">
        <span class="ltx_p" id="A4.T3.7.21.14.5.1.1">
         <span class="ltx_text" id="A4.T3.7.21.14.5.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.21.14.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.21.14.6.1">
        <span class="ltx_p" id="A4.T3.7.21.14.6.1.1">
         <span class="ltx_text" id="A4.T3.7.21.14.6.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.21.14.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.21.14.7.1">
        <span class="ltx_p" id="A4.T3.7.21.14.7.1.1">
         <span class="ltx_text" id="A4.T3.7.21.14.7.1.1.1" style="font-size:90%;">
          3e-5
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.22.15">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.22.15.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.22.15.1.1">
        <span class="ltx_p" id="A4.T3.7.22.15.1.1.1">
         <span class="ltx_text" id="A4.T3.7.22.15.1.1.1.1" style="font-size:90%;">
          batch size
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.22.15.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.22.15.2.1">
        <span class="ltx_p" id="A4.T3.7.22.15.2.1.1">
         <span class="ltx_text" id="A4.T3.7.22.15.2.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.22.15.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.22.15.3.1">
        <span class="ltx_p" id="A4.T3.7.22.15.3.1.1">
         <span class="ltx_text" id="A4.T3.7.22.15.3.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.22.15.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.22.15.4.1">
        <span class="ltx_p" id="A4.T3.7.22.15.4.1.1">
         <span class="ltx_text" id="A4.T3.7.22.15.4.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.22.15.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.22.15.5.1">
        <span class="ltx_p" id="A4.T3.7.22.15.5.1.1">
         <span class="ltx_text" id="A4.T3.7.22.15.5.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.22.15.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.22.15.6.1">
        <span class="ltx_p" id="A4.T3.7.22.15.6.1.1">
         <span class="ltx_text" id="A4.T3.7.22.15.6.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.22.15.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.22.15.7.1">
        <span class="ltx_p" id="A4.T3.7.22.15.7.1.1">
         <span class="ltx_text" id="A4.T3.7.22.15.7.1.1.1" style="font-size:90%;">
          32
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.3.3">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.3.3.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.3.3.1.1">
        <span class="ltx_p" id="A4.T3.3.3.1.1.1">
         <math alttext="\beta" class="ltx_Math" display="inline" id="A4.T3.3.3.1.1.1.m1.1">
          <semantics id="A4.T3.3.3.1.1.1.m1.1a">
           <mi id="A4.T3.3.3.1.1.1.m1.1.1" mathsize="90%" xref="A4.T3.3.3.1.1.1.m1.1.1.cmml">
            β
           </mi>
           <annotation-xml encoding="MathML-Content" id="A4.T3.3.3.1.1.1.m1.1b">
            <ci id="A4.T3.3.3.1.1.1.m1.1.1.cmml" xref="A4.T3.3.3.1.1.1.m1.1.1">
             𝛽
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A4.T3.3.3.1.1.1.m1.1c">
            \beta
           </annotation>
          </semantics>
         </math>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.3.3.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.3.3.2.1">
        <span class="ltx_p" id="A4.T3.3.3.2.1.1">
         <span class="ltx_text" id="A4.T3.3.3.2.1.1.1" style="font-size:90%;">
          4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.3.3.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.3.3.3.1">
        <span class="ltx_p" id="A4.T3.3.3.3.1.1">
         <span class="ltx_text" id="A4.T3.3.3.3.1.1.1" style="font-size:90%;">
          16
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.3.3.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.3.3.4.1">
        <span class="ltx_p" id="A4.T3.3.3.4.1.1">
         <span class="ltx_text" id="A4.T3.3.3.4.1.1.1" style="font-size:90%;">
          1
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.3.3.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.3.3.5.1">
        <span class="ltx_p" id="A4.T3.3.3.5.1.1">
         <span class="ltx_text" id="A4.T3.3.3.5.1.1.1" style="font-size:90%;">
          8
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.3.3.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.3.3.6.1">
        <span class="ltx_p" id="A4.T3.3.3.6.1.1">
         <span class="ltx_text" id="A4.T3.3.3.6.1.1.1" style="font-size:90%;">
          8
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.3.3.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.3.3.7.1">
        <span class="ltx_p" id="A4.T3.3.3.7.1.1">
         <span class="ltx_text" id="A4.T3.3.3.7.1.1.1" style="font-size:90%;">
          32
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.23.16">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.23.16.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.23.16.1.1">
        <span class="ltx_p" id="A4.T3.7.23.16.1.1.1">
         <span class="ltx_text" id="A4.T3.7.23.16.1.1.1.1" style="font-size:90%;">
          cql weight
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.23.16.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.23.16.2.1">
        <span class="ltx_p" id="A4.T3.7.23.16.2.1.1">
         <span class="ltx_text" id="A4.T3.7.23.16.2.1.1.1" style="font-size:90%;">
          0.001
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.23.16.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.23.16.3.1">
        <span class="ltx_p" id="A4.T3.7.23.16.3.1.1">
         <span class="ltx_text" id="A4.T3.7.23.16.3.1.1.1" style="font-size:90%;">
          0.5
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.23.16.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.23.16.4.1">
        <span class="ltx_p" id="A4.T3.7.23.16.4.1.1">
         <span class="ltx_text" id="A4.T3.7.23.16.4.1.1.1" style="font-size:90%;">
          0.001
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.23.16.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.23.16.5.1">
        <span class="ltx_p" id="A4.T3.7.23.16.5.1.1">
         <span class="ltx_text" id="A4.T3.7.23.16.5.1.1.1" style="font-size:90%;">
          1e-4
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.23.16.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.23.16.6.1">
        <span class="ltx_p" id="A4.T3.7.23.16.6.1.1">
         <span class="ltx_text" id="A4.T3.7.23.16.6.1.1.1" style="font-size:90%;">
          1
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.23.16.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.23.16.7.1">
        <span class="ltx_p" id="A4.T3.7.23.16.7.1.1">
         <span class="ltx_text" id="A4.T3.7.23.16.7.1.1.1" style="font-size:90%;">
          0.01
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.4.4">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.4.4.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.4.4.1.1">
        <span class="ltx_p" id="A4.T3.4.4.1.1.1">
         <span class="ltx_text" id="A4.T3.4.4.1.1.1.1" style="font-size:90%;">
          expectile
         </span>
         <math alttext="\tau" class="ltx_Math" display="inline" id="A4.T3.4.4.1.1.1.m1.1">
          <semantics id="A4.T3.4.4.1.1.1.m1.1a">
           <mi id="A4.T3.4.4.1.1.1.m1.1.1" mathsize="90%" xref="A4.T3.4.4.1.1.1.m1.1.1.cmml">
            τ
           </mi>
           <annotation-xml encoding="MathML-Content" id="A4.T3.4.4.1.1.1.m1.1b">
            <ci id="A4.T3.4.4.1.1.1.m1.1.1.cmml" xref="A4.T3.4.4.1.1.1.m1.1.1">
             𝜏
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A4.T3.4.4.1.1.1.m1.1c">
            \tau
           </annotation>
          </semantics>
         </math>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.4.4.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.4.4.2.1">
        <span class="ltx_p" id="A4.T3.4.4.2.1.1">
         <span class="ltx_text" id="A4.T3.4.4.2.1.1.1" style="font-size:90%;">
          0.7
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.4.4.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.4.4.3.1">
        <span class="ltx_p" id="A4.T3.4.4.3.1.1">
         <span class="ltx_text" id="A4.T3.4.4.3.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.4.4.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.4.4.4.1">
        <span class="ltx_p" id="A4.T3.4.4.4.1.1">
         <span class="ltx_text" id="A4.T3.4.4.4.1.1.1" style="font-size:90%;">
          0.7
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.4.4.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.4.4.5.1">
        <span class="ltx_p" id="A4.T3.4.4.5.1.1">
         <span class="ltx_text" id="A4.T3.4.4.5.1.1.1" style="font-size:90%;">
          0.7
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.4.4.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.4.4.6.1">
        <span class="ltx_p" id="A4.T3.4.4.6.1.1">
         <span class="ltx_text" id="A4.T3.4.4.6.1.1.1" style="font-size:90%;">
          0.7
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.4.4.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.4.4.7.1">
        <span class="ltx_p" id="A4.T3.4.4.7.1.1">
         <span class="ltx_text" id="A4.T3.4.4.7.1.1.1" style="font-size:90%;">
          0.7
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.5.5">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.5.5.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.5.5.1.1">
        <span class="ltx_p" id="A4.T3.5.5.1.1.1">
         <span class="ltx_text" id="A4.T3.5.5.1.1.1.1" style="font-size:90%;">
          discount
         </span>
         <math alttext="\gamma" class="ltx_Math" display="inline" id="A4.T3.5.5.1.1.1.m1.1">
          <semantics id="A4.T3.5.5.1.1.1.m1.1a">
           <mi id="A4.T3.5.5.1.1.1.m1.1.1" mathsize="90%" xref="A4.T3.5.5.1.1.1.m1.1.1.cmml">
            γ
           </mi>
           <annotation-xml encoding="MathML-Content" id="A4.T3.5.5.1.1.1.m1.1b">
            <ci id="A4.T3.5.5.1.1.1.m1.1.1.cmml" xref="A4.T3.5.5.1.1.1.m1.1.1">
             𝛾
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A4.T3.5.5.1.1.1.m1.1c">
            \gamma
           </annotation>
          </semantics>
         </math>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.5.5.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.5.5.2.1">
        <span class="ltx_p" id="A4.T3.5.5.2.1.1">
         <span class="ltx_text" id="A4.T3.5.5.2.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.5.5.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.5.5.3.1">
        <span class="ltx_p" id="A4.T3.5.5.3.1.1">
         <span class="ltx_text" id="A4.T3.5.5.3.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.5.5.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.5.5.4.1">
        <span class="ltx_p" id="A4.T3.5.5.4.1.1">
         <span class="ltx_text" id="A4.T3.5.5.4.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.5.5.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.5.5.5.1">
        <span class="ltx_p" id="A4.T3.5.5.5.1.1">
         <span class="ltx_text" id="A4.T3.5.5.5.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.5.5.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.5.5.6.1">
        <span class="ltx_p" id="A4.T3.5.5.6.1.1">
         <span class="ltx_text" id="A4.T3.5.5.6.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.5.5.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.5.5.7.1">
        <span class="ltx_p" id="A4.T3.5.5.7.1.1">
         <span class="ltx_text" id="A4.T3.5.5.7.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.24.17">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T3.7.24.17.1" rowspan="8">
       <span class="ltx_text" id="A4.T3.7.24.17.1.1" style="font-size:90%;">
        PPO
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.24.17.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.24.17.2.1">
        <span class="ltx_p" id="A4.T3.7.24.17.2.1.1">
         <span class="ltx_text" id="A4.T3.7.24.17.2.1.1.1" style="font-size:90%;">
          model
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.24.17.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.24.17.3.1">
        <span class="ltx_p" id="A4.T3.7.24.17.3.1.1">
         <span class="ltx_text" id="A4.T3.7.24.17.3.1.1.1" style="font-size:90%;">
          gpt2-medium, gpt2-medium, gpt2-xl
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.24.17.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.24.17.4.1">
        <span class="ltx_p" id="A4.T3.7.24.17.4.1.1">
         <span class="ltx_text" id="A4.T3.7.24.17.4.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.24.17.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.24.17.5.1">
        <span class="ltx_p" id="A4.T3.7.24.17.5.1.1">
         <span class="ltx_text" id="A4.T3.7.24.17.5.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.24.17.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.24.17.6.1">
        <span class="ltx_p" id="A4.T3.7.24.17.6.1.1">
         <span class="ltx_text" id="A4.T3.7.24.17.6.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.24.17.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.24.17.7.1">
        <span class="ltx_p" id="A4.T3.7.24.17.7.1.1">
         <span class="ltx_text" id="A4.T3.7.24.17.7.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A4.T3.7.24.17.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.24.17.8.1">
        <span class="ltx_p" id="A4.T3.7.24.17.8.1.1">
         <span class="ltx_text" id="A4.T3.7.24.17.8.1.1.1" style="font-size:90%;">
          gpt2-small
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.25.18">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.25.18.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.25.18.1.1">
        <span class="ltx_p" id="A4.T3.7.25.18.1.1.1">
         <span class="ltx_text" id="A4.T3.7.25.18.1.1.1.1" style="font-size:90%;">
          lr
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.25.18.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.25.18.2.1">
        <span class="ltx_p" id="A4.T3.7.25.18.2.1.1">
         <span class="ltx_text" id="A4.T3.7.25.18.2.1.1.1" style="font-size:90%;">
          1e-6
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.25.18.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.25.18.3.1">
        <span class="ltx_p" id="A4.T3.7.25.18.3.1.1">
         <span class="ltx_text" id="A4.T3.7.25.18.3.1.1.1" style="font-size:90%;">
          1e-6
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.25.18.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.25.18.4.1">
        <span class="ltx_p" id="A4.T3.7.25.18.4.1.1">
         <span class="ltx_text" id="A4.T3.7.25.18.4.1.1.1" style="font-size:90%;">
          5e-6
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.25.18.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.25.18.5.1">
        <span class="ltx_p" id="A4.T3.7.25.18.5.1.1">
         <span class="ltx_text" id="A4.T3.7.25.18.5.1.1.1" style="font-size:90%;">
          1e-5
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.25.18.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.25.18.6.1">
        <span class="ltx_p" id="A4.T3.7.25.18.6.1.1">
         <span class="ltx_text" id="A4.T3.7.25.18.6.1.1.1" style="font-size:90%;">
          1e-5
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.25.18.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.25.18.7.1">
        <span class="ltx_p" id="A4.T3.7.25.18.7.1.1">
         <span class="ltx_text" id="A4.T3.7.25.18.7.1.1.1" style="font-size:90%;">
          3e-5
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.26.19">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.26.19.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.26.19.1.1">
        <span class="ltx_p" id="A4.T3.7.26.19.1.1.1">
         <span class="ltx_text" id="A4.T3.7.26.19.1.1.1.1" style="font-size:90%;">
          rollouts
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.26.19.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.26.19.2.1">
        <span class="ltx_p" id="A4.T3.7.26.19.2.1.1">
         <span class="ltx_text" id="A4.T3.7.26.19.2.1.1.1" style="font-size:90%;">
          2048
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.26.19.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.26.19.3.1">
        <span class="ltx_p" id="A4.T3.7.26.19.3.1.1">
         <span class="ltx_text" id="A4.T3.7.26.19.3.1.1.1" style="font-size:90%;">
          512
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.26.19.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.26.19.4.1">
        <span class="ltx_p" id="A4.T3.7.26.19.4.1.1">
         <span class="ltx_text" id="A4.T3.7.26.19.4.1.1.1" style="font-size:90%;">
          4000
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.26.19.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.26.19.5.1">
        <span class="ltx_p" id="A4.T3.7.26.19.5.1.1">
         <span class="ltx_text" id="A4.T3.7.26.19.5.1.1.1" style="font-size:90%;">
          1024
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.26.19.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.26.19.6.1">
        <span class="ltx_p" id="A4.T3.7.26.19.6.1.1">
         <span class="ltx_text" id="A4.T3.7.26.19.6.1.1.1" style="font-size:90%;">
          512
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.26.19.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.26.19.7.1">
        <span class="ltx_p" id="A4.T3.7.26.19.7.1.1">
         <span class="ltx_text" id="A4.T3.7.26.19.7.1.1.1" style="font-size:90%;">
          512
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.27.20">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.27.20.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.27.20.1.1">
        <span class="ltx_p" id="A4.T3.7.27.20.1.1.1">
         <span class="ltx_text" id="A4.T3.7.27.20.1.1.1.1" style="font-size:90%;">
          batch size
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.27.20.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.27.20.2.1">
        <span class="ltx_p" id="A4.T3.7.27.20.2.1.1">
         <span class="ltx_text" id="A4.T3.7.27.20.2.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.27.20.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.27.20.3.1">
        <span class="ltx_p" id="A4.T3.7.27.20.3.1.1">
         <span class="ltx_text" id="A4.T3.7.27.20.3.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.27.20.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.27.20.4.1">
        <span class="ltx_p" id="A4.T3.7.27.20.4.1.1">
         <span class="ltx_text" id="A4.T3.7.27.20.4.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.27.20.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.27.20.5.1">
        <span class="ltx_p" id="A4.T3.7.27.20.5.1.1">
         <span class="ltx_text" id="A4.T3.7.27.20.5.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.27.20.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.27.20.6.1">
        <span class="ltx_p" id="A4.T3.7.27.20.6.1.1">
         <span class="ltx_text" id="A4.T3.7.27.20.6.1.1.1" style="font-size:90%;">
          128
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.27.20.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.27.20.7.1">
        <span class="ltx_p" id="A4.T3.7.27.20.7.1.1">
         <span class="ltx_text" id="A4.T3.7.27.20.7.1.1.1" style="font-size:90%;">
          32
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.6.6">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.6.6.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.6.6.1.1">
        <span class="ltx_p" id="A4.T3.6.6.1.1.1">
         <span class="ltx_text" id="A4.T3.6.6.1.1.1.1" style="font-size:90%;">
          GAE
         </span>
         <math alttext="\lambda" class="ltx_Math" display="inline" id="A4.T3.6.6.1.1.1.m1.1">
          <semantics id="A4.T3.6.6.1.1.1.m1.1a">
           <mi id="A4.T3.6.6.1.1.1.m1.1.1" mathsize="90%" xref="A4.T3.6.6.1.1.1.m1.1.1.cmml">
            λ
           </mi>
           <annotation-xml encoding="MathML-Content" id="A4.T3.6.6.1.1.1.m1.1b">
            <ci id="A4.T3.6.6.1.1.1.m1.1.1.cmml" xref="A4.T3.6.6.1.1.1.m1.1.1">
             𝜆
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A4.T3.6.6.1.1.1.m1.1c">
            \lambda
           </annotation>
          </semantics>
         </math>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.6.6.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.6.6.2.1">
        <span class="ltx_p" id="A4.T3.6.6.2.1.1">
         <span class="ltx_text" id="A4.T3.6.6.2.1.1.1" style="font-size:90%;">
          0.95
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.6.6.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.6.6.3.1">
        <span class="ltx_p" id="A4.T3.6.6.3.1.1">
         <span class="ltx_text" id="A4.T3.6.6.3.1.1.1" style="font-size:90%;">
          0.95
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.6.6.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.6.6.4.1">
        <span class="ltx_p" id="A4.T3.6.6.4.1.1">
         <span class="ltx_text" id="A4.T3.6.6.4.1.1.1" style="font-size:90%;">
          0.95
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.6.6.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.6.6.5.1">
        <span class="ltx_p" id="A4.T3.6.6.5.1.1">
         <span class="ltx_text" id="A4.T3.6.6.5.1.1.1" style="font-size:90%;">
          0.95
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.6.6.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.6.6.6.1">
        <span class="ltx_p" id="A4.T3.6.6.6.1.1">
         <span class="ltx_text" id="A4.T3.6.6.6.1.1.1" style="font-size:90%;">
          0.95
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.6.6.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.6.6.7.1">
        <span class="ltx_p" id="A4.T3.6.6.7.1.1">
         <span class="ltx_text" id="A4.T3.6.6.7.1.1.1" style="font-size:90%;">
          0.95
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.7">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.7.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.7.1.1">
        <span class="ltx_p" id="A4.T3.7.7.1.1.1">
         <span class="ltx_text" id="A4.T3.7.7.1.1.1.1" style="font-size:90%;">
          discount
         </span>
         <math alttext="\gamma" class="ltx_Math" display="inline" id="A4.T3.7.7.1.1.1.m1.1">
          <semantics id="A4.T3.7.7.1.1.1.m1.1a">
           <mi id="A4.T3.7.7.1.1.1.m1.1.1" mathsize="90%" xref="A4.T3.7.7.1.1.1.m1.1.1.cmml">
            γ
           </mi>
           <annotation-xml encoding="MathML-Content" id="A4.T3.7.7.1.1.1.m1.1b">
            <ci id="A4.T3.7.7.1.1.1.m1.1.1.cmml" xref="A4.T3.7.7.1.1.1.m1.1.1">
             𝛾
            </ci>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="A4.T3.7.7.1.1.1.m1.1c">
            \gamma
           </annotation>
          </semantics>
         </math>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.7.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.7.2.1">
        <span class="ltx_p" id="A4.T3.7.7.2.1.1">
         <span class="ltx_text" id="A4.T3.7.7.2.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.7.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.7.3.1">
        <span class="ltx_p" id="A4.T3.7.7.3.1.1">
         <span class="ltx_text" id="A4.T3.7.7.3.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.7.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.7.4.1">
        <span class="ltx_p" id="A4.T3.7.7.4.1.1">
         <span class="ltx_text" id="A4.T3.7.7.4.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.7.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.7.5.1">
        <span class="ltx_p" id="A4.T3.7.7.5.1.1">
         <span class="ltx_text" id="A4.T3.7.7.5.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.7.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.7.6.1">
        <span class="ltx_p" id="A4.T3.7.7.6.1.1">
         <span class="ltx_text" id="A4.T3.7.7.6.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.7.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.7.7.1">
        <span class="ltx_p" id="A4.T3.7.7.7.1.1">
         <span class="ltx_text" id="A4.T3.7.7.7.1.1.1" style="font-size:90%;">
          0.99
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.28.21">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.28.21.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.28.21.1.1">
        <span class="ltx_p" id="A4.T3.7.28.21.1.1.1">
         <span class="ltx_text" id="A4.T3.7.28.21.1.1.1.1" style="font-size:90%;">
          KL coef.
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.28.21.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.28.21.2.1">
        <span class="ltx_p" id="A4.T3.7.28.21.2.1.1">
         <span class="ltx_text" id="A4.T3.7.28.21.2.1.1.1" style="font-size:90%;">
          0.01
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.28.21.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.28.21.3.1">
        <span class="ltx_p" id="A4.T3.7.28.21.3.1.1">
         <span class="ltx_text" id="A4.T3.7.28.21.3.1.1.1" style="font-size:90%;">
          0.1
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.28.21.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.28.21.4.1">
        <span class="ltx_p" id="A4.T3.7.28.21.4.1.1">
         <span class="ltx_text" id="A4.T3.7.28.21.4.1.1.1" style="font-size:90%;">
          0.01
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.28.21.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.28.21.5.1">
        <span class="ltx_p" id="A4.T3.7.28.21.5.1.1">
         <span class="ltx_text" id="A4.T3.7.28.21.5.1.1.1" style="font-size:90%;">
          0.01
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.28.21.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.28.21.6.1">
        <span class="ltx_p" id="A4.T3.7.28.21.6.1.1">
         <span class="ltx_text" id="A4.T3.7.28.21.6.1.1.1" style="font-size:90%;">
          0.01
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.28.21.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.28.21.7.1">
        <span class="ltx_p" id="A4.T3.7.28.21.7.1.1">
         <span class="ltx_text" id="A4.T3.7.28.21.7.1.1.1" style="font-size:90%;">
          0.001
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.29.22">
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.29.22.1">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.29.22.1.1">
        <span class="ltx_p" id="A4.T3.7.29.22.1.1.1">
         <span class="ltx_text" id="A4.T3.7.29.22.1.1.1.1" style="font-size:90%;">
          clip range
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.29.22.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.29.22.2.1">
        <span class="ltx_p" id="A4.T3.7.29.22.2.1.1">
         <span class="ltx_text" id="A4.T3.7.29.22.2.1.1.1" style="font-size:90%;">
          0.2
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.29.22.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.29.22.3.1">
        <span class="ltx_p" id="A4.T3.7.29.22.3.1.1">
         <span class="ltx_text" id="A4.T3.7.29.22.3.1.1.1" style="font-size:90%;">
          0.2
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.29.22.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.29.22.4.1">
        <span class="ltx_p" id="A4.T3.7.29.22.4.1.1">
         <span class="ltx_text" id="A4.T3.7.29.22.4.1.1.1" style="font-size:90%;">
          0.2
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.29.22.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.29.22.5.1">
        <span class="ltx_p" id="A4.T3.7.29.22.5.1.1">
         <span class="ltx_text" id="A4.T3.7.29.22.5.1.1.1" style="font-size:90%;">
          0.2
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.29.22.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.29.22.6.1">
        <span class="ltx_p" id="A4.T3.7.29.22.6.1.1">
         <span class="ltx_text" id="A4.T3.7.29.22.6.1.1.1" style="font-size:90%;">
          0.2
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_r" id="A4.T3.7.29.22.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.29.22.7.1">
        <span class="ltx_p" id="A4.T3.7.29.22.7.1.1">
         <span class="ltx_text" id="A4.T3.7.29.22.7.1.1.1" style="font-size:90%;">
          0.2
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T3.7.30.23">
      <th class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.1">
      </th>
      <td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.30.23.2.1">
        <span class="ltx_p" id="A4.T3.7.30.23.2.1.1">
         <span class="ltx_text" id="A4.T3.7.30.23.2.1.1.1" style="font-size:90%;">
          BC loss weight
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.3">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.30.23.3.1">
        <span class="ltx_p" id="A4.T3.7.30.23.3.1.1">
         <span class="ltx_text" id="A4.T3.7.30.23.3.1.1.1" style="font-size:90%;">
          0
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.4">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.30.23.4.1">
        <span class="ltx_p" id="A4.T3.7.30.23.4.1.1">
         <span class="ltx_text" id="A4.T3.7.30.23.4.1.1.1" style="font-size:90%;">
          0
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.5">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.30.23.5.1">
        <span class="ltx_p" id="A4.T3.7.30.23.5.1.1">
         <span class="ltx_text" id="A4.T3.7.30.23.5.1.1.1" style="font-size:90%;">
          0
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.6">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.30.23.6.1">
        <span class="ltx_p" id="A4.T3.7.30.23.6.1.1">
         <span class="ltx_text" id="A4.T3.7.30.23.6.1.1.1" style="font-size:90%;">
          0
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.7">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.30.23.7.1">
        <span class="ltx_p" id="A4.T3.7.30.23.7.1.1">
         <span class="ltx_text" id="A4.T3.7.30.23.7.1.1.1" style="font-size:90%;">
          0
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="A4.T3.7.30.23.8">
       <span class="ltx_inline-block ltx_align_top" id="A4.T3.7.30.23.8.1">
        <span class="ltx_p" id="A4.T3.7.30.23.8.1.1">
         <span class="ltx_text" id="A4.T3.7.30.23.8.1.1.1" style="font-size:90%;">
          10
         </span>
        </span>
       </span>
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 3:
    </span>
    Hyperparameters for baseline experiments.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="A5" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix E
   </span>
   Evaluation Details
  </h2>
  <div class="ltx_para" id="A5.p1">
   <p class="ltx_p" id="A5.p1.1">
    We normalize
    <a class="ltx_ref" href="#A7.T9" title="In Appendix G Symbolic Maze Environment ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Table
     </span>
     <span class="ltx_text ltx_ref_tag">
      9
     </span>
    </a>
    such that 50 is the dataset average return, 0 is the minimum, and 100 is the maximum. The normalization process works as follows: if the reward is greater than the average return we calculate:
   </p>
  </div>
  <div class="ltx_para" id="A5.p2">
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A10.EGx1">
    <tbody id="A5.Ex1">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\text{score}=50+\frac{\text{raw return}-\text{dataset average}}{\text{max raw return}-\text{dataset average}}\times 50" class="ltx_Math" display="inline" id="A5.Ex1.m1.1">
        <semantics id="A5.Ex1.m1.1a">
         <mrow id="A5.Ex1.m1.1.1" xref="A5.Ex1.m1.1.1.cmml">
          <mtext id="A5.Ex1.m1.1.1.2" xref="A5.Ex1.m1.1.1.2a.cmml">
           score
          </mtext>
          <mo id="A5.Ex1.m1.1.1.1" xref="A5.Ex1.m1.1.1.1.cmml">
           =
          </mo>
          <mrow id="A5.Ex1.m1.1.1.3" xref="A5.Ex1.m1.1.1.3.cmml">
           <mn id="A5.Ex1.m1.1.1.3.2" xref="A5.Ex1.m1.1.1.3.2.cmml">
            50
           </mn>
           <mo id="A5.Ex1.m1.1.1.3.1" xref="A5.Ex1.m1.1.1.3.1.cmml">
            +
           </mo>
           <mrow id="A5.Ex1.m1.1.1.3.3" xref="A5.Ex1.m1.1.1.3.3.cmml">
            <mstyle displaystyle="true" id="A5.Ex1.m1.1.1.3.3.2" xref="A5.Ex1.m1.1.1.3.3.2.cmml">
             <mfrac id="A5.Ex1.m1.1.1.3.3.2a" xref="A5.Ex1.m1.1.1.3.3.2.cmml">
              <mrow id="A5.Ex1.m1.1.1.3.3.2.2" xref="A5.Ex1.m1.1.1.3.3.2.2.cmml">
               <mtext id="A5.Ex1.m1.1.1.3.3.2.2.2" xref="A5.Ex1.m1.1.1.3.3.2.2.2a.cmml">
                raw return
               </mtext>
               <mo id="A5.Ex1.m1.1.1.3.3.2.2.1" xref="A5.Ex1.m1.1.1.3.3.2.2.1.cmml">
                −
               </mo>
               <mtext id="A5.Ex1.m1.1.1.3.3.2.2.3" xref="A5.Ex1.m1.1.1.3.3.2.2.3a.cmml">
                dataset average
               </mtext>
              </mrow>
              <mrow id="A5.Ex1.m1.1.1.3.3.2.3" xref="A5.Ex1.m1.1.1.3.3.2.3.cmml">
               <mtext id="A5.Ex1.m1.1.1.3.3.2.3.2" xref="A5.Ex1.m1.1.1.3.3.2.3.2a.cmml">
                max raw return
               </mtext>
               <mo id="A5.Ex1.m1.1.1.3.3.2.3.1" xref="A5.Ex1.m1.1.1.3.3.2.3.1.cmml">
                −
               </mo>
               <mtext id="A5.Ex1.m1.1.1.3.3.2.3.3" xref="A5.Ex1.m1.1.1.3.3.2.3.3a.cmml">
                dataset average
               </mtext>
              </mrow>
             </mfrac>
            </mstyle>
            <mo id="A5.Ex1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A5.Ex1.m1.1.1.3.3.1.cmml">
             ×
            </mo>
            <mn id="A5.Ex1.m1.1.1.3.3.3" xref="A5.Ex1.m1.1.1.3.3.3.cmml">
             50
            </mn>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A5.Ex1.m1.1b">
          <apply id="A5.Ex1.m1.1.1.cmml" xref="A5.Ex1.m1.1.1">
           <eq id="A5.Ex1.m1.1.1.1.cmml" xref="A5.Ex1.m1.1.1.1">
           </eq>
           <ci id="A5.Ex1.m1.1.1.2a.cmml" xref="A5.Ex1.m1.1.1.2">
            <mtext id="A5.Ex1.m1.1.1.2.cmml" xref="A5.Ex1.m1.1.1.2">
             score
            </mtext>
           </ci>
           <apply id="A5.Ex1.m1.1.1.3.cmml" xref="A5.Ex1.m1.1.1.3">
            <plus id="A5.Ex1.m1.1.1.3.1.cmml" xref="A5.Ex1.m1.1.1.3.1">
            </plus>
            <cn id="A5.Ex1.m1.1.1.3.2.cmml" type="integer" xref="A5.Ex1.m1.1.1.3.2">
             50
            </cn>
            <apply id="A5.Ex1.m1.1.1.3.3.cmml" xref="A5.Ex1.m1.1.1.3.3">
             <times id="A5.Ex1.m1.1.1.3.3.1.cmml" xref="A5.Ex1.m1.1.1.3.3.1">
             </times>
             <apply id="A5.Ex1.m1.1.1.3.3.2.cmml" xref="A5.Ex1.m1.1.1.3.3.2">
              <divide id="A5.Ex1.m1.1.1.3.3.2.1.cmml" xref="A5.Ex1.m1.1.1.3.3.2">
              </divide>
              <apply id="A5.Ex1.m1.1.1.3.3.2.2.cmml" xref="A5.Ex1.m1.1.1.3.3.2.2">
               <minus id="A5.Ex1.m1.1.1.3.3.2.2.1.cmml" xref="A5.Ex1.m1.1.1.3.3.2.2.1">
               </minus>
               <ci id="A5.Ex1.m1.1.1.3.3.2.2.2a.cmml" xref="A5.Ex1.m1.1.1.3.3.2.2.2">
                <mtext id="A5.Ex1.m1.1.1.3.3.2.2.2.cmml" xref="A5.Ex1.m1.1.1.3.3.2.2.2">
                 raw return
                </mtext>
               </ci>
               <ci id="A5.Ex1.m1.1.1.3.3.2.2.3a.cmml" xref="A5.Ex1.m1.1.1.3.3.2.2.3">
                <mtext id="A5.Ex1.m1.1.1.3.3.2.2.3.cmml" xref="A5.Ex1.m1.1.1.3.3.2.2.3">
                 dataset average
                </mtext>
               </ci>
              </apply>
              <apply id="A5.Ex1.m1.1.1.3.3.2.3.cmml" xref="A5.Ex1.m1.1.1.3.3.2.3">
               <minus id="A5.Ex1.m1.1.1.3.3.2.3.1.cmml" xref="A5.Ex1.m1.1.1.3.3.2.3.1">
               </minus>
               <ci id="A5.Ex1.m1.1.1.3.3.2.3.2a.cmml" xref="A5.Ex1.m1.1.1.3.3.2.3.2">
                <mtext id="A5.Ex1.m1.1.1.3.3.2.3.2.cmml" xref="A5.Ex1.m1.1.1.3.3.2.3.2">
                 max raw return
                </mtext>
               </ci>
               <ci id="A5.Ex1.m1.1.1.3.3.2.3.3a.cmml" xref="A5.Ex1.m1.1.1.3.3.2.3.3">
                <mtext id="A5.Ex1.m1.1.1.3.3.2.3.3.cmml" xref="A5.Ex1.m1.1.1.3.3.2.3.3">
                 dataset average
                </mtext>
               </ci>
              </apply>
             </apply>
             <cn id="A5.Ex1.m1.1.1.3.3.3.cmml" type="integer" xref="A5.Ex1.m1.1.1.3.3.3">
              50
             </cn>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A5.Ex1.m1.1c">
          \displaystyle\text{score}=50+\frac{\text{raw return}-\text{dataset average}}{\text{max raw return}-\text{dataset average}}\times 50
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="A5.p3">
   <p class="ltx_p" id="A5.p3.1">
    Otherwise if the reward is less than the average return we calculate
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A10.EGx2">
    <tbody id="A5.Ex2">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\text{score}=\frac{\text{raw return}-\text{min raw return}}{\text{dataset average}-\text{min raw return}}\times 50" class="ltx_Math" display="inline" id="A5.Ex2.m1.1">
        <semantics id="A5.Ex2.m1.1a">
         <mrow id="A5.Ex2.m1.1.1" xref="A5.Ex2.m1.1.1.cmml">
          <mtext id="A5.Ex2.m1.1.1.2" xref="A5.Ex2.m1.1.1.2a.cmml">
           score
          </mtext>
          <mo id="A5.Ex2.m1.1.1.1" xref="A5.Ex2.m1.1.1.1.cmml">
           =
          </mo>
          <mrow id="A5.Ex2.m1.1.1.3" xref="A5.Ex2.m1.1.1.3.cmml">
           <mstyle displaystyle="true" id="A5.Ex2.m1.1.1.3.2" xref="A5.Ex2.m1.1.1.3.2.cmml">
            <mfrac id="A5.Ex2.m1.1.1.3.2a" xref="A5.Ex2.m1.1.1.3.2.cmml">
             <mrow id="A5.Ex2.m1.1.1.3.2.2" xref="A5.Ex2.m1.1.1.3.2.2.cmml">
              <mtext id="A5.Ex2.m1.1.1.3.2.2.2" xref="A5.Ex2.m1.1.1.3.2.2.2a.cmml">
               raw return
              </mtext>
              <mo id="A5.Ex2.m1.1.1.3.2.2.1" xref="A5.Ex2.m1.1.1.3.2.2.1.cmml">
               −
              </mo>
              <mtext id="A5.Ex2.m1.1.1.3.2.2.3" xref="A5.Ex2.m1.1.1.3.2.2.3a.cmml">
               min raw return
              </mtext>
             </mrow>
             <mrow id="A5.Ex2.m1.1.1.3.2.3" xref="A5.Ex2.m1.1.1.3.2.3.cmml">
              <mtext id="A5.Ex2.m1.1.1.3.2.3.2" xref="A5.Ex2.m1.1.1.3.2.3.2a.cmml">
               dataset average
              </mtext>
              <mo id="A5.Ex2.m1.1.1.3.2.3.1" xref="A5.Ex2.m1.1.1.3.2.3.1.cmml">
               −
              </mo>
              <mtext id="A5.Ex2.m1.1.1.3.2.3.3" xref="A5.Ex2.m1.1.1.3.2.3.3a.cmml">
               min raw return
              </mtext>
             </mrow>
            </mfrac>
           </mstyle>
           <mo id="A5.Ex2.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A5.Ex2.m1.1.1.3.1.cmml">
            ×
           </mo>
           <mn id="A5.Ex2.m1.1.1.3.3" xref="A5.Ex2.m1.1.1.3.3.cmml">
            50
           </mn>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A5.Ex2.m1.1b">
          <apply id="A5.Ex2.m1.1.1.cmml" xref="A5.Ex2.m1.1.1">
           <eq id="A5.Ex2.m1.1.1.1.cmml" xref="A5.Ex2.m1.1.1.1">
           </eq>
           <ci id="A5.Ex2.m1.1.1.2a.cmml" xref="A5.Ex2.m1.1.1.2">
            <mtext id="A5.Ex2.m1.1.1.2.cmml" xref="A5.Ex2.m1.1.1.2">
             score
            </mtext>
           </ci>
           <apply id="A5.Ex2.m1.1.1.3.cmml" xref="A5.Ex2.m1.1.1.3">
            <times id="A5.Ex2.m1.1.1.3.1.cmml" xref="A5.Ex2.m1.1.1.3.1">
            </times>
            <apply id="A5.Ex2.m1.1.1.3.2.cmml" xref="A5.Ex2.m1.1.1.3.2">
             <divide id="A5.Ex2.m1.1.1.3.2.1.cmml" xref="A5.Ex2.m1.1.1.3.2">
             </divide>
             <apply id="A5.Ex2.m1.1.1.3.2.2.cmml" xref="A5.Ex2.m1.1.1.3.2.2">
              <minus id="A5.Ex2.m1.1.1.3.2.2.1.cmml" xref="A5.Ex2.m1.1.1.3.2.2.1">
              </minus>
              <ci id="A5.Ex2.m1.1.1.3.2.2.2a.cmml" xref="A5.Ex2.m1.1.1.3.2.2.2">
               <mtext id="A5.Ex2.m1.1.1.3.2.2.2.cmml" xref="A5.Ex2.m1.1.1.3.2.2.2">
                raw return
               </mtext>
              </ci>
              <ci id="A5.Ex2.m1.1.1.3.2.2.3a.cmml" xref="A5.Ex2.m1.1.1.3.2.2.3">
               <mtext id="A5.Ex2.m1.1.1.3.2.2.3.cmml" xref="A5.Ex2.m1.1.1.3.2.2.3">
                min raw return
               </mtext>
              </ci>
             </apply>
             <apply id="A5.Ex2.m1.1.1.3.2.3.cmml" xref="A5.Ex2.m1.1.1.3.2.3">
              <minus id="A5.Ex2.m1.1.1.3.2.3.1.cmml" xref="A5.Ex2.m1.1.1.3.2.3.1">
              </minus>
              <ci id="A5.Ex2.m1.1.1.3.2.3.2a.cmml" xref="A5.Ex2.m1.1.1.3.2.3.2">
               <mtext id="A5.Ex2.m1.1.1.3.2.3.2.cmml" xref="A5.Ex2.m1.1.1.3.2.3.2">
                dataset average
               </mtext>
              </ci>
              <ci id="A5.Ex2.m1.1.1.3.2.3.3a.cmml" xref="A5.Ex2.m1.1.1.3.2.3.3">
               <mtext id="A5.Ex2.m1.1.1.3.2.3.3.cmml" xref="A5.Ex2.m1.1.1.3.2.3.3">
                min raw return
               </mtext>
              </ci>
             </apply>
            </apply>
            <cn id="A5.Ex2.m1.1.1.3.3.cmml" type="integer" xref="A5.Ex2.m1.1.1.3.3">
             50
            </cn>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A5.Ex2.m1.1c">
          \displaystyle\text{score}=\frac{\text{raw return}-\text{min raw return}}{\text{dataset average}-\text{min raw return}}\times 50
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <figure class="ltx_table" id="A5.T4">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T4.2">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A5.T4.2.1.1">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A5.T4.2.1.1.1">
       <span class="ltx_text" id="A5.T4.2.1.1.1.1" style="font-size:90%;">
        alg.
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T4.2.1.1.2">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.1.1.2.1" style="font-size:90%;">
        BC
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T4.2.1.1.3">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.1.1.3.1" style="font-size:90%;">
        % BC
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T4.2.1.1.4">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.1.1.4.1" style="font-size:90%;">
        MC Return
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A5.T4.2.1.1.5">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.1.1.5.1" style="font-size:90%;">
        ILQL
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T4.2.1.1.6">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.1.1.6.1" style="font-size:90%;">
        Online PPO
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A5.T4.2.1.1.7">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.1.1.7.1" style="font-size:90%;">
        Online % BC
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T4.2.1.1.8">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.1.1.8.1" style="font-size:90%;">
        GPT4
       </span>
      </th>
      <th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="A5.T4.2.1.1.9">
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A5.T4.2.2.1">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T4.2.2.1.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.2.1.1.1" style="font-size:90%;">
        FO Maze
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T4.2.2.1.2">
       <span class="ltx_text" id="A5.T4.2.2.1.2.1" style="font-size:90%;">
        -72.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T4.2.2.1.3">
       <span class="ltx_text" id="A5.T4.2.2.1.3.1" style="font-size:90%;">
        -56.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T4.2.2.1.4">
       <span class="ltx_text" id="A5.T4.2.2.1.4.1" style="font-size:90%;">
        -48.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T4.2.2.1.5">
       <span class="ltx_text" id="A5.T4.2.2.1.5.1" style="font-size:90%;">
        -6.97
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T4.2.2.1.6">
       <span class="ltx_text" id="A5.T4.2.2.1.6.1" style="font-size:90%;">
        -37.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T4.2.2.1.7">
       <span class="ltx_text" id="A5.T4.2.2.1.7.1" style="font-size:90%;">
        -71.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T4.2.2.1.8">
       <span class="ltx_text" id="A5.T4.2.2.1.8.1" style="font-size:90%;">
        -39.7
       </span>
      </td>
      <td class="ltx_td ltx_border_t" id="A5.T4.2.2.1.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.3.2">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.3.2.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.3.2.1.1" style="font-size:90%;">
        PO Maze
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.3.2.2">
       <span class="ltx_text" id="A5.T4.2.3.2.2.1" style="font-size:90%;">
        -79.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.3.2.3">
       <span class="ltx_text" id="A5.T4.2.3.2.3.1" style="font-size:90%;">
        -82.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.3.2.4">
       <span class="ltx_text" id="A5.T4.2.3.2.4.1" style="font-size:90%;">
        -80.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.3.2.5">
       <span class="ltx_text" id="A5.T4.2.3.2.5.1" style="font-size:90%;">
        -52.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.3.2.6">
       <span class="ltx_text" id="A5.T4.2.3.2.6.1" style="font-size:90%;">
        -91.7
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.3.2.7">
       <span class="ltx_text" id="A5.T4.2.3.2.7.1" style="font-size:90%;">
        -79.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.3.2.8">
       <span class="ltx_text" id="A5.T4.2.3.2.8.1" style="font-size:90%;">
        -88.0
       </span>
      </td>
      <td class="ltx_td" id="A5.T4.2.3.2.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.4.3">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.4.3.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.4.3.1.1" style="font-size:90%;">
        FO Text-Nav
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.4.3.2">
       <span class="ltx_text" id="A5.T4.2.4.3.2.1" style="font-size:90%;">
        0.39
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.4.3.3">
       <span class="ltx_text" id="A5.T4.2.4.3.3.1" style="font-size:90%;">
        0.54
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.4.3.4">
       <span class="ltx_text" id="A5.T4.2.4.3.4.1" style="font-size:90%;">
        0.63
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.4.3.5">
       <span class="ltx_text" id="A5.T4.2.4.3.5.1" style="font-size:90%;">
        0.88
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.4.3.6">
       <span class="ltx_text" id="A5.T4.2.4.3.6.1" style="font-size:90%;">
        0.81
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.4.3.7">
       <span class="ltx_text" id="A5.T4.2.4.3.7.1" style="font-size:90%;">
        0.62
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.4.3.8">
       <span class="ltx_text" id="A5.T4.2.4.3.8.1" style="font-size:90%;">
        0.52
       </span>
      </td>
      <td class="ltx_td" id="A5.T4.2.4.3.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.5.4">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.5.4.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.5.4.1.1" style="font-size:90%;">
        PO Text-Nav
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.5.4.2">
       <span class="ltx_text" id="A5.T4.2.5.4.2.1" style="font-size:90%;">
        0.25
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.5.4.3">
       <span class="ltx_text" id="A5.T4.2.5.4.3.1" style="font-size:90%;">
        0.49
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.5.4.4">
       <span class="ltx_text" id="A5.T4.2.5.4.4.1" style="font-size:90%;">
        0.58
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.5.4.5">
       <span class="ltx_text" id="A5.T4.2.5.4.5.1" style="font-size:90%;">
        0.76
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.5.4.6">
       <span class="ltx_text" id="A5.T4.2.5.4.6.1" style="font-size:90%;">
        0.80
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.5.4.7">
       <span class="ltx_text" id="A5.T4.2.5.4.7.1" style="font-size:90%;">
        0.53
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.5.4.8">
       <span class="ltx_text" id="A5.T4.2.5.4.8.1" style="font-size:90%;">
        0.21
       </span>
      </td>
      <td class="ltx_td" id="A5.T4.2.5.4.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.6.5">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.6.5.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.6.5.1.1" style="font-size:90%;">
        Wordle
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.6.5.2">
       <span class="ltx_text" id="A5.T4.2.6.5.2.1" style="font-size:90%;">
        -2.81
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.6.5.3">
       <span class="ltx_text" id="A5.T4.2.6.5.3.1" style="font-size:90%;">
        -2.85
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.6.5.4">
       <span class="ltx_text" id="A5.T4.2.6.5.4.1" style="font-size:90%;">
        -2.16
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.6.5.5">
       <span class="ltx_text" id="A5.T4.2.6.5.5.1" style="font-size:90%;">
        -2.04
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.6.5.6">
       <span class="ltx_text" id="A5.T4.2.6.5.6.1" style="font-size:90%;">
        -2.63
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.6.5.7">
       <span class="ltx_text" id="A5.T4.2.6.5.7.1" style="font-size:90%;">
        -2.15
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.6.5.8">
       <span class="ltx_text" id="A5.T4.2.6.5.8.1" style="font-size:90%;">
        -5.42
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.6.5.9">
       <span class="ltx_text" id="A5.T4.2.6.5.9.1" style="font-size:90%;">
        -
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.7.6">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.7.6.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.7.6.1.1" style="font-size:90%;">
        Chess
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.7.6.2">
       <span class="ltx_text" id="A5.T4.2.7.6.2.1" style="font-size:90%;">
        -22.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.7.6.3">
       <span class="ltx_text" id="A5.T4.2.7.6.3.1" style="font-size:90%;">
        -56.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.7.6.4">
       <span class="ltx_text" id="A5.T4.2.7.6.4.1" style="font-size:90%;">
        -28.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.7.6.5">
       <span class="ltx_text" id="A5.T4.2.7.6.5.1" style="font-size:90%;">
        -21.4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.7.6.6">
       <span class="ltx_text" id="A5.T4.2.7.6.6.1" style="font-size:90%;">
        -16.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.7.6.7">
       <span class="ltx_text" id="A5.T4.2.7.6.7.1" style="font-size:90%;">
        -22.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.7.6.8">
       <span class="ltx_text" id="A5.T4.2.7.6.8.1" style="font-size:90%;">
        -81.3
       </span>
      </td>
      <td class="ltx_td" id="A5.T4.2.7.6.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.8.7">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.8.7.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.8.7.1.1" style="font-size:90%;">
        Endgames
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.8.7.2">
       <span class="ltx_text" id="A5.T4.2.8.7.2.1" style="font-size:90%;">
        0.112
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.8.7.3">
       <span class="ltx_text" id="A5.T4.2.8.7.3.1" style="font-size:90%;">
        -0.439
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.8.7.4">
       <span class="ltx_text" id="A5.T4.2.8.7.4.1" style="font-size:90%;">
        0.588
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.8.7.5">
       <span class="ltx_text" id="A5.T4.2.8.7.5.1" style="font-size:90%;">
        0.452
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.8.7.6">
       <span class="ltx_text" id="A5.T4.2.8.7.6.1" style="font-size:90%;">
        0.814
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.8.7.7">
       <span class="ltx_text" id="A5.T4.2.8.7.7.1" style="font-size:90%;">
        0.112
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.8.7.8">
       <span class="ltx_text" id="A5.T4.2.8.7.8.1" style="font-size:90%;">
        -22.87
       </span>
      </td>
      <td class="ltx_td" id="A5.T4.2.8.7.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.9.8">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.9.8.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.9.8.1.1" style="font-size:90%;">
        20Qs
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.9.8.2">
       <span class="ltx_text" id="A5.T4.2.9.8.2.1" style="font-size:90%;">
        -16.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.9.8.3">
       <span class="ltx_text" id="A5.T4.2.9.8.3.1" style="font-size:90%;">
        -14.6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.9.8.4">
       <span class="ltx_text" id="A5.T4.2.9.8.4.1" style="font-size:90%;">
        -13.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.9.8.5">
       <span class="ltx_text" id="A5.T4.2.9.8.5.1" style="font-size:90%;">
        -14.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.9.8.6">
       <span class="ltx_text" id="A5.T4.2.9.8.6.1" style="font-size:90%;">
        -14.9
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.9.8.7">
       <span class="ltx_text" id="A5.T4.2.9.8.7.1" style="font-size:90%;">
        -16.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.9.8.8">
       <span class="ltx_text" id="A5.T4.2.9.8.8.1" style="font-size:90%;">
        -13.0
       </span>
      </td>
      <td class="ltx_td" id="A5.T4.2.9.8.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.10.9">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T4.2.10.9.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.10.9.1.1" style="font-size:90%;">
        Guess
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.10.9.2">
       <span class="ltx_text" id="A5.T4.2.10.9.2.1" style="font-size:90%;">
        -17.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.10.9.3">
       <span class="ltx_text" id="A5.T4.2.10.9.3.1" style="font-size:90%;">
        -15.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.10.9.4">
       <span class="ltx_text" id="A5.T4.2.10.9.4.1" style="font-size:90%;">
        -11.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.10.9.5">
       <span class="ltx_text" id="A5.T4.2.10.9.5.1" style="font-size:90%;">
        -12.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.10.9.6">
       <span class="ltx_text" id="A5.T4.2.10.9.6.1" style="font-size:90%;">
        -15.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A5.T4.2.10.9.7">
       <span class="ltx_text" id="A5.T4.2.10.9.7.1" style="font-size:90%;">
        -19.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T4.2.10.9.8">
       <span class="ltx_text" id="A5.T4.2.10.9.8.1" style="font-size:90%;">
        -10.13
       </span>
      </td>
      <td class="ltx_td" id="A5.T4.2.10.9.9">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T4.2.11.10">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A5.T4.2.11.10.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T4.2.11.10.1.1" style="font-size:90%;">
        Car
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T4.2.11.10.2">
       <span class="ltx_text" id="A5.T4.2.11.10.2.1" style="font-size:90%;">
        44.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T4.2.11.10.3">
       <span class="ltx_text" id="A5.T4.2.11.10.3.1" style="font-size:90%;">
        54.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T4.2.11.10.4">
       <span class="ltx_text" id="A5.T4.2.11.10.4.1" style="font-size:90%;">
        57.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A5.T4.2.11.10.5">
       <span class="ltx_text" id="A5.T4.2.11.10.5.1" style="font-size:90%;">
        46.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T4.2.11.10.6">
       <span class="ltx_text" id="A5.T4.2.11.10.6.1" style="font-size:90%;">
        50.5
       </span>
      </td>
      <td class="ltx_td ltx_border_bb ltx_border_r" id="A5.T4.2.11.10.7">
      </td>
      <td class="ltx_td ltx_border_bb" id="A5.T4.2.11.10.8">
      </td>
      <td class="ltx_td ltx_border_bb" id="A5.T4.2.11.10.9">
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 4:
    </span>
    Raw statistics for all tasks. In the main paper, the statistics are normalized. Refer to
    <a class="ltx_ref" href="#A7.T9" title="In Appendix G Symbolic Maze Environment ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Table
     </span>
     <span class="ltx_text ltx_ref_tag">
      9
     </span>
    </a>
   </figcaption>
  </figure>
  <figure class="ltx_table" id="A5.T5">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T5.2">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A5.T5.2.1.1">
      <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A5.T5.2.1.1.1">
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T5.2.1.1.2">
       <span class="ltx_text" id="A5.T5.2.1.1.2.1" style="font-size:90%;">
        Reward Min Score
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T5.2.1.1.3">
       <span class="ltx_text" id="A5.T5.2.1.1.3.1" style="font-size:90%;">
        Dataset Average Score
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T5.2.1.1.4">
       <span class="ltx_text" id="A5.T5.2.1.1.4.1" style="font-size:90%;">
        Reward Max Score
       </span>
      </th>
      <th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="A5.T5.2.1.1.5">
      </th>
      <th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="A5.T5.2.1.1.6">
      </th>
      <th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="A5.T5.2.1.1.7">
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A5.T5.2.2.1">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T5.2.2.1.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.2.1.1.1" style="font-size:90%;">
        FO Maze
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T5.2.2.1.2">
       <span class="ltx_text" id="A5.T5.2.2.1.2.1" style="font-size:90%;">
        -101
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T5.2.2.1.3">
       <span class="ltx_text" id="A5.T5.2.2.1.3.1" style="font-size:90%;">
        -83
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T5.2.2.1.4">
       <span class="ltx_text" id="A5.T5.2.2.1.4.1" style="font-size:90%;">
        -6.84
       </span>
      </td>
      <td class="ltx_td ltx_border_t" id="A5.T5.2.2.1.5">
      </td>
      <td class="ltx_td ltx_border_t" id="A5.T5.2.2.1.6">
      </td>
      <td class="ltx_td ltx_border_t" id="A5.T5.2.2.1.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.3.2">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.3.2.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.3.2.1.1" style="font-size:90%;">
        PO Maze
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.3.2.2">
       <span class="ltx_text" id="A5.T5.2.3.2.2.1" style="font-size:90%;">
        -101
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.3.2.3">
       <span class="ltx_text" id="A5.T5.2.3.2.3.1" style="font-size:90%;">
        -83
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.3.2.4">
       <span class="ltx_text" id="A5.T5.2.3.2.4.1" style="font-size:90%;">
        -25.75
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.3.2.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.3.2.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.3.2.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.4.3">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.4.3.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.4.3.1.1" style="font-size:90%;">
        F0 Text-Nav
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.4.3.2">
       <span class="ltx_text" id="A5.T5.2.4.3.2.1" style="font-size:90%;">
        0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.4.3.3">
       <span class="ltx_text" id="A5.T5.2.4.3.3.1" style="font-size:90%;">
        0.26
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.4.3.4">
       <span class="ltx_text" id="A5.T5.2.4.3.4.1" style="font-size:90%;">
        1
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.4.3.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.4.3.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.4.3.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.5.4">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.5.4.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.5.4.1.1" style="font-size:90%;">
        PO Text-Nav
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.5.4.2">
       <span class="ltx_text" id="A5.T5.2.5.4.2.1" style="font-size:90%;">
        0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.5.4.3">
       <span class="ltx_text" id="A5.T5.2.5.4.3.1" style="font-size:90%;">
        0.26
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.5.4.4">
       <span class="ltx_text" id="A5.T5.2.5.4.4.1" style="font-size:90%;">
        1
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.5.4.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.5.4.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.5.4.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.6.5">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.6.5.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.6.5.1.1" style="font-size:90%;">
        Wordle
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.6.5.2">
       <span class="ltx_text" id="A5.T5.2.6.5.2.1" style="font-size:90%;">
        -6
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.6.5.3">
       <span class="ltx_text" id="A5.T5.2.6.5.3.1" style="font-size:90%;">
        -4.12
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.6.5.4">
       <span class="ltx_text" id="A5.T5.2.6.5.4.1" style="font-size:90%;">
        -1.94
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.6.5.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.6.5.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.6.5.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.7.6">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.7.6.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.7.6.1.1" style="font-size:90%;">
        Chess
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.7.6.2">
       <span class="ltx_text" id="A5.T5.2.7.6.2.1" style="font-size:90%;">
        -401
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.7.6.3">
       <span class="ltx_text" id="A5.T5.2.7.6.3.1" style="font-size:90%;">
        0.21
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.7.6.4">
       <span class="ltx_text" id="A5.T5.2.7.6.4.1" style="font-size:90%;">
        1
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.7.6.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.7.6.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.7.6.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.8.7">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.8.7.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.8.7.1.1" style="font-size:90%;">
        Endgames
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.8.7.2">
       <span class="ltx_text" id="A5.T5.2.8.7.2.1" style="font-size:90%;">
        -1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.8.7.3">
       <span class="ltx_text" id="A5.T5.2.8.7.3.1" style="font-size:90%;">
        0.586
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.8.7.4">
       <span class="ltx_text" id="A5.T5.2.8.7.4.1" style="font-size:90%;">
        1
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.8.7.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.8.7.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.8.7.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.9.8">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.9.8.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.9.8.1.1" style="font-size:90%;">
        20Qs
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.9.8.2">
       <span class="ltx_text" id="A5.T5.2.9.8.2.1" style="font-size:90%;">
        -20.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.9.8.3">
       <span class="ltx_text" id="A5.T5.2.9.8.3.1" style="font-size:90%;">
        -17.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.9.8.4">
       <span class="ltx_text" id="A5.T5.2.9.8.4.1" style="font-size:90%;">
        -12.6
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.9.8.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.9.8.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.9.8.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.10.9">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="A5.T5.2.10.9.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.10.9.1.1" style="font-size:90%;">
        Guess
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.10.9.2">
       <span class="ltx_text" id="A5.T5.2.10.9.2.1" style="font-size:90%;">
        -20.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.10.9.3">
       <span class="ltx_text" id="A5.T5.2.10.9.3.1" style="font-size:90%;">
        -18.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A5.T5.2.10.9.4">
       <span class="ltx_text" id="A5.T5.2.10.9.4.1" style="font-size:90%;">
        -8.56
       </span>
      </td>
      <td class="ltx_td" id="A5.T5.2.10.9.5">
      </td>
      <td class="ltx_td" id="A5.T5.2.10.9.6">
      </td>
      <td class="ltx_td" id="A5.T5.2.10.9.7">
      </td>
     </tr>
     <tr class="ltx_tr" id="A5.T5.2.11.10">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A5.T5.2.11.10.1">
       <span class="ltx_text ltx_font_typewriter" id="A5.T5.2.11.10.1.1" style="font-size:90%;">
        Car
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T5.2.11.10.2">
       <span class="ltx_text" id="A5.T5.2.11.10.2.1" style="font-size:90%;">
        0
       </span>
      </td>
      <td class="ltx_td ltx_border_bb" id="A5.T5.2.11.10.3">
      </td>
      <td class="ltx_td ltx_border_bb" id="A5.T5.2.11.10.4">
      </td>
      <td class="ltx_td ltx_border_bb" id="A5.T5.2.11.10.5">
      </td>
      <td class="ltx_td ltx_border_bb" id="A5.T5.2.11.10.6">
      </td>
      <td class="ltx_td ltx_border_bb" id="A5.T5.2.11.10.7">
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 5:
    </span>
    In this table we report the minimum, dataset average, and maximum reward used to normalize the results in
    <a class="ltx_ref" href="#A5.T4" title="In Appendix E Evaluation Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Table
     </span>
     <span class="ltx_text ltx_ref_tag">
      4
     </span>
    </a>
    to get
    <a class="ltx_ref" href="#A7.T9" title="In Appendix G Symbolic Maze Environment ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
     <span class="ltx_text ltx_ref_tag">
      Table
     </span>
     <span class="ltx_text ltx_ref_tag">
      9
     </span>
    </a>
    .
   </figcaption>
  </figure>
  <div class="ltx_para" id="A5.p4">
   <p class="ltx_p" id="A5.p4.1">
    In the following sections, we discuss more in-depth the evaluation protocol for the various tasks.
   </p>
  </div>
  <section class="ltx_subsection" id="A5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.1
    </span>
    Maze
   </h3>
   <div class="ltx_para" id="A5.SS1.p1">
    <p class="ltx_p" id="A5.SS1.p1.1">
     For evaluating the maze task, we take 32 rollouts from each of the 25 possible positions and then average the result. In the environment, the agent has 100 moves to successfully make it to the goal otherwise the episode will terminate. Since the agent receives -1 reward for every move that does not reach the goal state the minimum possible goal state, the minimum reward is -101. We compute the dataset average reward, by sampling actions according to how likely they are in the dataset. We compute the maximum possible reward by evaluating the optimal policy from each of the possible start positions and averaging the results.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A5.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.2
    </span>
    Chess
   </h3>
   <div class="ltx_para" id="A5.SS2.p1">
    <p class="ltx_p" id="A5.SS2.p1.1">
     To evaluate the chess agent, we have it play 1000 games against Stockfish elo 1200 from the beginning of the game. As the game progresses, the board positions get increasing OOD for the chess agent so the chess agent often makes illegal moves. To measure this, we track the percent of illegal moves as well as the average episode length for the full game chess agent.
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A5.SS2.p2">
    <p class="ltx_p" id="A5.SS2.p2.1">
     For filtered BC, we simply trained the agent only on games in the dataset which resulted in a victory for the agent, thus denoted BC-Won. Note that BC-Won achieves the worst performance of all algorithms listed. This is because there is a distribution shift between the state visited by a BC-Won agent and the rollouts of the policy. In other words, the "winning positions" and the "rollout positions" are two overlapping but distinct distributions especially since the full-game chess agent did not succeed in winning any games.
    </p>
   </div>
   <figure class="ltx_table" id="A5.T6">
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T6.2">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A5.T6.2.1.1">
       <th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A5.T6.2.1.1.1">
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T6.2.1.1.2">
        <span class="ltx_text" id="A5.T6.2.1.1.2.1" style="font-size:90%;">
         BC
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T6.2.1.1.3">
        <span class="ltx_text" id="A5.T6.2.1.1.3.1" style="font-size:90%;">
         BC-Won
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T6.2.1.1.4">
        <span class="ltx_text" id="A5.T6.2.1.1.4.1" style="font-size:90%;">
         ILQL
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T6.2.1.1.5">
        <span class="ltx_text" id="A5.T6.2.1.1.5.1" style="font-size:90%;">
         MC Returns
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T6.2.1.1.6">
        <span class="ltx_text" id="A5.T6.2.1.1.6.1" style="font-size:90%;">
         PPO Offline
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T6.2.1.1.7">
        <span class="ltx_text" id="A5.T6.2.1.1.7.1" style="font-size:90%;">
         PPO Online
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T6.2.2.2">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T6.2.2.2.1">
        <span class="ltx_text" id="A5.T6.2.2.2.1.1" style="font-size:90%;">
         reward
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.2.2.2">
        <span class="ltx_text" id="A5.T6.2.2.2.2.1" style="font-size:90%;">
         -23.189
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.2.2.3">
        <span class="ltx_text" id="A5.T6.2.2.2.3.1" style="font-size:90%;">
         -56.522
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.2.2.4">
        <span class="ltx_text" id="A5.T6.2.2.2.4.1" style="font-size:90%;">
         -20.46
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.2.2.5">
        <span class="ltx_text" id="A5.T6.2.2.2.5.1" style="font-size:90%;">
         -25.47
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.2.2.6">
        <span class="ltx_text" id="A5.T6.2.2.2.6.1" style="font-size:90%;">
         -20.90
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.2.2.2.7">
        <span class="ltx_text" id="A5.T6.2.2.2.7.1" style="font-size:90%;">
         -15.95
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T6.2.3.3">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T6.2.3.3.1">
        <span class="ltx_text" id="A5.T6.2.3.3.1.1" style="font-size:90%;">
         percent illegal
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.3.3.2">
        <span class="ltx_text" id="A5.T6.2.3.3.2.1" style="font-size:90%;">
         24.929%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.3.3.3">
        <span class="ltx_text" id="A5.T6.2.3.3.3.1" style="font-size:90%;">
         34.91%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.3.3.4">
        <span class="ltx_text" id="A5.T6.2.3.3.4.1" style="font-size:90%;">
         24.76 %
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.3.3.5">
        <span class="ltx_text" id="A5.T6.2.3.3.5.1" style="font-size:90%;">
         25.64%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.3.3.6">
        <span class="ltx_text" id="A5.T6.2.3.3.6.1" style="font-size:90%;">
         23.05%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.2.3.3.7">
        <span class="ltx_text" id="A5.T6.2.3.3.7.1" style="font-size:90%;">
         21.96%
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T6.2.4.4">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T6.2.4.4.1">
        <span class="ltx_text" id="A5.T6.2.4.4.1.1" style="font-size:90%;">
         episode length
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.4.4.2">
        <span class="ltx_text" id="A5.T6.2.4.4.2.1" style="font-size:90%;">
         51.01
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.4.4.3">
        <span class="ltx_text" id="A5.T6.2.4.4.3.1" style="font-size:90%;">
         92.02
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.4.4.4">
        <span class="ltx_text" id="A5.T6.2.4.4.4.1" style="font-size:90%;">
         47.96
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.4.4.5">
        <span class="ltx_text" id="A5.T6.2.4.4.5.1" style="font-size:90%;">
         53.44
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T6.2.4.4.6">
        <span class="ltx_text" id="A5.T6.2.4.4.6.1" style="font-size:90%;">
         48.69
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.2.4.4.7">
        <span class="ltx_text" id="A5.T6.2.4.4.7.1" style="font-size:90%;">
         44.19
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 6:
     </span>
     Results of chess agent in the full game positions against Stockfish Elo 1200.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="A5.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.3
    </span>
    Chess Endgames
   </h3>
   <div class="ltx_para" id="A5.SS3.p1">
    <p class="ltx_p" id="A5.SS3.p1.1">
     To evaluate the chess agent in endgame positions, we select 645 positions not contained in the training dataset and which are not trivially solvable. By trivially solvable, we mean a position which could be solved by stockfish in one to four moves. In order to check this, we use Stockfish’s evaluation tools to select positions which are a mate in 15 or greater. We then have the chess agent play one game from each position of these positions and keep these positions fixed for evaluation purposes. In this case we consider filtered BC to be training BC on all of the trajectories which ended in a victory.
    </p>
   </div>
   <figure class="ltx_table" id="A5.T7">
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T7.2">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A5.T7.2.1.1">
       <th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A5.T7.2.1.1.1">
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T7.2.1.1.2">
        BC
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T7.2.1.1.3">
        % BC
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T7.2.1.1.4">
        MC
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T7.2.1.1.5">
        ILQL
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T7.2.1.1.6">
        PPO Offline
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A5.T7.2.1.1.7">
        PPO Online
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T7.2.2.2">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T7.2.2.2.1">
        reward
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.2.2.2">
        0.112
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.2.2.3">
        -0.439
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.2.2.4">
        0.588
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.2.2.5">
        0.452
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.2.2.6">
        -0.019
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.2.2.7">
        <span class="ltx_text ltx_font_bold" id="A5.T7.2.2.2.7.1">
         0.814
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T7.2.3.3">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T7.2.3.3.1">
        percent victories
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.3.3.2">
        26.233
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.3.3.3">
        26.419
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.3.3.4">
        69.3
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.3.3.5">
        56.7
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.3.3.6">
        28.37
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.3.3.7">
        <span class="ltx_text ltx_font_bold" id="A5.T7.2.3.3.7.1">
         88.4
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T7.2.4.4">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T7.2.4.4.1">
        percent illegal
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.4.4.2">
        0.967
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.4.4.3">
        2.717
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.4.4.4">
        0.692
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.4.4.5">
        <span class="ltx_text ltx_font_bold" id="A5.T7.2.4.4.5.1">
         0.66
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.4.4.6">
        0.925
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.4.4.7">
        0.722
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T7.2.5.5">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T7.2.5.5.1">
        episode length
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.5.5.2">
        12.923
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.5.5.3">
        23.477
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.5.5.4">
        11.92
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.5.5.5">
        14.6
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.5.5.6">
        25.24
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T7.2.5.5.7">
        <span class="ltx_text ltx_font_bold" id="A5.T7.2.5.5.7.1">
         8.38
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="A5.T7.3.1.1" style="font-size:90%;">
       Table 7
      </span>
      :
     </span>
     <span class="ltx_text" id="A5.T7.4.2" style="font-size:90%;">
      Comparison between the different baseline methods. The best performance is achieved by PPO Online with a 0.13 gap in performance between PPO Online and the next best-performing method of MC Returns. PPO Online attains overall the highest reward, but BC-Engine wins more frequently and MC Returns and ILQL make fewer illegal moves.
     </span>
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="A5.SS3.p2">
    <p class="ltx_p" id="A5.SS3.p2.1">
     As we can see in the table above, PPO Online significantly outperforms all of the other methods. To investigate whether PPO Online’s performance is simply due to dataset collected, we fine-tune our BC agent on the PPO Online dataset. We do ablations where the data used for training is from the last 50, 25 and 10 rounds of data collection for the PPO policy. We choose to do this ablation because we expect the quality of the PPO policy performance increases in the later rounds of data collection.
    </p>
   </div>
   <figure class="ltx_table" id="A5.T8">
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T8.2">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A5.T8.2.1.1">
       <th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T8.2.1.1.1">
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.1.1.2">
        BC
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.1.1.3">
        Complete
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.1.1.4">
        Last 50
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.1.1.5">
        Last 25
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.1.1.6">
        Last 10
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.1.1.7">
        PPO Online
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T8.2.2.2">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T8.2.2.2.1">
        reward
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.2.2.2">
        0.112
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.2.2.3">
        0.201
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.2.2.4">
        0.17
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.2.2.5">
        0.189
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.2.2.6">
        0.235
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.2.2.7">
        0.814
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T8.2.3.3">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T8.2.3.3.1">
        percent victories
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.3.3.2">
        26.233
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.3.3.3">
        38.636
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.3.3.4">
        37.023
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.3.3.5">
        40.558
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.3.3.6">
        41.271
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.3.3.7">
        88.4
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T8.2.4.4">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T8.2.4.4.1">
        percent illegal
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.4.4.2">
        0.967
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.4.4.3">
        1.165
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.4.4.4">
        1.159
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.4.4.5">
        1.213
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.4.4.6">
        1.175
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.4.4.7">
        0.722
       </td>
      </tr>
      <tr class="ltx_tr" id="A5.T8.2.5.5">
       <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T8.2.5.5.1">
        episode length
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.5.5.2">
        12.923
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.5.5.3">
        13.21
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.5.5.4">
        14.22
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.5.5.5">
        14.647
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.5.5.6">
        13.338
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A5.T8.2.5.5.7">
        8.38
       </td>
      </tr>
     </tbody>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="A5.T8.3.1.1" style="font-size:90%;">
       Table 8
      </span>
      :
     </span>
     <span class="ltx_text" id="A5.T8.4.2" style="font-size:90%;">
      Comparison between PPO Online and BC agents fine-tuned on the dataset collected by PPO during training. We chose to train on the complete PPO dataset, the last 50 rounds, last 25 rounds, and last 10 rounds of data collected. PPO Online performance still far surpassed performance of the BC agents trained on the PPO policy dataset. Furthermore, there is no substantive difference between training on the complete PPO dataset and the PPO dataset collected in the last 10 rounds.
     </span>
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="A5.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.4
    </span>
    Wordle
   </h3>
   <div class="ltx_para" id="A5.SS4.p1">
    <p class="ltx_p" id="A5.SS4.p1.1">
     To evaluate Wordle, we rollout 4096 trajectories against the environment and report the average reward across all rollouts.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_appendix" id="A6" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix F
   </span>
   Baseline Details
  </h2>
  <section class="ltx_subsection" id="A6.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     F.1
    </span>
    MC Details
   </h3>
   <div class="ltx_para" id="A6.SS1.p1">
    <p class="ltx_p" id="A6.SS1.p1.6">
     The target for these heads is the discounted return-to-go:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A10.EGx3">
     <tbody id="A6.E2">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle R_{t}" class="ltx_Math" display="inline" id="A6.E2.m1.1">
         <semantics id="A6.E2.m1.1a">
          <msub id="A6.E2.m1.1.1" xref="A6.E2.m1.1.1.cmml">
           <mi id="A6.E2.m1.1.1.2" xref="A6.E2.m1.1.1.2.cmml">
            R
           </mi>
           <mi id="A6.E2.m1.1.1.3" xref="A6.E2.m1.1.1.3.cmml">
            t
           </mi>
          </msub>
          <annotation-xml encoding="MathML-Content" id="A6.E2.m1.1b">
           <apply id="A6.E2.m1.1.1.cmml" xref="A6.E2.m1.1.1">
            <csymbol cd="ambiguous" id="A6.E2.m1.1.1.1.cmml" xref="A6.E2.m1.1.1">
             subscript
            </csymbol>
            <ci id="A6.E2.m1.1.1.2.cmml" xref="A6.E2.m1.1.1.2">
             𝑅
            </ci>
            <ci id="A6.E2.m1.1.1.3.cmml" xref="A6.E2.m1.1.1.3">
             𝑡
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.E2.m1.1c">
           \displaystyle R_{t}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\sum_{i=t}^{T-1}\gamma^{i-t}r_{t}" class="ltx_Math" display="inline" id="A6.E2.m2.1">
         <semantics id="A6.E2.m2.1a">
          <mrow id="A6.E2.m2.1.1" xref="A6.E2.m2.1.1.cmml">
           <mi id="A6.E2.m2.1.1.2" xref="A6.E2.m2.1.1.2.cmml">
           </mi>
           <mo id="A6.E2.m2.1.1.1" xref="A6.E2.m2.1.1.1.cmml">
            =
           </mo>
           <mrow id="A6.E2.m2.1.1.3" xref="A6.E2.m2.1.1.3.cmml">
            <mstyle displaystyle="true" id="A6.E2.m2.1.1.3.1" xref="A6.E2.m2.1.1.3.1.cmml">
             <munderover id="A6.E2.m2.1.1.3.1a" xref="A6.E2.m2.1.1.3.1.cmml">
              <mo id="A6.E2.m2.1.1.3.1.2.2" movablelimits="false" xref="A6.E2.m2.1.1.3.1.2.2.cmml">
               ∑
              </mo>
              <mrow id="A6.E2.m2.1.1.3.1.2.3" xref="A6.E2.m2.1.1.3.1.2.3.cmml">
               <mi id="A6.E2.m2.1.1.3.1.2.3.2" xref="A6.E2.m2.1.1.3.1.2.3.2.cmml">
                i
               </mi>
               <mo id="A6.E2.m2.1.1.3.1.2.3.1" xref="A6.E2.m2.1.1.3.1.2.3.1.cmml">
                =
               </mo>
               <mi id="A6.E2.m2.1.1.3.1.2.3.3" xref="A6.E2.m2.1.1.3.1.2.3.3.cmml">
                t
               </mi>
              </mrow>
              <mrow id="A6.E2.m2.1.1.3.1.3" xref="A6.E2.m2.1.1.3.1.3.cmml">
               <mi id="A6.E2.m2.1.1.3.1.3.2" xref="A6.E2.m2.1.1.3.1.3.2.cmml">
                T
               </mi>
               <mo id="A6.E2.m2.1.1.3.1.3.1" xref="A6.E2.m2.1.1.3.1.3.1.cmml">
                −
               </mo>
               <mn id="A6.E2.m2.1.1.3.1.3.3" xref="A6.E2.m2.1.1.3.1.3.3.cmml">
                1
               </mn>
              </mrow>
             </munderover>
            </mstyle>
            <mrow id="A6.E2.m2.1.1.3.2" xref="A6.E2.m2.1.1.3.2.cmml">
             <msup id="A6.E2.m2.1.1.3.2.2" xref="A6.E2.m2.1.1.3.2.2.cmml">
              <mi id="A6.E2.m2.1.1.3.2.2.2" xref="A6.E2.m2.1.1.3.2.2.2.cmml">
               γ
              </mi>
              <mrow id="A6.E2.m2.1.1.3.2.2.3" xref="A6.E2.m2.1.1.3.2.2.3.cmml">
               <mi id="A6.E2.m2.1.1.3.2.2.3.2" xref="A6.E2.m2.1.1.3.2.2.3.2.cmml">
                i
               </mi>
               <mo id="A6.E2.m2.1.1.3.2.2.3.1" xref="A6.E2.m2.1.1.3.2.2.3.1.cmml">
                −
               </mo>
               <mi id="A6.E2.m2.1.1.3.2.2.3.3" xref="A6.E2.m2.1.1.3.2.2.3.3.cmml">
                t
               </mi>
              </mrow>
             </msup>
             <mo id="A6.E2.m2.1.1.3.2.1" lspace="0em" rspace="0em" xref="A6.E2.m2.1.1.3.2.1.cmml">
              ​
             </mo>
             <msub id="A6.E2.m2.1.1.3.2.3" xref="A6.E2.m2.1.1.3.2.3.cmml">
              <mi id="A6.E2.m2.1.1.3.2.3.2" xref="A6.E2.m2.1.1.3.2.3.2.cmml">
               r
              </mi>
              <mi id="A6.E2.m2.1.1.3.2.3.3" xref="A6.E2.m2.1.1.3.2.3.3.cmml">
               t
              </mi>
             </msub>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A6.E2.m2.1b">
           <apply id="A6.E2.m2.1.1.cmml" xref="A6.E2.m2.1.1">
            <eq id="A6.E2.m2.1.1.1.cmml" xref="A6.E2.m2.1.1.1">
            </eq>
            <csymbol cd="latexml" id="A6.E2.m2.1.1.2.cmml" xref="A6.E2.m2.1.1.2">
             absent
            </csymbol>
            <apply id="A6.E2.m2.1.1.3.cmml" xref="A6.E2.m2.1.1.3">
             <apply id="A6.E2.m2.1.1.3.1.cmml" xref="A6.E2.m2.1.1.3.1">
              <csymbol cd="ambiguous" id="A6.E2.m2.1.1.3.1.1.cmml" xref="A6.E2.m2.1.1.3.1">
               superscript
              </csymbol>
              <apply id="A6.E2.m2.1.1.3.1.2.cmml" xref="A6.E2.m2.1.1.3.1">
               <csymbol cd="ambiguous" id="A6.E2.m2.1.1.3.1.2.1.cmml" xref="A6.E2.m2.1.1.3.1">
                subscript
               </csymbol>
               <sum id="A6.E2.m2.1.1.3.1.2.2.cmml" xref="A6.E2.m2.1.1.3.1.2.2">
               </sum>
               <apply id="A6.E2.m2.1.1.3.1.2.3.cmml" xref="A6.E2.m2.1.1.3.1.2.3">
                <eq id="A6.E2.m2.1.1.3.1.2.3.1.cmml" xref="A6.E2.m2.1.1.3.1.2.3.1">
                </eq>
                <ci id="A6.E2.m2.1.1.3.1.2.3.2.cmml" xref="A6.E2.m2.1.1.3.1.2.3.2">
                 𝑖
                </ci>
                <ci id="A6.E2.m2.1.1.3.1.2.3.3.cmml" xref="A6.E2.m2.1.1.3.1.2.3.3">
                 𝑡
                </ci>
               </apply>
              </apply>
              <apply id="A6.E2.m2.1.1.3.1.3.cmml" xref="A6.E2.m2.1.1.3.1.3">
               <minus id="A6.E2.m2.1.1.3.1.3.1.cmml" xref="A6.E2.m2.1.1.3.1.3.1">
               </minus>
               <ci id="A6.E2.m2.1.1.3.1.3.2.cmml" xref="A6.E2.m2.1.1.3.1.3.2">
                𝑇
               </ci>
               <cn id="A6.E2.m2.1.1.3.1.3.3.cmml" type="integer" xref="A6.E2.m2.1.1.3.1.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="A6.E2.m2.1.1.3.2.cmml" xref="A6.E2.m2.1.1.3.2">
              <times id="A6.E2.m2.1.1.3.2.1.cmml" xref="A6.E2.m2.1.1.3.2.1">
              </times>
              <apply id="A6.E2.m2.1.1.3.2.2.cmml" xref="A6.E2.m2.1.1.3.2.2">
               <csymbol cd="ambiguous" id="A6.E2.m2.1.1.3.2.2.1.cmml" xref="A6.E2.m2.1.1.3.2.2">
                superscript
               </csymbol>
               <ci id="A6.E2.m2.1.1.3.2.2.2.cmml" xref="A6.E2.m2.1.1.3.2.2.2">
                𝛾
               </ci>
               <apply id="A6.E2.m2.1.1.3.2.2.3.cmml" xref="A6.E2.m2.1.1.3.2.2.3">
                <minus id="A6.E2.m2.1.1.3.2.2.3.1.cmml" xref="A6.E2.m2.1.1.3.2.2.3.1">
                </minus>
                <ci id="A6.E2.m2.1.1.3.2.2.3.2.cmml" xref="A6.E2.m2.1.1.3.2.2.3.2">
                 𝑖
                </ci>
                <ci id="A6.E2.m2.1.1.3.2.2.3.3.cmml" xref="A6.E2.m2.1.1.3.2.2.3.3">
                 𝑡
                </ci>
               </apply>
              </apply>
              <apply id="A6.E2.m2.1.1.3.2.3.cmml" xref="A6.E2.m2.1.1.3.2.3">
               <csymbol cd="ambiguous" id="A6.E2.m2.1.1.3.2.3.1.cmml" xref="A6.E2.m2.1.1.3.2.3">
                subscript
               </csymbol>
               <ci id="A6.E2.m2.1.1.3.2.3.2.cmml" xref="A6.E2.m2.1.1.3.2.3.2">
                𝑟
               </ci>
               <ci id="A6.E2.m2.1.1.3.2.3.3.cmml" xref="A6.E2.m2.1.1.3.2.3.3">
                𝑡
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.E2.m2.1c">
           \displaystyle=\sum_{i=t}^{T-1}\gamma^{i-t}r_{t}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="A6.SS1.p1.1">
     and we use MSE loss for the
     <math alttext="Q" class="ltx_Math" display="inline" id="A6.SS1.p1.1.m1.1">
      <semantics id="A6.SS1.p1.1.m1.1a">
       <mi id="A6.SS1.p1.1.m1.1.1" xref="A6.SS1.p1.1.m1.1.1.cmml">
        Q
       </mi>
       <annotation-xml encoding="MathML-Content" id="A6.SS1.p1.1.m1.1b">
        <ci id="A6.SS1.p1.1.m1.1.1.cmml" xref="A6.SS1.p1.1.m1.1.1">
         𝑄
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A6.SS1.p1.1.m1.1c">
        Q
       </annotation>
      </semantics>
     </math>
     head:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A10.EGx4">
     <tbody id="A6.E3">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle J(Q)" class="ltx_Math" display="inline" id="A6.E3.m1.1">
         <semantics id="A6.E3.m1.1a">
          <mrow id="A6.E3.m1.1.2" xref="A6.E3.m1.1.2.cmml">
           <mi id="A6.E3.m1.1.2.2" xref="A6.E3.m1.1.2.2.cmml">
            J
           </mi>
           <mo id="A6.E3.m1.1.2.1" lspace="0em" rspace="0em" xref="A6.E3.m1.1.2.1.cmml">
            ​
           </mo>
           <mrow id="A6.E3.m1.1.2.3.2" xref="A6.E3.m1.1.2.cmml">
            <mo id="A6.E3.m1.1.2.3.2.1" stretchy="false" xref="A6.E3.m1.1.2.cmml">
             (
            </mo>
            <mi id="A6.E3.m1.1.1" xref="A6.E3.m1.1.1.cmml">
             Q
            </mi>
            <mo id="A6.E3.m1.1.2.3.2.2" stretchy="false" xref="A6.E3.m1.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A6.E3.m1.1b">
           <apply id="A6.E3.m1.1.2.cmml" xref="A6.E3.m1.1.2">
            <times id="A6.E3.m1.1.2.1.cmml" xref="A6.E3.m1.1.2.1">
            </times>
            <ci id="A6.E3.m1.1.2.2.cmml" xref="A6.E3.m1.1.2.2">
             𝐽
            </ci>
            <ci id="A6.E3.m1.1.1.cmml" xref="A6.E3.m1.1.1">
             𝑄
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.E3.m1.1c">
           \displaystyle J(Q)
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\mathbb{E}_{(s_{t},a_{t},r_{t:T-1})\sim\mathcal{D}}\left[(Q(s_{t},a_{t})-R_{t})^{2}\right]" class="ltx_Math" display="inline" id="A6.E3.m2.4">
         <semantics id="A6.E3.m2.4a">
          <mrow id="A6.E3.m2.4.4" xref="A6.E3.m2.4.4.cmml">
           <mi id="A6.E3.m2.4.4.3" xref="A6.E3.m2.4.4.3.cmml">
           </mi>
           <mo id="A6.E3.m2.4.4.2" xref="A6.E3.m2.4.4.2.cmml">
            =
           </mo>
           <mrow id="A6.E3.m2.4.4.1" xref="A6.E3.m2.4.4.1.cmml">
            <msub id="A6.E3.m2.4.4.1.3" xref="A6.E3.m2.4.4.1.3.cmml">
             <mi id="A6.E3.m2.4.4.1.3.2" xref="A6.E3.m2.4.4.1.3.2.cmml">
              𝔼
             </mi>
             <mrow id="A6.E3.m2.3.3.3" xref="A6.E3.m2.3.3.3.cmml">
              <mrow id="A6.E3.m2.3.3.3.3.3" xref="A6.E3.m2.3.3.3.3.4.cmml">
               <mo id="A6.E3.m2.3.3.3.3.3.4" stretchy="false" xref="A6.E3.m2.3.3.3.3.4.cmml">
                (
               </mo>
               <msub id="A6.E3.m2.1.1.1.1.1.1" xref="A6.E3.m2.1.1.1.1.1.1.cmml">
                <mi id="A6.E3.m2.1.1.1.1.1.1.2" xref="A6.E3.m2.1.1.1.1.1.1.2.cmml">
                 s
                </mi>
                <mi id="A6.E3.m2.1.1.1.1.1.1.3" xref="A6.E3.m2.1.1.1.1.1.1.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="A6.E3.m2.3.3.3.3.3.5" xref="A6.E3.m2.3.3.3.3.4.cmml">
                ,
               </mo>
               <msub id="A6.E3.m2.2.2.2.2.2.2" xref="A6.E3.m2.2.2.2.2.2.2.cmml">
                <mi id="A6.E3.m2.2.2.2.2.2.2.2" xref="A6.E3.m2.2.2.2.2.2.2.2.cmml">
                 a
                </mi>
                <mi id="A6.E3.m2.2.2.2.2.2.2.3" xref="A6.E3.m2.2.2.2.2.2.2.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="A6.E3.m2.3.3.3.3.3.6" xref="A6.E3.m2.3.3.3.3.4.cmml">
                ,
               </mo>
               <msub id="A6.E3.m2.3.3.3.3.3.3" xref="A6.E3.m2.3.3.3.3.3.3.cmml">
                <mi id="A6.E3.m2.3.3.3.3.3.3.2" xref="A6.E3.m2.3.3.3.3.3.3.2.cmml">
                 r
                </mi>
                <mrow id="A6.E3.m2.3.3.3.3.3.3.3" xref="A6.E3.m2.3.3.3.3.3.3.3.cmml">
                 <mi id="A6.E3.m2.3.3.3.3.3.3.3.2" xref="A6.E3.m2.3.3.3.3.3.3.3.2.cmml">
                  t
                 </mi>
                 <mo id="A6.E3.m2.3.3.3.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="A6.E3.m2.3.3.3.3.3.3.3.1.cmml">
                  :
                 </mo>
                 <mrow id="A6.E3.m2.3.3.3.3.3.3.3.3" xref="A6.E3.m2.3.3.3.3.3.3.3.3.cmml">
                  <mi id="A6.E3.m2.3.3.3.3.3.3.3.3.2" xref="A6.E3.m2.3.3.3.3.3.3.3.3.2.cmml">
                   T
                  </mi>
                  <mo id="A6.E3.m2.3.3.3.3.3.3.3.3.1" xref="A6.E3.m2.3.3.3.3.3.3.3.3.1.cmml">
                   −
                  </mo>
                  <mn id="A6.E3.m2.3.3.3.3.3.3.3.3.3" xref="A6.E3.m2.3.3.3.3.3.3.3.3.3.cmml">
                   1
                  </mn>
                 </mrow>
                </mrow>
               </msub>
               <mo id="A6.E3.m2.3.3.3.3.3.7" stretchy="false" xref="A6.E3.m2.3.3.3.3.4.cmml">
                )
               </mo>
              </mrow>
              <mo id="A6.E3.m2.3.3.3.4" xref="A6.E3.m2.3.3.3.4.cmml">
               ∼
              </mo>
              <mi class="ltx_font_mathcaligraphic" id="A6.E3.m2.3.3.3.5" xref="A6.E3.m2.3.3.3.5.cmml">
               𝒟
              </mi>
             </mrow>
            </msub>
            <mo id="A6.E3.m2.4.4.1.2" lspace="0em" rspace="0em" xref="A6.E3.m2.4.4.1.2.cmml">
             ​
            </mo>
            <mrow id="A6.E3.m2.4.4.1.1.1" xref="A6.E3.m2.4.4.1.1.2.cmml">
             <mo id="A6.E3.m2.4.4.1.1.1.2" xref="A6.E3.m2.4.4.1.1.2.1.cmml">
              [
             </mo>
             <msup id="A6.E3.m2.4.4.1.1.1.1" xref="A6.E3.m2.4.4.1.1.1.1.cmml">
              <mrow id="A6.E3.m2.4.4.1.1.1.1.1.1" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.cmml">
               <mo id="A6.E3.m2.4.4.1.1.1.1.1.1.2" stretchy="false" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="A6.E3.m2.4.4.1.1.1.1.1.1.1" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.cmml">
                <mrow id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.cmml">
                 <mi id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.4" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.4.cmml">
                  Q
                 </mi>
                 <mo id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.3" lspace="0em" rspace="0em" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.3.cmml">
                  ​
                 </mo>
                 <mrow id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml">
                  <mo id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml">
                   (
                  </mo>
                  <msub id="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    s
                   </mi>
                   <mi id="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    t
                   </mi>
                  </msub>
                  <mo id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.4" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml">
                   ,
                  </mo>
                  <msub id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.cmml">
                   <mi id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.2" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.2.cmml">
                    a
                   </mi>
                   <mi id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.3" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.3.cmml">
                    t
                   </mi>
                  </msub>
                  <mo id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A6.E3.m2.4.4.1.1.1.1.1.1.1.3" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.3.cmml">
                 −
                </mo>
                <msub id="A6.E3.m2.4.4.1.1.1.1.1.1.1.4" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.cmml">
                 <mi id="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.2" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.2.cmml">
                  R
                 </mi>
                 <mi id="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.3" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.3.cmml">
                  t
                 </mi>
                </msub>
               </mrow>
               <mo id="A6.E3.m2.4.4.1.1.1.1.1.1.3" stretchy="false" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
              <mn id="A6.E3.m2.4.4.1.1.1.1.3" xref="A6.E3.m2.4.4.1.1.1.1.3.cmml">
               2
              </mn>
             </msup>
             <mo id="A6.E3.m2.4.4.1.1.1.3" xref="A6.E3.m2.4.4.1.1.2.1.cmml">
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A6.E3.m2.4b">
           <apply id="A6.E3.m2.4.4.cmml" xref="A6.E3.m2.4.4">
            <eq id="A6.E3.m2.4.4.2.cmml" xref="A6.E3.m2.4.4.2">
            </eq>
            <csymbol cd="latexml" id="A6.E3.m2.4.4.3.cmml" xref="A6.E3.m2.4.4.3">
             absent
            </csymbol>
            <apply id="A6.E3.m2.4.4.1.cmml" xref="A6.E3.m2.4.4.1">
             <times id="A6.E3.m2.4.4.1.2.cmml" xref="A6.E3.m2.4.4.1.2">
             </times>
             <apply id="A6.E3.m2.4.4.1.3.cmml" xref="A6.E3.m2.4.4.1.3">
              <csymbol cd="ambiguous" id="A6.E3.m2.4.4.1.3.1.cmml" xref="A6.E3.m2.4.4.1.3">
               subscript
              </csymbol>
              <ci id="A6.E3.m2.4.4.1.3.2.cmml" xref="A6.E3.m2.4.4.1.3.2">
               𝔼
              </ci>
              <apply id="A6.E3.m2.3.3.3.cmml" xref="A6.E3.m2.3.3.3">
               <csymbol cd="latexml" id="A6.E3.m2.3.3.3.4.cmml" xref="A6.E3.m2.3.3.3.4">
                similar-to
               </csymbol>
               <vector id="A6.E3.m2.3.3.3.3.4.cmml" xref="A6.E3.m2.3.3.3.3.3">
                <apply id="A6.E3.m2.1.1.1.1.1.1.cmml" xref="A6.E3.m2.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="A6.E3.m2.1.1.1.1.1.1.1.cmml" xref="A6.E3.m2.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="A6.E3.m2.1.1.1.1.1.1.2.cmml" xref="A6.E3.m2.1.1.1.1.1.1.2">
                  𝑠
                 </ci>
                 <ci id="A6.E3.m2.1.1.1.1.1.1.3.cmml" xref="A6.E3.m2.1.1.1.1.1.1.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="A6.E3.m2.2.2.2.2.2.2.cmml" xref="A6.E3.m2.2.2.2.2.2.2">
                 <csymbol cd="ambiguous" id="A6.E3.m2.2.2.2.2.2.2.1.cmml" xref="A6.E3.m2.2.2.2.2.2.2">
                  subscript
                 </csymbol>
                 <ci id="A6.E3.m2.2.2.2.2.2.2.2.cmml" xref="A6.E3.m2.2.2.2.2.2.2.2">
                  𝑎
                 </ci>
                 <ci id="A6.E3.m2.2.2.2.2.2.2.3.cmml" xref="A6.E3.m2.2.2.2.2.2.2.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="A6.E3.m2.3.3.3.3.3.3.cmml" xref="A6.E3.m2.3.3.3.3.3.3">
                 <csymbol cd="ambiguous" id="A6.E3.m2.3.3.3.3.3.3.1.cmml" xref="A6.E3.m2.3.3.3.3.3.3">
                  subscript
                 </csymbol>
                 <ci id="A6.E3.m2.3.3.3.3.3.3.2.cmml" xref="A6.E3.m2.3.3.3.3.3.3.2">
                  𝑟
                 </ci>
                 <apply id="A6.E3.m2.3.3.3.3.3.3.3.cmml" xref="A6.E3.m2.3.3.3.3.3.3.3">
                  <ci id="A6.E3.m2.3.3.3.3.3.3.3.1.cmml" xref="A6.E3.m2.3.3.3.3.3.3.3.1">
                   :
                  </ci>
                  <ci id="A6.E3.m2.3.3.3.3.3.3.3.2.cmml" xref="A6.E3.m2.3.3.3.3.3.3.3.2">
                   𝑡
                  </ci>
                  <apply id="A6.E3.m2.3.3.3.3.3.3.3.3.cmml" xref="A6.E3.m2.3.3.3.3.3.3.3.3">
                   <minus id="A6.E3.m2.3.3.3.3.3.3.3.3.1.cmml" xref="A6.E3.m2.3.3.3.3.3.3.3.3.1">
                   </minus>
                   <ci id="A6.E3.m2.3.3.3.3.3.3.3.3.2.cmml" xref="A6.E3.m2.3.3.3.3.3.3.3.3.2">
                    𝑇
                   </ci>
                   <cn id="A6.E3.m2.3.3.3.3.3.3.3.3.3.cmml" type="integer" xref="A6.E3.m2.3.3.3.3.3.3.3.3.3">
                    1
                   </cn>
                  </apply>
                 </apply>
                </apply>
               </vector>
               <ci id="A6.E3.m2.3.3.3.5.cmml" xref="A6.E3.m2.3.3.3.5">
                𝒟
               </ci>
              </apply>
             </apply>
             <apply id="A6.E3.m2.4.4.1.1.2.cmml" xref="A6.E3.m2.4.4.1.1.1">
              <csymbol cd="latexml" id="A6.E3.m2.4.4.1.1.2.1.cmml" xref="A6.E3.m2.4.4.1.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A6.E3.m2.4.4.1.1.1.1.cmml" xref="A6.E3.m2.4.4.1.1.1.1">
               <csymbol cd="ambiguous" id="A6.E3.m2.4.4.1.1.1.1.2.cmml" xref="A6.E3.m2.4.4.1.1.1.1">
                superscript
               </csymbol>
               <apply id="A6.E3.m2.4.4.1.1.1.1.1.1.1.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1">
                <minus id="A6.E3.m2.4.4.1.1.1.1.1.1.1.3.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.3">
                </minus>
                <apply id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2">
                 <times id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.3">
                 </times>
                 <ci id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.4.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.4">
                  𝑄
                 </ci>
                 <interval closure="open" id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2">
                  <apply id="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.2">
                    𝑠
                   </ci>
                   <ci id="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.3">
                    𝑡
                   </ci>
                  </apply>
                  <apply id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2">
                   <csymbol cd="ambiguous" id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2">
                    subscript
                   </csymbol>
                   <ci id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.2">
                    𝑎
                   </ci>
                   <ci id="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.2.2.2.2.3">
                    𝑡
                   </ci>
                  </apply>
                 </interval>
                </apply>
                <apply id="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.4">
                 <csymbol cd="ambiguous" id="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.4">
                  subscript
                 </csymbol>
                 <ci id="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.2">
                  𝑅
                 </ci>
                 <ci id="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E3.m2.4.4.1.1.1.1.1.1.1.4.3">
                  𝑡
                 </ci>
                </apply>
               </apply>
               <cn id="A6.E3.m2.4.4.1.1.1.1.3.cmml" type="integer" xref="A6.E3.m2.4.4.1.1.1.1.3">
                2
               </cn>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.E3.m2.4c">
           \displaystyle=\mathbb{E}_{(s_{t},a_{t},r_{t:T-1})\sim\mathcal{D}}\left[(Q(s_{t},a_{t})-R_{t})^{2}\right]
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (3)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="A6.SS1.p1.5">
     where
     <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="A6.SS1.p1.2.m1.1">
      <semantics id="A6.SS1.p1.2.m1.1a">
       <mi class="ltx_font_mathcaligraphic" id="A6.SS1.p1.2.m1.1.1" xref="A6.SS1.p1.2.m1.1.1.cmml">
        𝒟
       </mi>
       <annotation-xml encoding="MathML-Content" id="A6.SS1.p1.2.m1.1b">
        <ci id="A6.SS1.p1.2.m1.1.1.cmml" xref="A6.SS1.p1.2.m1.1.1">
         𝒟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A6.SS1.p1.2.m1.1c">
        \mathcal{D}
       </annotation>
      </semantics>
     </math>
     represents the dataset.
In MC,
     <math alttext="Q(s_{t},a_{t})" class="ltx_Math" display="inline" id="A6.SS1.p1.3.m2.2">
      <semantics id="A6.SS1.p1.3.m2.2a">
       <mrow id="A6.SS1.p1.3.m2.2.2" xref="A6.SS1.p1.3.m2.2.2.cmml">
        <mi id="A6.SS1.p1.3.m2.2.2.4" xref="A6.SS1.p1.3.m2.2.2.4.cmml">
         Q
        </mi>
        <mo id="A6.SS1.p1.3.m2.2.2.3" lspace="0em" rspace="0em" xref="A6.SS1.p1.3.m2.2.2.3.cmml">
         ​
        </mo>
        <mrow id="A6.SS1.p1.3.m2.2.2.2.2" xref="A6.SS1.p1.3.m2.2.2.2.3.cmml">
         <mo id="A6.SS1.p1.3.m2.2.2.2.2.3" stretchy="false" xref="A6.SS1.p1.3.m2.2.2.2.3.cmml">
          (
         </mo>
         <msub id="A6.SS1.p1.3.m2.1.1.1.1.1" xref="A6.SS1.p1.3.m2.1.1.1.1.1.cmml">
          <mi id="A6.SS1.p1.3.m2.1.1.1.1.1.2" xref="A6.SS1.p1.3.m2.1.1.1.1.1.2.cmml">
           s
          </mi>
          <mi id="A6.SS1.p1.3.m2.1.1.1.1.1.3" xref="A6.SS1.p1.3.m2.1.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="A6.SS1.p1.3.m2.2.2.2.2.4" xref="A6.SS1.p1.3.m2.2.2.2.3.cmml">
          ,
         </mo>
         <msub id="A6.SS1.p1.3.m2.2.2.2.2.2" xref="A6.SS1.p1.3.m2.2.2.2.2.2.cmml">
          <mi id="A6.SS1.p1.3.m2.2.2.2.2.2.2" xref="A6.SS1.p1.3.m2.2.2.2.2.2.2.cmml">
           a
          </mi>
          <mi id="A6.SS1.p1.3.m2.2.2.2.2.2.3" xref="A6.SS1.p1.3.m2.2.2.2.2.2.3.cmml">
           t
          </mi>
         </msub>
         <mo id="A6.SS1.p1.3.m2.2.2.2.2.5" stretchy="false" xref="A6.SS1.p1.3.m2.2.2.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A6.SS1.p1.3.m2.2b">
        <apply id="A6.SS1.p1.3.m2.2.2.cmml" xref="A6.SS1.p1.3.m2.2.2">
         <times id="A6.SS1.p1.3.m2.2.2.3.cmml" xref="A6.SS1.p1.3.m2.2.2.3">
         </times>
         <ci id="A6.SS1.p1.3.m2.2.2.4.cmml" xref="A6.SS1.p1.3.m2.2.2.4">
          𝑄
         </ci>
         <interval closure="open" id="A6.SS1.p1.3.m2.2.2.2.3.cmml" xref="A6.SS1.p1.3.m2.2.2.2.2">
          <apply id="A6.SS1.p1.3.m2.1.1.1.1.1.cmml" xref="A6.SS1.p1.3.m2.1.1.1.1.1">
           <csymbol cd="ambiguous" id="A6.SS1.p1.3.m2.1.1.1.1.1.1.cmml" xref="A6.SS1.p1.3.m2.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="A6.SS1.p1.3.m2.1.1.1.1.1.2.cmml" xref="A6.SS1.p1.3.m2.1.1.1.1.1.2">
            𝑠
           </ci>
           <ci id="A6.SS1.p1.3.m2.1.1.1.1.1.3.cmml" xref="A6.SS1.p1.3.m2.1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
          <apply id="A6.SS1.p1.3.m2.2.2.2.2.2.cmml" xref="A6.SS1.p1.3.m2.2.2.2.2.2">
           <csymbol cd="ambiguous" id="A6.SS1.p1.3.m2.2.2.2.2.2.1.cmml" xref="A6.SS1.p1.3.m2.2.2.2.2.2">
            subscript
           </csymbol>
           <ci id="A6.SS1.p1.3.m2.2.2.2.2.2.2.cmml" xref="A6.SS1.p1.3.m2.2.2.2.2.2.2">
            𝑎
           </ci>
           <ci id="A6.SS1.p1.3.m2.2.2.2.2.2.3.cmml" xref="A6.SS1.p1.3.m2.2.2.2.2.2.3">
            𝑡
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A6.SS1.p1.3.m2.2c">
        Q(s_{t},a_{t})
       </annotation>
      </semantics>
     </math>
     represents how much more rewards the policy will get if it takes action
     <math alttext="a_{t}" class="ltx_Math" display="inline" id="A6.SS1.p1.4.m3.1">
      <semantics id="A6.SS1.p1.4.m3.1a">
       <msub id="A6.SS1.p1.4.m3.1.1" xref="A6.SS1.p1.4.m3.1.1.cmml">
        <mi id="A6.SS1.p1.4.m3.1.1.2" xref="A6.SS1.p1.4.m3.1.1.2.cmml">
         a
        </mi>
        <mi id="A6.SS1.p1.4.m3.1.1.3" xref="A6.SS1.p1.4.m3.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A6.SS1.p1.4.m3.1b">
        <apply id="A6.SS1.p1.4.m3.1.1.cmml" xref="A6.SS1.p1.4.m3.1.1">
         <csymbol cd="ambiguous" id="A6.SS1.p1.4.m3.1.1.1.cmml" xref="A6.SS1.p1.4.m3.1.1">
          subscript
         </csymbol>
         <ci id="A6.SS1.p1.4.m3.1.1.2.cmml" xref="A6.SS1.p1.4.m3.1.1.2">
          𝑎
         </ci>
         <ci id="A6.SS1.p1.4.m3.1.1.3.cmml" xref="A6.SS1.p1.4.m3.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A6.SS1.p1.4.m3.1c">
        a_{t}
       </annotation>
      </semantics>
     </math>
     at the state
     <math alttext="s_{t}" class="ltx_Math" display="inline" id="A6.SS1.p1.5.m4.1">
      <semantics id="A6.SS1.p1.5.m4.1a">
       <msub id="A6.SS1.p1.5.m4.1.1" xref="A6.SS1.p1.5.m4.1.1.cmml">
        <mi id="A6.SS1.p1.5.m4.1.1.2" xref="A6.SS1.p1.5.m4.1.1.2.cmml">
         s
        </mi>
        <mi id="A6.SS1.p1.5.m4.1.1.3" xref="A6.SS1.p1.5.m4.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A6.SS1.p1.5.m4.1b">
        <apply id="A6.SS1.p1.5.m4.1.1.cmml" xref="A6.SS1.p1.5.m4.1.1">
         <csymbol cd="ambiguous" id="A6.SS1.p1.5.m4.1.1.1.cmml" xref="A6.SS1.p1.5.m4.1.1">
          subscript
         </csymbol>
         <ci id="A6.SS1.p1.5.m4.1.1.2.cmml" xref="A6.SS1.p1.5.m4.1.1.2">
          𝑠
         </ci>
         <ci id="A6.SS1.p1.5.m4.1.1.3.cmml" xref="A6.SS1.p1.5.m4.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A6.SS1.p1.5.m4.1c">
        s_{t}
       </annotation>
      </semantics>
     </math>
     under some policy (in this case the policy that collected the dataset).
     <br class="ltx_break"/>
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A6.SS1.p2">
    <p class="ltx_p" id="A6.SS1.p2.2">
     During rollout, when sampling, we perturb the base BC policy with the learned value-functions
     <cite class="ltx_cite ltx_citemacro_citep">
      [Snell et al.,
      <a class="ltx_ref" href="#bib.bib56" title="">
       2022a
      </a>
      ]
     </cite>
     . Let
     <math alttext="\pi_{\beta}" class="ltx_Math" display="inline" id="A6.SS1.p2.1.m1.1">
      <semantics id="A6.SS1.p2.1.m1.1a">
       <msub id="A6.SS1.p2.1.m1.1.1" xref="A6.SS1.p2.1.m1.1.1.cmml">
        <mi id="A6.SS1.p2.1.m1.1.1.2" xref="A6.SS1.p2.1.m1.1.1.2.cmml">
         π
        </mi>
        <mi id="A6.SS1.p2.1.m1.1.1.3" xref="A6.SS1.p2.1.m1.1.1.3.cmml">
         β
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A6.SS1.p2.1.m1.1b">
        <apply id="A6.SS1.p2.1.m1.1.1.cmml" xref="A6.SS1.p2.1.m1.1.1">
         <csymbol cd="ambiguous" id="A6.SS1.p2.1.m1.1.1.1.cmml" xref="A6.SS1.p2.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="A6.SS1.p2.1.m1.1.1.2.cmml" xref="A6.SS1.p2.1.m1.1.1.2">
          𝜋
         </ci>
         <ci id="A6.SS1.p2.1.m1.1.1.3.cmml" xref="A6.SS1.p2.1.m1.1.1.3">
          𝛽
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A6.SS1.p2.1.m1.1c">
        \pi_{\beta}
       </annotation>
      </semantics>
     </math>
     represent the policy trained with BC, and
     <math alttext="\alpha" class="ltx_Math" display="inline" id="A6.SS1.p2.2.m2.1">
      <semantics id="A6.SS1.p2.2.m2.1a">
       <mi id="A6.SS1.p2.2.m2.1.1" xref="A6.SS1.p2.2.m2.1.1.cmml">
        α
       </mi>
       <annotation-xml encoding="MathML-Content" id="A6.SS1.p2.2.m2.1b">
        <ci id="A6.SS1.p2.2.m2.1.1.cmml" xref="A6.SS1.p2.2.m2.1.1">
         𝛼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A6.SS1.p2.2.m2.1c">
        \alpha
       </annotation>
      </semantics>
     </math>
     represent a scalar multiplier, then:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A10.EGx5">
     <tbody id="A6.E5">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\pi_{\texttt{MC}}(a_{t}|s_{t})\propto\pi_{\beta}(a_{t}|s_{t})^{\alpha Q(s_{t},a_{t})}" class="ltx_Math" display="inline" id="A6.E5.m1.4">
         <semantics id="A6.E5.m1.4a">
          <mrow id="A6.E5.m1.4.4" xref="A6.E5.m1.4.4.cmml">
           <mrow id="A6.E5.m1.3.3.1" xref="A6.E5.m1.3.3.1.cmml">
            <msub id="A6.E5.m1.3.3.1.3" xref="A6.E5.m1.3.3.1.3.cmml">
             <mi id="A6.E5.m1.3.3.1.3.2" xref="A6.E5.m1.3.3.1.3.2.cmml">
              π
             </mi>
             <mtext class="ltx_mathvariant_monospace" id="A6.E5.m1.3.3.1.3.3" xref="A6.E5.m1.3.3.1.3.3a.cmml">
              MC
             </mtext>
            </msub>
            <mo id="A6.E5.m1.3.3.1.2" lspace="0em" rspace="0em" xref="A6.E5.m1.3.3.1.2.cmml">
             ​
            </mo>
            <mrow id="A6.E5.m1.3.3.1.1.1" xref="A6.E5.m1.3.3.1.1.1.1.cmml">
             <mo id="A6.E5.m1.3.3.1.1.1.2" stretchy="false" xref="A6.E5.m1.3.3.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="A6.E5.m1.3.3.1.1.1.1" xref="A6.E5.m1.3.3.1.1.1.1.cmml">
              <msub id="A6.E5.m1.3.3.1.1.1.1.2" xref="A6.E5.m1.3.3.1.1.1.1.2.cmml">
               <mi id="A6.E5.m1.3.3.1.1.1.1.2.2" xref="A6.E5.m1.3.3.1.1.1.1.2.2.cmml">
                a
               </mi>
               <mi id="A6.E5.m1.3.3.1.1.1.1.2.3" xref="A6.E5.m1.3.3.1.1.1.1.2.3.cmml">
                t
               </mi>
              </msub>
              <mo fence="false" id="A6.E5.m1.3.3.1.1.1.1.1" xref="A6.E5.m1.3.3.1.1.1.1.1.cmml">
               |
              </mo>
              <msub id="A6.E5.m1.3.3.1.1.1.1.3" xref="A6.E5.m1.3.3.1.1.1.1.3.cmml">
               <mi id="A6.E5.m1.3.3.1.1.1.1.3.2" xref="A6.E5.m1.3.3.1.1.1.1.3.2.cmml">
                s
               </mi>
               <mi id="A6.E5.m1.3.3.1.1.1.1.3.3" xref="A6.E5.m1.3.3.1.1.1.1.3.3.cmml">
                t
               </mi>
              </msub>
             </mrow>
             <mo id="A6.E5.m1.3.3.1.1.1.3" stretchy="false" xref="A6.E5.m1.3.3.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="A6.E5.m1.4.4.3" xref="A6.E5.m1.4.4.3.cmml">
            ∝
           </mo>
           <mrow id="A6.E5.m1.4.4.2" xref="A6.E5.m1.4.4.2.cmml">
            <msub id="A6.E5.m1.4.4.2.3" xref="A6.E5.m1.4.4.2.3.cmml">
             <mi id="A6.E5.m1.4.4.2.3.2" xref="A6.E5.m1.4.4.2.3.2.cmml">
              π
             </mi>
             <mi id="A6.E5.m1.4.4.2.3.3" xref="A6.E5.m1.4.4.2.3.3.cmml">
              β
             </mi>
            </msub>
            <mo id="A6.E5.m1.4.4.2.2" lspace="0em" rspace="0em" xref="A6.E5.m1.4.4.2.2.cmml">
             ​
            </mo>
            <msup id="A6.E5.m1.4.4.2.1" xref="A6.E5.m1.4.4.2.1.cmml">
             <mrow id="A6.E5.m1.4.4.2.1.1.1" xref="A6.E5.m1.4.4.2.1.1.1.1.cmml">
              <mo id="A6.E5.m1.4.4.2.1.1.1.2" stretchy="false" xref="A6.E5.m1.4.4.2.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="A6.E5.m1.4.4.2.1.1.1.1" xref="A6.E5.m1.4.4.2.1.1.1.1.cmml">
               <msub id="A6.E5.m1.4.4.2.1.1.1.1.2" xref="A6.E5.m1.4.4.2.1.1.1.1.2.cmml">
                <mi id="A6.E5.m1.4.4.2.1.1.1.1.2.2" xref="A6.E5.m1.4.4.2.1.1.1.1.2.2.cmml">
                 a
                </mi>
                <mi id="A6.E5.m1.4.4.2.1.1.1.1.2.3" xref="A6.E5.m1.4.4.2.1.1.1.1.2.3.cmml">
                 t
                </mi>
               </msub>
               <mo fence="false" id="A6.E5.m1.4.4.2.1.1.1.1.1" xref="A6.E5.m1.4.4.2.1.1.1.1.1.cmml">
                |
               </mo>
               <msub id="A6.E5.m1.4.4.2.1.1.1.1.3" xref="A6.E5.m1.4.4.2.1.1.1.1.3.cmml">
                <mi id="A6.E5.m1.4.4.2.1.1.1.1.3.2" xref="A6.E5.m1.4.4.2.1.1.1.1.3.2.cmml">
                 s
                </mi>
                <mi id="A6.E5.m1.4.4.2.1.1.1.1.3.3" xref="A6.E5.m1.4.4.2.1.1.1.1.3.3.cmml">
                 t
                </mi>
               </msub>
              </mrow>
              <mo id="A6.E5.m1.4.4.2.1.1.1.3" stretchy="false" xref="A6.E5.m1.4.4.2.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
             <mrow id="A6.E5.m1.2.2.2" xref="A6.E5.m1.2.2.2.cmml">
              <mi id="A6.E5.m1.2.2.2.4" xref="A6.E5.m1.2.2.2.4.cmml">
               α
              </mi>
              <mo id="A6.E5.m1.2.2.2.3" lspace="0em" rspace="0em" xref="A6.E5.m1.2.2.2.3.cmml">
               ​
              </mo>
              <mi id="A6.E5.m1.2.2.2.5" xref="A6.E5.m1.2.2.2.5.cmml">
               Q
              </mi>
              <mo id="A6.E5.m1.2.2.2.3a" lspace="0em" rspace="0em" xref="A6.E5.m1.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="A6.E5.m1.2.2.2.2.2" xref="A6.E5.m1.2.2.2.2.3.cmml">
               <mo id="A6.E5.m1.2.2.2.2.2.3" stretchy="false" xref="A6.E5.m1.2.2.2.2.3.cmml">
                (
               </mo>
               <msub id="A6.E5.m1.1.1.1.1.1.1" xref="A6.E5.m1.1.1.1.1.1.1.cmml">
                <mi id="A6.E5.m1.1.1.1.1.1.1.2" xref="A6.E5.m1.1.1.1.1.1.1.2.cmml">
                 s
                </mi>
                <mi id="A6.E5.m1.1.1.1.1.1.1.3" xref="A6.E5.m1.1.1.1.1.1.1.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="A6.E5.m1.2.2.2.2.2.4" xref="A6.E5.m1.2.2.2.2.3.cmml">
                ,
               </mo>
               <msub id="A6.E5.m1.2.2.2.2.2.2" xref="A6.E5.m1.2.2.2.2.2.2.cmml">
                <mi id="A6.E5.m1.2.2.2.2.2.2.2" xref="A6.E5.m1.2.2.2.2.2.2.2.cmml">
                 a
                </mi>
                <mi id="A6.E5.m1.2.2.2.2.2.2.3" xref="A6.E5.m1.2.2.2.2.2.2.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="A6.E5.m1.2.2.2.2.2.5" stretchy="false" xref="A6.E5.m1.2.2.2.2.3.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </msup>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A6.E5.m1.4b">
           <apply id="A6.E5.m1.4.4.cmml" xref="A6.E5.m1.4.4">
            <csymbol cd="latexml" id="A6.E5.m1.4.4.3.cmml" xref="A6.E5.m1.4.4.3">
             proportional-to
            </csymbol>
            <apply id="A6.E5.m1.3.3.1.cmml" xref="A6.E5.m1.3.3.1">
             <times id="A6.E5.m1.3.3.1.2.cmml" xref="A6.E5.m1.3.3.1.2">
             </times>
             <apply id="A6.E5.m1.3.3.1.3.cmml" xref="A6.E5.m1.3.3.1.3">
              <csymbol cd="ambiguous" id="A6.E5.m1.3.3.1.3.1.cmml" xref="A6.E5.m1.3.3.1.3">
               subscript
              </csymbol>
              <ci id="A6.E5.m1.3.3.1.3.2.cmml" xref="A6.E5.m1.3.3.1.3.2">
               𝜋
              </ci>
              <ci id="A6.E5.m1.3.3.1.3.3a.cmml" xref="A6.E5.m1.3.3.1.3.3">
               <mtext class="ltx_mathvariant_monospace" id="A6.E5.m1.3.3.1.3.3.cmml" mathsize="70%" xref="A6.E5.m1.3.3.1.3.3">
                MC
               </mtext>
              </ci>
             </apply>
             <apply id="A6.E5.m1.3.3.1.1.1.1.cmml" xref="A6.E5.m1.3.3.1.1.1">
              <csymbol cd="latexml" id="A6.E5.m1.3.3.1.1.1.1.1.cmml" xref="A6.E5.m1.3.3.1.1.1.1.1">
               conditional
              </csymbol>
              <apply id="A6.E5.m1.3.3.1.1.1.1.2.cmml" xref="A6.E5.m1.3.3.1.1.1.1.2">
               <csymbol cd="ambiguous" id="A6.E5.m1.3.3.1.1.1.1.2.1.cmml" xref="A6.E5.m1.3.3.1.1.1.1.2">
                subscript
               </csymbol>
               <ci id="A6.E5.m1.3.3.1.1.1.1.2.2.cmml" xref="A6.E5.m1.3.3.1.1.1.1.2.2">
                𝑎
               </ci>
               <ci id="A6.E5.m1.3.3.1.1.1.1.2.3.cmml" xref="A6.E5.m1.3.3.1.1.1.1.2.3">
                𝑡
               </ci>
              </apply>
              <apply id="A6.E5.m1.3.3.1.1.1.1.3.cmml" xref="A6.E5.m1.3.3.1.1.1.1.3">
               <csymbol cd="ambiguous" id="A6.E5.m1.3.3.1.1.1.1.3.1.cmml" xref="A6.E5.m1.3.3.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="A6.E5.m1.3.3.1.1.1.1.3.2.cmml" xref="A6.E5.m1.3.3.1.1.1.1.3.2">
                𝑠
               </ci>
               <ci id="A6.E5.m1.3.3.1.1.1.1.3.3.cmml" xref="A6.E5.m1.3.3.1.1.1.1.3.3">
                𝑡
               </ci>
              </apply>
             </apply>
            </apply>
            <apply id="A6.E5.m1.4.4.2.cmml" xref="A6.E5.m1.4.4.2">
             <times id="A6.E5.m1.4.4.2.2.cmml" xref="A6.E5.m1.4.4.2.2">
             </times>
             <apply id="A6.E5.m1.4.4.2.3.cmml" xref="A6.E5.m1.4.4.2.3">
              <csymbol cd="ambiguous" id="A6.E5.m1.4.4.2.3.1.cmml" xref="A6.E5.m1.4.4.2.3">
               subscript
              </csymbol>
              <ci id="A6.E5.m1.4.4.2.3.2.cmml" xref="A6.E5.m1.4.4.2.3.2">
               𝜋
              </ci>
              <ci id="A6.E5.m1.4.4.2.3.3.cmml" xref="A6.E5.m1.4.4.2.3.3">
               𝛽
              </ci>
             </apply>
             <apply id="A6.E5.m1.4.4.2.1.cmml" xref="A6.E5.m1.4.4.2.1">
              <csymbol cd="ambiguous" id="A6.E5.m1.4.4.2.1.2.cmml" xref="A6.E5.m1.4.4.2.1">
               superscript
              </csymbol>
              <apply id="A6.E5.m1.4.4.2.1.1.1.1.cmml" xref="A6.E5.m1.4.4.2.1.1.1">
               <csymbol cd="latexml" id="A6.E5.m1.4.4.2.1.1.1.1.1.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.1">
                conditional
               </csymbol>
               <apply id="A6.E5.m1.4.4.2.1.1.1.1.2.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.2">
                <csymbol cd="ambiguous" id="A6.E5.m1.4.4.2.1.1.1.1.2.1.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.2">
                 subscript
                </csymbol>
                <ci id="A6.E5.m1.4.4.2.1.1.1.1.2.2.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.2.2">
                 𝑎
                </ci>
                <ci id="A6.E5.m1.4.4.2.1.1.1.1.2.3.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.2.3">
                 𝑡
                </ci>
               </apply>
               <apply id="A6.E5.m1.4.4.2.1.1.1.1.3.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.3">
                <csymbol cd="ambiguous" id="A6.E5.m1.4.4.2.1.1.1.1.3.1.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="A6.E5.m1.4.4.2.1.1.1.1.3.2.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.3.2">
                 𝑠
                </ci>
                <ci id="A6.E5.m1.4.4.2.1.1.1.1.3.3.cmml" xref="A6.E5.m1.4.4.2.1.1.1.1.3.3">
                 𝑡
                </ci>
               </apply>
              </apply>
              <apply id="A6.E5.m1.2.2.2.cmml" xref="A6.E5.m1.2.2.2">
               <times id="A6.E5.m1.2.2.2.3.cmml" xref="A6.E5.m1.2.2.2.3">
               </times>
               <ci id="A6.E5.m1.2.2.2.4.cmml" xref="A6.E5.m1.2.2.2.4">
                𝛼
               </ci>
               <ci id="A6.E5.m1.2.2.2.5.cmml" xref="A6.E5.m1.2.2.2.5">
                𝑄
               </ci>
               <interval closure="open" id="A6.E5.m1.2.2.2.2.3.cmml" xref="A6.E5.m1.2.2.2.2.2">
                <apply id="A6.E5.m1.1.1.1.1.1.1.cmml" xref="A6.E5.m1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="A6.E5.m1.1.1.1.1.1.1.1.cmml" xref="A6.E5.m1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="A6.E5.m1.1.1.1.1.1.1.2.cmml" xref="A6.E5.m1.1.1.1.1.1.1.2">
                  𝑠
                 </ci>
                 <ci id="A6.E5.m1.1.1.1.1.1.1.3.cmml" xref="A6.E5.m1.1.1.1.1.1.1.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="A6.E5.m1.2.2.2.2.2.2.cmml" xref="A6.E5.m1.2.2.2.2.2.2">
                 <csymbol cd="ambiguous" id="A6.E5.m1.2.2.2.2.2.2.1.cmml" xref="A6.E5.m1.2.2.2.2.2.2">
                  subscript
                 </csymbol>
                 <ci id="A6.E5.m1.2.2.2.2.2.2.2.cmml" xref="A6.E5.m1.2.2.2.2.2.2.2">
                  𝑎
                 </ci>
                 <ci id="A6.E5.m1.2.2.2.2.2.2.3.cmml" xref="A6.E5.m1.2.2.2.2.2.2.3">
                  𝑡
                 </ci>
                </apply>
               </interval>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.E5.m1.4c">
           \displaystyle\pi_{\texttt{MC}}(a_{t}|s_{t})\propto\pi_{\beta}(a_{t}|s_{t})^{\alpha Q(s_{t},a_{t})}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (5)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
  </section>
  <section class="ltx_subsection" id="A6.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     F.2
    </span>
    PPO Details
   </h3>
   <section class="ltx_paragraph" id="A6.SS2.SSS0.Px1">
    <h5 class="ltx_title ltx_title_paragraph">
     PPO Implementation Details
    </h5>
    <div class="ltx_para" id="A6.SS2.SSS0.Px1.p1">
     <p class="ltx_p" id="A6.SS2.SSS0.Px1.p1.1">
      Our PPO implementation uses a learned value function to estimate an advantage baseline. Our value function is fit using GAE
      <cite class="ltx_cite ltx_citemacro_citep">
       [Schulman et al.,
       <a class="ltx_ref" href="#bib.bib51" title="">
        2018
       </a>
       ]
      </cite>
      value estimates and is implemented as a linear head on top of the same transformer as the policy. We apply clipping to both the importance weights and the value function, as is done in
      <cite class="ltx_cite ltx_citemacro_citep">
       [Castricato et al.,
       <a class="ltx_ref" href="#bib.bib9" title="">
        2023
       </a>
       ]
      </cite>
      . We also apply a KL penality to the reward, as is standard for RLHF
      <cite class="ltx_cite ltx_citemacro_citep">
       [Stiennon et al.,
       <a class="ltx_ref" href="#bib.bib60" title="">
        2022
       </a>
       ]
      </cite>
      . On some of our tasks, we add a supervised learning, BC, loss term to the standard PPO loss to prevent the model in distribution; this is similar to the approach taken in
      <cite class="ltx_cite ltx_citemacro_cite">
       Ouyang et al. [
       <a class="ltx_ref" href="#bib.bib41" title="">
        2022
       </a>
       ]
      </cite>
      , which adds a pretraining loss term to the PPO loss to mitigate performance regressions on some benchmarks during RLHF.
     </p>
    </div>
   </section>
   <section class="ltx_paragraph" id="A6.SS2.SSS0.Px2">
    <h5 class="ltx_title ltx_title_paragraph">
     PPO Instabilities
    </h5>
    <div class="ltx_para" id="A6.SS2.SSS0.Px2.p1">
     <p class="ltx_p" id="A6.SS2.SSS0.Px2.p1.1">
      In some cases we observed training instabilities with PPO in which the policy’s performance would increase for a little bit and then collapse (see Figure
      <a class="ltx_ref" href="#A6.F5" title="Figure 5 ‣ PPO Instabilities ‣ F.2 PPO Details ‣ Appendix F Baseline Details ‣ LMRL Gym: Benchmarks for Multi-Turn Reinforcement Learning with Language Models">
       <span class="ltx_text ltx_ref_tag">
        5
       </span>
      </a>
      ). We primarily observed this on our maze environment. We are uncertain what the cause of this dramatic instability is, and leave further investigation of this phenomenon to future work.
     </p>
    </div>
    <figure class="ltx_figure" id="A6.F5">
     <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="360" id="A6.F5.g1" src="/html/2311.18232/assets/figures/ppo_training_plot.png" width="600"/>
     <figcaption class="ltx_caption ltx_centering">
      <span class="ltx_tag ltx_tag_figure">
       <span class="ltx_text" id="A6.F5.2.1.1" style="font-size:90%;">
        Figure 5
       </span>
       :
      </span>
      <span class="ltx_text" id="A6.F5.3.2" style="font-size:90%;">
       An example of an observed PPO training instability on the fully observed maze task.
      </span>
     </figcaption>
    </figure>
   </section>
  </section>
 </section>
 <section class="ltx_appendix" id="A7" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix G
   </span>
   Symbolic Maze Environment
  </h2>
  <div class="ltx_para" id="A7.p1">
   <p class="ltx_p" id="A7.p1.1">
    Code to run experiments for the symbolic maze task can be found here: REDACTED. We ran online and offline Q-learning on this environment. The online Q-learning method is DQN and the offline Q-learning method is CQL. We found that Q-learning was able to perform optimally on the Maze task in both the online and offline setting. The results are as follows:
   </p>
  </div>
  <figure class="ltx_table" id="A7.T9">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T9.2">
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A7.T9.2.1.1">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A7.T9.2.1.1.1">
       <span class="ltx_text" id="A7.T9.2.1.1.1.1" style="font-size:90%;">
        alg.
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A7.T9.2.1.1.2">
       <span class="ltx_text" id="A7.T9.2.1.1.2.1" style="font-size:90%;">
        DQN
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A7.T9.2.1.1.3">
       <span class="ltx_text" id="A7.T9.2.1.1.3.1" style="font-size:90%;">
        CQL
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.2.2.2">
      <th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="A7.T9.2.2.2.1">
       <span class="ltx_text ltx_font_typewriter" id="A7.T9.2.2.2.1.1" style="font-size:90%;">
        Symbolic Maze
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A7.T9.2.2.2.2">
       <span class="ltx_text" id="A7.T9.2.2.2.2.1" style="font-size:90%;">
        100.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A7.T9.2.2.2.3">
       <span class="ltx_text" id="A7.T9.2.2.2.3.1" style="font-size:90%;">
        100.0
       </span>
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 9:
    </span>
    Results for CQL and DQN on the symbolic maze environment. These are normalized in the same way as results on LM RL tasks.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="A8" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix H
   </span>
   Generated Examples from Trained Models
  </h2>
  <div class="ltx_para" id="A8.p1">
   <p class="ltx_p" id="A8.p1.1">
    We show an example of a conversation between BC model (seller) and the oracle model (buyer):
   </p>
   <blockquote class="ltx_quote" id="A8.p1.2">
    <p class="ltx_p" id="A8.p1.2.1">
     <span class="ltx_text ltx_font_typewriter" id="A8.p1.2.1.1" style="font-size:90%;">
      ===========
      <br class="ltx_break"/>
      Preferred brands:
Lexus, 46 features, backup camera, blind spot monitoring, sunroof. Budget: $90000.
      <br class="ltx_break"/>
      ===========
      <br class="ltx_break"/>
      Seller: Good afternoon! How may I assist you today?
      <br class="ltx_break"/>
      Buyer: Hi there! I’m looking for a Lexus SUV with a backup camera, blind spot monitoring, and a sunroof. Do you have anything like that?
      <br class="ltx_break"/>
      Seller: Absolutely! We have a few models that fit that description. Do you have a budget in mind?
      <br class="ltx_break"/>
      Buyer: Well, I’d like to stay around $90,000, but I’m willing to go over that if I find the perfect car.
      <br class="ltx_break"/>
      Seller: Great! Let me show you our selection. This Lexus SUV here has all the features you’re looking for. Have a seat inside and take a look. Buyer: Wow, this is really nice! How much does it cost? Seller: The MSRP for this model is $87,000, but we can work with you on the price.
      <br class="ltx_break"/>
      Buyer: Hmm, that’s a bit high for me. Do you have any other options?
      <br class="ltx_break"/>
      Seller: Of course! We have this similar model here for $80,000. It’s a great car and has all the features you’re looking for.
      <br class="ltx_break"/>
      Buyer: That’s more in my budget. Let me take a look inside.
      <br class="ltx_break"/>
      Seller: Absolutely! And if you’re interested, we could also discuss financing options.
      <br class="ltx_break"/>
      Buyer: I’m definitely interested in financing. How does that work here?
      <br class="ltx_break"/>
      Seller: Well, we have a few options available. We can work with your bank or credit union, or we can discuss financing through our dealership. We also have some special offers and promotions available that may be of interest to you.
      <br class="ltx_break"/>
      Buyer: That sounds good. I definitely want to make sure I’m getting the best deal possible.
      <br class="ltx_break"/>
      Seller: Of course! We want to make sure you’re completely satisfied with your purchase. And this car here is a great value for the features you’re getting. Buyer: You know what, I think I’m sold! Let’s do this.
      <br class="ltx_break"/>
      Seller: Wonderful! I just need to get some paperwork started and we can get the financing process going. Congratulations on your new car!
      <br class="ltx_break"/>
     </span>
    </p>
   </blockquote>
  </div>
  <div class="ltx_para ltx_noindent" id="A8.p2">
   <p class="ltx_p" id="A8.p2.1">
    We show a conversation between the MC model (seller) and the oracle (buyer):
   </p>
   <blockquote class="ltx_quote" id="A8.p2.2">
    <p class="ltx_p" id="A8.p2.2.1">
     <span class="ltx_text ltx_font_typewriter" id="A8.p2.2.1.1" style="font-size:90%;">
      ===========
      <br class="ltx_break"/>
      Preferred brands:
Audi, Sunroof/moonroof, Leather seats, Heated seats. Budget: $70000
      <br class="ltx_break"/>
      ===========
      <br class="ltx_break"/>
      Seller: Good morning, how can I assist you today?
      <br class="ltx_break"/>
      Buyer: I’m looking to buy an Audi Sedan.
      <br class="ltx_break"/>
      Seller: Certainly, we have a range of Audi Sedans available. What features are you interested in?
      <br class="ltx_break"/>
      Buyer: I want a car with a sunroof/moonroof, leather seats, and heated seats.
      <br class="ltx_break"/>
      Seller: I understand. Let me check our inventory for Audi Sedans with those features. (Pause)
      <br class="ltx_break"/>
      Seller: We have a few options that meet your requirements. The prices range from $75,000 to $85,000.
      <br class="ltx_break"/>
      Buyer: My budget is $70,000. Can you offer a lower price?
      <br class="ltx_break"/>
      Seller: I’m sorry, but we don’t offer any discounts. The prices are as listed.
      <br class="ltx_break"/>
      Buyer: I really can’t go over my budget. Is there anything you can do?
Seller: I apologize for the inconvenience, but the prices are fixed. We have quality Audi Sedans that meet your preferences.
Buyer: (Sighs) Okay, let’s say I consider going slightly over my budget. How much would it be?
Seller: The closest option to your budget is priced at $75,000.
Buyer: Hmm, that’s not bad. Can you go any lower?
      <br class="ltx_break"/>
      Seller: I’m sorry, but I can’t lower the price.
      <br class="ltx_break"/>
      Buyer: Alright, I’ll take it. What’s the final price?
      <br class="ltx_break"/>
      Seller: The final price is $75,000.
      <br class="ltx_break"/>
      Buyer: Okay, let’s proceed with the purchase then.
     </span>
    </p>
   </blockquote>
  </div>
 </section>
 <section class="ltx_appendix" id="A9" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix I
   </span>
   Human Evaluation Examples
  </h2>
  <div class="ltx_para" id="A9.p1">
   <blockquote class="ltx_quote" id="A9.p1.1">
    <p class="ltx_p" id="A9.p1.1.1">
     <span class="ltx_text ltx_font_typewriter" id="A9.p1.1.1.1" style="font-size:90%;">
      You are playing a game of twenty questions. You can ask 20 yes-no questions to determine the identity of an object chosen by an oracle. Each turn, you can ask a question and receives a "Yes" or "No" as the answer. You are smart, so you will ask the question that will narrow down the possible objects as much as possible. Don’t get stuck on one idea and try to branch out if you get stuck.
      <br class="ltx_break"/>
      <br class="ltx_break"/>
      Human: Does the item belong indoors?
      <br class="ltx_break"/>
      Oracle: No.
      <br class="ltx_break"/>
      Is the item used for playing sports?
      <br class="ltx_break"/>
      Oracle: Yes.
      <br class="ltx_break"/>
      Human: Is the item a ball?
      <br class="ltx_break"/>
      Oracle: Yes.
      <br class="ltx_break"/>
      Human: Do you throw the item?
      <br class="ltx_break"/>
      Oracle: Yes.
      <br class="ltx_break"/>
      Human: Do you bounce the item?
      <br class="ltx_break"/>
      Oracle: No.
      <br class="ltx_break"/>
      Human: Is it a baseball?
      <br class="ltx_break"/>
      Oracle: No.
      <br class="ltx_break"/>
      Human: Is it a football?
      <br class="ltx_break"/>
      Oracle: Yes.
     </span>
    </p>
   </blockquote>
  </div>
 </section>
 <section class="ltx_appendix" id="A10" lang="en">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix J
   </span>
   User Study on Naturalness of Conversations
  </h2>
  <div class="ltx_para" id="A10.p1">
   <p class="ltx_p" id="A10.p1.1">
    We conducted a user study where we provided 16 participants with 18 examples to annotate on a scale from 1 to 5, where 1 represents the least natural and 5 represents the most natural conversation. There were 9 examples that were from GPT, and 9 examples that were generated from one of our models (MC Returns). We showed them examples from 20 Questions, Guess My City, and Car Dealer tasks. We found the following ratings below. Note that each element shows the percentage for the particular label. We found that participants felt conversations from GPT and the MC model where equally natural of 55.56% and 58.53% respectively. We performed a t-test to test if there is a significant difference between the results for GPT and MC Model, and found that there is no statistically significant difference.
   </p>
  </div>
  <figure class="ltx_table" id="A10.T10">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A10.T10.2">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A10.T10.2.1.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A10.T10.2.1.1.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.1.1.1.1" style="font-size:90%;">
        Label
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="A10.T10.2.1.1.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.1.1.2.1" style="font-size:90%;">
        Percentages for GPT
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="A10.T10.2.1.1.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.1.1.3.1" style="font-size:90%;">
        Percentages for MC Model
       </span>
      </th>
     </tr>
     <tr class="ltx_tr" id="A10.T10.2.2.2">
      <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="A10.T10.2.2.2.1" style="padding:0.9pt 8.0pt;">
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A10.T10.2.2.2.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.2.2.2.1" style="font-size:90%;">
        Car Dealer
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A10.T10.2.2.2.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.2.2.3.1" style="font-size:90%;">
        Guess City
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A10.T10.2.2.2.4" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.2.2.4.1" style="font-size:90%;">
        20 Questions
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A10.T10.2.2.2.5" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.2.2.5.1" style="font-size:90%;">
        Car Dealer
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A10.T10.2.2.2.6" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.2.2.6.1" style="font-size:90%;">
        Guess City
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A10.T10.2.2.2.7" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.2.2.7.1" style="font-size:90%;">
        20 Questions
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A10.T10.2.3.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A10.T10.2.3.1.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.3.1.1.1" style="font-size:90%;">
        1 - Not Natural
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A10.T10.2.3.1.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.3.1.2.1" style="font-size:90%;">
        4.44%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A10.T10.2.3.1.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.3.1.3.1" style="font-size:90%;">
        13.33%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A10.T10.2.3.1.4" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.3.1.4.1" style="font-size:90%;">
        24.44%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A10.T10.2.3.1.5" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.3.1.5.1" style="font-size:90%;">
        8.89%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A10.T10.2.3.1.6" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.3.1.6.1" style="font-size:90%;">
        11.11%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A10.T10.2.3.1.7" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.3.1.7.1" style="font-size:90%;">
        22.22%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T10.2.4.2">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A10.T10.2.4.2.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.4.2.1.1" style="font-size:90%;">
        2 - Slightly Unnatural
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.4.2.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.4.2.2.1" style="font-size:90%;">
        24.44%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.4.2.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.4.2.3.1" style="font-size:90%;">
        35.56%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.4.2.4" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.4.2.4.1" style="font-size:90%;">
        31.11%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.4.2.5" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.4.2.5.1" style="font-size:90%;">
        17.78%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.4.2.6" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.4.2.6.1" style="font-size:90%;">
        40.00%
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A10.T10.2.4.2.7" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.4.2.7.1" style="font-size:90%;">
        24.44%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T10.2.5.3">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A10.T10.2.5.3.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.5.3.1.1" style="font-size:90%;">
        3 - Neutral/Natural
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.5.3.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.5.3.2.1" style="font-size:90%;">
        20.00%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.5.3.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.5.3.3.1" style="font-size:90%;">
        24.44%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.5.3.4" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.5.3.4.1" style="font-size:90%;">
        15.56%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.5.3.5" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.5.3.5.1" style="font-size:90%;">
        17.78%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.5.3.6" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.5.3.6.1" style="font-size:90%;">
        20.00%
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A10.T10.2.5.3.7" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.5.3.7.1" style="font-size:90%;">
        8.89%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T10.2.6.4">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A10.T10.2.6.4.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.6.4.1.1" style="font-size:90%;">
        4 - Quite Natural
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.6.4.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.6.4.2.1" style="font-size:90%;">
        24.44%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.6.4.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.6.4.3.1" style="font-size:90%;">
        22.22%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.6.4.4" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.6.4.4.1" style="font-size:90%;">
        13.33%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.6.4.5" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.6.4.5.1" style="font-size:90%;">
        31.11%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T10.2.6.4.6" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.6.4.6.1" style="font-size:90%;">
        20.00%
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A10.T10.2.6.4.7" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.6.4.7.1" style="font-size:90%;">
        35.56%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T10.2.7.5">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A10.T10.2.7.5.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.7.5.1.1" style="font-size:90%;">
        5 - Very Natural
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A10.T10.2.7.5.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.7.5.2.1" style="font-size:90%;">
        26.67%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A10.T10.2.7.5.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.7.5.3.1" style="font-size:90%;">
        4.44%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A10.T10.2.7.5.4" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.7.5.4.1" style="font-size:90%;">
        15.56%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A10.T10.2.7.5.5" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.7.5.5.1" style="font-size:90%;">
        24.44%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A10.T10.2.7.5.6" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.7.5.6.1" style="font-size:90%;">
        8.89%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A10.T10.2.7.5.7" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T10.2.7.5.7.1" style="font-size:90%;">
        8.89%
       </span>
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 10:
    </span>
    User study of humans rating conversations from GPT and from our MC model for three tasks: Car Dealer, Guess City, and 20 Questions.
   </figcaption>
  </figure>
  <figure class="ltx_table" id="A10.T11">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A10.T11.1">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A10.T11.1.2.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A10.T11.1.2.1.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text ltx_font_bold" id="A10.T11.1.2.1.1.1" style="font-size:90%;">
        Label
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A10.T11.1.2.1.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text ltx_font_bold" id="A10.T11.1.2.1.2.1" style="font-size:90%;">
        GPT
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A10.T11.1.2.1.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text ltx_font_bold" id="A10.T11.1.2.1.3.1" style="font-size:90%;">
        MC Model
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A10.T11.1.3.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A10.T11.1.3.1.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.3.1.1.1" style="font-size:90%;">
        1
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A10.T11.1.3.1.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.3.1.2.1" style="font-size:90%;">
        14.07%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A10.T11.1.3.1.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.3.1.3.1" style="font-size:90%;">
        14.07%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T11.1.4.2">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A10.T11.1.4.2.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.4.2.1.1" style="font-size:90%;">
        2
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T11.1.4.2.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.4.2.2.1" style="font-size:90%;">
        30.37%
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A10.T11.1.4.2.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.4.2.3.1" style="font-size:90%;">
        27.41%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T11.1.5.3">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A10.T11.1.5.3.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.5.3.1.1" style="font-size:90%;">
        3
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T11.1.5.3.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.5.3.2.1" style="font-size:90%;">
        20.00%
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A10.T11.1.5.3.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.5.3.3.1" style="font-size:90%;">
        15.56%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T11.1.6.4">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A10.T11.1.6.4.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.6.4.1.1" style="font-size:90%;">
        4
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T11.1.6.4.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.6.4.2.1" style="font-size:90%;">
        20.00%
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A10.T11.1.6.4.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.6.4.3.1" style="font-size:90%;">
        28.89%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T11.1.7.5">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A10.T11.1.7.5.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.7.5.1.1" style="font-size:90%;">
        5
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A10.T11.1.7.5.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.7.5.2.1" style="font-size:90%;">
        15.56%
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A10.T11.1.7.5.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.7.5.3.1" style="font-size:90%;">
        14.07%
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A10.T11.1.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="A10.T11.1.1.1" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.1.1.1" style="font-size:90%;">
        Sum (
       </span>
       <math alttext="\geq" class="ltx_Math" display="inline" id="A10.T11.1.1.1.m1.1">
        <semantics id="A10.T11.1.1.1.m1.1a">
         <mo id="A10.T11.1.1.1.m1.1.1" mathsize="90%" xref="A10.T11.1.1.1.m1.1.1.cmml">
          ≥
         </mo>
         <annotation-xml encoding="MathML-Content" id="A10.T11.1.1.1.m1.1b">
          <geq id="A10.T11.1.1.1.m1.1.1.cmml" xref="A10.T11.1.1.1.m1.1.1">
          </geq>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A10.T11.1.1.1.m1.1c">
          \geq
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text" id="A10.T11.1.1.1.2" style="font-size:90%;">
        3)
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="A10.T11.1.1.2" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.1.2.1" style="font-size:90%;">
        55.56%
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A10.T11.1.1.3" style="padding:0.9pt 8.0pt;">
       <span class="ltx_text" id="A10.T11.1.1.3.1" style="font-size:90%;">
        58.52%
       </span>
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 11:
    </span>
    Average of percentage ratings for three tasks for GPT and for our MC Model
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
</article>
